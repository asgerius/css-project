[{"tags": ["c++", "structure", "binaryfiles", "dynamic-arrays"], "comments": [{"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1521072092, "post_id": 49289441, "comment_id": 85582166, "body": "I don&#39;t have time to go through your entire program. Maybe you should just write a very simple (10 line?) program to do the specific thing that is failing. Here is some advice to improve how the community responds to your question: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1521072458, "post_id": 49289441, "comment_id": 85582256, "body": "The values you&#39;re using when trying to print out the data you&#39;ve read are all wrong. You used <code>sizeof</code> before, so why not use it again? Why not read directly into the members of an instantiated object like you write them out? It&#39;s not surprising the data doesn&#39;t make any sense the way you&#39;re reading and trying to interpret it."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521073089, "post_id": 49289441, "comment_id": 85582412, "body": "In <code>addRecord()</code>, <code>sizeof(qty)</code> is 4 bytes on many systems, so at most you could read 3 digits from <code>cin.getline()</code>.  Consider using <code>std::getline()</code> instead of <code>cin.getline()</code> to read lines as variable-length <code>std::string</code> values, and then use <code>std::stod()</code> or <code>std::istringstream::operator&gt;&gt;</code> to parse them.  And your <code>viewRecord()</code> is outputting individual bytes read from the file, not the parsed <code>Inventory</code> fields. This whole code could use an overhaul"}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1521079195, "creation_date": 1521079195, "answer_id": 49290391, "question_id": 49289441, "link": "https://stackoverflow.com/questions/49289441/binary-file-reading-into-dynamic-array-as-garbage-values/49290391#49290391", "title": "Binary File reading into dynamic array as garbage values", "body": "<p>Try something more like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;limits&gt;\n\n#pragma pack(push, 1) // or your compiler's equivilent...\nstruct Inventory\n{\n    char desc[30];\n    int qty;\n    double wholeSaleCost;\n};\n#pragma pack(pop)\n\n// Function prototypes\nvoid addRecord();\nvoid viewRecord();\nvoid changeRecord();\n\nvoid resetInput()\n{\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');            \n    std::cin.clear();\n}\n\ntemplate&lt;typename T&gt;\nvoid promptforNumber(const char *prompt, T &amp;value)\n{\n    do\n    { \n        std::cout &lt;&lt; prompt &lt;&lt; \": \";\n        if (std::cin &gt;&gt; value)\n        {\n            if (value &gt;= T(0))\n                break;\n\n            std::cout &lt;&lt; \"Please enter a number greater than or equal to 0.\" &lt;&lt; std::endl;\n        }\n        else\n        {\n            resetInput();\n            std::cout &lt;&lt; \"That is not a valid number, please try again.\" &lt;&lt; std::endl;\n        }\n    }\n    while (true);\n}\n\nvoid promptforRecordData(Inventory &amp;item)\n{\n    std::cout &lt;&lt; \"Enter the following inventory data:\" &lt;&lt; endl;    \n\n    do\n    {\n        std::cout &lt;&lt; \"Description: \";\n        if (std::cin.getline(item.desc, sizeof(item.desc)))\n            break;\n\n        resetInput();\n        std::cout &lt;&lt; \"Please enter a string less than \" &lt;&lt; sizeof(item.desc) &lt;&lt; \" chars.\" &lt;&lt; std::endl;\n    }\n    while (true);\n    std::cout &lt;&lt; std::endl;\n\n    promptforNumber(\"Quantity\", item.qty);\n    std::cout &lt;&lt; std::endl;\n\n    promptforNumber(\"Retail Price\", item.wholeSaleCost);\n    std::cout &lt;&lt; std::endl;\n}\n\nvoid displayRecord(const Inventory &amp;item)\n{\n    std::cout &lt;&lt; \"Description: \" &lt;&lt; item.desc &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Quantity: \" &lt;&lt; item.qty &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Retail Price: \" &lt;&lt; item.wholeSaleCost &lt;&lt; std::end;\n}\n\nbool readRecord(std::istream &amp;in, Inventory &amp;item)\n{\n    if (!in.read(reinterpret_cast&lt;char*&gt;(&amp;item), sizeof(item)))\n        std::cout &lt;&lt; \"Failed to read inventory item.\" &lt;&lt; std::endl;\n    return in.good();\n}\n\nbool writeRecord(std::ostream &amp;out, const Inventory &amp;item)\n{\n    if (!out.write(reinterpret_cast&lt;const char*&gt;(&amp;item), sizeof(item)))\n        std::cout &lt;&lt; \"Failed to write inventory item.\" &lt;&lt; std::endl;\n    return out.good();\n}\n\nbool seekInToRecord(std::istream &amp;in, int recordNumber)\n{\n    if (!in.seekg(sizeof(Inventory) * recordNumber))\n        std::cout &lt;&lt; \"Failed to seek file.\" &lt;&lt; std::endl;\n    return in.good();\n}\n\nbool seekOutToRecord(std::ostream &amp;out, int recordNumber)\n{\n    if (!out.seekp(sizeof(Inventory) * recordNumber))\n        std::cout &lt;&lt; \"File Failed to seek.\" &lt;&lt; std::endl;\n    return out.good();\n}\n\n// This function will add a record to the file\nvoid addRecord()\n{\n    Inventory inventoryItem;    \n    promptforRecordData(inventoryItem);\n\n    // Adding record to the end of a binary file\n    std::ofstream inventoryFile(\"C:/temp/inventory.dat\", std::ios::app | ios::binary);    \n    if (!inventoryFile.is_open())\n    {\n        std::cout &lt;&lt; \"Failed to open file.\" &lt;&lt; std::endl;\n        return;\n    }\n\n    writeRecord(inventoryFile, inventoryItem);\n}\n\n// This function will display a record from the file\nvoid viewRecord()\n{\n    int recordNumber;\n    promptForNumber(\"Enter the record number of the item\", recordNumber);\n    std::cout &lt;&lt; endl;\n\n    // Reading from file    \n\n    std::ifstream inventoryFile(\"C:/temp/inventory.dat\", std::ios::binary);\n    if (!inventoryFile.is_open())\n    {\n        std::cout &lt;&lt; \"Failed to open file.\" &lt;&lt; std::endl;\n        return;\n    }\n\n    if (recordNumber &gt; 0)\n    {\n        if (!seekInToRecord(inventoryFile, recordNumber))\n            return;\n    }\n\n    Inventory inventoryItem;\n    if (!readRecord(inventoryFile, inventoryItem))\n        return;\n\n    inventoryFile.close();\n\n    //Record Display\n    displayRecord(inventoryItem);\n}\n\n// This function will change a record in the file\nvoid changeRecord()\n{\n    int recordNumber;    \n    promptForNumber(\"Enter the record number of the item\", recordNumber);\n    std::cout &lt;&lt; endl;\n\n    // Reading from file\n\n    std::fstream inventoryFile(\"C:/temp/inventory.dat\", std::ios::in | std::ios::out | std::ios::binary);\n    if (!inventoryFile.is_open())\n    {\n        std::cout &lt;&lt; \"File Failed to open.\" &lt;&lt; std::endl;\n        return;\n    }\n\n    if (recordNumber &gt; 0)\n    {\n        if (!seekInToRecord(inventoryFile, recordNumber))\n            return;\n    }\n\n    Inventory inventoryItem;\n    if (!readRecord(inventoryFile, inventoryItem))\n        return;\n\n    //Record Display\n    displayRecord(inventoryItem);\n\n    // Overwrite record in binary file\n    promptForRecordData(inventoryItem);\n    if (seekOutToRecord(inventoryFile, recordNumber))\n        writeRecord(inventoryFile, inventoryItem);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8585343, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cdc4cd04b3c5c04a4a9facbf482dfb07?s=128&d=identicon&r=PG&f=1", "display_name": "user8585343", "link": "https://stackoverflow.com/users/8585343/user8585343"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521079195, "creation_date": 1521071770, "question_id": 49289441, "link": "https://stackoverflow.com/questions/49289441/binary-file-reading-into-dynamic-array-as-garbage-values", "title": "Binary File reading into dynamic array as garbage values", "body": "<p>Hi trying to finish up some code and ran into an issue. My program is trying to write records to a binary file and then read them back when the appropriate functions are called. Whenever I try and read the file into the dynamic array so that I can format the output, only garbage values (I think the addresses?) are printed past some first text. </p>\n\n<p>Here's the code I'm working with now,</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include&lt;iomanip&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nstruct Inventory\n{\n char desc[30];\n int qty;\n double wholeSaleCost;\n};\n\n// Function prototypes\nvoid addRecord(fstream &amp;);\nvoid viewRecord(fstream &amp;);\nvoid changeRecord(fstream &amp;);\nbool validInput(char userInput);\n// This function will add a record to the file\nvoid addRecord(fstream &amp;inventoryFile)\n{\n    Inventory recordUserInput;\n    cin.ignore();\n    char *tempWholeSale;\n    char *tempQuantity;\n    tempWholeSale = new char[sizeof(Inventory().wholeSaleCost)];\n    tempQuantity = new char[sizeof(Inventory().qty)];\n\n\n\n    cout &lt;&lt; \"Enter the following inventory data:\" &lt;&lt; endl;\n\n    cout &lt;&lt; \"Description: \";\n    cin.getline(recordUserInput.desc, sizeof(Inventory().desc));\n    cout &lt;&lt; endl;\n\n    cout &lt;&lt; \"Quantity: \";\n    cin.getline(tempQuantity, sizeof(Inventory().qty));\n    while (!validInput(*tempQuantity))\n    {\n        cout &lt;&lt; \"That is not a valid input, please enter a number greater than 0.\" &lt;&lt; endl;\n        cout &lt;&lt; \"Quantity: \";\n        cin.getline(tempQuantity, sizeof(Inventory().qty));\n    }\n\n    recordUserInput.qty = atoi(tempQuantity);\n    cout &lt;&lt; endl;\n\n\n    cout &lt;&lt; \"Retail Price: \";\n    cin.getline(tempWholeSale, sizeof(Inventory().wholeSaleCost));\n    while (!validInput(*tempWholeSale))\n    {\n        cout &lt;&lt; \"That is not a valid input, please enter a number greater than 0.\" &lt;&lt; endl;\n        cout &lt;&lt; \"Retail Price: \";\n        cin.getline(tempWholeSale, sizeof(Inventory().wholeSaleCost));\n    }\n    recordUserInput.wholeSaleCost = atof(tempWholeSale);\n    cout &lt;&lt; endl;\n\n\n\n    // Adding record to the end of a binary file\n    inventoryFile.open(\"C:/temp/inventory.dat\", ios::out | ios::app | ios::binary);\n\n    if (inventoryFile)\n    {\n        inventoryFile.write(reinterpret_cast&lt;const char*&gt;(&amp;recordUserInput.desc), sizeof(Inventory().desc));\n        inventoryFile.write(reinterpret_cast&lt;const char*&gt;(&amp;recordUserInput.qty), sizeof(Inventory().qty));\n        inventoryFile.write(reinterpret_cast&lt;const char*&gt;(&amp;recordUserInput.wholeSaleCost), sizeof(Inventory().wholeSaleCost));\n        inventoryFile.close();\n    }\n    else\n    {\n        cout &lt;&lt; \"File Failed to open.\" &lt;&lt; endl;\n    }\n\n}\n\nvoid viewRecord(fstream &amp;inventoryFile)\n{\n    int recordNumber;\n    char * recordReadFromFile;\n    int recordIterator = 0;\n    recordReadFromFile = new char[sizeof(Inventory)];\n\n\n    cout &lt;&lt; \"Enter the record number of the item: \";\n    cin &gt;&gt; recordNumber;\n    cin.ignore();\n    cout &lt;&lt; endl;\n\n    // Reading from file\n\n    inventoryFile.open(\"C:/temp/inventory.dat\", ios::in | ios::binary);\n\n\n\n    if (inventoryFile)\n    {\n        inventoryFile.seekg((sizeof(Inventory)*recordNumber), ios::beg);\n        inventoryFile.read(recordReadFromFile, sizeof(Inventory));\n        inventoryFile.close();\n    }\n    else\n    {\n        cout &lt;&lt; \"File Failed to open.\" &lt;&lt; endl;\n    }\n\n\n    //Record Display\n    cout &lt;&lt; \"Description: \";\n    for (recordIterator; recordIterator &lt; 32; )\n    {\n        cout &lt;&lt; recordReadFromFile[recordIterator];\n        recordIterator++;\n    }\n\n    cout &lt;&lt; endl &lt;&lt; \"Quantity: \";\n    for (recordIterator; recordIterator &lt; 38; )\n    {\n        cout &lt;&lt; recordReadFromFile[recordIterator];\n        recordIterator++;\n    }\n\n    cout &lt;&lt; endl &lt;&lt; \"Retail Price: \";\n    for (recordIterator; recordIterator &lt; 48; )\n    {\n        cout &lt;&lt; recordReadFromFile[recordIterator];\n        recordIterator++;\n    }\n}\n</code></pre>\n\n<p>Main just has an if/else block to call the different functions. The fstream object I'm working with is 'fstream inventoryFile'</p>\n\n<p>The numbers for the cout display came from using a sizeof(Inventory.desc) etc. and I found that inv.desc was 30 bytes, .qty was 4 bytes and .wholeSale was 8 bytes (expected) but I can't find a way around the buffer issue when writing each structure member individually. Really appreciate any help that can be offered, working through these 2 issues has brought me to a standstill.</p>\n"}, {"tags": ["c++", "c++11", "struct"], "comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1521071373, "post_id": 49289350, "comment_id": 85581947, "body": "This code is simply wrong. You haven&#39;t declared the type of n; you&#39;re treating <code>tempWalker</code> as though it was a Twalker, while it&#39;s actually a vector... read your code before posting it here."}, {"owner": {"reputation": 135, "user_id": 8495358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1032f1ac710658bff20ffb9306fd16d0?s=128&d=identicon&r=PG&f=1", "display_name": "abk", "link": "https://stackoverflow.com/users/8495358/abk"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1521072348, "post_id": 49289350, "comment_id": 85582225, "body": "I know the code is wrong. Thank you for pointing out the type of n. The second part is unfortunately not yet clear."}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1521126261, "post_id": 49302034, "comment_id": 85607628, "body": "Rather than <code>tempWalker.clear();</code>, why not just declare <code>tempWalker</code> inside the loop?"}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1521126444, "post_id": 49302034, "comment_id": 85607746, "body": "@Caleth True! I will add it as a note. Thank you."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1521126714, "post_id": 49302034, "comment_id": 85607967, "body": "@Caleth because keeping it outside and doing clear avoids to stress the allocator for no good reason. In many hot spots hoisting a vector or a string outside of the loop gave me great performance improvements."}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1521126962, "post_id": 49302034, "comment_id": 85608158, "body": "@MatteoItalia actually makes sense. I was recently improving performance of some programs by removing similar redundant allocations and deallocations. I will add your comment to that comment too."}, {"owner": {"reputation": 135, "user_id": 8495358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1032f1ac710658bff20ffb9306fd16d0?s=128&d=identicon&r=PG&f=1", "display_name": "abk", "link": "https://stackoverflow.com/users/8495358/abk"}, "edited": false, "score": 0, "creation_date": 1521128138, "post_id": 49302034, "comment_id": 85609055, "body": "I will dig deeper into those concepts to make it work better. For the record, the original program has &lt;chrono&gt; and does not use namespace. It also seems that the difference between using vectors as compared to linked list based on pointers is not yet clear to me. Thank you kindly for the wonderful explanation."}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "edited": false, "score": 0, "creation_date": 1521162613, "post_id": 49302034, "comment_id": 85625312, "body": "Glad it helped. Besides vectors, look into other stl containers, like list for example."}], "tags": [], "owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "is_accepted": true, "score": 1, "last_activity_date": 1521127115, "last_edit_date": 1521127115, "creation_date": 1521123929, "answer_id": 49302034, "question_id": 49289350, "link": "https://stackoverflow.com/questions/49289350/initialise-vector-of-vectors-using-structure-as-datatype-in-c/49302034#49302034", "title": "Initialise vector of vectors using structure as datatype in c++", "body": "<p>First of all, structures are equivalent to classes - the only difference is that their members are by default public, while class members are by default private.</p>\n\n<p>Your program has multiple issues, and here is one possible solution to it:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;ctime&gt;\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\nusing std::vector;\n\nstruct Twalker\n{\n    int state;\n    float x,y;\n};\n\n// Initialize the vector of vectors of Twalker objects\nvoid initialise(vector&lt;vector&lt;Twalker&gt;&gt;&amp; walker, int nv, int n)\n{ \n    Twalker wlk;\n    vector&lt;Twalker&gt; tempWalker;\n\n    // Outer loop - vector of vectors\n    for (int i=0; i&lt;nv; i++){\n        // Inner loop - vector of Twalker objects\n        for (int j=0; j&lt;n; j++){\n            // Temporary Twalker\n            wlk.state = 1;\n            wlk.x = 0.0; \n            wlk.y = float(rand()%10);\n            // Add it to the inner vector\n            tempWalker.push_back(wlk);\n        }\n        // Add the inner vector to the vector of vectors\n        walker.push_back(tempWalker);\n        // Reset the inner vector\n        tempWalker.clear();\n    }\n}\n\nint main()\n{\n    // Set the seed\n    std::srand(std::time(0));\n\n    int nv = 3, n = 2;\n    vector&lt;vector&lt;Twalker&gt;&gt; walker;\n\n    // Initialize   \n    initialise(walker, nv, n);\n\n    // Print \n    for (int i = 0; i &lt; nv; i++)\n        for (int j = 0; j &lt; n; j++)\n            cout &lt;&lt; walker[i][j].state &lt;&lt; \" \" \n                 &lt;&lt; walker[i][j].x &lt;&lt; \" \"\n                 &lt;&lt; walker[i][j].y &lt;&lt; endl; \n    return 0;\n}\n</code></pre>\n\n<p>You should definitely read more on vectors including basics and concepts like iterators and <code>size_t</code>. Here I only used variations of what it seems you are familiar with, but some parts of this program would normally look quite different (like printing part). </p>\n\n<p>Some notes and suggestions related to this code:</p>\n\n<ul>\n<li>Generally don't use <code>using namespace std</code>. You may, for instance, end up overwriting stl functions with your own by accident. It is more recommended to use <code>using</code> for specific, commonly used components like <code>cin</code>, <code>cout</code>, <code>vector</code> etc.</li>\n<li>You are initializing a vector of vectors - thus you need two loops in your initialization function (and possibly an extra parameter to control the vector of vectors size).</li>\n<li>While you can access object (here Twalker) members directly from the vector, like in the print part at the end, you reversed the order for that in your program. You would need to push back a temporary Twalker first and then fill each member with a value. Here the Twalker is filled first and then pushed back.</li>\n<li>At the end of the inner loop the inner (temporary) vector is cleared - its size is reset to 0. If not for this, the inner loop would be increasing the size of the vector each time it performs a push_back. Last vector in the vector of vectors would be <code>nv</code> times longer than the first!</li>\n<li>The <code>srand</code> function resets the random seed every time the program is ran. Without it, executing the same program would always lead to the same set of random numbers. </li>\n<li>I normally use <code>argc</code> and <code>argv</code> only when I have command line arguments in the program. Also, you can but don't have to add a <code>return 0</code> statement at the end of your main (compiler will add it for you if you don't).</li>\n<li>As @Caleth said in the comment, instead of clearing <code>tempWalker</code> after the inner loop, you can also declare it in the inner loop which will create a new, empty <code>tempWalker</code> vector each time the inner loop is re-entered. On the other hand, as noted by @MatteoItalia, this approach allocates and deallocates memory for the inner vector each time the inner loop is executed. In larger programs with larger vectors this kind of redundant allocations will cause performance losses and should be avoided.</li>\n</ul>\n"}], "owner": {"reputation": 135, "user_id": 8495358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1032f1ac710658bff20ffb9306fd16d0?s=128&d=identicon&r=PG&f=1", "display_name": "abk", "link": "https://stackoverflow.com/users/8495358/abk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 49302034, "answer_count": 1, "score": 0, "last_activity_date": 1521127115, "creation_date": 1521071045, "last_edit_date": 1521124108, "question_id": 49289350, "link": "https://stackoverflow.com/questions/49289350/initialise-vector-of-vectors-using-structure-as-datatype-in-c", "title": "Initialise vector of vectors using structure as datatype in c++", "body": "<p>I would rather use a class, but my requirement is simpler than that. Which is to create a two dimensional array of elements, with each element representing a structure datatype. The problem is when I try to do a variable initialisation after the multi vector is passed into a function. The simple version of my code is as follows:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nstruct Twalker\n{\n    int state;  \n    float x,y; \n};`\n\nvoid initialise(vector&lt;vector&lt;Twalker&gt;&gt;&amp; walker,int n)\n{   \n   vector&lt;Twalker&gt; tempWalker;\n   for (int i=0; i&lt;n; i++)\n   {\n     tempWalker.state.push_back(+1); //need help!\n     tempWalker.y.push_back(float(rand() % 10)); //need help!\n     tempWalker.x.push_back(0.0); //need help!\n   }\n   walker.push_back(tempWalker);\n\n}\n\nint main(int argc, char** argv) \n{   \n   int n = 5;\n   vector&lt;vector&lt;Twalker&gt;&gt; walker;\n   initialise(walker,n);\n}\n</code></pre>\n\n<p>I have seen that we can add  multiple values into a structure using <code>push_back</code>. But i was trying to input values more liberally. Did I miss any syntax while using <code>push_back</code>? I started learning the concept of vectors few hours before and I am trying to shift my code from <code>arrays</code> into <code>vectors</code>.</p>\n"}, {"tags": ["c++", "visual-studio-2013"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521070988, "post_id": 49289295, "comment_id": 85581839, "body": "As for workarounds, have you tried <code>sizeof staticTest().myVal</code>? Or does that fail because <code>staticTest</code> is still incomplete?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521071330, "post_id": 49289295, "comment_id": 85581936, "body": "@melpomene thanks for the suggestion, but unfortunately still no good. You guessed correctly, first of 3 errors I get is <code>error C2027: use of undefined type &#39;staticTest&#39;</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1521071677, "post_id": 49289295, "comment_id": 85582036, "body": "What if you move the initialization out of the class? That&#39;s allowed, right? <code>class staticTest { ... static const size_t staticLength; }; const size_t staticTest::staticLength = sizeof staticTest().myVal;</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521072089, "post_id": 49289295, "comment_id": 85582164, "body": "@melpomene !!! Write up an answer please, that compiles for me in VS and <code>g++</code>!"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1521073081, "post_id": 49289295, "comment_id": 85582409, "body": "Are <code>&quot;stdafx.h&quot;</code> and/or <code>&lt;iostream&gt;</code> really relevant?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1521074201, "post_id": 49289295, "comment_id": 85582684, "body": "@aschepler possibly not. I just piggybacked off an existing test code solution for VS which included <code>stdafx.h</code>. And I didn&#39;t know off the top of my head what header defines <code>size_t</code>, but including <code>iostream</code> made that error go away. If you know better feel free to edit."}], "answers": [{"comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1521215367, "post_id": 49289514, "comment_id": 85650843, "body": "Using <code>decltype</code> solved this for me in 99% of my use cases, except for one different scenario in a <code>static</code> function. MS compiler can go pound sand as far as I&#39;m concerned."}], "tags": [], "owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "is_accepted": true, "score": 1, "last_activity_date": 1521073852, "last_edit_date": 1521073852, "creation_date": 1521072171, "answer_id": 49289514, "question_id": 49289295, "link": "https://stackoverflow.com/questions/49289295/cannot-use-sizeofmember-variable-to-initialize-a-static-const-value-in-visual/49289514#49289514", "title": "Cannot use sizeof(member variable) to initialize a static const value in Visual Studio", "body": "<p>This works in my Visual Studio compiler:</p>\n\n<pre><code>static const size_t staticLength = sizeof(decltype(myVal)); \n</code></pre>\n\n<p>And as far as I know this should accommodate any changes to the type of myVal.</p>\n\n<p>If you don't have to initialise it inside the class definition, don't initialise inside the class and have:</p>\n\n<pre><code>const size_t staticTest::staticLength = sizeof staticTest::myVal;\n</code></pre>\n\n<p>in a .cpp file</p>\n"}], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 49289514, "answer_count": 1, "score": 0, "last_activity_date": 1521073852, "creation_date": 1521070643, "last_edit_date": 1521071189, "question_id": 49289295, "link": "https://stackoverflow.com/questions/49289295/cannot-use-sizeofmember-variable-to-initialize-a-static-const-value-in-visual", "title": "Cannot use sizeof(member variable) to initialize a static const value in Visual Studio", "body": "<p>I've been developing a library on a Fedora 23 box using g++ 5.3.1, and successfully building this on a Windows box using mingw (I can fetch the version here if necessary).  I handed this code off to a coworker today interested in using it.  He tried compiling it in Visual Studio 2013 (his IDE of choice), and it blew up.  Below I've created an MCVE of the problem:</p>\n\n<pre><code>#include \"stdafx.h\"  // include this while in Visual Studio\n#include &lt;iostream&gt;  // include when compiling with g++\n\nclass staticTest\n{\npublic:\n  staticTest() { };\n  ~staticTest() { };\n\n  unsigned myVal;\n\nprivate:\n  static const size_t staticLength = sizeof(myVal);  // errors in VS2013, compiles fine with g++ and mingw\n  const size_t length_ = sizeof(myVal);  // compiles fine for all\n};\n</code></pre>\n\n<p>This compiles without error or warning with <code>g++ -Wall -Wextra -std=c++11 -c staticTest.cpp</code>.  However, in Visual Studio 2013, I get the following 3 errors about the <code>staticLength</code> assignment line:</p>\n\n<pre><code>statictest.cpp(12): error C2327: 'staticTest::myVal' : is not a type name, static, or enumerator\nstatictest.cpp(12): error C2065: 'myVal' : undeclared identifier\nstatictest.cpp(12): error C2070: 'unknown-type': illegal sizeof operand\n</code></pre>\n\n<p>I know what the errors are basically saying, it doesn't see the member variable in the <code>static</code> context, and therefore cannot apply the <code>sizeof</code> operator to it.  Through clenched teeth, I approved changing all such instances to <code>static const size_t staticLength = sizeof(unsigned);</code> and it built fine after that.  This problem compounded even further in another instance where I tried doing something similar in a <code>static</code> function with <code>sizeof(memberArray)</code> and <code>sizeof(memberArray[0])</code>.</p>\n\n<p>I'm assuming this is standard compliant, since <code>g++</code> likes it and I've heard before Microsoft compilers are loose with the standards, accepting a kind of pseudo-c/c++ language.</p>\n\n<ol>\n<li>Is this bad coding style?  I always prefer using <code>sizeof(myVariable)</code> because it's more maintainable (if the type of <code>myVariable</code> changes, no changes are necessary to the <code>sizeof</code>).  Seems like to me the compiler should know (as g++ does) the type of <code>myVal</code> at compile time and not care whether it's a member of a class or not.</li>\n<li>Any chance if anybody knows of a work-around for this in Visual Studio 2013, or if this problem is fixed in later versions of Visual Studio?  The real kicker for me is Windows mingw compiles this just fine, but my coworker won't budge from VS, so here I am modifying my code, making it less-maintainable, just to comply with the whims of a wonky IDE/compiler.  Oh and his final executable will be built for Linux and run on the same box as mine, so building it in VS isn't even necessary or a requirement... [angry/puking emoji]</li>\n</ol>\n\n<p><strong>EDIT</strong>\nI have also tried:</p>\n\n<pre><code>static const size_t staticLength = sizeof(this-&gt;myVal);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>static const size_t staticLength = sizeof(staticTest::myVal);\n</code></pre>\n\n<p>Both failed.</p>\n"}, {"tags": ["c++", "macos", "opencv"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1521071830, "post_id": 49289287, "comment_id": 85582089, "body": "Is there a difference between 3.4.1 and 3.4.0? You&#39;re crashing in 3.4.0"}, {"owner": {"reputation": 11, "user_id": 745724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1a1a5e6dac54f0111d46c4b00cded6?s=128&d=identicon&r=PG", "display_name": "Jim M.", "link": "https://stackoverflow.com/users/745724/jim-m"}, "reply_to_user": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1521083381, "post_id": 49289287, "comment_id": 85584761, "body": "yes. good catch. it&#39;s just the data I posted is from two machines. some of the data I posted is 3.4.0 and some from 3.4.1. that&#39;s a red herring. the 3.4.0 is an old crash report from a Mac where it doesn&#39;t run. The 3.4.1 is from my computer where i&#39;m compiling. I wish it was that. it crashed in opencv 3.3.0, 3.3.1, 3.4.0 and recently in 3.4.1. There has to be some compiler setting to get it to work on older macs."}], "owner": {"reputation": 11, "user_id": 745724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b1a1a5e6dac54f0111d46c4b00cded6?s=128&d=identicon&r=PG", "display_name": "Jim M.", "link": "https://stackoverflow.com/users/745724/jim-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521070591, "creation_date": 1521070591, "question_id": 49289287, "link": "https://stackoverflow.com/questions/49289287/cant-get-opencv-based-application-to-run-on-macbook-older-than-mine", "title": "can&#39;t get opencv-based application to run on Macbook older than mine", "body": "<p>I have already compiled opencv on the Mac and created a MacOS application based on it. It currently works on a variety of Macs for the past couple months. However, my Macbook is a Late 2013. Right now, no users with Early 2013 Macbooks or older can run it.</p>\n\n<p>I have tried several different ways to compile OpenCV on the Mac in order to get it to work on a computer older than mine but have not been successful. My application is and has been running for months on 50+ Macs but they are all Late 2013 Macbooks or newer. I have confirmed that it runs on older operating systems. For example, I run High Sierra 10.13 and I've seen my application run on a system with 10.10.5 and 10.12 systems. Even Early 2013 Macbooks don't run my application. My goal is to get the application to run on older Macs than mine which is a Late 2013 Macbook Pro.</p>\n\n<p>I use Xcode 9.2. I use brew to compile OpenCV. In this example, I was using opencv 3.4.0. I also tried 3.4.1 and it didn't work either. I'm sure I'm missing some simple setting.</p>\n\n<p>I currently compile with this setting but it is not enough:</p>\n\n<pre><code>-DCMAKE_OSX_DEPLOYMENT_TARGET=10.9\n</code></pre>\n\n<p>I tried compiling with this flag but it didn't help. i thought this flag would tell the compiler to target an older architecture but it didn't work:</p>\n\n<pre><code>-DCMAKE_CXX_COMPILER_TARGET=x86_64-apple-darwin15.5.0\n</code></pre>\n\n<p>the crash log from the Macbook from 2010 looks like this:</p>\n\n<pre><code>Process:               Brightday [17622]\nPath:                  /Users/USER/Downloads/Brightday.app/Contents/MacOS/Brightday\nIdentifier:            com.brightday.Brightday\nVersion:               47 (47)\nCode Type:             X86-64 (Native)\nParent Process:        ??? [1]\nResponsible:           Brightday [17622]\nUser ID:               502\n\nDate/Time:             2018-01-22 17:46:07.436 -0800\nOS Version:            Mac OS X 10.11.5 (15F34)\nReport Version:        11\nAnonymous UUID:        333100CF-2D55-443A-78BE-49F842AC3DD4\n\nSleep/Wake UUID:       B8FBAF9B-42C4-450F-905D-74EAE4B19AD9\n\nTime Awake Since Boot: 600000 seconds\nTime Since Wake:       5100 seconds\n\nSystem Integrity Protection: enabled\n\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\n\nException Type:        EXC_BAD_INSTRUCTION (SIGILL)\nException Codes:       0x0000000000000001, 0x0000000000000000\nException Note:        EXC_CORPSE_NOTIFY\n\nApplication Specific Information:\n/Users/USER/Downloads/Brightday.app/Contents/MacOS/../Frameworks/../Frameworks/opencv/libopencv_core.3.4.0.dylib\n\nThread 0 Crashed:: Dispatch queue: com.apple.main-thread\n0   libopencv_core.3.4.0.dylib      0x000000010f8e7556 _GLOBAL__sub_I_persistence.cpp + 44\n1   dyld                            0x00007fff6606510b ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&amp;) + 265\n2   dyld                            0x00007fff66065284 ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&amp;) + 40\n3   dyld                            0x00007fff660618bd ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 305\n4   dyld                            0x00007fff66061852 ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 198\n5   dyld                            0x00007fff66061743 ImageLoader::processInitializers(ImageLoader::LinkContext const&amp;, unsigned int, ImageLoader::InitializerTimingList&amp;, ImageLoader::UninitedUpwards&amp;) + 127\n6   dyld                            0x00007fff660619b3 ImageLoader::runInitializers(ImageLoader::LinkContext const&amp;, ImageLoader::InitializerTimingList&amp;) + 75\n7   dyld                            0x00007fff660540f1 dyld::initializeMainExecutable() + 208\n8   dyld                            0x00007fff66057d98 dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 3596\n9   dyld                            0x00007fff66053276 dyldbootstrap::start(macho_header const*, int, char const**, long, macho_header const*, unsigned long*) + 512\n10  dyld                            0x00007fff66053036 _dyld_start + 54\n\nThread 0 crashed with X86 Thread State (64-bit):\n  rax: 0x000000011003b6d1  rbx: 0x00007fff50563650  rcx: 0x00007fff50566d40  rdx: 0x00007fff50566ce0\n  rdi: 0x0000000000000001  rsi: 0x00007fff50566cd0  rbp: 0x00007fff505636c0  rsp: 0x00007fff50563650\n   r8: 0x00007fff6608b630   r9: 0x000000000000002c  r10: 0x00007fff50566d38  r11: 0x0000000000000000\n  r12: 0x00000001102758e8  r13: 0x00007fff6608b568  r14: 0x00007fff66093b78  r15: 0x0000000000000001\n  rip: 0x000000010f8e7556  rfl: 0x0000000000010246  cr2: 0x000000010f8e752a\n\nLogical CPU:     2\nError Code:      0x00000000\nTrap Number:     6\n\n\nBinary Images:\n       0x10f699000 -        0x10f71bfff +com.brightday.Brightday (47 - 47) &lt;C4224EF0-C56D-3124-80DF-2394BAEF1392&gt; /Users/USER/Downloads/Brightday.app/Contents/MacOS/Brightday\n       0x10f75d000 -        0x110274fe7 +libopencv_core.3.4.0.dylib (0) &lt;59A4B9B9-1E75-3314-AF6C-E6C6D6AB98A4&gt; /Users/USER/Downloads/Brightday.app/Contents/Frameworks/opencv/libopencv_core.3.4.0.dylib\n       0x1103ec000 -        0x11047bfef +libopencv_features2d.3.4.0.dylib (0) &lt;4BC1D301-389F-34CE-BE2E-60F2EA549F2C&gt; /Users/USER/Downloads/Brightday.app/Contents/Frameworks/opencv/libopencv_features2d.3.4.0.dylib\n       0x1104ae000 -        0x1104e8ffb +libopencv_flann.3.4.0.dylib (0) &lt;1052FC33-9DEA-3B9F-9C8E-6036FCE6DB9E&gt; /Users/USER/Downloads/Brightday.app/Contents/Frameworks/opencv/libopencv_flann.3.4.0.dylib\n</code></pre>\n\n<p>from this command:</p>\n\n<pre><code>otool -l libopencv_core.3.4.1.dylib \n</code></pre>\n\n<p>I get this output</p>\n\n<pre><code>libopencv_core.3.4.1.dylib:\nMach header\n      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags\n 0xfeedfacf 16777223          3  0x00           6    19       2184 0x00118085\nLoad command 0\n      cmd LC_SEGMENT_64\n  cmdsize 632\n  segname __TEXT\n   vmaddr 0x0000000000000000\n   vmsize 0x000000000024a000\n  fileoff 0\n filesize 2400256\n  maxprot 0x00000007\n initprot 0x00000005\n   nsects 7\n    flags 0x0\nSection\n  sectname __text\n   segname __TEXT\n      addr 0x0000000000002610\n      size 0x00000000001bf9c7\n    offset 9744\n     align 2^4 (16)\n    reloff 0\n    nreloc 0\n     flags 0x80000400\n reserved1 0\n reserved2 0\nSection\n  sectname __stubs\n   segname __TEXT\n      addr 0x00000000001c1fd8\n      size 0x000000000000052e\n    offset 1843160\n     align 2^1 (2)\n    reloff 0\n    nreloc 0\n     flags 0x80000408\n reserved1 0 (index into indirect symbol table)\n reserved2 6 (size of stubs)\nSection\n  sectname __stub_helper\n   segname __TEXT\n      addr 0x00000000001c2508\n      size 0x000000000000088a\n    offset 1844488\n     align 2^2 (4)\n    reloff 0\n    nreloc 0\n     flags 0x80000400\n reserved1 0\n reserved2 0\nSection\n  sectname __gcc_except_tab\n   segname __TEXT\n      addr 0x00000000001c2d94\n      size 0x000000000003bfa0\n    offset 1846676\n     align 2^2 (4)\n    reloff 0\n    nreloc 0\n     flags 0x00000000\n reserved1 0\n reserved2 0\nSection\n  sectname __cstring\n   segname __TEXT\n      addr 0x00000000001fed40\n      size 0x000000000003b1f2\n    offset 2092352\n     align 2^4 (16)\n    reloff 0\n    nreloc 0\n     flags 0x00000002\n reserved1 0\n reserved2 0\nSection\n  sectname __const\n   segname __TEXT\n      addr 0x0000000000239f40\n      size 0x000000000000a21c\n    offset 2334528\n     align 2^5 (32)\n    reloff 0\n    nreloc 0\n     flags 0x00000000\n reserved1 0\n reserved2 0\nSection\n  sectname __unwind_info\n   segname __TEXT\n      addr 0x000000000024415c\n      size 0x0000000000005e90\n    offset 2376028\n     align 2^2 (4)\n    reloff 0\n    nreloc 0\n     flags 0x00000000\n reserved1 0\n reserved2 0\nLoad command 1\n      cmd LC_SEGMENT_64\n  cmdsize 712\n  segname __DATA\n   vmaddr 0x000000000024a000\n   vmsize 0x0000000000010000\n  fileoff 2400256\n filesize 45056\n  maxprot 0x00000007\n initprot 0x00000003\n   nsects 8\n    flags 0x0\nSection\n  sectname __got\n   segname __DATA\n      addr 0x000000000024a000\n      size 0x0000000000000188\n    offset 2400256\n     align 2^3 (8)\n    reloff 0\n    nreloc 0\n     flags 0x00000006\n reserved1 221 (index into indirect symbol table)\n reserved2 0\nSection\n  sectname __nl_symbol_ptr\n   segname __DATA\n      addr 0x000000000024a188\n      size 0x0000000000000010\n    offset 2400648\n     align 2^3 (8)\n    reloff 0\n    nreloc 0\n     flags 0x00000006\n reserved1 270 (index into indirect symbol table)\n reserved2 0\nSection\n  sectname __la_symbol_ptr\n   segname __DATA\n      addr 0x000000000024a198\n      size 0x00000000000006e8\n    offset 2400664\n     align 2^3 (8)\n    reloff 0\n    nreloc 0\n     flags 0x00000007\n reserved1 272 (index into indirect symbol table)\n reserved2 0\nSection\n  sectname __mod_init_func\n   segname __DATA\n      addr 0x000000000024a880\n      size 0x0000000000000040\n    offset 2402432\n     align 2^3 (8)\n    reloff 0\n    nreloc 0\n     flags 0x00000009\n reserved1 0\n reserved2 0\nSection\n  sectname __const\n   segname __DATA\n      addr 0x000000000024a8c0\n      size 0x0000000000005090\n    offset 2402496\n     align 2^4 (16)\n    reloff 0\n    nreloc 0\n     flags 0x00000000\n reserved1 0\n reserved2 0\nSection\n  sectname __data\n   segname __DATA\n      addr 0x000000000024f950\n      size 0x0000000000004aa0\n    offset 2423120\n     align 2^4 (16)\n    reloff 0\n    nreloc 0\n     flags 0x00000000\n reserved1 0\n reserved2 0\nSection\n  sectname __bss\n   segname __DATA\n      addr 0x0000000000254400\n      size 0x0000000000004fb6\n    offset 0\n     align 2^5 (32)\n    reloff 0\n    nreloc 0\n     flags 0x00000001\n reserved1 0\n reserved2 0\nSection\n  sectname __common\n   segname __DATA\n      addr 0x00000000002593b8\n      size 0x0000000000000059\n    offset 0\n     align 2^3 (8)\n    reloff 0\n    nreloc 0\n     flags 0x00000001\n reserved1 0\n reserved2 0\nLoad command 2\n      cmd LC_SEGMENT_64\n  cmdsize 72\n  segname __LINKEDIT\n   vmaddr 0x000000000025a000\n   vmsize 0x0000000000085000\n  fileoff 2445312\n filesize 543516\n  maxprot 0x00000007\n initprot 0x00000001\n   nsects 0\n    flags 0x0\nLoad command 3\n          cmd LC_ID_DYLIB\n      cmdsize 80\n         name /usr/local/opt/opencv/lib/libopencv_core.3.4.dylib (offset 24)\n   time stamp 1 Wed Dec 31 16:00:01 1969\n      current version 3.4.1\ncompatibility version 3.4.0\nLoad command 4\n            cmd LC_DYLD_INFO_ONLY\n        cmdsize 48\n     rebase_off 2445312\n    rebase_size 1616\n       bind_off 2446928\n      bind_size 5176\n  weak_bind_off 2452104\n weak_bind_size 1560\n  lazy_bind_off 2453664\n lazy_bind_size 7616\n     export_off 2461280\n    export_size 55288\nLoad command 5\n     cmd LC_SYMTAB\n cmdsize 24\n  symoff 2523664\n   nsyms 8017\n  stroff 2653908\n strsize 334920\nLoad command 6\n            cmd LC_DYSYMTAB\n        cmdsize 80\n      ilocalsym 0\n      nlocalsym 5832\n     iextdefsym 5832\n     nextdefsym 1824\n      iundefsym 7656\n      nundefsym 361\n         tocoff 0\n           ntoc 0\n      modtaboff 0\n        nmodtab 0\n   extrefsymoff 0\n    nextrefsyms 0\n indirectsymoff 2651936\n  nindirectsyms 493\n      extreloff 0\n        nextrel 0\n      locreloff 0\n        nlocrel 0\nLoad command 7\n     cmd LC_UUID\n cmdsize 24\n    uuid 148A22D3-49C6-3F35-BA2C-E3C83AEC474A\nLoad command 8\n      cmd LC_VERSION_MIN_MACOSX\n  cmdsize 16\n  version 10.9\n      sdk 10.13\nLoad command 9\n      cmd LC_SOURCE_VERSION\n  cmdsize 16\n  version 0.0\nLoad command 10\n          cmd LC_LOAD_DYLIB\n      cmdsize 64\n         name /usr/local/opt/tbb/lib/libtbb.dylib (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 0.0.0\ncompatibility version 0.0.0\nLoad command 11\n          cmd LC_LOAD_DYLIB\n      cmdsize 48\n         name /usr/lib/libz.1.dylib (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 1.2.11\ncompatibility version 1.0.0\nLoad command 12\n          cmd LC_LOAD_DYLIB\n      cmdsize 88\n         name /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 1.0.0\ncompatibility version 1.0.0\nLoad command 13\n          cmd LC_LOAD_DYLIB\n      cmdsize 96\n         name /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 4.0.0\ncompatibility version 1.0.0\nLoad command 14\n          cmd LC_LOAD_DYLIB\n      cmdsize 56\n         name /usr/lib/libSystem.B.dylib (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 1252.0.0\ncompatibility version 1.0.0\nLoad command 15\n          cmd LC_LOAD_DYLIB\n      cmdsize 48\n         name /usr/lib/libc++.1.dylib (offset 24)\n   time stamp 2 Wed Dec 31 16:00:02 1969\n      current version 400.9.0\ncompatibility version 1.0.0\nLoad command 16\n      cmd LC_FUNCTION_STARTS\n  cmdsize 16\n  dataoff 2516568\n datasize 6528\nLoad command 17\n      cmd LC_DATA_IN_CODE\n  cmdsize 16\n  dataoff 2523096\n datasize 568\nLoad command 18\n          cmd LC_RPATH\n      cmdsize 48\n         path /usr/local/Cellar/opencv/3.4.1/lib (offset 12)\n</code></pre>\n\n<p>Here's the output from</p>\n\n<blockquote>\n  <p>brew edit opencv</p>\n</blockquote>\n\n<pre><code>class Opencv &lt; Formula\ndesc \"Open source computer vision library\"\n homepage \"https://opencv.org/\"\nurl \"https://github.com/opencv/opencv/archive/3.4.1.tar.gz\"\nsha256 \"ac627047c2afbbcb0ddd9583342f03c8e700032c9a77721a52c39c9d96790dbb\"\n\n bottle do\n  sha256 \"e076e80bc5fe389bab1a8c1ba767fe737d4143b832830829681b5114203f0a78\" =&gt; :high_sierra\n  sha256 \"afac0a89c93c20e90b28292a72a91d088ef03b528f82ed01679f92df6696e56c\" =&gt; :sierra\n   sha256 \"639b043ae297109902edea2a6fcfff7da74caed73f3e5a5cc0fddf9743dc8fbe\" =&gt; :el_capitan\n end\n\ndepends_on \"cmake\" =&gt; :build\n depends_on \"pkg-config\" =&gt; :build\n depends_on \"eigen\"\n\nneeds :cxx11\n\nresource \"contrib\" do\n  url \"https://github.com/opencv/opencv_contrib/archive/3.4.1.tar.gz\"\n  sha256 \"298c69ee006d7675e1ff9d371ba8b0d9e7e88374bb7ba0f9d0789851d352ec6e\"\nend\n\ndef install\n  ENV.cxx11\n\n  resource(\"contrib\").stage buildpath/\"opencv_contrib\"\n\n  args = std_cmake_args + %W[\n  -DCMAKE_OSX_SYSROOT=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.9.sdk\n  -DCMAKE_OSX_DEPLOYMENT_TARGET=10.9\n  -DBUILD_opencv_aruco=OFF\n  -DBUILD_opencv_bgsegm=OFF\n  -DBUILD_opencv_bioinspired=OFF\n  -DBUILD_opencv_calib3d=OFF\n  -DBUILD_opencv_ccalib=OFF\n  -DBUILD_opencv_dpm=OFF\n  -DBUILD_opencv_face=OFF\n  -DBUILD_opencv_fuzzy=OFF\n  -DBUILD_opencv_img_hash=OFF\n  -DBUILD_opencv_line_descriptor=OFF\n  -DBUILD_opencv_optflow=OFF\n  -DBUILD_opencv_phase_unwrapping=OFF\n  -DBUILD_opencv_reg=OFF\n  -DBUILD_opencv_rgbd=OFF\n  -DBUILD_opencv_saliency=OFF\n  -DBUILD_opencv_shape=OFF\n  -DBUILD_opencv_stereo=OFF\n  -DBUILD_opencv_stitching=OFF\n  -DBUILD_opencv_structured_light=OFF\n  -DBUILD_opencv_superres=OFF\n  -DBUILD_opencv_surface_matching=OFF\n  -DBUILD_opencv_videostab=OFF\n  -DBUILD_opencv_xfeatures2d=OFF\n  -DBUILD_opencv_ximgproc=OFF\n  -DBUILD_opencv_xobjdetect=OFF\n  -DBUILD_opencv_xphoto=OFF\n  -DCMAKE_BUILD_TYPE=RELEASE\n  -DWITH_OPENMP=ON\n  -DWITH_IPP=ON\n  -DWITH_NVCUVID=ON\n  -DBUILD_opencv_cudaarithm=ON\n  -DBUILD_opencv_cudafilters=ON\n  -DBUILD_opencv_cudaimgproc=ON\n  -DBUILD_opencv_cudafeatures2d=ON\n  -DWITH_CUDA=ON\n  -DENABLE_FAST_MATH=1\n  -DCUDA_FAST_MATH=1\n  -DWITH_CUBLAS=1\n  -DWITH_CUFFT=1\n  -DWITH_CSTRIPES=ON\n  -DBUILD_JASPER=OFF\n  -DBUILD_JPEG=ON\n  -DBUILD_OPENEXR=ON\n  -DBUILD_PERF_TESTS=OFF\n  -DBUILD_PNG=ON\n  -DBUILD_TESTS=OFF\n  -DBUILD_TIFF=ON\n  -DBUILD_ZLIB=OFF\n  -DBUILD_opencv_java=OFF\n  -DOPENCV_ENABLE_NONFREE=OFF\n  -DOPENCV_EXTRA_MODULES_PATH=#{buildpath}/opencv_contrib/modules\n  -DWITH_1394=OFF\n  -DWITH_EIGEN=ON\n  -DWITH_FFMPEG=OFF\n  -DWITH_GPHOTO2=OFF\n  -DWITH_GSTREAMER=OFF\n  -DWITH_JASPER=OFF\n  -DWITH_OPENEXR=ON\n  -DWITH_OPENGL=OFF\n  -DWITH_QT=OFF\n  -DWITH_TBB=ON\n  -DWITH_VTK=OFF\n  -DBUILD_opencv_python2=OFF\n  -DBUILD_opencv_python3=OFF\n  -DCPU_BASELINE=SSE2\n  -DCPU_DISPATCH=SSE4_2,AVX2\n]\n\nif build.bottle?\n  args += %w[-DCPU_BASELINE=SSE2 -DCPU_DISPATCH=SSE4_2,AVX]\nend\n\nmkdir \"build\" do\n  system \"cmake\", \"..\", *args\n  system \"make\"\n  system \"make\", \"install\"\n  end\nend\n\ntest do\n  (testpath/\"test.cpp\").write &lt;&lt;~EOS\n    #include &lt;opencv/cv.h&gt;\n    #include &lt;iostream&gt;\n    int main() {\n      std::cout &lt;&lt; CV_VERSION &lt;&lt; std::endl;\n    return 0;\n  }\nEOS\nsystem ENV.cxx, \"test.cpp\", \"-I#{include}\", \"-L#{lib}\", \"-o\", \"test\"\nassert_equal `./test`.strip, version.to_s\n\n[\"python\", \"python3\"].each do |python|\n  output = shell_output(\"#{python} -c 'import cv2; print(cv2.__version__)'\")\n  assert_equal version.to_s, output.chomp\n  end\n end\nend\n</code></pre>\n"}, {"tags": ["c++", "c", "compiler-construction", "llvm", "compiler-optimization"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1521075870, "post_id": 49289270, "comment_id": 85583092, "body": "all the variables are declared as <code>float</code> but all the literals are <code>double</code>.  Suggest remembering to append &#39;f&#39; to each of the literals"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1521076296, "post_id": 49289270, "comment_id": 85583183, "body": "the function <code>sqrt()</code> expects a <code>double</code> parameter and returns a <code>double</code> result.  You can avoid all the resulting conversions by replacing &#39;sqrt&#39; with &#39;sqrtf&#39;"}, {"owner": {"reputation": 516, "user_id": 3525451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a48eae41cfabe94ce6716e0184048f6?s=128&d=identicon&r=PG", "display_name": "Farhad", "link": "https://stackoverflow.com/users/3525451/farhad"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1521076652, "post_id": 49289270, "comment_id": 85583269, "body": "@user3629249 Unfortunately, the issue remains even if I have a completely different body with no floating point operations..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1521098258, "post_id": 49289270, "comment_id": 85589387, "body": "My comment about which function to call was a suggestion on improving the code, NOT a fix for the loop unrolling.  BTW: what exactly are the parameters to the compile step, that you are using?"}, {"owner": {"reputation": 516, "user_id": 3525451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a48eae41cfabe94ce6716e0184048f6?s=128&d=identicon&r=PG", "display_name": "Farhad", "link": "https://stackoverflow.com/users/3525451/farhad"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1521099776, "post_id": 49289270, "comment_id": 85590047, "body": "@user3629249 I&#39;m using <code>clang -O0 -S -emit-llvm trainingCode.cpp -o trainingCode.ll</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": false, "score": 1, "last_activity_date": 1521207897, "creation_date": 1521207897, "answer_id": 49322269, "question_id": 49289270, "link": "https://stackoverflow.com/questions/49289270/why-is-llvm-completely-unrolling-my-loops/49322269#49322269", "title": "Why is LLVM completely unrolling my loops?", "body": "<p>LLVM has different heuristics for determining whether to unroll and whether to unroll fully, because unrolling a loop fully is often more beneficial than unrolling it partially, particularly if the trip count is fixed and known at compile time, because then all the checks and branches can be eliminated.</p>\n\n<p>My quick search only turned up the <a href=\"http://llvm.org/doxygen/LoopUnrollPass_8cpp_source.html\" rel=\"nofollow noreferrer\">source code</a> and not the documentation, \nbut I think full unrolling is limited by a different setting: <code>-unroll-full-max-count</code>.</p>\n"}], "owner": {"reputation": 516, "user_id": 3525451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a48eae41cfabe94ce6716e0184048f6?s=128&d=identicon&r=PG", "display_name": "Farhad", "link": "https://stackoverflow.com/users/3525451/farhad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521207897, "creation_date": 1521070494, "question_id": 49289270, "link": "https://stackoverflow.com/questions/49289270/why-is-llvm-completely-unrolling-my-loops", "title": "Why is LLVM completely unrolling my loops?", "body": "<p>I have a piece of code that I want to unroll by various unroll factors and then look at the resulting bitcode. To do so I'm doing the following:</p>\n\n<p>1) I first compile the code using clang:</p>\n\n<pre><code>clang -O0 -S -emit-llvm trainingCode.cpp -o trainingCode.ll\n</code></pre>\n\n<p>2) I then run a couple of passes on the resulting bitcode (as recommended by <a href=\"https://stackoverflow.com/questions/31340251/llvm-unable-to-unroll-loops-cant-unroll-loop-not-terminated-by-a-conditional\">this</a>):</p>\n\n<pre><code>opt -mem2reg -simplifycfg -loops -lcssa -loop-simplify -loop-rotate -inline -inline-threshold=1000000 trainingCode.ll -o trainingCode.bc &gt; /dev/null\n</code></pre>\n\n<p>3) Finally, I run the unrolling pass:</p>\n\n<pre><code>opt -loop-unroll -unroll-count=2 -unroll-allow-partial trainingCode.bc -o unrolledTrainingCode.bc &gt; /dev/null\n</code></pre>\n\n<p>I then repeat this with various unroll factors from 1 to 4.</p>\n\n<p>For a simple piece of code like the following, this works <em>exactly</em> like I need it to:</p>\n\n<pre><code>#include &lt;math.h&gt;\nint main() {\n    volatile float checksum = 0.0;\n    for (int i = 0; i &lt; 10; i++) {\n        float fff = 0.112345; \n\n        fff *= fff;\n        fff += 1.13;\n\n        checksum += fff/10000;\n    }\n}\n</code></pre>\n\n<p>But I get really weird behavior when I increase the complexity/size of the body to this for instance:</p>\n\n<pre><code>#include &lt;math.h&gt;\nint main() {\n    volatile float checksum = 0.0;\n    for (int i = 0; i &lt; 10; i++) {\n        float fff = 0.112345; \n\n        fff *= sqrt(fff) + fff;\n        fff += 1.13;\n        fff *= sqrt(fff) + fff;\n        fff += 17.16; \n        fff *= sqrt(fff) + fff;\n        fff += 15.13; \n        fff *= sqrt(fff) + fff;\n        fff += 21.13; \n        fff *= sqrt(fff) + fff;\n        fff += 81.13; \n        fff *= sqrt(fff) + fff;\n        fff += 11.13; \n        fff *= sqrt(fff) + fff;\n        fff += 81.13; \n        fff *= sqrt(fff) + fff;\n        fff += 11.13; \n        fff *= sqrt(fff) + fff;\n        fff += 91.13; \n        fff *= sqrt(fff) + fff;\n        fff += 11.13; \n\n        checksum += (fff + i)/10000;\n    }\n}\n</code></pre>\n\n<p>For unroll factors of 1-2, everything works fine, but if I try to unroll using a factor greater than 2, LLVM <em>completely</em> unrolls the loop. This happens for <em>any</em> loop with sufficiently large of a body. For instance, this is (an excerpt) of the resulting bitcode of using any unroll factor greater than 2 for the code directly above:</p>\n\n<pre><code>; ModuleID = 'unrolledtrainingCode3.bc'\nsource_filename = \"p1HighComplexity.cpp\"\ntarget datalayout = \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\"\ntarget triple = \"x86_64-unknown-linux-gnu\"\n\n; Function Attrs: norecurse uwtable\ndefine i32 @main() #0 {\nentry:\n  %checksum = alloca float, align 4\n  store volatile float 0.000000e+00, float* %checksum, align 4\n  br label %for.body\n\nfor.body:                                         ; preds = %entry\n  %call.i = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add = fadd float %call.i, 0x3FBCC2A460000000\n  %mul = fmul float 0x3FBCC2A460000000, %add\n  %conv = fpext float %mul to double\n  %add1 = fadd double %conv, 1.130000e+00\n  %conv2 = fptrunc double %add1 to float\n  %call.i2 = call float @sqrtf(float %conv2) #2\n  %add4 = fadd float %call.i2, %conv2\n  %mul5 = fmul float %conv2, %add4\n  %conv6 = fpext float %mul5 to double\n  %add7 = fadd double %conv6, 1.716000e+01\n  %conv8 = fptrunc double %add7 to float\n  %call.i3 = call float @sqrtf(float %conv8) #2\n  %add10 = fadd float %call.i3, %conv8\n  %mul11 = fmul float %conv8, %add10\n  %conv12 = fpext float %mul11 to double\n  %add13 = fadd double %conv12, 1.513000e+01\n  %conv14 = fptrunc double %add13 to float\n  %call.i4 = call float @sqrtf(float %conv14) #2\n  %add16 = fadd float %call.i4, %conv14\n  %mul17 = fmul float %conv14, %add16\n  %conv18 = fpext float %mul17 to double\n  %add19 = fadd double %conv18, 2.113000e+01\n  %conv20 = fptrunc double %add19 to float\n  %call.i5 = call float @sqrtf(float %conv20) #2\n  %add22 = fadd float %call.i5, %conv20\n  %mul23 = fmul float %conv20, %add22\n  %conv24 = fpext float %mul23 to double\n  %add25 = fadd double %conv24, 0x40544851EB851EB8\n  %conv26 = fptrunc double %add25 to float\n  %call.i6 = call float @sqrtf(float %conv26) #2\n  %add28 = fadd float %call.i6, %conv26\n  %mul29 = fmul float %conv26, %add28\n  %conv30 = fpext float %mul29 to double\n  %add31 = fadd double %conv30, 1.113000e+01\n  %conv32 = fptrunc double %add31 to float\n  %call.i7 = call float @sqrtf(float %conv32) #2\n  %add34 = fadd float %call.i7, %conv32\n  %mul35 = fmul float %conv32, %add34\n  %conv36 = fpext float %mul35 to double\n  %add37 = fadd double %conv36, 0x40544851EB851EB8\n  %conv38 = fptrunc double %add37 to float\n  %call.i8 = call float @sqrtf(float %conv38) #2\n  %add40 = fadd float %call.i8, %conv38\n  %mul41 = fmul float %conv38, %add40\n  %conv42 = fpext float %mul41 to double\n  %add43 = fadd double %conv42, 1.113000e+01\n  %conv44 = fptrunc double %add43 to float\n  %call.i9 = call float @sqrtf(float %conv44) #2\n  %add46 = fadd float %call.i9, %conv44\n  %mul47 = fmul float %conv44, %add46\n  %conv48 = fpext float %mul47 to double\n  %add49 = fadd double %conv48, 0x4056C851EB851EB8\n  %conv50 = fptrunc double %add49 to float\n  %call.i10 = call float @sqrtf(float %conv50) #2\n  %add52 = fadd float %call.i10, %conv50\n  %mul53 = fmul float %conv50, %add52\n  %conv54 = fpext float %mul53 to double\n  %add55 = fadd double %conv54, 1.113000e+01\n  %conv56 = fptrunc double %add55 to float\n  %div = fdiv float %conv56, 1.000000e+04\n  %0 = load volatile float, float* %checksum, align 4\n  %add57 = fadd float %0, %div\n  store volatile float %add57, float* %checksum, align 4\n  %call.i.1 = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add.1 = fadd float %call.i.1, 0x3FBCC2A460000000\n  %mul.1 = fmul float 0x3FBCC2A460000000, %add.1\n  %conv.1 = fpext float %mul.1 to double\n  %add1.1 = fadd double %conv.1, 1.130000e+00\n  %conv2.1 = fptrunc double %add1.1 to float\n  %call.i2.1 = call float @sqrtf(float %conv2.1) #2\n  %add4.1 = fadd float %call.i2.1, %conv2.1\n  %mul5.1 = fmul float %conv2.1, %add4.1\n  %conv6.1 = fpext float %mul5.1 to double\n  %add7.1 = fadd double %conv6.1, 1.716000e+01\n  %conv8.1 = fptrunc double %add7.1 to float\n  %call.i3.1 = call float @sqrtf(float %conv8.1) #2\n  %add10.1 = fadd float %call.i3.1, %conv8.1\n  %mul11.1 = fmul float %conv8.1, %add10.1\n  %conv12.1 = fpext float %mul11.1 to double\n  %add13.1 = fadd double %conv12.1, 1.513000e+01\n  %conv14.1 = fptrunc double %add13.1 to float\n  %call.i4.1 = call float @sqrtf(float %conv14.1) #2\n  %add16.1 = fadd float %call.i4.1, %conv14.1\n  %mul17.1 = fmul float %conv14.1, %add16.1\n  %conv18.1 = fpext float %mul17.1 to double\n  %add19.1 = fadd double %conv18.1, 2.113000e+01\n  %conv20.1 = fptrunc double %add19.1 to float\n  %call.i5.1 = call float @sqrtf(float %conv20.1) #2\n  %add22.1 = fadd float %call.i5.1, %conv20.1\n  %mul23.1 = fmul float %conv20.1, %add22.1\n  %conv24.1 = fpext float %mul23.1 to double\n  %add25.1 = fadd double %conv24.1, 0x40544851EB851EB8\n  %conv26.1 = fptrunc double %add25.1 to float\n  %call.i6.1 = call float @sqrtf(float %conv26.1) #2\n  %add28.1 = fadd float %call.i6.1, %conv26.1\n  %mul29.1 = fmul float %conv26.1, %add28.1\n  %conv30.1 = fpext float %mul29.1 to double\n  %add31.1 = fadd double %conv30.1, 1.113000e+01\n  %conv32.1 = fptrunc double %add31.1 to float\n  %call.i7.1 = call float @sqrtf(float %conv32.1) #2\n  %add34.1 = fadd float %call.i7.1, %conv32.1\n  %mul35.1 = fmul float %conv32.1, %add34.1\n  %conv36.1 = fpext float %mul35.1 to double\n  %add37.1 = fadd double %conv36.1, 0x40544851EB851EB8\n  %conv38.1 = fptrunc double %add37.1 to float\n  %call.i8.1 = call float @sqrtf(float %conv38.1) #2\n  %add40.1 = fadd float %call.i8.1, %conv38.1\n  %mul41.1 = fmul float %conv38.1, %add40.1\n  %conv42.1 = fpext float %mul41.1 to double\n  %add43.1 = fadd double %conv42.1, 1.113000e+01\n  %conv44.1 = fptrunc double %add43.1 to float\n  %call.i9.1 = call float @sqrtf(float %conv44.1) #2\n  %add46.1 = fadd float %call.i9.1, %conv44.1\n  %mul47.1 = fmul float %conv44.1, %add46.1\n  %conv48.1 = fpext float %mul47.1 to double\n  %add49.1 = fadd double %conv48.1, 0x4056C851EB851EB8\n  %conv50.1 = fptrunc double %add49.1 to float\n  %call.i10.1 = call float @sqrtf(float %conv50.1) #2\n  %add52.1 = fadd float %call.i10.1, %conv50.1\n  %mul53.1 = fmul float %conv50.1, %add52.1\n  %conv54.1 = fpext float %mul53.1 to double\n  %add55.1 = fadd double %conv54.1, 1.113000e+01\n  %conv56.1 = fptrunc double %add55.1 to float\n  %div.1 = fdiv float %conv56.1, 1.000000e+04\n  %1 = load volatile float, float* %checksum, align 4\n  %add57.1 = fadd float %1, %div.1\n  store volatile float %add57.1, float* %checksum, align 4\n  %call.i.2 = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add.2 = fadd float %call.i.2, 0x3FBCC2A460000000\n  %mul.2 = fmul float 0x3FBCC2A460000000, %add.2\n  %conv.2 = fpext float %mul.2 to double\n  %add1.2 = fadd double %conv.2, 1.130000e+00\n  %conv2.2 = fptrunc double %add1.2 to float\n  %call.i2.2 = call float @sqrtf(float %conv2.2) #2\n  %add4.2 = fadd float %call.i2.2, %conv2.2\n  %mul5.2 = fmul float %conv2.2, %add4.2\n  %conv6.2 = fpext float %mul5.2 to double\n  %add7.2 = fadd double %conv6.2, 1.716000e+01\n  %conv8.2 = fptrunc double %add7.2 to float\n  %call.i3.2 = call float @sqrtf(float %conv8.2) #2\n  %add10.2 = fadd float %call.i3.2, %conv8.2\n  %mul11.2 = fmul float %conv8.2, %add10.2\n  %conv12.2 = fpext float %mul11.2 to double\n  %add13.2 = fadd double %conv12.2, 1.513000e+01\n  %conv14.2 = fptrunc double %add13.2 to float\n  %call.i4.2 = call float @sqrtf(float %conv14.2) #2\n  %add16.2 = fadd float %call.i4.2, %conv14.2\n  %mul17.2 = fmul float %conv14.2, %add16.2\n  %conv18.2 = fpext float %mul17.2 to double\n  %add19.2 = fadd double %conv18.2, 2.113000e+01\n  %conv20.2 = fptrunc double %add19.2 to float\n  %call.i5.2 = call float @sqrtf(float %conv20.2) #2\n  %add22.2 = fadd float %call.i5.2, %conv20.2\n  %mul23.2 = fmul float %conv20.2, %add22.2\n  %conv24.2 = fpext float %mul23.2 to double\n  %add25.2 = fadd double %conv24.2, 0x40544851EB851EB8\n  %conv26.2 = fptrunc double %add25.2 to float\n  %call.i6.2 = call float @sqrtf(float %conv26.2) #2\n  %add28.2 = fadd float %call.i6.2, %conv26.2\n  %mul29.2 = fmul float %conv26.2, %add28.2\n  %conv30.2 = fpext float %mul29.2 to double\n  %add31.2 = fadd double %conv30.2, 1.113000e+01\n  %conv32.2 = fptrunc double %add31.2 to float\n  %call.i7.2 = call float @sqrtf(float %conv32.2) #2\n  %add34.2 = fadd float %call.i7.2, %conv32.2\n  %mul35.2 = fmul float %conv32.2, %add34.2\n  %conv36.2 = fpext float %mul35.2 to double\n  %add37.2 = fadd double %conv36.2, 0x40544851EB851EB8\n  %conv38.2 = fptrunc double %add37.2 to float\n  %call.i8.2 = call float @sqrtf(float %conv38.2) #2\n  %add40.2 = fadd float %call.i8.2, %conv38.2\n  %mul41.2 = fmul float %conv38.2, %add40.2\n  %conv42.2 = fpext float %mul41.2 to double\n  %add43.2 = fadd double %conv42.2, 1.113000e+01\n  %conv44.2 = fptrunc double %add43.2 to float\n  %call.i9.2 = call float @sqrtf(float %conv44.2) #2\n  %add46.2 = fadd float %call.i9.2, %conv44.2\n  %mul47.2 = fmul float %conv44.2, %add46.2\n  %conv48.2 = fpext float %mul47.2 to double\n  %add49.2 = fadd double %conv48.2, 0x4056C851EB851EB8\n  %conv50.2 = fptrunc double %add49.2 to float\n  %call.i10.2 = call float @sqrtf(float %conv50.2) #2\n  %add52.2 = fadd float %call.i10.2, %conv50.2\n  %mul53.2 = fmul float %conv50.2, %add52.2\n  %conv54.2 = fpext float %mul53.2 to double\n  %add55.2 = fadd double %conv54.2, 1.113000e+01\n  %conv56.2 = fptrunc double %add55.2 to float\n  %div.2 = fdiv float %conv56.2, 1.000000e+04\n  %2 = load volatile float, float* %checksum, align 4\n  %add57.2 = fadd float %2, %div.2\n  store volatile float %add57.2, float* %checksum, align 4\n  %call.i.3 = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add.3 = fadd float %call.i.3, 0x3FBCC2A460000000\n  %mul.3 = fmul float 0x3FBCC2A460000000, %add.3\n  %conv.3 = fpext float %mul.3 to double\n  %add1.3 = fadd double %conv.3, 1.130000e+00\n  %conv2.3 = fptrunc double %add1.3 to float\n  %call.i2.3 = call float @sqrtf(float %conv2.3) #2\n  %add4.3 = fadd float %call.i2.3, %conv2.3\n  %mul5.3 = fmul float %conv2.3, %add4.3\n  %conv6.3 = fpext float %mul5.3 to double\n  %add7.3 = fadd double %conv6.3, 1.716000e+01\n  %conv8.3 = fptrunc double %add7.3 to float\n  %call.i3.3 = call float @sqrtf(float %conv8.3) #2\n  %add10.3 = fadd float %call.i3.3, %conv8.3\n  %mul11.3 = fmul float %conv8.3, %add10.3\n  %conv12.3 = fpext float %mul11.3 to double\n  %add13.3 = fadd double %conv12.3, 1.513000e+01\n  %conv14.3 = fptrunc double %add13.3 to float\n  %call.i4.3 = call float @sqrtf(float %conv14.3) #2\n  %add16.3 = fadd float %call.i4.3, %conv14.3\n  %mul17.3 = fmul float %conv14.3, %add16.3\n  %conv18.3 = fpext float %mul17.3 to double\n  %add19.3 = fadd double %conv18.3, 2.113000e+01\n  %conv20.3 = fptrunc double %add19.3 to float\n  %call.i5.3 = call float @sqrtf(float %conv20.3) #2\n  %add22.3 = fadd float %call.i5.3, %conv20.3\n  %mul23.3 = fmul float %conv20.3, %add22.3\n  %conv24.3 = fpext float %mul23.3 to double\n  %add25.3 = fadd double %conv24.3, 0x40544851EB851EB8\n  %conv26.3 = fptrunc double %add25.3 to float\n  %call.i6.3 = call float @sqrtf(float %conv26.3) #2\n  %add28.3 = fadd float %call.i6.3, %conv26.3\n  %mul29.3 = fmul float %conv26.3, %add28.3\n  %conv30.3 = fpext float %mul29.3 to double\n  %add31.3 = fadd double %conv30.3, 1.113000e+01\n  %conv32.3 = fptrunc double %add31.3 to float\n  %call.i7.3 = call float @sqrtf(float %conv32.3) #2\n  %add34.3 = fadd float %call.i7.3, %conv32.3\n  %mul35.3 = fmul float %conv32.3, %add34.3\n  %conv36.3 = fpext float %mul35.3 to double\n  %add37.3 = fadd double %conv36.3, 0x40544851EB851EB8\n  %conv38.3 = fptrunc double %add37.3 to float\n  %call.i8.3 = call float @sqrtf(float %conv38.3) #2\n  %add40.3 = fadd float %call.i8.3, %conv38.3\n  %mul41.3 = fmul float %conv38.3, %add40.3\n  %conv42.3 = fpext float %mul41.3 to double\n  %add43.3 = fadd double %conv42.3, 1.113000e+01\n  %conv44.3 = fptrunc double %add43.3 to float\n  %call.i9.3 = call float @sqrtf(float %conv44.3) #2\n  %add46.3 = fadd float %call.i9.3, %conv44.3\n  %mul47.3 = fmul float %conv44.3, %add46.3\n  %conv48.3 = fpext float %mul47.3 to double\n  %add49.3 = fadd double %conv48.3, 0x4056C851EB851EB8\n  %conv50.3 = fptrunc double %add49.3 to float\n  %call.i10.3 = call float @sqrtf(float %conv50.3) #2\n  %add52.3 = fadd float %call.i10.3, %conv50.3\n  %mul53.3 = fmul float %conv50.3, %add52.3\n  %conv54.3 = fpext float %mul53.3 to double\n  %add55.3 = fadd double %conv54.3, 1.113000e+01\n  %conv56.3 = fptrunc double %add55.3 to float\n  %div.3 = fdiv float %conv56.3, 1.000000e+04\n  %3 = load volatile float, float* %checksum, align 4\n  %add57.3 = fadd float %3, %div.3\n  store volatile float %add57.3, float* %checksum, align 4\n  %call.i.4 = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add.4 = fadd float %call.i.4, 0x3FBCC2A460000000\n  %mul.4 = fmul float 0x3FBCC2A460000000, %add.4\n  %conv.4 = fpext float %mul.4 to double\n  %add1.4 = fadd double %conv.4, 1.130000e+00\n  %conv2.4 = fptrunc double %add1.4 to float\n  %call.i2.4 = call float @sqrtf(float %conv2.4) #2\n  %add4.4 = fadd float %call.i2.4, %conv2.4\n  %mul5.4 = fmul float %conv2.4, %add4.4\n  %conv6.4 = fpext float %mul5.4 to double\n  %add7.4 = fadd double %conv6.4, 1.716000e+01\n  %conv8.4 = fptrunc double %add7.4 to float\n  %call.i3.4 = call float @sqrtf(float %conv8.4) #2\n  %add10.4 = fadd float %call.i3.4, %conv8.4\n  %mul11.4 = fmul float %conv8.4, %add10.4\n  %conv12.4 = fpext float %mul11.4 to double\n  %add13.4 = fadd double %conv12.4, 1.513000e+01\n  %conv14.4 = fptrunc double %add13.4 to float\n  %call.i4.4 = call float @sqrtf(float %conv14.4) #2\n  %add16.4 = fadd float %call.i4.4, %conv14.4\n  %mul17.4 = fmul float %conv14.4, %add16.4\n  %conv18.4 = fpext float %mul17.4 to double\n  %add19.4 = fadd double %conv18.4, 2.113000e+01\n  %conv20.4 = fptrunc double %add19.4 to float\n  %call.i5.4 = call float @sqrtf(float %conv20.4) #2\n  %add22.4 = fadd float %call.i5.4, %conv20.4\n  %mul23.4 = fmul float %conv20.4, %add22.4\n  %conv24.4 = fpext float %mul23.4 to double\n  %add25.4 = fadd double %conv24.4, 0x40544851EB851EB8\n  %conv26.4 = fptrunc double %add25.4 to float\n  %call.i6.4 = call float @sqrtf(float %conv26.4) #2\n  %add28.4 = fadd float %call.i6.4, %conv26.4\n  %mul29.4 = fmul float %conv26.4, %add28.4\n  %conv30.4 = fpext float %mul29.4 to double\n  %add31.4 = fadd double %conv30.4, 1.113000e+01\n  %conv32.4 = fptrunc double %add31.4 to float\n  %call.i7.4 = call float @sqrtf(float %conv32.4) #2\n  %add34.4 = fadd float %call.i7.4, %conv32.4\n  %mul35.4 = fmul float %conv32.4, %add34.4\n  %conv36.4 = fpext float %mul35.4 to double\n  %add37.4 = fadd double %conv36.4, 0x40544851EB851EB8\n  %conv38.4 = fptrunc double %add37.4 to float\n  %call.i8.4 = call float @sqrtf(float %conv38.4) #2\n  %add40.4 = fadd float %call.i8.4, %conv38.4\n  %mul41.4 = fmul float %conv38.4, %add40.4\n  %conv42.4 = fpext float %mul41.4 to double\n  %add43.4 = fadd double %conv42.4, 1.113000e+01\n  %conv44.4 = fptrunc double %add43.4 to float\n  %call.i9.4 = call float @sqrtf(float %conv44.4) #2\n  %add46.4 = fadd float %call.i9.4, %conv44.4\n  %mul47.4 = fmul float %conv44.4, %add46.4\n  %conv48.4 = fpext float %mul47.4 to double\n  %add49.4 = fadd double %conv48.4, 0x4056C851EB851EB8\n  %conv50.4 = fptrunc double %add49.4 to float\n  %call.i10.4 = call float @sqrtf(float %conv50.4) #2\n  %add52.4 = fadd float %call.i10.4, %conv50.4\n  %mul53.4 = fmul float %conv50.4, %add52.4\n  %conv54.4 = fpext float %mul53.4 to double\n  %add55.4 = fadd double %conv54.4, 1.113000e+01\n  %conv56.4 = fptrunc double %add55.4 to float\n  %div.4 = fdiv float %conv56.4, 1.000000e+04\n  %4 = load volatile float, float* %checksum, align 4\n  %add57.4 = fadd float %4, %div.4\n  store volatile float %add57.4, float* %checksum, align 4\n  %call.i.5 = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add.5 = fadd float %call.i.5, 0x3FBCC2A460000000\n  %mul.5 = fmul float 0x3FBCC2A460000000, %add.5\n  %conv.5 = fpext float %mul.5 to double\n  %add1.5 = fadd double %conv.5, 1.130000e+00\n  %conv2.5 = fptrunc double %add1.5 to float\n  %call.i2.5 = call float @sqrtf(float %conv2.5) #2\n  %add4.5 = fadd float %call.i2.5, %conv2.5\n  %mul5.5 = fmul float %conv2.5, %add4.5\n  %conv6.5 = fpext float %mul5.5 to double\n  %add7.5 = fadd double %conv6.5, 1.716000e+01\n  %conv8.5 = fptrunc double %add7.5 to float\n  %call.i3.5 = call float @sqrtf(float %conv8.5) #2\n  %add10.5 = fadd float %call.i3.5, %conv8.5\n  %mul11.5 = fmul float %conv8.5, %add10.5\n  %conv12.5 = fpext float %mul11.5 to double\n  %add13.5 = fadd double %conv12.5, 1.513000e+01\n  %conv14.5 = fptrunc double %add13.5 to float\n  %call.i4.5 = call float @sqrtf(float %conv14.5) #2\n  %add16.5 = fadd float %call.i4.5, %conv14.5\n  %mul17.5 = fmul float %conv14.5, %add16.5\n  %conv18.5 = fpext float %mul17.5 to double\n  %add19.5 = fadd double %conv18.5, 2.113000e+01\n  %conv20.5 = fptrunc double %add19.5 to float\n  %call.i5.5 = call float @sqrtf(float %conv20.5) #2\n  %add22.5 = fadd float %call.i5.5, %conv20.5\n  %mul23.5 = fmul float %conv20.5, %add22.5\n  %conv24.5 = fpext float %mul23.5 to double\n  %add25.5 = fadd double %conv24.5, 0x40544851EB851EB8\n  %conv26.5 = fptrunc double %add25.5 to float\n  %call.i6.5 = call float @sqrtf(float %conv26.5) #2\n  %add28.5 = fadd float %call.i6.5, %conv26.5\n  %mul29.5 = fmul float %conv26.5, %add28.5\n  %conv30.5 = fpext float %mul29.5 to double\n  %add31.5 = fadd double %conv30.5, 1.113000e+01\n  %conv32.5 = fptrunc double %add31.5 to float\n  %call.i7.5 = call float @sqrtf(float %conv32.5) #2\n  %add34.5 = fadd float %call.i7.5, %conv32.5\n  %mul35.5 = fmul float %conv32.5, %add34.5\n  %conv36.5 = fpext float %mul35.5 to double\n  %add37.5 = fadd double %conv36.5, 0x40544851EB851EB8\n  %conv38.5 = fptrunc double %add37.5 to float\n  %call.i8.5 = call float @sqrtf(float %conv38.5) #2\n  %add40.5 = fadd float %call.i8.5, %conv38.5\n  %mul41.5 = fmul float %conv38.5, %add40.5\n  %conv42.5 = fpext float %mul41.5 to double\n  %add43.5 = fadd double %conv42.5, 1.113000e+01\n  %conv44.5 = fptrunc double %add43.5 to float\n  %call.i9.5 = call float @sqrtf(float %conv44.5) #2\n  %add46.5 = fadd float %call.i9.5, %conv44.5\n  %mul47.5 = fmul float %conv44.5, %add46.5\n  %conv48.5 = fpext float %mul47.5 to double\n  %add49.5 = fadd double %conv48.5, 0x4056C851EB851EB8\n  %conv50.5 = fptrunc double %add49.5 to float\n  %call.i10.5 = call float @sqrtf(float %conv50.5) #2\n  %add52.5 = fadd float %call.i10.5, %conv50.5\n  %mul53.5 = fmul float %conv50.5, %add52.5\n  %conv54.5 = fpext float %mul53.5 to double\n  %add55.5 = fadd double %conv54.5, 1.113000e+01\n  %conv56.5 = fptrunc double %add55.5 to float\n  %div.5 = fdiv float %conv56.5, 1.000000e+04\n  %5 = load volatile float, float* %checksum, align 4\n  %add57.5 = fadd float %5, %div.5\n  store volatile float %add57.5, float* %checksum, align 4\n  %call.i.6 = call float @sqrtf(float 0x3FBCC2A460000000) #2\n  %add.6 = fadd float %call.i.6, 0x3FBCC2A460000000\n  %mul.6 = fmul float 0x3FBCC2A460000000, %add.6\n  %conv.6 = fpext float %mul.6 to double\n  %add1.6 = fadd double %conv.6, 1.130000e+00\n  %conv2.6 = fptrunc double %add1.6 to float\n  %call.i2.6 = call float @sqrtf(float %conv2.6) #2\n  %add4.6 = fadd float %call.i2.6, %conv2.6\n  %mul5.6 = fmul float %conv2.6, %add4.6\n  %conv6.6 = fpext float %mul5.6 to double\n  %add7.6 = fadd double %conv6.6, 1.716000e+01\n  %conv8.6 = fptrunc double %add7.6 to float\n  %call.i3.6 = call float @sqrtf(float %conv8.6) #2\n  %add10.6 = fadd float %call.i3.6, %conv8.6\n  %mul11.6 = fmul float %conv8.6, %add10.6\n  %conv12.6 = fpext float %mul11.6 to double\n  %add13.6 = fadd double %conv12.6, 1.513000e+01\n  %conv14.6 = fptrunc double %add13.6 to float\n  %call.i4.6 = call float @sqrtf(float %conv14.6) #2\n  %add16.6 = fadd float %call.i4.6, %conv14.6\n  %mul17.6 = fmul float %conv14.6, %add16.6\n  %conv18.6 = fpext float %mul17.6 to double\n  %add19.6 = fadd double %conv18.6, 2.113000e+01\n  %conv20.6 = fptrunc double %add19.6 to float\n  %call.i5.6 = call float @sqrtf(float %conv20.6) #2\n  %add22.6 = fadd float %call.i5.6, %conv20.6\n  %mul23.6 = fmul float %conv20.6, %add22.6\n  %conv24.6 = fpext float %mul23.6 to double\n  %add25.6 = fadd double %conv24.6, 0x40544851EB851EB8\n  %conv26.6 = fptrunc double %add25.6 to float\n  %call.i6.6 = call float @sqrtf(float %conv26.6) #2\n  %add28.6 = fadd float %call.i6.6, %conv26.6\n  %mul29.6 = fmul float %conv26.6, %add28.6\n  %conv30.6 = fpext float %mul29.6 to double\n  %add31.6 = fadd double %conv30.6, 1.113000e+01\n  %conv32.6 = fptrunc double %add31.6 to float\n  %call.i7.6 = call float @sqrtf(float %conv32.6) #2\n  %add34.6 = fadd float %call.i7.6, %conv32.6\n  %mul35.6 = fmul float %conv32.6, %add34.6\n  %conv36.6 = fpext float %mul35.6 to double\n  %add37.6 = fadd double %conv36.6, 0x40544851EB851EB8\n  %conv38.6 = fptrunc double %add37.6 to float\n  %call.i8.6 = call float @sqrtf(float %conv38.6) #2\n  %add40.6 = fadd float %call.i8.6, %conv38.6\n  %mul41.6 = fmul float %conv38.6, %add40.6\n  %conv42.6 = fpext float %mul41.6 to double\n  %add43.6 = fadd double %conv42.6, 1.113000e+01\n  %conv44.6 = fptrunc double %add43.6 to float\n  %call.i9.6 = call float @sqrtf(float %conv44.6) #2\n  %add46.6 = fadd float %call.i9.6, %conv44.6\n  %mul47.6 = fmul float %conv44.6, %add46.6\n  %conv48.6 = fpext float %mul47.6 to double\n  %add49.6 = fadd double %conv48.6, 0x4056C851EB851EB8\n  %conv50.6 = fptrunc double %add49.6 to float\n  %call.i10.6 = call float @sqrtf(float %conv50.6) #2\n  %add52.6 = fadd float %call.i10.6, %conv50.6\n  %mul53.6 = fmul float %conv50.6, %add52.6\n  %conv54.6 = fpext float %mul53.6 to double\n  %add55.6 = fadd double %conv54.6, 1.113000e+01\n  %conv56.6 = fptrunc double %add55.6 to float\n  %div.6 = fdiv float %conv56.6, 1.000000e+04\n  %6 = load volatile float, float* %checksum, align 4\n  %add57.6 = fadd float %6, %div.6\n</code></pre>\n\n<p>As you can see, the loop was <em>fully</em> unrolled, despite me specifying an unroll factor of 3. I was hoping someone would have some insight into why this was happening...</p>\n"}, {"tags": ["c++", "function", "class", "vmt"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521070583, "post_id": 49289224, "comment_id": 85581727, "body": "All of this looks pretty UB."}, {"owner": {"reputation": 602, "user_id": 903612, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8f9272524e9087c29bb36d495c599f40?s=128&d=identicon&r=PG", "display_name": "Kracken", "link": "https://stackoverflow.com/users/903612/kracken"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521070757, "post_id": 49289224, "comment_id": 85581777, "body": "@melpomene sorry, what is UB?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1521072431, "post_id": 49289224, "comment_id": 85582246, "body": "UB = undefined behavior"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521072895, "post_id": 49289224, "comment_id": 85582379, "body": "@RemyLebeau Let us never forget Bob, a disciple of the great Guru, who was drawn to Undefined Behavior, and the problems that it created. <a href=\"http://www.gotw.ca/conv/002.htm\" rel=\"nofollow noreferrer\">gotw.ca/conv/002.htm</a>"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1541987441, "post_id": 49289224, "comment_id": 93394727, "body": "What is the end goal of this? Testing? Curiosity? Practical applications?"}], "answers": [{"tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": true, "score": 3, "last_activity_date": 1521072056, "creation_date": 1521072056, "answer_id": 49289491, "question_id": 49289224, "link": "https://stackoverflow.com/questions/49289224/how-to-determine-count-of-vmt-pointers/49289491#49289491", "title": "How to determine count of VMT pointers", "body": "<p>Just don't do this.</p>\n\n<p>Firstly, a class that has no virtual members has no V-table, hence your attempt to fetch it will at best give an invalid pointer and at worst crash.</p>\n\n<p>Secondly, even if you do get it, you'll only find pointers to virtual member functions in it, normal functions aren't placed in the V-table.</p>\n\n<p>Thirdly, while I do note that you're using MSVC, so portability is less of an issue, this is hideously non-portable.  I remember back to a very interesting object oriented system I used for the one game I wrote that published on the Sega Genesis.  This was all done in 68K assembler, back in about 1995, including a V-table.  Due to interesting memory constraints, all V-tables lived miles away from their class instances, in a special area of the first 64K page of memory.  We had some gnarly linker trickery to hook everything up and make it all work.</p>\n\n<p>My point being that your line of code to go and fetch VMT may not wind up pointing at the V-table at all.  The workings of this are implementation dependent, the compiler writer is at liberty to do it any way they want, as long as the end product works correctly according to the standard.</p>\n\n<p>And the final question?  Why?  What problem are you trying to solve that requires digging around like this in places most programmers stay well away from.</p>\n"}], "owner": {"reputation": 602, "user_id": 903612, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8f9272524e9087c29bb36d495c599f40?s=128&d=identicon&r=PG", "display_name": "Kracken", "link": "https://stackoverflow.com/users/903612/kracken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 49289491, "answer_count": 1, "score": 0, "last_activity_date": 1521072056, "creation_date": 1521070232, "last_edit_date": 1521070692, "question_id": 49289224, "link": "https://stackoverflow.com/questions/49289224/how-to-determine-count-of-vmt-pointers", "title": "How to determine count of VMT pointers", "body": "<p>using Visual C++ compiler every class object have <code>VMT</code> ( first pointer in object) which is the pointer to array of pointers to every method in class. Using code like this:</p>\n\n<pre><code>TestObject * object = new TestObject();\nvoid** VMT = (void**)object;\nint TestCount = 100;\n\nfor( int i = 0; i &lt; TestCount; i ++ )\n{\n     printf(\"%d function: %p\\r\\n\", (i+1), VMT[i] );\n}\n</code></pre>\n\n<p>This code enumerates first 100 functions in class, but how can i determine how many those pointers class have considering that i don't have class definition? How to find out it dynamically?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1521070248, "post_id": 49289191, "comment_id": 85581634, "body": "Umm, it means that the compiler expected to find a <code>)</code> at the specified location but didn&#39;t.  Not that hard to understand ;-)"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1521070259, "post_id": 49289191, "comment_id": 85581640, "body": "It means the syntax is invalid. Since there are &quot;an infinite number of ways&quot; to generate such messages - of which the compiler is being quite clear about - such overgeneralized questions are not very useful."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521070294, "post_id": 49289191, "comment_id": 85581647, "body": "Please show the line that generated the error. There are many typos and mistakes can cause this error to appear."}, {"owner": {"reputation": 281, "user_id": 9461367, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/gAYmr.png?s=128&g=1", "display_name": "Werner", "link": "https://stackoverflow.com/users/9461367/werner"}, "edited": false, "score": 0, "creation_date": 1521070298, "post_id": 49289191, "comment_id": 85581650, "body": "Please add testable example code"}, {"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 0, "creation_date": 1521070318, "post_id": 49289191, "comment_id": 85581652, "body": "There are numerous ways to generate this error. Most, if not all of them involve a typographical error."}], "answers": [{"tags": [], "owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "is_accepted": true, "score": 0, "last_activity_date": 1521070078, "creation_date": 1521070078, "answer_id": 49289192, "question_id": 49289191, "link": "https://stackoverflow.com/questions/49289191/what-can-compiler-error-expected-mean/49289192#49289192", "title": "What can compiler error `Expected &#39;)&#39;` mean?", "body": "<p>In my case, it meant that I was missing a comma between parameters in a function call.</p>\n"}], "owner": {"reputation": 1972, "user_id": 3738356, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/e17701b63957cb2224001256ad355f6b?s=128&d=identicon&r=PG&f=1", "display_name": "interestedparty333", "link": "https://stackoverflow.com/users/3738356/interestedparty333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "closed_date": 1521070694, "accepted_answer_id": 49289192, "answer_count": 1, "score": -6, "last_activity_date": 1521070078, "creation_date": 1521070078, "question_id": 49289191, "link": "https://stackoverflow.com/questions/49289191/what-can-compiler-error-expected-mean", "closed_reason": "Needs more focus", "title": "What can compiler error `Expected &#39;)&#39;` mean?", "body": "<p>What can the compiler error <code>Expected ')'</code> mean when generated on a line with a function call?</p>\n"}, {"tags": ["c++", "boost-asio"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1521073518, "post_id": 49289161, "comment_id": 85582518, "body": "There is no such thing as &#39;connect to a UDP server&#39;. The source address and port of each datagram is available in the datagram."}, {"owner": {"reputation": 81, "user_id": 3163902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212309562688385ad3eaa557e645d6b0?s=128&d=identicon&r=PG&f=1", "display_name": "cqwrteur", "link": "https://stackoverflow.com/users/3163902/cqwrteur"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1521073832, "post_id": 49289161, "comment_id": 85582583, "body": "ok. How can i get hostname of an ip address?"}], "owner": {"reputation": 81, "user_id": 3163902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212309562688385ad3eaa557e645d6b0?s=128&d=identicon&r=PG&f=1", "display_name": "cqwrteur", "link": "https://stackoverflow.com/users/3163902/cqwrteur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1521152609, "answer_count": 0, "score": 0, "last_activity_date": 1521069898, "creation_date": 1521069898, "question_id": 49289161, "link": "https://stackoverflow.com/questions/49289161/how-to-get-hostname-of-clients-connect-to-async-udp-server-by-asio-library", "closed_reason": "Duplicate", "title": "How to get hostname of clients connect to async UDP server by asio library?", "body": "<p>I am writing an async UDP server by using asio library. I want to get the hostnames of those UDP clients which connect to my server. How could I do this? Also, is it possible to get the hostname of UDP client without reverse-DNS resolving it just like java library guava inetaddress?</p>\n\n<pre><code>class udp_server\n{\nasio::ip::udp::socket socket;\nasio::ip::udp::endpoint remote_endpoint;\nstd::array&lt;std::uint8_t,16384&gt; buffer;\nsqlite::sqlite db;\nvoid start()\n{\n    socket.async_receive_from(asio::buffer(buffer),remote_endpoint,[this](const std::error_code&amp; error,std::size_t bytes)\n    {\n        start();\n    });\n}\npublic:\nudp_server(asio::io_service&amp; io_service,unsigned long port,const char* dbpath):socket(io_service,asio::ip::udp::endpoint(asio::ip::udp::v4(),port)),db(dbpath)\n{\n    start();\n}\n};\n</code></pre>\n\n<p>How can I get hostname of this remote_endpoint? Thank you! \nSorry for my poor English.</p>\n"}, {"tags": ["c++", "zeromq", "python-3.6", "communication", "asyncsocket"], "answers": [{"comments": [{"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1521664564, "post_id": 49411410, "comment_id": 85833895, "body": "Great samples patterns. Initially, I am interested in send messages one client to many clients (TO clients connected in an instant time). According to the samples, the important here is make some communication type between <code>ROUTER</code> and <code>PUBLISHER</code> on the server side ... really? This may be implemented performing some <code>zmq.POLLIN</code> in together (<code>ROUTER</code> and <code>PUBLISHER</code>) sockets?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 1, "creation_date": 1521673724, "post_id": 49411410, "comment_id": 85837677, "body": "@bgarcial You can leave out the <code>ROUTER</code>--<code>DEALER</code> part if you only want to send messages from any client to all clients. See the example in my updated answer."}, {"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1521696875, "post_id": 49411410, "comment_id": 85843404, "body": "Ralf, the approach is correct. How to can I think here in scalability/redundancy of my server? Threads, async?  I&#39;ve coded the <a href=\"https://github.com/bgarcial/pub_pull-sub_push/blob/master/client1.cpp\" title=\"C++ SUB - PUB client version\" rel=\"nofollow noreferrer\">C++ SUB - PUB client version</a>, and works, although I unknown if this is well built or may be optimized in code can you check it please? Just in case .."}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 1, "creation_date": 1521711386, "post_id": 49411410, "comment_id": 85851061, "body": "@bgarcial What redundancy requirements do you have? I suggest to carefully read the relevant sections in The Guide (chapters 4 and 5) which details how to match different requirements with appropriate solutions. As for scalability I would suggest to do some load tests first. I would expect that the limiting factor will be the network connection. I see no obvious problems with your code. I guess the main challenge will be the interleaving of listening to the <code>SUB</code> socket and doing &#39;real work&#39; that might result in sending via the <code>PUSH</code> socket."}, {"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1521752755, "post_id": 49411410, "comment_id": 85878906, "body": "Ralf, Let me please make other question: In this architecture, I have python clients and c++ clients. The server is Python. The question is: Why on my python clients the message appears faster than my c++ clients? This is related with the server is coded in Python?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1521759987, "post_id": 49411410, "comment_id": 85881670, "body": "@bgarcial That is unexpected. I think it would be best if you reduce it to a minimal example (only the PUB-SUB part?) and post that as a separate question."}, {"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1521768527, "post_id": 49411410, "comment_id": 85883983, "body": "I&#39;ve published as a separate question, <a href=\"https://stackoverflow.com/questions/49439387/pub-pull-messaging-broker-improve-the-messaging\" title=\"pub pull messaging broker improve the messaging\">stackoverflow.com/questions/49439387/&hellip;</a> just in case. Thanks. :)"}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "reply_to_user": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1521785083, "post_id": 49411410, "comment_id": 85888270, "body": "@bgarcial With all due respect to author, the <b>proposed solution does not meet the specifications of the O/P definition</b>. The code violates the requirement to deliver any message from agent-[A] to all other agents ( [B], [C], ... ), but not agent-[A] itself, by the [Server]-entity. <b>This explicit requirement was not met in the above submitted proposal</b>."}, {"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "reply_to_user": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1521814840, "post_id": 49411410, "comment_id": 85906009, "body": "@user3666197 In this sense will be the better to deal with the transport of all ID&#39;s of each client that send data to server and that each client can filter out messages with their own ID, this was mentioned by Ralf too ..."}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "reply_to_user": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 1, "creation_date": 1521830062, "post_id": 49411410, "comment_id": 85915526, "body": "@bgarcial Negative, Sir, there is better approach, that principally avoids this duty from being delegated back onto the sending-client and that avoids all overheads with sending data that is not intended to be delivered / consumed on the sending-client, which the proposed approach principally did not solve"}, {"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "reply_to_user": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1521840625, "post_id": 49411410, "comment_id": 85920008, "body": "@user3666197 Can you tell us about that approach? .... I was thinking according to the recommendations in this answer that it is also possible to think that the server is the one that filters the sending of messages and sends them only to all the connected clients different from the sender?"}], "tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": true, "score": 3, "last_activity_date": 1521673608, "last_edit_date": 1521673608, "creation_date": 1521648766, "answer_id": 49411410, "question_id": 49289072, "link": "https://stackoverflow.com/questions/49289072/zmq-dealer-router-communication/49411410#49411410", "title": "ZMQ DEALER - ROUTER Communication", "body": "<p>You could have all clients send a \"I am here\" message at start-up. The central server could then store all the IDs, c.f. the initial communication between worker and router in here: <a href=\"http://zguide.zeromq.org/page:all#A-Load-Balancing-Message-Broker\" rel=\"nofollow noreferrer\">http://zguide.zeromq.org/page:all#A-Load-Balancing-Message-Broker</a>. The server would send out any received message to all currently known clients. You should add some heart beating in order to detect disconnected clients, c.f. <a href=\"http://zguide.zeromq.org/page:all#Heartbeating\" rel=\"nofollow noreferrer\">http://zguide.zeromq.org/page:all#Heartbeating</a>.</p>\n\n<p>However, ZeroMQ already comes with such a communication pattern: <code>PUB</code>\u2014<code>SUB</code>. In essence every client would have a  <code>DEALER</code> and a <code>SUB</code> socket connected to the servers <code>ROUTER</code> and <code>PUB</code> sockets. The server simply sends out any received \nmessage via the <code>PUB</code> socket to <em>all</em> clients. If this would be a problem for the originating client, you can include the client ID in the message so that each client can filter out messages with their own ID. See also this example from the guide \n<a href=\"http://zguide.zeromq.org/page:all#Getting-an-Out-of-Band-Snapshot\" rel=\"nofollow noreferrer\">http://zguide.zeromq.org/page:all#Getting-an-Out-of-Band-Snapshot</a></p>\n\n<p>Another interesting pattern would be <a href=\"http://zguide.zeromq.org/page:all#toc123\" rel=\"nofollow noreferrer\">Republishing Updates from Clients</a>: </p>\n\n<p><a href=\"https://i.stack.imgur.com/OImNA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OImNA.png\" alt=\"Republishing Updates from Clients\"></a></p>\n\n<p>Here <code>PUSH</code>--<code>PULL</code> is used to send the updates to the server. This makes sense if there is no need for a reply message from the server. If you do not need the state request from that example, you can leave out the <code>ROUTER</code>--<code>DEALER</code> part. Here a sample implementation using Python for brevity. The server listens to the <code>PULL</code> socket and sends out everything via the <code>PUB</code> socket:</p>\n\n<pre><code>import zmq\n\ndef main():\n    # context and sockets\n    ctx = zmq.Context()\n    publisher = ctx.socket(zmq.PUB)\n    publisher.bind(\"tcp://*:5557\")\n    collector = ctx.socket(zmq.PULL)\n    collector.bind(\"tcp://*:5558\")\n\n    while True:\n        message = collector.recv()\n        print \"I: publishing update %s\" % message\n        publisher.send(message)\n\nif __name__ == '__main__':\n    main()\n</code></pre>\n\n<p>The client listens to the <code>PUB</code> socket for some time. If a message is received it is logged. If the timeout is reached, a message is generated with a 1 in 10 chance:</p>\n\n<pre><code>import random\nimport time\n\nimport zmq\n\ndef main():\n\n    # Prepare our context and subscriber\n    ctx = zmq.Context()\n    subscriber = ctx.socket(zmq.SUB)\n    subscriber.setsockopt(zmq.SUBSCRIBE, '')\n    subscriber.connect(\"tcp://localhost:5557\")\n    publisher = ctx.socket(zmq.PUSH)\n    publisher.connect(\"tcp://localhost:5558\")\n\n    random.seed(time.time())\n    while True:\n        if subscriber.poll(100) &amp; zmq.POLLIN:\n            message = subscriber.recv()\n            print \"I: received message %s\" % message\n        else:\n            rand = random.randint(1, 100)\n            if rand &lt; 10:\n                publisher.send(\"%d\" % rand)\n                print \"I: sending message %d\" % rand\n\nif __name__ == '__main__':\n    main()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 0, "creation_date": 1523029262, "post_id": 49462767, "comment_id": 86405614, "body": "In the pull section, in the server side, we should create a <code>PULL</code> socket instead of <code>PUSH</code> really? You type .. <code>aPULL = aCTX.socket( zmq.PUSH )</code>  In that consist, the <code>notSoftFLAG</code> and the <code>aReasonToFlagLoopEXIT</code> is some mechanism to mark the identities client?"}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "reply_to_user": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "edited": false, "score": 1, "creation_date": 1523031762, "post_id": 49462767, "comment_id": 86407157, "body": "Right, PULL was obvious. The logical flags have nothing to do with identities, but form additional potential loop-break mechanics."}], "tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": false, "score": 3, "last_activity_date": 1523031695, "last_edit_date": 1523031695, "creation_date": 1521880459, "answer_id": 49462767, "question_id": 49289072, "link": "https://stackoverflow.com/questions/49289072/zmq-dealer-router-communication/49462767#49462767", "title": "ZMQ DEALER - ROUTER Communication", "body": "<h2>The <em>( prematurely )</em> awarded answer does not meet defined properties.</h2>\n\n<p>Distributed systems need to operate both <strong>smart</strong> and <strong>efficiently</strong>, as the agents are distributed and both error-analyses and deployed production-issues are extremely expensive to analyse / test / debug.</p>\n\n<p>Thus a copy/paste re-use of a problem-incompatible idea is not a way to achieve either the former, the less the latter.</p>\n\n<hr>\n\n<h2>So, let's review the efficiency first:</h2>\n\n<p>client-<strong><code>[A].send()</code></strong>-s a message, that O/P wanted to become server-side-<strong><code>[S].recv()</code></strong>-ed and <strong>re-broadcast to all <em>other</em> clients-</strong><code>[B,C,...]</code>, except the <code>[A]</code>-itself.</p>\n\n<p>The most resources-efficient approach to this is to properly configure the infrastructure tools for doing exactly this, without re-inventing wheel and/or using a fragile and performance-devastating scaffolding code(s).</p>\n\n<p>So:</p>\n\n<p>on the client-<code>[*]</code> side best use the below sketched primitive agent-concept. More complex setups, like using as clever event-handling facilities as Tkinter has evolved to have packed into the <strong><code>.mainloop()</code></strong> soft-real-time system, are better, yet it is not as easy to start design-battles on more than one front, so let's rather keep things simpler at this moment:</p>\n\n<pre><code>zmq_VERSION      = zmq.zmq_version_info()\nanAgentsIDENTITY = whateverHashOrHumanReadableSTRING\nnotMINE          = anAgentsIDENTITY\n\nif     zmq_VERSION[0] &lt; 4:\n           print \"ZMQ{0:} ver &lt; than expected, will exit\".format( zmq_VERSION )\naCTX = zmq.Context( 2 )                        # if performance boosting is needed\n\n#SUB ---------------------------------------------------------------------------\naSUB = aCTX.socket( zmq.SUB )\naSUB.setsockopt(    zmq.LINGER,          0 )   # protect your agent\naSUB.setsockopt(    zmq.MAXMSGSIZE,      m )   # protect your agent from DoS\naSUB.setsockopt(    zmq.AFFINITY,        1 )   # protect your server resources\naSUB.setsockopt(    zmq.HEARTBEAT_IVL,   ivl ) #     set server helping Heartbeats\naSUB.setsockopt(    zmq.HEARTBEAT_TTL,   ttl ) #     set server helping Heartbeats\naSUB.setsockopt(    zmq.INVERT_MATCHING, 1 )   #   avoid server sending data back\naSUB.setsockopt(    zmq.SUBSCRIBE,       notMINE )  #  NEVER .recv()-s  data back\n...\n#SUB PERFORMANCE &amp; RESOURCES TWEAKING DETAILS GO WAY BEYOND THE SCOPE OF THIS POST\n\naSUB.connect(      \"tcp://localhost:5557\" )\n\n#PUSH --------------------------------------------------------------------------\naPUSH = aCTX.socket( zmq.PUSH )\n...\n#PUSH PERFORMANCE &amp; RESOURCES TWEAKING DETAILS GO WAY BEYOND THE SCOPE OF THIS POST\n\n#main loop ---------------------------------------------------------------------\npass; notSoftFLAG = True; anAgentSignsWithIdentityPREFIX = anAgentsIDENTITY\nwhile notSoftFLAG:\n\n    if aReasonToSendSomethingToServer:\n       aPUSH.send( anAgentSignsWithIdentityPREFIX\n                 + \":::\"\n                 + aMsgPAYLOAD,\n                   zmq.DONTWAIT\n                   )                          # inspect ZMQError\n       ...\n       pass\n\n    if aSUB.poll( 100 ):\n       message = aSUB.recv( zmq.DONTWAIT )    #  NEVER .recv()-s own data back\n       ...\n       pass\n\n\n    if aReasonToFlagLoopEXIT:\n       notSoftFLAG = False\n       ...\n       pass\n\n    if ...:\n       ...\n       pass\n\n#main loop ---------------------------------------------------------------------\npass\n\n#########\n# ALWAYS:\n#          better using context-aware try:/except:/finally:\n\naRetCODE = [ aSOCK.close() for aSOCK in ( aSUB, aPUSH, ) ]\n...\n\naCTX.term()\n#   .term()\n#########\n</code></pre>\n\n<hr>\n\n<h2>Server can avoid <em>ALL</em> hassles with any need for any ad-hoc handling:</h2>\n\n<p>all being well tuned inside the ZeroMQ infrastructure:</p>\n\n<pre><code>pass;  zmq_VERSION = zmq.zmq_version_info()\nif     zmq_VERSION[0] &lt; 4:\n           print \"ZMQ{0:} ver &lt; than expected, will exit\".format( zmq_VERSION )\n\naCTX = zmq.Context( 2 )                        # if performance boosting is needed\n\n#PUB ---------------------------------------------------------------------------\naPUB = aCTX.socket( zmq.PUB )\naPUB.setsockopt(    zmq.LINGER,          0 )   # protect your server\naPUB.setsockopt(    zmq.MAXMSGSIZE,      m )   # protect your server from DoS\naPUB.setsockopt(    zmq.AFFINITY,        3 )   # protect your server resources\naPUB.setsockopt(    zmq.HEARTBEAT_IVL,   ivl ) #     server L3-helper Heartbeats\naPUB.setsockopt(    zmq.HEARTBEAT_TTL,   ttl ) #     server L3-helper Heartbeats\naPUB.setsockopt(    zmq.INVERT_MATCHING, 1 )   #   avoid server sending data back\naPUB.setsockopt(    zmq.IMMEDIATE,       1 )   # avoid Queueing for dead-ends\naPUB.setsockopt(    zmq.TOS,             tos ) # allow for L3-router TOS-policies\n...\n#PUB PERFORMANCE &amp; RESOURCES TWEAKING DETAILS GO WAY BEYOND THE SCOPE OF THIS POST\naPUB.bind(   \"tcp://*:5557\" )                  # expose AccessPoint on tcp://\n\n#PULL --------------------------------------------------------------------------\naPULL = aCTX.socket( zmq.PULL )\naPULL.setsockopt(    zmq.LINGER,          0 )  # protect your server\naPULL.setsockopt(    zmq.MAXMSGSIZE,      m )  # protect your server from DoS\naPULL.setsockopt(    zmq.AFFINITY,        3 )  # protect your server resources\naPULL.setsockopt(    zmq.HEARTBEAT_IVL,   ivl )#     server L3-helper Heartbeats\naPULL.setsockopt(    zmq.HEARTBEAT_TTL,   ttl )#     server L3-helper Heartbeats\n...\n#PULL PERFORMANCE &amp; RESOURCES TWEAKING DETAILS GO WAY BEYOND THE SCOPE OF THIS POST\naPULL.bind(   \"tcp://*:5558\" )                 # expose AccessPoint on tcp://\n...\n\n#main loop ---------------------------------------------------------------------\npass; notSoftFLAG = True\nwhile notSoftFLAG:\n    NOP_SLEEP = 10                            #  set a 10 [ms] sleep in case NOP\n    if aPULL.poll( 0 ):                       #  NEVER block/wait\n       aMSG = aPULL.recv( zmq.DONTWAIT )      #  NEVER .recv()-s own data back\n       #CPY = zmq_msg_copy( &amp;aMSG );          // WARNING ABOUT NATIVE C-API\n       #                                      // HANDLING, NEED .COPY()\n       #                                      //           NEED .CLOSE()\n       aPUB.send( aMSG,   zmq.DONTWAIT )      #  re-PUB-lish to all others but sender\n       ...&lt; process aMSG payload on server-side, if needed &gt;...\n\n       NOP_SLEEP = 0                          # !NOP, avoid 10[ms] NOP-loop sleep\n       pass\n\n    if aReasonToFlagLoopEXIT:\n       notSoftFLAG = False\n       ...\n       NOP_SLEEP = 0\n       pass\n\n    if ...:\n       ...\n       pass\n\n    sleep( NOP_SLEEP )                        # a soft-real-time controlled sleep on NOP\n#main loop ---------------------------------------------------------------------\npass\n\n#########\n# ALWAYS:\n#          better using context-aware try:/except:/finally:\n\naRetCODE = [ aSOCK.close() for aSOCK in ( aPUB, aPULL, ) ]\n...\n\naCTX.term()\n#   .term()\n#########\n</code></pre>\n"}], "owner": {"reputation": 2095, "user_id": 2773461, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/PJykN.jpg?s=128&g=1", "display_name": "bgarcial", "link": "https://stackoverflow.com/users/2773461/bgarcial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5202, "favorite_count": 4, "accepted_answer_id": 49411410, "answer_count": 2, "score": 3, "last_activity_date": 1523031695, "creation_date": 1521069135, "last_edit_date": 1521127157, "question_id": 49289072, "link": "https://stackoverflow.com/questions/49289072/zmq-dealer-router-communication", "title": "ZMQ DEALER - ROUTER Communication", "body": "<p>I am currently working on a project that requires some communication over the network of a different data types from some entities of a distributed system and I am using ZMQ. </p>\n\n<p>The main goal of the project is to have a central node which services clients which can connect at any time. For each client connected, the central node should manage the message communication between the two. </p>\n\n<p>Currently, and by the moment, all communication is happening over TCP.</p>\n\n<p>The clients need to send and receive messages at any time so they are <code>ZMQ_DEALER</code> type sockets and the central node is <code>ZMQ_ROUTER</code></p>\n\n<p>Initially, the goal is that one message from some client, this message arrive at other clients.  This means that the other clients can see the same data all.</p>\n\n<p>I have using the <a href=\"http://zguide.zeromq.org/page:all#The-Asynchronous-Client-Server-Pattern\" rel=\"nofollow noreferrer\">Asynchronous Client/Server pattern</a> because I am interested in having several clients talking to each other in a collaborative way, having maybe a server broker or middleware.</p>\n\n<p>I have a <code>ZMQ_DEALER</code> socket client which connect to <code>ZMQ_ROUTER</code> socket server</p>\n\n<pre><code>#include &lt;zmq.hpp&gt;\n#include \"zhelpers.hpp\"\nusing namespace std;\n\nint main(int argc, char *argv[])\n{\n\n    zmq::context_t context(1);\n    zmq::socket_t client(context, ZMQ_DEALER);\n\n    const string endpoint = \"tcp://localhost:5559\";\n\n    client.setsockopt(ZMQ_IDENTITY, \"PEER1\", 5);\n    cout &lt;&lt; \"Connecting to ZMQ Network Manager \" &lt;&lt; endpoint &lt;&lt; \"...\" &lt;&lt; endl;\n    client.connect(endpoint);\n    for (int request = 0; request &lt; 10; request++)\n    {\n\n        s_sendmore(client, \"\");\n        s_send(client, \"Testing sending some data\");\n\n        std::string string = s_recv(client);\n\n        std::cout &lt;&lt; \"Received reply \" &lt;&lt; request\n                  &lt;&lt; \" [\" &lt;&lt; string &lt;&lt; \"]\" &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>On my server code, I have a ZMQ_ROUTER which receive and manage the messages is, making bind it to a well port. This server is made in Python</p>\n\n<pre><code>import zmq\ncontext = zmq.Context()\nfrontend = context.socket(zmq.ROUTER)\nfrontend.bind(\"tcp://*:5559\")\n\n# Initialize a poll set\npoller = zmq.Poller()\npoller.register(frontend, zmq.POLLIN)\n\nprint(\"Creating Server Network Manager Router\")\n\nwhile True:\n    socks = dict(poller.poll())\n\n    if socks.get(frontend) == zmq.POLLIN:\n        message = frontend.recv_multipart()\n        print(message)\n        frontend.send_multipart(message)\n</code></pre>\n\n<p>On my other peer/client I have the following:</p>\n\n<pre><code>#include &lt;zmq.hpp&gt;\n#include \"zhelpers.hpp\"\nusing namespace std;\n\nint main (int argc, char *argv[])\n{\n\n    zmq::context_t context(1);\n    zmq::socket_t peer2(context, ZMQ_DEALER);\n\n    const string endpoint = \"tcp://localhost:5559\";\n\n    peer2.setsockopt(ZMQ_IDENTITY, \"PEER2\", 5);\n    cout &lt;&lt; \"Connecting to ZMQ Network Manager \" &lt;&lt; endpoint &lt;&lt; \"...\" &lt;&lt; endl;\n    peer2.connect(endpoint);\n    //s_sendmore(peer2, \"\");\n    //s_send(peer2, \"Probando\");\n\n    //std::string string = s_recv(peer2);\n\n    //std::cout &lt;&lt; \"Received reply \" &lt;&lt; \" [\" &lt;&lt; string &lt;&lt; \"]\" &lt;&lt; std::endl;\n\n    for (int request = 0; request &lt; 10; request++)\n    {\n\n        s_sendmore(peer2, \"\");\n        s_send(peer2, \"Probando\");\n\n        std::string string = s_recv(peer2);\n\n        std::cout &lt;&lt; \"Received reply \" &lt;&lt; request\n                  &lt;&lt; \" [\" &lt;&lt; string &lt;&lt; \"]\" &lt;&lt; std::endl;\n    }\n\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>But each that I execute some client, their respective messages do not arrive at another peer client. \nThe messages arrive at <code>ZMQ_ROUTER</code>, and are returned to the <code>ZMQ_DEALER</code> sender origin.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CANBG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CANBG.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is because the identity frame was preceded by the ROUTER at the time of reception and the message is sent back through the ROUTER; where it removes the identity and uses the value to route the message back to the relevant DEALER, <a href=\"http://api.zeromq.org/4-2:zmq-socket\" rel=\"nofollow noreferrer\">according to the ZMQ_ROUTER section to the end page here</a>.</p>\n\n<p>And this is logic, I am sending the identity of my <code>DEALER</code> to the <code>ROUTER</code>, the <code>ROUTER</code> take that identity frame and return to my <code>DEALER</code> the message</p>\n\n<p>In the first instance, to starting in my implementation, I need that some message sent by any DEALER, this will be visualized by any another DEALER without matter how many DEALERS (one or many) are connected to the ZMQ_ROUTER.\nIn this sense ... Is necessary meet about of the identity frame of other  DEALER or other DEALERS?</p>\n\n<p>If I have <code>DEALER A</code>, <code>DEALER B</code>, and <code>DEALER C</code>, and <code>ROUTER</code></p>\n\n<p>then:</p>\n\n<p><code>DEALER A</code> send a message ...\nAnd  I want that message from DEALER A to arrive at <code>DEALER B</code> and <code>DEALER C</code> and so other <code>DEALERS</code> that can be joined to my session conversation ...</p>\n\n<p>In this ideas order, is necessary met the identity frame of <code>DEALER B</code> and <code>DEALER C</code> previously on the <code>DEALER A</code> side so that this message to arrive him?</p>\n\n<p>How to know the identity frames of each DEALER existent on my implementation?\nThis is made on the ROUTER side?\nI haven't clear this</p>\n"}, {"tags": ["c++", "loops", "dictionary", "iterator"], "comments": [{"owner": {"reputation": 1016, "user_id": 8456454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f627dc7d8a375702876cbfc2a22f168?s=128&d=identicon&r=PG&f=1", "display_name": "gsquaredxc", "link": "https://stackoverflow.com/users/8456454/gsquaredxc"}, "edited": false, "score": 0, "creation_date": 1521069222, "post_id": 49289062, "comment_id": 85581319, "body": "While iterator!=end?"}, {"owner": {"reputation": 1016, "user_id": 8456454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f627dc7d8a375702876cbfc2a22f168?s=128&d=identicon&r=PG&f=1", "display_name": "gsquaredxc", "link": "https://stackoverflow.com/users/8456454/gsquaredxc"}, "edited": false, "score": 0, "creation_date": 1521069244, "post_id": 49289062, "comment_id": 85581326, "body": "Sound close to what you want?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1521069924, "post_id": 49289062, "comment_id": 85581529, "body": "First you say <i>What I cant figure out though is how to iterate over the entire map</i> -- and then -- <i>I am not asking how to iterate over a map, I already know how to do that</i>.  Unclear what you are asking for.  Also, what is <code>textWord</code>?"}, {"owner": {"reputation": 73, "user_id": 9280542, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eda3bcf35c28802d08872a840196c240?s=128&d=identicon&r=PG&f=1", "display_name": "Mark.B", "link": "https://stackoverflow.com/users/9280542/mark-b"}, "edited": false, "score": 0, "creation_date": 1521077025, "post_id": 49289062, "comment_id": 85583336, "body": "thanks for all the replies"}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1521070112, "creation_date": 1521070112, "answer_id": 49289199, "question_id": 49289062, "link": "https://stackoverflow.com/questions/49289062/how-to-search-all-map-keys-c/49289199#49289199", "title": "how to search all map keys c++", "body": "<pre><code>std::map&lt;std::string,std::string&gt;::iterator p;\nstd::string found;\nfor(p = m_repl.begin(); p != m_repl.end(); ++p)\n{\n     if(p-&gt;second == &lt;what I am looking for&gt;)\n      {\n         found = p-&gt;second;\n         break;\n     }\n}\n</code></pre>\n\n<p>ie loop over the whole dictionary. More recent c++ version have nicer enumeration sytaxes - see <a href=\"https://stackoverflow.com/questions/6963894/how-to-use-range-based-for-loop-with-stdmap\">How to use range-based for() loop with std::map?</a></p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 9280542, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eda3bcf35c28802d08872a840196c240?s=128&d=identicon&r=PG&f=1", "display_name": "Mark.B", "link": "https://stackoverflow.com/users/9280542/mark-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1521077007, "creation_date": 1521077007, "answer_id": 49290133, "question_id": 49289062, "link": "https://stackoverflow.com/questions/49289062/how-to-search-all-map-keys-c/49290133#49290133", "title": "how to search all map keys c++", "body": "<p>got caught up in what i was doing but I figured it out by just adding a boolean like this to avoid asking the user for every iteration of the loop                       </p>\n\n<pre><code>bool mapFound;\n                    for(std::map&lt;std::string,std::string&gt;::iterator it = m_Replacements.begin(); it!= m_Replacements.end(); it++)\n                    {\n                        std::string word = it-&gt;first;\n                        if(word == oneWord)\n                        {\n                            mapFound = true;\n                        }\n                    }\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 9280542, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eda3bcf35c28802d08872a840196c240?s=128&d=identicon&r=PG&f=1", "display_name": "Mark.B", "link": "https://stackoverflow.com/users/9280542/mark-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521077007, "creation_date": 1521069065, "question_id": 49289062, "link": "https://stackoverflow.com/questions/49289062/how-to-search-all-map-keys-c", "title": "how to search all map keys c++", "body": "<p>What I am trying to implement is a basic spell checker which reads an input text file and compares the words to a small dictionary. If the word isn't in the dictionary then it is assumed to be spelled wrong, and then the user is prompted to spell the word correctly. This correctly spelled word is stored with its misspelled counterpart in a map. So far I have been able to do all this. What I cant figure out though is how to iterate over the entire map to check if that key (misspelled word) already exists without asking the user every time how to spell it if it is not found in that iteration of the map? Below is the code i have so far which checks to see if the word is in the dictionary, asks the user how to spell it if its not, and adding it to the map.</p>\n\n<pre><code>std::map&lt;std::string,std::string&gt;::iterator p = m_Replacements.begin();\n            bool isIn = m_Dictionary.find(oneWord) != m_Dictionary.end();\n            std::map&lt;std::string,std::string&gt;::iterator found = m_Replacements.find(oneWord);\n\n            if(found==m_Replacements.end())\n            {\n                if( isIn == false)\n                {\n                    osInputPrompt&lt;&lt;\"How do you correctly spell \" + oneWord + \"\\n\";\n                    isInputPrompt &gt;&gt; correctSpell;\n                    m_Replacements.insert(make_pair(textWord,correctSpell));\n                    osOutput&lt;&lt;correctSpell + \" \";\n                }\n                else\n                {\n                    osOutput&lt;&lt;oneWord + \" \";\n                }\n</code></pre>\n\n<p>So in summation, I would like to add another loop inside the loop that checks if the word is in the dictionary which would then check the whole map to see if the misspelled word is already there without asking \"How do you correctly spell...\" for each iteration of the map loop. Just for clarification I am not asking how to iterate over a map, I already know how to do that. Thanks in advance. </p>\n"}, {"tags": ["c++", "cplex", "getvalue"], "comments": [{"owner": {"reputation": 4187, "user_id": 1718477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iisrz.jpg?s=128&g=1", "display_name": "rkersh", "link": "https://stackoverflow.com/users/1718477/rkersh"}, "edited": false, "score": 0, "creation_date": 1521140002, "post_id": 49289021, "comment_id": 85616418, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44955130/cplex-error-in-accessing-solution-c\">CPLEX - Error in accessing solution C++</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4738058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d598e772a625e2ec367aae0b367d130c?s=128&d=identicon&r=PG&f=1", "display_name": "rbl", "link": "https://stackoverflow.com/users/4738058/rbl"}, "edited": false, "score": 0, "creation_date": 1521123344, "post_id": 49294125, "comment_id": 85605353, "body": "Thank you for your answer! I have another doubt that I wrote here. I&#39;m not sure if I used the correct space. Could you see if you can help me again, please?"}, {"owner": {"reputation": 1695, "user_id": 2108433, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d734ef97ea8fececa4988dcc738f2e1d?s=128&d=identicon&r=PG", "display_name": "TimChippingtonDerrick", "link": "https://stackoverflow.com/users/2108433/timchippingtonderrick"}, "reply_to_user": {"reputation": 17, "user_id": 4738058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d598e772a625e2ec367aae0b367d130c?s=128&d=identicon&r=PG&f=1", "display_name": "rbl", "link": "https://stackoverflow.com/users/4738058/rbl"}, "edited": false, "score": 0, "creation_date": 1521240799, "post_id": 49294125, "comment_id": 85663161, "body": "I don&#39;t understand what you mean. I don&#39;t see any further question?"}], "tags": [], "owner": {"reputation": 1695, "user_id": 2108433, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d734ef97ea8fececa4988dcc738f2e1d?s=128&d=identicon&r=PG", "display_name": "TimChippingtonDerrick", "link": "https://stackoverflow.com/users/2108433/timchippingtonderrick"}, "is_accepted": false, "score": 2, "last_activity_date": 1521100640, "creation_date": 1521100640, "answer_id": 49294125, "question_id": 49289021, "link": "https://stackoverflow.com/questions/49289021/problems-with-function-getvalues-cplex-c/49294125#49294125", "title": "Problems with function getValue(s) cplex c++", "body": "<p>Most likely your constraints in your problem do not include all the variables; there may be some variable which is not involved in any constraint. Does your code get values for some of the variables? Have you tried debugging through this code to see which variable is not extracted to CPLEX?</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/44955130/cplex-error-in-accessing-solution-c\">CPLEX - Error in accessing solution C++</a></p>\n"}], "owner": {"reputation": 17, "user_id": 4738058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d598e772a625e2ec367aae0b367d130c?s=128&d=identicon&r=PG&f=1", "display_name": "rbl", "link": "https://stackoverflow.com/users/4738058/rbl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521123321, "creation_date": 1521068734, "question_id": 49289021, "link": "https://stackoverflow.com/questions/49289021/problems-with-function-getvalues-cplex-c", "title": "Problems with function getValue(s) cplex c++", "body": "<p>everyone!</p>\n\n<p>I'm having problems to get variables x values after solving the model.</p>\n\n<p>x variables are a four index variables.</p>\n\n<p>I define the structs:</p>\n\n<pre><code>#define     ILOARRAYNUM2                   IloArray&lt;IloNumArray&gt;\n#define     ILOARRAYNUM3                   IloArray&lt;ILOARRAYNUM2 &gt;\n#define     ILOARRAYNUM4                   IloArray&lt;ILOARRAYNUM3 &gt;\ntypedef IloArray&lt;IloNumVarArray&gt; NumVar2Array;\ntypedef IloArray&lt;NumVar2Array&gt;   NumVar3Array;\ntypedef IloArray&lt;NumVar3Array&gt;   NumVar4Array;\n</code></pre>\n\n<p>The variables x are defined as:</p>\n\n<pre><code>NumVar4Array x; \nILOARRAYNUM4 _x;\n\nmono.x = NumVar4Array(env, n);\nfor(int i = 0; i &lt; n; i++) { \n    mono.x[i] = NumVar3Array(env, n);\n    for(int j = 0; j &lt; n; j++) {\n        mono.x[i][j] = NumVar2Array(env, n);\n        for (int k = 0; k &lt; n; k++) {\n            mono.x[i][j][k] = IloNumVarArray(env, n, 0.0, 1.0, ILOFLOAT);\n        }\n    }\n}\n\nmono._x = ILOARRAYNUM4(env,n);\nfor (int i = 0; i &lt; n; i++){\n    mono._x[i]    = ILOARRAYNUM3(env,n);\n    for (int j = 0; j &lt; n; j++){\n        mono._x[i][j]  = ILOARRAYNUM2(env,n);\n        for (int k = 0; k &lt; n; k++) {\n            mono._x[i][j][k] = IloNumArray(env,n);\n        }\n    }\n}  \n</code></pre>\n\n<p>To get the values of x, I do:</p>\n\n<pre><code>for (int i = 0; i &lt; n; i++) { \n    for (int j  = 0; j &lt; n; j++) { \n        if (w[i][j] != 0){ \n            for (int k = 0; k &lt; n; k++) {\n                for (int m = 0; m &lt; n; m++) {\n                    if ( (k != m &amp;&amp; k != j &amp;&amp; m != i) or (k == m) ) {\n                        mono.cplex.getValue(mono.x[i][j][k][m], mono._x[i][j][k][m]);\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>But, then, the error message below appears:</p>\n\n<p>The referenced IloExtractable has not been extracted by the IloAlgorithm</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c++", "function-pointers"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1521068803, "post_id": 49288989, "comment_id": 85581174, "body": "The compiler could be generating a special &quot;free function&quot; <code>int func2_free(A* this, int v) { return this-&gt;vtable.func2(this, v); }</code>"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1521068803, "post_id": 49288989, "comment_id": 85581175, "body": "<a href=\"https://stackoverflow.com/questions/34367360/how-is-pointer-to-member-function-implemented-in-c\" title=\"how is pointer to member function implemented in c\">stackoverflow.com/questions/34367360/&hellip;</a>"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521068870, "post_id": 49288989, "comment_id": 85581201, "body": "<a href=\"https://www.codeguru.com/cpp/cpp/article.php/c17401/C-Tutorial-PointertoMember-Function.htm\" rel=\"nofollow noreferrer\">RTFM</a>"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521073504, "post_id": 49288989, "comment_id": 85582514, "body": "@VictorGubin That link (which is not really &quot;the manual&quot;) explains how to use pointers to member functions and what happens when you do use them, but it looks like the OP understands all that.  It doesn&#39;t address the actual question, which is how compilers implement them in a way that handles both non-virtual and virtual functions."}], "answers": [{"tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 0, "last_activity_date": 1521118713, "creation_date": 1521118713, "answer_id": 49300102, "question_id": 49288989, "link": "https://stackoverflow.com/questions/49288989/how-do-pointers-to-member-functions-work/49300102#49300102", "title": "How do pointers to member functions work?", "body": "<p>GCC <a href=\"http://gcc.gnu.org/onlinedocs/gcc/Bound-member-functions.html\" rel=\"nofollow noreferrer\">documents</a> that PMFs are implemented as structs that know how to compute the value of <code>this</code> and make any vtable lookup.</p>\n"}, {"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 4, "last_activity_date": 1521158304, "last_edit_date": 1592644375, "creation_date": 1521158304, "answer_id": 49311188, "question_id": 49288989, "link": "https://stackoverflow.com/questions/49288989/how-do-pointers-to-member-functions-work/49311188#49311188", "title": "How do pointers to member functions work?", "body": "<p>This of course depends on the compiler and the target architecture, and there is more than one single way to do it.  But I'll describe how it works on the system I use most, g++ for Linux x86_64.</p>\n<p>g++ follows the <a href=\"https://itanium-cxx-abi.github.io/cxx-abi/abi.html\" rel=\"nofollow noreferrer\">Itanium C++ ABI</a>, which describes a lot of the details of one way various C++ features including virtual functions can be implemented behind the scenes for most architectures.</p>\n<p>The ABI says this about pointers to member functions, in section 2.3:</p>\n<blockquote>\n<p>A pointer to member function is a pair as follows:</p>\n<p>\u00a0\u00a0\u00a0<strong>ptr</strong>:</p>\n<p>For a non-virtual function, this field is a simple function pointer. ... For a virtual function, it is 1 plus the virtual table offset (in bytes) of the function, represented as a <code>ptrdiff_t</code>. The value zero represents a NULL pointer, independent of the adjustment field value below.</p>\n<p>\u00a0\u00a0\u00a0<strong>adj</strong>:</p>\n<p>The required adjustment to <code>this</code>, represented as a <code>ptrdiff_t</code>.</p>\n<p>It has the size, data size, and alignment of a class containing those two members, in that order.</p>\n</blockquote>\n<p>The +1 to ptr for a virtual function helps detect whether or not the function is virtual, since for most platforms all function pointer values and vtable offsets are even. It also makes sure a null member function pointer has a distinct value from any valid member function pointer.</p>\n<p>The vtable / vptr setup for your class <code>A</code> will work something like this C code:</p>\n<pre><code>struct A__virt_funcs {\n    int (*func2)(A*, int);\n};\n\nstruct A__vtable {\n    ptrdiff_t offset_to_top;\n    const std__typeinfo* typeinfo;\n    struct A__virt_funcs funcs;\n};\n\nstruct A {\n    const struct A__virt_funcs* vptr;\n};\n\nint A__func1(struct A*, int v) {\n    std__operator__ltlt(&amp;std__cout, &quot;fun1&quot;);\n    return v;\n}\n\nint A__func2(struct A*, int v) {\n    std__operator__ltlt(&amp;std__cout, &quot;fun2&quot;);\n    return v;\n}\n\nextern const std__typeinfo A__typeinfo;\n\nconst struct A__vtable vt_for_A = { 0, &amp;A__typeinfo, { &amp;A__func2 } };\n\nvoid A__initialize(A* a) {\n    a-&gt;vptr = &amp;vt_for_A.funcs;\n}\n</code></pre>\n<p>(Yes, a real name mangling scheme would need to do something with function parameter types to allow for overloading, and more things since the <code>operator&lt;&lt;</code> involved is actually a function template specialization. But that's beside the point here.)</p>\n<p>Now let's look at the assembly I get for your <code>main()</code> (with options <code>-O0 -fno-stack-protector</code>).  My comments are added.</p>\n<pre><code>Dump of assembler code for function main:\n     // Standard stack adjustment for function setup.\n   0x00000000004007e6 &lt;+0&gt;: push   %rbp\n   0x00000000004007e7 &lt;+1&gt;: mov    %rsp,%rbp\n   0x00000000004007ea &lt;+4&gt;: push   %rbx\n   0x00000000004007eb &lt;+5&gt;: sub    $0x38,%rsp\n     // Put argc in the stack at %rbp-0x34.\n   0x00000000004007ef &lt;+9&gt;: mov    %edi,-0x34(%rbp)\n     // Put argv in the stack at %rbp-0x40.\n   0x00000000004007f2 &lt;+12&gt;:    mov    %rsi,-0x40(%rbp)\n     // Construct &quot;a&quot; on the stack at %rbp-0x20.\n     // 0x4009c0 is &amp;vt_for_A.funcs.\n   0x00000000004007f6 &lt;+16&gt;:    mov    $0x4009c0,%esi\n   0x00000000004007fb &lt;+21&gt;:    mov    %rsi,-0x20(%rbp)\n     // Check if argc is more than 2.\n     // In both cases, &quot;pf&quot; will be on the stack at %rbp-0x30.\n   0x00000000004007ff &lt;+25&gt;:    cmpl   $0x2,-0x34(%rbp)\n   0x0000000000400803 &lt;+29&gt;:    jle    0x400819 &lt;main+51&gt;\n     // if (argc &lt;= 2) {\n     //   Initialize pf to { &amp;A__func2, 0 }.\n   0x0000000000400805 &lt;+31&gt;:    mov    $0x4008ce,%ecx\n   0x000000000040080a &lt;+36&gt;:    mov    $0x0,%ebx\n   0x000000000040080f &lt;+41&gt;:    mov    %rcx,-0x30(%rbp)\n   0x0000000000400813 &lt;+45&gt;:    mov    %rbx,-0x28(%rbp)\n   0x0000000000400817 &lt;+49&gt;:    jmp    0x40082b &lt;main+69&gt;\n     // } else { [argc &gt; 2]\n     //   Initialize pf to { 1, 0 }.\n   0x0000000000400819 &lt;+51&gt;:    mov    $0x1,%eax\n   0x000000000040081e &lt;+56&gt;:    mov    $0x0,%edx\n   0x0000000000400823 &lt;+61&gt;:    mov    %rax,-0x30(%rbp)\n   0x0000000000400827 &lt;+65&gt;:    mov    %rdx,-0x28(%rbp)\n     // }\n     // Test whether pf.ptr is even or odd:\n   0x000000000040082b &lt;+69&gt;:    mov    -0x30(%rbp),%rax\n   0x000000000040082f &lt;+73&gt;:    and    $0x1,%eax\n   0x0000000000400832 &lt;+76&gt;:    test   %rax,%rax\n   0x0000000000400835 &lt;+79&gt;:    jne    0x40083d &lt;main+87&gt;\n     // int (*funcaddr)(A*, int); [will be in %rax]\n     // if (is_even(pf.ptr)) {\n     //   Just do:\n     //   funcaddr = pf.ptr;\n   0x0000000000400837 &lt;+81&gt;:    mov    -0x30(%rbp),%rax\n   0x000000000040083b &lt;+85&gt;:    jmp    0x40085c &lt;main+118&gt;\n     // } else { [is_odd(pf.ptr)]\n     //   Compute A* a2 = (A*)((char*)&amp;a + pf.adj); [in %rax]\n   0x000000000040083d &lt;+87&gt;:    mov    -0x28(%rbp),%rax\n   0x0000000000400841 &lt;+91&gt;:    mov    %rax,%rdx\n   0x0000000000400844 &lt;+94&gt;:    lea    -0x20(%rbp),%rax\n   0x0000000000400848 &lt;+98&gt;:    add    %rdx,%rax\n     //   Compute funcaddr =\n     //     (int(*)(A*,int)) (((char*)(a2-&gt;vptr))[pf.ptr-1]);\n   0x000000000040084b &lt;+101&gt;:   mov    (%rax),%rax\n   0x000000000040084e &lt;+104&gt;:   mov    -0x30(%rbp),%rdx\n   0x0000000000400852 &lt;+108&gt;:   sub    $0x1,%rdx\n   0x0000000000400856 &lt;+112&gt;:   add    %rdx,%rax\n   0x0000000000400859 &lt;+115&gt;:   mov    (%rax),%rax\n     // }\n     // Compute A* a3 = (A*)((char*)&amp;a + pf.adj); [in %rcx]\n   0x000000000040085c &lt;+118&gt;:   mov    -0x28(%rbp),%rdx\n   0x0000000000400860 &lt;+122&gt;:   mov    %rdx,%rcx\n   0x0000000000400863 &lt;+125&gt;:   lea    -0x20(%rbp),%rdx\n   0x0000000000400867 &lt;+129&gt;:   add    %rdx,%rcx\n     // Call int r = (*funcaddr)(a3, argc);\n   0x000000000040086a &lt;+132&gt;:   mov    -0x34(%rbp),%edx\n   0x000000000040086d &lt;+135&gt;:   mov    %edx,%esi\n   0x000000000040086f &lt;+137&gt;:   mov    %rcx,%rdi\n   0x0000000000400872 &lt;+140&gt;:   callq  *%rax\n     // Standard stack cleanup for function exit.\n   0x0000000000400874 &lt;+142&gt;:   add    $0x38,%rsp\n   0x0000000000400878 &lt;+146&gt;:   pop    %rbx\n   0x0000000000400879 &lt;+147&gt;:   pop    %rbp\n     // Return r.\n   0x000000000040087a &lt;+148&gt;:   retq   \nEnd of assembler dump.\n</code></pre>\n<p>But then what's the deal with the member function pointer's <code>adj</code> value?  The assembly added it to the address of <code>a</code> before doing the vtable lookup and also before calling the function, whether the function was virtual or not.  But both cases in <code>main</code> set it to zero, so we haven't really seen it in action.</p>\n<p>The <code>adj</code> value comes in when we have multiple inheritance.  So now suppose we have:</p>\n<pre><code>class B\n{\npublic:\n    virtual void func3() {}\n    int n;\n};\n\nclass C : public B, public A\n{\npublic:\n    int func4(int v) { return v; }\n    int func2(int v) override { return v; }\n};\n</code></pre>\n<p>The layout of an object of type <code>C</code> contains a <code>B</code> subobject (which contains another vptr and an <code>int</code>) and then an <code>A</code> subobject.  So the address of the <code>A</code> contained in a <code>C</code> is not the same as the address of the <code>C</code> itself.</p>\n<p>As you might be aware, any time code implicitly or explicitly converts a (non-null) <code>C*</code> pointer to an <code>A*</code> pointer, the C++ compiler accounts for this difference by adding the correct offset to the address value.  C++ also allows converting from a pointer to member function of <code>A</code> to a pointer to member function of <code>C</code> (since any member of <code>A</code> is also a member of <code>C</code>), and when that happens (for a non-null member function pointer), a similar offset adjustment needs to be made.  So if we have:</p>\n<pre><code>int (A::*pf1)(int) = &amp;A::func1;\nint (C::*pf2)(int) = pf1;\n</code></pre>\n<p>the values within the member function pointers under the hood would be <code>pf1 = { &amp;A__func1, 0 };</code> and <code>pf2 = { &amp;A__func1, offset_A_in_C };</code>.</p>\n<p>And then if we have</p>\n<pre><code>C c;\nint n = (c.*pf2)(3);\n</code></pre>\n<p>the compiler will implement the call to the member function pointer by adding the offset <code>pf2.adj</code> to the address <code>&amp;c</code> to find the implicit &quot;this&quot; parameter, which is good because then it will be a valid <code>A*</code> value as <code>A__func1</code> expects.</p>\n<p>The same thing goes for a virtual function call, except that as the disassembly dump showed, the offset is needed both to find the implicit &quot;this&quot; parameter and to find the vptr which contains the actual function code address.  There's an added twist to the virtual case, but it's one which is needed for both ordinary virtual calls and calls using a pointer to member function: The virtual function <code>func2</code> will be called with an <code>A*</code> &quot;this&quot; parameter since that's where the original overridden declaration is, and the compiler won't in general be able to know if the &quot;this&quot; argument is actually of any other type. But the definition of override <code>C::func2</code> expects a <code>C*</code> &quot;this&quot; parameter. So when the most derived type is <code>C</code>, the vptr within the <code>A</code> subobject will point at a vtable which has an entry pointing not at the code for <code>C::func2</code> itself, but at a tiny &quot;thunk&quot; function, which does nothing but subtract <code>offset_A_in_C</code> from the &quot;this&quot; parameter and then pass control to the actual <code>C::func2</code>.</p>\n"}], "owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 49311188, "answer_count": 2, "score": 2, "last_activity_date": 1521158304, "creation_date": 1521068520, "question_id": 49288989, "link": "https://stackoverflow.com/questions/49288989/how-do-pointers-to-member-functions-work", "title": "How do pointers to member functions work?", "body": "<p>I understand that normal function pointer contain the start address of the function being pointed to so when a normal function pointer is used, we just jump to the stored address. But what does a pointer to an object member function contain?</p>\n\n<p>Consider:</p>\n\n<pre><code>class A\n{\npublic:\n    int func1(int v) {\n        std::cout &lt;&lt; \"fun1\";\n        return v;\n    }\n    virtual int func2(int v) {\n        std::cout &lt;&lt; \"fun2\";\n        return v;\n    }\n};\n\nint main(int argc, char** argv)\n{\n    A a;\n    int (A::*pf)(int a) = argc &gt; 2 ? &amp;A::func1 : &amp;A::func2;\n    static_assert(sizeof(pf) == (sizeof(void*), \"Unexpected function size\");\n    return (a.*pf)(argc);\n}\n</code></pre>\n\n<p>In the above program, the function pointer can take its value from either a virtual function (that needs to be accessed via the vtable) or a normal class member (that is implemented as a normal function with an implicit <code>this</code> as a first argument.)</p>\n\n<p>So what is the value stored in my pointer to member function and how does the compiler get things to work as expected?</p>\n"}, {"tags": ["c++", "memory", "text", "readprocessmemory"], "comments": [{"owner": {"reputation": 1609, "user_id": 9335240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374b57f721280fb0c39d46f6d3d3955d?s=128&d=identicon&r=PG", "display_name": "user9335240", "link": "https://stackoverflow.com/users/9335240/user9335240"}, "edited": false, "score": 0, "creation_date": 1521066999, "post_id": 49288688, "comment_id": 85580588, "body": "What about using interprocess communication? Use sockets for example (but there may be simpler techiniques). Because you may need to notify the other process to update its UI according to the new value, not just change the memory contents."}, {"owner": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 0, "creation_date": 1521067015, "post_id": 49288688, "comment_id": 85580594, "body": "How did you search for the text? It may be stored in ASCII, or it may possibly be in &quot;Unicode&quot; (wide/UTF16) format, which some search functions might not catch..."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521067088, "post_id": 49288688, "comment_id": 85580622, "body": "A windowless UI may support <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ee684009.aspx\" rel=\"nofollow noreferrer\">UI Automation</a> (which you should be using anyway)."}], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": 0, "last_activity_date": 1587238365, "creation_date": 1587238365, "answer_id": 61295105, "question_id": 49288688, "link": "https://stackoverflow.com/questions/49288688/c-edit-text-on-another-program-window-from-its-memory/61295105#61295105", "title": "c++ edit text on another program window from its memory", "body": "<blockquote>\n  <p>can't find the string in the memory</p>\n</blockquote>\n\n<p>The string must exist in memory, it is most likely a Unicode string and you're searching for an ANSI string.</p>\n\n<p>For the purpose of this answer, unicode chars are 2 bytes while the ANSI chars are 1 byte.</p>\n\n<p>If you're searching for the value in Cheat Engine then you need to check the 'unicode' option.</p>\n\n<p>When you go to overwrite that memory, make sure your source buffer is a wchar_t array not a char array and make sure you use sizeof() not strlen() so you get the correct size in bytes.  Also make sure you use a null terminator, assuming it's a null terminated string.</p>\n"}], "owner": {"reputation": 29, "user_id": 9395228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf875f55d3b04c91ead71ba8311c929?s=128&d=identicon&r=PG&f=1", "display_name": "prog511", "link": "https://stackoverflow.com/users/9395228/prog511"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587238365, "creation_date": 1521066787, "question_id": 49288688, "link": "https://stackoverflow.com/questions/49288688/c-edit-text-on-another-program-window-from-its-memory", "title": "c++ edit text on another program window from its memory", "body": "<p>I want to edit text in another program ui element\nthis is easy if the window has a handle so I can use SetWindowText() function</p>\n\n<p>but some windows doesn't have handles as they are windowless so I can't access the elements in them</p>\n\n<p>I tried to use ReadProcessMemory to find the text I'm searching for and edit it with WriteProcessMemory but I can't find the string in the memory , I also used a program called heapmemview but also I didn't get the readable text I look for , so where is this text as I know it must be in the memory of the process but it doesn't apear to be there</p>\n"}, {"tags": ["c++", "visual-studio-code", "printf", "variadic-functions"], "comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "reply_to_user": {"reputation": 200, "user_id": 7803590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df85890e13f3d9584a7b6824a576580?s=128&d=identicon&r=PG&f=1", "display_name": "chrisg", "link": "https://stackoverflow.com/users/7803590/chrisg"}, "edited": false, "score": 1, "creation_date": 1521066866, "post_id": 49288611, "comment_id": 85580537, "body": "@chrisg Cat got your comment? ;P"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 3, "creation_date": 1521067521, "post_id": 49288611, "comment_id": 85580784, "body": "Why do you believe that quote says the code has undefined behavior?"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1521067601, "post_id": 49288611, "comment_id": 85580827, "body": "A char pointer is fine as an argument to <code>va_start()</code> (it&#39;s not a function, array, or reference type). Does vscode give any more detail about what it thinks is the problem?  Maybe vscode doesn&#39;t like that there&#39;s no <code>va_end()</code>?  technically there should be one, though I don&#39;t think it actually does anything in Visual C/C__."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1521070516, "post_id": 49288611, "comment_id": 85581703, "body": "Do you have some more info about your environment ? Which platform are you on, and which compiler/version  are you using ? Is this an actual error or warning when you compile your code, or is it just a hint that VSCode shows you that might not actually originate from the compiler ?"}, {"owner": {"reputation": 10386, "user_id": 365338, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9204e001a231dfbf8e55a8a68ec95699?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/365338/zak"}, "edited": false, "score": 0, "creation_date": 1521072097, "post_id": 49288611, "comment_id": 85582168, "body": "I&#39;m using VSCode on macOS 10.13.3 w/ llvm. It may very well be an error on the part of VSCode, but I assumed they knew more than me, so I researched and ultimately reached out here to understand better."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9518427, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adrian Bentley", "link": "https://stackoverflow.com/users/9518427/adrian-bentley"}, "is_accepted": false, "score": 1, "last_activity_date": 1521677842, "creation_date": 1521677842, "answer_id": 49418571, "question_id": 49288611, "link": "https://stackoverflow.com/questions/49288611/vscode-error-incorrect-use-of-va-start/49418571#49418571", "title": "VSCode Error: &quot;incorrect use of va_start&quot;", "body": "<p>So I'm running into this too and it confuses me when working with build output. I believe its a bug (I've registered one here: <a href=\"https://github.com/Microsoft/vscode-cpptools/issues/1720\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/vscode-cpptools/issues/1720</a>). </p>\n\n<p>I found a maybe horrible work around using special preprocessor logic for <code>__INTELLISENSE__</code> builds (necessary if a platform can't support Intellisense natively, but vscode is cross platform so....). </p>\n\n<p>Here's the workaround:</p>\n\n<pre><code>#if __INTELLISENSE__\n#undef va_start(arg, va)\n#define va_start(arg, va)\n#undef va_end(va)\n#define va_end(va)\n#undef va_copy(va0, va1)\n#define va_copy(arg0, va1)\n#define __INT_MAX__ 0x7fffffff\n#endif\n</code></pre>\n\n<p>I had issues with the definition of <code>__INT_MAX__</code> as well.</p>\n\n<p>If you're desperate this will get these errors out of the way.</p>\n\n<p>Hopefully someone will figure out an actual solution, or at least one that doesn't require custom code.</p>\n\n<p>Thanks,\nAdrian</p>\n"}], "owner": {"reputation": 10386, "user_id": 365338, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9204e001a231dfbf8e55a8a68ec95699?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/365338/zak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521677842, "creation_date": 1521066416, "question_id": 49288611, "link": "https://stackoverflow.com/questions/49288611/vscode-error-incorrect-use-of-va-start", "title": "VSCode Error: &quot;incorrect use of va_start&quot;", "body": "<p>VSCode is complaining about the use of <code>va_start</code> in the following <em>currently working</em> function.</p>\n\n<pre><code>void _log(int level, const char *format, ...)\n{\n    va_list arglist;\n    va_start(arglist, format);\n    writelog(level, format, arglist);\n}\n</code></pre>\n\n<p>After searching around, I found a reference to the standard that appears to indicate VSCode is correct and the code will result in undefined behavior.</p>\n\n<blockquote>\n  <p>18.10/3 ...The parameter parmN is the identifier of the rightmost parameter in the variable parameter list of the function definition (the one just before the ...). If the parameter parmN is declared with a function, array, or reference type, or with a type that is not compatible with the type that results when passing an argument for which there is no parameter, the behavior is undefined.</p>\n</blockquote>\n\n<p>I tried to find examples of how others handled similar functionality. I found several blogs and several code samples recreating <code>printf</code>, using implementations similar to the one above. Are these examples also incorrect?</p>\n\n<p><strong>What is the appropriate way to write a <code>printf</code>-like function without resulting in undefined behavior?</strong></p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 7, "creation_date": 1521066905, "post_id": 49288470, "comment_id": 85580548, "body": "A better option would be to use a GUID instead of a randomly generated filename (the <code>GetTempFileName()</code> documentation even says so). See <code>CoCreateGuid()</code> and <code>StringFromGUID2()</code>, or <code>UuidCreate()</code> and <code>UuidToString()</code>."}, {"owner": {"reputation": 1379, "user_id": 3587624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0d027a64fc870832410a87419265937a?s=128&d=identicon&r=PG&f=1", "display_name": "user3587624", "link": "https://stackoverflow.com/users/3587624/user3587624"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521067342, "post_id": 49288470, "comment_id": 85580725, "body": "I would like to avoid creating a super long guid. Would that be possible?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1521067525, "post_id": 49288470, "comment_id": 85580789, "body": "You want to create a random folder and not a file, so I suggest you duplicate the algorithm that <code>GetTempFileName()</code> uses: &quot;<i>If uUnique is zero, the function attempts to form a unique file name using the current system time. If the file already exists, the number is increased by one and the functions tests if this file already exists. This continues until a unique filename is found</i>&quot;. You can accomplish those tasks using <code>CreateDirectory()</code> and <code>FindFirstFile()</code>, for instance."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1521067689, "post_id": 49288470, "comment_id": 85580852, "body": "Or better, don&#39;t even bother using random numbers, simply format the current system time down to milliseconds as a human-readable string.  If you find a folder that already exists, just wait a few milliseconds and try again"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1521071297, "post_id": 49288470, "comment_id": 85581923, "body": "You don&#39;t want to start with GetTempFileName and tweak it.   GetTempFileName creates the file to guarantee that there&#39;s no race condition between when it determines certain name is available until it &quot;claims&quot; that name.  You can emulate that logic to create a directory instead of a file."}, {"owner": {"reputation": 1379, "user_id": 3587624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0d027a64fc870832410a87419265937a?s=128&d=identicon&r=PG&f=1", "display_name": "user3587624", "link": "https://stackoverflow.com/users/3587624/user3587624"}, "edited": false, "score": 0, "creation_date": 1521072193, "post_id": 49288470, "comment_id": 85582190, "body": "Marked your answers with a +1 since these are totally valid and also worked well for me. Thanks!"}, {"owner": {"reputation": 326, "user_id": 2344930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ba462b1397c32f74eb1ad0e2e8de4a?s=128&d=identicon&r=PG", "display_name": "mu7z", "link": "https://stackoverflow.com/users/2344930/mu7z"}, "edited": false, "score": 0, "creation_date": 1572984813, "post_id": 49288470, "comment_id": 103730511, "body": "What about if you want to create a random file?"}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1521113205, "post_id": 49288683, "comment_id": 85598199, "body": "That creates a TOCTOU race. <code>GetTempFileName</code> is used to create a file. If you need to create a folder, don&#39;t use it."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 1, "last_activity_date": 1521066763, "creation_date": 1521066763, "answer_id": 49288683, "question_id": 49288470, "link": "https://stackoverflow.com/questions/49288470/use-gettempfilename-function-to-generate-random-file-name-on-c/49288683#49288683", "title": "Use GetTempFileName function to generate random file name on C++", "body": "<p>You can delete the file, remove the extension from the generated name, then create the folder.</p>\n"}, {"tags": [], "owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "is_accepted": false, "score": 4, "last_activity_date": 1521117666, "last_edit_date": 1521117666, "creation_date": 1521111025, "answer_id": 49297498, "question_id": 49288470, "link": "https://stackoverflow.com/questions/49288470/use-gettempfilename-function-to-generate-random-file-name-on-c/49297498#49297498", "title": "Use GetTempFileName function to generate random file name on C++", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364991.aspx\" rel=\"nofollow noreferrer\">GetTempFileName</a> is responsible for creating a file. If you want to create a unique directory instead, you have to write your own implementation. Using <code>GetTempFileName</code>, then deleting the file, and creating a directory with the same name in its place is doomed to fail, due to a <a href=\"https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use\" rel=\"nofollow noreferrer\">TOCTOU</a> race.</p>\n\n<p>The standard solution to creating unique names is to use string representations of GUIDs. You can call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa379205(v=vs.85).aspx\" rel=\"nofollow noreferrer\">UuidCreate</a>, followed by <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa379352.aspx\" rel=\"nofollow noreferrer\">UuidToString</a> to get one.</p>\n\n<p>If 36 characters is unwieldy in your situation, you would need to write your own implementation, based on a less unique algorithm (like the system time) and a retry strategy.</p>\n\n<p>As an example, here is an implementation, that uses the string representation of the system time, represented as a 64-bit decimal number. That leads to a string representation, that is at most 19 characters wide.</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;system_error&gt;\n\nstd::wstring GetTempDir(std::wstring const&amp; root_dir) {\n    while (true) {\n        ::SYSTEMTIME st{};\n        ::GetSystemTime(&amp;st);\n\n        ::FILETIME ft{};\n        if (!::SystemTimeToFileTime(&amp;st, &amp;ft)) {\n            auto error_code{ ::GetLastError() };\n            throw std::system_error(error_code, std::system_category(),\n                                    \"SystemTimeToFileTime()\");\n        }\n\n        ULARGE_INTEGER ft_uli{ ft.dwLowDateTime, ft.dwHighDateTime };\n        auto dir_name{ std::to_wstring(ft_uli.QuadPart) };\n        auto dir_name_full{ root_dir + dir_name };\n        if (::CreateDirectoryW(dir_name_full.c_str(), nullptr)) {\n            return dir_name_full;\n        }\n        else {\n            auto error_code{ ::GetLastError() };\n            if (error_code != ERROR_ALREADY_EXISTS) {\n                throw std::system_error(error_code, std::system_category(),\n                                        \"CreateDirectoryW()\");\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This function returns the fully qualified path to the temporary directory it creates, or throws an exception if it cannot. It expects a string to the root directory including a trailing backslash. In case the directory already exists, it keeps trying, until a directory can be created.</p>\n\n<p>Note in particular, that there is no race condition. If the function succeeds, the directory has been created.</p>\n\n<p>It can be called as shown in the following sample:</p>\n\n<pre><code>int main() {\n    wchar_t path[MAX_PATH + 1]{};\n    ::GetTempPathW(_countof(path), path);\n\n    auto temp_dir{ GetTempDir(path) };\n    std::wcout &lt;&lt; L\"Temporary directory created: \" &lt;&lt; temp_dir &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 1379, "user_id": 3587624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0d027a64fc870832410a87419265937a?s=128&d=identicon&r=PG&f=1", "display_name": "user3587624", "link": "https://stackoverflow.com/users/3587624/user3587624"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1539, "favorite_count": 0, "accepted_answer_id": 49288683, "answer_count": 2, "score": 0, "last_activity_date": 1521117666, "creation_date": 1521065698, "last_edit_date": 1521065921, "question_id": 49288470, "link": "https://stackoverflow.com/questions/49288470/use-gettempfilename-function-to-generate-random-file-name-on-c", "title": "Use GetTempFileName function to generate random file name on C++", "body": "<p>I want to use the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa364991(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetTempFileName</a> function to generate a random file name but without creating the file itself when the function gets called. I want to use that function to use the name itself (and without the extension) so later I can create a folder with that particular name. Since there is no similar function that creates a folder, I just want to get the string that GetTempFileName creates to later on create a folder.</p>\n\n<pre><code>LPTSTR wzTemp = new TCHAR[MAX_PATH];\nGetTempFileName(strTemp, 0, 0, wzTemp);\n\nCString tempFolder;\ntempFolder = wzTemp;\n</code></pre>\n\n<p>This is my attempt but right after GetTempFileName the file gets created.</p>\n\n<p>Any idea how can I tweak this?</p>\n"}, {"tags": ["c++", "opengl", "opencl", "arrayfire"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521069342, "post_id": 49288288, "comment_id": 85581352, "body": "You need at least two shaders, vertex and fragment. If you&#39;r array is GLBuffer vertex data use it in your shaders.  Suggesting David_Wolff OpenGL4 Shading Language Cookbook. This is a kind of <code>Modern OpenGL RedBook</code>."}, {"owner": {"reputation": 75, "user_id": 9492811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48b65a510825fdc4554d8b9f4c2bcc7?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaAB", "link": "https://stackoverflow.com/users/9492811/hamzaab"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521069818, "post_id": 49288288, "comment_id": 85581500, "body": "@VictorGubin I am aware of how to use OpenGL on its own, I would like to know how to fill an OpenGL buffer with an array of information, derived from what I have in Arrayfire, without needing unnecessary copies to set the OpenGL buffer."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521072305, "post_id": 49288288, "comment_id": 85582214, "body": "<a href=\"https://developer.apple.com/library/content/documentation/Performance/Conceptual/OpenCL_MacProgGuide/shareGroups/shareGroups.html\" rel=\"nofollow noreferrer\">Sharing OpenCL and OpenGL data</a>"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521072522, "post_id": 49288288, "comment_id": 85582281, "body": "And build with OpenCL.  <a href=\"https://github.com/arrayfire/arrayfire/wiki/Build-Instructions-for-OSX#opencl-build-dependencies\" rel=\"nofollow noreferrer\">BUILD_OPENCL</a> using cmake."}], "answers": [{"tags": [], "owner": {"reputation": 657, "user_id": 1985476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DyZNz.jpg?s=128&g=1", "display_name": "pradeep", "link": "https://stackoverflow.com/users/1985476/pradeep"}, "is_accepted": true, "score": 1, "last_activity_date": 1521072659, "creation_date": 1521072659, "answer_id": 49289588, "question_id": 49288288, "link": "https://stackoverflow.com/questions/49288288/using-opengl-from-arrayfire/49289588#49289588", "title": "Using OpenGL from ArrayFire", "body": "<p>@HamzaAB</p>\n\n<p>What you are asking is known as GL-CUDA or GL-OpenCL interoperability, if you already don't know about it, which is the area <a href=\"https://github.com/arrayfire/forge\" rel=\"nofollow noreferrer\">Forge</a> tries to address. You can look the <a href=\"https://github.com/arrayfire/forge/blob/master/include/ComputeCopy.h\" rel=\"nofollow noreferrer\">ComputeCopy.h</a> header inside forge repository to understand how to do OpenGL interop.</p>\n\n<p>Having said that, Do you want to reset the transformation you are doing to the line plot, if you want to reset it then there is way. While holding the left control, hit middle mouse button, that will reset the pan/zoom done to the line plot. If you are facing some other issue with forge's line plot, you may raise an issue <a href=\"https://github.com/arrayfire/forge/issues\" rel=\"nofollow noreferrer\">here</a> and we will try to look into it. </p>\n\n<p>PS. I am one of the core developers of ArrayFire.</p>\n"}], "owner": {"reputation": 75, "user_id": 9492811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b48b65a510825fdc4554d8b9f4c2bcc7?s=128&d=identicon&r=PG&f=1", "display_name": "HamzaAB", "link": "https://stackoverflow.com/users/9492811/hamzaab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 49289588, "answer_count": 1, "score": 2, "last_activity_date": 1521072659, "creation_date": 1521064750, "last_edit_date": 1521067762, "question_id": 49288288, "link": "https://stackoverflow.com/questions/49288288/using-opengl-from-arrayfire", "title": "Using OpenGL from ArrayFire", "body": "<p>If I have an af::array A already in GPU memory, what is the procedure to pass it through to OpenGl? My intention is to plot it as a line graph using OpenGl, but I'm not sure how to deal with the fact that the backend of Arrayfire could be OpenCl, CUDA or even the CPU. How does OpenGl achieve ownership of the array? I would preferably like to avoid copying if possible.</p>\n\n<p>On a separate note, if I was to use the in built forge library to plot graphs in Arrayfire, I find that if I follow the tutorials to plot a graph, by pressing and holding on the data in the plot and dragging it somewhere else, the data plot moves from its original location and is no longer correctly aligned with the axis. Is there a way to correct this?</p>\n"}, {"tags": ["c++", "algorithm", "multiplication", "karatsuba"], "comments": [{"owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 1, "creation_date": 1521064735, "post_id": 49288251, "comment_id": 85579652, "body": "Heed my advice: Use <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>. I don&#39;t even want to know how many memory leaks are in here..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8005765"}, "reply_to_user": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "edited": false, "score": 1, "creation_date": 1521065022, "post_id": 49288251, "comment_id": 85579777, "body": "thank you for your advice but I have to use arrays like these, because I will have to work with vector registers and parallelization with OpenMP."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1521065627, "post_id": 49288251, "comment_id": 85580053, "body": "Welcome to StackOverflow.  Please read and follow the posting guidelines in the help documentation.  <a href=\"http://stackoverflow.com/help/mcve\">Minimal, complete, verifiable example</a> applies here.  We cannot effectively help you until you post your MCVE code and accurately describe the problem. We should be able to paste your posted code into a text file and reproduce the problem you described. &quot;Doesn&#39;t work&quot; is not a problem specification."}, {"owner": {"reputation": 51837, "user_id": 2144669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7393f439028063515255b63ed94cfd?s=128&d=identicon&r=PG", "display_name": "David Eisenstat", "link": "https://stackoverflow.com/users/2144669/david-eisenstat"}, "edited": false, "score": 0, "creation_date": 1521077193, "post_id": 49288251, "comment_id": 85583368, "body": "In C++11, <code>vector::data()</code> will return a pointer to the underlying data."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521101565, "post_id": 49288251, "comment_id": 85590809, "body": "how about debug this thing .... on a specific input (not too big so you do not step hundred times over)  and compare with sub-result on paper check for first inconsistency...."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1521102584, "post_id": 49288251, "comment_id": 85591294, "body": "<code>int half = size &#47; 2</code> may be the problem. What if <code>size</code> is not even? Looks like you missed some digits or overflow somewhere (loops that fill arrays). Did you tried with original data of size 2^n? It may work well."}], "answers": [{"tags": [], "owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "is_accepted": false, "score": 0, "last_activity_date": 1521918558, "creation_date": 1521918558, "answer_id": 49468761, "question_id": 49288251, "link": "https://stackoverflow.com/questions/49288251/karatsuba-algorithm-for-multiplication-of-polynomials/49468761#49468761", "title": "Karatsuba algorithm for multiplication of polynomials", "body": "<p>I noticed one-and-a-half issues concerning correctness:</p>\n\n<ol>\n<li>the index in \"the combination loop\" is limited to the recursive calls <em>parameter length</em> instead of the <em>result length</em> (almost twice the parameter length)</li>\n<li>when the limit is correct, the intermediate results \"overlap\", necessitating accumulation instead of assignment.</li>\n</ol>\n\n<p>I never used \"modern C++\" \"in anger\" - if this works, but leaves you dissatisfied with the code, consider posting your concerns on <a href=\"https://codereview.stackexchange.com/help/on-topic\">Code Review</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8005765"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2040, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521918558, "creation_date": 1521064568, "last_edit_date": 1521065810, "question_id": 49288251, "link": "https://stackoverflow.com/questions/49288251/karatsuba-algorithm-for-multiplication-of-polynomials", "title": "Karatsuba algorithm for multiplication of polynomials", "body": "<p>I am trying to implement the recursive Karatsuba algorithm for multiplication of two polynomials (of the same degree). My code still doesn't work for polynomials with degree greater than 1. Can anyone explain to me what I am doing wrong in my function? It should work for even and also for odd numbers of coefficients.</p>\n\n<p>The polynomials are stored in an array of <code>long</code>. Every element represents one coefficient, so <code>1 2 3 4</code> means <code>1 + 2x + 3x^2 + 4x^3</code> and the argument <code>size</code> is the number of coefficients.</p>\n\n<pre><code>long* karatsuba(const long *A, const long *B, int size) {\n    long *lowA, *highA, *lowB, *highB, *midA, *midB;\n\n    if (size == 1)\n        return naive(A, B, size, size);\n\n    int half = size / 2;\n\n    lowA = new long[half];\n    lowB = new long[half];\n    midA = new long[half];\n    midB = new long[half];\n    highA = new long[half];\n    highB = new long[half];\n\n    // init low coefficients\n    for(int i=0; i&lt;half; i++){\n        lowA[i] = A[i];\n        lowB[i] = B[i];\n    }\n\n    // init high // init low coefficients\n    for(int i=half; i&lt;size; i++){\n        highA[i-half] = A[i];\n        highB[i-half] = B[i];\n    }\n\n    // init mid // init low coefficients\n    for(int i=0; i&lt;half; i++){\n        midA[i] = lowA[i] + highA[i];\n        midB[i] = lowB[i] + highB[i];\n    }\n\n    long *z0 = karatsuba(lowA, lowB, half);\n    long *z1 = karatsuba(midA, midB, half);\n    long *z2 = karatsuba(highA, highB, half);\n\n    // compute the result\n    long *result = new long[2*size-1];\n    for(int i=0; i&lt;half; i++){\n        result[i + 2*half] = z2[i];\n        result[i + half] = z1[i] - z0[i] - z2[i];\n        result[i] = z0[i];\n    }\n    return result;\n}\n</code></pre>\n\n<p>My main problem is that this function doesn't compute the correct results.</p>\n"}, {"tags": ["c++", "c++11", "templates"], "comments": [{"owner": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "edited": false, "score": 0, "creation_date": 1521067679, "post_id": 49288250, "comment_id": 85580848, "body": "&gt; &quot;My problem/concern is, if it was going to be implemented not with vectors or templates, how can I do such thing?&quot;  you don&#39;t. In weaker languages without generics you would have to duplicate your code for each type: <code>void add_matrix_int(matrix_int* lhs, matrix_int* rhs, matrix_int** res);</code> <code>void add_matrix_float(matrix_float* lhs, matrix_float* rhs, matrix_** res);</code> for instance in C89"}, {"owner": {"reputation": 11, "user_id": 9044093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aBXj1.jpg?s=128&g=1", "display_name": "Mostafa Anwar", "link": "https://stackoverflow.com/users/9044093/mostafa-anwar"}, "reply_to_user": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "edited": false, "score": 0, "creation_date": 1521068916, "post_id": 49288250, "comment_id": 85581215, "body": "Thank you for your answer. But I have a small inquiry here by the lhs and the rhs you mean like the first and second matrix? @Jean-Micha&#235;lCelerier"}, {"owner": {"reputation": 5281, "user_id": 1495627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/05f7c73495dfcdc1b6b32b30fdb994f0?s=128&d=identicon&r=PG", "display_name": "Jean-Micha&#235;l Celerier", "link": "https://stackoverflow.com/users/1495627/jean-micha%c3%abl-celerier"}, "edited": false, "score": 0, "creation_date": 1521071459, "post_id": 49288250, "comment_id": 85581973, "body": "Yes -- it&#39;s short-hand for left-hand side and right-hand side, referring to what you would write: <code>matrixA + matrixB;</code>"}], "owner": {"reputation": 11, "user_id": 9044093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aBXj1.jpg?s=128&g=1", "display_name": "Mostafa Anwar", "link": "https://stackoverflow.com/users/9044093/mostafa-anwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521067231, "creation_date": 1521064567, "last_edit_date": 1521067231, "question_id": 49288250, "link": "https://stackoverflow.com/questions/49288250/changing-from-template-to-normal-data-types-int-float-etc", "title": "changing from template to normal data types (int,float,...etc)", "body": "<p>I had to make a group project. Its idea is to make all mathematical properties on two matrices (add, multiply, transpose, subtract), but we had to use templates and vectors.</p>\n\n<p>My problem/concern is, if it was going to be implemented not with vectors or templates, how can I do such thing?</p>\n\n<p>For example, this part:</p>\n\n<pre><code>//Matrix is the class name,mtrx is a private vector in the class\nMatrix&lt;T&gt; Matrix&lt;T&gt;::operator+(const Matrix&lt;T&gt;&amp; obj){\n    Matrix&lt;T&gt; res(*this);\n    int r1,c1,r2,c2;\n    r1 = mtrx.size();\n    c1 = mtrx[0].size();\n    r2 = obj.mtrx.size();\n    c2 = obj.mtrx[0].size();\n    if(r1==r2 &amp;&amp; c1==c2){\n        for(int i = 0; i &lt; r1; i++){\n            for(int j = 0; j &lt; c1; j++){\n                res.mtrx[i][j] += obj.mtrx[i][j];\n            }\n        }\n        return res;\n    }\n    throw invalid_argument(\"Cannot add, matrices don't have same dimensions\");\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "gcc", "locale"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1521066582, "post_id": 49288019, "comment_id": 85580435, "body": "Depends how classic you want to get.  It makes it consistent with what the OS assumes.  Underlying call is <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd318117(v=vs.85).aspx\" rel=\"nofollow noreferrer\">GetStringTypeA()</a>, retrieving the C1_TYPE for a character. \\n is AT&amp;T, \\r\\n is DEC and \\n was pretty blank on the teletype :)  Pretty typical Windows approach, it strongly avoids having multiple oracles."}, {"owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521087857, "post_id": 49288019, "comment_id": 85585781, "body": "I want classic to be what the standard says it should be and what their own CRT version of the function and documentation says.  Anyway I submitted it and they admitted it&#39;s a known problem so I guess that&#39;s that."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1521090939, "post_id": 49288019, "comment_id": 85586646, "body": "I know, I know, nobody ever cares why it is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 6, "last_activity_date": 1521064681, "last_edit_date": 1592644375, "creation_date": 1521064176, "answer_id": 49288172, "question_id": 49288019, "link": "https://stackoverflow.com/questions/49288019/inconsistent-return-from-stdisblank-between-visual-c-and-gcc-which-one-is-w/49288172#49288172", "title": "Inconsistent return from std::isblank between Visual C++ and gcc. Which one is wrong?", "body": "<p>Yes, MSVS is wrong.  <strong>[locale.statics]</strong> states:</p>\n<blockquote>\n<pre><code>static const locale&amp; classic();\n</code></pre>\n<ol start=\"4\">\n<li><p>The &quot;C&quot; locale.</p>\n</li>\n<li><p>Returns: A locale that implements the classic &quot;C&quot; locale semantics, equivalent to the value locale(&quot;C&quot;).</p>\n</li>\n<li><p>Remarks: This locale, its facets, and their member functions, do not change with time.</p>\n</li>\n</ol>\n</blockquote>\n<p>Thus the following:</p>\n<pre><code>std::isblank('\\n', std::locale::classic()); \n</code></pre>\n<p>Is the same as:</p>\n<pre><code>std::isblank('\\n');  \n \n</code></pre>\n<p>Where <code>locale(&quot;C&quot;)</code> has been called.</p>\n"}], "owner": {"reputation": 2275, "user_id": 5869304, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ed0827adc1d5b81f2125f83c44e7feb5?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5869304/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 1, "accepted_answer_id": 49288172, "answer_count": 1, "score": 9, "last_activity_date": 1521064681, "creation_date": 1521063451, "last_edit_date": 1521064409, "question_id": 49288019, "link": "https://stackoverflow.com/questions/49288019/inconsistent-return-from-stdisblank-between-visual-c-and-gcc-which-one-is-w", "title": "Inconsistent return from std::isblank between Visual C++ and gcc. Which one is wrong?", "body": "<p>I'm seeing inconsistent behavior in a call to <code>std::isblank</code> between Visual C++ on Windows and gcc on Ubuntu and I'm wondering which one is correct.</p>\n\n<p>On both compilers -- when the default locale is the \"C\" locale -- the following call returns false</p>\n\n<pre><code>std::isblank('\\n');  \n</code></pre>\n\n<p>This is what I expect.  And it squares with what I see on <a href=\"http://en.cppreference.com/w/cpp/string/byte/isblank\" rel=\"nofollow noreferrer\">cppreference.com</a>  </p>\n\n<blockquote>\n  <p>In the default C locale, only space (0x20) and horizontal tab (0x09)\n  are classified as blank characters.</p>\n</blockquote>\n\n<p>However with C++, we also have the version that takes a <code>std::locale</code> argument</p>\n\n<pre><code>std::isblank('\\n', std::locale::classic()); \n</code></pre>\n\n<p>Here I am supplying <code>std::locale::classic</code>.  Shouldn't that be the equivalent to the previous call?  Because when I call this second version on Windows, it returns true.  It considers a newline to be a blank character.  Linux still says false.</p>\n\n<p>Is my understanding (about <code>std::locale::classic</code>) correct?  And if so, is the Visual C++ version wrong?</p>\n"}, {"tags": ["c++", "c++11", "templates", "rvalue-reference"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1521063102, "post_id": 49287916, "comment_id": 85578971, "body": "Why are you considering doing this?"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 1, "creation_date": 1521063154, "post_id": 49287916, "comment_id": 85578990, "body": "Its scope is just that expression."}, {"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 1, "creation_date": 1521063267, "post_id": 49287916, "comment_id": 85579048, "body": "@NeilButterworth I want to pass around large objects (containers to be preciese). I am experimenting with possible solutions to avoid copying as much as I can."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1521063321, "post_id": 49287916, "comment_id": 85579075, "body": "How about using pointers?"}, {"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 1, "creation_date": 1521063462, "post_id": 49287916, "comment_id": 85579141, "body": "@NeilButterworth It is an option. As I said, I&#39;m experimenting. I would not call it that way if knew what I was doing ;)"}], "answers": [{"comments": [{"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1521063506, "post_id": 49288017, "comment_id": 85579166, "body": "Can I perfectly forward through object like this?"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 1, "creation_date": 1521063610, "post_id": 49288017, "comment_id": 85579206, "body": "For r/lvalue this approach will have essentially different behavior. I&#39;m afraid this will easily cause hidden bugs in the future."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1521063613, "post_id": 49288017, "comment_id": 85579209, "body": "@bartop Only use <code>std::forward</code> in a <code>&amp;&amp;</code> qualified method on member data, but sure.  Note <code>factory</code> will move-construct a copy.  There really isn&#39;t a safe way to avoid that, tho."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 1, "creation_date": 1521063733, "post_id": 49288017, "comment_id": 85579262, "body": "@lili it behaves like <code>auto&amp;&amp;</code> reference lifetime extension (or not).  You can also use <code>std::decay_t&lt;T&gt; t_;</code> for <code>auto</code> like behaviour."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1521063829, "post_id": 49288017, "comment_id": 85579304, "body": "@Yakk: There&#39;s a quirk here, that this instantiates <code>factory&lt;int&amp;&gt;</code> or <code>factory&lt;int&amp;&amp;&gt;</code> rather than the expected <code>factory&lt;int&gt;</code>. That&#39;s worth calling out explicitly."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1521063970, "post_id": 49288017, "comment_id": 85579358, "body": "@Yakk It might be useful for immediate use, then go out of scope and throw away. Otherwise too error-prone."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1521064171, "post_id": 49288017, "comment_id": 85579432, "body": "@mooing yes, putting the decay in make, then perfect forwarding in factory ctor, can be a better plan."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1521063544, "last_edit_date": 1521063544, "creation_date": 1521063448, "answer_id": 49288017, "question_id": 49287916, "link": "https://stackoverflow.com/questions/49287916/dangers-of-storing-rvalue-references-in-templates/49288017#49288017", "title": "Dangers of storing rvalue references in templates", "body": "<p>Generally do this:</p>\n\n<pre><code>template&lt;class T&gt;\nclass factory {\npublic:\n  factory(T &amp;&amp;t) : t_(std::forward&lt;T&gt;(t)) {}\n\nprivate:\n  T t_; // could be a lvalue ref\n};\n</code></pre>\n\n<p>and it just works.  Really.  Yep, that case too.</p>\n\n<p>Rvalues should not outlive their enclosing statement; so your make factory should not return a struct containing an rvalue ref.</p>\n"}], "owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521063969, "creation_date": 1521062951, "last_edit_date": 1521063969, "question_id": 49287916, "link": "https://stackoverflow.com/questions/49287916/dangers-of-storing-rvalue-references-in-templates", "title": "Dangers of storing rvalue references in templates", "body": "<p>Consider following piece of code:</p>\n\n<pre><code>#include &lt;functional&gt;\n\ntemplate&lt;class T&gt;\nclass factory {\npublic:\n    factory(T &amp;&amp;t) : t_(std::forward&lt;T&gt;(t)) {}\n\nprivate:\n    T &amp;&amp;t_;\n};\n\ntemplate&lt;class T&gt;\nfactory&lt;T&gt; make_factory(T &amp;&amp;t) {\n    return factory&lt;T&gt;(std::forward&lt;T&gt;(t));\n}\n\nint main(){\n    int i = 3;\n    auto bar = make_factory(i); //now it will store int &amp;\n    auto foo = make_factory(5); //now will store int &amp;&amp;\n    return 0;\n}\n</code></pre>\n\n<p>This is of course simplification of code but shows my general idea - I am considering storing references to rvalues. As far as I know in the first case the deduced type will be <code>int &amp;</code> so the factory will be valid until leaving of the scope (due to reference collapsing). My questions are </p>\n\n<ol>\n<li>Is the <code>foo</code> object causing undefined behaviour? </li>\n<li>If not, for how long is the stored rvalue reference valid (I mean, what's its scope)?</li>\n<li>Are there any caveats that I am missing?</li>\n</ol>\n\n<p>EDIT:\nI thought this is enough but I see I have to clarify. I want to achieve something like this:</p>\n\n<pre><code>template&lt;class T&gt;\nclass factory {\npublic:\n    factory(T &amp;&amp;t) : t_(std::forward&lt;T&gt;(t)) {}\n\n    auto make() const &amp; {\n        return wrap(t_);\n    }\n\n    auto make() &amp;&amp; {\n       return wrap(/*what here, move(t_), forward&lt;T&gt;(t_) ?*/);\n    }\nprivate:\n    T t_;//or maybe T&amp;&amp; here?\n};\n</code></pre>\n\n<p>I do not want to copy the member unless I <strong>really</strong> have to. I would like to do something like forwarding through the <code>factory</code> class.</p>\n"}, {"tags": ["c++", "multithreading", "mpi", "openmp", "shared-memory"], "answers": [{"comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1521069199, "post_id": 49289028, "comment_id": 85581312, "body": "Indeed. The difficulty is in <i>finding</i> the incorrect or poorly-formed component(s) when they&#39;re only apparent under extreme load."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 2, "last_activity_date": 1521102337, "last_edit_date": 1521102337, "creation_date": 1521068785, "answer_id": 49289028, "question_id": 49287345, "link": "https://stackoverflow.com/questions/49287345/can-openmp-oversubscription-cause-memory-errors/49289028#49289028", "title": "Can OpenMP oversubscription cause memory errors?", "body": "<p><strong>No.</strong> A correct well-formed parallel program on functioning hardware does not become incorrect from being oversubscribed.</p>\n\n<p>There is simply no correctness assumption being violated by oversubscription. Imagine a non-pinned program - one of it's threads could be migrated by the processor to a core that is already executing another threads. Locally, this is similar to oversubscription, and it must not be incorrect.</p>\n\n<p>You may experience severe performance degradation or program termination due to lack of resources. Of course an incorrect program that <em>appeared</em> to have worked before, can <em>reveal</em> its flaws when run under oversubscription. Oversubscription could possibly exhibit a pattern that reveals existing hardware issues.</p>\n"}], "owner": {"reputation": 606, "user_id": 2525083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/muMuh.jpg?s=128&g=1", "display_name": "xcski", "link": "https://stackoverflow.com/users/2525083/xcski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 2, "accepted_answer_id": 49289028, "answer_count": 1, "score": 2, "last_activity_date": 1521102337, "creation_date": 1521060396, "question_id": 49287345, "link": "https://stackoverflow.com/questions/49287345/can-openmp-oversubscription-cause-memory-errors", "title": "Can OpenMP oversubscription cause memory errors?", "body": "<p>Can oversubscribing the number of OpenMP threads in a hybrid MPI / OpenMP program lead to an incorrect execution of parallel code in C++? By incorrect I mean it does not produce output in a parallel test case as expected.</p>\n\n<p>I am trying to come up with an example of a case where oversubscription, on its own, causes execution of the code to fail. The only cause I can think of and find via research is when there are so many threads used in OpenMP that they cause a stack overflow.</p>\n\n<p>My motivation for the question is I am working on a large project with hybrid OpenMP / MPI where the number of failed tests seems to depend on the number of cores used. I imagine this could be due to a number of issues outside the scope of the question, but I am interested to know whether solely oversubscription could cause correctness tests to fail. </p>\n"}, {"tags": ["c++", "qt"], "answers": [{"comments": [{"owner": {"reputation": 5913, "user_id": 1244932, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d2c608e688b798896e8b516855fc1ab1?s=128&d=identicon&r=PG", "display_name": "user1244932", "link": "https://stackoverflow.com/users/1244932/user1244932"}, "edited": false, "score": 0, "creation_date": 1521078210, "post_id": 49287705, "comment_id": 85583616, "body": "gesture Qt&#39;s example also not works for me on PC without touchpad. I also try to add to gesture example empty mouse event handlers, but changes nothing."}], "tags": [], "owner": {"reputation": 8788, "user_id": 6866309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CFXxE.jpg?s=128&g=1", "display_name": "Pavan Chandaka", "link": "https://stackoverflow.com/users/6866309/pavan-chandaka"}, "is_accepted": false, "score": 0, "last_activity_date": 1521061937, "creation_date": 1521061937, "answer_id": 49287705, "question_id": 49287314, "link": "https://stackoverflow.com/questions/49287314/qgestureevent-for-mouse/49287705#49287705", "title": "QGestureEvent for mouse", "body": "<p>Look into this image widget gestures example. (search for mouseDoubleClickEvent)</p>\n\n<p><a href=\"http://doc.qt.io/qt-5/qtwidgets-gestures-imagegestures-imagewidget-cpp.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qtwidgets-gestures-imagegestures-imagewidget-cpp.html</a></p>\n\n<p>Based on that you need to reimplement the required mouse events.</p>\n\n<pre><code>MyWidget::MyWidget() {\n    ---\n    ---\n}\n\nbool MyWidget::event(QEvent *ev)\n{\n    ---\n    ---\n}\n\nvoid MyWidget::mouseReleaseEvent(QMouseEvent *event)\n{\n\n\n}\nvoid MyWidget::mouseMoveEvent(QMouseEvent *event)\n{\n\n\n}\n</code></pre>\n\n<p>And declare those two functions in header</p>\n\n<pre><code>void mouseReleaseEvent(QMouseEvent *event);\nvoid mouseMoveEvent(QMouseEvent *event);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": true, "score": 4, "last_activity_date": 1522343418, "creation_date": 1522343418, "answer_id": 49561684, "question_id": 49287314, "link": "https://stackoverflow.com/questions/49287314/qgestureevent-for-mouse/49561684#49561684", "title": "QGestureEvent for mouse", "body": "<p>The official way to make gestures out of mouse events in Qt is deriving from the <code>QGestureRecognizer</code> class, which allows to listen to relevant mouse events, set gesture properties accordingly, then trigger the gesture (or cancel it).</p>\n\n<p>Here follows an example for pan gestures only, just to give an idea of what has to be done.</p>\n\n<p>Have a <code>QGestureRecognizer</code> subclass like this:</p>\n\n<pre><code>#include &lt;QGestureRecognizer&gt;\n#include &lt;QPointF&gt;\nclass PanGestureRecognizer : public QGestureRecognizer\n{\n  QPointF startpoint;\n  bool panning;\npublic:\n  PanGestureRecognizer() : panning(false){}\n  QGesture *create(QObject *target);\n  Result recognize(QGesture *state, QObject *watched, QEvent *event);\n};\n</code></pre>\n\n<p>The <code>create</code> method has been overridden to return a new instance of our gesture of interest:</p>\n\n<pre><code>QGesture *PanGestureRecognizer::create(QObject *target)\n{\n  return  new QPanGesture();\n}\n</code></pre>\n\n<p>The <code>recognize</code> method override is the core of our recognizer class, where events are passed in, gesture properties set, gesture events triggered:</p>\n\n<pre><code>QGestureRecognizer::Result PanGestureRecognizer::recognize(QGesture *state, QObject *, QEvent *event)\n{\n  QMouseEvent * mouse = dynamic_cast&lt;QMouseEvent*&gt;(event);\n  if(mouse != 0)\n  {\n    if(mouse-&gt;type() == QMouseEvent::MouseButtonPress)\n    {\n      QPanGesture * gesture = dynamic_cast&lt;QPanGesture*&gt;(state);\n      if(gesture != 0)\n      {\n        panning = true;\n        startpoint = mouse-&gt;pos();\n        gesture-&gt;setLastOffset(QPointF());\n        gesture-&gt;setOffset(QPointF());\n        return TriggerGesture;\n      }\n    }\n    if(panning &amp;&amp; (mouse-&gt;type() == QMouseEvent::MouseMove))\n    {\n      QPanGesture * gesture = dynamic_cast&lt;QPanGesture*&gt;(state);\n      if(gesture != 0)\n      {\n        gesture-&gt;setLastOffset(gesture-&gt;offset());\n        gesture-&gt;setOffset(mouse-&gt;pos() - startpoint);\n        return TriggerGesture;\n      }\n    }\n    if(mouse-&gt;type() == QMouseEvent::MouseButtonRelease)\n    {\n      QPanGesture * gesture = dynamic_cast&lt;QPanGesture*&gt;(state);\n      if(gesture != 0)\n      {\n        QPointF endpoint = mouse-&gt;pos();\n        if(startpoint == endpoint)\n        {\n          return CancelGesture;\n        }\n        panning = false;\n        gesture-&gt;setLastOffset(gesture-&gt;offset());\n        gesture-&gt;setOffset(mouse-&gt;pos() - startpoint);\n        return FinishGesture;\n      }\n    }\n    if(mouse-&gt;type() == QMouseEvent::MouseButtonDblClick)\n    {\n      panning = false;\n      return CancelGesture;\n    }\n    return Ignore;\n  }\n}\n</code></pre>\n\n<p>Basically, we track mouse events, updating a couple of properties of our own (<code>panning</code> and <code>startpoint</code>) and the passed in gesture properties as well. For each mouse event type, we also return a <a href=\"http://doc.qt.io/qt-5/qgesturerecognizer.html#ResultFlag-enum\" rel=\"nofollow noreferrer\">QGestureRecognizer::Result </a>. All other events are discarded (the method returns <code>Ignore</code>).</p>\n\n<p>This code can be tested with the <a href=\"http://doc.qt.io/qt-5/qtwidgets-gestures-imagegestures-example.html\" rel=\"nofollow noreferrer\">Image Gestures Example</a>, though: just add the class to the project and this line in the <code>ImageWidget</code> constructor:</p>\n\n<pre><code>QGestureRecognizer::registerRecognizer(new PanGestureRecognizer());\n</code></pre>\n\n<p>This should let the user grab the picture and move it around, using a mouse.</p>\n"}], "owner": {"reputation": 5913, "user_id": 1244932, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d2c608e688b798896e8b516855fc1ab1?s=128&d=identicon&r=PG", "display_name": "user1244932", "link": "https://stackoverflow.com/users/1244932/user1244932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1405, "favorite_count": 3, "accepted_answer_id": 49561684, "answer_count": 2, "score": 10, "last_activity_date": 1522343418, "creation_date": 1521060246, "last_edit_date": 1522147580, "question_id": 49287314, "link": "https://stackoverflow.com/questions/49287314/qgestureevent-for-mouse", "title": "QGestureEvent for mouse", "body": "<p>I write desktop application that works with map,\nand I want to react on pan and long press events.\nIt is possible to use <code>QGestureEvent</code> on Qt/Linux/X11 with ordinary mouse?</p>\n\n<p>I took <a href=\"http://doc.qt.io/qt-5/qtwidgets-gestures-imagegestures-example.html\" rel=\"noreferrer\">Qt gesture example</a>, it works on tablet,\nbut not reaction on press left mouse button and move (I expect that application recognizes it as tap or swipe event).</p>\n\n<p>Then I added to  <a href=\"http://doc.qt.io/qt-5/qtwidgets-gestures-imagegestures-example.html\" rel=\"noreferrer\">Qt gesture example</a> <code>app.setAttribute(Qt::AA_SynthesizeTouchForUnhandledMouseEvents, true);</code> at <code>main</code> and such code to <code>imagewidget.cpp</code>:</p>\n\n<pre><code>void ImageWidget::mousePressEvent(QMouseEvent *e)\n{\n    e-&gt;ignore();\n}\nvoid ImageWidget::mouseReleaseEvent(QMouseEvent *e)\n{\n    e-&gt;ignore();\n}\nvoid ImageWidget::mouseMoveEvent(QMouseEvent *e)\n{\n    e-&gt;ignore();\n}\n</code></pre>\n\n<p>this code still works on tablet, but again no reaction on mouse on Linux/X11.</p>\n\n<p>Any way to enable qgesture on linux/x11, should I write my own gesture recognition\nfor mouse?</p>\n"}, {"tags": ["c++", "qt", "qt3d"], "comments": [{"owner": {"reputation": 245, "user_id": 2229241, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/244f6f523a25d694c488dc68cfcc5e6b?s=128&d=identicon&r=PG", "display_name": "Moohasha", "link": "https://stackoverflow.com/users/2229241/moohasha"}, "edited": false, "score": 0, "creation_date": 1521061613, "post_id": 49287287, "comment_id": 85578253, "body": "I really like Qt3D but the documentation is still very limited and most of the examples are for QML and for static scenes, so I&#39;m still having trouble wrapping my head around how to do certain things.  If there&#39;s a better way to go to dynamically add and remove new render targets, I&#39;m all ears."}, {"owner": {"reputation": 1170, "user_id": 632150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90d870c57e93d34fac6328699b82f9c?s=128&d=identicon&r=PG", "display_name": "dragly", "link": "https://stackoverflow.com/users/632150/dragly"}, "edited": false, "score": 0, "creation_date": 1521542827, "post_id": 49287287, "comment_id": 85765011, "body": "I think you have come across one of the race conditions that we&#39;ve been working to fix in Qt3D lately. The issue you&#39;re seeing might already have been fixed in Qt 5.11, but I&#39;ll need to test to verify that first. If you have the time, it would be great if you could file a bug report at <a href=\"https://bugreports.qt.io\" rel=\"nofollow noreferrer\">bugreports.qt.io</a> also, to improve the likelihood that it will be fixed in upcoming releases."}, {"owner": {"reputation": 245, "user_id": 2229241, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/244f6f523a25d694c488dc68cfcc5e6b?s=128&d=identicon&r=PG", "display_name": "Moohasha", "link": "https://stackoverflow.com/users/2229241/moohasha"}, "reply_to_user": {"reputation": 1170, "user_id": 632150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90d870c57e93d34fac6328699b82f9c?s=128&d=identicon&r=PG", "display_name": "dragly", "link": "https://stackoverflow.com/users/632150/dragly"}, "edited": false, "score": 0, "creation_date": 1521719639, "post_id": 49287287, "comment_id": 85857050, "body": "@dragly I have submitted a bug report to Qt already."}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 2229241, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/244f6f523a25d694c488dc68cfcc5e6b?s=128&d=identicon&r=PG", "display_name": "Moohasha", "link": "https://stackoverflow.com/users/2229241/moohasha"}, "edited": false, "score": 0, "creation_date": 1521315983, "post_id": 49327785, "comment_id": 85682486, "body": "This is just a simple test application to play around with some aspects of Qt3D.  In my real application I would do a better job managing my objects.I don&#39;t like the idea of keeping unused windows around until the application itself finishes.  Is there any sort of notification from the frame graph or anything else when it is finished with a surface that I could trigger off of to know that it&#39;s safe to delete the window?"}, {"owner": {"reputation": 21, "user_id": 8021227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ebb2b6aece6aa6c2d45293ef88e023e?s=128&d=identicon&r=PG", "display_name": "s.greshake", "link": "https://stackoverflow.com/users/8021227/s-greshake"}, "reply_to_user": {"reputation": 245, "user_id": 2229241, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/244f6f523a25d694c488dc68cfcc5e6b?s=128&d=identicon&r=PG", "display_name": "Moohasha", "link": "https://stackoverflow.com/users/2229241/moohasha"}, "edited": false, "score": 1, "creation_date": 1521458971, "post_id": 49327785, "comment_id": 85723726, "body": "I totally agree with you, to keep the windows isn&#39;t rally a neat solution. I experimented a bit with the method deleteLater() which postpones the deletion of the window until the control returns to the event loop. Unfortunately, this does not solve the problem either."}], "tags": [], "owner": {"reputation": 21, "user_id": 8021227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ebb2b6aece6aa6c2d45293ef88e023e?s=128&d=identicon&r=PG", "display_name": "s.greshake", "link": "https://stackoverflow.com/users/8021227/s-greshake"}, "is_accepted": false, "score": 2, "last_activity_date": 1521226626, "creation_date": 1521226626, "answer_id": 49327785, "question_id": 49287287, "link": "https://stackoverflow.com/questions/49287287/qt3d-crashing-when-removing-frame-graph/49327785#49327785", "title": "Qt3D Crashing when removing frame graph", "body": "<p>I've thoroughly tested your example and draw the same conclusions. When you destroy the window too quickly, the application crashes, probably because Qt3D still tries to issue some OpenGL commands to the underlying QSurface. I think this is a bug that should be reported.</p>\n\n<p>A 'cleaner' work-around of this problem could be to track the generated 3d windows in the main window. You could maintain a list of pointers to all windows that where generated (and probably closed by the user at the some point). The windows are finally destroyed in the destructor of the main window.</p>\n"}, {"tags": [], "owner": {"reputation": 231, "user_id": 9468665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f023ffdd2dfda4337dfe61159d3a30?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Sellers", "link": "https://stackoverflow.com/users/9468665/bill-sellers"}, "is_accepted": false, "score": 0, "last_activity_date": 1541423598, "last_edit_date": 1541423598, "creation_date": 1541360403, "answer_id": 53144678, "question_id": 49287287, "link": "https://stackoverflow.com/questions/49287287/qt3d-crashing-when-removing-frame-graph/53144678#53144678", "title": "Qt3D Crashing when removing frame graph", "body": "<p>I had exactly the same problem. I was creating a class derived from Qt3DWindow in a dialog box so the user could preview the effects of the choices made, and the program crashed when the dialog exited. In fact on Windows this crash causes the debugger and Qt Creator to crash too!</p>\n\n<p>I tried working around this in a variety of ways and some helped because it turns out that it is a threading issue that was fixed on the 23rd October:</p>\n\n<p><a href=\"https://github.com/qt/qt3d/commit/3314694004b825263c9b9f2d69bd85da806ccbbc\" rel=\"nofollow noreferrer\">https://github.com/qt/qt3d/commit/3314694004b825263c9b9f2d69bd85da806ccbbc</a></p>\n\n<p>The fix is now to apply the patch, and recompile Qt. 5.11.3 (or perhaps 5.12) will be out quite soon I expect but this bug is a killer if you are using Qt3D in dialogs.</p>\n"}], "owner": {"reputation": 245, "user_id": 2229241, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/244f6f523a25d694c488dc68cfcc5e6b?s=128&d=identicon&r=PG", "display_name": "Moohasha", "link": "https://stackoverflow.com/users/2229241/moohasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1541423598, "creation_date": 1521060156, "last_edit_date": 1521072595, "question_id": 49287287, "link": "https://stackoverflow.com/questions/49287287/qt3d-crashing-when-removing-frame-graph", "title": "Qt3D Crashing when removing frame graph", "body": "<p>I'm trying to create an application using Qt3D that where I can create multiple view windows on the same scene.  I started with the code from the Qt3DWindow and the <a href=\"https://doc.qt.io/qt-5.10/qt3d-simple-cpp-example.html\" rel=\"nofollow noreferrer\">Simple C++ Example</a> and started moving things around.  What I figured is that each view window would define its own frame graph (just using a simple QForwardRenderer for now) and camera and then I would add each window's frame graph to the main frame graph in my scene.</p>\n\n<p>Everything appears to be working fine as I create multiple windows, but when I close the windows and start removing frame graphs, the application crashes.  It's crashing on a background thread somewhere down in the Qt3DCore or Qt3DRender module and I can't get to the source code.  As I understand it I should be able to modify the frame graph dynamically at run time, but is that not thread safe?  Are you expected to wholesale replace one frame graph with another as opposed to modifying the active frame graph like I'm doing?</p>\n\n<p><strong>--- Edit ---</strong></p>\n\n<p>I did a little more testing and if I delay destroying the QWindow (i.e., the surface that it's trying to render to) a bit after removing its frame graph from the parent frame graph, I don't get the crash.  I <em>do</em> however get some warnings on the console that say:</p>\n\n<blockquote>\n  <p>Qt3D.Renderer.Backend: bool __cdecl Qt3DRender::Render::GraphicsContext::makeCurrent(class QSurface *) makeCurrent failed</p>\n</blockquote>\n\n<p>My guess is it's a threading issue, that the backend is still trying to use the QSurface to render to after it has been destroyed on the main thread.  I don't really like my solution (I just used a single shot timer to delay destroying the window by 1 second), but it's better than crashing.</p>\n\n<p><strong>RenderWindow.h</strong></p>\n\n<pre><code>#ifndef RENDERWINDOW_H\n#define RENDERWINDOW_H\n#include &lt;QWindow&gt;\n#include &lt;Qt3DCore&gt;\n#include &lt;Qt3DRender&gt;\n#include &lt;Qt3DInput&gt;\n#include &lt;Qt3DExtras/QForwardRenderer&gt;\n\nclass RenderWindow : public QWindow\n{\npublic:\n  RenderWindow(QScreen* screen = nullptr);\n  ~RenderWindow();\n\n  Qt3DRender::QCamera* camera() const;\n  Qt3DRender::QFrameGraphNode* frameGraph() const;\n\nprotected:\n  void resizeEvent(QResizeEvent *) override;\n\nprivate:\n  // Rendering\n  Qt3DRender::QFrameGraphNode* mpFrameGraph;\n  Qt3DRender::QCamera* mpCamera;\n\n  static bool msFormatDefined;\n};\n\n#endif // RENDERWINDOW_H\n</code></pre>\n\n<p><strong>RenderWindow.cpp</strong></p>\n\n<pre><code>#include \"renderwindow.h\"\n#include &lt;QDebug&gt;\n\nbool RenderWindow::msFormatDefined = false;\n\nnamespace\n{\n    // Different clear colors so that it's obvious each window is using a\n    // different camera and frame graph.\n    static QColor sClearColors[] = {\n        Qt::darkBlue,\n        Qt::blue,\n        Qt::darkCyan,\n        Qt::cyan\n    };\n    static int sViewCount = 0;\n}\n\nRenderWindow::RenderWindow(QScreen* screen)\n    : QWindow(screen)\n    , mpFrameGraph(nullptr)\n    , mpCamera(new Qt3DRender::QCamera)\n{\n    setSurfaceType(QWindow::OpenGLSurface);\n\n    // Set the default surface format once\n    if (!msFormatDefined)\n    {\n        QSurfaceFormat format;\n        format.setVersion(4, 3);\n        format.setProfile(QSurfaceFormat::CoreProfile);\n        format.setDepthBufferSize(24);\n        format.setSamples(4);\n        format.setStencilBufferSize(8);\n        setFormat(format);\n\n        QSurfaceFormat::setDefaultFormat(format);\n        msFormatDefined = true;\n    }\n\n    // Camera\n    mpCamera-&gt;lens()-&gt;setPerspectiveProjection(45.0f, 16.0f/9.0f, 0.1f, 1000.0f);\n    mpCamera-&gt;setPosition(QVector3D(0, 0, 40.0f));\n    mpCamera-&gt;setViewCenter(QVector3D(0, 0, 0));\n\n    // Frame Graph (using forward renderer for now)\n    Qt3DExtras::QForwardRenderer* renderer = new Qt3DExtras::QForwardRenderer;\n    renderer-&gt;setCamera(mpCamera);\n    renderer-&gt;setSurface(this);\n    renderer-&gt;setClearColor(sClearColors[sViewCount++ % 4]);\n    mpFrameGraph = renderer;\n}\n\nRenderWindow::~RenderWindow()\n{\n    qDebug() &lt;&lt; \"start ~RenderWindow\";\n\n    // Unparent objects.  Probably not necessary but it makes me feel\n    // good inside.\n    mpFrameGraph-&gt;setParent(static_cast&lt;Qt3DCore::QNode*&gt;(nullptr));\n    mpCamera-&gt;setParent(static_cast&lt;Qt3DCore::QNode*&gt;(nullptr));\n\n    delete mpFrameGraph;\n    delete mpCamera;\n\n    qDebug() &lt;&lt; \"end ~RenderWindow\";\n}\n\nQt3DRender::QCamera* RenderWindow::camera() const\n{\n    return mpCamera;\n}\n\nQt3DRender::QFrameGraphNode* RenderWindow::frameGraph() const\n{\n    return mpFrameGraph;\n}\n\nvoid RenderWindow::resizeEvent(QResizeEvent *)\n{\n    mpCamera-&gt;setAspectRatio((float)width()/(float)height());\n}\n</code></pre>\n\n<p><strong>Scene.h</strong></p>\n\n<pre><code>#ifndef SCENE_H\n#define SCENE_H\n#include &lt;Qt3DCore/QEntity&gt;\n\n#include &lt;Qt3DInput/QInputAspect&gt;\n\n#include &lt;Qt3DRender/QFrameGraphNode&gt;\n#include &lt;Qt3DRender/QRenderAspect&gt;\n#include &lt;Qt3DRender/QRenderSettings&gt;\n\nclass RenderWindow;\n\nclass Scene\n{\npublic:\n    Scene();\n    ~Scene();\n\n    Qt3DCore::QEntityPtr rootNode() const;\n\n    void addView(RenderWindow* window);\n\nprivate:\n    void setupScene();\n\nprivate:\n    Qt3DCore::QEntityPtr mpRoot;\n\n    // Frame Graph\n    Qt3DRender::QFrameGraphNode* mpFrameGraph;\n    Qt3DRender::QRenderSettings* mpRenderSettings;\n\n    // Aspects\n    Qt3DCore::QAspectEngine* mpEngine;\n    Qt3DRender::QRenderAspect* mpRenderAspect;\n    Qt3DInput::QInputAspect* mpInputAspect;\n};\n\n#endif // SCENE_H\n</code></pre>\n\n<p><strong>Scene.cpp</strong></p>\n\n<pre><code>#include \"scene.h\"\n\n#include &lt;QDebug&gt;\n#include &lt;QPropertyAnimation&gt;\n\n#include &lt;Qt3DCore/QTransform&gt;\n\n#include &lt;Qt3DRender/QClearBuffers&gt;\n\n#include &lt;Qt3DExtras/QPhongMaterial&gt;\n#include &lt;Qt3DExtras/QCylinderMesh&gt;\n#include &lt;Qt3DExtras/QSphereMesh&gt;\n#include &lt;Qt3DExtras/QTorusMesh&gt;\n\n#include \"orbittransformcontroller.h\"\n#include \"RenderWindow.h\"\n\nScene::Scene()\n    : mpRoot(nullptr)\n    , mpFrameGraph(new Qt3DRender::QFrameGraphNode)\n    , mpRenderSettings(new Qt3DRender::QRenderSettings)\n    , mpEngine(new Qt3DCore::QAspectEngine)\n    , mpRenderAspect(new Qt3DRender::QRenderAspect)\n    , mpInputAspect(new Qt3DInput::QInputAspect)\n{\n    mpEngine-&gt;registerAspect(mpRenderAspect);\n\n    mpRenderSettings-&gt;setActiveFrameGraph(mpFrameGraph);\n\n    setupScene();\n\n    mpRoot-&gt;addComponent(mpRenderSettings);\n    mpEngine-&gt;setRootEntity(mpRoot);\n}\n\nScene::~Scene()\n{\n    qDebug() &lt;&lt; \"start ~Scene\";\n\n    mpEngine-&gt;setRootEntity(Qt3DCore::QEntityPtr());\n    mpRoot.clear();\n\n    delete mpEngine;\n    // mpRenderSettings and mpFrameGraph are children of the\n    // root node and are automatically destroyed when it is.\n\n    qDebug() &lt;&lt; \"end ~Scene\";\n}\n\nQt3DCore::QEntityPtr Scene::rootNode() const\n{\n    return mpRoot;\n}\n\nvoid Scene::addView(RenderWindow* window)\n{\n    // Add the window's frame graph to the main frame graph\n    if (window-&gt;frameGraph())\n    {\n        window-&gt;frameGraph()-&gt;setParent(mpFrameGraph);\n    }\n}\n\nvoid Scene::setupScene()\n{\n    mpRoot.reset(new Qt3DCore::QEntity);\n\n    Qt3DCore::QEntity* entity = new Qt3DCore::QEntity;\n    entity-&gt;setParent(mpRoot.data());\n\n    // Create the material\n    Qt3DExtras::QPhongMaterial *material = new Qt3DExtras::QPhongMaterial(entity);\n    material-&gt;setAmbient(Qt::black);\n    material-&gt;setDiffuse(QColor(196, 196, 32));\n    material-&gt;setSpecular(Qt::white);\n\n    // Torrus\n    Qt3DCore::QEntity *torusEntity = new Qt3DCore::QEntity(entity);\n    Qt3DExtras::QTorusMesh *torusMesh = new Qt3DExtras::QTorusMesh;\n    torusMesh-&gt;setRadius(5);\n    torusMesh-&gt;setMinorRadius(1);\n    torusMesh-&gt;setRings(100);\n    torusMesh-&gt;setSlices(20);\n\n    Qt3DCore::QTransform *torusTransform = new Qt3DCore::QTransform;\n    torusTransform-&gt;setScale3D(QVector3D(1.5, 1, 0.5));\n    torusTransform-&gt;setRotation(QQuaternion::fromAxisAndAngle(QVector3D(1, 0, 0), -45.0f));\n\n    torusEntity-&gt;addComponent(torusMesh);\n    torusEntity-&gt;addComponent(torusTransform);\n    torusEntity-&gt;addComponent(material);\n\n    // Sphere\n    Qt3DCore::QEntity *sphereEntity = new Qt3DCore::QEntity(entity);\n    Qt3DExtras::QSphereMesh *sphereMesh = new Qt3DExtras::QSphereMesh;\n    sphereMesh-&gt;setRadius(3);\n\n    Qt3DCore::QTransform *sphereTransform = new Qt3DCore::QTransform;\n    /*OrbitTransformController *controller = new OrbitTransformController(sphereTransform);\n    controller-&gt;setTarget(sphereTransform);\n    controller-&gt;setRadius(20.0f);\n\n    QPropertyAnimation *sphereRotateTransformAnimation = new QPropertyAnimation(sphereTransform);\n    sphereRotateTransformAnimation-&gt;setTargetObject(controller);\n    sphereRotateTransformAnimation-&gt;setPropertyName(\"angle\");\n    sphereRotateTransformAnimation-&gt;setStartValue(QVariant::fromValue(0));\n    sphereRotateTransformAnimation-&gt;setEndValue(QVariant::fromValue(360));\n    sphereRotateTransformAnimation-&gt;setDuration(10000);\n    sphereRotateTransformAnimation-&gt;setLoopCount(-1);\n    sphereRotateTransformAnimation-&gt;start();*/\n\n    sphereEntity-&gt;addComponent(sphereMesh);\n    sphereEntity-&gt;addComponent(sphereTransform);\n    sphereEntity-&gt;addComponent(material);\n}\n</code></pre>\n\n<p><strong>MainWindow.h</strong></p>\n\n<pre><code>#ifndef MAINWINDOW_H\n#define MAINWINDOW_H\n\n#include &lt;QMainWindow&gt;\n\n#include \"scene.h\"\n\nnamespace Ui {\nclass MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\n    Q_OBJECT\n\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n    ~MainWindow();\n\n    void createWindow();\n\nprivate:\n    Ui::MainWindow *ui;\n    Scene* scene;\n};\n\n#endif // MAINWINDOW_H\n</code></pre>\n\n<p><strong>MainWindow.cpp</strong></p>\n\n<pre><code>#include \"mainwindow.h\"\n#include &lt;QDebug&gt;\n#include \"ui_mainwindow.h\"\n#include \"renderwindow.h\"\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow),\n    scene(new Scene())\n{\n    ui-&gt;setupUi(this);\n    connect(ui-&gt;createButton, &amp;QPushButton::clicked, this, &amp;MainWindow::createWindow);\n}\n\nMainWindow::~MainWindow()\n{\n    qDebug() &lt;&lt; \"~MainWindow\";\n\n    delete scene;\n    delete ui;\n}\n\nvoid MainWindow::createWindow()\n{\n    RenderWindow* window = new RenderWindow();\n    scene-&gt;addView(window);\n    window-&gt;resize(640, 480);\n    window-&gt;show();\n\n    QVector3D pos[] = {\n        QVector3D(0, 0, 40),\n        QVector3D(0, 25, -30),\n        QVector3D(-20, -20, -20),\n        QVector3D(40, 0, 0)\n    };\n    static int count = 0;\n    window-&gt;camera()-&gt;setPosition(pos[count++%4]);\n    window-&gt;camera()-&gt;setViewCenter(QVector3D(0, 0, 0));\n\n    // Delete the window when it is closed.\n    connect(window, &amp;QWindow::visibilityChanged, this, [=](bool on)\n    {\n        if (!on)\n            window-&gt;deleteLater();\n    });\n}\n</code></pre>\n"}, {"tags": ["c++", "dereference", "object-lifetime", "istream-iterator", "const-reference"], "comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1521060824, "post_id": 49287221, "comment_id": 85577888, "body": "The one liner should work: <a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.static.cast#4\" rel=\"nofollow noreferrer\">static.cast</a>. If <code>*it</code> is a <code>pr-value</code> a temporary is materialized to hold the value, this temporary will last until the end of the full expression. if <code>*it</code> is an l-value the result of the static_cast will be a reference directly bound to <code>*it</code>."}, {"owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1521060956, "post_id": 49287221, "comment_id": 85577939, "body": "@Oliv, thanks, I think it would work only because of the <code>const&amp;</code> in the static cast."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1521061286, "post_id": 49287221, "comment_id": 85578091, "body": "Indeed a <code>&amp;</code> without the const would not have work: <a href=\"https://timsong-cpp.github.io/cppwp/n4659/dcl.init.ref#5.2\" rel=\"nofollow noreferrer\">dlc.init.ref</a>"}], "owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521061386, "creation_date": 1521059839, "last_edit_date": 1521061386, "question_id": 49287221, "link": "https://stackoverflow.com/questions/49287221/optimize-inputiterator-dereference-without-making-a-copy-if-possible", "title": "Optimize InputIterator dereference without making a copy if possible?", "body": "<p>I have a legacy code in which the interface is defined for pointer only and I am trying to adapt some functions to take iterators.</p>\n\n<p>In the answers to this question <a href=\"https://stackoverflow.com/questions/49267066/address-of-a-dereferenced-inputiterator/49267131?noredirect=1#comment85539731_49267131\">Address of a dereferenced InputIterator? The case of istream_iterator</a>\nit was noted that <code>std::istream_iterators</code> are <code>InputIterator</code>. \nHowever they are special among <code>InputIterator</code>s, because their dereference is guarantied to generate a language reference <code>T const&amp;</code>.</p>\n\n<p>The code for a general input iterator would look like this, notice that I have to generate a copy of the value type to take the address.</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;iterator&gt;\n#include&lt;sstream&gt;\n\nvoid f_legacy(double const* t){\n    std::cout &lt;&lt; *t &lt;&lt; std::endl;\n};\n\ntemplate&lt;class InputIt&gt;\nvoid f_aux(InputIt it, std::input_iterator_tag){\n    using value_type = typename std::iterator_traits&lt;InputIt&gt;::value_type;\n    value_type v = *it; // creates a local copy, *might be* unnecessary\n    f_legacy(std::addressof(v));\n}\n\ntemplate&lt;class It&gt;\nvoid f(It it){\n    f_aux(it, typename std::iterator_traits&lt;It&gt;::iterator_category{});\n}\nint main(){\n    double d = 5.;\n    std::istringstream iss(\"1 2 3\");\n    std::istream_iterator&lt;double&gt; it(iss);\n    f_legacy(&amp;d);\n    f(it);\n}\n</code></pre>\n\n<p>However for <code>std::istream_iterator</code> this is not optimal because an unnecessary copy is made. (I don't know if it can be optimized, but that is another question.)\nSo I could add an overload to handle the optimizations for <code>istream_iterator</code>.</p>\n\n<pre><code>void f(std::istream_iterator&lt;double&gt; it){\n    f_legacy(std::addressof(*it));\n}\n</code></pre>\n\n<p>or more verbose </p>\n\n<pre><code>void f(std::istream_iterator&lt;double&gt; it){\n    double const&amp; v = *it; // no copy is made\n    f_legacy(std::addressof(v));\n}\n</code></pre>\n\n<p><strong>The question is, can I just use this following version of <code>f</code> <em>without</em> writing an overload of <code>istream_iterator</code>?</strong></p>\n\n<pre><code>template&lt;class InputIt&gt;\nvoid f_aux(InputIt it, std::input_iterator_tag){\n    using value_type = typename std::iterator_traits&lt;InputIt&gt;::value_type;\n    value_type const&amp; v = *it; // a \"copy\" is made only if necessary\n    f_legacy(std::addressof(v));\n}\n</code></pre>\n\n<p>I think this should work due to <a href=\"https://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/\" rel=\"nofollow noreferrer\">https://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/</a> , but I am not sure if it applies.</p>\n\n<p>or even this one liner:</p>\n\n<pre><code>template&lt;class InputIt&gt;\nvoid f_aux(InputIt it, std::input_iterator_tag){\n    using value_type = typename std::iterator_traits&lt;InputIt&gt;::value_type;\n    f_legacy(std::addressof(static_cast&lt;value_type const&amp;&gt;(*it)));\n}\n</code></pre>\n\n<p>Note: In the real code all the functions are templated, <code>double</code> is just a placeholder here.</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1521060030, "post_id": 49287216, "comment_id": 85577559, "body": "Read up on <a href=\"http://en.cppreference.com/w/cpp/language/member_functions#const-.2C_volatile-.2C_and_ref-qualified_member_functions\" rel=\"nofollow noreferrer\">ref-qualified functions</a> cppref link might not be the best resource, actually"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1521060189, "post_id": 49287216, "comment_id": 85577628, "body": "In both cases <code>t</code> is surely an lvalue. You appear to be asking about differentiating between read and write access to <code>t</code>. In which case you probably want to use a proxy - see <a href=\"https://stackoverflow.com/questions/30806786/distinguish-between-read-and-write-using-operator-overloading-in-c\" title=\"distinguish between read and write using operator overloading in c\">stackoverflow.com/questions/30806786/&hellip;</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1521061429, "post_id": 49287216, "comment_id": 85578163, "body": "In C++, &quot;lvalue&quot; and &quot;rvalue&quot; don&#39;t really mean the more traditional &quot;left-hand side of assignment&quot; and &quot;right-hand side of assignment&quot;."}, {"owner": {"reputation": 311, "user_id": 5737011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba17e3baa0f837e2c2cd52c9e5c56426?s=128&d=identicon&r=PG&f=1", "display_name": "firk", "link": "https://stackoverflow.com/users/5737011/firk"}, "edited": false, "score": 0, "creation_date": 1521061953, "post_id": 49287216, "comment_id": 85578416, "body": "Unfortunately, ref-qualified function didn&#39;t helped - it still uses lvalue one for both cases if it exists. As for proxy class - i know it possible, but it looks like too many coding for such a simple problem :(. And yes, it is read vs write access to <code>t</code>, but from compilers point of view it should be read-only vs read-write access to the value returned by <code>[]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 2, "last_activity_date": 1521062665, "last_edit_date": 1521062665, "creation_date": 1521062228, "answer_id": 49287764, "question_id": 49287216, "link": "https://stackoverflow.com/questions/49287216/separate-handlers-lvalue-and-rvalue-operators/49287764#49287764", "title": "separate handlers lvalue and rvalue [] operators", "body": "<p>No and yes.</p>\n\n<p>No, context cannot change the return type of an operator or function in C++.</p>\n\n<p>Yes, you can fake it using a pseudo reference.</p>\n\n<p>A pseudo reference is an object that overloads <code>operator =(T const&amp;)&amp;&amp;</code> and <code>operator T()&amp;&amp;</code>.</p>\n\n<pre><code>struct pr_unsigned { // lazy name, do better\n  unsigned* target;\n  void operator=(unsigned const&amp; in)&amp;&amp;{ *target=in; }\n  operator unsigned()&amp;&amp;{ return *target; }\n  pr_unsigned(pr_unsigned&amp;&amp;)=delete;\n};\n</code></pre>\n\n<p>this is a bit of a toy, but:</p>\n\n<pre><code>pr_unsigned test::operator [](unsigned const idx) { return {&amp;a}; }\n</code></pre>\n\n<p>we now have different code paths for <code>test[2]=3;</code> and <code>foo=test[0];</code>.</p>\n\n<p>This is far from a perfect emulation; <code>auto x = test[2];</code> does the wrong thing.  But it isn't horrid.</p>\n\n<p>You could store a <code>test*</code> and <code>unsigned idx</code> in <code>pr_unsigned</code> and have arbitrary code run on <code>test</code> when elements are assigned to/from.</p>\n"}], "owner": {"reputation": 311, "user_id": 5737011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba17e3baa0f837e2c2cd52c9e5c56426?s=128&d=identicon&r=PG&f=1", "display_name": "firk", "link": "https://stackoverflow.com/users/5737011/firk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 1, "accepted_answer_id": 49287764, "answer_count": 1, "score": 1, "last_activity_date": 1521062665, "creation_date": 1521059815, "last_edit_date": 1521061796, "question_id": 49287216, "link": "https://stackoverflow.com/questions/49287216/separate-handlers-lvalue-and-rvalue-operators", "title": "separate handlers lvalue and rvalue [] operators", "body": "<p>Is there a way to make the [] operator to be handled differently in lvalue and rvalue contexts?</p>\n\n<p>Example code:</p>\n\n<pre><code>include &lt;stdio.h&gt;\n\nclass test {\npublic:\n  unsigned a;\n  unsigned const &amp; operator [](unsigned const idx) const;\n  unsigned &amp; operator [](unsigned const idx);\n};\n\nunsigned const &amp; test::operator [](unsigned const idx) const {\n  printf(\"const [%u] called\\n\", idx);\n  return a;\n}\n\nunsigned &amp; test::operator [](unsigned const idx) {\n  printf(\"non-const [%u] called\\n\", idx);\n  return a;\n}\n\nint main() {\n  test t;\n  unsigned a;\n  a = 0;\n  printf(\"a = %u\\n\", a);\n  t[0] = a;\n  printf(\"stored a to t[0]; a = %u\\n\", a);\n  a = t[0];\n  printf(\"read a from t[0]; a = %u\\n\", a);\n}\n</code></pre>\n\n<p><code>t[0] = a;</code> has lvalue-context [] operator and <code>a = t[0];</code> has rvalue-context [] operator, but they both are handled via non-const function. I tried also to declare <code>unsigned const &amp; test::operator [](unsigned const idx)</code> method but it not compiles and say that such overloading is not allowed. Is there a way (i need it) to handle [] operator via different handlers for <code>t[0]=a;</code> and <code>a=t[0];</code> ?</p>\n\n<p>Please don't mark this as duplicate of <a href=\"https://stackoverflow.com/questions/37051502/c-operator-overloading-for-lvalue-and-rvalue\">C++ Operator Overloading [ ] for lvalue and rvalue</a> because this question is not the same, even if it looks like similarly.</p>\n\n<p>Added simplified code that may be also related:\n    include </p>\n\n<pre><code>class test {\npublic:\n  unsigned a;\n  unsigned const &amp; operator [](unsigned const idx) const;\n  /*unsigned &amp; operator [](unsigned const idx);*/\n};\n\nunsigned const &amp; test::operator [](unsigned const idx) const {\n  printf(\"const [%u] called\\n\", idx);\n  return a;\n}\n\n/*unsigned &amp; test::operator [](unsigned const idx) {\n  printf(\"non-const [%u] called\\n\", idx);\n  return a;\n}*/\n\nint main() {\n  test t;\n  unsigned a;\n  a = t[0];\n  printf(\"read a from t[0]; a = %u\\n\", a);\n}\n</code></pre>\n\n<p>I commented out non-const operator [], removed writing to t[0], and now it compiles and uses needed method for []. But once i uncomment non-const one it starts using it and ignores previous one. And the question, in another words: is there a way to make const one preferred over non-const one in all places where it is possible?</p>\n"}, {"tags": ["c++", "template-meta-programming", "enable-if"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1521059027, "post_id": 49286989, "comment_id": 85577108, "body": "Wait a minute, do you mean you add a class to the <code>std</code> namespace? Besides a very few exceptions, doing that is explicitly <i>undefined behavior</i>."}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521059173, "post_id": 49286989, "comment_id": 85577172, "body": "Yes, I&#39;ve been told not to do so, but it is not what makes or breaks this specific issue. Just some legacy stuff that I forgot to clean up."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1521059222, "post_id": 49286989, "comment_id": 85577193, "body": "<code>typename = std::enable_if_t&lt;cond&gt;</code> should be <code>std::enable_if_t&lt;cond, bool&gt; = false</code>."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 1, "creation_date": 1521059333, "post_id": 49286989, "comment_id": 85577255, "body": "std::enable_if is designed to be used to initialize default constructor or function parameter at compile time. So that constructor or function will or will not be chosen from the list of possible constructor/functions of the same name according to the result of the compile time expression evaluation. Take a look into std::shared_ptr class, it uses this technique."}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1521059668, "post_id": 49286989, "comment_id": 85577401, "body": "I removed the offending <code>std</code> from <code>function_traits</code> and also I tried <code>std::enable_if_t&lt;cond, bool&gt; = false</code> but it doesn&#39;t work. @Jarod42, what do you mean?"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1521059789, "post_id": 49286989, "comment_id": 85577447, "body": "@AOK That is the major problem, you have other problems, like the missing of <code>template</code> for dependent name."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1521063431, "post_id": 49286989, "comment_id": 85579125, "body": "@PasserBy: see <a href=\"https://stackoverflow.com/a/38305320/2684539\">default-template-argument-when-using-stdenable-if</a>."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521064676, "post_id": 49287622, "comment_id": 85579627, "body": "Thanks for the detailed explanation, this looks phenomenal! Once I wake up again, I&#39;m sure I&#39;ll learn 10 new things."}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521121720, "post_id": 49287622, "comment_id": 85604071, "body": "So this did work for me, however, VC++ is still quite picky in how one can use types from derived classes. In my original usage <code>a_type</code> and <code>b_type</code> are actually derived, and further composed of other types. In gcc I can just do <code>Parent::a_type</code> and be done, in VC++ I need to override the parent&#39;s  types with itself, and cannot use anything from the parent class when defining the child&#39;s type. Luckily, it is not a design breaking problem, but a bit annoying. Thanks for the code."}], "tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 3, "last_activity_date": 1521062418, "last_edit_date": 1521062418, "creation_date": 1521061530, "answer_id": 49287622, "question_id": 49286989, "link": "https://stackoverflow.com/questions/49286989/how-to-properly-use-stdenable-if-on-a-constructor/49287622#49287622", "title": "How to properly use std::enable_if on a constructor", "body": "<h3>Dependent names</h3>\n\n<pre><code>typename function_traits&lt;Lambda&gt;::template arg&lt;0&gt;::type\n                                  ^^^^^^^^\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords\">this</a> post for more information on dependent names and when <code>template</code> or <code>typename</code> is needed.</p>\n\n<h3><code>enable_if</code></h3>\n\n<pre><code>typename = std::enable_if_t&lt;condition&gt;\n</code></pre>\n\n<p>should instead be</p>\n\n<pre><code>std::enable_if_t&lt;condition&gt;* = nullptr\n</code></pre>\n\n<p>as @Jarod42 mentioned. This is because the constructors would otherwise be identical and unable to be overloaded. That their default values differ doesn't change this fact. See <a href=\"https://stackoverflow.com/questions/31500426/why-does-enable-if-t-in-template-arguments-complains-about-redefinitions\">this</a> for more information.</p>\n\n<p>Putting it together is</p>\n\n<pre><code>template&lt;typename Lambda, std::enable_if_t&lt;std::is_same_v&lt;typename function_traits&lt;Lambda&gt;::template arg&lt;0&gt;::type, a_type&gt;&gt;* = nullptr&gt;\nA(const Lambda&amp;);\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/a98322eea16e3c2f\" rel=\"nofollow noreferrer\">Live</a></p>\n\n<h3>Side note</h3>\n\n<p><code>function_traits</code> won't work with either overloaded or templated <code>operator()</code>, it can instead be replaced</p>\n\n<pre><code>template&lt;typename T, typename... Args&gt;\nusing return_type = decltype(std::declval&lt;T&gt;()(std::declval&lt;Args&gt;()...));\n\ntemplate&lt;typename T, typename... Args&gt;\nusing mfp = decltype(static_cast&lt;return_type&lt;T, Args...&gt;(T::*)(Args...) const&gt;(&amp;T::operator()));\n\ntemplate&lt;typename Lambda, mfp&lt;Lambda, a_type&gt; = nullptr&gt;\nA(const Lambda&amp;);\n</code></pre>\n\n<p>To check if the callable can be called with the exact arguments without conversions.</p>\n"}], "owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1191, "favorite_count": 0, "accepted_answer_id": 49287622, "answer_count": 1, "score": 0, "last_activity_date": 1521062418, "creation_date": 1521058835, "last_edit_date": 1521059541, "question_id": 49286989, "link": "https://stackoverflow.com/questions/49286989/how-to-properly-use-stdenable-if-on-a-constructor", "title": "How to properly use std::enable_if on a constructor", "body": "<p>This question combines several pieces of code and is a bit complicated, but I tried slimming it down as much as possible.</p>\n\n<p>I am trying to use <code>std::enable_if</code> to conditionally invoke the correct constructor as a result of ambiguous function signatures when a lambda expression is used as input, but the parameters of said lambda expression can be implicitly convertible to one another.</p>\n\n<p>This is an attempt to build upon the following question: <a href=\"https://stackoverflow.com/questions/49280668/why-is-the-constructor-in-this-c-code-ambiguous-and-how-do-i-fix-it\">Here</a>, but is sufficiently different and focuses on <code>std::enable_if</code> to merit another question. I am also providing the <a href=\"http://coliru.stacked-crooked.com/a/33e85093107b13bb\" rel=\"nofollow noreferrer\">Live Example</a> that works with the problem parts commented out.</p>\n\n<p>To inspect the argument (and result) types of the functor, I have the following class:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct function_traits\n    : public function_traits&lt;decltype(&amp;T::operator())&gt;\n{};\n// For generic types, directly use the result of the signature of its 'operator()'\n\ntemplate &lt;typename ClassType, typename ReturnType, typename... Args&gt;\nstruct function_traits&lt;ReturnType(ClassType::*)(Args...) const&gt;\n    // we specialize for pointers to member function\n{\n    enum { num_args = sizeof...(Args) };\n\n    typedef ReturnType result_type;\n\n    template &lt;size_t N&gt;\n    struct arg\n    {\n        typedef typename std::tuple_element&lt;N, std::tuple&lt;Args...&gt;&gt;::type type;\n        // the i-th argument is equivalent to the i-th tuple element of a tuple\n        // composed of those arguments.\n    };\n};\n</code></pre>\n\n<p>Then I try to run the below code, however, the <code>std::enable_if</code> part does not seem to work, but I know that everything within the brackets does (or should) work as demonstrated by the <a href=\"http://coliru.stacked-crooked.com/a/33e85093107b13bb\" rel=\"nofollow noreferrer\">Live Example</a>.</p>\n\n<pre><code>template&lt;typename data_type, typename Type1, typename Type2&gt;\nclass A\n{\npublic:\n    using a_type = std::tuple&lt;Type1, Type2&gt;;\n    using b_type = std::tuple&lt;std::size_t,std::size_t&gt;;\n\n    template&lt;typename Lambda, typename = std::enable_if_t&lt;std::is_same&lt;typename function_traits&lt;Lambda&gt;::arg&lt;0&gt;::type, b_type&gt;::value&gt;&gt;\n    A(const Lambda&amp; Initializer)\n    {\n        std::cout &lt;&lt; \"idx_type\" &lt;&lt; std::endl;\n    }\n    template&lt;typename Lambda, typename = std::enable_if_t&lt;std::is_same&lt;typename function_traits&lt;Lambda&gt;::arg&lt;0&gt;::type, a_type&gt;::value&gt;&gt;\n    A(const Lambda&amp; Initializer)\n    {\n        std::cout &lt;&lt; \"point_type\" &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    auto f = [](std::tuple&lt;long long, int&gt;) -&gt; double { return 2; };\n\n    std::cout &lt;&lt; std::is_same&lt;typename function_traits&lt;decltype(f)&gt;::arg&lt;0&gt;::type, std::tuple&lt;std::size_t, std::size_t&gt;&gt;::value\n        &lt;&lt; std::is_same&lt;typename function_traits&lt;decltype(f)&gt;::arg&lt;0&gt;::type, std::tuple&lt;long long, int&gt;&gt;::value;\n\n    auto a = A&lt;double, long long, int&gt;{\n        [](std::tuple&lt;long long, int&gt;) -&gt; double { return 1; }\n    };\n\n    auto b = A&lt;double, long long, int&gt;{\n        [](std::tuple&lt;std::size_t, std::size_t&gt;) -&gt; double { return 2; }  \n    };\n\n}\n</code></pre>\n\n<p>So what am I missing? I am working off example #5 <a href=\"http://en.cppreference.com/w/cpp/types/enable_if\" rel=\"nofollow noreferrer\">here</a>. </p>\n"}, {"tags": ["c++", "c", "function", "mpi"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 4, "creation_date": 1521058867, "post_id": 49286960, "comment_id": 85577012, "body": "<code>multiply</code> doesn&#39;t return anything (its return type is <code>void</code> and it doesn&#39;t seem to have output parameters). Can you show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so that we can see how you&#39;re calling it?"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521059687, "post_id": 49286960, "comment_id": 85577407, "body": "Consistent indentation makes code much easier to understand."}, {"owner": {"reputation": 31, "user_id": 9493783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cb92eb2cc5135e620a20bffe42475cd?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Ailantes", "link": "https://stackoverflow.com/users/9493783/eric-ailantes"}, "edited": false, "score": 0, "creation_date": 1521059851, "post_id": 49286960, "comment_id": 85577476, "body": "Thank you for your answers. I just edited my question in order to show a simple example of how I use it."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1521060616, "post_id": 49286960, "comment_id": 85577804, "body": "Please, please, please, use proper indenting."}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1521064966, "post_id": 49286960, "comment_id": 85579747, "body": "This is not written in C."}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 8056248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50334383e1823cf5688da4ed39f8cf5b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Holmgren", "link": "https://stackoverflow.com/users/8056248/andrew-holmgren"}, "is_accepted": false, "score": 0, "last_activity_date": 1521059599, "creation_date": 1521059599, "answer_id": 49287155, "question_id": 49286960, "link": "https://stackoverflow.com/questions/49286960/calling-functions-when-using-parallel-programming/49287155#49287155", "title": "Calling functions when using parallel programming", "body": "<p>Aside from the provided code having issues, the answer to your question is no, each processing element will go through the function as it's called, but maybe you don't want each processing element to do the whole dot product and you'd be better off using a scatterv and gatherv to split the program; or maybe each processing element has its own unique vectors that get reduced or added later and you're fine. Be sure to use MPI types.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9493783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cb92eb2cc5135e620a20bffe42475cd?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Ailantes", "link": "https://stackoverflow.com/users/9493783/eric-ailantes"}, "edited": false, "score": 0, "creation_date": 1521060604, "post_id": 49287308, "comment_id": 85577800, "body": "Indeed, it is working now. Thanks a lot."}], "tags": [], "owner": {"reputation": 2577, "user_id": 6263317, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Imx4J.jpg?s=128&g=1", "display_name": "Jon Deaton", "link": "https://stackoverflow.com/users/6263317/jon-deaton"}, "is_accepted": true, "score": 2, "last_activity_date": 1521060223, "creation_date": 1521060223, "answer_id": 49287308, "question_id": 49286960, "link": "https://stackoverflow.com/questions/49286960/calling-functions-when-using-parallel-programming/49287308#49287308", "title": "Calling functions when using parallel programming", "body": "<p>The initial value of <code>dot</code> is not changing is because it is passed by value. A copy of <code>dot</code> is made when passed to <code>multiply</code> and that is the version that is modified. If you want <code>multiply</code> to modify the <code>dot</code> variable, and keep the changes outside the <code>multiply</code> function, pass <code>dot</code> by reference. </p>\n\n<pre><code>void multiply(double* x, double* y, int tai, double&amp; dot);\n</code></pre>\n\n<p>The fact that you are using MPI has no effect on this behavior.</p>\n"}], "owner": {"reputation": 31, "user_id": 9493783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cb92eb2cc5135e620a20bffe42475cd?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Ailantes", "link": "https://stackoverflow.com/users/9493783/eric-ailantes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1521103514, "accepted_answer_id": 49287308, "answer_count": 2, "score": 2, "last_activity_date": 1521060606, "creation_date": 1521058691, "last_edit_date": 1521060606, "question_id": 49286960, "link": "https://stackoverflow.com/questions/49286960/calling-functions-when-using-parallel-programming", "closed_reason": "Needs more focus", "title": "Calling functions when using parallel programming", "body": "<p>I just have a fairly simple question about using MPI in a C++ program. Indeed, let's take this example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include &lt;cblas.h&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\n#include &lt;mpi.h&gt;\n\nvoid multiply(double* x,double* y,int tai,double dot){\n    for(int i=0; i&lt;tai;i=i+1){\n        dot=dot+x[i]*y[i];\n    }\n}\n\nint main(int argc, char* argv[]) {\n    const int n=32;\n    int rank;\n    int size;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n    int tai=n/size;\n    double* x=new double[tai];\n    double* y=new double[tai];\n    srand(time(0)+rank);\n\n    for(int i=0;i&lt;tai;i=i+1){\n        x[i]=(double)rand()/RAND_MAX*10;\n        y[i]=(double)rand()/RAND_MAX*10;\n    }\n    double dot=0;\n    multiply(x,y,tai,dot);\n    double ddot;\n    MPI_Reduce(&amp;dot, &amp;ddot, 1, MPI_DOUBLE, MPI_SUM,0, MPI_COMM_WORLD);\n    if(rank==0){\n        cout&lt;&lt;\"product:\"&lt;&lt;ddot&lt;&lt;endl;\n    }\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>Then, I call my function \"multiply\" in my program to multiply two vectors but unfortunately it returns the initial value of \"dot\" (which is basically 0).</p>\n\n<p>I just would like to know if there is anything special about calling a function when we are doing parallel programming.</p>\n\n<p>PS: I know the whole program is working as it gives me good results when I directly multiply my 2 vectors in the \"main\" function</p>\n"}, {"tags": ["c++", "vector", "allocator", "memory-pool"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1521058288, "post_id": 49286810, "comment_id": 85576717, "body": "<code>std::vector&lt;double&gt; * underlying_vec = new std::vector&lt;double&gt;(3*size, 1.0);</code> is already wrong - there&#39;s no reason to <code>new</code> a <code>vector</code>"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 2, "creation_date": 1521058583, "post_id": 49286810, "comment_id": 85576866, "body": "Why not use a pointer instead of vector? Which features of vector are you going to use, which a pointer doesn&#39;t have? You can <a href=\"https://stackoverflow.com/posts/49286810/edit\">edit</a> your question to show an example of your code that uses the vectors."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1521058827, "post_id": 49286810, "comment_id": 85576988, "body": "Perhaps you should consider using pairs of iterators to map out your smaller vectors to the single larger vectors."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 5, "creation_date": 1521058833, "post_id": 49286810, "comment_id": 85576992, "body": "Maybe look at <a href=\"https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#span-parameters-how-should-i-choose-between-span-and-traditional-ptr-length-parameters\" rel=\"nofollow noreferrer\">gsl::span</a> (a standard proposal) <a href=\"https://github.com/Microsoft/GSL/blob/master/include/gsl/span\" rel=\"nofollow noreferrer\">Source code</a>"}, {"owner": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1521060216, "post_id": 49286810, "comment_id": 85577638, "body": "@UnholySheep I didn&#39;t want the storage of <i>underlying_vec</i> to be deleted when the <i>underlying_vec</i> goes out of scope, that&#39;s why I used new."}, {"owner": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1521060702, "post_id": 49286810, "comment_id": 85577839, "body": "@anatolyg That&#39;s actually what I did in my first try. Since each of these small vectors need to free their corresponding portion of memory independent of each other, without accessing <i>underlying_vector</i>, I don&#39;t think it&#39;s a good idea to delete the heap allocated memory with one new call, in three different delete calls."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 3, "creation_date": 1521061128, "post_id": 49286810, "comment_id": 85578014, "body": "A <code>std::vector</code> owns its own storage. Always. You cannot make it refer to storage owned by some other object. You could try kluging something with a custom allocator which gives the vector memory that was already allocated elsewhere, and doesn&#39;t actually deallocate when told to, but it would be very fragile. Just use something other than <code>std::vector</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "edited": false, "score": 0, "creation_date": 1521061977, "post_id": 49287181, "comment_id": 85578427, "body": "Thanks for your suggestion, however I need a container instead of pointer or span to be able to free its own memory after it&#39;s done."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "edited": false, "score": 0, "creation_date": 1521063302, "post_id": 49287181, "comment_id": 85579065, "body": "@AlirezaMajidi So you want to allocate one large chunk of memory and deallocate different parts of it individually?"}, {"owner": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "edited": false, "score": 0, "creation_date": 1521219455, "post_id": 49287181, "comment_id": 85653435, "body": "Exactly, as I said I get better performance when I allocate a large chunk instead of 3 separate heap allocation."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "edited": false, "score": 0, "creation_date": 1521219813, "post_id": 49287181, "comment_id": 85653636, "body": "@AlirezaMajidi But memory allocation doesn&#39;t work like that. You have to give back the same size chunk that you allocated. Writing an allocator would not circumvent that. The allocator would simply give the whole chuck back after all the pieces had been accounted for. This solution is really not so different. Once you have finished with all your <i>spans</i> you can deallocate the whole chunk when the vector gets deleted."}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 3, "last_activity_date": 1521060779, "last_edit_date": 1521060779, "creation_date": 1521059681, "answer_id": 49287181, "question_id": 49286810, "link": "https://stackoverflow.com/questions/49286810/chunking-a-big-vector-to-smaller-ones-without-extra-heap-allocation/49287181#49287181", "title": "Chunking a big vector to smaller ones without extra heap allocation", "body": "<p>This is the kind of thing <a href=\"https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#span-parameters-how-should-i-choose-between-span-and-traditional-ptr-length-parameters\" rel=\"nofollow noreferrer\">gsl::span</a> is designed for.</p>\n\n<p>You can find an implementation <a href=\"https://github.com/Microsoft/GSL/blob/master/include/gsl/span\" rel=\"nofollow noreferrer\">HERE</a>. It is proposed for inclusion in the <code>C++</code> standard libraries.</p>\n\n<p>You can use it like this:</p>\n\n<pre><code>void double_data(gsl::span&lt;int&gt; sp)\n{\n    for(auto&amp; i: sp)\n        i *= 2;\n}\n\nvoid tripple_data(gsl::span&lt;int&gt; sp)\n{\n    for(auto&amp; i: sp)\n        i *= 3;\n}\n\nint main()\n{\n    std::vector&lt;int&gt; v = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n\n    auto sp = gsl::make_span(v); // the whole vector\n\n    auto sp1 = sp.subspan(0, 5); // first 5 elements\n    auto sp2 = sp.subspan(5, 5); // last five elements\n\n    double_data(sp1); // process it like you would a container\n\n    tripple_data(sp2);\n\n    for(auto i: v)\n        std::cout &lt;&lt; i &lt;&lt; ' ';\n    std::cout &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>2 4 6 8 10 18 21 24 27 30 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "edited": false, "score": 0, "creation_date": 1521221872, "post_id": 49308812, "comment_id": 85654789, "body": "If I understood aliasing constructor correctly, it just changes where the shared_ptr points to. This means that if I have to do the copy of the object that actually shared_ptr is created over it (for serialization purpose for example), I need to copy all the underlying buffer, which I guess hurt the performance. shared_ptr aliasing constructor was a new thing to me though, thanks for pointing out."}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 2, "last_activity_date": 1521146452, "creation_date": 1521146452, "answer_id": 49308812, "question_id": 49286810, "link": "https://stackoverflow.com/questions/49286810/chunking-a-big-vector-to-smaller-ones-without-extra-heap-allocation/49308812#49308812", "title": "Chunking a big vector to smaller ones without extra heap allocation", "body": "<p>You can use <code>std::shared_ptr</code>, whose primary purpose is management of shared resources. First of all, create your buffer:</p>\n\n<pre><code>std::shared_ptr&lt;double&gt; underlying(new double[3 * size], std::default_delete&lt;double[]&gt;());\n</code></pre>\n\n<p>Here you have to use <code>default_delete</code> as an explicit deleter, so the correct <code>operator delete[]</code> is used for deallocation. BTW I heard that in C++17 you no longer need to use an explicit deleter, if you use <code>shared_ptr&lt;double[]&gt;</code>.</p>\n\n<p>Then define your smaller containers, using the <em>aliasing constructor</em>:</p>\n\n<pre><code>std::shared_ptr&lt;double&gt; vec0(underlying, underlying.get());\nstd::shared_ptr&lt;double&gt; vec1(underlying, underlying.get() + size);\nstd::shared_ptr&lt;double&gt; vec2(underlying, underlying.get() + 2 * size);\n</code></pre>\n\n<p>Here you can use your \"vectors\" until the last of them goes out of scope, and when that happens, the buffer is deallocated. However, these are not vectors \u2014 e.g. they don't store their size, only the pointer to first element.</p>\n"}], "owner": {"reputation": 115, "user_id": 1373201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RIEwi.jpg?s=128&g=1", "display_name": "Alireza Majidi", "link": "https://stackoverflow.com/users/1373201/alireza-majidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1521307817, "creation_date": 1521058108, "last_edit_date": 1521307817, "question_id": 49286810, "link": "https://stackoverflow.com/questions/49286810/chunking-a-big-vector-to-smaller-ones-without-extra-heap-allocation", "title": "Chunking a big vector to smaller ones without extra heap allocation", "body": "<p>I need to replace 3 heap allocations for 3 instances of std::vector, with \nonly one contiguous heap allocation and then share it between those 3 vectors. These vector sizes are not going to be changed, so I don't need to be worried about allocation of new contiguous storage in case of pushing or inserting elements to them. My experimental result shows I get up to 2X speed up for different sizes, when I replace these 3 vectors of size <em>n</em>, with one vector of size of *3*n*. </p>\n\n<p>However, I don't know exactly how to achieve the job of making smaller vectors out of the big one, without doing any extra heap allocation.</p>\n\n<pre><code>std::array&lt;std::vector&lt;double&gt;, 3&gt;\nchunck_vector(size_t size)\n{\n  std::vector&lt;double&gt; * underlying_vec = new std::vector&lt;double&gt;(3*size, 1.0);\n\n  // how to avoid extra heap allocations in constructor of small vectors\n  std::vector&lt;double&gt; vec0(underlying_vec-&gt;begin()         , underlying_vec-&gt;begin() + size);\n  std::vector&lt;double&gt; vec1(underlying_vec-&gt;begin() + size  , underlying_vec-&gt;begin() + 2*size);\n  std::vector&lt;double&gt; vec2(underlying_vec-&gt;begin() + 2*size, underlying_vec-&gt;end());\n\n  return {vec0, vec1, vec2};\n}\n\nint main(int argc, char const *argv[])\n{\n  int size = 1000;\n\n  auto&amp;&amp; chunked_vecs = chunck_vector(size);\n\n  // passing each chunk to different functions\n  // each chunk should be responsible for managing its resources\n  foo0(std::get&lt;0&gt;(chunked_vecs));\n  foo1(std::get&lt;1&gt;(chunked_vecs));\n  foo2(std::get&lt;2&gt;(chunked_vecs));\n\n  return 0;\n}\n</code></pre>\n\n<p>I tried writing my own vector class, which its constructor accepts two iterators specifying begin and end of the portion of the <em>underlying_vec</em> storage belongs to this vector, but it doesn't sound a clean solution when it comes to the job of freeing resources when the <em>underlying</em> vector is not accessible any more and solving the memory leakage problem.</p>\n\n<p>Apparently using a customized allocator which is shared between these three vectors and allocates a contiguous memory once and assign it to the corresponding vectors seems a better solution, however since I've never written one, any hint or suggestion to help me start coding will be appreciated.</p>\n"}, {"tags": ["c++", "copy-constructor", "c++17", "move-constructor", "implicit-declaration"], "comments": [{"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1521058608, "post_id": 49286779, "comment_id": 85576879, "body": "I&#39;m not sure, but I think by declaring a move constructor in <code>F</code>, you implicitly delete <code>F</code>&#39;s copy constructor, which in turn implicitly deletes <code>C</code>&#39;s copy constructor.  I would try implementing (or <code>default</code>ing/<code>delete</code>ing) <code>F</code>&#39;s copy constructor, copy/move assignment operators, and destructor to follow the rule of 5."}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1521058850, "post_id": 49286779, "comment_id": 85577004, "body": "@DanielLangr Ahh, good point."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1521060691, "post_id": 49286779, "comment_id": 85577835, "body": "The move constructor in <code>F</code> is implicitly defined."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1521060855, "post_id": 49286779, "comment_id": 85577903, "body": "I think this is ill-formed NDR, but I&#39;m not sure why..."}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 1, "creation_date": 1521060902, "post_id": 49286779, "comment_id": 85577914, "body": "See: <a href=\"https://wandbox.org/permlink/QyLQVFjohdW5XBok\" rel=\"nofollow noreferrer\">wandbox.org/permlink/QyLQVFjohdW5XBok</a>"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 2, "creation_date": 1521061825, "post_id": 49286779, "comment_id": 85578362, "body": "At <code>F&lt;C()&gt; f_;</code>, <code>C</code> is an incomplete type, which corresponds with <code>R</code> template parameter within <code>F</code>, where it is used as template argument for <code>std::is_invocable_r_v</code>. Template arguments of <code>std::is_invocable_r_v</code> cannot be incomplete types. But I am not sure whether this is the cause of the reported problem. If it is, then you have undefined behavior."}, {"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1521063032, "post_id": 49286779, "comment_id": 85578948, "body": "@DanielLangr this appears to be the case, yes. Would you care to make this an answer?"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1521063342, "post_id": 49286779, "comment_id": 85579083, "body": "@yurikilochek I will, just trying to dig a bit deeper into the problem. I still cannot figure out why uncommenting the defaulted move constructor makes the code compilable. Although, if there is undefined behavior, then a compiler is free to behave anything it wants during compilation as well."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1521064035, "post_id": 49286779, "comment_id": 85579385, "body": "@yurikilochek Why should any implicitly-defined constructor of <code>C</code> invoke <code>F::F(F_&amp;&amp;)</code>? Implicitly-defined constructors of <code>C</code> should only invoke implicitly-defined constructors of <code>F</code> in this case, not this user-proveded template constructor. Moreover, the code compiles even when I comment out the whole definition of <code>F::F(F_&amp;&amp;)</code> constructor. And, what&#39;s &quot;worse&quot;, also when I comment out the definition of <code>operator()</code>."}, {"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1521064740, "post_id": 49286779, "comment_id": 85579654, "body": "@DanielLangr <code>F::F(F_&amp;&amp;)</code> is not invoked, but it has to be instantiated to perform overload resolution. But that (deleted) comment was bullshit anyway because explicitly defaulted constructors do the same thing, and still cause UB."}], "answers": [{"comments": [{"owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1521067257, "post_id": 49288427, "comment_id": 85580695, "body": "<code>F::F</code> is instantiated though, from within the default definition of <code>C</code>&#39;s copy/move constructors, which perform member-wise direct-initialization."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "edited": false, "score": 0, "creation_date": 1521067900, "post_id": 49288427, "comment_id": 85580934, "body": "@yurikilochek Why would be instantiated the templated <code>F::F</code>? It is not invoked anywhere. Does it need to be instantiated for constructor overload resolution?"}], "tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": true, "score": 2, "last_activity_date": 1521066714, "last_edit_date": 1521066714, "creation_date": 1521065439, "answer_id": 49288427, "question_id": 49286779, "link": "https://stackoverflow.com/questions/49286779/unexpectedly-missing-implicitly-declared-copy-move-constructors/49288427#49288427", "title": "Unexpectedly missing implicitly declared copy/move constructors", "body": "<p>My best guess is that here:</p>\n\n<pre><code>F&lt;C()&gt; f_;\n</code></pre>\n\n<p><code>C</code> is an incomplete type. Within <code>F</code>, <code>C</code> substitutes the template parameter <code>R</code>, which is then used as a template argument of <code>std::is_invocable_r_v</code>. The Standard does not allow to use incomplete types as template arguments of <code>std::is_invocable_r_v</code> and it results in undefined behavior. Undefined behavior includes, among others, arbitrary behavior of a compiler during compilation.</p>\n\n<hr>\n\n<p>Note that I am not completely sure about my answer, mainly because neither the templated <code>F::F</code> constructor nor its templated <code>operator()</code> is instantiated.</p>\n"}], "owner": {"reputation": 11117, "user_id": 1554020, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/49118fbd7e64a00bc99b19d41e5e28e0?s=128&d=identicon&r=PG", "display_name": "yuri kilochek", "link": "https://stackoverflow.com/users/1554020/yuri-kilochek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 49288427, "answer_count": 1, "score": 2, "last_activity_date": 1521066714, "creation_date": 1521057949, "last_edit_date": 1521060262, "question_id": 49286779, "link": "https://stackoverflow.com/questions/49286779/unexpectedly-missing-implicitly-declared-copy-move-constructors", "title": "Unexpectedly missing implicitly declared copy/move constructors", "body": "<p>Consider the following:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n\ntemplate &lt;typename&gt;\nstruct F;\n\ntemplate &lt;typename R, typename... As&gt;\nstruct F&lt;R(As...)&gt;\n{\n    template &lt;typename F_, std::enable_if_t&lt;\n        std::is_invocable_r_v&lt;R, std::decay_t&lt;F_&gt;, As...&gt;&gt;*...&gt;\n    F(F_&amp;&amp;) {}\n\n    F() = default;\n\n    template &lt;typename... As_, std::enable_if_t&lt;\n        std::is_invocable_v&lt;void(As&amp;&amp;...), As_...&gt;&gt;*...&gt;\n    R operator()(As_&amp;&amp;...)\n    { return R(); }\n};\n\nstruct C\n{\n    F&lt;C()&gt; f_;\n\n    // C(C&amp;&amp;) = default;  // &lt;&lt;&lt; 1\n};\n\nint main() {\n    F&lt;C(int)&gt; x;\n    auto y = x;\n}\n</code></pre>\n\n<p>gcc 7.3.0 fails to compile it (deep within <code>std::is_invocable_r</code>):</p>\n\n<pre><code>error: invalid use of incomplete type\n    \u2018struct std::__or_&lt;std::is_void&lt;C&gt;, std::is_convertible&lt;C, C&gt; &gt;\u2019\n</code></pre>\n\n<p>as does clang 5.0.1:</p>\n\n<pre><code>error: no type named 'type' in\n    'std::__or_&lt;std::is_void&lt;C&gt;, std::is_convertible&lt;C, C&gt; &gt;'\n</code></pre>\n\n<p>From this I deduce that <code>C</code> is missing move and copy constructors. Indeed, if we uncomment its move constructor (1), this code compiles.</p>\n\n<p>I believe the requirements for them to be implicitly declared are satisfied. Why aren't they?</p>\n"}, {"tags": ["c++", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1521058190, "post_id": 49286772, "comment_id": 85576652, "body": "Do you want to stretch the specified range to the full size of the window?"}, {"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 0, "creation_date": 1521058307, "post_id": 49286772, "comment_id": 85576732, "body": "What do you want to show exactly? Do you want to hide the whole window except for that &quot;range&quot; (which just sounds like a rectangle to me, or a <code>SDL_Rect</code> if you prefer)?"}, {"owner": {"reputation": 111, "user_id": 5338875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/26c732229ff95b605822b6e1de52825e?s=128&d=identicon&r=PG&f=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5338875/aaa"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1521058831, "post_id": 49286772, "comment_id": 85576989, "body": "@HolyBlackCat Yes, exactly"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1521059828, "post_id": 49286772, "comment_id": 85577463, "body": "<a href=\"https://wiki.libsdl.org/SDL_RenderSetClipRect\" rel=\"nofollow noreferrer\"><code>SDL_RenderSetClipRect()</code></a>?"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1521084606, "post_id": 49286772, "comment_id": 85585019, "body": "Can you provide a clear use case to that? As it sounds now, it is highly unusual case and I highly doubt it would be possible with SDL directly. But maybe that is not even a solution to your problem. So - what is your initial problem that you&#39;re trying to solve (i.e. where do you want to use that kind of window and why)?"}], "owner": {"reputation": 111, "user_id": 5338875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/26c732229ff95b605822b6e1de52825e?s=128&d=identicon&r=PG&f=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5338875/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1521064476, "creation_date": 1521057903, "last_edit_date": 1521064476, "question_id": 49286772, "link": "https://stackoverflow.com/questions/49286772/how-to-specify-the-visible-range-of-a-sdl-renderer-window", "title": "How to specify the visible range of a SDL renderer window", "body": "<p>I am trying to make a SDL window, the problem is that I only need a specific range of the window to be generally visible, like from 50 to 100 in x direction and 70 to 150 in y. Imagine I want a window with width of 500 and height of 500, but I want to show the mentioned range of x and y (50 to 100 in x direction and 70 to 150 in y.) in this window:\n<br/><img src=\"https://i.stack.imgur.com/UXKl9.png\" alt=\"example image\"/><br/>\nHow should I specify that in my code. : </p>\n\n<pre><code>&gt; if (SDL_Init(SDL_INIT_EVERYTHING) &lt; 0) {\n&gt;         std::cout &lt;&lt; \"Error initializing SDL: \" &lt;&lt; SDL_GetError() &lt;&lt; std::endl;\n&gt;     }\n&gt;      SDL_Window* window = SDL_CreateWindow(\"window\",\n&gt;       SDL_WINDOWPOS_CENTERED,\n&gt;       SDL_WINDOWPOS_CENTERED,\n&gt;       SCREEN_W, SCREEN_H, -----&gt; here I specify the width and height\n&gt;       SDL_WINDOW_SHOWN);\n&gt; \n&gt;           SDL_Renderer* renderer = SDL_CreateRenderer(window, -1, 0);\n&gt;           SDL_RenderPresent(renderer);\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521057967, "post_id": 49286754, "comment_id": 85576521, "body": "No there is not - but you can round the number to a number of significance places"}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521058063, "post_id": 49286754, "comment_id": 85576579, "body": "@EdHeal can you please provide more details how to do that?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521058078, "post_id": 49286754, "comment_id": 85576586, "body": "This is an output problem. Set how many places you want to display and you&#39;ll get nice, rounded values. In the debugger you should expect ugly, raw values to be shown."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521058412, "post_id": 49286754, "comment_id": 85576782, "body": "Perhaps read up about <code>cout</code> and <code>setprecision</code>. The debugger will display the true value that the computer understands. If you want a less precise value that read up <code>cout</code> and <code>setprecision</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1521058482, "post_id": 49286754, "comment_id": 85576821, "body": "<a href=\"http://www.cplusplus.com/reference/iomanip/setprecision/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/iomanip/setprecision</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1521058713, "post_id": 49286754, "comment_id": 85576924, "body": "<a href=\"http://en.cppreference.com/w/cpp/io/manip/setprecision\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/manip/setprecision</a>"}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521059380, "post_id": 49286754, "comment_id": 85577276, "body": "setprecision will not solve my issue I will get 13899 in output and not 13900"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1521060731, "post_id": 49286754, "comment_id": 85577850, "body": "<code>setprecision</code> will not help if you are viewing numbers in a debugger. If precision is an absolute must you may have to operate in integers and use <a href=\"https://en.wikipedia.org/wiki/Fixed-point_arithmetic\" rel=\"nofollow noreferrer\">fixed point math</a>."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521061398, "post_id": 49286754, "comment_id": 85578146, "body": "I am not viewing in debugger I am doing cout, and it prints 13899."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521061806, "post_id": 49286754, "comment_id": 85578355, "body": "There&#39;s no code with <code>cout</code> in your example, though."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521062189, "post_id": 49286754, "comment_id": 85578548, "body": "@tadman just added, not added originally becouse Cout will not solve probleme as after multiplication I am having different number."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521062248, "post_id": 49286754, "comment_id": 85578576, "body": "That helps clarify considerably. Remember that floating point math can be a bit imprecise, that&#39;s just how it is, so if you need absolute precision you need to use a fixed-point system internally. With 64-bit values you can get a <i>lot</i> of precision."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521062501, "post_id": 49286754, "comment_id": 85578700, "body": "@tadman can you please provide more details what you mean saying &#39;fixed-point system internally&#39; and <code>64-bit values</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521062684, "post_id": 49286754, "comment_id": 85578792, "body": "If you need, for example, 10 places of precision, you use integer values that are all multiplied by ten billion. Since 64-bit values are in the range of +/- 9.2e18 then you can get +/- 9.2 billion with ten places of precision, or in other words, more than you get with a 32-bit integer value that has no precision."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1521063262, "post_id": 49286754, "comment_id": 85579042, "body": "What we see from the output is <code>double</code> numbers are rounding as one would expect when printed, but the <code>long</code> numbers aren&#39;t. The <code>long</code> numbers are already damaged here: <code>const long long longLongResult_3 = value1_39 * m_10000double;</code> This makes no attempt at rounding, it truncates (just lops off the fractional portion). <code>const long long longLongResult_3 = std::llround(value1_39 * m_10000double);</code> may do what you want, depending on what it is you really want. I do not believe you can get a get a compile time  constant out of it <code>llround</code>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1521063313, "post_id": 49286754, "comment_id": 85579068, "body": "Docs on C++ rounding functions: <a href=\"http://en.cppreference.com/w/cpp/numeric/math/round\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/numeric/math/round</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521061037, "post_id": 49287177, "comment_id": 85577974, "body": "but why when I multiply 1.39 * 100 000 I get 139000 but with multipling by 10 000 not."}, {"owner": {"reputation": 1548, "user_id": 1365061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/663f21bc0ace65ff9405fc115ec61980?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1365061/alex"}, "reply_to_user": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 1, "creation_date": 1521061372, "post_id": 49287177, "comment_id": 85578136, "body": "This could be because of the order of magnitude. 10000 has 5 digits, 1.39 has 3 digits (distance 7 - just within the float). Both could be near enough to &quot;show&quot; the problem. When it comes to 100000 you have 6 digits but you have one more magnitude difference to 1.39 (distance 8 - just out of float). Therefore one of the trailing digits gets cut off and you get a more &quot;natural&quot; result."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521061473, "post_id": 49287177, "comment_id": 85578187, "body": "thanks for answer, maybe you can include this in your original answer."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521061530, "post_id": 49287177, "comment_id": 85578219, "body": "One more thing is there any algorithm to check is the number  base two number?"}, {"owner": {"reputation": 1548, "user_id": 1365061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/663f21bc0ace65ff9405fc115ec61980?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1365061/alex"}, "reply_to_user": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521061891, "post_id": 49287177, "comment_id": 85578390, "body": "I altered my response. According to your other question - It&#39;s hard to know this in advance when you convert a string into a float (A trivial approach could be to manually do the division [in string format] and output an error if it&#39;s not a base 2 but this would be REALLY dirty). I would not rely on ANY solution that might exist. The far more interesting question is your use case. Most likely there is a better solution without the hassle of float point impression."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521062373, "post_id": 49287177, "comment_id": 85578636, "body": "my use case is following I have some coefficient which is for adjusting some number  and this is stored as double. So I asked you about check for base two number to add a limitation to not define this number to any value which is not   a base two number."}, {"owner": {"reputation": 1548, "user_id": 1365061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/663f21bc0ace65ff9405fc115ec61980?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1365061/alex"}, "reply_to_user": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 1, "creation_date": 1521062854, "post_id": 49287177, "comment_id": 85578876, "body": "When this is a completely mathematical problem, you should think about a fraction representation. <code>1.39</code> is equal to <code>139&#47;100</code>. This fraction is easily multiplied by <code>10^5</code> and then (after the multiplication) solved to a float result. This is also the way most computer algebraic systems use (otherwise you are screwed). If you need to know if your result is &quot;near&quot; the expected result [eg in IF-ELSE situations] you can use an epsilon-delta criterion with respect to the &quot;expected&quot; result."}, {"owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521063149, "post_id": 49287177, "comment_id": 85578987, "body": "139/100 was also in my mind but it seems for me some dirty fix :)  so I asked here to see maybe there is some nice solution I am not aware. In terms of IF-ELSE situations I know about headache of this with floating point numbers but fortunately in my case I do not have such a case."}, {"owner": {"reputation": 1548, "user_id": 1365061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/663f21bc0ace65ff9405fc115ec61980?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1365061/alex"}, "reply_to_user": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "edited": false, "score": 0, "creation_date": 1521063184, "post_id": 49287177, "comment_id": 85579002, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/166847/discussion-between-alex-and-t-m\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1548, "user_id": 1365061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/663f21bc0ace65ff9405fc115ec61980?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1365061/alex"}, "is_accepted": true, "score": 2, "last_activity_date": 1521062284, "last_edit_date": 1521062284, "creation_date": 1521059668, "answer_id": 49287177, "question_id": 49286754, "link": "https://stackoverflow.com/questions/49286754/how-to-avoid-floating-point-format-error/49287177#49287177", "title": "How to avoid floating point format error", "body": "<p>As the comments already said, no there is no solution. This problem is due to the nature of floating points being stored as base 2 (as you already said). The type floating point is defined in <a href=\"https://en.wikipedia.org/wiki/IEEE_754_revision\" rel=\"nofollow noreferrer\">IEEE 754</a>. Everything that is not a base two number can't be stored precisely in base 2.</p>\n\n<p>To be more specific</p>\n\n<p><strong>You CAN store:</strong></p>\n\n<ul>\n<li>1.25 (2^0 + 2^-2)</li>\n<li>0.75 (2^-1 + 2^-2)</li>\n</ul>\n\n<p>because there is an exact representation.</p>\n\n<p><strong>You CAN'T store:</strong></p>\n\n<ul>\n<li>1.1</li>\n<li>1.4</li>\n</ul>\n\n<p>because this will result in an irrational fracture in the base 2 system. You can try to round or use a sort of arbitrary precision float point library (but even they have their limits [memory/speed]) with a much greater precision than float and then backcast to float after multiplication.</p>\n\n<p>There are also a lot of other related problems when it comes to floating points. You will find out that the result of <code>10^20 + 2</code> is only <code>10^20</code> because you have a fixed digit resolution (6-7 digits for float and 15-16 digits for double). When you calculate with numbers that have huge differences in magnitude the smaller ones will just \"disappear\".</p>\n\n<p><strong>Question: Why does multiply 1.39 * 10^6 get 139000 but multiplying 1.39 * 10^5 not?</strong></p>\n\n<p>This could be because of the order of magnitude. 10000 has 5 digits, 1.39 has 3 digits (distance 7 - just within the float). Both could be near enough to \"show\" the problem. When it comes to 100000 you have 6 digits but you have one more magnitude difference to 1.39 (distance 8 - just out of float). Therefore one of the trailing digits gets cut off and you get a more \"natural\" result. (This is just one reason for this. Compiler, OS and other reasons might exist)</p>\n"}], "owner": {"reputation": 2885, "user_id": 1535428, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/64ab20f64a8d6228c1177c044d0c11a0?s=128&d=identicon&r=PG", "display_name": "T M", "link": "https://stackoverflow.com/users/1535428/t-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 49287177, "answer_count": 1, "score": 0, "last_activity_date": 1521062284, "creation_date": 1521057821, "last_edit_date": 1521062052, "question_id": 49286754, "link": "https://stackoverflow.com/questions/49286754/how-to-avoid-floating-point-format-error", "title": "How to avoid floating point format error", "body": "<p>I am facing with following issue. \nwhen I multiply two numbers depending from values of this numbers I get different results. I tried to experiment with types but didn't get expected result.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;iomanip&gt;\n#include &lt;math.h&gt;    \nint main()\n{\n    const double value1_39 = 1.39;\n    const long long m_100000 = 100000;\n    const long long m_10000 = 10000;\n    const double m_10000double = 10000;\n\n    const long long longLongResult_1 = value1_39 * m_100000;\n    const double doubleResult_1 = value1_39 * m_100000;\n\n    const long long longLongResult_2 = value1_39 * m_10000;\n    const double doubleResult_2 = value1_39 * m_10000;\n\n    const long long longLongResult_3 = value1_39 * m_10000double;\n    const double doubleResult_3 = value1_39 * m_10000double;\n\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; value1_39 &lt;&lt; '\\n';\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; longLongResult_1 &lt;&lt; '\\n';\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; doubleResult_1 &lt;&lt; '\\n';\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; longLongResult_2 &lt;&lt; '\\n';\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; doubleResult_2 &lt;&lt; '\\n';\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; longLongResult_3 &lt;&lt; '\\n';\n   std::cout &lt;&lt; std::setprecision(6) &lt;&lt; doubleResult_3 &lt;&lt; '\\n';\n\n    return 0;\n}\n</code></pre>\n\n<p>result seen in debuger</p>\n\n<pre><code>Variable            Value\nvalue1_39           1.3899999999999999\nm_100000            100000\nm_10000             10000\nm_10000double       10000\n\nlongLongResult_1    139000\ndoubleResult_1      139000\n\nlongLongResult_2    13899\ndoubleResult_2      13899.999999999998\n\nlongLongResult_3    13899\ndoubleResult_3      13899.999999999998\n</code></pre>\n\n<p>result seen in cout</p>\n\n<pre><code>1.39                                                                                                                                    \n139000                                                                                                                                  \n139000                                                                                                                                  \n13899                                                                                                                                   \n13900                                                                                                                                   \n13899                                                                                                                                   \n13900 \n</code></pre>\n\n<p>I know that the problem is that the problem is in nature of keeping floating point format in computer. It keeps data as a fractions in base 2.\nMy question is how to get <strong>1.39</strong> * <strong>10 000</strong> as <strong>13900</strong>?(because I am getting <strong>139000</strong> when multipling with <strong>100000</strong> the same value) is there any trick which can help to achieve my goal?</p>\n\n<p>I have some ideas in my mind bunt not sure are they good enough.</p>\n\n<p>1) pars string to get number from left of . and rigth of doth</p>\n\n<p>2) multiply number by 100 and divide by 100 when calculation is done, but each of this solutions has their drawback. I am wondering is there any nice trick for this.</p>\n"}, {"tags": ["c++", "function", "reference"], "comments": [{"owner": {"reputation": 47, "user_id": 9421105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab6cc01d683faf3d952e31feb3f3f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Itsenough1", "link": "https://stackoverflow.com/users/9421105/itsenough1"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1521057775, "post_id": 49286681, "comment_id": 85576402, "body": "Well how could I use that with VS?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1521057871, "post_id": 49286681, "comment_id": 85576464, "body": "@FredLarson I do not think profiling tool will help here, OP wants referenced count, not called."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1521057996, "post_id": 49286681, "comment_id": 85576540, "body": "@FredLarson &quot;So times it was referenced in code, not called.&quot; I think this is pretty clear."}, {"owner": {"reputation": 47, "user_id": 9421105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab6cc01d683faf3d952e31feb3f3f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Itsenough1", "link": "https://stackoverflow.com/users/9421105/itsenough1"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1521058035, "post_id": 49286681, "comment_id": 85576562, "body": "@FredLarson Well I thought that my title was good enough on the issue. So is that do-able? I figured maybe there is a macro that would do the job since there are some that do stuff like that but had no luck actually finding anything for my issue specifically"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1521058122, "post_id": 49286681, "comment_id": 85576611, "body": "@Itsenough1 I doubt macro will help here. One solution would be to parse preprocessor output with regexp, but that maybe inaccurate. Proper way is to use AST from clang"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1521058784, "post_id": 49286681, "comment_id": 85576961, "body": "Maybe comment out the declaration and definition and then count the compiler errors that refer to the missing declaration? <a href=\"http://coliru.stacked-crooked.com/a/89d837ff08506976\" rel=\"nofollow noreferrer\">Works with clang</a>."}, {"owner": {"reputation": 47, "user_id": 9421105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab6cc01d683faf3d952e31feb3f3f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Itsenough1", "link": "https://stackoverflow.com/users/9421105/itsenough1"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1521060109, "post_id": 49286681, "comment_id": 85577586, "body": "@wally well that wouldn&#39;t be any better than just counting them myself. Ok I guess, will do if there is no easier way"}, {"owner": {"reputation": 1089, "user_id": 5299433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc842e32992ec3c0d8cd694c26afb70?s=128&d=identicon&r=PG&f=1", "display_name": "Smit Ycyken", "link": "https://stackoverflow.com/users/5299433/smit-ycyken"}, "edited": false, "score": 0, "creation_date": 1521060649, "post_id": 49286681, "comment_id": 85577820, "body": "@Itsenough1, sounds interesting but, IMHO almost senselessly. You can try to implement it at compile time using template wrapper around your function."}], "answers": [{"comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1521062816, "post_id": 49287745, "comment_id": 85578860, "body": "This is limited to a single translation unit though"}], "tags": [], "owner": {"reputation": 1089, "user_id": 5299433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2dc842e32992ec3c0d8cd694c26afb70?s=128&d=identicon&r=PG&f=1", "display_name": "Smit Ycyken", "link": "https://stackoverflow.com/users/5299433/smit-ycyken"}, "is_accepted": true, "score": 2, "last_activity_date": 1521063380, "last_edit_date": 1521063380, "creation_date": 1521062137, "answer_id": 49287745, "question_id": 49286681, "link": "https://stackoverflow.com/questions/49286681/count-times-a-function-is-referenced-in-code/49287745#49287745", "title": "Count times a function is referenced in code", "body": "<p>Macro <a href=\"https://msdn.microsoft.com/ru-ru/library/b0084kay.aspx\" rel=\"nofollow noreferrer\"><code>__COUNTER__</code></a> expands to an integer literal that starts at 0 and is incremented by 1 every time it is used in a source file or included headers of the source file. <code>__COUNTER__</code> remembers its state when you use precompiled headers. This macro is always defined.</p>\n\n<pre><code>#include &lt;iostream&gt; \n\ntemplate&lt;typename T&gt; \nstruct Counter \n{\n\n    template&lt;int&gt;\n    static void MyFunction()\n    {\n        std::cout &lt;&lt; \"Do smth.\" &lt;&lt; std::endl;\n    }\n};\n\n#define CountMe MyFunction&lt;__COUNTER__&gt;\n\nint main()\n{\n\n    Counter&lt;int&gt;::CountMe();\n    Counter&lt;double&gt;::CountMe();\n\n    std::cout &lt;&lt; __COUNTER__ &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre><code>Do smth.\nDo smth.\n2\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9421105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab6cc01d683faf3d952e31feb3f3f3a?s=128&d=identicon&r=PG&f=1", "display_name": "Itsenough1", "link": "https://stackoverflow.com/users/9421105/itsenough1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 49287745, "answer_count": 1, "score": 1, "last_activity_date": 1521063380, "creation_date": 1521057560, "last_edit_date": 1521063047, "question_id": 49286681, "link": "https://stackoverflow.com/questions/49286681/count-times-a-function-is-referenced-in-code", "title": "Count times a function is referenced in code", "body": "<p>I want to find a way to keep track of the number of times a function is referenced in the code using a macro (or anything really, just be updated compile-time).</p>\n\n<p>Let's say I have this code:</p>\n\n<pre><code>void n(int* d, int x) {\n    functionCall();\n    *d += x;\n    functionCall();\n    return;\n}\n\nprintf(\"called=%d\", TIMES_CALLED);\n/* called=2 */\n</code></pre>\n\n<p>Basically something like this. I need to make sure it is accurate too, so anything would help.</p>\n"}, {"tags": ["c++", "qt", "architecture", "signals-slots"], "comments": [{"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1521057925, "post_id": 49286453, "comment_id": 85576494, "body": "You need to provide a concrete example of what exactly you want to do in order for people to be able to help you with its design. What data is changed, what updates it mandates and so on."}, {"owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "reply_to_user": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1521058602, "post_id": 49286453, "comment_id": 85576875, "body": "@dtech Is it clear now or it is necessary to make more clarifications?"}, {"owner": {"reputation": 462, "user_id": 3096593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c0c2b3c4ae2f4627e7e8fd2f552f5?s=128&d=identicon&r=PG&f=1", "display_name": "francek", "link": "https://stackoverflow.com/users/3096593/francek"}, "edited": false, "score": 0, "creation_date": 1549556437, "post_id": 49286453, "comment_id": 95952950, "body": "<a href=\"https://stackoverflow.com/a/54577124/3096593\">stackoverflow.com/a/54577124/3096593</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "edited": false, "score": 0, "creation_date": 1521108019, "post_id": 49286603, "comment_id": 85594749, "body": "I am 100% agree with you that it is essential to make separation between gui layer and logic layer. However both my program and your example had weak connection: lets imagine you logic level wrapped into <code>class App</code>. Then <code>class MainWindow</code> has instance of <code>class App</code> inside and to pass selections it calls methods <code>setFolder</code> and <code>setFile</code> on that instance. Extending you example, some change in tree1 can cause changes in directory structure, so it changes both tree1 and tree2 through issuing signal from <code>class App</code> to <code>class MainWindow</code>. So now we have 1 level of hierarchy."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "edited": false, "score": 0, "creation_date": 1521208990, "post_id": 49286603, "comment_id": 85646392, "body": "Well naturally, it is impossible to make it work if there is no connection between the two layers. The thing is that the connection between the two should be a well defined purpose specific API. Again - the core logic layer should be usable entirely on its own as a back end, the GUI should then connect to that in order to display data and issue commands via user input."}, {"owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "edited": false, "score": 0, "creation_date": 1521209379, "post_id": 49286603, "comment_id": 85646675, "body": "But what if <b>logic</b> also has more <b>basic logic</b> inside with the similar relationship between <b>logic</b> and <b>basic logic</b> as between <b>main window</b> and <b>logic</b>? The main problem is the depth of that hierarchy, because it is difficult to manage a lot of levels."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "edited": false, "score": 0, "creation_date": 1521210060, "post_id": 49286603, "comment_id": 85647169, "body": "The API design should handle that without requiring excessive effort from the developer. Good API design is a hard skill to acquire. Most commercial software is actually extremely poorly designed. And the only way is to learn from mistakes, nobody can help you if you can&#39;t give a concrete example for a requirement. I myself have rewritten more than a few applications from scratch because of coming up with substantially better design or hitting framework limitations later on."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "reply_to_user": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "edited": false, "score": 1, "creation_date": 1521210245, "post_id": 49286603, "comment_id": 85647284, "body": "I also heavily rely on my own code generators, I represent structure via basic building blocks and let that generate thousands of lines of code form 5 minutes of putting building blocks together to express my intent, in a matter of milliseconds. That cuts development time by a factor of 100X easy."}], "tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": false, "score": 1, "last_activity_date": 1521061446, "last_edit_date": 1521061446, "creation_date": 1521057248, "answer_id": 49286603, "question_id": 49286453, "link": "https://stackoverflow.com/questions/49286453/too-deep-hierarchy-of-signals-slots-in-qt/49286603#49286603", "title": "Too deep hierarchy of signals-slots in Qt", "body": "<p>Sounds like you might have become a victim of going through too many examples. Examples tend to cram functionality where it doesn't belong, creating the possibility to develop bad programming habits. </p>\n\n<p>In actual production things need to be more compartmentalized. The main window should not be the container of the \"application logic\", all it needs to concern itself with is holding together the main widgets. </p>\n\n<p>But that doesn't seem to be your case, judging by the necessity to delegate things \"<em>from mainwindow (pushbuttons) to leaf nodes</em>\" as you put it.</p>\n\n<p>On a grander scale, it is not advisable to mix application logic with UI at all, much less cram it all in the main window. The application logic should be its own layer, designed so that it can work without any GUI whatsoever, and then the GUI is another layer that simply hooks up to the logic core.</p>\n\n<p>The logic core should not be monolith either, it should be made of individual components focusing on their particular task.</p>\n\n<p>Your use case doesn't really require any crazy amount of connections, just some basic handlers for the UI elements, which should target the logic core API rather than GUI elements as you appear to be doing now.</p>\n\n<p>Your clarification unfortunately makes absolutely no sense to me, it is still completely unclear what you exactly you want to do. </p>\n\n<p>Let's assume your situation is something like this:</p>\n\n<p>Tree 1 shows a folder structure.</p>\n\n<p>Tree 2 shows the file content of the folder, selected in tree 1.</p>\n\n<p>Data is an editor for the file, assuming a text file, selected in tree 2.</p>\n\n<p>So, in pseudocode, presuming that <code>app</code> is your application core logic object:</p>\n\n<p>Clicking an item in tree 1 says <code>app.setFolder(tree1.selectedItem())</code></p>\n\n<p>Clicking an item in tree 2 says <code>app.setFile(tree2.selectedItem())</code></p>\n\n<p>Clicking the editor \"save\" button says <code>app.save(editorUI.dataField.text())</code></p>\n\n<pre><code>logic layer                          gui layer\napp                                  mainWindow\n folder &lt;-----------select----------- tree1\n file   &lt;-----------select----------- tree2\n save(newData) {                      editor\n    if (file) file.rewrite(newData)    textField\n }                                     saveBtn: app.save(textField.text())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1521231870, "creation_date": 1521231870, "answer_id": 49328981, "question_id": 49286453, "link": "https://stackoverflow.com/questions/49286453/too-deep-hierarchy-of-signals-slots-in-qt/49328981#49328981", "title": "Too deep hierarchy of signals-slots in Qt", "body": "<p>Since there is only a single data source, you could do the following:</p>\n\n<ol>\n<li><p>Create a general model for that data source. The model should represent the data source generally, without consideration of what the views need.</p></li>\n<li><p>Create two proxy viewmodels that adapt the general model to the needs of the views.</p></li>\n<li><p>Couple the selection models of the views that display the viewmodels.</p></li>\n</ol>\n\n<p>Given the selection models on top of the two proxy models that map to the same source, we can propagate the selection change between them. We leverage the selection mapping provided by the proxy. The <code>QAbstractProxyModel</code> has a functional implementation of <code>mapSelectionxxxx</code>.</p>\n\n<pre><code>void applySel(const QItemSelectionModel *src, const QItemSelection &amp;sel,\n              const QItemSelection &amp;desel, const QItemSelectionModel *dst) {\n  // Disallow reentrancy on the selection models\n  static QHash&lt;QObject*&gt; busySelectionModels;\n  if (busySelectionModels.contains(src) || busySelectionModels.contains(dst))\n    return;\n  busySelectionModels.insert(src);\n  busySelectionModels.insert(dst);\n  // The models must be proxies\n  auto *srcModel = qobject_cast&lt;QAbstractProxyItemModel*&gt;(src-&gt;model());\n  auto *dstModel = qobject_cast&lt;QAbstractProxyItemModel*&gt;(dst-&gt;model());\n  Q_ASSERT(srcModel &amp;&amp; dstModel);\n  // The proxies must refer to the same source model\n  auto *srcSourceModel = srcModel-&gt;sourceModel();\n  auto *dstSourceModel = dstModel-&gt;sourceModel();\n  Q_ASSERT(srcSourceModel &amp;&amp; (srcSourceModel == dstSourceModel));\n  // Convey the selection\n  auto const srcSel = srcModel-&gt;mapSelectionToSource(sel);\n  auto const srcDesel = srcModel-&gt;mapSelectionToSource(desel);\n  auto const dstSel = dstModel-&gt;mapSelectionFromSource(srcSel);\n  auto const dstDesel = dstModel-&gt;mapSelectionFromSource(srcDesel);\n     // we would re-enter in the select calls\n  dst-&gt;select(dstSel, QItemSelectionModel::Select);\n  dst-&gt;select(dstDesel, QItemSelectionModel::Deselect);\n  // Allow re-entrancy\n  busySelectionModels.remove(src);\n  busySelectionModels.remove(dst);\n}\n</code></pre>\n\n<p>The above could be easily adapted for a list of destination item selection models, in case you had more than two views.</p>\n\n<p>We can use this translation to couple the selection models of the views:</p>\n\n<pre><code>void coupleSelections(QAbstractItemView *view1, QAbstractItemView *view2) {\n  auto *sel1 = view1-&gt;selectionModel();\n  auto *sel2 = view2-&gt;selectionModel();\n  Q_ASSERT(sel1 &amp;&amp; sel2);\n  connect(sel1, &amp;QItemSelectionModel::selectionChanged, \n          [=](const QItemSelection &amp;sel, const QItemSelection &amp;desel){\n            applySel(sel1, sel, desel, sel2);\n          });\n  connect(sel2, &amp;QItemSelectionModel::selectionChanged, \n          [=](const QItemSelection &amp;sel, const QItemSelection &amp;desel){\n            applySel(sel2, sel, desel, sel1);\n          });\n}\n</code></pre>\n\n<p>The above is untested and written from memory, but hopefully will work without much ado.</p>\n"}], "owner": {"reputation": 1292, "user_id": 8044236, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b25c9e70d1b4bb2bde0254c9c82fc75e?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/8044236/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 1, "accepted_answer_id": 49328981, "answer_count": 2, "score": 1, "last_activity_date": 1521231870, "creation_date": 1521056542, "last_edit_date": 1521058462, "question_id": 49286453, "link": "https://stackoverflow.com/questions/49286453/too-deep-hierarchy-of-signals-slots-in-qt", "title": "Too deep hierarchy of signals-slots in Qt", "body": "<p>I am writing GUI applicaton in Qt. Currently I waste too much time on routine. It seems something wrong with my architecture. Please tell me how can I change my approach to improve code.</p>\n\n<p>What I am doing:</p>\n\n<p>My program can be decomposed as hierarchy of classes (not inheritance but composition). In example:</p>\n\n<pre><code>class D { /* something */ };\nclass C { /* something */ };\nclass B { C c1; C c2; D d1; };\nclass A { D d1; C c1; };\n</code></pre>\n\n<p>So, actually it is a tree hierarchy where leaf nodes (class C, class D) are \"models\" in Qt terminology which hold data. At the top of hierarchy MainWindow (class A) is placed, which holds first level of \"views\" (class D, i.e. subwidget) and leaf node with data (class C, i.e. text field).</p>\n\n<p>To pass information down from main window to data I use function calls from mainwindow (pushbuttons) to leaf nodes. After that data changes and tells parents about it with signal slot mechanism. Parents continue to pass message up with signaling.</p>\n\n<p>I am really bored by establishing all these communication. Now I have up to 5 levels, however it is not that much in usual code when using composition. Please tell me how can I change my approach. Due to complexity of these connections, development of the code extremely slow, almost stopped. </p>\n\n<hr>\n\n<p>It is hard to give a concrete example, because there are a lot of code, but the idea of problem which is very difficult to solve is following:</p>\n\n<p>There are two QTreeView, which differently shows data from own model inherited from QAbstractItemModel (tree inside model is not that tree in previous discussion, this tree is only single level of hierarchy). <strong>I want to select objects in one QTreeView and change by that selection in second QTreeView.</strong> There are total 2 QTreeView, 2 different QAbstractItemModel instances, 2 trees of own objects (for each QAbstractItemModel), and <strong>single</strong> data.</p>\n"}, {"tags": ["c++", "constants"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1521056610, "post_id": 49286402, "comment_id": 85575724, "body": "The <code>const</code> following <code>bar</code> makes the guarentee that you will not mutate any of <code>B</code>&#39;s members, which <code>bar</code> does not. To do that, it would have to modify the <i>value</i> of <code>a2</code> or the <i>address</i> of the pointer <code>a1</code>. All it did was modify the value of the <code>A</code> that <code>a1</code> was pointing at, which is legal."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1521056703, "post_id": 49286402, "comment_id": 85575777, "body": "@CoryKramer: except that <code>a1</code> is pointing at <code>a2</code>, and <code>a1</code> is declared as a pointer to a non-const <code>A</code>, so the compiler allows the call to <code>a1-&gt;foo()</code> since the pointed object is not <code>const</code> and <code>foo()</code> is not declared as <code>const</code>, but it can&#39;t validate that <code>a1</code> is actually pointing at a member <code>B</code> that should be const.  The code has <b>undefined behavior</b>.  When <code>bar()</code> calls <code>a2.foo()</code> instead, <code>a2</code> is being accessed via the <code>this</code> pointer, which is a <code>const B*</code> since <code>bar()</code> is <code>const</code>, so <code>a2</code> is <code>const</code> and the compiler fails the call since <code>foo()</code> is not declared as <code>const</code>."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1521056735, "post_id": 49286402, "comment_id": 85575798, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1143262/what-is-the-difference-between-const-int-const-int-const-and-int-const\">What is the difference between const int*, const int * const, and int const *?</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521056822, "post_id": 49286402, "comment_id": 85575843, "body": "@RemyLebeau can you cite the standard part which would claim this behavior undefined? I am pretty sure there are none."}, {"owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1521056843, "post_id": 49286402, "comment_id": 85575853, "body": "@CoryKramer But <code>bar</code> did mutate the value of <code>a2</code>, because <code>a1</code> points to <code>a2</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521057001, "post_id": 49286402, "comment_id": 85575952, "body": "Why would people downvote the question? It rather interesting in my view (though not without a bit of provocation)"}, {"owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "edited": false, "score": 0, "creation_date": 1521057062, "post_id": 49286402, "comment_id": 85575986, "body": "Don&#39;t understand the down votes??? Whats wrong with my question?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521057106, "post_id": 49286402, "comment_id": 85576011, "body": "@bmk do not know. I am afraid, people just do not understand the question (and the fact that it was asked in a certain manner does not help)"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1521057177, "post_id": 49286402, "comment_id": 85576051, "body": "This is a duplicate. Not of the currently proposed duplicate but I am having trouble finding the right one. It was asked just the other day. (this is closeish) <a href=\"https://stackoverflow.com/questions/28732648/c-preventing-const-methods-from-changing-data-through-a-member-pointer-or-refe\" title=\"c preventing const methods from changing data through a member pointer or refe\">stackoverflow.com/questions/28732648/&hellip;</a>"}, {"owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521057411, "post_id": 49286402, "comment_id": 85576195, "body": "@SergeyA provocation, certain manner... Can you be a bit more specific?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521057511, "post_id": 49286402, "comment_id": 85576263, "body": "@bmk, in the same question, you managed to admit your limited knowledge of C++ and fail the language for failing to fulfill the promise. Since most of the time here on SO such messages are complete rubbish, knee-jerk reaction is the downvoting. I am pretty sure, were you to ask the question differently, you would end up upvoted."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1521057617, "post_id": 49286402, "comment_id": 85576312, "body": "Using <a href=\"https://isocpp.org/wiki/faq/const-correctness\" rel=\"nofollow noreferrer\">const correctness</a> allows the compiler to catch potential defects before run-time, such as mistakenly writing to an object or calling a function that writes to a constant object."}, {"owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521057968, "post_id": 49286402, "comment_id": 85576522, "body": "@SergeyA I can only say, wow!!! I didn&#39;t blame or attack the C++ language itself in any way. In fact, I was hoping that I would get some helpful explanations about <code>const</code> (what it actually promises and how I can use it more effectively) from more experienced C++ programmers... Instead you are bombarded with downvotes <b>without any sensible explanations or feedback</b>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1521058062, "post_id": 49286402, "comment_id": 85576578, "body": "what can I say? I disagree with downvotes. (I even upvoted). If it is any consolation, your score is still above 0 with 2 downvotes and 2 upvotes. Also, having an answer from @Yakk is a reward on it&#39;s own :)"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": -1, "last_activity_date": 1521057626, "last_edit_date": 1521057626, "creation_date": 1521056660, "answer_id": 49286480, "question_id": 49286402, "link": "https://stackoverflow.com/questions/49286402/what-good-is-the-cs-const-promise/49286480#49286480", "title": "What good is the c++&#39;s `const` promise?", "body": "<p>This is a correct observation. In const-qualified functions (<code>bar</code> in your example) all data members of the class are behaving as if they are const data members <em>when accessed from this function</em>. With pointers, it means that the pointer itself is constant, but <em>not</em> the object it points to. As a matter of fact, your example can be very much simplified into:</p>\n\n<pre><code>int k = 56;\nint* const i = &amp;k;\n*i = 42;\n</code></pre>\n\n<p>There is a big difference between pointer to constant object and constant pointer, and one needs to understand it, so that 'promises', which were not given in the first place, would not seem to be broken.</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 6, "last_activity_date": 1521056808, "creation_date": 1521056808, "answer_id": 49286517, "question_id": 49286402, "link": "https://stackoverflow.com/questions/49286402/what-good-is-the-cs-const-promise/49286517#49286517", "title": "What good is the c++&#39;s `const` promise?", "body": "<p><code>const</code> tells the caller \"this shouldn't mutate the object\".</p>\n\n<p><code>const</code> helps the implementor with some errors where accidentally mutating state generates errors unless the implementor casts it away.</p>\n\n<p><code>const</code> data (not references, actual data) provides guarantees to the compiler that anyone who modifies this data is doing undefined behaviour; thus, the compiler is free to assume that the data is never modified.</p>\n\n<p><code>const</code> in the <code>std</code> library makes certain guarantees about thread safety.</p>\n\n<p>All of these are uses of <code>const</code>.</p>\n\n<hr>\n\n<p>If an object isn't <code>const</code>, anyone is free to <code>const_cast</code> away <code>const</code> on a reference to the object and modify it.</p>\n\n<p>If an object is <code>const</code>, compilers will not reliably diagnose you casting away <code>const</code>, and generating undefined behavior.</p>\n\n<p>If you mark data as <code>mutable</code>, even if it is also marked as <code>const</code> it won't be.</p>\n\n<p>The guarantees that the <code>std</code> provides based off <code>const</code> are limited by the types you in turn pass into <code>std</code> following those guarantees.</p>\n\n<hr>\n\n<p><code>const</code> doesn't <em>enforce</em> much on the programmer.  It simply tries to help.</p>\n\n<p>No language can make a hostlie programmer friendly; <code>const</code> in C++ doesn't try.  Instead, it tries to make it <em>easier</em> to write <code>const</code>-correct code than to write <code>const</code>-incorrect code.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1521057046, "creation_date": 1521057046, "answer_id": 49286571, "question_id": 49286402, "link": "https://stackoverflow.com/questions/49286402/what-good-is-the-cs-const-promise/49286571#49286571", "title": "What good is the c++&#39;s `const` promise?", "body": "<p>Constness by itself doesn't guarantee you anything. It only takes away rights of specific code to mutate an object through a specific reference. It doesn't take away rights of other code to mutate the same object through other references, right under your feet.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1593202062, "last_edit_date": 1593202062, "creation_date": 1521057282, "answer_id": 49286613, "question_id": 49286402, "link": "https://stackoverflow.com/questions/49286402/what-good-is-the-cs-const-promise/49286613#49286613", "title": "What good is the c++&#39;s `const` promise?", "body": "<blockquote>\n<p>So it seems that one can fairly easily circumvent the compiler with pointers.</p>\n</blockquote>\n<p>That is indeed true.</p>\n<blockquote>\n<p>I guess my main question is, how or if I can be 100% sure that const methods won't cause any mutation to the objects they are invoked with?</p>\n</blockquote>\n<p>The language guarantees that only in a local sense.</p>\n<p>Your class is, indirectly, the same as the following:</p>\n<pre><code>struct Foo\n{\n  int* ptr;\n  Foo() : ptr(new int(0)) {};\n\n  void bar() const { *ptr = 10; }\n};\n</code></pre>\n<p>When you use:</p>\n<pre><code>Foo f;\nf.bar();\n</code></pre>\n<p>the member variable of <code>f</code> did not change since the pointer still points to the location after the call to <code>f.bar()</code> as it did before the call. In that sense, <code>f</code> did not change. But if you extend the &quot;state&quot; of <code>f</code> to include the value of what <code>f.ptr</code> points to, then the state of <code>f</code> did change. The language does not guarantee against such changes.</p>\n<p>It's our job, as designers and developers, to document the &quot;const&quot; semantics of the types we create and provide functions that preserve those semantics.</p>\n<blockquote>\n<p>Or do I have completely false expectations about const?</p>\n</blockquote>\n<p>Perhaps.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1521059899, "last_edit_date": 1521059899, "creation_date": 1521057753, "answer_id": 49286739, "question_id": 49286402, "link": "https://stackoverflow.com/questions/49286402/what-good-is-the-cs-const-promise/49286739#49286739", "title": "What good is the c++&#39;s `const` promise?", "body": "<p>When a class method is declared as <code>const</code>, that means the implicit <code>this</code> pointer inside the method is pointing at a <code>const</code> object and thus the method cannot alter any of the members of that object (unless they are explicitly declared as <code>mutable</code>, which is not the case in this example).</p>\n\n<p>The <code>B</code> constructor is not declared as <code>const</code>, so <code>this</code> is of type <code>B*</code>, ie a pointer to a non-const <code>B</code> object.  So <code>a1</code> and <code>a2</code> are non-const, and <code>a1</code> is declared as a pointer to a non-const <code>A</code> object, so the compiler allows <code>a1</code> to be pointed at <code>a2</code>.</p>\n\n<p><code>bar()</code> is declared as <code>const</code>, so <code>this</code> is of type <code>const B*</code>, ie a pointer to a const <code>B</code> object.</p>\n\n<p>When <code>bar()</code> calls <code>a1-&gt;foo()</code>, <code>a1</code> is <code>const</code> by virtue of <code>this</code> pointing at a <code>const B</code> object, so <code>bar()</code> can't change <code>a1</code> to point at something else.  But the <code>A</code> object that <code>a1</code> is pointing at is still deemed to be non-const by virtue of <code>a1</code>'s declaration, and <code>foo()</code> is not declared as <code>const</code>, so the compiler allows the call.  However, the compiler can't validate that <code>a1</code> is actually pointing at <code>a2</code>, a member of <code>B</code> that is supposed to be <code>const</code> inside of <code>bar()</code>, so the code breaks the <code>const</code> contract and has <strong>undefined behavior</strong>.</p>\n\n<p>When <code>bar()</code> tries to call <code>a2.foo()</code> instead, <code>a2</code> is <code>const</code> by virtue of <code>this</code> pointing at a <code>const B</code> object, but <code>foo()</code> is not declared as <code>const</code>, so the compiler fails the call.</p>\n\n<p><code>const</code> is just a safety catch for well-behaving code.  It does not stop you from shooting yourself in the foot by using misbehaving code.</p>\n"}], "owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 49286517, "answer_count": 5, "score": 3, "last_activity_date": 1593202062, "creation_date": 1521056350, "last_edit_date": 1521061000, "question_id": 49286402, "link": "https://stackoverflow.com/questions/49286402/what-good-is-the-cs-const-promise", "title": "What good is the c++&#39;s `const` promise?", "body": "<p>I am trying to understand c++'s <code>const</code> semantics more in depth but I can't fully understand what really the constness guarantee worth is.\nAs I see it, the constness guarantees that there will be no mutation, but consider the following (contrived) example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;optional&gt;\n#include &lt;memory&gt;\n\nclass A {\npublic:\n  int i{0};\n\n  void foo() {\n    i = 42;\n  };\n};\n\nclass B {\npublic:\n  A *a1;\n  A a2;\n\n  B() {\n    a1 = &amp;a2;\n  }\n\n  void bar() const {\n    a1-&gt;foo();\n  }\n};\n\nint main() {\n  B b;\n  std::cout &lt;&lt; b.a2.i &lt;&lt; std::endl; // output is 0\n\n  b.bar();\n\n  std::cout &lt;&lt; b.a2.i &lt;&lt; std::endl; // output is 42\n}\n</code></pre>\n\n<p>Since <code>bar</code> is <code>const</code>, one would assume that it wouldn't mutate the object <code>b</code>. But after its invocation <code>b</code> is mutated.\nIf I write the method <code>foo</code> like this</p>\n\n<pre><code>void bar() const {\n    a2.foo();\n}\n</code></pre>\n\n<p>then the compiler catches it as expected.\nSo it seems that one can fairly easily circumvent the compiler with pointers. I guess my main question is, how or if I can be 100% sure that <code>const</code> methods won't cause any mutation to the objects they are invoked with? Or do I have completely false expectations about <code>const</code>?</p>\n\n<p><strong>Why does c++ allow invocation of non-const methods over pointers in <code>const</code> methods?</strong></p>\n\n<p>EDIT:</p>\n\n<p>thanks to Galik's comment, I now found this:</p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4372.html\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4372.html</a></p>\n\n<p>Well, this was exactly what I was looking for! Thanks!\nAnd I find Yakk's answer also very helpful, so I'll accept his answer.</p>\n"}, {"tags": ["c++", "c++11", "c++14", "deleted-functions"], "comments": [{"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 3, "creation_date": 1521055831, "post_id": 49286205, "comment_id": 85575306, "body": "A map&#39;s <code>operator[]</code> requires the value type to have a default constructor so it can create an entry in case the key doesn&#39;t exist.  What you should do is something like <code>auto i = my_map.find(key_); if (i != my_map.end()) { auto&amp; val = i-&gt;second; ... } else { handle_non_existent_key(); }</code>"}, {"owner": {"reputation": 9112, "user_id": 2721883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c8448407184c2a90cc46db06c159ca?s=128&d=identicon&r=PG&f=1", "display_name": "clcto", "link": "https://stackoverflow.com/users/2721883/clcto"}, "edited": false, "score": 0, "creation_date": 1521055876, "post_id": 49286205, "comment_id": 85575337, "body": "Read the <a href=\"http://en.cppreference.com/w/cpp/container/unordered_map/operator_at\" rel=\"nofollow noreferrer\">documentation</a>: <i>&quot;When the default allocator is used, this means that key_type must be MoveConstructible and mapped_type must be DefaultConstructible. &quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 5, "last_activity_date": 1521056131, "last_edit_date": 1521056131, "creation_date": 1521055852, "answer_id": 49286281, "question_id": 49286205, "link": "https://stackoverflow.com/questions/49286205/illegal-use-of-deleted-function/49286281#49286281", "title": "illegal use of deleted function", "body": "<p>From <a href=\"http://en.cppreference.com/w/cpp/container/map/operator_at\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/container/map/operator_at</a>:</p>\n\n<blockquote>\n  <p>mapped_type must meet the requirements of CopyConstructible and DefaultConstructible.</p>\n</blockquote>\n\n<p>Since the default constructor is deleted, the compiler rightly reports the error.</p>\n\n<p>Further down in the linked page:</p>\n\n<blockquote>\n  <p><strong>Return value</strong></p>\n  \n  <p>Reference to the mapped value of the new element if no element with key key existed. Otherwise a reference to the mapped value of the existing element whose key is equivalent to key.</p>\n</blockquote>\n\n<p>The function inserts a new element if no element with the given key existed. A default constructor is needed to be able to insert a new element.</p>\n"}], "owner": {"reputation": 1206, "user_id": 3047822, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/RDyN1.png?s=128&g=1", "display_name": "apramc", "link": "https://stackoverflow.com/users/3047822/apramc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 49286281, "answer_count": 1, "score": 0, "last_activity_date": 1521056131, "creation_date": 1521055629, "last_edit_date": 1521056063, "question_id": 49286205, "link": "https://stackoverflow.com/questions/49286205/illegal-use-of-deleted-function", "title": "illegal use of deleted function", "body": "<p>I have a class A</p>\n\n<pre><code>struct A\n{\n    A() = delete;\n    A(const A&amp;) = default;\n    A&amp; operator=(const A&amp;) = default;\n    A(A&amp;&amp;) = default;\n    A&amp; operator=(A&amp;&amp;) = default;\n\n    explicit A(int i) ....\n    // a few explicit constructors\n}\n</code></pre>\n\n<p>when I am trying to get strcut A that is stored in unordered_map as below:</p>\n\n<pre><code>auto a = my_map[key_];\n</code></pre>\n\n<p>I get </p>\n\n<blockquote>\n  <p>illegal use of deleted method</p>\n</blockquote>\n\n<p>error.\nmy understanding was that this is a copy construction, but I do not know why compiler calls the default constructor before the assignement.</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": false, "score": 1, "last_activity_date": 1521056032, "last_edit_date": 1521056032, "creation_date": 1521055181, "answer_id": 49286092, "question_id": 49286028, "link": "https://stackoverflow.com/questions/49286028/unanticipated-infinite-loop/49286092#49286092", "title": "Unanticipated Infinite loop", "body": "<p>IF <code>cin.fail()</code> is true - we are good to go for the loop</p>\n\n<p>After the first attempt of reading two numbers that failed, you clear the status and try again. This is without reading the offending item. It is bound to fail again as the data is left in the stream.</p>\n\n<p>You need to add logic that on failure of reading, you take the appropriate action - like reading the offending data</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1521055792, "creation_date": 1521055792, "answer_id": 49286255, "question_id": 49286028, "link": "https://stackoverflow.com/questions/49286028/unanticipated-infinite-loop/49286255#49286255", "title": "Unanticipated Infinite loop", "body": "<p>If operator <code>&gt;&gt;</code> fails due to input not matching the target type, the characters remain in the stream (even if you clear the fail bit).\nSo if you repeat the same read operation again and again, it will fail again and again. Usually you will skip/ignore characters in such a case. The following example is directly taken from <a href=\"http://en.cppreference.com/w/cpp/io/basic_istream/ignore\" rel=\"nofollow noreferrer\">cppreference/ignore</a>:</p>\n\n<pre><code>int main()\n{\n    std::istringstream input(\"1\\n\"\n                             \"some non-numeric input\\n\"\n                             \"2\\n\");\n    for(;;) {\n        int n;\n        input &gt;&gt; n;\n\n        if (input.eof() || input.bad()) {\n            break;\n        } else if (input.fail()) {\n            input.clear(); // unset failbit\n            input.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n'); // skip bad input\n        } else {\n            std::cout &lt;&lt; n &lt;&lt; '\\n';\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9271646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27b8e24e14f49e94f1e7b09454469a83?s=128&d=identicon&r=PG&f=1", "display_name": "CtrlMj", "link": "https://stackoverflow.com/users/9271646/ctrlmj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1521056432, "answer_count": 2, "score": -4, "last_activity_date": 1521056629, "creation_date": 1521054974, "last_edit_date": 1521055192, "question_id": 49286028, "link": "https://stackoverflow.com/questions/49286028/unanticipated-infinite-loop", "closed_reason": "Duplicate", "title": "Unanticipated Infinite loop", "body": "<p>I stumbled upon this infinite loop. I was supposed to check the user's input not to be of any type other than integer and also not to be a negative number. \nWhy am I getting this infinite loop and more importantly how do I impose these restrictions on the input?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main(){\n    long long int m, k;\n    cin &gt;&gt; m &gt;&gt; k;\n    while (cin.fail() || m &lt; 0 || k &lt; 0){\n        cin.clear();\n        cout &lt;&lt; \"please enter another input\";\n        cin &gt;&gt; m &gt;&gt; k;\n    }\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "text-formatting"], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 1525708, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/77f4d7695bc287a75a859e6f86c5b61d?s=128&d=identicon&r=PG", "display_name": "Alatriste", "link": "https://stackoverflow.com/users/1525708/alatriste"}, "edited": false, "score": 0, "creation_date": 1521054380, "post_id": 49285848, "comment_id": 85574550, "body": "Thank you for answer, So there is no way to use old C cast type without that indent problem right? :("}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521054677, "post_id": 49285848, "comment_id": 85574687, "body": "@Fran&#231;oisAndrieux, thanks for clarification, edited!"}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 447, "user_id": 1525708, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/77f4d7695bc287a75a859e6f86c5b61d?s=128&d=identicon&r=PG", "display_name": "Alatriste", "link": "https://stackoverflow.com/users/1525708/alatriste"}, "edited": false, "score": 0, "creation_date": 1521054818, "post_id": 49285848, "comment_id": 85574754, "body": "@Alatriste, honestly I&#39;m not sure, I&#39;m just giving you a workaround."}, {"owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "reply_to_user": {"reputation": 447, "user_id": 1525708, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/77f4d7695bc287a75a859e6f86c5b61d?s=128&d=identicon&r=PG", "display_name": "Alatriste", "link": "https://stackoverflow.com/users/1525708/alatriste"}, "edited": false, "score": 0, "creation_date": 1521055832, "post_id": 49285848, "comment_id": 85575308, "body": "@Alatriste, maybe this helps you: <a href=\"https://stackoverflow.com/questions/15578935/proper-way-of-casting-pointer-types\" title=\"proper way of casting pointer types\">stackoverflow.com/questions/15578935/&hellip;</a>  And: <a href=\"https://embeddedartistry.com/blog/2017/2/28/c-casting-or-oh-no-we-broke-malloc\" rel=\"nofollow noreferrer\">embeddedartistry.com/blog/2017/2/28/&hellip;</a>"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1521068486, "post_id": 49285848, "comment_id": 85581107, "body": "This isn&#39;t true. You can absolutely use C-style casts in C++, it&#39;s just not a good idea because there are better alternatives available."}], "tags": [], "owner": {"reputation": 3109, "user_id": 6178493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9rTzh.jpg?s=128&g=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/6178493/rama"}, "is_accepted": false, "score": 1, "last_activity_date": 1521120644, "last_edit_date": 1521120644, "creation_date": 1521054293, "answer_id": 49285848, "question_id": 49285788, "link": "https://stackoverflow.com/questions/49285788/visual-studio-2017-indent/49285848#49285848", "title": "Visual studio 2017 indent", "body": "<p>Old style C cast should not be used in c++ code (there are better alternatives available for casting). \nBut in this case, you can just use literal float instead: (And you will killing two problems at one time)</p>\n\n<pre><code>void function(0, 0,\n              1.f, 2);\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 1525708, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/77f4d7695bc287a75a859e6f86c5b61d?s=128&d=identicon&r=PG", "display_name": "Alatriste", "link": "https://stackoverflow.com/users/1525708/alatriste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521120644, "creation_date": 1521054030, "question_id": 49285788, "link": "https://stackoverflow.com/questions/49285788/visual-studio-2017-indent", "title": "Visual studio 2017 indent", "body": "<p>I installed visual studio 2017 professional and I have indent problem.</p>\n\n<p>when I'm typing </p>\n\n<pre><code>void function(0, 0,\n              1, 2);\n</code></pre>\n\n<p>and it's ok, but when I'm typing additional ( symbol I have this indent problem</p>\n\n<pre><code>void function(0, 0,\n     (float)1, 2);\n</code></pre>\n\n<p>I changed setting inside Tools->Options->Text Editor->C/C++->Formatting->Indentation but can't get same indentation with additional '(' symbol. </p>\n"}, {"tags": ["c++", "ios", "opencv", "video"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5457377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c24c2bda07095a691e51ccff745e7d1?s=128&d=identicon&r=PG&f=1", "display_name": "teals", "link": "https://stackoverflow.com/users/5457377/teals"}, "edited": false, "score": 0, "creation_date": 1521075359, "post_id": 49287368, "comment_id": 85582976, "body": "Ahh okay that is unfortunate. Thank you for the answer I will go down the AVPlayer route."}, {"owner": {"reputation": 93, "user_id": 9512437, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-luDtVJh73cI/AAAAAAAAAAI/AAAAAAAAAM8/_vya_FNu1II/photo.jpg?sz=128", "display_name": "Marc LaBelle", "link": "https://stackoverflow.com/users/9512437/marc-labelle"}, "edited": false, "score": 0, "creation_date": 1584403377, "post_id": 49287368, "comment_id": 107421332, "body": "Note that grab also doesn&#39;t work. I founf this post when set wasn&#39;t working for me, so I thought I would quickly iterate through frames with grab(), but it is also broken."}], "tags": [], "owner": {"reputation": 29472, "user_id": 4253437, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/bcBpJ.jpg?s=128&g=1", "display_name": "CodeBender", "link": "https://stackoverflow.com/users/4253437/codebender"}, "is_accepted": true, "score": 2, "last_activity_date": 1521060467, "creation_date": 1521060467, "answer_id": 49287368, "question_id": 49285694, "link": "https://stackoverflow.com/questions/49285694/opencv-videocaptureset-ios-doesnt-work/49287368#49287368", "title": "OpenCV VideoCapture::set iOS doesn&#39;t work", "body": "<p>Short answer is it <em>is</em> broken:\n<a href=\"https://github.com/opencv/opencv/blob/5c13ffb73edef4d105fbafc1bff0bff3560eedb2/modules/videoio/src/cap_avfoundation.mm\" rel=\"nofollow noreferrer\">https://github.com/opencv/opencv/blob/5c13ffb73edef4d105fbafc1bff0bff3560eedb2/modules/videoio/src/cap_avfoundation.mm</a></p>\n\n<p>The relevant code is all commented out, with it just returning true by default. See lines 1054-1101 for this.</p>\n\n<p>Regarding scrubbing your video (skipping back &amp; forward), it is possible, just look into <code>AVPlayer</code>.</p>\n"}], "owner": {"reputation": 47, "user_id": 5457377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c24c2bda07095a691e51ccff745e7d1?s=128&d=identicon&r=PG&f=1", "display_name": "teals", "link": "https://stackoverflow.com/users/5457377/teals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "accepted_answer_id": 49287368, "answer_count": 1, "score": 1, "last_activity_date": 1521060467, "creation_date": 1521053681, "question_id": 49285694, "link": "https://stackoverflow.com/questions/49285694/opencv-videocaptureset-ios-doesnt-work", "title": "OpenCV VideoCapture::set iOS doesn&#39;t work", "body": "<p>So I have written some OpenCV code on MacOS in C++ for skipping forwards and backwards inside a video doing some processing. It works correctly on MacOS, but when I tried porting the code to iOS it fails to work.</p>\n\n<p>Specifically these API calls to OpenCV do not work on iOS. They do not return the correct values nor do they perform the correct operations, but they work as expected on MacOS.</p>\n\n<p><code>cap.get(CV_CAP_PROP_FPS);//Getting the FPS doesn't return the correct value.\ncap.set(CV_CAP_PROP_POS_AVI_RATIO, 1);//Set relative video position doesn't work.\ncap.get(CV_CAP_PROP_POS_MSEC);//Getting the duration doesn't return the correct value.\ncap.set(CV_CAP_PROP_POS_MSEC, video_time); //Setting video timestamp doesn't work.</code></p>\n\n<p>Alternatively I tried replacing some of the calls using AVFoundation but the call to <code>cap.set(CV_CAP_PROP_POS_MSEC, video_time);</code> Still doesn't work.</p>\n\n<p>I am kind of at a loss here on what to do. Is it possible to do forward and backward time skipping using AVFoundation?</p>\n"}, {"tags": ["c++", "winapi", "localization", "mfc", "filetime"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 1, "creation_date": 1521054063, "post_id": 49285691, "comment_id": 85574379, "body": "Use standard library chrono or boost chrono if you on a legacy C++03 compiler. See: <a href=\"https://stackoverflow.com/questions/16692400/c11-adding-a-stream-output-operator-for-stdchronotime-point\" title=\"c11 adding a stream output operator for stdchronotime point\">stackoverflow.com/questions/16692400/&hellip;</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521055644, "post_id": 49285691, "comment_id": 85575181, "body": "Automation dates had to be compatible with Lotus 123 bugs.  The monstrosity is just there to help you not fall in the trap.  Don&#39;t use dates before March 1st 1900."}], "answers": [{"comments": [{"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1521069207, "post_id": 49287077, "comment_id": 85581314, "body": "Wow, good find. I somehow missed that <code>SHFormatDateTime</code> API. Although I can&#39;t seem to figure out how localization would work with it. Neither <code>SetThreadUILanguage</code> nor <code>SetThreadPreferredUILanguages</code> seem to have any effect on it? And the same with <code>StrFromTimeInterval</code>"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1521131655, "post_id": 49287077, "comment_id": 85611502, "body": "Nah, the same thing. Although I just realized that I can simply do <code>GetDateFormat(lcid, DATE_SHORTDATE, &amp;st, NULL, bufferDate, _countof(bufferDate));</code> and then <code>GetTimeFormat(lcid, 0, &amp;st, NULL, bufferTime, _countof(bufferTime));</code> and then concatenate it as <code>date + space + time</code>, and it would do what I need. What I&#39;m curious though (that I can&#39;t seem to find anywhere) so maybe you know -- do pretty much all cultures have <code>date</code> followed by a <code>space</code> and then <code>time</code>?"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1521133478, "post_id": 49287077, "comment_id": 85612765, "body": "The implementation has moved to propsys.dll at some point and short dates are: date + &quot; &quot; + time. Long dates are: date + &quot;, &quot; + time but the comma string comes from LoadString and could possibly be something other than &quot;, &quot; in a different locale because MUI is involved."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 4, "last_activity_date": 1521062610, "last_edit_date": 1521062610, "creation_date": 1521059211, "answer_id": 49287077, "question_id": 49285691, "link": "https://stackoverflow.com/questions/49285691/winapi-to-format-filetime-as-a-localized-string-with-date-and-or-time/49287077#49287077", "title": "WinAPI to format FILETIME as a localized string with date and/or time", "body": "<p>You can use the classic time functions in kernel32: First call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724280.aspx\" rel=\"nofollow noreferrer\"><code>FileTimeToSystemTime</code></a> and then call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd318130.aspx\" rel=\"nofollow noreferrer\"><code>GetTimeFormat</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd318086.aspx\" rel=\"nofollow noreferrer\"><code>GetDateFormat</code></a>. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773833.aspx\" rel=\"nofollow noreferrer\"><code>SHFormatDateTime</code></a> is a wrapper around those functions. </p>\n\n<p>The shell also has <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb759980.aspx\" rel=\"nofollow noreferrer\"><code>StrFromTimeInterval</code></a> if you need friendly text of time duration.</p>\n"}], "owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 49287077, "answer_count": 1, "score": 0, "last_activity_date": 1521062610, "creation_date": 1521053678, "question_id": 49285691, "link": "https://stackoverflow.com/questions/49285691/winapi-to-format-filetime-as-a-localized-string-with-date-and-or-time", "title": "WinAPI to format FILETIME as a localized string with date and/or time", "body": "<p>I'm looking for a low-level WinAPI to format date-time from <code>FILETIME</code> to a localized string with an output of a date, time, or date and time together.</p>\n\n<p>By reversing the MFC's <code>COleDateTime</code> I was able to find <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221699(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>VarBstrFromDate</code></a> function that \"kinda\" works. So I was trying to see if there's another more reliable API that can accomplish that.</p>\n\n<p>There are two issues with <code>VarBstrFromDate</code> that I could see:</p>\n\n<p><strong>1)</strong> It doesn't reliably report the date or time parts. For instance, if I call it as such for <code>midnight Dec. 31, 1899</code>:</p>\n\n<pre><code>BSTR bstr = NULL;\nHRESULT hr = ::VarBstrFromDate(1.0, LANG_USER_DEFAULT, VAR_FOURDIGITYEARS, &amp;bstr);\n::SysFreeString(bstr);\n</code></pre>\n\n<p>it returns <code>\"12/31/1899\"</code> without the time part.</p>\n\n<p>Or, if I call it for, say, <code>noon Dec. 30, 1899</code>:</p>\n\n<pre><code>BSTR bstr = NULL;\nHRESULT hr = ::VarBstrFromDate(0.5, LANG_USER_DEFAULT, VAR_FOURDIGITYEARS, &amp;bstr);\n::SysFreeString(bstr);\n</code></pre>\n\n<p>it returns <code>\"12:00:00 PM\"</code> without the date part.</p>\n\n<p><strong>2)</strong>  Additionally, conversion from <code>FILETIME</code> to <code>DATE</code> is somewhat tricky, especially for dates prior to Dec. 30, 1899. Again, by reversing MFC I was able to find that <a href=\"https://msdn.microsoft.com/es-es/library/windows/desktop/ms221646(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>SystemTimeToVariantTime</code></a> can do it via the <code>SYSTEMTIME</code> struct. Kinda backwards, but OK. But then I saw this monstrosity in the <code>atlcore.h</code>:</p>\n\n<pre><code>inline BOOL AtlConvertSystemTimeToVariantTime(\n    _In_ const SYSTEMTIME&amp; systimeSrc,\n    _Out_ double* pVarDtTm)\n{\n    ATLENSURE(pVarDtTm!=NULL);\n    //Convert using ::SystemTimeToVariantTime and store the result in pVarDtTm then\n    //convert variant time back to system time and compare to original system time.\n    BOOL ok = ::SystemTimeToVariantTime(const_cast&lt;SYSTEMTIME*&gt;(&amp;systimeSrc), pVarDtTm);\n    SYSTEMTIME sysTime;\n    ::ZeroMemory(&amp;sysTime, sizeof(SYSTEMTIME));\n\n    ok = ok &amp;&amp; ::VariantTimeToSystemTime(*pVarDtTm, &amp;sysTime);\n    ok = ok &amp;&amp; (systimeSrc.wYear == sysTime.wYear &amp;&amp;\n            systimeSrc.wMonth == sysTime.wMonth &amp;&amp;\n            systimeSrc.wDay == sysTime.wDay &amp;&amp;\n            systimeSrc.wHour == sysTime.wHour &amp;&amp;\n            systimeSrc.wMinute == sysTime.wMinute &amp;&amp;\n            systimeSrc.wSecond == sysTime.wSecond);\n\n    return ok;\n}\n</code></pre>\n\n<p>Do you know why they're checking the result returned by <code>SystemTimeToVariantTime</code> by then passing it through <code>VariantTimeToSystemTime</code> in such an awkward way? Does it mean that <code>SystemTimeToVariantTime</code> may return an incorrect result, or what?</p>\n\n<p>Anyway, I was thinking to find another API that wouldn't rely on conversion to a floating-point <code>DATE</code>.</p>\n"}, {"tags": ["c++", "multithreading", "sockets", "pthreads", "client-server"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1521052997, "post_id": 49285392, "comment_id": 85573800, "body": "Sharing the same socket descriptor across threads is generally a bad idea, and if it&#39;s a TCP socket it&#39;s always a bad idea (because you can&#39;t control which bytes from the TCP stream will go to which thread, and in the inevitable case where thread A ends up with half of the incoming TCP message and thread B ends up with the other half, neither thread can correctly handle the message)"}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1521056920, "post_id": 49285392, "comment_id": 85575898, "body": "I guess entire message chunk goes to a particular thread only. <code>read(sockfd, buffer, chunkSize)</code> is threadsafe."}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 2, "creation_date": 1521058788, "post_id": 49285392, "comment_id": 85576965, "body": "Your guess is overly optimistic at best. The point is that <code>read(sockfd, buffer, chunkSize)</code> is <i>not</i> guaranteed to obtain <code>chunkSize</code> bytes. In particular, if you have multiple threads sharing a socket, it may receive only 1 byte of one peer&#39;s message. Or it may receive bytes of several peers&#39; messages interspersed. Code can be both thread-safe and incoherent."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1521063170, "post_id": 49285392, "comment_id": 85578997, "body": "To elaborate on what Gil mentioned above -- TCP is a stream-based protocol, not a message-based one; that means that a TCP stream only guarantees the delivery and ordering of the bytes it transports, it doesn&#39;t provide any message-framing capabilities.  So the data passed to the TCP layer via a single call to send() may be received at the other end by multiple calls to recv(), or contrariwise the data passed in via multiple calls to send() might be received all together via a single recv() call.  Your receiving code will need to account for that -- hard to do if multiple threads are involved."}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1521063347, "post_id": 49285392, "comment_id": 85579085, "body": "So you are saying server shouldn&#39;t ever (I mean generally .... ) use threads ?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1521063843, "post_id": 49285392, "comment_id": 85579308, "body": "I wouldn&#39;t go that far -- you can write a server with or without threads; however if you do use threads, I would recommend making sure that each file descriptor is owned exclusively by a single thread (i.e. so that thread is the only thread that has access to that file descriptor, and that thread is responsible for closing the file descriptor when it is done using it)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1521063854, "post_id": 49285392, "comment_id": 85579316, "body": "@sapy: No, that is not what they are saying.  You CAN have 1 thread reading from a socket while another thread writes to the same socket. But you CANNOT have multiple threads reading from the same socket at the same time, or multiple threads writing to the same socket at the same time, unless you serialize access to the socket to avoid concurrency issues and data corruption. Otherwise, use a separate thread for each socket, don&#39;t share the socket across multiple threads."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1521064312, "post_id": 49285392, "comment_id": 85579496, "body": "You have a problem with a server and you post client code?"}], "answers": [{"tags": [], "owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "is_accepted": false, "score": 0, "last_activity_date": 1521071890, "creation_date": 1521071890, "answer_id": 49289466, "question_id": 49285392, "link": "https://stackoverflow.com/questions/49285392/multithreaded-socket-programming-server-is-getting-messages-from-only-1-client-t/49289466#49289466", "title": "Multithreaded Socket programming server is getting messages from only 1 client thread", "body": "<p>The problem is <code>accept connection code</code> was in the main thread(As not visible in the code). And hence server accepted only one connection though client tried to create 4 connection. And the out put did not reveal this issue as the code doesn't send an acknowledgment back or forth. (No ping pong . ideally most receive is followed by send ack, and every send is followed by recv ack). </p>\n\n<p>When I moved that accept connection code to thread worker . It worked as intended.</p>\n\n<pre><code>void *serverWorker(void *threadarg) {\n    struct workDetails *thisWork;\n    thisWork = (struct workDetails *) threadarg;\n    int threadcount = thisWork-&gt;threadcount;\n    int chunkSize = thisWork-&gt;chunkSize;\n    char *dataStore = thisWork-&gt;dataStore;\n    int sockfd = thisWork-&gt;sockfd;\n    struct sockaddr_in cli_addr; // = thisWork-&gt;cli_addr;\n    char *buffer = new char[chunkSize];\n\n\n    listen(sockfd, 5);\n    socklen_t clilen = sizeof(cli_addr);\n    sockfd = ::accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\n    if (sockfd &lt; 0)\n        error(\"ERROR on accept\");\n\n    while (1) {\n        if (recv(sockfd, buffer, chunkSize, 0) &gt; 0) {\n            //lock_guard&lt;mutex&gt; guard(cout_mutex);\n            //cout &lt;&lt; \"Server \" &lt;&lt; thisWork-&gt;threadid &lt;&lt; \" Received - \" &lt;&lt; buffer &lt;&lt; endl;\n            buffer[chunkSize] = NULL;\n            strncat(dataStore, buffer, strlen(buffer));\n            if (strlen(dataStore) == oneGBtoByte) {\n                cout &lt;&lt; \"Done - \" &lt;&lt; endl;\n                storeInfile(created, dataStore);\n                break;\n            }\n        }\n    }\n\n    //End\n    delete[] buffer;\n    pthread_exit((void *) NULL);\n\n}\n</code></pre>\n\n<p>How ever what ever @jeremy-friesner or @gil-hamilton told is true. But those issues are not important here , as I'm only interested in total byte received and not who received which chunk. </p>\n"}], "owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521071890, "creation_date": 1521052615, "question_id": 49285392, "link": "https://stackoverflow.com/questions/49285392/multithreaded-socket-programming-server-is-getting-messages-from-only-1-client-t", "title": "Multithreaded Socket programming server is getting messages from only 1 client thread", "body": "<p>For a benchmarking task, I'm creating multiple server workers with the same socket descriptor and client workers with separate connections.</p>\n\n<p>Though client threads are sending a copy of the same message for each thread. The server shows it's received only one copy of each message, not all copies, sent by sending by all client threads.</p>\n\n<p>for 4 threads and 2 messages {0,1} , client output</p>\n\n<pre><code>client 3Wrote 0\n client 1Wrote 1\n client 0Wrote 0\n client 1Wrote 0\n client 2Wrote 0\n client 3Wrote 1\n client 2Wrote 1\n</code></pre>\n\n<p>Where as server output</p>\n\n<pre><code>Server 0 Received - 0\nServer 2 Received - 1\n</code></pre>\n\n<p>Why aren't rest of the messages showing up ? Or they were never actually sent by the client ?</p>\n\n<pre><code>void *clientWorker(void *threadarg) {\n    struct workDetails *thisWork;\n    thisWork = (struct workDetails *) threadarg;\n    int threadcount = thisWork-&gt;threadcount;\n    int chunkSize = thisWork-&gt;chunkSize;\n    char *serverIp = thisWork-&gt;serverIp;\n    char *dataStore = thisWork-&gt;dataStore;\n\n    int sockfd;\n    struct sockaddr_in serv_addr;\n    struct hostent *server;\n    char *buffer = (char *) calloc(chunkSize, sizeof(char));\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sockfd &lt; 0) error(\"ERROR opening client socket\");\n    server = gethostbyname(serverIp);\n    if (server == NULL) error(\"Could not detect server by node name\");\n\n    bzero((char *) &amp;serv_addr, sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    bcopy((char *) server-&gt;h_addr,\n          (char *) &amp;serv_addr.sin_addr.s_addr,\n          server-&gt;h_length);\n    serv_addr.sin_port = htons(PORTNO);\n    if (connect(sockfd, (struct sockaddr *) &amp;serv_addr, sizeof(serv_addr)) &lt; 0)\n        error(\"Server is not up.\");\n    long totalPackets = oneGBtoByte / (chunkSize * threadcount);\n    long i;\n    for (i = 0; i &lt; totalPackets; ++i) {\n        sprintf(buffer, \"%ld\", i);\n        if (write(sockfd, buffer, chunkSize) &lt; 0)\n            error(\"ERROR writing to socket\");\n        else {\n            lock_guard&lt;mutex&gt; guard(cout_mutex);\n            cout &lt;&lt; \" client \" &lt;&lt; thisWork-&gt;threadid &lt;&lt; \"Wrote \" &lt;&lt; i &lt;&lt; endl;\n        }\n    }\n    cout &lt;&lt; \" client \" &lt;&lt; thisWork-&gt;threadid &lt;&lt; \"Exit\";\n    pthread_exit((void *) NULL);\n}\n\nvoid *serverWorker(void *threadarg) {\n    struct workDetails *thisWork;\n    thisWork = (struct workDetails *) threadarg;\n    int threadcount = thisWork-&gt;threadcount;\n    int chunkSize = thisWork-&gt;chunkSize;\n    char *dataStore = thisWork-&gt;dataStore;\n    int sockfd = thisWork-&gt;sockfd;\n    char *buffer = new char[chunkSize];\n\n    while (1) {\n\n        if(read(sockfd, buffer, chunkSize) &gt; 0){\n            lock_guard&lt;mutex&gt; guard(cout_mutex);\n            cout &lt;&lt; \"Server \" &lt;&lt; thisWork-&gt;threadid &lt;&lt; \" Received - \" &lt;&lt; buffer &lt;&lt; endl;\n        }\n    }\n    pthread_exit((void *) NULL);\n}\n</code></pre>\n"}, {"tags": ["c++", "formatting", "clang-format"], "comments": [{"owner": {"reputation": 1036, "user_id": 192737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f738d8db73053bd199aef3ae0bc10e?s=128&d=identicon&r=PG", "display_name": "Jeff Trull", "link": "https://stackoverflow.com/users/192737/jeff-trull"}, "edited": false, "score": 0, "creation_date": 1603156726, "post_id": 49285383, "comment_id": 113940858, "body": "I&#39;m encountering a similar issue, but with <code>BraceWrapping: {AfterFunction: true}</code> and <code>AllowShortFunctionsOnASingleLine</code>"}], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 729, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1521052590, "creation_date": 1521052590, "question_id": 49285383, "link": "https://stackoverflow.com/questions/49285383/are-allowshortfunctionsonasingleline-and-alwaysbreakafterreturntype-compatible", "title": "Are AllowShortFunctionsOnASingleLine and AlwaysBreakAfterReturnType compatible?", "body": "<p>There's a repository which I want to use Clang Format with that has a peculiar coding style. It breaks the return type, but it also puts short function definitions on one line:</p>\n\n\n\n<pre class=\"lang-c++ prettyprint-override\"><code>bool\nisConditionMet() const { return _isConditionMet; }\n</code></pre>\n\n<p>When the function isn't short:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>bool\nMyClass::isConditionMet() const {\n    bool first = computeA();\n    return first &amp;&amp; computeB();\n}\n</code></pre>\n\n<p>I'm trying to make the <em>.clang-format</em> file match as closely as possible, but I couldn't get this to work. This is a minimal example (I eliminated all irrelevant settings):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>---\nLanguage:        Cpp\nAllowShortFunctionsOnASingleLine: All\nAlwaysBreakAfterReturnType: All\n...\n</code></pre>\n\n<p>When running it over this:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>class Test\n{\npublic:\n  void doNothing() {}\n\n  int giveMe() { return 42; }\n\n  int compute()\n  {\n    int i = 0;\n    i += 42;\n    return i;\n  }\n};\n</code></pre>\n\n<p>I got this:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>class Test {\npublic:\n  void\n  doNothing() {}\n\n  int\n  giveMe() {\n    return 42;\n  }\n\n  int\n  compute() {\n    int i = 0;\n    i += 42;\n    return i;\n  }\n};\n</code></pre>\n\n<p>Instead of what I expected:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>class Test {\npublic:\n  void\n  doNothing() {}\n\n  int\n  giveMe() { return 42; }\n\n  int\n  compute() {\n    int i = 0;\n    i += 42;\n    return i;\n  }\n};\n</code></pre>\n\n<p>The two settings <code>AllowShortFunctionsOnASingleLine</code> and <code>AlwaysBreakAfterReturnType</code> appear to be conflicting with each other. Does Clang Format allow for my desired formatting style?</p>\n\n<p>Version:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ clang-format-5.0 --version\nclang-format version 5.0.0-3~16.04.1 (tags/RELEASE_500/final)\n</code></pre>\n"}, {"tags": ["c++", "opengl", "vertex-buffer-objects", "texture1d"], "comments": [{"owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1521053807, "post_id": 49285320, "comment_id": 85574259, "body": "@Rabbid76 I do have this enabled in my code, forgot to add to question. Its added now."}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 1, "creation_date": 1521054033, "post_id": 49285320, "comment_id": 85574363, "body": "You show the definition of <code>vArray</code> twice but never the one of <code>tArray</code>. You should also clearify what <code>is not as I expected</code> means for the output. Nothing draw? Other colors than expected? Other location than expected? What did you expect?"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "edited": false, "score": 0, "creation_date": 1521484154, "post_id": 49285745, "comment_id": 85740945, "body": "If this was a 2D texture, where the horizontal gradient went form red to green, and the vertical gradient got more blue, how would the pixels and the tArray array change?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "reply_to_user": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "edited": false, "score": 0, "creation_date": 1521570599, "post_id": 49285745, "comment_id": 85784919, "body": "@tester: Edited in a 2D version; mostly just <code>GL_TEXTURE_1D</code> -&gt; <code>GL_TEXTURE_2D</code>, some extra texture pixels, and 2D texture coordinates."}, {"owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "edited": false, "score": 0, "creation_date": 1521570969, "post_id": 49285745, "comment_id": 85785153, "body": "Thanks for your time, I understand what I was doing wrong now."}], "tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": true, "score": 1, "last_activity_date": 1521570530, "last_edit_date": 1521570530, "creation_date": 1521053837, "answer_id": 49285745, "question_id": 49285320, "link": "https://stackoverflow.com/questions/49285320/gltexcoordpointer-output-not-as-expected/49285745#49285745", "title": "glTexCoordPointer output not as expected", "body": "<ul>\n<li>RE: your <code>glTexCoordPointer()</code> call: Tightly-packed arrays usually use <code>0</code> for <code>stride</code>.</li>\n<li><code>vArray</code> and <code>tArray</code> only have four elements, not five, so the <code>4</code> in <code>iArray</code> will cause OpenGL to read off the ends of those arrays into garbage (if you're lucky) or segfaults (if you're not).</li>\n</ul>\n\n<p>All together:</p>\n\n<pre><code>#include &lt;GL/glew.h&gt;\n#include &lt;GL/glut.h&gt;\n\nGLuint tex = 0;\nvoid display()\n{\n    glClear( GL_COLOR_BUFFER_BIT );\n\n    float vArray[] =\n    {\n       -0.5, -0.5,\n        0.5, -0.5,\n        0.5,  0.5,\n       -0.5,  0.5,\n    };\n\n    GLfloat tArray[] =\n    {\n       0.0, 0.3, 1.0, 0.0,\n    };\n\n    unsigned int iArray[] =\n    {\n       0, 1, 2,\n       2, 3, 0,\n    };\n\n    glEnable( GL_TEXTURE_1D );\n    glBindTexture( GL_TEXTURE_1D, tex );\n    glEnableClientState( GL_TEXTURE_COORD_ARRAY );\n    glTexCoordPointer( 1, GL_FLOAT, 0, tArray );\n\n    glEnableClientState( GL_VERTEX_ARRAY );\n    glVertexPointer( 2, GL_FLOAT, 0, vArray );\n\n    glDrawElements( GL_TRIANGLES, 6, GL_UNSIGNED_INT, iArray );\n\n    glDisableClientState( GL_TEXTURE_COORD_ARRAY );\n    glDisableClientState( GL_VERTEX_ARRAY );\n    glDisable( GL_TEXTURE_1D );\n\n    glutSwapBuffers();\n}\n\nint main( int argc, char** argv )\n{\n    glutInit( &amp;argc, argv );\n    glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );\n    glutInitWindowSize( 400, 400 );\n    glutCreateWindow( \"GLUT\" );\n    glewInit();\n\n    glGenTextures( 1, &amp;tex );\n    glBindTexture( GL_TEXTURE_1D, tex );\n    unsigned char pixels[] =\n    {\n        255, 0, 0, 255,\n        0, 255, 0, 255,\n        0, 0, 255, 255,\n    };\n    glTexImage1D( GL_TEXTURE_1D, 0, GL_RGBA, 3, 0, GL_RGBA, GL_UNSIGNED_BYTE, pixels );\n    glTexEnvi( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL );\n    glTexParameteri( GL_TEXTURE_1D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );\n    glTexParameteri( GL_TEXTURE_1D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );\n    glTexParameteri( GL_TEXTURE_1D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );\n\n    glutDisplayFunc( display );\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: 2D version:</p>\n\n<pre><code>#include &lt;GL/glew.h&gt;\n#include &lt;GL/glut.h&gt;\n\nGLuint tex = 0;\nvoid display()\n{\n    glClear( GL_COLOR_BUFFER_BIT );\n\n    float vArray[] =\n    {\n       -0.5, -0.5,\n        0.5, -0.5,\n        0.5,  0.5,\n       -0.5,  0.5,\n    };\n\n    GLfloat tArray[] =\n    {\n       0.0, 0.0,\n       1.0, 0.0,\n       1.0, 1.0,\n       0.0, 1.0,\n    };\n\n    unsigned int iArray[] =\n    {\n       0, 1, 2,\n       2, 3, 0,\n    };\n\n    glEnable( GL_TEXTURE_2D );\n    glBindTexture( GL_TEXTURE_2D, tex );\n    glEnableClientState( GL_TEXTURE_COORD_ARRAY );\n    glTexCoordPointer( 2, GL_FLOAT, 0, tArray );\n\n    glEnableClientState( GL_VERTEX_ARRAY );\n    glVertexPointer( 2, GL_FLOAT, 0, vArray );\n\n    glDrawElements( GL_TRIANGLES, 6, GL_UNSIGNED_INT, iArray );\n\n    glDisableClientState( GL_TEXTURE_COORD_ARRAY );\n    glDisableClientState( GL_VERTEX_ARRAY );\n    glDisable( GL_TEXTURE_2D );\n\n    glutSwapBuffers();\n}\n\nint main( int argc, char** argv )\n{\n    glutInit( &amp;argc, argv );\n    glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );\n    glutInitWindowSize( 400, 400 );\n    glutCreateWindow( \"GLUT\" );\n    glewInit();\n\n    glGenTextures( 1, &amp;tex );\n    glBindTexture( GL_TEXTURE_2D, tex );\n    unsigned char pixels[] =\n    {\n        255, 0, 0, 255,\n        0, 255, 0, 255,\n        0, 0, 255, 255,\n        0, 0, 255, 255,\n    };\n    glTexImage2D( GL_TEXTURE_2D, 0, GL_RGBA, 2, 2, 0, GL_RGBA, GL_UNSIGNED_BYTE, pixels );\n    glTexEnvi( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL );\n    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );\n    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE );\n    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );\n    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );\n\n    glutDisplayFunc( display );\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1521063268, "accepted_answer_id": 49285745, "answer_count": 1, "score": 1, "last_activity_date": 1521570530, "creation_date": 1521052398, "last_edit_date": 1521054148, "question_id": 49285320, "link": "https://stackoverflow.com/questions/49285320/gltexcoordpointer-output-not-as-expected", "closed_reason": "Not suitable for this site", "title": "glTexCoordPointer output not as expected", "body": "<p>I am trying to use <code>glDrawElements</code> , <code>glTexCoordPointer</code> and <code>glTexImage1D</code> to create a 1D texture, render a surface dataset and color the vertices according to their height value.</p>\n\n<pre><code>GLuint tex = 0;\n</code></pre>\n\n<p>My texture generation:</p>\n\n<pre><code>glGenTextures( 1, &amp;tex );\nglBindTexture( GL_TEXTURE_1D, tex );\nunsigned char pixels[] =\n{\n    255, 0, 0, 255,\n    0, 255, 0, 255,\n    0, 0, 255, 255,\n};\nglTexImage1D( GL_TEXTURE_1D, 0, GL_RGBA, 3, 0, GL_RGBA, GL_UNSIGNED_BYTE, pixels );\nglTexEnvi( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL );\nglTexParameteri( GL_TEXTURE_1D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );\nglTexParameteri( GL_TEXTURE_1D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );\nglTexParameteri( GL_TEXTURE_1D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );\n</code></pre>\n\n<p><code>vArray</code> is an array which stores the vertices for rendering.</p>\n\n<pre><code>float vArray[12] = {  \n   0.0, 1.0, 0.0,\n   0.0, 3.0, 1.0,\n   1.0, 2.0, 0.0,\n   1.0, 1.0, 1.0,\n}\n</code></pre>\n\n<p><code>iArray</code> is an array which stores the indices for rendering.</p>\n\n<pre><code>int iSize = 6;\nint iArray[6] = {  \n   0, 2, 1,\n   2, 1, 4,\n}\n</code></pre>\n\n<p><code>tArray</code> is an array which stores the normalised heights.</p>\n\n<pre><code>GLfloat tArray[4] = {  \n   0.0, 0.3, 1.0, 0.0,\n}\n</code></pre>\n\n<p>My render code:</p>\n\n<pre><code>  glEnable(GL_TEXTURE_1D);\n  glEnableClientState(GL_TEXTURE_COORD_ARRAY);\n  glBindTexture(GL_TEXTURE_1D, tex);\n  glTexCoordPointer(1, GL_FLOAT, sizeof(GL_FLOAT), tArray);\n\n  glEnableClientState(GL_VERTEX_ARRAY);\n  glVertexPointer(3 ,GL_FLOAT,0, vArray);    \n\n  glDrawElements(GL_TRIANGLES, iSize, GL_UNSIGNED_INT, iArray);\n\n  glDisableClientState(GL_VERTEX_ARRAY);\n  glDisableClientState(GL_TEXTURE_COORD_ARRAY);\n  glDisable(GL_TEXTURE_1D);\n</code></pre>\n\n<p>The final output is not as I expected, hoping somebody can point out my mistakes.</p>\n"}, {"tags": ["c++", "class", "templates"], "comments": [{"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 1, "creation_date": 1521052556, "post_id": 49285264, "comment_id": 85573552, "body": "In old compilers it is ok but now you should use <code>void Stack&lt;T&gt;::</code>."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9198862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0435961947ed85fa1b679c6f0a81a7ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Roe", "link": "https://stackoverflow.com/users/9198862/j-roe"}, "edited": false, "score": 0, "creation_date": 1521052607, "post_id": 49285332, "comment_id": 85573577, "body": "According that, it&#39;s not so clear why (in contrast to this) I can write <code>throw Full();</code> - why it&#39;s not gives error and require to write like that: <code>throw Stack&lt;T&gt;::Full();</code> ?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 63, "user_id": 9198862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0435961947ed85fa1b679c6f0a81a7ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Roe", "link": "https://stackoverflow.com/users/9198862/j-roe"}, "edited": false, "score": 2, "creation_date": 1521052814, "post_id": 49285332, "comment_id": 85573696, "body": "@J.Roe, inside the definition of the member functions of <code>Stack&lt;T&gt;</code>, all typenames defined the <code>Stack&lt;T&gt;</code> are in scope. Hence, <code>Full()</code> is the same as <code>Stack&lt;T&gt;::Full()</code>."}, {"owner": {"reputation": 63, "user_id": 9198862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0435961947ed85fa1b679c6f0a81a7ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Roe", "link": "https://stackoverflow.com/users/9198862/j-roe"}, "edited": false, "score": 0, "creation_date": 1521052935, "post_id": 49285332, "comment_id": 85573760, "body": "Even if the implementaion of the member function is outside the class?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 63, "user_id": 9198862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0435961947ed85fa1b679c6f0a81a7ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Roe", "link": "https://stackoverflow.com/users/9198862/j-roe"}, "edited": false, "score": 1, "creation_date": 1521052977, "post_id": 49285332, "comment_id": 85573792, "body": "@J.Roe, yes. that is indeed the case."}, {"owner": {"reputation": 63, "user_id": 9198862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0435961947ed85fa1b679c6f0a81a7ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Roe", "link": "https://stackoverflow.com/users/9198862/j-roe"}, "edited": false, "score": 0, "creation_date": 1521053388, "post_id": 49285332, "comment_id": 85574009, "body": "Just for be certain that I am understand. If for example I am want to call to <code>Full() </code> or <code>Empty()</code> in the main, I must write <code>Stack&lt;T&gt;::Full()</code> or <code>Stack&lt;T&gt;::Empty()</code> ?"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1521052675, "last_edit_date": 1521052675, "creation_date": 1521052447, "answer_id": 49285332, "question_id": 49285264, "link": "https://stackoverflow.com/questions/49285264/when-to-write-the-template-angle-brackets/49285332#49285332", "title": "When to write the template angle brackets (&lt;...&gt;)?", "body": "<blockquote>\n  <p>The part of the implementaion of push method and pop method it's ok? I don't understand if I need to write void Stack::push(const T&amp; t) instead void Stack::push(const T&amp; t) (and the same for pop method).</p>\n</blockquote>\n\n<p>You need to use </p>\n\n<pre><code>template &lt;typename T&gt;\nvoid Stack&lt;T&gt;::push(const T&amp; t) { ... }\n\ntemplate &lt;typename T&gt;\nvoid Stack&lt;T&gt;::pop() { ... }\n</code></pre>\n\n<p>The name <code>Stack</code> is the same as <code>Stack&lt;T&gt;</code> inside the class template definition when it is used as a typename. Outside the class template definition, you have to supply the template parameter explicitly.</p>\n"}, {"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 2, "last_activity_date": 1521054424, "last_edit_date": 1521054424, "creation_date": 1521052913, "answer_id": 49285477, "question_id": 49285264, "link": "https://stackoverflow.com/questions/49285264/when-to-write-the-template-angle-brackets/49285477#49285477", "title": "When to write the template angle brackets (&lt;...&gt;)?", "body": "<p>Both <code>push()</code> and <code>pop()</code> are (non-template) <em>member functions</em> of the <code>Stack</code> <em>class template</em>. Since this <em>class template</em>, <code>Stack</code>, is parameterized by a <em>type template parameter</em> (i.e.: <code>T</code>), so are those member functions as well.</p>\n\n<p>Therefore, the implementation of those member functions needs a type template parameter:</p>\n\n<pre><code>template&lt;typename A&gt;\nvoid Stack&lt;A&gt;::push(const A&amp; t) { ... }\n\ntemplate&lt;typename B&gt;\nvoid Stack&lt;B&gt;::pop() { ... }\n</code></pre>\n\n<p>Note that the name of the template parameter is actually irrelevant (<code>A</code> and <code>B</code> above).</p>\n\n<p>Note as well that the name of the class template <code>Stack</code> not followed by any <em>template arguments</em> <strong>inside the body of its definition</strong> is equivalent to the class template with its <em>template parameter</em> as the <em>template argument</em>, i.e.: <code>Stack&lt;T&gt;</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 9198862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0435961947ed85fa1b679c6f0a81a7ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Roe", "link": "https://stackoverflow.com/users/9198862/j-roe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 49285332, "answer_count": 2, "score": 0, "last_activity_date": 1521057832, "creation_date": 1521052243, "last_edit_date": 1521057832, "question_id": 49285264, "link": "https://stackoverflow.com/questions/49285264/when-to-write-the-template-angle-brackets", "title": "When to write the template angle brackets (&lt;...&gt;)?", "body": "<p>Given this example class template:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass Stack {\n    T * data;\n    int size;\n    int nextIndex;\npublic:\n    Stack(int size = 100);\n    Stack(const Stack&amp; stack);\n    ~Stack();\n    Stack&amp; operator=(const Stack&amp; s);\n    void push(const T&amp; t);\n    void pop();\n    T&amp; top();\n    const T&amp; top() const;\n    int getSize() const;\n\n    class Full {\n    };\n    class Empty {\n    };\n};\n\ntemplate&lt;typename T&gt;\nvoid Stack::push(const T&amp; t) {\n    if (nextIndex &gt;= size) {\n        throw Full();\n    }\n    data[nextIndex++] = t;\n}\n\u00a0\ntemplate&lt;typename T&gt;\nvoid Stack::pop() {\n    if (nextIndex &lt;= 0) {\n        throw Empty();\n    }\n    nextIndex--;\n}  \n</code></pre>\n\n<p>Is it ok the part of the implementaion of the <code>push</code> and <code>pop</code> methods? </p>\n\n<p>I don't understand if I need to write <code>void Stack&lt;T&gt;::push(const T&amp; t)</code> instead of <code>void Stack::push(const T&amp; t)</code> (and the same for the <code>pop</code> method).  </p>\n\n<p>NOTE: Eclipse (according to C++11) gives me the next error:  </p>\n\n<blockquote>\n  <p>Member declaration not found  </p>\n</blockquote>\n\n<p>because of these lines:  </p>\n\n<pre><code>void Stack::push(const T&amp; t) { \nvoid Stack::pop() {\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "futex", "timespec"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1521052506, "post_id": 49285223, "comment_id": 85573515, "body": "Assuming you get the error from <code>sem_timedwait(&amp;hFCRequestEvt, &amp;ts);</code>, how do you know you get an error?  The posted code isn&#39;t checking any return values."}, {"owner": {"reputation": 124, "user_id": 1907736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555d3b88446a59b84b73596d9746ef52?s=128&d=identicon&r=PG", "display_name": "0x64", "link": "https://stackoverflow.com/users/1907736/0x64"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521053355, "post_id": 49285223, "comment_id": 85573986, "body": "It returns -1 and perror prints &quot;Connection timed out&quot;. Then immediately I get &quot;The futex facility returned an unexpected error code.Aborted (core dumped)&quot;"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1521055313, "post_id": 49285223, "comment_id": 85575009, "body": "<i>It returns -1 and perror prints &quot;Connection timed out&quot;.</i> What call to <code>perror()</code>?  Your posted code doesn&#39;t match what you&#39;re describing?  I also wonder how you avoid race conditions in accessing the members of <code>requests</code> - you&#39;re not doing any locking to access the <code>state</code>, and presumably other threads can alter that value."}, {"owner": {"reputation": 124, "user_id": 1907736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555d3b88446a59b84b73596d9746ef52?s=128&d=identicon&r=PG", "display_name": "0x64", "link": "https://stackoverflow.com/users/1907736/0x64"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521056355, "post_id": 49285223, "comment_id": 85575596, "body": "I added code on my end for the return value and perror() for debugging. They are not in the original question. Sorry for the confusion.The requests are irrelevant here. The STARTED state just marks the beginning of the requests processing. There is no race condition."}, {"owner": {"reputation": 124, "user_id": 1907736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555d3b88446a59b84b73596d9746ef52?s=128&d=identicon&r=PG", "display_name": "0x64", "link": "https://stackoverflow.com/users/1907736/0x64"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521073943, "post_id": 49285223, "comment_id": 85582614, "body": "After I wrote more code for the other parts of the program, as mysterious as the problem appeared, it now disappeared. sem_timedwait now works as expected even though I&#39;ve made no change to the posted code, which is pretty weird because I am sure the futex facility error originated from the thread that is doing sem_timedwait."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1521075338, "post_id": 49285223, "comment_id": 85582971, "body": "please add a &#39;EDIT&#39; section to your question, with the updated code.  Other wise we are just guessing.   Also, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can see what your code is actually doing."}], "owner": {"reputation": 124, "user_id": 1907736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555d3b88446a59b84b73596d9746ef52?s=128&d=identicon&r=PG", "display_name": "0x64", "link": "https://stackoverflow.com/users/1907736/0x64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521052089, "creation_date": 1521052089, "question_id": 49285223, "link": "https://stackoverflow.com/questions/49285223/sem-timedwait-causes-the-futex-facility-returned-an-unexpected-error-code", "title": "sem_timedwait causes &quot;The futex facility returned an unexpected error code&quot;", "body": "<p>What is wrong with this code? When the sem object is posted, it is fine. However as soon as it needs to wait for the time out, I get \"The futex facility returned an unexpected error code\".</p>\n\n<pre><code>void* BackgroudProc(void*){\n    struct timespec ts;\n    while(1){\n        clock_gettime(CLOCK_REALTIME, &amp;ts);\n        ts.tv_sec += 10;\n        sem_timedwait(&amp;hFCRequestEvt, &amp;ts);\n        for(int i = 0; i &lt; requests.size(); i++){\n            if(numOfConnection &gt;= MAX_CONNECTION)\n                break;\n            if(requests[i].state == QUEUED){\n                requests[i].state = STARTED;\n                numOfConnection++;\n                pthread_create(&amp;requests[i].tid, 0, (void* (*)(void*))FileCopyFSM, (void*)(&amp;requests[i]));\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521051464, "post_id": 49285010, "comment_id": 85572953, "body": "Since <code>it</code> is declared outside of the loop shouldn&#39;t it be considered <code>shared</code> as well as <code>vec</code> and <code>sum</code>?"}, {"owner": {"reputation": 19, "user_id": 9296940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9411b14cf2c021cf3d9752b158d5751f?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh", "link": "https://stackoverflow.com/users/9296940/mukesh"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521051959, "post_id": 49285010, "comment_id": 85573213, "body": "I have added &#39;private(it)&#39; in the #pragma command, so it should be private."}, {"owner": {"reputation": 1923, "user_id": 3033441, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5128fcd3a14587660ea0cb737aa54143?s=128&d=identicon&r=PG&f=1", "display_name": "lakshayg", "link": "https://stackoverflow.com/users/3033441/lakshayg"}, "edited": false, "score": 0, "creation_date": 1521052635, "post_id": 49285010, "comment_id": 85573599, "body": "I don&#39;t know the cause of this problem but using the following pragma solved this issue for me: <code>#pragma omp parallel for default(none) shared(vec) reduction(+:sum)</code>. You can even remove the <code>#pragma critical</code> if you use this."}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1521054732, "post_id": 49285010, "comment_id": 85574709, "body": "Which version of openMP? Is it 3.0 or later? If not, change the loop to use an int, not an iterator. (VC++ uses 2.0)"}, {"owner": {"reputation": 19, "user_id": 9296940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9411b14cf2c021cf3d9752b158d5751f?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh", "link": "https://stackoverflow.com/users/9296940/mukesh"}, "edited": false, "score": 0, "creation_date": 1521054909, "post_id": 49285010, "comment_id": 85574799, "body": "I am using OpenMP 4.5 and I want to use iterators as loop index."}, {"owner": {"reputation": 19, "user_id": 9296940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9411b14cf2c021cf3d9752b158d5751f?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh", "link": "https://stackoverflow.com/users/9296940/mukesh"}, "edited": false, "score": 0, "creation_date": 1521055060, "post_id": 49285010, "comment_id": 85574867, "body": "Found my problem; I should have used <code>#pragma omp critical</code> instead of <code>#pragma critical</code>."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1521059680, "post_id": 49285010, "comment_id": 85577406, "body": "Yes. Your compiler should warn you about that with proper warning levels. Also look at <a href=\"https://stackoverflow.com/questions/40819136/when-is-the-reduction-needed\" title=\"when is the reduction needed\">stackoverflow.com/questions/40819136/&hellip;</a> - a reduction is much better in that case than a critical section."}], "owner": {"reputation": 19, "user_id": 9296940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9411b14cf2c021cf3d9752b158d5751f?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh", "link": "https://stackoverflow.com/users/9296940/mukesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521051300, "creation_date": 1521051300, "question_id": 49285010, "link": "https://stackoverflow.com/questions/49285010/openmp-for-loop-using-iterators-gives-incorrect-results", "title": "OpenMP for loop using iterators gives incorrect results", "body": "<p>I wrote the following OpenMP program that uses an iterator as the loop index to compute the sum of elements of a vector but it does not print correct results:</p>\n\n<pre><code>#include &lt;omp.h&gt;\n#include &lt;vector&gt;\n#include &lt;stdio.h&gt;\nusing namespace std;\n#define NT 10\n\nint main()\n{\n    vector&lt;int&gt; vec;\n    vector&lt;int&gt;::iterator it;\n    int sum = 0;\n    int k = 0;\n\n    for (int i = 0; i &lt; NT; i++)\n        vec.push_back(i);\n\n    k = vec.end() - vec.begin();\n    printf(\"vec.end() - vec.begin() = %d\\n\", k);\n\n    #pragma omp parallel for default(none) shared(vec, sum) private(it)\n    for (it = vec.begin(); it &lt; vec.end(); it++) {\n        #pragma critical\n        sum += *it;\n    }\n\n    printf(\"sum = %d\\n\", sum);\n}\n</code></pre>\n\n<p>I get different values of sum on different runs of the program. What am I doing wrong?</p>\n"}, {"tags": ["c++", "lambda", "function-pointers", "ostream", "template-argument-deduction"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1521051388, "post_id": 49284932, "comment_id": 85572924, "body": "&quot;It will not compile&quot; <b>show the error message</b>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5709287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9e5efcec5f50ab86712a49bbd2da5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Tarirah", "link": "https://stackoverflow.com/users/5709287/tarirah"}, "edited": false, "score": 0, "creation_date": 1521051674, "post_id": 49285017, "comment_id": 85573074, "body": "But why does it work when using cout? which overload is used here? To work around this problem, I also gave a <code>bool</code> overload to <code>test()</code>, but it will not be used"}, {"owner": {"reputation": 1395, "user_id": 6256451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5271ddbb0e7b464e61ea8a0ae2eaa68e?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel", "link": "https://stackoverflow.com/users/6256451/marcel"}, "edited": false, "score": 0, "creation_date": 1521053280, "post_id": 49285017, "comment_id": 85573942, "body": "There is no <code>operator &lt;&lt;</code> for <code>std::ostream</code> and function pointer - at least the debugger directly calls <code>std::ostream::operator&lt;&lt;(bool)</code>. But I have no idea why a function pointer implicitly converts to <code>bool</code>. In fact any other function pointer also prints true or false (when NULL)."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 2, "last_activity_date": 1521051572, "last_edit_date": 1521051572, "creation_date": 1521051338, "answer_id": 49285017, "question_id": 49284932, "link": "https://stackoverflow.com/questions/49284932/lambda-converted-to-bool-instead-of-deducing-function-pointer-type/49285017#49285017", "title": "lambda converted to bool instead of deducing function-pointer-type", "body": "<p>Your problem here is that Template Argument Deduction is <strong>only</strong> done on the actual argument passed to <code>test</code>. It's not done on all possible types that the argument could possibly converted to. That might be an infinite set, so that's clearly a no-go.</p>\n\n<p>So, Template Argument Deduction is done on the actual lambda object, which has an unspeakable class type. So the deduction for <code>test(T*)</code> fails as the lambda object is not a pointer. <code>T</code> can't be deduced from <code>test(bool)</code>, obviously. Finally, the deduction fails for <code>test(Ret(*el)(Args...))</code> as the lambda object is not a pointer-to-function either.</p>\n\n<p>There are a few options. You might not even need a template, you could accept a <code>std::function&lt;void(void)&gt;</code> and rely on the fact that it has a templated constructor. Or you could just take a <code>test(T t)</code> argument and call it as <code>t()</code>. <code>T</code> will now deduce to the actual lambda type. The most fancy solution is probably using <a href=\"https://stackoverflow.com/a/43680610/15416\"><code>std::invoke</code></a>, and accepting a template vararg list.</p>\n"}, {"tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1521051974, "last_edit_date": 1521051974, "creation_date": 1521051637, "answer_id": 49285100, "question_id": 49284932, "link": "https://stackoverflow.com/questions/49284932/lambda-converted-to-bool-instead-of-deducing-function-pointer-type/49285100#49285100", "title": "lambda converted to bool instead of deducing function-pointer-type", "body": "<pre><code>template&lt;typename T&gt;\nvoid test(bool) {\n    std::cout &lt;&lt; \"bool\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Template is not needed. In fact you overload functions, not templates. Replace it with</p>\n\n<pre><code>void test(bool) {\n     std::cout &lt;&lt; \"bool\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Now your sample will compile.</p>\n"}, {"tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": false, "score": 0, "last_activity_date": 1521051648, "creation_date": 1521051648, "answer_id": 49285103, "question_id": 49284932, "link": "https://stackoverflow.com/questions/49284932/lambda-converted-to-bool-instead-of-deducing-function-pointer-type/49285103#49285103", "title": "lambda converted to bool instead of deducing function-pointer-type", "body": "<p>Even though non-capturing lambdas have an implicit conversion to function pointers, function templates must match exactly for deduction to succeed, no conversions will be performed.</p>\n\n<p>Therefore the easiest fix is to force the conversion with a <code>+</code></p>\n\n<pre><code>int main() {\n    std::boolalpha(std::cout);\n    std::cout &lt;&lt; []{return 5;} &lt;&lt; std::endl; // true is outputted\n    test(+[]{return 5;}); \n    //   ^\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5709287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9e5efcec5f50ab86712a49bbd2da5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Tarirah", "link": "https://stackoverflow.com/users/5709287/tarirah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 49285017, "answer_count": 3, "score": 1, "last_activity_date": 1521053479, "creation_date": 1521050993, "last_edit_date": 1521053479, "question_id": 49284932, "link": "https://stackoverflow.com/questions/49284932/lambda-converted-to-bool-instead-of-deducing-function-pointer-type", "title": "lambda converted to bool instead of deducing function-pointer-type", "body": "<p>I wanted to implement a overload for <code>operator&lt;&lt;</code> that allowed me to call a given function and output the result.\nI therefore wrote an overload, but the conversion to bool is selected and when writing a function myself, it would not compile.</p>\n\n<p>EDIT: Know that I do not want to call the lambda,\nbut instead pass it to the function where it should be called with a default constructed parameter list.</p>\n\n<p>I have appended my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\ntemplate&lt;typename T&gt;\nvoid test(T *) {\n    std::cout &lt;&lt; \"ptr\" &lt;&lt; std::endl;\n}\ntemplate&lt;typename T&gt;\nvoid test(bool) {\n    std::cout &lt;&lt; \"bool\" &lt;&lt; std::endl;\n}\ntemplate&lt;typename Ret, typename ...Args&gt;\nvoid test(Ret(*el)(Args...)) {\n    std::cout &lt;&lt; \"function ptr\\n\" &lt;&lt; el(Args()...) &lt;&lt; std::endl;\n}\n\ntemplate&lt;typename Char_T, typename Char_Traits, typename Ret, typename ...Args&gt;\nstd::basic_ostream&lt;Char_T, Char_Traits&gt;&amp; operator&lt;&lt;(\n      std::basic_ostream&lt;Char_T, Char_Traits&gt; &amp;str, Ret(*el)(Args...)) {\n    return str &lt;&lt; el(Args()...);\n}\n\nint main() {\n    std::boolalpha(std::cout);\n    std::cout &lt;&lt; []{return 5;} &lt;&lt; std::endl; // true is outputted\n    test([]{return 5;}); // will not compile\n}\n</code></pre>\n\n<p>I use gcc 7.3.1 with the version flag <code>-std=c++14</code>.</p>\n\n<p>EDIT: Error message:</p>\n\n<pre><code>main.cc: In function \u2018int main()\u2019:\nmain.cc:25:23: error: no matching function for call to \u2018test(main()::&lt;lambda()&gt;)\u2019\n     test([]{return 5;});\n                       ^\nmain.cc:5:6: note: candidate: template&lt;class T&gt; void test(T*)\n void test(T *) {\n      ^~~~\nmain.cc:5:6: note:   template argument deduction/substitution failed:\nmain.cc:25:23: note:   mismatched types \u2018T*\u2019 and \u2018main()::&lt;lambda()&gt;\u2019\n     test([]{return 5;});\n                       ^\nmain.cc:9:6: note: candidate: template&lt;class T&gt; void test(bool)\n void test(bool) {\n      ^~~~\nmain.cc:9:6: note:   template argument deduction/substitution failed:\nmain.cc:25:23: note:   couldn't deduce template parameter \u2018T\u2019\n     test([]{return 5;});\n                       ^\nmain.cc:13:6: note: candidate: template&lt;class Ret, class ... Args&gt; void test(Ret (*)(Args ...))\n void test(Ret(*el)(Args...)) {\n      ^~~~\nmain.cc:13:6: note:   template argument deduction/substitution failed:\nmain.cc:25:23: note:   mismatched types \u2018Ret (*)(Args ...)\u2019 and \u2018main()::&lt;lambda()&gt;\u2019\n     test([]{return 5;});\n</code></pre>\n"}, {"tags": ["c++", "division", "outofrangeexception", "numeric-limits"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1521050133, "post_id": 49284646, "comment_id": 85572147, "body": "<code>0.5</code> is a <code>double</code> so you need floating point division.  Also <code>INT_MAX + INT_MAX</code> is going to give you a wrong result."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1521050136, "post_id": 49284646, "comment_id": 85572150, "body": "multiply one of the terms on the denominator by 1.0 to force argument promotion."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 7, "creation_date": 1521050174, "post_id": 49284646, "comment_id": 85572179, "body": "<code>double correct_answer = 0.5;</code>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521050180, "post_id": 49284646, "comment_id": 85572184, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1521050241, "post_id": 49284646, "comment_id": 85572219, "body": "@storyteller: constexpr surely? ;-)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1521050273, "post_id": 49284646, "comment_id": 85572236, "body": "@Bathsheba - You know me, I don&#39;t like to spoon feed the OP :P"}, {"owner": {"reputation": 3, "user_id": 4075075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101f633270f07391c645d0a6526ccd35?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Wong", "link": "https://stackoverflow.com/users/4075075/eric-wong"}, "edited": false, "score": 0, "creation_date": 1521050538, "post_id": 49284646, "comment_id": 85572417, "body": "It&#39;s just an example, here I just want to know how to get the right result of the division (a / 2a = 0.5) when both divisor (a) and dividend (2a) are very large."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521050674, "post_id": 49284646, "comment_id": 85572496, "body": "@EricWong Why?  It will <b>always</b> be <code>.5</code>."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521050696, "post_id": 49284646, "comment_id": 85572511, "body": "examples are fine, but just an example without code isnt. Plese take the 2 minutes to write 2 lines for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. If you put casts in the right place it should work, but without seeing your code we cannot know what is wrong"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1521050697, "post_id": 49284646, "comment_id": 85572512, "body": "@EricWong - Apologies if I offended you. I was only jesting. Though you should have provided those details when originally posting. If your question was &quot;How do protect against possible overflow for this equation&quot; it would have been a <i>good question</i>! Instead you phrased it in a way that left room for a silly interpretation, like mine."}, {"owner": {"reputation": 3, "user_id": 4075075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101f633270f07391c645d0a6526ccd35?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Wong", "link": "https://stackoverflow.com/users/4075075/eric-wong"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521051323, "post_id": 49284646, "comment_id": 85572886, "body": "@StoryTeller Thanks for the advice, I am a newbie to stackoverflow so I don&#39;t know much about the rules."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521051555, "post_id": 49284646, "comment_id": 85572999, "body": "@EricWong - Don&#39;t worry about it. You can take the <a href=\"https://stackoverflow.com/tour\">tour</a> to learn about the Stack Overflow model. We have a pretty good <a href=\"https://stackoverflow.com/help\">help center</a>, and it even has a great set of articles about <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> good questions."}], "answers": [{"comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1521050558, "post_id": 49284732, "comment_id": 85572429, "body": "You actually only need one <code>static_cast&lt;double&gt;</code> if you are careful where you put it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1521050894, "post_id": 49284732, "comment_id": 85572629, "body": "@Justin Correct as far as the language is concerned, but for human readers, I&#39;d probably leave in at least the cast of the first <code>INT_MAX</code>."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1521050902, "post_id": 49284732, "comment_id": 85572635, "body": "Then why answer if it&#39;s nonsense? Conserve your effort for decent questions. If you do decide to answer however, give it your best effort."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521051027, "post_id": 49284732, "comment_id": 85572703, "body": "i second storyteller, by answering a question that you consider as low quality you actually decrease the chances that it will be improved (dont want to point at someone, happens to myself often enough, just saying...)"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521051239, "post_id": 49284732, "comment_id": 85572842, "body": "@StoryTeller: If I had answered &quot;do <code>INT_MAX &#47; (static_cast&lt;double&gt;(INT_MAX) + INT_MAX)</code>&quot; do you think it would have helped the OP? And there is absolutely no difference nor for the compiler neither for the execution, so what&#39;s the point?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521051455, "post_id": 49284732, "comment_id": 85572947, "body": "Actually, it would have helped the OP, since it makes the code much more readable. Since code is read mostly by humans, it should be as readable as possible. And if you even included a word about how the clever little cast makes everything work, I would have even considered your answer useful (the criteria for voting). You don&#39;t want to accept the feedback? Then don&#39;t. It&#39;s your answer, after all."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1521052732, "post_id": 49284732, "comment_id": 85573652, "body": "I accept it but it&#39;s harder from someone who answered <code>double correct_answer = 0.5;</code> and who talks to me about helping the OP..."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521063211, "post_id": 49284732, "comment_id": 85579015, "body": "Answered? I didn&#39;t &quot;answer&quot; anything, I joked with the OP. And when there was a hint of offence on their part, I apologized. Given your entire attitude here, and that blatant ad-hominem, I&#39;m really wasting my keystrokes."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1521064783, "post_id": 49284732, "comment_id": 85579668, "body": "Sure. You blame me for not &quot;conserving my effort for decent question&quot; while you spend it joking on a non-humouristic website and blaming the ones just trying to help. So yes, wasting your keystrokes seems to be quite a habit..."}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": true, "score": 0, "last_activity_date": 1521050329, "creation_date": 1521050329, "answer_id": 49284732, "question_id": 49284646, "link": "https://stackoverflow.com/questions/49284646/int-max-divided-by-twice-of-itself-int-max-2/49284732#49284732", "title": "INT_MAX divided by twice of itself (INT_MAX * 2)", "body": "<p>What you are trying is impossible for 2 reasons.</p>\n\n<p>First, <code>INT_MAX + INT_MAX</code> cannot be represented by an <code>int</code>, which is logical since the maximum value of an <code>int</code> is <code>INT_MAX</code>. This leads to an overflow.</p>\n\n<p>Second, even if you try to do <code>(3 / (3 + 3))</code> you will get 0 since you are working with integers and not fractional numbers. Do do what you want to do you can try:</p>\n\n<p><code>static_cast&lt;double&gt;(INT_MAX) / (static_cast&lt;double&gt;(INT_MAX) + static_cast&lt;double&gt;(INT_MAX))</code> though this has no interest.</p>\n"}], "owner": {"reputation": 3, "user_id": 4075075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101f633270f07391c645d0a6526ccd35?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Wong", "link": "https://stackoverflow.com/users/4075075/eric-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 49284732, "answer_count": 1, "score": -4, "last_activity_date": 1521051132, "creation_date": 1521050047, "question_id": 49284646, "link": "https://stackoverflow.com/questions/49284646/int-max-divided-by-twice-of-itself-int-max-2", "title": "INT_MAX divided by twice of itself (INT_MAX * 2)", "body": "<p>in C++, I wonder how to get the correct answer 0.5 for \"INT_MAX / (INT_MAX + INT_MAX)\"? I tried cast the divisor/both divisor and dividend to long, and also cast divisor to double, all return -1073741823. Could anyone give me some advice ? Thanks.</p>\n"}, {"tags": ["c++", "prefix", "infix-notation"], "comments": [{"owner": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 1, "creation_date": 1521049892, "post_id": 49284524, "comment_id": 85572002, "body": "Where / What do you think the problem is?"}, {"owner": {"reputation": 31, "user_id": 8418148, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c247d6736a8cd2d060ac31a59ef74c7?s=128&d=identicon&r=PG&f=1", "display_name": "Zenor27", "link": "https://stackoverflow.com/users/8418148/zenor27"}, "reply_to_user": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521050415, "post_id": 49284524, "comment_id": 85572324, "body": "Yes there is a problem with my parentheses-handling...but i don&#39;t know how to solve it"}, {"owner": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521050446, "post_id": 49284524, "comment_id": 85572349, "body": "&quot;I think I see the problem&quot; Ok, well, what is it that you see? Just because X doesn&#39;t work doesn&#39;t mean you know where the problem is."}, {"owner": {"reputation": 31, "user_id": 8418148, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c247d6736a8cd2d060ac31a59ef74c7?s=128&d=identicon&r=PG&f=1", "display_name": "Zenor27", "link": "https://stackoverflow.com/users/8418148/zenor27"}, "reply_to_user": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521050873, "post_id": 49284524, "comment_id": 85572621, "body": "The problem is that when there is two operators in the stack the algorithm try to get the left and the right operand, but it can happen that there is just one operand in the stack, for example (1+2) : the algorithm push ( and + in the operator stack and 1 in the operand stack, but I need another operand (the 2)"}, {"owner": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521051002, "post_id": 49284524, "comment_id": 85572689, "body": "Add this to your question, it helps to understand what is going on with this code, and where the problem specifically lies."}, {"owner": {"reputation": 31, "user_id": 8418148, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c247d6736a8cd2d060ac31a59ef74c7?s=128&d=identicon&r=PG&f=1", "display_name": "Zenor27", "link": "https://stackoverflow.com/users/8418148/zenor27"}, "reply_to_user": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521051168, "post_id": 49284524, "comment_id": 85572799, "body": "Done, I hope it&#39;s understandable"}, {"owner": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521051292, "post_id": 49284524, "comment_id": 85572867, "body": "Have you looked at this through a debugger?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1521051415, "post_id": 49284524, "comment_id": 85572933, "body": "Further editing is recommended. There is still danger of this question being closed for lacking an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Why an MCVE? Well, it could be we&#39;re lazy, but the reason I like them is the act of whittling the program down to the point where it is the bug, the whole bug, and nothing but the bug  almost always leads to the asker seeing the bug and how to fix it. This is far more educational for the asker than just about all of Stack Overflow&#39;s answers."}, {"owner": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 0, "creation_date": 1521052375, "post_id": 49284524, "comment_id": 85573436, "body": "This looks mostly like a minimal example, but it is not complete/verifiable as we have no test cases for which it is failing."}, {"owner": {"reputation": 145, "user_id": 8972359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe81755a07f76574d252cd0c2db4e6c?s=128&d=identicon&r=PG&f=1", "display_name": "R.Laney", "link": "https://stackoverflow.com/users/8972359/r-laney"}, "edited": false, "score": 0, "creation_date": 1521056803, "post_id": 49284524, "comment_id": 85575832, "body": "You might want to look more in to prefix notation  You can have multiple operands take as an argument the result of an operation in prefix notation like (* A + B C D) =&gt; (A * (B+C+D)) see: <a href=\"http://www.cs.man.ac.uk/~pjj/cs212/fix.html\" rel=\"nofollow noreferrer\">http://www.cs.man.ac.uk/~pjj/cs212/fix.html</a>"}], "owner": {"reputation": 31, "user_id": 8418148, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c247d6736a8cd2d060ac31a59ef74c7?s=128&d=identicon&r=PG&f=1", "display_name": "Zenor27", "link": "https://stackoverflow.com/users/8418148/zenor27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521051280, "creation_date": 1521049602, "last_edit_date": 1521051280, "question_id": 49284524, "link": "https://stackoverflow.com/questions/49284524/infix-to-prefix-algorithm", "title": "Infix to Prefix algorithm", "body": "<p>I need to transform a <code>Infix</code> expression into a <code>Prefix</code> expression. My algorithm works for expression without parenthesis, but when I add parenthesis this algorithm doesn't work anymore. </p>\n\n<p>The problem is that when there is two operators in the stack, the algorithm tries to get the left and the right operand, but it can happen that there is just one operand in the stack. For example <code>(1+2)</code>: the algorithm pushes <code>(</code> and <code>+</code> in the <code>operator</code> stack and <code>1</code> in the <code>operand</code> stack, but I need the other operand (the <code>2</code>). I think My code is broken in my while when I try to access to top of the <code>operand</code> stack (that is empty)</p>\n\n<p>Here is my code : </p>\n\n<pre><code>void transformerenprefixe(vector&lt;string&gt; tableau)\n{\n    stack&lt;string&gt; Operand;\n    stack&lt;string&gt; Operator;\n\n    string token;\n    string operatorElm;\n    string rightOperand;\n    string leftOperand;\n\n\n    for (size_t i = 0; i &lt; tableau.size(); i++)\n    {\n        token = tableau.at(i);\n        if (checkOperand(token))\n        {\n            Operand.push(token);\n        }\n        else if (token == \"(\" || Operator.empty() || precedence(token) &gt; precedence(Operator.top()))\n        {\n            Operator.push(token);\n        }\n        else if(token == \")\")\n        {\n            while (Operator.top() != \"(\")\n            {\n                operatorElm = Operator.top();\n                Operator.pop();\n                rightOperand = Operand.top();\n                Operand.pop();\n                leftOperand = Operand.top();\n                Operand.pop();\n                string operande = operatorElm + leftOperand + rightOperand;\n                Operand.push(operande);\n            }\n            operatorElm = Operator.top();\n            Operator.pop();\n        }\n        else if(precedence(token) &lt;= precedence(Operator.top()))\n        {\n            while (!Operator.empty() &amp;&amp; precedence(token) &lt;= precedence(Operator.top()))\n            {\n                operatorElm = Operator.top();\n                Operator.pop();\n                rightOperand = Operand.top();\n                Operand.pop();\n                leftOperand = Operand.top();\n                Operand.pop();\n                string operande = operatorElm + leftOperand + rightOperand;\n                Operand.push(operande);\n            }\n            Operator.push(token);\n        }\n    }\n\n    while (!Operator.empty())\n    {\n        operatorElm = Operator.top();\n        Operator.pop();\n        rightOperand = Operand.top();\n        Operand.pop();\n        leftOperand = Operand.top();\n        Operand.pop();\n        string operande = operatorElm + leftOperand + rightOperand;\n        Operand.push(operande);\n    }\n\n    cout &lt;&lt; \"The prefix expression is : \" &lt;&lt; Operand.top() &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1521049205, "post_id": 49284388, "comment_id": 85571581, "body": "1. Fix the formatting of your code 2. Don&#39;t tag C, this has nothing to do with C 3. What is the question? What problems do you have with your code?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1521049358, "post_id": 49284388, "comment_id": 85571682, "body": "You may want to consider a <code>std::vector</code> of <code>std::tuple&lt;int, int, int&gt;</code> instead. Better yet, store <code>struct</code>s."}, {"owner": {"reputation": 3966, "user_id": 868546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05c689f8a9d6a545795c89c6118f47db?s=128&d=identicon&r=PG", "display_name": "Drise", "link": "https://stackoverflow.com/users/868546/drise"}, "edited": false, "score": 1, "creation_date": 1521049594, "post_id": 49284388, "comment_id": 85571837, "body": "I smell an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 0, "last_activity_date": 1521050123, "last_edit_date": 1521050123, "creation_date": 1521049393, "answer_id": 49284456, "question_id": 49284388, "link": "https://stackoverflow.com/questions/49284388/how-to-access-vectorpairint-pairint-int-d20/49284456#49284456", "title": "How to access vector&lt;pair&lt;int, pair&lt;int, int&gt;&gt;&gt; D[20]?", "body": "<p>Well you are declaring an array of 20 vectors. So right way would be</p>\n\n<pre><code>D[1].push_back(make_pair(0,make_pair(1,2));\nint a = D[1][0].first;\npair&lt;int,int&gt; b = D[1][0].second;\nb.second++; // You now have a pair containing increased value. Original remains unchanged.\nint z = D[1][0].second.second; // contains the nested pair's second value\n</code></pre>\n\n<p>If you want to increase the second - then do it directly.</p>\n\n<pre><code>D[1][0].second.second++; // originally changed.\n</code></pre>\n\n<p>If you want to get pair which is in the last position you can get the size of the vector and validate and then get the last inserted element.</p>\n"}], "owner": {"reputation": 3, "user_id": 9493101, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tipy Joace", "link": "https://stackoverflow.com/users/9493101/tipy-joace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 49284456, "answer_count": 1, "score": -4, "last_activity_date": 1521050123, "creation_date": 1521049136, "last_edit_date": 1521049508, "question_id": 49284388, "link": "https://stackoverflow.com/questions/49284388/how-to-access-vectorpairint-pairint-int-d20", "title": "How to access vector&lt;pair&lt;int, pair&lt;int, int&gt;&gt;&gt; D[20]?", "body": "<p>Is it correct to save information like this?</p>\n\n<pre><code>D[1].push_back(make_pair(x,make_pair(y,0));\n</code></pre>\n\n<p>I need 0 in the second position of that pair.</p>\n\n<p>How do I access the values, for example:</p>\n\n<pre><code>int a,b;\n</code></pre>\n\n<p>I need a to get the value of <code>x</code>, <code>b</code> the value of <code>y</code>, and rise by 1, the last value (the 0 value from the second pair)</p>\n\n<p>Is it correct like this?</p>\n\n<pre><code>a=D[1].first; \nb=D[1].second.first;\nD[1].second.second++;\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521049998, "post_id": 49284182, "comment_id": 85572077, "body": "Welcome to C++. I&#39;d like to introduce you to your new best friend, <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>."}, {"owner": {"reputation": 473, "user_id": 4851239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/993fd5a9d2c3839ab78269293876adf7?s=128&d=identicon&r=PG&f=1", "display_name": "Johan van Breda", "link": "https://stackoverflow.com/users/4851239/johan-van-breda"}, "edited": false, "score": 0, "creation_date": 1521050059, "post_id": 49284182, "comment_id": 85572112, "body": "What about cin &gt;&gt; number[count];"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1521060991, "post_id": 49284182, "comment_id": 85577957, "body": "Don&#39;t use <code>highest</code> before you&#39;ve initialised it - have you forgotten to enable plenty of compiler warnings?  Oh, and don&#39;t assign to <code>number[SIZE]</code> - Valgrind will show you that&#39;s out of range."}], "answers": [{"tags": [], "owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "is_accepted": false, "score": 1, "last_activity_date": 1521048515, "creation_date": 1521048515, "answer_id": 49284206, "question_id": 49284182, "link": "https://stackoverflow.com/questions/49284182/c-find-highest-value-in-array/49284206#49284206", "title": "C ++ Find highest value in array", "body": "<pre><code>cin &gt;&gt; number[SIZE];\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>cin &gt;&gt; number[count];\n</code></pre>\n\n<p>It looks like you misstyped here. What you're actually doing now is reading 10 numbers into the same location into the array. That location is one past the last index of the array you own, resulting undefined behavior. It looks like for you this manifested as a \"corrupted stack.\"</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9493094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a6da3885124666f7a1f2cc76597d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Valley", "link": "https://stackoverflow.com/users/9493094/aaron-valley"}, "edited": false, "score": 0, "creation_date": 1521048745, "post_id": 49284220, "comment_id": 85571297, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 2, "last_activity_date": 1521048753, "last_edit_date": 1521048753, "creation_date": 1521048571, "answer_id": 49284220, "question_id": 49284182, "link": "https://stackoverflow.com/questions/49284182/c-find-highest-value-in-array/49284220#49284220", "title": "C ++ Find highest value in array", "body": "<p>firstly \n<code>cin &gt;&gt; number[SIZE];</code> --> <code>std::cin &gt;&gt; number[count];</code></p>\n\n<p>Secondly <code>highest</code> is un-initialized. initialize it with  <code>number[0]</code> as</p>\n\n<pre><code>highest  = number[0]; /* first time it should have array 0th element value */\nfor (count =1; count &lt; SIZE; count++) {\n    if (number[count] &gt; highest)\n        highest = number[count];\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1015, "user_id": 8919133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cn93c.png?s=128&g=1", "display_name": "Blasco", "link": "https://stackoverflow.com/users/8919133/blasco"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1521054877, "post_id": 49284563, "comment_id": 85574787, "body": "@user4581301 Thnx for the tip!"}], "tags": [], "owner": {"reputation": 1015, "user_id": 8919133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cn93c.png?s=128&g=1", "display_name": "Blasco", "link": "https://stackoverflow.com/users/8919133/blasco"}, "is_accepted": false, "score": 1, "last_activity_date": 1521054863, "last_edit_date": 1521054863, "creation_date": 1521049739, "answer_id": 49284563, "question_id": 49284182, "link": "https://stackoverflow.com/questions/49284182/c-find-highest-value-in-array/49284563#49284563", "title": "C ++ Find highest value in array", "body": "<p>You made a few mistakes. This would be the corrected version of your code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\nconst int SIZE = 10;\nint number[SIZE];\nint count;\nint highest;\n\nfor (count = 0; count &lt; SIZE; count++)\n{\n    cout &lt;&lt; \"Enter 10 numbers\" &lt;&lt; endl;\n    cin &gt;&gt; number[count];\n    cout &lt;&lt; \"you entered: \" &lt;&lt; number[count] &lt;&lt; endl;\n}\n\nhighest = number[0];\nfor (count = 1; count &lt; SIZE; count++)\n{\n    if (number[count] &gt; highest)\n        highest = number[count];\n}\n\ncout &lt;&lt; highest &lt;&lt; endl;\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>but consider the following solution, you can simplify and improve your code if you start learning the stl.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt; \n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"Enter 10 numbers:\\n\";\n    const int size = 10;\n    std::vector&lt;int&gt; v(size);\n    for (auto&amp; val : v) std::cin &gt;&gt; val;\n    std::cout &lt;&lt; \"max: \" &lt;&lt; *std::max_element(v.begin(),v.end()) &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9493094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a6da3885124666f7a1f2cc76597d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Valley", "link": "https://stackoverflow.com/users/9493094/aaron-valley"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1521068017, "answer_count": 3, "score": -1, "last_activity_date": 1521054863, "creation_date": 1521048437, "question_id": 49284182, "link": "https://stackoverflow.com/questions/49284182/c-find-highest-value-in-array", "closed_reason": "Not suitable for this site", "title": "C ++ Find highest value in array", "body": "<p>I'm trying to create a program that allows the user to enter 10 values, and then displays the highest value in the array. Everytime I run the program, it gives me an error saying the stack was corrupted. Help please? this is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\n\nint main()\n{\nconst int SIZE = 10;\nint number[SIZE];\nint count;\nint highest;\n\nfor (count = 0; count &lt; SIZE; count++)\n{\n    cout &lt;&lt; \"Enter 10 numbers\" &lt;&lt; endl;\n    cin &gt;&gt; number[SIZE];\n}\n\nfor (count =1; count &lt; SIZE; count++)\n{\n    if (number[count] &gt; highest)\n        highest = number[count];\n}\n\ncout &lt;&lt; highest &lt;&lt; endl;\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 8, "creation_date": 1521047443, "post_id": 49283794, "comment_id": 85570386, "body": "C++ itself knows nothing about the text size. You need to consume the OS specific interfaces for the task."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1521047443, "post_id": 49283794, "comment_id": 85570387, "body": "This entirely depends on what platform or shell you are using. c++ does not offer a standard solution."}, {"owner": {"reputation": 13, "user_id": 9492999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbbd650781f4bc57dc79e9f27e7ca47?s=128&d=identicon&r=PG&f=1", "display_name": "Jim M", "link": "https://stackoverflow.com/users/9492999/jim-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521047523, "post_id": 49283794, "comment_id": 85570440, "body": "@Fran&#231;oisAndrieux I&#39;m using Windows."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 1, "creation_date": 1521047533, "post_id": 49283794, "comment_id": 85570449, "body": "If you&#39;re in bash, you can use <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code\" rel=\"nofollow noreferrer\">ANSI Codes</a> to change text color if you just want to distinguish certain lines of text."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1521047559, "post_id": 49283794, "comment_id": 85570469, "body": "Probably not on the console. You should consider writing some GUI application, perhaps using <a href=\"http://qt.io/\" rel=\"nofollow noreferrer\">Qt</a>"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1521047610, "post_id": 49283794, "comment_id": 85570509, "body": "@JimM Have you ever seen text of varying size on the Windows console?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521047865, "post_id": 49283936, "comment_id": 85570690, "body": "<a href=\"http://www.figlet.org\" rel=\"nofollow noreferrer\">FIGlet</a> to the rescue!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521047895, "post_id": 49283936, "comment_id": 85570711, "body": "@tadman: Yissssssss"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1521047709, "creation_date": 1521047709, "answer_id": 49283936, "question_id": 49283794, "link": "https://stackoverflow.com/questions/49283794/changing-text-size/49283936#49283936", "title": "Changing text size", "body": "<p><strong>tl;dr: Not really, no.</strong></p>\n\n<p>Consoles are generally things that output plain text in some consistent way. Terminal emulators such as <code>cmd.exe</code>, or PuTTY, or your Linux terminal, may well provide a way to change font name and size for the whole window. Furthermore, many POSIX-compliant terminals understand formatting systems like \"<a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code\" rel=\"nofollow noreferrer\">ANSI Codes</a>\" that give a little control over colours and boldness, and I'm sure that Windows has similar functionality via WinAPI calls &mdash; these could be controlled by your C++ program. But none of this can take you out of the consistent-size, monospaced environment.</p>\n\n<h2>Option 1</h2>\n\n<p>Create a GUI instead. It seems like this is the direction you are headed, and it is the most appropriate solution if you really want fine, graphics-like control over how your program \"looks\".</p>\n\n<h2>Option 2</h2>\n\n<p>ASCII art:</p>\n\n<pre><code>    _   _                        \n   | \\ | |                     _ \n   |  \\| | __ _ _ __ ___   ___(_)\n   | . ` |/ _` | '_ ` _ \\ / _ \\  \n   | |\\  | (_| | | | | | |  __/_ \n   |_| \\_|\\__,_|_| |_| |_|\\___(_)\n\n                           Jordan\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9492999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbbd650781f4bc57dc79e9f27e7ca47?s=128&d=identicon&r=PG&f=1", "display_name": "Jim M", "link": "https://stackoverflow.com/users/9492999/jim-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "closed_date": 1521048841, "accepted_answer_id": 49283936, "answer_count": 1, "score": -1, "last_activity_date": 1521047709, "creation_date": 1521047280, "question_id": 49283794, "link": "https://stackoverflow.com/questions/49283794/changing-text-size", "closed_reason": "Needs details or clarity", "title": "Changing text size", "body": "<p>Is it possible to change the text size (not the whole console window) of a portion of words?</p>\n\n<p>For example, if I have something like this:</p>\n\n<pre><code>Name:\nJordan\n</code></pre>\n\n<p>I want to turn 'Name:' into a bigger font size and leave 'Jordan' as it is. Is this possible in C++?</p>\n"}, {"tags": ["c++", "xml", "xml-parsing"], "comments": [{"owner": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "edited": false, "score": 0, "creation_date": 1521065289, "post_id": 49283755, "comment_id": 85579915, "body": "Took a look at Rapid XML, while it does look very fast, it doesn&#39;t seem to implement XPath, which would allow you to directly access all level 6 and 7 nodes with a simple XPath expression like &quot;//Level5/*&quot;."}, {"owner": {"reputation": 13, "user_id": 9459188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/advDb.jpg?s=128&g=1", "display_name": "jayanth as", "link": "https://stackoverflow.com/users/9459188/jayanth-as"}, "reply_to_user": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "edited": false, "score": 0, "creation_date": 1521106248, "post_id": 49283755, "comment_id": 85593540, "body": "so @WilliamWalseth do you have any suggestions?"}, {"owner": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "edited": false, "score": 0, "creation_date": 1521120165, "post_id": 49283755, "comment_id": 85602835, "body": "I&#39;d suggest you consider Saxon, or other XML Parser, that let&#39;s you do this sort of thing with XPath.  XML Parsers are very fast, and are suitable for most applications.  See <a href=\"http://www.saxonica.com/saxon-c/index.xml\" rel=\"nofollow noreferrer\">saxonica.com/saxon-c/index.xml</a>"}, {"owner": {"reputation": 13, "user_id": 9459188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/advDb.jpg?s=128&g=1", "display_name": "jayanth as", "link": "https://stackoverflow.com/users/9459188/jayanth-as"}, "reply_to_user": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "edited": false, "score": 0, "creation_date": 1521148489, "post_id": 49283755, "comment_id": 85620788, "body": "Ok thank you. I will check if that helps."}], "owner": {"reputation": 13, "user_id": 9459188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/advDb.jpg?s=128&g=1", "display_name": "jayanth as", "link": "https://stackoverflow.com/users/9459188/jayanth-as"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521047174, "creation_date": 1521047174, "question_id": 49283755, "link": "https://stackoverflow.com/questions/49283755/how-to-access-intermediate-node-in-xml-using-rapidxml", "title": "How to access intermediate node in xml using RapidXml", "body": "<p>I am new to xml parsing and I am using RapidXml (as i learnt it is easy to get started and use). I have fair amount of knowledge in C++ so using them together.</p>\n\n<p>I have a xml file which in the format below:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Root-tag xmlns:xsi=\"\" xmlns:xsd=\"\" schemaVersion=\"\" xmlns=\"\"&gt;\n  &lt;Level2 fileType=\"\" version=\"\" typesetVersion=\"\"&gt;\n    &lt;Level31&gt;&lt;/Level31&gt;\n    &lt;Level32&gt;&lt;/Level32&gt;\n  &lt;/Level2&gt;\n  &lt;Level21 version=\"\" typeVersion=\"\"&gt;\n    &lt;Level34 xsi:type=\"\" typeVersion=\"\"&gt;\n      &lt;Level4 xsi:type=\"\" typeVersion=\"\"&gt;\n        &lt;Level5 xsi:type=\"\"&gt;\n          &lt;Level61&gt;xx&lt;/Level61&gt;\n          &lt;Level62&gt;xxx,xxx&lt;/Level62&gt;\n          &lt;Level63&gt;&lt;/Level63&gt;\n          &lt;Level64&gt;&lt;/Level64&gt;\n          &lt;Level65 typeVersion=\"\"&gt;\n            &lt;Level7&gt;&lt;/Level7&gt;\n          &lt;/Level65&gt;\n        &lt;/Level5&gt;\n      &lt;/Level4&gt;\n    &lt;/Level34&gt;\n  &lt;/Level21&gt;\n&lt;/Root-tag&gt;\n</code></pre>\n\n<p>Is there a way to access value at level 6 or 7 directly?\nReally appreciate any help.</p>\n"}, {"tags": ["c++", "optimization"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 3, "creation_date": 1521046770, "post_id": 49283593, "comment_id": 85569933, "body": "This might be better suited on <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1521046819, "post_id": 49283593, "comment_id": 85569972, "body": "Optimize for what? Memory? Performance? Code size?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1521046827, "post_id": 49283593, "comment_id": 85569975, "body": "Just do one pass manually instead of using <code>std::accumulate</code>"}, {"owner": {"reputation": 2137, "user_id": 1034253, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/nO7s7.png?s=128&g=1", "display_name": "Ufx", "link": "https://stackoverflow.com/users/1034253/ufx"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521047428, "post_id": 49283593, "comment_id": 85570376, "body": "@tadman optimize for performance."}], "answers": [{"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 6, "last_activity_date": 1521046927, "creation_date": 1521046927, "answer_id": 49283668, "question_id": 49283593, "link": "https://stackoverflow.com/questions/49283593/how-to-optimize-getting-average-values-of-array/49283668#49283668", "title": "How to optimize getting average values of array?", "body": "<p>You don't need to recalculate the sum from the beginning at each iteration. Just keep a running sum.</p>\n\n<pre><code>std::vector&lt;double&gt; f(const std::vector&lt;double&gt; &amp;v)\n{\n    std::vector&lt;double&gt; ret(v.size());\n\n    double cur = 0.;\n    for (size_t i = 0; i &lt; v.size(); ++i)\n    {\n        cur += v[i];\n        ret[i] = cur / (i + 1);\n    }\n\n    return ret;\n}\n</code></pre>\n\n<p>This is even amenable to working inplace, so if the caller doesn't mind losing the source vector it can avoid the extra allocation.</p>\n\n<pre><code>void f_inplace(std::vector&lt;double&gt; &amp;v)\n{\n    double cur = 0.;\n    for (size_t i = 0; i &lt; v.size(); ++i)\n    {\n        cur += v[i];\n        v[i] = cur / (i + 1);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1521047198, "post_id": 49283703, "comment_id": 85570225, "body": "<code>ret[i] &#47;= i + 1</code> is grouped as <code>ret[i] &#47;= (i + 1)</code>."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1521047449, "post_id": 49283703, "comment_id": 85570391, "body": "this does 2 loops over the array when it can be done with just one."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1521047492, "post_id": 49283703, "comment_id": 85570424, "body": "@bolov That&#39;s a micro optimization in my opinion. I don&#39;t see the point in optimizing to that level without benchmarks and/or profiling. It could even happen that 2 loops is faster than 1."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1521047708, "post_id": 49283703, "comment_id": 85570575, "body": "@Justin absolutely it can happen that 2 loops are better than one. But not in this case..."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1521047960, "post_id": 49283703, "comment_id": 85570747, "body": "@bolov My point is that it&#39;s not worth optimizing it further unless you have profiles that show this isn&#39;t fast enough and benchmarks to prove that you are improving it."}], "tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": false, "score": 4, "last_activity_date": 1521047217, "last_edit_date": 1521047217, "creation_date": 1521047033, "answer_id": 49283703, "question_id": 49283593, "link": "https://stackoverflow.com/questions/49283593/how-to-optimize-getting-average-values-of-array/49283703#49283703", "title": "How to optimize getting average values of array?", "body": "<p>Use <a href=\"http://en.cppreference.com/w/cpp/algorithm/partial_sum\" rel=\"nofollow noreferrer\"><code>std::partial_sum</code></a>:</p>\n\n<pre><code>std::vector&lt;double&gt; f(const std::vector&lt;double&gt; &amp;v)\n{\n    std::vector&lt;double&gt; ret(v.size());\n\n    std::partial_sum(v.begin(), v.end(), ret.begin());\n    for (size_t i = 0; i &lt; ret.size(); ++i) {\n        ret[i] /= i + 1;\n    }\n\n    return ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 2137, "user_id": 1034253, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/nO7s7.png?s=128&g=1", "display_name": "Ufx", "link": "https://stackoverflow.com/users/1034253/ufx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "closed_date": 1521049691, "accepted_answer_id": 49283668, "answer_count": 2, "score": 1, "last_activity_date": 1521066495, "creation_date": 1521046689, "last_edit_date": 1521066495, "question_id": 49283593, "link": "https://stackoverflow.com/questions/49283593/how-to-optimize-getting-average-values-of-array", "closed_reason": "Needs more focus", "title": "How to optimize getting average values of array?", "body": "<p>There is a function which is returned the average for all elements from beginning to <code>i + 1</code>.  </p>\n\n<pre><code>std::vector&lt;double&gt; f(const std::vector&lt;double&gt; &amp;v)\n{\n    std::vector&lt;double&gt; ret(v.size());\n\n    for (size_t i = 0; i &lt; v.size(); ++i) {\n        ret[i] = std::accumulate(v.begin(), v.begin() + i + 1, 0.0) / (i + 1);\n    }\n\n    return ret;\n}\n</code></pre>\n\n<p>How can I optimize this function?</p>\n"}, {"tags": ["c++", "c++11", "templates", "gcc", "visual-studio-2015"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 3, "creation_date": 1521046798, "post_id": 49283587, "comment_id": 85569955, "body": "<code>template &lt;&gt;</code> -- that looks like nonsense."}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1521047038, "post_id": 49283587, "comment_id": 85570125, "body": "@Yakk Well, if you think about it, that&#39;s how you would introduce any explicit specialization. It actually looks pretty natural to me."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1521047231, "post_id": 49283587, "comment_id": 85570243, "body": "@Yakk ...but is accepted by GCC and Clang w/ <code>-pedantic-errors</code>. The Clang warns about it having no effect though."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1521047385, "post_id": 49283587, "comment_id": 85570343, "body": "also clang++ compile but with &quot;warning: extraneous template parameter list in template specialization&quot; (pointing the line <code>template &lt;&gt;</code>)"}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 1, "creation_date": 1521047452, "post_id": 49283587, "comment_id": 85570392, "body": "And, by the way, the error given by Visual Studio <code>cannot be explicitly specialized</code> looks totally misleading to me, because that&#39;s actually what we are able to achieve here."}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 3, "creation_date": 1521049327, "post_id": 49283587, "comment_id": 85571668, "body": "That is just a partial specialization. I&#39;ve only ever seen two lines of <code>template &lt;...&gt;</code> used when you are referring to a template inside another template which is not the case here."}, {"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "reply_to_user": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 0, "creation_date": 1521055770, "post_id": 49283587, "comment_id": 85575268, "body": "@super It&#39;s interesting how you can partially specialize a template which has only one template argument. It&#39;s counter-intuitive, but it makes sense the moment we see that one template argument as something that can be templated (somehow we &quot;split&quot; that one template argument)."}], "answers": [{"comments": [{"owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "edited": false, "score": 0, "creation_date": 1521145775, "post_id": 49284775, "comment_id": 85619465, "body": "I think the key here is that one can have partial specialization even if there is only one template argument (if you see that one template argument as something that can be &quot;split&quot; into a templetable class). A partial specialization can have more template parameters then the class being partially specialized!!"}], "tags": [], "owner": {"reputation": 2123, "user_id": 2212026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AyWTS.jpg?s=128&g=1", "display_name": "shakurov", "link": "https://stackoverflow.com/users/2212026/shakurov"}, "is_accepted": false, "score": 2, "last_activity_date": 1521050456, "creation_date": 1521050456, "answer_id": 49284775, "question_id": 49283587, "link": "https://stackoverflow.com/questions/49283587/templated-class-specialization-where-template-argument-is-templated-difference/49284775#49284775", "title": "Templated class specialization where template argument is templated: difference Visual Studio vs. g++", "body": "<p>If I read the standard correctly, <code>template&lt;&gt;</code> should not be used in this case.</p>\n\n<p>Basically, you have to provide multiple template parameter lists for nested templates:</p>\n\n<p>(see [temp.mem] \u00a71)</p>\n\n<blockquote>\n  <p>A template can be declared within a class or class template; such a template is called a member template. A member template can be defined within or outside its class definition or class template definition. A member template of a class template that is defined outside of its class template definition shall be specified with the template-parameters of the class template <strong>followed by the template-parameters of the member template.</strong></p>\n</blockquote>\n\n<p>...but you <strong>don't</strong> need to provide an additional template parameter list for specializing a template with a template parameter:</p>\n\n<p>(see [temp.class.spec] \u00a72)</p>\n\n<blockquote>\n  <p>Each class template partial specialization is a distinct template...</p>\n</blockquote>\n\n<p>(and then \u00a74)</p>\n\n<blockquote>\n  <p>The template parameters are specified in the angle bracket enclosed list that immediately follows the keyword template. For partial specializations, the template argument list is explicitly written immediately following the class template name. For primary templates, this list is implicitly described by the template parameter list...</p>\n</blockquote>\n\n<p>There's nothing to suggest that an additional template parameter list is required - a specialization is just a template, and as such it requires just a single parameter list.</p>\n"}], "owner": {"reputation": 17210, "user_id": 2436175, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/CK0Zo.png?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/2436175/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1521050456, "creation_date": 1521046646, "question_id": 49283587, "link": "https://stackoverflow.com/questions/49283587/templated-class-specialization-where-template-argument-is-templated-difference", "title": "Templated class specialization where template argument is templated: difference Visual Studio vs. g++", "body": "<p>The following code, which I derived reading <a href=\"https://stackoverflow.com/questions/4189945/templated-class-specialization-where-template-argument-is-a-template\">this</a>, compiles and behaves fine in gcc (<a href=\"http://coliru.stacked-crooked.com/a/806ad8c67a4d471e\" rel=\"noreferrer\">link</a>), but in Visual Studio gives an error.</p>\n\n<blockquote>\n  <p>Error C2910 '<code>my_property&lt;A&lt;U&gt;&gt;</code>': cannot be explicitly specialized</p>\n</blockquote>\n\n<p>It works fine only if I remove the <code>template &lt;&gt;</code> line. \nI got the workaround <a href=\"https://stackoverflow.com/a/13970541/2436175\">here</a>. The workaround version is ok also in g++.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;typename T&gt;\nstruct A {\n  T x;\n};\n\ntemplate &lt;typename T&gt;\nstruct my_property {\n  static const bool value = false;\n};\n\ntemplate &lt;&gt; //Remove this and it will work in Visual Studio\ntemplate &lt;typename U&gt;\nstruct my_property&lt;A&lt;U&gt;&gt; {\n  static const bool value = true;\n};\n\nint main() \n{\n  std::cout &lt;&lt; std::boolalpha;\n  std::cout &lt;&lt; my_property&lt;int&gt;::value &lt;&lt; '\\n'; //false\n  std::cout &lt;&lt; my_property&lt;A&lt;int&gt;&gt;::value &lt;&lt; '\\n'; //true\n  std::cout &lt;&lt; my_property&lt;A&lt;float&gt;&gt;::value &lt;&lt; '\\n'; //true\n}\n</code></pre>\n\n<p>Which compiler is right?</p>\n"}, {"tags": ["c++", "antlr4"], "comments": [{"owner": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "edited": false, "score": 0, "creation_date": 1521103702, "post_id": 49283333, "comment_id": 85591919, "body": "Have you looked at the <a href=\"https://github.com/antlr/antlr4/tree/master/runtime/Cpp/demo\" rel=\"nofollow noreferrer\">C++ demo</a>? It will answer exactly these questions."}, {"owner": {"reputation": 1, "user_id": 9492844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c13bab974860ed98eb555b3356ba3?s=128&d=identicon&r=PG", "display_name": "James Dilts", "link": "https://stackoverflow.com/users/9492844/james-dilts"}, "reply_to_user": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "edited": false, "score": 0, "creation_date": 1521140906, "post_id": 49283333, "comment_id": 85616921, "body": "I did. I can do all of it up to &quot;and run.&quot; But it generates a .dll or .lib, and I&#39;m not sure what to do with them. Are THOSE the files I use in my own project? Because the demo has a main() that seems like it should run, but it doesn&#39;t, of course, because it&#39;s a .dll or .lib. Or do I set things up the same way as the example (somehow) and then it will let me use the parser?"}, {"owner": {"reputation": 36245, "user_id": 1137174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/361fd9b1b32d13cd1c1dc03e5c6a2127?s=128&d=identicon&r=PG", "display_name": "Mike Lischke", "link": "https://stackoverflow.com/users/1137174/mike-lischke"}, "edited": false, "score": 0, "creation_date": 1521188470, "post_id": 49283333, "comment_id": 85633272, "body": "It&#39;s not a lib. The demo is a terminal application. You probably only built the runtime, not the entire demo."}], "owner": {"reputation": 1, "user_id": 9492844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c13bab974860ed98eb555b3356ba3?s=128&d=identicon&r=PG", "display_name": "James Dilts", "link": "https://stackoverflow.com/users/9492844/james-dilts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521045814, "creation_date": 1521045814, "question_id": 49283333, "link": "https://stackoverflow.com/questions/49283333/basic-antlr4-use-in-visual-studio-2017-c", "title": "Basic ANTLR4 use in Visual Studio 2017 (C++)", "body": "<p>I'm trying to use ANTLR4 in Visual Studio 2018 (C++, Windows 10), and I simply do not understand what to do, despite reading the <a href=\"https://github.com/antlr/antlr4/blob/master/doc/getting-started.md\" rel=\"nofollow noreferrer\">getting started</a> and the <a href=\"https://github.com/antlr/antlr4/blob/master/doc/cpp-target.md\" rel=\"nofollow noreferrer\">C++ target readme</a>, and looking at a dozen other places.</p>\n\n<p>I can take the grammar suggested from the getting started page, and use the ANTLR4 jar to create the HelloParser.h, HelloParser.cpp, etc files. I have downloaded the runtime (antlr4-cpp-runtime-4.7.1-vs2015) as well. But what am I supposed to do with these files in order to include them in my main solution/project? Let's say my solution is in C:\\Users\\UserName\\source\\repos\\test. </p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521045874, "post_id": 49283319, "comment_id": 85569297, "body": "Why, in 2018, use MD5?"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521045912, "post_id": 49283319, "comment_id": 85569321, "body": "Any better suggestions , although that&#39;s not of main concern here, it&#39;s for a trial so gtg with it"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521046061, "post_id": 49283319, "comment_id": 85569415, "body": "I&#39;d go with SHA2-256 at the very last and SHA2-512 if I cared about detecting changes reliably."}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521046103, "post_id": 49283319, "comment_id": 85569449, "body": "@tadman ok, will do the needful, thanks :)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046199, "post_id": 49283319, "comment_id": 85569534, "body": "what sense use <code>ReadProcessMemory</code> for read itself from memory ?! read memory direct"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046298, "post_id": 49283319, "comment_id": 85569604, "body": "<code>ReadProcessMemory(hMyProcess, moduleInfo.lpBaseOfDll,         &amp;hexEXE, moduleInfo.SizeOfImage, 0)</code> - <b><code>&amp;hexEXE</code></b> !"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1521046308, "post_id": 49283319, "comment_id": 85569614, "body": "@RbMm sorry, I don&#39;t get you, the purpose is to read itself from memory and then calculate it&#39;s checksum, so as to detect debuggers, I know there are ways to bypass it and also better ways to check it but I want to implement this, if you can help with this thanks ."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1521046359, "post_id": 49283319, "comment_id": 85569647, "body": "You don&#39;t need to use <code>ReadProcessMemory</code>. You can simply read the memory directly, the way you would read any memory."}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046385, "post_id": 49283319, "comment_id": 85569663, "body": "@RbMm I tried <b>&amp;hexEXE</b> too, but the printf&#39;s don&#39;t trigger, i.e. the <code>if</code> condition still remains false ."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046392, "post_id": 49283319, "comment_id": 85569669, "body": "use <code>ReadProcessMemory</code> exist sense use for read memory for <b>another</b> process. for read memory of current process - it not need"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046423, "post_id": 49283319, "comment_id": 85569683, "body": "<i>I tried &amp;hexEXE too</i> - and this is error"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046427, "post_id": 49283319, "comment_id": 85569684, "body": "@RbMm ok , I get it, how do I read memory directly ?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046457, "post_id": 49283319, "comment_id": 85569706, "body": "@hemo - <i>how do I read memory directly</i> - very strange question"}, {"owner": {"reputation": 787, "user_id": 6715227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NB84a.png?s=128&g=1", "display_name": "stetoc", "link": "https://stackoverflow.com/users/6715227/stetoc"}, "edited": false, "score": 0, "creation_date": 1521046526, "post_id": 49283319, "comment_id": 85569760, "body": "@hemo you have no clue about how windows exe works and looks in memory after it&#39;s executed, also you want to use ReadProcessMemory to read from memory of own process? You clearly need to educate yourself, you&#39;re not gonna achieve anything without basic knownledge, not even simple md5 checksum"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046544, "post_id": 49283319, "comment_id": 85569779, "body": "@RbMm, I may sound silly ( which I believe I am ), but what do you mean by the above comment &quot;I tried &amp;hexEXE too - and this is error &quot;"}, {"owner": {"reputation": 787, "user_id": 6715227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NB84a.png?s=128&g=1", "display_name": "stetoc", "link": "https://stackoverflow.com/users/6715227/stetoc"}, "edited": false, "score": 2, "creation_date": 1521046644, "post_id": 49283319, "comment_id": 85569846, "body": "@hemo that&#39;s how stuff works - you can copypaste many things from stackoverflow, but you can&#39;t copypaste your way through everything you want whenever you want, it&#39;s like you want to solve integral eq without knowing how to multiply two numbers"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521046670, "post_id": 49283319, "comment_id": 85569862, "body": "@RbMm I mean it&#39;s not that I&#39;ve to read a single point of memory, rather the whole chunk of memory, I thought there is some shortcut for that so asked, instead of iterating over using a loop like <code>&amp;address</code> ..."}, {"owner": {"reputation": 787, "user_id": 6715227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NB84a.png?s=128&g=1", "display_name": "stetoc", "link": "https://stackoverflow.com/users/6715227/stetoc"}, "edited": false, "score": 0, "creation_date": 1521046754, "post_id": 49283319, "comment_id": 85569919, "body": "@hemo you&#39;re not gonna receive here any copypaste friendly code, at first I was going to paste you some snippets but now I clearly see you don&#39;t have clue about what you want to do"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521047100, "post_id": 49283319, "comment_id": 85570178, "body": "@RbMm oh sorry man, I get it , it was silly <b>&amp;hexEXE</b>, but that still doesn&#39;t work, I get it that I can read the process memory iterating over addresses but why doesn&#39;t it work ?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1521047330, "post_id": 49283319, "comment_id": 85570311, "body": "@hemo: We are not a tutoring site. Please get the basics and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Edit your question according to the rules and don&#39;t use comments for extended discussion or follow-up questions."}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "edited": false, "score": 0, "creation_date": 1521048886, "post_id": 49284092, "comment_id": 85571391, "body": "Anyone who&#39;s downvoted this, can you please comment what&#39;s wrong with this, I don&#39;t know how to properly print it but that&#39;s not my concern"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1521051019, "post_id": 49284092, "comment_id": 85572699, "body": "(Not my vote) It might not be <i>your</i> concern, but at least 2 people seem to think that pictures of text are a bad idea. That said - &quot;extended discussion&quot; is also a red flag on a pure Question&amp;Answers site."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1521053405, "post_id": 49284092, "comment_id": 85574021, "body": "You seem to be asking a question in this answer."}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1521088951, "post_id": 49284092, "comment_id": 85586090, "body": "@DavidHeffernan I&#39;m actually unclear of one point and thought it would be better if someone might answer that"}, {"owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1521088994, "post_id": 49284092, "comment_id": 85586104, "body": "@MSalters I took pictures of text to make it clear, nothing unintended"}], "tags": [], "owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "is_accepted": false, "score": -2, "last_activity_date": 1521048195, "creation_date": 1521048195, "answer_id": 49284092, "question_id": 49283319, "link": "https://stackoverflow.com/questions/49283319/how-can-a-program-read-its-own-image-from-memory-via-readprocessmemory/49284092#49284092", "title": "How can a program read its own image from memory via ReadProcessMemory?", "body": "<p>Sorry for the extended discussion, but I got it running by changing the code to instead of using <strong>ReadProcessMemory</strong> directly iterating over the memory through a <em>for loop</em> like this :</p>\n\n<pre><code> long *baseAddress = (long *)moduleInfo.lpBaseOfDll;\n    printf(\"%d %x\\n\",baseAddress, baseAddress);\n    for (int i = 0; i &lt; moduleInfo.SizeOfImage; ++i){\n        long *addressToRead = baseAddress+i;\n        printf(\"%x : %x\\n\", addressToRead, *addressToRead);\n    }\n</code></pre>\n\n<p>Here's the output :</p>\n\n<p><a href=\"https://i.stack.imgur.com/SACTW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SACTW.png\" alt=\"This is the output \"></a></p>\n\n<h2>Further thoughts</h2>\n\n<p>However, I don't understand why am I not able to get it using <strong>ReadProcessMemory</strong>.</p>\n"}], "owner": {"reputation": 90, "user_id": 9196854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9412c312d7a8fca1c6ef7854a5ff563f?s=128&d=identicon&r=PG&f=1", "display_name": "hemo", "link": "https://stackoverflow.com/users/9196854/hemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1521580894, "creation_date": 1521045770, "last_edit_date": 1521580894, "question_id": 49283319, "link": "https://stackoverflow.com/questions/49283319/how-can-a-program-read-its-own-image-from-memory-via-readprocessmemory", "title": "How can a program read its own image from memory via ReadProcessMemory?", "body": "<p>I am trying to make an executable which can read itself from memory using <strong>ReadProcessMemory</strong> api of windows.</p>\n\n<p>Then, I will use this to calculate the checksum of executable.</p>\n\n<p>This is my code : </p>\n\n<pre><code>#define PSAPI_VERSION 1\n#include &lt;string&gt;\n#include &lt;windows.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;psapi.h&gt;\n#include &lt;Wincrypt.h&gt;\n\n#define BUFSIZE 1024\n#define MD5LEN  16\n\n// To ensure correct resolution of symbols, add Psapi.lib to TARGETLIBS\n#pragma comment(lib, \"psapi.lib\")\n\n\nint main(void)\n{\n\n    HWND hMyProcess = (HWND)(GetCurrentProcess());\n    HMODULE hModule = (HMODULE)GetModuleHandle(NULL);\n    TCHAR szProcessName[MAX_PATH] = TEXT(\"&lt;unknown&gt;\");\n    MODULEINFO moduleInfo;\n    if(hModule != NULL &amp;&amp; hMyProcess != NULL){\n        // if (GetModuleInformation())\n        GetModuleBaseName(hMyProcess, hModule, szProcessName, MAX_PATH);\n        printf(\"%s\\n\", szProcessName);\n        if (GetModuleInformation(hMyProcess, hModule, &amp;moduleInfo, sizeof(moduleInfo))){\n            printf(\"lpBaseOfDLL : %x\\n\", moduleInfo.lpBaseOfDll);\n            printf(\"Entry Point : %x\\n\", moduleInfo.EntryPoint);\n            printf(\"SizeOfImage : %x\\n\", moduleInfo.SizeOfImage);\n        }\n    }\n    // Till here working fine, problem lies below\n\n    // read process memory\n    TCHAR *hexEXE;\n    SIZE_T *lpNumberOfBytesRead;\n    if(ReadProcessMemory(hMyProcess, moduleInfo.lpBaseOfDll,\n        hexEXE, moduleInfo.SizeOfImage, 0)){\n        //printf(\"%s\\n\", hexEXE);\n        printf(\"Read memory\\n\");\n        printf(\"%d \\n\",strlen(hexEXE));\n    }\n\n    // will be implemented later, taken from --&gt; https://msdn.microsoft.com/en-us/library/aa382380(VS.85).aspx\n    DWORD dwStatus = 0;\n    BOOL bResult = FALSE;\n    HCRYPTPROV hProv = 0;\n    HCRYPTHASH hHash = 0;\n\n    /*if (!CryptAcquireContext(&amp;hProv,NULL,NULL,PROV_RSA_FULL,CRYPT_VERIFYCONTEXT)){\n        dwStatus = GetLastError();\n        printf(\"CryptAcquireContext failed: %d\\n\", dwStatus);\n        //CloseHandle(hFile);\n        return dwStatus;\n    }\n\n    if (!CryptCreateHash(hProv, CALG_MD5, 0, 0, &amp;hHash)){\n        dwStatus = GetLastError();\n        printf(\"CryptAcquireContext failed: %d\\n\", dwStatus);\n        //CloseHandle(hFile);\n        CryptReleaseContext(hProv, 0);\n        return dwStatus;\n    }*/\n\n\n\n    return 0;\n}\n</code></pre>\n\n<h2>Problem :</h2>\n\n<p>I am not able to read the my own process's memory, it's the first time I'm using <strong>WinAPI</strong>, so perhaps I am using the function in some wrong way.</p>\n\n<p>The program just hangs and it shows \"Windows has encountered some problem...\"</p>\n\n<h2>Possible Reasons of Error :</h2>\n\n<p>I think the handle to the process ( <strong>hMyProcess</strong> ) I'm getting earlier isn't with the required privileges ( <strong>PROCESS_VM_READ</strong> ), how do I verify it and if it isn't then how do I get the correct privileges. </p>\n"}, {"tags": ["c++", "qt", "file"], "comments": [{"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521045100, "post_id": 49283046, "comment_id": 85568800, "body": "Every computer store internally only 0 and 1&#39;s. Hex is just an easy way to see its contents."}, {"owner": {"reputation": 119, "user_id": 9492756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juliette Marquis", "link": "https://stackoverflow.com/users/9492756/juliette-marquis"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521045590, "post_id": 49283046, "comment_id": 85569123, "body": "Yes, that is why I had a doubt about the need to convert them in my file. But the thing is I need to read a .bin that has contents in bits and not hexadecimal notation :P"}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521045768, "post_id": 49283046, "comment_id": 85569233, "body": "That is what I said. They are only stored in binary. Hex is just a convenient way to see it. There is no conversion to be done, just the way you want to present it. This mean that when you see 0xF, internally they are stored as 1111 in binary (assuming only 4 bits)"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1521046134, "post_id": 49283046, "comment_id": 85569470, "body": "You don&#39;t want to be using formatted operations (i.e. <code>operator&lt;&lt;</code>).  By definition, they format numbers into readable values.  And you don&#39;t want a <code>QDataStream</code> - as its documentation says, it&#39;s a platform-independent transfer representation.  You probably want to <code>writeRawData()</code> or simply use your <code>QIODevice</code> directly (i.e. <code>QIODevice::write()</code>)."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1521046599, "post_id": 49283046, "comment_id": 85569817, "body": "<i>&quot;So far, I succeeded in writing a .bin where the content has an hexadecimal format&quot;</i> as viewed by what? It&#39;s not clear what you are saying. You either have a binary file or you don&#39;t. The rest is merely a matter of how you are viewing the data, and you may be viewing it in a hex editor, for example. You also forgot to show us what the desired content is... only the wrong one..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1521049526, "post_id": 49283046, "comment_id": 85571791, "body": "Reading the documentation to <code>QDataStream</code>, I&#39;d assume the content of facts.bin was viewed in a hex editor; <b><i>if</i></b> this is the case, then you have already what you are after: Binary representation of your data on disk. It then is the <i>hex editor</i> that converts the bytes in the file into hexadecimal, human readable <i>textual</i> representation on the screen (be aware that every byte in the file is represented by two characters on the screen then)."}, {"owner": {"reputation": 119, "user_id": 9492756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juliette Marquis", "link": "https://stackoverflow.com/users/9492756/juliette-marquis"}, "edited": false, "score": 0, "creation_date": 1521102869, "post_id": 49283046, "comment_id": 85591459, "body": "Thank you all for your comments and your answers. I think I understood better the way things work : the .bin resulting from my program is just a representation (in hexadecimal) of the binary data the computer stores."}], "answers": [{"tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": true, "score": 2, "last_activity_date": 1521052091, "last_edit_date": 1521052091, "creation_date": 1521051381, "answer_id": 49285028, "question_id": 49283046, "link": "https://stackoverflow.com/questions/49283046/how-to-write-binary-and-not-hex-in-bin-with-qt-and-c/49285028#49285028", "title": "How to write binary (and not hex) in .bin with qt and c++?", "body": "<p>This is a non issue. Binary, octal, decimal, hexadecimal and so on - that's just different representation of the same data. </p>\n\n<p>Computers are binary, and all data stored on a computer is therefore binary data.</p>\n\n<p>Don't be tricked by the default/preferable way binary data is output to humans, which is usually hexadecimal for the sake of brevity, and for technical and historic reasons.</p>\n\n<p>The smallest thing computers can address is a byte. Unless you pack data explicitly, boolean values are stored as bytes too, even though they only require a single bit in theory. You cannot really read or write a single bit, that operation would involve reading or writing the container byte plus some bitwise operations to extract or splice in the desired bit. </p>\n\n<p>And finally, keep in mind that data is very often actually <strong>not</strong> stored in a binary format but as \"text\" that needs additional parsing in order to be read. It is such cases where the numeric system is important, because this tells the computer how to interpret the text in order to convert it to the proper binary data. So that it knows whether a <code>101</code> is a 5 (bin), or a 65 (oct), or a 101 (dec) or a 257 (hex).</p>\n"}], "owner": {"reputation": 119, "user_id": 9492756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Juliette Marquis", "link": "https://stackoverflow.com/users/9492756/juliette-marquis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 49285028, "answer_count": 1, "score": 1, "last_activity_date": 1521052091, "creation_date": 1521044955, "last_edit_date": 1521046246, "question_id": 49283046, "link": "https://stackoverflow.com/questions/49283046/how-to-write-binary-and-not-hex-in-bin-with-qt-and-c", "title": "How to write binary (and not hex) in .bin with qt and c++?", "body": "<p>I am trying to write a binary document. So far, I succeeded in writing a .bin where the content has an hexadecimal format. I would like to have the content in a binary format (0 and 1 only).</p>\n\n<p>Is it possible ?\nHow to do it ?\nAm I wrong in my idea and having it in hexadecimal or binary is the same thing ?</p>\n\n<p>Here is my code so far :)</p>\n\n<pre><code>#include &lt;QApplication&gt;\n#include &lt;QDataStream&gt;\n#include &lt;QString&gt;\n#include &lt;QFile&gt;\n#include &lt;iostream&gt;\n#include &lt;QDebug&gt;\n#include &lt;QTextStream&gt;\nvoid createBinaryFile()\n{\n    int a = 22;\n\n    QFile file(\"/home/.../facts.bin\");\n    if (!file.open(QIODevice::WriteOnly)) {\n        std::cerr &lt;&lt; \"Cannot open file for writing: \"\n              &lt;&lt; qPrintable(file.errorString()) &lt;&lt; std::endl;\n    return;\n    }\n    QDataStream out(&amp;file);\n    out.setVersion(QDataStream::Qt_4_3);\n    out &lt;&lt; quint32(0x12345678) &lt;&lt; a;\n    QTextStream writeInConsole(stdout);\n    writeInConsole &lt;&lt; a;\n\n    file.flush();\n    file.close();\n\n}\nvoid readBinaryFile()\n{\n    quint32 n;\n    int a;\n    QFile file(\"/home/.../facts.bin\");\n    if (!file.open(QIODevice::ReadOnly)) {\n        std::cerr &lt;&lt; \"Cannot open file for reading: \"\n              &lt;&lt; qPrintable(file.errorString()) &lt;&lt; std::endl;\n    return;\n}\n\nQDataStream in(&amp;file);\nin.setVersion(QDataStream::Qt_4_3);\n\nin &gt;&gt; n &gt;&gt; a;\nQTextStream okk(stdout);\nokk &lt;&lt; a;\n}\n\nint main(int argc, char *argv[])\n{\nQApplication app(argc, argv);\ncreateBinaryFile();\n//readBinaryFile();\n\nreturn app.exec();\n}\n</code></pre>\n\n<p>And this is the content of facts.bin :\n1234 5678 0000 0016 </p>\n\n<p>Thank you very much for your help ! :)</p>\n"}, {"tags": ["python", "c++", "tensorflow", "bazel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9492514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "9friday", "link": "https://stackoverflow.com/users/9492514/9friday"}, "edited": false, "score": 0, "creation_date": 1530088970, "post_id": 50458567, "comment_id": 89106741, "body": "Thanks for the answer. I actually found out another way to do what i needed using the <a href=\"https://github.com/opencv/opencv/wiki/TensorFlow-Object-Detection-API\" rel=\"nofollow noreferrer\">Deep Learning support in OpenCV</a>. This also does not require TensorFlow to be installed in the machine running the classification."}], "tags": [], "owner": {"reputation": 26, "user_id": 4165968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3f3272eed1913445eef1bf768b9493?s=128&d=identicon&r=PG&f=1", "display_name": "szm", "link": "https://stackoverflow.com/users/4165968/szm"}, "is_accepted": false, "score": 0, "last_activity_date": 1526952500, "creation_date": 1526952500, "answer_id": 50458567, "question_id": 49283031, "link": "https://stackoverflow.com/questions/49283031/exporting-trained-tensorflow-models-to-c/50458567#50458567", "title": "Exporting trained TensorFlow models to C++", "body": "<p>in order to export object detection models I use the export_inference_graph.py code in research/object-detection. Here's an example of running the code:</p>\n\n<pre><code>python3 export_inference_graph.py \\\n--input_type image_tensor \\\n--pipeline_config_path path/to/model.config \\    \n--trained_checkpoint_prefix path/to/model.ckpt-CHECKPOINTNUMBER \\    \n--output_directory path/to/frozen_inference_graph\n</code></pre>\n\n<p>Then I use the created frozen_inference_graph.pb with a C++ code that is essentially the same as <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/label_image/main.cc\" rel=\"nofollow noreferrer\">label_image</a> with little modifications to run for a detection model rather than a classification one.</p>\n"}], "owner": {"reputation": 1, "user_id": 9492514, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "9friday", "link": "https://stackoverflow.com/users/9492514/9friday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1293, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1526952500, "creation_date": 1521044907, "question_id": 49283031, "link": "https://stackoverflow.com/questions/49283031/exporting-trained-tensorflow-models-to-c", "title": "Exporting trained TensorFlow models to C++", "body": "<p>I am trying to export trained TensorFlow models to C++ using <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/tools/freeze_graph.py\" rel=\"nofollow noreferrer\">freeze_graph.py</a>. I am trying to export the ssd_mobilenet_v1_coco_2017_11_17 model using the following syntax:</p>\n\n<pre><code>bazel build tensorflow/python/tools:freeze_graph &amp;&amp; \\\nbazel-bin/tensorflow/python/tools/freeze_graph \\\n--input_graph=frozen_inference_graph.pb \\\n--input_checkpoint=model.ckpt \\\n--output_graph=/tmp/frozen_graph.pb --output_node_names=softmax \n</code></pre>\n\n<p>The terminal said that the build was successful but showed the following error:</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 350, in &lt;module&gt;\n    app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 124, in run\n    _sys.exit(main(argv))\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 249, in main\n    FLAGS.saved_model_tags)\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 227, in freeze_graph\n    input_graph_def = _parse_input_graph_proto(input_graph, input_binary)\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 171, in _parse_input_graph_proto\n    text_format.Merge(f.read(), input_graph_def)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 525, in Merge\n    descriptor_pool=descriptor_pool)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 579, in MergeLines\n    return parser.MergeLines(lines, message)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 612, in MergeLines\n    self._ParseOrMerge(lines, message)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 627, in _ParseOrMerge\n    self._MergeField(tokenizer, message)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 671, in _MergeField\n    name = tokenizer.ConsumeIdentifierOrNumber()\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 1144, in ConsumeIdentifierOrNumber\n    raise self.ParseError('Expected identifier or number, got %s.' % result)\ngoogle.protobuf.text_format.ParseError: 2:1 : Expected identifier or number, got `.\n</code></pre>\n\n<p>On running that command again, I got this message:</p>\n\n<pre><code>WARNING: /home/my_username/tensorflow/tensorflow/core/BUILD:1814:1: in includes attribute of cc_library rule //tensorflow/core:framework_headers_lib: '../../external/nsync/public' resolves to 'external/nsync/public' not below the relative path of its package 'tensorflow/core'. This will be an error in the future. Since this rule was created by the macro 'cc_header_only_library', the error might have been caused by the macro implementation in /home/my_username/tensorflow/tensorflow/tensorflow.bzl:1138:30\nWARNING: /home/my_username/tensorflow/tensorflow/core/BUILD:1814:1: in includes attribute of cc_library rule //tensorflow/core:framework_headers_lib: '../../external/nsync/public' resolves to 'external/nsync/public' not below the relative path of its package 'tensorflow/core'. This will be an error in the future. Since this rule was created by the macro 'cc_header_only_library', the error might have been caused by the macro implementation in /home/my_username/tensorflow/tensorflow/tensorflow.bzl:1138:30\nWARNING: /home/my_username/tensorflow/tensorflow/contrib/learn/BUILD:15:1: in py_library rule //tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depends on deprecated target '//tensorflow/contrib/session_bundle:exporter': No longer supported. Switch to SavedModel immediately.\nWARNING: /home/my_username/tensorflow/tensorflow/contrib/learn/BUILD:15:1: in py_library rule //tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depends on deprecated target '//tensorflow/contrib/session_bundle:gc': No longer supported. Switch to SavedModel immediately.\nINFO: Analysed target //tensorflow/python/tools:freeze_graph (0 packages loaded).\nINFO: Found 1 target...\nTarget //tensorflow/python/tools:freeze_graph up-to-date:\n  bazel-bin/tensorflow/python/tools/freeze_graph\nINFO: Elapsed time: 0.419s, Critical Path: 0.00s\nINFO: Build completed successfully, 1 total action\nTraceback (most recent call last):\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 350, in &lt;module&gt;\n    app.run(main=main, argv=[sys.argv[0]] + unparsed)\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/platform/app.py\", line 124, in run\n    _sys.exit(main(argv))\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 249, in main\n    FLAGS.saved_model_tags)\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 227, in freeze_graph\n    input_graph_def = _parse_input_graph_proto(input_graph, input_binary)\n  File \"/home/my_username/tensorflow/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 171, in _parse_input_graph_proto\n    text_format.Merge(f.read(), input_graph_def)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 525, in Merge\n    descriptor_pool=descriptor_pool)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 579, in MergeLines\n    return parser.MergeLines(lines, message)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 612, in MergeLines\n    self._ParseOrMerge(lines, message)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 627, in _ParseOrMerge\n    self._MergeField(tokenizer, message)\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 671, in _MergeField\n    name = tokenizer.ConsumeIdentifierOrNumber()\n  File \"/home/my_username/.cache/bazel/_bazel_my_username/3572bc2aff1de1dd37356cf341944e54/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/python/tools/freeze_graph.runfiles/protobuf_archive/python/google/protobuf/text_format.py\", line 1144, in ConsumeIdentifierOrNumber\n    raise self.ParseError('Expected identifier or number, got %s.' % result)\ngoogle.protobuf.text_format.ParseError: 2:1 : Expected identifier or number, got `.\n</code></pre>\n\n<p>I am exporting the ssd_mobilenet_v1_coco_2017_11_17 just as for practice. I intend to export my own trained models and test the output with this <a href=\"https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/label_image/main.cc\" rel=\"nofollow noreferrer\">program</a>.\nI have built TensorFlow 1.5 using Bazel v0.11.1. I validated the installation using the following code snippet provided in the TensorFlow website;</p>\n\n<pre><code># Python\nimport tensorflow as tf\nhello = tf.constant('Hello, TensorFlow!')\nsess = tf.Session()\nprint(sess.run(hello))\n</code></pre>\n\n<p>I also ran the object detection iPython example notebook and it worked.</p>\n\n<p>I am using Ubuntu 17.10.1 on  a laptop with an Intel Core i5-8250U CPU, 8GB RAM, 1TB HDD and an NVIDIA MX150(2 GB) GPU. Please help. How do I export a trained model to C++?</p>\n"}, {"tags": ["c++", "qt", "qt5", "qtextdocument"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1521326345, "post_id": 49282942, "comment_id": 85685357, "body": "The concept of &quot;page&quot; in the sense you mean only really applies to printed document. So you need to print the document (even if it&#39;s just inside the application and invisible to user). So research Qt printing."}, {"owner": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1521374728, "post_id": 49282942, "comment_id": 85694970, "body": "@hyde: I&#39;d challenge that idea. The concept of the page is independent of printing, it&#39;s primarily related to how the Scribe framework lays out the document."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1521381768, "post_id": 49282942, "comment_id": 85697123, "body": "Seeing the comments here and there, is it possible then to bring up a suitable demo example for the case?"}, {"owner": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1521384771, "post_id": 49282942, "comment_id": 85698220, "body": "@MohammadKanan: What exactly would you need in the example to help answer the question? The code which renders the page on a widget or QQuickPaintedItem?"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1521385238, "post_id": 49282942, "comment_id": 85698382, "body": "merely the content you are rendering .. the actual position you are trying to catch. if that is <i>possible</i> thanks."}, {"owner": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "reply_to_user": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1521386675, "post_id": 49282942, "comment_id": 85698870, "body": "@MohammadKanan: Done, please ask if there is still something unclear."}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1521386860, "post_id": 49282942, "comment_id": 85698945, "body": "Excellent, lets see."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1521449080, "post_id": 49282942, "comment_id": 85717490, "body": "@Inkane Well, we probably mean the same thing. I meant &quot;printing&quot; as synonym to creating concrete layout here. I don&#39;t think there&#39;s a &quot;light version&quot; of laying out a document, which doesn&#39;t effectively produce same result as printing to a digital PDF/PS-like format which doesn&#39;t require rendering actual pixels."}, {"owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1521850408, "post_id": 49282942, "comment_id": 85922680, "body": "Why would each paragraph be on a new page? If that&#39;s your design requriement, it will be easier to simply parse the html."}, {"owner": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "reply_to_user": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "edited": false, "score": 0, "creation_date": 1521890701, "post_id": 49282942, "comment_id": 85931049, "body": "@dtech: Maybe the small example text misled you, but as I wrote,&quot;In general, the text in the p tags can span multiple pages&quot;, and to clarify, a page can contain multiple p tags."}], "answers": [{"comments": [{"owner": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "edited": false, "score": 0, "creation_date": 1521372494, "post_id": 49346496, "comment_id": 85694319, "body": "Unfortunately, that&#39;s not what I need. I already render the paginated text on a QQuickPaintedItem using QTextDocument::drawContents, and now I&#39;m just trying to find the position in the text for a specified page."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "reply_to_user": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "edited": false, "score": 0, "creation_date": 1521395501, "post_id": 49346496, "comment_id": 85701940, "body": "Honestly, I doubt Qt API will let you get that information."}], "tags": [], "owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "is_accepted": false, "score": 0, "last_activity_date": 1521453614, "last_edit_date": 1521453614, "creation_date": 1521366387, "answer_id": 49346496, "question_id": 49282942, "link": "https://stackoverflow.com/questions/49282942/qtextdocument-get-content-of-specific-page/49346496#49346496", "title": "QTextDocument: Get content of specific page", "body": "<p>It isn't possible to get the content of a specific page as \"plaintext + image URL\". Qt does not support that. Specially when you set the content as html, Qt won't extract a sub-html document for you...</p>\n\n<p>What you can get is the content as an image (or a pdf), by using a <code>QPrinter</code> and requesting to print only a specific page. I can post code showing how to do so if that could be an acceptable solution for you.</p>\n"}], "owner": {"reputation": 1290, "user_id": 1078224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e0e8f406fa87f0c3b1c077ce4361365d?s=128&d=identicon&r=PG", "display_name": "Inkane", "link": "https://stackoverflow.com/users/1078224/inkane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 681, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1521453614, "creation_date": 1521044663, "last_edit_date": 1521386633, "question_id": 49282942, "link": "https://stackoverflow.com/questions/49282942/qtextdocument-get-content-of-specific-page", "title": "QTextDocument: Get content of specific page", "body": "<p>Given a <code>QTextDocument</code> with a specific width and height, is there a way to get the content of a given page (as plaintext + image URL in case there is an image on the page)  given its page number?</p>\n\n<p>Here's an example of what I'd like to achieve:</p>\n\n<pre><code>QString getTextForPage(int pageNumber); // this is the function I'd like to have\nQString getURLForPage(int pageNumber); // this is the function I'd like to have\n\nQString html = R\"(\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\"&gt;\n  &lt;style&gt;\n    .summary {page-break-after: always}\n  &lt;/style&gt;\n  &lt;title&gt;title&lt;/title&gt;\n&lt;/head&gt;\n  &lt;p class=\"summary\"&gt;This is a short summary which would fit into a page&lt;/p&gt;\n  &lt;p&gt;&lt;img src=\"www.example.com/test.png\" height=\"100\" width=\"200\"&gt;&lt;/p&gt;\n  &lt;p&gt;&lt;img src\"www.example.com/test2.png&gt;\" height=\"50\" width=\"10\"&lt;/p&gt;\n  &lt;p&gt;This is a short text which should fit into a page&lt;p&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n)\"\n\nconst auto width = 100;\nconst auto height = 200;\nauto textDoc = new QTextDocument();\ntextDoc-&gt;setHtml(html);\ntextDoc-&gt;setPageSize(QSizeF {wide, height});\ntextDoc-&gt;setDocumentMargin(0);\n\nfor (auto curPageNum = 1; curPageNum &lt;= textDoc-&gt;pageCount(); ++curPageNum) {\n    qDebug() &lt;&lt; \"current page: \" &lt;&lt; curPageNum;\n    qDebug() &lt;&lt; getTextForPage(curPageNum);\n    qDebug() &lt;&lt; getURLForPage(curPageNum);\n}\n</code></pre>\n\n<p>This should print:</p>\n\n<pre><code>1\nThis is a short summary which would fit into a page\n(empty string as there is no URL)\n2\n(empty string as the there is no text on the page)\nwww.example.com/test.png\n3\nThis is a short text which should fit into a page\nwww.example.com/test2.png\n</code></pre>\n\n<p>In general, the text in the p tags can span multiple pages, and the images are guaranteed to span at most one page,in case that helps.</p>\n"}, {"tags": ["c++", "pointers", "null-pointer"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 12, "creation_date": 1521043975, "post_id": 49282690, "comment_id": 85568006, "body": "What does your <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">C++ book</a> say on the topic?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 4, "creation_date": 1521044117, "post_id": 49282690, "comment_id": 85568100, "body": "It is Tony Hoare&#39;s <a href=\"https://stackoverflow.com/a/5149102/17034\">billion dollar mistake</a>.  Backgrounder: <a href=\"https://en.wikipedia.org/wiki/Sentinel_value\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Sentinel_value</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521044124, "post_id": 49282690, "comment_id": 85568102, "body": "Where does a pointer point before it has something to point to?"}, {"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1521044253, "post_id": 49282690, "comment_id": 85568204, "body": "@tadman except a null pointer doesn&#39;t point to &quot;nothing&quot;. It points to absolute address <code>0</code>. That&#39;s not generally accessible, so it causes a fault."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 0, "creation_date": 1521044340, "post_id": 49282690, "comment_id": 85568276, "body": "@CharlieMartin That&#39;s an insignificant implementation-detail, though true on many machines."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521044345, "post_id": 49282690, "comment_id": 85568282, "body": "@tadman it points to whereever it was initialised with - or something random"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 2, "creation_date": 1521044380, "post_id": 49282690, "comment_id": 85568306, "body": "@CharlieMartin Technically speaking, it is UB to dereference a <code>nullptr</code>, rather than &quot;causes a fault&quot;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 0, "creation_date": 1521044402, "post_id": 49282690, "comment_id": 85568320, "body": "@CharlieMartin It depends on your platform, some don&#39;t have any memory protection, but you&#39;re right that it&#39;s not &quot;nothing&quot;, but it&#39;s also not &quot;something&quot;, as in <code>nullptr</code> is a &quot;not assigned&quot; type value."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1521044480, "post_id": 49282690, "comment_id": 85568370, "body": "@UKMonkey I was asking rhetorically, as a lot of times people initialize these with <code>nullptr</code> until there&#39;s an actual value to assign."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521044637, "post_id": 49282690, "comment_id": 85568478, "body": "@tadman For that case there&#39;s a std::optional.  (But I&#39;m being factious)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1521044696, "post_id": 49282690, "comment_id": 85568522, "body": "@UKMonkey That&#39;s one of the gifts that C++17 brought to the party, but people survived for decades without it. If you have a class with a pointer you need to initialize that value with something, and if you don&#39;t have a target, <code>nullptr</code> is better than nothing as later you can test if it&#39;s assigned or not instead of not knowing."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521044810, "post_id": 49282690, "comment_id": 85568603, "body": "@tadman survived?  still surviving!  How much c++ code is out there that&#39;s using c++17?  0.1% maybe?  Probably still an order or two of magnitudes off! ;)"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1521045056, "post_id": 49282690, "comment_id": 85568773, "body": "@AlgirdasPreid\u017eius Very technically speaking, deferencing a <code>nullptr</code> is well-defined."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1521045125, "post_id": 49282690, "comment_id": 85568819, "body": "@PasserBy How so? Please provide a section number, of C++ standard, where it is said so."}, {"owner": {"reputation": 85, "user_id": 9492684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f51fc20257fa2b4f4cd4f05daa531610?s=128&d=identicon&r=PG&f=1", "display_name": "ineedalife", "link": "https://stackoverflow.com/users/9492684/ineedalife"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1521045168, "post_id": 49282690, "comment_id": 85568859, "body": "@AlgirdasPreid\u017eius I don&#39;t have a book I have been watching tutorials and reading through some pdf files. I don&#39;t have the money to take a class or anything."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521045221, "post_id": 49282690, "comment_id": 85568898, "body": "&quot;I don&#39;t have a book I have been watching tutorials&quot;. You are doing it wrong. Stop watching tutorials and get a book."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1521045266, "post_id": 49282690, "comment_id": 85568935, "body": "@AlgirdasPreid\u017eius <a href=\"https://stackoverflow.com/a/28483256/4832499\">stackoverflow.com/a/28483256/4832499</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521045304, "post_id": 49282690, "comment_id": 85568958, "body": "Googling the exact title of your question might bring up some information."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1521045532, "post_id": 49282690, "comment_id": 85569087, "body": "@PasserBy Ha, nice. Thanks for the link."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1521045910, "post_id": 49282690, "comment_id": 85569320, "body": "<i>&quot;It seems like it would be pointless to add a pointer to point to nothing.&quot;</i> Love it"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1521044521, "post_id": 49282765, "comment_id": 85568397, "body": "This answer makes a lot of assumptions about the architecture involved."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1521044844, "post_id": 49282765, "comment_id": 85568630, "body": "That&#39;s indeed how it works (more or less), but that&#39;s not true from the standard point of view."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1521045035, "post_id": 49282765, "comment_id": 85568757, "body": "@HolyBlackCat &quot;<i>That&#39;s indeed how it works</i>&quot; Usually.. Due to the UB nature of such an action (dereferencing a <code>nullptr</code>), one can, sometimes, call a method, which doesn&#39;t use any member variables, on a <code>nullptr</code> <code>class</code> pointer."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521049007, "post_id": 49282765, "comment_id": 85571462, "body": "@n.m. the first sentence is however not <i>entirely</i> wrong."}, {"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521137538, "post_id": 49282765, "comment_id": 85615168, "body": "@n.m. Nonsense. What do <i>you</i> think a pointer in C is? An address, right? What&#39;s an address? A natural number n with 0 \u2264 n \u2264 max address. What&#39;s a null pointer? it&#39;s an address with value 0. I mean, you can look it up: C11(ISO/IEC 9899:201x) &#167;6.3.2.3 Pointers Section 3"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521146651, "post_id": 49282765, "comment_id": 85619889, "body": "Some architectures may define an address as a natural number, but the C language does not. It says a pointer may be converted to and from an integer, but this doesn&#39;t make it an integer. Some architectures may define a null pointer as an address with value 0, but the C language does not. Don&#39;t confuse the null pointer constant with the null pointer representation, these are two different things. A null pointer may well be represented with a value of 0xFFFFFFFF at run time. I have seen such platforms."}, {"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521149742, "post_id": 49282765, "comment_id": 85621290, "body": "@n.m: Now you&#39;re just being silly. Present to me an example of a platform in which machine addresses aren&#39;t natural numbers. Similarly, present to me a platform on which, CONTRARY TO THE STANDARD, a null pointer is not represented as value 0."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521178436, "post_id": 49282765, "comment_id": 85629062, "body": "(1) Ever heard of 8086 based computers? They used to have segmented memory. An address is a pair of integers, a segment and an offset. (2) The standard never says how null should be represented. You are welcome to find a quote to the contrary (the null pointer constant has nothing to do with the representation of null at runtime). See <a href=\"http://c-faq.com/null/machexamp.html\" rel=\"nofollow noreferrer\">c-faq.com/null/machexamp.html</a>. All of this is beaten to death here and elsewhere."}, {"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521267207, "post_id": 49282765, "comment_id": 85667914, "body": "@n.m. Sure, segment+offset is not a natural number. You bet,"}], "tags": [], "owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "is_accepted": false, "score": -2, "last_activity_date": 1521139411, "last_edit_date": 1521139411, "creation_date": 1521044171, "answer_id": 49282765, "question_id": 49282690, "link": "https://stackoverflow.com/questions/49282690/what-are-null-pointers-used-for/49282765#49282765", "title": "What are null pointers used for", "body": "<p>Basically, pointers are just integers. The null pointer is a pointer with a value of 0. It doesn't strictly point to nothing, it points to absolute address 0, which generally isn't accessible to your program; dereferencing it causes a fault. </p>\n\n<p>It's generally used as a flag value, so that you can, for example, use it to end a loop.</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>There seem to be a lot of people confused by this answer, which is, strictly, completely correct.  See C11(ISO/IEC 9899:201x) \u00a76.3.2.3 Pointers Section 3:</p>\n\n<blockquote>\n  <p>An <em>integer constant expression with the value 0</em>, or such an expression cast to type void *, is called a null pointer constant. If a null pointer constant is converted to a pointer type, the resulting pointer, called a null pointer, is guaranteed to compare unequal to a pointer to any object or function.</p>\n</blockquote>\n\n<p>So, what's an address? It's a number <em>n</em> where 0 \u2264 <em>n</em> \u2264 <code>max_address</code>. And how do we represent such a number? Why, it's an <em>integer</em>, just like the standard says.</p>\n\n<p>The C11 standard makes it clear that there's never anything to reference at address 0, because in some old pathologically non-portable code in BSD 4.2, you often saw code like this:</p>\n\n<pre><code>/* DON'T TRY THIS AT HOME */\n\nint\nmain(){\n    char target[100] ;\n    char * tp = &amp;target ;\n    char * src = \"This won't do what you think.\" ;\n    void exit(int);\n\n    while((*tp++ = *src++))\n        ;\n\n    exit(0);\n}\n</code></pre>\n\n<p>This is still valid C:</p>\n\n<pre><code>$ gcc -o dumb dumb.c\ndumb.c:6:12: warning: incompatible pointer types initializing 'char *' with an\n      expression of type 'char (*)[100]' [-Wincompatible-pointer-types]\n    char * tp = &amp;target ;\n           ^    ~~~~~~~\n1 warning generated.\n$ \n</code></pre>\n\n<p>In 4.2BSD on a VAX, you could get away with that nonsense, because address <code>0</code> reliably contained the <em>value</em> 0, so the assignment evaluated to <code>0</code>, which is of course FALSE.</p>\n\n<p>Now, to demonstrate:</p>\n\n<pre><code>/* Very simple program dereferencing a NULL pointer. */\n\nint\nmain() {\n    int * a_pointer ;\n    int a_value ;\n    void exit(int);             /* To avoid any #includes */\n\n    a_pointer = ((void*)0);\n    a_value = *a_pointer ;\n\n    exit(0);\n}\n</code></pre>\n\n<p>Here's the results:</p>\n\n<pre><code>$ gcc -o null null.c\n$ ./null\nSegmentation fault: 11\n$ \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1521044555, "post_id": 49282780, "comment_id": 85568418, "body": "In C++ land it&#39;s <a href=\"http://en.cppreference.com/w/cpp/language/nullptr\" rel=\"nofollow noreferrer\"><code>nullptr</code></a>."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521045346, "post_id": 49282780, "comment_id": 85568987, "body": "@tadman: If you restrict that to C++11+ land, that&#39;s true enough, though not quite the full picture. Would have been nicer if they had just bitten the bullet and taken <code>null</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1521045437, "post_id": 49282780, "comment_id": 85569031, "body": "@Deduplicator We all have hopes and dreams that end up crushed by a C++ TR."}], "tags": [], "owner": {"reputation": 1235, "user_id": 736694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a653dd4c531fe67209cee664848722b?s=128&d=identicon&r=PG", "display_name": "Yserbius", "link": "https://stackoverflow.com/users/736694/yserbius"}, "is_accepted": false, "score": 0, "last_activity_date": 1521044963, "last_edit_date": 1521044963, "creation_date": 1521044213, "answer_id": 49282780, "question_id": 49282690, "link": "https://stackoverflow.com/questions/49282690/what-are-null-pointers-used-for/49282780#49282780", "title": "What are null pointers used for", "body": "<p>Generally it's a placeholder. If you just declare a pointer, <code>int *a;</code>, there's no guarantee what is in the pointer when you want to access it. So if your code may or may not set the pointer later, there's no way to tell if the pointer is valid or just pointing to garbage memory. But if you declare it as <code>NULL</code>, such as <code>int *a = NULL;</code> you can then check later to see if the pointer was set, like <code>if(a == NULL)</code>.</p>\n\n<p>Most of the time during initialization we assign null value to a pointer so that we can check whether it is still null or a address has been assign to it or not.</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1521044955, "post_id": 49283018, "comment_id": 85568692, "body": "<i>&quot;But <code>nullptr</code> in C++ is different from it.&quot;</i> This doesn&#39;t sound right. Can you elaborate?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1521045758, "post_id": 49283018, "comment_id": 85569229, "body": "<i>&quot;nullptr is always a pointer type in C++&quot;</i> Actually, the type of <code>nullptr</code> is specifically not a pointer type. <code>*nullptr</code> is ill-formed."}], "tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": -1, "last_activity_date": 1521045265, "last_edit_date": 1521045265, "creation_date": 1521044873, "answer_id": 49283018, "question_id": 49282690, "link": "https://stackoverflow.com/questions/49282690/what-are-null-pointers-used-for/49283018#49283018", "title": "What are null pointers used for", "body": "<p>null value in C and C++ is equal to 0. But <code>nullptr</code> in C++ is different from it, nullptr is always a pointer type in C++. We assign a null value to a pointer variable for various reason.</p>\n\n<blockquote>\n  <ol>\n  <li>To check whether a memory has been allocated to the pointer or not</li>\n  <li>To neutralize a dangling pointer so that it should not create any side effect</li>\n  <li>To check whether a return address is a valid address or not etc. </li>\n  </ol>\n</blockquote>\n\n<p>Most of the time during initialization we assign null value to a pointer so that we can check whether it is still null or a address has been assign to it or not. </p>\n"}, {"comments": [{"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 0, "creation_date": 1521139550, "post_id": 49283020, "comment_id": 85616202, "body": "This answer is in fact incorrect.  See below, per the standard, the null pointer always has the value 0."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 0, "creation_date": 1521140166, "post_id": 49283020, "comment_id": 85616520, "body": "@CharlieMartin: No. It says that a literal 0 (and some related things) is converted to a null ponter value in a pointer context, which is something completely different. The devil is in the details."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 2, "last_activity_date": 1521045194, "last_edit_date": 1521045194, "creation_date": 1521044883, "answer_id": 49283020, "question_id": 49282690, "link": "https://stackoverflow.com/questions/49282690/what-are-null-pointers-used-for/49283020#49283020", "title": "What are null pointers used for", "body": "<p>Well, the null pointer value has the remarkable property that, despite it being a well-defined and unique constant value, the exact value depending on machine-architecture and ABI (on most modern ones all-bits-zero, not that it matters), it <em>never</em> points to (or just behind) an object.</p>\n\n<p>This allows it to be used as a reliable error-indicator when a valid pointer is expected (functions might throw an exception or terminate execution instead), as well as a sentinel value, or to mark the absence of something optional.</p>\n\n<p>On many implementations accessing memory through a nullpointer will reliably cause a hardware exception (some even trap on arithmetic), though on many others, especially those without paging and / or segmentation it will not.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "is_accepted": false, "score": 0, "last_activity_date": 1521045408, "creation_date": 1521045408, "answer_id": 49283218, "question_id": 49282690, "link": "https://stackoverflow.com/questions/49282690/what-are-null-pointers-used-for/49283218#49283218", "title": "What are null pointers used for", "body": "<blockquote>\n  <p>It seems like it would be pointless to add a pointer to point to\n  nothing.</p>\n</blockquote>\n\n<p>No, it is not. Suppose you have a function returning optional dynamically allocated value. When you want to return \"nothing\" you return null. The caller can check for null and distinguish between 2 different cases: when the return value is \"nothing\" and when the return value is some valid usable object.</p>\n"}], "owner": {"reputation": 85, "user_id": 9492684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f51fc20257fa2b4f4cd4f05daa531610?s=128&d=identicon&r=PG&f=1", "display_name": "ineedalife", "link": "https://stackoverflow.com/users/9492684/ineedalife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "closed_date": 1521045580, "answer_count": 5, "score": 1, "last_activity_date": 1521139411, "creation_date": 1521043935, "last_edit_date": 1521045209, "question_id": 49282690, "link": "https://stackoverflow.com/questions/49282690/what-are-null-pointers-used-for", "closed_reason": "Needs more focus", "title": "What are null pointers used for", "body": "<p>I have just started using c++ and saw that their is a null value for pointers. I am curious as to what this is used for. It seems like it would be pointless to add a pointer to point to nothing.</p>\n"}, {"tags": ["c++", "boost"], "answers": [{"tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1521076462, "last_edit_date": 1521076462, "creation_date": 1521074522, "answer_id": 49289834, "question_id": 49282682, "link": "https://stackoverflow.com/questions/49282682/constructing-object-with-private-constructor-inside-boost-managed-memory-segment/49289834#49289834", "title": "constructing object with private constructor inside boost managed_memory_segment", "body": "<p>You can simply pass a reference to the segment manager (or an associated allocator, depending on your requirements).</p>\n\n<p>Often you'll require the allocator anyways for any embedded objects that use them.</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/02644460c018ab57\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/interprocess/allocators/allocator.hpp&gt;\n\nnamespace bip = boost::interprocess;\n\nclass X {\npublic:\n    template &lt;typename SegmentManager&gt;\n    static X* factory(int id, SegmentManager* sm) {\n        bip::allocator&lt;X, SegmentManager&gt; alloc{sm};\n        X* x = alloc.allocate(1).get();\n        new (x) X(id);\n        return x;\n    }\n    template &lt;typename SegmentManager&gt;\n    static void destroy(X *x, SegmentManager* sm) {\n        if (!x) return;\n\n        bip::allocator&lt;X, SegmentManager&gt; alloc{sm};\n        x-&gt;~X();\n        alloc.deallocate(x, 1);\n    }\n\n    int getId() const { return id; }\n\nprivate:\n    X(int id) : id(id) {}\n    ~X() = default;\n\n    int id;\n};\n\n#include &lt;iostream&gt;\n\ntemplate &lt;typename Segment&gt;\nvoid run_test(Segment&amp; segment) {\n    std::cout &lt;&lt; \"Free: \" &lt;&lt; segment.get_free_memory() &lt;&lt; '\\n';\n\n    auto sm = segment.get_segment_manager();\n\n    auto a = X::factory(42, sm);\n    auto b = X::factory(43, sm);\n    std::cout &lt;&lt; \"Free: \" &lt;&lt; segment.get_free_memory() &lt;&lt; '\\n';\n\n    X&amp; aref = *a;\n\n    std::cout &lt;&lt; \"a.id = \" &lt;&lt; aref.getId() &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"b.id = \" &lt;&lt; b-&gt;getId() &lt;&lt; \"\\n\";\n\n    X::destroy(a, sm);\n    X::destroy(b, sm);\n    std::cout &lt;&lt; \"Free: \" &lt;&lt; segment.get_free_memory() &lt;&lt; '\\n';\n}\n\n#include &lt;boost/interprocess/managed_mapped_file.hpp&gt;\n#include &lt;boost/interprocess/managed_shared_memory.hpp&gt;\n\nint main() {\n    bip::managed_mapped_file mmf(bip::open_or_create, \"test.bin\",       10240);\n    bip::managed_shared_memory msm(bip::open_or_create, \"MySharedMemory\", 10240);\n\n    std::cout &lt;&lt; \" ------------- managed_mapped_file ---------------\\n\";\n    run_test(mmf);\n    std::cout &lt;&lt; \" ------------- managed_shared_memory -------------\\n\";\n    run_test(msm);\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code> ------------- managed_mapped_file ---------------\nFree: 10016\nFree: 9920\na.id = 42\nb.id = 43\nFree: 10016\n ------------- managed_shared_memory -------------\nFree: 10016\nFree: 9920\na.id = 42\nb.id = 43\nFree: 10016\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 8710263, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/98788583f07b4e7c0a7a55eed3599543?s=128&d=identicon&r=PG&f=1", "display_name": "S.K", "link": "https://stackoverflow.com/users/8710263/s-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521076462, "creation_date": 1521043914, "question_id": 49282682, "link": "https://stackoverflow.com/questions/49282682/constructing-object-with-private-constructor-inside-boost-managed-memory-segment", "title": "constructing object with private constructor inside boost managed_memory_segment", "body": "<p>I have a class like below:</p>\n\n<pre><code>class X {\npublic:\n    static X *factory(...);\n    static void destroy(X *x);\n\nprivate:\n    X();\n    ~X();\n\n};\n</code></pre>\n\n<p>I am trying to construct this object in shared memory using boost managed_shared_memory following the examples in</p>\n\n<p><a href=\"http://www.boost.org/doc/libs/1_47_0/doc/html/interprocess/managed_memory_segments.html#interprocess.managed_memory_segments.managed_memory_segment_features.allocation_types\" rel=\"nofollow noreferrer\">http://www.boost.org/doc/libs/1_47_0/doc/html/interprocess/managed_memory_segments.html#interprocess.managed_memory_segments.managed_memory_segment_features.allocation_types</a></p>\n\n<p>How do I use find_or_construct() or construct() in this case given that the constructor is private ? Are we forced make the constructors public and not use factory/destroy methods for the classes being constructed in shared memory ?</p>\n\n<p>Thanks,\nS.K</p>\n"}, {"tags": ["c++", "containers"], "comments": [{"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 1, "creation_date": 1521052762, "post_id": 49282601, "comment_id": 85573669, "body": "With <code>typedef typename std::list&lt;T&gt;::iterator iterator;</code> there&#39;s no way to override the preincrement operator since the compiler can&#39;t distinguish between your container&#39;s iterator and the standard list iterator.  You&#39;ll need to make a wrapper class which stores a list iterator internally, but then redefines the preincrement operator - which as a method of the new class would need to look like <code>iterator&amp; operator++()</code>."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 1, "creation_date": 1521052924, "post_id": 49282601, "comment_id": 85573756, "body": "Also, incidentally, it looks like the current implementation of <code>begin()</code> will probably crash if you try to execute it on an empty container (i.e. the underlying <code>std::list&lt;T&gt;</code> is empty)."}, {"owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "reply_to_user": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1521077826, "post_id": 49282601, "comment_id": 85583527, "body": "Good catch on the begin() crash.  I updated my question with the solution I came up with based on your suggestion.  It works nicely, I just wish there was a simpler solution."}, {"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1521134770, "post_id": 49282601, "comment_id": 85613551, "body": "Boost provides a <code>boost::iterators::filter_iterator</code> template class which does a lot of what you did in your solution, only more generally.  Using that instead of rolling your own might make things a bit simpler and easier to read."}], "answers": [{"comments": [{"owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "edited": false, "score": 0, "creation_date": 1521051864, "post_id": 49282742, "comment_id": 85573163, "body": "Yes, but how do I do that within the class?  And more importantly, how to call the default preincrement operator from within the operator++ definition?  I&#39;ll put what I&#39;m trying in the question."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "edited": false, "score": 0, "creation_date": 1521064964, "post_id": 49282742, "comment_id": 85579745, "body": "the post increment operator returns a COPY of what it was; and then increases itself.  This means it won&#39;t return a reference but a value.  The pre increment however increases itself by one and then returns a reference to itself.  This it has the signature `\tT&amp; T::operator++();`"}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1521044090, "creation_date": 1521044090, "answer_id": 49282742, "question_id": 49282601, "link": "https://stackoverflow.com/questions/49282601/overload-operator-for-encapsulated-standard-container/49282742#49282742", "title": "Overload operator++ for encapsulated standard container", "body": "<p>From <a href=\"http://en.cppreference.com/w/cpp/language/range-for\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/range-for</a></p>\n\n<blockquote>\n  <p>The above syntax produces code equivalent to the following (__range,\n  __begin and __end are for exposition only):</p>\n\n<pre><code>{\n    auto &amp;&amp; __range = range_expression ; \n    for (auto __begin = begin_expr, __end = end_expr; \n            __begin != __end; ++__begin) { \n        range_declaration = *__begin; \n    loop_statement \n    } \n}\n</code></pre>\n</blockquote>\n\n<p>ie you must have the preincrement operator defined.</p>\n"}, {"comments": [{"owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "edited": false, "score": 0, "creation_date": 1521145147, "post_id": 49306912, "comment_id": 85619125, "body": "Thanks for the answer.  I\u2019m going to go ahead and accept this because it completely answers the question of HOW to implement a solution.  However, I had already come up with a solution in my edits that, as far as I can tell, is very similar to this.  Would you mind pointing out any significant shortcomings in my solution that yours covers?"}], "tags": [], "owner": {"reputation": 874, "user_id": 6524134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/582660ba292a4204b267476ed318bfc6?s=128&d=identicon&r=PG&f=1", "display_name": "toozyfuzzy", "link": "https://stackoverflow.com/users/6524134/toozyfuzzy"}, "is_accepted": true, "score": 0, "last_activity_date": 1521142871, "last_edit_date": 1521142871, "creation_date": 1521139096, "answer_id": 49306912, "question_id": 49282601, "link": "https://stackoverflow.com/questions/49282601/overload-operator-for-encapsulated-standard-container/49306912#49306912", "title": "Overload operator++ for encapsulated standard container", "body": "<p>You can not do it within the container class. You should implement your own iterator and implement the behavior you want in it's prefix increment operator. You can do it several ways including <strong>inheriting</strong> one from <strong>STL</strong> or creating your own wrapper for <strong>std::list</strong> iterator.</p>\n\n<p>Actually to implement your desired behavior in iterator you need to provide to your custom iterator class <strong>the end iterator</strong> of container.</p>\n\n<p>I would not recommend you to implement your own iterators unless your design actually good with them. Unnecessary complications almost always lead to even more unnecessary complications.</p>\n\n<p>I've modified your code so it actually compiles and implemented <strong>std::list</strong> iterator wrapper to behave as you planned. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;list&gt;\n#include &lt;iterator&gt;\n\nusing namespace std;\n\nclass Valid {};\n\ntemplate&lt;typename _Tp&gt;\nstruct myIteratorWrapper\n{\n\n  typedef myIteratorWrapper&lt;_Tp&gt;         _Self;\n  typedef _Tp               value_type;\n  typedef _Tp*                 pointer;\n  typedef _Tp&amp;               reference;\n\n  typedef typename std::list&lt;_Tp&gt;::iterator listIterator;\n\n  listIterator it;\n  listIterator itEnd;\n\n  myIteratorWrapper(const listIterator&amp; listIterArg) _GLIBCXX_NOEXCEPT\n    : it(listIterArg)\n  {}\n\n  myIteratorWrapper(const listIterator&amp; itBegin,\n            const listIterator&amp; itEnd) _GLIBCXX_NOEXCEPT\n    : it(itBegin), itEnd(itEnd)\n  {}\n\n  reference\n  operator*() const _GLIBCXX_NOEXCEPT\n  { return *it; }\n\n  pointer\n  operator-&gt;() const _GLIBCXX_NOEXCEPT\n  { return &amp;(*it); }\n\n  /* Change logic of this method as you wish, but keep the signature */ \n  _Self&amp;\n  operator++() _GLIBCXX_NOEXCEPT\n  {\n    do\n    {\n      ++it;\n    }while (it != itEnd &amp;&amp; !(*it)-&gt;valid());\n\n    return *this;\n  }\n\n  bool\n  operator==(const _Self&amp; __x) const _GLIBCXX_NOEXCEPT\n  { return it == __x.it; }\n\n  bool\n  operator!=(const _Self&amp; __x) const _GLIBCXX_NOEXCEPT\n  { return it != __x.it; }\n};\n\ntemplate &lt;typename T&gt; class DeferredCleanupList\n{\npublic:\n  DeferredCleanupList() {\n    (void)static_cast&lt;Valid *&gt;((T)0);\n  }\n  virtual ~DeferredCleanupList() {}\n\n  typedef myIteratorWrapper&lt;T&gt; iterator;\n\n  iterator begin() {\n    iterator it(container.begin(), container.end());\n    return it;\n  }\n\n  iterator next(iterator it) {       \n    return ++it;\n  }\n\n  iterator end() { return container.end(); }\n\n  size_t size() const { return container.size(); }\n\n  void add(T ptr) { container.push_front(ptr); }\n  void remove(T ptr) { ptr-&gt;invalidate(); }\n\n  // called occasionally\n  void delete_invalid() {\n    for (auto it = container.begin(); it != container.end(); ) {\n      auto ptr = *it;\n      if (ptr-&gt;valid())\n    ++it;\n      else {\n    delete ptr;\n    it = container.erase(it);\n      }\n    }\n  }\n\nprivate:\n  DeferredCleanupList(const DeferredCleanupList&amp;);\n  DeferredCleanupList&amp; operator=(const DeferredCleanupList&amp;);\n\n  std::list&lt;T&gt; container;\n};\n\nclass D : public Valid {\n  bool isValid;\n  std::string myName;\npublic:\n\n  D(std::string myName, bool arg = false)\n    : myName(myName), isValid(arg) {}\n\n  bool valid() const\n  { return isValid; }\n\n  const std::string&amp; whoAmI() const\n  { return myName; }\n};\n\nint main() {\n  D o1(\"o1\", true);\n  D o2(\"o2\");\n  D o3(\"o3\", true);\n  D o4(\"o4\");\n  D o5(\"o5\", true);\n\n  DeferredCleanupList&lt;D *&gt; list;\n  list.add(&amp;o1);\n  list.add(&amp;o2);\n  list.add(&amp;o3);\n  list.add(&amp;o4);\n  list.add(&amp;o5);\n\n  for (auto ptr : list)\n    {\n      std::cout &lt;&lt; ptr-&gt;whoAmI() &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>o5\no3\no1\n</code></pre>\n"}], "owner": {"reputation": 794, "user_id": 3808882, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/76accdde31eadc26bbf994643bd15519?s=128&d=identicon&r=PG&f=1", "display_name": "Rakurai", "link": "https://stackoverflow.com/users/3808882/rakurai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 49306912, "answer_count": 2, "score": 0, "last_activity_date": 1521142871, "creation_date": 1521043671, "last_edit_date": 1521077054, "question_id": 49282601, "link": "https://stackoverflow.com/questions/49282601/overload-operator-for-encapsulated-standard-container", "title": "Overload operator++ for encapsulated standard container", "body": "<p>I am encapsulating a std::list to make it safely iterable when iterating can potentially mark contents as 'invalid', and 'invalid' contents are skipped in the iteration.  Specifically, during the iteration the current object could schedule itself or other objects for removal from the list and mark those objects as invalid.  The list is then periodically cleaned of invalid objects.</p>\n\n<p><strong>How do I define an increment operator to make range-based for loops work correctly?</strong>  Here is my class:</p>\n\n<pre><code>template &lt;typename T&gt; class DeferredCleanupList\n{\npublic:\n    DeferredCleanupList() {\n        (void)static_cast&lt;Valid *&gt;((T)0);\n    }\n    virtual ~DeferredCleanupList() {}\n\n    typedef typename std::list&lt;T&gt;::iterator iterator;\n\n    iterator begin() {\n        iterator it = container.begin();\n\n        if ((*it)-&gt;valid())\n            return it;\n\n        return next(it);\n    }\n    iterator next(iterator it) {\n        do {\n            ++it;\n        }\n        while (it != end() &amp;&amp; !(*it)-&gt;valid());\n\n        return it;\n    }\n    iterator end() { return container.end(); }\n\n//    to be implemented:\n//    typedef typename std::list&lt;T&gt;::const_iterator const_iterator ;\n//    const_iterator cbegin() const { return container.cbegin(); }\n//    const_iterator cend() const { return container.cend(); }\n//    const_iterator cnext() const { ??? }\n\n    size_t size() const { return container.size(); }\n\n    void add(T *ptr) { container.push_front(ptr); }\n    void remove(T *ptr) { ptr-&gt;invalidate(); }\n\n    // called occasionally\n    void delete_invalid() {\n        for (auto it = container.begin(); it != container.end(); ) {\n            auto ptr = *it;\n            if (ptr-&gt;valid())\n                ++it;\n            else {\n                delete ptr;\n                it = container.erase(it);\n            }\n        }\n    }\n\nprivate:\n    DeferredCleanupList(const DeferredCleanupList&amp;);\n    DeferredCleanupList&amp; operator=(const DeferredCleanupList&amp;);\n\n    std::list&lt;T&gt; container;\n};\n</code></pre>\n\n<p>My current test case is something like:</p>\n\n<pre><code>int main() {\n    class D : public Valid {};\n\n    DeferredCleanupList&lt;D *&gt; list;\n\n    for (auto it = list.begin(); it != list.end(); it = list.next(it)); // works\n    for (auto ptr : list); // iterates, but doesn't call list.next(it)\n}\n</code></pre>\n\n<p>EDIT:\nAfter some trial and error, I wrote this iterator wrapper based on the suggestions in the comments:</p>\n\n<pre><code>template &lt;typename T&gt; class DeferredCleanupList\n{\npublic:\n    class iterator {\n    public:\n        iterator(typename std::list&lt;T&gt;::iterator it, DeferredCleanupList&lt;T&gt;&amp; ls) : it(it), list(ls) {}\n\n        iterator&amp; operator=(const iterator&amp; rhs) { it = rhs; return *this; }\n        iterator&amp; operator++() {\n            do {\n                ++it;\n            }\n            while (it != list.end().it &amp;&amp; !(*it)-&gt;valid());\n\n            return *this;\n        }\n        friend bool operator==(const iterator&amp; lhs, const iterator&amp; rhs) { return lhs.it == rhs.it; }\n        friend bool operator!=(const iterator&amp; lhs, const iterator&amp; rhs) { return !(lhs == rhs); }\n\n        T&amp; operator*() { return *it; }\n\n    private:\n        typename std::list&lt;T&gt;::iterator it;\n        DeferredCleanupList&amp; list;\n    };\n\n    iterator begin() {\n        iterator it = iterator(container.begin(), *this);\n\n        if (it == end() || (*it)-&gt;valid())\n            return it;\n\n        return ++it;\n    }\n\n    iterator end() { return iterator(container.end(), *this); }\n}\n</code></pre>\n\n<p>It appears to work perfectly in all the test cases I throw at it.  Am I missing anything obvious with this approach?  Is there a more elegant solution?</p>\n"}, {"tags": ["c++", "ios", "swift", "bridging-header"], "answers": [{"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 2, "last_activity_date": 1521044195, "creation_date": 1521044195, "answer_id": 49282774, "question_id": 49282560, "link": "https://stackoverflow.com/questions/49282560/passing-a-file-as-a-parameter-to-a-c-method-from-swift/49282774#49282774", "title": "Passing a file as a parameter to a C++ method from Swift", "body": "<p>Swift can't import C++. <code>ifstream</code> is a C++ class and the parameter is also a C++ reference. Neither of these are going to work with Swift.</p>\n\n<p>You have to write a C function that wraps your C++ call and treats your <code>ifstream</code> object as an opaque reference.</p>\n\n<p>Also your wrapper function has to be <strong>declared</strong> <code>extern \"C\"</code> not just defined that way, otherwise other C++ files that include the header will assume it has name mangling.</p>\n\n<p>Something like this might work but I haven't tested it at all:</p>\n\n<pre><code>// header\n#if !defined _cplusplus\n\ntypedef struct ifstream ifstream; // incomplete struct def for C opaque type\n\n#else\n\nextern \"C\" {\n\n#endif\n\nint getNumber(int num);\n\nvoid processGlobeFile(ifstream *file); // note you need to use a pointer not a reference\n\n#if defined __cplusplus\n\n} // of the exten C\n\n#endif\n</code></pre>\n"}], "owner": {"reputation": 4853, "user_id": 2115842, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e1edbcb22a72df5b04c429103b9cffa7?s=128&d=identicon&r=PG", "display_name": "Pheepster", "link": "https://stackoverflow.com/users/2115842/pheepster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 1, "accepted_answer_id": 49282774, "answer_count": 1, "score": 2, "last_activity_date": 1521044195, "creation_date": 1521043536, "question_id": 49282560, "link": "https://stackoverflow.com/questions/49282560/passing-a-file-as-a-parameter-to-a-c-method-from-swift", "title": "Passing a file as a parameter to a C++ method from Swift", "body": "<p>I am trying to call some C++ code in a Swift application. I did not write the C++ nor do I have control over it.</p>\n\n<p>I have created a C++ wrapper to handle the calls from Swift. I also added some test functions within the C++ files to verify that I am calling the C++ from Swift. Those functions simply return an int.</p>\n\n<p>In the C++ header code there is a function defined as follows:</p>\n\n<pre><code>class GlobeProcessor {\npublic:\n    void readFile(ifstream &amp;inputFile);\n    // ...\n};\n</code></pre>\n\n<p>In my wrapper I have defined the function as follows:</p>\n\n<pre><code>extern \"C\" void processGlobe(ifstream &amp;file) {\n    GlobeProcessor().readFile(file);\n}\n</code></pre>\n\n<p>The confusing part is how to reference this in my bridging header. Currently the bridging header contains the following:</p>\n\n<pre><code>// test function\nint getNumber(int num);\n\nvoid processGlobeFile(ifstream &amp;file);\n</code></pre>\n\n<p>The test function succeeds, so I am able to access the C++ from Swift. However, adding a declaration for <code>processGlobeFile</code>to the bridging header produces the following compile error:</p>\n\n<pre><code>Unknown type name 'ifstream'\n</code></pre>\n\n<p>I have tried unsuccessfully to add the appropriate imports to the bridging header. I am not a seasoned C++ guy, so i don't really know if I'm approaching this in the correct manner. Can somebody help me to understand how to pass a file as a parameter to a C++ method from Swift?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "string", "c++11", "visual-studio-2017", "unordered-set"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1521043677, "post_id": 49282504, "comment_id": 85567770, "body": "If you have two copies of the same string in different places, the addresses obviously will be different. You can&#39;t compare C strings by comparing addresses. Why don&#39;t you make a set of <code>std::strings</code>? If you really want it to work, you have to provide a custom comparator. Read <code>unordered_set</code> docs to learn how."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1521043742, "post_id": 49282504, "comment_id": 85567820, "body": "Note that you were able to find <code>cstr</code> in your set because your compiler realized that two string literals have the same value and merged them into one. This behaviour is not portable."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1521043860, "post_id": 49282504, "comment_id": 85567912, "body": "<code>std::unordered_set::find</code> searches for matching <code>const char*</code> values without looking at what values they are pointing to. If you want custom comparison to be done, consider passing custom predicates for key equality, and hashing, to <code>std::unordered_set</code>, when constructing it."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9492476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d7d4cef85feb68d250b3282f71447d?s=128&d=identicon&r=PG&f=1", "display_name": "nacho3", "link": "https://stackoverflow.com/users/9492476/nacho3"}, "edited": false, "score": 0, "creation_date": 1521044330, "post_id": 49282661, "comment_id": 85568271, "body": "Great, thank you! For some stupid reason I thought the unordered_set would come with up a smart solution for comparing the two on its own.. :)"}], "tags": [], "owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "is_accepted": true, "score": 2, "last_activity_date": 1521043858, "creation_date": 1521043858, "answer_id": 49282661, "question_id": 49282504, "link": "https://stackoverflow.com/questions/49282504/stdstring-casted-to-const-char-can-not-be-found-in-an-stdunordered-setcon/49282661#49282661", "title": "std::string casted to const char * can not be found in an std::unordered_set&lt;const char *&gt;", "body": "<p>For <code>const char *</code>, there is no overload of the <code>==</code> operator that compares strings by value, so I believe the <code>unordered_set</code> container will always compare pointers, not the values of the pointed-to strings.</p>\n\n<p>The compiler can, as an optimization, make multiple string literals with the same characters use the same memory location (and thus have identical pointers), which is why you're able to find the string when you use another string literal. But any string you construct by some other mechanism, even if it contains the same characters, won't be at the same memory location, and thus the pointers will not be equal.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9492476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d7d4cef85feb68d250b3282f71447d?s=128&d=identicon&r=PG&f=1", "display_name": "nacho3", "link": "https://stackoverflow.com/users/9492476/nacho3"}, "edited": false, "score": 0, "creation_date": 1521044421, "post_id": 49282808, "comment_id": 85568336, "body": "Thank you for the example, I ended up just using std::strings everywhere now though!"}], "tags": [], "owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "is_accepted": false, "score": 1, "last_activity_date": 1521058450, "last_edit_date": 1521058450, "creation_date": 1521044287, "answer_id": 49282808, "question_id": 49282504, "link": "https://stackoverflow.com/questions/49282504/stdstring-casted-to-const-char-can-not-be-found-in-an-stdunordered-setcon/49282808#49282808", "title": "std::string casted to const char * can not be found in an std::unordered_set&lt;const char *&gt;", "body": "<p>Use <code>std::unordered_set&lt;std::string&gt;</code> or provide custom hasher if you sure that your strings will not left the stack while you are using the hashtable e.g. static variables or allocated with new/malloc etc.</p>\n\n<p>Something like:</p>\n\n<pre><code>struct str_eq {\n  bool opeator()(const char* lsh, const char rhs) const noexcept\n  {\n    return lsh == rhs || 0 == std::strcmp(lsh, rhs);\n  }  \n};\n\n\nstruct str_hash {\n   std::size_t opeator()(const char* str) const noexcept\n   {\n     // some mur-mur2, google cityhash hash_bytes etc instead of this\n      return std::hash&lt;std::string&gt;( std::string(str) ) ();\n   }\n};\n\ntypedef std::unordered_set&lt;const char*, str_hash, str_eq, std::allocator&lt;const char*&gt; &gt; my_string_hashset;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 848, "user_id": 5941564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1916422a9c9c1aef25c1c3e886725781?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle A", "link": "https://stackoverflow.com/users/5941564/kyle-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1521044538, "creation_date": 1521044538, "answer_id": 49282896, "question_id": 49282504, "link": "https://stackoverflow.com/questions/49282504/stdstring-casted-to-const-char-can-not-be-found-in-an-stdunordered-setcon/49282896#49282896", "title": "std::string casted to const char * can not be found in an std::unordered_set&lt;const char *&gt;", "body": "<p>As @Daniel Pryden pointed out, you are doing address comparisons. To fix this you will need to either have the <code>unordered_set</code> store <code>std::string</code> objects, or create a custom comparison for the <code>unordered_set</code> to use.</p>\n\n<p>Based on the answer to a <a href=\"https://stackoverflow.com/questions/36058387/how-to-use-unordered-set-with-compare-function\">related question</a>, something like this:</p>\n\n<pre><code>struct StringEqual\n{\n    bool operator()(const char* a, const char* b) { return 0 == strcmp(a,b); }\n};\n\nstd::unordered_set&lt;const char *, std::Hash&lt;const char*&gt;, StringEqual&gt; the_set(\n    {\"one\", \"two\", \"three\", \"four\", \"five\"});\n</code></pre>\n\n<p>should do the trick. This gives the <code>unordered_set</code> a better operator to use for testing the strings.</p>\n\n<p>For more information about the <code>Pred</code> template parameter, see the <a href=\"http://en.cppreference.com/w/cpp/container/unordered_set\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 9492476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d7d4cef85feb68d250b3282f71447d?s=128&d=identicon&r=PG&f=1", "display_name": "nacho3", "link": "https://stackoverflow.com/users/9492476/nacho3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 49282661, "answer_count": 3, "score": 1, "last_activity_date": 1521058450, "creation_date": 1521043405, "question_id": 49282504, "link": "https://stackoverflow.com/questions/49282504/stdstring-casted-to-const-char-can-not-be-found-in-an-stdunordered-setcon", "title": "std::string casted to const char * can not be found in an std::unordered_set&lt;const char *&gt;", "body": "<p>While working on a project, I ran into the following issue I could not explain to myself. </p>\n\n<p>I have the following <a href=\"https://stackoverflow.com/questions/1701067/how-to-check-that-an-element-is-in-a-stdset\">is_in_set(..) function</a>, which simply checks if a cstring is in an unordered_set of cstrings:</p>\n\n<pre><code>bool is_in_set(const char * str, std::unordered_set&lt;const char *&gt; the_set)\n{\n    if ( the_set.find( str ) != the_set.end() )\n        return true;\n    else\n        return false;\n}\n</code></pre>\n\n<p>And then I created the following sample main method to demonstrate my problem:</p>\n\n<pre><code>int main()\n{\n    std::unordered_set&lt;const char *&gt; the_set({\"one\",\n        \"two\", \"three\", \"four\", \"five\"});\n\n    std::string str = \"three\";\n    const char * cstr = \"three\";\n\n    std::cout &lt;&lt; \"str in set? \"\n        &lt;&lt; is_in_set( str.c_str() , the_set ) &lt;&lt; std::endl\n        &lt;&lt; \"cstr in set? \" \n        &lt;&lt; is_in_set( cstr, the_set ) &lt;&lt; std::endl;\n\n    const char * str_conv = str.c_str();\n\n    std::cout &lt;&lt; \"str_conv in set? \"\n        &lt;&lt; is_in_set( str_conv , the_set ) &lt;&lt; std::endl\n        &lt;&lt; \"strcmp(str_conv, cstr) = \" &lt;&lt; strcmp( str_conv , cstr )\n        &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>I expected the above code to find the std::string casted to const char*, as well as the cstring in the set.\nInstead of that, it generates the following output (Visual Studio Community 2017):\n</p>\n\n<pre><code>str in set? 0\ncstr in set? 1\nstr_conv in set? 0\nstrcmp(str_conv, cstr) = 0\n</code></pre>\n\n<p>I also ran a for-loop over both variables, outputting byte by byte (in hexadecimal representation) for each, which results in the following:\n</p>\n\n<pre><code>74 68 72 65 65 00 = c_str\n74 68 72 65 65 00 = str_conv\n</code></pre>\n\n<p>Why is the std::string casted to const char * not being found in the set?\nShouldn't strcmp return a value different from 0 in this case?</p>\n"}, {"tags": ["c++", "lambda", "callback", "pass-by-reference"], "comments": [{"owner": {"reputation": 1, "user_id": 7548100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9428732ffd4e1c5ec83e457272cbf6f?s=128&d=identicon&r=PG&f=1", "display_name": "jm4l1", "link": "https://stackoverflow.com/users/7548100/jm4l1"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521043436, "post_id": 49282325, "comment_id": 85567583, "body": "@user463035818 Yes, the code compiles and runs. I didn&#39;t copy and paste so i typed parts directly to the question. But the code does run. My code has <code>MyClass MyObject(&quot;new list&quot;);</code>. So its not a compilation issue"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521043676, "post_id": 49282325, "comment_id": 85567768, "body": "i fixed it for you, but please next time make sure that the code you post here can be copy/pasted to reproduce the problem you describe (and not something else ;)"}, {"owner": {"reputation": 1, "user_id": 7548100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9428732ffd4e1c5ec83e457272cbf6f?s=128&d=identicon&r=PG&f=1", "display_name": "jm4l1", "link": "https://stackoverflow.com/users/7548100/jm4l1"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521043770, "post_id": 49282325, "comment_id": 85567842, "body": "Thanks and I will keep that in mind."}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521043958, "post_id": 49282325, "comment_id": 85567995, "body": "Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it is almost impossible to say what is wrong: <a href=\"http://coliru.stacked-crooked.com/a/fe8996939e5a441b\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/fe8996939e5a441b</a>"}, {"owner": {"reputation": 1, "user_id": 7548100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9428732ffd4e1c5ec83e457272cbf6f?s=128&d=identicon&r=PG&f=1", "display_name": "jm4l1", "link": "https://stackoverflow.com/users/7548100/jm4l1"}, "edited": false, "score": 0, "creation_date": 1521045651, "post_id": 49282325, "comment_id": 85569163, "body": "I edited the original post to include more information I hope can shed light. I apologise for the bad format of the question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7548100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9428732ffd4e1c5ec83e457272cbf6f?s=128&d=identicon&r=PG&f=1", "display_name": "jm4l1", "link": "https://stackoverflow.com/users/7548100/jm4l1"}, "is_accepted": true, "score": 0, "last_activity_date": 1521139911, "creation_date": 1521139911, "answer_id": 49307162, "question_id": 49282325, "link": "https://stackoverflow.com/questions/49282325/class-member-is-not-modified-globally-when-changed-in-lamba-c/49307162#49307162", "title": "Class member is not modified globally when changed in lamba - c++", "body": "<p>Ok, After thinking about the process I realised that the issue is not with the lambda, but actually with the socket code. I am using <code>fork()</code> to handle a new connection in the <code>MyServer::Listen()</code> function. This creates a new child process and copies the parent memory to a new memory segment, but the parent isn't updated as the memory is not shared. Hence each call spawns a new child with the original parent memory. I removed the call to fork and the object is indeed updated after each call and is reflected in subsequent one.</p>\n\n<p>I was thinking about the lambda functions as I introduced them most recently. I will work on finding a way around this child/parent issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 7548100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9428732ffd4e1c5ec83e457272cbf6f?s=128&d=identicon&r=PG&f=1", "display_name": "jm4l1", "link": "https://stackoverflow.com/users/7548100/jm4l1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 49307162, "answer_count": 1, "score": 0, "last_activity_date": 1521139911, "creation_date": 1521042890, "last_edit_date": 1521045578, "question_id": 49282325, "link": "https://stackoverflow.com/questions/49282325/class-member-is-not-modified-globally-when-changed-in-lamba-c", "title": "Class member is not modified globally when changed in lamba - c++", "body": "<p>I\u2019m having an issue with some code I  have written in C++. I have created two classes <code>MyClass</code> and <code>Server</code>. <code>MyClass</code> has member called list of type <code>std::vector&lt;std::string&gt;</code>. The <code>Server</code> class  has a method called <code>RegisterRoute</code> which is used to bind a callback method to a string (API route) and adds the binding to a <code>std::map</code> member called <code>routemap</code>.  When the server receives a request, it looks up the path in the request url and calls the corresponding function that has been bound.</p>\n\n<p>I instantiate instances of <code>MyClass</code> and <code>Server</code> called <code>MyClass::MyObject</code> and <code>Server::MyServer</code> in my main program, I bind a callback lambda to a route using <code>MyServer.RegisterRoute()</code>. In this lambda I pass <code>MyObject</code> to the lambda by reference, and I call a method that adds and item to the <code>std::vector&lt;&gt;</code>.  The issue is that out side of the scope of the lambda, the object does not seem to be modified. Hence each time I call the route, the list seems to be unaffected by previous lambda calls. The form of the lambda is as shown below.</p>\n\n<pre><code>[&amp;MyObject](std::string item){\n    MyObject.addItem(item);\n    MyObject.showList();\n}\n</code></pre>\n\n<p>If I call the <code>MyObject.showlist()</code> method in the lambda after the <code>MyObject.addItem()</code>, the list is shown as modified. However, when I hit a route to show the list (which calls the <code>MyObject.showlist()</code>), it shows the original list created when the object before the last <code>addItem</code> route was called. Also If I call the addItem method outside the lambda, the list is modified.</p>\n\n<pre><code>int main(){\nMyClass MyObject(\"new list\"); //Constructor to take string and  add it to std::vector&lt;std::string&gt; list\nServer MyServer(4564);       //Constructor to create server and bind port to socket\n\nMyServer.RegisterRoute(\"/additem\",[&amp;MyObject](std::string item){\n    MyObject.addItem(item);\n    MyObject.show();\n    return \"added\";\n});\nMyObject.addItem(\"Dummy Item\"); //This item is seen in the list when show list calls\nMyServer.StartServer();\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>I thought that passing the object by reference would allow the modifications made in the lambda to affect the original object,Can someone advise on what I am maybe missing?</p>\n\n<p>EDIT ...\nI realised I left out parts of the call chain.</p>\n\n<p>RegisterRoute is used to add a defined callback to an route map.</p>\n\n<pre><code>void MyServer::RegisterRoute(std::string route,std::function&lt;std::string(std::string)&gt;routehandle){\n    this-&gt;routemap.emplace(std::make_pair(route,routehandle));\n};\n</code></pre>\n\n<p>The MyServer Class calls the Listen method, which accepts a call back that is executed when an incoming connection is received.</p>\n\n<pre><code>void MyServer::StartServer(){\n    Listen(httphandle);\n};\n</code></pre>\n\n<p>The httphandle is a member function of MyServer which defines how to handle the request.</p>\n\n<pre><code>void MyServer::httphandle(char* buffer, int socket){\n    char* requestbuffer = buffer;\n    std::stringstream datastream,headerstream;\n\n    auto requestline = strtok(requestbuffer,\"\\n\");\n    auto header = strtok(nullptr,\"\\n\");\n    headerstream &lt;&lt; header &lt;&lt; \"\\n\";\n\n    while((header != nullptr) &amp;&amp; (strlen(header)&gt;1)){\n        header = strtok(nullptr,\"\\n\");\n        headerstream &lt;&lt; header &lt;&lt;\"\\n\";\n    }\n\n    auto data = strtok(nullptr,\"\\n\");\n    char* reqline[3];\n\n    reqline[0] = strtok (requestline, \" \\t\\n\");\n    if(routemap.find(reqline[1]) != routemap.end()){\n                    auto reponsestring = routemap[reqline[1]](data);\n                    write(socket, \"HTTP/1.0 200 OK\\n\\n\", 17);\n                    write(socket, reponsestring.c_str(), strlen(reponsestring.c_str()));\n            }\n            else    \n                write(socket, \"HTTP/1.0 404 Not Found\\n\\n{\\\"error\\\":\\\"Not Found\\\"}\\n\", strlen(\"HTTP/1.0 404 Not Found\\n\\n{\\\"error\\\":\\\"Not Found\\\"}\\n\")); //FILE NOT FOUND\n}\n</code></pre>\n\n<p>It is in this callback the stored lambda will be executed by the routemap lookup.</p>\n\n<p>I can confirm that the lambda is calling as each time I hit the route i call the showlist method and it shows the item was added. When I call the addItem route again, the list doesn't show the previous ones added.</p>\n\n<p>*I apologise for the bad question format, this is my first question and my code is quite heavy so I was trying to simplify the question.</p>\n"}, {"tags": ["c++", "memory-management", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1521041829, "post_id": 49281875, "comment_id": 85566341, "body": "version 1 is not an assignment first of all."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521041845, "post_id": 49281875, "comment_id": 85566356, "body": "there is no static allocation, because no matter how you insert the first 3 you can always (dynamically) add more"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1521041920, "post_id": 49281875, "comment_id": 85566421, "body": "for int&#39;s it doesn&#39;t matter (probably).  For larger objects; x[] will default create the object first; so is slower. 0 and 3 are probably identical.  What did you see when you profiled it?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521041921, "post_id": 49281875, "comment_id": 85566422, "body": "why do you care?"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1521041970, "post_id": 49281875, "comment_id": 85566454, "body": "Version 2, for each key, inserts a node with this key and a value-initialized value and then performs assignment through the reference to this value. Version 1 is probably the best here. Allocation is not largely an issue here, though map implementation probably makes use of the fact that some of the elements are already known beforehand."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521042006, "post_id": 49281875, "comment_id": 85566473, "body": "@user463035818 Why do I care about performance? Well I don&#39;t know, I probably want to be as slow as possible?"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521042075, "post_id": 49281875, "comment_id": 85566519, "body": "@user463035818: More seriously I am thinking about a huge std::map instantiation with generated code."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1521042108, "post_id": 49281875, "comment_id": 85566544, "body": "@BenjaminBarrois then just don&#39;t use #2"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1521042119, "post_id": 49281875, "comment_id": 85566552, "body": "@BenjaminBarrois choose proper algorithms and data structures, write readable and so maintainable code first, then worry about performance later if necessary."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521042142, "post_id": 49281875, "comment_id": 85566576, "body": "very seriously: then you need to profile your code instead of speculating"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1521042250, "post_id": 49281875, "comment_id": 85566665, "body": "I&#39;t&#39;s all going to be dynamic allocation, but option 1 does all the work up front. Probably save you some time, but the only way to be sure is measure."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1521042357, "post_id": 49281875, "comment_id": 85566751, "body": "@Slava: Worrying about performance late is only an opinion."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1521042500, "post_id": 49281875, "comment_id": 85566857, "body": "&quot;Programmers waste enormous amounts of time thinking about, or worrying about, the speed of noncritical parts of their programs, and these attempts at efficiency actually have a strong negative impact when debugging and maintenance are considered. We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil. Yet we should not pass up our opportunities in that critical 3%.&quot; Knuth"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1521042615, "post_id": 49281875, "comment_id": 85566951, "body": "@Slava: you are speculating about the fact the part of the code is critical or not and so over-interpreting the question, which is only what it is, not about coding philosophy."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1521042624, "post_id": 49281875, "comment_id": 85566956, "body": "btw that quote is often quoted without the last sentence which imho is the key: you need to get the 97% right before you can profile to identify the 3% and that 3% are important"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1521042698, "post_id": 49281875, "comment_id": 85567014, "body": "philosophical discussions aside, the question is of course worth considering, but still the only way to know for sure is to measure"}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521042782, "post_id": 49281875, "comment_id": 85567088, "body": "I doubt that there is any real difference between the three versions. They are all just syntactic sugar for creating 3 tree nodes and inserting them into the tree."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521042927, "post_id": 49281875, "comment_id": 85567203, "body": "@PaulFloyd That&#39;s what I suspect too but that would clearly be a lack of optimization if <i>Version 1</i> does not behave like I supposed it would."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521042930, "post_id": 49281875, "comment_id": 85567205, "body": "@PaulFloyd no, they are definitely not just syntactic sugar. eg 1 is no assignment and 2 has considerable overhead"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1521046182, "post_id": 49281875, "comment_id": 85569516, "body": "Version 3 should use <code>std::pair&lt;const int, int&gt;</code> (the map&#39;s <code>value_type</code>) otherwise a copy of the pair might be made (which could be optimized out).  Or use <code>try_emplace</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521045659, "post_id": 49282515, "comment_id": 85569171, "body": "How can allocation occur at compile time?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521046171, "post_id": 49282515, "comment_id": 85569503, "body": "I mean small buffer optimization"}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521049146, "post_id": 49282515, "comment_id": 85571534, "body": "Whilst I think that it should be possible to allocate all of the nodes in a single block of memory (in the case of the init list) I doubt that this happens in practice. Otherwise the only difference is in the number of function calls, for which the init list probably has an advantage."}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 4, "last_activity_date": 1521043430, "creation_date": 1521043430, "answer_id": 49282515, "question_id": 49281875, "link": "https://stackoverflow.com/questions/49281875/is-stdmap-allocation-static-when-possible/49282515#49282515", "title": "Is std::map allocation static when possible?", "body": "<p>The C++ standard makes no requirements on whether the allocation happens at compile-time or run-time. All this means is that implementations are free to make their own optimizations (or not).</p>\n\n<p>So the proper thing to do would be to test.</p>\n\n<p>Most likely such optimizations have not been implemented. There is no <code>constexpr</code> constructor of <code>std::map</code>, despite the fact that the <code>std::initializer_list</code> you create here may be a compile-time constant (note that no aggregate initialization is being performed here either)</p>\n\n<pre><code>std::map&lt;int,int&gt; x = {{0,0}, {1,1}, {2,2}};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1521046182, "post_id": 49282520, "comment_id": 85569517, "body": "Then how can you explain the differences in the profiling tests? (See my own answer)"}, {"owner": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "reply_to_user": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1521046517, "post_id": 49282520, "comment_id": 85569747, "body": "I cant tell unless I see your tests and approach"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1521046634, "post_id": 49282520, "comment_id": 85569840, "body": "I generated the exact code in the question (except that instead of 3 entries I put 100,000), then compiled with <code>g++ -std=c++11</code> (no other flag). I&#39;m currently doing it with optimizations but the compilation is very long so I still don&#39;t have the results."}], "tags": [], "owner": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "is_accepted": false, "score": 2, "last_activity_date": 1524839979, "last_edit_date": 1524839979, "creation_date": 1521043440, "answer_id": 49282520, "question_id": 49281875, "link": "https://stackoverflow.com/questions/49281875/is-stdmap-allocation-static-when-possible/49282520#49282520", "title": "Is std::map allocation static when possible?", "body": "<p>Although its implementation defined, <code>std::map</code>'s allocations is never static. It using an <a href=\"https://en.wikipedia.org/wiki/Red%E2%80%93black_tree\" rel=\"nofollow noreferrer\">RB tree</a>\nas an underlying data structure in 99 cases of 100.<br>\nIn your case, you have exactly the same time and space complexity in all three cases.</p>\n"}, {"comments": [{"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 3, "creation_date": 1521045592, "post_id": 49282988, "comment_id": 85569127, "body": "And with optimization? A lot of the std::map interface is in functions that can be inlined."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1521052892, "post_id": 49282988, "comment_id": 85573741, "body": "With optimization: 15 ms for version 1, 2.6 seconds of compilation, and the compilations have been running for hours for versions 2 and 3 and have still not finished..."}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": false, "score": 1, "last_activity_date": 1521044816, "creation_date": 1521044816, "answer_id": 49282988, "question_id": 49281875, "link": "https://stackoverflow.com/questions/49281875/is-stdmap-allocation-static-when-possible/49282988#49282988", "title": "Is std::map allocation static when possible?", "body": "<p>After all these speculations, I finally profiled the code. For this, I generated 3 codes like in the question, but with 100,000 entries. Here are the results, averaged on several runs, compiled with g++ with no optimization:</p>\n\n<ul>\n<li>Version 1: 26 ms (compile time: 2.5 s)</li>\n<li>Version 2: 80 ms (compile time: 10 s)</li>\n<li>Version 3: 73 ms (compile time: 37 s)</li>\n</ul>\n\n<p>So clearly, the best solution is the first one. Both versions 2 and 3 are nearly equivalent at execution, but version 3 is really worse at compile time.</p>\n"}], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1524839979, "creation_date": 1521041731, "last_edit_date": 1521042285, "question_id": 49281875, "link": "https://stackoverflow.com/questions/49281875/is-stdmap-allocation-static-when-possible", "title": "Is std::map allocation static when possible?", "body": "<p>Consider 3 versions of a code with the same effects:</p>\n\n<p>Version 1:</p>\n\n<pre><code>int main()  {\n    std::map&lt;int,int&gt; x = {{0,0}, {1,1}, {2,2}};\n    // Do some stuff...\n    return 0;\n}\n</code></pre>\n\n<p>Version 2:</p>\n\n<pre><code>int main()  {\n    std::map&lt;int,int&gt; x;\n    x[0] = 0;\n    x[1] = 1;\n    x[2] = 2;\n    // Do some stuff...\n    return 0;\n}\n</code></pre>\n\n<p>Version 3:</p>\n\n<pre><code>int main()  {\n    std::map&lt;int,int&gt; x;\n    x.insert(std::pair&lt;int,int&gt;(0,0));\n    x.insert(std::pair&lt;int,int&gt;(1,1));\n    x.insert(std::pair&lt;int,int&gt;(2,2));\n    // Do some stuff...\n    return 0;\n}\n</code></pre>\n\n<p>What is the efficiency of each of these codes?</p>\n\n<p>I think that version 1 is a fully static allocation: space required by <code>x</code> is allocated once and values are set.\nI also think that version 3 requires dynamic allocation: each call to insert will check if the key is not already used, check where to insert and allocate more space to map before assigning the value.\nFor version 2, I am not sure. Could you help me with that?</p>\n"}, {"tags": ["c++", "pointers", "constructor", "reference", "type-conversion"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1521041713, "post_id": 49281777, "comment_id": 85566246, "body": "Yay, broken example code from MSDN again. The easiest fix is to declare both <code>m_Func</code> and <code>func</code> as <code>Func *</code> and not deal with references-to-functions at all."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1521041717, "post_id": 49281777, "comment_id": 85566250, "body": "Please post how <code>Func</code> is defined."}], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 9454839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d930a16411efa2512513c2480c41ed?s=128&d=identicon&r=PG&f=1", "display_name": "ScienceAmateur", "link": "https://stackoverflow.com/users/9454839/scienceamateur"}, "edited": false, "score": 0, "creation_date": 1521042345, "post_id": 49281886, "comment_id": 85566739, "body": "thank you very much, that worked like a charm.  Now I can use the example to follow the instructions. :-)"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1521042114, "last_edit_date": 1521042114, "creation_date": 1521041757, "answer_id": 49281886, "question_id": 49281777, "link": "https://stackoverflow.com/questions/49281777/c2440-cannot-convert-from-void-cdeclint-to-void-cdeclint/49281886#49281886", "title": "C2440 cannot convert from &#39;void (_cdecl*)(int)&#39; to &#39;void(_cdecl&amp;)(int)", "body": "<p>In this constructor</p>\n\n<pre><code>   RunFunc(Func func,int o):m_Func(func),m_o(o)\n   {\n\n   };\n</code></pre>\n\n<p>the prameter <code>Func func</code> is adjusted by the compiler to the type <code>Func *func</code>. On the other hand the data member <code>m_Func</code> is declared as a referenced type.</p>\n\n<pre><code>Func&amp; m_Func;\n</code></pre>\n\n<p>And the error message says about incompatibility of the types.</p>\n\n<blockquote>\n  <p>C2440 cannot convert from 'void (_cdecl*)(int)' to 'void(_cdecl&amp;)(int)</p>\n</blockquote>\n\n<p>Try to declare the constructor like</p>\n\n<pre><code>   RunFunc(Func &amp;func,int o):m_Func(func),m_o(o)\n   {\n\n   };\n</code></pre>\n\n<p>Or declare the data member like</p>\n\n<pre><code>Func *m_Func;\n</code></pre>\n\n<p>without changing the constructor.</p>\n\n<p>Here are two demonstrative programs</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n typedef void Func( int );\n\n class RunFunc\n {\n   Func&amp; m_Func;\n   int   m_o;\n\n   public:\n\n   RunFunc(Func &amp;func,int o):m_Func(func),m_o(o)\n   {\n\n   };\n\n   void operator()()const \n   {\n     m_Func(m_o);\n   };\n };\n\nint main() {\n    return 0;\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n typedef void Func( int );\n\n class RunFunc\n {\n   Func *m_Func;\n   int   m_o;\n\n   public:\n\n   RunFunc(Func func,int o):m_Func(func),m_o(o)\n   {\n\n   };\n\n   void operator()()const \n   {\n     m_Func(m_o);\n   };\n };\n\nint main() {\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 9454839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d930a16411efa2512513c2480c41ed?s=128&d=identicon&r=PG&f=1", "display_name": "ScienceAmateur", "link": "https://stackoverflow.com/users/9454839/scienceamateur"}, "edited": false, "score": 1, "creation_date": 1521042496, "post_id": 49281986, "comment_id": 85566855, "body": "thank you for help, I very much appreciate it and what you posted works too.  I gave the tick to Vlad because his answer was correct and he was first but, I appreciate the help equally."}], "tags": [], "owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "is_accepted": false, "score": 1, "last_activity_date": 1521042003, "creation_date": 1521042003, "answer_id": 49281986, "question_id": 49281777, "link": "https://stackoverflow.com/questions/49281777/c2440-cannot-convert-from-void-cdeclint-to-void-cdeclint/49281986#49281986", "title": "C2440 cannot convert from &#39;void (_cdecl*)(int)&#39; to &#39;void(_cdecl&amp;)(int)", "body": "<p>In your code you are  tyring to bound a reference to a temporary, namely to copy of argument passed to the constructor. You can try to run the following code snippet to see the difference:</p>\n\n<pre><code>struct Func {\n    int _i;\n    void operator()(int i) { cout &lt;&lt; i*_i &lt;&lt; endl; }\n};\n\nclass RunFunc\n{\n    Func&amp; m_Func;\n    int   m_o;\n\npublic:\n\n    RunFunc(Func &amp;func, int o) :m_Func(func), m_o(o)\n//  RunFunc(Func func, int o) :m_Func(func), m_o(o)\n    {\n    };\n\n    void operator()()const\n    {\n        m_Func(m_o);\n    };\n};\n\nint main() {\n    Func f{ 5 };\n    RunFunc rf(f, 2);\n    rf();\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 9454839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d930a16411efa2512513c2480c41ed?s=128&d=identicon&r=PG&f=1", "display_name": "ScienceAmateur", "link": "https://stackoverflow.com/users/9454839/scienceamateur"}, "edited": false, "score": 0, "creation_date": 1521042702, "post_id": 49282140, "comment_id": 85567020, "body": "it definitely sounds like the example code uses legacy constructs.  The first thing it did was complain about some class being deprecated.  It went downhill from there. ;-)"}], "tags": [], "owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "is_accepted": false, "score": 1, "last_activity_date": 1521042364, "creation_date": 1521042364, "answer_id": 49282140, "question_id": 49281777, "link": "https://stackoverflow.com/questions/49281777/c2440-cannot-convert-from-void-cdeclint-to-void-cdeclint/49282140#49282140", "title": "C2440 cannot convert from &#39;void (_cdecl*)(int)&#39; to &#39;void(_cdecl&amp;)(int)", "body": "<p>This is a legacy approach. You can use standard library <a href=\"https://www.tutorialspoint.com/cpp_standard_library/functional.htm\" rel=\"nofollow noreferrer\">functor and binder instead</a>. For example:</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\nstatic void my_callback(int i) {\n    std::cout&lt;&lt; i &lt;&lt; std::endl;\n}\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n    std::function&lt;void()&gt; functor;\n    functor = std::bind(my_callback, 1);\n    functor();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 9454839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d930a16411efa2512513c2480c41ed?s=128&d=identicon&r=PG&f=1", "display_name": "ScienceAmateur", "link": "https://stackoverflow.com/users/9454839/scienceamateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 1, "accepted_answer_id": 49281886, "answer_count": 3, "score": 2, "last_activity_date": 1521042434, "creation_date": 1521041471, "last_edit_date": 1521042434, "question_id": 49281777, "link": "https://stackoverflow.com/questions/49281777/c2440-cannot-convert-from-void-cdeclint-to-void-cdeclint", "title": "C2440 cannot convert from &#39;void (_cdecl*)(int)&#39; to &#39;void(_cdecl&amp;)(int)", "body": "<p>I am using C++ in native mode with Visual Studio 2017 and I am <strong>trying</strong> to compile and run the example code found at <a href=\"https://docs.microsoft.com/en-us/visualstudio/debugger/walkthrough-debugging-a-parallel-application\" rel=\"nofollow noreferrer\">Debugging a Parallel Application in Visual Studio</a>.\nFor the record, I program in C not C++.  I am clueless when it comes to method declarations (among many other things).  I suspect correcting the error is simple but, I simply don't know how.</p>\n\n<p>In other words, I am currently RTFineM.  I simply copied and pasted the example given in the url above and ran into 2 problems.  First it complained about something being deprecated but a simple define took care of that problem.  Second it complained about not being able to convert a type into another as stated in the title.   </p>\n\n<p>The RunFunc class causing the problem is declared as follows:</p>\n\n<pre><code> class RunFunc\n {\n   Func&amp; m_Func;\n   int   m_o;\n\n   public:\n\n   RunFunc(Func func,int o):m_Func(func),m_o(o)\n   {\n\n   };\n\n   void operator()()const \n   {\n     m_Func(m_o);\n   };\n };\n</code></pre>\n\n<p><strong>My question/request is:</strong> how does the declaration of RunFunc need to be in order for the example to compile and run properly ?</p>\n\n<p>Thank you, much appreciate the help.</p>\n"}, {"tags": ["c++", "string", "push-back"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1521041405, "post_id": 49281726, "comment_id": 85565992, "body": "How is the result wrong? What do you expect? What do you get? How do those differ?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1521041498, "post_id": 49281726, "comment_id": 85566073, "body": "You create a vector of <code>n</code> elements, then add <code>n</code> more, then print the first <code>n</code> elements. The ones you <code>push_back</code> come after the ones you print. You likely want to start with an empty vector."}], "answers": [{"tags": [], "owner": {"reputation": 4650, "user_id": 6755083, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CVobU.png?s=128&g=1", "display_name": "seccpur", "link": "https://stackoverflow.com/users/6755083/seccpur"}, "is_accepted": true, "score": 1, "last_activity_date": 1521042792, "last_edit_date": 1521042792, "creation_date": 1521042412, "answer_id": 49282156, "question_id": 49281726, "link": "https://stackoverflow.com/questions/49281726/pushing-back-into-a-vector-of-pairs-from-cin-giving-wrong-results/49282156#49282156", "title": "Pushing back into a vector of pairs from cin giving wrong results", "body": "<p>Use only this <code>vector&lt;pair&lt;int, string&gt;&gt; o;</code> Yours will end up with 2n elements in the vector or you can </p>\n\n<pre><code>int n;\ncin &gt;&gt; n;\nvector&lt;pair&lt;int, string&gt;&gt; o (n, make_pair(0, \" \"));\n\nfor (int a0 = 0; a0 &lt; n; a0++)\n{\n    int x;\n    string s;\n    cin &gt;&gt; x &gt;&gt; s;\n\n    auto&amp; it = o.at(a0);\n    (it.first) = x;\n    it.second = s;\n    //o.push_back(make_pair(x, s));\n}\n</code></pre>\n"}], "owner": {"reputation": 194, "user_id": 5027348, "user_type": "registered", "profile_image": "https://graph.facebook.com/836661389745383/picture?type=large", "display_name": "nishant_boro", "link": "https://stackoverflow.com/users/5027348/nishant-boro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "closed_date": 1521045518, "accepted_answer_id": 49282156, "answer_count": 1, "score": 1, "last_activity_date": 1521042792, "creation_date": 1521041340, "question_id": 49281726, "link": "https://stackoverflow.com/questions/49281726/pushing-back-into-a-vector-of-pairs-from-cin-giving-wrong-results", "closed_reason": "Not suitable for this site", "title": "Pushing back into a vector of pairs from cin giving wrong results", "body": "<p>So i am trying to build a vector and then push back pair items into it. The code goes like this:</p>\n\n<pre><code>int main() \n{\n    int n;\n    cin &gt;&gt; n;\n    vector&lt;pair&lt;int,string&gt;&gt; o(n,make_pair(0,\" \"));\n\n    for(int a0 = 0; a0 &lt; n; a0++)\n    {\n        int x;\n        string s;\n        cin&gt;&gt;x&gt;&gt;s;\n        o.push_back(make_pair(x,s));\n    }\n    for(int i=0;i&lt;n;++i)\n        cout&lt;&lt;o[i].first;\n\n    return 0;\n}\n</code></pre>\n\n<p>But the resultant vector is showing wrong results. So what is wrong here?. Can someone help me out?</p>\n"}, {"tags": ["c++", "c", "memory-management", "free", "tcmalloc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521041439, "post_id": 49281720, "comment_id": 85566023, "body": "Why do you need this? There is no such thing forn the standard <code>malloc</code> either?"}, {"owner": {"reputation": 1056, "user_id": 1498329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f05806694ca16c86f8adaa7e94bae308?s=128&d=identicon&r=PG", "display_name": "Daniel Heilper", "link": "https://stackoverflow.com/users/1498329/daniel-heilper"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521041690, "post_id": 49281720, "comment_id": 85566228, "body": "@Michael Walz - I don&#39;t think it is important why I need this. Also, TCMalloc is much more comprehensive library than standard malloc, and it has also heap profiling tool, etc..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521041888, "post_id": 49281720, "comment_id": 85566400, "body": "The &quot;why&quot; is often important (See this: <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">xyproblem.info</a>)"}, {"owner": {"reputation": 1056, "user_id": 1498329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f05806694ca16c86f8adaa7e94bae308?s=128&d=identicon&r=PG", "display_name": "Daniel Heilper", "link": "https://stackoverflow.com/users/1498329/daniel-heilper"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521042406, "post_id": 49281720, "comment_id": 85566789, "body": "@Michael Walz - allocation counting for requests, when each request exclusively owns a group of threads. Each request is inspected once in a while to see if it satisfies memory constraints.  The Idea is to Proxy the existing malloc/free calls with a minimal management of a counter per request. When malloc is called the size is trivially known, but not when free is called"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521043341, "post_id": 49281720, "comment_id": 85567525, "body": "You could write your own <code>mymalloc&#47;myfree</code> functions that call the original <code>malloc&#47;free</code> or <code>TCMalloc&#47;free</code> or what ever, and store the allocated size before the actual data. But this adds a little overhead."}, {"owner": {"reputation": 1056, "user_id": 1498329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f05806694ca16c86f8adaa7e94bae308?s=128&d=identicon&r=PG", "display_name": "Daniel Heilper", "link": "https://stackoverflow.com/users/1498329/daniel-heilper"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521043560, "post_id": 49281720, "comment_id": 85567685, "body": "@Michael Walz I&#39;m trying to avoid any overhead in management. Your idea is a well-known approach, however, it can cause serious fragmentations (and performance degradations) if calling malloc of multiple of  page size."}], "answers": [{"comments": [{"owner": {"reputation": 1056, "user_id": 1498329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f05806694ca16c86f8adaa7e94bae308?s=128&d=identicon&r=PG", "display_name": "Daniel Heilper", "link": "https://stackoverflow.com/users/1498329/daniel-heilper"}, "edited": false, "score": 0, "creation_date": 1521119180, "post_id": 49283063, "comment_id": 85602133, "body": "I tried it, with calling malloc_usable_size, and it seems to have alias to tc_malloc_size (I cannot call directly to tc_XX api since the library is preloaded)."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1521143156, "last_edit_date": 1521143156, "creation_date": 1521044999, "answer_id": 49283063, "question_id": 49281720, "link": "https://stackoverflow.com/questions/49281720/tcmalloc-get-size-of-allocation-for-a-pointer/49283063#49283063", "title": "TCMalloc - get size of allocation for a pointer", "body": "<p>Since version 1.6, TCMalloc <a href=\"https://github.com/gperftools/gperftools/blob/master/src/gperftools/tcmalloc.h.in#L118\" rel=\"nofollow noreferrer\">includes</a>:</p>\n\n<pre><code>size_t tc_malloc_size(void*);\n</code></pre>\n\n<p>which returns the usable size of the allocation starting at the argument.</p>\n\n<p>It is identical to the glibc <code>malloc_usable_size</code> (or BSD's <code>malloc_size</code>), and <code>libtcmalloc</code> includes aliases for both of those functions.</p>\n\n<p>However, it is <em>not</em> necessarily the originally requested size. It may be larger (and usually is). I don't believe that TCMalloc (or most other malloc implementations) retain that metadata, so there is (afaik) neither a reliable nor an unreliable mechanism to time travel back to the original malloc call and inspect the request size.</p>\n"}], "owner": {"reputation": 1056, "user_id": 1498329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f05806694ca16c86f8adaa7e94bae308?s=128&d=identicon&r=PG", "display_name": "Daniel Heilper", "link": "https://stackoverflow.com/users/1498329/daniel-heilper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 49283063, "answer_count": 1, "score": 0, "last_activity_date": 1521143156, "creation_date": 1521041319, "question_id": 49281720, "link": "https://stackoverflow.com/questions/49281720/tcmalloc-get-size-of-allocation-for-a-pointer", "title": "TCMalloc - get size of allocation for a pointer", "body": "<p>Using TCMalloc - given heap allocated object, is there any way to get the allocated size of the object (meaning only the size passed in malloc call)?\nI'm asking for a \"reliable\" method (i.e, not going a word size back assuming the allocation size is stored before the pointer)</p>\n"}, {"tags": ["c++", "floating-point"], "comments": [{"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521040957, "post_id": 49281522, "comment_id": 85565636, "body": "If you know the valid ranges of user inputs, you can, internally, store your float as integer + expoents."}, {"owner": {"reputation": 35247, "user_id": 163394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/af52bc2881bfd89cc35bf928e20f7d6a?s=128&d=identicon&r=PG", "display_name": "Narek", "link": "https://stackoverflow.com/users/163394/narek"}, "reply_to_user": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521041001, "post_id": 49281522, "comment_id": 85565672, "body": "Oh, I cannot do that any more. This solution is valid, but it breaks backward compatibility :("}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1521041078, "post_id": 49281522, "comment_id": 85565728, "body": "Still, if you know the user inputs, you know the lowest valid number, just round to the lowest"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521041102, "post_id": 49281522, "comment_id": 85565749, "body": "Look into a fixed point or a floating point library that gives you more precision."}, {"owner": {"reputation": 35247, "user_id": 163394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/af52bc2881bfd89cc35bf928e20f7d6a?s=128&d=identicon&r=PG", "display_name": "Narek", "link": "https://stackoverflow.com/users/163394/narek"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521041201, "post_id": 49281522, "comment_id": 85565831, "body": "@NathanOliver cannot do that either. I use RapidJSON to read the JSON file. It returns me a double. That double number is already the wrong number (1.399... instead of 1.4)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521041231, "post_id": 49281522, "comment_id": 85565850, "body": "@Narek Can you instead have it return to you a string?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1521041249, "post_id": 49281522, "comment_id": 85565861, "body": "&quot;breaks backward compatibility&quot; every suggestion will do that; because you&#39;ve not given your specifications well enough"}, {"owner": {"reputation": 35247, "user_id": 163394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/af52bc2881bfd89cc35bf928e20f7d6a?s=128&d=identicon&r=PG", "display_name": "Narek", "link": "https://stackoverflow.com/users/163394/narek"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1521041309, "post_id": 49281522, "comment_id": 85565919, "body": "@Ron this is not a duplicate. I am not surprised why float works that way. I ask how to solve the issue, even when float works that way."}, {"owner": {"reputation": 9690, "user_id": 1707560, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8VK4M.jpg?s=128&g=1", "display_name": "imreal", "link": "https://stackoverflow.com/users/1707560/imreal"}, "edited": false, "score": 0, "creation_date": 1521041381, "post_id": 49281522, "comment_id": 85565974, "body": "If the second multiplier is 10^n can&#39;t you read the integer before the dot <code>.</code> and multiply it by 10^n and then read the integer after and multiply it by 10^(n-1) and then add them?"}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 2, "creation_date": 1521041918, "post_id": 49281522, "comment_id": 85566419, "body": "Anyway, if your QA engineer is working with integer and you with float, soon or later you will need to convert it to integer. Just look into your specification to see what is the common denominator."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521042661, "post_id": 49281522, "comment_id": 85566986, "body": "Is there any way you can have RapidJason give you the value in a non floating point form?"}], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1521045629, "post_id": 49282116, "comment_id": 85569154, "body": "It&#39;s about 15-17 digits: <i>The 53-bit significand precision gives from 15 to 17 significant decimal digits precision (2\u221253 \u2248 1.11 &#215; 10\u221216). If a decimal string with at most 15 significant digits is converted to IEEE 754 double-precision representation, and then converted back to a decimal string with the same number of digits, the final result should match the original string. If an IEEE 754 double-precision number is converted to a decimal string with at least 17 significant digits, and then converted back to double-precision representation, the final result must match the original number.</i>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1521045690, "post_id": 49282116, "comment_id": 85569198, "body": "<a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Double-precision_floating-point_format</a> Excel always round to 15 digits before displaying, so even if you specify more than 15 decimal digits you&#39;ll always get 0s from the 16th digit"}], "tags": [], "owner": {"reputation": 101058, "user_id": 318758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9870a37447a4ae811096e8e7d10ed3f9?s=128&d=identicon&r=PG", "display_name": "Joni", "link": "https://stackoverflow.com/users/318758/joni"}, "is_accepted": false, "score": 0, "last_activity_date": 1521042296, "creation_date": 1521042296, "answer_id": 49282116, "question_id": 49281522, "link": "https://stackoverflow.com/questions/49281522/how-make-a-good-calculator-with-floating-point-arithmetic/49282116#49282116", "title": "How make a good calculator with floating point arithmetic", "body": "<p>Round the result when you format it for display. A double precision value is correct to about 15 significant digits, so if you round the result to 12 significant digits you're not going to surprise the user.</p>\n"}], "owner": {"reputation": 35247, "user_id": 163394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/af52bc2881bfd89cc35bf928e20f7d6a?s=128&d=identicon&r=PG", "display_name": "Narek", "link": "https://stackoverflow.com/users/163394/narek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 371, "favorite_count": 0, "closed_date": 1521062384, "answer_count": 1, "score": -1, "last_activity_date": 1521042296, "creation_date": 1521040825, "last_edit_date": 1521041427, "question_id": 49281522, "link": "https://stackoverflow.com/questions/49281522/how-make-a-good-calculator-with-floating-point-arithmetic", "closed_reason": "Duplicate", "title": "How make a good calculator with floating point arithmetic", "body": "<p>Here is how my calculator should work:</p>\n\n<p>There is a JSON value where I can write the first multiplier - something like this:</p>\n\n<pre><code>{\n    \"value1\": 1.4\n}\n</code></pre>\n\n<p>On the calculator I can write the second multiplier - only <code>10^n</code> numbers (10, 100, ..., 10000000). And my calc should return me an integer, as I know that always people who use my calc with write less numbers after the decimal point for the first multiplier than we have <code>0</code>s on the calc for the second multiplier. Yes, my calc is a very-very strange one.</p>\n\n<p>Here are valid inputs:</p>\n\n<pre><code>v1=1.4; v2=100;\nv1=1.414; v2=100000;\nv1=1.1; v2=100;\n</code></pre>\n\n<p>What happens when I do this, for example for <code>value1=1.4</code> and <code>value2=10000</code> I get 13900. As far as float cannot hold any number sometimes it stores different numbers. For 1.4 internally it stores 1.399999 on my machine. I know why, but you know the QA engineer who tests my app tells me that I need to get 14000. Your calc does not work. How to make my calc so that I will print correct number? </p>\n\n<p>P.S. Of course I have cut out my real problem from the context but the thing is that I have a float in a file and a 10^n number in my program as a user input. How to get correct result?</p>\n\n<p>EDIT1: I don't ask why float works that way. I know why. I ask how to solve the problem even when float works that way.</p>\n\n<p>EDIT2: I use RapidJson to read the JSON file which already returns me  wrong number as a double precision number. I can't use libraries that provide with higher precision floating points. </p>\n"}, {"tags": ["c++", "multithreading", "c++11", "c++14", "c++17"], "comments": [{"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 2, "creation_date": 1521040513, "post_id": 49281378, "comment_id": 85565317, "body": "Try <code>tbb</code> library."}, {"owner": {"reputation": 2137, "user_id": 1034253, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/nO7s7.png?s=128&g=1", "display_name": "Ufx", "link": "https://stackoverflow.com/users/1034253/ufx"}, "edited": false, "score": 0, "creation_date": 1521040576, "post_id": 49281378, "comment_id": 85565360, "body": "msvc. But I want to make crossplatform code."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1521040651, "post_id": 49281378, "comment_id": 85565409, "body": "@Ufx: Is <code>v[i] = o.f(i);</code> expensive enough to be <i>worth</i> the overhead of farming them out to other cores and then synchronizing the results? If not, then don&#39;t bother."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1521040663, "post_id": 49281378, "comment_id": 85565424, "body": "With c++11 <a href=\"http://en.cppreference.com/w/cpp/thread/async\" rel=\"nofollow noreferrer\"><code>std::async</code></a> is an easy way of parallelizing jobs.  With c++17 you can provide run <a href=\"http://en.cppreference.com/w/cpp/algorithm/for_each\" rel=\"nofollow noreferrer\"><code>std::for_each</code></a> with an <a href=\"http://en.cppreference.com/w/cpp/algorithm/execution_policy_tag_t\" rel=\"nofollow noreferrer\">execution policy</a>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1521042863, "post_id": 49281378, "comment_id": 85567145, "body": "@Ufx tbb is pretty cross platform"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521042908, "post_id": 49281378, "comment_id": 85567185, "body": "@Fran&#231;oisAndrieux MSVC <code>std::async</code> is sadly far from standard compliant, at least as of 2015.  I am uncertain if they fixed everything in 2017, I got burned twice and stopped using it.  (it had incorrect destruction behavior, and it used a global thread pool, both of which cause serious problems)"}, {"owner": {"reputation": 2137, "user_id": 1034253, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/nO7s7.png?s=128&g=1", "display_name": "Ufx", "link": "https://stackoverflow.com/users/1034253/ufx"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521042996, "post_id": 49281378, "comment_id": 85567258, "body": "@Fran&#231;oisAndrieux I would prefer standard library if it&#39;s possible."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1521043023, "post_id": 49281378, "comment_id": 85567280, "body": "@Ufx Those are all features from the standard library. If by &quot;standard&quot; you mean c++03, it&#39;s not more or less standard than c++11 and c++17, simply different versions of the language. When people talk about standard c++ without specifying the version, it&#39;s usually assumed to mean the most recent standard published."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1521052838, "post_id": 49281378, "comment_id": 85573708, "body": "@Nicol I suspect the cost is inside o.f(i), not the assignment of the result."}, {"owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "edited": false, "score": 3, "creation_date": 1521055572, "post_id": 49281378, "comment_id": 85575144, "body": "OpenMP does exactly this, and most compilers (GCC, LLVM, MSVC) support it. By adding a line like <code>#pragma omp parallel for</code> over the <code>for</code> loop."}], "answers": [{"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521041274, "post_id": 49281669, "comment_id": 85565888, "body": "@Fran&#231;oisAndrieux I dunno, it says &quot;something like&quot;.  That isn&#39;t code."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1521041377, "post_id": 49281669, "comment_id": 85565971, "body": "Since each call is independent, could probably use <code>std::execution::par_unseq</code> policy."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1521041785, "post_id": 49281669, "comment_id": 85566298, "body": "@user2079303 I just added some advice on that."}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 6, "last_activity_date": 1521042272, "last_edit_date": 1521042272, "creation_date": 1521041188, "answer_id": 49281669, "question_id": 49281378, "link": "https://stackoverflow.com/questions/49281378/how-can-i-use-all-the-cores-in-the-loop/49281669#49281669", "title": "How can I use all the cores in the loop?", "body": "<p>The <a href=\"http://en.cppreference.com/w/cpp/algorithm/execution_policy_tag_t\" rel=\"nofollow noreferrer\"><code>ExecutionPolicy</code></a> overloads of the algorithms in <code>&lt;algorithm&gt;</code> exist for this purpose. <a href=\"http://en.cppreference.com/w/cpp/algorithm/transform\" rel=\"nofollow noreferrer\"><code>std::transform</code></a> applies a function to each element of a source range to assign to a destination range.</p>\n\n<p><code>v.begin()</code> is an acceptable destination, so long as <code>v</code> is of appropriate size. Your snippet assumes this when it uses <code>v[i]</code>, so I will too.</p>\n\n<p>We then need an iterator that gives the values <code>[0, n)</code> as our source, so <a href=\"http://www.boost.org/doc/libs/1_50_0/libs/iterator/doc/counting_iterator.html\" rel=\"nofollow noreferrer\"><code>boost::counting_iterator&lt;int&gt;</code></a>.</p>\n\n<p>Finally we need a <code>Callable</code> that will apply <code>o.f</code> to our values, so lets capture <code>o</code> in a lambda.</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;execution&gt;\n#include &lt;boost/iterator/counting_iterator.hpp&gt;\n\n// assert(v.size() &gt;= n)\nstd::transform(std::execution::par, boost::counting_iterator&lt;int&gt;(0), boost::counting_iterator&lt;int&gt;(n), v.begin(), [&amp;o](int i){ return o.f(i); });\n</code></pre>\n\n<p>If <code>o.f</code> does not perform any \"vectorization-unsafe operations\", you are able to use <a href=\"http://en.cppreference.com/w/cpp/algorithm/execution_policy_tag_t\" rel=\"nofollow noreferrer\"><code>std::execution::par_unseq</code></a>, which <em>may</em> interleave calls on the same thread (i.e. unroll the loop and use SIMD instructions)</p>\n"}, {"comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 1, "creation_date": 1521109113, "post_id": 49285739, "comment_id": 85595442, "body": "This spawns a thread for each invocation, which may be very inefficient. I suggest breaking the work down into chunks of <code>n &#47; std::this_thread::hardware_concurrency()</code>, if the latter does not return zero (if it does, a sensible default value should be used instead)."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 2, "creation_date": 1521109536, "post_id": 49285739, "comment_id": 85595741, "body": "Yes there are many ways to make it use the resources better, but as a first step it will show you if there is any benefit to be gained. There are issues with batching and waiting if your jobs are not all similar sized. Another way to drive the processor load balancing is to launch the first X jobs, then launch 1 job at a time as you wait for the first already launched job to finish, then finally wait for the last X jobs to finish."}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 4, "last_activity_date": 1521212065, "last_edit_date": 1521212065, "creation_date": 1521053810, "answer_id": 49285739, "question_id": 49281378, "link": "https://stackoverflow.com/questions/49281378/how-can-i-use-all-the-cores-in-the-loop/49285739#49285739", "title": "How can I use all the cores in the loop?", "body": "<p>In the land of existing compilers, and remembering that M/S can't even get this stuff right for C++11, never mind about C++17/20, the C++11 answer goes something like:</p>\n\n<pre><code>typedef v.value_type R;\nstd::vector&lt; std::future&lt;R&gt; &gt; fut(n);\nfor (int i=0; i&lt;n; i++)\n    fut[i] = std::async(std::launch::async, O::f, o, i);\nfor (auto&amp; f : fut)\n    v.push_back(f.get());\n</code></pre>\n\n<p>@arne suggests we can do better by throttling the number of tasks by considering the number of processors (P), which is true, though the above code will give you a clear indication on whether you will really benefit from multi-threading the method f. Given we only want to launch X jobs simultaneously, where X is > P, &lt; 3*P depending on the variation in job complexity (note I am relying on a signed index):</p>\n\n<pre><code>typedef v.value_type R;\nstd::vector&lt; std::future&lt;R&gt; &gt; fut(n);\nfor (ssize_t i=0, j=-X; j&lt;n; i++,j++)\n{\n    if (i&lt;n)    fut[i] = std::async(std::launch::async, O::f, o, i);\n    if (j&gt;=0)   v.push_back(fut[j].get());\n}\n</code></pre>\n\n<p>I'm not claiming the above code is \"great\", but if the jobs are complex enough for us to need multithreading, the cost of looping a few extra times isn't gointg to be noticed. You will notice that if X > n the loop will spin a few times in the middle, but will produce the correct result :-)</p>\n"}], "owner": {"reputation": 2137, "user_id": 1034253, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/nO7s7.png?s=128&g=1", "display_name": "Ufx", "link": "https://stackoverflow.com/users/1034253/ufx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1521212065, "creation_date": 1521040387, "last_edit_date": 1521040789, "question_id": 49281378, "link": "https://stackoverflow.com/questions/49281378/how-can-i-use-all-the-cores-in-the-loop", "title": "How can I use all the cores in the loop?", "body": "<p>There is a loop.  </p>\n\n<pre><code>for (int i = 0; i &lt; n; ++i) {\n    //...\n    v[i] = o.f(i);\n    //...\n}\n</code></pre>\n\n<p>Each <code>v[i] = o.f(i)</code> is independent of all the other <code>v[i] = o.f(i)</code>.<br>\n<code>n</code> can be any value and it may not be a multiple of the number of cores. What is the simplest way to use all the cores to do this?</p>\n"}, {"tags": ["c++", "visual-studio-2017", "point-cloud-library", "vcpkg"], "answers": [{"tags": [], "owner": {"reputation": 486, "user_id": 5871543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb0a345c0a3e5f068b2c253325b3600?s=128&d=identicon&r=PG&f=1", "display_name": "roschuma", "link": "https://stackoverflow.com/users/5871543/roschuma"}, "is_accepted": true, "score": 0, "last_activity_date": 1521054909, "creation_date": 1521054909, "answer_id": 49286010, "question_id": 49281203, "link": "https://stackoverflow.com/questions/49281203/install-point-cloud-library/49286010#49286010", "title": "Install Point Cloud Library", "body": "<p>The <code>x64-windows-static</code> triplets won't be automatically selected[1] -- you need to edit your MSBuild vcxproj and set the <code>VcpkgTriplet</code> MSBuild property to <code>x64-windows-static</code>:</p>\n\n<pre><code>&lt;PropertyGroup Label=\"Globals\"&gt;\n  &lt;!-- .... --&gt;\n  &lt;VcpkgTriplet Condition=\"'$(Platform)'=='Win32'\"&gt;x86-windows-static&lt;/VcpkgTriplet&gt;\n  &lt;VcpkgTriplet Condition=\"'$(Platform)'=='x64'\"&gt;x64-windows-static&lt;/VcpkgTriplet&gt;\n&lt;/PropertyGroup&gt;\n</code></pre>\n\n<p>Note that you will also need to change to static link the CRT (/MT) if you do this.</p>\n\n<p>Alternatively, you can install the dynamic libraries (<code>x64-windows</code>) and they will be automatically picked up by default and work with the settings for your new project without any changes.</p>\n\n<p>Either way, you should not need to add any paths to your Additional Include Directories or to your Additional Dependencies.</p>\n\n<p>[1] <a href=\"https://github.com/Microsoft/vcpkg/blob/master/docs/users/integration.md#triplet-selection\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/vcpkg/blob/master/docs/users/integration.md#triplet-selection</a></p>\n"}], "owner": {"reputation": 107, "user_id": 8096778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21054dbba6f1b0811f677c5d58236131?s=128&d=identicon&r=PG&f=1", "display_name": "IsmNaj", "link": "https://stackoverflow.com/users/8096778/ismnaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "accepted_answer_id": 49286010, "answer_count": 1, "score": 0, "last_activity_date": 1521055030, "creation_date": 1521039998, "last_edit_date": 1521055030, "question_id": 49281203, "link": "https://stackoverflow.com/questions/49281203/install-point-cloud-library", "title": "Install Point Cloud Library", "body": "<p>I've recently been introduced to <strong>vcpkg</strong> as I've been looking for the best way to install Point Cloud Library (PCL) in order to use it in my Visual Studio C++ project. </p>\n\n<p>I've installed PLC static libraries using <code>.\\vcpkg install pcl:x64-windows-static</code> and then <code>.\\vcpkg integrate install</code> to integrate the libs and dlls to Visual Studio 2017. My goal for now is to run the demo of <a href=\"http://pointclouds.org/documentation/tutorials/iterative_closest_point.php\" rel=\"nofollow noreferrer\">Iterative Closest Point Algorithm</a> on the official PCL website.  </p>\n\n<p>I have created a virgin project and I've done the following to add PCL: </p>\n\n<ul>\n<li>Added \"vcpkg-master\\installed\\x64-windows-static\\include\" path to Property Page->VC++ directories->Include Directories</li>\n<li>Added \"vcpkg-master\\installed\\x64-windows-static\\include\" path to Property Page<br>\n->C/C++ ->Additional Include Directories</li>\n<li>Added the all the lib files (the ones in vcpkg-master\\installed\\x64-windows-static\\lib)to Property Page->Linker->Additional Dependencies </li>\n<li>Added \"vcpkg-master\\installed\\x64-windows-static\\lib\" path to Property Page->Linker->General->Additional Library Directories</li>\n</ul>\n\n<p>I'm trying to compile the previously mentioned demo in Debug x86 mode but I keep getting the following error: </p>\n\n<pre><code>1&gt;LINK : fatal error LNK1104: cannot open file 'manual-link.obj'\n</code></pre>\n\n<p>Please note that in the installed PCL directories, there are two folders called <strong>manual-link</strong>.<br>\nThe first one is \"vcpkg-master\\installed\\x64-windows-static\\debug\\lib\\manual-link\" and contains two lib files:</p>\n\n<ul>\n<li>boost_prg_exec_monitor-vc140-mt-gd.lib</li>\n<li>boost_test_exec_monitor-vc140-mt-gd.lib</li>\n</ul>\n\n<p>The other one is \"vcpkg-master\\installed\\x64-windows-static\\lib\\manual-link\" and includes: </p>\n\n<ul>\n<li>boost_prg_exec_monitor-vc140-mt.lib</li>\n<li>boost_test_exec_monitor-vc140-mt.lib</li>\n</ul>\n\n<p>I don't know what I'm missing here. Has anybody experienced the same problem with PCL and Visual Studio 2017? Any solutions to this problem?  </p>\n"}, {"tags": ["c++", "cobol", "xerces-c"], "comments": [{"owner": {"reputation": 4615, "user_id": 5027456, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4402d93af57510a743974c4b2062720?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sobisch", "link": "https://stackoverflow.com/users/5027456/simon-sobisch"}, "edited": false, "score": 0, "creation_date": 1521050414, "post_id": 49281002, "comment_id": 85572322, "body": "Seems a little bit unclear: Where does the filename for the XML comes from? I assume it comes from COBOL (you&#39;ve missed to specify which COBOL on what OS you use btw). If this is correct: How does the COBOL and C field definition looks like? How do you pass the COBOL field to C?"}, {"owner": {"reputation": 1, "user_id": 9492157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogDqLpqp4ec/AAAAAAAAAAI/AAAAAAAAB4U/A8Knkrsu3Us/photo.jpg?sz=128", "display_name": "Frederic", "link": "https://stackoverflow.com/users/9492157/frederic"}, "reply_to_user": {"reputation": 4615, "user_id": 5027456, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4402d93af57510a743974c4b2062720?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sobisch", "link": "https://stackoverflow.com/users/5027456/simon-sobisch"}, "edited": false, "score": 0, "creation_date": 1521097954, "post_id": 49281002, "comment_id": 85589261, "body": "I am using cobol85 on a HP Nonstop (guardian os). The XML file is created by the c program, so the filename is in the right format. But xerces is still thinking that the program runs on the other hp nonstop os(oss, just like unix). There are several methods to tell the compiler (c89) and linker (eld) that I want to run the program and xerces on the guardian platform, just like the <code>GuardianTandemPlatformUtils.o</code> or the option <code>systype=guardian</code>: Btw my standalone c program is compiled and linked by the same makefile as the c program that is linked to my cobol program."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9492157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogDqLpqp4ec/AAAAAAAAAAI/AAAAAAAAB4U/A8Knkrsu3Us/photo.jpg?sz=128", "display_name": "Frederic", "link": "https://stackoverflow.com/users/9492157/frederic"}, "is_accepted": false, "score": 0, "last_activity_date": 1521533920, "creation_date": 1521533920, "answer_id": 49379277, "question_id": 49281002, "link": "https://stackoverflow.com/questions/49281002/calling-c-with-xerces-from-cobol-trouble-with-guardian-and-oss-path/49379277#49379277", "title": "Calling C++ with Xerces from COBOL: Trouble with Guardian and OSS path", "body": "<p>I solved this problem by using the <code>InputSource</code> class with base- and relative-path as shown <a href=\"https://xerces.apache.org/xerces-c/apiDocs-3/classLocalFileInputSource.html#aa40f6d0d8010a45a678c53faf5f7e67c\" rel=\"nofollow noreferrer\">here</a>. After this I am calling the <code>parser.parse(&amp;inputSource)</code> and get no error.</p>\n"}], "owner": {"reputation": 1, "user_id": 9492157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ogDqLpqp4ec/AAAAAAAAAAI/AAAAAAAAB4U/A8Knkrsu3Us/photo.jpg?sz=128", "display_name": "Frederic", "link": "https://stackoverflow.com/users/9492157/frederic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521533920, "creation_date": 1521039505, "question_id": 49281002, "link": "https://stackoverflow.com/questions/49281002/calling-c-with-xerces-from-cobol-trouble-with-guardian-and-oss-path", "title": "Calling C++ with Xerces from COBOL: Trouble with Guardian and OSS path", "body": "<p>I am writing an cobol program that calls a c++ program. This c++ program does some XML validation using Xerces c++. When I write a standalone C++ programm, I get no errors. When I call the c++ programm from cobol, there occurs an error when calling the parse method of <a href=\"https://xerces.apache.org/xerces-c/apiDocs-3/classSAXParser.html\" rel=\"nofollow noreferrer\" title=\"SAXParser\">SAXParser</a> because xerces cannot find the xml file. Inside the c++ program, I can open the file but xerces cannot. </p>\n\n<p>Xerces thinks that the path to the xml is in OSS style <code>/G/vol/subvol/filename</code>, but it's in guardian style <code>vol.subvol.filename</code> This error occurs only when I'm using Xerces, not when using the c++ program.</p>\n\n<p>My standalone c++ program that calls xerces works fine. Has anybody an idea why this error occurs and how to solve it? </p>\n"}, {"tags": ["c++", "class", "variables", "static"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521039536, "post_id": 49280961, "comment_id": 85564574, "body": "Whats the problem with using <code>static int nextNodeID = 0;</code> in the class?  You can still increment it in your constructor."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1521039536, "post_id": 49280961, "comment_id": 85564575, "body": "1) &quot;<i>I tried this down here ... it says the variable is multiply defined.</i>&quot; Don&#39;t define the variable in the header - do it in the .cpp file, so it is defined only once. 2) &quot;<i>it says the in-class initializer must be constant</i>&quot; Are you compiling with C++-11 enabled? If I remember correctly, such syntax was invalid before C++-11."}, {"owner": {"reputation": 1774, "user_id": 469476, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4469e6e376ebf2104f5367aaafa30008?s=128&d=identicon&r=PG", "display_name": "elbillaf", "link": "https://stackoverflow.com/users/469476/elbillaf"}, "edited": false, "score": 0, "creation_date": 1521039791, "post_id": 49280961, "comment_id": 85564768, "body": "Nathan, the problem is that it says &quot;a member with an in-class initializer must be const&quot; ... but this is not intended to be a constant."}, {"owner": {"reputation": 1774, "user_id": 469476, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4469e6e376ebf2104f5367aaafa30008?s=128&d=identicon&r=PG", "display_name": "elbillaf", "link": "https://stackoverflow.com/users/469476/elbillaf"}, "edited": false, "score": 0, "creation_date": 1521040181, "post_id": 49280961, "comment_id": 85565078, "body": "Algirdas, If I put it outside the class definition, it&#39;s no longer a private variable.  However, I tried that and it works.   I don&#39;t know how to tell what version of C++ I&#39;m compiling to.  I just installed VS community 2017.  There is nothing entered in the &quot;C++ Language Standard&quot;"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521040285, "post_id": 49280961, "comment_id": 85565154, "body": "Oh, oops. Forgot that in class initialization still doesn&#39;t apply for non-const static members"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1521040423, "post_id": 49280961, "comment_id": 85565252, "body": "<i>&quot;If I put it outside the class definition, it&#39;s no longer a private variable&quot;</i> - what are you talking about? It&#39;s still a private static member, even if you&#39;re simply moving the initial value to the definition rather than the declaration. And the definition, <code>int TestMethods::nextNodeID = 0;</code>, should be in <i>one</i> cpp file. That doesn&#39;t belong in the header."}, {"owner": {"reputation": 1774, "user_id": 469476, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4469e6e376ebf2104f5367aaafa30008?s=128&d=identicon&r=PG", "display_name": "elbillaf", "link": "https://stackoverflow.com/users/469476/elbillaf"}, "edited": false, "score": 0, "creation_date": 1521040580, "post_id": 49280961, "comment_id": 85565365, "body": "Whoz, you&#39;re right. I see how that makes sense.  thanks"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 2, "last_activity_date": 1521040550, "creation_date": 1521040550, "answer_id": 49281437, "question_id": 49280961, "link": "https://stackoverflow.com/questions/49280961/initializing-a-static-non-constant-variable-of-a-class/49281437#49281437", "title": "initializing a static (non-constant) variable of a class.", "body": "<p>You need to move the definition of <code>TestMethods::nextNodeID</code> into the cpp file.  If you have it in the header file then every file that includes the header will get it defined in them leading to multiple defenitions.</p>\n\n<p>If you have C++17 support you can use the <code>inline</code> keyword to declare the static variable in the class like</p>\n\n<pre><code>class ExampleClass {\n\nprivate:\n    inline static int counter = 0;\npublic:\n    ExampleClass() {\n        ++counter;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 469476, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4469e6e376ebf2104f5367aaafa30008?s=128&d=identicon&r=PG", "display_name": "elbillaf", "link": "https://stackoverflow.com/users/469476/elbillaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 49281437, "answer_count": 1, "score": 0, "last_activity_date": 1521040550, "creation_date": 1521039400, "question_id": 49280961, "link": "https://stackoverflow.com/questions/49280961/initializing-a-static-non-constant-variable-of-a-class", "title": "initializing a static (non-constant) variable of a class.", "body": "<p>I have TestMethods.h</p>\n\n<pre><code>#pragma once\n\n// strings and c-strings\n#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n#include &lt;string&gt;\n\nclass TestMethods\n{\nprivate:\n    static int nextNodeID;\n    // I tried the following line instead ...it says the in-class initializer must be constant ... but this is not a constant...it needs to increment.\n    //static int nextNodeID = 0;\n    int nodeID;\n\n    std::string fnPFRfile; // Name of location data file for this node.\n\n\npublic:\n    TestMethods();\n    ~TestMethods();\n\n    int currentNodeID();\n};\n\n// Initialize the nextNodeID\nint TestMethods::nextNodeID = 0;\n// I tried this down here ... it says the variable is multiply defined.  \n</code></pre>\n\n<p>I have TestMethods.cpp</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"TestMethods.h\"\n\nTestMethods::TestMethods()\n{\n    nodeID = nextNodeID;\n    ++nextNodeID;\n}\nTestMethods::~TestMethods()\n{\n}\nint TestMethods::currentNodeID()\n{\n    return nextNodeID;\n}\n</code></pre>\n\n<p>I've looked at this example here: <a href=\"https://stackoverflow.com/questions/40444153/unique-id-of-class-instance\">Unique id of class instance</a></p>\n\n<p>It looks almost identical to mine.  I tried both the top solutions.  Neither works for me.  Obviously I'm missing something.  Can anyone point out what it is?</p>\n"}, {"tags": ["c++", "c++11", "swig"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1521039166, "post_id": 49280831, "comment_id": 85564298, "body": "Is your class missing a <code>;</code> real or a typo?"}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521039204, "post_id": 49280831, "comment_id": 85564331, "body": "typo.. sorry, I tried to concentrate on the real problem and missed that in the question"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1521039205, "post_id": 49280831, "comment_id": 85564332, "body": "Those <code>...</code> aren&#39;t valid, either. Present your actual <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, not some made-up nonsense that doesn&#39;t represent the problematic code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521039235, "post_id": 49280831, "comment_id": 85564355, "body": "@purpletentacle The we really need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1521039283, "post_id": 49280831, "comment_id": 85564389, "body": "It&#39;s <i>probably</i> lack of support for <code>override</code>, though \u2014 try removing things until it works."}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1521039287, "post_id": 49280831, "comment_id": 85564392, "body": "@LightnessRacesinOrbit I think that was a bit harsh... SWIG requires a much more complicated build process that would not fit in the question. The issue is the relation between override and throw when compiled with SWIG"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1521039302, "post_id": 49280831, "comment_id": 85564398, "body": "It&#39;s not &quot;harsh&quot;. You&#39;ve been here long enough to know to post a MCVE from the outset."}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "edited": false, "score": 2, "creation_date": 1521039397, "post_id": 49280831, "comment_id": 85564457, "body": "Thank you for your feedback. Maybe someone that has more experience with SWIG knows a bit more about the problem. It is definitely not about override."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1521039436, "post_id": 49280831, "comment_id": 85564486, "body": "btw, dynamic exception specifications are not allowed since C++17"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1521039508, "post_id": 49280831, "comment_id": 85564548, "body": "How do you know the problem isn&#39;t in <code>&#47;&#47; ... more code goes here</code>?"}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1521039526, "post_id": 49280831, "comment_id": 85564563, "body": "@bolov that is why I wrote the node. SWIG uses that to expose exceptions to python."}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1521039606, "post_id": 49280831, "comment_id": 85564639, "body": "@interjay Because I have CI and can compile the exact code in OSX and Linux (both clang and gcc). Only when this class is wrapped by SWIG is when I see this compilation issue."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1521039663, "post_id": 49280831, "comment_id": 85564671, "body": "That doesn&#39;t answer my question of how you know the problem isn&#39;t in the code which you chose not to show here."}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1521039778, "post_id": 49280831, "comment_id": 85564764, "body": "@interjay I will update with more info"}, {"owner": {"reputation": 145, "user_id": 1633071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fab0100dda2b689334e02564b42cda3?s=128&d=identicon&r=PG", "display_name": "Tim Smit", "link": "https://stackoverflow.com/users/1633071/tim-smit"}, "edited": false, "score": 0, "creation_date": 1521040678, "post_id": 49280831, "comment_id": 85565440, "body": "There&#39;s no need to %include &quot;std_except.i&quot; before %include &quot;headerFile.h&quot; right?"}, {"owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "reply_to_user": {"reputation": 145, "user_id": 1633071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fab0100dda2b689334e02564b42cda3?s=128&d=identicon&r=PG", "display_name": "Tim Smit", "link": "https://stackoverflow.com/users/1633071/tim-smit"}, "edited": false, "score": 0, "creation_date": 1521041499, "post_id": 49280831, "comment_id": 85566074, "body": "@TimSmit updated. My *.i is actually quite complicated."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1521062465, "post_id": 49280831, "comment_id": 85578682, "body": "Your header file doesn&#39;t even <i>have</i> 22 lines, unless your error message didn&#39;t come from your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Please post <i>exactly</i> a complete minimal program and its <i>matching</i> error messages."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1521095271, "post_id": 49280831, "comment_id": 85588125, "body": "What version of SWIG are you using, and what command line are you using with swig to generate the wrapper?"}], "answers": [{"tags": [], "owner": {"reputation": 3820, "user_id": 4754037, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpB-u9D7emI/AAAAAAAAAAI/AAAAAAAAAAA/LsS3R-k2AUY/photo.jpg?sz=128", "display_name": "shawn", "link": "https://stackoverflow.com/users/4754037/shawn"}, "is_accepted": true, "score": 5, "last_activity_date": 1521041832, "creation_date": 1521041832, "answer_id": 49281925, "question_id": 49280831, "link": "https://stackoverflow.com/questions/49280831/missing-semicolon-c-or-swig-issue/49281925#49281925", "title": "Missing semicolon: C++ or SWIG issue?", "body": "<p>Your SWIG is using C++11:</p>\n\n<p><a href=\"http://www.swig.org/Doc3.0/CPlusPlus11.html\" rel=\"noreferrer\">http://www.swig.org/Doc3.0/CPlusPlus11.html</a></p>\n\n<p>7.2.11 Explicit overrides and final:  The special identifiers final and override can be used on methods and destructors, such as in the following example: </p>\n\n<pre><code>  virtual void ef() final override;\n  virtual ~DerivedStruct() override;\n</code></pre>\n\n<p>You may either:</p>\n\n<ol>\n<li>Use C++11 with the C++ compiler (eg: <code>-std=c++11</code>)</li>\n<li>Disable SWIG's C++11 code generator.</li>\n<li>Use trick <code>#define override</code></li>\n</ol>\n"}], "owner": {"reputation": 5321, "user_id": 157726, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PY0sR.png?s=128&g=1", "display_name": "Juan Leni", "link": "https://stackoverflow.com/users/157726/juan-leni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 49281925, "answer_count": 1, "score": 2, "last_activity_date": 1521041832, "creation_date": 1521039074, "last_edit_date": 1521041461, "question_id": 49280831, "link": "https://stackoverflow.com/questions/49280831/missing-semicolon-c-or-swig-issue", "title": "Missing semicolon: C++ or SWIG issue?", "body": "<p>This question is actually about SWIG, not a basic C++ missing a semicolon.</p>\n\n<p>I have the following method in a class (in the header file):</p>\n\n<pre><code>class BarClass \n{\n    // ... more code goes here\n    unsigned int foo(unsigned int val) throw(std::invalid_argument) override;\n    // ... more code goes here\n};\n</code></pre>\n\n<p>I have a SWIG interface declaration in the form:</p>\n\n<pre><code>%include \"stdint.i\"\n%include \"std_except.i\"\n%include \"exception.i\"\n\n%module mymodule\n%{\n    #include \"headerFile.h\"\n%}\n%include \"headerFile.h\"\n</code></pre>\n\n<p>The code is used as a C++ static library but also exposed to python via SWIG. Normal compilation with GCC / Clang works well. </p>\n\n<p>However, when wrapping the library with SWIG, I receive an error:</p>\n\n<blockquote>\n  <p>headerFile.h:22: Error: Syntax error - possibly a missing semicolon.</p>\n</blockquote>\n\n<p>I could replace the method declaration with:</p>\n\n<pre><code>unsigned int foo(unsigned int val) throw(std::invalid_argument);\n</code></pre>\n\n<p>When removing the override, SWIG seems to work but I get warnings. I have the impression that SWIG gets confused by the combination of throw and override at the same time.</p>\n\n<p>Is this is SWIG bug or something silly that I am missing?</p>\n\n<p><strong>Note:</strong> I very much aware that using throw declarations is deprecated but that is the way SWIG gets information about exceptions and generates the appropriate code for Python. Maybe there is a better/newer way to do this in SWIG?</p>\n"}, {"tags": ["c++", "macos", "dynamic-linking", "dlopen"], "comments": [{"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1521040955, "post_id": 49280813, "comment_id": 85565633, "body": "but if I still want to reload new library version, can I do so by changing the file name, for example by adding its version after the suffix ?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1521041972, "post_id": 49280813, "comment_id": 85566456, "body": "Yes, but your issue is probably that you didn&#39;t reload the functions and objects you got from <code>dlsym</code>."}, {"owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1521042581, "post_id": 49280813, "comment_id": 85566918, "body": "@Quentin, I actually take the API I need using <code>dlsym</code> (see updated question), isn&#39;t there any way that the linker gets confused with the older symbols (that have the same name) ?"}], "answers": [{"comments": [{"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 2, "creation_date": 1521045159, "post_id": 49282687, "comment_id": 85568852, "body": "GCC may also output <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=66830\" rel=\"nofollow noreferrer\">unique symbols</a> which can prevent unloading <i>even if</i> <code>RTLD_LOCAL</code> is used. These show up as <code>u</code> when using <code>nm</code>. Most commonly, these are <code>static</code> variables in <code>inline</code> functions and/or function templates. We have this problem with header-only libraries such as parts of Boost but coworkers of mine also managed to create these. The thing is that if the plugin is the first DSO to introduce them, it can never be unloaded. <code>dlclose</code> succeeds but the binary remains mapped."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 5, "last_activity_date": 1521043931, "creation_date": 1521043931, "answer_id": 49282687, "question_id": 49280813, "link": "https://stackoverflow.com/questions/49280813/runtime-library-reloading-using-dlopen/49282687#49282687", "title": "Runtime library reloading using `dlopen`", "body": "<blockquote>\n  <p>it seems like my program is unexpectedly gets crashed after the third phase. is it possible that the <code>dlclose</code> part leave some remnants of the older library in the process virtual space?</p>\n</blockquote>\n\n<p>It is possible. Objects with function pointers to functions and objects with virtual functions defined in the library being unloaded are going to end up with invalid pointers. Even worse, one can attach a new facet to a standard stream (e.g. <code>std::cout</code>) and then unload the shared library implementing the facet. Later on it would crash when using <code>std::cout</code> in a unrelated place (true story). So, you must be in total control of what the shared library does.</p>\n\n<p>Also, <code>dlopen</code> must be called with <code>RTLD_LOCAL</code>, so that nothing else can (accidentally) use the symbols of the shared library being loaded and prevent it from unloading. You must read and understand <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"noreferrer\"><code>man dlopen</code></a> if you do such feats.</p>\n"}], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 1, "closed_date": 1521056058, "accepted_answer_id": 49282687, "answer_count": 1, "score": 6, "last_activity_date": 1521044948, "creation_date": 1521039039, "last_edit_date": 1521044948, "question_id": 49280813, "link": "https://stackoverflow.com/questions/49280813/runtime-library-reloading-using-dlopen", "closed_reason": "Duplicate", "title": "Runtime library reloading using `dlopen`", "body": "<p>Is it possible for a running c++ based process to reload a c++ based dynamic library using <code>dlopen</code>. </p>\n\n<p>The running process polls for a new version of the dynamic library (with the same API). once such file is detected, the following set of actions are taking place :</p>\n\n<ol>\n<li>The older Library gets unloaded using <code>dlclose</code> </li>\n<li>The newer dylib is copied and override the file of the older version.</li>\n<li>The process loads the newer version from that location using <code>dlopen</code></li>\n<li>Setting the function pointer variables according to <code>dlsym</code> from the newly loaded library. </li>\n</ol>\n\n<p>In the last stage, I actually get the desired API and place it in function pointer from my main code to be used later. </p>\n\n<p>However, it seems like my program is unexpectedly gets crashed after the third phase. is it possible that the <code>dlclose</code> part leave some remnants of the older library in the process virtual space ? is there any better way to do so ? </p>\n\n<p>by the way, in Windows it's working just fine using <code>LoadLibrary,  FreeLibrary and GetProcAddress</code> instead of <code>dlopen, dlclose and dlsym</code>.</p>\n"}, {"tags": ["c++", "locking", "ofstream"], "comments": [{"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 0, "creation_date": 1521039747, "post_id": 49280805, "comment_id": 85564730, "body": "Look for <code>flock</code>, <code>lockf</code> and/or <code>fcntl</code>."}, {"owner": {"reputation": 1, "user_id": 9492163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zzR1.png?s=128&g=1", "display_name": "Oimat", "link": "https://stackoverflow.com/users/9492163/oimat"}, "reply_to_user": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 0, "creation_date": 1521122558, "post_id": 49280805, "comment_id": 85604759, "body": "Thank you both ;)"}], "owner": {"reputation": 1, "user_id": 9492163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zzR1.png?s=128&g=1", "display_name": "Oimat", "link": "https://stackoverflow.com/users/9492163/oimat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1521122520, "answer_count": 0, "score": 0, "last_activity_date": 1521039020, "creation_date": 1521039020, "question_id": 49280805, "link": "https://stackoverflow.com/questions/49280805/multiple-jobs-writing-in-the-same-file", "closed_reason": "Duplicate", "title": "Multiple jobs writing in the same file", "body": "<p>I have multiple jobs running on a server that have to write to the same file, but they may overlap in the writing, mixing characters and making the file unreadable.\nI'd like to make a lock on the file, so if another job is writing in it, the second one has to wait.</p>\n\n<p>I know we can do that through mutex for multithreading. Any ideas about multijobing ?</p>\n\n<p>Thanks a lot !</p>\n"}, {"tags": ["c++", "templates", "implicit-conversion", "explicit-constructor"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1521038738, "post_id": 49280668, "comment_id": 85563948, "body": "Thanks for the live MCVE!"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1521038872, "post_id": 49280668, "comment_id": 85564053, "body": "lambda are not <code>std::function</code>."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 2, "creation_date": 1521038873, "post_id": 49280668, "comment_id": 85564055, "body": "I had to reread the constructor parameters 3 times before I noticed <code>a_type</code> and <code>b_type</code> are different."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 3, "creation_date": 1521038977, "post_id": 49280668, "comment_id": 85564148, "body": "Short answer is that both constructors can be used because <a href=\"http://en.cppreference.com/w/cpp/utility/functional/function/function\" rel=\"nofollow noreferrer\">the fifth</a> overload of <code>std::function</code>."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 3, "creation_date": 1521039168, "post_id": 49280668, "comment_id": 85564300, "body": "A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> will actually look more like <a href=\"http://coliru.stacked-crooked.com/a/d03fb0862739eec4\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1521039428, "post_id": 49280668, "comment_id": 85564478, "body": "@SombreroChicken: And that <code>std::tuple&lt;long long,int&gt;</code> and <code>std::tuple&lt;std::sizt_t,int&gt;</code> are constructible from each other."}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1521039429, "post_id": 49280668, "comment_id": 85564480, "body": "Which constructor do you want to use?"}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521039479, "post_id": 49280668, "comment_id": 85564521, "body": "I would like to use the one with <code>b_type</code>"}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1521039491, "post_id": 49280668, "comment_id": 85564534, "body": "@Jarod42 Good addition, thanks."}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521039539, "post_id": 49280668, "comment_id": 85564583, "body": "@SobreroChicken, but i thought the using the keyword <code>explicit</code> should prevent the conversion from <code>std::tuple&lt;long long,int&gt;</code> to <code>std::tuple&lt;long long,int&gt;</code>"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1521039582, "post_id": 49280668, "comment_id": 85564622, "body": "Another workaround alternative is to not use a tuple for the b_type, but instead roll your own.  <code>using b_type = struct { std::size_t a; std::size_t b; };</code>"}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521039819, "post_id": 49280668, "comment_id": 85564799, "body": "thanks Eljay, however I want to keep the structure considering how all these elements fit together. Also, I give a particular example with 2 types, but my original class uses a variadic list of types. At that point, the struct solution is far less workable and requires doubling the code (one for use with a_type and one with b_type)"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528851506, "post_id": 49280668, "comment_id": 88660020, "body": "@AOK &quot;... <i>should prevent the conversion from <code>std::tuple&lt;long long,int&gt;</code> to <code>std::tuple&lt;long long,int&gt;</code></i>&quot; It does if you change that converting constructor to a one argument constructor callable only by direct initialization, by marking it <code>explicit</code>, or if you remove that implicit conversion operator, whichever it is that perform the conversion (I haven&#39;t checked and don&#39;t want to, as it&#39;s irrelevant for the point I&#39;m making). But then of course <code>std::tuple</code> is not a customization point, you can&#39;t change it."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521040075, "post_id": 49280970, "comment_id": 85565007, "body": "I was hoping for some solution that mucks around with <code>class A</code>, but this will have to do for now. Thanks!"}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 4, "last_activity_date": 1521039777, "last_edit_date": 1521039777, "creation_date": 1521039426, "answer_id": 49280970, "question_id": 49280668, "link": "https://stackoverflow.com/questions/49280668/why-is-the-constructor-in-this-c-code-ambiguous-and-how-do-i-fix-it/49280970#49280970", "title": "Why is the constructor in this C++ code ambiguous and how do I fix it?", "body": "<p>The reason it doesn't work is because a lambda is not a <code>std::function</code> and so the compiler tries to create one using <a href=\"http://en.cppreference.com/w/cpp/utility/functional/function/function\" rel=\"nofollow noreferrer\">the fifth</a> overload of the constructor. The problem is that both of your <code>A</code> constructors can be used because of this conversion and the reason that <code>std::tuple&lt;long long,int&gt;</code> and <code>std::tuple&lt;std::size_t,std::size_t&gt;</code> are constructible from each other makes this ambigious for the compiler what constructor to pick.</p>\n\n<p>What you could do is explicitly cast to the desired <code>std::function</code> (MCVE of @PasserBy used in comments), <a href=\"http://coliru.stacked-crooked.com/a/abe43f9a5961c15e\" rel=\"nofollow noreferrer\">like this</a>:</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename data_type, typename Type1, typename Type2&gt;\nclass A\n{\npublic:\n    using a_type = std::tuple&lt;Type1, Type2&gt;;\n    using b_type = std::tuple&lt;std::size_t,std::size_t&gt;;\n\n    A(const std::function&lt;data_type(a_type)&gt;&amp;)\n    {\n        std::cout &lt;&lt; \"idx_type\" &lt;&lt; std::endl;\n    }\n    A(const std::function&lt;data_type(b_type)&gt;&amp;)\n    {\n        std::cout &lt;&lt; \"point_type\" &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    std::function&lt;double(std::tuple&lt;long long, int&gt;)&gt; func = [](auto p) -&gt; double { return 1; };\n    auto c = A&lt;double, long long, int&gt;{\n        func\n    };\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521043710, "post_id": 49281403, "comment_id": 85567788, "body": "I&#39;ve been trying to put this together for VC++, but <code>std::is_invocable_v</code> isn&#39;t available and I can&#39;t get <code>std::_Is_invocable_r</code> to work. Any suggestions?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521044454, "post_id": 49281403, "comment_id": 85568359, "body": "@AOK It seems like MSVC doesn&#39;t have this yet. You may try implement it yourself. A possible implementation is to first implement <a href=\"http://en.cppreference.com/w/cpp/utility/functional/invoke\" rel=\"nofollow noreferrer\"><code>invoke</code></a> and SFINAE on whether the invocation is successful"}, {"owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "edited": false, "score": 0, "creation_date": 1521058953, "post_id": 49281403, "comment_id": 85577057, "body": "I tried to take a stab at it from a different angle (mostly since I had the structures for it already built), but it doesn&#39;t seem to be working. I posted it up as another questions because I feel it might be sufficiently different, in case you want to take a peek: <a href=\"https://stackoverflow.com/questions/49286989/how-to-properly-use-stdenable-if-in-c-on-a-constructor\">here</a>"}], "tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": true, "score": 1, "last_activity_date": 1521040463, "creation_date": 1521040463, "answer_id": 49281403, "question_id": 49280668, "link": "https://stackoverflow.com/questions/49280668/why-is-the-constructor-in-this-c-code-ambiguous-and-how-do-i-fix-it/49281403#49281403", "title": "Why is the constructor in this C++ code ambiguous and how do I fix it?", "body": "<p>As @SombreroChicken mentioned, <code>std::function&lt;R(Args...)&gt;</code> has a constructor that allows <em>any</em> callable object <code>c</code> to initialize it, as long as <code>c(Args...)</code> is valid and returns something convertible to <code>R</code>.</p>\n\n<p>To fix it, you may use some SFINAE machinery</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\ntemplate&lt;typename data_type, typename Type1, typename Type2&gt;\nclass A\n{\n    template&lt;typename T&gt;\n    struct tag\n    {\n        operator T();\n    };\n\npublic:\n    using a_type = std::tuple&lt;Type1, Type2&gt;;\n    using b_type = std::tuple&lt;std::size_t,std::size_t&gt;;\n\n    template&lt;typename C, std::enable_if_t&lt;std::is_invocable_v&lt;C, tag&lt;b_type&gt;&gt;&gt;* = nullptr&gt;\n    A(C&amp;&amp; initializer)\n    {\n        std::cout &lt;&lt; \"size_t\" &lt;&lt; std::endl;\n    }\n\n    template&lt;typename C, std::enable_if_t&lt;std::is_invocable_v&lt;C, tag&lt;a_type&gt;&gt;&gt;* = nullptr&gt;\n    A(C&amp;&amp; initializer)\n    {\n        std::cout &lt;&lt; \"other\" &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    auto c = A&lt;double, long long, int&gt;{\n        [](std::tuple&lt;long long, int&gt; p) -&gt; double { return 1; }\n    };\n\n    auto c2 = A&lt;double, long long, int&gt;{\n        [](std::tuple&lt;std::size_t, std::size_t&gt;) -&gt; double { return 2; }  \n    };\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/7931097ecbb0bbe5\" rel=\"nofollow noreferrer\">Live</a></p>\n\n<p>Here, we turn off the constructor if the callable can be called with <code>b_type</code> or <code>a_type</code> respectively. The extra indirection through <code>tag</code> is there to disable the conversion between tuples of different types</p>\n"}], "owner": {"reputation": 433, "user_id": 8411980, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43f65b4972600a0d9610a0ddcd587fe1?s=128&d=identicon&r=PG&f=1", "display_name": "AOK", "link": "https://stackoverflow.com/users/8411980/aok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 49281403, "answer_count": 2, "score": 10, "last_activity_date": 1521040463, "creation_date": 1521038621, "last_edit_date": 1521038743, "question_id": 49280668, "link": "https://stackoverflow.com/questions/49280668/why-is-the-constructor-in-this-c-code-ambiguous-and-how-do-i-fix-it", "title": "Why is the constructor in this C++ code ambiguous and how do I fix it?", "body": "<p>In the below code, the compiler can't figure out which constructor I want to use. Why, and how do I fix this? (<a href=\"http://coliru.stacked-crooked.com/a/77f21f7dd5c964b3\" rel=\"noreferrer\">Live example</a>)</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;typename data_type, typename eval_type, typename Type1, typename Type2&gt;\nclass A\n{\npublic:\n    using a_type = std::tuple&lt;Type1, Type2&gt;;\n    using b_type = std::tuple&lt;std::size_t,std::size_t&gt;;\n\n    inline explicit constexpr A(const std::function&lt;data_type(a_type)&gt;&amp; Initializer,\n        const std::function&lt;eval_type(data_type)&gt;&amp; Evaluator,\n        const Type1&amp; elem1, const Type2&amp; elem2)\n    {\n        std::cout &lt;&lt; \"idx_type\" &lt;&lt; std::endl;\n    }\n    inline explicit constexpr A(const std::function&lt;data_type(b_type)&gt;&amp; Initializer,\n        const std::function&lt;eval_type(data_type)&gt;&amp; Evaluator,\n        const Type1&amp; elem1, const Type2&amp; elem2)\n    {\n        std::cout &lt;&lt; \"point_type\" &lt;&lt; std::endl;\n    }\n};\n\nint main()\n{\n    int a = 1;\n    long long b = 2;\n    auto c = A&lt;double, double, long long, int&gt;{\n        [](std::tuple&lt;long long,int&gt; p)-&gt;double { return 1.0*std::get&lt;0&gt;(p) / std::get&lt;1&gt;(p); },\n        [](double d)-&gt;double { return d; }, b,a\n        };\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "ffmpeg"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9492082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e25b0dec08a34d7cc69d118ce785f8d?s=128&d=identicon&r=PG&f=1", "display_name": "MrEinsa", "link": "https://stackoverflow.com/users/9492082/mreinsa"}, "edited": false, "score": 0, "creation_date": 1521103762, "post_id": 49294373, "comment_id": 85591965, "body": "Thanks for the reply, but the data pointer in the AVPacket is not filled. So i dont think everything is filled."}], "tags": [], "owner": {"reputation": 354, "user_id": 6716398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JoFAt.jpg?s=128&g=1", "display_name": "Amr", "link": "https://stackoverflow.com/users/6716398/amr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521101652, "creation_date": 1521101652, "answer_id": 49294373, "question_id": 49280566, "link": "https://stackoverflow.com/questions/49280566/ffmpeg-c-convert-compress-a-single-image-out-of-buffer/49294373#49294373", "title": "FFMPEG (C++) convert &amp; compress a single image out of buffer", "body": "<p>I am not sure but following an ffmpeg <a href=\"https://ffmpeg.org/doxygen/trunk/doc_2examples_2transcoding_8c-example.html\" rel=\"nofollow noreferrer\">example</a> it seems that that just means it is done and you should return like they do in this code snippet:</p>\n\n<pre><code>/* if no more frames for output - returns AVERROR(EAGAIN)\n* if flushed and no more frames for output - returns AVERROR_EOF\n* rewrite retcode to 0 to show it as normal procedure completion\n*/\n            if (ret == AVERROR(EAGAIN) || ret == AVERROR_EOF)\n                ret = 0;\n</code></pre>\n\n<p>In their comments they seem to imply that it signals \"normal procedure completion\"</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 9492082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e25b0dec08a34d7cc69d118ce785f8d?s=128&d=identicon&r=PG&f=1", "display_name": "MrEinsa", "link": "https://stackoverflow.com/users/9492082/mreinsa"}, "is_accepted": true, "score": 0, "last_activity_date": 1522132120, "creation_date": 1522132120, "answer_id": 49505758, "question_id": 49280566, "link": "https://stackoverflow.com/questions/49280566/ffmpeg-c-convert-compress-a-single-image-out-of-buffer/49505758#49505758", "title": "FFMPEG (C++) convert &amp; compress a single image out of buffer", "body": "<p>the answer for this issue is this:</p>\n\n<pre><code>         do\n     {\n         ret = avcodec_receive_packet(av_codec_context_, &amp;pkt);\n         if (ret == 0)\n         {\n             break;\n         }\n         else if ((ret &lt; 0) &amp;&amp; (ret != AVERROR(EAGAIN)))\n         {\n             return false;\n         }\n         else if (ret == AVERROR(EAGAIN))\n         {\n              ret = avcodec_send_frame(av_codec_context_, NULL);\n              if (0 &gt; ret)\n              {\n                  return false;\n              }\n         }\n     } while (ret == 0);\n</code></pre>\n\n<p>The NULL frame will flush the buffer and we are able to get the encoded frame.</p>\n"}], "owner": {"reputation": 33, "user_id": 9492082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e25b0dec08a34d7cc69d118ce785f8d?s=128&d=identicon&r=PG&f=1", "display_name": "MrEinsa", "link": "https://stackoverflow.com/users/9492082/mreinsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 0, "accepted_answer_id": 49505758, "answer_count": 2, "score": 0, "last_activity_date": 1522132120, "creation_date": 1521038339, "last_edit_date": 1521530901, "question_id": 49280566, "link": "https://stackoverflow.com/questions/49280566/ffmpeg-c-convert-compress-a-single-image-out-of-buffer", "title": "FFMPEG (C++) convert &amp; compress a single image out of buffer", "body": "<p>i try to encode (with compression) and decode (without compression) a image with ffmpeg. But if i want to get the sent image back with avcodec_receive_packet i get only the error AVERROR(EAGAIN).</p>\n\n<p>It doesnt matter what i change ... allways AVERROR(EAGAIN) is the outcome. Is it maybe a problem of sending just one single frame to the encoder? And if yes, how to fix it?</p>\n\n<p>Code (only relevant stuff shown):</p>\n\n<pre><code>        avcodec_register_all();\n\n\n    /* ------ init codec ------------------*/\n    AVCodec *codec;\n    codec = avcodec_find_decoder(AV_CODEC_ID_H264);\n    if (!codec)\n    {\n        print(\"compressH264, could not find decoder:\\\"AV_CODEC_ID_H264\\\"!!!\");\n        return false;\n    }\n\n    AVCodec *nVidiaCodec = avcodec_find_encoder_by_name(\"h264_nvenc\");\n    if (!nVidiaCodec)\n    {\n        print(\"err\");\n    }\n    /* ------ ------------ ------------------*/\n\n    /* ------ init context ------------------*/\n    AVCodecContext* av_codec_context_ = NULL;\n    av_codec_context_ = avcodec_alloc_context3(nVidiaCodec);\n    if (!av_codec_context_)\n    {\n        print(\"compressH264, avcodec_alloc_context3 failed!!!\");\n        return false;\n    }\n    int w = imgSrc.width();\n    int h = imgSrc.height();\n    if ((w % 2) != 0)\n    {\n        ++w;\n    }\n    if ((h % 2) != 0)\n    {\n        ++h;\n    }\n    av_codec_context_-&gt;width = w;\n    av_codec_context_-&gt;height = h;\n    av_codec_context_-&gt;pix_fmt = AV_PIX_FMT_YUV420P;\n    av_codec_context_-&gt;gop_size = 1;\n    av_codec_context_-&gt;max_b_frames = 1;\n    av_codec_context_-&gt;bit_rate = 400000; \n    av_codec_context_-&gt;time_base.den = 1;\n    av_codec_context_-&gt;time_base.num = 1;\n\n    av_opt_set(av_codec_context_-&gt;priv_data, \"preset\", \"slow\", 0);\n\n    int ret = avcodec_open2(av_codec_context_, nVidiaCodec, NULL);\n    if (0 &gt; ret)\n    {\n        print(\"compressH264, could not open codec context for decoder:\\\"AV_CODEC_ID_H264\\\"!!!\");\n        return false;\n    }\n\n\n    AVFrame *picture = av_frame_alloc();\n    picture-&gt;format = AV_PIX_FMT_RGB24;\n    picture-&gt;width = w;\n    picture-&gt;height = h;\n\n    ret = avpicture_fill((AVPicture *)picture, imgSrc.bits(), AV_PIX_FMT_RGB24, w, h);\n    if (0 &gt; ret)\n    {\n        print(\"compressH264, avpicture_fill - failed!!!\");\n        return false;\n    }\n\n    AVFrame *tmp_picture = av_frame_alloc();\n    tmp_picture-&gt;format = AV_PIX_FMT_YUV420P;\n    tmp_picture-&gt;width = w;\n    tmp_picture-&gt;height = h;\n\n    ret = av_frame_get_buffer(tmp_picture, 32);\n\n    SwsContext *img_convert_ctx = sws_getContext(av_codec_context_-&gt;width, av_codec_context_-&gt;height, AV_PIX_FMT_RGB24, av_codec_context_-&gt;width, av_codec_context_-&gt;height, av_codec_context_-&gt;pix_fmt, SWS_BICUBIC, NULL, NULL, NULL);\n\n    ret = sws_scale(img_convert_ctx, picture-&gt;data, picture-&gt;linesize, 0, av_codec_context_-&gt;height, tmp_picture-&gt;data, tmp_picture-&gt;linesize);\n\n    int h264Size = avpicture_get_size(AV_PIX_FMT_YUV420P, w, h);\n\n    ret = avcodec_send_frame(av_codec_context_, tmp_picture);\n    if (0 &gt; ret)\n    {\n        char err[AV_ERROR_MAX_STRING_SIZE];\n        av_make_error_string(err, AV_ERROR_MAX_STRING_SIZE, ret);\n        print(\"compressH264, avcodec_send_frame: %s\", err);\n    }\n\n\n    AVPacket *pkt = av_packet_alloc();\n\n    while (ret &gt;= 0)\n    {\n        ret = avcodec_receive_packet(av_codec_context_, pkt);\n        if (ret == AVERROR(EAGAIN) || ret == AVERROR_EOF)\n        {\n            break;\n        }\n        else if (ret &lt; 0)\n        {\n            fprintf(stderr, \"Error during encoding\\n\");\n            exit(1);\n        }\n        av_packet_unref(pkt);\n    }\n    print(\"success\");\n</code></pre>\n\n<p>Everything works well until:\n- avcodec_receive_packet ... i get all time the error AVERROR(EAGAIN).</p>\n\n<p>I can start decoding just if i have the compressed image.</p>\n\n<p>Thanks for your help guys.</p>\n\n<p>Edit:\nIf i do now the following code, i get a packet and ret == 0, but i have to send 46 times the same image ... for me this makes no sence.</p>\n\n<pre><code>        do \n    {\n        ret = avcodec_receive_packet(av_codec_context_, &amp;pkt);\n        if (ret == 0)\n        {\n            break;\n        }\n        else if ((ret &lt; 0) &amp;&amp; (ret != AVERROR(EAGAIN)))\n        {\n            coutF(\"error\");\n        }\n        else if (ret == AVERROR(EAGAIN))\n        {\n            ret = avcodec_send_frame(av_codec_context_, tmp_picture);\n            if (0 &gt; ret)\n            {\n                char err[AV_ERROR_MAX_STRING_SIZE];\n                av_make_error_string(err, AV_ERROR_MAX_STRING_SIZE, ret);\n                coutFRed(\"compressH264, avcodec_send_frame: %s\", err);\n            }\n            coutF(\"cnt:%d\", ++cnt);\n        }\n\n    } while (ret == 0);\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Good morning,</p>\n\n<p>after more invest, i got the issue. I have to send the same frame a lot of time, because of the keyframe stuff for h264. The question now is, if it is possible to remove the h264 standart stuff from the encoder and just let FFMPEG convert one single frame.</p>\n"}, {"tags": ["c++", "segmentation-fault", "dijkstra"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1521038456, "post_id": 49280565, "comment_id": 85563720, "body": "You never set the size of <code>G</code>, so <code>G[i]</code> is out of bounds for <i>any</i> <code>i</code>. Why did you comment out <code>G.resize(V)</code>?"}, {"owner": {"reputation": 114, "user_id": 8773953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c533838d2993d2d00b89814bae73ee72?s=128&d=identicon&r=PG&f=1", "display_name": "Tazik_S", "link": "https://stackoverflow.com/users/8773953/tazik-s"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521038899, "post_id": 49280565, "comment_id": 85564078, "body": "Even when I uncomment it, I&#39;m getting a segmentation fault. I was trying to debug by commenting it out. Thank you, I&#39;ve edited the post to include that line."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521039810, "post_id": 49280565, "comment_id": 85564791, "body": "Use your debugger. Find out the line where the crash happens. Contemplate for a while. Do you need that line?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521039868, "post_id": 49280565, "comment_id": 85564845, "body": "What is your input to the program? What is the values of <code>V</code> and <code>E</code>? Could <code>E</code> be larger than <code>V</code>? And in the reading-loop, the values you read for <code>i</code> and <code>j</code> can never be equal to or larger than <code>V</code>? Or negative? Perhaps you should check that?"}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "edited": false, "score": 0, "creation_date": 1521039892, "post_id": 49280565, "comment_id": 85564867, "body": "You do <code>G[j][i] = 0;</code> before you&#39;ve resized the <code>j</code>th vector. Just build the whole 2D vector as something like <code>vector&lt; vector&lt;int&gt; &gt; G (i, vector&lt;int&gt; (j, 0));</code> \u2026"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521040005, "post_id": 49280565, "comment_id": 85564949, "body": "And you don&#39;t really need that initialization loop, all you need is <code>vector&lt;vector&lt;int&gt;&gt; G(V, vector&lt;int&gt;(V));</code> That defines <i>and</i> initializes all <code>int</code> elements to zero."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "edited": false, "score": 0, "creation_date": 1521040142, "post_id": 49280565, "comment_id": 85565055, "body": "OK, I got the wrong variable(s) for the size &gt;.&lt; thanks for pointing it out."}, {"owner": {"reputation": 114, "user_id": 8773953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c533838d2993d2d00b89814bae73ee72?s=128&d=identicon&r=PG&f=1", "display_name": "Tazik_S", "link": "https://stackoverflow.com/users/8773953/tazik-s"}, "edited": false, "score": 0, "creation_date": 1521040493, "post_id": 49280565, "comment_id": 85565304, "body": "Will Crawford, after replacing the loop with your suggested line, I&#39;m now getting a SIGABRT (3) message. Fortunately, the segmentation fault has been fixed, however."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521044284, "post_id": 49280565, "comment_id": 85568229, "body": "You should try replacing it with @some-programmer-dude&#39;s version, I messed up with the <code>i</code> and <code>j</code> in there. Put <code>V</code> for both. <code>abort</code> is most likely out-of-memory, and would make sense if <code>i</code> and <code>j</code> (uninitialised at that point) were used to size the allocations."}, {"owner": {"reputation": 114, "user_id": 8773953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c533838d2993d2d00b89814bae73ee72?s=128&d=identicon&r=PG&f=1", "display_name": "Tazik_S", "link": "https://stackoverflow.com/users/8773953/tazik-s"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521053343, "post_id": 49280565, "comment_id": 85573978, "body": "Even after updating my code with @Someprogrammerdude&#39;s recommendations, I&#39;m getting a segmentation fault (SIGSEGV). EDIT: I&#39;ve updated the original post with my current code for easy reference."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "edited": false, "score": 0, "creation_date": 1521395905, "post_id": 49280565, "comment_id": 85702103, "body": "Can you provide a link to the input data? And / or add some debugging statements :)"}, {"owner": {"reputation": 114, "user_id": 8773953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c533838d2993d2d00b89814bae73ee72?s=128&d=identicon&r=PG&f=1", "display_name": "Tazik_S", "link": "https://stackoverflow.com/users/8773953/tazik-s"}, "edited": false, "score": 0, "creation_date": 1521425032, "post_id": 49280565, "comment_id": 85709944, "body": "I managed to fix it using your suggestions. But it turns out that I had misinterpreted the problem, so I&#39;m now facing a different challenge, trying to determine how to work with vector &lt;vector &lt;pair &lt;int, int&gt; &gt; &gt;"}], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "is_accepted": true, "score": 1, "last_activity_date": 1521044694, "last_edit_date": 1521044694, "creation_date": 1521040092, "answer_id": 49281243, "question_id": 49280565, "link": "https://stackoverflow.com/questions/49280565/segfault-dijkstras-implementation/49281243#49281243", "title": "Segfault: Dijkstra&#39;s implementation", "body": "<p>In this bit of code:</p>\n\n<pre><code> G.resize(V);\n  for (i = 0; i &lt; V; ++i){\n    G[i].resize(V);\n    for (j = 0; j &lt; V; ++j){\n        G[i][j] = 0;\n        G[j][i] = 0;\n    }\n  } \n</code></pre>\n\n<p>you're assigning to <code>G[j][i]</code> before you've resized <code>G[j]</code>, so the elements don\u2019t exist yet.</p>\n\n<p>As I tried to suggest, and @some-programmer-dude suggested more accurately, you should just have:</p>\n\n<pre><code>vector&lt; vector&lt;int&gt; &gt; G( V, vector&lt;int&gt; (G, 0) );\n</code></pre>\n\n<p>I thought the <code>, 0</code> was needed, he doesn\u2019t, he\u2019s probably right :o)</p>\n\n<hr>\n\n<p>Just as a style issue, I'd suggest passing <code>V</code> into the <code>Dijkstra</code> function, or putting</p>\n\n<pre><code>const int V = G.size();\n</code></pre>\n\n<p>at the top, and use it instead of referring to <code>G.size()</code> everywhere.</p>\n"}], "owner": {"reputation": 114, "user_id": 8773953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c533838d2993d2d00b89814bae73ee72?s=128&d=identicon&r=PG&f=1", "display_name": "Tazik_S", "link": "https://stackoverflow.com/users/8773953/tazik-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 49281243, "answer_count": 1, "score": 0, "last_activity_date": 1521053428, "creation_date": 1521038338, "last_edit_date": 1521053428, "question_id": 49280565, "link": "https://stackoverflow.com/questions/49280565/segfault-dijkstras-implementation", "title": "Segfault: Dijkstra&#39;s implementation", "body": "<p>Can someone help me determine why I'm getting a segmentation fault? I think it has to do with the way I'm allocating memory for my 2D and 1D vectors in main, but I'm not sure what I'm doing wrong. Is it perhaps some behaviour of the resize function that I'm not accounting for?</p>\n\n<pre><code>#include &lt;queue&gt;\n#include &lt;vector&gt;\n#include &lt;deque&gt;\n#include &lt;limits&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nvoid Dijkstra(vector&lt;vector&lt;int&gt;&gt; &amp;G, int src) {\n  deque&lt;bool&gt; visited(G.size(), false);\n  vector&lt;int&gt; dist(G.size(),numeric_limits&lt;int&gt;::max());\n  queue&lt;int&gt; q;\n\n  dist[src] = 0;\n  q.emplace(src);\n  while (!q.empty()) {\n    int cur = q.front();\n    for(int i = 0; i&lt; G.size(); i++) {\n      if (!visited[i] &amp;&amp; G[cur][i]) {\n        q.emplace(i);\n        dist[i] = min(dist[i], G[cur][i] + dist[cur]);\n      }\n\n    }\n    visited[cur] = true;\n    q.pop();\n  }\n\n  for (int i = 0; i &lt; G.size(); i++){\n    if (dist[i] == numeric_limits&lt;int&gt;::max())\n    dist[i] = -1;\n    cout &lt;&lt; dist[i] &lt;&lt; \"\\n\";\n  }\n cout &lt;&lt; \"\\n\";\n}\n\n\n\n int main() {\n  int V, E, i , j, wt;\n  cin &gt;&gt; V &gt;&gt; E;\n  vector &lt;vector &lt;int&gt; &gt; G (V, vector &lt;int&gt; (V));\n\n\n for (int k = 0; k &lt; E; ++k){ \n      cin &gt;&gt; i &gt;&gt; j &gt;&gt; wt;\n      G[i][j] = wt;\n      G[j][i] = wt; \n  }  \n\n Dijkstra(G, 0);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1521039179, "post_id": 49280558, "comment_id": 85564305, "body": "<code>array</code> is an <code>int *</code>, so <code>array[I][j]</code> is incorrect."}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 1, "creation_date": 1521039179, "post_id": 49280558, "comment_id": 85564306, "body": "<code>int * array = new int[row*col]</code>; This is one dimensional array. You need to work with it using one dimension in all cases, like <code>array[i*row + j]</code> or something like this. Two dimensional array should be declared as <code>int**</code>. Or better, use std::vector."}, {"owner": {"reputation": 385, "user_id": 5707687, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-A7dMMtmvsI4/AAAAAAAAAAI/AAAAAAAAAG4/OFAaXD84QPo/photo.jpg?sz=128", "display_name": "Rami Far", "link": "https://stackoverflow.com/users/5707687/rami-far"}, "reply_to_user": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1521041156, "post_id": 49280558, "comment_id": 85565794, "body": "thank you very much @AlexF it worked"}], "owner": {"reputation": 385, "user_id": 5707687, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-A7dMMtmvsI4/AAAAAAAAAAI/AAAAAAAAAG4/OFAaXD84QPo/photo.jpg?sz=128", "display_name": "Rami Far", "link": "https://stackoverflow.com/users/5707687/rami-far"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521038320, "creation_date": 1521038320, "question_id": 49280558, "link": "https://stackoverflow.com/questions/49280558/expression-must-have-pointer-to-object-type-error-in-mpi-send", "title": "Expression must have pointer to object type error in MPI send", "body": "<p>I got syntax error in <code>MPI send</code> command. I wanted to send some rows and respective columns with it. I have got error in this line <code>MPI_Send(&amp;(array[ch_row][ch_col]), ch_size*col, MPI_INT, p, 1, MPI_COMM_WORLD)</code> at <code>ch_col</code>. I can't understand why I and getting this error.</p>\n\n<pre><code> int tot_processes;\n        int process_id;\n        MPI_Comm_size(MPI_COMM_WORLD, &amp;tot_processes);\n        MPI_Comm_rank(MPI_COMM_WORLD, &amp;process_id);\n        if (process_id == 0) {\n            int row, col;\n            cout &lt;&lt; \"Enter rows and columns: \";\n            cin &gt;&gt; row &gt;&gt; col;\n            int *array = new int[row*col];\n            for (int i = 0; i &lt; row; i++) {\n                for (int j = 0; j &lt; col; j++) {\n                    array[i][j] = 1;\n                }\n            }\n            int ch_size = row / tot_processes;\n            for (int p = 1; p &lt; tot_processes; p++) {\n                int ch_row = ch_size * (p - 1);\n                int ch_col = ch_size * col;\n                MPI_Send(&amp;ch_size, 1, MPI_INT, p, 0, MPI_COMM_WORLD);\n                MPI_Send(&amp;(array[ch_row][ch_col]), ch_size*col, MPI_INT, p, 1, MPI_COMM_WORLD);\n            }\n        }\n</code></pre>\n"}, {"tags": ["c++", "linked-list"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1521040538, "post_id": 49280477, "comment_id": 85565331, "body": "If this is <code>c++11</code>, then use <code>nullptr</code>, not <code>NULL</code>. But then you could just use <code>std::list</code>, instead of rolling your own... though I won&#39;t deny the exercise. :P Either way, <code>ALL CAPS</code> for anything except <code>#define</code>s and macro names is very bad style IMO."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1521051294, "post_id": 49280477, "comment_id": 85572868, "body": "@underscore_d: Nothing about this question is particular to C++11... I changed its tags."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9492478, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/137758993ffaab0b008ad2f8c4db86f3?s=128&d=identicon&r=PG", "display_name": "rrrkk", "link": "https://stackoverflow.com/users/9492478/rrrkk"}, "is_accepted": false, "score": 0, "last_activity_date": 1521302498, "last_edit_date": 1521302498, "creation_date": 1521041355, "answer_id": 49281733, "question_id": 49280477, "link": "https://stackoverflow.com/questions/49280477/list-not-printing-all-the-elements/49281733#49281733", "title": "List not printing all the Elements", "body": "<p>You havae a bug with your List::Prepand() method. The \"Current->next = nullptr;\"\nline is not needed within \"else\" block.</p>\n\n<pre><code>void List::Prepend(int data_val) {\n    NODE* Current = new NODE;\n    Current-&gt;data = data_val;\n    if (HEAD == NULL) {\n        Current-&gt;next = nullptr;\n        HEAD = TAIL = Current;\n    }\n    else {\n        Current-&gt;next = HEAD;\n        HEAD = Current;\n        Current-&gt;next = nullptr;  // &lt;---- remove this line\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7195057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2e5fc877737975bc8480fedcbd0b66?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Okpala", "link": "https://stackoverflow.com/users/7195057/richard-okpala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521302498, "creation_date": 1521038095, "last_edit_date": 1521051275, "question_id": 49280477, "link": "https://stackoverflow.com/questions/49280477/list-not-printing-all-the-elements", "title": "List not printing all the Elements", "body": "<p>So basically I created a linked list with the append and prepend functions and when I print the list it is only printing out 12 which I prepended to front of the list and not the other elements, how do I fix this issue? so that all the elements will be printed. I think that my append and prepend functions are correct but I do not know what could be wrong.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"List.h\"\n\nusing namespace std;\n\nint main() {\n    List* list = new List();\n    list-&gt;Append(1);\n    list-&gt;Append(2423);\n    list-&gt;Prepend(12);\n    list-&gt;print();\n    system(\"pause\");\n    return 0;\n}\n\n#include&lt;iostream&gt;\n#include \"List.h\"\n\nusing namespace std;\n\nList::List() {\n    this-&gt;HEAD = NULL;\n    this-&gt;TAIL=NULL;\n}\nvoid List::Append(int Data_val) {\n    NODE* Current = new NODE;\n    Current-&gt;data = Data_val;\n\n    if (HEAD == NULL) {\n\n        HEAD = Current;\n        TAIL = Current;\n        Current-&gt;next = nullptr;\n    }\n    else {\n        TAIL-&gt;next= Current;\n        TAIL = Current;\n        Current-&gt;next = nullptr;\n    }\n}\nvoid List::Prepend(int data_val) {\n    NODE* Current = new NODE;\n    Current-&gt;data = data_val;\n    if (HEAD = NULL) {\n        Current-&gt;next = nullptr;\n        HEAD = Current;\n        TAIL = Current;\n\n    }\n    else {\n        Current-&gt;next = HEAD;\n        HEAD = Current;\n        Current-&gt;next = nullptr;\n\n    }\n}\nvoid List::print() {\n    NODE* Current = HEAD;\n    while (Current != NULL) {\n        cout &lt;&lt; Current-&gt;data &lt;&lt; endl;\n        Current=Current-&gt;next;\n    }\n}\n\n\n#ifndef LIST_H\n#define LIST_H\n\nstruct NODE {\n    int data;\n    NODE* next;\n};\nclass List\n{\n    public:\n        List();\n        void Append(int data_val);\n        void Prepend(int data_val);\n        //create prepend\n        //create insertafter\n        //create delte\n        void print();\n    private:\n        //\n        NODE * HEAD;\n        NODE* TAIL;\n};\n#endif\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1521038235, "post_id": 49280476, "comment_id": 85563552, "body": "It seems to me like a <code>unsigned char RabbitObject[sizeof(Rabbit)];</code> would have the same size as <code>Rabbit</code>. I&#39;m not clear on why you feel the arrays &quot;make no sense&quot;."}, {"owner": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1521038519, "post_id": 49280476, "comment_id": 85563769, "body": "I simply don&#39;t get it. I need the max size of all objects, so to me it&#39;s logic to create an union with one instance of each object inside, then take &quot;sizeof(union)&quot; in order to get the max. Why would I need array of unsigned char of sizeof(class)?"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1521038609, "post_id": 49280476, "comment_id": 85563833, "body": "If you can use c++17 it might be clearer to go back to a <code>constexpr</code> version of your first implementation.  Something like <code>constexpr std::array&lt;std::size_t, 4&gt; sizes = {{sizeof(Rabbit), sizeof(Horse), ...}}; constexpr std::size_t maxSize = std::max_element(std::begin(sizes), std::end(sizes));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521038626, "post_id": 49280554, "comment_id": 85563850, "body": "which assumption? about the union? Correct me please, I really want to understand this, even if it&#39;s a simple thingy."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521038730, "post_id": 49280554, "comment_id": 85563941, "body": "@lukuss, yes. An assumption that union size is equal to the size of the latest element is incorrect."}, {"owner": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521038935, "post_id": 49280554, "comment_id": 85564104, "body": "latest? No, greater. I meant, that if I have an union with and &quot;unsigned char&quot; and an &quot;int&quot; - size of union it would be the int size. right?"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1521039574, "post_id": 49280554, "comment_id": 85564615, "body": "improvement: <code>template &lt;typename... Ts&gt; struct max_size : std::integral_constant&lt;size_t, std::max({sizeof(Ts)...})&gt;</code>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1521039739, "post_id": 49280554, "comment_id": 85564724, "body": "@Caleth, good point. Always forget about initializer list version of it. Will add."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1521129783, "post_id": 49280554, "comment_id": 85610250, "body": "Just curious, why do you think that using <code>sizeof()</code> on the various types and getting the maximum is any different of a result than the <code>union</code> approach? Admittedly the <code>union</code> approach is a C style tactic."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1521130408, "post_id": 49280554, "comment_id": 85610692, "body": "@RichardChambers Because union is not guaranteed to give you exact size."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1521131460, "post_id": 49280554, "comment_id": 85611362, "body": "What do you mean by &quot;exact size&quot;?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1521134940, "post_id": 49280554, "comment_id": 85613645, "body": "@RichardChambers those words have a defined meaning. Exact size means exact size of the largest class. Union is only going to give you the size sufficient to hold the largest class, which is not the same thing"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1521138243, "post_id": 49280554, "comment_id": 85615544, "body": "What is your interpretation of the following. &quot;The size of a union is sufficient to contain the largest of its non-static data members. <b>Each non-static data member is allocated as if it were the sole member of a struct.</b> All non-static data members of a union object have the same address.&quot; Does this mean that the size of a <code>union</code> is the size of the largest member of the  union? (section 9.5 of the standard)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1521138530, "post_id": 49280554, "comment_id": 85615681, "body": "@RichardChambers, I do not see how it could mean that. The fact that each non-static member is allocated as if... tells us <b>nothing</b> about the size of the union."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "edited": false, "score": 0, "creation_date": 1521308682, "post_id": 49280554, "comment_id": 85680097, "body": "You might have one member that\u2019s, say, 64 bits in size, and needs 64 bit <b><i>alignment</i></b>, and another, say 72 bits in size, that only needs 16 bit alignment, but the union size then needs to be rounded up to 128 bits to satisfy the alignment requirement of the 64-bit-sized member."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 6, "last_activity_date": 1521039914, "last_edit_date": 1521039914, "creation_date": 1521038301, "answer_id": 49280554, "question_id": 49280476, "link": "https://stackoverflow.com/questions/49280476/how-does-an-union-determine-max-size-from-a-list-of-objects/49280554#49280554", "title": "How does an union determine max size from a list of objects?", "body": "<p>The assumptions are incorrect, and the question is moot. Standard does not require the union size to be equal of the size of the largest member. Instead, it requires union size to be <strong>sufficient</strong> to hold the largest member, which is not the same at all. Both solutions are flawed is size of the largest class needs to be known exactly.</p>\n\n<p>Instead, something like that should be used:</p>\n\n<pre><code>template&lt;class L, class Y, class... T&gt; struct max_size\n        : std::integral_constant&lt;size_t, std::max(sizeof (L), max_size&lt;Y, T...&gt;::value)&gt; { };\ntemplate&lt;class L, class Y&gt; struct max_size&lt;L, Y&gt;\n        : std::integral_constant&lt;size_t, std::max(sizeof (L), sizeof (Y))&gt; { };\n</code></pre>\n\n<p>As @Caleth suggested below, it could be shortened using initializer list version of <code>std::max</code> (and template variables):</p>\n\n<pre><code>template&lt;class... Ts&gt;\nconstexpr size_t max_size_v = std::max({sizeof(Ts)...});\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1521038787, "post_id": 49280689, "comment_id": 85563987, "body": "Both union approaches are wrong. Union has no obligation to has it&#39;s size equal to the largest element."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521038820, "post_id": 49280689, "comment_id": 85564017, "body": "@SergeyA I know that.  I&#39;m explaining why the superior said what they did"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521038906, "post_id": 49280689, "comment_id": 85564081, "body": "But it was a mistake anyways. Both approaches (array and no array) yield the same (as long as Standard value is concerned) result - a size <b>sufficient</b> to hold the largest member, but not necessarily exactly equal."}, {"owner": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521039320, "post_id": 49280689, "comment_id": 85564412, "body": "@NathanOliver The superior(architect) suggested the union(not the array, the array was my solution), so I cannot do anything about it. I just wanted to understand why my union was wrong and his was right. And now I see that both are wrong."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521039433, "post_id": 49280689, "comment_id": 85564485, "body": "@lukuss That&#39;s sad.  Try to talk them out of it if you can as they are relying on behavior that could change in the future."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521309442, "post_id": 49280689, "comment_id": 85680375, "body": "@SergeyA Nathan\u2019s answered the question (correctly), why are you waling on him? :o)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 0, "last_activity_date": 1521038950, "last_edit_date": 1521038950, "creation_date": 1521038686, "answer_id": 49280689, "question_id": 49280476, "link": "https://stackoverflow.com/questions/49280476/how-does-an-union-determine-max-size-from-a-list-of-objects/49280689#49280689", "title": "How does an union determine max size from a list of objects?", "body": "<p>You superior suggested you use the array version because a union could have padding.  For instance if you have</p>\n\n<pre><code>union padding {\n    char arr[sizeof (double) + 1];\n    double d;\n};\n</code></pre>\n\n<p>The this could either be of size <code>sizeof(double) + 1</code> or it could be <code>sizeof (double) * 2</code> as the union could be padded to keep it aligned for <code>double</code>'s (<a href=\"http://coliru.stacked-crooked.com/a/0b6b2fa57448bbbd\" rel=\"nofollow noreferrer\">Live example</a>).</p>\n\n<p>However if you have</p>\n\n<pre><code>union padding {\n    char arr[sizeof(double) + 1];\n    char d[sizeof(double)];\n};\n</code></pre>\n\n<p>The the union need not be double aligned and the union most likely has a size of <code>sizeof(double) + 1</code> (<a href=\"http://coliru.stacked-crooked.com/a/9e87023fa56a840c\" rel=\"nofollow noreferrer\">Live example</a>).  This is not guanrteed though and the size can be greater than it's largest element.</p>\n\n<p>If you want for sure to have largest size I would suggest using</p>\n\n<pre><code>auto max_size = std::max({sizeof(Rabbit), sizeof(Horse), sizeof(Mouse), sizeof(Pony)});\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521185192, "post_id": 49280916, "comment_id": 85631781, "body": "The classes are empty now. But what if the classes will have methods and attributes?(They will sure do). What if we have specific constructors inside classes? Does my first method still stands? (this is one of the reasons my superior recommended the second union)"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521200890, "post_id": 49280916, "comment_id": 85640924, "body": "@lukuss see the following postings and discussions: <a href=\"https://stackoverflow.com/questions/422830/structure-of-a-c-object-in-memory-vs-a-struct\">Structure of a C++ Object in Memory Vs a Struct</a>, [What does an object look like in memory? duplicate ](<a href=\"https://stackoverflow.com/questions/12378271/what-does-an-object-look-like-in-memory\" title=\"what does an object look like in memory\">stackoverflow.com/questions/12378271/&hellip;</a>), <a href=\"https://stackoverflow.com/questions/1632600/memory-layout-c-objects\">memory layout C++ objects closed</a> as well as <a href=\"https://www.youtube.com/watch?v=e0DsVqZLMzU\" rel=\"nofollow noreferrer\">The memory model in C++ - Rainer Grimm - Meeting C++ 2016 video 54 mins</a>."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "edited": false, "score": 0, "creation_date": 1521202224, "post_id": 49280916, "comment_id": 85641735, "body": "@lukuss I really don&#39;t see any benefit to the array version because <code>sizeof()</code> will provide the same size as the <code>class</code> in the union. Class methods are not part of the class memory allocation though the vtable, created if virtual functions, is. The basic rule of thumb is invariant parts of a class such as methods are not part of the <code>class</code> memory allocation while variant parts of a class such as data and object specific management data such as vtable is part of the <code>class</code> memory allocation used to instantiate an object of that class."}, {"owner": {"reputation": 244, "user_id": 5347283, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uHWX26Md2lU/AAAAAAAAAAI/AAAAAAAAAEw/U8_A4Jaedlc/photo.jpg?sz=128", "display_name": "Will Crawford", "link": "https://stackoverflow.com/users/5347283/will-crawford"}, "edited": false, "score": 0, "creation_date": 1521309097, "post_id": 49280916, "comment_id": 85680253, "body": "The alignment is the maximum of what\u2019s most useful for each member, for the architecture (ABI, really) being compiled for. Padding may appear anywhere <i>but</i> the beginning (because inherited C behaviour means that in a <code>struct</code> you can cast a pointer to the struct, to one to its first member; it&#39;s one way inheritance is done \u201cby hand\u201d in C)."}], "tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": true, "score": 0, "last_activity_date": 1521201737, "last_edit_date": 1521201737, "creation_date": 1521039276, "answer_id": 49280916, "question_id": 49280476, "link": "https://stackoverflow.com/questions/49280476/how-does-an-union-determine-max-size-from-a-list-of-objects/49280916#49280916", "title": "How does an union determine max size from a list of objects?", "body": "<p>The two approaches provide a way to find a maximum size that all of the objects of the union will fit within. I would prefer the first as it is clearer as to what is being done and the second provides nothing that the first does not for your needs.</p>\n\n<p>And the first, a union composed of the various classes, offers the ability to access a specific member of the union as well.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/9254605/is-a-structs-address-the-same-as-its-first-members-address\">Is a struct's address the same as its first member's address?\n</a> as well as <a href=\"https://stackoverflow.com/questions/740577/sizeof-a-union-in-c-c\">sizeof a union in C/C++\n</a> and <a href=\"https://stackoverflow.com/questions/25542390/anonymous-union-and-struct\">Anonymous union and struct [duplicate]\n</a>.</p>\n\n<p>For some discussions on memory layout of classes see the following postings:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/422830/structure-of-a-c-object-in-memory-vs-a-struct\">Structure of a C++ Object in Memory Vs a Struct</a></li>\n<li><a href=\"https://stackoverflow.com/questions/26939609/how-is-the-memory-layout-of-a-class-vs-a-struct\">How is the memory layout of a class vs. a struct</a></li>\n<li><a href=\"https://stackoverflow.com/questions/1632600/memory-layout-c-objects\">memory layout C++ objects [closed]</a></li>\n<li><a href=\"https://stackoverflow.com/questions/6881172/c-class-memory-model-and-alignment\">C++ Class Memory Model And Alignment</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12378271/what-does-an-object-look-like-in-memory\">What does an object look like in memory? [duplicate]</a></li>\n<li><a href=\"https://stackoverflow.com/questions/6319146/c11-introduced-a-standardized-memory-model-what-does-it-mean-and-how-is-it-g?rq=1\">C++11 introduced a standardized memory model. What does it mean? And how is it going to affect C++ programming?</a></li>\n</ul>\n\n<p>Since the compiler is free to add to the sizes of the various components in order to align variables on particular memory address boundaries, the size of the union may be larger than the actual size of the data. Some compilers offer a pragma or other type of directive to instruct the compiler as to whether packing of the class, struct, or union members should be done or not.</p>\n\n<p>The size as reported by <code>sizeof()</code> will be the size of the variable or type specified however again this may include additional unused memory area to pad the variable to the next desirable memory address alignment. See <a href=\"https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member\">Why isn't sizeof for a struct equal to the sum of sizeof of each member?</a>.</p>\n\n<p>Typically a class, struct, or union is sized so that if an array of the type is created then each element of the array will begin on the most useful memory alignment such as a double word memory alignment for an Intel x86 architecture. This padding is typically on the end of the variable.</p>\n"}], "owner": {"reputation": 128, "user_id": 9092777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yzSIr.jpg?s=128&g=1", "display_name": "lukuss", "link": "https://stackoverflow.com/users/9092777/lukuss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 49280916, "answer_count": 3, "score": 1, "last_activity_date": 1521201737, "creation_date": 1521038094, "question_id": 49280476, "link": "https://stackoverflow.com/questions/49280476/how-does-an-union-determine-max-size-from-a-list-of-objects", "title": "How does an union determine max size from a list of objects?", "body": "<p>I am not sure the question is well put, because I understood how, but I don't know to write the questions with the thing I don't understand. Here it is:</p>\n\n<p>I have some classes:</p>\n\n<pre><code>class Animal{};\nclass Rabbit{}: public Animal;\nclass Horse{}: public Animal;\nclass Mouse{}: public Animal;\nclass Pony{}: public Horse;\n</code></pre>\n\n<p>My goal was to find the maximum size from this object list in order to use it in memory allocation afterwards. I've stored each <code>sizeof</code> of the object in an array then took the max of the array. The superior(to whom I send the code for review) suggested me to use an union in order to find maximum size <strong>at pre-compilation</strong> time. The idea seemed very nice to me so I've did it like this:</p>\n\n<pre><code>typedef union\n{\n  Rabbit rabbitObject;\n  Horse horseObject;\n  Mouse mouseObject;\n  Pony ponyObject;\n} Size;\n</code></pre>\n\n<p>... because an union allocates memory according to the greatest-in-size element.\nThe next suggestion was to do it like this:</p>\n\n<pre><code>typedef union\n{\n   unsigned char RabbitObject[sizeof(Rabbit)];\n   unsigned char HorseObject[sizeof(Horse)];\n   unsigned char MouseObject[sizeof(Mouse)];\n   unsigned char PonyObject[sizeof(Pony)];\n} Interesting;\n</code></pre>\n\n<p>My question is:</p>\n\n<p>How does <code>Interesting</code> union get the maximum size of object? To me, it makes no sense to create an array of type unsigned char, of length <code>sizeof(class)</code> inside it. Why the second option would solve the problem and previous union it doesn't? \nWhat's happening behind and I miss?</p>\n\n<p>PS: The conditions are in that way that I cannot ask the guy personally.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["java", "c++", "intellij-idea"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1521037266, "post_id": 49280100, "comment_id": 85562897, "body": "Have you tried doing it?"}, {"owner": {"reputation": 1447, "user_id": 6020034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/20fc6f63f649759b7b7c10ca5e7adef0?s=128&d=identicon&r=PG&f=1", "display_name": "mdo123", "link": "https://stackoverflow.com/users/6020034/mdo123"}, "edited": false, "score": 0, "creation_date": 1521038003, "post_id": 49280100, "comment_id": 85563398, "body": "Have you seen <a href=\"https://stackoverflow.com/questions/7593334/how-to-call-c-from-java\" title=\"how to call c from java\">stackoverflow.com/questions/7593334/how-to-call-c-from-java</a>. ?"}, {"owner": {"reputation": 194, "user_id": 7373646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4364c13b64f23ad0e1d2c02a64bf3d?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/7373646/filippo"}, "edited": false, "score": 0, "creation_date": 1521038502, "post_id": 49280100, "comment_id": 85563758, "body": "I&#39;ve just done it one time in Android Studio that is at least the same of Intellij IDEA but Android Studio automatically creates the java method and the cpp file. I don&#39;t know the folder where i&#39;ve to put the cpp file and then call System.loadLibrary(&quot;&quot;)"}, {"owner": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 1, "creation_date": 1521045953, "post_id": 49280100, "comment_id": 85569351, "body": "IntelliJ IDEA does not have any support for C++. You can edit .cpp files as plain text, but that&#39;s it - you won&#39;t get any additional assistance."}, {"owner": {"reputation": 194, "user_id": 7373646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4364c13b64f23ad0e1d2c02a64bf3d?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/7373646/filippo"}, "reply_to_user": {"reputation": 79983, "user_id": 147024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35432f97606c0a31da17084d2414966?s=128&d=identicon&r=PG", "display_name": "yole", "link": "https://stackoverflow.com/users/147024/yole"}, "edited": false, "score": 0, "creation_date": 1521058035, "post_id": 49280100, "comment_id": 85576561, "body": "Where i&#39;ve to place the .cpp? @yole"}], "owner": {"reputation": 194, "user_id": 7373646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4364c13b64f23ad0e1d2c02a64bf3d?s=128&d=identicon&r=PG&f=1", "display_name": "Filippo", "link": "https://stackoverflow.com/users/7373646/filippo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560933493, "creation_date": 1521037157, "question_id": 49280100, "link": "https://stackoverflow.com/questions/49280100/how-can-i-create-a-native-method-and-his-implementation-cpp-file-in-intellij-id", "title": "How can i create a native method and his implementation .cpp file in Intellij IDEA?", "body": "<p>I need to use some c++ things in a java project, can i do it?</p>\n\n<pre><code>public static void main(String[] args) {\n    System.out.println(getCpuTemp());\n}\n\nprivate static native int getCpuTemp();\n</code></pre>\n"}, {"tags": ["c++", "3d", "physx"], "owner": {"reputation": 124, "user_id": 4489874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7ff12c1e5b21099a15aa6c6774ee19?s=128&d=identicon&r=PG&f=1", "display_name": "Zyie", "link": "https://stackoverflow.com/users/4489874/zyie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1526555646, "creation_date": 1521036928, "last_edit_date": 1526555646, "question_id": 49280019, "link": "https://stackoverflow.com/questions/49280019/issue-creating-triangle-mesh-in-physx", "title": "Issue creating triangle mesh in PhysX", "body": "<p>I've constructed a quick python script that reads a wavefront .obj file and outputs the verticies and faces to files. I have another C++ function that reads these files and creates a mesh based of-of those.</p>\n\n<p>The issue that I'm experiencing is that this works perfectly sometimes, and other time not so much - with the same mesh. E.g. I start my PhysX program, and create 10 of the same objects of the same mesh and some of them look like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3mxES.png\" alt=\"Normal Mesh\"></p>\n\n<p>and others look like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/FIaRg.png\" alt=\"Broken Mesh\"></p>\n\n<p>The following C++ is the code that loads the verticies and triangles:</p>\n\n<pre><code>bool ModelLoader::LoadVertexFile(const std::string&amp; fileLocation)\n{\n    std::ifstream file(fileLocation);\n    if (!file) {\n        std::cerr &lt;&lt; \"Failed to load vertex data\\n\";\n        return false;\n    }\n\n    float x, y, z;\n    vertexArray.clear();\n\n    while (file &gt;&gt; x &gt;&gt; y &gt;&gt; z)\n    {\n        vertexArray.push_back(PhysicsEngine::PxVec3(x, y, z));\n    }\n    return true;\n}\n\nbool ModelLoader::LoadTrianglesFile(const std::string&amp; fileLocation)\n{\n    std::ifstream file(fileLocation);\n    if (!file) {\n        std::cerr &lt;&lt; \"Failed to load vertex data\\n\";\n        return false;\n    }\n\n    int x;\n    triangleArray.clear();\n    while (file &gt;&gt; x)\n    {\n        triangleArray.push_back(x);\n    }\n    return true;\n}\n</code></pre>\n\n<p>This is the code for creating constructing the mesh </p>\n\n<pre><code>   CustomObject(const PxTransform&amp; pose = PxTransform(PxIdentity), string vertfile = \"\", string trigfile = \"\") :\n        StaticActor(pose)\n    {\n\n        modelLoader = new ModelLoader();\n        if(!modelLoader-&gt;LoadVertexFile(vertfile))\n            throw new Exception(\"Failed to load VertexFile.\");\n        if(!modelLoader-&gt;LoadTrianglesFile(trigfile))\n            throw new Exception(\"Failed to load TrianglesFile.\");\n\n        PxTriangleMeshDesc mesh_desc;\n        mesh_desc.points.count = (PxU32)modelLoader-&gt;vertexArray.size();\n        mesh_desc.points.stride = sizeof(PxVec3);\n        mesh_desc.points.data = &amp;modelLoader-&gt;vertexArray.front();\n        mesh_desc.triangles.count = (PxU32)modelLoader-&gt;triangleArray.size();\n        mesh_desc.triangles.stride = 3 * sizeof(PxU32);\n        mesh_desc.triangles.data = &amp;modelLoader-&gt;triangleArray.front();\n\n        CreateShape(PxTriangleMeshGeometry(CookMesh(mesh_desc)));\n    }\n</code></pre>\n\n<p>So if anyone can help me figure out whats going wrong it would be really appreciated</p>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 5, "creation_date": 1521036994, "post_id": 49280002, "comment_id": 85562733, "body": "C# background?  I&#39;m asking because C++ doesn&#39;t define anything called &quot;a property&quot;.  It may help to clarify what you&#39;re trying to do."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1521037032, "post_id": 49280002, "comment_id": 85562758, "body": "And please give the complete error messages(s)."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1521037098, "post_id": 49280002, "comment_id": 85562801, "body": "I&#39;m pretty sure this has nothing to do with templates or the STL."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 4, "creation_date": 1521037099, "post_id": 49280002, "comment_id": 85562803, "body": "The STL is completely innocent here, I&#39;m not sure what you&#39;re ranting about."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1521037182, "post_id": 49280002, "comment_id": 85562854, "body": "Take everything you learned about C# and then forget it if you want to learn C++."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 2, "creation_date": 1521037290, "post_id": 49280002, "comment_id": 85562914, "body": "Your boss should have been able to answer this question simply. Unless he gave you reasons for not asking, I&#39;d say next time ask your boss about it instead of asking us :-)"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1521037609, "post_id": 49280002, "comment_id": 85563110, "body": "You&#39;re essentially missing a big chunk of C++ knowledge, among which &quot;how to declare types&quot;. This whole question is just pointing fingers at random features that have nothing to do with the missing <code>#include</code> or declaration. Hence, VTC as &quot;unlikely to help future readers&quot;. In your defense, MSVC&#39;s error message in this situation is incredibly unhelpful."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1521038020, "post_id": 49280002, "comment_id": 85563412, "body": "Also, how is this any different from <a href=\"https://stackoverflow.com/a/49030353/3233393\">this other Q&amp;A of yours</a>?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1521062548, "post_id": 49280002, "comment_id": 85578727, "body": "&quot;compiler errors C3646 and C4430&quot; doesn&#39;t mean very much to anyone who&#39;s not using the same compiler as you.  What&#39;s the exact (English) error message?"}], "answers": [{"comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1521037464, "post_id": 49280118, "comment_id": 85563023, "body": "The <code>#include &quot;Timer.h&quot;</code> is not allowed because of circular references (although we don&#39;t find where that circular reference is: I&#39;ve tried to upgrade my visual studio in order to have a graphical display of inclusions, but this caused my whole Visual Studio environment not to work anymore)."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 1, "creation_date": 1521037649, "post_id": 49280118, "comment_id": 85563143, "body": "That is a whole other question. On any large-scale project I&#39;ve seen there was a facility for generating the inclusion tree. When a cycle is introduced (or attempted), you look up the tree and you use a clue bat where appropriate. In this case, it smells like Timer.h is inculding too much stuff. Because aggregating a Timer smells reasonable."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1521039123, "post_id": 49280118, "comment_id": 85564261, "body": "But using a shared pointer is unlikely to be the best choice."}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": true, "score": 2, "last_activity_date": 1521037203, "creation_date": 1521037203, "answer_id": 49280118, "question_id": 49280002, "link": "https://stackoverflow.com/questions/49280002/how-to-add-a-property-to-a-class/49280118#49280118", "title": "How to add a property to a class", "body": "<p>If you want to aggregate a <code>Timer</code> into your class defintion, the compiler needs to know what a <code>Timer</code> is. So, you could use <code>#include \"Timer.h\"</code>(use the right header).</p>\n\n<p>What your boss did is two-fold</p>\n\n<ol>\n<li>use a pointer instead of a member object. Thus allowing it to work\nwith a forward declaration instead of an include.  </li>\n<li>use a smart\npointer instead of a raw pointer. This is good practice.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1521038645, "post_id": 49280172, "comment_id": 85563863, "body": "I do not understand the downvote"}], "tags": [], "owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "is_accepted": false, "score": 0, "last_activity_date": 1521038209, "last_edit_date": 1521038209, "creation_date": 1521037359, "answer_id": 49280172, "question_id": 49280002, "link": "https://stackoverflow.com/questions/49280002/how-to-add-a-property-to-a-class/49280172#49280172", "title": "How to add a property to a class", "body": "<p>This has nothing to do with template and STL.</p>\n\n<p>You should look at what <strong>forward declaration</strong> is:</p>\n\n<p>What your boss did with that </p>\n\n<pre><code>class Timer;\n</code></pre>\n\n<p>is to say to the compiler \"hey look, there's something called Timer which you don't know yet, trust me and reserve for that some space\".</p>\n\n<p>Compiler answer ok, but it has to know how much space to allocate for costructing that object. Since you use an object and do not include the header file containing it, compiler doesn't know much space it takes and gives you an error. If you use a pointer instead (or smart pointer), the compiler does need to reserve only the space for a pointer and it can do it. Of coure then you have to include the header of time if you want to use it in the implementation.</p>\n\n<p>For the same reason, you cannot forward declare a class you're going to inherit.</p>\n\n<p>timer.h</p>\n\n<pre><code>class Timer\n{\npublic:\n   void time() { std::cout &lt;&lt; \"time!\"; }\n}\n</code></pre>\n\n<p>yourclass.h</p>\n\n<pre><code>class Timer; // forward declaration\n\nclass Manager\n{\npublic:\n  void doStuff() {}\n\nprivate:\n Timer* t1; // this will work\n std::shared_pointer&lt;Timer&gt; t2; // this will work\n //Timer t3;  // this one don't\n}\n</code></pre>\n\n<p>}</p>\n\n<p>this case <strong>does not work</strong>:</p>\n\n<pre><code>class Timer;\n\nclass SpecialTimer : public Timer\n{\n // ... do stuff\n}\n</code></pre>\n\n<p>Some link about forward declaration:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Forward_declaration\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Forward_declaration</a></p>\n\n<p><a href=\"https://stackoverflow.com/a/4757718/8805095\">This Post</a> has a good explanation.</p>\n"}], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1521062565, "accepted_answer_id": 49280118, "answer_count": 2, "score": -3, "last_activity_date": 1521038209, "creation_date": 1521036875, "question_id": 49280002, "link": "https://stackoverflow.com/questions/49280002/how-to-add-a-property-to-a-class", "closed_reason": "Not suitable for this site", "title": "How to add a property to a class", "body": "<p>I'm working on a new application, based on templates, STL, namespaces, ... (my collegues have taken all necessary steps to make a mess), now I just want to add a property to a class, and this does not work, let me show you):</p>\n\n<p>Within a header-file:</p>\n\n<pre><code>namespace utils{\n\nclass Logging_Manager : public Singleton&lt;Logging_Manager&gt; {\n    friend Singleton&lt;Logging_Manager&gt;;\n\n    Logging_Manager();\n\nprivate:\n    std::vector&lt;std::shared_ptr&lt;Single_Logger&gt;&gt; logging_modules;\n    LogLevelType loglevel; // 0 : no logging, 1 : info logging, (2-4 are not used), 5 : debug, 6 : everything\npublic:\n    Timer getDebuggerTimer;\n    Timer getFileTimer;\n</code></pre>\n\n<p>I've just added the last entries <code>getDebuggerTimer</code> and <code>getFileTimer</code> myself and this does not compile, due to the compiler errors C3646 and C4430.</p>\n\n<p>All I mean is that both are properties of the type <code>Timer</code>, I don't mean those things to be templates of some methods which might be abstract, virtual, or whatsoever, no they are just to meant as properties, nothing more nothing less.</p>\n\n<p>As I didn't find a way to add both timers to my header file, my boss has just solved the issue as follows:</p>\n\n<pre><code>class Timer;    // this class is defined elsewhere, how can it be put here and make things work?\nnamespace utils{\n\nclass Logging_Manager : public Singleton&lt;Logging_Manager&gt; {\n    friend Singleton&lt;Logging_Manager&gt;;\n\n    Logging_Manager();\n\nprivate:\n    std::shared_ptr&lt;Timer&gt; getDebuggerTimer;\n    std::shared_ptr&lt;Timer&gt; getFileTimer;\n</code></pre>\n\n<p>In other words: he did not add an inclusion, but he added a reference to something the header does not know: <code>class Timer</code>.</p>\n\n<p>In top of this, he added a shared pointer, which magically did something.</p>\n\n<p>I'm completely lost here: it looks like STL has added programming rules like:<br/>\n- In case you want something to work, don't add an inclusion, but add a reference (but how does your code know what the reference means?)\n- You can add shared pointers (or other STL inventions), who will make your code work.</p>\n\n<p>?????</p>\n\n<p>Can anybody shed a light to this?</p>\n"}, {"tags": ["c++", "windows", "xaudio2"], "answers": [{"comments": [{"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1603666960, "post_id": 49292153, "comment_id": 114101707, "body": "So does that mean that a different thread is assigned to play a sound for each source voice?"}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 1, "creation_date": 1603681856, "post_id": 49292153, "comment_id": 114104127, "body": "No. There&#39;s one audio thread that does the &#39;mixing&#39;. It takes input from all active source voices and processes the &#39;audiograph&#39;. The mastering voice submits the single audio stream to WASAPI for output. See <a href=\"https://docs.microsoft.com/en-us/windows/win32/xaudio2/xaudio2-audio-graph\" rel=\"nofollow noreferrer\">Microsoft Docs</a>"}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1603798563, "post_id": 49292153, "comment_id": 114144712, "body": "Thank you. It works a little bit differently compared to other code, because here you can actually have multiple sounds using up the sourceVoice-&gt;Play() method simultaneously (in other words multiple sounds playing at the same time) without any data races. ie there&#39;s apparently no need for you to use threads or other synchronization mechanisms. As you said, XAudio2 and WASAPI handles this stuff for you behind the scenes. (just spelling it out)"}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "reply_to_user": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 1, "creation_date": 1603829013, "post_id": 49292153, "comment_id": 114159626, "body": "Effectively every call you make to an <code>XAudio2</code> API is asynchronous and will be acted upon by the audio thread in the next quantum. The main trick is that the application must keep all memory buffers pointed to by the queued buffers in all XAudio2 source voices valid until after they finish playing. This model allows audio to be responsive (glitches are easily heard), and avoids the need to copy the source voice data into private buffers--which is what DirectSound did."}], "tags": [], "owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "is_accepted": false, "score": 2, "last_activity_date": 1521091658, "creation_date": 1521091658, "answer_id": 49292153, "question_id": 49279982, "link": "https://stackoverflow.com/questions/49279982/how-does-one-play-multiple-sounds-simultaneously-on-xaudio2/49292153#49292153", "title": "How does one play multiple sounds simultaneously on XAudio2?", "body": "<p>XAudio2 is a non-blocking API. To play two sounds simultaneously, you need two 'source voices' and one 'mastering voice' at a minimum.</p>\n\n<pre><code>DX::ThrowIfFailed(\n    CoInitializeEx( nullptr, COINIT_MULTITHREADED )\n);\n\nMicrosoft::WRL::ComPtr&lt;IXAudio2&gt; pXAudio2;\n// Note that only IXAudio2 (and APOs) are COM reference counted\nDX::ThrowIfFailed(\n    XAudio2Create( pXAudio2.GetAddressOf(), 0 )\n);\n\nIXAudio2MasteringVoice* pMasteringVoice = nullptr;\nDX::ThrowIfFailed(\n    pXAudio2-&gt;CreateMasteringVoice( &amp;pMasteringVoice )\n);\n\nIXAudio2SourceVoice* pSourceVoice1 = nullptr;\nDX::ThrowIfFailed(\n    pXaudio2-&gt;CreateSourceVoice( &amp;pSourceVoice1, &amp;wfx ) )\n    // The default 'pSendList' will be just to the pMasteringVoice\n);\n\nIXAudio2SourceVoice* pSourceVoice2 = nullptr;\nDX::ThrowIfFailed(\n    pXaudio2-&gt;CreateSourceVoice( &amp;pSourceVoice2, &amp;wfx) )\n    // Doesn't have to be same format as other source voice\n    // And doesn't have to match the mastering voice either\n);\n\nDX::ThrowIfFailed(\n    pSourceVoice1-&gt;SubmitSourceBuffer( &amp;buffer )\n);\n\nDX::ThrowIfFailed(\n    pSourceVoice2-&gt;SubmitSourceBuffer( &amp;buffer /* could be different WAV data or not */)\n);\n\nDX::ThrowIfFailed(\n    pSourceVoice1-&gt;Start( 0 );\n);\n\nDX::ThrowIfFailed(\n    pSourceVoice2-&gt;Start( 0 );\n);\n</code></pre>\n\n<blockquote>\n  <p>You should take a look at the samples on <a href=\"https://github.com/walbourn/directx-sdk-samples/tree/master/XAudio2\" rel=\"nofollow noreferrer\">GitHub</a> as well as <a href=\"https://github.com/Microsoft/DirectXTK/wiki/Audio\" rel=\"nofollow noreferrer\">DirectX Tool Kit for Audio</a></p>\n</blockquote>\n\n<p>If you wanted to ensure both source voices started at precisely the same time, you'd use:</p>\n\n<pre><code>DX::ThrowIfFailed(\n    pSourceVoice1-&gt;Start( 0, 1 );\n);\n\nDX::ThrowIfFailed(\n    pSourceVoice2-&gt;Start( 0, 1 );\n);\n\nDX::ThrowIfFailed(\n    pSourceVoice2-&gt;CommitChanges( 1 );\n);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "is_accepted": false, "score": 0, "last_activity_date": 1603454515, "creation_date": 1603454515, "answer_id": 64499627, "question_id": 49279982, "link": "https://stackoverflow.com/questions/49279982/how-does-one-play-multiple-sounds-simultaneously-on-xaudio2/64499627#64499627", "title": "How does one play multiple sounds simultaneously on XAudio2?", "body": "<p>If you want to play multiple sounds simultaneously have a <code>playSound</code> function and launch various threads to play your various sounds each one of a certain source voice.</p>\n<p>XAudio2 will take care of mapping each sound to available channels (or if you have a more advanced system you can specify the mapping yourself using <code>IXAudio2Voice::SetOutputMatrix</code>).</p>\n<pre><code>void playSound( IXAudio2SourceVoice* sourceVoice )\n{\n    BOOL isPlayingSound = TRUE;\n    XAUDIO2_VOICE_STATE soundState = {0};\n    HRESULT hres = sourceVoice-&gt;Start( 0u );\n    while ( SUCCEEDED( hres ) &amp;&amp; isPlayingSound )\n    {// loop till sound completion\n        sourceVoice-&gt;GetState( &amp;soundState );\n        isPlayingSound = ( soundState.BuffersQueued &gt; 0 ) != 0;\n        Sleep( 100 );\n    }\n}\n</code></pre>\n<p>For example to play two sounds simultaneously:</p>\n<pre><code>IXAudio2SourceVoice* pSourceVoice1 = nullptr;\nIXAudio2SourceVoice* pSourceVoice2 = nullptr;\n\n// setup the source voices, load the sounds etc..\n\nstd::thread thr1{ playSound, pSourceVoice1 };\nstd::thread thr2{ playSound, pSourceVoice2 };\n\nthr1.join();\nthr2.join();\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9491970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf18a7ad98e3af5f68be9330c8f1a3bb?s=128&d=identicon&r=PG&f=1", "display_name": "Aphelion", "link": "https://stackoverflow.com/users/9491970/aphelion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1603454515, "creation_date": 1521036810, "last_edit_date": 1521037770, "question_id": 49279982, "link": "https://stackoverflow.com/questions/49279982/how-does-one-play-multiple-sounds-simultaneously-on-xaudio2", "title": "How does one play multiple sounds simultaneously on XAudio2?", "body": "<p>I am currently trying to make a game app in Windows with XAudio2 and I cannot figure out how to make the application not block when playing a sound. I tried calling a new thread in the samples in <a href=\"https://github.com/walbourn/directx-sdk-samples/tree/master/XAudio2\" rel=\"nofollow noreferrer\">this repository.</a></p>\n\n<p>But it will just cause an error. I tried passing a reference to the mastering voice in the function but then it just raises a \"XAudio2: Must create a mastering voice first\" error. Am I missing something? I am just trying to make it play two sounds at once and build from there. I went over the documentation but it's very vague.</p>\n"}, {"tags": ["c++", "xml", "boost-propertytree"], "answers": [{"tags": [], "owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "is_accepted": false, "score": 0, "last_activity_date": 1521038277, "creation_date": 1521038277, "answer_id": 49280546, "question_id": 49279868, "link": "https://stackoverflow.com/questions/49279868/check-if-an-element-does-exists-in-xml-file-with-boost-property-tree/49280546#49280546", "title": "Check if an element does exists in xml file with boost property tree", "body": "<p>Looking at the documentation of <a href=\"http://www.boost.org/doc/libs/1_66_0/doc/html/boost/property_tree/basic_ptree.html#id-1_3_32_10_7_1_1_1_3_34-bb\" rel=\"nofollow noreferrer\"><code>find()</code></a></p>\n\n<blockquote>\n  <p>assoc_iterator find(const key_type &amp; key);<br>\n  34. Find a child with the given key, or not_found() if there is none. There is no guarantee about which child is returned if multiple have the same key.</p>\n</blockquote>\n\n<p>and <a href=\"http://www.boost.org/doc/libs/1_66_0/doc/html/boost/property_tree/basic_ptree.html#id-1_3_32_10_7_1_1_1_3_45-bb\" rel=\"nofollow noreferrer\"><code>get_child()</code></a></p>\n\n<blockquote>\n  <p>self_type &amp; get_child(const path_type &amp; path);<br>\n  45. Get the child at the given path, or throw ptree_bad_path.</p>\n</blockquote>\n\n<p>I would guess, that <code>find</code> is looking for immediate children -- this would  explain why looking for the root element works --, and <code>get_child</code> is intended for going down a whole path.</p>\n\n<hr>\n\n<p>So, either go step by step, e.g. something like</p>\n\n<pre><code>it = prop_tree.find(\"DocName\");\nit = it-&gt;find(\"InitCommands\");\nit = it-&gt;find(\"OptionalCommands\");\n</code></pre>\n\n<p>or create a <code>path_type</code> and use <code>get_child</code> instead.</p>\n"}], "owner": {"reputation": 333, "user_id": 3967641, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/1ab67f080596e4f26a169fe003ac2bbf?s=128&d=identicon&r=PG&f=1", "display_name": "sbunny", "link": "https://stackoverflow.com/users/3967641/sbunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 903, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521038277, "creation_date": 1521036414, "last_edit_date": 1521036873, "question_id": 49279868, "link": "https://stackoverflow.com/questions/49279868/check-if-an-element-does-exists-in-xml-file-with-boost-property-tree", "title": "Check if an element does exists in xml file with boost property tree", "body": "<p>I am parsing an XML file using boost property tree of the following type:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;DocName&gt;\n    &lt;InitCommands&gt;\n        &lt;OptionalCommands&gt;\n            &lt;command name=\"write\" address=\"0x00000000\"/&gt;\n            &lt;command name=\"write\" address=\"0x00000000\"/&gt;\n            &lt;command name=\"write\" address=\"0x00000000\"/&gt;\n        &lt;/OptionalCommands&gt;\n        &lt;command name=\"write\" address=\"0x00000000\"/&gt;\n        &lt;command name=\"write\" address=\"0x00000000\"/&gt;        \n    &lt;/InitCommands&gt;\n&lt;/DocName&gt;\n</code></pre>\n\n<p>I would like to check if a certain element exists in the XML tree. Below is the code I am using:</p>\n\n<pre><code>namespace pt = boost::property_tree;\nint main (){\n   pt::ptree prop_tree;\n   read_xml (\"my.xml\", prop_tree);\n   pt::ptree::const_assoc_iterator it;\n   it  = prop_tree.find(\"DocName.InitCommands.OptionalCommands\");\n   if (it != prop_tree.not_found())\n     std::cout &lt;&lt;\"Optional Options found !\" &lt;&lt; std::endl;              \n}\n</code></pre>\n\n<p>However, running this code returns</p>\n\n<pre><code>it == prop_tree.not_found()\n</code></pre>\n\n<p>This works if I try to find the root element of my xml file i.e</p>\n\n<pre><code>it  = prop_tree.find(\"DocName\");\n</code></pre>\n\n<p>Can someone please suggest how this find() function should be used ? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1521036094, "post_id": 49279707, "comment_id": 85562088, "body": "It&#39;s not clear where the problem lies. Do you know how to call a function? Show your attempt."}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 2, "creation_date": 1521036261, "post_id": 49279707, "comment_id": 85562217, "body": "Sounds like you could benefit from one of these <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">C++ books</a>. C++ can&#39;t be learned by guessing."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 3, "creation_date": 1521036558, "post_id": 49279707, "comment_id": 85562443, "body": "<a href=\"https://stackoverflow.com/questions/49120292\">This seems to be a repost</a>.  Is this version better?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9448187, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mike Evans", "link": "https://stackoverflow.com/users/9448187/mike-evans"}, "edited": false, "score": 0, "creation_date": 1521069171, "post_id": 49279973, "comment_id": 85581304, "body": "Works fine!  Thanks for your help!"}], "tags": [], "owner": {"reputation": 88, "user_id": 8620746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XFpdo.jpg?s=128&g=1", "display_name": "ThomasRift", "link": "https://stackoverflow.com/users/8620746/thomasrift"}, "is_accepted": false, "score": 3, "last_activity_date": 1521036780, "creation_date": 1521036780, "answer_id": 49279973, "question_id": 49279707, "link": "https://stackoverflow.com/questions/49279707/how-to-print-the-results-of-a-return-value-i-am-a-beginner-learning-c/49279973#49279973", "title": "how to print the results of a return value? I am a beginner learning C++", "body": "<p>This should work :</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint sumTo(int value)\n{\n    int total = 0;\n    for (int count=1; count &lt;= value; ++count)\n        total += count;\n\n    return total;\n}\n\nint main(void)\n{\n    std::cout &lt;&lt; sumTo(12);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9448187, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mike Evans", "link": "https://stackoverflow.com/users/9448187/mike-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "closed_date": 1521046035, "answer_count": 1, "score": -3, "last_activity_date": 1521036780, "creation_date": 1521035989, "last_edit_date": 1521036117, "question_id": 49279707, "link": "https://stackoverflow.com/questions/49279707/how-to-print-the-results-of-a-return-value-i-am-a-beginner-learning-c", "closed_reason": "Needs details or clarity", "title": "how to print the results of a return value? I am a beginner learning C++", "body": "<pre><code>int sumTo(int value)\n{\nint total(0);\nfor (int count=1; count &lt;= value; ++count)\n    total += count;\n\nreturn total;\n}\n</code></pre>\n\n<p>Where do I add <code>cout&lt;&lt;total;</code> to print the results? I have tried to add the print function several locations without success -- either getting nothing or a large number (maybe a number previously stored in the location). Have debugger with the result showing total as 15 when value is equal to 5.</p>\n\n<p>In addition, I have added a void function to print, but still no correct results. </p>\n\n<p>Need help with the proper placement of the print function to yield the correct answer?</p>\n"}, {"tags": ["c++", "visual-studio-2013", "visual-studio-2017", "std"], "comments": [{"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1521036514, "post_id": 49279598, "comment_id": 85562412, "body": "What you expect to get when your string date contains the month 13? January 02 2014?"}, {"owner": {"reputation": 3841, "user_id": 820657, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9e5420844d05978735341ced109f684a?s=128&d=identicon&r=PG&f=1", "display_name": "ksl", "link": "https://stackoverflow.com/users/820657/ksl"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1521190172, "post_id": 49279598, "comment_id": 85634149, "body": "Did you read the question @S.M.?"}], "answers": [{"tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1521206139, "creation_date": 1521206139, "answer_id": 49321716, "question_id": 49279598, "link": "https://stackoverflow.com/questions/49279598/stdget-time-not-working-correctly-in-vs-2017/49321716#49321716", "title": "std::get_time not working correctly in VS 2017?", "body": "<p>It works correctly.</p>\n\n<p><code>std::get_time</code> throws an exception <code>ios_base::failure</code> if the resulting error state flag is not <code>ios_base::iostate::goodbit</code> and member <code>std::basic_ios::exceptions</code> was set to throw for that state.</p>\n\n<p>Check the value returned by <code>iss.exceptions()</code> to see which of <code>eofbit</code>, <code>failbit</code> and <code>badbit</code> are set.</p>\n\n<p>This is a common case for all stream operations, not only for <code>std::get_time</code>.</p>\n"}], "owner": {"reputation": 3841, "user_id": 820657, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9e5420844d05978735341ced109f684a?s=128&d=identicon&r=PG&f=1", "display_name": "ksl", "link": "https://stackoverflow.com/users/820657/ksl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526481824, "creation_date": 1521035685, "question_id": 49279598, "link": "https://stackoverflow.com/questions/49279598/stdget-time-not-working-correctly-in-vs-2017", "title": "std::get_time not working correctly in VS 2017?", "body": "<p>The following code does not throw an exception when built and run using VS 2017. Note the month in the date is not valid.</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include &lt;iomanip&gt;\n#include &lt;cctype&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::string invalidMonth = \"2013-13-02T19:58:55Z\";\n\n    std::tm datetime = {};\n    std::istringstream iss(invalidMonth);\n    iss &gt;&gt; std::get_time(&amp;datetime, \"%Y-%m-%dT%H:%M:%S\");\n\n    if (iss.fail())\n    {\n        std::ostringstream oss;\n        oss &lt;&lt; \"Invalid value '\" &lt;&lt; invalidMonth &lt;&lt; \"'\\n\";\n        throw std::runtime_error(oss.str());\n    }\n\n    else\n    {\n        std::cout &lt;&lt; \"No error\\n\";\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The value of <code>datetime</code> after parsing is:</p>\n\n<pre><code>tm_sec  55  int\ntm_min  58  int\ntm_hour 19  int\ntm_mday 2   int\ntm_mon  0   int\ntm_year 113 int\ntm_wday 0   int\ntm_yday 0   int\ntm_isdst    0   int\n</code></pre>\n\n<p>This code throws an exception when built and run using VS 2013.</p>\n"}, {"tags": ["c++", "uwp", "windows-10-universal", "smartcard"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521036646, "post_id": 49279470, "comment_id": 85562519, "body": "Did you look at <a href=\"https://stackoverflow.com/questions/15292199/when-does-if-winapi-family-partitionwinapi-partition-desktop-in-dxvahd-h-micr\" title=\"when does if winapi family partitionwinapi partition desktop in dxvahd h micr\">stackoverflow.com/questions/15292199/&hellip;</a>?"}, {"owner": {"reputation": 551, "user_id": 6607702, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qpAnv.jpg?s=128&g=1", "display_name": "Attila Sz&#225;sz", "link": "https://stackoverflow.com/users/6607702/attila-sz%c3%a1sz"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1521037043, "post_id": 49279470, "comment_id": 85562767, "body": "Yes, of course but it didn&#39;t helped me."}], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 6607702, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qpAnv.jpg?s=128&g=1", "display_name": "Attila Sz&#225;sz", "link": "https://stackoverflow.com/users/6607702/attila-sz%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1521097120, "post_id": 49287114, "comment_id": 85588900, "body": "Thank you for you answer! I was afraid to start from the beginning with that namespace, but I should :)"}], "tags": [], "owner": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "is_accepted": true, "score": 4, "last_activity_date": 1521059388, "creation_date": 1521059388, "answer_id": 49287114, "question_id": 49279470, "link": "https://stackoverflow.com/questions/49279470/cant-use-winscard-h-in-a-uwp-app-due-to-winapi-partition-desktop-blocks/49287114#49287114", "title": "Can&#39;t use winscard.h in a UWP app due to WINAPI_PARTITION_DESKTOP blocks", "body": "<p>The <code>WINAPI_PARTITION_DESKTOP</code> guard means the API is not supported for UWP apps. It is trivial to unblock the compiler, but it's not a good idea.</p>\n\n<ul>\n<li>You could unblock the compiler by making the declarations visible, but then you'd have problems linking. </li>\n<li>You could manually add the correct import lib to link, but then it would likely fail at runtime due to security checks. </li>\n<li>Even if you managed to make that work, your app would not be allowed in the Windows Store. </li>\n<li>Even if you get it working and don't care about the Windows Store, this is not a supported scenario and could break at any point in time.</li>\n</ul>\n\n<p>The correct way to do this is with the types in the <code>Windows.Devices.SmartCards</code> namespace. If there are features missing from that API, you can send feedback via <a href=\"https://wpdev.uservoice.com/forums/110705-universal-windows-platform?query=smartcard\" rel=\"nofollow noreferrer\">UserVoice</a> or the Feedback Hub.</p>\n"}], "owner": {"reputation": 551, "user_id": 6607702, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qpAnv.jpg?s=128&g=1", "display_name": "Attila Sz&#225;sz", "link": "https://stackoverflow.com/users/6607702/attila-sz%c3%a1sz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 49287114, "answer_count": 1, "score": 3, "last_activity_date": 1521138519, "creation_date": 1521035337, "last_edit_date": 1521138519, "question_id": 49279470, "link": "https://stackoverflow.com/questions/49279470/cant-use-winscard-h-in-a-uwp-app-due-to-winapi-partition-desktop-blocks", "title": "Can&#39;t use winscard.h in a UWP app due to WINAPI_PARTITION_DESKTOP blocks", "body": "<p>I'm developing in C++ a Universal Windows Platform app. I have a <strong>working</strong> project in C++ which can communicate with smart cards. For this communication it uses the <code>winscard.h</code> library.</p>\n\n<p>I'd like to use in the UWP app this functions provided by the <code>winscard.h</code>, but I can't compile it in the UWP. After some research I found that in this header file there is a condition:</p>\n\n<p><code>#if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP)</code></p>\n\n<p>So this is the reason the compiler doesn't found the methods. Going forward I wanted to change this <code>WINAPI_FAMILY_PARTITION</code> to the <code>WINAPI_PARTITION_DESKTOP</code> but I found nothing about this. </p>\n\n<p>I set in the appxmanifest file the <code>TargetDeviceFamily</code> name to <code>Windows.Desktop</code>, but it doesn't help.</p>\n\n<p>So, my questions are:</p>\n\n<ol>\n<li>Is it possible to change the <code>WINAPI_FAMILY_PARTITION</code>?\nIf not:</li>\n<li>Can I use the <code>winscard.h</code> lib in UWP app?</li>\n</ol>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1521035407, "post_id": 49279414, "comment_id": 85561552, "body": "<code>B_obj[i] = B(this);</code>?"}, {"owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1521035444, "post_id": 49279414, "comment_id": 85561586, "body": "Your non-working example is failing because arrays invoke the default constructor for every member of the array.  You can try @UnholySheep&#39;s suggestion, or use a <code>vector</code>."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1521035698, "post_id": 49279414, "comment_id": 85561772, "body": "@UnholySheep won&#39;t work if <code>B</code> has no parameterless constructor."}, {"owner": {"reputation": 23, "user_id": 8976684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ahWk9d2o2cU/AAAAAAAAAAI/AAAAAAAAAAA/5MPWDcfEZN0/photo.jpg?sz=128", "display_name": "Phani Chinimilli", "link": "https://stackoverflow.com/users/8976684/phani-chinimilli"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1521191050, "post_id": 49279414, "comment_id": 85634643, "body": "@UnholySheep thanks ,atleast this fixed my compilation error. but my program is not working as expected.                                                                           I want to try with Vector that was mentioned by stephen Newell, can you throw some light on it ?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8976684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ahWk9d2o2cU/AAAAAAAAAAI/AAAAAAAAAAA/5MPWDcfEZN0/photo.jpg?sz=128", "display_name": "Phani Chinimilli", "link": "https://stackoverflow.com/users/8976684/phani-chinimilli"}, "edited": false, "score": 0, "creation_date": 1521190910, "post_id": 49279557, "comment_id": 85634564, "body": "Thanks for the comment , but in my case value 4 is not constant , it always changes, may be my for loop looks like &quot;for(i=0;i&lt;max;i++) {"}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 1, "last_activity_date": 1521035562, "creation_date": 1521035562, "answer_id": 49279557, "question_id": 49279414, "link": "https://stackoverflow.com/questions/49279414/how-to-pass-the-current-class-reference-to-initialize-class-members-in-c/49279557#49279557", "title": "how to pass the current class reference to initialize class members in c++", "body": "<p>If your only constructor of <code>B</code> is <code>B(A*)</code> (no parameterless one) then you have to use member list initialization:</p>\n\n<pre><code>A() : b_obj{{this}, {this}, {this}, {this}, {this}} {}\n</code></pre>\n\n<p>This gets messy fast though, so a better solution would be using <code>std::vector</code> or creating a parameterless constructor and then copy-initializing them later on.</p>\n"}], "owner": {"reputation": 23, "user_id": 8976684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ahWk9d2o2cU/AAAAAAAAAAI/AAAAAAAAAAA/5MPWDcfEZN0/photo.jpg?sz=128", "display_name": "Phani Chinimilli", "link": "https://stackoverflow.com/users/8976684/phani-chinimilli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1521035957, "creation_date": 1521035201, "last_edit_date": 1521035957, "question_id": 49279414, "link": "https://stackoverflow.com/questions/49279414/how-to-pass-the-current-class-reference-to-initialize-class-members-in-c", "title": "how to pass the current class reference to initialize class members in c++", "body": "<p>My class <code>A</code> has an array of objects of class B as members, the requirement is that in the constructor of class A I need to pass <code>this</code> to every <code>B</code> object in the array. However, trying to loop over them in the constructor body of <code>A</code> doesn't work:</p>\n\n<pre><code>for (i=0;i&lt;max(B_obj);i++) {\nB_obj[i](this);\n}\n</code></pre>\n\n<hr>\n\n<h1>code example working</h1>\n\n<pre><code>struct A : EventHandler {\n    A() : B_obj_1(this) {}\n    B B_obj_1;\n\n};\n</code></pre>\n\n<hr>\n\n<h1>code example Notworking</h1>\n\n<pre><code>struct A : EventHandler {\n    A() : {\n        for (auto i = 0; i&lt;4; i++) {\n            B_obj[i](this);\n        }\n    }\n    B B_obj[5];\n};\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521035151, "post_id": 49279300, "comment_id": 85561350, "body": "there is nothing wrong with the code, but I guess your expectations are wrong. What do you expect this code to do and what do you think is wrong about it?"}, {"owner": {"reputation": 318, "user_id": 1877501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46aabbe257541e8efd34e98f0e20c08c?s=128&d=identicon&r=PG", "display_name": "Londerson Ara&#250;jo", "link": "https://stackoverflow.com/users/1877501/londerson-ara%c3%bajo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521035259, "post_id": 49279300, "comment_id": 85561431, "body": "@user463035818 the answer give me what i want: duplicated keys."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521035355, "post_id": 49279300, "comment_id": 85561510, "body": "yes, you got the answer, but still the question is rather unclear because what you have is already the way to insert items into a unordered_map"}, {"owner": {"reputation": 318, "user_id": 1877501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46aabbe257541e8efd34e98f0e20c08c?s=128&d=identicon&r=PG", "display_name": "Londerson Ara&#250;jo", "link": "https://stackoverflow.com/users/1877501/londerson-ara%c3%bajo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1521044791, "post_id": 49279300, "comment_id": 85568589, "body": "@user463035818 obvious not! in unordered_map I CAN&#39;T duplicate the keys."}], "answers": [{"tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": false, "score": 5, "last_activity_date": 1521035219, "last_edit_date": 1521035219, "creation_date": 1521035137, "answer_id": 49279383, "question_id": 49279300, "link": "https://stackoverflow.com/questions/49279300/how-is-the-way-to-insert-dynamically-one-pair-to-may-unordered-list/49279383#49279383", "title": "How is the way to insert dynamically one pair to may unordered_list?", "body": "<p>That's because <code>std::unordered_map</code> doesn't allow duplicate keys (<code>\"foo\"</code> twice).If you want duplicate keys you should use <code>std::unordered_multimap</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 16438, "user_id": 312896, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/57c5b6cdd1a94aef510d5dce28992494?s=128&d=identicon&r=PG", "display_name": "Yola", "link": "https://stackoverflow.com/users/312896/yola"}, "is_accepted": false, "score": 3, "last_activity_date": 1521035302, "creation_date": 1521035302, "answer_id": 49279458, "question_id": 49279300, "link": "https://stackoverflow.com/questions/49279300/how-is-the-way-to-insert-dynamically-one-pair-to-may-unordered-list/49279458#49279458", "title": "How is the way to insert dynamically one pair to may unordered_list?", "body": "<blockquote>\n  <p><strong>26.2.7 Unordered associative containers</strong><br>\n   An unordered associative container supports unique keys if it may contain at most one element for each key. Otherwise, it supports equivalent keys. <code>unordered_set</code> and <code>unordered_map</code> support unique keys. <code>unordered_multiset</code> and <code>unordered_multimap</code> support equivalent keys.</p>\n</blockquote>\n\n<p>So, you need to use <code>unordered_multimap</code> in case you want two objects with the same keys \"foo\" in the map.</p>\n"}], "owner": {"reputation": 318, "user_id": 1877501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46aabbe257541e8efd34e98f0e20c08c?s=128&d=identicon&r=PG", "display_name": "Londerson Ara&#250;jo", "link": "https://stackoverflow.com/users/1877501/londerson-ara%c3%bajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1521066787, "answer_count": 2, "score": -1, "last_activity_date": 1521036305, "creation_date": 1521034934, "last_edit_date": 1521036305, "question_id": 49279300, "link": "https://stackoverflow.com/questions/49279300/how-is-the-way-to-insert-dynamically-one-pair-to-may-unordered-list", "closed_reason": "Needs details or clarity", "title": "How is the way to insert dynamically one pair to may unordered_list?", "body": "<p>If I have one <code>unordered_map</code> and I want insert in a for dynamically the value iterated, but always the <code>std::unordered_map::insert</code> insert only once.</p>\n\n<pre><code>unordered_map&lt;string, string&gt; legalities;\nvector&lt;string&gt; values = {\"foo\", \"bar\"};\n\nfor(auto&amp; value : values) {\n  legalities.insert({ \"foo\", value });\n  cout &lt;&lt; value &lt;&lt; endl;\n}\n\nlegalities.size(); // return 1\n</code></pre>\n\n<p>How I can insert in this way?</p>\n"}, {"tags": ["c++", "templates", "c++17", "type-deduction"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1521038257, "post_id": 49279284, "comment_id": 85563567, "body": "How about simply <code>return std::tie(t1.*P, t1.*Ps...) &lt; std::tie(t2.*P, t2.Ps...);</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": true, "score": 2, "last_activity_date": 1521035759, "last_edit_date": 1521035759, "creation_date": 1521035343, "answer_id": 49279474, "question_id": 49279284, "link": "https://stackoverflow.com/questions/49279284/c-deduce-pointer-to-member-template-parameter/49279474#49279474", "title": "C++ deduce pointer to member template parameter", "body": "<p>You are missing the <code>T</code> in your <code>less&lt;Ps...&gt;</code>.</p>\n\n<pre><code>namespace compare\n{\n    template &lt;typename T, auto P, auto ...Ps&gt;\n    bool less(const T &amp;t1, const T &amp;t2)\n    {\n        if constexpr (sizeof...(Ps) == 0)\n        {\n            return t1.*P &lt; t2.*P;\n        }\n        else\n        {\n            if (t1.*P == t2.*P)\n            {\n                return less&lt;T, Ps...&gt;(t1, t2);\n            }\n            else\n            {\n                return t1.*P &lt; t2.*P;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/43a81936d194d542\" rel=\"nofollow noreferrer\">See it live</a></p>\n\n<p>Aside: To fit with the way that the Standard Library defines the concept Compare, I would suggest removing the use of <code>==</code>, and instead have</p>\n\n<pre><code>if (return t1.*P &lt; t2.*P)\n{\n    return true;\n}\nif (return t2.*P &lt; t1.*P)\n{\n    return false;\n}\nreturn less&lt;T, Ps...&gt;(t1, t2);\n</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 4949225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5908bcb3377bd4d4c71fa323f7ac643?s=128&d=identicon&r=PG&f=1", "display_name": "Smoof", "link": "https://stackoverflow.com/users/4949225/smoof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49279474, "answer_count": 1, "score": 1, "last_activity_date": 1521035759, "creation_date": 1521034874, "question_id": 49279284, "link": "https://stackoverflow.com/questions/49279284/c-deduce-pointer-to-member-template-parameter", "title": "C++ deduce pointer to member template parameter", "body": "<p>I am trying to write a templated version for a lexicographical compare using C++17 features:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;set&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nnamespace compare\n{\n    template &lt;typename T, auto P, auto ...Ps&gt;\n    bool less(const T &amp;t1, const T &amp;t2)\n    {\n        if constexpr (sizeof...(Ps) == 0)\n        {\n            return t1.*P &lt; t2.*P;\n        }\n        else\n        {\n            if (t1.*P == t2.*P)\n            {\n                return less&lt;Ps...&gt;(t1, t2);\n            }\n            else\n            {\n                return t1.*P &lt; t2.*P;\n            }\n        }\n    }\n}\n\nstruct my_type\n{\n    int i = 0;\n    std::set&lt;int&gt; s;\n};\n\nint main()\n{\n    my_type t1, t2;\n\n    t2.i = -1;\n\n    std::cout &lt;&lt; std::boolalpha &lt;&lt; compare::less&lt;my_type, &amp;my_type::i, &amp;my_type::s&gt;(t1, t2) &lt;&lt; std::endl;\n\n    return 0;\n\n}\n</code></pre>\n\n<p>However, my example does not compile with the latest version of GCC:</p>\n\n<pre><code>main.cpp: In instantiation of 'bool compare::less(const T&amp;, const T&amp;) [with T = my_type; auto P = &amp;my_type::i; auto ...Ps = {&amp;my_type::s}]':\nmain.cpp:42:88:   required from here\nmain.cpp:16:23: error: no matching function for call to 'less&lt;&amp;my_type::s&gt;(const my_type&amp;, const my_type&amp;)'\n     return less&lt;Ps...&gt;(t1, t2);\n            ~~~~~~~~~~~^~~~~~~~\nmain.cpp:6:7: note: candidate: template&lt;class T, auto P, auto ...Ps&gt; bool compare::less(const T&amp;, const T&amp;)\n  bool less(const T &amp;t1, const T &amp;t2)\n       ^~~~\nmain.cpp:6:7: note:   template argument deduction/substitution failed:\n</code></pre>\n\n<p>Interestingly, the compilers output does not state which template parameter could not be deduced. I know how to implement this in the pre C++17 way. What am i doing wrong?</p>\n"}, {"tags": ["c++", "windows", "eclipse", "gdb"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521034567, "post_id": 49279108, "comment_id": 85560839, "body": "Check that you have gdb installed in your cygwin. I&#39;ll suggest to switch into MSYS2 from cygwin, this is newer and better version of the same. P.S. You can try Code::Blocks instead of Eclipse, Eclipse is a Java IDE not really good for C++, and the vise versa."}, {"owner": {"reputation": 19, "user_id": 9491681, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Z44Es1qv8c/AAAAAAAAAAI/AAAAAAAAABk/-EWeOOyvMyU/photo.jpg?sz=128", "display_name": "Mauro Dell&#39;Amico", "link": "https://stackoverflow.com/users/9491681/mauro-dellamico"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521194145, "post_id": 49279108, "comment_id": 85636550, "body": "Thanks for the suggestion. Gdb is installed and works. I use it regularly with Netbeans. I was trying to switch to Eclipse as common ide for C++, python and java, but it seems it is not a good idea."}], "owner": {"reputation": 19, "user_id": 9491681, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Z44Es1qv8c/AAAAAAAAAAI/AAAAAAAAABk/-EWeOOyvMyU/photo.jpg?sz=128", "display_name": "Mauro Dell&#39;Amico", "link": "https://stackoverflow.com/users/9491681/mauro-dellamico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521038926, "creation_date": 1521034334, "last_edit_date": 1521038926, "question_id": 49279108, "link": "https://stackoverflow.com/questions/49279108/eclipse-oxigen-c-windows-10-gdb-does-not-work", "title": "Eclipse oxigen c++ windows 10 gdb does not work", "body": "<p>I installed for the first time Eclipse oxygen with CDT 9.4.0, under Windows 10, gdb 7.10.1 and it fails with messages</p>\n\n<pre><code>&lt;terminated&gt;EclipseProject1.exe [C/C++ Application] \n    &lt;terminated, exit value: 0&gt;C:/cygwin64/bin/gdb.exe (7.10.1) \n</code></pre>\n\n<p>doing nothing. I have seen some similar questions raised in the past, but I did not found an answer that worked for me.</p>\n"}, {"tags": ["c++", "linux", "shared-libraries", "libc", "dynamic-library"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1521034823, "post_id": 49279087, "comment_id": 85561060, "body": "Why don&#39;t you link all the libraries statically?"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1521034893, "post_id": 49279087, "comment_id": 85561122, "body": "Use the debugger."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1521035358, "post_id": 49279087, "comment_id": 85561512, "body": "Neither linking with glibc statically nor copying parts of glibc over to the target platform are working solutions to the portability problem. Don&#39;t do that. Link dynamically, don&#39;t copy parts of glibc (you can copy other libraries), and solve any problems that arise on the case-by-case basis."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1521035420, "post_id": 49279087, "comment_id": 85561564, "body": "@S.M. On ls? Or perhaps on ld.so?"}, {"owner": {"reputation": 1150, "user_id": 1789718, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/1789718/luca"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521035834, "post_id": 49279087, "comment_id": 85561900, "body": "@n.m. i can&#39;t solve problem coming from every pc the program is shipped to"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521036831, "post_id": 49279087, "comment_id": 85562634, "body": "You can announce that you only support PCs that have at least some minimal glibc version (and link against that version). Or link statically against an alternative libc implementation with no portability issues like <a href=\"https://www.musl-libc.org/intro.html\" rel=\"nofollow noreferrer\">musl</a>."}, {"owner": {"reputation": 1150, "user_id": 1789718, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/1789718/luca"}, "edited": false, "score": 0, "creation_date": 1521041453, "post_id": 49279087, "comment_id": 85566039, "body": "The main issues were caused by libc.so and libdl.so, i guess i can safely suppose that every system has a decent version for them."}], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 3, "last_activity_date": 1521432824, "creation_date": 1521432824, "answer_id": 49355708, "question_id": 49279087, "link": "https://stackoverflow.com/questions/49279087/bundle-c-application-using-libc-so-6/49355708#49355708", "title": "Bundle c++ application using libc.so.6", "body": "<blockquote>\n  <p>to do this i need to copy all the shared library used by the program itself</p>\n</blockquote>\n\n<p>No, you <em>don't</em>. In particular, copying GLIBC simply doesn't work (as you've discovered).</p>\n\n<p>What you <em>actually</em> need is to build your program against an old enough (not newer than any of systems you distribute your program to) libc, and then depend on GLIBC ABI compatibility (which guarantees that programs linked against old GLIBC continue to run correctly when bound to newer GLIBC at runtime).</p>\n\n<p>This can be achieved by either building your program on an old system, or using a <code>chroot</code>, or building a \"linux to older linux\" cross-compiler.</p>\n\n<blockquote>\n  <p>I'm pretty sure that libc.so.6 is causing the problem</p>\n</blockquote>\n\n<p>Correct. The reason this doesn't work is explained e.g. <a href=\"https://stackoverflow.com/a/851229/50617\">here</a>.</p>\n\n<p>The problem is that GLIBC is composed of multiple binaries which all must match. And the path to one of these binaries (the <code>ld-linux</code>) is hard-coded into the program at static link time and can not be changed.</p>\n"}], "owner": {"reputation": 1150, "user_id": 1789718, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3fe641a6a3acaaede04ec4a239f78e41?s=128&d=identicon&r=PG", "display_name": "Luca", "link": "https://stackoverflow.com/users/1789718/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 1, "accepted_answer_id": 49355708, "answer_count": 1, "score": 2, "last_activity_date": 1521432824, "creation_date": 1521034275, "last_edit_date": 1521035754, "question_id": 49279087, "link": "https://stackoverflow.com/questions/49279087/bundle-c-application-using-libc-so-6", "title": "Bundle c++ application using libc.so.6", "body": "<p>I'm Trying to make my executable portable on linux, to do this i need to copy all the shared library used by the program itself, to check which one do I need I use:</p>\n\n<pre><code>ldd program_name\n</code></pre>\n\n<p>The output of the program helps me find all the required <code>.so</code>, between these libraries there is:</p>\n\n<pre><code>libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f5b61ac2000)\n</code></pre>\n\n<p>At this point I copied all the libraries in a folder called <code>shared_libs</code> and shipped them alongside the program to another pc, the problem arise when i do:</p>\n\n<pre><code>LD_LIBRARY_PATH=./shared_libs ./program_name\n</code></pre>\n\n<p>which gives:</p>\n\n<pre><code>[1]    4619 segmentation fault (core dumped)  LD_LIBRARY_PATH=./shared_libs ./program_name\n</code></pre>\n\n<p>I'm pretty sure that libc.so.6 is causing the problem because if I do:</p>\n\n<pre><code>LD_LIBRARY_PATH=./shared_libs ls\n</code></pre>\n\n<p>with just that library in the shared_libs folder, <code>ls</code> gives seg fault as well.</p>\n\n<p>How can i bundle my application?</p>\n\n<p><strong>EDIT 1: Why i don't link statically everything?</strong></p>\n\n<p>I tried it, The only thing i got was headache...</p>\n"}, {"tags": ["c++", "memory-leaks", "activex", "c++builder", "codesys"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521052267, "post_id": 49279035, "comment_id": 85573383, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> showing the imported TLB code and how you are using it in your project.  Perhaps you are not releasing the component correctly when you are done using it, or maybe it returns something as output that you are not releasing when you should be.  Really hard to say one way or the other without seeing what you are working with."}, {"owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521104104, "post_id": 49279035, "comment_id": 85592176, "body": "Yes, my question was a bit general because I was wondering if there could be some known issue for the described situation. I&#39;ll edit the question for more detail. Thank you"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1521123519, "post_id": 49279035, "comment_id": 85605463, "body": "Please <a href=\"https://stackoverflow.com/posts/49279035/edit\">edit</a> your code to reduce it to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem.  Your current code includes much that is peripheral to your problem - a minimal sample normally looks similar to a good unit test: only performing one task, with input values specified for reproducibility."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521135343, "post_id": 49279035, "comment_id": 85613901, "body": "Yes, you have a memory leak when calling <code>MSyncReadVarFromPlc()</code>. It returns an OLE <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a>, which you are assigning to an RTL <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a>. That assignment <b>copies</b> the data, and then the leak occurs because you are not calling <a href=\"https://msdn.microsoft.com/en-us/library/ms221165.aspx\" rel=\"nofollow noreferrer\"><code>VariantClear()</code></a> on the original <code>VARIANT</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521135493, "post_id": 49279035, "comment_id": 85613990, "body": "I also see a number of other problems with your code. But the biggest one that stands out to me is that your Form&#39;s constructor is calling <code>PLCHandler-&gt;MCreate()</code> twice, which is potentially another memory leak, depending on what <code>MCreate()</code> is actually creating. And I don&#39;t see any code that is calling <code>PLCHandler-&gt;MDelete()</code> when the Form is closed/destroyed, only when <code>Button3</code> is clicked. The rest of the issues I see are not memory leaks, just opportunities for optimizations."}, {"owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521205504, "post_id": 49279035, "comment_id": 85643987, "body": "@Remy Lebeau, I&#39;m really trying to use the information you gave me but I can&#39;t find a way to call VariantClear on the original VARIANT. I&#39;ll keep try in this direction, I thought that the original VARIANT deallocation was up to the ActiveX...lot of unknown things to learn. How can I point to the VARIANT instead of copying it?   By the way, the double PLCHandler-&gt;MCreate() is a dumb error made while I was writing the example, in the real code is called just once. And the call PLCHandler-&gt;MDelete() only in Button3 is because Form1 is the mainForm so closing it terminates the Application."}, {"owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "edited": false, "score": 0, "creation_date": 1521215932, "post_id": 49279035, "comment_id": 85651246, "body": "Also, if I try to get the returned VARIANT address I received a compiler error:  <code>VARIANT *varReceived = &amp;PLCHandler-&gt;MSyncReadVarFromPlc(iHandle, &amp;iResult, name, 2); \tVariantClear(varReceived);</code>    The error: <i>[bcc32c Error] Unit1.cpp(73): taking the address of a temporary object of type &#39;VARIANT&#39; (aka &#39;tagVARIANT&#39;)</i>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1521218830, "post_id": 49279035, "comment_id": 85653041, "body": "@LucaMaccioni the function returns a temporary variable that goes out of scope when the function call is done. You cant take the address of a temporary, just like the error says. You have to save the temporary to another variable. But you don&#39;t need to declare that variable as a pointer. Use this instead: <code>VARIANT varReceived = PLCHandler-&gt;MSyncReadVarFromPlc(iHandle, &amp;iResult, name, 2); &#47;* use varReceived as needed... *&#47;\tVariantClear(&amp;varReceived);</code>"}, {"owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521220859, "post_id": 49279035, "comment_id": 85654232, "body": "@RemyLebeau, thank you, I&#39;ll try what you suggested next monday...I can&#39;t do other tests before because my workplace is closed :D Meanwhile, a further question: why saving the temporary variable to another VARIANT one is different from saving it directly in a RTL Variant as in my original code? I understand that with the code you suggested I mantain the value in a not temporary VARIANT that I can clear after the use, but I still miss how this can solve the original VARIANT memory leak."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1521221276, "post_id": 49279035, "comment_id": 85654476, "body": "@LucaMaccioni: A <code>VARIANT</code> is just a struct with data fields. Assigning a <code>VARIANT</code> directly to another <code>VARIANT</code> without using <code>VariantCopy()</code> just copies the field values as-is. Dynamically allocated data, like strings and arrays, are not re-allocated, the pointers are copied as-is. A <code>Variant</code>, on the other hand, is a class wrapper that has copy semantics. Assigning a <code>VARIANT</code> (or another <code>Variant</code>) to a <code>Variant</code> allocates a new copy of dynamic data, preserving the original. The original and copy need to be cleared separately, that is why you were leaking. You were clearing the copy only"}, {"owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521221407, "post_id": 49279035, "comment_id": 85654535, "body": "@RemyLebeau Ok, sounds good. I&#39;ll follow you&#39;re suggestion and I&#39;ll give feedback asap. Sorry for the bunch of comments but it&#39;s my first StackOverflow question and my netiquette is even worst than my code."}, {"owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521644929, "post_id": 49279035, "comment_id": 85821298, "body": "@RemyLebeau Following your informations i finally understood and solved the memory leak problems, thank you <b>very</b> much! Everything works fine now."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1521647156, "post_id": 49279035, "comment_id": 85823130, "body": "@LucaMaccioni: I copied my comments into an answer for you."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1521647140, "creation_date": 1521647140, "answer_id": 49410765, "question_id": 49279035, "link": "https://stackoverflow.com/questions/49279035/memory-leak-with-activex-in-c-builder/49410765#49410765", "title": "Memory leak with ActiveX in C++ Builder", "body": "<p>You have a memory leak when calling <code>MSyncReadVarFromPlc()</code>. It returns an OLE <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a>, which you are assigning to an RTL <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a>. That assignment copies the data, and then the leak occurs because you are not calling <a href=\"https://msdn.microsoft.com/en-us/library/28741d81-8404-4f85-95d3-5c209ec13835(vs.85)\" rel=\"nofollow noreferrer\"><code>VariantClear()</code></a> on the original <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a>.</p>\n\n<p>A <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a> is just a struct with data fields. Assigning a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a> directly to another <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a> without using <a href=\"https://msdn.microsoft.com/en-us/library/f6ddbe1f-37b0-44f1-a3f0-b7ef4df88f8a(VS.85)\" rel=\"nofollow noreferrer\"><code>VariantCopy()</code></a> just copies the field values as-is. Dynamically allocated data, like strings and arrays, are not re-allocated, the pointers are copied as-is.</p>\n\n<p>A <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a>, on the other hand, is a class wrapper that has copy semantics. Assigning a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a> (or another <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a>) to a <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a> allocates a new copy of dynamic data, preserving the original. The original and copy need to be cleared separately.  You are leaking because you are not clearing the original <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a>, only the copied <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a>.</p>\n\n<p>Change your call to <code>MSyncReadVarFromPlc()</code> to save the return value to a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd373687.aspx\" rel=\"nofollow noreferrer\"><code>VARIANT</code></a> instead of a <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Variant\" rel=\"nofollow noreferrer\"><code>Variant</code></a>, and then call <a href=\"https://msdn.microsoft.com/en-us/library/28741d81-8404-4f85-95d3-5c209ec13835(vs.85)\" rel=\"nofollow noreferrer\"><code>VariantClear()</code></a> when you are done using it:</p>\n\n<pre><code>VARIANT varReceived;\n...\nvarReceived = PLCHandler-&gt;MSyncReadVarFromPlc(iHandle, &amp;iResult, name, 2);\n...\nVariantClear(&amp;varReceived); \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8299963, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213450361682853/picture?type=large", "display_name": "LucaM", "link": "https://stackoverflow.com/users/8299963/lucam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 49410765, "answer_count": 1, "score": 0, "last_activity_date": 1521647140, "creation_date": 1521034125, "last_edit_date": 1521118701, "question_id": 49279035, "link": "https://stackoverflow.com/questions/49279035/memory-leak-with-activex-in-c-builder", "title": "Memory leak with ActiveX in C++ Builder", "body": "<p>I'm encountering a memory leak while using an activeX component in my project.\nI'm working with Embarcadero Rad Studio 10.2 and developing a C++ industrial program that needs to communicate with a Codesys soft PLC on the same machine.</p>\n\n<p>So, i have a ActiveX component that can handle the communication part between my program and the soft PLC.</p>\n\n<p>I imported the ActiveX and everything seemed OK but i've found a memory leak that fills about 20MB per hour...\nTo import the library i followed the official guide:\n<a href=\"http://docwiki.embarcadero.com/RADStudio/Tokyo/en/Registering_a_COM_Object\" rel=\"nofollow noreferrer\">http://docwiki.embarcadero.com/RADStudio/Tokyo/en/Registering_a_COM_Object</a></p>\n\n<p>I made lot of tests and I realized that the memory leak happens every time I work with ActiveX methods with variants involved. Looks like the program is not able to free some kind of temporary variants used by the component.</p>\n\n<p>I've tested Visual Studio examples and everything works fine, so i think that the problems is generated by the type library that Rad Studio generates when I import the activeX component.\nAlso the ActiveX developer claims that everything works with Visual Studio.</p>\n\n<p>I used also Dr. Memory and other tools that confirm the presence of the leak but can't provide details because i think the ActiveX is not compiled for debug.</p>\n\n<p>Any idea about the reason for a behaviour like that?</p>\n\n<p>There is some possibile incompatibility for an ActiveX in RAD studio?</p>\n\n<p>Thanks in advance</p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>An example that shows the ActiveX usage.</p>\n\n<p><em>Unit1.cpp</em> </p>\n\n<pre><code>#include &lt;vcl.h&gt;\n#pragma hdrstop\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\n#include &lt;System.IOUtils.hpp&gt;\n#include \"Unit1.h\"\n\nTForm1 *Form1;\n// ---------------------------------------------------------------------------\n\n__fastcall TForm1::TForm1(TComponent* Owner) : TForm(Owner)\n{\n    counter = 0;\n    // Setting the path for communication setting files required for later connection\n    if (TFile::Exists(\"PLCHandler.ini\"))\n    {\n        iniPath = (wchar_t*)L\"PLCHandler.ini\";\n        logPath = (wchar_t*)L\"Log.txt\";\n    }\n    iResult = PLCHandler-&gt;MCreate(&amp;iHandle);\n\n    try\n    {\n        // Creating the component and retrieving the handle for other methods\n        iResult = PLCHandler-&gt;MCreate(&amp;iHandle);\n        if (iResult == 0)\n        {\n            iResult = PLCHandler-&gt;MConnect(iHandle, 0, iniPath, logPath);\n            if (iResult == 0)\n            {\n                connected              = true;\n                LabeledEdit1-&gt;Text     = \"CONNECTED\";\n                long int numeroSimboli = 0;\n                PLCHandler-&gt;MGetNumberOfSymbols(iHandle, &amp;numeroSimboli);\n                LabeledEdit2-&gt;Text = numeroSimboli;\n                PLCHandler-&gt;MGetPlcStatus(iHandle, &amp;iPLCStatus);\n                LabeledEdit3-&gt;Text = iPLCStatus;\n            }\n        }\n        else\n        {\n            LabeledEdit2-&gt;Text = \"ERROR: \" + (String)iResult;\n        }\n    }\n    catch (...)\n    {\n        LabeledEdit2-&gt;Text = \"ERROR\";\n    }\n\n}\n\n// ---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n    // Timers for testing purposes, they launch the next method every ms. Changing timing only delays the problem\n    Timer1-&gt;Enabled = !Timer1-&gt;Enabled;\n    Timer2-&gt;Enabled = !Timer2-&gt;Enabled;\n}\n\n// ---------------------------------------------------------------------------\nvoid __fastcall TForm1::Timer1Timer(TObject *Sender)\n{\n    // Asking to the PLC Handler the value of a PLC variable, identified by name\n    Variant varReceived;\n    BSTR name = SysAllocString(L\"Test.GVL.Test_INT\");\n    try\n    {\n        counter++;\n        LabeledEdit1-&gt;Text = counter;\n        // This is where i suppose the memory leak happens; the problem vanishes commenting the next line\n        varReceived        = PLCHandler-&gt;MSyncReadVarFromPlc(iHandle, &amp;iResult, name, 2);\n        LabeledEdit3-&gt;Text = varReceived.GetElement(0);\n        SysFreeString(name);\n        VarClear(varReceived);\n    }\n    catch (...)\n    {\n        VarClear(varReceived);\n        SysFreeString(name);\n    }\n\n}\n\n// ---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button2Click(TObject *Sender)\n{\n    Timer1Timer(this);\n}\n\n// ---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button3Click(TObject *Sender)\n{\n    // Other test: destroy the component and recreates it: the memory usages remains the same, no deallocation happens\n    try\n    {\n        PLCHandler-&gt;MDelete(&amp;iHandle);\n        iResult = PLCHandler-&gt;MCreate(&amp;iHandle);\n        if (iResult == 0)\n        {\n            iResult = PLCHandler-&gt;MConnect(iHandle, 0, iniPath, logPath);\n            if (iResult == 0)\n            {\n                connected              = true;\n                LabeledEdit1-&gt;Text     = \"CONNECTED\";\n                long int numeroSimboli = 0;\n                PLCHandler-&gt;MGetNumberOfSymbols(iHandle, &amp;numeroSimboli);\n                LabeledEdit2-&gt;Text = numeroSimboli;\n                PLCHandler-&gt;MGetPlcStatus(iHandle, &amp;iPLCStatus);\n                LabeledEdit3-&gt;Text = iPLCStatus;\n            }\n        }\n        else\n        {\n            LabeledEdit2-&gt;Text = \"ERROR: \" + (String)iResult;\n        }\n    }\n    catch (...)\n    {\n        LabeledEdit2-&gt;Text = \"ERROR\";\n    }\n}\n// ---------------------------------------------------------------------------\n</code></pre>\n\n<p><em>Unit1.h</em>   </p>\n\n<pre><code>#ifndef Unit1H\n#define Unit1H\n// ---------------------------------------------------------------------------\n#include &lt;System.Classes.hpp&gt;\n#include &lt;Vcl.Controls.hpp&gt;\n#include &lt;Vcl.StdCtrls.hpp&gt;\n#include &lt;Vcl.Forms.hpp&gt;\n#include &lt;Vcl.ExtCtrls.hpp&gt;\n#include &lt;Vcl.OleCtrls.hpp&gt;\n#include \"PLCHANDLERXLib_OCX.h\"\n\n// ---------------------------------------------------------------------------\nclass TForm1 : public TForm\n{\n__published: // IDE-managed Components\n    TTimer *      Timer1;\n    TButton *     Button1;\n    TLabeledEdit *LabeledEdit1;\n    TTimer *      Timer2;\n    TLabeledEdit *LabeledEdit2;\n    TButton *     Button3;\n    TPLCHandlerX *PLCHandler;\n    TLabeledEdit *LabeledEdit3;\n\n    void __fastcall Button1Click(TObject *Sender);\n    void __fastcall Timer1Timer(TObject *Sender);\n    void __fastcall Button2Click(TObject *Sender);\n    void __fastcall Button3Click(TObject *Sender);\n\nprivate:\n     // User declarations\npublic:  // User declarations\n\n    long int counter;\n    wchar_t* iniPath;\n    wchar_t* logPath;\n    long int iPLCStatus;\n    long int iHandle;\n    long int readSize;\n    long int writeSize;\n    long int iResult;\n    Byte     unbyte;\n    bool     connected;\n\n    __fastcall TForm1(TComponent* Owner);\n};\n\n// ---------------------------------------------------------------------------\nextern PACKAGE TForm1 *Form1;\n// ---------------------------------------------------------------------------\n#endif\n</code></pre>\n\n<p>And as requested the TLB generated by RAD Studio while importing the ActiveX</p>\n\n<p><em>.cpp File</em></p>\n\n<pre><code>// ************************************************************************ //\n// WARNING\n// -------\n// The types declared in this file were generated from data read from a\n// Type Library. If this type library is explicitly or indirectly (via\n// another type library referring to this type library) re-imported, or the\n// 'Refresh' command of the Type Library Editor activated while editing the\n// Type Library, the contents of this file will be regenerated and all\n// manual modifications will be lost.\n// ************************************************************************ //\n\n// $Rev: 87174 $\n// File generated on 14/03/2018 11:22:13 from Type Library described below.\n\n// ************************************************************************  //\n// Type Lib: C:\\PLCHandler_SDK_Windows_v16\\bin\\Windows\\PLCHandlerX.ocx (1)\n// LIBID: {BB4C0C2B-D94B-4F5C-A774-4DF59A2227FF}\n// LCID: 0\n// Helpfile: C:\\PLCHandler_SDK_Windows_v16\\bin\\Windows\\PLCHandlerX.hlp\n// HelpString: PLCHandlerX ActiveX Control module\n// DepndLst:\n//   (1) v2.0 stdole, (C:\\Windows\\SysWOW64\\stdole2.tlb)\n// SYS_KIND: SYS_WIN32\n// ************************************************************************ //\n\n#include &lt;vcl.h&gt;\n#pragma hdrstop\n\n#include \"PLCHANDLERXLib_TLB.h\"\n\n#if !defined(__PRAGMA_PACKAGE_SMART_INIT)\n#define      __PRAGMA_PACKAGE_SMART_INIT\n#pragma package(smart_init)\n#endif\n\nnamespace Plchandlerxlib_tlb\n{\n\n\n// *********************************************************************//\n// GUIDS declared in the TypeLibrary\n// *********************************************************************//\nconst GUID LIBID_PLCHANDLERXLib = {0xBB4C0C2B, 0xD94B, 0x4F5C,{ 0xA7, 0x74, 0x4D,0xF5, 0x9A, 0x22,0x27, 0xFF} };\nconst GUID DIID__DPLCHandlerX = {0xA51B6208, 0x4C76, 0x4E79,{ 0xAC, 0x93, 0xB4,0x15, 0x7D, 0x6D,0x97, 0xC5} };\nconst GUID DIID__DPLCHandlerXEvents = {0xF2CC045D, 0x93E1, 0x4FE1,{ 0xA1, 0x5F, 0xE6,0x48, 0x18, 0x85,0x35, 0x5A} };\nconst GUID CLSID_PLCHandlerX = {0x99036BDD, 0x9A94, 0x4ED2,{ 0x89, 0x61, 0x42,0x0C, 0x74, 0xDD,0x51, 0xCE} };\n\n};   \n</code></pre>\n\n<p><em>.h File</em> is too long for the question body (<a href=\"https://pastebin.com/ebs16RMN\" rel=\"nofollow noreferrer\">Full code here</a>), but the MSyncReadVarsFromPlc method is </p>\n\n<pre><code>    VARIANT __fastcall MSyncReadVarsFromPlc(long lHandle, long* plResult, BSTR pszSymbols, VARIANT SizeList, long lNumOfVars)\n    {\n        _TDispID _dispid(/* MSyncReadVarsFromPlc */ DISPID(45));\n        TAutoArgs&lt;5&gt; _args;\n        _args[1] = lHandle /*[VT_I4:0]*/;\n        _args[2] = plResult /*[VT_I4:1]*/;\n        _args[3] = pszSymbols /*[VT_BSTR:0]*/;\n        _args[4] = SizeList /*[VT_VARIANT:0]*/;\n        _args[5] = lNumOfVars /*[VT_I4:0]*/;\n        OleFunction(_dispid, _args);\n        return _args.GetRetVariant();\n    }\n</code></pre>\n\n<p>As you can see in the TLB, the MSyncReadVars method returns a VARIANT that actually contains an array of bytes with the requested variables values.</p>\n\n<p>The Variant varReceived stores the returned VARIANT but is deallocated with VarClear when finished.</p>\n\n<p>Any idea of what can generate the memory leak? </p>\n\n<p>My feeling is that the returned VARIANT from MSyncReadVarsFromPlc is not deallocated after the method execution. But I can't see any way to solve this issue, also because same usage in a Visual Studio example works fine.</p>\n\n<p>Can an ActiveX work fine in Visual Studio and not in RAD Studio?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1521034178, "post_id": 49279021, "comment_id": 85560542, "body": "If you have C++ 11, you can do following:  void do(vector&lt;C&gt;&amp;&amp; cs),  this wil move your vector instead of copying int. But if you&#39;d like to use it in the calling function, simply do it like void do(vector&lt;C&gt;&amp; cs)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 2, "creation_date": 1521034219, "post_id": 49279021, "comment_id": 85560573, "body": "@VictorGubin - The answer section is down there. If I suspect correctly and you intend to post code in a comment, don&#39;t."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1521034224, "post_id": 49279021, "comment_id": 85560575, "body": "Can <code>C</code>&#39;s be moved?  If so C++11 and above vectors support moving elements instead of copying them."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1521034330, "post_id": 49279021, "comment_id": 85560658, "body": "<code>type_traits</code>, <code>enable_if</code>, <i>et al.</i> can presumably help here."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1521038549, "post_id": 49279021, "comment_id": 85563796, "body": "<code>do</code> is an invalid function name... <code>do while</code>."}], "answers": [{"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521035256, "post_id": 49279327, "comment_id": 85561428, "body": "My actual code is more complex than just looping over the vector and applying a function to it though, so I&#39;ll basically just be copying and pasting the entire function which is what I want to avoid."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521035458, "post_id": 49279327, "comment_id": 85561603, "body": "Then do not pass argument directly to <code>f</code> but have helper function, that passes reference directly and dereferences pointer."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521035807, "post_id": 49279327, "comment_id": 85561878, "body": "Sorry I don&#39;t see how that prevents copying and pasting lots of the function, since it can&#39;t all be bundled neatly into an <code>f()</code> function that operates on each element independently."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521038122, "post_id": 49279327, "comment_id": 85563481, "body": "See my updated answer and new example. Note you can use <code>apply_helper</code>  without functor ie directly like <code>apply_helper(elem).do_whatever()</code>"}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521046982, "post_id": 49279327, "comment_id": 85570091, "body": "Ah ok, in that case you do need the <code>class T</code> template, and this was something I specifically wanted to avoid (see &quot;I could get around it by giving up...&quot; in the question)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521047149, "post_id": 49279327, "comment_id": 85570201, "body": "&quot;and this was something I specifically wanted to avoid&quot; you either write generic code or write it for each type manually. And your reasoning why you want to avoid template is not clear."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521047481, "post_id": 49279327, "comment_id": 85570414, "body": "It&#39;s not unclear: &quot;it makes do() easier to understand if you don&#39;t have to go hunting around for places where it is used&quot; (and there are other reasons, e.g. code completion). But I think you are right there is no way to do this without fully generic code. That was kind of the point of the question - I want something generic wrt &quot;pointerness&quot; but <i>not</i> generic wrt the specific class. I guess this is something C++ lacks. (Other languages like Java don&#39;t have this issue because <i>everything</i> is a pointer)"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521047647, "post_id": 49279327, "comment_id": 85570533, "body": "@Timmmm &quot;I guess this is something C++ lacks.&quot; strange conclusion. Limit yourself to only using pointers and here you go - you problem is solved. Or you want to get flexibility and not to pay for that? No way, sorry."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521107490, "post_id": 49279327, "comment_id": 85594350, "body": "&quot;No way, sorry&quot; - err yeah because C++ doesn&#39;t support it."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521120592, "post_id": 49279327, "comment_id": 85603167, "body": "No, because there are no free lunches in this world. You do not have this issue in Java because it does not support objects by value, not vice versa"}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521191174, "post_id": 49279327, "comment_id": 85634729, "body": "Come on, use your imagination! C++ could definitely support a templating type thing that <i>only</i> templates out the pointer-ness of a class. Not saying it&#39;s a good idea but I can&#39;t see any reason why it wouldn&#39;t be possible."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521205963, "post_id": 49279327, "comment_id": 85644315, "body": "Just because you do not like or do not understand templates? No way."}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1521038020, "last_edit_date": 1521038020, "creation_date": 1521034985, "answer_id": 49279327, "question_id": 49279021, "link": "https://stackoverflow.com/questions/49279021/make-function-generic-with-respect-to-pointers-and-references/49279327#49279327", "title": "Make function generic with respect to pointers and references", "body": "<p>Just write 2 template functions that applies a functor:</p>\n\n<pre><code>template&lt;class T,typename Func&gt;\nvoid apply( const std::vector&lt;T&gt; &amp;v, Func f )\n{\n    for( const auto &amp;i : v ) f( i );\n}\n\ntemplate&lt;class T,typename Func&gt;\nvoid apply( const std::vector&lt;T*&gt; &amp;v, Func f )\n{\n    for( auto i : v ) f( *i );\n}\n</code></pre>\n\n<p>then pass a lambda:</p>\n\n<pre><code>std::vector&lt;C&gt; vc;\nstd::vector&lt;C*&gt; vp;\nauto call = []( const C &amp;c ) { c.do_whatever(); };\napply( vc, call );\napply( vp, call );\n</code></pre>\n\n<p>(note you cannot call your function <code>do</code> - it is a keyword in C++)</p>\n\n<p><a href=\"https://ideone.com/Skvqn3\" rel=\"nofollow noreferrer\">live example</a></p>\n\n<p>PS As you mentioned in comments your function <code>apply</code> is rather complex so you prefer to have only one copy of it, in this case create a helper:</p>\n\n<pre><code>template&lt;class T&gt;\nconst T &amp;apply_helper( const T *t ) { return *t; }\n\ntemplate&lt;class T&gt;\ntypename std::enable_if&lt;!std::is_pointer&lt;T&gt;::value, const T &amp;&gt;::type \napply_helper( const T &amp;t )  { return t; }\n</code></pre>\n\n<p>then write your <code>apply</code> function only once:</p>\n\n<pre><code>template&lt;class T,typename Func&gt;\nvoid apply( const std::vector&lt;T&gt; &amp;v, Func f )\n{\n    for( const auto &amp;i : v ) f( apply_helper( i ) );\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/FtaLXn\" rel=\"nofollow noreferrer\">live example N2</a></p>\n"}, {"comments": [{"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521035667, "post_id": 49279364, "comment_id": 85561750, "body": "Yeah this is basically the solution I put in the question. :-/"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521035781, "post_id": 49279364, "comment_id": 85561858, "body": "@Timmmm: I think this is quite different. In the question, you had to specialize the entirely of your <code>do</code> function. If you look closely here, you are only specializing the accessor for the vector. You will have to handle references and pointers separately in any solution you do, I feel like this answer does it in the smallest scope possible."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521035946, "post_id": 49279364, "comment_id": 85561982, "body": "Yeah I didn&#39;t put the full code but it is the solution I meant. <code>template&lt;typename T&gt; void do(const vector&lt;T&gt;&amp; cs) {</code> is the same as <code>template&lt;class T&gt; void do_a_thing(const std::vector&lt;T&gt;&amp; cs) {</code>."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521036371, "post_id": 49279364, "comment_id": 85562302, "body": "@Timmmm: I meant for <code>do_a_thing</code> to represent your <code>do</code> function; this isn&#39;t a new function I&#39;m advocating for, <code>do</code> is a reserved keyword in C++ so you have to name the function something else."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521036543, "post_id": 49279364, "comment_id": 85562429, "body": "Yeah... I know...? Sorry I think we are probably agreeing with each other!"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "edited": false, "score": 0, "creation_date": 1521037096, "post_id": 49279364, "comment_id": 85562799, "body": "@Timmmm: I think you&#39;re right. I updated the post, is this any better?"}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 1, "last_activity_date": 1521037074, "last_edit_date": 1521037074, "creation_date": 1521035095, "answer_id": 49279364, "question_id": 49279021, "link": "https://stackoverflow.com/questions/49279021/make-function-generic-with-respect-to-pointers-and-references/49279364#49279364", "title": "Make function generic with respect to pointers and references", "body": "<p>You might keep your <code>do</code> function generic, but specialize a getter for <code>T&amp;</code> and <code>T*</code> that both return a <code>T&amp;</code>:</p>\n\n<pre><code>namespace detail{\n    template&lt;class T&gt;\n    T&amp; get(T&amp; _in){\n        return _in;\n    }\n\n    template&lt;class T&gt;\n    T&amp; get(T* _in){\n        return *_in;\n    }\n} // namespace detail\n\ntemplate&lt;class T&gt;\nvoid do_a_thing(const std::vector&lt;T&gt;&amp; cs) {\n   for (size_t i = 0; i &lt; cs.size(); ++i) {\n      detail::get(cs[i]).do_whatever();\n   }\n}\n</code></pre>\n\n<h3><a href=\"https://wandbox.org/permlink/s1od1VmcS4TTMtvC\" rel=\"nofollow noreferrer\">Demo</a></h3>\n\n<p>Either way you are going to need to specialize between pointers and references. I think that this pushes it to the smallest scope.</p>\n\n<hr>\n\n<p>If you want to constrain <code>do_a_thing</code> to only accept <code>C</code> or <code>C*</code>, we can create a small trait to do this:</p>\n\n<pre><code>template &lt;class T&gt;\nstruct is_c : std::false_type{};\n\ntemplate &lt;&gt;\nstruct is_c&lt;C&gt;: std::true_type{};\n\ntemplate &lt;&gt;\nstruct is_c&lt;C*&gt;: std::true_type{};\n</code></pre>\n\n<p>And then modify <code>do_a_thing</code> with <code>std::enable_if</code>:</p>\n\n<pre><code>template&lt;class T, std::enable_if_t&lt;is_c&lt;T&gt;::value, int&gt; = 0&gt;\nvoid do_a_thing(const std::vector&lt;T&gt;&amp; cs) {\n   for (size_t i = 0; i &lt; cs.size(); ++i) {\n      detail::get(cs[i]).do_whatever();\n   }\n}\n</code></pre>\n\n<p>For bonus points, we'll write another specialization of <code>do_a_thing</code> that gives a nice compiler error for types that do not satisfy the constraint:</p>\n\n<pre><code>template&lt;class T&gt;\nstruct always_false : std::false_type{};\n\ntemplate&lt;class T, std::enable_if_t&lt;!is_c&lt;T&gt;::value, int&gt; = 0&gt;\nvoid do_a_thing(const std::vector&lt;T&gt;&amp; cs) {\n   static_assert(always_false&lt;T&gt;::value, \"do_a_thing only works for C and C*\");\n}\n</code></pre>\n\n<p>Now the following will fail:</p>\n\n<pre><code>struct Q{};\nstd::vector&lt;Q&gt; qs;\ndo_a_thing(qs); // compiler error\n</code></pre>\n\n<h2><a href=\"https://wandbox.org/permlink/ZFih8nrOLNZ4Tqa4\" rel=\"nofollow noreferrer\">Demo</a></h2>\n"}, {"comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1521038652, "post_id": 49279888, "comment_id": 85563869, "body": "At that point you might as well use a <code>variant</code> and a visitor pattern. Otherwise the class is hard to reason about."}, {"owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1521047215, "post_id": 49279888, "comment_id": 85570234, "body": "You mean something like <code>void do_thing(variant&lt;vector&lt;C&gt;, vector&lt;C*&gt;&gt; wrapper) { ...</code>? Good point. I think using the visitor pattern would be extremely verbose but you could write a generic accessor for the variant."}], "tags": [], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "is_accepted": false, "score": 0, "last_activity_date": 1521036499, "creation_date": 1521036499, "answer_id": 49279888, "question_id": 49279021, "link": "https://stackoverflow.com/questions/49279021/make-function-generic-with-respect-to-pointers-and-references/49279888#49279888", "title": "Make function generic with respect to pointers and references", "body": "<p>I think a possible solution could be to create a modified <code>vector</code> class that is generic with respect to pointerness, and can be implicitly converted to from a <code>vector&lt;T&gt;</code> or a <code>vector&lt;T*&gt;</code>. Like this:</p>\n\n<pre><code>template&lt;typename T&gt;\nclass VectorWrapper {\npublic:\n    VectorWrapper(const vector&lt;T&gt;&amp; v) : reference(&amp;v) { }\n    VectorWrapper(const vector&lt;T*&gt;&amp; v) : pointer(&amp;v) { }\n\n    const T&amp; at(int idx) const {\n        if (reference)\n           return (*reference)[idx];\n        return *(*pointer)[idx];\n    }\n\n    // etc. for size() and so on. You could probably have\n    // this class derive from std::vector and reimplement its\n    // methods to switch between `reference` and `pointer`.\n\nprivate:\n    const vector&lt;T&gt;* reference = nullptr;\n    const vector&lt;T*&gt;* pointer = nullptr;\n};\n\nvoid do_thing(VectorWrapper&lt;C&gt; wrapper) {\n    wrapper.at(0).whatever();\n}\n</code></pre>\n\n<p>Not tested, and I don't think I'll go this route to be honest but it's the best I could come up with.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1521038562, "last_edit_date": 1521038562, "creation_date": 1521037461, "answer_id": 49280217, "question_id": 49279021, "link": "https://stackoverflow.com/questions/49279021/make-function-generic-with-respect-to-pointers-and-references/49280217#49280217", "title": "Make function generic with respect to pointers and references", "body": "<p>Write a function template that gets a <em>pair of iterators</em> (not a vector).</p>\n\n<p>Then pass it either normal <code>vector&lt;C&gt;::iterator</code>s, or <em>adapted</em> <code>vector&lt;C*&gt;::iterator</code>s, e.g. <code>boost::transform_iterator</code> instances.</p>\n\n<p>Working example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n#include &lt;boost/iterator/transform_iterator.hpp&gt;\n\nint&amp; deref(int*&amp; x) { return *x; }\n\ntemplate &lt;class it&gt;\nvoid print(it from, it to)\n{\n    std::copy(from, to, std::ostream_iterator&lt;typename it::value_type&gt;(std::cout, \" \"));\n    std::cout &lt;&lt; \"\\n\";\n}\n\nint main()\n{\n    std::vector&lt;int&gt; a {4,3,7,1};\n    std::vector&lt;int*&gt; b {new int(2), new int(0), new int(11), new int(-3)};\n\n    //    auto deref = [](int*&amp; x) -&gt; int&amp; { return *x; };\n    //    cannot use a lambda here because it's non-copyable\n    //    and iterators must be copyable.\n\n    std::sort(std::begin(a), std::end(a));\n    std::sort(boost::make_transform_iterator(std::begin(b), &amp;deref),\n              boost::make_transform_iterator(std::end(b), &amp;deref));\n\n    print(std::begin(a), std::end(a));\n    print(boost::make_transform_iterator(std::begin(b), &amp;deref),\n          boost::make_transform_iterator(std::end(b), &amp;deref));\n\n}\n</code></pre>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1521038562, "creation_date": 1521034088, "question_id": 49279021, "link": "https://stackoverflow.com/questions/49279021/make-function-generic-with-respect-to-pointers-and-references", "title": "Make function generic with respect to pointers and references", "body": "<p>Suppose I have this C++ function:</p>\n\n<pre><code>class C { ... };\n\nvoid do(const vector&lt;C&gt;&amp; cs) {\n   ...\n   for (...) {\n      cs[i].do_whatever();\n   }\n   ...\n}\n</code></pre>\n\n<p>But <code>C</code> is expensive to copy so I might have something like this:</p>\n\n<pre><code>std::vector&lt;C*&gt; reorder_in_some_way(const std::vector&lt;C&gt;&amp; cs) {\n   ...\n}\n\nint main() {\n   std::vector&lt;C&gt; cs = ...;\n\n   std::vector&lt;C*&gt; reorderedCs = reorder_in_some_way(cs);\n\n   do(reorderedCs);\n}\n</code></pre>\n\n<p>Obviously this won't work. I could get around it by giving up and just making <code>do</code> a template over <em>any</em> type like this:</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid do(const vector&lt;T&gt;&amp; cs) {\n</code></pre>\n\n<p>But it really only works with <code>C</code>'s and I'd like that to be encoded in the type system - and also it makes <code>do()</code> easier to understand if you don't have to go hunting around for places where it is used.</p>\n\n<p>Is there any way to write <code>do()</code> so that it can generically take both <code>vector&lt;C&gt;</code> and <code>vector&lt;C*&gt;</code> (and for bonus points <code>vector&lt;reference_wrapper&lt;C&gt;&gt;</code>)?</p>\n"}, {"tags": ["c++", "cmake"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521033483, "post_id": 49278766, "comment_id": 85560006, "body": "If you think the error is in your <code>CMakeLists.txt</code> file, how would we be able to find it and help you if you don&#39;t show it to us? Also, how do you invoke <code>cmake</code>? Please edit your question to include that information."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "edited": false, "score": 0, "creation_date": 1521034857, "post_id": 49279089, "comment_id": 85561094, "body": "you&#39;re right,I should choose Visual Studio 14 Win64,but it get more complecated,Cmake shows:CMake Error: Could not find cmake module file: CMakeDetermineC++Compiler.cmake CMake Error: Could not find cmake module file: E:/cmake_test/CMakeFiles/3.11.0-rc3/CMakeC++Compiler.cmake CMake Error at CMakeLists.txt:51 (project):   No CMAKE_C++_COMPILER could be found. CMake Error: Could not find cmake module file: CMakeC++Information.cmake"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "edited": false, "score": 0, "creation_date": 1521035162, "post_id": 49279089, "comment_id": 85561362, "body": "I would delete your build folder for this project and downgrade CMake to the latest released version 3.10.2. Install that using the installer from here: <a href=\"https://cmake.org/download\" rel=\"nofollow noreferrer\">cmake.org/download</a> . CMake should not be installed  in E:/cmake_test. The error says that parts of CMake are missing."}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "edited": false, "score": 0, "creation_date": 1521035509, "post_id": 49279089, "comment_id": 85561633, "body": "I installed Cmake in C disk by the default set ,the dir of source code is E:/LZO/lzo-2.10,the dir to build  the binaries is E:/cmake_test ,the version of  Cmake is 3.11.0,I will try another version"}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "edited": false, "score": 0, "creation_date": 1521116748, "post_id": 49279089, "comment_id": 85600470, "body": "I get the reason now,it&#39;s because of the source code,there must be some bugs in the original files of LZO in version 2.10.When I use version 2.08 to create VS project,it works!"}], "tags": [], "owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "is_accepted": true, "score": 0, "last_activity_date": 1521034281, "creation_date": 1521034281, "answer_id": 49279089, "question_id": 49278766, "link": "https://stackoverflow.com/questions/49278766/when-use-cmake-to-compile-lzo-it-notes-that-cant-find-any-instance-of-vs/49279089#49279089", "title": "When use Cmake to compile LZO,it notes that can&#39;t find any instance of VS", "body": "<p><strong><em>Generator Visual Studio 15 2017 Win64</em></strong> is the wrong generator for Visual Studio 2015. You need <code>Visual Studio 14 2015 Win64</code> if you have any trouble with that execute cmake-gui from a Visual Studio 2015 x64 command prompt so you have the compiler environment variables setup.</p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1521117477, "creation_date": 1521117477, "answer_id": 49299681, "question_id": 49278766, "link": "https://stackoverflow.com/questions/49278766/when-use-cmake-to-compile-lzo-it-notes-that-cant-find-any-instance-of-vs/49299681#49299681", "title": "When use Cmake to compile LZO,it notes that can&#39;t find any instance of VS", "body": "<p>When I used LZO of version 2.08,the errors disappeared!So I think there must be some bugs in the original files of LZO in version 2.10.</p>\n"}], "owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 49279089, "answer_count": 2, "score": 1, "last_activity_date": 1521117477, "creation_date": 1521033360, "last_edit_date": 1521034486, "question_id": 49278766, "link": "https://stackoverflow.com/questions/49278766/when-use-cmake-to-compile-lzo-it-notes-that-cant-find-any-instance-of-vs", "title": "When use Cmake to compile LZO,it notes that can&#39;t find any instance of VS", "body": "<p>I have installed VS2015 (win64) and I wanna use Cmake to compile LZO to generate a VS project,but the Cmake show this:</p>\n\n<pre><code>CMake Error at CMakeLists.txt:51 (project):\n  Generator\n    Visual Studio 15 2017 Win64\n  could not find any instance of Visual Studio.\n</code></pre>\n\n<p>I think the problem may come from the Cmakelist.txt document,but I don't know how to fix it...\nThe 51 row of CmakeList.txt file is:</p>\n\n<pre><code>if(\",${CMAKE_SOURCE_DIR},\" STREQUAL \",${CMAKE_BINARY_DIR},\")\n    message(FATAL_ERROR \"ERROR: In-source builds are not allowed.\")\nendif()\n\nif(NOT CMAKE_BUILD_TYPE)\n    set(CMAKE_BUILD_TYPE \"Release\" CACHE STRING \"\" FORCE)\nendif()\n\nproject(lzo VERSION 2.10 LANGUAGES C++)\n</code></pre>\n"}, {"tags": ["c++", "boost", "c++17"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1521033328, "post_id": 49278691, "comment_id": 85559906, "body": "If memory allocations and indirection are a concern you should not be using <code>any</code> at all."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1521033937, "post_id": 49278691, "comment_id": 85560361, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/41878040/does-boostany-stdany-store-small-objects-in-place\" title=\"does boostany stdany store small objects in place\">stackoverflow.com/questions/41878040/&hellip;</a>"}, {"owner": {"reputation": 1833, "user_id": 1900563, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2094e3540201216badc3c0e707183d7a?s=128&d=identicon&r=PG", "display_name": "Spiros", "link": "https://stackoverflow.com/users/1900563/spiros"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1521034260, "post_id": 49278691, "comment_id": 85560605, "body": "@MaximEgorushkin: they are not a concern, but I would like to know what happens in what case."}], "answers": [{"comments": [{"owner": {"reputation": 1833, "user_id": 1900563, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2094e3540201216badc3c0e707183d7a?s=128&d=identicon&r=PG", "display_name": "Spiros", "link": "https://stackoverflow.com/users/1900563/spiros"}, "edited": false, "score": 0, "creation_date": 1521037896, "post_id": 49279996, "comment_id": 85563313, "body": "Thanks for the answer. An <a href=\"https://stackoverflow.com/a/41887519/1900563\">answer in the linked question</a> says that boost never applies small object optimization. That answer is of year old. Did the boost implementation change I the meantime?"}, {"owner": {"reputation": 8115, "user_id": 4636534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GoTz67GRao8/AAAAAAAAAAI/AAAAAAAAADI/PyDv-i56924/photo.jpg?sz=128", "display_name": "Andrey Semashev", "link": "https://stackoverflow.com/users/4636534/andrey-semashev"}, "edited": false, "score": 0, "creation_date": 1521192522, "post_id": 49279996, "comment_id": 85635519, "body": "<code>boost::any</code> does not implement small object optimization."}, {"owner": {"reputation": 1833, "user_id": 1900563, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2094e3540201216badc3c0e707183d7a?s=128&d=identicon&r=PG", "display_name": "Spiros", "link": "https://stackoverflow.com/users/1900563/spiros"}, "edited": false, "score": 0, "creation_date": 1521209555, "post_id": 49279996, "comment_id": 85646800, "body": "Thanks for editing the answer. Do standard libraries implement small object optimizations, that you know?"}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 5, "last_activity_date": 1521204461, "last_edit_date": 1521204461, "creation_date": 1521036869, "answer_id": 49279996, "question_id": 49278691, "link": "https://stackoverflow.com/questions/49278691/differences-between-boostany-and-stdany/49279996#49279996", "title": "Differences between `boost::any` and `std::any`", "body": "<blockquote>\n  <p>I'm interested to the differences between the behavior and the guarantees.</p>\n</blockquote>\n\n<p>There aren't any behavioral differences; not really. They both have the same requirements on the ValueType (copy-constructible, and a destructor that doesn't emit exceptions). They both provide the same operations on the values they store, with pretty much identical exception guarantees.</p>\n\n<p>The principle difference is that <code>boost::any</code>'s implementation at present doesn't implement small object optimization, while <code>std::any</code> implementations <em>may</em> provide it.</p>\n"}], "owner": {"reputation": 1833, "user_id": 1900563, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2094e3540201216badc3c0e707183d7a?s=128&d=identicon&r=PG", "display_name": "Spiros", "link": "https://stackoverflow.com/users/1900563/spiros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1390, "favorite_count": 1, "accepted_answer_id": 49279996, "answer_count": 1, "score": 11, "last_activity_date": 1521204461, "creation_date": 1521033150, "question_id": 49278691, "link": "https://stackoverflow.com/questions/49278691/differences-between-boostany-and-stdany", "title": "Differences between `boost::any` and `std::any`", "body": "<p>C++17 introduces the object container <a href=\"http://en.cppreference.com/w/cpp/header/any\" rel=\"noreferrer\"><code>std::any</code></a>, based on the boost library <a href=\"http://www.boost.org/doc/libs/1_66_0/doc/html/any.html\" rel=\"noreferrer\"><code>boost::any</code></a>.\nMy question is: Is the standardized <code>any</code> equivalent to the boost version, or are there differences?</p>\n\n<p>A <a href=\"https://stackoverflow.com/questions/40201371/what-are-the-differences-between-stdvariant-and-boostvariant\">similar question has been posted about <code>variant</code></a>, and some differences exist in that case, but I could not find references about <code>any</code>.</p>\n\n<hr>\n\n<p>EDIT: A difference I could see is the availability of the methods <code>emplace</code>. More than a difference in the API I'm interested to the differences between the behavior and the guarantees. For instance, different allocations would be significant for me.</p>\n"}]