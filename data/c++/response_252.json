[{"tags": ["c++", "vector", "c++17", "copy-constructor", "move-semantics"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573084271, "post_id": 58740022, "comment_id": 103769999, "body": "I see no way to avoid copying objects when placing them into a vector, whether during construction or after. This can&#39;t be done. A vector requires, at a minimum, a copyable boject."}, {"owner": {"reputation": 766, "user_id": 6926706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/551619408360290/picture?type=large", "display_name": "Kirill Korolev", "link": "https://stackoverflow.com/users/6926706/kirill-korolev"}, "edited": false, "score": 2, "creation_date": 1573085312, "post_id": 58740022, "comment_id": 103770212, "body": "What do you mean by compile time check? Please, give an example"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1573085340, "post_id": 58740022, "comment_id": 103770223, "body": "Another possibility is to allocate the objects on the heap and store their pointers (or use smart pointers)"}], "answers": [{"comments": [{"owner": {"reputation": 1661, "user_id": 5141619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaaef6fdf502d7df2b2be002fa9ad51c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5141619/max"}, "edited": false, "score": 0, "creation_date": 1573085991, "post_id": 58740234, "comment_id": 103770364, "body": "looks like my solution is going to involve the array! Thank you"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 1661, "user_id": 5141619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaaef6fdf502d7df2b2be002fa9ad51c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5141619/max"}, "edited": false, "score": 0, "creation_date": 1573086214, "post_id": 58740234, "comment_id": 103770412, "body": "@Max <code>std::array</code> is the right idea, unfortunately the <code>explicit</code> constructor will make this a bit trickier than advertised. I don&#39;t have a good solution for that or I&#39;d have written an answer half an hour ago."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1573086295, "post_id": 58740234, "comment_id": 103770431, "body": "And I&#39;m stupid. It&#39;s what you were trying with the <code>vector</code>: <code>std::array&lt;MyClass, 3&gt; v = {MyClass(0), MyClass(1), MyClass(2)};</code>"}], "tags": [], "owner": {"reputation": 4802, "user_id": 921070, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f584b200a79f438d9092d7f76da7ede6?s=128&d=identicon&r=PG", "display_name": "Dean Seo", "link": "https://stackoverflow.com/users/921070/dean-seo"}, "is_accepted": true, "score": 6, "last_activity_date": 1573086432, "last_edit_date": 1573086432, "creation_date": 1573085865, "answer_id": 58740234, "question_id": 58740022, "link": "https://stackoverflow.com/questions/58740022/c17-add-class-with-deleted-copy-constructor-to-stdvector-at-compile-time/58740234#58740234", "title": "c++17 add class with deleted copy constructor to std::vector at compile time", "body": "<blockquote>\n  <p>My compiler is telling me that the STL requires the use of my deleted copy constructor <code>MyClass::MyClass(const MyClass&amp;)</code> but is there any way around this?</p>\n</blockquote>\n\n<p>No, you can't. </p>\n\n<p><code>initializer_list</code> creates a hidden array for you, which is declared <code>const</code>, being estimated like this:</p>\n\n<pre><code>// pseudo code\nconst MyClass __arr[3] = { MyClass(1), MyClass(2), MyClass(3) };\nstd::vector&lt;MyClass&gt; v{ std::initializer_list&lt;MyClass&gt;{ __arr, __arr + 2 } }; \n</code></pre>\n\n<p>If you want to avoid copying, you'll have to stick to <code>emplace_back</code> like you said.</p>\n\n<blockquote>\n  <p>I am already aware of a possible way to add values at runtime ...</p>\n</blockquote>\n\n<p>By the way, the example you gave is <strong>not</strong> a proper way to use <code>emplace_back</code>:</p>\n\n<pre><code>std::vector&lt;MyClass&gt; v;\nv.emplace_back(MyClass{0});\nv.emplace_back(MyClass{1});\nv.emplace_back(MyClass{2});\n</code></pre>\n\n<p>You're still creating <code>MyClass</code> and then move it to <code>v</code>, which is quite a common mistake when using <code>emplace</code>-ish functions. </p>\n\n<p>What you really wanted to do is probably as follows:</p>\n\n<pre><code>v.reserve(3);\nv.emplace_back(0);\nv.emplace_back(1);\nv.emplace_back(2);\n</code></pre>\n\n<p>This way you're avoiding <em>accidentally</em> invoking move constructor, and just constructing the object at the right place <strong>only once with no move, and no copy</strong>.</p>\n\n<blockquote>\n  <p>The goal is then to add my class to a <code>std::vector</code> at compile time.</p>\n</blockquote>\n\n<p>If you want to create an array at compile time, use <code>std::array</code> instead.\n<code>std::array</code> is exactly designed for that purpose:</p>\n\n<pre><code>std::array&lt;MyClass, 3&gt; v = { 1, 2, 3 };\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 5141619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaaef6fdf502d7df2b2be002fa9ad51c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5141619/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58740234, "answer_count": 1, "score": 1, "last_activity_date": 1573086432, "creation_date": 1573084026, "question_id": 58740022, "link": "https://stackoverflow.com/questions/58740022/c17-add-class-with-deleted-copy-constructor-to-stdvector-at-compile-time", "title": "c++17 add class with deleted copy constructor to std::vector at compile time", "body": "<p>Below is a class that I've defined with a deleted copy constructor and copy assignment operator. This is the only assumption that has to be made.</p>\n\n<pre><code>class MyClass\n{\n    public:\n    explicit MyClass(int i) : i(i) {}\n\n    MyClass(const MyClass&amp;) = delete;\n    MyClass&amp; operator=(const MyClass&amp;) = delete;\n\n    MyClass(MyClass&amp;&amp; other) :\n        i(std::move(other.i))\n        {}  \n\n    MyClass&amp; operator=(MyClass&amp;&amp; other) {\n        i = std::move(other.i);\n        return *this;\n    }   \n\n    private:\n    int i;\n};\n</code></pre>\n\n<p>The goal is then to add my class to a std::vector at compile time.</p>\n\n<pre><code>int main()\n{\n    std::vector&lt;MyClass&gt; v{MyClass{0}, MyClass{1}, MyClass{2}};\n\n    return 0;\n}\n</code></pre>\n\n<p>My compiler is telling me that the STL requires the use of my deleted copy constructor <code>MyClass::MyClass(const MyClass&amp;)</code> but is there any way around this?</p>\n\n<p>I am already aware of a possible way to add values at runtime but the below is a poor solution in my opinion because I've lost the compile time check.</p>\n\n<pre><code>int main()\n{\n    std::vector&lt;MyClass&gt; v;\n    v.emplace_back(MyClass{0});\n    v.emplace_back(MyClass{1});\n    v.emplace_back(MyClass{2});\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "opengl", "glut"], "comments": [{"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573083999, "post_id": 58739986, "comment_id": 103769938, "body": "You&#39;re probably getting a <code>WM_ERASE</code> message."}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1573084054, "post_id": 58739986, "comment_id": 103769948, "body": "Your drawing only happens in the mouse down code.. Buffers in OpenGL are swapped (in your case: <code>glutSwapBuffers</code>).. you aren&#39;t drawing every frame so it gets wiped when the next frame renders."}, {"owner": {"reputation": 35, "user_id": 12031885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f647614a9d23f5018de594be991fe0?s=128&d=identicon&r=PG&f=1", "display_name": "laklaklak", "link": "https://stackoverflow.com/users/12031885/laklaklak"}, "edited": false, "score": 0, "creation_date": 1573084282, "post_id": 58739986, "comment_id": 103770002, "body": "If I swapped already... why it swaps back?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1573084617, "post_id": 58739986, "comment_id": 103770060, "body": "Don&#39;t draw in your input callbacks, latch some state &amp; request a re-call of your display callback via <code>glutPostRedisplay()</code> and do the drawing there."}], "answers": [{"tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 0, "last_activity_date": 1573087312, "creation_date": 1573087312, "answer_id": 58740413, "question_id": 58739986, "link": "https://stackoverflow.com/questions/58739986/why-my-drawings-disappear-after-i-release-my-left-click/58740413#58740413", "title": "Why my drawings disappear after I release my left click?", "body": "<p>Yeah, there's quite a lot wrong with your approach here. In almost all cases, your draw function should be data driven <em>(i.e. data controls what is drawn, and nothing but data!)</em>. Something along these lines:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// use this vector to store all of the point clicks\nstd::vector&lt;Vector&gt; points;\n\nvoid onDisplay() {\n\n  // now just render each vertex making up the lines\n  glBegin(GL_LINES);\n  for(auto p : points)\n    glVertex2f(p.x, p.y);\n  glEnd();\n\n  glutSwapBuffers();\n}\n</code></pre>\n\n<p>Next up, you will need to track the state of the mouse, so with the aim of keeping this as simple as possible <em>(you may want to track the mouse position, and other button states as well, but this is a minimal example)</em>. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool leftHeld = false;\n</code></pre>\n\n<p>Next up your mouse function will now do the following:</p>\n\n<ol>\n<li>When the left button is pressed, add a new vertex to the points array.</li>\n<li>When left button is released, update the position of the last point in the array</li>\n<li>When the right button is pressed (and the left button is not pressed), clear the array of points. </li>\n</ol>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void onMouse(int button, int state, int x, int y) {\n  switch(button) {\n  case GLUT_LEFT_BUTTON:\n    {\n      leftHeld = state == GLUT_DOWN;\n      if(leftHeld)\n      {\n        points.push_back(convertToNdc(x, y)); // add new point\n      }\n      else\n        points.back() = convertToNdc(x, y); // update last point\n    }\n    break;\n\n  // on right click, empty the array\n  // (but only if the left mouse button isn't currently pressed!)\n  case GLUT_RIGHT_BUTTON: \n    if(!leftHeld &amp;&amp; state == GLUT_DOWN)\n      points.clear();\n    break;\n  }\n  glutPostRedisplay();\n}\n</code></pre>\n\n<p>Finally, if you want to see the lines update as you click and drag on the screen, you'll need to register a mouse motion function to update the last point in the array</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// register with glutMotionFunc. \n// code updates last coordinate whilst mouse is moving, and\n// the left button is held. \nvoid onMouseMove(int x, int y) {\n  if(leftHeld)\n  {\n    points.back() = convertToNdc(x, y);\n  }\n  glutPostRedisplay();\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 12031885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f647614a9d23f5018de594be991fe0?s=128&d=identicon&r=PG&f=1", "display_name": "laklaklak", "link": "https://stackoverflow.com/users/12031885/laklaklak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573087312, "creation_date": 1573083794, "last_edit_date": 1573084405, "question_id": 58739986, "link": "https://stackoverflow.com/questions/58739986/why-my-drawings-disappear-after-i-release-my-left-click", "title": "Why my drawings disappear after I release my left click?", "body": "<p>So I am trying to draw lines in OpenGL between the points where I click. The drawing is on the screen if I am pressing the left click, but it disappears if I release my left click:</p>\n\n<pre><code>struct Vector {\n    float x, y;\n    Vector(float x = 0, float y = 0) : x(x), y(y) {}\n\n} last_mouse_pos;\n\nvoid onInitialization() {\n    glClearColor(0, 0, 0, 0); // A hatterszin beallitasa.\n    glClear(GL_COLOR_BUFFER_BIT); // A kepernyo torlese, az uj hatterszinnel.\n}\n\nvoid onDisplay() {\n    glutSwapBuffers();\n}\n\nVector convertToNdc(float x, float y) {\n    Vector ret;\n    ret.x = (x - kScreenWidth / 2) / (kScreenWidth / 2);\n    ret.y = (kScreenHeight / 2 - y) / (kScreenHeight / 2);\n    return ret;\n}\n\nint i = 0;\n\nvoid onMouse(int button, int state, int x, int y) {\n\n    if (button == GLUT_RIGHT_BUTTON &amp;&amp; state == GLUT_DOWN) {\n        glClear(GL_COLOR_BUFFER_BIT); \n        glutPostRedisplay(); \n    }\n    else if (button == GLUT_LEFT_BUTTON) {\n        if (state == GLUT_DOWN) {\n            i++;\n            if (i == 1) last_mouse_pos = convertToNdc(x, y);\n            if (i &gt; 1) {\n                Vector pos = convertToNdc(x, y);\n                glBegin(GL_LINES);  \n                glVertex2f(last_mouse_pos.x, last_mouse_pos.y);\n                glVertex2f(pos.x, pos.y);\n                glEnd();\n                glutPostRedisplay();\n                last_mouse_pos = pos; \n            }\n        }\n    }\n}\n</code></pre>\n\n<p>So I make 2 points, it draws the line if I am keep pressing the left click, if I release it, the screen gets black. If I click somewhere else, now I have 2 lines but only if I am pressing the left click. If I release, all of it gets black again.</p>\n"}, {"tags": ["c++", "xcode", "multithreading", "stdthread"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573083350, "post_id": 58739885, "comment_id": 103769779, "body": "No, this code will not work. It&#39;s almost a guaranteed crash."}, {"owner": {"reputation": 39, "user_id": 11909399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iq53-KRG2T8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resUAXpRIZD89-J8gJ7_5LZGiIGyA/photo.jpg?sz=128", "display_name": "user11909399", "link": "https://stackoverflow.com/users/11909399/user11909399"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573083975, "post_id": 58739885, "comment_id": 103769930, "body": "Thanks. So, how can I pass a string from the main thread to a child thread?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573084177, "post_id": 58739885, "comment_id": 103769968, "body": "Start with figuring out the compilation error. The shown code compiles without issues for me, once I add all the missing includes. Then, you have to make sure that the string/pointer, whatever being passed to the new thread is valid. This is what you were getting to in your question. But your <code>main()</code> returns immediately, there&#39;s no guarantee that the string will still exist when the new execution thread starts. This is a guaranteed crash anyway, since you must <code>join()</code> a new execution thread before its <code>std::thread</code> gets destroyed, which happens when <code>main()</code> returns."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1573086542, "post_id": 58739885, "comment_id": 103770496, "body": "To avoid the crash, pass the string by value."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11909399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iq53-KRG2T8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resUAXpRIZD89-J8gJ7_5LZGiIGyA/photo.jpg?sz=128", "display_name": "user11909399", "link": "https://stackoverflow.com/users/11909399/user11909399"}, "edited": false, "score": 0, "creation_date": 1573149279, "post_id": 58740253, "comment_id": 103796716, "body": "This code does not compile. I get the same exact error message."}], "tags": [], "owner": {"reputation": 766, "user_id": 6926706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/551619408360290/picture?type=large", "display_name": "Kirill Korolev", "link": "https://stackoverflow.com/users/6926706/kirill-korolev"}, "is_accepted": false, "score": 0, "last_activity_date": 1573086069, "creation_date": 1573086069, "answer_id": 58740253, "question_id": 58739885, "link": "https://stackoverflow.com/questions/58739885/passing-a-string-pointer-to-a-function-running-on-different-thread-in-c-and-xc/58740253#58740253", "title": "Passing a string pointer to a function running on different thread in C++ and Xcode 11.1", "body": "<p>In order to use std::thread you need to include a proper header file. Then you must decide to wait for the thread to do its job or to detach it. Otherwise std::thread will call std::terminate in a destructor. Another problem is that you will have a dangling pointer in a printString function if main returns and releases a string. </p>\n\n<p>So, one possible solution</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;iostream&gt;\n\nvoid printString(const char* s)\n{\n    std::cout &lt;&lt; s &lt;&lt; std::endl;\n}\n\nint main()\n{\n      std::string str = \"hello world\";\n      std::thread T3(printString, str.c_str());\n      T3.join();\n      return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 11909399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iq53-KRG2T8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resUAXpRIZD89-J8gJ7_5LZGiIGyA/photo.jpg?sz=128", "display_name": "user11909399", "link": "https://stackoverflow.com/users/11909399/user11909399"}, "is_accepted": false, "score": 0, "last_activity_date": 1573149668, "creation_date": 1573149668, "answer_id": 58754607, "question_id": 58739885, "link": "https://stackoverflow.com/questions/58739885/passing-a-string-pointer-to-a-function-running-on-different-thread-in-c-and-xc/58754607#58754607", "title": "Passing a string pointer to a function running on different thread in C++ and Xcode 11.1", "body": "<p>I solved this issue by setting my CMake to use C++ 11</p>\n\n<pre><code>set (CMAKE_CXX_STANDARD 11)\n</code></pre>\n\n<p>The generated Xcode project now has the right compiler flags set and the posted code compiles correctly.</p>\n"}], "owner": {"reputation": 39, "user_id": 11909399, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iq53-KRG2T8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resUAXpRIZD89-J8gJ7_5LZGiIGyA/photo.jpg?sz=128", "display_name": "user11909399", "link": "https://stackoverflow.com/users/11909399/user11909399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573149668, "creation_date": 1573083024, "question_id": 58739885, "link": "https://stackoverflow.com/questions/58739885/passing-a-string-pointer-to-a-function-running-on-different-thread-in-c-and-xc", "title": "Passing a string pointer to a function running on different thread in C++ and Xcode 11.1", "body": "<p>I'm trying to run the following simple example.</p>\n\n<pre><code>void printString(const char* s)\n{\n    std::cout &lt;&lt; s &lt;&lt; std::endl;\n}\n\nint main()\n{\n      std::string str = \"hello world\";\n      std::thread T3(printString, str.c_str());\n}\n</code></pre>\n\n<p>But I get the following error.</p>\n\n<pre><code>No matching constructor for initialization of 'std::thread'\n</code></pre>\n\n<p>I'm using Xcode 11.1.</p>\n\n<p>If this were to compile, would this code even work? Since threads share the same heap, thread <code>T3</code> should be able to access <code>str.c_str()</code> right? Assuming that <code>std::string</code> buffers are allocated on the heap.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "multithreading"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1573082745, "post_id": 58739807, "comment_id": 103769648, "body": "Ignoring the crash for a second, if you want 3 threads to run serially, it doesn&#39;t make sense to use 2 mutexes in the first place, only 1 mutex. Using 2 mutexes would allow 2 threads to run concurrently, defeating your serialization"}, {"owner": {"reputation": 715, "user_id": 3586940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9c9c03c81770b24d1a922d741af79c2?s=128&d=identicon&r=PG&f=1", "display_name": "user3586940", "link": "https://stackoverflow.com/users/3586940/user3586940"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1573083368, "post_id": 58739807, "comment_id": 103769785, "body": "@RemyLebeau Agreed. This is just a toy program designed to highlight the issue I had in a bigger piece of code :)"}], "answers": [{"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": true, "score": 5, "last_activity_date": 1573082847, "creation_date": 1573082847, "answer_id": 58739860, "question_id": 58739807, "link": "https://stackoverflow.com/questions/58739807/why-does-using-multiple-mutexs-on-the-same-condition-variable-crash-this-code/58739860#58739860", "title": "Why does using multiple mutex&#39;s on the same condition variable crash this code?", "body": "<p>You can't do it because the C++ standard says you can't.</p>\n\n<blockquote>\n  <p>33.5.3 Class condition_variable    [thread.condition.condvar]</p>\n  \n  <p>void wait(unique_lock&amp; lock);</p>\n  \n  <p>Requires: lock.owns_lock() is true and lock.mutex() is locked by the\n  calling thread, and either</p>\n  \n  <p>(9.1)  \u2014 no other thread is waiting on this\n  condition_variable object or</p>\n  \n  <p>(9.2)  \u2014 lock.mutex() returns the same\n  value for each of the lock arguments supplied by all concurrently\n  waiting (via wait, wait_for, or wait_until) threads.</p>\n</blockquote>\n\n<p>The second clause imposes a requirement that all execution threads must have the same mutex locked, if they are also blocking on the condition variable.</p>\n\n<p>(The above is for the <code>wait</code> method that takes no additional parameters, the same requirement is repeated for all overloads/variations, including the one that your code uses, which takes a predicate).</p>\n"}], "owner": {"reputation": 715, "user_id": 3586940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9c9c03c81770b24d1a922d741af79c2?s=128&d=identicon&r=PG&f=1", "display_name": "user3586940", "link": "https://stackoverflow.com/users/3586940/user3586940"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 58739860, "answer_count": 1, "score": 1, "last_activity_date": 1573082847, "creation_date": 1573082331, "question_id": 58739807, "link": "https://stackoverflow.com/questions/58739807/why-does-using-multiple-mutexs-on-the-same-condition-variable-crash-this-code", "title": "Why does using multiple mutex&#39;s on the same condition variable crash this code?", "body": "<p>In the code below, which I have tried to make minimially verifiable, runs fine and does what it should (print 1,2,3 in order no matter which order I pass in threads). However, if I change m1 to m2 in the line that I have commented in the function third, this code crashes with the message \"terminated without an active exception\". Why can't I use the same condition variable to lock on two different mutex's at the same time?</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;future&gt;\n#include &lt;iostream&gt;\n\nvoid printFirst() {\n    cout &lt;&lt; \"1\";\n}\n\nvoid printSecond() {\n    cout &lt;&lt; \"2\";\n}\n\nvoid printThird() {\n    cout &lt;&lt; \"3\";\n}\nstruct test {\n\n    condition_variable c, c2;\n    int count = 0;\n    mutex m1,m2;\n\nvoid first(function&lt;void()&gt; printFirst) {\n    printFirst();\n    count++;\n    c.notify_all();\n}\n\nvoid second(function&lt;void()&gt; printSecond) {\n    unique_lock&lt;mutex&gt; sL1(m1);\n    c.wait(sL1,[&amp;]{return count&gt;=1;});\n    printSecond();\n    count+=1;\n    c.notify_all();\n}\n\nvoid third(function&lt;void()&gt; printThird) {\n    unique_lock&lt;mutex&gt; sL2(m1); //If I make m1, m2, this code crashes\n    c.wait(sL2,[&amp;]{return count&gt;=2;});\n    printThird();\n}\n};\nint main() {\n    test t;\n\n    function&lt;void()&gt; printFirstN =[&amp;](){ t.first(printFirst);};\n    function&lt;void()&gt; printSecondN=[&amp;](){ t.second(printSecond);};\n    function&lt;void()&gt; printThirdN=[&amp;](){ t.third(printThird);};\n    std::thread t1(printFirstN);\n    std::thread t2( printThirdN);\n    std::thread t3( printSecondN);\n    t1.join();\n    t2.join();\n    t3.join();\n}\n</code></pre>\n"}, {"tags": ["c++", "sorting", "comparator"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1573082046, "post_id": 58739754, "comment_id": 103769455, "body": "so you&#39;re saying that potentially m[b] is less than m[a] AND that m[a] is less than m[b]"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1573082106, "post_id": 58739754, "comment_id": 103769469, "body": "The <code>std::sort()</code> comparator is required to return <code>true</code> only if the 1st argument is <b>less than</b> the 2nd argument. Using <code>&lt;</code> satisfies that, but <code>&lt;=</code> does not.  Also, in your <code>loop</code>, you don&#39;t need to call <code>m.find()</code> manually at all, since <code>operator[]</code> will insert a default value (which for an <code>int</code> is 0) if the specified key is not found: <code>for (char c:s) { m[c]++; }</code> (besides, you are not using the iterator returned by <code>find()</code> effectively anyway, calling <code>operator[]</code> does the same search that <code>find()</code> does, so you may as well just remove the <code>find()</code>)"}, {"owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1573082110, "post_id": 58739754, "comment_id": 103769471, "body": "@UKMonkey I am trying to say: if they are equal, I don&#39;t care about the order ... or what should be the right expression for that?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1573082160, "post_id": 58739754, "comment_id": 103769485, "body": "That&#39;s a different sort of sort. std::sort doesn&#39;t care about the order for items of the same value.  While stable_sort will  So you need to; as remy said - adhear to the spec that says &quot;return true if a &lt; b&quot;"}], "owner": {"reputation": 17078, "user_id": 3993270, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1bee661ad7451ff3107ca6954560a06c?s=128&d=identicon&r=PG&f=1", "display_name": "Edamame", "link": "https://stackoverflow.com/users/3993270/edamame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 1, "closed_date": 1573082247, "answer_count": 0, "score": 0, "last_activity_date": 1573081820, "creation_date": 1573081820, "question_id": 58739754, "link": "https://stackoverflow.com/questions/58739754/implication-of-in-the-comparator", "closed_reason": "Duplicate", "title": "Implication of &quot;=&quot; in the comparator", "body": "<p>I have the following codes trying to sort the string based the the character frequency in descending order.</p>\n\n<pre><code>string frequencySort(string s) {\n\n    unordered_map&lt;char,int&gt; m{};\n    for (char c:s) {\n        if(m.find(c) != m.end()){\n            m[c]++;\n        } else {\n            m[c] = 1;\n        }\n    }\n\n    sort(s.begin(), s.end(), [&amp;m](char a, char b) { return m[b] &lt; m[a];});\n    return s;\n}\n</code></pre>\n\n<p>The code works fine, but if I use \"&lt;=\" in the lambda function:</p>\n\n<pre><code>[&amp;m](char a, char b) { return m[b] &lt;= m[a];}\n</code></pre>\n\n<p>I would get heap-buffer-overflow error. Does anyone know why is that?\nThanks!</p>\n"}, {"tags": ["c++", "algorithm", "performance", "dbscan"], "answers": [{"tags": [], "owner": {"reputation": 766, "user_id": 6926706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/551619408360290/picture?type=large", "display_name": "Kirill Korolev", "link": "https://stackoverflow.com/users/6926706/kirill-korolev"}, "is_accepted": true, "score": 0, "last_activity_date": 1573084087, "last_edit_date": 1573084087, "creation_date": 1573083546, "answer_id": 58739957, "question_id": 58739720, "link": "https://stackoverflow.com/questions/58739720/if-i-use-a-dbscan-algorithm-with-a-minpts-of-1-will-it-still-run-in-onlogn-tim/58739957#58739957", "title": "If I use a DBSCAN algorithm with a minPts of 1 will it still run in O(nlogn) time?", "body": "<p>As far as I'm concerned running time of a DBSCAN in this case depends on a calculation of neighbours, which is performed on each point, within the given distance. As you mentioned if you perform a linear scan you'd get O(n^2) in total. Nevertheless, in order to speed up a search you could use an index-based structure which searches in a O(logn) time.\nPlease, checkout <a href=\"https://en.wikipedia.org/wiki/Spatial_database\" rel=\"nofollow noreferrer\">spatial databases</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 70452, "user_id": 1060350, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/XCkw7.jpg?s=128&g=1", "display_name": "Has QUIT--Anony-Mousse", "link": "https://stackoverflow.com/users/1060350/has-quit-anony-mousse"}, "is_accepted": false, "score": 0, "last_activity_date": 1573109964, "creation_date": 1573109964, "answer_id": 58743453, "question_id": 58739720, "link": "https://stackoverflow.com/questions/58739720/if-i-use-a-dbscan-algorithm-with-a-minpts-of-1-will-it-still-run-in-onlogn-tim/58743453#58743453", "title": "If I use a DBSCAN algorithm with a minPts of 1 will it still run in O(nlogn) time?", "body": "<p>The runtime depends on epsilon being small enough so that the result sizes are small, as well as an index being able to accelerate these queries. There is no requirement on minpts, so it will work for the \"degenerate\" case of Single-Link clustering.</p>\n\n<p>But in your case, you may simply want to use the spatial index for neighbor search directly, not go via the proxy of DBSCAN?</p>\n"}], "owner": {"reputation": 5, "user_id": 11924267, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gDwLmFhIpRE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehBmpmBjZRTt-OCKPr4-LZNuLKQA/photo.jpg?sz=128", "display_name": "Nathan Hill", "link": "https://stackoverflow.com/users/11924267/nathan-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 58739957, "answer_count": 2, "score": 0, "last_activity_date": 1573109964, "creation_date": 1573081576, "question_id": 58739720, "link": "https://stackoverflow.com/questions/58739720/if-i-use-a-dbscan-algorithm-with-a-minpts-of-1-will-it-still-run-in-onlogn-tim", "title": "If I use a DBSCAN algorithm with a minPts of 1 will it still run in O(nlogn) time?", "body": "<p>I'm doing a homework problem that simplified is grouping stars into constellations given their x,y coordinates and a min distance.  Any star can be a constellation by itself.  so e.g 5 stars cant connect to each other then it will return that there are 5 constellations. </p>\n\n<p>I've initially made an algorithm that checks each point with a runtime of O(n^2).  I want to make it faster and saw that a DBSCAN runs in O(nlogn) time.  </p>\n\n<p>My question is that if I were to use a DBSCAN the algorithm says it will run in O(nlogn) time but if my minPts is 1 (the size of my clusters) will that negate the efficiency of the DBSCAN and run in O(n^2)??</p>\n"}, {"tags": ["c++", "assembly", "optimization", "x86-64", "simd"], "comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1573098434, "post_id": 58739544, "comment_id": 103772892, "body": "What do you mean &quot;not <i>heavy</i> AVX&quot;?  <code>_mm256_fmadd_ps</code> looks like the obvious way to go, with a pre-computed loop-invariant value for the multiplier <code>(d - c) &#47; (b - a)</code>.  Can you usefully do this on a group of inputs that are in contiguous memory?  If not, then scalar <code>fma()</code> is still good, and simplifies the uint32_t &lt;-&gt; float conversion.  (You can just convert to/from scalar 64-bit integers, and treat the low half as unsigned)."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573111215, "post_id": 58739544, "comment_id": 103776386, "body": "@PeterCordes i&#39;m sorry for this spurrious remark. I&#39;m new to the low-level stuff and I often get performance drops when tinkering with AVX. Maybe this is because of quite outdated benchmark cpu which is one core of Xeon E5-2660. Can you write your solution as a full answer?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573111324, "post_id": 58739544, "comment_id": 103776428, "body": "This is for a Bucket Sort or something, right?  (So you eventually need these results in integer regs for an addressing mode.)  Can you Radix sort instead, using the top few bits as an index?  Or can you assume that <code>x-a</code> &lt;= <code>INT_MAX</code>?  Or can you take advantage of that as a special case for some data sets?  I&#39;m working on an answer but didn&#39;t know whether to assume huge ranges (bigger than FP rounding error from a range-shift to signed int) or work with small unsigned integers.  Or if not small, then at least <code>a..b</code> being a small range compared to the full range of <code>uint32_t</code>."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573111456, "post_id": 58739544, "comment_id": 103776495, "body": "No i&#39;ve already tried Bucket and Radix Sorts in many variations. I have a custom algorithm for a particular data sets."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573111635, "post_id": 58739544, "comment_id": 103776598, "body": "Ok, but did I guess right that you eventually want to use this scaled number to figure out where to store the original?  So you need to either get it back into integer registers for a scalar addressing mode or possibly use it with an AVX512 scatter store.  Although <i>probably</i> it&#39;s still a win to use SIMD even if you can&#39;t just store 4x or 8x <code>uint32_t</code> results to contiguous memory."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1573111828, "post_id": 58739544, "comment_id": 103776692, "body": "Exact limits:  <code>a &gt;= 0</code>, <code>b &lt;= 2^31 - 1</code>,  <code>c &gt;= 0</code>, <code>d &lt;= 2^20 - 1</code>. Ity is always possible to zero <code>c</code>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1573112007, "post_id": 58739544, "comment_id": 103776774, "body": "Ok perfect, so you can treat your inputs as signed-positive or unsigned, and <code>x-a</code> is always going to be signed positive, not still in the upper half of the unsigned range.  And it&#39;s ok to round to single-precision <code>float</code>?  Would rounding <code>x</code> to <code>float</code> instead of <code>x-a</code> be ok?  That lets you do it with cvt + vfmaddps + cvt (because the <code>-a * scale</code> can be combined with the <code>+c</code> at the end)."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573112033, "post_id": 58739544, "comment_id": 103776788, "body": "Yes i&#39;m going to use the routine results as pointer offsets and i need them as integers. Actually it is reflected in the formula."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573112104, "post_id": 58739544, "comment_id": 103776818, "body": "Yes, there are only unsigned integers and no possibility of an overflow on substraction."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573112140, "post_id": 58739544, "comment_id": 103776832, "body": "Yes I know you need them as <code>uint32_t</code>, but the question was whether you needed to get them out YMM0 into RAX (a GP-integer <i>register</i>) for use in an addressing mode, instead of just storing 8 results to memory with <code>vmovdqu</code>."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1573112365, "post_id": 58739544, "comment_id": 103776938, "body": "IDK what you mean by &quot;they are <i>only</i> unsigned integers&quot;.  The full range of <code>uint32_t</code> is <code>0 .. 2^32 - 1</code>.  You couldn&#39;t implement this as efficiently if <code>x-a</code> could be &gt;= INT_MAX.  So it&#39;s a good thing that your numbers have the same value if interpreted as <code>int32_t</code> (i.e. their high bit isn&#39;t set).  Anyway, I understand what the actual ranges are, I&#39;m only nit-picking about the terminology in your followup comment."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573112474, "post_id": 58739544, "comment_id": 103776984, "body": "Well, i need this snippet as an inline function to be used in several places in \u0421++ code. So it should be in <code>RAX</code> register."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1573115597, "post_id": 58739544, "comment_id": 103778430, "body": "If parts of that C++ code can vectorize, then you wouldn&#39;t need it in RAX.  That&#39;s why I asked <i>how</i> you used the value (specifically as part of a memory address).  Apparently the answer to the important question was yes, so you do need it in RAX (or another integer reg), but that doesn&#39;t follow automatically from using it several times in C++.  You tagged this assembly; I&#39;m thinking in terms of what code-gen we want the compiler to make.  (Because that&#39;s how you write efficient C++)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573115997, "post_id": 58739544, "comment_id": 103778637, "body": "You reuse the same a,b,c,d for multiple <code>x</code> values, right?  Like at least a full SIMD vector of 8?"}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1573116247, "post_id": 58739544, "comment_id": 103778769, "body": "Yes, i reuse those many times, up to millions of calculations without <code>a</code>, <code>b</code>, <code>c</code>, <code>d</code> changing."}, {"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1573129834, "post_id": 58739544, "comment_id": 103786034, "body": "@chtz you&#39;re very possible correct, my own code hasn&#39;t reached the readyness level when i would check border conditions. It&#39;s just an ugly patch that deals with a bottleneck."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1573130418, "post_id": 58739544, "comment_id": 103786350, "body": "@AndreyGodyaev (I realized Peter already asked the exact same question, so I deleted it). If you can de-facto just work on one element at a time, you could just convert to <code>double</code> (every <code>[u]int32</code> has an exact representation as <code>double</code> and do the mapping in that domain)."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 1, "creation_date": 1573130940, "post_id": 58739544, "comment_id": 103786674, "body": "For clarification, could you specify (inside the question, not the comments), if (and at what points) you are fine with losing precision. Also write how you intend to use the scaled result. The information is hard to extract from the comments."}], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "edited": false, "score": 0, "creation_date": 1584012443, "post_id": 58754612, "comment_id": 107308254, "body": "Thank you. The MR that contained this subtask was merged finally. The implementation would be much less effective without your help."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1573149703, "creation_date": 1573149703, "answer_id": 58754612, "question_id": 58739544, "link": "https://stackoverflow.com/questions/58739544/map-integer-range-onto-another-range/58754612#58754612", "title": "Map integer range onto another range", "body": "<p>Actual runtime division (FP and integer) is very slow so you definitely want to avoid that.  The way you wrote that expression probably compiles to include a division because FP math is not associative (without <code>-ffast-math</code>); the compiler can't turn <code>x / foo * bar</code> into <code>x * (bar/foo)</code> for you, even though that's very good with loop-invariant <code>bar/foo</code>.  You do need either floating point or 64-bit integers to avoid overflow in a multiply, but only FP lets you reuse a non-integer loop-invariant division result.</p>\n\n<p><code>_mm256_fmadd_ps</code> looks like the obvious way to go, with <strong>a pre-computed loop-invariant value for the multiplier <code>(d - c) / (b - a)</code></strong>.  If <code>float</code> rounding isn't a problem for doing it strictly in order (multiply then divide), it's probably ok to do this inexact division first, outside the loop.  Like<br>\n<code>_mm256_set1_ps((d - c) / (double)(b - a))</code>.  Using <code>double</code> for this calculation avoids rounding error during conversion to FP of the division operands.</p>\n\n<p>You're reusing the same a,b,c,d for many <code>x</code>, presumably coming from contiguous memory.  You're using the result as part of a memory address so you do eventually need the results back from SIMD into integer registers, unfortunately.  (Possibly with AVX512 scatter stores you could avoid that.)</p>\n\n<p>Modern x86 CPUs have 2/clock load throughput so probably your best bet for getting 8x uint32_t back into integer registers is a vector store / integer reload, instead of spending 2 uops per element for ALU shuffle stuff.  That has some latency so I'd suggest converting into a tmp buffer of maybe 16 or 32 ints (64 or 128 bytes), i.e. 2x or 4x <code>__m256i</code> before looping through that scalar.</p>\n\n<p>Or maybe alternate converting and storing one vector then looping over the 8 elements of <em>another</em> one that you converted earlier.  i.e. software pipelining.  Out-of-order execution can hide latency but you're already going to be stretching its latency-hiding capability for cache misses for whatever you're doing with memory.</p>\n\n<p>Depending on your CPU (e.g. Haswell or some Skylake), using 256-bit vector instructions might cap your max turbo slightly lower than it would otherwise.  You might consider only doing vectors of 4 at once but then you're spending more uops per element.</p>\n\n<p>If not SIMD, then even scalar C++ <code>fma()</code> is still good, for <code>vfmadd213sd</code>, but using intrinsics is a very convenient way to get rounding (instead of truncation) from float -> int (<code>vcvtps2dq</code> rather than <code>vcvttps2dq</code>).</p>\n\n<hr>\n\n<p>Note that <code>uint32_t</code> &lt;-> <code>float</code> conversion isn't directly available until AVX512. For scalar you can just convert to/from int64_t with truncation / zero-extension for the unsigned low half.</p>\n\n<p>It's very convenient that (as discussed in comments) your inputs are range-limited so if you interpret them as signed integers they have the same value (signed non-negative).  Both <code>x</code> and <code>x-a</code> (and <code>b-a</code>) are known to be positive and &lt;= INT32_MAX i.e <code>0x7FFFFFFF</code>.  (Or at least non-negative.  Zero is fine.)</p>\n\n<p><strong>Float Rounding</strong></p>\n\n<p>For SIMD, single-precision <code>float</code> is <em>very</em> good for SIMD throughput.  Efficient packed-conversion to/from signed int32_t.  But <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">not every <code>int32_t</code> can be exactly represented as a <code>float</code></a>.  Larger values get rounded to the nearest even, nearest multiple of 2^2, 2^3, or more the farther above 2^24 the value is.</p>\n\n<p>Using SIMD <code>double</code> is possible but requires some shuffling.</p>\n\n<p>I don't think <code>float</code> is usually a problem for the formula as-written with <code>(float)(x-a)</code>.  If the <code>b-a</code> input range is large, that means both ranges are large and rounding error isn't going to map all possible <code>x</code> values into the same output.  Depending on the multiplier, the input rounding error might be worse than the output rounding error, maybe leaving some representable output floats unused for higher <code>x-a</code> values.</p>\n\n<p>But if we want to factor out the <code>-a * (d - c) / (b - a)</code> part and combine it with the <code>+c</code> at the end, then</p>\n\n<ol>\n<li>We potentially have precision loss from catastrophic cancellation in that value to be added.</li>\n<li>We need to do <code>(float)x</code> on the raw input value.  If <code>a</code> is huge and <code>b-a</code> is small, i.e. a small range near the top of the possible input range, rounding error can map all possible <code>x</code> values to the same float.</li>\n<li>To make best use of FMA, we want to do the <code>+c</code> before converting back to integer, which again risks output rounding error if the <code>d-c</code> is a small output range but <code>c</code> is huge.  In your case not a problem; with <code>d</code> &lt;= 2^<sup>20</sup> - 1 we know that <code>float</code> can exactly represent every output integer value in that c..d range.</li>\n</ol>\n\n<hr>\n\n<p>If you didn't have the input range constraint, you could range-shift to/from signed before the scaling by using integer <code>(x-a)+0x80000000U</code> on input and <code>...+c+0x80000000U</code> on output (after rounding to nearest <code>int32_t</code>).  But that would introduce huge <code>float</code> rounding error for small <code>uint32_t</code> inputs (close to 0) which get range-shifted to close to <code>INT_MIN</code>.</p>\n\n<p>We don't need to range-shift for the <code>b-a</code> or <code>d-c</code> because the + or - or XOR with <code>0x80000000U</code> would cancel out in the subtractions.</p>\n\n<hr>\n\n<h3>Example:</h3>\n\n<p>The <code>const</code> vectors should be hoisted out of a loop by the compiler after this inlines,\nor you can do that manually.</p>\n\n<p>This requires AVX1 + FMA (e.g. AMD Piledriver or Intel Haswell or later).  Untested, sorry I didn't even throw this on Godbolt to see if it compiles.</p>\n\n<pre><code>// fastest but not safe if b-a is small and  a &gt; 2^24\nstatic inline\n__m256i range_scale_fast_fma(__m256i data, uint32_t a, uint32_t b, uint32_t c, uint32_t d)\n{\n     // avoid rounding errors when computing the scale factor, but convert double-&gt;float on the final result\n    double scale_scalar = (d - c) / (double)(b - a);\n    const __m256 scale = _mm256_set1_ps(scale_scalar);\n    const __m256 add = _m256_set1_ps(-a*scale_scalar + c);\n    //    (x-a) * scale + c\n    // =  x * scale + (-a*scale + c)   but with different rounding error from doing -a*scale + c\n\n    __m256  in = _mm256_cvtepi32_ps(data);\n    __m256  out = _mm256_fmadd_ps(in, scale, add);\n    return _mm256_cvtps_epi32(out);   // convert back with round to nearest-even\n                                   // _mm256_cvttps_epi32 truncates, matching C rounding; maybe good for scalar testing\n}\n</code></pre>\n\n<p><strong>Or a safer version, doing the input range-shift with integer:</strong>  You could easily avoid FMA here if necessary for portability (just AVX1) and use an integer add for the output, too.  But we know the output range is small enough that it can always exactly represent any integer </p>\n\n<pre><code>static inline\n__m256i range_scale_safe_fma(__m256i data, uint32_t a, uint32_t b, uint32_t c, uint32_t d)\n{\n     // avoid rounding errors when computing the scale factor, but convert double-&gt;float on the final result\n    const __m256 scale = _mm256_set1_ps((d - c) / (double)(b - a));\n    const __m256 cvec = _m256_set1_ps(c);\n\n    __m256i in_offset = _mm256_add_epi32(data, _mm256_set1_epi32(-a));  // add can more easily fold a load of a memory operand than sub because it's commutative.  Only some compilers will do this for you.\n    __m256  in_fp = _mm256_cvtepi32_ps(in_offset);\n    __m256  out = _mm256_fmadd_ps(in_fp, scale, _mm256_set1_ps(c));  // in*scale + c\n    return _mm256_cvtps_epi32(out);\n}\n</code></pre>\n\n<p>Without FMA you could still use <code>vmulps</code>.  You might as well convert back to integer before adding <code>c</code> if you're doing that, although <code>vaddps</code> would be safe.</p>\n\n<p>You might use this in a loop like</p>\n\n<pre><code>void foo(uint32_t *arr, ptrdiff_t len)\n{\n    if (len &lt; 24) special case;\n\n    alignas(32) uint32_t tmpbuf[16];\n\n    // peel half of first iteration for software pipelining / loop rotation\n    __m256i arrdata = _mm256_loadu_si256((const __m256i*)&amp;arr[0]);\n    __m256i outrange = range_scale_safe_fma(arrdata);\n    _mm256_store_si256((__m256i*)tmpbuf, outrange);\n\n    // could have used an unsigned loop counter\n    // since we probably just need an if() special case handler anyway for small len which could give len-23 &lt; 0\n    for (ptrdiff_t i = 0 ; i &lt; len-(15+8) ; i+=16 ) {\n\n        // prep next 8 elements\n        arrdata = _mm256_loadu_si256((const __m256i*)&amp;arr[i+8]);\n        outrange = range_scale_safe_fma(arrdata);\n        _mm256_store_si256((__m256i*)&amp;tmpbuf[8], outrange);\n\n        // use first 8 elements\n        for (int j=0 ; j&lt;8 ; j++) {\n            use tmpbuf[j] which corresponds to arr[i+j]\n        }\n\n        // prep 8 more for next iteration\n        arrdata = _mm256_loadu_si256((const __m256i*)&amp;arr[i+16]);\n        outrange = range_scale_safe_fma(arrdata);\n        _mm256_store_si256((__m256i*)&amp;tmpbuf[0], outrange);\n\n        // use 2nd 8 elements\n        for (int j=8 ; j&lt;16 ; j++) {\n            use tmpbuf[j] which corresponds to arr[i+j]\n        }\n    }\n\n    // use tmpbuf[0..7]\n    // then cleanup: one vector at a time until &lt; 8 or &lt; 4 with 128-bit vectors, then scalar\n}\n</code></pre>\n\n<p>These variable-names sound dumb but I couldn't think of anything better.</p>\n\n<p>This software pipelining is an optimization; you can just get it working / try it out with a single vector at a time used right away.  (Optimize the reload of the first element from a reload to <code>vmovd</code> using <code>_mm_cvtsi128_si32(_mm256_castsi256_si128(outrange))</code> if you want.)</p>\n\n<hr>\n\n<h2>Special cases</h2>\n\n<p>If there cases where you know <code>(b - a)</code> is a power of 2, you could bitscan with <code>tzcnt</code> or <code>bsf</code>, then multiply.  (There are intrinsics for those, like GNU C <code>__builtin_ctz()</code> to count trailing zeros.)</p>\n\n<p>Or can you <em>ensure</em> that <code>(b - a)</code> is always a power of 2?</p>\n\n<p>Or better, <strong>if <code>(b - a) / (d - c)</code> is an exact power of 2 the whole thing can just be sub / right shift / add.</strong></p>\n\n<p>If you can't <em>always</em> ensure that you'd still need the general case sometimes, but maybe possible to do that efficiently.</p>\n"}], "owner": {"reputation": 521, "user_id": 5860619, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba6577881df7b0cd6d8896dcfae228d5?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Godyaev", "link": "https://stackoverflow.com/users/5860619/andrey-godyaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 58754612, "answer_count": 1, "score": 1, "last_activity_date": 1573149703, "creation_date": 1573080263, "last_edit_date": 1573132003, "question_id": 58739544, "link": "https://stackoverflow.com/questions/58739544/map-integer-range-onto-another-range", "title": "Map integer range onto another range", "body": "<p>In runtime I have 2 ranges defined by their <code>uint32_t</code> borders <code>a..b</code> and <code>c..d</code>. The first range tends to be much greater than the second: <code>8 &lt; (b - a) / (d - c) &lt; 64</code>.<br>\nExact limits: <code>a &gt;= 0</code>, <code>b &lt;= 2^31 - 1</code>, <code>c &gt;= 0</code>, <code>d &lt;= 2^20 - 1</code>.</p>\n\n<p>I need a routine that performs linear mapping of an integer from the first range onto the second one: <code>f(uint32_t x) -&gt; round_to_uint32_t((float)(x - a) / (b - a) * (d - c) + c)</code>.<br>\nWhen <code>b - a &gt;= d - c</code> it is important to mantain the ratio as close to ideal as possible, otherwise in cases when element from <code>[a; b]</code> can be mapped on more than one integer from <code>[c; d]</code> it is okay to return any of these integers.</p>\n\n<p>Sounds like a simple ratio problem and was already answered in many questions like<br>\n<a href=\"https://stackoverflow.com/questions/929103/convert-a-number-range-to-another-range-maintaining-ratio\">Convert a number range to another range, maintaining ratio</a><br>\nbut here I need a really really fast solution.</p>\n\n<p>This routine is a pivotal part of a specialized sorting algorithm and will be called at least once for every element of a sorted array.</p>\n\n<p>SIMD solution is also acceptable if it doesn't drop overall performance.</p>\n"}, {"tags": ["c++", "gcc", "parameter-passing", "c++17", "return-by-reference"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1573080215, "post_id": 58739525, "comment_id": 103768953, "body": "If you want to return a reference, why isn&#39;t the return type <code>const std::string&amp;</code>?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573080755, "post_id": 58739525, "comment_id": 103769103, "body": "Sure you can have the cake, and also eat it. It just requires a little bit more work: returning a variant of either a string or a <code>std::ref</code> to a string. Sure, it&#39;s quite an overkill, but it&#39;ll get the job done, albeit in a rather verbose, slightly convoluted way that will require additional work by each caller to properly process the result."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1573081065, "post_id": 58739525, "comment_id": 103769184, "body": "@Rualark: This question seems improperly phrased. Your concern is not <i>really</i> with the return value; it is with the second parameter <code>default_st</code>. That&#39;s where this whole notion of &quot;<i>constructor, copy constructor and destructor, even if second (default) argument is not selected for return</i>&quot;. You want to somehow take this parameter and choose to construct a <code>std::string</code> from it or not based on the first parameter."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573115850, "post_id": 58739676, "comment_id": 103778567, "body": "Hi! Thanks for you suggested solution! Now I understand that I am looking for an elegant solution, that will be simple for caller. I have not seen such syntax before. Is this correct? enum { std::string s; std::String&amp; v; };"}, {"owner": {"reputation": 383, "user_id": 10299721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mQnnLqAacmU/AAAAAAAAAAI/AAAAAAAAAD0/szKrU2XNEZM/photo.jpg?sz=128", "display_name": "AbbysSoul", "link": "https://stackoverflow.com/users/10299721/abbyssoul"}, "reply_to_user": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573123679, "post_id": 58739676, "comment_id": 103782711, "body": "Ah - I made a few typos in the answer which I have fixed.  Currect syntax is <code>union {std::string s; std::string&amp; v}</code>; The concept explained in <a href=\"https://en.wikipedia.org/wiki/Tagged_union\" rel=\"nofollow noreferrer\">wiki</a> in C/C++ section. Also, <a href=\"https://medium.com/@almtechhub/c-c-tagged-discriminated-union-ecd5907610bf\" rel=\"nofollow noreferrer\">this article</a> seems to give a good example too.  But just to be clear - I don&#39;t think it is a good approach :)"}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1573126754, "post_id": 58739676, "comment_id": 103784329, "body": "<a href=\"http://eel.is/c++draft/class.union#3.sentence-4\" rel=\"nofollow noreferrer\">Unions cannot have nonstatic member varialbes of reference type.</a>. <a href=\"http://eel.is/c++draft/variant#variant-2\" rel=\"nofollow noreferrer\">Nor <code>std::variant</code> objects.</a>."}, {"owner": {"reputation": 383, "user_id": 10299721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mQnnLqAacmU/AAAAAAAAAAI/AAAAAAAAAD0/szKrU2XNEZM/photo.jpg?sz=128", "display_name": "AbbysSoul", "link": "https://stackoverflow.com/users/10299721/abbyssoul"}, "edited": false, "score": 0, "creation_date": 1573127904, "post_id": 58739676, "comment_id": 103784957, "body": "It&#39;s worth mentioning that one can use std::reference_wrapper&lt;&gt; instead of direct reference. And let us not forget the need to define constructors and destructor if one was to implement such a class. That is why I think it is a bad idea to do it.   But if anyone wants to experiment with the concept - here is a <a href=\"https://godbolt.org/z/_5z-2-\" rel=\"nofollow noreferrer\">godbolt playground</a>."}], "tags": [], "owner": {"reputation": 383, "user_id": 10299721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mQnnLqAacmU/AAAAAAAAAAI/AAAAAAAAAD0/szKrU2XNEZM/photo.jpg?sz=128", "display_name": "AbbysSoul", "link": "https://stackoverflow.com/users/10299721/abbyssoul"}, "is_accepted": false, "score": 2, "last_activity_date": 1573250165, "last_edit_date": 1573250165, "creation_date": 1573081307, "answer_id": 58739676, "question_id": 58739525, "link": "https://stackoverflow.com/questions/58739525/is-there-a-way-to-return-either-a-new-object-or-reference-to-existing-object-fro/58739676#58739676", "title": "Is there a way to return either a new object or reference to existing object from a function?", "body": "<p>Well, there a few things here.\nTo express what you ask for directly you can use something like <code>std::variant&lt;std::string, std::string&amp;&gt;</code> as your function return type. Although I have not checked if variant can store a reference. \nOr some equivalent from a third party library. either&lt;> ?\nYou can also write your own class wrapping string and string ref. </p>\n\n<p>(Not an real code)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct StringOrRef {\n    enum class Type {Value, Ref} type;\n    union {\n        std::string value;\n        std::reference_wrapper&lt;const std::string&gt; ref;\n    };\n...\n};\n</code></pre>\n\n<p>Check the topic: discriminating union in C++.</p>\n\n<p>But I think there is a bigger problem with your example!\nPlease consider the ownership of data. std::string takes ownership of data passed. That is why it copy data. Thus when your function returns - the called is sure it had a data and don't need to worry about it as long as (s)he holds the value.</p>\n\n<p>In case you design a function to return a reference to passed argument value - you need to make sure that the value is used within the same lifespan as the argument passed (to which the ref is returned)</p>\n\n<p>So consider:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>\nStringOrRef func(strging const&amp; a, string const&amp; b);\n...\n\nStringOrRef val;\n{ // begin scope:\n\n\nSomeStruct s = get_defaul();\nval = func(\"some value\", s.get_ref_to_internal_string());\n\n}// end of val scope\n\nval; // is in scope but may be referencing freed data. \n\n</code></pre>\n\n<p>The problem here is the temporary object <code>SomeStruct s</code>. if it's member function <code>get_ref_to_internal_string() -&gt; string&amp;</code> returns a ref to a string field of that object (which is often the way it is implemented) - then when <code>s</code> goes out of scope - tha ref becomes invalid. that is - it is referencing freed memory which may have been given to some other objects.\nAnd if you capture that reference in <code>val</code> - val will be referencing invalid data.\nYou will be lucky if it all end in <code>access violation</code> or a signal. At worst your program continues but will be crashing randomly.   </p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573150887, "post_id": 58740180, "comment_id": 103797383, "body": "Ted, thanks a lot for your solution! First argument should always be lvalue (as in the question), but this is very simple to fix. A bigger problem is that in first function std::move() does not work. Copy constructor and destructor are called instead of returning a reference to lvalue.  As you have already brilliantly solved the case with second argument being lvalue, we can now think that first argument is always lvalue and second argument is always rvalue. What could be a most performance-effective strategy to cope without copy constructors?"}, {"owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573152696, "post_id": 58740180, "comment_id": 103798131, "body": "I&#39;m sorry if I could not explain better. Please see the example code, which shows that copy constructor is called instead of move constructor: <a href=\"https://onlinegdb.com/rkMKP1Gir\" rel=\"nofollow noreferrer\">onlinegdb.com/rkMKP1Gir</a> I had to replace std::string with a debug class TStruct to show which constructors were called (see case &quot;First  2&quot;)"}, {"owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573157765, "post_id": 58740180, "comment_id": 103800270, "body": "I added more debugging output and now it is visible that copy constructor is being called in &quot;First 2&quot; case (see &quot;Cc(4)&quot; string in output). Can we avoid it? I added comments at lines 75-77, 80-82: <a href=\"https://godbolt.org/z/y74sDG\" rel=\"nofollow noreferrer\">godbolt.org/z/y74sDG</a>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573158500, "post_id": 58740180, "comment_id": 103800587, "body": "@Rualark Updated with the new function templates: <a href=\"https://godbolt.org/z/JKK-PP\" rel=\"nofollow noreferrer\">godbolt.org/z/JKK-PP</a> To answer your questions: No, not that I can see. When one of the optional parameters is an xvalue we must create a &quot;body&quot; for it to be moved into. We can&#39;t change the return type of the function depending on runtime conditions."}, {"owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 1, "creation_date": 1573196048, "post_id": 58740180, "comment_id": 103810159, "body": "Ted, thank you so much for your answers! This answer seems perfect except the copy constructor problem. P.S. For some reason I cannot mention you using @Ted"}, {"owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573197236, "post_id": 58740180, "comment_id": 103810549, "body": "Probably, this could be an impassable limitation of C++ that a function cannot return value or reference based on runtime decision."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "edited": false, "score": 0, "creation_date": 1573197513, "post_id": 58740180, "comment_id": 103810665, "body": "@Rualark Indeed it is. To emulate that one can use <code>std::variant</code> as mentioned in the comments but I doubt it&#39;ll be more effective."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 3, "last_activity_date": 1573162445, "last_edit_date": 1573162445, "creation_date": 1573085379, "answer_id": 58740180, "question_id": 58739525, "link": "https://stackoverflow.com/questions/58739525/is-there-a-way-to-return-either-a-new-object-or-reference-to-existing-object-fro/58740180#58740180", "title": "Is there a way to return either a new object or reference to existing object from a function?", "body": "<p>I'm not 100% sure I understood the combinations of requirements but:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\n// if called with an rvalue (xvalue) as 2:nd arg, move or copy\nstd::string get_or_default(const std::string&amp; st, std::string&amp;&amp; default_st) {\n    std::cout &lt;&lt; \"got temporary\\n\";\n    if(st.empty())\n        return std::move(default_st);      // rval, move ctor\n        // return std::forward&lt;std::string&gt;(default_st); // alternative\n    else\n        return st;                         // lval, copy ctor\n}\n\n// lvalue as 2:nd argument, return the reference as-is\nconst std::string&amp; get_or_default(const std::string&amp; st,\n                                  const std::string&amp; default_st) {\n    std::cout &lt;&lt; \"got ref\\n\";\n    if(st.empty()) return default_st;\n    else           return st;\n}\n\nint main() {\n    std::string lval = \"lval\";\n\n    // get ref or copy ...\n    decltype(auto) s1 = get_or_default(\"\", \"temporary1\");\n    decltype(auto) s2 = get_or_default(\"\", std::string(\"temporary2\"));\n    decltype(auto) s3 = get_or_default(\"\", lval);\n\n    std::cout &lt;&lt; std::boolalpha;\n    std::cout &lt;&lt; std::is_reference_v&lt;decltype(s1)&gt; &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; std::is_reference_v&lt;decltype(s2)&gt; &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; std::is_reference_v&lt;decltype(s3)&gt; &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>got temporary\ngot temporary\ngot ref\nfalse\nfalse\ntrue\n</code></pre>\n\n<p>Edit: Made a slightly more generic version after OP:s testing. It can use a lambda, like<br>\n<code>auto empty_check = [](const std::string&amp; s) { return s.empty(); };</code><br>\nto test if the first argument is empty.</p>\n\n<pre><code>template&lt;typename T, typename F&gt;\nT get_or_default(const T&amp; st, T&amp;&amp; default_st, F empty) {\n    if(empty(st)) return std::move(default_st);\n               // return std::forward&lt;T&gt;(default_st); // alternative\n    else          return st;\n}\n\ntemplate&lt;typename T, typename F&gt;\nconst T&amp; get_or_default(const T&amp; st, const T&amp; default_st, F empty) {\n    if(empty(st)) return default_st;\n    else          return st;\n}\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 2695664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cdf0d550ea3e82e1dd8a19e215850e?s=128&d=identicon&r=PG", "display_name": "Rualark", "link": "https://stackoverflow.com/users/2695664/rualark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 2, "accepted_answer_id": 58740180, "answer_count": 2, "score": 1, "last_activity_date": 1573250165, "creation_date": 1573080106, "last_edit_date": 1573115745, "question_id": 58739525, "link": "https://stackoverflow.com/questions/58739525/is-there-a-way-to-return-either-a-new-object-or-reference-to-existing-object-fro", "title": "Is there a way to return either a new object or reference to existing object from a function?", "body": "<p>I am trying to write a function, which can either return a reference to an existing object passed as a first argument (if it is in correct state) or create and return a new object using literal passed as a second argument (default).</p>\n\n<p>It would be even better if a function could take not only literal, but also another existing object as a second (default) argument and return a reference to it.</p>\n\n<p>Below is a trivial implementation, but it does a lot of unneeded work:</p>\n\n<ol>\n<li><p>If called with lvalue as a second (default) argument, it calls a copy constructor of an argument, that is selected for return. Ideally a reference to an object should be returned.</p></li>\n<li><p>If called with literal as a second (default) argument, it calls constructor, copy constructor and destructor, even if second (default) argument is not selected for return. It would be better if an object is constructed and returned as rvalue reference without calling copy constructor or destructor.</p></li>\n</ol>\n\n<pre><code>std::string get_or_default(const std::string&amp; st, const std::string&amp; default_st) {\n    if (st.empty()) return default_st\n    else return st;\n}\n</code></pre>\n\n<p>Is there a way to accomplish this more efficiently, while still keeping simple for caller? If I am correct, this requires a function to change return type based on run-time decision made inside a function, but I cannot think of a simple solution for caller.</p>\n"}, {"tags": ["python", "c++", "pybind11"], "comments": [{"owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "edited": false, "score": 0, "creation_date": 1573085678, "post_id": 58739466, "comment_id": 103770297, "body": "<code>py::object data_class_output;</code> just creates a handle to a nullptr, not an actual python object, so then trying to add an attribute crashes. What is the intended output type? The same as the input type?"}, {"owner": {"reputation": 41, "user_id": 10694472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02ac61e4ea6cfd106526c71a23f1f652?s=128&d=identicon&r=PG&f=1", "display_name": "raef", "link": "https://stackoverflow.com/users/10694472/raef"}, "reply_to_user": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "edited": false, "score": 0, "creation_date": 1573137660, "post_id": 58739466, "comment_id": 103790375, "body": "thanks for the input. Regarding the output, in this example i want it to be similar to the input (a new python class with a float member variable &quot;new_data&quot;)."}, {"owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "edited": false, "score": 0, "creation_date": 1573140845, "post_id": 58739466, "comment_id": 103792169, "body": "Is not quite what I meant. I&#39;ll post a full code example as an &quot;answer&quot; below that will ease the discussion."}], "answers": [{"tags": [], "owner": {"reputation": 2343, "user_id": 9448377, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Wim Lavrijsen", "link": "https://stackoverflow.com/users/9448377/wim-lavrijsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1573141158, "creation_date": 1573141158, "answer_id": 58752178, "question_id": 58739466, "link": "https://stackoverflow.com/questions/58739466/how-to-set-a-new-attribute-in-pybind11-to-python-object-within-c/58752178#58752178", "title": "How to set a new attribute in pybind11 to python object within c++?", "body": "<p>There needs to be some object instance to attach the new attribute to. This object, if you want a new one, will need to be created from some type. If based on the discussion above you want the output type and input type to be the same, you can get the proper type from the <code>__class__</code> attribute of the input. Then, assuming <code>__init__</code> takes no additional parameters, create an instance and attach the attribute.</p>\n\n<p>Working example by adjusting yours follows:</p>\n\n<pre><code>#include &lt;pybind11/pybind11.h&gt;\n\nnamespace py = pybind11;\n\npy::object func_wrapper(py::object data_class_input){\n\n    //1) read in the data of some python class\n    int a       = data_class_input.attr(\"a\").cast&lt;int&gt;();\n\n    //2) do something\n    float new_data = 3.1; //just an example value\n\n    //3) make the results accessible from python:\n    py::object data_class_input_type = data_class_input.attr(\"__class__\");\n    py::object data_class_output = data_class_input_type();\n    data_class_output.attr(\"new_data\")    = py::cast(new_data);\n\n    return data_class_output;\n}\n\n//pybind11-related:\nPYBIND11_MODULE(TEST,m){\n  m.doc() = \"pybind11 example plugin\";\n  m.def(\"func_wrapper\",  &amp;func_wrapper);\n}\n</code></pre>\n\n<p>after which your python snippet will print:</p>\n\n<pre><code>3.09999990463\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10694472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02ac61e4ea6cfd106526c71a23f1f652?s=128&d=identicon&r=PG&f=1", "display_name": "raef", "link": "https://stackoverflow.com/users/10694472/raef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573141158, "creation_date": 1573079673, "question_id": 58739466, "link": "https://stackoverflow.com/questions/58739466/how-to-set-a-new-attribute-in-pybind11-to-python-object-within-c", "title": "How to set a new attribute in pybind11 to python object within c++?", "body": "<p>I am trying to create a new python class in c++ with pybind11, fill it with data and then return it. </p>\n\n<p>For example, take a simple class in python, which is then used in a c++ function call compiled with pybind11.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from TEST import func_wrapper \n\nclass class_DATA_py:\n    def __init__(self):\n        self.a   = 1\n\ndata_class_input = class_DATA_py()\ndata_return      = func_wrapper(data_class_input) #is not compiling\nprint(data_return.new_data) #is what I wish to see\n</code></pre>\n\n<p>Now use the class in c++ with the help of pybind 11. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;pybind11/pybind11.h&gt;\nnamespace py = pybind11;\n\npy::object func_wrapper(py::object data_class_input){\n\n    //1) read in the data of some python class\n    int a       = data_class_input.attr(\"a\").cast&lt;int&gt;();  \n\n    //2) do something \n    float new_data = 3.1; //just an example value\n\n    //3) make the results accessible from python:\n    py::object data_class_output;\n    //This is where things go wrong and crashes during compilation\n    //Is there a way to set an attribute so that I can write something like below?\n    data_class_output.attr(\"new_data\")    = py::cast(new_data);\n    return data_class_output;\n}\n\n//pybind11-related:\nPYBIND11_MODULE(TEST,m){\n  m.doc() = \"pybind11 example plugin\";\n  m.def(\"func_wrapper\",  &amp;func_wrapper);\n  );\n\n</code></pre>\n\n<p>The idea is then to be able to use the data_class_output in python and access for example the data_class_output.new_data value. </p>\n\n<p>A workaround is defining the data_class_output class also in python, use it as an additional input and fill the values there then. </p>\n\n<p>However, is it possible to work in the way outlined above and define the \"py::object data_class_output\" from scratch in c++ and then use it in python without problems?</p>\n"}, {"tags": ["c++", "codeblocks"], "comments": [{"owner": {"reputation": 8174, "user_id": 2319844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886739627f42f94f4e05159428a265fa?s=128&d=identicon&r=PG", "display_name": "Sumner Evans", "link": "https://stackoverflow.com/users/2319844/sumner-evans"}, "edited": false, "score": 0, "creation_date": 1573079016, "post_id": 58739332, "comment_id": 103768573, "body": "Can you post your <code>.cpp</code> file as well, please?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573079172, "post_id": 58739332, "comment_id": 103768621, "body": "Unrelated: Never do <code>using namespace std;</code> into the global namespace in header files. It&#39;ll taint the global namespace for all users of your header with possible errors/unexpected happenings as a result."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573079324, "post_id": 58739332, "comment_id": 103768663, "body": "Out of curiousity: <code>double numPurchased</code> implies buying non-integer amounts. Is that on purpose?"}, {"owner": {"reputation": 3, "user_id": 12229579, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCHjPs3glOC6EG3e1rkoHt3kIbyNiD3nhYWNXN_Nw=k-s128", "display_name": "Strange Festive Tortillas", "link": "https://stackoverflow.com/users/12229579/strange-festive-tortillas"}, "edited": false, "score": 0, "creation_date": 1573079450, "post_id": 58739332, "comment_id": 103768706, "body": "No, it&#39;s not. I&#39;ll fix that, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 2, "last_activity_date": 1573079516, "creation_date": 1573079516, "answer_id": 58739438, "question_id": 58739332, "link": "https://stackoverflow.com/questions/58739332/undefined-reference-to-function-cashregistergettotalprice/58739438#58739438", "title": "Undefined reference to function &quot;CashRegister::GetTotalPrice&quot;", "body": "<p>Your header:</p>\n\n<pre><code>double GetTotalPrice(InventoryItem myItem, int numPurchased)\n</code></pre>\n\n<p>Your <code>.cpp</code>:</p>\n\n<pre><code>double GetTotalPrice(InventoryItem myItem, double numPurchased)\n</code></pre>\n\n<p>The signature of the function in the <code>.cpp</code> file does not match that of the function in your header file. The function in the <code>.cpp</code> file is also a free function, not part of the class. </p>\n\n<p>You need this in your <code>.cpp</code>:</p>\n\n<pre><code>double CashRegister::GetTotalPrice(InventoryItem myItem, int numPurchased) {\n//...\n}\n</code></pre>\n\n<p>The same goes for the other member functions you've declared in the header file. Add <code>CashRegister::</code> before the function name in the <code>.cpp</code> file.</p>\n"}], "owner": {"reputation": 3, "user_id": 12229579, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCHjPs3glOC6EG3e1rkoHt3kIbyNiD3nhYWNXN_Nw=k-s128", "display_name": "Strange Festive Tortillas", "link": "https://stackoverflow.com/users/12229579/strange-festive-tortillas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58739438, "answer_count": 1, "score": 0, "last_activity_date": 1573079516, "creation_date": 1573078841, "last_edit_date": 1573079198, "question_id": 58739332, "link": "https://stackoverflow.com/questions/58739332/undefined-reference-to-function-cashregistergettotalprice", "title": "Undefined reference to function &quot;CashRegister::GetTotalPrice&quot;", "body": "<p>I'm trying to call a few functions in a separate class like so;</p>\n\n<pre><code>CashRegister* reg = new CashRegister();\n Subtotal = reg-&gt;GetTotalPrice(Shelf[Choice], Quantity);\n            Tax = reg-&gt;GetTax(Subtotal);\n            totalCost = Subtotal + Tax;\n            cout &lt;&lt; endl &lt;&lt; \"Aaah, big spender I see. That's going to cost you...\" &lt;&lt; endl;\n            cout &lt;&lt; \"Subtotal: \" &lt;&lt; totalCost &lt;&lt; endl &lt;&lt; \"Sales Tax: \" &lt;&lt; Tax &lt;&lt; endl &lt;&lt; \"Total\" &lt;&lt; totalCost &lt;&lt; endl;\n</code></pre>\n\n<p>But I'm getting the error \"undefined reference to <code>CashRegister::GetTotalPrice(InventoryItem, int)</code> along with the same errors for the other calls. </p>\n\n<p>Here's CashRegister.h </p>\n\n<pre><code>    #ifndef CASHREGISTER_H_INCLUDED\n    #define CASHREGISTER_H_INCLUDED\n    #include &lt;string&gt;\n    #include \"InventoryItem.h\"\n    using namespace std;\n\n    //Constant variables\n        const int PROFIT = .3;\n        const int SALES_TAX = .06;\n    class CashRegister\n    {\n        public:\n        CashRegister();\n\n        ~CashRegister();\n\n        double GetTotalPrice(InventoryItem myItem, int numPurchased); //Gets the total price and returns it (INC. profit).\n        double GetTax(double price); //Calculates sales tax and returns it (JUST the tax)\n        double GetProfit(double price); //Adds the profit margin to the item and returns the value\n    };\n\n\n#endif // CASHREGISTER_H_INCLUDED\n</code></pre>\n\n<p>I can post the rest if you need it, but its a lot. I would very much appreciate any help!</p>\n\n<p>edit: CashRegister.cpp;</p>\n\n<pre><code>#include \"CashRegister.h\"\n\nCashRegister::CashRegister()\n{\n\n}\n\n// Destructor\nCashRegister::~CashRegister()\n{\n\n}\ndouble GetProfit(double price)\n{\n    price = price * PROFIT;\n    return price;\n}\n\ndouble GetTax(double price)\n{\n    price = price * SALES_TAX;\n    return price;\n}\n\ndouble GetTotalPrice(InventoryItem myItem, double numPurchased)\n{\n    double myPrice = myItem.getCost();\n    myPrice = myPrice * numPurchased;\n    myPrice = GetProfit(myPrice);\n    return myPrice;\n}\n</code></pre>\n"}, {"tags": ["c++", "string", "templates", "dynamic-arrays"], "comments": [{"owner": {"reputation": 325, "user_id": 5616722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hBqY3INj7Ps/AAAAAAAAAAI/AAAAAAAAAA8/y9ipUGFo7wc/photo.jpg?sz=128", "display_name": "Patrick Sturm", "link": "https://stackoverflow.com/users/5616722/patrick-sturm"}, "edited": false, "score": 0, "creation_date": 1573078989, "post_id": 58739309, "comment_id": 103768565, "body": "First line of Add function will overflow. Try (len-1). If capacity == 10 and len == 10, it will still try add an item. Only next iteration will grow, after the critical error"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573079193, "post_id": 58739309, "comment_id": 103768627, "body": "No, that <code>if</code> statement appears to be correct. The buffer overrun and undefined behavior is somewhere else. The buffer overrun seems to be obvious, however, there are obvious typos and truncation in the shown code that indicate that the shown code has been edited. It possible that the editing also hid additional issues, so until the shown code is fixes so that it meets all requirements of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, it would be a bit premature (at least speaking for myself) to give the answer."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573079338, "post_id": 58739309, "comment_id": 103768669, "body": "&quot;I just added the parts where I think the mistakes are&quot;. That in itself is wrong. Instead, you should add everything that&#39;s necessary for the code to meet all requirements for <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, that anyone can simply cut/paste, compile, run, and reproduce your error. Right now, if what you showed is cut/pasted, it can&#39;t even compile. For more information, see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> in the <a href=\"https://stackoverflow.com/help\">help center</a>."}, {"owner": {"reputation": 325, "user_id": 5616722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hBqY3INj7Ps/AAAAAAAAAAI/AAAAAAAAAA8/y9ipUGFo7wc/photo.jpg?sz=128", "display_name": "Patrick Sturm", "link": "https://stackoverflow.com/users/5616722/patrick-sturm"}, "edited": false, "score": 0, "creation_date": 1573079365, "post_id": 58739309, "comment_id": 103768680, "body": "Perhaps the loop which goes from 0-&gt;len which should be 0-&gt;(len-1)"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1573079494, "post_id": 58739309, "comment_id": 103768724, "body": "That&#39;s probably the bug. However, in the past, in similar situations, once the obvious bug is pointed out, a little bit later you get a reply that says &quot;gee, I made that change, but the code is still broken&quot;. That was because there was something else in the code that wasn&#39;t even shown, that was also broken, and I wasted my time typing up an answer. So, for that reason, my personal policy is to only post a minimal comment if the question does not have a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. I must be able to cut/paste, reproduce the bug, apply my fix and recompile, and prove now that it&#39;s correct. Then I post an answer."}], "owner": {"reputation": 21, "user_id": 12334609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f089e6740641599e4112d53365aa25?s=128&d=identicon&r=PG&f=1", "display_name": "greenbanzai", "link": "https://stackoverflow.com/users/12334609/greenbanzai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573080688, "creation_date": 1573078691, "last_edit_date": 1573080688, "question_id": 58739309, "link": "https://stackoverflow.com/questions/58739309/c-access-violation-writing-location-when-adding-strings-to-a-dynamic-array", "title": "C++ Access violation writing location when adding strings to a dynamic array", "body": "<p>I'm implementing a dynamic array. My default array capacity is 10. When I'm trying to add more than 10 randomized strings I'm getting an error \"Access violation writing location. this-> **_Myproxy ** was 0xFDFDFDFD.\" and I'm thrown to the 239th line of xutility file.</p>\n\n<p>However when I set my array to contain ints or chars it works just fine. Same when I'm adding less than 10 strings so I have no idea where the problem is. Maybe I'm releasing memory in a twisted way?</p>\n\n<p>This is my main function as well as Arr class' constructor, destructor and void add function. </p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;time.h&gt;\nusing namespace std;\n\ntemplate &lt; typename T &gt;\nclass Arr\n{\n    T * data;\n    int capacity, len;\npublic:\n    Arr()\n    {\n        capacity = 10;\n        len = 0;\n        data = new T[ capacity ];\n    }\n    ~Arr()\n    {\n        delete[] data;\n    }\n    void add( T value )\n    {\n        if( capacity &lt;= len ) //powiekszenie jesli nie ma miejsca\n        {\n            capacity = 2 * capacity;\n            T * temp = new T[ capacity ];\n            for( int i = 0; i &lt;= len; i++ )\n            {\n                //temp[i] = data[i];\n                temp[ i ] = move( data[ i ] );\n            }\n            delete[] data;\n            data = temp;\n        }\n        data[ len++ ] = value;\n    }\n    const T retVal( const int index )\n    {\n        if( index &gt;= len )\n        {\n            cout &lt;&lt; \"Nie ma elementu o takim indeksie, zwracam wartosc el.     \n        [0]: \";\n        return this-&gt;data[ 0 ];\n    }\n    else\n         return this-&gt;data[ index ];\n\n    }\n    void change( int index, T new_data )\n    {\n        if( index &gt; len )\n        {\n            cout &lt;&lt; \"Nie ma takiego elementu\" &lt;&lt; endl;\n            return;\n        }\n        data[ index ] = new_data;\n    }\n    void clean()\n    {\n        if( len == 0 )\n        {\n            cout &lt;&lt; \"Tablica pusta!\" &lt;&lt; endl;\n            return;\n        }\n        len = len - 1;\n        for( int i = len; i &gt;= 1; --i )\n        {\n            data[ i ].~T();\n            len--;\n        }\n    }\n    void getData()\n    {\n        cout &lt;&lt; endl &lt;&lt; \"Akt. pojemnosc tablicy: \" &lt;&lt; capacity &lt;&lt; endl;\n        cout &lt;&lt; \"Liczba el. w tablicy: \" &lt;&lt; len &lt;&lt; endl;\n    }\n    void delLast()\n    {\n        data[ len-- ].~T();\n    }\n    void printArr()\n    {\n        for( int i = 0; i &lt; len; i++ )\n        {\n            cout &lt;&lt; data[ i ] &lt;&lt; \" \";\n        }\n        //cout &lt;&lt; \"Koniec\" &lt;&lt; endl;\n    }\n};\nstring randomString( int length )\n{\n    string rs;\n    static const char chars[] = \n  \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n    int size = sizeof( chars );\n    for( int i = 0; i &lt; length; i++ )\n    {\n        rs = rs + chars[ rand() %( size - 1 ) ];\n    }\n    return rs;\n}\nint main()\n{\nArr &lt; string &gt; * tab = new Arr &lt; string &gt;();\nconst int order = 7;\nconst int n = pow( 10, order );\nclock_t start = clock();\ndouble max_time_per_element = 0.0;\nsrand( time( 0 ) );\nfor( int i = 0; i &lt; n; i++ )\n{\n    string el = randomString( 3 );\n    clock_t start2 = clock();\n    tab-&gt;add( el );\n    clock_t stop2 = clock();\n    double time_per_element =( stop2 - start2 ) / CLOCKS_PER_SEC; // obliczenie czasu pojedynczej operacji dodawania\n    if( time_per_element &gt; max_time_per_element )\n    {\n        time_per_element = max_time_per_element;\n        cout &lt;&lt; max_time_per_element &lt;&lt; endl;\n    }\n}\nclock_t stop = clock();\ndouble general_time =( stop - start ) / CLOCKS_PER_SEC;\ntab-&gt;getData();\ncout &lt;&lt; \"Czas calej operacji to: \" &lt;&lt; general_time &lt;&lt; endl;\ntab-&gt;printArr();\ntab-&gt;clean(); // czyszczenie tablicy wraz z uwalnianiem pamieci danych\ndelete tab;\nreturn 0;\n}\n</code></pre>\n\n<p>[EDIT] As some of you suggestes I pasted the entire code instead of just some parts like at the beginning. Please forgive me that, I'm new here!</p>\n"}, {"tags": ["c++", "collision-detection", "computational-geometry", "glm-math"], "comments": [{"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573079290, "post_id": 58739275, "comment_id": 103768656, "body": "When you said &quot;triangular terrain&quot; at first I thought you just meant you had a height map and were managing the polygons as triangles. Is that essentially what your &quot;TriangularWalls&quot; amounts to? If they are equivalent, I&#39;d think you would get better performance by keeping track of it as a grid of height values. Also this would allow you to make certain assumptions about where you expect the sphere to be relative to the terrain."}, {"owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "reply_to_user": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573079533, "post_id": 58739275, "comment_id": 103768734, "body": "No, TriangularWalls simply defines a triangle with a normal, which is then used in the algorithm. I didn&#39;t implement a height map yet, but it sounds like a good idea. @Loduwijk"}, {"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573079638, "post_id": 58739275, "comment_id": 103768776, "body": "Like this pseudocode <code>y0 = (int)(sphere.y - sphere.radius); y1 = (int)(sphere.y + sphere.radius)+1; same thing for x0&#47;x1&#47;z0&#47;z1; for(y = y0 to y1) for(x = x0 to x1) if(z0 &lt;= height_map[x][y]) then there might be a collision so do your more detailed check else no possible collision</code>"}, {"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573079715, "post_id": 58739275, "comment_id": 103768810, "body": "That would not be an accurate check. That would just be a rough initial check to see if you should bother to check closer. That&#39;s something that is sometimes done in collision detection, though you might already be aware of that."}, {"owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "reply_to_user": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573080464, "post_id": 58739275, "comment_id": 103769022, "body": "@Loduwijk Yes. I already have a broader phase that I didn&#39;t include in the example code, because it looked ugly. Basically, the entire space is divided into 30&#215;30&#215;30 cells which store the ID of each terrain piece and object, and only objects / terrain from the same or adjacent cells are put into the closer collision phase. However, it&#39;s still pretty laggy. And it eats up quite a lot of memory, so I&#39;ll try implementing height maps instead."}, {"owner": {"reputation": 1852, "user_id": 369604, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/613ba412b35c0d51e4de306d92858bd4?s=128&d=identicon&r=PG", "display_name": "Loduwijk", "link": "https://stackoverflow.com/users/369604/loduwijk"}, "edited": false, "score": 0, "creation_date": 1573144362, "post_id": 58739275, "comment_id": 103794266, "body": "If a standard video-game-style heightmap is sufficient then I&#39;d recommend it, but before you go doing an overhaul just make sure you decide if it is sufficient. They are not as flexible as freeform polygons. Every x/y point is necessarily an integer on a square grid... (1,1), (1,2),... (1,n), (2,1), (2,2),... (2,n),... (n,n). Limited concave shapes, no holes, no completely vertical walls, and x/y coordinates snapped to the nearest integer. If you want to overcome any of those limitations with heightmaps you need to implement heightmap plus something else to go with it. But its fast/easy."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1573144625, "post_id": 58739275, "comment_id": 103794410, "body": "What do you call a collision ? Do you mean checking that the sphere intersects no triangle, or do you mean finding the remaining distance before the first intersection with a triangle occurs ? These are two different problems."}, {"owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1573149700, "post_id": 58739275, "comment_id": 103796889, "body": "@Yves Daoust I mean checking whether it intersects a triangle."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1573203393, "post_id": 58739275, "comment_id": 103812813, "body": "What do you mean by &quot;Multiple, simultaneous collisions give bad results&quot; ?"}, {"owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "reply_to_user": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1573226900, "post_id": 58739275, "comment_id": 103824676, "body": "@Yves Daoust If the object is sliding downhill on a slope and reaches a vertical wall, it goes through it. I had to implement something which stops the object in place if it&#39;d still run into the wall after the initial collision test, which significantly increases latency and provides ugly effects."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "edited": false, "score": 0, "creation_date": 1573298389, "post_id": 58763294, "comment_id": 103842098, "body": "I have partly implemented the bounding spheres for the triangles. But instead I&#39;d check if the squared distance is smaller than the squared sum of the radii in order to avoid square rooting."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "edited": false, "score": 0, "creation_date": 1573310946, "post_id": 58763294, "comment_id": 103844833, "body": "@John: goes without saying. But micro-optimizations come after the choice of efficient algorithms."}, {"owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "edited": false, "score": 0, "creation_date": 1573335785, "post_id": 58763294, "comment_id": 103850980, "body": "Turned out that the main lag source was from rendering the objects&#39; models. I ran a benchmark with 20004 objects without rendering them and 10000 triangles and it had a frame time of about 65 ms. With 200 rendered objects and 10000 triangles it was at about 350 ms. I should look into the shaders instead (and maybe use a lower poly model...)"}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": true, "score": 1, "last_activity_date": 1573203636, "last_edit_date": 1573203636, "creation_date": 1573203281, "answer_id": 58763294, "question_id": 58739275, "link": "https://stackoverflow.com/questions/58739275/how-to-provide-efficient-collision-detection-and-response-for-spherical-objects/58763294#58763294", "title": "How to provide efficient collision detection and response for spherical objects and triangular terrain?", "body": "<p>Assuming that what you call \"resource consuming\" is too high running-time, the number of triangles must be significant. So the first thing to do is to reduce the number of triangles to be tested against.</p>\n\n<p>You mentioned oct-trees. More generally, a hierarchy of bounding volumes is the way to go. (<a href=\"https://en.wikipedia.org/wiki/Bounding_volume_hierarchy\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Bounding_volume_hierarchy</a>.) Speedups will be tremendous for million triangles. In your particular case, I would probably opt for a binary tree of bounding spheres.</p>\n\n<hr>\n\n<p>Note that before implementing this, you will already obtain a speedup by precomputing the bounding sphere of every triangle (the center of the sphere is the center of the circumscribed circle, i.e. the intersection of the mediator planes and the plane of the triangle). Then non-intersecting triangles are detected by comparing the distance between the centers to the sum of radii.</p>\n\n<hr>\n\n<p>Regarding the exact intersection test between the sphere and a triangle, I am afraid that there is no free lunch. Using the \"inflating/deflating\" method, the center of the sphere can be inside either the right prism over the triangle, one of three truncated cylindres around the edges or one of three spheres around the vertices.</p>\n\n<p>Whatever approach you take, you will have to deal with that complexity of the case analysis.</p>\n"}], "owner": {"reputation": 183, "user_id": 5116730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69c95d49b2851459c34db8f26c696620?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/5116730/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 58763294, "answer_count": 1, "score": 0, "last_activity_date": 1575144795, "creation_date": 1573078475, "last_edit_date": 1575144795, "question_id": 58739275, "link": "https://stackoverflow.com/questions/58739275/how-to-provide-efficient-collision-detection-and-response-for-spherical-objects", "title": "How to provide efficient collision detection and response for spherical objects and triangular terrain?", "body": "<p>I've been trying to make efficient collision detection between objects and terrain. The objects are represented by mobile spheres and the terrain is made of static triangles.<br>\n<strong>So far, I managed to implement a collision algorithm, but it has some major issues:</strong><br>\n1. It's very resource-consuming.<br>\n2. Collision only works on one side of the triangles.<br>\n3. Multiple, simultaneous collisions give bad results.<br>\n<strong>Below I've put the algorithm that I have. It's based on an article from <a href=\"http://realtimecollisiondetection.net/blog/?p=103\" rel=\"nofollow noreferrer\">realtimecollisiondetection.net</a>, and it's using the GLM math library. I've simplified loops, variable names, unnecessary code and class members:</strong>  </p>\n\n<pre><code>//Class definitions:  \nclass Sphere\n{\n     public:\n     float x;\n     float y;\n     float z;\n     float radius;\n     float sqradius;\n     float xmov;\n     float ymov;\n     float zmov;\n};\nclass TriangularWall\n{\n     public:\n     float x[3];\n     float y[3];\n     float z[3];\n     glm::vec3 Normal;\n};\n</code></pre>\n\n<pre><code>using namespace glm; \nSphere Obj;\nTriangularWall Wall;\n//Assume that the 2 objects above are constructed. I didn't include their constructors because they looked ugly. \nfloat rr=Obj.sqradius;  \nvec3 A=vec3(Wall.x[0], Wall.y[0], Wall.z[0])-vec3(Obj.x, Obj.y, Obj.z);  \nvec3 B=vec3(Wall.x[1], Wall.y[1], Wall.z[1])-vec3(Obj.x, Obj.y, Obj.z);\nvec3 C=vec3(Wall.x[2], Wall.y[2], Wall.z[2])-vec3(Obj.x, Obj.y, Obj.z);  \nvec3 V=cross(B-A, C-A);  \nfloat d=dot(A, V);  \nfloat e=dot(V, V);  \nfloat di=d;  \nfloat ei=e;\nvec3 Ai;\nvec3 Bi;\nvec3 Ci;\nvec3 Vi;\nif(!(di*di&gt;rr*ei))\n{\n      float aa=dot(A, A);\n      float ab=dot(A, B);\n      float ac=dot(A, C);\n      float bb=dot(B, B);\n      float bc=dot(B, C);\n      float cc=dot(C, C);\n      if(!(aa&gt;rr &amp;&amp; ab&gt;aa &amp;&amp; ac&gt;aa))\n      if(!(bb&gt;rr &amp;&amp; ab&gt;bb &amp;&amp; bc&gt;bb))\n      if(!(cc&gt;rr &amp;&amp; ac&gt;cc &amp;&amp; bc&gt;cc))\n      {\n            vec3 AB=B-A;\n            vec3 BC=C-B;\n            vec3 CA=A-C;\n            float d1=ab-aa;\n            float d2=bc-bb;\n            float d3=ac-cc;\n            float e1=dot(AB, AB);\n            float e2=dot(BC, BC);\n            float e3=dot(CA, CA);\n            vec3 Q1=A*e1-d1*AB;\n            vec3 Q2=B*e2-d2*BC;\n            vec3 Q3=C*e3-d3*CA;\n            vec3 QC=C*e1-Q1;\n            vec3 QA=A*e2-Q2;\n            vec3 QB=B*e3-Q3;\n            if(!(dot(Q1, Q1)&gt;rr*e1*e1 &amp;&amp; dot(Q1, QC)&gt;0)\n            if(!(dot(Q2, Q2)&gt;rr*e2*e2 &amp;&amp; dot(Q2, QA)&gt;0)\n            if(!(dot(Q3, Q3)&gt;rr*e3*e3 &amp;&amp; dot(Q3, QB)&gt;0)\n            {\n                  vec3 ObjectMov=vec3(Obj.xmov, Obj.ymov, Obj.zmov);\n                  if(dot(ObjectMov, Wall.Normal)&lt;0)\n                  ObjectMov-=dot(ObjectMov, Wall.Normal);\n                  Obj.xmov=ObjectMov [0];\n                  Obj.ymov=ObjectMov [1];\n                  Obj.zmov=ObjectMov [2];\n            }\n      }\n}\n</code></pre>\n\n<p>For the third issue, I re-made the above algorithm (simply stopping the object on the corresponding axis if a collision still takes place). However, this loads up the program significantly, and doesn't produce that nice effects.<br>\nI'm also aware that I could include a few performance tweaks to the algorithm above, but I don't see anything that could improve performance by a significant margin.<br>\n<em>I know that I could also use octrees, however they seemed pretty complicated to me and I'm also worried that they could, in some situations, create a lot of latency.</em><br>\n<strong>Therefore, is there any way to improve the algorithm I used in order to fix its main issues? Or should I just try to use another one?</strong></p>\n"}, {"tags": ["c++", "opencv", "convolution"], "comments": [{"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1573114558, "post_id": 58739200, "comment_id": 103777940, "body": "The image is grayish because of the normalization.  Your edge detection will produce positive, negative or zero values.  The zero values get increased to 0.5, the negative values are close to 0, the positive values are close to 1.  You are getting the correct result.  I will preface that your Gaussian Blur is not truly one as you didn&#39;t normalize by the sum of the kernel values.  If you did that, then you wouldn&#39;t need to normalize the result after you do the convolution."}], "owner": {"reputation": 63, "user_id": 8929547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da5fc2fa5bc961a92e756de12ea506d5?s=128&d=identicon&r=PG&f=1", "display_name": "Flix17", "link": "https://stackoverflow.com/users/8929547/flix17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573078011, "creation_date": 1573078011, "question_id": 58739200, "link": "https://stackoverflow.com/questions/58739200/2d-convolution-border-handling-zero-padding-not-working", "title": "2D Convolution border handling: zero padding not working?", "body": "<p>I am doing a homework where we need to write a function which gets an image and a kernel and we have to calculate the 2d spatial convolution.\nUsing a gaussian kernel I get the expected result (a blurred image) but if I use instead for example an edge detection kernel <a href=\"https://en.wikipedia.org/wiki/Kernel_(image_processing)\" rel=\"nofollow noreferrer\">(taken from here)</a> I see that something isn't working properly (the image becomes very greyish).</p>\n\n<p>I guess the problem is either the border handling, which should be a zero-padding but I am not totally sure if implemented it correctly or the normalization at the end.\nIs there a way to display a float image (e.g. one pixel of the float has a value for 25000), because I think it always gets capped at 255 (white) if I don't use the normalization.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;opencv2/core/core.hpp&gt;\n#include &lt;opencv2/imgproc/imgproc.hpp&gt;\n#include &lt;opencv2/highgui/highgui.hpp&gt;\n#include &lt;iostream&gt;\n\nint main(int argc, char *argv[])\n{\n    cv::Mat img = cv::imread(\"orig.jpg\",0);             // load image as grayscale\n    img.convertTo(img,CV_32FC1);                        // convert to float\n    cv::Mat_&lt;float&gt; output(img.rows,img.cols);          // create new mat with same size as source image\n    output = 0;   \n    // creating a kernel (here Gaussian blur)\n    cv::Mat_&lt;float&gt; kernel(5,5);\n    kernel &lt;&lt; 1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1;\n\n    int kCenterX = kernel.cols/2;\n    int kCenterY = kernel.rows/2;\n\n    for (int i = 0; i &lt; img.rows; i++){                 // for every row in image\n        for (int j = 0; j &lt; img.cols; j++){             // for every column in image\n            for (int m = 0; m &lt; kernel.rows; m++){      // for every row of kernel\n                int mm = kernel.rows - 1 -m;            // row index of flipped kernel\n                for (int n = 0; n &lt; kernel.cols; n++){  // for every column of kernel\n                    int nn = kernel.cols - 1 -n;        // column index of flipped kernel\n                    // index for border handling\n                    int ii = i + (m - kCenterY);\n                    int jj = j + (n - kCenterX);\n                    // checking if sample is still in bound of input image\n                    // and if not, treat those pixels as 0 (because they won't get added to sum)\n                    if (ii &gt;= 0 &amp;&amp; ii &lt; img.rows &amp;&amp; jj &gt;= 0 &amp;&amp; jj &lt; img.cols)\n                        output.at&lt;float&gt;(i,j) += img.at&lt;float&gt;(ii,jj) * kernel.at&lt;float&gt;(mm,nn);\n                }\n            }\n        }\n    }\n    // normalize input and output image (might be wrong, but I don't know how else I can see float images\n    cv::normalize(output, output, 0, 1, cv::NORM_MINMAX);\n    cv::normalize(img, img, 0, 1, cv::NORM_MINMAX);\n    // display images\n    cv::imshow(\"Original\", img);\n    cv::imshow(\"Convolution\", output);\n    cv::waitKey(0);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "language-lawyer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573077827, "post_id": 58739126, "comment_id": 103768165, "body": "<code>std::numeric_limits</code> should give you all the information you need to know if the values are convertible (calculation will be required)."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573078577, "post_id": 58739126, "comment_id": 103768436, "body": "@NathanOliver-ReinstateMonica I am not sure what I should use for comparison. As I mentioned I don&#39;t think I can compare against <code>max</code>, because that would already require the operand to be converted to that type, which may not be possible. I could compare the log2 of the integer against <code>max_exponent</code>, but I am not sure that I can draw any conclusion when they compare equal."}, {"owner": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 2, "creation_date": 1573079055, "post_id": 58739126, "comment_id": 103768583, "body": "<a href=\"https://stackoverflow.com/questions/51104995/can-a-conversion-from-double-to-int-be-written-in-portable-c\" title=\"can a conversion from double to int be written in portable c\">stackoverflow.com/questions/51104995/&hellip;</a> related or even a duplicate"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 1396, "user_id": 4625005, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/jm809.gif?s=128&g=1", "display_name": "Green Tree", "link": "https://stackoverflow.com/users/4625005/green-tree"}, "edited": false, "score": 0, "creation_date": 1573079341, "post_id": 58739126, "comment_id": 103768672, "body": "@GreenTree Thanks, I must have searched for the wrong terms. This and the other linked questions seem like duplicates. I still need to read through them in detail though."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573082816, "post_id": 58739126, "comment_id": 103769666, "body": "Is there anything wrong with just doing the conversion both directions and checking for equality? I have trouble thinking of a case where that would fail."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573083225, "post_id": 58739126, "comment_id": 103769749, "body": "@MarkRansom That might work, yet may need to do twice: FP--&gt;i-&gt;FP compare as FP and a i-&gt;FP-&gt;i compare as integer"}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573083321, "post_id": 58739126, "comment_id": 103769774, "body": "@chux-ReinstateMonica I was thinking of two functions, one for each conversion direction. Each would only need a single check."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573083443, "post_id": 58739126, "comment_id": 103769802, "body": "@MarkRansom The conversion has undefined behavior if the value falls outside the representable range, so it may not be used without prior testing whether the function I am looking for returns <code>true</code>."}], "answers": [{"comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573083947, "post_id": 58739833, "comment_id": 103769924, "body": "Yes, I am not interested in the fractional part. The case where the range of <code>I</code> is potentially larger than that of <code>F</code> is what I considered problematic. The linked question doesn&#39;t completely answer the question, but I guess could be considered a duplicate. If someone wants to close it as duplicate, that would be fine by me."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573084395, "post_id": 58739833, "comment_id": 103770025, "body": "@uneven_mark Yes the &quot;I is larger than that of F&quot; is tricky - I&#39;ll add something later on that - real life is calling me away. <a href=\"https://stackoverflow.com/a/51310956/2410359\"><code>int double_to_int(double val, int *err)</code></a> does handle the &quot;not interested in the fractional part&quot;."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1573084463, "last_edit_date": 1573084463, "creation_date": 1573082595, "answer_id": 58739833, "question_id": 58739126, "link": "https://stackoverflow.com/questions/58739126/implementation-independent-floating-point-integer-conversions/58739833#58739833", "title": "Implementation-independent floating-point/integer conversions", "body": "<p><em>some float</em> to <em>some int</em> is fairly easy is we can assume <code>FLT_RADIX != 10</code> (2<sup>N</sup> floating point) and the range of FP exceeds the integer range.</p>\n\n<p>Form exact FP limits<br>\nTest if FP has a fraction part that is 0<sup>**</sup>.   (also handles NaN, inf)<br>\nTest if too positive.<br>\nTest if too negative.<br>\nTest if converted to integer value rounds. </p>\n\n<p>Pseudo code</p>\n\n<pre><code>// For now, assume 2's complement.\n// With some extra macro magic, could handle all integer encodings. \n\n// Use integer limits whose magnitudes are at or 1 away from a power-of-2  \n//   and form FP power-of-2 limits \n// The following will certainly not incur any rounding\n#define FLT_INT_MAXP1 ((INT_MAX/2 + 1)*2.0f)\n#define FLT_INT_MIN (INT_MIN*1.0f)\n\nstatus float_to_int_test(float f) {\n  float ipart;\n  if (modff(f, &amp;ipart) != 0.0) {\n    return not_a_whole_number;\n  }\n  if (f &gt;= FLT_INT_MAXP1) return too_big;\n  if (f &lt; FLT_INT_MIN) return too_negative;\n  if (f != (volatile float) f)) return rounding_occurred;\n  return success;\n}\n</code></pre>\n\n<hr>\n\n<p>Armed with the above float_to_int test....</p>\n\n<pre><code>status int_to_float_test(int i) { \n  volatile float f = (float) i;\n  if (float_to_int_test(f) != success) return fail\n  volatile int j = (int) f;\n  if (i != j) return fail;\n  return success;\n}\n</code></pre>\n\n<hr>\n\n<p>Simplifications possible, but something to get OP started.</p>\n\n<p>Extreme cases which need additional code include <code>int128_t</code> or wider having more range than <code>float</code> and <code>FLT_RADIX == 10</code>.</p>\n\n<hr>\n\n<p><sup>**</sup> Hmmm - appears OP does not cares about fractional part.  In that case <a href=\"https://stackoverflow.com/questions/51104995/can-a-conversion-from-double-to-int-be-written-in-portable-c\">conversion from double to int</a> appears as a good duplicate for half the problem.</p>\n"}], "owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1573084463, "creation_date": 1573077574, "question_id": 58739126, "link": "https://stackoverflow.com/questions/58739126/implementation-independent-floating-point-integer-conversions", "title": "Implementation-independent floating-point/integer conversions", "body": "<p>Suppose <code>I</code> is some integer type and <code>F</code> some (real) floating point type.</p>\n\n<p>I want to write two functions. The first function shall take a value <code>i</code> of type <code>I</code> and return a boolean indicating whether <code>i</code> converted to <code>F</code> falls into the representable range, i.e. whether <code>(F)i</code> will have defined behavior.</p>\n\n<p>The second function shall take a value <code>f</code> of type <code>F</code> and return a boolean indicating whether <code>f</code> converted to <code>I</code> falls into the representable range, i.e. whether <code>(I)f</code> will have defined behavior.</p>\n\n<p>Is it possible to write such a function that will be, on every implementation conforming to the standard, correct and not exhibit undefined behavior for any input? In particular I do not want to assume that the floating point types are IEEE 754 types.</p>\n\n<p>I am asking about both C and C++ and their respective standard versions separately, in case that changes the answer.</p>\n\n<p>Basically the intention of this question is to figure out whether (sensible) floating-point / integral conversions are possible without relying on IEEE 754 or other standards or hardware details at all. I ask out of curiosity.</p>\n\n<p>Comparing against e.g. <code>INT_MAX</code> or <code>FLT_MAX</code> does not seem to be possible, because it is not clear which type to do the comparison in without already knowing which of the types has wider range.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573077630, "post_id": 58739104, "comment_id": 103768106, "body": "Define &quot;run the final output multiple times&quot;. What does this mean? Yes, there are several obvious bugs in the shown code, but it&#39;s unclear what your actual question is."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573077892, "post_id": 58739104, "comment_id": 103768191, "body": "You should check out some <a href=\"https://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\">good documentation for the <code>std::string</code> member functions</a>. Odds are good you&#39;ll find at least one function that does exactly what you need."}, {"owner": {"reputation": 559, "user_id": 12322064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/23a8u.jpg?s=128&g=1", "display_name": "ufoxDan", "link": "https://stackoverflow.com/users/12322064/ufoxdan"}, "edited": false, "score": 0, "creation_date": 1573077939, "post_id": 58739104, "comment_id": 103768205, "body": "I ran your code, and I think your&#39;e asking how to stop printing that the pair is in the list multiple times yes? i.e. once it finds a pair it prints it and then exits?"}, {"owner": {"reputation": 559, "user_id": 12322064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/23a8u.jpg?s=128&g=1", "display_name": "ufoxDan", "link": "https://stackoverflow.com/users/12322064/ufoxdan"}, "edited": false, "score": 1, "creation_date": 1573078336, "post_id": 58739104, "comment_id": 103768345, "body": "To reiterate, if there are multiple occurrences of the pair, do you want to print every occurrence or just the first? Regardless you might get the &quot;is not in string&quot; message multiple times because this triggers every time the first letter of the pair is found but the next doesn&#39;t match."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1573078367, "post_id": 58739104, "comment_id": 103768357, "body": "Have you tried <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">explaining every line in your program to your rubber duck</a>? Remember the Golden Rule Of Computer Programming: &quot;A Computer Always Does Exactly What You Told It To Do, Instead Of What You Want It To Do&quot;. Now, write out in plain English (or your native language), exactly what you told your computer to do with your <code>for</code> loop, and read it outloud to your rubber duck, and your bug should be very obvious."}, {"owner": {"reputation": 11, "user_id": 12300491, "user_type": "registered", "profile_image": "https://graph.facebook.com/2884692018210576/picture?type=large", "display_name": "user12300491", "link": "https://stackoverflow.com/users/12300491/user12300491"}, "edited": false, "score": 0, "creation_date": 1573078493, "post_id": 58739104, "comment_id": 103768404, "body": "which for loop are you refering too"}, {"owner": {"reputation": 559, "user_id": 12322064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/23a8u.jpg?s=128&g=1", "display_name": "ufoxDan", "link": "https://stackoverflow.com/users/12322064/ufoxdan"}, "edited": false, "score": 0, "creation_date": 1573078744, "post_id": 58739104, "comment_id": 103768488, "body": "Again <i>do you want it to print every occurrence or just the first</i>? If you answer this then we know what you&#39;re going for and can better help you get there. The rubber duck is a great suggestion too."}], "owner": {"reputation": 11, "user_id": 12300491, "user_type": "registered", "profile_image": "https://graph.facebook.com/2884692018210576/picture?type=large", "display_name": "user12300491", "link": "https://stackoverflow.com/users/12300491/user12300491"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573077819, "creation_date": 1573077482, "last_edit_date": 1573077819, "question_id": 58739104, "link": "https://stackoverflow.com/questions/58739104/ask-the-user-if-a-sequence-of-two-letters-is-in-a-random-array-of-letters", "title": "ask the user if a sequence of two letters is in a random array of letters", "body": "<p>The user inputs some desired length of a string of characters . then the program outputs a list of randomly generated characters. After which the user is prompted to input 2 characters (that either exist or does not exist whiten the list). the program will then output where the first character appears in the pair or say that the pair does not exist in the list.    </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;stdlib.h&gt;\nusing namespace std;\nint main()\n{\n    int size, c;\n    char ltr1, ltr2;\n    cout &lt;&lt; \"How many letters do you want in your random sting? \";\n    cin &gt;&gt; size;\n    string str;\n    for (int i = 0; i &lt; size; i++)\n    {\n        c = rand() % 26 + 'a';\n        str.push_back(c);\n    }\n    for (int i = 0; i &lt; size; i++)\n    {\n        cout &lt;&lt; str[i];\n    }\n    cout &lt;&lt; endl &lt;&lt; endl;\n\n    cout &lt;&lt; \"what pair of letters would you like to find?\";\n    cin &gt;&gt; ltr1;\n    cin &gt;&gt; ltr2;\n    cout &lt;&lt; endl;\n    for (int i = 0; i &lt; size; i++)\n    {\n        if (char((str[i] == ltr1) &amp;&amp; (str[i + 1] == ltr2)))\n        {\n            cout &lt;&lt; \"the pair is in the string starting at character number \"\n                 &lt;&lt; i &lt;&lt; \" in the string\" &lt;&lt; endl;\n        }\n        if (char((str[i] == ltr1) &amp;&amp; (str[i + 1] != ltr2)))\n        {\n            cout &lt;&lt; \"the pair \" &lt;&lt; ltr1 &lt;&lt; ltr2 &lt;&lt; \" is not in the string.\" &lt;&lt; endl;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>the output is capable of determining weather or not the pair exist or not and will output the location however if you input a value greater than 25 it will run the final output multiple times.</p>\n"}, {"tags": ["c++", "arrays", "data-structures", "graph"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 3, "creation_date": 1573077227, "post_id": 58739031, "comment_id": 103767957, "body": "Use <code>std::vector</code>?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573077550, "post_id": 58739031, "comment_id": 103768072, "body": "Unrelated: <code>#include &lt;bits&#47;stdc++.h&gt;</code> <a href=\"https://stackoverflow.com/questions/31816095/why-should-i-not-include-bits-stdc-h\">loads the gun</a>. <code>using namespace std;</code> <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">takes the safety off</a>. Be really cautious with this combination."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12334574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc906b718b5019423f73a4da712feb1?s=128&d=identicon&r=PG&f=1", "display_name": "Avneetsingh", "link": "https://stackoverflow.com/users/12334574/avneetsingh"}, "is_accepted": true, "score": 0, "last_activity_date": 1573110099, "creation_date": 1573110099, "answer_id": 58743480, "question_id": 58739031, "link": "https://stackoverflow.com/questions/58739031/how-to-redeclare-the-same-array-again-in-a-loop-with-different-size-everytime/58743480#58743480", "title": "How to redeclare the same array again in a loop with different size everytime?", "body": "<p>Guys the issue was resolved. The problem was not in the way how colVert array was declared but a really silly mistake:</p>\n\n<pre><code>for(i=0;i&lt;num;i++){\n            sum = sum + colVert[i];\n        }\n</code></pre>\n\n<p>I used 'i' variable in a loop inside a loop which is also using 'i' as its counter. Simply using any other counter variable fixed the problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 12334574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc906b718b5019423f73a4da712feb1?s=128&d=identicon&r=PG&f=1", "display_name": "Avneetsingh", "link": "https://stackoverflow.com/users/12334574/avneetsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58743480, "answer_count": 1, "score": 0, "last_activity_date": 1573110099, "creation_date": 1573077148, "last_edit_date": 1573077268, "question_id": 58739031, "link": "https://stackoverflow.com/questions/58739031/how-to-redeclare-the-same-array-again-in-a-loop-with-different-size-everytime", "title": "How to redeclare the same array again in a loop with different size everytime?", "body": "<p>So i am doing a graph coloring problem in which i input number of test cases for which the code has to run. Here's the code:</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\n\nint main() {\n    int test,num,i,j,k,l,sum,num1,num2,count,col;\n    cin&gt;&gt;test;\n    for(i=0;i&lt;test;i++){\n        sum = 0;\n        cin&gt;&gt;num;\n        int arr[num][num];\n\n        for(j=0;j&lt;num;j++){\n            for(k=0;k&lt;num;k++){\n                arr[j][k] = 0;\n            }\n        }\n\n        for(l=0;l&lt;num-1;l++){\n            cin&gt;&gt;num1&gt;&gt;num2;\n            arr[num1-1][num2-1] = 1;\n            arr[num2-1][num1-1] = 1;\n        }\n\n        int* colVert = new int[num];\n\n        for(j=0;j&lt;num;j++){\n            colVert[j] = 0;\n        }\n\n        for(j=0;j&lt;num;j++){\n            count = 0;\n            l=0;\n            if(j == 0){\n                colVert[j] = 1;\n            }\n\n            else{\n                for(k=0;k&lt;num;k++){\n                    if(arr[j][k] == 1){\n                        count++;\n                    }\n                }\n                int colSeq[count];\n                for(k=0;k&lt;num;k++){\n                    if(arr[j][k] == 1){\n                        colSeq[l] = colVert[k];\n                        l++;\n                    }\n                }\n                sort(colSeq, colSeq+count);\n                /*for(k=0;k&lt;count;k++){\n                    cout&lt;&lt;colSeq[k];\n                }*/\n                for(k=0;k&lt;count;k++){\n                    if(colSeq[k] != k+1){\n                        col = k;\n                        break;\n                    }\n                    else{\n                        col = colSeq[k] + 1;\n                    }\n                }\n                colVert[j] = col;\n            }\n        }\n\n        for(i=0;i&lt;num;i++){\n            sum = sum + colVert[i];\n        }\n\n        cout&lt;&lt;sum&lt;&lt;endl;\n    }\n    return 0;\n}\n\n</code></pre>\n\n<p>So the problem is the code only runs for the first test case and then program ends. I think the problem is with the way i have declared colVert array. So how to do it correctly so that it runs for every case?</p>\n"}, {"tags": ["c++", "c++17", "auto"], "owner": {"reputation": 11861, "user_id": 1899020, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c6f377132e8aad22b97bfcc85adffdb?s=128&d=identicon&r=PG", "display_name": "user1899020", "link": "https://stackoverflow.com/users/1899020/user1899020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1573077243, "answer_count": 0, "score": 2, "last_activity_date": 1573077077, "creation_date": 1573077077, "question_id": 58739024, "link": "https://stackoverflow.com/questions/58739024/how-to-use-auto-to-declare-a-couple-of-variables-deeply", "closed_reason": "Duplicate", "title": "how to use auto to declare a couple of variables deeply?", "body": "<p>If I have a map, I can use auto to declare variables like</p>\n\n<pre><code>map&lt;int, float&gt; m;\nfor (auto[i, f] : m) {\n    ...\n}\n</code></pre>\n\n<p>If the map is</p>\n\n<pre><code>map&lt;int, pair&lt;float, bool&gt;&gt; m;\nfor (auto[i, [f, b]] : m) { // not right\n    ...\n}\n</code></pre>\n\n<p>How can I still use the <code>auto</code> to declare a number of variables together? </p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1573077063, "creation_date": 1573077063, "answer_id": 58739019, "question_id": 58738884, "link": "https://stackoverflow.com/questions/58738884/dev-c-line-69-error-name-lookup-of-i-changed-for-iso-for-scoping-fperm/58739019#58739019", "title": "DEV C++ Line 69 [Error] name lookup of &#39;i&#39; changed for ISO &#39;for&#39; scoping [-fpermissive]", "body": "<p>You have defined <code>i</code> in a few places but their lifetimes &amp; scope are all limited to their respective <code>for</code> loops.</p>\n\n<p>But here</p>\n\n<pre><code>cout&lt;&lt;emp[i].nombre&lt;&lt;\"\\t \"&lt;&lt;emp[i].apellido&lt;&lt;\"\\t \"&lt;&lt;emp[i].horas&lt;&lt;\"\\t \"&lt;&lt;emp[i].salporhora&lt;&lt;\"\\t \"&lt;&lt;emp[i].edad&lt;&lt;\"\\t \"&lt;&lt;emp[i].salbruto&lt;&lt;\"\\t \"&lt;&lt;emp[i].imp&lt;&lt;\"\\t \"&lt;&lt;emp[i].salneto&lt;&lt;\"\\n\";\n</code></pre>\n\n<p>you are using <code>i</code> - but there's no <code>i</code> defined in this scope. That's what the error is about.</p>\n\n<p>Perhaps you meant to include inside the <code>for</code> loop above?</p>\n\n<pre><code>for (int i=0;i&lt;2;i++){          \n    emp[i].imp = emp[i].salbruto * 0.20;\n    emp[i].salneto = emp[i].salbruto - emp[i].imp;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12177960, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBh-p1CiqLZ9P4Uc6JZanIpuNzoVyecpk6wVLiH=k-s128", "display_name": "alex gonz", "link": "https://stackoverflow.com/users/12177960/alex-gonz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573112276, "creation_date": 1573076340, "last_edit_date": 1573112276, "question_id": 58738884, "link": "https://stackoverflow.com/questions/58738884/dev-c-line-69-error-name-lookup-of-i-changed-for-iso-for-scoping-fperm", "title": "DEV C++ Line 69 [Error] name lookup of &#39;i&#39; changed for ISO &#39;for&#39; scoping [-fpermissive]", "body": "<p>I've been working on this code for a while and I've made it compile yet it doesn't do what I want it to do.</p>\n\n<p>Here is the problem so you can see what I'm trying to do.</p>\n\n<p>Develop a program that allows solving the following problem: Panamericana S.A. You want to modify and print the information of your 5 employees. For each one the program must read the name, hours of work, the payment base, the age. For example, a typical group of data could be:</p>\n\n<ul>\n<li>Full payment for employees at least 40 years old</li>\n<li>The average total payment for employees under 45</li>\n<li>The name and total payment for the employee with maximum total payment (It is assumed that there is no tie)</li>\n</ul>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;cstdlib&gt;\n#include &lt;windows.h&gt;\n\nusing namespace std;\n\n    struct Empleados{\n        char nombre[20];\n        char apellido[20];\n        double edad;\n        float horas;\n        float salporhora;\n        float imp;\n        float salbruto;\n        float salneto;\n    }emp[2];\n\nint main(){\n\n    int posM = 0, posm = 0;\n    float sal=40;\n    float impuesto = 200;\n    float sa,prom45;\n    float mayor = 0, menor = 99999;\n    for(int i=0;i&lt;2;i++)\n    {\n        fflush(stdin);\n        cout&lt;&lt;\"Introduzca nombre del empleado: \";\n        cin.getline(emp[i].nombre,20,'\\n');\n        cout&lt;&lt;\"Introduzca Apellido del empleado: \";\n        cin.getline(emp[i].apellido,20,'\\n');\n        cout&lt;&lt;\"Introduzca su edad: \";\n        cin&gt;&gt;emp[i].edad;\n        cout&lt;&lt;\"Introduzca sus horas de trabajo: \";\n        cin&gt;&gt;emp[i].horas;\n        cout&lt;&lt;\"Pago por hora: \";\n        cin&gt;&gt;emp[i].salporhora;\n        cout&lt;&lt;\"\\n\";\n    }\n        for(int i=0;i&lt;2;i++){\n        sa = emp[i].salbruto * 1.5;\n        emp[i].salbruto = sa + (emp[i].horas * emp[i].salporhora);  \n        }\n\n        for(int i=0;i&lt;2;i++){\n        if (emp[i].salneto &gt; mayor){\n            mayor = emp[i].salneto;\n            posM = i;\n        }\n        if (emp[i].salneto &lt; menor){\n            menor = emp[i].salneto;\n            posm = i;\n        }\n\n    }\n\n    for (int i=0;i&lt;2;i++){          \n        emp[i].imp = emp[i].salbruto * 0.20;\n        emp[i].salneto = emp[i].salbruto - emp[i].imp;\n    }\n\n\n\n\n        cout&lt;&lt;\"NOMBRE\"&lt;&lt;\"\\t \"&lt;&lt;\"APELLIDO\"&lt;&lt;\"\\t \"&lt;&lt;\"HORAS\"&lt;&lt;\"\\t \"&lt;&lt;\"SUELDO\"&lt;&lt;\"\\t \"&lt;&lt;\"EDAD\"&lt;&lt;\"\\t \"&lt;&lt;\"TOTAL\"&lt;&lt;\"\\t \"&lt;&lt;\"IMP%\"&lt;&lt;\"\\t \"&lt;&lt;\"NETO\"&lt;&lt;\"\\n\";\n        cout&lt;&lt;emp[i].nombre&lt;&lt;\"\\t \"&lt;&lt;emp[i].apellido&lt;&lt;\"\\t \"&lt;&lt;emp[i].horas&lt;&lt;\"\\t \"&lt;&lt;emp[i].salporhora&lt;&lt;\"\\t \"&lt;&lt;emp[i].edad&lt;&lt;\"\\t \"&lt;&lt;emp[i].salbruto&lt;&lt;\"\\t \"&lt;&lt;emp[i].imp&lt;&lt;\"\\t \"&lt;&lt;emp[i].salneto&lt;&lt;\"\\n\";\n\n    for(int i=0;i&lt;2;i++){\n\n        if (emp[i].edad &gt;= 40){\n            cout&lt;&lt;\"Los Pagos totales de los empleados de almenos 40 \"&lt;&lt;emp[i].salneto&lt;&lt;\"\\n\";\n        }\n        if (emp[i].edad &lt; 45){\n            prom45 = emp[i].salneto/2;\n            cout&lt;&lt;\"El Promedio de Los Pagos totales de los empleados de menos de 45 anos \"&lt;&lt;prom45&lt;&lt;\"\\n\";\n        }\n   }\n        cout&lt;&lt;\"\\nEl empleado con mayor salario es: \"&lt;&lt;emp[posM].nombre&lt;&lt;endl;\n        cout&lt;&lt;\"Que tiene un salario de: \"&lt;&lt;posM&lt;&lt;endl;\n        Sleep (5000);\n        cout&lt;&lt;\"\\nGracias Por su Tiempo\"&lt;&lt;endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "xcode", "sfml", "macos-catalina"], "comments": [{"owner": {"reputation": 1530, "user_id": 181836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9c67de7f6ac08f5d8031d74fd83c8c42?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/181836/greg"}, "edited": false, "score": 0, "creation_date": 1573082006, "post_id": 58738867, "comment_id": 103769443, "body": "Welcome to Stack Overflow! Please visit <a href=\"https://stackoverflow.com/help\">help center</a>, take a <a href=\"https://stackoverflow.com/tour\">tour</a>  to see what and  <a href=\"https://stackoverflow.com/questions/how-to-ask\">how to ask</a>.  if you get stuck, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your attempt."}, {"owner": {"reputation": 3333, "user_id": 1040347, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/43Chf.jpg?s=128&g=1", "display_name": "Aleksey Potapov", "link": "https://stackoverflow.com/users/1040347/aleksey-potapov"}, "edited": false, "score": 0, "creation_date": 1575918367, "post_id": 58738867, "comment_id": 104719794, "body": "contact the framework <a href=\"https://www.sfml-dev.org/community.php\" rel=\"nofollow noreferrer\">support community</a>"}, {"owner": {"reputation": 3333, "user_id": 1040347, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/43Chf.jpg?s=128&g=1", "display_name": "Aleksey Potapov", "link": "https://stackoverflow.com/users/1040347/aleksey-potapov"}, "edited": false, "score": 0, "creation_date": 1575924961, "post_id": 58738867, "comment_id": 104722334, "body": "<a href=\"https://stackoverflow.com/a/59255716/1040347\">stackoverflow.com/a/59255716/1040347</a>"}], "owner": {"reputation": 1, "user_id": 11956252, "user_type": "registered", "profile_image": "https://graph.facebook.com/641196109998665/picture?type=large", "display_name": "NintySwinty", "link": "https://stackoverflow.com/users/11956252/nintyswinty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573076258, "creation_date": 1573076258, "question_id": 58738867, "link": "https://stackoverflow.com/questions/58738867/how-to-fix-bundle-format-unrecognized-invalid-or-unsuitable", "title": "How to fix: &quot;bundle format unrecognized, invalid, or unsuitable&quot;", "body": "<p>I create project to school and after update my MacOS to Catalina SFML start doesn't work.</p>\n\n<p>i had been used this links at my project still doesn't work.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29271548/code-sign-error-bundle-format-unrecognized-invalid-or-unsuitable\">Code sign error : bundle format unrecognized, invalid, or unsuitable</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/37720234/xcode-bundle-format-unrecognized-invalid-or-unsuitable/38751921\">Xcode - Bundle format unrecognized, invalid, or unsuitable</a></p>\n\n<p><a href=\"https://github.com/CocoaPods/CocoaPods/issues/5742\" rel=\"nofollow noreferrer\">https://github.com/CocoaPods/CocoaPods/issues/5742</a></p>\n\n<p><a href=\"https://github.com/bitstadium/HockeySDK-iOS/issues/363\" rel=\"nofollow noreferrer\">https://github.com/bitstadium/HockeySDK-iOS/issues/363</a></p>\n\n<p>/Users/nintyswinty/Library/Developer/Xcode/DerivedData/SFML-gsdieoedqhlmxqahfxqzujzewoid/Build/Products/Debug/SFML.app/Contents/Frameworks/sfml-window.framework/Versions/A: bundle format unrecognized, invalid, or unsuitable\nCommand CodeSign failed with a nonzero exit code</p>\n"}, {"tags": ["c++", "csv", "segmentation-fault", "coredump"], "comments": [{"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 1, "creation_date": 1573075805, "post_id": 58738711, "comment_id": 103767466, "body": "At ` if(CRN == record[0] &amp;&amp; Password == record[10])` How can you be sure that record has 10 entries?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1573075842, "post_id": 58738711, "comment_id": 103767478, "body": "<code>if(CRN == record[0] &amp;&amp; Password == record[10]){</code> -- Change that to <code>record.at(0)</code> and <code>record.at(10)</code>.  If there are no such records, you will get an <code>out_of_range</code> exception thrown."}, {"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "edited": false, "score": 0, "creation_date": 1573075957, "post_id": 58738711, "comment_id": 103767504, "body": "Just added a sreenshot. The record has 11 entries"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1573076013, "post_id": 58738711, "comment_id": 103767528, "body": "<i>The record has 11 entries</i> -- No, please verify that the vector has those entries.  Never write code that assumes these things.  Also, please, no images.  Put the data in the question, preferably in the code."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1573076296, "post_id": 58738711, "comment_id": 103767620, "body": "In addition, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  You posted a member function of a class, and if that member function is non-static, we need to know if that <code>person</code> object is valid."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573076713, "post_id": 58738711, "comment_id": 103767757, "body": "If the line marked in the picture is the full content of <code>acc_info.csv</code> then your <code>record</code> will contain <code>0</code> entries. Edit: Hmm, it will <i>always</i> contain <code>0</code> entries."}, {"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573076945, "post_id": 58738711, "comment_id": 103767835, "body": "@TedLyngmo how is that?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573077065, "post_id": 58738711, "comment_id": 103767887, "body": "You mix formatted input and unformatted input. Can you please include an example of the <code>csv</code> file as text in the question?"}, {"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "edited": false, "score": 0, "creation_date": 1573077193, "post_id": 58738711, "comment_id": 103767942, "body": "okay sure: 9138119,913811921297,Shivam,J,Jha,3811921297,sj@g.c,DEL,sji2&zwnj;&#8203;ns,100,sj@bank"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1573077294, "post_id": 58738711, "comment_id": 103767985, "body": "All that goes into <code>temp</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1573077354, "post_id": 58738711, "comment_id": 103768011, "body": "@ShivamJha still not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The true beauty of the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is it&#39;s a very useful debugging technique. It&#39;s hard to make one without discovering and fixing the bug along the way. While constantly asking for one might make us seem pedantic, if you created the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> before asking the question odds are very good you wouldn&#39;t have to ask the question."}, {"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573077424, "post_id": 58738711, "comment_id": 103768039, "body": "okay @TedLyngmo what should I do now? so that the core is not dumped?"}], "answers": [{"comments": [{"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "edited": false, "score": 0, "creation_date": 1573078455, "post_id": 58739124, "comment_id": 103768380, "body": "thank you so much Ted Lyngmo. I&#39;ve been trying to find this issue for couple of hours , you saved me!"}, {"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "edited": false, "score": 0, "creation_date": 1573078619, "post_id": 58739124, "comment_id": 103768453, "body": "yes sure man, it did help me alot.. in fact you saved my project! good to find you man! :)"}, {"owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "edited": false, "score": 0, "creation_date": 1573078896, "post_id": 58739124, "comment_id": 103768540, "body": "lol ma! now i know how to accept an answer!! thank you once again again!!!"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "edited": false, "score": 1, "creation_date": 1573081049, "post_id": 58739124, "comment_id": 103769178, "body": "@ShivamJha debugging tip: throw in some extra print statements to make sure you&#39;re reading what you think you are reading. <code>while(getline(s, word, &#39;,&#39;)){ record.push_back(word); cout &lt;&lt; word &lt;&lt; endl; }</code> would have quickly shown you weren&#39;t reading anything.  The next logical thing to look at after that would have been <code>cout &lt;&lt; temp &lt;&lt; endl;</code> and that would have solved the mystery."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 1, "last_activity_date": 1573078384, "last_edit_date": 1573078384, "creation_date": 1573077561, "answer_id": 58739124, "question_id": 58738711, "link": "https://stackoverflow.com/questions/58738711/segmentation-fault-core-dumped-while-accesing-csv-records-from-a-file/58739124#58739124", "title": "segmentation fault: core dumped while accesing csv records from a file", "body": "<p>Your <code>while(fin &gt;&gt; temp)</code> reads the line and puts it in <code>temp</code> but you don't use it, so <code>line</code> will be empty, even if followed by another valid line in the file.\n<code>&gt;&gt;</code> leaves the newline character in the stream which is the only thing the following <code>std::getline</code> will read. It'll always read empty lines as long as the lines in the file don't contain characters that would make <code>&gt;&gt;</code> split it, like whitespace characters.</p>\n\n<p>Consider just using <code>std::getline</code> to skip formatted input and actually check that you got a valid record before indexing:</p>\n\n<pre><code>    if(fin) {\n        while(std::getline(fin, line)) {\n            record.clear();\n            stringstream s(line);\n\n            while(std::getline(s, word, ',')) {\n                record.push_back(word);\n            }\n\n            // check that you've got a valid record\n            if(record.size() != 11)\n                throw std::runtime_error(\"invalid record size (\" +\n                                         std::to_string(record.size()) + \")\");\n\n            if(CRN == record[0] &amp;&amp; Password == record[10]) {\n                found = true;\n                cout &lt;&lt; \"\\nLogin successful!\\n\\n\";\n                break;\n            }\n        }\n        if(!found) {\n            cout &lt;&lt; \"\\nWrong CRN and password entered\\n\\n\";\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 914, "user_id": 11667949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lzevvCMuhBw/AAAAAAAAAAI/AAAAAAAAn54/_v-bTRtqDOA/photo.jpg?sz=128", "display_name": "Shivam Jha", "link": "https://stackoverflow.com/users/11667949/shivam-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 58739124, "answer_count": 1, "score": -2, "last_activity_date": 1573078384, "creation_date": 1573075517, "last_edit_date": 1573078135, "question_id": 58738711, "link": "https://stackoverflow.com/questions/58738711/segmentation-fault-core-dumped-while-accesing-csv-records-from-a-file", "title": "segmentation fault: core dumped while accesing csv records from a file", "body": "<p>I am working on a college c++ project and creating a function that parses a csv file and reads records stored in it. But it gives me an error everytime I use that function</p>\n\n<p>csv file example:</p>\n\n<pre><code>9138119,913811921297,Shivam,J,Jha,3811921297,sj@g.c,DEL,sji2ns,100,sj@bank\n</code></pre>\n\n<p>I tried using reserve() function of vector</p>\n\n<pre><code>void person::login(){\n   bool found = false;\n\n   fstream fin;\n   fin.open(\"acc_info.csv\", ios:: in);\n\n   string CRN, Password;\n   cout &lt;&lt; \"\\nEnter CRN: \";\n   getline(cin, CRN);\n\n   cout &lt;&lt; \"\\nEnter password :\";\n   getline(cin, Password);\n\n   vector&lt;string&gt; record;\n   string line, word, temp;\n\n   if(fin){\n      while(fin &gt;&gt; temp){\n         record.clear();\n         getline(fin, line);\n         stringstream s(line);\n\n         while(getline(s, word, ',')){\n            record.push_back(word);\n         }\n\n         if(CRN == record[0] &amp;&amp; Password == record[10]){\n            found = true;\n            cout &lt;&lt; \"\\nLogin successfull!\\n\\n\";\n            break;\n         }\n      }\n      if(!found){\n         cout &lt;&lt; \"\\nWrong CRN and password entered\\n\\n\";\n      }\n   }\n   else{\n      cout &lt;&lt; \"\\nTechnical fault occured.. try again after some time!!\\n\\n\";\n   }\n}\n</code></pre>\n\n<p>It should match the CRN and password as entered by user and provide whether successful login or not</p>\n\n<blockquote>\n  <p>Here is the person class:</p>\n</blockquote>\n\n<pre><code>class person {\n\n    public:\n        void welcome();\n        void show_account();\n        void after_user_choice(int);\n        void create_acc();\n        void login();\n        void accounts();\n        void deposit();\n        void cards();\n        void loans();\n        void insurance();\n        void investments();\n        int check(int, int, int);\n        bool d;\n        string retacno() const{\n            return acc_no;\n        }\n\n        ~person();\n\n\n        int x=5;\n\n    protected:\n        void show_acc_info(const unsigned long int);\n\n\n        string firstname , middlename , lastname , address  , pan_no , fname ;\n        string password, mobile_no ;\n        string acc_no, crn, balance= \"100\";\n        string email_id;\n        string line, word, temp;\n\n    private:\n        string usr ; \n        string pswd;\n\n\n};\n</code></pre>\n\n<blockquote>\n  <p>Here's how I took input from user to write to CSV file:</p>\n</blockquote>\n\n<pre><code>void person::create_acc(){\n\n     ofstream xl(\"acc_info.csv\" , ios::app );\n         cout&lt;&lt;\"ENTER FIRST NAME\\n\";\n     getline(cin,firstname);\n\n     cout&lt;&lt;\"ENTER MIDDLE NAME \\n\";\n     getline(cin,middlename);\n\n     cout&lt;&lt;\"ENTER LAST NAME: \"&lt;&lt;endl;\n     getline(cin,lastname);  \n\n     cout&lt;&lt;\"ENTER FATHER'S NAME: \"&lt;&lt;endl;\n     getline(cin,fname);  \n\n     cout&lt;&lt;\"ENTER YOUR EMAIL_ID: \";\n     getline(cin,email_id);\n\n     cout&lt;&lt;\"ENTER PAN CARD NUMBER: \"&lt;&lt;endl;\n     getline(cin,pan_no);\n\n     cout&lt;&lt;\"ENTER YOUR RESIDENTIAL ADDRESS: \"&lt;&lt;endl;\n     getline(cin,address);  \n\n     cout&lt;&lt;\"ENTER YOUR MOBILE NUMBER: \"&lt;&lt;endl;\n     getline(cin, mobile_no);\n\n    acc_no = to_string(910000000000 + stol(mobile_no, nullptr, 10)); //generating acc no;\n\n    crn = to_string(int(stol(acc_no)/100000)); //generating crn;\n     string repswrd;\n     bool z;\n\n    do{\n\n     cout&lt;&lt;\"ENTER PASSWORD FOR YOUR CRN(USER_ACC): \";\n     getline(cin,password);    \n\n     cout&lt;&lt;\"RE-ENTER YOUR PASSWORD: \";\n     getline(cin,repswrd);\n\n     if(!(password.compare(repswrd))){\n\n           cout&lt;&lt;\"Passwords matched succesfully!\"&lt;&lt;endl&lt;&lt;endl;\n           z = true;\n           }\n     else{\n\n          cout&lt;&lt;\"Passwords didn't match!!! Try again\\n\"&lt;&lt;endl;\n          z = false;\n               }\n\n         }while(!z);\n\n      cout&lt;&lt;\"\\n\\nAccount created successfully\\n\\n\";\n\n      cout &lt;&lt; \"Customer Satisfaction is our main\"\n           &lt;&lt; \"priority, so we have deposited a \"\n           &lt;&lt; \"sum of Rs. 100 into your bank a/c\"\n           &lt;&lt; endl &lt;&lt; endl;\n\n     xl&lt;&lt;crn&lt;&lt;\",\"\n      &lt;&lt; acc_no&lt;&lt; \",\"\n     &lt;&lt; firstname &lt;&lt; \",\" \n     &lt;&lt; middlename &lt;&lt; \",\" \n     &lt;&lt; lastname&lt;&lt; \",\"\n     &lt;&lt; mobile_no&lt;&lt; \",\"\n     &lt;&lt;email_id&lt;&lt;\",\"\n     &lt;&lt; address&lt;&lt; \",\"\n     &lt;&lt;pan_no&lt;&lt;\",\"\n     &lt;&lt;balance &lt;&lt; \",\"\n     &lt;&lt; password&lt;&lt; \"\\n\";\n\n     xl.close();\n\n     cout&lt;&lt;endl;  \n\n     }\n</code></pre>\n"}, {"tags": ["c++", "mysql"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11895912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ff9d39f1d45f31b7d74ef05601dc4e0?s=128&d=identicon&r=PG&f=1", "display_name": "kawapa", "link": "https://stackoverflow.com/users/11895912/kawapa"}, "is_accepted": false, "score": 0, "last_activity_date": 1603828132, "creation_date": 1603828132, "answer_id": 64561880, "question_id": 58738663, "link": "https://stackoverflow.com/questions/58738663/c-failed-to-connect-to-mysql/64561880#64561880", "title": "c++ failed to connect to mysql", "body": "<p>Today I had the same problem. Solution:</p>\n<ol>\n<li>Using command line, log in to your mysql server using the following command:</li>\n</ol>\n<pre><code>mysql -u user -p -e &quot;SHOW plugins&quot;\n</code></pre>\n<ol start=\"2\">\n<li>Make sure the plugin <code>mysqlx</code> is actived.</li>\n</ol>\n<pre><code>+----------------------------+----------+--------------------+---------+---------+\n| Name                       | Status   | Type               | Library | License |\n+----------------------------+----------+--------------------+---------+---------+\n...\n| mysqlx                     | ACTIVE   | DAEMON             | NULL    | GPL     |\n</code></pre>\n<p>In my case it wasn't even on the list.</p>\n<p>More information: <a href=\"https://dev.mysql.com/doc/refman/8.0/en/x-plugin-checking-installation.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/8.0/en/x-plugin-checking-installation.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12334220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b7230069e36178e7e5ae08b9d89263?s=128&d=identicon&r=PG&f=1", "display_name": "madcat", "link": "https://stackoverflow.com/users/12334220/madcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1603828132, "creation_date": 1573075262, "question_id": 58738663, "link": "https://stackoverflow.com/questions/58738663/c-failed-to-connect-to-mysql", "title": "c++ failed to connect to mysql", "body": "<p>I get the following error message when I connect to mysql:</p>\n\n<pre><code>CDK Error: unexpected message\n</code></pre>\n\n<p>client is Ubuntu 19.04\nserver is Ubuntu 18.04.1 LTS</p>\n\n<p>The client library is: libmysqlcppconn-dev/bionic,now 1.1.9-1 amd64 [installed]</p>\n\n<p>mysql server is version: 5.7.27-0</p>\n\n<p>I can connect via the mysql command line client using the same credentials.</p>\n\n<pre><code>\nusing namespace mysqlx;\n\nint main(int argc, char **argv)\n{\n    Session s\n    (\n        SessionOption::HOST, \"11.11.11.11\"\n        ,SessionOption::PORT, 3306\n        ,SessionOption::USER, \"xxx\"\n        ,SessionOption::PWD, \"xxx\"\n        ,SessionOption::DB, \"xxx\"\n    );\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>mysqltest \nterminate called after throwing an instance of 'mysqlx::abi2::r0::Error'\n  what():  CDK Error: Broken pipe (generic:32)\nAborted (core dumped)\n</code></pre>\n"}, {"tags": ["c++", "allocator"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573075041, "post_id": 58738561, "comment_id": 103767191, "body": "TL;DR of the dupe:  <code>{ stuff }</code> has no type.  You cant pass something to a template that doesn&#39;t have a type."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1573075345, "post_id": 58738561, "comment_id": 103767311, "body": "You can pass an <code>initializer_list</code> to <code>construct</code>. <code>{...}</code> isn&#39;t an <code>initializer_list</code>."}, {"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573077566, "post_id": 58738561, "comment_id": 103768078, "body": "@NathanOliver-ReinstateMonica But why <code>a.construct(p, 5);</code> works?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573077622, "post_id": 58738561, "comment_id": 103768099, "body": "Because <code>5</code> has a type.  It is <code>int</code>.  If you tried <code>a.construct(p, {5});</code> it would also fail"}, {"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573078018, "post_id": 58738561, "comment_id": 103768232, "body": "@NathanOliver-ReinstateMonica: I&#39;ve visited the link you marked and saw that I can specify explicitly the element type: <code>a.construct&lt;vector&lt;int&gt;&gt;(p + 1, { 7, 16, 23, 81, 77, 24, 10 });</code> but again this doesn&#39;t work`"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573078363, "post_id": 58738561, "comment_id": 103768356, "body": "@ItachiUchiwa That work around wont work because <code>construct</code> is a variadic template."}, {"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573078408, "post_id": 58738561, "comment_id": 103768364, "body": "@NathanOliver-ReinstateMonica: Ok thank you. So I have to explicitly pass an initializer list: <code>a.constrcut(p + 1, std::initializer_list&lt;int&gt;{1,2,3,4});</code> This works."}, {"owner": {"reputation": 3797, "user_id": 2874856, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kWxOm.jpg?s=128&g=1", "display_name": "Raindrop7", "link": "https://stackoverflow.com/users/2874856/raindrop7"}, "edited": false, "score": 1, "creation_date": 1573080028, "post_id": 58738561, "comment_id": 103768905, "body": "Simply you have to specify the element type for both <code>vector&lt;int&gt;</code> followed by <code>initializer_list</code>: <code>a.construct&lt;vector&lt;int&gt;, initializer_list&lt;int&gt;&gt;(p + 1, {7, 16, 23, 81, 77, 24, 10});</code> This should work because you told to the compiler that the second argument to <code>construct</code> is an <code>initializer_list</code>."}], "owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1573075013, "answer_count": 0, "score": 0, "last_activity_date": 1573074742, "creation_date": 1573074742, "question_id": 58738561, "link": "https://stackoverflow.com/questions/58738561/why-passing-an-initializer-list-to-allocotrconstruct-to-construct-a-vector-doe", "closed_reason": "Duplicate", "title": "Why passing an initializer_list to allocotr::construct to construct a vector doesn&#39;t work?", "body": "<p>I have a problem here: I am again reading C++ primer 5 edition. Now I am at <code>std::allocator</code> everything is Ok but I don't know why my code here doesn't copmile:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;initializer_list&gt;\n#include &lt;memory&gt;\n#include &lt;vector&gt;\n\n\nvoid print_vec(vector&lt;int&gt; v) {\n    for (const auto i : v)\n        std::cout &lt;&lt; i &lt;&lt; \", \";\n    std::cout &lt;&lt; std::endl;\n}\n\n\nint main(int argc, char* argv[]) {\n\n\n    //print_vec(5); // fails. vector(size_t) is explicit\n\n    std::allocator&lt;vector&lt;int&gt;&gt; a;\n    auto p = a.allocate(10);\n    a.construct(p, 5);// works?!\n\n    //a.construct(p + 1, {7, 16, 23, 81, 77, 24, 10}); // doesn't work even vector(initilizer_list) is not explicit\n    a.construct(p + 1, vector&lt;int&gt;({7, 16, 23, 81, 77, 24, 10 })); // works\n\n    for (int i = 0; i != 2; ++i) {\n        for (const auto&amp; e : *(p + i))\n            std::cout &lt;&lt; e &lt;&lt; \", \";\n        std::cout &lt;&lt; std::endl;\n    }\n\n\n    a.destroy(p);\n    a.destroy(p + 1);\n    a.deallocate(p, 10);\n\n\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<ul>\n<li><p>Why calling <code>print_vec</code> passing an integer doesn't compile -because I guess that the constructor of <code>vector(size_type)</code> is <code>explicit</code> then why calling <code>a.construct(p, 5);</code> works? as long as this value <code>5</code> is passed in to the constructor of vector to create 5 value-initialized integer elements. </p></li>\n<li><p>Second I can call <code>print_vec</code> passing in an <code>initializer_list&lt;int&gt;</code> (vector(initializer_list) is not explicit ctor) but why this statement doesn't compile: <code>a.construct(p + 1, {7, 16, 23, 81, 77, 24, 10});</code>?</p></li>\n</ul>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 0, "creation_date": 1573074600, "post_id": 58738517, "comment_id": 103767030, "body": "delete the void keywords, and assuming the functions exist it should work"}], "answers": [{"tags": [], "owner": {"reputation": 9631, "user_id": 258009, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1ccdf76b2fb6a2c5e3c64e686b092ff0?s=128&d=identicon&r=PG", "display_name": "Component 10", "link": "https://stackoverflow.com/users/258009/component-10"}, "is_accepted": false, "score": 3, "last_activity_date": 1573074715, "creation_date": 1573074715, "answer_id": 58738553, "question_id": 58738517, "link": "https://stackoverflow.com/questions/58738517/functions-inside-of-cases/58738553#58738553", "title": "Functions inside of cases", "body": "<p>That's because it looks like you're trying to <em>declare</em> the functions there rather than <em>call</em> them. Give this a try:</p>\n\n<pre><code>{\n   case 1:\n      getnames();\n      break;\n   case 2:\n      getNumber();\n      break;\n ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 12334252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8852c0ffd9a7f1baaefb829f6f3f13e2?s=128&d=identicon&r=PG&f=1", "display_name": "user12334252", "link": "https://stackoverflow.com/users/12334252/user12334252"}, "edited": false, "score": 0, "creation_date": 1573075007, "post_id": 58738559, "comment_id": 103767177, "body": "Yes Thanks i have changed my code to that thanks now i have a validation issue that means that it continusly loops the menu and displays invalid input whatever is inputed"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 1, "creation_date": 1573077128, "post_id": 58738559, "comment_id": 103767915, "body": "Take a debugger to it.  Put a breakpoint on the <code>switch (choice)</code> line and inspect the <code>choice</code> variable to see what it contains."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1573074734, "creation_date": 1573074734, "answer_id": 58738559, "question_id": 58738517, "link": "https://stackoverflow.com/questions/58738517/functions-inside-of-cases/58738559#58738559", "title": "Functions inside of cases", "body": "<p>Remove the <code>void</code> keywords, and assuming the functions exist, this will work, as @Tyler commented.</p>\n\n<p>So now, your code should look like this:</p>\n\n<pre><code>  {\n     case 1:\n        getnames();\n        break;\n     case 2:\n        getNumber();\n        break;\n     case 3:\n        cout &lt;&lt; \"End of Program.\\n\";\n        break;\n     default:\n        cout &lt;&lt; \"Not a Valid Choice. \\n\";\n        cout &lt;&lt; \"Choose again.\\n\";\n        break;\n\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 11981587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBAdOdhIWvWZUvUACxroYq1DymWMA_dXDGvQEFEvw=k-s128", "display_name": "Ahmed Anter", "link": "https://stackoverflow.com/users/11981587/ahmed-anter"}, "is_accepted": false, "score": 0, "last_activity_date": 1573075038, "creation_date": 1573075038, "answer_id": 58738630, "question_id": 58738517, "link": "https://stackoverflow.com/questions/58738517/functions-inside-of-cases/58738630#58738630", "title": "Functions inside of cases", "body": "<p>change </p>\n\n<pre><code>void getnames();\n</code></pre>\n\n<p>to </p>\n\n<pre><code>getnames();\n</code></pre>\n\n<p>the first from declare a function not invoking it. so nothing will happen.</p>\n"}], "owner": {"reputation": 11, "user_id": 12334252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8852c0ffd9a7f1baaefb829f6f3f13e2?s=128&d=identicon&r=PG&f=1", "display_name": "user12334252", "link": "https://stackoverflow.com/users/12334252/user12334252"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1573075452, "answer_count": 3, "score": 1, "last_activity_date": 1573075387, "creation_date": 1573074550, "last_edit_date": 1573075387, "question_id": 58738517, "link": "https://stackoverflow.com/questions/58738517/functions-inside-of-cases", "closed_reason": "Duplicate", "title": "Functions inside of cases", "body": "<p>Im trying to run fuctions inside of 3 cases (case1,case2,case3) but when i run the code nothing happens so ive been trying to reseach how you put a function inside of a case correctly in c++ but iv ehad no luck.</p>\n\n<p>Ive tried to run the code inside of the cases without linking to the functions and it works but for the outcomes i need to link a caseto a function.</p>\n\n<pre><code>switch (choice)\n//wont run case functions   \n{\n    case 1:\n        void getnames();\n        break;\n    case 2:\n        void getNumber();\n        break;\n    case 3:\n        cout &lt;&lt; \"End of Program.\\n\";\n        break;\n    default:\n        cout &lt;&lt; \"Not a Valid Choice. \\n\";\n        cout &lt;&lt; \"Choose again.\\n\";\n        break;\n}\n</code></pre>\n\n<p>The result i need is that the program will run the fuctions when the right number is inputed the program runs fine but it just keeps looping the menus and does not run the functions</p>\n"}, {"tags": ["c++", "types", "language-lawyer", "std"], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 3, "last_activity_date": 1573074826, "creation_date": 1573074826, "answer_id": 58738584, "question_id": 58738474, "link": "https://stackoverflow.com/questions/58738474/does-an-aggregate-type-imply-that-it-is-also-standard-layout/58738584#58738584", "title": "Does an aggregate type imply that it is also standard layout?", "body": "<p>No.  Imagine you have a setup like</p>\n\n<pre><code>struct A\n{\n    int a;\n};\n\nstruct B : A\n{\n\n};\n\nstruct C : B\n{\n    int c;\n};\n</code></pre>\n\n<p>Here <code>A</code>, <code>B</code> and <code>C</code> are all aggregates, but only <code>A</code> and <code>B</code> are standard layout.</p>\n"}, {"comments": [{"owner": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573074966, "post_id": 58738587, "comment_id": 103767159, "body": "Then the two things has nothing related. You can be standard layout, or aggregate, none, or both."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573075023, "post_id": 58738587, "comment_id": 103767182, "body": "@plasmacel - Yes, they are orthogonal. Aggregates are just clumps of data, and they may or may not have standard layout."}, {"owner": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573075137, "post_id": 58738587, "comment_id": 103767236, "body": "I think I confused aggregates with trivial types. Do you know a counter example where a trivial type is not standard layout?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573075263, "post_id": 58738587, "comment_id": 103767289, "body": "@plasmacel - In the previous example <code>bar</code>. If I was to add another virtual member function, and removed the d&#39;tor then it would become a trivial type, but still not standard layout."}, {"owner": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573075557, "post_id": 58738587, "comment_id": 103767382, "body": "What about aggregate and trivial? Sounds like trivial implies aggregate."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573075648, "post_id": 58738587, "comment_id": 103767409, "body": "@plasmacel - A trivial type is allowed to have a deleted default constructor, thus making it a non-aggregate."}, {"owner": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "edited": false, "score": 0, "creation_date": 1573075977, "post_id": 58738587, "comment_id": 103767514, "body": "Seems like gcc with <code>-std=c++17</code> allows deleted default constructor on aggregates: <a href=\"http://coliru.stacked-crooked.com/a/efba6e6c7cbf6632\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/efba6e6c7cbf6632</a>"}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1573074841, "creation_date": 1573074841, "answer_id": 58738587, "question_id": 58738474, "link": "https://stackoverflow.com/questions/58738474/does-an-aggregate-type-imply-that-it-is-also-standard-layout/58738587#58738587", "title": "Does an aggregate type imply that it is also standard layout?", "body": "<p>No, it does not. For a class type to be standard layout, all of its non-static members must themselves be standard layout. But the same recursive requirement is not imposed on aggregates. So a simple counter example</p>\n\n<pre><code>struct bar {\n  virtual ~bar() {}\n};\n\nstruct foo {\n    bar b;\n};\n</code></pre>\n\n<p><code>foo</code> is an aggregate, but it is not standard layout.</p>\n"}], "owner": {"reputation": 7335, "user_id": 2430597, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f0kyJ.jpg?s=128&g=1", "display_name": "plasmacel", "link": "https://stackoverflow.com/users/2430597/plasmacel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58738587, "answer_count": 2, "score": 3, "last_activity_date": 1573074841, "creation_date": 1573074355, "question_id": 58738474, "link": "https://stackoverflow.com/questions/58738474/does-an-aggregate-type-imply-that-it-is-also-standard-layout", "title": "Does an aggregate type imply that it is also standard layout?", "body": "<p>Does an aggregate type (<code>std::is_aggregate_v&lt;T&gt; == true</code>) imply that the type is also standard layout (<code>std::is_standard_layout_v&lt;T&gt; == true</code>) or not? My intuition is that the answer is yes, but I'm not entirely convinced about it.</p>\n"}, {"tags": ["c++", "printf", "iostream"], "comments": [{"owner": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 4, "creation_date": 1573074449, "post_id": 58738467, "comment_id": 103766975, "body": "What did you try and what errors?"}, {"owner": {"reputation": 1, "user_id": 9069406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45730903b6134a0f3a9a6f78394ec338?s=128&d=identicon&r=PG&f=1", "display_name": "snoh8r", "link": "https://stackoverflow.com/users/9069406/snoh8r"}, "reply_to_user": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 0, "creation_date": 1573074628, "post_id": 58738467, "comment_id": 103767041, "body": "I tried removing the % signs for one and adding mat[] (found that somewhere), but it failed and I&#39;m getting something about unnecessary commas. I also get no such file or directory."}, {"owner": {"reputation": 1, "user_id": 9069406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45730903b6134a0f3a9a6f78394ec338?s=128&d=identicon&r=PG&f=1", "display_name": "snoh8r", "link": "https://stackoverflow.com/users/9069406/snoh8r"}, "reply_to_user": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 0, "creation_date": 1573074917, "post_id": 58738467, "comment_id": 103767146, "body": "std::cout&lt;&lt;&quot;s\\t&quot; &quot;s\\t&quot; &quot;s\\t&quot; &quot;s\\n&quot;, &quot;ID&quot;, &quot;math&quot;, &quot;chem&quot;, &quot;ave&quot;; is working, kind of. I&#39;m just getting S as the headers now."}, {"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 1, "creation_date": 1573074974, "post_id": 58738467, "comment_id": 103767162, "body": "Did you take look at the documentation or a simple tutorial? <code>std::cout</code> works different then <code>printf</code>, you don&#39;t pass a format string and a argument list but just <code>std::cout &lt;&lt; &quot;ID&quot; &lt;&lt; &quot;math&quot; &lt;&lt; ...</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1573075670, "post_id": 58738467, "comment_id": 103767418, "body": "Prefer the documentation over a tutorial. Crom only know what lack-witted fool wrote the tutorial if you just go a-Googling. If you need to use a tutorial, do some research to find out who the domain experts are and use their tutorials or the ones they recommend."}], "answers": [{"tags": [], "owner": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "is_accepted": true, "score": 1, "last_activity_date": 1573075020, "creation_date": 1573075020, "answer_id": 58738625, "question_id": 58738467, "link": "https://stackoverflow.com/questions/58738467/c-change-printf-to-cout/58738625#58738625", "title": "C++ Change printf to cout", "body": "<p>The <code>iomanip</code> library includes methods for setting decimal precision, namely <code>setprecision</code> and <code>fixed</code>. You can specify <code>setprecision(2)</code> and <code>fixed</code> to print two decimal places as part of each score. The following produces the same output as the original code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\nusing namespace std;\n\nint main() {\n    double mathScores[] = { 95, 87, 73, 82, 92, 84, 81, 76 };\n    double chemScores[] = { 91, 85, 81, 90, 96, 89, 77, 79 };\n    double aveScores[] = { 0, 0, 0, 0, 0, 0, 0, 0 };\n    //calculate size of array\n    int len = sizeof(mathScores) / sizeof(double);\n    //use array\n    for (int i = 0; i &lt; len; ++i) {\n        aveScores[i] = (mathScores[i] + chemScores[i]) / 2;\n    }\n    // Set decimal precision\n    std::cout &lt;&lt; std::setprecision(2);\n    std::cout &lt;&lt; std::fixed;\n    std::cout &lt;&lt; \"ID\\tmath\\tchem\\tave\" &lt;&lt; endl;\n    for (int i = 0; i &lt; len; ++i) {\n        std::cout &lt;&lt; i &lt;&lt; \"\\t\" &lt;&lt; mathScores[i] &lt;&lt; \"\\t\" &lt;&lt; chemScores[i] &lt;&lt; \"\\t\" &lt;&lt; aveScores[i] &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9069406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45730903b6134a0f3a9a6f78394ec338?s=128&d=identicon&r=PG&f=1", "display_name": "snoh8r", "link": "https://stackoverflow.com/users/9069406/snoh8r"}, "edited": false, "score": 0, "creation_date": 1573076352, "post_id": 58738681, "comment_id": 103767635, "body": "&#39;setprecision&#39; is not a member of &#39;std&#39;|      &#39;TAB&#39; was not declared in this scope|"}], "tags": [], "owner": {"reputation": 9631, "user_id": 258009, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1ccdf76b2fb6a2c5e3c64e686b092ff0?s=128&d=identicon&r=PG", "display_name": "Component 10", "link": "https://stackoverflow.com/users/258009/component-10"}, "is_accepted": false, "score": 0, "last_activity_date": 1573075362, "creation_date": 1573075362, "answer_id": 58738681, "question_id": 58738467, "link": "https://stackoverflow.com/questions/58738467/c-change-printf-to-cout/58738681#58738681", "title": "C++ Change printf to cout", "body": "<p>The first line is pretty easy as it can all be done as one string:</p>\n\n<pre><code>std::cout &lt;&lt; \"ID\\tmath\\tchem\\tave\" &lt;&lt; std::endl;\n</code></pre>\n\n<p>however, you might want to to treat the seperator a bit more obviously:</p>\n\n<pre><code>const char TAB('\\t');\nstd::cout &lt;&lt; \"ID\" &lt;&lt; TAB &lt;&lt; \"math\" &lt;&lt; TAB &lt;&lt; \"chem\" &lt;&lt; TAB \"ave\" &lt;&lt; std::endl;\n</code></pre>\n\n<p>The loop just needs to use the <code>std::setprecision()</code> modifier to set the precision to two places:</p>\n\n<pre><code>for (int i = 0; i &lt; len; ++i) {\n    std::cout &lt;&lt; std::setprecision(2)\n              &lt;&lt; i &lt;&lt; TAB\n              &lt;&lt; mathScores[i] &lt;&lt; TAB\n              &lt;&lt; chemScores[i] &lt;&lt; TAB\n              &lt;&lt; aveScores[i] &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 3685401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E317n.jpg?s=128&g=1", "display_name": "jokogarcia", "link": "https://stackoverflow.com/users/3685401/jokogarcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1573082116, "last_edit_date": 1573082116, "creation_date": 1573075999, "answer_id": 58738815, "question_id": 58738467, "link": "https://stackoverflow.com/questions/58738467/c-change-printf-to-cout/58738815#58738815", "title": "C++ Change printf to cout", "body": "<p>A more familiar syntax can be achieved with the <a href=\"https://www.boost.org/\" rel=\"nofollow noreferrer\">Boost Library</a>. It would look something like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\nusing boost::format\nusing namespace std;\n\nint main() {\n    double mathScores[] = { 95, 87, 73, 82, 92, 84, 81, 76 };\n    double chemScores[] = { 91, 85, 81, 90, 96, 89, 77, 79 };\n    double aveScores[] = { 0, 0, 0, 0, 0, 0, 0, 0 };\n    string s;\n    char ss[30];\n    //calculate size of array\n    int len = sizeof(mathScores) / sizeof(double);\n    //use array\n    for (int i = 0; i &lt; len; ++i) {\n        aveScores[i] = (mathScores[i] + chemScores[i]) / 2;\n    }\n\n    cout&lt;&lt;format(\"%s\\t%s\\t%s\\t%s\\n\") % \"ID\" % \"math\" % \"chem\" % \"ave\";\n    //printf(\"%s\\t%s\\t%s\\t%s\\n\", \"ID\", \"math\", \"chem\", \"ave\");\n    for (int i = 0; i &lt; len; ++i) {\n        //printf(\"%d\\t%.2f\\t%.2f\\t%.2f\\n\", i, mathScores[i], chemScores[i],\n                aveScores[i]);\n        cout&lt;&lt;format(\"%d\\t%.2f\\t%.2f\\t%.2f\\n\") %i  % mathScores[i] % chemScores[i] % aveScores[i];\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9069406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45730903b6134a0f3a9a6f78394ec338?s=128&d=identicon&r=PG&f=1", "display_name": "snoh8r", "link": "https://stackoverflow.com/users/9069406/snoh8r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58738625, "answer_count": 3, "score": -2, "last_activity_date": 1573082116, "creation_date": 1573074341, "last_edit_date": 1573074520, "question_id": 58738467, "link": "https://stackoverflow.com/questions/58738467/c-change-printf-to-cout", "title": "C++ Change printf to cout", "body": "<p>I have this code below that works great. I just need to write the printf as cout. I've tried a few times but it errors on me. Any help would be appreciated. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\nusing namespace std;\n\nint main() {\n    double mathScores[] = { 95, 87, 73, 82, 92, 84, 81, 76 };\n    double chemScores[] = { 91, 85, 81, 90, 96, 89, 77, 79 };\n    double aveScores[] = { 0, 0, 0, 0, 0, 0, 0, 0 };\n    //calculate size of array\n    int len = sizeof(mathScores) / sizeof(double);\n    //use array\n    for (int i = 0; i &lt; len; ++i) {\n        aveScores[i] = (mathScores[i] + chemScores[i]) / 2;\n    }\n    printf(\"%s\\t%s\\t%s\\t%s\\n\", \"ID\", \"math\", \"chem\", \"ave\");\n    for (int i = 0; i &lt; len; ++i) {\n        printf(\"%d\\t%.2f\\t%.2f\\t%.2f\\n\", i, mathScores[i], chemScores[i],\n                aveScores[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c#", "c++", "audio", "real-time", "midi"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 9257081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbdc70ad51e0fe2507448e9c3cf25ee?s=128&d=identicon&r=PG&f=1", "display_name": "Narek Aydinyan", "link": "https://stackoverflow.com/users/9257081/narek-aydinyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1573074612, "creation_date": 1573074612, "answer_id": 58738534, "question_id": 58738428, "link": "https://stackoverflow.com/questions/58738428/would-cs-garbage-collection-cause-problems-for-a-real-time-audio-application/58738534#58738534", "title": "Would C#&#39;s garbage collection cause problems for a real time audio application?", "body": "<p>It is easy to write the code which will be very slow also in assembler \nPlease demonstrate some peace of code where you think it is slow down otherwise I don't know what to answer to this question.\nSome answer. Yes garbig collection can slow down your program, but you can control that. </p>\n"}], "owner": {"reputation": 611, "user_id": 5090751, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/16f3e2287c2986dfc5851c9d60b4388f?s=128&d=identicon&r=PG&f=1", "display_name": "koreus737", "link": "https://stackoverflow.com/users/5090751/koreus737"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "closed_date": 1573074555, "answer_count": 1, "score": 0, "last_activity_date": 1573074612, "creation_date": 1573074169, "question_id": 58738428, "link": "https://stackoverflow.com/questions/58738428/would-cs-garbage-collection-cause-problems-for-a-real-time-audio-application", "closed_reason": "Duplicate", "title": "Would C#&#39;s garbage collection cause problems for a real time audio application?", "body": "<p>I'm currently writing a real time audio application in C++ that takes in a depth sensor input and converts it to MIDI signals. It has to model 3D space and respond in real time to the movement of an object in 3D space monitored by the depth sensors.</p>\n\n<p>I want to re-write this application in C# because I find C++ clunky and slow to develop with while I find C# a pleasure to write. My concern is that the garbage collector will cause random slow downs that could result in unacceptable latency. The application could take a 20% performance hit overall but it needs to be consistent. It can't spike to 200% slowdown once then have 10% slowdown the rest of the time to average to 20% it would need to be steady.</p>\n\n<p>An added latency of say 50ms at any one time would be enough to make it sound off.</p>\n\n<p>Is it viable to do this in C#?</p>\n"}, {"tags": ["c++", "encryption", "aes", "intel", "aes-ni"], "answers": [{"comments": [{"owner": {"reputation": 763, "user_id": 3276539, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/6W2ss.png?s=128&g=1", "display_name": "tomsk", "link": "https://stackoverflow.com/users/3276539/tomsk"}, "edited": false, "score": 0, "creation_date": 1573390637, "post_id": 58738689, "comment_id": 103859664, "body": "I removed that <code>memcpy</code> compiled and I get <code>Illegal instruction (core dumped)</code>."}], "tags": [], "owner": {"reputation": 99, "user_id": 9257081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccbdc70ad51e0fe2507448e9c3cf25ee?s=128&d=identicon&r=PG&f=1", "display_name": "Narek Aydinyan", "link": "https://stackoverflow.com/users/9257081/narek-aydinyan"}, "is_accepted": false, "score": 1, "last_activity_date": 1573075399, "creation_date": 1573075399, "answer_id": 58738689, "question_id": 58738426, "link": "https://stackoverflow.com/questions/58738426/correct-way-of-aes-ni-encryption-in-c/58738689#58738689", "title": "Correct way of AES NI encryption in C++", "body": "<p>Please read documentation of memcpy.\nThe first argument must be destination buffer.  In your code you are copy data to block and then delete it.\nAlso the usage of memcpy in for loop is wrong. You should increment destination buffer pointer.</p>\n"}], "owner": {"reputation": 763, "user_id": 3276539, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/6W2ss.png?s=128&g=1", "display_name": "tomsk", "link": "https://stackoverflow.com/users/3276539/tomsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573075399, "creation_date": 1573074141, "question_id": 58738426, "link": "https://stackoverflow.com/questions/58738426/correct-way-of-aes-ni-encryption-in-c", "title": "Correct way of AES NI encryption in C++", "body": "<p>I am attempting to make AES 256 bit (CBC mode) encrypt function using special instruction set (AES-NI) from Intel.</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>int Nb = 4;\nint Nk = 8;\nint Nr = 14;\n\nunsigned int BLOCK_SIZE = 16;\n\nvoid block_encryption_special(unsigned char input[], unsigned char result[], __m256i *key)\n{\n\n    __m256i block = _mm256_loadu_si256((__m256i *) input);\n\n    block = _mm256_xor_si256(block, key[0]);\n\n    for (int i = 1; i &lt; Nr; i++)\n    {\n        block = _mm256_aesenc_epi128(block, key[i]);\n    }\n\n    block = _mm256_aesenclast_epi128(block, key[Nr]);\n\n    _mm256_storeu_si256((__m256i *) result, block);\n\n}\n\nunsigned char* encrypt(unsigned char input[], unsigned int input_length, unsigned  char key[], unsigned char *iv, bool special)\n{\n    unsigned int i = 0;\n    unsigned int total_lenght;\n    unsigned int length_padded = (input_length / BLOCK_SIZE);\n\n    if(input_length % BLOCK_SIZE)\n    {\n        length_padded++;\n    }\n\n    length_padded *=  BLOCK_SIZE;\n\n    total_lenght = length_padded;\n\n    unsigned char *align  = null_padding(input, input_length, total_lenght);\n    unsigned char *result = new unsigned char[total_lenght];\n    unsigned char *block = new unsigned char[BLOCK_SIZE];\n\n    memcpy(block, iv, BLOCK_SIZE);\n\n    for (i = 0; i &lt; total_lenght; i += BLOCK_SIZE)\n    {\n        block_encryption_special(block, result + i, (__m256i *)key);\n        memcpy(block, result + i, BLOCK_SIZE);\n    }\n\n    delete[] block;\n    delete[] align;\n\n    return result;\n}\n</code></pre>\n\n<p>I think, I am doing something wrong, because I get empty output from it. Do I miss something please?</p>\n"}, {"tags": ["c++", "pointers", "constants", "const-correctness"], "comments": [{"owner": {"reputation": 15189, "user_id": 477771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1e6012428cc236ed32cf9a13376f0f3?s=128&d=identicon&r=PG", "display_name": "Mark Storer", "link": "https://stackoverflow.com/users/477771/mark-storer"}, "edited": false, "score": 0, "creation_date": 1573074360, "post_id": 58738419, "comment_id": 103766941, "body": "I suggest typedefs.  Lots of typedefs.  Lots of typedefs that build on one another.  Enough typedefs that you hate life to such a degree that you avoid such foolishness in the future.  Yes, the distinction could be important.  No, I have never seen production code where it mattered."}, {"owner": {"reputation": 15189, "user_id": 477771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1e6012428cc236ed32cf9a13376f0f3?s=128&d=identicon&r=PG", "display_name": "Mark Storer", "link": "https://stackoverflow.com/users/477771/mark-storer"}, "edited": false, "score": 0, "creation_date": 1573074397, "post_id": 58738419, "comment_id": 103766954, "body": "To be fair:  &quot;I have never NOTICED code where it mattered&quot;, in my 20+ year career as a programmer, most of which has been spent in C++."}, {"owner": {"reputation": 3414, "user_id": 1282931, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/7TwwM.jpg?s=128&g=1", "display_name": "matthias_buehlmann", "link": "https://stackoverflow.com/users/1282931/matthias-buehlmann"}, "reply_to_user": {"reputation": 15189, "user_id": 477771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1e6012428cc236ed32cf9a13376f0f3?s=128&d=identicon&r=PG", "display_name": "Mark Storer", "link": "https://stackoverflow.com/users/477771/mark-storer"}, "edited": false, "score": 0, "creation_date": 1573074563, "post_id": 58738419, "comment_id": 103767016, "body": "this is more for my understanding of const-correctness than in order to write production code. I did stumble over it when I tried to replace a statically allocated <code>static const char* foo[1000]</code> with a dynamically allocated <code>static char** foo</code> and the compiler didn&#39;t allow me to assign string literals to the elements of foo"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1573078429, "post_id": 58738419, "comment_id": 103768370, "body": "The <code>const</code> keyword binds to the thing to its immediate left.  (Unless <code>const</code> appears very first, in which case it binds to the thing to its immediate right.)"}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 1, "last_activity_date": 1573075412, "last_edit_date": 1573075412, "creation_date": 1573074343, "answer_id": 58738469, "question_id": 58738419, "link": "https://stackoverflow.com/questions/58738419/c-const-for-pointer-to-pointer/58738469#58738469", "title": "c++ const for pointer to pointer", "body": "<blockquote>\n  <p>a) declare a <code>const</code> pointer to a non-<code>const</code> pointer to a non-<code>const</code> <code>int</code></p>\n</blockquote>\n\n<pre><code>int ** const a = nullptr;\n</code></pre>\n\n<p>Note that, since the pointer above is <code>const</code>-qualified it has to be initialized at the declaration. Otherwise, it won't compile.</p>\n\n<blockquote>\n  <p>b) declare a non-<code>const</code> pointer to a <code>const</code> pointer to a non-<code>const</code> <code>int</code></p>\n</blockquote>\n\n<pre><code>int * const *b;   \n</code></pre>\n\n<blockquote>\n  <p>c) declare a non-<code>const</code> pointer to a non-<code>const</code> pointer to a <code>const</code> <code>int</code></p>\n</blockquote>\n\n<pre><code>const int **c;\n</code></pre>\n\n<hr>\n\n<p>The pattern is, for a <code>const</code> pointer:</p>\n\n<pre><code>T * const ptr; // const pointer to T\n</code></pre>\n\n<p>and for a non-<code>const</code> pointer:</p>\n\n<pre><code>T * ptr; // non-const pointer to T\n</code></pre>\n\n<p>Then, select the proper pattern above for the outtermost pointer and replace <code>T</code> accordingly for the innermost pointer (i.e., the deepest one buried in the type):</p>\n\n<ul>\n<li>Non-<code>const</code> pointer to a non-<code>const</code> <code>int</code>: <code>T = int *</code>.</li>\n<li><code>const</code> pointer to a non-<code>const</code> <code>int</code>: <code>T = int * const</code>.</li>\n<li>Non-<code>const</code> pointer to a <code>const</code> <code>int</code>: <code>T = const int *</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1573074390, "creation_date": 1573074390, "answer_id": 58738477, "question_id": 58738419, "link": "https://stackoverflow.com/questions/58738419/c-const-for-pointer-to-pointer/58738477#58738477", "title": "c++ const for pointer to pointer", "body": "<p>It's all about where the<code>const</code> is placed relative to the <code>*</code>: if <code>const</code> is on the left then what's pointed to is <code>const</code>, if <code>const</code> is on the right of <code>*</code> then what's pointing is <code>const</code>.</p>\n"}], "owner": {"reputation": 3414, "user_id": 1282931, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/7TwwM.jpg?s=128&g=1", "display_name": "matthias_buehlmann", "link": "https://stackoverflow.com/users/1282931/matthias-buehlmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573075412, "creation_date": 1573074106, "question_id": 58738419, "link": "https://stackoverflow.com/questions/58738419/c-const-for-pointer-to-pointer", "title": "c++ const for pointer to pointer", "body": "<p>a pointer to a constant int. I may change the pointer, but I may not change the value:</p>\n\n<pre><code>const int* a;\n</code></pre>\n\n<p>a constant pointer to an int. I may not change the pointer, but I may change the variable's value:</p>\n\n<pre><code>int* const a;\n</code></pre>\n\n<p>now, how do things look like if I'm dealing with a pointer to a pointer?</p>\n\n<pre><code>int** a;\n</code></pre>\n\n<p>how do I:</p>\n\n<p>a) declare a const pointer to a non-const pointer to a non-const int</p>\n\n<p>b) declare a non-const pointer to a const pointer to a non-const int</p>\n\n<p>c) declare a non-const pointer to a non-const poiinter to a const int\n?</p>\n"}, {"tags": ["c++", "placement-new", "copy-assignment"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573073342, "post_id": 58737993, "comment_id": 103766533, "body": "How about using existing tested code and storing a <code>std::variant</code> in your class in-place of the <code>union</code>?  You can keep the additional behaviour/requirements just implement less code."}, {"owner": {"reputation": 451, "user_id": 6828765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9076a033d487e81eb8a5db8935117714?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/6828765/anonymous"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573073920, "post_id": 58737993, "comment_id": 103766774, "body": "I could, but I&#39;m under the impression <code>std::variant</code> has more overhead, and since my class is really fairly simple it&#39;s not much of a problem unless there&#39;s some really big, complicated issue I really don&#39;t want to do fix on my own (as with <code>std::shared_ptr</code>)."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1573076113, "post_id": 58737993, "comment_id": 103767561, "body": "I strongly suggest you to use the <code>std::variant</code>; the only memory overhead it has is a single <code>size_t</code> (I believe) for the type index, which is not much. Those low-level classes like <code>std::variant</code> can be very hard to get right, especially if you want to have proper exception safety."}], "answers": [{"comments": [{"owner": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "edited": false, "score": 0, "creation_date": 1573074699, "post_id": 58738406, "comment_id": 103767070, "body": "OPTION 1 is anything but clean.  It is a terrible antipattern that should virtually never be used.  1) If the constructor throws, you&#39;re left with a dead object.  2) Even if the constructor succeeds, it&#39;s not guaranteed that myC is the proper type to construct in its place!  Consider that myC is a base class, and <i>this</i> actually points to a derived type.  This approach will, for example, replace a <code>Dog</code> with an <code>Animal</code> and anyone still thinking it&#39;s a Dog are in serious trouble."}, {"owner": {"reputation": 15189, "user_id": 477771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1e6012428cc236ed32cf9a13376f0f3?s=128&d=identicon&r=PG", "display_name": "Mark Storer", "link": "https://stackoverflow.com/users/477771/mark-storer"}, "reply_to_user": {"reputation": 3923, "user_id": 8309701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S44bo.png?s=128&g=1", "display_name": "Chris Uzdavinis", "link": "https://stackoverflow.com/users/8309701/chris-uzdavinis"}, "edited": false, "score": 0, "creation_date": 1573075025, "post_id": 58738406, "comment_id": 103767185, "body": "An excellent point, though to be fair the destructor isn&#39;t virtual leading me to believe that won&#39;t be a problem.  The problem could then be resolved by ensuring that all child classes implement their own assignment operator, which is just prone to a different kind of bug.  I&#39;m not sure even RTTI could dig you out hole number one."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1573076957, "post_id": 58738406, "comment_id": 103767841, "body": "Also fun if in-place copy-ctor throws."}], "tags": [], "owner": {"reputation": 15189, "user_id": 477771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1e6012428cc236ed32cf9a13376f0f3?s=128&d=identicon&r=PG", "display_name": "Mark Storer", "link": "https://stackoverflow.com/users/477771/mark-storer"}, "is_accepted": false, "score": 0, "last_activity_date": 1573075985, "last_edit_date": 1573075985, "creation_date": 1573074053, "answer_id": 58738406, "question_id": 58737993, "link": "https://stackoverflow.com/questions/58737993/should-i-use-placement-new-in-a-copy-assignment-operator/58738406#58738406", "title": "Should I use placement-new in a copy assignment operator", "body": "<p>Your first version makes me nervous because you never actually call a constructor on <code>this</code> after calling <code>this-&gt;~MyC()</code>, so your object should be considered invalid.  Even if the code immediately after forces all the current member variables into theoretical validity, it'll be a prone to bugs.</p>\n\n<p>Your second option seems better, but it still leaves three places that must update every time someone adds to that union... and given that your <code>Kind</code> enum has 4 values while \nyou're only showing three... I'm thinking that'll happen sooner or later.  Again, prone to bugs.</p>\n\n<p>I can think of two other options:</p>\n\n<p>1) </p>\n\n<pre><code>MyC&amp; operator =(const MyC&amp; other)\n{\n    this-&gt;~MyC();\n    new (this) MyC(other);\n}\n</code></pre>\n\n<p>Use your existing copy constructor in place, after using your destructor \"in place\" to avoid leaks.  Slightly hacky, much cleaner, no extra maintenance.</p>\n\n<p>This results in you having only two places where you need to make changes, at the cost of a little efficiency in the string to string case.  I find that maintainability trumps efficiency in most cases.  Which cases?  Ask your profiler.</p>\n\n<p>WARNING: As Chris pointed out in the comments below, This Will Fail Horribly when dealing with a class derived from MyC unless that class likewise has its own assignment operator.  If it were called on some derived class, that class would</p>\n\n<ul>\n<li>leak anything that required that the derived class's destructor was called.</li>\n<li>turn the derived class into an instance of MyC.  MOSTLY.  I suspect that the derived destructor would still be called, with much potential badness to follow.\n\n<ul>\n<li>OTOH, this could just clean up all the stuff that 'leaked' when we called the wrong destructor earlier.  It really Just Depends.</li>\n</ul></li>\n</ul>\n\n<p>On the one hand, this code is an excellent example of walking a high rope with no net.  On the other, so is working with new/delete directly.  We just have more practice walking that particular rope, and we have nets like <code>unique_ptr</code> and <code>shared_ptr</code> we can (and generally should) use.</p>\n\n<p>2)</p>\n\n<p>Wrap your union in some any/variant template (std::variant, boost::any, whatever), per Richard's comment.  My last employer had something like 3 different variant/any classes written by three different programmers, at least two of whom clearly didn't bother to look around our codebase first.  Your company might have its own implementation[s] too.</p>\n\n<p>Don't assume that they'll be less efficient.  Again:  ask your profiler.</p>\n\n<blockquote>\n  <p>unrelated:  Searching said former employer's codebase for interesting phrases like \"do not check in\", profanity, etc, found all kinds of interesting things.  It was a game company, so things were considerably less \"retentive\" than one might find elsewhere.  It made for entertaining reading.</p>\n</blockquote>\n"}], "owner": {"reputation": 451, "user_id": 6828765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9076a033d487e81eb8a5db8935117714?s=128&d=identicon&r=PG&f=1", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/6828765/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1573075985, "creation_date": 1573072015, "question_id": 58737993, "link": "https://stackoverflow.com/questions/58737993/should-i-use-placement-new-in-a-copy-assignment-operator", "title": "Should I use placement-new in a copy assignment operator", "body": "<p>I'm creating a discriminated union-like class. I am using c++ 17, so I could technically use a <code>std::variant</code>, but because of the specific use-case I want the meaning of each variant to be more explicit (especially because two of the cases hold no data except which case they are). The class looks something like this (for the purposes of simplicity, I'll ignore move semantics in the question):</p>\n\n<pre><code>class MyC {\n\n  public:\n  enum class Kind {A, B, C, D};\n\n  private:\n  Kind _kind;\n  union {\n\n    struct {} _noVal;\n    string _aVal;\n    int _bVal; \n\n  };\n\n  MyC(Kind kind) : _kind(kind), _noVal() {}\n\n  public:\n  MyC(const MyC&amp; other) : _kind(other.kind), _noVal() {\n    if (_kind == Kind::A) new (&amp;_aVal) string(other._aVal);\n    if (_kind == Kind::B) _bVal = other._bVal;\n  }\n\n  ~MyC() {\n    if (_kind == Kind::A) _aVal.~string();\n  }\n\n  MyC&amp; operator =(const MyC&amp;);\n\n  // factory methods and methods for consuming the current value\n\n}\n</code></pre>\n\n<p>My first thought for the copy assignment operator is </p>\n\n<pre><code>MyC&amp; MyC::operator &amp;(const MyC&amp; other) {\n  this-&gt;~MyC();\n  _kind = other._kind;\n  if (_kind == Kind::A) new (&amp;_aVal) string(other.aVal);\n  else if (_kind == Kind::B) _bVal = other.bVal;\n  else _noVal = other.noVal;\n  return *this;\n}\n</code></pre>\n\n<p>This seems fine to me, but I'm wondering if it's better c++ style to call string's copy assignment operator, which would require something more like this:</p>\n\n<pre><code>MyC&amp; MyC::operator &amp;(const MyC&amp; other) {\n  if (other._kind == Kind::A) {\n    if (_kind != Kind::A) new (&amp;_aVal) string; // *\n    _aVal = other.aVal;\n  } else if (other._kind == Kind::B) {\n    _bVal = other.bVal;\n  } else {\n    _noVal = other.noVal;\n  }\n  _kind = other._kind;\n  return *this;\n}\n</code></pre>\n\n<p>To summarize, what is the right way to do this (and why), or does it matter?</p>\n\n<hr>\n\n<p>* This line is here because my original implementation set <code>aVal</code> directly without making sure a string had ever been initialized there, and it crashed.</p>\n"}, {"tags": ["c++", "for-loop", "stdvector"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1573071986, "post_id": 58737969, "comment_id": 103765969, "body": "Welcome to Stack Overflow! Please <b><a href=\"https://stackoverflow.com/posts/58737969/edit\">edit</a></b> your question with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> or <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE (Short, Self Contained, Correct Example)</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1573072705, "post_id": 58737969, "comment_id": 103766285, "body": "please dont leave out details, they do matter. If the value of <code>someSum</code> is not relevant for the example then put some other value. <code>&#47;&#47; repeat until vec[3]</code>... comments are liars, why remove code and write a comment, when you could show the code?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573073536, "post_id": 58737969, "comment_id": 103766612, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that we can cut and paste without editing and reproduces the problem.  If you have additional test cases extra code can be posted but the 1st test case should be complete and not require any editing."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1573079892, "post_id": 58737969, "comment_id": 103768867, "body": "@jej <a href=\"https://ideone.com/qAuQBq\" rel=\"nofollow noreferrer\">Can&#39;t reproduce</a>"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1573130359, "post_id": 58737969, "comment_id": 103786306, "body": "Is the code shown the <i>real</i> code?  Are you sure you didn&#39;t mistakenly call <code>reserve</code> rather than <code>resize</code>?"}], "owner": {"reputation": 1, "user_id": 12334219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5fd60ef76944330e7152f35a63476fd?s=128&d=identicon&r=PG&f=1", "display_name": "jej", "link": "https://stackoverflow.com/users/12334219/jej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573079737, "creation_date": 1573071893, "last_edit_date": 1573079737, "question_id": 58737969, "link": "https://stackoverflow.com/questions/58737969/vector-subscript-of-of-range-error-when-looping", "title": "Vector subscript of of range error when looping", "body": "<p>In <code>main()</code>, I declare a <code>std::vector</code> and call <code>f(std::vector&lt;float&gt;&amp; vec)</code>:</p>\n\n<pre><code>int main(){\n    std::vector&lt;float&gt; vec;\n    vec.resize(4);\n    f(vec);\n}\n</code></pre>\n\n<p>And then in function <code>f()</code> I try to assign values to it:</p>\n\n<pre><code>f(std::vector&lt;float&gt;&amp; vec){\n    for(int i = 0;i &lt; vec.size();i++){\n        vec[0] = //someSum;\n        vec[1] = //someSum;\n        //repeat until vec[3] \n    }\n}\n</code></pre>\n\n<p>But on the line</p>\n\n<pre><code>vec[1] = //someSum;\n</code></pre>\n\n<p>I get a vector subscript out of range error. Using the debugger, I've found out the capacity of <code>vec</code> was changed to 4, but it only had the value <code>[0]</code> in it.</p>\n\n<p>I tried stuff like pushing back:</p>\n\n<pre><code>vec.push_back(0);\n</code></pre>\n\n<p>And initialization like this:</p>\n\n<pre><code>std::vector&lt;float&gt; vec = \n     {0,0,0,0};\n</code></pre>\n\n<p>But I still get the same error. Why is that?</p>\n"}, {"tags": ["javascript", "c++", "http", "restbed"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12334193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56afb056091e01cd5218348802b7d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatboychummy", "link": "https://stackoverflow.com/users/12334193/fatboychummy"}, "edited": false, "score": 0, "creation_date": 1573122773, "post_id": 58746187, "comment_id": 103782255, "body": "restbed seemingly doesn&#39;t care if you don&#39;t return a response code. When I was getting the GET method going I never responded anything and it was fine.  The real problem is that none of the code in <code>put_method_handler</code> is being run."}, {"owner": {"reputation": 21, "user_id": 12334193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56afb056091e01cd5218348802b7d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatboychummy", "link": "https://stackoverflow.com/users/12334193/fatboychummy"}, "edited": false, "score": 0, "creation_date": 1573122967, "post_id": 58746187, "comment_id": 103782352, "body": "I&#39;ll try it tomorrow though.  I&#39;ll come back here and mark it if it works, but I very much doubt it will."}, {"owner": {"reputation": 4410, "user_id": 8343843, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CNo1jh6oD1U/AAAAAAAAAAI/AAAAAAAAAD4/A_N62bZRoQw/photo.jpg?sz=128", "display_name": "Alexey R.", "link": "https://stackoverflow.com/users/8343843/alexey-r"}, "reply_to_user": {"reputation": 21, "user_id": 12334193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56afb056091e01cd5218348802b7d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatboychummy", "link": "https://stackoverflow.com/users/12334193/fatboychummy"}, "edited": false, "score": 0, "creation_date": 1573123141, "post_id": 58746187, "comment_id": 103782439, "body": "Yes, please check and get back with the results. As per HTTP specification, GET request must not return 501 error (<a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/501\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/HTTP/Status/501</a>). Probably this is why GET is handled in some special way in restbed.."}, {"owner": {"reputation": 21, "user_id": 12334193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56afb056091e01cd5218348802b7d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatboychummy", "link": "https://stackoverflow.com/users/12334193/fatboychummy"}, "edited": false, "score": 0, "creation_date": 1573880626, "post_id": 58746187, "comment_id": 104041966, "body": "Hey sorry I&#39;m really late for this... Problem ended up being that our restbed implementation had broken.  Don&#39;t know the cause of that, but removing it and redownloading worked."}], "tags": [], "owner": {"reputation": 4410, "user_id": 8343843, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CNo1jh6oD1U/AAAAAAAAAAI/AAAAAAAAAD4/A_N62bZRoQw/photo.jpg?sz=128", "display_name": "Alexey R.", "link": "https://stackoverflow.com/users/8343843/alexey-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1573120746, "creation_date": 1573120746, "answer_id": 58746187, "question_id": 58737904, "link": "https://stackoverflow.com/questions/58737904/getting-http-501-not-implemented-when-there-is-definitely-an-implementation/58746187#58746187", "title": "Getting HTTP 501 Not Implemented when there is definitely an implementation?", "body": "<p>I have just checked <a href=\"https://github.com/Corvusoft/restbed/blob/master/test/feature/source/http_method_handlers/http_put.cpp\" rel=\"nofollow noreferrer\">how restbed developers test <code>put</code> method</a>.. Below is the code snippet:</p>\n\n<pre><code>void put_handler( const shared_ptr&lt; Session &gt; session )\n{\n    session-&gt;close( 200, \"Hello, World!\", { { \"Content-Length\", \"13\" }, { \"Connection\", \"close\" } } );\n}\n\nSCENARIO( \"publishing single path resources\", \"[resource]\" )\n{\n    auto resource = make_shared&lt; Resource &gt;( );\n    resource-&gt;set_path( \"/resources/1\" );\n    resource-&gt;set_method_handler( \"PUT\", put_handler );\n    ...\n}\n</code></pre>\n\n<p>My guess is that you're not returning success code in your put handler so that server thinks that not explicit code returned means the method is not implemented.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12334193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56afb056091e01cd5218348802b7d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatboychummy", "link": "https://stackoverflow.com/users/12334193/fatboychummy"}, "is_accepted": true, "score": 0, "last_activity_date": 1573880652, "creation_date": 1573880652, "answer_id": 58887757, "question_id": 58737904, "link": "https://stackoverflow.com/questions/58737904/getting-http-501-not-implemented-when-there-is-definitely-an-implementation/58887757#58887757", "title": "Getting HTTP 501 Not Implemented when there is definitely an implementation?", "body": "<p>Problem ended up being that our restbed implementation had broken. Don't know the cause of that, but removing it and redownloading worked.</p>\n"}], "owner": {"reputation": 21, "user_id": 12334193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56afb056091e01cd5218348802b7d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Fatboychummy", "link": "https://stackoverflow.com/users/12334193/fatboychummy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58887757, "answer_count": 2, "score": 0, "last_activity_date": 1573880652, "creation_date": 1573071598, "question_id": 58737904, "link": "https://stackoverflow.com/questions/58737904/getting-http-501-not-implemented-when-there-is-definitely-an-implementation", "title": "Getting HTTP 501 Not Implemented when there is definitely an implementation?", "body": "<p>I'm attempting to make a simple http service, I've got GET and POST working so far.  For some reason though every time I try to send a PUT, my restbed server returns 501, even though I have the method handler set for PUT.</p>\n\n<p>The PUT, POST, and GET methods are set the exact same way, via <code>resource-&gt;set_method_handler(\"METHOD\", METHOD_method_handler);</code></p>\n\n<p>The handler / setup</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void put_method_handler(const std::shared_ptr&lt;restbed::Session&gt;&amp; session) {\n  const auto request = session-&gt;get_request();\n\n  std::cout &lt;&lt; \"yes\\n\";\n}\n\nint main() {\n  auto resource = std::make_shared&lt;restbed::Resource&gt;();\n  resource-&gt;set_path(\"/resource\");\n  resource-&gt;set_method_handler(\"PUT\", put_method_handler);\n\n  // bla bla service.publish() etc\n}\n</code></pre>\n\n<p>Currently using a simple javascript FETCH via the chrome console to just see if it's recieving anything.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>fetch(\"http://localhost:1234/resource\", {method: 'PUT', body: {}})\n</code></pre>\n\n<p>My server should be printing the <code>cout</code> statement, but instead it is silent and the <code>fetch</code> returns 501.</p>\n"}, {"tags": ["c++", "templates", "tree", "insertion"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573072277, "post_id": 58737850, "comment_id": 103766101, "body": "The change in <code>N</code> means the classes are different types. I don&#39;t see what you get from having a fixed number of children when clearly you do not want a fixed number of children. I&#39;d remove template <code>N</code>  and dynamically allocate the number of children.  Use <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a> if you are allowed to."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573072397, "post_id": 58737850, "comment_id": 103766147, "body": "For completeness you should add the definition for <code>Node</code> to the question. Sidenote: See if you can hide <code>Node</code> from the user, and definitely don&#39;t let them hols a reference to one. It sucks when the user accidentally frees or damages a node because it breaks the whole data structure."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573073575, "post_id": 58737850, "comment_id": 103766630, "body": "@user4581301 I did not quite understood what you are saying but i could send a const reference to Node when I want to use Node objects and this case i don&#39;t modify node because it is const."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573074398, "post_id": 58737850, "comment_id": 103766955, "body": "Assumption: <code>Node</code> contains an array of child nodes of size <code>N</code>. This means that <code>Node&lt;5&gt;</code> has a different size from <code>Node&lt;10&gt;</code> and is no longer compatible. What you can do is make a non-templated <code>Base_Node</code> class that <code>Node</code> inherits from. <code>Base_Node</code> declares all of the functions of <code>Node</code>, but does not implement them. <code>Tree</code> stores and sees pointers to <code>Base_Node</code> and knows nothing about how many children, and thus what type of <code>Node</code> is actually pointed at. This solves the compatibility problem, but makes it really hard on <code>Tree</code> to figure out which <code>Node</code> to construct."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573074460, "post_id": 58737850, "comment_id": 103766978, "body": "The above will keep the amount of dynamic allocations down to the bare minimum, but does not scale well."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "edited": false, "score": 1, "creation_date": 1573073479, "post_id": 58738168, "comment_id": 103766592, "body": "i prefer not to use std::vector but I like your idea to pass N as parameter.  Also so just I know, does std::vector allocates the vector on heap or stack?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1573073945, "post_id": 58738168, "comment_id": 103766783, "body": "@Mohammadreza <code>vector</code> allocates dynamically. Heap is a common implementation of Dynamic storage. <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">Documentation for <code>std::vector</code></a>"}, {"owner": {"reputation": 11, "user_id": 12334315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD9bUMR6ku5MdxHzq94yuOsyZ1Y-DumuF7gtda6ceY=k-s128", "display_name": "Olivier Le Doeuff", "link": "https://stackoverflow.com/users/12334315/olivier-le-doeuff"}, "edited": false, "score": 0, "creation_date": 1573089773, "post_id": 58738168, "comment_id": 103771151, "body": "You can use at function on vector to get a reference on element to change it. But you need to check that size of the vector is superior of the element you want to access"}], "tags": [], "owner": {"reputation": 11, "user_id": 12334315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD9bUMR6ku5MdxHzq94yuOsyZ1Y-DumuF7gtda6ceY=k-s128", "display_name": "Olivier Le Doeuff", "link": "https://stackoverflow.com/users/12334315/olivier-le-doeuff"}, "is_accepted": false, "score": 0, "last_activity_date": 1573072804, "creation_date": 1573072804, "answer_id": 58738168, "question_id": 58737850, "link": "https://stackoverflow.com/questions/58737850/getting-error-because-of-template-in-tree-class/58738168#58738168", "title": "Getting error because of template in Tree class", "body": "<p>Why don't you use a std::vector and only pass N as a parameter to the node? Then you create an insert function in the node that check that max size isn't reached</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "edited": false, "score": 0, "creation_date": 1573075800, "post_id": 58738594, "comment_id": 103767464, "body": "Thank you. I understand now  what to do. I remove N and use std::vector for my <code>_children</code>"}], "tags": [], "owner": {"reputation": 19, "user_id": 9771894, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B16-l7EK3wU/AAAAAAAAAAI/AAAAAAAAB38/VRKE_9tX6eg/photo.jpg?sz=128", "display_name": "Shpresim Muja", "link": "https://stackoverflow.com/users/9771894/shpresim-muja"}, "is_accepted": false, "score": 0, "last_activity_date": 1573074903, "creation_date": 1573074903, "answer_id": 58738594, "question_id": 58737850, "link": "https://stackoverflow.com/questions/58737850/getting-error-because-of-template-in-tree-class/58738594#58738594", "title": "Getting error because of template in Tree class", "body": "<p>When c++ creates an object it creates it staticaly which means that an object with SIZE 4 is a whole diffrent object from the one with SIZE 5.these two objectare nothing alike and you can't trat them as if thy were</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "edited": false, "score": 0, "creation_date": 1573075712, "post_id": 58738658, "comment_id": 103767432, "body": "Thank you for your answer. Here I do need to use template because I dont know the type that will be passed to my tree. Although I am convinced that it is better to remove N and use std::vector."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1573076310, "post_id": 58738658, "comment_id": 103767625, "body": "@Mohammadreza I didnt want to suggest to not use a template. &quot;I dont know the type that will be passed to my tree&quot; is a good reason to write a template, but you have no good reason to parametrize the template on <code>N</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "edited": false, "score": 0, "creation_date": 1573077032, "post_id": 58738658, "comment_id": 103767869, "body": "Yeah i am agree . I am gonna remove <code>N</code> and use std::vector instead"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "edited": false, "score": 0, "creation_date": 1573077234, "post_id": 58738658, "comment_id": 103767958, "body": "But I would like to know if I can choose an index of my vector and assign it to something? Or it is impossible to do such a thing and I am stuck with <code>push_back()</code>"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1573075234, "creation_date": 1573075234, "answer_id": 58738658, "question_id": 58737850, "link": "https://stackoverflow.com/questions/58737850/getting-error-because-of-template-in-tree-class/58738658#58738658", "title": "Getting error because of template in Tree class", "body": "<blockquote>\n  <p>The Tree class is a template class of course.</p>\n</blockquote>\n\n<p>A tree is not necessarily a template. Don't do stuff \"just because\" ;).</p>\n\n<p><code>Tree&lt;char,10&gt;</code> and <code>Tree&lt;char,5&gt;</code> are two distinct types. You cannot convert one into the other unless you implement some means to convert them. </p>\n\n<p>It is not clear, why you decided to have the number of nodes children in the tree to be part of the trees type. Adding or removing children would yield you a different type of tree.</p>\n\n<p>Consider <code>std::array</code> vs <code>std::vector</code>. <code>std::array</code> has number of elements as template parameter, because its size cannot ever change. On the other hand, <code>std::vector</code> has dynamic size.</p>\n\n<p>Actually I do not see why your <code>Tree</code> needs to know about the size of its nodes <code>children</code> array. Either I missed it or you never use <code>N</code> in <code>Tree</code>. I did not follow all the details, but it seems you can safely remove <code>N</code> completely from your code and use a <code>std::vector</code> for the nodes childrens. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12278897"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1573075234, "creation_date": 1573071334, "question_id": 58737850, "link": "https://stackoverflow.com/questions/58737850/getting-error-because-of-template-in-tree-class", "title": "Getting error because of template in Tree class", "body": "<p>I have a <strong>Tree</strong> class and in this class i have a <strong>Node</strong> class (nested) which is private. The <strong>Tree</strong> class is a template class of course.<br>\nThe problem is that when I want to insert a tree child into a tree parent that has not the exact number of children, I get an error of not compatible type for conversion.  </p>\n\n<hr>\n\n<p>Here is my code:<br>\n<strong>tree.hpp</strong>  </p>\n\n<pre><code>#ifndef TREE_HPP\n#define TREE_HPP\n\n#include &lt;iostream&gt;\n#include &lt;cstddef&gt; \n\ntemplate &lt;typename T, char N&gt;\nclass Tree {\nprivate:\n  class Node;\n  Node* _info;\npublic:\n  Tree();\n  Tree(T, char);\n  Tree(const Tree&amp;) = delete;  // copy constructor\n  Tree&amp; operator= (const Tree&amp;) = delete; // assignement by copy constructor\n  Tree (Tree&amp;&amp;); // transfer constructor\n  Tree&amp; operator= (Tree&amp;&amp;); // assignement by transfer constructor\n  ~Tree() {delete _info;}\n  bool ins(char, Tree&amp;);\n  Tree* fils(char);\n};\n\ntemplate &lt;typename T, char N&gt;\nTree&lt;T, N&gt;::Tree() \n  : _info(nullptr) {}\n\ntemplate &lt;typename T, char N&gt;\nTree&lt;T, N&gt;::Tree(T data, char size) {\n  Node* node = new Node(data);\n  _info = node;\n}\n\ntemplate &lt;typename T, char N&gt;\nTree&lt;T, N&gt;::Tree(Tree&amp;&amp; t) {\n  _info = t._info;\n  t._info = nullptr;\n}\n\ntemplate &lt;typename T, char N&gt;\nTree&lt;T, N&gt;&amp; Tree&lt;T, N&gt;::operator= (Tree&amp;&amp; t) {\n  if (&amp;t != this) {delete _info; _info = t._info; t._info = nullptr;}\n  return *this;\n}\n\ntemplate &lt;typename T, char N&gt;\nbool Tree&lt;T, N&gt;::ins(char index, Tree&amp; childTree){\n  if (_info){\n    _info-&gt;getChildren()[index] = &amp;childTree;\n    return true;\n  }\n  return false;\n}\n\ntemplate &lt;typename T, char N&gt;\nTree&lt;T,N&gt;* Tree&lt;T, N&gt;::fils(char index){\n  return _info-&gt;getChildren()[index];\n}\n\ntemplate &lt;typename T, char N&gt;\nclass Tree&lt;T, N&gt;::Node {\nprivate:\n  T _data;\n  Tree* _children[N];\n  bool _isWord;\npublic:\n  Node();\n  Node(T);\n  Tree** getChildren() {return this-&gt;_children;}\n  T getData(){return this-&gt;_data;}\n  ~Node() = default;\n};\n\ntemplate &lt;typename T, char N&gt; // Node class default constructor\nTree&lt;T,N&gt;::Node::Node(){\n  _data = 0;\n  _children = nullptr;\n  _isWord = false;\n}\n\ntemplate &lt;typename T, char N&gt; // Node class constructor\nTree&lt;T,N&gt;::Node::Node(T data){\n  _data = data;\n  _isWord = false;\n  for (char i = 0; i &lt; N; i++) \n    _children[i] = NULL;\n}\n\n#endif\n\n</code></pre>\n\n<p><strong>main.cpp</strong>  </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstddef&gt;\n#include \"tree.hpp\"\n\n#define SIZE 5\n#define display(x) std::cout&lt;&lt;x&lt;&lt;std::endl\nint main() {\n  Tree&lt;char,SIZE&gt; n1('A',SIZE);\n  Tree&lt;char,SIZE&gt; n1_1('B',SIZE); // works fine\n  Tree&lt;char,10&gt; n1_2('C',10); // sends the error\n  n1.ins(0,n1_1);\n  n1.ins(1,n1_2);\n  return 0;\n}\n</code></pre>\n\n<p>and the error is:</p>\n\n<pre><code>main.cpp: In function \u2018int main()\u2019:\nmain.cpp:16:12: error: cannot convert \u2018Tree&lt;char, '\\012'&gt;\u2019 to \u2018Tree&lt;char, '\\005'&gt;&amp;\u2019\n   16 |   n1.ins(1,n1_2);\n      |            ^~~~\n      |            |\n      |            Tree&lt;char, '\\012'&gt;\nIn file included from main.cpp:4:\ntree.hpp:80:40: note:   initializing argument 2 of \u2018bool Tree&lt;T, N&gt;::ins(char, Tree&lt;T, N&gt;&amp;) [with T = char; char N = '\\005']\u2019\n   80 | bool Tree&lt;T, N&gt;::ins(char index, Tree&amp; childTree){\n      | \n</code></pre>\n\n<p>I am also opened to suggestion about ways to improve this code.<br>\nThank you ...</p>\n"}, {"tags": ["c++", "crc"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573070433, "post_id": 58737580, "comment_id": 103765296, "body": "Please show the work you&#39;ve already written so far, and explain how exactly your function doesn&#39;t work or doesn&#39;t produce the expected results. You have to show your work first, before asking for help on stackoverflow.com. Stackoverflow.com is not a web site where you can ask someone else to write your program or function from scratch. For more information, see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> questions, take the <a href=\"https://stackoverflow.com/tour\">tour</a>, and read the <a href=\"https://stackoverflow.com/help\">help center</a>."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573071691, "post_id": 58737580, "comment_id": 103765822, "body": "That&#39;s why I&#39;m asking here to get an answer, I have tried to fill it up with random data, but it doesn&#39;t work."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573071824, "post_id": 58737580, "comment_id": 103765881, "body": "You did not show any work. All you&#39;ve shown is a canned, fixed function for which you need to write more code to make it work in a certain way, according to your question&#39;s description. Please show all the work you&#39;ve done so far, and explain exactly why you wrote it in this particular way, and how exactly it &quot;doesn&#39;t work&quot;. The statement that &quot;it doesn&#39;t work&quot; is not very useful. This is like calling your mechanic on the phone, describing the problem with your car as &quot;it doesn&#39;t move&quot;, and expect the mechanic to know exactly which parts need to be fixed."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1573073171, "post_id": 58737580, "comment_id": 103766475, "body": "I&#39;m curious as to why you phrased it as a challenge <a href=\"https://codegolf.stackexchange.com/questions/195392/generate-data-buffer-to-zero-the-crc-check-result\">on codegolf</a> as well."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573073259, "post_id": 58737580, "comment_id": 103766509, "body": "If it&#39;s not a challenge I don&#39;t what it is..."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "edited": false, "score": 0, "creation_date": 1573074068, "post_id": 58737580, "comment_id": 103766813, "body": "The parameter names do not correspond to the parameter types. &quot;lp&quot; == &quot;long pointer&quot; (also used for normal pointer), &quot;dw&quot; == &quot;dword&quot; == &quot;uint32_t&quot; == &quot;unsigned int&quot; (for most platforms)."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573075040, "post_id": 58737580, "comment_id": 103767190, "body": "Thanks for your help, but it really doesn&#39;t help to solve the problem :), I usually name my variables with my dogs names. Is it wrong?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573163441, "post_id": 58740493, "comment_id": 103802501, "body": "First of I&#39;d like to thank you for your help. I have tested both solutions. Both have failed. 1. The initial CRC can be anything (it&#39;s calculated from previous blocks), if I set iCrc to this value instead of 0x0000000 it fails. 2. Both examples fails at if (oCrc != 0) 3.You are not using calcCrcPartialx() but calcCrcPartial() of your own, can that be a problem?"}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573163860, "post_id": 58740493, "comment_id": 103802637, "body": "4. The checksum is NOT stored in the blocks or after the block, it&#39;s just expected to be 0 afterwards."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573177024, "post_id": 58740493, "comment_id": 103805941, "body": "The iCrc (initial CRC) can be anything (and in your code you are setting it to 0x00000000) and we are looking for the final oCrc of the block with generated data to be 0 (in your code example) for any given iCrc, so for example I want to find the data that will set oCrc to 0 for the iCrc = 0x3932AB (example). It&#39;s not a normal case, and the CRC is NOT stored anywhere, the final CRC is expected to be of 0 value, this is the first time I have seen something like this and I really appreciate your help man :)"}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573178135, "post_id": 58740493, "comment_id": 103806171, "body": "But again the iCrc (initial CRC) is NOT 0, it can be any value, I&#39;m not looking for iCrc, I know its value (from previous blocks CRC calculations), but I don&#39;t know what data should I put in the last data buffer (those calculations are made from a file, block by block until the last block that expects to set the final oCrc to 0x00000000) to make the calcCrcPartial(data, 512, 0x123456) return 0, and in your code there is no option to set the iCrc to the given constant value."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573211725, "post_id": 58740493, "comment_id": 103816835, "body": "But your code breaks the loop at the first if (oCrc != 0) why is that? And how to setup iCrc to any given value, because it seems your code doesn&#39;t allow that."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573211762, "post_id": 58740493, "comment_id": 103816847, "body": "But in my task, the CRC is not meant to be stored anywhere."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573214138, "post_id": 58740493, "comment_id": 103817978, "body": "I&#39;m testing your code and it assumes the CRC is stored within the data, but it&#39;s not (it&#39;s not required), your code works fine, but it doesn&#39;t allow to set the initial CRC to any value say 0xABC."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573214600, "post_id": 58740493, "comment_id": 103818220, "body": "I have tried something like this <a href=\"https://pastebin.com/6PVFWRnh\" rel=\"nofollow noreferrer\">pastebin.com/6PVFWRnh</a> but it doesn&#39;t work. The buffer size MUST be 512 bytes, the initial CRC is pre-defined and I need to figure out what data put in those 512 bytes to make the calcCrcPartial() return 0. Can you help me? Thank you again, I would like to learn what am I doing wrong and how to do it properly."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573218910, "post_id": 58740493, "comment_id": 103820258, "body": "I think it works, but I overwrite my source code to test the entire code and I need to re-create it again... I&#39;m so mad ;), will rewrite it and let you know! Anyway thank you again Sir."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573234097, "post_id": 58740493, "comment_id": 103828448, "body": "I have tested everything and it works fine. Thank you :)"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573235142, "post_id": 58740493, "comment_id": 103828862, "body": "@BorisJodorovsky - where did you get this code? Is there existing data that uses CRC in the way this code generates the CRC? If not, I would suggest switching to a conventional CRC (xor data first, the cycle CRC)."}, {"owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573248466, "post_id": 58740493, "comment_id": 103833953, "body": "It&#39;s from an old flight simulator. The original files has the data resetting CRC stored as multiple WORDs to reset out the CRC to the 0 value and they are stored at the buffer beginning (they don&#39;t fill up the entire buffer). Would it be possible to do it the same way?"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "edited": false, "score": 0, "creation_date": 1573280611, "post_id": 58740493, "comment_id": 103839090, "body": "@BorisJodorovsky - yes, but I&#39;m still not sure about the order of the CRC operations, xor first or cycle first. If the current code matches what is used for the flight simulator, then use it as is. If not, try doing <code>crc ^= ((uint32_t)**lpwBlockData++)&lt;&lt;16;</code> first (xor to upper bits), then cycle the crc 16 times."}], "tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": true, "score": 0, "last_activity_date": 1573177347, "last_edit_date": 1573177347, "creation_date": 1573088099, "answer_id": 58740493, "question_id": 58737580, "link": "https://stackoverflow.com/questions/58737580/how-to-calculate-data-buffer-to-zero-checksum-value-with-as-little-data-as-its/58740493#58740493", "title": "How to calculate data buffer to zero checksum value with as little data as it&#39;s possible", "body": "<p>This is not a normal CRC. The initial CRC is cycled left 16 times, then the first short is XOR'ed to the lower 16 bits of the CRC, which is then cycled again 16 times, and the next short is XOR'ed to the lower 16 bits of the CRC. If the data is just 2 shorts, it's the same as cycling the initial CRC 32 times, then XOR'ing the 2 shorts to the cycled CRC. To get the CRC==0, just set the 2 shorts to the initial CRC cycled 32 times. Example code below.</p>\n\n<blockquote>\n  <p>How to calculate data buffer to zero checksum value with as little data as possible</p>\n</blockquote>\n\n<p>Just need 2 shorts to do this. Set the 2 shorts = 0, calculate CRC, then set the 2 shorts to the calculated CRC. This will result in a CRC of 0 for any initial CRC.</p>\n\n<p>I switched to a table driven version of the checksum function, but the code below also includes a \"cleaned up\" version of the questions example CRC function.</p>\n\n<p>This code compares the CRC outputs from the questions code, an alternate version, and a table driven version:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\ntypedef unsigned short uint16_t;\ntypedef unsigned int   uint32_t;\n\nuint32_t crctbl[65536];\n\nvoid gentbl()\n{\nuint32_t crc;\nint i, j;\n    for(j = 0; j &lt; 0x10000; j++){\n        crc = j&lt;&lt;16;\n        for(i = 0; i &lt; 16; i++)\n            // assumes twos complement\n            crc = (crc&lt;&lt;1)^((0-(crc&gt;&gt;31))&amp;0x400007u);\n        crctbl[j] = crc;\n    }\n}\n\nint calcCrcPartial(unsigned short* lpdwBlockData, unsigned short dwBlockSizeInBytes, int iInitialCrc)\n{\n    unsigned short dwBlocksSizeInWords;\n    int bIsSigned;\n    signed int j;\n    signed int i;\n    unsigned short dwDataItem;\n    bool bIsNegative;\n\n    // number of WORD blocks\n    dwBlocksSizeInWords = dwBlockSizeInBytes &gt;&gt; 1;\n\n    for (i = 0; ; ++i)\n    {\n        if (dwBlocksSizeInWords &lt;= i)\n        {\n            break;\n        }\n\n        dwDataItem = lpdwBlockData[i];\n\n//      bInvalidCrc not delcared and not used\n//      if (dwDataItem != 0)\n//      {\n//          bInvalidCrc = false;\n//      }\n\n        for (j = 0; j &lt;= 15; ++j)\n        {\n            bIsSigned = (dwDataItem &amp; 0x8000u) != 0;\n\n            dwDataItem &lt;&lt;= 1;\n\n            bIsNegative = iInitialCrc &lt; 0;\n\n            iInitialCrc &lt;&lt;= 1;\n            iInitialCrc += bIsSigned;\n\n            if (bIsNegative)\n            {\n                iInitialCrc ^= 0x400007u;\n            }\n        }\n    }\n\n    return iInitialCrc;\n}\n\n// alternate version of calcCrcPartial\nuint32_t calcCrcPartiala(uint16_t* lpwBlockData, uint16_t wBlockSizeInBytes, uint32_t iInitialCrc)\n{\nint sz = wBlockSizeInBytes &gt;&gt; 1;\nint i;\n    while(sz--){\n        for(i = 0; i &lt; 16; i++)\n            // assumes twos complement\n            iInitialCrc = (iInitialCrc&lt;&lt;1)^((0-(iInitialCrc&gt;&gt;31))&amp;0x400007u);\n        iInitialCrc ^= *lpwBlockData++;\n    }\n    return iInitialCrc;\n}\n\n// table version of calcCrcPartial\nuint32_t calcCrcPartialt(uint16_t* lpwBlockData, uint16_t wBlockSizeInBytes, uint32_t iInitialCrc)\n{\nint sz = wBlockSizeInBytes &gt;&gt; 1;\n    while(sz--)\n        iInitialCrc = (iInitialCrc&lt;&lt;16)^crctbl[iInitialCrc&gt;&gt;16]^*lpwBlockData++;\n    return iInitialCrc;\n}\n\nint main()\n{\nuint16_t data[] = {0x0000, 0x0000};\nuint32_t iCrc, oCrc, oCra, oCrt;\n    gentbl();\n    iCrc = 0x00000000u;\n    do{\n        oCrc = calcCrcPartial (data, sizeof(data), iCrc);\n        oCra = calcCrcPartiala(data, sizeof(data), iCrc);\n        oCrt = calcCrcPartiala(data, sizeof(data), iCrc);\n        if(oCrc != oCra || oCrc != oCrt){\n            std::cout &lt;&lt; \"mismatch\" &lt;&lt; std::endl;\n            break;}\n        if ((iCrc &amp; 0x0ffffffu) == 0)\n            std::cout &lt;&lt; std::hex &lt;&lt; iCrc &lt;&lt; std::endl;\n    }while(++iCrc != 0x10000000u);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>This code tests all 4 billion possible initial CRCs.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n\ntypedef unsigned short uint16_t;\ntypedef unsigned int   uint32_t;\n\nuint32_t crctbl[65536];\n\nvoid gentbl()\n{\nuint32_t crc;\nint i, j;\n    for(j = 0; j &lt; 0x10000; j++){\n        crc = j&lt;&lt;16;\n        for(i = 0; i &lt; 16; i++)\n            // assumes twos complement\n            crc = (crc&lt;&lt;1)^((0-(crc&gt;&gt;31))&amp;0x400007u);\n        crctbl[j] = crc;\n    }\n}\n\nuint32_t calcCrcPartial(uint16_t* lpwBlockData, uint16_t wBlockSizeInBytes, uint32_t iInitialCrc)\n{\nint sz = wBlockSizeInBytes &gt;&gt; 1;\n    while(sz--)\n        iInitialCrc = (iInitialCrc&lt;&lt;16)^crctbl[iInitialCrc&gt;&gt;16]^*lpwBlockData++;\n    return iInitialCrc;\n}\n\n// alternate version of questions code\nuint32_t calcCrcPartialx(uint16_t* lpwBlockData, uint16_t wBlockSizeInBytes, uint32_t iInitialCrc)\n{\nint sz = wBlockSizeInBytes &gt;&gt; 1;\nint i;\n    while(sz--){\n        for(i = 0; i &lt; 16; i++)\n            // assumes twos complement\n            iInitialCrc = (iInitialCrc&lt;&lt;1)^((0-(iInitialCrc&gt;&gt;31))&amp;0x400007u);\n        iInitialCrc ^= *lpwBlockData++;\n    }\n    return iInitialCrc;\n}\n\nint main()\n{\nuint16_t data[] = {0x0000, 0x0000};\nuint32_t iCrc, oCrc;\n    gentbl();\n    iCrc = 0x00000000u;\n    do{\n        // oCrc = iCrc cycled 32 times\n        data[0] = 0x0000;\n        data[1] = 0x0000;\n        oCrc = calcCrcPartial(data, 4, iCrc);\n        // store oCrc and verify new crc == 0\n        data[0] = (oCrc&gt;&gt;16);\n        data[1] = (oCrc&gt;&gt; 0);\n        oCrc = calcCrcPartial(data, 4, iCrc);\n        if (oCrc != 0) {\n            std::cout &lt;&lt; \"error\" &lt;&lt; std::endl;\n            break;\n        }\n        if ((iCrc &amp; 0xfffffffu) == 0)\n            std::cout &lt;&lt; std::hex &lt;&lt; iCrc &lt;&lt; std::endl;\n    }while(++iCrc != 0x00000000u);\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How to calculate data buffer to zero checksum value with as little data as possible</p>\n</blockquote>\n\n<p>If this means the minimum number of error bits, then in a buffer of 34 shorts, all zero, and initial CRC = 0, 6 bits in specific locations (based on poly and initial CRC) need to be toggled to also produce a CRC = 0:</p>\n\n<pre><code>0x8000, 0x0000, 0x0000, 0x0000, 0x0000,0x0000,0x0000,0x0000,\n0x0000, 0x0000, 0x8000, 0x0000, 0x0000,0x0000,0x0000,0x0000,\n0x0000, 0x0000, 0x0000, 0x0000, 0x0000,0x0000,0x0000,0x0000,\n0x0000, 0x0000, 0x0000, 0x0000, 0x0000,0x0000,0x0020,0x8003,\n0x0000, 0x0000\n</code></pre>\n\n<p>or simple still use the CRC polynomial which only has 5 bits = 1, only 5 words needed:</p>\n\n<pre><code>0x0100, 0x4000, 0x0700, 0x0000, 0x0000\n</code></pre>\n\n<hr>\n\n<p>This is how this version of CRC could be used for 512 bytes of data and 4 bytes of CRC:</p>\n\n<pre><code>#include &lt;stdlib.h&gt; // for rand()\n\n// # of shorts in data, not including CRC\n#define COUNT 256\n\nint main()\n{\nuint16_t data[COUNT+2];\nuint32_t iCrc, oCrc;\nint i;\n    gentbl();\n    // fill data with psuedo random values\n    for(i = 0; i &lt; COUNT; i++)\n        data[i] = ((rand()&gt;&gt;4)&amp;0xff)|((rand()&lt;&lt;4)&amp;0xff00);\n    iCrc = 0x00000000u;\n    do{\n        // generate crc\n        data[COUNT+0] = 0x0000u;\n        data[COUNT+1] = 0x0000u;\n        oCrc = calcCrcPartial(data, sizeof(data), iCrc);\n        // append crc to data\n        data[COUNT+0] = (oCrc&gt;&gt;16);\n        data[COUNT+1] = (oCrc&gt;&gt; 0);\n        // check crc\n        oCrc = calcCrcPartial(data, sizeof(data), iCrc);\n        if (oCrc != 0) {\n            std::cout &lt;&lt; \"error\" &lt;&lt; std::endl;\n            break;\n        }\n        if ((iCrc &amp; 0xfffffu) == 0)\n            std::cout &lt;&lt; std::hex &lt;&lt; iCrc &lt;&lt; std::endl;\n    }while(++iCrc != 0x01000000u);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12333655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24899bbca9830102083468203764b948?s=128&d=identicon&r=PG", "display_name": "Boris Jodorovsky", "link": "https://stackoverflow.com/users/12333655/boris-jodorovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "closed_date": 1573104115, "accepted_answer_id": 58740493, "answer_count": 1, "score": -2, "last_activity_date": 1573177347, "creation_date": 1573070068, "last_edit_date": 1573165549, "question_id": 58737580, "link": "https://stackoverflow.com/questions/58737580/how-to-calculate-data-buffer-to-zero-checksum-value-with-as-little-data-as-its", "closed_reason": "Needs details or clarity", "title": "How to calculate data buffer to zero checksum value with as little data as it&#39;s possible", "body": "<p>Given this checksum calculation function in C++</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int calcCrcPartial(unsigned short* lpdwBlockData, unsigned short dwBlockSizeInBytes, int iInitialCrc)\n{\n    unsigned short dwBlocksSizeInWords;\n    int bIsSigned;\n    signed int j;\n    signed int i;\n    unsigned short dwDataItem;\n    bool bIsNegative;\n\n    // number of WORD blocks\n    dwBlocksSizeInWords = dwBlockSizeInBytes &gt;&gt; 1;\n\n    for (i = 0; ; ++i)\n    {\n        if (dwBlocksSizeInWords &lt;= i)\n        {\n            break;\n        }\n\n        dwDataItem = lpdwBlockData[i];\n\n        if (dwDataItem != 0)\n        {\n            bInvalidCrc = false;\n        }\n\n        for (j = 0; j &lt;= 15; ++j)\n        {\n            bIsSigned = (dwDataItem &amp; 0x8000u) != 0;\n\n            dwDataItem &lt;&lt;= 1;\n\n            bIsNegative = iInitialCrc &lt; 0;\n\n            iInitialCrc &lt;&lt;= 1;\n            iInitialCrc += bIsSigned;\n\n            if (bIsNegative)\n            {\n                iInitialCrc ^= 0x400007u;\n            }\n        }\n    }\n\n    return iInitialCrc;\n}\n</code></pre>\n\n<p>Task:</p>\n\n<p>How to write a function to generate a valid block of data lpdwBlockData (512 bytes) that will make function calcCrcPartial() to return 0 for <em>any</em> given iInitialCrc (calculated from previous calls to this function)?</p>\n\n<p>The CRC is not stored in the block.</p>\n\n<p>The generated block of data (512 bytes) can contain any data.</p>\n\n<p>I have tried to fill the buffer with random data in hope it will hit the 0 checksum value after CRC calculation, but I guess it's not the way...</p>\n\n<p>How to reverse this algorithm and generate valid data to make the calcCrcPartial() on the generated buffer data and provided iInitialCrc to return value 0?</p>\n"}, {"tags": ["c++", "c++20", "duck-typing", "c++-concepts"], "answers": [{"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 3, "creation_date": 1573073837, "post_id": 58738302, "comment_id": 103766737, "body": "So, templates = compile-time duck typing :-)"}], "tags": [], "owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": false, "score": 3, "last_activity_date": 1573073526, "creation_date": 1573073526, "answer_id": 58738302, "question_id": 58737419, "link": "https://stackoverflow.com/questions/58737419/whats-the-relationship-between-c-concept-and-duck-typing/58738302#58738302", "title": "What&#39;s the relationship between C++ &quot;concept&quot; and duck typing?", "body": "<p>It really all depends on how you define \"duck typing\".</p>\n\n<p>If you use the <a href=\"https://en.wikipedia.org/wiki/Duck_typing\" rel=\"nofollow noreferrer\">dictionary definition</a> (\"If it walks like a duck and it quacks like a duck, then it must be a duck\"), then pre-concepts <a href=\"https://en.wikipedia.org/wiki/Duck_typing#Templates_or_generic_types\" rel=\"nofollow noreferrer\">templates are a form of duck typing</a>.</p>\n\n<p>The argument that <a href=\"https://stackoverflow.com/questions/6923299/whats-the-relationship-between-c-template-and-duck-typing#comment8248721_6923359\">templates are not duck typing</a> is essentially an argument from the way the term is commonly used: languages that are said to use \"duck typing\" (Python, Lua, etc) do most/all of their verification that the duck is in fact a duck at runtime. Templates do their equivalent operations at compile time and therefore they do not represent duck typing.</p>\n\n<p>Note that concepts doesn't affect either of these interpretations. If you consider runtime checking to be a fundamental part of the nature of \"duck typing\", then templates aren't duck typing even with concepts.</p>\n\n<p>So if you felt that templates are duck typing pre-concepts, then you likely feel the same way post-concepts. And vice-versa.</p>\n"}, {"comments": [{"owner": {"reputation": 3447, "user_id": 5244653, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9412ec207649931753eb77f7afca2599?s=128&d=identicon&r=PG&f=1", "display_name": "Brick", "link": "https://stackoverflow.com/users/5244653/brick"}, "edited": false, "score": 0, "creation_date": 1573133630, "post_id": 58738588, "comment_id": 103788049, "body": "&quot;the other argument here is that duck typing generally supposes you express your type constraints by attempting to use the type. Concepts are further from this model than templates already are.&quot; This is looking like the &quot;right&quot; answer to me so far. Definitely not a point that I took away from my reading of the spec but also clearly true now that you&#39;ve said it."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "reply_to_user": {"reputation": 3447, "user_id": 5244653, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9412ec207649931753eb77f7afca2599?s=128&d=identicon&r=PG&f=1", "display_name": "Brick", "link": "https://stackoverflow.com/users/5244653/brick"}, "edited": false, "score": 0, "creation_date": 1573135758, "post_id": 58738588, "comment_id": 103789227, "body": "I tend to think of concepts as more like Haskell&#39;s type classes: they&#39;re for making explicit things that are otherwise only implied"}], "tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": true, "score": 4, "last_activity_date": 1573074851, "creation_date": 1573074851, "answer_id": 58738588, "question_id": 58737419, "link": "https://stackoverflow.com/questions/58737419/whats-the-relationship-between-c-concept-and-duck-typing/58738588#58738588", "title": "What&#39;s the relationship between C++ &quot;concept&quot; and duck typing?", "body": "<blockquote>\n  <p>With C++20 there will be the new feature of \"concept\" that looks much more like a duck-typing feature</p>\n</blockquote>\n\n<p>Not really.</p>\n\n<ol>\n<li><p>If we accept that templates are already compile-time duck typing</p>\n\n<ul>\n<li><p>I disagree with both the accepted answer on the linked question and the Wikipedia page, because doing <em>the same thing</em> at compile time instead of run time is not a persuasive reason to give it a wholly different name. See static vs. dynamic polymorphism for example.</p></li>\n<li><p>then concepts are not obviously more duck-type-y than templates already are</p></li>\n<li><p>the other argument here is that duck typing generally supposes you express your type constraints by <em>attempting to use the type</em>. Concepts are further from this model than templates already are.</p></li>\n</ul></li>\n<li><p>If we agree (wrongly) with both the accepted answer on the linked question, and with Wikipedia, then</p>\n\n<ul>\n<li><p>the reason templates are not (an example of) duck typing is that they happen at compile time</p></li>\n<li><p>concepts also happen at compile time</p></li>\n<li><p>QED</p></li>\n</ul></li>\n</ol>\n\n<p>Concepts take what templates <em>already</em> do (which may or may not be, but definitely is, duck typing) and give finer-grained options for specialization, and/or more clearly express type constraints, and (hopefully) help to generate better errors.</p>\n\n<p>The quality of duckiness is invariant under all these operations.</p>\n"}], "owner": {"reputation": 3447, "user_id": 5244653, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9412ec207649931753eb77f7afca2599?s=128&d=identicon&r=PG&f=1", "display_name": "Brick", "link": "https://stackoverflow.com/users/5244653/brick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 1, "accepted_answer_id": 58738588, "answer_count": 2, "score": 8, "last_activity_date": 1573074851, "creation_date": 1573069303, "last_edit_date": 1573074530, "question_id": 58737419, "link": "https://stackoverflow.com/questions/58737419/whats-the-relationship-between-c-concept-and-duck-typing", "title": "What&#39;s the relationship between C++ &quot;concept&quot; and duck typing?", "body": "<p>There was an earlier question (8 years ago!) about the relationship between templates and duck typing here: <a href=\"https://stackoverflow.com/questions/6923299/whats-the-relationship-between-c-template-and-duck-typing\">What&#39;s the relationship between C++ template and duck typing?</a>  I've borrowed and modified the tag line for my question on a new feature of C++.</p>\n\n<p>With C++20 there will be the new feature of \"concept\" that looks much more like a duck-typing feature. Is it correct that the new C++ \"concept\" is equivalent to duck typing for C++?  If not, how is it different?</p>\n"}, {"tags": ["c++", "vector", "lambda", "priority-queue", "decltype"], "comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 3, "creation_date": 1573068966, "post_id": 58737302, "comment_id": 103764706, "body": "Please, ask only one question per question."}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 11910061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-czXVN3O10b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbS1o35yUSm8tuni-qR9bT0UVjqw/photo.jpg?sz=128", "display_name": "Tee Zad Awk", "link": "https://stackoverflow.com/users/11910061/tee-zad-awk"}, "edited": false, "score": 0, "creation_date": 1573070301, "post_id": 58737491, "comment_id": 103765234, "body": "<code>In method 2, why can I not specify my lambda as the third argument directly?</code> I mean, why can I not replace <code>decltype(myComp)</code> with the lambda expression <code>[](const pair&lt;int, int&gt;&amp; A, const pair&lt;int, int&gt;&amp; B)                {return A.second &lt; B.second;};</code> like I would in any other STL algorithm? I guess it&#39;s because this is an object being constructed, and not an algorithm.  I also don&#39;t understand where <code>decltype(myComp)</code> fits into the priority_queue constructor. Mind elaborating a little please?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 682, "user_id": 11910061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-czXVN3O10b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbS1o35yUSm8tuni-qR9bT0UVjqw/photo.jpg?sz=128", "display_name": "Tee Zad Awk", "link": "https://stackoverflow.com/users/11910061/tee-zad-awk"}, "edited": false, "score": 1, "creation_date": 1573070412, "post_id": 58737491, "comment_id": 103765280, "body": "@TomerTzadok Until C++20, The language did not allow you to declare a lambda in a template."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 682, "user_id": 11910061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-czXVN3O10b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbS1o35yUSm8tuni-qR9bT0UVjqw/photo.jpg?sz=128", "display_name": "Tee Zad Awk", "link": "https://stackoverflow.com/users/11910061/tee-zad-awk"}, "edited": false, "score": 0, "creation_date": 1573070434, "post_id": 58737491, "comment_id": 103765298, "body": "@TomerTzadok, <code>[](...) {...}</code> is a value, not a type. You need a type there."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 1, "last_activity_date": 1573070573, "last_edit_date": 1573070573, "creation_date": 1573069654, "answer_id": 58737491, "question_id": 58737302, "link": "https://stackoverflow.com/questions/58737302/why-is-vector-used-as-a-second-argument-to-priority-queue/58737491#58737491", "title": "Why is Vector used as a second argument to Priority Queue?", "body": "<blockquote>\n  <p>Why is the second parameter of priority_queue a vector?</p>\n</blockquote>\n\n<p>You can use any container that satisfies <a href=\"https://en.cppreference.com/w/cpp/container/priority_queue\" rel=\"nofollow noreferrer\">certain requirements</a>. <code>vector</code> is a reasonable default choice.</p>\n\n<blockquote>\n  <p>What does this mean and when does this second parameter need to be specified?</p>\n</blockquote>\n\n<p>If either you want to change its default value, or you want to specify the third one. <code>std::priority_queue&lt;std::pair&lt;int,int&gt;&gt;</code> is a valid type without specifying the second paramater.</p>\n\n<blockquote>\n  <p>In method 2, why is decltype needed with this lambda?</p>\n</blockquote>\n\n<p>If you want to use a custom comparator, you have to specify its type as a third template parameter. Each lambda has its own unique type, the only way to obtain it, is through <code>decltype</code>.</p>\n\n<blockquote>\n  <p>In method 2, why does the object leaderBoard need to be initialised with (myComp)</p>\n</blockquote>\n\n<p>Because <code>struct</code>-based comparator can be default constructed, but lambda-based one can't. The relevant constructors are</p>\n\n<pre><code>priority_queue() : priority_queue(Compare(), Container()) { }\npriority_queue(const Compare&amp; compare) : priority_queue(compare, Container()) { }\n</code></pre>\n\n<p>If you don't provide <code>compare</code>, <code>Compare()</code> is used. <code>myCompare()</code> is a valid value, and <code>decltype(myComp)()</code> is not.</p>\n\n<blockquote>\n  <p>In method 2, why can I not specify my lambda as the third argument directly?</p>\n</blockquote>\n\n<p>You need a type, not a value of that type.</p>\n\n<blockquote>\n  <p>What is the difference between A.second > B.second and A.second &lt; B.second? </p>\n</blockquote>\n\n<p>Swapping the order of arguments (or, equivalently, <code>&lt;</code> and <code>&gt;</code>) turns a min-heap into a max-heap and vice versa, i.e. that order determines which element will be returned by <code>.top()</code>, the smallest or the largest.</p>\n"}, {"comments": [{"owner": {"reputation": 682, "user_id": 11910061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-czXVN3O10b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbS1o35yUSm8tuni-qR9bT0UVjqw/photo.jpg?sz=128", "display_name": "Tee Zad Awk", "link": "https://stackoverflow.com/users/11910061/tee-zad-awk"}, "edited": false, "score": 0, "creation_date": 1573071352, "post_id": 58737662, "comment_id": 103765684, "body": "Thanks for this, but for 5.2 I meant: If we have a list of <code>1 2 4 1 2 51 5 3 1 2</code>, how do I know if <code>return A &lt; B</code> will put them in ascending or descending order. As I understand, B is the second element, and A is the first element, so it&#39;s saying that B must be bigger than A, hence ascending?"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 682, "user_id": 11910061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-czXVN3O10b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbS1o35yUSm8tuni-qR9bT0UVjqw/photo.jpg?sz=128", "display_name": "Tee Zad Awk", "link": "https://stackoverflow.com/users/11910061/tee-zad-awk"}, "edited": false, "score": 0, "creation_date": 1573071509, "post_id": 58737662, "comment_id": 103765740, "body": "@TomerTzadok correct. Sorting algorithms require a comparator callable which, given two arbitrary elements, will represent a <i>strict, weak ordering</i>, i.e. <code>&lt;</code> relation. They sort <i>ascending</i> in regard to the <code>&lt;</code> relation. Sorting descending, for example, is simply <i>sorting ascending, but with <code>&gt;</code> relation</i>."}], "tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": true, "score": 3, "last_activity_date": 1617132675, "last_edit_date": 1617132675, "creation_date": 1573070469, "answer_id": 58737662, "question_id": 58737302, "link": "https://stackoverflow.com/questions/58737302/why-is-vector-used-as-a-second-argument-to-priority-queue/58737662#58737662", "title": "Why is Vector used as a second argument to Priority Queue?", "body": "<blockquote>\n<p>Why is it that when <code>priority_queue</code> is used with a single data type, like 'int', we initialise it like this: <code>priority_queue&lt;int&gt;</code> [...] ?</p>\n</blockquote>\n<p>Because <code>std::priority_queue</code> is a class template defined as follows:</p>\n<pre><code>template&lt;\n    class T,\n    class Container = std::vector&lt;T&gt;,\n    class Compare = std::less&lt;typename Container::value_type&gt;\n&gt; class priority_queue;\n</code></pre>\n<p>As you can see, you can instantiate this class only providing the <code>T</code>, because the rest of the types will be defaulted. You can read more about <a href=\"https://stackoverflow.com/questions/15373823/template-default-arguments\">template default arguments here</a>.</p>\n<blockquote>\n<p>but, when it's initialized with a pair we add a second parameter of type vector <code>priority_queue&lt;pair&lt;int,int&gt;, vector&lt;pair&lt;int,int&gt;&gt;&gt;</code>?</p>\n</blockquote>\n<p>Because someone wanted to be explicit. <code>priority_queue&lt;pair&lt;int, int&gt;&gt;</code> is equivalent to <code>priority_queue&lt;pair&lt;int,int&gt;, vector&lt;pair&lt;int,int&gt;&gt;&gt;</code>, because the second template type (<code>vector&lt;pair&lt;int, int&gt;&gt;</code>) will be present by default.</p>\n<blockquote>\n<ol>\n<li>Why is the second parameter of priority_queue a vector? What does this mean and when does this second parameter need to be specified?</li>\n</ol>\n</blockquote>\n<p>We don't need to specify it <strong>explicitly</strong>. The second template parameter is a type use for internal representation of data. <code>std::priority_queue</code> is a <em>container adaptor</em>, which means that it's not a container by itself - it uses some other container and <em>wraps</em> it with certain kind of utilities.</p>\n<blockquote>\n<ol start=\"2\">\n<li>In method 2, why is decltype needed with this lambda?</li>\n</ol>\n</blockquote>\n<p>Because you need to provide a <em>type</em>. <code>myCompare</code> is a <code>struct</code>, so it's a name of a type. <code>myComp</code> is not a type, it's a variable. You wish to get it's <em>declared type</em>? Use <code>decltype</code>.</p>\n<blockquote>\n<ol start=\"3\">\n<li>In method 2, why does the object leaderBoard need to be initialised with <code>(myComp)</code>?</li>\n</ol>\n</blockquote>\n<p>Because you cannot default construct an object given a <code>decltype</code> of a lambda. You need to use the following constructor:</p>\n<pre><code>explicit priority_queue(const Compare&amp; compare)\n    : priority_queue(compare, Container()) { }\n</code></pre>\n<p>which expects a callable (in this case - the lambda) that will be used as a comparator.</p>\n<blockquote>\n<ol start=\"4\">\n<li>In method 2, why can I not specify my lambda as the third argument directly?</li>\n</ol>\n</blockquote>\n<p>You mean as the thirs <code>template</code> argument? Because as of right now, lambdas cannot be used in unevaluated contexts, and providing a type for a template is one of those.</p>\n<blockquote>\n<p>5.1. What is the difference between <code>A.second &gt; B.second</code> and <code>A.second &lt; B.second</code>?</p>\n</blockquote>\n<p>The difference is blatant. One checks for <code>A.second</code> being greater than the second argument and the other one is the reverse.</p>\n<blockquote>\n<p>5.2 How do you remember which one means ascending order, and which one is descending order?</p>\n</blockquote>\n<p>It's pretty easy - the <code>C++</code> conception is to use <code>&lt;</code> between the <em><strong>left</strong> hand side</em> argument and the <em><strong>right</strong> hand side</em> argument, like so: <code>left_hand_side &lt; right_hand_side</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1573070835, "post_id": 58737666, "comment_id": 103765437, "body": "IIRC, we cannot use a lambda in an unevaluated context, such as inside <code>decltype</code>."}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1573071323, "post_id": 58737666, "comment_id": 103765667, "body": "@DanielLangr As per <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0315r4.pdf\" rel=\"nofollow noreferrer\">this paper</a> it is allowed. I tested the code above with <code>c++2a</code> under G++, compiles and works fine."}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": false, "score": 1, "last_activity_date": 1573070490, "creation_date": 1573070490, "answer_id": 58737666, "question_id": 58737302, "link": "https://stackoverflow.com/questions/58737302/why-is-vector-used-as-a-second-argument-to-priority-queue/58737666#58737666", "title": "Why is Vector used as a second argument to Priority Queue?", "body": "<blockquote>\n  <p>In method 2, why does the object leaderBoard need to be initialised\n  with (myComp)</p>\n</blockquote>\n\n<p>it depends on what C++ standard you use. Before C++20 you need to pass functor created by lambda expression to <code>priority_queue</code> constructor because lambdas until C++20 were not default constructible. </p>\n\n<p>Since C++20 you can write:</p>\n\n<pre><code>priority_queue&lt;pair&lt;int, int&gt;, vector&lt;pair&lt;int, int&gt;&gt;, decltype(myComp)&gt; leaderBoard;\n</code></pre>\n\n<p>it will work fine because compiler knows type of lambda - specified by <code>decltype(myComp)</code>, and it can call its default ctor.</p>\n\n<hr>\n\n<blockquote>\n  <p>In method 2, why can I not specify my lambda as the third argument\n  directly?</p>\n</blockquote>\n\n<p>Yes, you can but you need to still use <code>decltype</code> to get comparator type:</p>\n\n<pre><code>priority_queue&lt;pair&lt;int, int&gt;, vector&lt;pair&lt;int, int&gt;&gt;, \n     decltype( [](const pair&lt;int, int&gt;&amp; A, const pair&lt;int, int&gt;&amp; B) \n              {return A.second &lt; B.second;} ) &gt; leaderBoard;\n</code></pre>\n"}], "owner": {"reputation": 682, "user_id": 11910061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-czXVN3O10b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbS1o35yUSm8tuni-qR9bT0UVjqw/photo.jpg?sz=128", "display_name": "Tee Zad Awk", "link": "https://stackoverflow.com/users/11910061/tee-zad-awk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 58737662, "answer_count": 3, "score": 2, "last_activity_date": 1617132675, "creation_date": 1573068689, "last_edit_date": 1573070687, "question_id": 58737302, "link": "https://stackoverflow.com/questions/58737302/why-is-vector-used-as-a-second-argument-to-priority-queue", "title": "Why is Vector used as a second argument to Priority Queue?", "body": "<p>Why is it that when priority_queue is used with a single data type, like 'int', we initialise it like this: <code>priority_queue&lt;int&gt;</code>; but, when it's initialized with a pair we add a second parameter of type vector <code>priority_queue&lt;pair&lt;int,int&gt;, vector&lt;pair&lt;int,int&gt;&gt;&gt;</code>?</p>\n\n<p>Also, I've noticed several ways to add a third argument that specifies ordering. </p>\n\n<p><strong>Method 1</strong> - Struct</p>\n\n<pre><code>struct myCompare {\n   bool operator()(const pair&lt;int, int&gt;&amp; A, const pair&lt;int, int&gt;&amp; B) {\n       return A.second &lt; B.second;\n   }\n};\n\npriority_queue&lt;pair&lt;int, int&gt;, vector&lt;pair&lt;int, int&gt;&gt;, myCompare&gt; leaderBoard;\n\n</code></pre>\n\n<p><strong>Method 2</strong> - Lambda</p>\n\n<pre><code>auto myComp = [](const pair&lt;int, int&gt;&amp; A, const pair&lt;int, int&gt;&amp; B) \n              {return A.second &lt; B.second;};\n\npriority_queue&lt;pair&lt;int, int&gt;, vector&lt;pair&lt;int, int&gt;&gt;, decltype(myComp)&gt; leaderBoard(myComp);\n</code></pre>\n\n<p><strong>My Questions</strong></p>\n\n<ol>\n<li>Why is the second parameter of <code>priority_queue</code> a <code>vector</code>? What does this mean and when does this second parameter need to be specified?</li>\n<li>In method 2, why is <code>decltype</code> needed with this lambda?</li>\n<li>In method 2, why does the object <code>leaderBoard</code> need to be initialised with <code>(myComp)</code></li>\n<li>In method 2, why can I not specify my lambda as the third argument directly?</li>\n<li>What is the difference between <code>A.second &gt; B.second</code> and <code>A.second &lt; B.second</code>? How do you remember which one means ascending order, and which one is descending order?</li>\n</ol>\n"}, {"tags": ["c++", "visual-studio", "function", "return"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1573068594, "post_id": 58737251, "comment_id": 103764563, "body": "It&#39;s undefined behavior."}, {"owner": {"reputation": 31, "user_id": 8737180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kdNrTnVDI4k/AAAAAAAAAAI/AAAAAAAAHbU/rcnH125eje8/photo.jpg?sz=128", "display_name": "Sarthik Garg", "link": "https://stackoverflow.com/users/8737180/sarthik-garg"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1573068753, "post_id": 58737251, "comment_id": 103764634, "body": "but I&#39;m getting this behaviour from two different independent compilers"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1573069367, "post_id": 58737251, "comment_id": 103764859, "body": "I would expect a warning about this if you complied it modern compiler and a reasonable warning level."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1573069544, "post_id": 58737251, "comment_id": 103764930, "body": "The compiler is <i>not</i> required to tell you when you break the rules of the language. That&#39;s all on <i>you</i>. Undefined Behaviour, no diagnostic required is a big C++ dragon you have to appease/fight/avoid."}, {"owner": {"reputation": 31, "user_id": 8737180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kdNrTnVDI4k/AAAAAAAAAAI/AAAAAAAAHbU/rcnH125eje8/photo.jpg?sz=128", "display_name": "Sarthik Garg", "link": "https://stackoverflow.com/users/8737180/sarthik-garg"}, "edited": false, "score": 0, "creation_date": 1573069841, "post_id": 58737251, "comment_id": 103765045, "body": "I&#39;m using Visual Studio 2019 as IDE and well, from it I expect an error"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1573069846, "post_id": 58737251, "comment_id": 103765049, "body": "Check your warning/error level flags; warnings from clang, g++, MSVC live: <a href=\"https://godbolt.org/z/Bx0DQr\" rel=\"nofollow noreferrer\">godbolt.org/z/Bx0DQr</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1573070048, "post_id": 58737251, "comment_id": 103765135, "body": "<i>but I&#39;m getting this behaviour from two different independent compilers</i> -- Each one of those compilers have many options to build a program, so it isn&#39;t just &quot;two compilers&quot;.  Multiply those two by the many options, and you have literally hundreds, if not thousands of ways you could have built your program that could make a difference."}, {"owner": {"reputation": 4955, "user_id": 5699329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86758f7ce8c15546da5968c504360e55?s=128&d=identicon&r=PG", "display_name": "rsjaffe", "link": "https://stackoverflow.com/users/5699329/rsjaffe"}, "edited": false, "score": 0, "creation_date": 1573071101, "post_id": 58737251, "comment_id": 103765564, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c\">What should main() return in C and C++?</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1573071122, "post_id": 58737251, "comment_id": 103765575, "body": "Sadly this is a place where you do not get an error from the compiler because in exceedingly rare occasions you don&#39;t want a hard error here."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1573078700, "post_id": 58737251, "comment_id": 103768472, "body": "On my machine, my compiler produces 3 warnings.  When I run the program, it crashes."}], "answers": [{"comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1573070000, "post_id": 58737327, "comment_id": 103765111, "body": "I find <code>&#47;Wall</code> for MSVC is a little excessive and I recommend <code>&#47;W4 &#47;permissive-</code>  Suggest OP tries both."}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 2, "creation_date": 1573070069, "post_id": 58737327, "comment_id": 103765146, "body": "The <code>&#47;Wall</code> option will spew an enormous number of warnings (even for the standard library headers). They actually want <code>&#47;W4</code> instead."}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 1, "creation_date": 1573070185, "post_id": 58737327, "comment_id": 103765192, "body": "Thanks I added to the answer."}], "tags": [], "owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "is_accepted": false, "score": 7, "last_activity_date": 1573070135, "last_edit_date": 1573070135, "creation_date": 1573068786, "answer_id": 58737327, "question_id": 58737251, "link": "https://stackoverflow.com/questions/58737251/c-i-was-solving-a-question-when-suddenly-i-noticed-that-the-code-compiled-wit/58737327#58737327", "title": "C++: I was solving a question when suddenly I noticed that the code compiled without a return statement", "body": "<p>A function that doesn\u2019t return anything as it was expected to return, has <a href=\"https://en.cppreference.com/w/cpp/language/return\" rel=\"nofollow noreferrer\">undefined behavior</a>. </p>\n\n<blockquote>\n  <p>Flowing off the end of a value-returning function (except main)\n  without a return statement is undefined behavior.</p>\n</blockquote>\n\n<p>That is why you should never ignore warnings. <code>/Wall</code>  or <code>/w4</code> is the flag you need on visual studio. </p>\n"}, {"comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 4, "creation_date": 1573070218, "post_id": 58737409, "comment_id": 103765203, "body": "It&#39;s Undefined Behaviour and I would not recommend anything but changing the compiler options to show the problem and fixing the code."}, {"owner": {"reputation": 605, "user_id": 11981587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBAdOdhIWvWZUvUACxroYq1DymWMA_dXDGvQEFEvw=k-s128", "display_name": "Ahmed Anter", "link": "https://stackoverflow.com/users/11981587/ahmed-anter"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573071090, "post_id": 58737409, "comment_id": 103765559, "body": "me too not recommend it. I am just describing how it worked"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1573073069, "post_id": 58737409, "comment_id": 103766430, "body": "If you check release code (see my live link in the comment to OP) this does not happen.  An answer is recommending a solution to OP (or it&#39;s not an answer).  If it&#39;s just a description it should be a comment."}], "tags": [], "owner": {"reputation": 605, "user_id": 11981587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBAdOdhIWvWZUvUACxroYq1DymWMA_dXDGvQEFEvw=k-s128", "display_name": "Ahmed Anter", "link": "https://stackoverflow.com/users/11981587/ahmed-anter"}, "is_accepted": false, "score": 0, "last_activity_date": 1573070647, "last_edit_date": 1573070647, "creation_date": 1573069248, "answer_id": 58737409, "question_id": 58737251, "link": "https://stackoverflow.com/questions/58737251/c-i-was-solving-a-question-when-suddenly-i-noticed-that-the-code-compiled-wit/58737409#58737409", "title": "C++: I was solving a question when suddenly I noticed that the code compiled without a return statement", "body": "<p>many compilers store returned value in EAX register which in your case holds the result of the add operation.\nso it will report the correct value.\nbut you should not depend on that in future\nhere is how vs2019 compile this</p>\n\n<pre><code>int c = a + b;\n01001FD8  mov         eax,dword ptr [a]  \n01001FDB  add         eax,dword ptr [b]  \n01001FDE  mov         dword ptr [c],eax  \n    return c;\n01001FE1  mov         eax,dword ptr [c]  \n\n}\n01001FE4  pop         edi  \n01001FE5  pop         esi  \n01001FE6  pop         ebx  \n01001FE7  add         esp,0CCh  \n01001FED  cmp         ebp,esp  \n01001FEF  call        __RTC_CheckEsp (01001294h)  \n01001FF4  mov         esp,ebp  \n01001FF6  pop         ebp  \n01001FF7  ret  \n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8737180, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kdNrTnVDI4k/AAAAAAAAAAI/AAAAAAAAHbU/rcnH125eje8/photo.jpg?sz=128", "display_name": "Sarthik Garg", "link": "https://stackoverflow.com/users/8737180/sarthik-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573109516, "creation_date": 1573068466, "last_edit_date": 1573109516, "question_id": 58737251, "link": "https://stackoverflow.com/questions/58737251/c-i-was-solving-a-question-when-suddenly-i-noticed-that-the-code-compiled-wit", "title": "C++: I was solving a question when suddenly I noticed that the code compiled without a return statement", "body": "<p>Visual Studios and even Codechef is compiling my code which has a missing return statement.</p>\n\n<p>I was solving some competitive programming question and noticed that my program is compiled without a return statement in a function. I wrote a simple function and didn't mention any return statement and the program is being compiled perfectly.</p>\n\n<p>Here's the code</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint add(int x, int y)\n{\n    int c = x + y;\n}\n\nint main() {\n\n    int a = add(1, 2);\n    cout &lt;&lt; a;\n    return 0;\n}\n</code></pre>\n\n<p>I was expecting an error which I didn't get and made me wonder what was wrong with my code(of-course not the above one). And in the program above I'm getting output <code>0</code> which I don't understand how?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1573069553, "post_id": 58737235, "comment_id": 103764933, "body": "I made an answer but deleted it because I noticed there are a lot of other things that will break so to get on the right track: Skip the manual memory allocation. <code>uint32_t *memory = new uint32_t[16];</code> should be <code>uint32_t memory[16];</code> etc."}, {"owner": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "edited": false, "score": 0, "creation_date": 1573069568, "post_id": 58737235, "comment_id": 103764941, "body": "Where&#39;d you put your &quot;terminal&quot; at in the above code.  Can you post a more complete sample?"}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "reply_to_user": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "edited": false, "score": 0, "creation_date": 1573069853, "post_id": 58737235, "comment_id": 103765052, "body": "@TJBandrowsky Yeah terminal was remnant of minimal executable example. When I realised that I typed <i>foo</i> / <i>bar</i> in question I just renamed it."}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "edited": false, "score": 1, "creation_date": 1573069879, "post_id": 58737235, "comment_id": 103765067, "body": "@Danilo Already edited that for you."}], "answers": [{"comments": [{"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573069732, "post_id": 58737464, "comment_id": 103765000, "body": "Would you mind answering why did you choose to put constructor bellow the <code>foo</code> struct?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1573069872, "post_id": 58737464, "comment_id": 103765062, "body": "<code>bar &amp;operator[]( int index)</code> was one of the things I commented in my now deleted answer. It compiles and will probably end in disaster. Edit: Actually, it doesn&#39;t compile: <a href=\"https://godbolt.org/z/oIJ5U2\" rel=\"nofollow noreferrer\">godbolt.org/z/oIJ5U2</a>"}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573069976, "post_id": 58737464, "comment_id": 103765100, "body": "@Danilo As I said in the post, <code>foo</code> is an incomplete type, You can&#39;t refer to members of <code>foo</code> until after the struct is defined."}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573070038, "post_id": 58737464, "comment_id": 103765129, "body": "@TedLyngmo Agreed."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573070508, "post_id": 58737464, "comment_id": 103765318, "body": "@Spencer Yes, sometimes it needs some help: <a href=\"https://godbolt.org/z/vQiNGL\" rel=\"nofollow noreferrer\">godbolt.org/z/vQiNGL</a> (or in this case, silly much help. <code>&#47;W4</code> is an almost unusable warning level). It still compiles with MSVC, but at least with a warning."}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573070615, "post_id": 58737464, "comment_id": 103765358, "body": "@Spencer, would you mind adding the assigment operator overloading since it fails for me ?"}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573071009, "post_id": 58737464, "comment_id": 103765519, "body": "@Danilo I added a default copy constructor, which is necessary for this to work.   You shouldn&#39;t need to add any assignment operator."}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573071543, "post_id": 58737464, "comment_id": 103765753, "body": "@Spencer, why i shouldn&#39;t need any assignment operator ? There is implied way to change the values of memory and opcode of bar?      Also I&#39;ve run this code, and it prints foo perfectly, but for bar <code>std::cout</code> returns 1. This has happened before for me when I tried to print uninitialized structure.  Maybe my compiler has gone mental."}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573071970, "post_id": 58737464, "comment_id": 103765956, "body": "@Danilo The way you&#39;ve designed it, you can&#39;t assign them separately.   And the assignment is ill-defined -- Do you want to assign the pointers, or what&#39;s behind the pointers? <code>std::cout</code> doesn&#39;t return anything -- it&#39;s an object. What makes you think it returns 1?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 1, "creation_date": 1573072133, "post_id": 58737464, "comment_id": 103766045, "body": "@Danilo If you are going to continue down this rabbit hole, at least read <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">What is The Rule of Three?</a> and <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">The rule of three/five/zero</a>."}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573072254, "post_id": 58737464, "comment_id": 103766093, "body": "In example you provided (from original code) ostream operators are overloaded. Which means that foo and bar are printable. Looks like there is serious language barrier from my side @Spencer. I don&#39;t know how to parse it differently. Ostream operators are overloaded, both objects are printable. When I try to print <code>f[4]</code> for example it returns 1, but it should return values stored at index 4."}], "tags": [], "owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "is_accepted": true, "score": 3, "last_activity_date": 1573075274, "last_edit_date": 1573075274, "creation_date": 1573069539, "answer_id": 58737464, "question_id": 58737235, "link": "https://stackoverflow.com/questions/58737235/how-to-do-c-custom-structured-array-subscript-operator-overload/58737464#58737464", "title": "How to do C++ custom structured array subscript operator overload?", "body": "<p>Basic design problems (which don't relate to your question) aside, there are <s>two</s> three things that keep this from compiling:</p>\n\n<ol>\n<li><p>The body of the constructor <code>bar::bar(foo*,int)</code> is defined inline, and uses members from <code>foo</code>.  Since <code>foo</code> isn't defined yet (it's an <strong><em>incomplete type</em></strong>), the compiler chokes because it doesn't know about the members of <code>foo</code> yet.</p></li>\n<li><p>When you call the constructor, you pass in a <code>foo &amp;</code>, not a <code>foo *</code>.</p></li>\n<li><p><code>foo::operator[]</code> returns a non-const reference to a temporary, which some compilers might accept, but is just plain wrong. (spotted by Ted Lyngmo)</p></li>\n</ol>\n\n<p>The following code compiles (<a href=\"https://godbolt.org/z/_F_ZpJ\" rel=\"nofollow noreferrer\">https://godbolt.org/z/_F_ZpJ</a>):</p>\n\n<pre><code>#include &lt;iostream&gt;\nstruct foo;\n\nstruct bar\n{\n    uint32_t *mem;\n    uint32_t *opcode;\n\n    bar():mem(nullptr),opcode(nullptr){}\n    bar( foo *f, int index );\n    bar (bar const &amp;) = default;  // add default copy constructor\n    operator bool(){ return (this-&gt;mem != nullptr) &amp; (this-&gt;opcode != nullptr); }\n};\n\n\nstruct foo{\n\n    uint32_t *memory = new uint32_t[16]();\n    uint32_t *instructions = new uint32_t[16]();\n\n    foo(){}\n\n    ~foo(){\n        delete[] this-&gt;memory;\n        delete[] this-&gt;instructions;\n    }\n\n   bar operator[]( int index){\n      return bar( this, index%16 ); // this, not *this\n   } \n\n};\n\n\nbar::bar( foo *f, int index )   // moved the definition down here\n{\n     this-&gt;mem = f-&gt;memory + (index%16);\n     this-&gt;opcode = f-&gt;instructions +(index%16);\n}\n\nstd::ostream&amp; operator&lt;&lt;( std::ostream&amp; os, bar &amp;t )\n{\n    if( t ){\n        return os &lt;&lt; \"bar:\" &lt;&lt; (*t.mem) &lt;&lt; \"\\t-\\t\" &lt;&lt; (*t.opcode);\n    }else{\n        return os &lt;&lt; \"bar: NOT INITIALIZED\";\n    }\n}\n\n\nstd::ostream&amp; operator&lt;&lt;( std::ostream&amp; os, foo &amp;f )\n{\n    for( int i =0 ; i &lt; 16; i++ ){\n        os &lt;&lt; f.memory[i] &lt;&lt; \"\\t\" &lt;&lt; f.instructions[i] &lt;&lt; \"\\n\";\n    }\n    return os;\n}\n</code></pre>\n\n<p>As I already said, there are some basic design problems and you should think about redesigning this code.   Something like <a href=\"https://godbolt.org/z/xU5q1E\" rel=\"nofollow noreferrer\">the code at this link</a> is better.  Better yet, ditch <code>foo</code> altogether use the refactoring suggested in TJ Bandrowsky's answer. </p>\n"}, {"comments": [{"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573069790, "post_id": 58737504, "comment_id": 103765022, "body": "What is machine model? I have tried using <code>std::vector</code> ... I had bad time referencing it since (and I&#39;ve read this on SO somewhere) it can not be changed."}, {"owner": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573070098, "post_id": 58737504, "comment_id": 103765158, "body": "Well, it looks like you are trying to write something that emulates assembler, so a list of your bars would be like a program.  Therefor   std::vector&lt;bar&gt; instructions.  Then you just loop through instructions ...the tell tale sign is that you are using way too many pointers for modern C++.  Instead of trying to roll your own collections, use the ones they have."}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573070119, "post_id": 58737504, "comment_id": 103765168, "body": "@Danilo What do you mean by &quot;it cannot be changed&quot;?  You can insert, delete, and update individual values of a <code>vector</code>...."}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "reply_to_user": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "edited": false, "score": 0, "creation_date": 1573070357, "post_id": 58737504, "comment_id": 103765259, "body": "@Spencer. I tried to implement subscirpt operator with 1D <code>std::vector</code> instead of 2 <code>array</code>s but, when I searched for the issue I was having (on some questions several days ago) it said that reference to item in vector cant change the value of vectors item."}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573070758, "post_id": 58737504, "comment_id": 103765401, "body": "@TJBandrowsky yeah, assembler is close to what I want to do, but every memory is tied to instruction, no looping over programs - just bouncing out variables between memories and their instructions. That is why I need to hold in bar opcode and memory, since I can then use operators <code>&gt;&gt;</code>, <code>&lt;&lt;</code> and <code>=</code> to set,get memory and assign instruction."}, {"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "reply_to_user": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573070808, "post_id": 58737504, "comment_id": 103765424, "body": "@Danilo You shouldn&#39;t need to implement <code>operator[]</code>. <code>vector</code> already does that for you."}, {"owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "edited": false, "score": 0, "creation_date": 1573071241, "post_id": 58737504, "comment_id": 103765633, "body": "So I do have 1 vector that holds entire file, but now I need to reference specific memory segments that are changeable, so if I grab 1 instruction, and its memory with offset of 16*4 bytes, that is what I need to access with subscript operator overloading. It seems much easier than running over whole file every time I need to access memory or instruction."}, {"owner": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "edited": false, "score": 0, "creation_date": 1573072890, "post_id": 58737504, "comment_id": 103766349, "body": "In that case what you do is change bar to like so:  class bar {     int opcode;     std::vector&lt;int&gt; mem; }  class machine {   std::vector&lt;bar&gt; instructions;  }  Now you have variable length memory, can access each instruction individually, and C++ does all the heavy lifting for you."}], "tags": [], "owner": {"reputation": 640, "user_id": 3111723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f6cc5dfdc3fff2278517e8ae2eb40f?s=128&d=identicon&r=PG&f=1", "display_name": "TJ Bandrowsky", "link": "https://stackoverflow.com/users/3111723/tj-bandrowsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1573069723, "creation_date": 1573069723, "answer_id": 58737504, "question_id": 58737235, "link": "https://stackoverflow.com/questions/58737235/how-to-do-c-custom-structured-array-subscript-operator-overload/58737504#58737504", "title": "How to do C++ custom structured array subscript operator overload?", "body": "<p>I'd consider refactoring the thing to something like:</p>\n\n<pre><code>bar {\nuint opcode, mem;\n}\n</code></pre>\n\n<p>then make your machine model a std:vector and it would be a lot simpler.</p>\n"}], "owner": {"reputation": 934, "user_id": 3142882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100003477858906/picture?type=large", "display_name": "Danilo", "link": "https://stackoverflow.com/users/3142882/danilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 58737464, "answer_count": 2, "score": 0, "last_activity_date": 1573075274, "creation_date": 1573068370, "last_edit_date": 1573070784, "question_id": 58737235, "link": "https://stackoverflow.com/questions/58737235/how-to-do-c-custom-structured-array-subscript-operator-overload", "title": "How to do C++ custom structured array subscript operator overload?", "body": "<p>I want to provide an subscript operator structure for the struct I am writing. I plan to do this with two <code>struct</code>s <strong>foo</strong> and <strong>bar</strong>. Code is as follows:  </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\nstruct foo;\n\nstruct bar{\n    uint32_t *mem;\n    uint32_t *opcode;\n\n    bar():mem(nullptr),opcode(nullptr){}\n    bar( foo *f, int index ){\n        this-&gt;mem = f-&gt;memory + (index%16);\n        this-&gt;opcode = f-&gt;instructions +(index%16);\n    }\n    operator bool(){ return (this-&gt;mem != nullptr) &amp; (this-&gt;opcode != nullptr); }\n};\nstd::ostream&amp; operator&lt;&lt;( std::ostream&amp; os, bar &amp;t ){\n    if( t ){\n        return os &lt;&lt; \"bar:\" &lt;&lt; (*t.mem) &lt;&lt; \"\\t-\\t\" &lt;&lt; (*t.opcode);\n    }else{\n        return os &lt;&lt; \"bar: NOT INITIALIZED\";\n    }\n}\n\nstruct foo{\n\n    uint32_t *memory = new uint32_t[16]();\n    uint32_t *instructions = new uint32_t[16]();\n\n    foo(){}\n\n    ~foo(){\n        delete[] this-&gt;memory;\n        delete[] this-&gt;instructions;\n    }\n\n   bar &amp;operator[]( int index){\n      return bar( *this, index%16 );\n   } \n\n};\nstd::ostream&amp; operator&lt;&lt;( std::ostream&amp; os, foo &amp;f ){\n    for( int i =0 ; i &lt; 16; i++ ){\n        os &lt;&lt; f.memory[i] &lt;&lt; \"\\t\" &lt;&lt; f.instructions[i] &lt;&lt; \"\\n\";\n    }\n    return os;\n}\n</code></pre>\n\n<p>I am using CygWin[x86_64] and Notepad++ as main compiler and editor on Windows 7 64 bit.   </p>\n\n<p>I have tried a lot of permutations on my own to fix this problem, but I would like to show the following:  </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bar( foo *f, int index ){\n    this-&gt;mem = f-&gt;memory + (index%16);\n    this-&gt;opcode = f-&gt;instructions +(index%16);\n}\n\nand \n\nbar( foo *f, int index ){\n    this-&gt;mem = f-&gt;memory[index%16];\n    this-&gt;opcode = f-&gt;memory[index%16];\n}\n\n</code></pre>\n\n<blockquote>\n  <p>'f' is incomplete type error, with note that I have used forward declaration.</p>\n</blockquote>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bar( foo *f, int index ){\n    this-&gt;mem = f-&gt;memory[index%16];\n    this-&gt;opcode = f-&gt;memory[index%16];\n}\n\n</code></pre>\n\n<blockquote>\n  <p>two forward declarations notes, and two invalid use of incomplete type <code>struct foo</code> on <code>this-&gt;mem = f-&gt;memory[index%16]</code> and <code>this-&gt;opcode = f-&gt;memory[index%16];</code></p>\n</blockquote>\n\n<hr>\n\n<p>I have tried a bunch of other stuff but it seems I have mostly an issue with <code>incomplete type</code>. I have searched SO for answers, and one did explain <a href=\"https://stackoverflow.com/questions/553682/when-can-i-use-a-forward-declaration/553869#553869\">what is incomplete type</a>, other issue was <a href=\"https://stackoverflow.com/questions/5276134/incomplete-type\">about recursive definition</a> and <a href=\"https://stackoverflow.com/questions/10446494/incomplete-type-error\">this one doesn't define how to make an incomplete type complete</a>.  </p>\n\n<p>I am hung on this for past several days, going trough iterations for simple operator overloading. Maybe I am phrasing it wrong in questions, or searching for wrong answers. </p>\n\n<p>But can someone point out my mistakes and/or write how to overload array subscript operator with code and not just body less functions?   </p>\n"}, {"tags": ["c++", "insert", "iterator"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1573067723, "post_id": 58737048, "comment_id": 103764203, "body": "What have you tried so far, what errors do you get.  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3198, "user_id": 6119582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d37ce6d78ed9281f47a2712aaed48?s=128&d=identicon&r=PG&f=1", "display_name": "sweenish", "link": "https://stackoverflow.com/users/6119582/sweenish"}, "is_accepted": false, "score": 0, "last_activity_date": 1573079131, "creation_date": 1573079131, "answer_id": 58739381, "question_id": 58737048, "link": "https://stackoverflow.com/questions/58737048/c-nested-iterator-class-in-linked-list-class-insert-after-function/58739381#58739381", "title": "C++ Nested Iterator Class (In Linked List Class) Insert_After Function", "body": "<p>I think the short answer to your compiler errors is that you are likely supposed to pass a <code>Node</code> or <code>Node*</code> as your second argument and not an iterator. <code>previous</code> is also an iterator, and therefore does not have a <code>next</code> call.</p>\n\n<p><em>Long answer below about generally fixing the function in question:</em><br>\nThere's a lot [not] going on in that function, which gets me wondering about the rest of the linked list class as well. I've only looked at this function, as it's the one you claim is causing you trouble. </p>\n\n<p><strong>SUBJECTIVE THOUGHT</strong> I generally hate working with iterators in my class functions. Deal with the Nodes directly as much as possible. The iterator pattern exists for universal traversal of containers no matter how they're laid out, and that abstraction makes it a pain to deal with inside your class.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Iterator insert_after(Iterator position, const T&amp; value)\n{\n    // Need to insert after position\n    Iterator previous = position;\n    ++position;\n    Node* newNode = new Node(value, position);\n    previous-&gt;next = newNode;\n\n}\n</code></pre>\n\n<p>As it currently stands, if <code>position</code> is anywhere but the last element, you will break your list and leak memory. This is because you never check what is after <code>position</code>. That first mistake leads into the second. <code>newNode-&gt;next</code> never gets set. Maybe it's default constructed to <code>nullptr</code>, that's fine. But if I'm inserting into the middle of my list, I need to connect <code>newNode</code> to whatever came after <code>position</code> originally.</p>\n\n<p>Another question that you need to consider is \"what if this is called on an empty list?\" Does your <code>begin()</code> function handle that? Is it supposed to throw?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Iterator insert_after(Iterator position, const T&amp; value)\n{\n    Node* pos = position.iNode;\n\n    if (!pos) {  // assumes an empty list if this is true\n        // Correctly build first Node of your list and get everything assigned\n        // that you can\n        // return the new iterator;\n\n        // or just throw\n    }\n\n    if (!pos-&gt;next) {  // position at end of list if true\n        pos-&gt;next = new Node(value, position);  // Is that second argument\n                                                // supposed to be an iterator?\n        return Iterator(pos-&gt;next);\n    } else {\n        // Some of this is probably redundant depending on how you are actually\n        // building Nodes, but the gist is it's important to ensure the list is\n        // not broken; connecting tmp before changing existing nodes helps the\n        // list stay intact for as long as possible\n        Node* tmp = new Node(value, position);\n        tmp-&gt;next = pos-&gt;next;\n        pos-&gt;next = tmp;\n\n        return Iterator(tmp);\n    }    \n</code></pre>\n\n<p>A doubly linked list never seems attractive at first blush to a student, but it makes certain operations like erasing from the middle of the list so much easier. Yes, you have one extra pointer to deal with, but it makes it harder to lose Nodes as well. Along with bi-directional iteration.</p>\n"}], "owner": {"reputation": 1, "user_id": 12329197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7f28c4893179bc32d40d13fac464de3?s=128&d=identicon&r=PG&f=1", "display_name": "Sennri", "link": "https://stackoverflow.com/users/12329197/sennri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573079131, "creation_date": 1573067526, "last_edit_date": 1573068256, "question_id": 58737048, "link": "https://stackoverflow.com/questions/58737048/c-nested-iterator-class-in-linked-list-class-insert-after-function", "title": "C++ Nested Iterator Class (In Linked List Class) Insert_After Function", "body": "<p>I have an iterator class nested in a LinkedList class. My question is how do I make the insert_after function using iterators. The rest of the code is given for information purposes, but the function I'm trying to get working is at the end.</p>\n\n<p>Insert_After takes a position and inserts a value after it.</p>\n\n<pre><code>template &lt;typename T&gt;\nclass LinkedList : public LinkedListInterface&lt;T&gt; {\nprivate:\n    struct Node {\n\n    T data; // data can be any type\n    Node* next; // points to the next Node in the list\n\n    Node(const T&amp; d, Node* n) : data(d), next(n) {}\n};\nNode* head; // Is a pointer\n\nclass Iterator\n{\nprivate:\n    Node* iNode;\npublic:\n    Iterator(Node* head) : iNode(head){ }\n    ~Iterator() {}\n    bool operator!=(const Iterator&amp; rhs) const { return iNode != rhs.iNode; }\n    Iterator&amp; operator++() { iNode = iNode-&gt;next; return *this; }\n    T&amp; operator*() const { return iNode-&gt;data; }\n};\n\n/** Return iterator pointing to the first value in linked list */\nIterator begin(void) {\n    return LinkedList&lt;T&gt;::Iterator(head); \n}\n\n/** Return iterator pointing to something not in linked list */\nIterator end(void) {\n    return LinkedList&lt;T&gt;::Iterator(NULL); \n}\n\n/** Return iterator pointing found value in linked list */\nIterator find(Iterator first, Iterator last, const T&amp; value) {\n    Iterator current = first;\n    bool found = false;\n    while (current != last) {\n        if (*current == value) {\n            return current;\n        }\n\n        ++current;\n    }\n\n    return last;\n}\n\nIterator insert_after(Iterator position, const T&amp; value)\n{\n    // Need help here\n}\n</code></pre>\n\n<p>What I've tried so far resulted in a few errors.</p>\n\n<pre><code>Iterator insert_after(Iterator position, const T&amp; value)\n{\n    // Need to insert after position\n    Iterator previous = position;\n    ++position;\n    Node* newNode = new Node(value, position);\n    previous-&gt;next = newNode;\n\n}\n</code></pre>\n\n<p>The error I got was Error C2664 'function' : cannot convert argument n from 'type1' to 'type2' for the line </p>\n\n<pre><code>Node* newNode = new Node(value, position);\n</code></pre>\n\n<p>Compiler Error C2819 type 'type' does not have an overloaded member 'operator ->' for line</p>\n\n<pre><code>previous-&gt;next = newNode;\n</code></pre>\n\n<p>I understand the errors but I'm not sure how to work around them.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1573067549, "post_id": 58736955, "comment_id": 103764130, "body": "<code>Derived* derivedPtr = reinterpret_cast&lt;Derived*&gt;(dervivedObjs.at(0));</code> - ouch, please don&#39;t ever do that. If <i>anything</i> you want a <code>dynamic_cast</code> there, <i>not</i> a <code>reinterpret_cast</code>. <code>reinterpret_cast</code> should almost <i>never</i> be used."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573067603, "post_id": 58736955, "comment_id": 103764148, "body": "Put the common virtual methods in <code>Base</code>; use <code>dynamic_cast</code> (and test) when you <b>have</b> to call methods on <code>Derived</code> directly.  This assumes that there will be more than 1 class derived from Base."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "edited": false, "score": 2, "creation_date": 1573067649, "post_id": 58736955, "comment_id": 103764168, "body": "If you do <code>std::map&lt;int, Base*&gt;</code> it reads: you might store (pointer to) any class object derived from <code>Base</code> (not just only <code>Derived</code>); then it doesn&#39;t make sense to <code>reinterpret_cast&lt;Derived*&gt;</code> because you don&#39;t know the runtime type of your object..."}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 5158790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f05785f41cb20ddde4645a243f6891?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5158790/martin"}, "edited": false, "score": 0, "creation_date": 1573088739, "post_id": 58737094, "comment_id": 103770954, "body": "derived has diferent data."}, {"owner": {"reputation": 66, "user_id": 5158790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f05785f41cb20ddde4645a243f6891?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5158790/martin"}, "edited": false, "score": 0, "creation_date": 1573089211, "post_id": 58737094, "comment_id": 103771033, "body": "(edited because pressed enter accidentally) Thanks for the answer. derived has different data. using this: virtual int get_b() = 0; i&#39;m forced to override in a derived class that wont have to do that. But i can use it as non pure virtual, but you said don&#39;t. why?  And what would be a better design? i&#39;m ok to redeseing because i&#39;m learning."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 66, "user_id": 5158790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f05785f41cb20ddde4645a243f6891?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5158790/martin"}, "edited": false, "score": 0, "creation_date": 1573154236, "post_id": 58737094, "comment_id": 103798785, "body": "@Martin the article I had in mind, I didnt find anymore, anyhow, &quot;don&#39;t&quot; because you don&#39;t want each class deriving from <code>Base</code> carry a <code>get_b</code> method that can only return a dummy value, just because one derived class has a <code>b</code> member. To propose a better design one would need to know what you want to design for. <code>Base</code> and <code>Derived</code> dont really tell what those classes are supposed to be good for. Though, SO isnt the place to discuss design I am afraid (there might be other Q&amp;As on SE where this would be ontopic)."}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": true, "score": 4, "last_activity_date": 1573069745, "last_edit_date": 1573069745, "creation_date": 1573067749, "answer_id": 58737094, "question_id": 58736955, "link": "https://stackoverflow.com/questions/58736955/derived-objects-stored-in-one-common-container-how-to-avoid-casting/58737094#58737094", "title": "Derived Objects stored in one common container. How to avoid casting", "body": "<blockquote>\n  <p>How can avoid casting everytime i need to access some data on a derived class?</p>\n</blockquote>\n\n<p>By providing an appropriate interface:</p>\n\n<pre><code>class Base\n{\npublic:\n    Base() {}\n    virtual ~Base() {}\n    //some data\n    int a;\n    virtual int get_b() = 0;\n};\n</code></pre>\n\n<p>Now <code>Derived</code> can override <code>get_b</code> to provide access to its member <code>b</code>.</p>\n\n<p><strong>PS</strong></p>\n\n<p>More precisely <code>Derived</code> and all other classes inheriting from <code>Base</code> would <strong>have to</strong> provide a definition for <code>get_b</code>, because <code>get_b</code> is pure virtual. </p>\n\n<p>If some classes deriving from <code>Base</code> cannot do that, you could consider to make <code>get_b</code> non-abstract in <code>Base</code> ... long story short: Don't.</p>\n\n<p>The desire to cast is almost always a sign for wrong design. What you are trying at the moment is to fight your design. Instead of casting you should go one step back and consider if a <code>std::map&lt;int, Base*&gt;</code> is what you really want. The sloppy translation of this data structure is: \"I want a container whose elements have the interface as defined in <code>Base</code>, other than that I do not care about the dynamic type of the objects.\"</p>\n\n<p>If you ever have to cast a <code>Base*</code> to <code>Derived*</code> then use <a href=\"https://en.cppreference.com/w/cpp/language/dynamic_cast\" rel=\"nofollow noreferrer\"><code>dynamic_cast</code></a>. <a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"nofollow noreferrer\"><code>reinterpret_cast</code></a> has a very limited number of allowed uses and is not meant to be used for casts along a class hierarchy. </p>\n\n<p><strong>TL;DR</strong></p>\n\n<blockquote>\n  <p>How can avoid casting everytime i need to access some data on a derived class?</p>\n</blockquote>\n\n<p>Just don't do it.</p>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 11981587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBAdOdhIWvWZUvUACxroYq1DymWMA_dXDGvQEFEvw=k-s128", "display_name": "Ahmed Anter", "link": "https://stackoverflow.com/users/11981587/ahmed-anter"}, "is_accepted": false, "score": 0, "last_activity_date": 1573068311, "creation_date": 1573068311, "answer_id": 58737225, "question_id": 58736955, "link": "https://stackoverflow.com/questions/58736955/derived-objects-stored-in-one-common-container-how-to-avoid-casting/58737225#58737225", "title": "Derived Objects stored in one common container. How to avoid casting", "body": "<p>Using Base pointer to store pointers to derived classes is useful in the these cases:</p>\n\n<p>1- you have many objects instantiated from different classes that derived from Base and want to store them in one container\n2- you want to do common tasks on those objects which should declared as virtual functions in Base class</p>\n\n<p>then you don't need to cast to derived class</p>\n"}], "owner": {"reputation": 66, "user_id": 5158790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f05785f41cb20ddde4645a243f6891?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5158790/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58737094, "answer_count": 2, "score": 0, "last_activity_date": 1573069745, "creation_date": 1573067093, "question_id": 58736955, "link": "https://stackoverflow.com/questions/58736955/derived-objects-stored-in-one-common-container-how-to-avoid-casting", "title": "Derived Objects stored in one common container. How to avoid casting", "body": "<p>Hey dear folks i'm doing this. Probably this is not good.</p>\n\n<pre><code>class Base\n{\npublic:\n    Base() {}\n    virtual ~Base() {}\n    //some data\n    int a;\n};\n\nclass Derived : public Base\n{\npublic:\n    Derived() {}\n    ~Derived() {}\n    //some extra data not in base\n    int b;\n};\n\nint main()\n{\n    std::map&lt;int, Base*&gt; dervivedObjs;\n\n    Derived* derived = new Derived;\n    dervivedObjs.emplace(0, derived);\n\n    Derived* derivedPtr = reinterpret_cast&lt;Derived*&gt;(dervivedObjs.at(0));\n\n    return 0;\n}\n</code></pre>\n\n<p>How can avoid casting everytime i need to access some data on a derived class?</p>\n\n<p>or is there a most performant way?</p>\n"}, {"tags": ["c++", "c++17"], "comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1573068362, "post_id": 58736875, "comment_id": 103764463, "body": "what compiler version are you using?"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 1, "creation_date": 1573069462, "post_id": 58736875, "comment_id": 103764896, "body": "it is reproducible <a href=\"https://godbolt.org/z/RkhHqy\" rel=\"nofollow noreferrer\">godbolt.org/z/RkhHqy</a> @S.M. you are declaring local variables, which are a different beast."}, {"owner": {"reputation": 263, "user_id": 3721426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6659b6debfea6770cfebc47d51412499?s=128&d=identicon&r=PG&f=1", "display_name": "user3721426", "link": "https://stackoverflow.com/users/3721426/user3721426"}, "reply_to_user": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1573069857, "post_id": 58736875, "comment_id": 103765056, "body": "Thank you for providing a link, @bolov. I tested this on godbolt and should of course have provided a link myself."}, {"owner": {"reputation": 951, "user_id": 8274127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc5657bf373d72636079311cf0369806?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8274127/mark"}, "edited": false, "score": 1, "creation_date": 1573073498, "post_id": 58736875, "comment_id": 103766596, "body": "See <a href=\"https://stackoverflow.com/questions/26386010/does-a-declaration-using-auto-match-an-extern-declaration-that-uses-a-concrete\" title=\"does a declaration using auto match an extern declaration that uses a concrete\">stackoverflow.com/questions/26386010/&hellip;</a>"}, {"owner": {"reputation": 263, "user_id": 3721426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6659b6debfea6770cfebc47d51412499?s=128&d=identicon&r=PG&f=1", "display_name": "user3721426", "link": "https://stackoverflow.com/users/3721426/user3721426"}, "edited": false, "score": 0, "creation_date": 1573079307, "post_id": 58736875, "comment_id": 103768660, "body": "Thank you Mark for providing a definitive answer."}], "owner": {"reputation": 263, "user_id": 3721426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6659b6debfea6770cfebc47d51412499?s=128&d=identicon&r=PG&f=1", "display_name": "user3721426", "link": "https://stackoverflow.com/users/3721426/user3721426"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1573066965, "creation_date": 1573066793, "last_edit_date": 1573066965, "question_id": 58736875, "link": "https://stackoverflow.com/questions/58736875/extern-declaration-defined-using-auto-legal-compilers-differ", "title": "extern declaration defined using auto. Legal? Compilers differ", "body": "<p>Why does this not compile with gcc/msvc? clang is happy and hopefully right.</p>\n\n<pre><code>#include &lt;type_traits&gt;\nextern const int s1;\nstatic_assert(std::is_same_v&lt;decltype(s1),int const&gt;);\nauto  const s1 = int{42};\nstatic_assert(std::is_same_v&lt;decltype(s1),int const&gt;);\n</code></pre>\n"}, {"tags": ["c++", "c", "winapi", "disk"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1573067044, "post_id": 58736814, "comment_id": 103763923, "body": "Check <code>sizeof(long) == sizeof(DWORD)</code> as <code>moveToHigh</code> should be a <code>DWORD</code>.  Also <code>SetFilePointerEx</code> might be simpler to use."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573068598, "post_id": 58736814, "comment_id": 103764567, "body": "@RichardCritten also <code>SetFilePointer[Ex]</code> not need at all. need set offset in <code>ReadFile&#47;WriteFile</code> call direct"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1573069895, "post_id": 58736814, "comment_id": 103765074, "body": "RbMm is referring to using an <code>OVERLAPPED</code> struct to specify the offset when calling <code>ReadFile()</code>/<code>WriteFile()</code>, then there is no need to use <code>SetFilePointer&#47;Ex()</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1573069979, "post_id": 58736814, "comment_id": 103765101, "body": "@Deulis are you sure the sector size on the disk is 512 bytes? How is the disk formatted exactly?"}, {"owner": {"reputation": 406, "user_id": 1397307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9585055fa3e7817c9f46b29382e876c2?s=128&d=identicon&r=PG", "display_name": "Deulis", "link": "https://stackoverflow.com/users/1397307/deulis"}, "edited": false, "score": 0, "creation_date": 1573075229, "post_id": 58736814, "comment_id": 103767276, "body": "RbMm and Remy, I have the same result using an OVERLAPPED struct. And yes, the sector size on disk is 512 bytes, I am using WinHex and Disk Editor to double check that. Thanks!"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1573078009, "post_id": 58736814, "comment_id": 103768231, "body": "@Deulis - of course result will not change only because you change way how you set offset. i only try to say that api like <code>SetFilePointerEx</code> was atavism. about access denied (if it really was access denied - i be call <code>RtlGetLastNtStatus()</code> or <code>NtWriteFile</code>) - it can be from filesystem, but you dismount volume"}], "owner": {"reputation": 406, "user_id": 1397307, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9585055fa3e7817c9f46b29382e876c2?s=128&d=identicon&r=PG", "display_name": "Deulis", "link": "https://stackoverflow.com/users/1397307/deulis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "closed_date": 1573070074, "answer_count": 0, "score": 0, "last_activity_date": 1573093793, "creation_date": 1573066517, "last_edit_date": 1573093793, "question_id": 58736814, "link": "https://stackoverflow.com/questions/58736814/windows-filewrite-fails-for-volume-sectors-bigger-than-0x1fff", "closed_reason": "Duplicate", "title": "Windows FileWrite fails for volume sectors bigger than 0x1FFF", "body": "<p>Why I can not write sector at position bigger than 0x1FFF?\nI am trying to write sector in a SD card. The following code work great for sectors number lower than 0x2000 but fail for any sector bigger than 0x1FFFF returning error code number 5. I don't know why?\nI don't think this is a duplicate question because I can write sectors in the disk but I can't write sector bigger than 0x1FFF. I am using WinHex and Disk Editor to verify that those sector exist.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    LPCWSTR device_name = L\"\\\\\\\\.\\\\PHYSICALDRIVE2\";\n\n\n    int sector = 0x2000;\n\n    //Open the volume\n    HANDLE hDisk = CreateFile(device_name, (GENERIC_READ | GENERIC_WRITE), 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);\n    if (hDisk != INVALID_HANDLE_VALUE) \n    {\n        DWORD ol = 0;\n        //Lock the volume\n        if (DeviceIoControl(hDisk, FSCTL_LOCK_VOLUME, NULL, 0, NULL, 0, &amp;ol, NULL))\n        {\n            ol = 0;\n            //Dismount the volume\n            if (DeviceIoControl(hDisk, FSCTL_DISMOUNT_VOLUME, NULL, 0, NULL, 0, &amp;ol, NULL))\n            {\n                unsigned char buff[512];\n\n                //Set position at desire sector\n                int position = sector * 512;\n                DWORD readBytes = 0;\n                long moveToHigh = 0;\n                SetFilePointer(hDisk, position, &amp;moveToHigh, FILE_BEGIN);\n\n                //Read the sector\n                if (ReadFile(hDisk, buff, 512, &amp;readBytes, NULL) &amp;&amp; readBytes == 512)\n                {\n                    //Set the write position\n                    DWORD writenBytes = 0;\n                    moveToHigh = 0;\n                    SetFilePointer(hDisk, position, &amp;moveToHigh, FILE_BEGIN);\n\n                    if (WriteFile(hDisk, buff, 512, &amp;writenBytes, NULL) &amp;&amp; writenBytes == 512)\n                    {\n                        printf(\"OK for Sector %d \\r\\n\", sector);\n                    }\n                    else\n                    {\n                        DWORD dwError = GetLastError();\n                        printf(\"Error Code: %d \\r\\n\", dwError);\n                    }\n                }\n            }\n        }\n\n        CloseHandle(hDisk);\n    }   \n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1573066722, "post_id": 58736528, "comment_id": 103763801, "body": "Please make sure to read how to write good questions.   Stack overflow isn&#39;t here to teach people how to program."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 10276814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad8e8d9f5b29aaf204149bc22f031b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Nerfi", "link": "https://stackoverflow.com/users/10276814/nerfi"}, "edited": false, "score": 0, "creation_date": 1573066041, "post_id": 58736564, "comment_id": 103763490, "body": "What do you mean by &quot;class is not fully defined&quot;?"}, {"owner": {"reputation": 15754, "user_id": 9835872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PN0Lq.jpg?s=128&g=1", "display_name": "ruohola", "link": "https://stackoverflow.com/users/9835872/ruohola"}, "reply_to_user": {"reputation": 91, "user_id": 10276814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad8e8d9f5b29aaf204149bc22f031b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Nerfi", "link": "https://stackoverflow.com/users/10276814/nerfi"}, "edited": false, "score": 0, "creation_date": 1573066236, "post_id": 58736564, "comment_id": 103763582, "body": "@Nerfi Well, the class definition has not ended, since the line declaring <code>next</code> is part of it."}], "tags": [], "owner": {"reputation": 15754, "user_id": 9835872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PN0Lq.jpg?s=128&g=1", "display_name": "ruohola", "link": "https://stackoverflow.com/users/9835872/ruohola"}, "is_accepted": false, "score": 4, "last_activity_date": 1573066515, "last_edit_date": 1573066515, "creation_date": 1573065428, "answer_id": 58736564, "question_id": 58736528, "link": "https://stackoverflow.com/questions/58736528/how-to-declare-a-pointer-within-a-class-definition-to-the-class-being-defined/58736564#58736564", "title": "How to declare a pointer within a class definition to the class being defined?", "body": "<p>This can be used for example in a linked-list  where a Node of the list has to also hold a reference to the next Node in the list.</p>\n\n<pre><code>class Node\n{\npublic:\n    int value;\n    Node* next;\n};\n\nclass LinkedList\n{\npublic:\n    Node head;\n}\n</code></pre>\n\n<p>The reason why the <code>next</code> Node is a pointer here is that the class is not yet fully defined and thus the compiler doesn't know its size. But since pointers have always a fixed size, we can store a <code>Node*</code> as a class member just fine.</p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1573066880, "post_id": 58736581, "comment_id": 103763864, "body": "Future readers: as an intellectual exercise, think on what the effect of changing the rules to allow <code>Car</code> to directly contain <code>Car</code> members would have on the size of the resulting object."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573066955, "post_id": 58736581, "comment_id": 103763892, "body": "@user4581301 you cant change rules of logic :P"}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 3, "last_activity_date": 1573065901, "last_edit_date": 1573065901, "creation_date": 1573065508, "answer_id": 58736581, "question_id": 58736528, "link": "https://stackoverflow.com/questions/58736528/how-to-declare-a-pointer-within-a-class-definition-to-the-class-being-defined/58736581#58736581", "title": "How to declare a pointer within a class definition to the class being defined?", "body": "<pre><code>class Car {\npublic:\n    // ...\n    Car* other;\n};\n</code></pre>\n\n<p>At the moment of declaring the data member <code>other</code>, the <code>Car</code> class is actually an <em>incomplete type</em> (i.e., it is not completely defined). As a result, the compiler doesn't know the size of a <code>Car</code> object yet. However, since this data member <code>other</code> is <strong>a pointer to a <code>Car</code> object</strong> rather than a <code>Car</code> object, the compiler does know the size of <code>other</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 10276814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad8e8d9f5b29aaf204149bc22f031b4f?s=128&d=identicon&r=PG&f=1", "display_name": "Nerfi", "link": "https://stackoverflow.com/users/10276814/nerfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 58736581, "answer_count": 2, "score": 0, "last_activity_date": 1612539376, "creation_date": 1573065264, "last_edit_date": 1612539376, "question_id": 58736528, "link": "https://stackoverflow.com/questions/58736528/how-to-declare-a-pointer-within-a-class-definition-to-the-class-being-defined", "title": "How to declare a pointer within a class definition to the class being defined?", "body": "<p>I am new to C++, and I am learning classes now. I have found this class and wondering how works object created as a pointer in its own class. Can you guys explain it please? Where and how can it be used?</p>\n\n<pre><code>class Car {\npublic:\n    int weight;\n    const char* model;\n    Car* other;\n};\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "vector", "visual-c++"], "comments": [{"owner": {"reputation": 3198, "user_id": 6119582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d37ce6d78ed9281f47a2712aaed48?s=128&d=identicon&r=PG&f=1", "display_name": "sweenish", "link": "https://stackoverflow.com/users/6119582/sweenish"}, "edited": false, "score": 0, "creation_date": 1573065083, "post_id": 58736449, "comment_id": 103763078, "body": "<a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/algorithm/find</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1573065147, "post_id": 58736449, "comment_id": 103763109, "body": "What&#39;s wrong with <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">std::find</a>?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1573065222, "post_id": 58736449, "comment_id": 103763141, "body": "<code>return false;</code> should be outside of the loop."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1573066572, "post_id": 58736449, "comment_id": 103763729, "body": "Additional suggestions: 1) Don&#39;t pass the size, as <code>std::vector</code> already knows it. 2) Pass the vector by <code>const &amp;</code> to avoid making a copy unnecessarily. 3) Pass the string by <code>const &amp;</code> for the same reason. 4) If you use <code>std::find</code> or <code>std::binary_search</code> (must be sorted to use that one), you don&#39;t need a separate function at all."}], "answers": [{"comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1573066349, "post_id": 58736492, "comment_id": 103763632, "body": "Exactly. Also, if the vector happens to be sorted, <a href=\"https://en.cppreference.com/w/cpp/algorithm/binary_search\" rel=\"nofollow noreferrer\"><code>std::binary_search</code></a> would be ideal here, with better complexity."}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 8, "last_activity_date": 1573067035, "last_edit_date": 1573067035, "creation_date": 1573065143, "answer_id": 58736492, "question_id": 58736449, "link": "https://stackoverflow.com/questions/58736449/how-to-find-a-certain-value-in-a-vector-of-strings/58736492#58736492", "title": "How to find a certain value in a vector of strings", "body": "<p>You should use std algorithms whenever possible:</p>\n\n<pre><code>auto result = std::find(restaurantVctr.begin(), restaurantVctr.end(), targetRestnt);\nreturn result != restaurantVctr.end();\n</code></pre>\n\n<p>That is exactly what <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\"><code>std::find</code></a> is for.</p>\n"}, {"comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1573065991, "post_id": 58736655, "comment_id": 103763469, "body": "The <code>break</code> (also present in the OP&#39;s code) is superfluous and unreachable, since the <code>return</code> will exit the function first."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1573066238, "post_id": 58736655, "comment_id": 103763584, "body": "@formerlyknownas_463035818 I don&#39;t think it will cause a problem here because <code>return</code> will always execute before <code>break</code>, but I edited it out, as both of you are right: it is unneeded."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": true, "score": 2, "last_activity_date": 1573066121, "last_edit_date": 1573066121, "creation_date": 1573065874, "answer_id": 58736655, "question_id": 58736449, "link": "https://stackoverflow.com/questions/58736449/how-to-find-a-certain-value-in-a-vector-of-strings/58736655#58736655", "title": "How to find a certain value in a vector of strings", "body": "<p>While I recommend using <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\"><code>std::find</code></a> as others have recommended, if you're curious what is wrong with your code, the problem is your <code>else</code>:</p>\n\n<pre><code>for (i = 0; i &lt; vctrSize; ++i) {\n    if (restaurantVctr.at(i) == targetRestnt) {\n        return true;\n        break;\n    }\n    else {\n        return false;\n    }\n}\n</code></pre>\n\n<p>If the first item in your vector is <strong>not</strong> equal to <code>targetRestnt</code>, then your function <em>returns</em>--that is, it ends execution.</p>\n\n<p>You only want to return false if it's not in the whole list--that is, you want the whole loop to execute:</p>\n\n<pre><code>for (i = 0; i &lt; vctrSize; ++i) {\n    if (restaurantVctr.at(i) == targetRestnt) {\n        return true;\n        // Also, you don't need a break here: you can remove it completely\n        // For now, I just commented it out\n        // break;\n    }\n}\n\n// We didn't find it:\nreturn false;\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12333753, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD1rsHhu8lpW0mVsJ8LqyIOEV_F4WajG9VOy6Vf=k-s128", "display_name": "burningyeti", "link": "https://stackoverflow.com/users/12333753/burningyeti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 58736655, "answer_count": 2, "score": 0, "last_activity_date": 1573067035, "creation_date": 1573064976, "last_edit_date": 1573066437, "question_id": 58736449, "link": "https://stackoverflow.com/questions/58736449/how-to-find-a-certain-value-in-a-vector-of-strings", "title": "How to find a certain value in a vector of strings", "body": "<p>I'm trying to create a program for an assignment that will add and remove strings from a vector of strings, but first I need to create a function that will find whether or not the string already exists in the vector.</p>\n\n<p>I've already tried to use a loop to search through the vector to find a specific desired string at each index. I tried adding a <code>break;</code> to exit if the string was found. I don't know if the function is supposed to be void or boolean.</p>\n\n<pre><code>bool FindString(int vctrSize, vector&lt;string&gt; restaurantVctr, string targetRestnt) {\n    int i;\n\n    for (i = 0; i &lt; vctrSize; ++i) {\n        if (restaurantVctr.at(i) == targetRestnt) {\n            return true;\n            break;\n        }\n        else {\n            return false;\n        }\n    }\n}\n</code></pre>\n\n<p>I expect the output to be true if the string was found, else it would obviously be false.</p>\n\n<p>Edit: I forgot to mention that I also received the warning: \"not all control paths return a value\"</p>\n"}, {"tags": ["c++", "c++14", "clang++", "llvm-clang"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1573064368, "post_id": 58736278, "comment_id": 103762722, "body": "are you pre c++11? If not, why not use <code>nullptr</code>? If yes, better add the appropriate tag"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1573064677, "post_id": 58736278, "comment_id": 103762873, "body": "It is a g++ wart, C++ requires <code>=0</code> here."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1573064818, "post_id": 58736278, "comment_id": 103762950, "body": "Just use <code>nullptr</code> everywhere already. Don&#39;t use<code>__null</code>, <code>0</code> or <code>NULL</code> <i>anywhere</i> - use <i><code>nullptr</code></i> for null pointer constants. But, for declaring a pure vertical function, the syntax is <code>= 0</code> so there, that&#39;s what you <i>have</i> to use."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573064768, "post_id": 58736340, "comment_id": 103762932, "body": "Might need a little rewording; right now the first paragraph appears to contradict with the last paragraph, until you look closer"}, {"owner": {"reputation": 511, "user_id": 4206920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a46313b0205173e3ba5124f15111f57?s=128&d=identicon&r=PG&f=1", "display_name": "Pendyala", "link": "https://stackoverflow.com/users/4206920/pendyala"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573065209, "post_id": 58736340, "comment_id": 103763134, "body": "@Lightness... Thank you... So __null is keyword? Its not macro? where can I see its definition?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1573065602, "post_id": 58736340, "comment_id": 103763289, "body": "It&#39;s not really a keyword, but a compiler internal. You can usually recognise those with the leading double undescore."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 511, "user_id": 4206920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a46313b0205173e3ba5124f15111f57?s=128&d=identicon&r=PG&f=1", "display_name": "Pendyala", "link": "https://stackoverflow.com/users/4206920/pendyala"}, "edited": false, "score": 0, "creation_date": 1573065614, "post_id": 58736340, "comment_id": 103763297, "body": "@Pendyala Apparently <a href=\"https://stackoverflow.com/a/8783589/560648\">it&#39;s an implementation detail</a> (that answer is about GCC but Clang has some similar things), so... neither really. It certainly isn&#39;t standard. I have no idea why you chose to use it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1573065932, "post_id": 58736340, "comment_id": 103763445, "body": "<a href=\"https://stackoverflow.com/questions/228783/what-are-the-rules-about-using-an-underscore-in-a-c-identifier\">By the Holy Laws of C++</a>, anything that contains two underscores in a row is an implementation detail that is not portable and may vanish any time you upgrade your tools. That or it&#39;s a potential programming mistake that can result in very confusing errors or runtime behaviour."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 10, "last_activity_date": 1573065632, "last_edit_date": 1573065632, "creation_date": 1573064495, "answer_id": 58736340, "question_id": 58736278, "link": "https://stackoverflow.com/questions/58736278/does-clang-support-null/58736340#58736340", "title": "Does clang support __null?", "body": "<p>The syntax for pure virtual function is only <code>= 0</code>. For example, <code>virtual void do_stuff() = 0</code> is allowed, but <code>virtual void do_stuff() = nullptr</code> is not allowed.</p>\n\n<p>Clang does support <code>__null</code> but that compiler internal is not meant to declare virtual functions.</p>\n\n<p>The only reason that <code>NULL</code> <em>might</em> work for pure virtual functions is that some system define it as <code>0</code>, but you should not rely on that. Some compiler might also use <code>0LL</code> or <code>(void*)0</code>.</p>\n\n<p>If you can, you should use <code>nullptr</code> instead of <code>NULL</code> for declaring null pointers. This is the best solution and can be emulated in older standards.</p>\n\n<p>For declaring pure virtual functions, use <code>= 0</code>. This is the simplest and the usual way to declare pure virtual functions.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1573065762, "post_id": 58736459, "comment_id": 103763366, "body": "This is a good example of why I think the whole <code>= 0</code> thing is misleading. I realise the timeline&#39;s wrong for it, but a <code>[[pure]]</code> attribute would have been much better. (Or perhaps some other name)"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1573065822, "post_id": 58736459, "comment_id": 103763392, "body": "@LightnessRaceswithMonica I agree. That being said, in the grand scheme of bad C++ design decisions, this hardly deserves a footnote."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573065836, "post_id": 58736459, "comment_id": 103763399, "body": "Indeed that is so!"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 3, "last_activity_date": 1573065000, "creation_date": 1573065000, "answer_id": 58736459, "question_id": 58736278, "link": "https://stackoverflow.com/questions/58736278/does-clang-support-null/58736459#58736459", "title": "Does clang support __null?", "body": "<p>This seems to be some sort of misunderstanding here. Making a virtual function pure is not the same thing as initializing it to a null pointer. In fact, some compilers will set the vtable entry for a pure function to point to a special function called <code>__cxa_pure_virtual</code> or something like that.</p>\n\n<p>Since you are not actually initializing a pointer, you can't use <code>__null</code> here. <a href=\"https://godbolt.org/z/8Bw-D1\" rel=\"nofollow noreferrer\">Not even GCC 4.1 allows it.</a> Nor can you use <code>nullptr</code>, which is the standard replacement for <code>__null</code>. Just write <code>= 0;</code> here.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1573065716, "creation_date": 1573065716, "answer_id": 58736626, "question_id": 58736278, "link": "https://stackoverflow.com/questions/58736278/does-clang-support-null/58736626#58736626", "title": "Does clang support __null?", "body": "<p>What is going on here is:</p>\n\n<ol>\n<li><p>For some reason, you're using a compiler internal (<code>__null</code>) instead of the standard <code>nullptr</code> (at worst, the old <code>NULL</code> was already in the standard and did not need defining by you)</p></li>\n<li><p>For some reason, you're trying to use <code>__null</code> (or <code>NULL</code> (or <code>nullptr</code>)) as a <em>pure virtual function specifier</em>. You can't do that. It's supposed to be <code>= 0</code>. I believe GCC permits, or used to permit, what you're doing as an extension; Clang doesn't.</p></li>\n</ol>\n\n<p>Simple as that really!</p>\n\n<p>Your next steps:</p>\n\n<ol>\n<li>Stop using <code>__null</code> for null pointers; use <code>nullptr</code> instead.</li>\n<li>Stop using null pointers for pure virtual function specifiers. It's <code>= 0</code>.</li>\n</ol>\n"}], "owner": {"reputation": 511, "user_id": 4206920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a46313b0205173e3ba5124f15111f57?s=128&d=identicon&r=PG&f=1", "display_name": "Pendyala", "link": "https://stackoverflow.com/users/4206920/pendyala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1573065716, "creation_date": 1573064240, "last_edit_date": 1573064895, "question_id": 58736278, "link": "https://stackoverflow.com/questions/58736278/does-clang-support-null", "title": "Does clang support __null?", "body": "<p>When I am compiling the following program with clang++ version 5.0, it is resulting in </p>\n\n<blockquote>\n  <p>error: initializer on function does not look like a pure-specifier</p>\n</blockquote>\n\n<pre><code>extern void print(void *ptr);\n\n#define NULL __null\n\nclass IInterface\n{\npublic:\n    virtual void method1() = NULL;\n};\n\n\nint main()\n{\n    void *ptr = NULL;\n    print(ptr);\n    return 0;\n}\n</code></pre>\n\n<p>It seems <code>__null</code> is not supported by clang? But some posts in stackoverflow suggests clang supports <code>__null</code>. If so why am I getting this error. Could somebody suggest whats going on here?</p>\n\n<p>Link: <a href=\"https://godbolt.org/z/-f3Kf9\" rel=\"nofollow noreferrer\">https://godbolt.org/z/-f3Kf9</a></p>\n"}, {"tags": ["c++", "windows", "visual-studio", "c++-standard-library"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1573063930, "post_id": 58736140, "comment_id": 103762521, "body": "This is a limitation being imposed by the Windows operating system, not the C++ language. The filesystem preserves case when you name a file, but treats file lookup as case-insensitive. <a href=\"https://stackoverflow.com/questions/7199039/file-paths-in-windows-environment-not-case-sensitive\" title=\"file paths in windows environment not case sensitive\">stackoverflow.com/questions/7199039/&hellip;</a>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1573064029, "post_id": 58736140, "comment_id": 103762569, "body": "Also, you can change your filesystem to be case sensitive (but at the risk of breaking some applications still using legacy code): <a href=\"https://www.howtogeek.com/354220/how-to-enable-case-sensitive-folders-on-windows-10/\" rel=\"nofollow noreferrer\">howtogeek.com/354220/&hellip;</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1573064344, "post_id": 58736140, "comment_id": 103762711, "body": "<i>I have a file called Time.h in a folder (src)</i> -- The lesson learned is that you shouldn&#39;t name your header files the same as standard ones."}, {"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "edited": false, "score": 0, "creation_date": 1573064392, "post_id": 58736140, "comment_id": 103762735, "body": "To avoid name clashes keep your names different from those of the library."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1573064713, "post_id": 58736140, "comment_id": 103762897, "body": "@jxh It&#39;s per-directory"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573065612, "post_id": 58736140, "comment_id": 103763296, "body": "@LightnessRaceswithMonica: True! But, you can traverse all directories and execute the command with a batch script, I think... <a href=\"https://stackoverflow.com/questions/25691158/recursively-execute-command-in-all-directories-using-windows\" title=\"recursively execute command in all directories using windows\">stackoverflow.com/questions/25691158/&hellip;</a>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1573065869, "post_id": 58736140, "comment_id": 103763416, "body": "@jxh You could, but what I&#39;m saying is that setting this switch on your project directory won&#39;t automatically affect any other applications still using legacy code. You&#39;d have to go out of your way to do that (like in the manner you describe)"}], "answers": [{"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1573064973, "post_id": 58736369, "comment_id": 103763021, "body": "This can byte you in unexpectedly even on Unix if you are running a VM on a Windows host, and using the VM&#39;s file sharing mechanism."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1573065909, "post_id": 58736369, "comment_id": 103763432, "body": "@jxh: Very true!"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1573064602, "creation_date": 1573064602, "answer_id": 58736369, "question_id": 58736140, "link": "https://stackoverflow.com/questions/58736140/problems-with-header-having-the-same-name-but-different-case-as-a-standard-hea/58736369#58736369", "title": "Problems with header having the same name, but different case, as a standard header", "body": "<blockquote>\n  <p>Is this because of Windows' case insensitivity?</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/q/7199039/560648\">Yes</a>.</p>\n\n<blockquote>\n  <p>In that case, how can it be avoided other than making a dedicated directory Time/Time.h?</p>\n</blockquote>\n\n<p>It can't, except by using a directory, or choosing a different name for the file.</p>\n\n<p>Well, <em>technically</em>, <a href=\"https://www.howtogeek.com/354220/how-to-enable-case-sensitive-folders-on-windows-10/\" rel=\"nofollow noreferrer\">you can make NTFS directories case sensitive</a>. However, this seems like a fragile and non-portable solution, and I cannot guarantee that Visual Studio itself will honour it.</p>\n"}], "owner": {"reputation": 77, "user_id": 7391120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XlB4oTZdwt8/AAAAAAAAAAI/AAAAAAAAABE/efzcpSSbvrQ/photo.jpg?sz=128", "display_name": "Tim Roberts", "link": "https://stackoverflow.com/users/7391120/tim-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1573064602, "creation_date": 1573063693, "question_id": 58736140, "link": "https://stackoverflow.com/questions/58736140/problems-with-header-having-the-same-name-but-different-case-as-a-standard-hea", "title": "Problems with header having the same name, but different case, as a standard header", "body": "<p>I have a file called Time.h in a folder (src) that is included in the additional include directories/compiler include paths. Including \"Time.h\" is fine, but when including , Visual Studio seems to get confused and I get upwards to 100 errors before VS stops compilation in all files from filesystem to chrono saying some standard macro is undefined. No error about ambiguity. Is this because of Windows' case insensitivity? In that case, how can it be avoided other than making a dedicated directory Time/Time.h?</p>\n"}, {"tags": ["c++", "qt", "qtwebkit", "qtwebengine", "qtwebapp"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 11374433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-az2sqxDRUXo/AAAAAAAAAAI/AAAAAAAAZ7U/pzzuK6bSFwU/photo.jpg?sz=128", "display_name": "Billal Ouali", "link": "https://stackoverflow.com/users/11374433/billal-ouali"}, "edited": false, "score": 0, "creation_date": 1573658837, "post_id": 58790145, "comment_id": 103954798, "body": "But howw to know witch copiler I&#39;m using since they are all autodetected ( including MSVC 2017 and 2015)? and how can i select the compiler?  I searched in the QT documentation but none of there indications helped me since i staretd to use there IDE only few days ago."}, {"owner": {"reputation": 366, "user_id": 11405014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22caec28175e0f7e001a4eacad0593e9?s=128&d=identicon&r=PG", "display_name": "Allan Jensen", "link": "https://stackoverflow.com/users/11405014/allan-jensen"}, "reply_to_user": {"reputation": 77, "user_id": 11374433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-az2sqxDRUXo/AAAAAAAAAAI/AAAAAAAAZ7U/pzzuK6bSFwU/photo.jpg?sz=128", "display_name": "Billal Ouali", "link": "https://stackoverflow.com/users/11374433/billal-ouali"}, "edited": false, "score": 0, "creation_date": 1574164318, "post_id": 58790145, "comment_id": 104125916, "body": "It depends on what compiler you installed before Qt Creator, or if you have multiple which one you have chosen. You can select which one goes into which kit in the Qt Creator options. Personally I prefer to bulid inside VS command shell, then you just pick the shell from the right VS folder, that has the setup you want."}], "tags": [], "owner": {"reputation": 366, "user_id": 11405014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22caec28175e0f7e001a4eacad0593e9?s=128&d=identicon&r=PG", "display_name": "Allan Jensen", "link": "https://stackoverflow.com/users/11405014/allan-jensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1573400119, "creation_date": 1573400119, "answer_id": 58790145, "question_id": 58736098, "link": "https://stackoverflow.com/questions/58736098/qt-webenginewidgets-troubleshoots/58790145#58790145", "title": "Qt webenginewidgets troubleshoots", "body": "<p>You need to makes sure you are compiling with MSVC 2017 or MSVC 2019. If you configured Qt with an older Windows compiler, QtWebEngine is just going to be skipped. The reason being that Chromium uses C++14, and only the latest version of VS2017 and up supports that.</p>\n\n<p>Edit: For older versions of Qt like 5.9, MSVC 2015 also compiles QtWebEngine, but MSVC 2013 does not.</p>\n"}], "owner": {"reputation": 77, "user_id": 11374433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-az2sqxDRUXo/AAAAAAAAAAI/AAAAAAAAZ7U/pzzuK6bSFwU/photo.jpg?sz=128", "display_name": "Billal Ouali", "link": "https://stackoverflow.com/users/11374433/billal-ouali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573400119, "creation_date": 1573063507, "question_id": 58736098, "link": "https://stackoverflow.com/questions/58736098/qt-webenginewidgets-troubleshoots", "title": "Qt webenginewidgets troubleshoots", "body": "<p>I'm using Qt Creator 4.10.1 in Windows 7 ( Qt version 5.13.1 (MSVC 2017, 32 bit) ). \nI'm triying to make a navigator app for Windows. \nWhen I try to use the \" webenginewidgets \"  in my *.pro file and execute the qmake I have this error \" Unknown module in QT : webenginewidgets \". \nI verrified if the \" Webkit\" is installed in the QT directory, it is. \nsome proposed to use the MSVC 2013 at least. I have MSVC 2015 and 2017 installed and do have a VS 2017 installed in my laptop ( but I see an exclamation point beside it in the Tools/Options/kits/QT versions and a message that this compiler can't produce any code for this QT version\" , only MSVC 2015 32bits and MINGW work correctlly). </p>\n\n<p>my *.pro file: </p>\n\n<pre><code>FORMS += \\\n    mainwindow.ui\n\nHEADERS += \\\n    mainwindow.h\n\nSOURCES += \\\n    main.cpp \\\n    mainwindow.cpp\n\nQT += widgets webenginewidgets\n\nCONFIG += c++11 \n</code></pre>\n\n<p>the error I'm getting \" Unknown module(s) in QT: webenginewidgets \"</p>\n\n<p>here are some images to help you to understand:</p>\n\n<p>MainWindow.cpp \n<a href=\"https://i.stack.imgur.com/iSpLr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iSpLr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Qt versions\n<a href=\"https://i.stack.imgur.com/CazQr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CazQr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/A1F1v.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A1F1v.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Can any one propose a solution or guide me to find one? </p>\n\n<p>Best regards. </p>\n"}, {"tags": ["python", "c++", "windows", "mingw", "cross-platform"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573065263, "post_id": 58736093, "comment_id": 103763160, "body": "Your C++ application uses <code>pipe</code> and <code>fdopen</code>? If so, in Windows you can use <code>CreateProcess</code> and initialize the <code>STARTUPINFO</code> struct with file handles for stdin, stdout and stderr."}, {"owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573071325, "post_id": 58736093, "comment_id": 103765668, "body": "@TedLyngmo actually C++ application uses fdopen() and Python script feeds it with file descriptor number, obtained by os.pipe() call. So stdin/stdout/sterr approach will not work the desired way."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1573071714, "post_id": 58736093, "comment_id": 103765834, "body": "Ah... assuming the python side is ok, would the Windows <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/fdopen-wfdopen?view=vs-2019\" rel=\"nofollow noreferrer\">_fdopen</a> work? Or, you don&#39;t even get access to the file descriptor?"}, {"owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1573487981, "post_id": 58736093, "comment_id": 103889223, "body": "TedLyngmo: I receive fd = 3 from the Python, and attempt to open it fails with EBADF.  @ErykSun thanks for the details! We use Python 2.7."}, {"owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1573582266, "post_id": 58736093, "comment_id": 103925500, "body": "@ErykSun thanks again. Got a direction to search for explanation and got over this, which tells a lot: <a href=\"https://bugs.python.org/issue32865\" rel=\"nofollow noreferrer\">bugs.python.org/issue32865</a>"}, {"owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1573849176, "post_id": 58736093, "comment_id": 104035446, "body": "@ErykSun Thanks again! Actually your comment should be transferred to answer. However, I managed to make this to work in sample C code (just to make sure I&#39;m not missing anything), while still struggling with Python implementation."}], "answers": [{"comments": [{"owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "edited": false, "score": 0, "creation_date": 1574068946, "post_id": 58887663, "comment_id": 104084729, "body": "Managed code to work using this approach. Additional part of problem was Python, compiled with MSYS/MinGW - it didn&#39;t work at all, while Windows Python installation worked well. lpReserved2 of MSYS/MinGW version had different data."}], "tags": [], "owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "is_accepted": true, "score": 1, "last_activity_date": 1573879579, "creation_date": 1573879579, "answer_id": 58887663, "question_id": 58736093, "link": "https://stackoverflow.com/questions/58736093/use-pipe-and-fdopen-to-pass-data-from-python-script-to-c-application-in-wi/58887663#58887663", "title": "Use pipe() and fdopen() to pass data from Python script to C++ application in Windows", "body": "<p>In Windows, C file descriptors are inherited in the process <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfow\" rel=\"nofollow noreferrer\"><code>STARTUPINFO</code></a> record in the reserved fields <code>cbReserved2</code> and <code>lpReserved2</code>. The protocol is undocumented, but the source is distributed with Visual C++. C functions that use this feature include the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/spawn-wspawn-functions?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_[w]spawn</code></a> family of functions and <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/system-wsystem?view=vs-2019\" rel=\"nofollow noreferrer\"><code>[_w]system</code></a>. (The <code>[_w]system</code> function, however, is not generally useful in this regard because only the immediate cmd.exe process inherits the parent's file descriptors. CMD does not pass them on to child processes.)</p>\n\n<p>In Python 2.7, <code>os.pipe</code> is implemented by calling <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/namedpipeapi/nf-namedpipeapi-createpipe\" rel=\"nofollow noreferrer\"><code>CreatePipe</code></a>, which returns non-inheritable file handles for the read and write ends of the pipe. These handles are then manually wrapped with inheritable file descriptors via <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/open-osfhandle?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_open_osfhandle</code></a>, but the underlying OS handle is still non-inheritable. To work around this, duplicate the file descriptor via <code>os.dup</code>, which internally duplicates an inheritable file handle, and then close the source file descriptor. For example: </p>\n\n<pre><code>pread, pwrite = os.pipe()\npwrite_child = os.dup(pwrite)\nos.close(pwrite)\n</code></pre>\n\n<p>Python's <code>subprocess</code> module is usually the preferred way to create a child process. However, we can't use <code>subprocess</code> in this case because it doesn't support inheriting file descriptors via <code>STARTUPINFO</code> (*). Here's an example that uses <a href=\"https://docs.python.org/2.7/library/os.html#os.spawnv\" rel=\"nofollow noreferrer\"><code>os.spawnv</code></a> instead:</p>\n\n<pre><code>rc = os.spawnv(os.P_WAIT, 'path/to/spam.exe', ['spam', 'arg1', 'arg2'])\n</code></pre>\n\n<hr>\n\n<p>(*) It's an awkward situation that Windows Python internally uses the C runtime file API (e.g. <code>_wopen</code>, <code>_read</code>, <code>_write</code>), but in places fails to support C file descriptors. It should bite the bullet and use the Windows file API directly with OS file handles, then it would at least be consistent.</p>\n"}], "owner": {"reputation": 12296, "user_id": 452752, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a68d17cbd12e477e4a67745bd5b2452b?s=128&d=identicon&r=PG", "display_name": "Nickolay Olshevsky", "link": "https://stackoverflow.com/users/452752/nickolay-olshevsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 58887663, "answer_count": 1, "score": 1, "last_activity_date": 1573879579, "creation_date": 1573063477, "question_id": 58736093, "link": "https://stackoverflow.com/questions/58736093/use-pipe-and-fdopen-to-pass-data-from-python-script-to-c-application-in-wi", "title": "Use pipe() and fdopen() to pass data from Python script to C++ application in Windows", "body": "<p>We have some Linux/macOS application, which can communicate with outer world by passing file descriptor and reading data from it. Usually this is done to pass stdin/stdout descriptors, however we use pipe() and this works pretty well. Except MinGW/Windows.\nWhat would be the recommended way of doing the same job under the Windows? Pass the whole file handle, or there are good ways to simulate small-int-like descriptor?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1573064112, "post_id": 58735985, "comment_id": 103762600, "body": "A simple example -- <code>std::copy</code>.  What if the types to <code>std::copy</code> are &quot;simple&quot;, like an array of <code>int</code> or <code>char</code>?   You would use <code>memcpy</code>, right?  So how do you say &quot;If the type is simple, use memcpy, else use a &quot;slow&quot; loop&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 9160496, "user_type": "registered", "profile_image": "https://graph.facebook.com/187739654983698/picture?type=large", "display_name": "Rami Yen", "link": "https://stackoverflow.com/users/9160496/rami-yen"}, "edited": false, "score": 0, "creation_date": 1573063883, "post_id": 58736017, "comment_id": 103762496, "body": "So you mean for example I can use them to disable some instances of templates for specific type for example it is logical to disable a templated-function <code>Power&lt;T&gt;</code> or class when the argument type is not integral let&#39;s say std::string?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 165, "user_id": 9160496, "user_type": "registered", "profile_image": "https://graph.facebook.com/187739654983698/picture?type=large", "display_name": "Rami Yen", "link": "https://stackoverflow.com/users/9160496/rami-yen"}, "edited": false, "score": 1, "creation_date": 1573063948, "post_id": 58736017, "comment_id": 103762531, "body": "@RamiYen, Yes, that&#39;s referred to as <a href=\"https://en.cppreference.com/w/cpp/language/sfinae\" rel=\"nofollow noreferrer\">SFINAE</a>."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 17, "last_activity_date": 1573063111, "creation_date": 1573063111, "answer_id": 58736017, "question_id": 58735985, "link": "https://stackoverflow.com/questions/58735985/what-is-the-point-in-knowing-whether-an-object-is-an-integral-or-not-or-is-a-cla/58736017#58736017", "title": "What is the point in knowing whether an object is an integral or not or is a class type or not?", "body": "<p>It's not for writing to the console, that's for sure.</p>\n\n<p>More broadly you're asking: <em>what is the point of type traits?</em></p>\n\n<p>The answer is <em>template metaprogramming</em>. For example, I can create a template specialisation that does one thing for integral types, and another for non-integral types.</p>\n\n<p>Aaron Bullman has <a href=\"http://blog.aaronballman.com/2011/11/a-simple-introduction-to-type-traits/\" rel=\"noreferrer\">a simple introduction to type traits</a>, as does Jacek <a href=\"https://blog.galowicz.de/2016/02/18/what_is_a_type_trait/\" rel=\"noreferrer\">here</a>.</p>\n\n<p>In my opinion, <em>most</em> use of these things will be found buried within implementations of cool features and classes and utilities (i.e. in libraries) as part of the background machinery that makes it all work.</p>\n\n<p>Further reading:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/20734727/560648\">C++ Type Traits</a></li>\n<li><a href=\"https://stackoverflow.com/q/3979766/560648\">How do traits classes work and what do they do?</a></li>\n</ul>\n\n<p>rightfold's answer on that first one gives a superb example of when traits are useful:</p>\n\n<blockquote>\n  <p>For example, an implementation of <code>std::copy</code> may use <code>std::memcpy</code> internally instead of an explicit loop when the iterators are pointers to PODs. This can be achieved with SFINAE.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "is_accepted": false, "score": 7, "last_activity_date": 1573064607, "last_edit_date": 1573064607, "creation_date": 1573063280, "answer_id": 58736050, "question_id": 58735985, "link": "https://stackoverflow.com/questions/58735985/what-is-the-point-in-knowing-whether-an-object-is-an-integral-or-not-or-is-a-cla/58736050#58736050", "title": "What is the point in knowing whether an object is an integral or not or is a class type or not?", "body": "<p>It's for template meta programming.  When you have no idea what type(s) the end-user will pass into the template.  Sometimes it's to report errors, sometimes it's to specialise on the types passed.  Sometimes it's a combination.</p>\n\n<p>The examples seen on cppreference.com (eg <a href=\"https://en.cppreference.com/w/cpp/types/is_enum\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/types/is_enum</a> ) are very much over simplified and just show how to use the trait in a non-typical manner.  You would almost never use these traits directly in a simple (non-template function or class).</p>\n"}], "owner": {"reputation": 165, "user_id": 9160496, "user_type": "registered", "profile_image": "https://graph.facebook.com/187739654983698/picture?type=large", "display_name": "Rami Yen", "link": "https://stackoverflow.com/users/9160496/rami-yen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 7, "accepted_answer_id": 58736017, "answer_count": 2, "score": 9, "last_activity_date": 1573104325, "creation_date": 1573062958, "last_edit_date": 1573104325, "question_id": 58735985, "link": "https://stackoverflow.com/questions/58735985/what-is-the-point-in-knowing-whether-an-object-is-an-integral-or-not-or-is-a-cla", "title": "What is the point in knowing whether an object is an integral or not or is a class type or not?", "body": "<p>Hello I've seen many examples like this in Cppreference.com: </p>\n\n<pre><code>std::is_class&lt;T&gt;\nstd::is_integral\n</code></pre>\n\n<p>And so on. I know if I run the code for example I get <code>true</code> or <code>false</code>. But what is the point in that? e.g knowing the object is of class type or not?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\nstruct A {};\nclass B {};\nenum class C {};\n\nint main()\n{\n    std::cout &lt;&lt; std::boolalpha;\n    std::cout &lt;&lt; std::is_class&lt;A&gt;::value &lt;&lt; '\\n';\n    std::cout &lt;&lt; std::is_class&lt;B&gt;::value &lt;&lt; '\\n';\n    std::cout &lt;&lt; std::is_class&lt;C&gt;::value &lt;&lt; '\\n';\n    std::cout &lt;&lt; std::is_class&lt;int&gt;::value &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>true\ntrue\nfalse\nfalse\n</code></pre>\n\n<ul>\n<li><p>I've searched all over for a real example using this (<code>is_class</code>, <code>is_integral</code>, <code>is_arithmetic</code>, ...) But all the tutorials show only the hopeless example: only <code>true</code> or <code>false</code>.</p></li>\n<li><p>Could anyone help me with a small useful example using this templates?</p></li>\n</ul>\n"}, {"tags": ["c++", "function", "struct", "return-type"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 2, "creation_date": 1573062646, "post_id": 58735809, "comment_id": 103761936, "body": "How would you declare a function returning a int? And now how would you declare the same function but returning another type such as a struct?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1573062790, "post_id": 58735809, "comment_id": 103762005, "body": "I recommend this: <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/388242/&hellip;</a>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573064139, "post_id": 58735809, "comment_id": 103762613, "body": "structs are not functions"}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 3, "last_activity_date": 1573063089, "creation_date": 1573063089, "answer_id": 58736015, "question_id": 58735809, "link": "https://stackoverflow.com/questions/58735809/how-to-return-a-struct-from-a-function/58736015#58736015", "title": "How to return a struct from a function", "body": "<p>The type that you have defined with <code>struct</code> is not <code>struct</code> but <code>dough</code>.  </p>\n\n<p>So if you are use to work with <code>int</code>, but want to work with your new structure instead, just replace <code>int</code> with <code>dough</code>:   </p>\n\n<pre><code>dough delQ(Queue &amp;Q)  {\n    dough retval;   // I don't know how you initialize your struct\n    ....\n    return retval;  \n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12333579, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCBc2ggds5uwTHTFVu19HIhKVoxsv2nkfMv2biq=k-s128", "display_name": "Said M Firdaus", "link": "https://stackoverflow.com/users/12333579/said-m-firdaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58736015, "answer_count": 1, "score": -1, "last_activity_date": 1573064485, "creation_date": 1573062221, "last_edit_date": 1573064485, "question_id": 58735809, "link": "https://stackoverflow.com/questions/58735809/how-to-return-a-struct-from-a-function", "title": "How to return a struct from a function", "body": "<p>I'm learning c++ and my project is about queues. </p>\n\n<p>I have :</p>\n\n<pre><code>struct dough {\n    string code;\n    int stirringTime;\n};\n</code></pre>\n\n<p>Usually in my tasks, we use <code>int</code> and not <code>struct</code>. That is why I have problems with my delete function:</p>\n\n<p>Using int :</p>\n\n<pre><code>int delQ(Queue &amp;Q) // =&gt; return int\n</code></pre>\n\n<p>If I make: </p>\n\n<pre><code>struct delQ(Queue &amp;Q) // =&gt; what do i return?\n</code></pre>\n"}, {"tags": ["c++", "file", "fstream"], "answers": [{"tags": [], "owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "is_accepted": true, "score": 1, "last_activity_date": 1573064666, "creation_date": 1573064666, "answer_id": 58736384, "question_id": 58735757, "link": "https://stackoverflow.com/questions/58735757/fstream-library-trying-to-create-a-file-with-variable-name-c/58736384#58736384", "title": "fstream library, trying to create a file with variable name (c++)", "body": "<p>In this statement: </p>\n\n<pre><code>output(nombre.c_str());\n</code></pre>\n\n<p>The compiler thinks that <code>output</code> is a \"callable\" but std::fstream didn't overload call operator. So you get compile-time error.</p>\n\n<p>To fix it; you either call the member <code>open</code>:</p>\n\n<pre><code>    output.open(nomber); // directly because the new standard allows strings for fstream::open\n</code></pre>\n\n<p>or when initializing <code>output</code>:</p>\n\n<pre><code>std::ofstream output(nombere); // (contructor of ofstream that takes std::string) or \nstd::ofstream output(nombere.c_str()); // ctor that takes const char*\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11924720, "user_type": "registered", "profile_image": "https://graph.facebook.com/2264905740274513/picture?type=large", "display_name": "Kael Thas Sunstrider", "link": "https://stackoverflow.com/users/11924720/kael-thas-sunstrider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58736384, "answer_count": 1, "score": 1, "last_activity_date": 1573066981, "creation_date": 1573062035, "question_id": 58735757, "link": "https://stackoverflow.com/questions/58735757/fstream-library-trying-to-create-a-file-with-variable-name-c", "title": "fstream library, trying to create a file with variable name (c++)", "body": "<p>i am trying to create a file whose name is tied to a string type variable, however when i try to run it, i get this error --[Error] no match for call to '(std::ofstream {aka std::basic_ofstream}) (const char*)'</p>\n\n<p>Here is the code:</p>\n\n<pre><code>void Crear()\n{   \n    string nombre;\n    ofstream output;\n    ifstream input;\n\n    cout &lt;&lt; \"Deme el nombre de su archivo: \";\n    cin.ignore();\n    getline(cin, nombre);\n\n    //this is where the error happens\n    output(nombre.c_str());\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "variadic"], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 3, "last_activity_date": 1588176240, "last_edit_date": 1588176240, "creation_date": 1573062414, "answer_id": 58735860, "question_id": 58735753, "link": "https://stackoverflow.com/questions/58735753/variadic-template-recursive-constructor-problems/58735860#58735860", "title": "Variadic template recursive constructor problems", "body": "<p>You have also to inherit from <code>Tuple&lt;T2...&gt;</code></p>\n\n<pre><code>template &lt;class T, class... T2&gt;\nstruct Tuple : public Tuple&lt;T2...&gt;\n</code></pre>\n\n<p>and initialize the inherited class in the initialization list (before <code>value</code>) [caution code not tested]</p>\n\n<pre><code>   Tuple(T n, T2... re) : Tuple&lt;T2...&gt;{re...}, value{n}\n    { }\n</code></pre>\n\n<p>You also need a ground case specialization to stop the recursion</p>\n\n<p>Something as</p>\n\n<pre><code>template &lt;class T&gt;\nstruct Tuple&lt;T&gt;\n {\n   T value;\n\n   Tuple (T n) : value{n}\n    { }\n }; \n</code></pre>\n\n<p>or also (maybe simpler)</p>\n\n<pre><code>template &lt;&gt;\nstruct Tuple&lt;&gt;\n { }; \n</code></pre>\n\n<p>But for this second solution, you have to define <code>Tuple</code> as receiving zero or more types; maybe something as follows</p>\n\n<pre><code>template &lt;typename...&gt;\nstruct Tuple\n { };\n\ntemplate &lt;class T, class... T2&gt;\nstruct Tuple&lt;T, T2...&gt; : public Tuple&lt;T2...&gt;\n {\n   // ...\n };\n</code></pre>\n\n<p>This way, when <code>Tuple</code> receive at least one type, the specialization is selected; when receive zero type, only the main version match and serve as ground case.</p>\n"}], "owner": {"reputation": 13, "user_id": 12333531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XX163TMqx5M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rff5VoYJofbeNsFZ4-AewNS1CwE8A/photo.jpg?sz=128", "display_name": "Brian Martin", "link": "https://stackoverflow.com/users/12333531/brian-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 58735860, "answer_count": 1, "score": 1, "last_activity_date": 1588176240, "creation_date": 1573062020, "last_edit_date": 1573062501, "question_id": 58735753, "link": "https://stackoverflow.com/questions/58735753/variadic-template-recursive-constructor-problems", "title": "Variadic template recursive constructor problems", "body": "<p>i try to understand the use of recursive constructors with variadic templates. </p>\n\n<p>In the following code i want to implement a recursive constructor with variadic passed values.</p>\n\n<pre><code>template &lt;class T, class... T2&gt;\n    struct Tuple{\n        T value;\n\n        Tuple(T n){                    //constructor if only one value left\n           value = n;\n        }\n\n        Tuple(T n, T2... re){          //constructor if more than one value left\n            T value = n;\n            //Tuple(rest...);          doesnt work for me\n        }\n    }; \n\nint main(){\n    Tuple&lt;int, float, int&gt; t(2, 1.2, 9);\n\n    std::cout &lt;&lt; t.value &lt;&lt; \"\\n\";                   //2\n    std::cout &lt;&lt; t.rest.value &lt;&lt; \"\\n\";              //1.2\n    std::cout &lt;&lt; t.rest.rest.value &lt;&lt; \"\\n\";         //9\n}\n</code></pre>\n"}, {"tags": ["c++", "ide"], "comments": [{"owner": {"reputation": 1617, "user_id": 6864265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01bd0f9716eca1ad35cf30c47ae8f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Itachi Uchiwa", "link": "https://stackoverflow.com/users/6864265/itachi-uchiwa"}, "edited": false, "score": 9, "creation_date": 1573061784, "post_id": 58735652, "comment_id": 103761559, "body": "Possibly clean the project and rebuild otherwise clean and restart MSVC."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1573062293, "post_id": 58735652, "comment_id": 103761793, "body": "Also look at the date &amp; time on the generated executable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 2, "creation_date": 1573062637, "post_id": 58735652, "comment_id": 103761932, "body": "If you want to really test that changes aren&#39;t getting implemented: put some syntactically <i>incorrect</i> program on purpose. If the compiler is truly compiling your code, you will get an error."}], "owner": {"reputation": 11, "user_id": 12333532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f8926e1e8ce31bea8ba4a6ce67e2c79?s=128&d=identicon&r=PG&f=1", "display_name": "kornrolls7", "link": "https://stackoverflow.com/users/12333532/kornrolls7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1573062514, "creation_date": 1573061586, "last_edit_date": 1573062514, "question_id": 58735652, "link": "https://stackoverflow.com/questions/58735652/code-compiling-but-output-is-previous-code-version", "title": "Code compiling but output is previous code version?", "body": "<p>I am working with Visual Studio IDE. The code will compile with no errors. However any changes I made will not be reflected in the latest build.</p>\n\n<p>I compiled with gcc and the changes were reflected in the build. However when I restart Visual Studio it still builds a previous version</p>\n\n<p>for example if I change the code to read:\ncout &lt;&lt; \"PLACEHOLDER syntactically correct program\" &lt;&lt; endl;</p>\n\n<p>It will still output the previous build:\n\"syntactically correct program\"</p>\n\n<p>EDIT: updating Visual Studio seemed to do the trick</p>\n"}, {"tags": ["c++", "c", "unions", "porting"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573061614, "post_id": 58735640, "comment_id": 103761465, "body": "C and C++ are two very different languages. Unions is one area where they differ a lot."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 4, "creation_date": 1573061714, "post_id": 58735640, "comment_id": 103761523, "body": "And type punning that way would be UB in C++"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573061834, "post_id": 58735640, "comment_id": 103761585, "body": "C and C++ are different languages.  It&#39;s useful to get into the habit that what works in one is not guaranteed to work in the other.  This only gets more true and time goes on and the languages diverge even more.  Pretend you are working with Python and Java instead and attack the problem from the different languages idioms."}], "answers": [{"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1573064289, "post_id": 58736032, "comment_id": 103762675, "body": "Writing to one union member and reading from another is UB in C++. Also,  <code>--std=c++14</code> can&#39;t be right? It looks like C++20. Edit: <a href=\"https://godbolt.org/z/hgfQjt\" rel=\"nofollow noreferrer\">godbolt.org/z/hgfQjt</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1573065270, "post_id": 58736032, "comment_id": 103763163, "body": "Compiles != valid."}, {"owner": {"reputation": 88, "user_id": 4868875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ76T.jpg?s=128&g=1", "display_name": "Berthin", "link": "https://stackoverflow.com/users/4868875/berthin"}, "edited": false, "score": 0, "creation_date": 1573115366, "post_id": 58736032, "comment_id": 103778335, "body": "@bodo Thanks for pointing out the initialization order! It compiles with no errors in my pc when I tested :). I am accepting Christophe&#39;s answer since he elaborates a little bit more though."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": -2, "last_activity_date": 1573116227, "last_edit_date": 1573116227, "creation_date": 1573063176, "answer_id": 58736032, "question_id": 58735640, "link": "https://stackoverflow.com/questions/58735640/initialize-union-with-nested-structs/58736032#58736032", "title": "Initialize union with nested structs", "body": "<p>This works in C and C++:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef union Word_t\n{\n    uint32_t word32Bits;\n    struct\n    {\n        uint16_t leastSignificant16Bits;\n        uint16_t mostSignificant16Bits;\n    } _word16Bits;\n} Word_t;\n\nint main()\n{\n    Word_t w1 = {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    Word_t w2 = {._word16Bits={.leastSignificant16Bits = 0xABCD, .mostSignificant16Bits = 0x1234}};\n    printf(\"%x\\n\", w2.word32Bits);\n\n    return 0;\n}\n</code></pre>\n\n<p>Edit: <code>--std=c++2a</code> instead of <code>--std=c++14</code> is needed for designated initializers.</p>\n\n<pre><code>$ g++ -Wall -Wextra test.c --std=c++2a -pedantic -pedantic-errors -o a &amp;&amp; ./a\n1234abcd\n1234abcd\n$ gcc -Wall -Wextra test.c -pedantic -pedantic-errors -o a &amp;&amp; ./a\n1234abcd\n1234abcd\n</code></pre>\n\n<p>Note: In C++ you have to specify the tagged initializers in the same order as in the structure declaration.</p>\n\n<p>As mentioned in Ted Lyngmo's comment, writing to one union member and reading from another is undefined behavior in C++.</p>\n\n<p>In any case using a union to extract shorter parts from a longer data type or combine them is implementation-dependent. On a big-endian system, the order of <code>leastSignificant16Bits</code> and <code>mostSignificant16Bits</code> would be reversed.</p>\n"}, {"comments": [{"owner": {"reputation": 88, "user_id": 4868875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ76T.jpg?s=128&g=1", "display_name": "Berthin", "link": "https://stackoverflow.com/users/4868875/berthin"}, "edited": false, "score": 0, "creation_date": 1573115516, "post_id": 58737734, "comment_id": 103778394, "body": "Thanks for the detailed explanation!"}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 3, "last_activity_date": 1573073294, "last_edit_date": 1573073294, "creation_date": 1573070770, "answer_id": 58737734, "question_id": 58735640, "link": "https://stackoverflow.com/questions/58735640/initialize-union-with-nested-structs/58737734#58737734", "title": "Initialize union with nested structs", "body": "<h2>Syntactic issues</h2>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/aggregate_initialization\" rel=\"nofollow noreferrer\">Designated initializers</a> in aggregate initialization are formally part of the <a href=\"https://stackoverflow.com/a/29337570/3723423\">C++20 standard</a>. </p>\n\n<p>They come however with serious constraints compared to C99: </p>\n\n<ul>\n<li>They have to appear in the same order than the declaration;</li>\n<li>All the designated elements must be direct members of the aggregate;</li>\n<li>Nesting is possible only if initializer are nested</li>\n</ul>\n\n<p>In your case, the following would compile, but it would fail to provide the flexibility benefits that you expect from the explicit naming : </p>\n\n<pre><code>Word_t w2 = (Word_t) {._word16Bits  { .leastSignificant16Bits = 0xABCD, .mostSignificant16Bits = 0x1234} };\n</code></pre>\n\n<h2>More serious issues</h2>\n\n<p>First, this code, if it would work, is not portable: it assumes <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">little endianness</a> of the target architecture. </p>\n\n<p>Second, and this is crucial here, C++ has strong constraints on unions.  These are necessary in view of the consistency of the object lifecycle. In particular:  </p>\n\n<blockquote>\n  <p><strong>[class.union]/1</strong>: In a union, at most one of the non-static data members can be active at any time, that is, the value of at most one\n  of the non-static data members can be stored in a union at any time.</p>\n</blockquote>\n\n<p>So if you construct the union with one member active (the one used in your initializer), the other member is not active and you should not access it.  The only exception foreseen is not applicable to your case:  </p>\n\n<blockquote>\n  <p>[ Note: One special guarantee is made in order to simplify the use of\n  unions: If a standard-layout union contains several standard-layout\n  structs that share a common initial sequence, and if an object\n  of this standard-layout union type contains one of the standard-layout\n  structs, <strong>it is permitted to inspect</strong> the common initial sequence of any\n  of standard-layout struct members; \u2014 end note ]</p>\n</blockquote>\n\n<p>The standard also give hints about the way to change the active member of the union: </p>\n\n<blockquote>\n  <p>[ Note: In general, one must use explicit destructor calls and\n  placement new operators to change the active member of a union. \u2014 end\n  note ]</p>\n</blockquote>\n\n<p>This being said for simple scalar types, it may compile and work as you expect on most of the mainstream compilers. </p>\n\n<p>But the point is, that <strong>the usage you make of unions is incompatible with the standard</strong>.  It's UB, and even if it works on some implementations now, at every new compiler release, you'll have no guarantee that it will continue to work, putting all your investments at risks.</p>\n\n<h2>Why it is time to change approach ?</h2>\n\n<p>The C99 has less constraints on unions as C++.  But it gives no firm guarantee either about the value that might be read in one union member when another union member was set:  </p>\n\n<blockquote>\n  <p><strong>6.2.6.1/7</strong>: When a value is stored in a member of an object of union type, the bytes of the object representation that do not\n  correspond to that member but do correspond to other members take\n  unspecified values.</p>\n</blockquote>\n\n<p>It is mentioned in annex C99/J that this usage of unions is an unspecified behavior that can create portability issues.  </p>\n"}], "owner": {"reputation": 88, "user_id": 4868875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ76T.jpg?s=128&g=1", "display_name": "Berthin", "link": "https://stackoverflow.com/users/4868875/berthin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 58737734, "answer_count": 2, "score": 2, "last_activity_date": 1573918416, "creation_date": 1573061522, "last_edit_date": 1573918416, "question_id": 58735640, "link": "https://stackoverflow.com/questions/58735640/initialize-union-with-nested-structs", "title": "Initialize union with nested structs", "body": "<p>I am porting C99 code to C++(14 or 17), and in many places the list initializer is used. Now I am getting compilation errors and would like to know the simplest way to initalize a union nested by a struct. For instance, the following snippet in C works just fine:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ntypedef union Word_t\n{\n    uint32_t word32Bits;\n    struct\n    {\n        uint16_t leastSignificant16Bits;\n        uint16_t mostSignificant16Bits;\n    };\n} Word_t;\n\nint main()\n{\n    Word_t w1 = (Word_t) {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n    printf(\"%x\\n\", w2.word32Bits);\n\n    return 0;\n}\n\n\n</code></pre>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gcc test.c --std=c99 -o a &amp;&amp; ./a\n1234abcd\n1234abcd\n</code></pre>\n\n<p>However, in C++ it does not compile:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ntypedef union Word_t\n{\n    uint32_t word32Bits;\n    struct\n    {\n        uint16_t leastSignificant16Bits;\n        uint16_t mostSignificant16Bits;\n    } _word16Bits;\n} Word_t;\n\nint main()\n{\n    Word_t w1 = (Word_t) {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n    printf(\"%x\\n\", w2.word32Bits);\n\n    return 0;\n}\n\n\n```bash\n$ g++ test.c --std=c++14 -o a &amp;&amp; ./a\ntest.c: In function \u2018int main()\u2019:\ntest.c:57:92: error: \u2018Word_t\u2019 has no non-static data member named \u2018mostSignificant16Bits\u2019\n     Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n</code></pre>\n\n<p>The work-araound solution I found is to zero-initalize and then set the internal values of the struct as following:</p>\n\n<pre><code>\nint main()\n{\n    Word_t w1 = (Word_t) {.word32Bits = 0x1234ABCD};\n    printf(\"%x\\n\", w1.word32Bits);\n\n    <del>Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD};\n</del>\n\n    Word_t w2 = {0};\n    w2._word16Bits = {0x1234, 0xABCD};\n\n    return 0;\n}\n</code></pre>\n\n<p>Which works, but it doesn't allow me to explicitly say <code>.mostSignificant16Bits = 0x1234</code> for instance -- which I think is kind of useful, specially when reading the code.</p>\n\n<p>I tried couple of things like defining static members, creating a user-defined constructor, but still no idea how to simplify the refactor that I am going to do. Ideally, I would like to leave the variable declaration as how it is <code>Word_t w2 = (Word_t) {.mostSignificant16Bits = 0x1234, .leastSignificant16Bits = 0xABCD}</code> while all the changes are done in the definition of <code>Word_t</code>.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1573061603, "post_id": 58735618, "comment_id": 103761459, "body": "You will find a full explanation of everything <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">in your C++ book</a>. C++ is the most complicated general purpose programming language in use today. There are multiple fundamental problems with the shown code, beyond the one compilation error you&#39;re asking about. Trying to slap together something that might look like valid C++ grammar, and expecting it to work, has very little chances of a successful result. The only practical way to learn C++ is with a good book."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 1, "creation_date": 1573061699, "post_id": 58735618, "comment_id": 103761511, "body": "<code>enum object {rock, paper, scissors}</code> seems to be missing a <code>;</code>. Not 100% sure <code>enum</code>s need <code>;</code>s after it, but could be it."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573061713, "post_id": 58735618, "comment_id": 103761521, "body": "You&#39;re also missing a closing parenthesis in the second and third <code>if</code>."}, {"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1573061716, "post_id": 58735618, "comment_id": 103761524, "body": "@Algirdas.  It is the enum just below the main."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1573061755, "post_id": 58735618, "comment_id": 103761547, "body": "And unrelated to your current problem, but remember the difference between comparison for equality with <code>==</code> and assignment with <code>=</code>."}, {"owner": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 1, "creation_date": 1573061763, "post_id": 58735618, "comment_id": 103761548, "body": "This is a duplicate with <a href=\"https://stackoverflow.com/questions/10371681/enum-type-can-not-accept-cin-command\" title=\"enum type can not accept cin command\">stackoverflow.com/questions/10371681/&hellip;</a>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1573061805, "post_id": 58735618, "comment_id": 103761573, "body": "@EvilTeach Thank you. Somehow, I missed that :/"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1573061876, "post_id": 58735618, "comment_id": 103761617, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/10371681/enum-type-can-not-accept-cin-command\">enum type can not accept cin command</a>"}], "answers": [{"comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 5, "creation_date": 1573061825, "post_id": 58735673, "comment_id": 103761580, "body": "That may be true, but that has absolutely nothing to do, whatsoever, with the compilation error that&#39;s being asked about. The question is full of typos, and has major fundamental problems beyond this one. This one is probably due to a typo or a transcription error, and is the least of the problems here."}, {"owner": {"reputation": 663, "user_id": 7483509, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-rLN-a5QG95Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reidV1ZIp-ccT7ykiC9GJpJ54O-4A/mo/photo.jpg?sz=128", "display_name": "Nick Skywalker", "link": "https://stackoverflow.com/users/7483509/nick-skywalker"}, "edited": false, "score": 1, "creation_date": 1573061873, "post_id": 58735673, "comment_id": 103761614, "body": "Apart from that there is also the missing fact that the <code>cin</code> operator <code>&gt;&gt;</code> is not defined for custom defined type <code>enum object</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573062179, "post_id": 58735673, "comment_id": 103761743, "body": "@SamVarshavchik There are lots of errors in the code the OP posted, but the one the OP is asking about is most certainly caused by this. Putting it in a compiler and applying this fix will fix <i>this</i> error. Though the OP is about to get blasted with a few more errors."}, {"owner": {"reputation": 273, "user_id": 3962706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2a889bb27ced6b83a5d27d4c2ff3b28?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/3962706/developer"}, "edited": false, "score": 0, "creation_date": 1573065110, "post_id": 58735673, "comment_id": 103763096, "body": "@hipster Thanks for replying."}], "tags": [], "owner": {"reputation": 51, "user_id": 9370865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pgL4X.png?s=128&g=1", "display_name": "Abdessamad El Kasimi", "link": "https://stackoverflow.com/users/9370865/abdessamad-el-kasimi"}, "is_accepted": false, "score": 3, "last_activity_date": 1573061753, "last_edit_date": 1573061753, "creation_date": 1573061676, "answer_id": 58735673, "question_id": 58735618, "link": "https://stackoverflow.com/questions/58735618/problem-with-rock-paper-scissors-c-code/58735673#58735673", "title": "Problem with &quot;Rock, paper, scissors&quot; C++ code", "body": "<pre><code>enum object {rock, paper, scissors}\n</code></pre>\n\n<p>is missing a semicolon (;)</p>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 3962706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2a889bb27ced6b83a5d27d4c2ff3b28?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/3962706/developer"}, "edited": false, "score": 1, "creation_date": 1573488501, "post_id": 58737161, "comment_id": 103889487, "body": "Thank you so much for your detailed response! I had not noticed the error in the previous answer. I think cout &lt;&lt; &quot;Enter two objetcs (objects include rock, paper or scissors) should also be changed to something like cout &lt;&lt; &quot;Enter &quot;r&quot; for rock, &quot;p&quot; for paper or &quot;s&quot; for scissors)."}, {"owner": {"reputation": 273, "user_id": 3962706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2a889bb27ced6b83a5d27d4c2ff3b28?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/3962706/developer"}, "edited": false, "score": 0, "creation_date": 1573545486, "post_id": 58737161, "comment_id": 103906651, "body": "But how can we further improve the above code to enter the entire word instead of its initial?"}, {"owner": {"reputation": 559, "user_id": 12322064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/23a8u.jpg?s=128&g=1", "display_name": "ufoxDan", "link": "https://stackoverflow.com/users/12322064/ufoxdan"}, "reply_to_user": {"reputation": 273, "user_id": 3962706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2a889bb27ced6b83a5d27d4c2ff3b28?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/3962706/developer"}, "edited": false, "score": 0, "creation_date": 1573566553, "post_id": 58737161, "comment_id": 103917429, "body": "That would be better asked in a new question"}], "tags": [], "owner": {"reputation": 559, "user_id": 12322064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/23a8u.jpg?s=128&g=1", "display_name": "ufoxDan", "link": "https://stackoverflow.com/users/12322064/ufoxdan"}, "is_accepted": true, "score": 0, "last_activity_date": 1573502865, "last_edit_date": 1573502865, "creation_date": 1573068049, "answer_id": 58737161, "question_id": 58735618, "link": "https://stackoverflow.com/questions/58735618/problem-with-rock-paper-scissors-c-code/58737161#58737161", "title": "Problem with &quot;Rock, paper, scissors&quot; C++ code", "body": "<p>Since there is no mapping between your inputs and the enum types, only a direct equality can actually be determined, otherwise the last else statement triggers. Below I've modified your code with a solution that accepts the <code>char</code> values that <code>cin</code> gives, and then <strong>sets the objects with their enum values</strong>. You also had several typos missing parentheses, semicolons, and equal signs, so please read through and note the differences. This will not only fix the compiler error, but will make your code run as expected.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\nint main(int argc, char** argv) {\n    enum object {rock, paper, scissors};\n    object player1, player2;\n    cout &lt;&lt; \"Enter two objetcs (objects include rock, paper or scissors):\";\n    char p1, p2;\n    cin &gt;&gt; p1 &gt;&gt; p2;\n    if (p1 == 'r') {\n        player1 = rock;\n    }\n    else if (p1 == 'p') {\n        player1 = paper;\n    }\n    else if (p1 == 's') {\n        player1 = scissors;\n    }\n    else {\n        cout &lt;&lt; \"invalid input, play again\" &lt;&lt; endl;\n        exit(1);\n    }\n\n    if (p2 == 'r') {\n        player2 = rock;\n    }\n    else if (p2 == 'p') {\n        player2 = paper;\n    }\n    else if (p2 == 's') {\n        player2 = scissors;\n    }\n    else {\n        cout &lt;&lt; \"invalid input, play again\" &lt;&lt; endl;\n        exit(1);\n    }\n\n    if (player1==player2) cout &lt;&lt;\"objects are equal\";\n    else if (player1==rock &amp;&amp; player2==paper) cout &lt;&lt; \"player 2 is the winner\";\n    else if (player1==rock &amp;&amp; player2==scissors) cout&lt;&lt;\"player 1 is the winner\";\n    else if (player1==paper &amp;&amp; player2==rock) cout &lt;&lt; \"player 1 is the winner\";\n    else if (player1==paper &amp;&amp; player2==scissors) cout &lt;&lt;\"Palyer 2 is the winnder\";\n    else if (player1==scissors &amp;&amp; player2==paper) cout &lt;&lt; \"Player 1 is winner\";\n    else cout &lt;&lt;\"Player 2 is the winner\";\n    cout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>It is very important that you understand types and how there is no way in your original code to determine what inputs correspond to what enum your object is.</p>\n"}], "owner": {"reputation": 273, "user_id": 3962706, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2a889bb27ced6b83a5d27d4c2ff3b28?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/3962706/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 58737161, "answer_count": 2, "score": 2, "last_activity_date": 1573502865, "creation_date": 1573061410, "last_edit_date": 1573489772, "question_id": 58735618, "link": "https://stackoverflow.com/questions/58735618/problem-with-rock-paper-scissors-c-code", "title": "Problem with &quot;Rock, paper, scissors&quot; C++ code", "body": "<p>I know there are different ways to write code for the \"Rock, Paper, Scissors\" game. But I have tried to write the following code based on my elementary knowledge of C++. </p>\n\n<pre><code>using std::cin;\nusing std::cout;\nusing std::endl;\nint main(int argc, char** argv) {\n    enum object {rock, paper, scissors}\n    object player1, player2;\n    cout &lt;&lt;\"Enter two objetcs (objects include rock, paper or scissors):\";\n    cin &gt;&gt;player1 &gt;&gt; player2;\n    if (player1==player2) cout &lt;&lt;\"objects are equal\";\n    else if (player1==rock &amp;&amp; player2=paper cout &lt;&lt; \"player 2 is the winner\";\n    else if (player1==rock &amp;&amp; player2=scissors cout&lt;&lt;\"player 1 is the winner\";\n    else if (player1==paper &amp;&amp; player2=rock) cout &lt;&lt; \"player 1 is the winner\";\n    else if (player1==paper &amp;&amp; player2=scissors) cout &lt;&lt;\"Palyer 2 is the winnder\";\n    else if (player1==scissors &amp;&amp; player2=paper) cout &lt;&lt; \"Player 1 is winner\";\n    else cout &lt;&lt;\"Player 2 is the winner\";\n}   \n</code></pre>\n\n<p>The compiler <code>(Dev-C++)</code> finds error with <code>cin &gt;&gt;player1 &gt;&gt; player2;</code> line, explaining that <code>\"In Function 'int main(int, char**): [error] expected initializer before 'player1'\"</code>. I do not get the meaning of this warning. How I can I improve this code without too much change in its structure?</p>\n"}, {"tags": ["c++", "mesh", "cgal"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "edited": false, "score": 0, "creation_date": 1573150857, "post_id": 58742243, "comment_id": 103797371, "body": "Ok thx! have done that. I think it boils down to how to properly generate the SizingField. The basic example only shows a spherical analytical sizing field. But what I think I need is a  sizing field that is non-analytic (essentially defining sizes at each vertex or face of the surface)."}, {"owner": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "edited": false, "score": 0, "creation_date": 1573152266, "post_id": 58742243, "comment_id": 103797961, "body": "Can I define sizes for all the vertices on the surface, and then compute &#39;generate&#39; a &#39;sizing field&#39; from that somehow with your code? I can do that in python but... Apologies if I have missed something obvious."}, {"owner": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "edited": false, "score": 0, "creation_date": 1573153077, "post_id": 58742243, "comment_id": 103798291, "body": "I&#39;m going to make a figure that better explains. I have thin and thick structures, but I want the thin structures to be less mesh-dense, and the thicker structures to be more dense, which is kind of &#39;opposite&#39; what is normally done."}, {"owner": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "reply_to_user": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "edited": false, "score": 0, "creation_date": 1573200496, "post_id": 58742243, "comment_id": 103811719, "body": "The sizing field API basically takes a point for the surface and must return the local sizing field. Using the AABB-tree  aforementioned function you can locate the point on the input triangle mesh and get the info about the size you want."}, {"owner": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "edited": false, "score": 0, "creation_date": 1573675226, "post_id": 58742243, "comment_id": 103963089, "body": "Thanks for info. I&#39;m still having difficulty with a &#39;sizing field&#39; how to specify. Here is an illustration:  <a href=\"https://i.imgur.com/oj5aPGw.png\" rel=\"nofollow noreferrer\">i.imgur.com/oj5aPGw.png</a>  I want to specify at verts different tet size, such that the <i>thin</i> part has larger elements (low density), and the <i>thick</i> region have smaller elements (high density).  It looks like all I need is to properly define the &#39;sizing field&#39;, but from the current examples can&#39;t figure it out. I can provide the vertex sizes as a list. Is it possible that someone could provide a brief code snippet? I have examined the docs and just can&#39;t figure it out. thx"}, {"owner": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "reply_to_user": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "edited": false, "score": 0, "creation_date": 1574313071, "post_id": 58742243, "comment_id": 104189885, "body": "Are you having issues with the AABB-tree part?"}], "tags": [], "owner": {"reputation": 5172, "user_id": 863521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gGh24.jpg?s=128&g=1", "display_name": "sloriot", "link": "https://stackoverflow.com/users/863521/sloriot"}, "is_accepted": false, "score": 0, "last_activity_date": 1573103051, "creation_date": 1573103051, "answer_id": 58742243, "question_id": 58735560, "link": "https://stackoverflow.com/questions/58735560/grading-tet-mesh-density-in-cgal-polygon-mesher/58742243#58742243", "title": "Grading tet mesh density in cgal polygon mesher", "body": "<p>Look at the <code>Mesh_facet_criteria</code> and in particular this <a href=\"https://doc.cgal.org/latest/Mesh_3/classCGAL_1_1Mesh__facet__criteria__3.html#a77f4b4b8646e0cf549cdce4f8684ec4d\" rel=\"nofollow noreferrer\">constructor</a> where <code>SizingField</code> is where you can control the size. For locating the point wrt a face, you can use the AABB-tree function <a href=\"https://doc.cgal.org/latest/AABB_tree/classCGAL_1_1AABB__tree.html#a1b3ac9521fd7257f760deafff3743437\" rel=\"nofollow noreferrer\"><code>closest_point_and_primitive()</code></a>.</p>\n"}], "owner": {"reputation": 91, "user_id": 5212257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XbmmfAg58SY/AAAAAAAAAAI/AAAAAAAAERI/LGWldT1JQyc/photo.jpg?sz=128", "display_name": "tod doeh", "link": "https://stackoverflow.com/users/5212257/tod-doeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573103051, "creation_date": 1573061216, "question_id": 58735560, "link": "https://stackoverflow.com/questions/58735560/grading-tet-mesh-density-in-cgal-polygon-mesher", "title": "Grading tet mesh density in cgal polygon mesher", "body": "<p>I'm <em>still</em> trying to density control (grade) meshes in CGAL. Specifically tet-meshing a polygon surface (or multiple surface manifolds) that I simply load as OFF files. I can also load lists of selected faces or face nodes too. </p>\n\n<p>But I can't seem to get to first base on this with the polygon tet-mesher. All I want to do is assign and enforce a mesh density/size at selected faces in the OFF file. </p>\n\n<p>I <em>CAN</em> get some kinds of mesh density working by inserting 1-D features with volumetric data meshing, but for CAD and 3D printing purposes it <em>has to be computed</em> from an STL-like triangular surface manifold, so volume-based meshing is not do-able.</p>\n\n<p>Is what I'm trying to do even possible in CGAL? It feels to me like it must be, and I'm just missing something obvious. \nI really hope someone can help here. FYI i'm mostly working with the Mesh3 example using v4.14.\nThanks very much.</p>\n"}, {"tags": ["c++", "string", "syntax", "operator-overloading"], "answers": [{"comments": [{"owner": {"reputation": 733, "user_id": 101039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/88oCA.png?s=128&g=1", "display_name": "JPhi1618", "link": "https://stackoverflow.com/users/101039/jphi1618"}, "edited": false, "score": 0, "creation_date": 1573061597, "post_id": 58735614, "comment_id": 103761457, "body": "Ok, great.  &#39;Unary +&#39; is what I was forgetting about.  I knew the string literal wasn&#39;t the same as a std::string.  And I assume that there is no warning on that line because calling operator+ is &quot;having an effect&quot; even tho the value isn&#39;t stored."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1573062933, "post_id": 58735614, "comment_id": 103762065, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/operator_arithmetic\" rel=\"nofollow noreferrer\">More information</a> on unary + operator."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1573061405, "creation_date": 1573061405, "answer_id": 58735614, "question_id": 58735556, "link": "https://stackoverflow.com/questions/58735556/what-makes-this-string-addition-starting-with-a-a-valid-statement/58735614#58735614", "title": "What makes this string addition starting with a &#39;+&#39; a valid statement?", "body": "<p>Literal strings (like e.g. <code>\"???\"</code>) are really arrays of characters. And as all other arrays they decay to pointers to themselves. And this is what happens here, the expression <code>+ \"???\"</code> applies the unary <code>+</code> operator on the pointer to the first element of the string.</p>\n\n<p>This results in another pointer (to a character) that is equal to the first, and which can then be used to add to <code>std::string</code> objects.</p>\n\n<p>The same thing happens for other literals, like numbers, which is why <code>+4</code> is valid as well.</p>\n\n<p>But there's no unary <code>+</code> operator defined for <code>std::string</code> which is why you get an error for <code>+sMore</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1573062229, "last_edit_date": 1573062229, "creation_date": 1573061429, "answer_id": 58735623, "question_id": 58735556, "link": "https://stackoverflow.com/questions/58735556/what-makes-this-string-addition-starting-with-a-a-valid-statement/58735623#58735623", "title": "What makes this string addition starting with a &#39;+&#39; a valid statement?", "body": "<p>Firstly, string literal is an array of characters. When you pass an array as operand to unary operator +, the array is implicitly converted to a pointer to first element (which is of type <code>const char</code>). This implicit conversion is called decaying.</p>\n\n<p>The result of unary operator + is the operand after the conversion i.e. the pointer to the first element of the string literal in this case.</p>\n\n<p>The following binary operator + invokes the overloaded operator that takes a pointer to a character as one operand, and a <code>std::string</code> object as the other.</p>\n\n<p>For integers, operator + behaves the same, except instead of array-to-pointer decay, there is integral promotion. <code>int</code> is not promoted, but all types smaller than <code>int</code> are. For <code>std::string</code>, there is no overload for unary +, hence the error.</p>\n\n<hr>\n\n<blockquote>\n  <p>And I assume that there is no warning on that line because calling operator+ is \"having an effect\" even tho the value isn't stored.</p>\n</blockquote>\n\n<p>Lack of effect is only a reason to warn about if the result of the operation is discarded. In the string case, the result is used as an operand of the binary operator, so there is no reason to warn about lack of effect.</p>\n\n<p>Now, the result of the binary operation is discraded, and has no effect either, but it is practically impossible for the compiler to analyse all possible code paths for \"effects\", and it doesn't attempt to do so. The compiler is kind enough to check for primitive operations on pointers, but it probably won't bother analysing function calls (operator overloads for classes are functions).</p>\n"}], "owner": {"reputation": 733, "user_id": 101039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/88oCA.png?s=128&g=1", "display_name": "JPhi1618", "link": "https://stackoverflow.com/users/101039/jphi1618"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58735614, "answer_count": 2, "score": 1, "last_activity_date": 1573062229, "creation_date": 1573061204, "question_id": 58735556, "link": "https://stackoverflow.com/questions/58735556/what-makes-this-string-addition-starting-with-a-a-valid-statement", "title": "What makes this string addition starting with a &#39;+&#39; a valid statement?", "body": "<p>I had a copy/paste error in my code and ended up with a line that looked like:\n<code>myString = otherString; + \"?\" + anotherString;</code></p>\n\n<p>The code after the first semicolon wasn't issuing any errors or warnings.  Using an <a href=\"https://www.onlinegdb.com/online_c++_compiler\" rel=\"nofollow noreferrer\">online compiler</a> to double check my environment, I created this quick example that also compiles and runs:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int main()\n{\n    std::string sText(\"Hello World\");\n    std::string sMore(\" again\");\n\n    + \"???\" + sText + sMore; //No warning, no error\n\n    cout &lt;&lt; sText; //output \"Hello World\" as expected\n\n    + 4; //Warning has no effect\n    + sMore; //error: no match for \u2018operator+\u2019 (operand type is \u2018std::string {aka std::basic_string}\u2019)\n\n\n    return 0;\n}\n</code></pre>\n\n<p>So what is the beginning + doing?</p>\n"}, {"tags": ["c++", "c", "intellisense"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b172c6cd38e0469c7c8d4dad342b131?s=128&d=identicon&r=PG&f=1", "display_name": "Ebru", "link": "https://stackoverflow.com/users/12333445/ebru"}, "is_accepted": false, "score": 0, "last_activity_date": 1573061307, "creation_date": 1573061307, "answer_id": 58735592, "question_id": 58735409, "link": "https://stackoverflow.com/questions/58735409/c-c-intellisense-0-26-1-not-displaying-list-of-struct-members/58735592#58735592", "title": "C/C++ intellisense 0.26.1 not displaying list of struct members", "body": "<p>Edit: Just found out this only happens if i am trying to introduce a line between two finished lines of code (both ending with ;). Maybe intellisense does not work then because it sees a compile-time error?</p>\n"}], "owner": {"reputation": 11, "user_id": 12333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b172c6cd38e0469c7c8d4dad342b131?s=128&d=identicon&r=PG&f=1", "display_name": "Ebru", "link": "https://stackoverflow.com/users/12333445/ebru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573061307, "creation_date": 1573060624, "question_id": 58735409, "link": "https://stackoverflow.com/questions/58735409/c-c-intellisense-0-26-1-not-displaying-list-of-struct-members", "title": "C/C++ intellisense 0.26.1 not displaying list of struct members", "body": "<p>C/C++ intellisense is only displaying suggestions of struct members after i type some letter that is in their names, then it suggests possible matches. However, i would like it to show every possible struct member as soon as . or -> is typed. Is this a setting i`m missing?</p>\n"}, {"tags": ["c++", "c++11", "lambda", "conditional-operator"], "answers": [{"tags": [], "owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "is_accepted": false, "score": 8, "last_activity_date": 1573234340, "last_edit_date": 1573234340, "creation_date": 1573060563, "answer_id": 58735390, "question_id": 58735308, "link": "https://stackoverflow.com/questions/58735308/c-ternary-assignment-of-lambda/58735390#58735390", "title": "C++ ternary assignment of lambda", "body": "<p>Since 2 lambdas(<code>lambda1</code> and <code>lambda2</code>) are 2 different types, <code>?:</code> cannot deduce return type for <code>lambda</code> from <code>lambda1</code> and <code>lambda2</code>. This happens because these 2 are not convertible to each other.</p>\n"}, {"tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 8, "last_activity_date": 1573060619, "creation_date": 1573060619, "answer_id": 58735407, "question_id": 58735308, "link": "https://stackoverflow.com/questions/58735308/c-ternary-assignment-of-lambda/58735407#58735407", "title": "C++ ternary assignment of lambda", "body": "<p>It doesn't compile because each lambda has a unique type, there isn't a common type for <code>?:</code>. </p>\n\n<p>You could wrap them in <code>std::function&lt;void(T&amp;)&gt;</code>, e.g. </p>\n\n<pre><code>auto lamba1 = [&amp;](T&amp; arg) {\n  ...\n};\nauto lambda2 = [&amp;](T&amp; arg) {\n  ...\n};\nauto lambda = condition ? std::function(lambda1) : lambda2; // C++17 class template deduction\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 10, "last_activity_date": 1573060664, "creation_date": 1573060664, "answer_id": 58735418, "question_id": 58735308, "link": "https://stackoverflow.com/questions/58735308/c-ternary-assignment-of-lambda/58735418#58735418", "title": "C++ ternary assignment of lambda", "body": "<p>The compiler can't decide what type <code>auto</code> should be:</p>\n\n<pre><code>auto lambda = condition ? lambda1 : lambda2;\n</code></pre>\n\n<p>since every lambda has a different and unique type.</p>\n\n<p>One way that'll work is:</p>\n\n<pre><code>auto lambda = [&amp;](T&amp; arg) {\n     return (condition ? lambda1(arg) : lambda2(arg));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1000, "user_id": 340851, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48ced4682d3b1f4dd2d5004bef0be3ac?s=128&d=identicon&r=PG", "display_name": "cow", "link": "https://stackoverflow.com/users/340851/cow"}, "edited": false, "score": 0, "creation_date": 1573061078, "post_id": 58735436, "comment_id": 103761188, "body": "Complete error is &quot;error: operands to ?: have different types \u2018f(const std::vector&lt;int&gt;&amp;, size_t, size_t) [with T = unsigned char; size_t = long unsigned int]::&lt;lambda(unsigned char&amp;)&gt;\u2019 and \u2018f(const std::vector&lt;int&gt;&amp;, size_t, size_t) [with T = unsigned char; size_t = long unsigned int]::&lt;lambda(unsigned char&amp;)&gt;\u2019&quot;, in which i see identical all types &amp; formats."}, {"owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "reply_to_user": {"reputation": 1000, "user_id": 340851, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48ced4682d3b1f4dd2d5004bef0be3ac?s=128&d=identicon&r=PG", "display_name": "cow", "link": "https://stackoverflow.com/users/340851/cow"}, "edited": false, "score": 1, "creation_date": 1573114004, "post_id": 58735436, "comment_id": 103777702, "body": "@cow Because the lambda in themselves have the same signature so the compiler, in order to hide its implementation details and to give a more understandable error, gives you the location and signature of both lambdas which are identicals. But in the end, they are still interpreted as <code>SomeCompilerGeneratedTypeName1</code> and <code>SomeCompilerGeneratedTypeName2</code>"}, {"owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "reply_to_user": {"reputation": 1000, "user_id": 340851, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48ced4682d3b1f4dd2d5004bef0be3ac?s=128&d=identicon&r=PG", "display_name": "cow", "link": "https://stackoverflow.com/users/340851/cow"}, "edited": false, "score": 1, "creation_date": 1573464668, "post_id": 58735436, "comment_id": 103877830, "body": "@cow i added an example that highlights the beginning of the answer, you might find it interesting"}], "tags": [], "owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "is_accepted": true, "score": 11, "last_activity_date": 1574664186, "last_edit_date": 1574664186, "creation_date": 1573060768, "answer_id": 58735436, "question_id": 58735308, "link": "https://stackoverflow.com/questions/58735308/c-ternary-assignment-of-lambda/58735436#58735436", "title": "C++ ternary assignment of lambda", "body": "<p>Individual lambdas are translated to different classes by the compiler.\nFor example, lambda1's definition is equivalent to:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class SomeCompilerGeneratedTypeName {\npublic:\n  SomeCompilerGeneratedTypeName(...) { // Capture all the required variables here\n  }\n\n  void operator()(T&amp; arg) const {\n    // ...\n  }\n\nprivate:\n  // All the captured variables here ...\n};\n</code></pre>\n\n<p>Therefore, two different types are generated by the compiler, which causes a type incompatibility for <code>auto lambda = condition ? lambda1 : lambda2;</code></p>\n\n<p>The following would work:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto lambda = condition ? std::function&lt;void(T&amp;)&gt;(lambda1) : std::function&lt;void(T&amp;)&gt;(lambda2);\n</code></pre>\n\n<p>To highlight that both lambdas are indeed different types, we can use <a href=\"https://en.cppreference.com/w/cpp/language/typeid\" rel=\"nofollow noreferrer\"><code>&lt;typeinfo&gt;</code></a> from the standard library and the <code>typeid</code> operator. Lambdas are not polymorphic types, so the standard guarantees that the 'typeid' operator is evaluated at compile time. This shows that the following example is valid even if RTTI is disabled: </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;typeinfo&gt;\n\nint main()\n{\n    struct T {\n\n    };\n\n    auto lambda1 = [&amp;](T&amp; arg) {\n        return;\n    };\n\n    auto lambda2 = [&amp;](T&amp; arg) {\n      return;\n    };\n\n    std::cout &lt;&lt; typeid(lambda1).name() &lt;&lt; \"/\" &lt;&lt; typeid(lambda1).hash_code() &lt;&lt; std::endl;\n    std::cout &lt;&lt; typeid(lambda2).name() &lt;&lt; \"/\" &lt;&lt; typeid(lambda2).hash_code() &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>The output of the program is (with GCC 8.3, <a href=\"https://godbolt.org/z/pwT33g\" rel=\"nofollow noreferrer\">see on Gobolt</a>):</p>\n\n<pre><code>Z4mainEUlRZ4mainE1TE_/7654536205164302515\nZ4mainEUlRZ4mainE1TE0_/10614161759544824066\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1573061107, "post_id": 58735476, "comment_id": 103761211, "body": "This won&#39;t work on visual studio though. Their extension that allow a lambda to convert to different calling convesion prevents it."}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1573061166, "post_id": 58735476, "comment_id": 103761249, "body": "@GuillaumeRacicot, thanks for this note. Could you please give a link where I can read more about it?"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 3, "creation_date": 1573061239, "post_id": 58735476, "comment_id": 103761286, "body": "<a href=\"https://devblogs.microsoft.com/oldnewthing/20150220-00/?p=44623\" rel=\"nofollow noreferrer\">Here you go</a>"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 2, "creation_date": 1573061338, "post_id": 58735476, "comment_id": 103761325, "body": "@GuillaumeRacicot It seems to compile on a recent MSVC version though. <a href=\"https://godbolt.org/z/ZQLWxy\" rel=\"nofollow noreferrer\">godbolt.org/z/ZQLWxy</a>"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1573061418, "post_id": 58735476, "comment_id": 103761365, "body": "@Brian Oh! This is excellent news. Now I have to change some code. Thanks!"}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 12, "last_activity_date": 1573062324, "last_edit_date": 1573062324, "creation_date": 1573060903, "answer_id": 58735476, "question_id": 58735308, "link": "https://stackoverflow.com/questions/58735308/c-ternary-assignment-of-lambda/58735476#58735476", "title": "C++ ternary assignment of lambda", "body": "<p>Curiously, if lambdas are capture-less, operator <code>+</code> trick can be employed:</p>\n\n<pre><code>auto lambda1 = [](int arg) { ... };\nauto lambda2 = [](int arg) { ... };\n\nauto lambda = condition ? +lambda1 : +lambda2; // This compiles!\nlambda(2019); \n</code></pre>\n\n<p>This works, because <code>+</code> will convert lambda into a function pointer, and both function pointers have the same type (something like <code>void (*)(int)</code>).</p>\n\n<p>With GCC and Clang (but not with MSVC), <code>+</code> can be omitted, lambdas will still be converted into function pointers.</p>\n"}], "owner": {"reputation": 1000, "user_id": 340851, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48ced4682d3b1f4dd2d5004bef0be3ac?s=128&d=identicon&r=PG", "display_name": "cow", "link": "https://stackoverflow.com/users/340851/cow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 1, "accepted_answer_id": 58735436, "answer_count": 5, "score": 11, "last_activity_date": 1574664186, "creation_date": 1573060241, "last_edit_date": 1573061567, "question_id": 58735308, "link": "https://stackoverflow.com/questions/58735308/c-ternary-assignment-of-lambda", "title": "C++ ternary assignment of lambda", "body": "<p>Any idea why the following snippet doesn't compile? It complains with an error \"error: operands to ?: have different types\"</p>\n\n<pre><code>  auto lambda1 = [&amp;](T&amp; arg) {\n      ...\n  };\n  auto lambda2 = [&amp;](T&amp; arg) {\n      ...\n  };\n  auto lambda = condition ? lambda1 : lambda2;\n</code></pre>\n"}, {"tags": ["c++", "linux", "gpio"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 3458712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWQWd.png?s=128&g=1", "display_name": "Jo Luxer", "link": "https://stackoverflow.com/users/3458712/jo-luxer"}, "is_accepted": false, "score": 2, "last_activity_date": 1573207256, "creation_date": 1573207256, "answer_id": 58764317, "question_id": 58735140, "link": "https://stackoverflow.com/questions/58735140/using-libgpiod-how-do-i-switch-direction-of-a-requested-line-on-the-fly/58764317#58764317", "title": "Using libgpiod how do I switch direction of a requested line on the fly?", "body": "<p>Answering the question myself:</p>\n\n<p>The direction is currently not changeable yet without releasing the line. </p>\n\n<p>I've got this directly from the author of libgpiod via e-mail:</p>\n\n<blockquote>\n  <p>... this is because the kernel doesn't allow to change the\n  direction without releasing a line. This however will change in linux\n  v5.5 as the patches introducing this functionality have been reviewed\n  and are pending a merge. New version of libgpiod with support for that\n  will be released shortly after.</p>\n  \n  <p>Best regards,\n  Bartosz Golaszewski</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 3458712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aWQWd.png?s=128&g=1", "display_name": "Jo Luxer", "link": "https://stackoverflow.com/users/3458712/jo-luxer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573207256, "creation_date": 1573059627, "question_id": 58735140, "link": "https://stackoverflow.com/questions/58735140/using-libgpiod-how-do-i-switch-direction-of-a-requested-line-on-the-fly", "title": "Using libgpiod how do I switch direction of a requested line on the fly?", "body": "<p>I'm rewriting my code, changing from sysfs interface forward to libgpiod. After the request of a line, direction is fixed and I need to figure out, how to switch the direction of this line on the fly for changing between input and output. At the moment I don't see the right way, and a further request is denied.</p>\n\n<p>When I do a cycle of request - use - release - request-again with different direction, this seem wrong overhead to me.</p>\n\n<p>I would prefer to have a function call, which changes the direction from in to out and vice versa.</p>\n\n<p>Is there something, I've overseen?</p>\n"}, {"tags": ["c++", "c++17", "assertion", "compile-time", "requirements"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573059576, "post_id": 58735083, "comment_id": 103760395, "body": "You overlooked the fact that <code>v</code> is a parameter that can be called anywhere, from any translation unit, and when compiling the other translation unit that compiler knows nothing, whatsoever, what&#39;s in this translation unit, so what you&#39;re seeking to do is logically impossible in C++."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1573059596, "post_id": 58735083, "comment_id": 103760405, "body": "<code>constexpr OneAndOnlyOne(std::integral_constant&lt;1&gt;) noexcept</code>?"}, {"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1573059875, "post_id": 58735083, "comment_id": 103760549, "body": "@Jarod42, &quot;no known conversion for argument 1 from &#39;int&#39; to &#39;std::integral_constant&lt;int, 1&gt;&quot;"}, {"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573060145, "post_id": 58735083, "comment_id": 103760696, "body": "@SamVarshavchik, the definition has to be definition known at compile-time."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1573060438, "post_id": 58735083, "comment_id": 103760853, "body": "<a href=\"https://godbolt.org/z/lK4gf5\" rel=\"nofollow noreferrer\">Demo</a>."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573060451, "post_id": 58735083, "comment_id": 103760866, "body": "In that case the only way I can think of is to make it a template parameter, rather than a function parameter."}, {"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573060698, "post_id": 58735083, "comment_id": 103761001, "body": "@SamVarshavchik, well, if I didn&#39;t have to conform to an interface, I&#39;d omit the argument altogether. :)"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573061206, "post_id": 58735083, "comment_id": 103761267, "body": "Then a runtime assertion is pretty much the only portable way to go, here."}, {"owner": {"reputation": 591, "user_id": 1790748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8bd16273850e94617132fce97504e2?s=128&d=identicon&r=PG", "display_name": "erlc", "link": "https://stackoverflow.com/users/1790748/erlc"}, "edited": false, "score": 1, "creation_date": 1573065119, "post_id": 58735083, "comment_id": 103763099, "body": "David Stone proposes a fix for this in <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1045r1.html\" rel=\"nofollow noreferrer\">open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1045r1.html</a>"}, {"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "reply_to_user": {"reputation": 591, "user_id": 1790748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8bd16273850e94617132fce97504e2?s=128&d=identicon&r=PG", "display_name": "erlc", "link": "https://stackoverflow.com/users/1790748/erlc"}, "edited": false, "score": 0, "creation_date": 1573132954, "post_id": 58735083, "comment_id": 103787707, "body": "@erlc, that&#39;s exactly what I want. The <code>tuple::operator []</code> example looks like a great. I hope it gets adopted into C++20!"}], "owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573062731, "creation_date": 1573059401, "last_edit_date": 1573062731, "question_id": 58735083, "link": "https://stackoverflow.com/questions/58735083/accept-only-specific-integer-at-compile-time", "title": "Accept only specific integer at compile-time", "body": "<p>Some named requirements like <a href=\"https://en.cppreference.com/w/cpp/named_req/Allocator\" rel=\"nofollow noreferrer\">Allocator</a> want you to implement quite generic methods, e.g. <code>Allocator::allocate(int n)</code>. For my specific case I only want to implement an argument <code>n=1</code>, and if possible I'd it to fail at <strong>compile-time</strong> if some other integer was supplied.</p>\n\n<p>So far I have not found any reliable solution. I only care about GCC and Clang.</p>\n\n<ul>\n<li><p>This works fine in GCC, but it not in Clang (<a href=\"https://www.godbolt.org/z/DW_m3r\" rel=\"nofollow noreferrer\">Godbolt</a>):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct OneAndOnlyOne {\n    constexpr OneAndOnlyOne(int v) noexcept {\n        // static link-time error in Clang for any value of v unless -O2 is supplied:\n        if (v != 1) _you_must_supply_a_one();\n    }\nprivate:\n    void _you_must_supply_a_one();\n};\n</code></pre></li>\n<li><p>assert makes it a runtime-problem (<a href=\"https://www.godbolt.org/z/j9X-Uw\" rel=\"nofollow noreferrer\">Godbolt</a>): </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct OneAndOnlyOne {\n    constexpr OneAndOnlyOne(int v) noexcept {\n        // fails only at runtime:\n        assert(v == 1);\n        (void) v;\n    }\n};\n</code></pre></li>\n<li><p>static_assert does not work, either: (<a href=\"https://www.godbolt.org/z/tqQeNV\" rel=\"nofollow noreferrer\">Godbolt</a>):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct OneAndOnlyOne {\n    constexpr OneAndOnlyOne(int v) noexcept {\n        // \"error: 'v' is not a constant expression\"\n        static_assert(v == 1);\n    }\n};\n</code></pre></li>\n<li><p>There does not seem to trick to turn the argument into a template parameter (<a href=\"https://www.godbolt.org/z/TvYGms\" rel=\"nofollow noreferrer\">Godbolt</a>):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;int&gt; struct FailUnlessOne;\ntemplate &lt;&gt; struct FailUnlessOne &lt;1&gt; {};\n\nstruct OneAndOnlyOne {\n    constexpr OneAndOnlyOne(int v) noexcept {\n        // \"error: 'v' is not a constant expression\"\n        constexpr FailUnlessOne&lt;v&gt; test;\n        (void) test;\n    }\n};\n</code></pre></li>\n</ul>\n\n<p>Is there something I overlooked, or is it not possible at all to test an argument at compile-time?</p>\n"}, {"tags": ["c++", "namespaces"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573059428, "post_id": 58735020, "comment_id": 103760311, "body": "You would &quot;predefine&quot; them in an identical way. What exactly is the problem?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1573060982, "post_id": 58735020, "comment_id": 103761140, "body": "<code>cpu::Registers cpu::challas</code> should do it. You need to tell the compiler that <code>Registers</code> is inside the namespace. Or put all that code inside the namespace instead of outside."}], "owner": {"reputation": 159, "user_id": 12299993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1879829fd0ee1fb59811b28812566f?s=128&d=identicon&r=PG&f=1", "display_name": "toaster_fan", "link": "https://stackoverflow.com/users/12299993/toaster-fan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573060431, "creation_date": 1573059197, "last_edit_date": 1573060431, "question_id": 58735020, "link": "https://stackoverflow.com/questions/58735020/global-variables-in-namespaces-c", "title": "global variables in namespaces c++", "body": "<p>Im trying to define global shared pointer definition in a namspace such that every class in that namespace can use these. These pointers are defined in cpu_consts.h (cpu is the namespace). I know extern variables need to be defined outside of a function/namespace. This is done in cpu_class.cpp since this is the class that includes all the classes in the namespace. How do i predefine shared_ptr's?</p>\n\n<p>The Register class is also in the cpu namespace.</p>\n\n<p>I already tried predefining int's, which works:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"cpu_class.h\"\n\nint cpu::yote;\nnamespace cpu {\n...\n}\n</code></pre>\n\n<p>cpu_consts</p>\n\n<pre><code>#pragma once\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\n\nnamespace cpu {\n    class Registers;\n\n    extern int yote;\n    extern std::shared_ptr&lt;Registers&gt; registerPointer;\n    extern Registers challas;\n}\n</code></pre>\n\n<p>cpu_class.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"cpu_class.h\"\n\nint cpu::yote;\n... predefine shared_ptr how ?? Registers cpu::challas does not work\nnamespace cpu {\n...\n}\n</code></pre>\n"}, {"tags": ["c++", "set", "containers", "priority-queue"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1573059131, "post_id": 58734964, "comment_id": 103760148, "body": "<code>return c1.x == c2.x ? c1.y == c2.y ? true : false : false;</code> -- I feel sorry for the person trying to decipher this.  Why not simply <code>return (c1.x == c2.x &amp;&amp; c1.y == c2.y);</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1573059169, "post_id": 58734964, "comment_id": 103760170, "body": "Can you show how you are getting duplicates?  <code>std::set</code> wont store duplicates."}, {"owner": {"reputation": 353, "user_id": 9058538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bd2f96ff5a91d9f871935a899e04c?s=128&d=identicon&r=PG&f=1", "display_name": "Ovidiu Firescu", "link": "https://stackoverflow.com/users/9058538/ovidiu-firescu"}, "edited": false, "score": 0, "creation_date": 1573059889, "post_id": 58734964, "comment_id": 103760556, "body": "If I have in the <code>std::set</code> the following elements (Coordinates(1,1,T),2) and I want to insert in the set (Coordinates(2,0,T),2) it won&#39;t insert it. It compares it with (Coordinates(1,1,T),2) by the second parameter and returns false and it won&#39;t insert it. You&#39;re right Paul I overcomplicated that return ..."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 9058538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bd2f96ff5a91d9f871935a899e04c?s=128&d=identicon&r=PG&f=1", "display_name": "Ovidiu Firescu", "link": "https://stackoverflow.com/users/9058538/ovidiu-firescu"}, "edited": false, "score": 1, "creation_date": 1573061247, "post_id": 58735332, "comment_id": 103761291, "body": "You and @NathanOliver- Reinstate Monica posted almost at the same time (you faster with 1minute) so I&#39;m gonna respond here for both answers. This is really ingenious I didn&#39;t know you could do something like this. This really solves my problem and does exactly what I wanted thanks for both of you for your answers were really helpful."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 1, "last_activity_date": 1573060336, "creation_date": 1573060336, "answer_id": 58735332, "question_id": 58734964, "link": "https://stackoverflow.com/questions/58734964/stdset-different-comparer-for-inserting-and-ordering/58735332#58735332", "title": "std::set different comparer for inserting and ordering", "body": "<p>Using your <code>Comparer</code> the <code>set</code> will contain only unique values of the <code>int</code>, since <code>Coordinates</code> isn't participating in the comparison at all.</p>\n\n<p><code>std::set</code> uses <code>operator &lt;</code> for sorting as well as equality; equality is determined as <code>!(a&lt;b || b&lt;a)</code>. Therefore <code>operator &lt;</code> should take into account every attribute which makes the element unique.</p>\n\n<p>You can specialize <code>std::less</code> for your type like this:</p>\n\n<pre><code>namespace std {\ntemplate&lt;&gt;\nstruct less&lt;pair&lt;Coordinates, int&gt;&gt; {\n    bool operator()(const pair&lt;Coordinates, int&gt;&amp; a, const pair&lt;Coordinates, int&gt;&amp; b) const {\n        return tie(a.second, a.first.x, a.first.y) &lt; tie(b.second, b.first.x, b.first.y);\n    }\n};\n}\n</code></pre>\n\n<p>Then <code>std::set&lt; std::pair&lt;Coordinates, int&gt;&gt; positions;</code> should work.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 1, "last_activity_date": 1573061368, "last_edit_date": 1573061368, "creation_date": 1573060419, "answer_id": 58735351, "question_id": 58734964, "link": "https://stackoverflow.com/questions/58734964/stdset-different-comparer-for-inserting-and-ordering/58735351#58735351", "title": "std::set different comparer for inserting and ordering", "body": "<p>The issue here is that since you only look at <code>second</code> in you comparator, you can only store pairs that have unique values for <code>second</code>.  This is because the set only uses the comparator to compare the elements.  It doesn't use your <code>operator ==</code> to check for equality but instead does <code>cmp(a, b) == cmp(b, a)</code><sup>1</sup> to test if the values are equal.</p>\n\n<p>If you wan to sort by <code>second</code>, but allow other points with the same <code>second</code> but different other values then you need to add those values into you comparator.  The easiest way to do that is to use <code>std::tie</code> to build a couple of tuples and use the tuples <code>operator &lt;</code> which \"does the right thing\".  That would look like</p>\n\n<pre><code>class Compare\n{\npublic:\n    bool operator() (const std::pair&lt;Coordinates, int&gt;&amp; c1, const std::pair&lt;Coordinates, int&gt;&amp; c2) const\n    {\n        return std::tie(c1.second, c1.first.x, c1.first.y)  &lt; std::tie(c2.second, c2.first.x, c2.first.y);\n    }\n};\n</code></pre>\n\n<p><sup>1</sup>: If <code>a</code> is not less then <code>b</code>, and <code>b</code> is not less than <code>a</code> then <code>a</code> and <code>b</code> must be equal</p>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 9058538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bd2f96ff5a91d9f871935a899e04c?s=128&d=identicon&r=PG&f=1", "display_name": "Ovidiu Firescu", "link": "https://stackoverflow.com/users/9058538/ovidiu-firescu"}, "edited": false, "score": 0, "creation_date": 1573063049, "post_id": 58735765, "comment_id": 103762113, "body": "Other answers were both exactly what I was looking for, but to be honest I like more your approach and the use of the lambda function for comparison. Really interesting thanks for posting this answer and for the example."}], "tags": [], "owner": {"reputation": 3198, "user_id": 6119582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d37ce6d78ed9281f47a2712aaed48?s=128&d=identicon&r=PG&f=1", "display_name": "sweenish", "link": "https://stackoverflow.com/users/6119582/sweenish"}, "is_accepted": false, "score": 1, "last_activity_date": 1573062049, "creation_date": 1573062049, "answer_id": 58735765, "question_id": 58734964, "link": "https://stackoverflow.com/questions/58734964/stdset-different-comparer-for-inserting-and-ordering/58735765#58735765", "title": "std::set different comparer for inserting and ordering", "body": "<p>As stated, the issue was that you only looked at the second member of the pair, so the set didn't care if the Coordinates were different. You simply needed to include the Coordinates in your comparison.</p>\n\n<p>Unlike the other answers, this one utilizes a lambda for the comparison. I prefer it over <code>std::tie</code> and mucking around with <code>std</code> overrides. It also saves you the trouble of writing up a functor yourself like you did with your Compare class. </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;set&gt;\n\nclass Coordinates {\npublic:\n  Coordinates(int x = 0, int y = 0, char tool = 'T') : x(x), y(y), tool(tool) {}\n\n  int x, y;\n  char tool;\n};\n\nint main() {\n  using CoordPair = std::pair&lt;Coordinates, int&gt;;\n\n  auto compare = [](const CoordPair&amp; a, const CoordPair&amp; b) {\n    if (a.second != b.second)\n      return a.second &lt; b.second;\n\n    // Replace this with some method of comparing Coordinates\n    return a.first.x != b.first.x || a.first.y != b.first.y;\n  };\n\n  std::set&lt;std::pair&lt;Coordinates, int&gt;, decltype(compare)&gt; list(compare);\n\n  list.emplace(Coordinates(1, 1), 2);\n  list.emplace(Coordinates(2, 0), 2);\n  list.emplace(Coordinates(1, 1), 3);\n  list.emplace(Coordinates(1, 1), 2); // Shouldn't show up\n\n  for (auto i : list)\n    std::cout &lt;&lt; '(' &lt;&lt; i.first.x &lt;&lt; \", \" &lt;&lt; i.first.y &lt;&lt; \", \" &lt;&lt; i.first.tool\n              &lt;&lt; ')' &lt;&lt; \", \" &lt;&lt; i.second &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Your C++ version wasn't specified, this needs at least C++11.</p>\n"}], "owner": {"reputation": 353, "user_id": 9058538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72bd2f96ff5a91d9f871935a899e04c?s=128&d=identicon&r=PG&f=1", "display_name": "Ovidiu Firescu", "link": "https://stackoverflow.com/users/9058538/ovidiu-firescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 58735332, "answer_count": 3, "score": 1, "last_activity_date": 1573062049, "creation_date": 1573059007, "last_edit_date": 1573059960, "question_id": 58734964, "link": "https://stackoverflow.com/questions/58734964/stdset-different-comparer-for-inserting-and-ordering", "title": "std::set different comparer for inserting and ordering", "body": "<p>I need a structure in which I can insert elements, have no duplicate, use a custom comparer and have the smallest element first. I tried using <code>std::priority_queue</code>, but the problem is that I get a lot of duplicates and I run out of space. So I thought about using <code>std::set</code> : <br><code>std::set&lt; std::pair&lt;Coordinates, int&gt;, Compare&gt; positions;</code> where <br></p>\n\n<pre><code>Coordinates\n{\npublic:\n    Coordinates(int x = 0, int y = 0, char tool = 'T') : x(x), y(y), tool(tool) {}\n\npublic:\n    int x, y;\n    char tool;\n};\n</code></pre>\n\n<pre><code>class Compare\n{\npublic:\n    bool operator() (const std::pair&lt;Coordinates, int&gt;&amp; c1, const std::pair&lt;Coordinates, int&gt;&amp; c2) const\n    {\n        return c1.second &lt; c2.second;\n    }\n};\n</code></pre>\n\n<p>I want the elements to be sorted based on the second element of pair, which this implementation is doing, but the problem is that it is using the same comparer when inserting new pairs and I get duplicates. <br> My question is: Is it possible to make the <code>std::set</code> to not allow duplicates also to order the elements based on the second element of pair?</p>\n\n<p>Edit: Eliminated some code that was not necessary and changed in <code>Compare</code> > with &lt;</p>\n"}, {"tags": ["c++", "winapi", "freeze", "cdialog", "winspector"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573062443, "post_id": 58734940, "comment_id": 103761857, "body": "Spy++ hanging is a symptom of a <code>windowproc</code> that is blocked, ie not pumping messages.  This would also explain the other things you are seeing as messages would not be processed.  Do any of the message loops or code called (directly or indirectly) from the loops block and therefore stop the message pump?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1573062467, "post_id": 58734940, "comment_id": 103761866, "body": "&quot;multi-threaded application&quot; == random deadlock.  Everything you do with a window must only be done on the thread that executes the message loop"}, {"owner": {"reputation": 23, "user_id": 12333280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dxgrPhVpWFI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rekLnwzgRTLVri0BsvEzGSSP6FIAw/photo.jpg?sz=128", "display_name": "sobadola", "link": "https://stackoverflow.com/users/12333280/sobadola"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573133316, "post_id": 58734940, "comment_id": 103787875, "body": "@Richard, I tried commenting out everything in the dialog timer (thinking it might be accessing a locked mutex), but no help.   Is there a way I can identify the dialog/message that is blocking?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1573151507, "post_id": 58734940, "comment_id": 103797671, "body": "<a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugging-a-deadlock\" rel=\"nofollow noreferrer\">Debugging a Deadlock</a>."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 12333280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dxgrPhVpWFI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rekLnwzgRTLVri0BsvEzGSSP6FIAw/photo.jpg?sz=128", "display_name": "sobadola", "link": "https://stackoverflow.com/users/12333280/sobadola"}, "is_accepted": false, "score": 0, "last_activity_date": 1586870050, "creation_date": 1586870050, "answer_id": 61208626, "question_id": 58734940, "link": "https://stackoverflow.com/questions/58734940/sometimes-showwindow-never-calls-onshowwindow-and-main-app-hangs/61208626#61208626", "title": "Sometimes ShowWindow never calls OnShowWindow and main App hangs", "body": "<p>The dialog was getting created from a thread that was not executing a message pump. This was the root problem. I had tried to initialize all dialogs (i.e. call \"Create\") from an \"init\" thread, and then use them later on in the winproc/GUI thread. Can't do this apparently.</p>\n\n<p>A pointer to the dialog was then retrieved into the winproc/GUI (which has a message pump), but by that time, the dialog was already \"corrupt\" and no longer responding to winproc properly</p>\n"}], "owner": {"reputation": 23, "user_id": 12333280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dxgrPhVpWFI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rekLnwzgRTLVri0BsvEzGSSP6FIAw/photo.jpg?sz=128", "display_name": "sobadola", "link": "https://stackoverflow.com/users/12333280/sobadola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586870050, "creation_date": 1573058888, "last_edit_date": 1573656711, "question_id": 58734940, "link": "https://stackoverflow.com/questions/58734940/sometimes-showwindow-never-calls-onshowwindow-and-main-app-hangs", "title": "Sometimes ShowWindow never calls OnShowWindow and main App hangs", "body": "<p>I have a multi-threaded application with several supporting DLLs and several popup dialogs. My Main App loads all DLLs on startup, which creates all popups, but they are kept hidden until needed.</p>\n\n<p>When the user presses a button in the main app, a particular popup is shown (from the DLL) by calling ShowWindow( SW_SHOW ) (modeless)</p>\n\n<p>Sometimes (1-in-10 times?) the popup simply fails to show and the Main App hangs. OnShowWindow of the Popup dialog is never called. I have tried calling ShowWindowASync instead, and it still fails to show the popup sometimes, but this call doesn't lock the Main App.</p>\n\n<p>This problem only affects popups within a single DLL. </p>\n\n<p>If the popup shows the first time ShowWindow is called, it can be closed and re-opened indefinitely throughout the lifetime of the Main App. If (using ShowWindowASync), the popup fails to show, it will never show during the lifetime of the Main App. I can re-run the application (without rebuilding anything) and there is a hit-or-miss chance that it will work or fail. I haven't been able to identify any predictive conditions or properties.</p>\n\n<p>I have used tools to renumber all of my resource elements so that there are no conflicts throughout the solution.</p>\n\n<p>UPDATE:</p>\n\n<p>I used Winspector to get some information about the dialog when it does and does not work.</p>\n\n<p>When the dialog works (shows properly), Winspector reports that my dialog has valid position (10,96, 1015, 514), style attributes that match the resource template, ID of 0 (not sure what ID means), and the \"Owner EXE\" is \"MyApp.exe\" - I can see many messages passing in and out of the dialog, including WM_SHOWWINDOW.</p>\n\n<p>When the dialog fails (does not get a show window message), Winspector reports position (-1512, 190, -517, 634), style attributes that do not match the resource template, ID 509290824, and owner EXE is \"C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\IDE\\devenv.exe\" - I also do not see ANY messages in the message viewer within Winspector when the dialog fails to show.</p>\n\n<p>Clearly, the dialog is not getting created correctly. CDialog::Create never fails for me. Additionally, I experience this problem in release (not using Visual Studio) so it's not a VS-specific problem.</p>\n"}, {"tags": ["c++", "dependency-injection"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1573060810, "post_id": 58734769, "comment_id": 103761051, "body": "So you need another interface with both <code>Identity</code> and <code>D_Work</code>."}, {"owner": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1573075611, "post_id": 58734769, "comment_id": 103767394, "body": "There is no shame in keeping a <code>D*</code> if you need to <code>D_Work()</code>, isn&#39;t it? Don&#39;t overengineer the obvious."}, {"owner": {"reputation": 111, "user_id": 1366464, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6acb87d187b4278b5caeeb7ec47bd782?s=128&d=identicon&r=PG", "display_name": "Mathew Joy", "link": "https://stackoverflow.com/users/1366464/mathew-joy"}, "reply_to_user": {"reputation": 17424, "user_id": 278842, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/df6877d3f05e542ca5975b4670600f2e?s=128&d=identicon&r=PG", "display_name": "Christopher Oezbek", "link": "https://stackoverflow.com/users/278842/christopher-oezbek"}, "edited": false, "score": 0, "creation_date": 1573076166, "post_id": 58734769, "comment_id": 103767584, "body": "@ChristopherOezbek The problem of keeping <code>D*</code> is when you do Unit test. If it is from an interface, then I can mock it out. The accepted solution fits nicely with the Dependency Injection pattern that I have."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573059018, "post_id": 58734915, "comment_id": 103760091, "body": "This doesn&#39;t allow the OP to use an <code>A*</code> though, which sounds like that is what they want."}, {"owner": {"reputation": 111, "user_id": 1366464, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6acb87d187b4278b5caeeb7ec47bd782?s=128&d=identicon&r=PG", "display_name": "Mathew Joy", "link": "https://stackoverflow.com/users/1366464/mathew-joy"}, "edited": false, "score": 0, "creation_date": 1573060039, "post_id": 58734915, "comment_id": 103760643, "body": "@scohe001 Thanks, It is a good thought. But I think the problem is C, which is supposed to be an interface, now is aware of B, the implementation header."}, {"owner": {"reputation": 111, "user_id": 1366464, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6acb87d187b4278b5caeeb7ec47bd782?s=128&d=identicon&r=PG", "display_name": "Mathew Joy", "link": "https://stackoverflow.com/users/1366464/mathew-joy"}, "edited": false, "score": 0, "creation_date": 1573067012, "post_id": 58734915, "comment_id": 103763913, "body": "@scohe001 Ahh...Good one. I tried a small implementation, it works better than I expected with the whole DI work flow. Thanks."}], "tags": [], "owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "is_accepted": true, "score": 1, "last_activity_date": 1573061105, "last_edit_date": 1573061105, "creation_date": 1573058800, "answer_id": 58734915, "question_id": 58734769, "link": "https://stackoverflow.com/questions/58734769/c-how-to-do-dependency-injection-on-a-derived-class/58734915#58734915", "title": "C++ How to do dependency injection on a derived class?", "body": "<p>You can add another abstract class in between <code>B</code> and <code>D</code>:</p>\n\n<pre><code>class B : public A {\npublic:\n  string Identify() {return \"B\"; }\n};\n\nclass C : public B {\npublic:\n    virtual string D_Work() = 0;    \n};\n\nclass D : public C {\npublic:\n  string D_Work() {return \"D_Work\"; }\n};\n</code></pre>\n\n<p>See it work here: <a href=\"https://ideone.com/eiPBPx\" rel=\"nofollow noreferrer\">ideone</a></p>\n\n<hr>\n\n<p>It looks like I may have misunderstood what you want. It seems you want to be able to continue using only an <code>A</code> pointer. In that case, I'd add a virtual <code>D_Work()</code> function to <code>A</code> that throws:</p>\n\n<pre><code>class A {\npublic:\n  virtual string Identify() = 0;\n  virtual string D_Work() { throw; } // If it's not defined, throw\n};\n</code></pre>\n\n<p>See it work here: <a href=\"https://ideone.com/tBvmNi\" rel=\"nofollow noreferrer\">ideone</a></p>\n"}, {"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1573069061, "creation_date": 1573069061, "answer_id": 58737376, "question_id": 58734769, "link": "https://stackoverflow.com/questions/58734769/c-how-to-do-dependency-injection-on-a-derived-class/58737376#58737376", "title": "C++ How to do dependency injection on a derived class?", "body": "<p>The other approach is that you have multiple interfaces I, J ,K, and pure methods in A like GetI() that return pointers to that interface.</p>\n\n<p>Then All your implementation classes implement A, plus any other interfaces plus any of the GetX() methods.</p>\n\n<p>Your interface is A,I,J,K, and that is all that is exposed. That is all that needs to be mocked.</p>\n\n<p>Ultimately, the continuous updating of A to add new classes gets tiresome, so you invest in a different mechanism for getting the interfaces, probably based on a token declared in the interface class, and a template method in A that resolves the token and return type by calling an implementation method that does the same. Or you just give up and let the caller dynamic_cast to the interfaces.</p>\n\n<p>Sometime soon you end up with COM, or something very like it.</p>\n\n<pre><code>class A;\n{\n  virtual String Identify() = 0;\n  virtual I* GetI() { return nullptr;}\n  virtual J* GetJ() { return nullptr;}\n  virtual K* GetK() { return nullptr;}\n};\nclass I\n{\n   virtual void Work() =0;\n};\nclass J\n{\n   virtual void MoreWork() =0;\n};\n\nclass B: A, I\n{\n  void Work() {}\n  I* GetI() { return this;}\n};\nclass C: A, J\n{\n  void MoreWork() {}\n  I* GetJ() { return this;}\n};\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 1366464, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6acb87d187b4278b5caeeb7ec47bd782?s=128&d=identicon&r=PG", "display_name": "Mathew Joy", "link": "https://stackoverflow.com/users/1366464/mathew-joy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 58734915, "answer_count": 2, "score": 1, "last_activity_date": 1573069061, "creation_date": 1573058217, "question_id": 58734769, "link": "https://stackoverflow.com/questions/58734769/c-how-to-do-dependency-injection-on-a-derived-class", "title": "C++ How to do dependency injection on a derived class?", "body": "<p>I have a base class B derived from an abstract class A. The idea of having abstract class A is to facilitate Dependency Injection and Mocking while unit testing. So A have no implementation. Almost like C# interface. All works fine. </p>\n\n<p>Now I have a derived class D that is inherited from B. The problem now is D does not have an abstract class to facilitate DI or Mocking. Here is a little code that explains the problem:</p>\n\n<pre><code>class A // Abstract\n{\npublic:\n  virtual String Identify() = 0;\n};\n\nclass B : public A\n{\npublic:\n  String Identify() {return \"B\"; }\n};\n\nclass D : public B\n{\npublic:\n  String D_Work() {return \"D_Work\"; }\n};\n</code></pre>\n\n<p>So to use B, I do <code>A *b = new B();</code> which is fine. The using class does not know the type B. new() is done by a factory or the object is just passed in. </p>\n\n<p>But to use D, I either need the actual type (which I am trying to get away) or use type A and cast to call methods like <code>A *d = new D(); ((D*)d)-&gt;D_Work())</code> (using c-style for simplicity) which again will require the user to know the type. Any thoughts on the design?</p>\n"}, {"tags": ["c++", "loops", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1573060671, "post_id": 58734695, "comment_id": 103760984, "body": "Please check if <a href=\"https://stackoverflow.com/a/44083682/620382\">this answer</a> helps you. While it is a more specific context, I believe it applies also to your more generic case."}], "answers": [{"tags": [], "owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "is_accepted": false, "score": 1, "last_activity_date": 1573066424, "creation_date": 1573066424, "answer_id": 58736791, "question_id": 58734695, "link": "https://stackoverflow.com/questions/58734695/is-it-possible-to-parallelize-with-openmp-a-list-that-can-get-added-new-elements/58736791#58736791", "title": "Is it possible to parallelize with OpenMP a list that can get added new elements every iteration?", "body": "<p>I don't think its possible to grow the size of a parallel for loop once it has been started.</p>\n\n<p>You can run multiple parallel for loops one after the other until all the data has been processed as proposed in <a href=\"https://stackoverflow.com/a/44083682/9614249\">this answer</a>. Something like:</p>\n\n<pre><code>Data proccessInParallel(Data d) {\n    Data newData\n    #pragma omp parellel for\n    for (int i = 0; i &lt; d.size i++) {\n        // Do some processing\n        if (create_new) {\n            #pragma omp critical\n            {\n                newData.push_back(data)\n            }\n        }\n    }\n    return newData;\n}\n\nint main() {\n   Data data;\n   // Process data in batches until no new data is created\n   do {\n       data = proccessInParallel(data);\n   } while (!data.empty());\n\n</code></pre>\n\n<p>The downside being that some threads may be unused while between \"batches\" being processed.</p>\n\n<hr>\n\n<p>You can also try using <a href=\"https://en.wikibooks.org/wiki/OpenMP/Tasks\" rel=\"nofollow noreferrer\">tasks</a> to analyze new list items without waiting to start another for loop.</p>\n\n<p>Maybe something like:</p>\n\n<pre><code>\n#pragma omp parallel for\nfor (int i = 0; i &lt; N; i++) {\n    process(data[i]);\n    if (new_data) {\n        #pragma omp task\n        {\n        process(new_data);\n        }\n    }\n}\n</code></pre>\n\n<p>The task will execute as soon as a thread becomes available to execute it.</p>\n"}], "owner": {"reputation": 107, "user_id": 3848742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba9eb7b22d1c50aa191dd7ae83df9bec?s=128&d=identicon&r=PG&f=1", "display_name": "David Moreno", "link": "https://stackoverflow.com/users/3848742/david-moreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573066424, "creation_date": 1573057958, "question_id": 58734695, "link": "https://stackoverflow.com/questions/58734695/is-it-possible-to-parallelize-with-openmp-a-list-that-can-get-added-new-elements", "title": "Is it possible to parallelize with OpenMP a list that can get added new elements every iteration?", "body": "<p>Is there any way I could use openMP to parallelize a loop with a list that might have more elements added each iteration? As far as I understand openMP can parallelize a for loop by diving the range in chunks for each thread, but in this case the range changes, for one case the loop might have 10 iterations and for another one 100, the thing is that in the list I will usually have around 10-20 elements.</p>\n\n<p>Here's an example of what I'd like to parallelize (note that the order in which things are inserted into the vectorOfResults doesn't matter)</p>\n\n<pre><code>while(!list.empty()) {\n vectorOfResults.push_back(performExpensiveFunction());\n if (conditions) {\n   add new elements to the list;\n }\n}\n</code></pre>\n\n<p>I've been thinking about doing something like, inside the while loop, have a for loop with the current \"batch\" of elements in the list (copy them in a temporary list) and then the next while iteration will use the newly added elements, but I was thinking if there was a way to do this using other openmp constructs. (I only now a little bit about openmp).</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c++", "list", "operator-overloading"], "comments": [{"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573057692, "post_id": 58734578, "comment_id": 103759282, "body": "What makes you think you can do a proper implementation of <code>operator==</code> without iterating the list?"}, {"owner": {"reputation": 3, "user_id": 12312630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD6FrkxABYhApaZGImUCMTjtaqP3Xu_TTKaEYNR=k-s128", "display_name": "Amar Anto", "link": "https://stackoverflow.com/users/12312630/amar-anto"}, "reply_to_user": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573058268, "post_id": 58734578, "comment_id": 103759604, "body": "Sorry, i confused the operator, my question was for the operator=."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1573058519, "post_id": 58734578, "comment_id": 103759777, "body": "What if the lists in each object are not the same size?  You really shouldn&#39;t be using <code>operator=</code> for business logic like this.  Create a <code>set_equal</code> function or similar."}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1573059130, "post_id": 58734578, "comment_id": 103760146, "body": "My question still stands despite the change of operator. The operator will need to work with every element of the list, right?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1573059332, "post_id": 58734578, "comment_id": 103760256, "body": "1) There&#39;s nothing wrong with inheriting from a <code>std</code> container. 2) Are you trying to ask how to invoke <code>std::list</code>&#39;s assignment operator, as part of the assignment operator of your subclass?"}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573060506, "post_id": 58734578, "comment_id": 103760898, "body": "@SamVarshavchik, some people <a href=\"https://quuxplusone.github.io/blog/2018/12/11/dont-inherit-from-std-types/\" rel=\"nofollow noreferrer\">strongly suggest</a> that standard types should not be inherited."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573060635, "post_id": 58734578, "comment_id": 103760966, "body": "If one accepts everything that everyone &quot;strongly suggests&quot; on the Internet, they won&#39;t be able to write a single C++ program, because, on matter what, someone will &quot;strongly suggest&quot; that it&#39;s a bad idea."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1573065843, "post_id": 58734578, "comment_id": 103763406, "body": "Unclear (to me): what does <i>&quot;... to equalize the elements...&quot;</i> mean?  What are you trying to do with the 2 lists and why/how is this different from assignment (the expected operation)?"}, {"owner": {"reputation": 3, "user_id": 12312630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD6FrkxABYhApaZGImUCMTjtaqP3Xu_TTKaEYNR=k-s128", "display_name": "Amar Anto", "link": "https://stackoverflow.com/users/12312630/amar-anto"}, "edited": false, "score": 0, "creation_date": 1573113888, "post_id": 58734578, "comment_id": 103777644, "body": "Exactly the assignment."}, {"owner": {"reputation": 3, "user_id": 12312630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD6FrkxABYhApaZGImUCMTjtaqP3Xu_TTKaEYNR=k-s128", "display_name": "Amar Anto", "link": "https://stackoverflow.com/users/12312630/amar-anto"}, "edited": false, "score": 0, "creation_date": 1573117240, "post_id": 58734578, "comment_id": 103779232, "body": "I edited the post."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1573123511, "post_id": 58734578, "comment_id": 103782624, "body": "What&#39;s wrong with <code>std::fill(lst.begin(), lst.end(), value)</code>?"}], "owner": {"reputation": 3, "user_id": 12312630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD6FrkxABYhApaZGImUCMTjtaqP3Xu_TTKaEYNR=k-s128", "display_name": "Amar Anto", "link": "https://stackoverflow.com/users/12312630/amar-anto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573113857, "creation_date": 1573057530, "last_edit_date": 1573113857, "question_id": 58734578, "link": "https://stackoverflow.com/questions/58734578/overloading-operator-for-a-class-that-inherit-a-std-list-in-c", "title": "Overloading Operator= for a class that inherit a std list in C++", "body": "<pre><code>class A : protected list&lt;Type*&gt;\n</code></pre>\n\n<p>I know that it's a bad practice to inherit from std, but, only for testing: an operator= for this class should have to equalize the elements of the given class list. So, how can i do this directly (without iterating the two list)? And so (assuming that c is the given object, overloading the operator=) <code>(*this) = c</code> or something like <code>(*this) = c.list</code> ?</p>\n\n<p>So, is this correct?</p>\n\n<pre><code>void A::operator=(const A&amp; c)\n{\n    (*this) = c;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573057580, "post_id": 58734474, "comment_id": 103759221, "body": "<i>If we need to explicitly instantiate class template, it should be <code>template &lt;&gt; class myclass &lt;int&gt;</code></i> Why?  Who told you that?"}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573058068, "post_id": 58734658, "comment_id": 103759479, "body": "For 2, since the OP has <code>myclass &lt;int&gt; obj;</code> in the source file, doesn&#39;t the compiler implicitly instantiate the template for <code>int</code>?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573058094, "post_id": 58734658, "comment_id": 103759502, "body": "@NathanOliver-ReinstateMonica Yes it does. But it does not explicitly instantiate it."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "edited": false, "score": 0, "creation_date": 1573058181, "post_id": 58734658, "comment_id": 103759547, "body": "I believe it is also worth mentioning that member functions (if not deleted) are only <b>declared</b>, rather than defined, when the class template is instantiated."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 4, "last_activity_date": 1573057916, "last_edit_date": 1573057916, "creation_date": 1573057843, "answer_id": 58734658, "question_id": 58734474, "link": "https://stackoverflow.com/questions/58734474/definition-of-a-template-function-inside-cpp-file-is-not-working-even-though-i/58734658#58734658", "title": "Definition of a template function inside .cpp file is not working even though I am instantiating a dummy object in .cpp file", "body": "<blockquote>\n  <ol>\n  <li>If we need to explicitly instantiate class template, it should be <code>template &lt;&gt; class myclass &lt;int&gt;</code></li>\n  </ol>\n</blockquote>\n\n<p>No, it should not. That is not syntax for explicit instantiation. (It is syntax for template specialisation.)</p>\n\n<blockquote>\n  <p>Why we shouldn't use <code>&lt;&gt;</code> in this case?</p>\n</blockquote>\n\n<p>Because that is not syntax for explicit instantiation. The correct syntax is:</p>\n\n<pre><code>template class|struct template-name &lt; argument-list &gt; ;\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>am unable to understand why this is throwing error.</li>\n  </ol>\n</blockquote>\n\n<p>Because there is no explicit instantiation definition for the template. Without explicit instantiation, a template may not be used in TU where the template has not been defined.</p>\n"}, {"tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 3, "last_activity_date": 1573058097, "creation_date": 1573058097, "answer_id": 58734737, "question_id": 58734474, "link": "https://stackoverflow.com/questions/58734474/definition-of-a-template-function-inside-cpp-file-is-not-working-even-though-i/58734737#58734737", "title": "Definition of a template function inside .cpp file is not working even though I am instantiating a dummy object in .cpp file", "body": "<p>Your first question was why writing:</p>\n\n<pre><code>template&lt;&gt; class myclass &lt;int&gt;;\n</code></pre>\n\n<p>causes an undefined reference error. The answer is that <code>template&lt;&gt;</code> declares an explicit specialization: it's saying that there is a special definition of <code>myclass&lt;int&gt;::doSomething</code> that takes the place of the generic definition earlier in the file. However, the definition of the specialization is not provided. Therefore, no definition of <code>myclass&lt;int&gt;::doSomething</code> is emitted when <code>template.cpp</code> is translated.</p>\n\n<p>Your second question was why replacing the explicit instantiation with:</p>\n\n<pre><code>myclass &lt;int&gt; obj;\n</code></pre>\n\n<p>in <code>template.cpp</code> did not cause <code>myClass&lt;int&gt;::doSomething</code> to be emitted from that translation unit. The answer is twofold:</p>\n\n<ol>\n<li><p>When the compiler implicitly instantiates <code>myclass&lt;int&gt;</code> when translating <code>template.cpp</code>, it does <em>not</em> implicitly instantiate <code>myclass&lt;int&gt;::doSomething</code> because, at that point, the function's definition is not yet needed.</p></li>\n<li><p>Even if the compiler were to implicitly instantiate <code>myclass&lt;int&gt;::doSomething</code> during the translation of <code>template.cpp</code>, that implicit instantiation is NOT guaranteed to make that instantiated definition available to other translation units. (The compiler may, in effect, generate it with internal linkage.)</p></li>\n</ol>\n\n<p>See C++17 [temp]/7</p>\n\n<blockquote>\n  <p>A function template, member function of a class template, variable template, or static data member of a\n  class template shall be defined in every translation unit in which it is implicitly instantiated (17.7.1) unless\n  the corresponding specialization is explicitly instantiated (17.7.2) in some translation unit; no diagnostic is\n  required.</p>\n</blockquote>\n\n<p>What this is saying is that if you need to call a function template from translation unit 1, but you only want to define that function template in translation unit 2, then translation unit 2 must <strong>explicitly instantiate</strong> the function template with the desired arguments. An implicit instantiation doesn't count.</p>\n\n<p>(Note that the explicit instantiation of <code>myclass&lt;int&gt;</code> will also implicitly instantiate the definitions of all of <code>myclass&lt;int&gt;</code>'s member functions.)</p>\n"}], "owner": {"reputation": 3954, "user_id": 3137388, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/98f780bca09821cbd63d84b8d6e028df?s=128&d=identicon&r=PG&f=1", "display_name": "kadina", "link": "https://stackoverflow.com/users/3137388/kadina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58734737, "answer_count": 2, "score": 2, "last_activity_date": 1573058097, "creation_date": 1573057175, "question_id": 58734474, "link": "https://stackoverflow.com/questions/58734474/definition-of-a-template-function-inside-cpp-file-is-not-working-even-though-i", "title": "Definition of a template function inside .cpp file is not working even though I am instantiating a dummy object in .cpp file", "body": "<p>I understood the concept of templates and why do we need to define the template member functions in header file. And another option is where define template functions in cpp file and explicitly instantiate template classes as below.</p>\n\n<p><strong>template.h</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\ntemplate &lt;typename T&gt; class myclass\n{\n    public:\n        void doSomeThing();\n};\n</code></pre>\n\n<p><strong>template.cpp</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"template.h\"\n\nusing namespace std;\n\ntemplate &lt;typename T&gt; void myclass&lt;T&gt;::doSomeThing()\n{\n    cout &lt;&lt; \"in DoSomething\" &lt;&lt; endl;\n}\n\ntemplate class myclass &lt;int&gt;; // Why we shouldn't use template&lt;&gt; class myclass &lt;int&gt; here?\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"template.h\"\n\nusing namespace std;\n\nint main()\n{\n    myclass&lt;int&gt; obj;\n    obj.doSomeThing();\n}\n</code></pre>\n\n<p>I am compiling on Ubuntu OS using <code>g++ main.cpp template.cpp</code> and I am able to call <code>doSomeThing()</code></p>\n\n<p>I have couple of questions as below.</p>\n\n<ol>\n<li>If we need to explicitly instantiate class template, it should be\n<code>template &lt;&gt; class myclass &lt;int&gt;</code> But when I use this in\ntemplate.cpp instead of <code>template class myclass &lt;int&gt;</code>, it is\nthrowing <strong>undefined reference to 'myclass::doSomeThing()'</strong>\nerror. Why we shouldn't use <code>&lt;&gt;</code> in this case?</li>\n<li><p>I tried to instantiate an object for myclass (for int) as <code>myclass\n&lt;int&gt; obj;</code> instead of <code>template &lt;&gt; class myclass &lt;int&gt;;</code> in\ntemplate.cpp as below.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"template.h\"\n\nusing namespace std;\n\ntemplate &lt;typename T&gt; void myclass&lt;T&gt;::doSomeThing()\n{\n    cout &lt;&lt; \"in DoSomething\" &lt;&lt; endl;\n}\n\nmyclass &lt;int&gt; obj;\n</code></pre>\n\n<p>I thought template.cpp has both template declaration through template.h and all the template function definitions in template.cpp so creating an object for int type will create the class for int and it will contain the function definition for int type. So when g++ compiles main.cpp, it has all the functions for int type and creation of object for myclass (for int data type) will work if I compile template.cpp first and main.cpp after as <code>g++ template.cpp main.cpp</code>. But this is also throwing <strong>main.cpp:(.text+0x1f): undefined reference to `myclass::doSomeThing()'</strong> error. I am unable to understand why this is throwing error. Can anyone please help me to understand why this is not working.</p></li>\n</ol>\n"}, {"tags": ["c++", "function", "class", "inline", "declaration"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573057046, "post_id": 58734399, "comment_id": 103758946, "body": "There are many reasons for that. It is not important to you to understand all those reasons <b><i>now</i></b>. As you continue to go along with your C++ studies, and become more knowledgeable and skilled with C++, you will automatically learn and recognize the many differences between either approaches. Don&#39;t waste your time focusing on these trivialities at this time, and stay focused on learning the language."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573057047, "post_id": 58734399, "comment_id": 103758947, "body": "related/dupe: <a href=\"https://stackoverflow.com/questions/9075931/function-declaration-inside-or-outside-the-class\" title=\"function declaration inside or outside the class\">stackoverflow.com/questions/9075931/&hellip;</a>.  Just define them outside so your class isn&#39;t so big you can&#39;t read it."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1573057111, "post_id": 58734399, "comment_id": 103758974, "body": "<code>inline</code> has little to do with actual inlining and more to do with ODR (One Definition Rule)."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1573057166, "post_id": 58734399, "comment_id": 103759001, "body": "Don&#39;t forget that often you need to pass around the interface to the class, the definition, but for one reason or another can&#39;t pass around how the class works."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1573057213, "post_id": 58734399, "comment_id": 103759021, "body": "@FedericoklezCulloca Functions defined in a class declaration <i>are</i> implicitly <code>inline</code>. You can read that straight out of the C++ standard."}], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 5, "last_activity_date": 1573057374, "last_edit_date": 1573057374, "creation_date": 1573057032, "answer_id": 58734437, "question_id": 58734399, "link": "https://stackoverflow.com/questions/58734399/what-is-the-benefit-of-declaring-a-function-outside-class-in-c/58734437#58734437", "title": "What is the benefit of declaring a function outside class in c++?", "body": "<p>Defining a complex member function in a class makes the class definition too complicated and not well-readable.</p>\n\n<p>Bear in mind that you can declare a member function with the function specifier inline without its definition within the class.</p>\n\n<p>Take into account that if the compiler will make non-inline calls of a member function of a class defined within the class nevertheless all other requirements to the function will be the same as for an inline function. For example the function definition with the class definition can be included in many compilation units.</p>\n\n<p>Defining a member function outside a class allows to separate the interface and its realization.</p>\n"}], "owner": {"reputation": 125, "user_id": 9136850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d28f2b8d41ff492bb57c4c6f95d6d5?s=128&d=identicon&r=PG&f=1", "display_name": "samarendra chandan bindu Dash", "link": "https://stackoverflow.com/users/9136850/samarendra-chandan-bindu-dash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2879, "favorite_count": 0, "closed_date": 1573058132, "accepted_answer_id": 58734437, "answer_count": 1, "score": 4, "last_activity_date": 1573057594, "creation_date": 1573056888, "last_edit_date": 1573057594, "question_id": 58734399, "link": "https://stackoverflow.com/questions/58734399/what-is-the-benefit-of-declaring-a-function-outside-class-in-c", "closed_reason": "Duplicate", "title": "What is the benefit of declaring a function outside class in c++?", "body": "<p>I am fairly new to C++. I encountered two ways of declaring member functions in c++, ie. Inside class and Outside Class. I searched about the differences and it says the functions that are defined inside class are treated as inline functions.</p>\n\n<p>When I previously read about inline functions it stated that inline is just a request to the compiler to substitute function body instead of calling the functions. But if the function is complex (like recursive, contains static variables, switch etc.) then the compiler will ignore the request.\nSo even if we declare the function inside class if it is complex compiler will ignore the request. Then what is the point of defining functions outside class, if we can just let this decision on compiler itself to automatically do it for us?</p>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 7321370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209949778613430/picture?type=large", "display_name": "davidra7", "link": "https://stackoverflow.com/users/7321370/davidra7"}, "is_accepted": true, "score": 0, "last_activity_date": 1573561650, "creation_date": 1573561650, "answer_id": 58818748, "question_id": 58734369, "link": "https://stackoverflow.com/questions/58734369/stm32-external-flash-reading-device-id-using-hal-libraries/58818748#58818748", "title": "STM32 External flash reading device ID using HAL libraries", "body": "<p>Try to set recieved size as 3 and apply recieve function</p>\n\n<pre><code>void QSPI_read_ID(QSPI_HandleTypeDef *hqspi){\n  QSPI_CommandTypeDef     sCommand;\n    uint8_t tmp[3];\n    int         len;\n\n  /* READ ID ------------------------------------------ */\n  sCommand.InstructionMode   = QSPI_INSTRUCTION_1_LINE;\n  sCommand.Instruction       = JEDEC_ID_CMD;\n  sCommand.AddressMode       = QSPI_ADDRESS_NONE;\n  sCommand.AlternateByteMode = QSPI_ALTERNATE_BYTES_NONE;\n  sCommand.DataMode          = QSPI_DATA_NONE;\n  sCommand.DummyCycles       = 8;\n  sCommand.DdrMode           = QSPI_DDR_MODE_DISABLE;\n  sCommand.DdrHoldHalfCycle  = QSPI_DDR_HHC_ANALOG_DELAY;\n  sCommand.SIOOMode          = QSPI_SIOO_INST_EVERY_CMD;\n  sCommand.NbData        = 3;\n\n  if (HAL_QSPI_Command(hqspi, &amp;sCommand, HAL_QPSI_TIMEOUT_DEFAULT_VALUE) != HAL_OK)\n  {\n    QSPI_Flash_Error_Handler(hqspi); \n  }\n  if (HAL_QSPI_Receive(hqspi, tmp , HAL_QPSI_TIMEOUT_DEFAULT_VALUE) != HAL_OK){\n    QSPI_Flash_Error_Handler(hqspi); \n  } \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 9042970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5ddde74ea07475a638376edf99396c?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/9042970/lukas"}, "is_accepted": false, "score": 0, "last_activity_date": 1573563125, "creation_date": 1573563125, "answer_id": 58819173, "question_id": 58734369, "link": "https://stackoverflow.com/questions/58734369/stm32-external-flash-reading-device-id-using-hal-libraries/58819173#58819173", "title": "STM32 External flash reading device ID using HAL libraries", "body": "<p>Yes that works! I did not realise that I have to call the receive function to get the bytes ( Totally makes sense now ). Thanks.</p>\n\n<p>Code here if anyone is struggling with the same problem:</p>\n\n<pre><code>void QSPI_read_ID(QSPI_HandleTypeDef *hqspi){\n  QSPI_CommandTypeDef     sCommand;\n uint8_t reg[3]; // N25Q128A13EF840E 0xEF, 0xAB, 0x21\n\n  /* READ ID ------------------------------------------ */\n  sCommand.InstructionMode   = QSPI_INSTRUCTION_1_LINE;\n  sCommand.Instruction       = JEDEC_ID_CMD;\n  sCommand.AddressMode       = QSPI_ADDRESS_NONE;\n  sCommand.AlternateByteMode = QSPI_ALTERNATE_BYTES_NONE;\n  //sCommand.DataMode          = QSPI_DATA_NONE;\n  sCommand.DataMode = QSPI_DATA_1_LINE;\n  sCommand.NbData = sizeof(reg);\n  sCommand.DummyCycles       = 8;\n  sCommand.DdrMode           = QSPI_DDR_MODE_DISABLE;\n  sCommand.DdrHoldHalfCycle  = QSPI_DDR_HHC_ANALOG_DELAY;\n  sCommand.SIOOMode          = QSPI_SIOO_INST_EVERY_CMD;\n\n\n  if (HAL_QSPI_Command(hqspi, &amp;sCommand, HAL_QPSI_TIMEOUT_DEFAULT_VALUE) != HAL_OK)\n  {\n    QSPI_Flash_Error_Handler(hqspi); \n  }\n\n memset(reg, 0, sizeof(reg));\n\n\n    if (HAL_QSPI_Receive(hqspi, &amp;reg[0], HAL_QPSI_TIMEOUT_DEFAULT_VALUE) != HAL_OK)\n    {\n        puts('ERROR:HAL_QSPI_Receive');\n        Error_Handler();\n    }\n\n\n  HAL_Delay(10);\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9042970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5ddde74ea07475a638376edf99396c?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/9042970/lukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 58818748, "answer_count": 2, "score": 0, "last_activity_date": 1573563125, "creation_date": 1573056779, "question_id": 58734369, "link": "https://stackoverflow.com/questions/58734369/stm32-external-flash-reading-device-id-using-hal-libraries", "title": "STM32 External flash reading device ID using HAL libraries", "body": "<p>I am trying to interface with winbond external flash memory using QSPI interface : <a href=\"https://www.winbond.com/resource-files/w25m02gv%20revb%20070115.pdf\" rel=\"nofollow noreferrer\">https://www.winbond.com/resource-files/w25m02gv%20revb%20070115.pdf</a>. I am sending read Device ID command and I expect to see something like that: <a href=\"https://i.stack.imgur.com/YKFky.png\" rel=\"nofollow noreferrer\">Read device ID waveforms</a></p>\n\n<p>I have connected Logic analyzer and I can see that I am sending the required command but I am not getting any answer on D1 line:\n<a href=\"https://i.stack.imgur.com/LCQXd.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>The code that I am trying to</p>\n\n<pre><code>void QSPI_read_ID(QSPI_HandleTypeDef *hqspi){\n  QSPI_CommandTypeDef     sCommand;\n    uint32_t    tmp;\n    int         len;\n\n  /* READ ID ------------------------------------------ */\n  sCommand.InstructionMode   = QSPI_INSTRUCTION_1_LINE;\n  sCommand.Instruction       = JEDEC_ID_CMD;\n  sCommand.AddressMode       = QSPI_ADDRESS_NONE;\n  sCommand.AlternateByteMode = QSPI_ALTERNATE_BYTES_NONE;\n  sCommand.DataMode          = QSPI_DATA_NONE;\n  sCommand.DummyCycles       = 8;\n  sCommand.DdrMode           = QSPI_DDR_MODE_DISABLE;\n  sCommand.DdrHoldHalfCycle  = QSPI_DDR_HHC_ANALOG_DELAY;\n  sCommand.SIOOMode          = QSPI_SIOO_INST_EVERY_CMD;\n\n\n\n\n\n\n\n  if (HAL_QSPI_Command(hqspi, &amp;sCommand, HAL_QPSI_TIMEOUT_DEFAULT_VALUE) != HAL_OK)\n  {\n    QSPI_Flash_Error_Handler(hqspi); \n  }\n\n</code></pre>\n\n<p>If I change the dummy cycle number from 8 to lets say 24, I am able to read first 2 bytes of the device ID:\n<a href=\"https://i.stack.imgur.com/sK3Pp.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I am not sure whether I am not understanding this properly. I was under the impression that if I send the read device ID command I should invoke the D1 line to send me the ID automatically. The problem that it wont let me use more than 32 dummy cycles. </p>\n"}, {"tags": ["c++", "arrays", "char"], "comments": [{"owner": {"reputation": 557, "user_id": 3180151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xeh1I.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3180151/sebastian"}, "edited": false, "score": 0, "creation_date": 1573058841, "post_id": 58734328, "comment_id": 103759990, "body": "If you input the letter pair that you would like to find before the randomly generated string, you shouldn&#39;t have to store the randomly generated string. But yes, not storing the randomly generated string (you just keep overwriting <code>ch</code> which is one letter) is never going to yield a solution.  You have some of the fundamentals down, but you are also missing a loop to check for the letter pair, and your <code>chars[i+1]</code> is likely to go out of bounds and result in undefined behaviour.  It&#39;s difficult to know where to start helping without giving away the full answer to your (homework?) question."}, {"owner": {"reputation": 16165, "user_id": 3437460, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7253131fc32bf734fa570977c79182e6?s=128&d=identicon&r=PG&f=1", "display_name": "user3437460", "link": "https://stackoverflow.com/users/3437460/user3437460"}, "edited": false, "score": 0, "creation_date": 1573059185, "post_id": 58734328, "comment_id": 103760176, "body": "You need to store your random string somewhere before you can check it. Currently you are checking on your &quot;a-z&quot; string and you are not checking your randomly generated string!"}, {"owner": {"reputation": 557, "user_id": 3180151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xeh1I.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3180151/sebastian"}, "edited": false, "score": 0, "creation_date": 1573061979, "post_id": 58734328, "comment_id": 103761655, "body": "If you read and store <code>letter1</code> and <code>letter2</code> before you &quot;generate&quot; the random string, you do not need to store the random string."}], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 3180151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xeh1I.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3180151/sebastian"}, "edited": false, "score": 0, "creation_date": 1573058918, "post_id": 58734895, "comment_id": 103760039, "body": "This isn&#39;t really an answer: its more of a (valid) critique, but shouldn&#39;t be posted as an answer."}, {"owner": {"reputation": 795, "user_id": 10010538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae98bb47d1be523619caaba61416d37?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/10010538/eric"}, "reply_to_user": {"reputation": 557, "user_id": 3180151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xeh1I.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3180151/sebastian"}, "edited": false, "score": 0, "creation_date": 1573059224, "post_id": 58734895, "comment_id": 103760200, "body": "@Sebastian I pointed out exactly what is wrong and why. You don&#39;t have to write  code for someone to answer their question."}, {"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 0, "creation_date": 1573060511, "post_id": 58734895, "comment_id": 103760901, "body": "Since there was no actual question except &quot;I would appreciate any help.&quot; this is a valid answer in my eyes."}, {"owner": {"reputation": 557, "user_id": 3180151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xeh1I.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3180151/sebastian"}, "edited": false, "score": 0, "creation_date": 1573061891, "post_id": 58734895, "comment_id": 103761621, "body": "I&#39;m not trying to be pedantic, but this doesn&#39;t qualify as a SO answer and should not be posted in the answers section. I made the same mistake myself a few days ago. An answer would provide an an answer to to the problem, and not simply reasons why the current implementation will fail."}, {"owner": {"reputation": 795, "user_id": 10010538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae98bb47d1be523619caaba61416d37?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/10010538/eric"}, "reply_to_user": {"reputation": 557, "user_id": 3180151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xeh1I.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3180151/sebastian"}, "edited": false, "score": 0, "creation_date": 1573071745, "post_id": 58734895, "comment_id": 103765847, "body": "@Sebastian I recommend you to take a look at <a href=\"https://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>. \u201eAny answer that gets the asker going in the right direction is helpful\u201c. This also makes it very clear that an answer doesn\u2018t always have to provide a full working solution to the problem to qualify as an answer. An answer is simply supposed to answer the question. In this case the question was for help on why his program isn\u2018t doing what it is supposed to do. I think this answer provides that."}], "tags": [], "owner": {"reputation": 795, "user_id": 10010538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae98bb47d1be523619caaba61416d37?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/10010538/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1573058704, "creation_date": 1573058704, "answer_id": 58734895, "question_id": 58734328, "link": "https://stackoverflow.com/questions/58734328/checking-for-character-pair-in-array/58734895#58734895", "title": "checking for character pair in array", "body": "<p>First, you are not storing your randomly generated chars</p>\n\n<pre><code>for (i=0; i&lt;num; i++)\n{\n    ch = chars[rand()%26];\n    std::cout &lt;&lt; ch;\n}\n</code></pre>\n\n<p>This just writes a random char in ch and displays it on the console with each iteration. You don't store your data, ch just contains the last random char after your loop ends and everything else is lost. </p>\n\n<p>The part where you want to search is double wrong.</p>\n\n<pre><code>if ((chars[i] == letter1) &amp;&amp; (chars[i+1]==letter2))\n    std::cout &lt;&lt; \"It is in your string. \";\nelse\n    std::cout &lt;&lt; \"You do not have \" &lt;&lt; letter1 &lt;&lt; letter2 &lt;&lt; \" in your string\";\n</code></pre>\n\n<ol>\n<li>This isn't inside a loop, i is simply always going to be num-1.  </li>\n<li>The array you are checking is chars which is your const array containing \"abcdefghijklmnopqrstuvwxyz\". This doesn't contain your randomly generated chars.</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 12109851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a182e4e018cf8b464e56cb433803232e?s=128&d=identicon&r=PG&f=1", "display_name": "starlight96", "link": "https://stackoverflow.com/users/12109851/starlight96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573058704, "creation_date": 1573056644, "last_edit_date": 1573056747, "question_id": 58734328, "link": "https://stackoverflow.com/questions/58734328/checking-for-character-pair-in-array", "title": "checking for character pair in array", "body": "<p>I have a character array that produces a random array of lowercase letters in the length that the user inputs. my problem is that after the array of random letters is produced the user inputs a pair of charaters(two letters) and my code should check if that pair is in the random array that was produced. it worked fine when it just checked for one letter but when i introduced the second one it does not work.I would appreciate any help. </p>\n\n<pre><code>#include &lt;ctime&gt;\n#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n\nint main() {\n    std::srand(std::time(NULL));\n    int i, num;\n    char letter1, letter2, ch, r;\n    const char chars[]=\"abcdefghijklmnopqrstuvwxyz\";\n\n\n    std::cout &lt;&lt; \"How many letters do you want in your string? \";\n    std::cin &gt;&gt; num;\n\n    for (i=0; i&lt;num; i++)\n    {\n        ch = chars[rand()%26];\n        std::cout &lt;&lt; ch;\n    }\n\n    std::cout &lt;&lt; \"\\nWhat letter pair would you like to find? \";\n    std::cin &gt;&gt; letter1 &gt;&gt; letter2;\n\n\n    if ((chars[i] == letter1) &amp;&amp; (chars[i+1]==letter2))\n        std::cout &lt;&lt; \"It is in your string. \";\n    else\n        std::cout &lt;&lt; \"You do not have \" &lt;&lt; letter1 &lt;&lt; letter2 &lt;&lt; \" in your string\";\n}\n</code></pre>\n"}, {"tags": ["c++", "sorting", "vector", "std-pair"], "comments": [{"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1573056607, "post_id": 58734271, "comment_id": 103758697, "body": "Are you looking for cases where <code>vec[n].second == vec[n + 1].first</code>?"}, {"owner": {"reputation": 1, "user_id": 11107020, "user_type": "registered", "profile_image": "https://graph.facebook.com/886395341712473/picture?type=large", "display_name": "Dominik Wo\u017aniak", "link": "https://stackoverflow.com/users/11107020/dominik-wo%c5%baniak"}, "reply_to_user": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1573057036, "post_id": 58734271, "comment_id": 103758943, "body": "Yes, it works but only if vec is in sequence."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1573057213, "post_id": 58734271, "comment_id": 103759020, "body": "What are some examples that &quot;don&#39;t work&quot;? What does it do? What <i>should</i> it do in those cases?"}, {"owner": {"reputation": 1, "user_id": 11107020, "user_type": "registered", "profile_image": "https://graph.facebook.com/886395341712473/picture?type=large", "display_name": "Dominik Wo\u017aniak", "link": "https://stackoverflow.com/users/11107020/dominik-wo%c5%baniak"}, "edited": false, "score": 0, "creation_date": 1573057395, "post_id": 58734271, "comment_id": 103759123, "body": "For example: input: (4,2), (4,5), (5,2) output: (4,5), (5,2) it work, but for (5,2) ,(4,2), (4,5) I get empty vec, although the outputs should be the same."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1573057902, "post_id": 58734271, "comment_id": 103759391, "body": "<a href=\"http://coliru.stacked-crooked.com/a/6e5b10d426db5c29\" rel=\"nofollow noreferrer\">Can&#39;t reproduce</a>"}, {"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 0, "creation_date": 1573059837, "post_id": 58734271, "comment_id": 103760529, "body": "So the question becomes how to sort a vector?"}, {"owner": {"reputation": 24653, "user_id": 254306, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0745d192010b591257e771df7f439524?s=128&d=identicon&r=PG", "display_name": "Travis Gockel", "link": "https://stackoverflow.com/users/254306/travis-gockel"}, "edited": false, "score": 0, "creation_date": 1573077051, "post_id": 58734271, "comment_id": 103767877, "body": "&quot;Yes, it works but only if vec is in sequence.&quot; I&#39;m not sure what this statement means. All <code>std::vector</code>s are <a href=\"https://en.cppreference.com/w/cpp/container#Sequence_containers\" rel=\"nofollow noreferrer\">sequence containers</a>, so I assume you don&#39;t mean that. Are you asking how to use <a href=\"https://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\"><code>std::sort</code></a>?"}], "owner": {"reputation": 1, "user_id": 11107020, "user_type": "registered", "profile_image": "https://graph.facebook.com/886395341712473/picture?type=large", "display_name": "Dominik Wo\u017aniak", "link": "https://stackoverflow.com/users/11107020/dominik-wo%c5%baniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573057376, "creation_date": 1573056462, "last_edit_date": 1573057376, "question_id": 58734271, "link": "https://stackoverflow.com/questions/58734271/sorting-vertex-in-vector-with-stdpair", "title": "Sorting vertex in vector with std::pair", "body": "<p>I tried to return elements in vector where second element in pair is first element in second pair. For example:</p>\n\n<p>input: (4,2), (4,5), (5,2)<br>\noutput: (4,5), (5,2)</p>\n\n<pre><code>std::vector&lt;std::pair&lt;int, int&gt;&gt; buff;\n\nfor (auto elem : buff){\n    auto searching = elem.second;\n\n    for (auto el : buff){\n        if ( el.first == searching ){\n            vec.push_back(el);\n            vec.push_back(elem);\n        }\n    }\n}\n</code></pre>\n\n<p>Unfortunately, it doesn't work for other examples.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1573056487, "post_id": 58734184, "comment_id": 103758610, "body": "The expansion of <code># ## #</code> to <code>##</code> isn&#39;t about the stringize operation but rather due to the token-concatenation operator <code>##</code>. I think."}, {"owner": {"reputation": 77, "user_id": 11243929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2681d1950a71602019cfdded8fa0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/11243929/kent-g-budge"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1573056636, "post_id": 58734184, "comment_id": 103758717, "body": "The example explains that the ## is not a concatenation operator when expanded, e.g.  ``` c hash_hash c ``` fully expands to <code>c ## d</code>. Which puzzles me further."}, {"owner": {"reputation": 299, "user_id": 10634703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e552286e260613fba60f0ee08b8362?s=128&d=identicon&r=PG&f=1", "display_name": "MadKarel", "link": "https://stackoverflow.com/users/10634703/madkarel"}, "edited": false, "score": 1, "creation_date": 1573057424, "post_id": 58734184, "comment_id": 103759145, "body": "The example shows you how to &quot;escape&quot; the two hash sequence in a macro. It takes the first and last hash and concatenated them using the middle double hash, which when used in another macro puts the double hash sequence on output. There is no other way how to write double hash in the middle of a macro without it concatenation the neighbouring tokens and disappearing."}, {"owner": {"reputation": 77, "user_id": 11243929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2681d1950a71602019cfdded8fa0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/11243929/kent-g-budge"}, "edited": false, "score": 0, "creation_date": 1573057627, "post_id": 58734184, "comment_id": 103759246, "body": "Ah. Thanks, MadKarel. That makes it fairly clear. So concatenation of two hashes produces a single double hash token that is not a concatenation operator. I&#39;ll got back to the standard to understand better why this is the case."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 299, "user_id": 10634703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e552286e260613fba60f0ee08b8362?s=128&d=identicon&r=PG&f=1", "display_name": "MadKarel", "link": "https://stackoverflow.com/users/10634703/madkarel"}, "edited": false, "score": 0, "creation_date": 1573058370, "post_id": 58734184, "comment_id": 103759661, "body": "@MadKarel - that sounds like an answer (a good answer, too) - you should write it as an Answer, rather than in the comments!"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 11243929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2681d1950a71602019cfdded8fa0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/11243929/kent-g-budge"}, "edited": false, "score": 0, "creation_date": 1573061064, "post_id": 58735063, "comment_id": 103761178, "body": "The preprocessor isn&#39;t <i>strictly</i> single pass, since macro expansions are rescanned, which is a kind of limited local second pass."}, {"owner": {"reputation": 77, "user_id": 11243929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2681d1950a71602019cfdded8fa0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/11243929/kent-g-budge"}, "edited": false, "score": 0, "creation_date": 1573061530, "post_id": 58735063, "comment_id": 103761429, "body": "But I think I understand now. The # ## # concatenates the two hashes into a single ##, which is not treated as a concatenation operator on rescanning because it is not part of a replacement list. The standard only talks about ## when one of the neighbor tokens is a parameter name; you have to infer from the example that it pastes whatever two tokens adjoin it in the replacement list even if neither is a parameter name."}], "tags": [], "owner": {"reputation": 299, "user_id": 10634703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e552286e260613fba60f0ee08b8362?s=128&d=identicon&r=PG&f=1", "display_name": "MadKarel", "link": "https://stackoverflow.com/users/10634703/madkarel"}, "is_accepted": false, "score": 3, "last_activity_date": 1573059447, "last_edit_date": 1573059447, "creation_date": 1573059348, "answer_id": 58735063, "question_id": 58734184, "link": "https://stackoverflow.com/questions/58734184/what-does-a-hash-token-do-in-an-object-macro-expansion-list/58735063#58735063", "title": "What does a hash token (#) do in an object macro expansion list?", "body": "<p>The example shows you how to \"escape\" the two hash sequence in a macro. It takes the first and last hash and concatenates them using the middle double hash, which when used in another macro puts the double hash sequence on output. There is no other way how to write double hash in the middle of a macro without it concatenation the neighbouring tokens and disappearing.</p>\n\n<p>This happens because C++ is designed to be compiled in one pass, so once the <code># ## #</code> sequence is preprocessed by the preprocessor into <code>##</code>, it is never \"preprocessed\" again.</p>\n"}], "owner": {"reputation": 77, "user_id": 11243929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2681d1950a71602019cfdded8fa0a4?s=128&d=identicon&r=PG&f=1", "display_name": "Kent G. Budge", "link": "https://stackoverflow.com/users/11243929/kent-g-budge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573059447, "creation_date": 1573056217, "last_edit_date": 1573056269, "question_id": 58734184, "link": "https://stackoverflow.com/questions/58734184/what-does-a-hash-token-do-in-an-object-macro-expansion-list", "title": "What does a hash token (#) do in an object macro expansion list?", "body": "<p>I've been trying to understand the description of macro expansion in the C++ preprocessor as described in an early draft of the C++14 standard.  (It's the version I could get for free, and I doubt the preprocessor has changed much since.)</p>\n\n<p>The draft gives an example:</p>\n\n<pre><code>#define hash_hash # ## #\n</code></pre>\n\n<p>and shows that this expands as ##.   I've verified that g++ has this behavior. But I cannot find an explanation for it in the actual normative text of the standard, which explains that # before a parameter name in a function macro stringizes the corresponding argument (which I understand just fine) but says nothing about what it means in any other context.</p>\n\n<p>I'm even more puzzled when I see that </p>\n\n<pre><code>#define pound #\n</code></pre>\n\n<p>expands as #, exactly as I would have initially expected. </p>\n"}, {"tags": ["c++", "macos", "opencv", "anaconda"], "comments": [{"owner": {"reputation": 2211, "user_id": 8258079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hGor17Y5EI/AAAAAAAAAAI/AAAAAAAAAMM/imoWXkV2oCM/photo.jpg?sz=128", "display_name": "Richard Barber", "link": "https://stackoverflow.com/users/8258079/richard-barber"}, "edited": false, "score": 1, "creation_date": 1573062772, "post_id": 58734136, "comment_id": 103761993, "body": "<code>otool -l &#47;usr&#47;local&#47;lib&#47;libopencv_hdf.4.0.0.dylib</code> to list properties, including what the @rpath(s) are set to.  Then see if hdf5 is still there.  If you upgrade hdf5 just make sure your newer version is still api/abi compatible with the opencv_hdf module in use."}, {"owner": {"reputation": 803, "user_id": 6173226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VlUaG.png?s=128&g=1", "display_name": "Picard", "link": "https://stackoverflow.com/users/6173226/picard"}, "reply_to_user": {"reputation": 2211, "user_id": 8258079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0hGor17Y5EI/AAAAAAAAAAI/AAAAAAAAAMM/imoWXkV2oCM/photo.jpg?sz=128", "display_name": "Richard Barber", "link": "https://stackoverflow.com/users/8258079/richard-barber"}, "edited": false, "score": 1, "creation_date": 1573063814, "post_id": 58734136, "comment_id": 103762465, "body": "thanks that was helpful. it gives me two LC_RPATHs. I believe I understand the problem now. One rpath points to my old anaconda (python) installation, but I have installed a newer version to different path. So normally the solution would be to change this rpath with install_name_tool, right? The problem is the newer anaconda version also comes with a different libhdf5 version."}], "answers": [{"tags": [], "owner": {"reputation": 803, "user_id": 6173226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VlUaG.png?s=128&g=1", "display_name": "Picard", "link": "https://stackoverflow.com/users/6173226/picard"}, "is_accepted": true, "score": 0, "last_activity_date": 1573111548, "creation_date": 1573111548, "answer_id": 58743834, "question_id": 58734136, "link": "https://stackoverflow.com/questions/58734136/linker-error-in-opencv-c-binaries-after-anaconda-reinstall/58743834#58743834", "title": "Linker error in OpenCV C++ binaries after anaconda reinstall", "body": "<p><strong>The cause:</strong></p>\n\n<p>As suggested I used <code>otool -l /usr/local/lib/libopencv_hdf.4.0.0.dylib</code> and analyzed its output. There I found that the last <code>LC_RPATH</code> pointed to my old anaconda installation, in my case <code>~/anaconda3/lib</code>. So it seams that OpenCV, the way I've originally built it, relies on the HDF5 dylib of my anaconda installation. Even the C++ binaries rely on my python anaconda installation for this.\nI previously only searched for the missing library under <code>/usr/local/lib</code> which didn't yield any results. When I removed my old anaconda version and installed a newer one, I not only removed the library but anaconda now installs into a different path as well (now <code>~/opt/anaconda</code> instead of <code>~/anaconda</code>).</p>\n\n<p><strong>The solution:</strong></p>\n\n<p>I guess the obvious solution would have been to change the @rpath of <code>libopencv_hdf.4.0.0.dylib</code> to point to the new installation. However, the newer ancaonda version comes with a newer libhdf5 version and thus a different filename.</p>\n\n<p>Instead I created a softlink in one of the @rpath locations to point to the new installation of the library.</p>\n\n<p>Both versions work. So either:</p>\n\n<p><code>ln -s ~/opt/anaconda3/lib/libhdf5.103.dylib /usr/local/lib/libhdf5.101.dylib</code></p>\n\n<p>or (assuming you've created the necessary dirs):</p>\n\n<p><code>ln -s ~/opt/anaconda3/lib/libhdf5.103.dylib ~/anconda3/lib/libhdf5.101.dylib</code></p>\n"}], "owner": {"reputation": 803, "user_id": 6173226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VlUaG.png?s=128&g=1", "display_name": "Picard", "link": "https://stackoverflow.com/users/6173226/picard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 58743834, "answer_count": 1, "score": 0, "last_activity_date": 1573111548, "creation_date": 1573056070, "last_edit_date": 1573109855, "question_id": 58734136, "link": "https://stackoverflow.com/questions/58734136/linker-error-in-opencv-c-binaries-after-anaconda-reinstall", "title": "Linker error in OpenCV C++ binaries after anaconda reinstall", "body": "<p>I reinstalled python anaconda and now my previously compiled C++ OpenCV apps are no longer working.</p>\n\n<p>When I try to run my binaries I get the following error: </p>\n\n<pre><code>dyld: Library not loaded: @rpath/libhdf5.101.dylib\n  Referenced from: /usr/local/lib/libopencv_hdf.4.0.0.dylib\n  Reason: image not found\n[1]    5054 abort      ./test\n</code></pre>\n\n<p>As far as I understand this, this means an opencv library tries to use another dynamic hdf5 library at runtime but the linker can't find it.</p>\n"}, {"tags": ["c++", "floating-point"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1573056096, "post_id": 58734034, "comment_id": 103758381, "body": "Depends what you want to do. Define the sort of &quot;comparison&quot; you&#39;re after. You cannot solve an unspecified problem."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573056138, "post_id": 58734034, "comment_id": 103758413, "body": "Convert the floating point type into the integer type?"}, {"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 0, "creation_date": 1573056165, "post_id": 58734034, "comment_id": 103758419, "body": "My first idea would be to cast the float to a long long."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573056174, "post_id": 58734034, "comment_id": 103758428, "body": "@NathanOliver-ReinstateMonica But what if the integer type is not large enough? I&#39;m not even sure how to check if it&#39;s large enough."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573056209, "post_id": 58734034, "comment_id": 103758447, "body": "@LightnessRaceswithMonica I&#39;m trying to check if one number is less than the other number, in the mathematical sense."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573056250, "post_id": 58734034, "comment_id": 103758474, "body": "@HolyBlackCat To what level of precision? To the level of all significant figures given in the respective initialisers? To something else?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573056311, "post_id": 58734034, "comment_id": 103758502, "body": "Okay, convert both to a long double.  Can&#39;t really break anything with that although you may lose some precision on the integer but that&#39;s to be expected when working with floating point types."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573056321, "post_id": 58734034, "comment_id": 103758509, "body": "How are you getting so many usable decimal places from a <code>float</code> o.O"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573056361, "post_id": 58734034, "comment_id": 103758533, "body": "@LightnessRaceswithMonica <i>&quot;How are you getting so many usable decimal places&quot;</i> By carefully picking the float. :P"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1573056392, "post_id": 58734034, "comment_id": 103758558, "body": "@HolyBlackCat lol ok- well that&#39;s another important point: will you be carefully picking all your other floats? Is that a prerequisite for your desired algorithm? There are loads of gaps in the requirements here"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1573056598, "post_id": 58734034, "comment_id": 103758692, "body": "@LightnessRaceswithMonica Answering the question about precision: Every integer variable and every floating-point variable (unless it&#39;s a NaN or infinity) represents a specific number, which is finite and has a finite amount of digits after the decimal point. I want to compare those represented numbers. That means, with full precision (that is, without discarding &#39;garbage&#39; digits from floats)."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573056908, "post_id": 58734034, "comment_id": 103758863, "body": "@uneven_mark What do you mean? Do you say I should specify if I used IEEE floats or not, or that I should break down that float to the mantissa &amp; exponent and add it to the question?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573057696, "post_id": 58734034, "comment_id": 103759285, "body": "@LightnessRaceswithMonica: OP picked 999999984306749440 which is an exact IEEE754 32 bit <code>float</code>, although the space is sparse in that region. The next one differs from it by the GDP of a small country."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1573058093, "post_id": 58734034, "comment_id": 103759500, "body": "@Bathsheba Thank you we did cover that"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1573058179, "post_id": 58734034, "comment_id": 103759544, "body": "@LightnessRaceswithMonica: I&#39;ll get me coat."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1573058791, "post_id": 58734034, "comment_id": 103759951, "body": "This works: <code>float c = a; std::cout &lt;&lt; a &lt;&lt; &quot; &lt; &quot; &lt;&lt; b &lt;&lt; &quot; = &quot; &lt;&lt; ((a-(long long)c) &lt; (b-c)) &lt;&lt; &#39;\\n&#39;;</code>  It should be a generic fix to &quot;implicit conversion lost precision&quot;.  &quot;One of the values is out of range for the other datatype&quot; is a different problem that needs a different solution."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1573059571, "post_id": 58734034, "comment_id": 103760391, "body": "@Bathsheba You&#39;ve pulled? \ud83d\ude02"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573059608, "post_id": 58734034, "comment_id": 103760413, "body": "@LightnessRaceswithMonica: Not since May 1996. Wouldn&#39;t know where to start these days."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1573059744, "post_id": 58734034, "comment_id": 103760485, "body": "@Bathsheba Gosh good luck"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573060619, "post_id": 58734034, "comment_id": 103760960, "body": "@LightnessRaceswithMonica: Yup I married young!"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1574168790, "post_id": 58734034, "comment_id": 104128409, "body": "possible duplicate of <a href=\"https://stackoverflow.com/q/32810583/995714\">Comparing uint64_t and float for numeric equivalence</a>, <a href=\"https://stackoverflow.com/q/43862716/995714\">Compare a 32 bit float and a 32 bit integer without casting to double, when either value could be too large to fit the other type exactly</a>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1574173114, "post_id": 58734034, "comment_id": 104130961, "body": "@phuclv Those are interesting, but I don&#39;t think mine is a dupe. The first one asks specifically about equality, and the second one only asks about two specific types."}], "answers": [{"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1573058393, "post_id": 58734212, "comment_id": 103759690, "body": "Looks promising; I need to think about it for a bit. I guess I&#39;ll try to implement your idea in code and will post it as an answer."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1573058529, "post_id": 58734212, "comment_id": 103759784, "body": "@HolyBlackCat: Which I&#39;d upvote, ping me when you&#39;ve done it! Personally I&#39;d collapse the first two steps to the simple <code>8388607.5</code> check."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1573058107, "last_edit_date": 1573058107, "creation_date": 1573056306, "answer_id": 58734212, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value/58734212#58734212", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>(Restricting this answer to positive numbers; generalisation is trivial.)</p>\n\n<ol>\n<li><p>Get the number of bits in your exponent for the <code>float</code> on your platform along with the radix. If you have an IEEE754 32 bit <code>float</code> then this is a trivial step.</p></li>\n<li><p>Use (1) to compute the largest non-integer value that can be stored in your <code>float</code>. <code>std::numeric_limits</code> doesn't specify this value, annoyingly, so you need to do this yourself. For 32 bit IEEE754 you could take the easy option: <code>8388607.5</code> is the largest non-integral type <code>float</code>.</p></li>\n<li><p>If your <code>float</code> is less than or equal to (2), then check if it's an integer or not. If it's not an integer then you can round it appropriately so as not to invalidate the <code>&lt;</code>.</p></li>\n<li><p>At this point, the <code>float</code> is an integer. Check if it's within in the range of your <code>long long</code>. If it's out of range then the result of <code>&lt;</code> is known.</p></li>\n<li><p>If you get this far, then you can safely cast your <code>float</code> to a <code>long long</code>, and make the comparison.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1573056423, "post_id": 58734246, "comment_id": 103758573, "body": "Fails on edge cases sadly."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573056438, "post_id": 58734246, "comment_id": 103758584, "body": "What is the value is too big to be represented by the integer type?"}, {"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 1, "creation_date": 1573056442, "post_id": 58734246, "comment_id": 103758586, "body": "even double will hardly hold this large numbers with enough precision."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1573056466, "post_id": 58734246, "comment_id": 103758597, "body": "Just throwing more bits at the problem is not a good solution unless you have actually verified that it&#39;ll give you enough for all your possible inputs. There&#39;s no evidence of such reasoning here."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573056545, "post_id": 58734246, "comment_id": 103758654, "body": "@NathanOliver-ReinstateMonica Then you know the comparison is false because the other operand couldn&#39;t have held the value"}, {"owner": {"reputation": 155, "user_id": 5546839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f904a67e514333d1d8b594b083e5e9?s=128&d=identicon&r=PG&f=1", "display_name": "WilliamClements", "link": "https://stackoverflow.com/users/5546839/williamclements"}, "edited": false, "score": 0, "creation_date": 1573057399, "post_id": 58734246, "comment_id": 103759127, "body": "OK, sorry, I didn&#39;t suggest to vet the input. If the numbers are not guaranteed somehow to be reasonable, then by all means vet the input with use of std::numeric_limits."}], "tags": [], "owner": {"reputation": 155, "user_id": 5546839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f904a67e514333d1d8b594b083e5e9?s=128&d=identicon&r=PG&f=1", "display_name": "WilliamClements", "link": "https://stackoverflow.com/users/5546839/williamclements"}, "is_accepted": false, "score": -3, "last_activity_date": 1573056399, "creation_date": 1573056399, "answer_id": 58734246, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value/58734246#58734246", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>Use double, not float. Take the double value + 0.5. Truncate it by static cast to long long. Now compare the two long longs.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1573072033, "post_id": 58737875, "comment_id": 103765997, "body": "Very nice indeed Sir!"}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573138869, "post_id": 58737875, "comment_id": 103791062, "body": "Looks good, but you can suppress the result_if_eq: <code>(F) i</code> will never have a fractional part: either F has more precision than I, then (F) i conversion is exact (no fraction part) or I has more bits than F precision, but in this case (F) i cannot have a fraction part either (the ulp is &gt; 1)."}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573142045, "post_id": 58737875, "comment_id": 103792934, "body": "Since you are in the case <code>(F) i == f</code>, if <code>(F) i</code> does not have a fraction part, neither has <code>f</code>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573142069, "post_id": 58737875, "comment_id": 103792948, "body": "@aka.nice You&#39;re right, I didn&#39;t think about that. Edited."}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573154904, "post_id": 58737875, "comment_id": 103799088, "body": "You can also safely remove the <code>isinf(f)</code> test, this is already covered by <code>(F) i &lt; f</code> and <code>(F) i &gt; f</code> tests, unless the integer type has so many bits that it could overflow max float (unlikely, but you could eventually cover this condition with a static assertion)"}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573156032, "post_id": 58737875, "comment_id": 103799570, "body": "There are other implementation defined optimizations that could be covered by static assertions: assuming two complement, and F radix = 2, then INTEGER_MIN magnitude is a power of two and <code>(I) (F) INTEGER_MIN</code> cannot overflow (it is exact). Thus no need to cover float_too_large condition for negative f. BTW, did you test INTEGER_MIN case?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573156723, "post_id": 58737875, "comment_id": 103799866, "body": "@aka.nice Regarding the isinf(f) test - good point, I&#39;ve put it behind a constexpr condition. Regarding INTEGER_MIN - I don&#39;t quite get what changes you suggest. I&#39;ve added it to the test cases in the answer for the convenience. (At first I though you&#39;re suggesting removing the <code>+ (std::is_signed</code> part, but doing it gives an incorrect result.)"}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573158673, "post_id": 58737875, "comment_id": 103800660, "body": "@HolyBlackCat I mean that integer overflow in <code>(I) f</code> can only happen when <code>f == (F) INTEGER_MAX</code>, not when <code>f == (F) INTEGER_MIN</code> under above assumptions, so we need to care only of former case. Beside INTEGER_MIN and INTEGER_MAX generally differ in 1 bit of magnitude, so I&#39;m unsure about current handling..."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573159290, "post_id": 58737875, "comment_id": 103800903, "body": "@aka.nice Hmm. <a href=\"http://coliru.stacked-crooked.com/a/4ae4afef82474368\" rel=\"nofollow noreferrer\">Here</a> are some more test cases. The current solution appears to work on them."}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 1, "creation_date": 1573163942, "post_id": 58737875, "comment_id": 103802672, "body": "Ah OK, you harcoded the two-complement assumption via <code>+ (std::is_signed_v&lt;I&gt; &amp;&amp; frac == F(-0.5))</code>, I see it now. The condition <code>exp ==...</code> cannot happen for <code>numeric_limits&lt;I&gt;::min()</code> in case of two-complement AND <code>numeric_limits&lt;I&gt;::radix==numeric_limit&lt;F&gt;::radix</code>, because <code>(F) i == f</code> and <code>(F) numeric_limits&lt;I&gt;::min()</code> is then exact. Both implementation defined assumptions are implcit in your code because you compare float max exponent and int digits, which is only possible if sharing same radix..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573229415, "post_id": 58737875, "comment_id": 103826086, "body": "I think <code>(std::numeric_limits&lt;I&gt;::max()&#47;2+1) * 2;</code> needs review to handle cases where range of <code>I</code> exceed <code>F</code>.  Consider <code>int128_t</code> and <code>float</code>.  In my code I cheated and used <code>*2.0</code> to use <code>double</code> math when <code>F</code> is <code>float</code>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573229667, "post_id": 58737875, "comment_id": 103826214, "body": "@chux-ReinstateMonica I think I&#39;ve handled that by adding the <code>limits_overflow</code> thing. I&#39;ve not tested it though."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 4, "last_activity_date": 1573395819, "last_edit_date": 1573395819, "creation_date": 1573071456, "answer_id": 58737875, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value/58737875#58737875", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>Here's what I ended up with.</p>\n\n<p>Credit for the algorithm goes to @chux; his approach appears to outperform the other suggestions. You can find some alternative implementations in the edit history.</p>\n\n<p>If you can think of any improvements, suggestions are welcome.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cmath&gt;\n#include &lt;limits&gt;\n#include &lt;type_traits&gt;\n\nenum partial_ordering {less, equal, greater, unordered};\n\ntemplate &lt;typename I, typename F&gt;\npartial_ordering compare_int_float(I i, F f)\n{\n    if constexpr (std::is_integral_v&lt;F&gt; &amp;&amp; std::is_floating_point_v&lt;I&gt;)\n    {\n        return compare_int_float(f, i);\n    }\n    else\n    {\n        static_assert(std::is_integral_v&lt;I&gt; &amp;&amp; std::is_floating_point_v&lt;F&gt;);\n        static_assert(std::numeric_limits&lt;F&gt;::radix == 2);\n\n        // This should be exactly representable as F due to being a power of two.\n        constexpr F I_min_as_F = std::numeric_limits&lt;I&gt;::min();\n\n        // The `numeric_limits&lt;I&gt;::max()` itself might not be representable as F, so we use this instead.\n        constexpr F I_max_as_F_plus_1 = F(std::numeric_limits&lt;I&gt;::max()/2+1) * 2;\n\n        // Check if the constants above overflowed to infinity. Normally this shouldn't happen.\n        constexpr bool limits_overflow = I_min_as_F * 2 == I_min_as_F || I_max_as_F_plus_1 * 2 == I_max_as_F_plus_1;\n        if constexpr (limits_overflow)\n        {\n            // Manually check for special floating-point values.\n            if (std::isinf(f))\n                return f &gt; 0 ? less : greater;\n            if (std::isnan(f))\n                return unordered;\n        }\n\n        if (limits_overflow || f &gt;= I_min_as_F)\n        {\n            // `f &lt;= I_max_as_F_plus_1 - 1` would be problematic due to rounding, so we use this instead.\n            if (limits_overflow || f - I_max_as_F_plus_1 &lt;= -1)\n            {\n                I f_trunc = f;\n                if (f_trunc &lt; i)\n                    return greater;\n                if (f_trunc &gt; i)\n                    return less;\n\n                F f_frac = f - f_trunc;\n                if (f_frac &lt; 0)\n                    return greater;\n                if (f_frac &gt; 0)\n                    return less;\n\n                return equal;\n            }\n\n            return less;\n        }\n\n        if (f &lt; 0)\n            return greater;\n\n        return unordered;\n    }\n}\n</code></pre>\n\n<p>If you want to experiment with it, here are a few test cases:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cmath&gt;\n#include &lt;iomanip&gt;\n#include &lt;iostream&gt; \n\nvoid compare_print(long long a, float b, int n = 0)\n{\n    if (n == 0)\n    {\n        auto result = compare_int_float(a,b);\n        std::cout &lt;&lt; a &lt;&lt; ' ' &lt;&lt; \"&lt;=&gt;?\"[int(result)] &lt;&lt; ' ' &lt;&lt; b &lt;&lt; '\\n';\n    }\n    else\n    {\n        for (int i = 0; i &lt; n; i++)\n            b = std::nextafter(b, -INFINITY);\n\n        for (int i = 0; i &lt;= n*2; i++)\n        {\n            compare_print(a, b);\n            b = std::nextafter(b, INFINITY);\n        }\n\n        std::cout &lt;&lt; '\\n';\n    }\n}\n\nint main()\n{    \n    std::cout &lt;&lt; std::setprecision(1000);\n\n    compare_print(999999984306749440,\n                  999999984306749440.f, 2);\n\n    compare_print(999999984306749439,\n                  999999984306749440.f, 2);\n\n    compare_print(100,\n                  100.f, 2);\n\n    compare_print(-100,\n                  -100.f, 2);\n\n    compare_print(0,\n                  0.f, 2);\n\n    compare_print((long long)0x8000'0000'0000'0000,\n                  (long long)0x8000'0000'0000'0000, 2);\n\n    compare_print(42, INFINITY);\n    compare_print(42, -INFINITY);\n    compare_print(42, NAN);\n    std::cout &lt;&lt; '\\n';\n\n    compare_print(1388608,\n                  1388608.f, 2);\n\n    compare_print(12388608,\n                  12388608.f, 2);\n}\n</code></pre>\n\n<p><sup><a href=\"http://coliru.stacked-crooked.com/a/ede0edf180b627b9\" rel=\"nofollow noreferrer\">(run the code)</a></sup></p>\n"}, {"tags": [], "owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "is_accepted": false, "score": 1, "last_activity_date": 1573109762, "creation_date": 1573109762, "answer_id": 58743410, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value/58743410#58743410", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>This is how I solved it recently in opensmalltalk VM for comparing bounded integers:</p>\n\n<ol>\n<li>convert the integer as floating point (values is rounded, thus maybe inexact)</li>\n<li>compare if both float values are equal</li>\n<li>if they are not, there is no ambiguity whatever the rounding error, thus perform the comparison of floating point values and return the result</li>\n<li>if they are equal, then convert the floating point as integer and perform comparison of integer values</li>\n</ol>\n\n<p>The last point may lead to a difficulty: the conversion floating point->integer might lead to an integer overflow. You must thus make sure that you use a larger integer type for that edge cases, or fallback to Bathseba's algorithm.</p>\n\n<p>In OpenSmalltalk VM, that's not a problem because SmallInteger are on 61 bits at most, so I did not attempt to solve it.</p>\n\n<p>I have a Smallissimo blog entry giving additional pointers:</p>\n\n<p><a href=\"https://smallissimo.blogspot.com/2019/09/how-to-compare-exact-value-of.html\" rel=\"nofollow noreferrer\">How to compare exact value of SmallInteger and Float in Smalltalk</a> </p>\n\n<p>For unbounded (arbitrarily large) integers, the comparison is performed in Integer, but there are a few tricks to accelerate the comparison. This is not done in the VM but in Smalltalk code (Squeak is a good example).</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1573228553, "post_id": 58758802, "comment_id": 103825631, "body": "I <a href=\"http://quick-bench.com/hvx-hKyHKy_B4AKze52XDyft160\" rel=\"nofollow noreferrer\">benchmarked</a> it, and your approach seems to be faster than what I used to have in the answer (even after I removed <code>frexp</code> from mine). I&#39;ve C++-ified it a bit and added it to my answer."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1573186514, "last_edit_date": 1573186514, "creation_date": 1573173147, "answer_id": 58758802, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value/58758802#58758802", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>To compare a FP <code>f</code> and <em>integer</em> <code>i</code> for equality:</p>\n\n<p>(Code is representative and uses comparison of <code>float</code> and <code>long long</code> as an example)</p>\n\n<ol>\n<li><p>If <code>f</code> is a NaN, infinity, or has a fractional part  (perhaps use <code>frexp()</code>), <code>f</code> is not equal to <code>i</code>.</p>\n\n<pre><code>float ipart;\n// C++\nif (frexp(f, &amp;ipart) != 0) return not_equal;\n// C\nif (frexpf(f, &amp;ipart) != 0) return not_equal;\n</code></pre></li>\n<li><p>Convert the numeric limits of <code>i</code> into <em>exactly representable</em> FP values (powers of 2) near those limits.<sup>**</sup>  Easy to do if we assume FP is not a rare base 10 encoding and range of <code>double</code> exceeds the range on the <code>i</code>.  Take advantage that integer limits magnitudes are or near <a href=\"http://mathworld.wolfram.com/MersenneNumber.html\" rel=\"nofollow noreferrer\">Mersenne Number</a>.  (Sorry example code is C-ish)</p>\n\n<pre><code>#define FP_INT_MAX_PLUS1 ((LLONG_MAX/2 + 1)*2.0)\n#define FP_INT_MIN (LLONG_MIN*1.0)\n</code></pre></li>\n<li><p>Compare <code>f</code> to is limits</p>\n\n<pre><code>if (f &gt;= FP_INT_MAX_PLUS1) return not_equal;\nif (f &lt; FP_INT_MIN) return not_equal;\n</code></pre></li>\n<li><p>Convert <code>f</code> to integer and compare</p>\n\n<pre><code>return (long long) f == i;\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>To compare a FP <code>f</code> and <em>integer</em> <code>i</code> for <code>&lt;</code>, <code>&gt;</code>, <code>==</code> or not comparable:</p>\n\n<p>(Using above limits)</p>\n\n<ol>\n<li><p>Test <code>f &gt;= lower limit</code></p>\n\n<pre><code>if (f &gt;= FP_INT_MIN) {\n</code></pre></li>\n<li><p>Test <code>f &lt;= upper limit</code></p>\n\n<pre><code>  // reform below to cope with effects of rounding\n  // if (f &lt;= FP_INT_MAX_PLUS1 - 1)\n  if (f - FP_INT_MAX_PLUS1 &lt;= -1.0) {\n</code></pre></li>\n<li><p>Convert <code>f</code> to integer/fraction and compare    </p>\n\n<pre><code>    // at this point `f` is in the range of `i`\n    long long ipart = (long long) f;\n    if (ipart &lt; i) return f_less_than_i;\n    if (ipart &gt; i) return f_more_than_i;\n\n    float frac = f - ipart;\n    if (frac &lt; 0) return f_less_than_i;\n    if (frac &gt; 0) return f_more_than_i;\n    return equal;\n  }\n</code></pre></li>\n<li><p>Handle edge cases</p>\n\n<pre><code>  else return f_more_than_i;\n}\nif (f &lt; 0.0) return f_less_than_i;\nreturn not_comparable;\n</code></pre></li>\n</ol>\n\n<p>Simplifications possible, yet I wanted to convey the algorithm.</p>\n\n<hr>\n\n<p><sup>**</sup>  Additional conditional code needed to cope with non 2's complement integer encoding.  It is quite similar to the <code>MAX</code> code.</p>\n"}, {"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1573387898, "post_id": 58788215, "comment_id": 103859066, "body": "This is clever. It&#39;s the simplest algorithm so far, but it <a href=\"http://quick-bench.com/yCQYVXI_PpqEqc8hiq4N2bpEI2U\" rel=\"nofollow noreferrer\">appears</a> to be slightly slower than what @chux has suggested."}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573506238, "post_id": 58788215, "comment_id": 103896643, "body": "This also work for comparing long long to float: first convert float to double (exact) then compare long long to double... Same for shorter int type."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1573897172, "post_id": 58788215, "comment_id": 104044793, "body": "@aka.nice. Indeed that is what I meant. Calling <code>long_long_less_than_double</code> with a float argument converts the float to double. Thanks for the clarification."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1573898022, "post_id": 58788215, "comment_id": 104044966, "body": "@HolyBlackCat Nice to see the benchmark! One possible advantage of my solution is that in principle SIMD vectorization, e.g. AVX2 wth <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/\" rel=\"nofollow noreferrer\">intel intrinsics</a> is possible, see also <a href=\"https://stackoverflow.com/a/41148578/2439725\">here</a>. (Probably chux&#39; solution is also well vectorizable) This means that you can do 4 compares simultaneously, but this will only be successful if it is possible to vectorize the surrounding code too. Note that in the real world the performance might be slightly worse or better than the micro benchmark suggests."}, {"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 0, "creation_date": 1573898706, "post_id": 58788215, "comment_id": 104045114, "body": "I think the code <a href=\"http://quick-bench.com/I3UsfoDhSvoPystUTxc68CyKlZE\" rel=\"nofollow noreferrer\">here</a> produces the same result as your code. This code is still slower than chux&#39; idea, but you can see that it is branchless, and therefore it is suitable for vectorization. This might lead to a significant speedup, if it is possible to vectorize the performance critical surrounding code too, as I wrote before."}], "tags": [], "owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "is_accepted": false, "score": 2, "last_activity_date": 1573385461, "creation_date": 1573385461, "answer_id": 58788215, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value/58788215#58788215", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>The code below works with integer data types of at most 64 bits and \n    floating point data types of at most ieee-754 double precision accuracy.\n    For wider data types the same idea can be used, but you'll have to adapt he code.\n    Since I'm not very familiar with C++, the code is written in C. It shouldn't be too\n    difficult to convert it to a C++ style code. The code is branchless, which might \n    be a performance benefit.</p>\n\n<p><br/></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n// gcc -O3 -march=haswell cmp.c\n// Assume long long int is 64 bits.\n// Assume ieee-754 double precision.\nint long_long_less_than_double(long long int i, double y) {\n    long long i_lo = i &amp; 0x00000000FFFFFFFF;   // Extract lower 32 bits.\n    long long i_hi = i &amp; 0xFFFFFFFF00000000;   // Extract upper 32 bits.\n    double x_lo = (double)i_lo;                // Exact conversion to double, no rounding errors!\n    double x_hi = (double)i_hi;                // \n    return ( x_lo &lt; (y - x_hi) );              // If i is close to y then y - x_hi is exact,\n                                               // due to Sterbenz' lemma.\n    // i &lt; y\n    // i_lo +i_hi &lt; y      \n    // i_lo &lt; (y - i_hi)\n    // x_lo &lt; (y - x_hi)\n}\n\nint long_long_equals_double(long long int i, double y) {\n    long long i_lo = i &amp; 0x00000000FFFFFFFF;   \n    long long i_hi = i &amp; 0xFFFFFFFF00000000;   \n    double x_lo = (double)i_lo;                    \n    double x_hi = (double)i_hi;                    \n    return ( x_lo == (y - x_hi) );                  \n}                                                  \n\n\nint main()\n{\n    long long a0 = 999999984306749439;\n    long long a1 = 999999984306749440;    // Hex number: 0x0DE0B6B000000000\n    long long a2 = 999999984306749441;\n    float     b = 999999984306749440.f;   // This number can be represented exactly by a `float`.\n\n    printf(\"%lli less_than %20.1f = %i\\n\", a0, b, long_long_less_than_double(a0, b));  // Implicit conversion from float to double\n    printf(\"%lli less_than %20.1f = %i\\n\", a1, b, long_long_less_than_double(a1, b));\n\n    printf(\"%lli equals    %20.1f = %i\\n\", a0, b, long_long_equals_double(a0, b));\n    printf(\"%lli equals    %20.1f = %i\\n\", a1, b, long_long_equals_double(a1, b));\n    printf(\"%lli equals    %20.1f = %i\\n\\n\", a2, b, long_long_equals_double(a2, b));\n\n\n    long long c0 = 1311693406324658687;\n    long long c1 = 1311693406324658688;   // Hex number: 0x1234123412341200\n    long long c2 = 1311693406324658689; \n    double     d = 1311693406324658688.0; // This number can be represented exactly by a `double`.\n\n    printf(\"%lli less_than %20.1f = %i\\n\", c0, d, long_long_less_than_double(c0, d));\n    printf(\"%lli less_than %20.1f = %i\\n\", c1, d, long_long_less_than_double(c1, d));\n\n    printf(\"%lli equals    %20.1f = %i\\n\", c0, d, long_long_equals_double(c0, d));\n    printf(\"%lli equals    %20.1f = %i\\n\", c1, d, long_long_equals_double(c1, d));\n    printf(\"%lli equals    %20.1f = %i\\n\", c2, d, long_long_equals_double(c2, d));\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The idea is to split the 64 bits integer <code>i</code> in 32 upper bits <code>i_hi</code> and 32 lower bits <code>i_lo</code>, \nwhich are converted to doubles <code>x_hi</code> and <code>x_lo</code> without any rounding errors.\nIf double <code>y</code> is close to <code>x_hi</code>, then the floating point subtraction <code>y - x_hi</code> is exact,\ndue to <a href=\"http://perso.ens-lyon.fr/nathalie.revol/teaching/ValCS06-07/lecture-notes2.pdf\" rel=\"nofollow noreferrer\">Sterbenz' lemma</a>.\nSo, instead of <code>x_lo + x_hi &lt; y</code>, we can test for <code>x_lo &lt; (y - x_hi)</code>, which is more accurate!\nIf double <code>y</code> is not close to <code>x_hi</code> then <code>y - x_hi</code> is inacurate, but in that case we \ndon't need the accuracy because then <code>|y - x_hi|</code> is much larger than <code>|x_lo|</code>. In other words:\nIf <code>i</code> and <code>y</code> differ much than we don't have to worry about the value of the lower 32 bits.</p>\n\n<p>Output:</p>\n\n<pre><code>    999999984306749439 less_than 999999984306749440.0 = 1\n    999999984306749440 less_than 999999984306749440.0 = 0\n    999999984306749439 equals    999999984306749440.0 = 0\n    999999984306749440 equals    999999984306749440.0 = 1\n    999999984306749441 equals    999999984306749440.0 = 0\n\n    1311693406324658687 less_than 1311693406324658688.0 = 1\n    1311693406324658688 less_than 1311693406324658688.0 = 0\n    1311693406324658687 equals    1311693406324658688.0 = 0\n    1311693406324658688 equals    1311693406324658688.0 = 1\n    1311693406324658689 equals    1311693406324658688.0 = 0\n</code></pre>\n"}], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1220, "favorite_count": 1, "accepted_answer_id": 58737875, "answer_count": 6, "score": 8, "last_activity_date": 1573395819, "creation_date": 1573055710, "last_edit_date": 1573057562, "question_id": 58734034, "link": "https://stackoverflow.com/questions/58734034/how-to-properly-compare-an-integer-and-a-floating-point-value", "title": "How to properly compare an integer and a floating-point value?", "body": "<p>How do I compare an integer and a floating-point value <em>the right way\u2122</em>?</p>\n\n<p>The builtin comparsion operators give incorrect results in some edge cases, for example:</p>\n\n<pre><code>#include &lt;iomanip&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    long long a = 999999984306749439;\n    float     b = 999999984306749440.f; // This number can be represented exactly by a `float`.\n\n    std::cout &lt;&lt; std::setprecision(1000);\n    std::cout &lt;&lt; a &lt;&lt; \" &lt; \" &lt;&lt; b &lt;&lt; \" = \" &lt;&lt; (a &lt; b) &lt;&lt; '\\n';\n    // Prints `999999984306749439 &lt; 999999984306749440 = 0`, but it should be `1`.\n}\n</code></pre>\n\n<p>Apparently, the comparsion operators convert both operands to a same type before actually comparing them. Here lhs gets converted to <code>float</code>, which causes a loss of precision, and leads to an incorrect result.</p>\n\n<p>Even though I understand what's going on, I'm not sure how to work around this issue.</p>\n\n<hr>\n\n<p><sup>Disclaimer: The example uses a <code>float</code> and a <code>long long</code>, but I'm looking for a generic solution that works for every combination of an integral type and a floating-point type.</sup></p>\n"}, {"tags": ["c++", "visual-studio", "build", "compilation", "64-bit"], "comments": [{"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1573055128, "post_id": 58733754, "comment_id": 103757847, "body": "Do the project&#39;s include directory look the same for both targets ?"}, {"owner": {"reputation": 21, "user_id": 11252015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1732b964df5742233cc444251f81bd4?s=128&d=identicon&r=PG&f=1", "display_name": "Evethir", "link": "https://stackoverflow.com/users/11252015/evethir"}, "reply_to_user": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1573055675, "post_id": 58733754, "comment_id": 103758157, "body": "ehi @jeffrey Yes, I tried to manually force the include path, but nothing changed :/"}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1573055812, "post_id": 58733754, "comment_id": 103758228, "body": "You probably messed up by tinkering with the project settings. Start a fresh project with just #include &lt;map&gt;. Make sure it compiles for both targets. Copy over the nice default settings. If a fresh project, out of the box doesn&#39;t compile, ugh... reinstall VS?"}, {"owner": {"reputation": 21, "user_id": 11252015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1732b964df5742233cc444251f81bd4?s=128&d=identicon&r=PG&f=1", "display_name": "Evethir", "link": "https://stackoverflow.com/users/11252015/evethir"}, "reply_to_user": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1573055946, "post_id": 58733754, "comment_id": 103758299, "body": "ehi @Jeffrey actually $(VC_IncludePath);$(WindowsSDK_IncludePath);  was missing in the VC++ Directories/Include Directories"}], "owner": {"reputation": 21, "user_id": 11252015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1732b964df5742233cc444251f81bd4?s=128&d=identicon&r=PG&f=1", "display_name": "Evethir", "link": "https://stackoverflow.com/users/11252015/evethir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573054782, "creation_date": 1573054782, "question_id": 58733754, "link": "https://stackoverflow.com/questions/58733754/cannot-open-c-standard-libraries-when-compiling-x64-bits", "title": "Cannot open c++ standard libraries when compiling x64 bits", "body": "<p>Hei everybody! \nI have a Visual studio 2015 project. I can build in x86 meanwhile if I try to build in x64\nI have the following errors. I didn't change anything about the \"default\" configuration.</p>\n\n<p>Any clue on why I have these issues_</p>\n\n<pre><code>Error (active)      cannot open source file \"algorithm\" \nError (active)      cannot open source file \"cassert\"   \nError (active)      cannot open source file \"cassert\"   \nError (active)      cannot open source file \"cmath\" \nError (active)      cannot open source file \"cstddef\"   \nError (active)      cannot open source file \"cstring\"   \nError (active)      cannot open source file \"ctype.h\"   \nError (active)      cannot open source file \"excpt.h\"   \nError (active)      cannot open source file \"excpt.h\"   \nError (active)      cannot open source file \"excpt.h\"   \nError (active)      cannot open source file \"fstream\"   \nError (active)      cannot open source file \"functional\"\nError (active)      cannot open source file \"iostream\"  \nError (active)      cannot open source file \"limits\"    \nError (active)      cannot open source file \"map\"   \nError (active)      cannot open source file \"memory\"    \nError (active)      cannot open source file \"stdarg.h\"  \nError (active)      cannot open source file \"stdarg.h\"  \nError (active)      cannot open source file \"stdlib.h\"  \n\n</code></pre>\n"}, {"tags": ["c++", "cmd", "g++", "unordered-map", "auto"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 4, "creation_date": 1573054220, "post_id": 58733536, "comment_id": 103757286, "body": "<code>This file requires compiler and library support for the ISO C++ 2011 standard.</code>. Range based loops require C++11. You need to compile with <code>-std=c++11</code> (or upgrade the compiler to at least GCC 6.1)"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 2, "creation_date": 1573054488, "post_id": 58733536, "comment_id": 103757466, "body": "<code>#include &lt;bits&#47;stdc++.h&gt;</code>: <a href=\"https://stackoverflow.com/Questions/31816095/Why-Should-I-Not-Include-Bits-Stdc-H.\">Don&#39;t include that.</a>. Using <code>#include&lt;unordered_map&gt;</code> also indicates that you don&#39;t know what it actually does."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573054927, "post_id": 58733536, "comment_id": 103757736, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15733163/c-error-unordered-map-does-not-name-a-type\">C++ error: &#39;unordered_map&#39; does not name a type</a>"}, {"owner": {"reputation": 3, "user_id": 8119044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTjdL.jpg?s=128&g=1", "display_name": "Naima Farooqi", "link": "https://stackoverflow.com/users/8119044/naima-farooqi"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573055949, "post_id": 58733536, "comment_id": 103758301, "body": "@uneven_mark Thank you for feedback but I obviously know what bits/stdc++ does. I have included unordered_map header file to indicate that its the reason behind the above error. Even though I have g++ version 5.1 I still cant include c++11 features."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1573056104, "post_id": 58733536, "comment_id": 103758389, "body": "@NaimaFarooqi Except for the <code>#error This file requires compiler and library support</code> error you will get the same result without <code>#include&lt;unordered_map&gt;</code>. When you use <code>-std=c++11</code>, then <code>#include&lt;unordered_map&gt;</code> will be redundant with <code>#include&lt;bits&#47;stdc++.h&gt;</code> (though as I wrote, you should stay with the former rather than the latter). (If you are aware of this, ignore my comment.)"}], "answers": [{"tags": [], "owner": {"reputation": 3198, "user_id": 6119582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d37ce6d78ed9281f47a2712aaed48?s=128&d=identicon&r=PG&f=1", "display_name": "sweenish", "link": "https://stackoverflow.com/users/6119582/sweenish"}, "is_accepted": true, "score": 0, "last_activity_date": 1573074943, "creation_date": 1573074943, "answer_id": 58738604, "question_id": 58733536, "link": "https://stackoverflow.com/questions/58733536/using-unordered-map-on-my-g-5-1-0-compiler-in-command-prompt-shows-error/58738604#58738604", "title": "Using unordered_map on my g++ (5.1.0) compiler in command prompt shows error", "body": "<p>The compiler told you exactly what was wrong. It usually will.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>This file requires compiler and library support for the ISO C++ 2011 standard. This\nsupport is currently experimental, and must be enabled with the -std=c++11 or\n-std=gnu++11 compiler options.\n</code></pre>\n\n<p>You just have to compile with the proper flag, <code>-std=c++11</code>. I don't know if you are version-matching against what graders use or what, but there are very few good reasons to be on a minGW compiler where support for an 8 year old standard is still considered experimental.</p>\n\n<p>You can see that it works as expected here: <a href=\"https://godbolt.org/z/JQxL00\" rel=\"nofollow noreferrer\">https://godbolt.org/z/JQxL00</a>\nIf you remove the <code>-std=c++11</code> flag, it will fail to compile and give you the same error message.</p>\n\n<p>You might also notice that I altered the includes to only include what I use. This results in a much faster compile time, smaller executable, and an easier to understand piece of code (Since it is plain to see what standard features are being used). You also avoid polluting your namespace. </p>\n"}], "owner": {"reputation": 3, "user_id": 8119044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTjdL.jpg?s=128&g=1", "display_name": "Naima Farooqi", "link": "https://stackoverflow.com/users/8119044/naima-farooqi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 1, "accepted_answer_id": 58738604, "answer_count": 1, "score": -1, "last_activity_date": 1573074943, "creation_date": 1573054094, "question_id": 58733536, "link": "https://stackoverflow.com/questions/58733536/using-unordered-map-on-my-g-5-1-0-compiler-in-command-prompt-shows-error", "title": "Using unordered_map on my g++ (5.1.0) compiler in command prompt shows error", "body": "<p>I have recently downloaded MinGW into my computer but on using certain containers and iterators like unordered_map and auto it shows an unexpected error.</p>\n\n<p>my code is as follows :</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n#include&lt;unordered_map&gt;\nusing namespace std;\n\n\nint main()\n{\n\n    unordered_map&lt;string, int&gt; umap; \n\n    umap[\"GeeksforGeeks\"] = 10; \n    umap[\"Practice\"] = 20; \n    umap[\"Contribute\"] = 30; \n\n    for (auto x : umap) \n      cout &lt;&lt; x.first &lt;&lt; \" \" &lt;&lt; x.second &lt;&lt; endl; \n\n\n    return 0;\n}\n</code></pre>\n\n<p>it gives the following error :</p>\n\n<pre><code>\nC:\\Users\\naima\\Documents\\cpp&gt;g++ -o try2 try2.cpp\nIn file included from C:/TDM-GCC-64/lib/gcc/x86_64-w64-mingw32/5.1.0/include/c++/unordered_map:35:0,\n                 from try2.cpp:2:\nC:/TDM-GCC-64/lib/gcc/x86_64-w64-mingw32/5.1.0/include/c++/bits/c++0x_warning.h:32:2: error: #error This file requires compiler and library support for the ISO C++ 2011 standard. This support is currently experimental, and must be enabled with the -std=c++11 or -std=gnu++11 compiler options.\n #error This file requires compiler and library support for the \\\n  ^\ntry2.cpp: In function 'int main()':\ntry2.cpp:9:5: error: 'unordered_map' was not declared in this scope\n     unordered_map&lt;string, int&gt; umap;\n     ^\ntry2.cpp:9:25: error: expected primary-expression before ',' token\n     unordered_map&lt;string, int&gt; umap;\n                         ^\ntry2.cpp:9:27: error: expected primary-expression before 'int'\n     unordered_map&lt;string, int&gt; umap;\n                           ^\ntry2.cpp:11:5: error: 'umap' was not declared in this scope\n     umap[\"GeeksforGeeks\"] = 10;\n     ^\ntry2.cpp:15:15: error: 'x' does not name a type\n     for (auto x : umap)\n               ^\ntry2.cpp:19:5: error: expected ';' before 'return'\n     return 0;\n     ^\ntry2.cpp:19:5: error: expected primary-expression before 'return'\ntry2.cpp:19:5: error: expected ';' before 'return'\ntry2.cpp:19:5: error: expected primary-expression before 'return'\ntry2.cpp:19:5: error: expected ')' before 'return'\n</code></pre>\n"}, {"tags": ["c++", "arrays", "constructor", "arguments"], "comments": [{"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 1, "creation_date": 1573053245, "post_id": 58733203, "comment_id": 103756651, "body": "If you can&#39;t use vectors, then use a dynamically sized array, like: <code>Child **array; \u2026 array = new Child*[N]</code>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1573053309, "post_id": 58733203, "comment_id": 103756695, "body": "But don&#39;t forget to delete said dynamically sized array, when you are done with it (typically, in a destructor of the class), to avoid memory leaks."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1573053481, "post_id": 58733203, "comment_id": 103756821, "body": "Start with implementing a non-standard vector(-like) container."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1573053570, "post_id": 58733203, "comment_id": 103756886, "body": "Pro tip: If you need a vector, but your class doesn&#39;t let you use it, then write your own.  You don&#39;t need to do the full implementation though.  You just need enough to have an RAII type so you encapsulate the memory management."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1573053611, "post_id": 58733203, "comment_id": 103756915, "body": "If you&#39;re not allowed to use <code>vector</code>, the purpose of this exercise is most likely that you practice manual memory management using methods you&#39;ve learned recently."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1573054074, "post_id": 58733203, "comment_id": 103757208, "body": "<i>I\u2019m not allowed to use vectors.</i>  --  I really don&#39;t understand these types of requirements.  You&#39;re supposed to be implementing a b-tree, not maintain a dynamic array,  It&#39;s not as if the code will magically write itself because a vector is used.  Now if your manual memory management (or home-made vector) is bugged, there goes your entire b-tree down the drain."}, {"owner": {"reputation": 130, "user_id": 12066096, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-srF-knoCNt4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd5ufDMUXeU6P36QSo5ZHzFYWGVyw/photo.jpg?sz=128", "display_name": "BBridges", "link": "https://stackoverflow.com/users/12066096/bbridges"}, "edited": false, "score": 0, "creation_date": 1573054552, "post_id": 58733203, "comment_id": 103757498, "body": "I forgot about dynamically sized arrays. That might work. So for my keys.... Key *array?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1573055060, "post_id": 58733203, "comment_id": 103757816, "body": "@BDHys -- Now is a good time to quickly prototype your solution using <code>std::vector</code>, since a vector is already bug-free.  Once you see that your solution works, then change the <code>std::vector</code> to a home-made one.  This way, at the very least, you could be sure your solution can work, with the extra step of translating over from using vector to a home-made class."}], "owner": {"reputation": 130, "user_id": 12066096, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-srF-knoCNt4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd5ufDMUXeU6P36QSo5ZHzFYWGVyw/photo.jpg?sz=128", "display_name": "BBridges", "link": "https://stackoverflow.com/users/12066096/bbridges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573053111, "creation_date": 1573053111, "question_id": 58733203, "link": "https://stackoverflow.com/questions/58733203/using-class-constructors-to-set-class-variable-array-length", "title": "Using class constructors to set class variable array length", "body": "<p>I have built a functioning b-tree. I utilized arrays for my child pointers and keys. What I want now is to be able to have my constructor take an array size argument (an integer) and have that determine my array length (aka whether it is a 3-4 or a 2-3 tree etc). I\u2019m not allowed to use vectors. Im just now sure where to start.</p>\n"}, {"tags": ["c++", "r", "rcpp"], "comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 1, "creation_date": 1573053266, "post_id": 58732972, "comment_id": 103756665, "body": "I am not sure what this has to do with Rcpp -- but maybe you want to talk to the authors of <code>mixl</code> ?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 2, "creation_date": 1573053326, "post_id": 58732972, "comment_id": 103756706, "body": "are you sure you are supposed to use <code>&lt;-</code> for assignments in the model specification? the error message looks as if it was taken over to C++ where it has avery different meaning."}, {"owner": {"reputation": 31, "user_id": 10465230, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Aa7396nnYwc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOyHFpBJmuFsebRpCP2vnPdgpj1hQ/mo/photo.jpg?sz=128", "display_name": "transmod_kdtk", "link": "https://stackoverflow.com/users/10465230/transmod-kdtk"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1573071349, "post_id": 58732972, "comment_id": 103765683, "body": "Thank you @RalfStubner you are right, I can&#39;t believe I didn&#39;t check that one, it did work with <code>=</code>. Thanks @DirkEddelbuettel for the comment too, can I ask you how you could tell this was not an Rcpp related issue?"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 1, "creation_date": 1573074857, "post_id": 58732972, "comment_id": 103767123, "body": "@transmod_kdtk  Because by the same logic of &quot;but I am using Rcpp underneath&quot; it also a bug in R, the <code>gcc</code> compiler, and eventually your Intel hardware.  Kidding aside, that was just between you and <code>mixl</code> which itself was using Rcpp &quot;as advertised&quot;."}], "owner": {"reputation": 31, "user_id": 10465230, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Aa7396nnYwc/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOyHFpBJmuFsebRpCP2vnPdgpj1hQ/mo/photo.jpg?sz=128", "display_name": "transmod_kdtk", "link": "https://stackoverflow.com/users/10465230/transmod-kdtk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 814, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573053182, "creation_date": 1573052406, "last_edit_date": 1573053182, "question_id": 58732972, "link": "https://stackoverflow.com/questions/58732972/error-in-rcppsourcecpp-error-1-occurred-building-shared-library", "title": "Error in Rcpp::sourceCpp(): Error 1 occurred building shared library", "body": "<p>I am trying to use the <code>mixl</code> package in R for discrete choice modelling. <code>mixl</code> includes a pre-compiler that takes a model specification written in plain text, and converts it to a C++ utility function callable from R.</p>\n\n<p>I run R in Windows 10. I have installed the <code>Rtools</code> successfully and added the R executable path (<em>C:\\Program Files\\R\\R-3.6.1\\bin</em>) into the environment variables list.</p>\n\n<pre><code>&gt; find_rtools()\n[1] TRUE\n\n&gt; install.Rtools(check = T)\nNo need to install Rtools - You've got the relevant version of Rtools installed\n</code></pre>\n\n<p>I have installed the <code>Rcpp</code> package but when running the following code</p>\n\n<pre><code>library(mixl)\ndata(\"Train\", package = \"mlogit\")\nTrain$ID &lt;- Train$id\nTrain$CHOICE &lt;- as.numeric(Train$choice)\nmixl_test &lt;- \"\nASC_B_RND &lt;- @ASC_B + draw_1*@SIGMA_B;\nTIME_A_RND &lt;- @B_timeA + draw_2*@SIG_time;\nTIME_B_RND &lt;- @B_timeB + draw_2*@SIG_time;\nU_PT &lt;- @B_price*$price_A/1000 + TIME_A_RND*$time_A/60 + @B_change*$change_A;\nU_Car &lt;- ASC_B_RND + (@B_price*$price_B/1000 + TIME_B_RND*$time_B/60);\n\"\nmodel_spec &lt;- specify_model(mixl_test, Train)\n</code></pre>\n\n<p>the following error message comes up.</p>\n\n<pre><code>&gt; C:/Rtools/mingw_64/bin/g++  -std=gnu++11 -I\"C:/PROGRA~1/R/R-36~1.1/include\" -DNDEBUG -I\"C:/Users/takaa/Documents/R/win-library/3.6/mixl/include\"  -I\"C:/Users/takaa/Documents/R/win-library/3.6/Rcpp/include\" -I\"C:/Users/takaa/AppData/Local/Temp/RtmpOks2bQ/sourceCpp-x86_64-w64-mingw32-1.0.2\"     -fopenmp   -O2 -Wall  -mtune=generic -c file2fbc33473a13.cpp -o file2fbc33473a13.o\nfile2fbc33473a13.cpp: In function 'void utilityFunction(Rcpp::NumericVector, UF_args2&amp;)':\nfile2fbc33473a13.cpp:127:1: error: 'ASC_B_RND' was not declared in this scope\n ASC_B_RND &lt;- ASC_B + draw[0]*SIGMA_B;\n\n&gt; ^\n&gt; \n&gt; file2fbc33473a13.cpp:128:1: error: 'TIME_A_RND' was not declared in this scope\n TIME_A_RND &lt;- B_timeA + draw[1]*SIG_time;\n&gt; \n&gt; ^\n&gt; \n&gt; file2fbc33473a13.cpp:129:1: error: 'TIME_B_RND' was not declared in this scope\n TIME_B_RND &lt;- B_timeB + draw[1]*SIG_time;\n&gt; \n&gt; ^\n&gt; \n&gt; make: *** [C:/PROGRA~1/R/R-36~1.1/etc/x64/Makeconf:215:\n&gt; file2fbc33473a13.o] Error 1 \n&gt; \n&gt; Error in Rcpp::sourceCpp(code =\n&gt; e1$cpp_code, env = cpp_container) :    Error 1 occurred building\n&gt; shared library.\n&gt; \n</code></pre>\n\n<p>I believe the questions is similar to [<a href=\"https://stackoverflow.com/questions/58266286/error-1-occurred-building-shared-library-while-sourcing-cpp-code-inside-r?noredirect=1&amp;lq=1][1]\">Error 1 occurred building shared library while sourcing cpp code inside R</a> and [<a href=\"https://github.com/aidenlab/straw/issues/20][2]\" rel=\"nofollow noreferrer\">https://github.com/aidenlab/straw/issues/20][2]</a> but I have rebooted Rstudio and Windows (and nothing changed) and concerning the second question should I change to <code>-std=c++11</code> from <code>-std=gnu++11</code>? Has Anyone faced a similar problem, what is the issue here?   </p>\n\n<p>R version 3.6.1 (2019-07-05) -- \"Action of the Toes\"\nCopyright (C) 2019 The R Foundation for Statistical Computing\nPlatform: x86_64-w64-mingw32/x64 (64-bit)</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "c++11", "move", "future"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1573052672, "post_id": 58732963, "comment_id": 103756284, "body": "<code>prom.get_future()</code> is already returning a pr value, btw. No need to move it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573052764, "post_id": 58732963, "comment_id": 103756328, "body": "FWIW <code>return std::move(cases);</code> is almost always wrong.  Function local objects are already moved in a return statement if they can be so all this does is stop the compiler from being able to use NRVO.  Just use <code>return cases;</code> and &quot;It&#39;ll do the right thing&quot;"}, {"owner": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573052959, "post_id": 58732963, "comment_id": 103756447, "body": "@NathanOliver-ReinstateMonica Is it? I thought NRVO, as well as other optimizations in this category are all left to the compiler to apply (or not). Besides: What does it hurt?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1573053046, "post_id": 58732963, "comment_id": 103756506, "body": "I would cut <code>GenerateTestCases</code> down to <code>return std::vector&lt;std::vector&lt;int&gt;&gt;(number_inputs, std::vector&lt;int&gt;(input_size));</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1573053074, "post_id": 58732963, "comment_id": 103756529, "body": "@SonneXo Using <code>return std::move(cases);</code> stops the compiler from being able to use NRVO.  Since NRVO is a good thing, you don&#39;t want stop it.  If you have <code>return cases;</code> then you might get NRVO, if you don&#39;t you still get a move so it is a win-win to not use <code>return std::move(cases);</code>"}, {"owner": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1573053144, "post_id": 58732963, "comment_id": 103756580, "body": "@molbdnilo That&#39;s just a minimal working example"}, {"owner": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573053192, "post_id": 58732963, "comment_id": 103756610, "body": "@NathanOliver-ReinstateMonica I&#39;ll remember that for future usages, I thought the compiler would have enough freedom to to that nevertheless!"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573053307, "post_id": 58732963, "comment_id": 103756694, "body": "No worries, it does seem like it should be what you want.  For the technical reason why it isn&#39;t, see: <a href=\"https://stackoverflow.com/questions/19267408/why-does-stdmove-prevent-rvo\" title=\"why does stdmove prevent rvo\">stackoverflow.com/questions/19267408/&hellip;</a>"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1573053439, "post_id": 58732963, "comment_id": 103756787, "body": "You loop through the <code>test_cases</code>, I don&#39;t see a reason the time wouldn&#39;t increase.."}, {"owner": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "reply_to_user": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1573053589, "post_id": 58732963, "comment_id": 103756902, "body": "@appleapple Because <i>test_cases.size()</i> is always 100. Only the size of the inner vectors increases, which are not looped through."}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1573053652, "post_id": 58732963, "comment_id": 103756948, "body": "oh yes, I just notice that"}], "answers": [{"comments": [{"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "edited": false, "score": 0, "creation_date": 1573054596, "post_id": 58733562, "comment_id": 103757524, "body": "I think my English grammar here is weird, but I cannot get it correct now, can someone help me? I probably need to take a rest. :/"}, {"owner": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "edited": false, "score": 0, "creation_date": 1573054631, "post_id": 58733562, "comment_id": 103757549, "body": "Wow, I would&#39;ve never guessed deleting the memory would become more expensive the larger it is, let alone so drastically! Thank you!"}, {"owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "reply_to_user": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "edited": false, "score": 0, "creation_date": 1573106994, "post_id": 58733562, "comment_id": 103774808, "body": "@SonneXo it&#39;s also somewhat surprising to me. maybe it happens when run out of memory?"}], "tags": [], "owner": {"reputation": 5538, "user_id": 5980430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e941fd748178dc871ae6a9974d5099d4?s=128&d=identicon&r=PG&f=1", "display_name": "apple apple", "link": "https://stackoverflow.com/users/5980430/apple-apple"}, "is_accepted": true, "score": 2, "last_activity_date": 1573056245, "last_edit_date": 1573056245, "creation_date": 1573054190, "answer_id": 58733562, "question_id": 58732963, "link": "https://stackoverflow.com/questions/58732963/how-to-move-a-result-from-an-stdfuture-in-c11/58733562#58733562", "title": "How to move a result from an std::future in C++11?", "body": "<p>The time cost is probably from the destruction of the vector.</p>\n\n<hr>\n\n<p>I did a test and the time doesn't increase when the results are kept in another vector (i.e. prevent the destruction)</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/dc7792496a981de3\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/dc7792496a981de3</a></p>\n\n<hr>\n\n<p>While in your original code, the time does increase</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/66b96809fb35b3d2\" rel=\"nofollow noreferrer\">http://coliru.stacked-crooked.com/a/66b96809fb35b3d2</a></p>\n"}], "owner": {"reputation": 167, "user_id": 2950541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4765c29ff9d6b603f7d5ce74054452d9?s=128&d=identicon&r=PG&f=1", "display_name": "SonneXo", "link": "https://stackoverflow.com/users/2950541/sonnexo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 58733562, "answer_count": 1, "score": 1, "last_activity_date": 1573056245, "creation_date": 1573052381, "last_edit_date": 1573054493, "question_id": 58732963, "link": "https://stackoverflow.com/questions/58732963/how-to-move-a-result-from-an-stdfuture-in-c11", "title": "How to move a result from an std::future in C++11?", "body": "<p>I want to asynchronously process a <code>std::vector&lt;int&gt;</code> within my program. The retrieval of the objects, however, do not utilize move semantics.</p>\n\n<p>I've created a minimal working example and attached it below. According to <a href=\"http://www.cplusplus.com/reference/vector/vector/vector/\" rel=\"nofollow noreferrer\">cplusplus.com</a>, move semantics on copying and constructing vectors are linear in the size of the moved-to object and constant in the size of the moved-from object, as long as they share the same allocator (I'm using the standard one).\nAccording to <a href=\"http://www.cplusplus.com/reference/future/future/get/\" rel=\"nofollow noreferrer\">cplusplus.com</a> again, when retrieving an object from <code>std::future&lt;T&gt;::get()</code> and <code>T</code> is neither <code>void</code> nor a reference type (which is not the case), it behaves like moving the value.</p>\n\n<p>I even tried to just use <code>inputs[i].get();</code> instead in the second loop, currently within the comments, and not assigning it to anything. This still give the linear time increase.</p>\n\n<pre><code>std::vector&lt;std::vector&lt;int&gt;&gt; GenerateTestCases(int input_size, int number_inputs) {\n    std::vector&lt;std::vector&lt;int&gt;&gt; cases(number_inputs);\n\n    for (auto i = 0; i &lt; number_inputs; i++) {\n        std::vector&lt;int&gt; some_vector(input_size);\n        cases[i] = std::move(some_vector);\n    }\n\n    return std::move(cases);\n}\n\nint main() {\n    for (auto i = 0; i &lt; 25; i++) {\n        auto size = (int)pow(2, i);\n        int iterations = 100;\n\n        auto test_cases = GenerateTestCases(size, iterations);\n\n        std::vector&lt;std::future&lt;std::vector&lt;int&gt;&gt;&gt; inputs(iterations);\n\n        const auto start = std::chrono::high_resolution_clock::now();\n\n        for (auto i = 0; i &lt; test_cases.size(); i++) {\n            std::promise&lt;std::vector&lt;int&gt;&gt; prom;\n            prom.set_value(std::move(test_cases[i]));\n\n            inputs[i] = std::move(prom.get_future());\n        }\n\n        const auto middle = std::chrono::high_resolution_clock::now();\n\n        for (auto i = 0; i &lt; test_cases.size(); i++) {\n            //inputs[i].get();\n            auto&amp; result = (inputs[i]);\n            auto value = std::move(result.get());\n        }\n\n        const auto end = std::chrono::high_resolution_clock::now();\n\n        const auto elapsed_first = std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;\n        (middle - start).count();\n\n        const auto elapsed_second = std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;\n        (end - middle).count();\n\n        std::cout &lt;&lt; \"First: \" &lt;&lt; elapsed_first &lt;&lt; std::endl;\n        std::cout &lt;&lt; \"Second: \" &lt;&lt; elapsed_second &lt;&lt; std::endl;\n        std::cout &lt;&lt; std::endl;\n    }\n\n    char c;\n    std::cin &gt;&gt; c;\n}\n</code></pre>\n\n<p>I, however, see a linear increase in execution time when I'm executing my code above, ranging from </p>\n\n<blockquote>\n  <p>First: 13440ns Second: 9919ns</p>\n</blockquote>\n\n<p>for the smallest arrays size to</p>\n\n<blockquote>\n  <p>First: 25919ns Second: 300147450ns</p>\n</blockquote>\n\n<p>for the largest one.</p>\n\n<p>I'm using VS2019 on Win10 and compiling for x64, if this is from interest.</p>\n"}, {"tags": ["c++", "sdl-2", "opengl-3"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1573054993, "post_id": 58732911, "comment_id": 103757775, "body": "Are you talking about updating the window surface via <code>SDL_GetWindowSurface()</code> &amp; <code>SDL_UpdateWindowSurface()</code> on a SDL_Window created with the <code>SDL_WINDOW_OPENGL</code> flag?  Or just using random non-window surfaces?"}, {"owner": {"reputation": 1, "user_id": 9620801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79e28abb3c87f697b04b92ea09d4006?s=128&d=identicon&r=PG&f=1", "display_name": "mrkubax10", "link": "https://stackoverflow.com/users/9620801/mrkubax10"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1573058794, "post_id": 58732911, "comment_id": 103759956, "body": "I am taking about updating window surface via SDL_UpdateWindowSurface on SDL_Window created with SDL_WINDOW_OPENGL FLAG."}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1573105145, "post_id": 58732911, "comment_id": 103774276, "body": "Nothing is preventing you from <code>SDL_CreateSoftwareRenderer</code> on custom surface and then feeding this surface to opengl though."}], "answers": [{"tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": false, "score": 4, "last_activity_date": 1573061325, "creation_date": 1573061325, "answer_id": 58735600, "question_id": 58732911, "link": "https://stackoverflow.com/questions/58732911/how-to-use-sdl2-software-render-with-opengl/58735600#58735600", "title": "How to use SDL2 software render with OpenGL?", "body": "<blockquote>\n  <p>I am taking about updating window surface via <code>SDL_UpdateWindowSurface</code> on <code>SDL_Window</code> created with <code>SDL_WINDOW_OPENGL</code> flag</p>\n</blockquote>\n\n<p>That's <a href=\"https://hg.libsdl.org/SDL/file/0b98870c7f72/include/SDL_video.h#l831\" rel=\"nofollow noreferrer\">specifically prohibited by the API</a>:</p>\n\n<blockquote>\n  <p>You may not combine this [SDL_GetWindowSurface] with 3D or the rendering API on this window.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 9620801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d79e28abb3c87f697b04b92ea09d4006?s=128&d=identicon&r=PG&f=1", "display_name": "mrkubax10", "link": "https://stackoverflow.com/users/9620801/mrkubax10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573061325, "creation_date": 1573052224, "last_edit_date": 1573058812, "question_id": 58732911, "link": "https://stackoverflow.com/questions/58732911/how-to-use-sdl2-software-render-with-opengl", "title": "How to use SDL2 software render with OpenGL?", "body": "<p>I'm creating a 3D game and I'm wondering about how to mix SDL2 software (surface) render and OpenGL. I tried to render simple text using this code but it doesn't work.</p>\n\n<pre><code>glClearColor(0,0,1,1);\nglClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\nSDL_BlitSurface(surf,0,dest,0);\nSDL_GL_SwapWindow(win);\n</code></pre>\n\n<p>What is the issue?</p>\n"}, {"tags": ["c++", "cmake", "libpcap"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1573055183, "post_id": 58732857, "comment_id": 103757885, "body": "Have you seen <a href=\"https://stackoverflow.com/questions/8774593/cmake-link-to-external-library\">that question</a> about linking libraries in CMake? Cross-compiled libraries are linked in the same way as normal ones. (Of course, you need to have your project to be cross-compiled too)."}, {"owner": {"reputation": 5170, "user_id": 2645713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efef9add043f756851612ae611f282f7?s=128&d=identicon&r=PG", "display_name": "Markus Zeller", "link": "https://stackoverflow.com/users/2645713/markus-zeller"}, "edited": false, "score": 0, "creation_date": 1573059255, "post_id": 58732857, "comment_id": 103760221, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/8774593/cmake-link-to-external-library\">CMake link to external library</a>"}], "owner": {"reputation": 1, "user_id": 10861579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-y8W6snl45Oo/AAAAAAAAAAI/AAAAAAAABzY/RkVxwX15Q7Q/photo.jpg?sz=128", "display_name": "Raghu", "link": "https://stackoverflow.com/users/10861579/raghu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573052051, "creation_date": 1573052051, "question_id": 58732857, "link": "https://stackoverflow.com/questions/58732857/how-to-link-cross-compiled-libpcap-library-for-compiler-using-cmake-in-cmakelist", "title": "How to link cross compiled libpcap library for compiler using cmake in CMakeLists.txt", "body": "<p>I am using libpcap to capture some UDP packets from ethernet interface connected to my linux based ARM aarch64 Hardware. I am compiling the code in the host computer with ubuntu 16.04, using cmake3.5.1, libpcap1.9.1, and code is written in c++. </p>\n\n<p>To cross compile the libpcap, I followed this link (<a href=\"https://kush.com.fj/blog/posts/2018-05-15-crosscompile-libpcap-for-arm/\" rel=\"nofollow noreferrer\">https://kush.com.fj/blog/posts/2018-05-15-crosscompile-libpcap-for-arm/</a>). After cross compiling I need to add these cross compiled target libraries into the CMakeLists.txt for cmake compiler to understand.\n    I would like to understand how I should add these links in what way in CMakeLists.txt file. </p>\n\n<p>I have two CMakeLists.txt present. One for the big projects folder and one inside the source of the project folder. My Folder structure looks like :\n    Eth_read\n     ->build_host\n     ->build_target\n     ->cmake\n     ->src\n        ->eth_read\n           ->main.cpp\n        ->CMakeLists.txt (sub-cmakelists.txt)\n      ->CMakeLists.txt (main-cmakelists.txt for projects)</p>\n\n<pre><code>--The main CMakeLists.txt is as below:\ncmake_minimum_required(VERSION 2.8.12 FATAL_ERROR)\n\nset(CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake)\nset(PCAP_LIBRARY /home/rsidhan1/Downloads/libpcap-1.9.1/libpcap.so.1.9.1) // this file was created after building for ARM \n\nProject(Testing C CXX)\n\ninclude_directories(/home/rsidhan1/Downloads/libpcap-1.9.1/)\n\nset(PROJECTS eth_read)\n\nforeach(PROJECT ${PROJECTS})\n    add_subdirectory(src/${PROJECT})\nendforeach()\n\n\n\n--The sub CMakeLists.txt is as below:\nproject(eth_read C CXX)\n\nset(PUBLIC_DOCS\n    README.md\n)\n\nset(SOURCES\n    main.cpp   \n)\n\ntarget_link_libraries(eth_read /home/rsidhan1/Downloads/libpcap-1.9.1/)\n</code></pre>\n\n<p>I have a main.cpp  where I use the function from pcap.h to open the interface, to capture packets and to callback function to process those packets.</p>\n\n<p>I would like to know how to add the cross compiled libraries in the CMakeLists.txt and use the cross compiled binary file in hardware to listen to Ethernet interface. \n    Please let me know if I am missing something or doing something wrong here.</p>\n"}, {"tags": ["c++", "cmake", "visual-studio-2019", "ninja"], "comments": [{"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1573052219, "post_id": 58732840, "comment_id": 103756024, "body": "What the content of the CMake files looks like?"}, {"owner": {"reputation": 23, "user_id": 8573433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5032f598ac06def1690baafe09dd3103?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kaufmann", "link": "https://stackoverflow.com/users/8573433/a-kaufmann"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1573053209, "post_id": 58732840, "comment_id": 103756625, "body": "it is just the add_executable (Test main.cpp ClassA.h ClassA.cpp ClassB.h ClassB.cpp)."}, {"owner": {"reputation": 23, "user_id": 8573433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5032f598ac06def1690baafe09dd3103?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kaufmann", "link": "https://stackoverflow.com/users/8573433/a-kaufmann"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1573053361, "post_id": 58732840, "comment_id": 103756724, "body": "With a colleague with suspect now ninja. My computer is in French. His computer is in English. On my computer ninja -t deps answers &quot;no dependency&quot; for each file. On his computer the answer is correct. It might be related to the fact that ninja seems to have troubles to filter the messages &quot;Note: include file:&quot;."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1573054386, "post_id": 58732840, "comment_id": 103757400, "body": "I&#39;d report the issue to ninja. Visit <a href=\"https://github.com/ninja-build/ninja/issues\" rel=\"nofollow noreferrer\">their issue tracker</a> and describe the problem. They will be primarily interested in the CMake file and the generated Ninja build file."}, {"owner": {"reputation": 23, "user_id": 8573433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5032f598ac06def1690baafe09dd3103?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kaufmann", "link": "https://stackoverflow.com/users/8573433/a-kaufmann"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1573055388, "post_id": 58732840, "comment_id": 103757992, "body": "Issue for ninja published."}], "owner": {"reputation": 23, "user_id": 8573433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5032f598ac06def1690baafe09dd3103?s=128&d=identicon&r=PG&f=1", "display_name": "A.Kaufmann", "link": "https://stackoverflow.com/users/8573433/a-kaufmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573051979, "creation_date": 1573051979, "question_id": 58732840, "link": "https://stackoverflow.com/questions/58732840/dependency-problem-between-files-using-visual-2019-cmake-ninja", "title": "Dependency problem between files using Visual 2019/CMake/Ninja", "body": "<p>I have a problem of undetected dependencies in a project I'm creating with Visual 2019/CMake/ninja. For a demonstration of this problem I have created a small case with two classes ClassA and ClassB. </p>\n\n<p>The .cpp file of ClassA is:</p>\n\n<pre><code>#include \"ClassA.h\"\n\n#include \"ClassB.h\"\n\nClassA::ClassA()\n{}\n\n\nClassA::~ClassA()\n{}\n\nvoid ClassA::callPrivateB()\n{\n    ClassB toto;\n    toto.privateFct();\n}\n</code></pre>\n\n<p>The .h file of ClassB is:</p>\n\n<pre><code>#pragma once\n\nclass ClassB\n{\npublic:\n    ClassB();\n\n    ~ClassB();\n\n    void privateFct();\n};\n</code></pre>\n\n<p>And the main.cpp is:</p>\n\n<pre><code>#include &lt;ClassA.h&gt;\n\nint main(int argc, char* argv[])\n{\n    ClassA toto;\n\n    toto.callPrivateB();\n\n    return 0;\n}\n</code></pre>\n\n<p>Note: ClassA.h, ClassB.cpp, and CMakeLists.txt are not added too do not put to many code.</p>\n\n<p>I'm compiling this application. Everything works well. That is normal. Now, I'm changing the file ClassB.h to put privateFct private. Then I request to recompile the application. And the result is:</p>\n\n<pre><code>ninja: no work to do.\nGenerate all: OK.\n</code></pre>\n\n<p>So, the fact that ClassA.cpp depends of ClassB.h has not been detected by ninja? cmake? Visual? \nAny idea on how to solve this problem?</p>\n"}, {"tags": ["c++", "multithreading", "stl", "vtk"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1573051985, "post_id": 58732804, "comment_id": 103755888, "body": "What do you mean by &quot;strange behavior&quot;?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1573052067, "post_id": 58732804, "comment_id": 103755928, "body": "You may consider to replace <code>std::map</code> with a sorted vector (if you really need it sorted). You may get a lot of cache misses due to memory fragmentation <code>std::map</code> has"}, {"owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "edited": false, "score": 0, "creation_date": 1573052074, "post_id": 58732804, "comment_id": 103755940, "body": "my cpu usage goes down even though i use all cores and all threads are running"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573052080, "post_id": 58732804, "comment_id": 103755944, "body": "Without seeing the code, there isn&#39;t much we can give you.  It sounds like a thread contention issue but you say you don&#39;t have any shared state you are locking on.  It could also be UB.  It could also be a cache issue"}, {"owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1573052254, "post_id": 58732804, "comment_id": 103756051, "body": "@Slava i used a map to have points that are near each other to be close in the memory as well considering caching but that did not have any impact in terms of performance. Because normally cloud is unordered in the disk."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573052325, "post_id": 58732804, "comment_id": 103756083, "body": "Maps don&#39;t put close objects to close to each other.  A map to could put the nodes <b>anywhere</b> in memory.  If you want locality, you a container like a vector."}, {"owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573052455, "post_id": 58732804, "comment_id": 103756162, "body": "@NathanOliver-ReinstateMonica the area is voxelized so map indexes represent a voxel so each vector contains points from the same voxel. I though since map is ordered by key voxels will be near each other in the memory."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1573052649, "post_id": 58732804, "comment_id": 103756268, "body": "@AliKanat A map, particularly <code>std::map</code> is implemented as a RBTree.  That means it has nodes.  Those nodes get allocated on demand so every time you add an object, even though it gets linked in an ordered way, where that node was allocated in memory is up to the allocator.  They might be next to each other, the might be in &quot;different ends&quot; of the memory."}, {"owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1573052897, "post_id": 58732804, "comment_id": 103756410, "body": "@NathanOliver-ReinstateMonica ah i see thank you for that information. However, i believe that is not the cause of the problem, because in the method when i dont use the map i dont have any issue and that cloud is also not sorted in any terms."}, {"owner": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1573054705, "post_id": 58732804, "comment_id": 103757590, "body": "Depending on how much memory is required to hold this data, it&#39;s possible that the system begins swapping which will mean CPU utilization drops as the system has nothing to do while waiting on disk I/O to swap in/out pages of memory."}, {"owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "reply_to_user": {"reputation": 133051, "user_id": 501250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c39ae7fe43cf30bc0f4d4051defcbd87?s=128&d=identicon&r=PG", "display_name": "cdhowie", "link": "https://stackoverflow.com/users/501250/cdhowie"}, "edited": false, "score": 0, "creation_date": 1573056498, "post_id": 58732804, "comment_id": 103758618, "body": "@cdhowie normally i have free memory when this issue is happening but i am not sure if swapping happens"}], "owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573051879, "creation_date": 1573051879, "question_id": 58732804, "link": "https://stackoverflow.com/questions/58732804/weird-behaviour-when-inserting-too-many-items-to-stdmap-or-stdunordered-map", "title": "Weird behaviour when inserting too many items to std::map or std::unordered_map", "body": "<p>I am working on point clouds and i use <code>std::map&lt;int, std::vector&lt;int&gt;&gt;</code> for down sampling the cloud. Keys in the map holds spatial index and vector holds ids of points. From this map i extract some points to process and that processing is done using multithreading(not the part with the map). At this point map is already out of scope. However, When my cloud is too big and downsampling ratio is too low i get a really strange behavior. Even though i use all my logical threads my cpu usage goes down to 60-70%. When i do the down sampling without the map(by simply skipping points) i don't get this issue. I checked that all the threads are running and my application has no mutexes they only read from the cloud which is a <code>vtkUnstructuredGrid</code> and thread safe for read only operation. I don't see why something like this would happen.</p>\n\n<p>Could this issue be happening because of <code>map::max_size()</code> because when i decrease the size of the map i dont have any issue. Also why would it cause issue in my multithreaded part? My question would be does inserting elements to map more than <code>max_size</code> cause some sort of undefined behavior? Thanks in advance.</p>\n"}, {"tags": ["c++", "visual-c++", "visual-studio-code", "vscode-code-runner"], "comments": [{"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1573053377, "post_id": 58732791, "comment_id": 103756737, "body": "Run <code>vsvars64.bat</code> in your command prompt first, then run coderunner from that command prompt (Visual Studio adds a shortcut to do this: Command Prompt for Visual Studio 2019 (or similar))"}], "answers": [{"comments": [{"owner": {"reputation": 7323, "user_id": 4960953, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6d6e55bc6aef94acc340d142f9f8aded?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail_Sam", "link": "https://stackoverflow.com/users/4960953/mikhail-sam"}, "edited": false, "score": 1, "creation_date": 1582014385, "post_id": 60233878, "comment_id": 106620164, "body": "Thank you for responce! It&#39;s work, but I need to use <code>vcvars64.bat</code> first time manually. How to use it automatically? In my example I use <code>vcvars64.bat</code> in <code>code-runner.executorMap</code> and it is a matter of error."}, {"owner": {"reputation": 33, "user_id": 9880123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AgcW2.jpg?s=128&g=1", "display_name": "karthik oggu", "link": "https://stackoverflow.com/users/9880123/karthik-oggu"}, "reply_to_user": {"reputation": 7323, "user_id": 4960953, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6d6e55bc6aef94acc340d142f9f8aded?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail_Sam", "link": "https://stackoverflow.com/users/4960953/mikhail-sam"}, "edited": false, "score": 0, "creation_date": 1582396453, "post_id": 60233878, "comment_id": 106766289, "body": "don&#39;t know y it&#39;s not working in cmd but it working fine in powerShell."}], "tags": [], "owner": {"reputation": 33, "user_id": 9880123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AgcW2.jpg?s=128&g=1", "display_name": "karthik oggu", "link": "https://stackoverflow.com/users/9880123/karthik-oggu"}, "is_accepted": false, "score": 1, "last_activity_date": 1581716392, "creation_date": 1581716392, "answer_id": 60233878, "question_id": 58732791, "link": "https://stackoverflow.com/questions/58732791/code-runner-using-msvc-create-a-too-long-string/60233878#60233878", "title": "Code Runner using MSVC create a too long string", "body": "<p><br>\nThis is my setting.json\n</p>\n\n<pre><code>\"code-runner.executorMap\": {\n    \"cpp\": \"cd $dir &amp;&amp; cl /EHsc $fileName &amp;&amp; cls &amp;&amp; $dir$fileNameWithoutExt.exe &amp;&amp; del \n  $dir$fileNameWithoutExt.obj $dir$fileNameWithoutExt.exe\",\n},\n</code></pre>\n\n<p>And it's <strong>working as expected</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 9880123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AgcW2.jpg?s=128&g=1", "display_name": "karthik oggu", "link": "https://stackoverflow.com/users/9880123/karthik-oggu"}, "is_accepted": false, "score": 1, "last_activity_date": 1582395902, "last_edit_date": 1582395902, "creation_date": 1582394913, "answer_id": 60355212, "question_id": 58732791, "link": "https://stackoverflow.com/questions/58732791/code-runner-using-msvc-create-a-too-long-string/60355212#60355212", "title": "Code Runner using MSVC create a too long string", "body": "<p><strong>change</strong> default shell to <strong>PowerShell</strong> in vs-code</p>\n\n<pre><code>\"terminal.integrated.shell.windows\": \"C:\\\\WINDOWS\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\",\n</code></pre>\n\n<p>then <strong>add this</strong> in <strong>setting.json</strong> file : </p>\n\n<p><strong>For PowerShell</strong> </p>\n\n<pre><code>\"cpp\": \"cd $dir ; vcvars64.bat ;  cl /EHsc $fileName ; ./$fileNameWithoutExt.exe\",\n</code></pre>\n"}], "owner": {"reputation": 7323, "user_id": 4960953, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/6d6e55bc6aef94acc340d142f9f8aded?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail_Sam", "link": "https://stackoverflow.com/users/4960953/mikhail-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1582395902, "creation_date": 1573051854, "question_id": 58732791, "link": "https://stackoverflow.com/questions/58732791/code-runner-using-msvc-create-a-too-long-string", "title": "Code Runner using MSVC create a too long string", "body": "<p>I use CodeRunner for VSCode on Windows, so I need to change g++ to MSVC (Visual C++ Compiler).\nSo I configure <code>settings.json</code> for coderunner:</p>\n\n<pre><code>{\n    \"window.zoomLevel\": 0,\n    \"code-runner.runInTerminal\": true,\n    \"terminal.integrated.shell.windows\": \"cmd.exe\",\n    \"code-runner.executorMap\": {\n        \"cpp\": \"vcvars64.bat &amp;&amp; cl.exe $fileName &amp;&amp; del $fileNameWithoutExt.obj &amp;&amp; cls &amp;&amp; $fileNameWithoutExt.exe\",\n    },\n    \"files.autoSave\": \"afterDelay\"\n}\n</code></pre>\n\n<p>As you can see, I add path of vcvars64.bat to system PATH.\nIt works, but after several runs I get next error:</p>\n\n<blockquote>\n  <p>Input line is too long.</p>\n</blockquote>\n\n<p>I search for it and found that it is because CodeRunner run vcvars64.bat every time! So after several runs total path become too long:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/16821784/input-line-is-too-long-error-in-bat-file\">&quot;Input line is too long&quot; error in BAT File</a></p>\n\n<p>Restarting console clear it, but after several runs falls again.</p>\n\n<p>Looks like I need to find some way to use <code>vcvars64.bat</code> only once but I don't know how!</p>\n"}, {"tags": ["c++", "object", "reference"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1573051351, "post_id": 58732593, "comment_id": 103755491, "body": "It&#39;s not impossible that trying to <code>delete</code> through a reference will work, but it&#39;s usually a sign that you are doing something very wrong.  Please share the relevant code to be sure that any answer to this question doesn&#39;t cause more problems than it causes."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1573051362, "post_id": 58732593, "comment_id": 103755496, "body": "We love that you&#39;re here and show us your code so we can help."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1573051365, "post_id": 58732593, "comment_id": 103755497, "body": "Sounds like a job for smart pointers but this is too little information to say for certain.  If the map is going to control the lifetimes, the map should own the objects."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1573051476, "post_id": 58732593, "comment_id": 103755581, "body": "How do you store the object references? What objects do they really reference? Where and how are the real objects stored? And can you please try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 1, "creation_date": 1573051630, "post_id": 58732593, "comment_id": 103755686, "body": "IIRC, references are not valid mapped types for maps."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1573054711, "post_id": 58732593, "comment_id": 103757596, "body": "Store objects in the map by value and that solves your issue."}, {"owner": {"reputation": 11, "user_id": 7403742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99590078329e9a437a24fe4f2ae49043?s=128&d=identicon&r=PG&f=1", "display_name": "e3r4t5y6", "link": "https://stackoverflow.com/users/7403742/e3r4t5y6"}, "edited": false, "score": 0, "creation_date": 1573068688, "post_id": 58732593, "comment_id": 103764608, "body": "The object has many parameters, so I can&#39;t just store the object by value"}], "owner": {"reputation": 11, "user_id": 7403742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99590078329e9a437a24fe4f2ae49043?s=128&d=identicon&r=PG&f=1", "display_name": "e3r4t5y6", "link": "https://stackoverflow.com/users/7403742/e3r4t5y6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573051744, "creation_date": 1573051258, "last_edit_date": 1573051744, "question_id": 58732593, "link": "https://stackoverflow.com/questions/58732593/how-to-delete-an-object-using-reference-in-c", "title": "How to delete an object using reference in C++?", "body": "<p>I have object ids and object references stored in a map.\nI need to delete few objects whose references are in that map.\nUsing erase() function would just remove it from the map, but I would want the object to be deleted.</p>\n\n<p>I'm trying to implement Garbage  Collection. I have a std::map root set map and std::map objects map. I'm trying to compare the object ids and references, which are there in the root set(or in the reference field of the objects in root set) and delete rest of the objects(using objects map) which are not part of root set.</p>\n"}, {"tags": ["c++", "windows", "usb", "solid-state-drive"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1573055698, "post_id": 58732585, "comment_id": 103758177, "body": "This is a platform specific issue and you forgot to mention the platform and OS."}, {"owner": {"reputation": 1, "user_id": 8439875, "user_type": "registered", "profile_image": "https://graph.facebook.com/673678332840585/picture?type=large", "display_name": "Zb&#238;rnea Tiberiu", "link": "https://stackoverflow.com/users/8439875/zb%c3%aernea-tiberiu"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1573074059, "post_id": 58732585, "comment_id": 103766808, "body": "I work in Windows"}], "answers": [{"tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": false, "score": 2, "last_activity_date": 1573052533, "creation_date": 1573052533, "answer_id": 58733012, "question_id": 58732585, "link": "https://stackoverflow.com/questions/58732585/how-can-i-determine-if-an-ssd-drive-is-fixed-drive-or-connected-on-usb/58733012#58733012", "title": "How can I determine if an SSD drive is fixed drive or connected on USB?", "body": "<p>If you are on Windows, you can use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getdrivetypea\" rel=\"nofollow noreferrer\">GetDriveType</a>.</p>\n\n<p>Sample usage:</p>\n\n<pre><code>UINT nType = GetDriveType(_T(\"C:\\\\\"))\n</code></pre>\n\n<p>Return values for nType:</p>\n\n<p><strong>DRIVE_FIXED</strong>: \nThe drive has fixed media; for example, a hard disk drive or flash drive.</p>\n\n<p><strong>DRIVE_REMOVABLE</strong>:\nThe drive has removable media; for example, a floppy drive, thumb drive, or flash card reader.</p>\n\n<p>To check if it's USB drive, you must call for <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/setupapi/nf-setupapi-setupdigetdeviceregistrypropertya\" rel=\"nofollow noreferrer\">SetupDiGetDeviceRegistryProperty</a>.</p>\n\n<p>You can find a sample code <a href=\"https://stackoverflow.com/a/4947865/1410246\">here</a> and <a href=\"https://stackoverflow.com/q/3438366/1410246\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8439875, "user_type": "registered", "profile_image": "https://graph.facebook.com/673678332840585/picture?type=large", "display_name": "Zb&#238;rnea Tiberiu", "link": "https://stackoverflow.com/users/8439875/zb%c3%aernea-tiberiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1607607803, "creation_date": 1573051231, "last_edit_date": 1607607803, "question_id": 58732585, "link": "https://stackoverflow.com/questions/58732585/how-can-i-determine-if-an-ssd-drive-is-fixed-drive-or-connected-on-usb", "title": "How can I determine if an SSD drive is fixed drive or connected on USB?", "body": "<p>Is it possible to determine if an SSD drive is connected on USB or if is fixed disk (connected to motherboard)?</p>\n"}, {"tags": ["c++", "macos", "sdk", "vulkan", "moltenvk"], "comments": [{"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1573053110, "post_id": 58732459, "comment_id": 103756549, "body": "What version of <code>glfw</code>?"}, {"owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1573053280, "post_id": 58732459, "comment_id": 103756676, "body": "The version of glfw is 3.3"}, {"owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "reply_to_user": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1573053381, "post_id": 58732459, "comment_id": 103756740, "body": "Are you using MoltenVK? @trojanfoe OP does not mention this, does not tag this, and I don&#39;t see it anywhere."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "reply_to_user": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 0, "creation_date": 1573053418, "post_id": 58732459, "comment_id": 103756771, "body": "@opa The OP and me have <a href=\"https://stackoverflow.com/questions/58728757/how-to-add-mac-os-framework-on-cmake-file-for-c-project\">history</a>.  Of course looking at <i>that</i> question seems to indicate a non-standard MoltenVK library being used..."}, {"owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "edited": false, "score": 0, "creation_date": 1573053695, "post_id": 58732459, "comment_id": 103756976, "body": "Indeed I do not use MoltenVK Wrapper"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1573053728, "post_id": 58732459, "comment_id": 103756998, "body": "Yeah you do, you just don&#39;t set it up properly."}, {"owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "edited": false, "score": 0, "creation_date": 1573053888, "post_id": 58732459, "comment_id": 103757092, "body": "Ah ok, I did not know, I follow the tutorial of <a href=\"https://vulkan-tutorial.com/#page_E-book\" rel=\"nofollow noreferrer\">vulkan tutorial</a> and the tutorial does not mention MoltenVK"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "edited": false, "score": 0, "creation_date": 1573053994, "post_id": 58732459, "comment_id": 103757150, "body": "I am no Vulkan expert but got it running on a macOS app and it needed configuration files and all sorts for it to find its base configuration.  It was much easier doing it with Metal :)"}, {"owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "edited": false, "score": 0, "creation_date": 1573054651, "post_id": 58732459, "comment_id": 103757559, "body": "I am student and I realy wanted to learn how to use Vulkan, but I think I am gonna have many problem with this API on my mac. I will use Metal or OpenGL for my soft (on my mac), if I make my soft work on Windows or linux I will use Vulkan for my rendering subsystem. Thank you for yours help :}"}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "is_accepted": false, "score": 0, "last_activity_date": 1573117731, "creation_date": 1573117731, "answer_id": 58745303, "question_id": 58732459, "link": "https://stackoverflow.com/questions/58732459/vk-error-incompatible-driver-with-mac-os-and-vulkan-moltenvk/58745303#58745303", "title": "VK_ERROR_INCOMPATIBLE_DRIVER with Mac OS and Vulkan MoltenVK", "body": "<p>Here an answer from the vulkan forum, hope it will help for other people who try to developed with Vulkan on Mac OS:</p>\n\n<p>You can check <a href=\"https://vulkan.gpuinfo.org/\" rel=\"nofollow noreferrer\">link</a> for hardware support - on a quick glance I don\u2019t see your GPU in there.\nHowever, if you are on macOS (as opposed to e.g. running a different OS on the hardware) you cannot access Vulkan directly because it is not supported by the OS. You can use MoltenVK (which is part of the Vulkan SDK, so you may already have it), a translation layer that turns Vulkan API calls into corresponding Metal API calls.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15034868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5c93937dad627115657cd9bf28f27f?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/15034868/kay"}, "is_accepted": false, "score": 0, "last_activity_date": 1611038461, "last_edit_date": 1611038461, "creation_date": 1611038340, "answer_id": 65786575, "question_id": 58732459, "link": "https://stackoverflow.com/questions/58732459/vk-error-incompatible-driver-with-mac-os-and-vulkan-moltenvk/65786575#65786575", "title": "VK_ERROR_INCOMPATIBLE_DRIVER with Mac OS and Vulkan MoltenVK", "body": "<p>I met the same problem, and I solved it by running this command in the SDK:</p>\n<pre><code>sudo ./install_vulkan.py --force-install\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11038915, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Tj6Zy2UscE/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNfSnrP4Z0SDvvMLTh-N_Yyt77JHg/mo/photo.jpg?sz=128", "display_name": "Benzait Sofiane", "link": "https://stackoverflow.com/users/11038915/benzait-sofiane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1611038461, "creation_date": 1573050774, "last_edit_date": 1573053458, "question_id": 58732459, "link": "https://stackoverflow.com/questions/58732459/vk-error-incompatible-driver-with-mac-os-and-vulkan-moltenvk", "title": "VK_ERROR_INCOMPATIBLE_DRIVER with Mac OS and Vulkan MoltenVK", "body": "<p>I am trying to use Vulkan API on my mac OS (with my Intel HD Graphics 5000 1536 Mo).\nBut when I create an Instance With a <code>VkCreateInstance(...)</code></p>\n\n<p>the result of  <code>VkCreateInstance(...)</code> is VK_ERROR_INCOMPATIBLE_DRIVER.</p>\n\n<p>Here my code for initialize my VkInstance :</p>\n\n<pre><code>    VkApplicationInfo vkAppInfo    = {};\n    vkAppInfo.sType                = VK_STRUCTURE_TYPE_APPLICATION_INFO;\n    vkAppInfo.pApplicationName     = \"S2Engine\";\n    vkAppInfo.applicationVersion   = VK_MAKE_VERSION(1, 0, 0);\n    vkAppInfo.pEngineName          = \"No Engine\"; //TODO plus tard\n    vkAppInfo.engineVersion        = VK_MAKE_VERSION(1, 0, 0);\n    vkAppInfo.apiVersion           = VK_API_VERSION_1_0;\n\n\n\n    //Obligatoire\n    VkInstanceCreateInfo vkInstanceCreateInfo = {};\n    vkInstanceCreateInfo.sType                = VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO;\n    vkInstanceCreateInfo.pApplicationInfo     = &amp;vkAppInfo;\n\n    uint32_t glfwExtensionCount               = 0;\n    const char** glfwExtensions                  ;\n\n    glfwExtensions                            = glfwGetRequiredInstanceExtensions(&amp;glfwExtensionCount);\n\n    vkInstanceCreateInfo.enabledExtensionCount      = glfwExtensionCount;\n    vkInstanceCreateInfo.ppEnabledExtensionNames    = glfwExtensions;\n\n    vkInstanceCreateInfo.enabledLayerCount = 0;\n\n\n    if (vkCreateInstance(&amp;vkInstanceCreateInfo, nullptr /*custom allocator*/, &amp;_vkInstance) != VK_SUCCESS) {\n        throw std::runtime_error(\"failed to create instance!\");\n    }\n</code></pre>\n\n<p>So my question is do the vulkan API is available on my Mac OS with MoltenVK ? If yes, what can I do in order to make my app work ?</p>\n"}, {"tags": ["c++", "eof"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 1, "creation_date": 1573050913, "post_id": 58732434, "comment_id": 103755259, "body": "There is no such entity named &quot;EOF&quot; that exists in any stream. You&#39;re asking about the stream status or state."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1573051136, "post_id": 58732434, "comment_id": 103755385, "body": "The stream doesn&#39;t read <code>Ctrl + D</code>. It&#39;s interpreted by the terminal. So the behavior of <code>clear</code> depends on your terminal. I assume that in newer systems it closes the standard input. If that&#39;s the case clearing the eof bit doesn&#39;t help. The standard input will still be closed."}, {"owner": {"reputation": 3445, "user_id": 2396502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R6e2l.png?s=128&g=1", "display_name": "Peaceful", "link": "https://stackoverflow.com/users/2396502/peaceful"}, "edited": false, "score": 0, "creation_date": 1587089178, "post_id": 58732434, "comment_id": 108378200, "body": "I am also facing the same issue. I did not get any reasonable answer to this question so far."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9375582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxVYj.png?s=128&g=1", "display_name": "haward79", "link": "https://stackoverflow.com/users/9375582/haward79"}, "is_accepted": false, "score": 0, "last_activity_date": 1607225447, "creation_date": 1607225447, "answer_id": 65164399, "question_id": 58732434, "link": "https://stackoverflow.com/questions/58732434/cin-clear-leave-eof-in-stream/65164399#65164399", "title": "cin.clear() leave EOF in stream?", "body": "<p>I have the same issue in Ubuntu 20.</p>\n<p>I find the solution from <a href=\"https://stackoverflow.com/questions/51194821/how-to-restart-stdin-after-ctrld\">How to restart stdin after Ctrl+D?</a></p>\n<p>Terminal doesn't really close stdin stream. The stream just return &quot;nothing&quot; to indicate EOF or other troubles.</p>\n<p>To clear EOF, calling clearerr(stdin) in your program may solve the problem.</p>\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main(void)\n{\n    char c, d;\n    cout &lt;&lt; &quot;Enter a char: &quot; &lt;&lt; endl;\n    cin &gt;&gt; c;\n    clearerr(stdin);\n    cout &lt;&lt; &quot;\\nEnter another char: &quot; &lt;&lt; endl;\n    cin &gt;&gt; d;\n\n    cout &lt;&lt; &quot;\\n\\nc = '&quot; &lt;&lt; c &lt;&lt; &quot;' and d = '&quot; &lt;&lt; d &lt;&lt; &quot;'\\n\\n&quot;;\n\n    return 0;\n}\n</code></pre>\n<p>My g++ version is 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04)<br />\nMy OS is ubuntu 20 x64<br />\nMy terminal is gnome-terminal 3.36.1.1</p>\n"}], "owner": {"reputation": 11, "user_id": 12332506, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dh7CDU0aVvk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2L10OER0gtWXfaXMsz_0QmAB7Fg/photo.jpg?sz=128", "display_name": "Jhon", "link": "https://stackoverflow.com/users/12332506/jhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1607225447, "creation_date": 1573050700, "last_edit_date": 1573056956, "question_id": 58732434, "link": "https://stackoverflow.com/questions/58732434/cin-clear-leave-eof-in-stream", "title": "cin.clear() leave EOF in stream?", "body": "<p>I have a question about <code>cin.clear()</code>, my cpp code like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\n\nint main(void)\n{\n        char c, d;\n        cout &lt;&lt; \"Enter a char: \" &lt;&lt; endl;\n        cin &gt;&gt; c;                            // here I will enter Ctrl + D (that is EOF under linux)\n        cin.clear();\n        cout &lt;&lt; \"Enter another char: \" &lt;&lt; endl;\n        cin &gt;&gt; d;\n\n        return 0;\n}\n</code></pre>\n\n<p>I compiled and run this code under 2 systems: \none system is Debian 7 with older version of software like g++ and library</p>\n\n<pre><code> g++ --version\ng++ (Debian 6.3.0-18+deb9u1) 6.3.0 20170516\nCopyright (C) 2016 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>another system is Arch linux with newer version of software:</p>\n\n<pre><code>g++ --version\ng++ (GCC) 9.2.0\nCopyright (C) 2019 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>When I run this program , I enter Ctrl + D (EOF) when it ask me to \"Enter a char: \". The problem is that When I run it under Debian 7, I can Enter a char when the program asks me to \"Enter another char: \", but I will not be able to do the same under newer system, the program just finished.</p>\n\n<p>It seems that <code>cin.clear()</code> will clear eof bit and flush EOF in the stream under older system, with newer system <code>cin.clear()</code> will clear eof bit, but leave EOF in the stream untouched.</p>\n\n<p>Is this caused by some new cpp standards? And why <code>cin.clear()</code> behave differenly under 2 systems?</p>\n"}, {"tags": ["c++", "string", "sizeof", "c-strings", "string-literals"], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1573050909, "creation_date": 1573050909, "answer_id": 58732496, "question_id": 58732359, "link": "https://stackoverflow.com/questions/58732359/how-about-string-datatype-is-stored-as-bytes/58732496#58732496", "title": "How About string datatype is stored as bytes", "body": "<p>For starters the output of this statement</p>\n\n<pre><code>std::cout&lt;&lt;sizeof \"//n\"&lt;&lt;endl; //3 bytes\n</code></pre>\n\n<p>is <code>4</code>.</p>\n\n<p>In this statement </p>\n\n<pre><code>std::cout&lt;&lt;sizeof(name)&lt;&lt;endl;\n</code></pre>\n\n<p>there is outputted the size of an object of the type <code>std::string</code>. It is not the size of a string stored in the object. To output the size of the string you should write</p>\n\n<pre><code>std::cout&lt;&lt;name.size()&lt;&lt;endl;\n</code></pre>\n\n<p>and you will get <code>0</code> because the object does not contain any string.</p>\n\n<p>So if the size of an object of the type std::string is equal to 32 then the size of an array that contains 6 such objects is <code>6 * 32 = 192</code>.</p>\n\n<p>In this statement</p>\n\n<pre><code>std::cout&lt;&lt;sizeof \"n\"&lt;&lt;endl;\n</code></pre>\n\n<p>there is an output of the size of the string literal <code>\"n\"</code> that contains 2 characters (<code>{ 'n', '\\0' }</code>) including the terminating zero.</p>\n\n<p>And in this statement</p>\n\n<pre><code>std::cout&lt;&lt;sizeof \"//n\"&lt;&lt;endl;\n</code></pre>\n\n<p>there is also an output of the size of the string literal <code>\"//n\"</code> that contains 4 characters including the terminating zero.</p>\n"}, {"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1573051226, "last_edit_date": 1573051226, "creation_date": 1573050911, "answer_id": 58732497, "question_id": 58732359, "link": "https://stackoverflow.com/questions/58732359/how-about-string-datatype-is-stored-as-bytes/58732497#58732497", "title": "How About string datatype is stored as bytes", "body": "<p>Basically, a <code>std::string</code> object is nothing more than a pointer to the actual string data<sup>1</sup>, and some information about the string it wraps (like its current length). There might be other implementation-specific data that pushes up this number.</p>\n\n<p>And to understand the size of string literals like <code>\"n\"</code>, you need to understand that all string literals in C++ are really arrays of constant characters, <em>including</em> the string null-terminator character. So e.g. <code>\"n\"</code> is really an array of two characters: The <code>'n'</code> character and the <code>'\\0'</code> string terminator.</p>\n\n<p>That means your claim that <code>sizeof \"//n\"</code> is three bytes is wrong, it's really four bytes.</p>\n\n<p>Finally, the size of an array is the total size of the array. In other words the size of each element multiplied by the number of elements.</p>\n\n<hr>\n\n<p><sup>1</sup> While this is the \"classic\" view of <code>std::string</code>, it's not always true as there's often something called <em>short string optimization</em> where short string can be fully stored inside the <code>std::string</code> object itself. There's no standardized limit that defines a \"short string\", and it's really an implementation detail.</p>\n"}], "owner": {"reputation": 104, "user_id": 12277273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TNdHt.jpg?s=128&g=1", "display_name": "Talal02", "link": "https://stackoverflow.com/users/12277273/talal02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58732496, "answer_count": 2, "score": 1, "last_activity_date": 1573051635, "creation_date": 1573050448, "last_edit_date": 1592644375, "question_id": 58732359, "link": "https://stackoverflow.com/questions/58732359/how-about-string-datatype-is-stored-as-bytes", "title": "How About string datatype is stored as bytes", "body": "<h1>Question</h1>\n<p>Hello!\nMy question is about string datatype value when it is stored as bytes.\nSee my code below:</p>\n<h1>What's Problem</h1>\n<pre><code>int main(){\n    string name, names[6];\n    std::cout&lt;&lt;sizeof(name)&lt;&lt;endl; //32 bytes\n    std::cout&lt;&lt;sizeof &quot;n&quot;&lt;&lt;endl; //2 bytes\n    std::cout&lt;&lt;sizeof &quot;//n&quot;&lt;&lt;endl; //3 bytes\n    std::cout&lt;&lt;sizeof(names)&lt;&lt;endl; //192 bytes\n}\n</code></pre>\n<h1>Any Explaination?</h1>\n<p>Why is this happening? Can someone explain me how string datatype stores itself?</p>\n"}, {"tags": ["c++", "c++17", "clang++", "c++20"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1573050699, "post_id": 58732324, "comment_id": 103755147, "body": "Per <a href=\"https://libcxx.llvm.org/cxx1z_status.html\" rel=\"nofollow noreferrer\">the status page</a> it&#39;s a black hole.  Hopefully someone on the clang team will see this and be able to provide some more information."}, {"owner": {"reputation": 5184, "user_id": 6350078, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fcbd9246215586c3ff1b5c338570dd8d?s=128&d=identicon&r=PG&f=1", "display_name": "metalfox", "link": "https://stackoverflow.com/users/6350078/metalfox"}, "edited": false, "score": 2, "creation_date": 1573108638, "post_id": 58732324, "comment_id": 103775354, "body": "Here you can track it: <a href=\"https://reviews.llvm.org/source/pstl/\" rel=\"nofollow noreferrer\">reviews.llvm.org/source/pstl</a>"}], "owner": {"reputation": 5201, "user_id": 11638718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359a4a973e6a1f850f94f71bf09a47f6?s=128&d=identicon&r=PG&f=1", "display_name": "\u5eb7\u6853\u744b", "link": "https://stackoverflow.com/users/11638718/%e5%ba%b7%e6%a1%93%e7%91%8b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 656, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1573050337, "creation_date": 1573050337, "question_id": 58732324, "link": "https://stackoverflow.com/questions/58732324/how-is-the-clangs-parallel-stl-progress", "title": "How is the Clang&#39;s Parallel STL progress?", "body": "<p>According to <a href=\"https://en.cppreference.com/w/cpp/compiler_support\" rel=\"noreferrer\">cppreference</a>, GCC-9 has already implemented the <strong>C++17 Parallel STL</strong> with the linking flag <code>-ltbb</code>, but I have not heard information about how Clang focus on that feature or they will never implement that? Can someone tell me about the latest progress, thanks a lot.</p>\n"}, {"tags": ["c#", "c++", "opencv"], "comments": [{"owner": {"reputation": 139, "user_id": 3118959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fec6bcc2dff5dfabbf8359f1f42a29?s=128&d=identicon&r=PG&f=1", "display_name": "Himesh Sameera", "link": "https://stackoverflow.com/users/3118959/himesh-sameera"}, "edited": false, "score": 0, "creation_date": 1573475200, "post_id": 58731949, "comment_id": 103882706, "body": "Does the application crash?? What is the exception you get?"}, {"owner": {"reputation": 11, "user_id": 12332375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286ebe012a4e9a2a6143b22ec12c902?s=128&d=identicon&r=PG&f=1", "display_name": "Harpery", "link": "https://stackoverflow.com/users/12332375/harpery"}, "reply_to_user": {"reputation": 139, "user_id": 3118959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fec6bcc2dff5dfabbf8359f1f42a29?s=128&d=identicon&r=PG&f=1", "display_name": "Himesh Sameera", "link": "https://stackoverflow.com/users/3118959/himesh-sameera"}, "edited": false, "score": 0, "creation_date": 1573539099, "post_id": 58731949, "comment_id": 103904354, "body": "Thanks,this application doesn&#39;t crash,but it always returns 0,the imread function in opencv doesn&#39;t work,so I can&#39;t get the number of rows and columns of this test picture."}, {"owner": {"reputation": 139, "user_id": 3118959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fec6bcc2dff5dfabbf8359f1f42a29?s=128&d=identicon&r=PG&f=1", "display_name": "Himesh Sameera", "link": "https://stackoverflow.com/users/3118959/himesh-sameera"}, "edited": false, "score": 0, "creation_date": 1573578875, "post_id": 58731949, "comment_id": 103923949, "body": "Well then there are 2 posibilities. Imread has a problem or c++/c# interfacing has a problem. To verify please run a c++ console app with above code and check the results. Imread is a very reliable function and I ve used it many times. May be your image path is wrong or image is corroupted."}, {"owner": {"reputation": 139, "user_id": 3118959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fec6bcc2dff5dfabbf8359f1f42a29?s=128&d=identicon&r=PG&f=1", "display_name": "Himesh Sameera", "link": "https://stackoverflow.com/users/3118959/himesh-sameera"}, "edited": false, "score": 0, "creation_date": 1573623639, "post_id": 58731949, "comment_id": 103937451, "body": "Unsafe block is not needed here because we are not using any pointers.  If you are using visual studio please put a break point on &quot;return rowPic;&quot; line and check the readImage. If its null, it is because of missing file, improper permissions, unsupported or invalid format. Check this out also <a href=\"https://docs.opencv.org/master/d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56\" rel=\"nofollow noreferrer\">docs.opencv.org/master/d4/da8/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 12332375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286ebe012a4e9a2a6143b22ec12c902?s=128&d=identicon&r=PG&f=1", "display_name": "Harpery", "link": "https://stackoverflow.com/users/12332375/harpery"}, "reply_to_user": {"reputation": 139, "user_id": 3118959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fec6bcc2dff5dfabbf8359f1f42a29?s=128&d=identicon&r=PG&f=1", "display_name": "Himesh Sameera", "link": "https://stackoverflow.com/users/3118959/himesh-sameera"}, "edited": false, "score": 0, "creation_date": 1573625200, "post_id": 58731949, "comment_id": 103937874, "body": "THANKS,When I use C + + to packagethe DLL, I use C + + to call the DLL, and the result is what I want, but the return value of C# call is always 0. At first, I passed the path string into the DLL as a pointer, so I used unsafe. Later, I passed the path directly instead of the pointer."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12332375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286ebe012a4e9a2a6143b22ec12c902?s=128&d=identicon&r=PG&f=1", "display_name": "Harpery", "link": "https://stackoverflow.com/users/12332375/harpery"}, "edited": false, "score": 0, "creation_date": 1573539284, "post_id": 58801446, "comment_id": 103904430, "body": "OK,I will try it now.Thanks."}, {"owner": {"reputation": 11, "user_id": 12332375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286ebe012a4e9a2a6143b22ec12c902?s=128&d=identicon&r=PG&f=1", "display_name": "Harpery", "link": "https://stackoverflow.com/users/12332375/harpery"}, "edited": false, "score": 0, "creation_date": 1573549249, "post_id": 58801446, "comment_id": 103908375, "body": "After I try, it still doesn&#39;t work. The return result of the function is still 0.I found that it&#39;s not lack of other DLLs, it&#39;s just that the imread function in opencv can&#39;t be used."}], "tags": [], "owner": {"reputation": 139, "user_id": 3118959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94fec6bcc2dff5dfabbf8359f1f42a29?s=128&d=identicon&r=PG&f=1", "display_name": "Himesh Sameera", "link": "https://stackoverflow.com/users/3118959/himesh-sameera"}, "is_accepted": false, "score": 0, "last_activity_date": 1573475601, "creation_date": 1573475601, "answer_id": 58801446, "question_id": 58731949, "link": "https://stackoverflow.com/questions/58731949/c-calls-opencv-related-function-and-is-packaged-into-dll-c-can-not-call-it/58801446#58801446", "title": "c++ calls opencv related function and is packaged into dll, c# can not call it", "body": "<p>From the look of it I think it's a dll not found exception. I've encountered many of these. Probably you can figure it out by running EventViewer (its a utility inside windows). Event viewer will have an entry on what is the missing DLL. Probably copying all the opencv dlls to the execution path will fix the issue.</p>\n"}], "owner": {"reputation": 11, "user_id": 12332375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286ebe012a4e9a2a6143b22ec12c902?s=128&d=identicon&r=PG&f=1", "display_name": "Harpery", "link": "https://stackoverflow.com/users/12332375/harpery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573475601, "creation_date": 1573049152, "last_edit_date": 1573474757, "question_id": 58731949, "link": "https://stackoverflow.com/questions/58731949/c-calls-opencv-related-function-and-is-packaged-into-dll-c-can-not-call-it", "title": "c++ calls opencv related function and is packaged into dll, c# can not call it", "body": "<p>c++ is called dll after calling opencv related function, c# can not call it.but if I don't use the opencv in my dll,it works well.just like the imread function in the opencv package.</p>\n\n<p>When I packaged the dll, I used opencv.dll and its lib file. In C++, their related environment has been configured. I don't know if c# needs to configure the related opencv environment, or what other methods are needed.</p>\n\n<pre><code>[c++ code]-Packaged into test.dll\n#include&lt;memory.h&gt;\n#include&lt;time.h&gt;\n#include&lt;math.h&gt;\n#include&lt;vector&gt;\n#include\"test.h\"\n\n#pragma comment(lib,\"opencv_world310.lib\")\n\nusing namespace cv;\nusing namespace std;\n\nextern \"C\" __declspec(dllexport) int test();\nint test()\n{\n    Mat readImage = imread(\"D:\\\\pic\\\\pic1.JPG\");\n    int rowPic = readImage.rows;\n    return rowPic;\n}\n\n[c# code]-Call the test.dll\nnamespace testOilDetectionCsharp\n{\n    public sealed partial class MainPage : Page\n    {\n        [DllImport(\"test.dll\", CharSet = CharSet.Unicode)]\n        extern static int test();\n\n        public MainPage()\n        {\n            this.InitializeComponent();\n        }\n\n        private void Button_Click(object sender, RoutedEventArgs e)\n        {\n            unsafe\n            {\n                int num = test();\n                textBox.Text = num.ToString();\n            }\n        }\n\n    }\n}\n</code></pre>\n\n<p>just like the test function,I have the pic path,but in c#, calling the function will theoretically return the number of lines in the image. This is not the case. The imread function in opencv doesn't work.\n<strong>THANKS!</strong></p>\n"}, {"tags": ["c++", "string", "unicode", "utf-8", "character-encoding"], "answers": [{"comments": [{"owner": {"reputation": 734, "user_id": 2442002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qONGd.png?s=128&g=1", "display_name": "aatwo", "link": "https://stackoverflow.com/users/2442002/aatwo"}, "edited": false, "score": 0, "creation_date": 1573052857, "post_id": 58732576, "comment_id": 103756384, "body": "Thank you very much! That indeed was the issue. I didn&#39;t realise the facet I was originally using was converting between utf8 and USC-2."}], "tags": [], "owner": {"reputation": 231, "user_id": 12296330, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4aUMpMgO5nc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdReW7JiBDNYLj69KtVK2AqpYytYQ/photo.jpg?sz=128", "display_name": "Stu", "link": "https://stackoverflow.com/users/12296330/stu"}, "is_accepted": true, "score": 6, "last_activity_date": 1573517519, "last_edit_date": 1573517519, "creation_date": 1573051215, "answer_id": 58732576, "question_id": 58731734, "link": "https://stackoverflow.com/questions/58731734/issue-when-converting-utf16-wide-stdwstring-to-utf8-narrow-stdstring-for-rar/58732576#58732576", "title": "Issue when converting utf16 wide std::wstring to utf8 narrow std::string for rare characters", "body": "<p>The problem is that <code>std::wstring_convert&lt;std::codecvt_utf8&lt;wchar_t&gt;&gt;</code> converts from UCS-2, <em>not from UTF-16</em>. Characters inside of the BMP (U+0000..U+FFFF) have identical encodings in both UCS-2 and UTF-16 and so will work, but characters outside of the BMP (U+FFFF..U+10FFFF), such as your Emoji, do not exist in UCS-2 at all. This means the conversion doesn't understand the character and produces incorrect UTF-8 bytes (technically, it's converted each half of the UTF-16 surrogate pair into a separate UTF-8 character).</p>\n\n<p>You need to use <code>std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;wchar_t&gt;&gt;</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 2, "last_activity_date": 1573054839, "creation_date": 1573054839, "answer_id": 58733774, "question_id": 58731734, "link": "https://stackoverflow.com/questions/58731734/issue-when-converting-utf16-wide-stdwstring-to-utf8-narrow-stdstring-for-rar/58733774#58733774", "title": "Issue when converting utf16 wide std::wstring to utf8 narrow std::string for rare characters", "body": "<p>There is already a validated answer here. But for the records, here some additional information.</p>\n\n<p>The  <a href=\"https://www.fileformat.info/info/unicode/char/1f922/index.htm\" rel=\"nofollow noreferrer\">encoding</a> of the <a href=\"https://emojipedia.org/nauseated-face/\" rel=\"nofollow noreferrer\">nauseated face emoji</a> was introduced in Unicode in 2016. It is 4 utf-8 bytes (<code>0xF0 0x9F 0xA4 0xA2</code>) or  2 utf-16 words (<code>0xD83E 0xDD22</code>). </p>\n\n<p>The surprising encoding of <code>0xED 0xA0 0xBE 0xED 0xB4 0xA2</code> corresponds in fact to an UCS <a href=\"https://en.wikipedia.org/wiki/Universal_Character_Set_characters#Surrogates\" rel=\"nofollow noreferrer\">surrogate pair</a>:</p>\n\n<ul>\n<li><code>0xED 0xA0 0xBE</code> is the utf8 encoding of the <strong>high</strong> surrogate <code>0xD83E</code> according to <a href=\"https://stevemorse.org/hebrew/utf8.php?charset=74\" rel=\"nofollow noreferrer\">this conversion table</a>. </li>\n<li><code>0xED 0xB4 0xA2</code> corresponds to the utf8 encoding of the <strong>low</strong> surrogate <code>0xDD22</code> according to <a href=\"https://stevemorse.org/hebrew/utf8.php?charset=76\" rel=\"nofollow noreferrer\">this table</a>.  </li>\n</ul>\n\n<p>So basically, your first encoding is the direct utf8.  The second encoding is the encoding in utf8 of an UCS-2 encoding that corresponds to the utf-16 encoding of the desired character.  </p>\n\n<p>As the accepted answer rightly pointed out, the <a href=\"https://en.cppreference.com/w/cpp/locale/codecvt_utf8\" rel=\"nofollow noreferrer\"><code>std::codecvt_utf8&lt;wchar_t&gt;</code></a> is the culprit, because it's about UCS-2 and not UTF-16.</p>\n\n<p>It's quite astonishing nowadays to find in standard libraries this obsolete encoding, but I suspect that this is still a reminiscence of Microsoft's lobying in the standard committee that dates back from the old <a href=\"https://en.wikipedia.org/wiki/Unicode_in_Microsoft_Windows\" rel=\"nofollow noreferrer\">Windows support for unicode</a> with UCS-2.  </p>\n"}], "owner": {"reputation": 734, "user_id": 2442002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qONGd.png?s=128&g=1", "display_name": "aatwo", "link": "https://stackoverflow.com/users/2442002/aatwo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 58732576, "answer_count": 2, "score": 1, "last_activity_date": 1573517519, "creation_date": 1573048366, "last_edit_date": 1573050617, "question_id": 58731734, "link": "https://stackoverflow.com/questions/58731734/issue-when-converting-utf16-wide-stdwstring-to-utf8-narrow-stdstring-for-rar", "title": "Issue when converting utf16 wide std::wstring to utf8 narrow std::string for rare characters", "body": "<p><strong>Why do some utf16 encoded wide strings, when converted to utf8 encoded narrow strings convert to hex values that don't appear to be correct when converted using this commonly found conversion function?</strong></p>\n\n<pre><code>std::string convert_string(const std::wstring&amp; str)\n{\n    std::wstring_convert&lt;std::codecvt_utf8&lt;wchar_t&gt;&gt; conv;\n    return conv.to_bytes(str);\n}\n</code></pre>\n\n<p>Hello. I have a C++ app on Windows which takes some user input on the command line. I'm using the wide character main entry point to get the input as a utf16 string which I'm converting to a utf8 narrow string using the above function.</p>\n\n<p>This function can be found in many places online and works in almost all cases. I have however found a few examples where it doesn't seem to work as expected.</p>\n\n<p>For example if I input an emojii character \"\ud83e\udd22\" as a string literal (in my utf8 encoded cpp file) and write it to disk, the file (FILE-1) contains the following data (which are the correct utf8 hex values specified here <a href=\"https://www.fileformat.info/info/unicode/char/1f922/index.htm\" rel=\"nofollow noreferrer\">https://www.fileformat.info/info/unicode/char/1f922/index.htm</a>):</p>\n\n<pre><code>    0xF0 0x9F 0xA4 0xA2\n</code></pre>\n\n<p>However if I pass the emojii to my application on the command line and convert it to a utf8 string using the conversion function above and then write it to disk, the file (FILE-2) contains different raw bytes:</p>\n\n<pre><code>    0xED 0xA0 0xBE 0xED 0xB4 0xA2\n</code></pre>\n\n<p>While the second file seems to indicate the conversion has produced the wrong output if you copy and paste the hex values (in notepad++ at least) it produces the correct emojii. Also WinMerge considers the two files to be identical.</p>\n\n<p>so to conclude I would really like to know the following:</p>\n\n<ol>\n<li>how the incorrect-looking converted hex values map correctly to the right utf8 character in the example above</li>\n<li>why the conversion function converts some characters to this form while almost all other characters produce the expected raw bytes</li>\n<li>As a bonus I would like to know if it is possible to modify the conversion function to stop it from outputting these rare characters in this form</li>\n</ol>\n\n<p>I should note that I already have a workaround function below which uses WinAPI calls, however using standard library calls only is the dream :)</p>\n\n<pre><code>std::string convert_string(const std::wstring&amp; wstr)\n{\n    if(wstr.empty())\n        return std::string();\n\n    int size_needed = WideCharToMultiByte(CP_UTF8, 0, &amp;wstr[0], (int)wstr.size(), NULL, 0, NULL, NULL);\n    std::string strTo(size_needed, 0);\n    WideCharToMultiByte(CP_UTF8, 0, &amp;wstr[0], (int)wstr.size(), &amp;strTo[0], size_needed, NULL, NULL);\n    return strTo;\n}\n</code></pre>\n"}, {"tags": ["c++", "activemq", "activemq-cpp"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11015434, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hmYxR3jSS38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOsTKCOQwx7tgKjvY6IQJKywAuo8w/mo/photo.jpg?sz=128", "display_name": "Bogdan Cretu", "link": "https://stackoverflow.com/users/11015434/bogdan-cretu"}, "edited": false, "score": 0, "creation_date": 1573058747, "post_id": 58732337, "comment_id": 103759916, "body": "I modified my code. I have to use a durable consumer instead of queues (so queues are not an option for the product). I&#39;ve edited the question (added Consumer_durable). Right now the problem is that the listener is processing 100 messages and then nothing happens. I cut the connection (with the master). Then the listener process another 100 messages. The producer put in the topic all 1000 messages. I didn&#39;t find on ActiveMQ doc something about this. Is it normal?"}, {"owner": {"reputation": 15533, "user_id": 375722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04770ed0ecf1e91e322484f66c9726ba?s=128&d=identicon&r=PG", "display_name": "Tim Bish", "link": "https://stackoverflow.com/users/375722/tim-bish"}, "reply_to_user": {"reputation": 43, "user_id": 11015434, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hmYxR3jSS38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOsTKCOQwx7tgKjvY6IQJKywAuo8w/mo/photo.jpg?sz=128", "display_name": "Bogdan Cretu", "link": "https://stackoverflow.com/users/11015434/bogdan-cretu"}, "edited": false, "score": 0, "creation_date": 1573069079, "post_id": 58732337, "comment_id": 103764747, "body": "You would need to do some debugging.  I don&#39;t see you setting a client ID on the connection would could be causing issues.  The C++ client code from ActiveMQ is not maintained so it could be a bug.  I&#39;d try the Java client as it is still being maintained."}, {"owner": {"reputation": 43, "user_id": 11015434, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hmYxR3jSS38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOsTKCOQwx7tgKjvY6IQJKywAuo8w/mo/photo.jpg?sz=128", "display_name": "Bogdan Cretu", "link": "https://stackoverflow.com/users/11015434/bogdan-cretu"}, "edited": false, "score": 0, "creation_date": 1573121381, "post_id": 58732337, "comment_id": 103781520, "body": "I&#39;ve added clientID in the listener but the same thing is replicating, 100 messages are processed then stops. What I&#39;ve seen is that the connection is restart (the master broker is closed) another 100 are read. And then do the same thing about 9 times =&gt; all those 1000 messages are read. Through &quot;do the same thing&quot; I mean to reopen the closed master broker which right now will be the slave (lock is acquired by the old slave broker) and close the new master broker. Do I need to bulk ACK or something like this? I didn&#39;t find anything about this behavior. PS: java is not an option :("}], "tags": [], "owner": {"reputation": 15533, "user_id": 375722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04770ed0ecf1e91e322484f66c9726ba?s=128&d=identicon&r=PG", "display_name": "Tim Bish", "link": "https://stackoverflow.com/users/375722/tim-bish"}, "is_accepted": false, "score": 1, "last_activity_date": 1573054894, "last_edit_date": 1573054894, "creation_date": 1573050382, "answer_id": 58732337, "question_id": 58731527, "link": "https://stackoverflow.com/questions/58731527/activemq-master-slave-failover-loses-messages/58732337#58732337", "title": "ActiveMQ master slave failover loses messages", "body": "<p>If you want message persistence then you should either be using Queues, or using Durable Topic subscriptions.  Topics on their own do not persist messages regardless of the persistent mode of the producer, in fact if there are no consumers subscribed and you send to a Topic the message is discarded, likewise the ActiveMQ configuration for controlling the constant pending message limit for Topics would discard old messages on a Topic where consumers can't keep up as a Topic has a low service assurance level.  </p>\n\n<p>You need to use a Queue and set persistent on the producer, or ensure that you have a pre-existing durable Topic subscription and send the messages using a producer that assigns the persistent flag if you want the message written to the store and recovered on broker failover.</p>\n"}], "owner": {"reputation": 43, "user_id": 11015434, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hmYxR3jSS38/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOsTKCOQwx7tgKjvY6IQJKywAuo8w/mo/photo.jpg?sz=128", "display_name": "Bogdan Cretu", "link": "https://stackoverflow.com/users/11015434/bogdan-cretu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573058526, "creation_date": 1573047643, "last_edit_date": 1573058526, "question_id": 58731527, "link": "https://stackoverflow.com/questions/58731527/activemq-master-slave-failover-loses-messages", "title": "ActiveMQ master slave failover loses messages", "body": "<p>ActiveMQ is losing a lot of messages when failover is involved (only on topics).\nThe producer writes 1000 messages in the topic while (at the same time) the consumer is reading from the same topic. In the middle of the process, I close ActiveMQ master and the process is continued with the ActiveMQ slave. When the transition is made, a lot of messages are lost (~100 messages). The product I'm working on involves not losing messages.\nWhat could I do for persistence on topics?\nProducer:</p>\n\n<pre><code>#include &lt;activemq\\library\\ActiveMQCPP.h&gt;\n#include &lt;cms\\Connection.h&gt;\n#include &lt;cms\\Session.h&gt;\n#include &lt;activemq\\core\\ActiveMQConnection.h&gt;\n#include &lt;activemq\\core\\ActiveMQConnectionFactory.h&gt;\n#include &lt;activemq\\core\\ActiveMQSession.h&gt;\n#include &lt;activemq\\core\\ActiveMQConsumer.h&gt;\n#include &lt;activemq\\core\\ActiveMQQueueBrowser.h&gt;\n#include &lt;activemq\\core\\PrefetchPolicy.h&gt;\n#include &lt;activemq/core/policies/DefaultPrefetchPolicy.h&gt;\n#include &lt;activemq\\util\\ActiveMQProperties.h&gt;\n#include &lt;activemq\\util\\Config.h&gt;\n#include &lt;decaf\\util\\Properties.h&gt;\n#include &lt;cms\\Queue.h&gt;\n#include &lt;cms\\Topic.h&gt;\n#include &lt;cms\\MapMessage.h&gt;\n#include &lt;cms\\MessageEnumeration.h&gt;\n#include &lt;cms\\CMSException.h&gt;\n#include &lt;activemq\\commands\\Command.h&gt;\n#include &lt;decaf\\lang\\Pointer.h&gt;\n#include &lt;activemq\\transport\\Transport.h&gt;\n#include &lt;activemq\\transport\\TransportFilter.h&gt;\n#include &lt;activemq\\commands\\SessionInfo.h&gt;\n#include &lt;activemq\\commands\\ActiveMQMessage.h&gt;\n#include &lt;activemq\\commands\\BrokerInfo.h&gt;\n\n#include &lt;activemq\\exceptions\\ConnectionFailedException.h&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;decaf\\lang\\Throwable.h&gt;\n\nstd::string _amqURI(\"failover:(tcp://host1:61616,tcp://host2:61616)?initialReconnectDelay=5000&amp;maxReconnectAttempts=2\");\nconst std::string _username(\"user\");\nconst std::string _password(\"pass\");\nconst std::string _host(\"localhost\");\nconst std::string _destination(\"Test.AMQ.bogcretu.Topic\");\n\nstd::string _garbageMessage(\"GARBAGE0_GARBAGE1_GARBAGE2_GARBAGE3_GARBAGE4_GARBAGE5_GARBAGE6_GARBAGE7_GARBAGE8_GARBAGE9\");\nint _countMessages = 1000;\nint _multiplyFactor = 100;\nstd::string _bodyMessage = \"\";\n\nvoid CreateMessage()\n{\n    for (int i = 0; i &lt; _multiplyFactor; i++) {\n        _bodyMessage += _garbageMessage;\n    }\n}\n\nint main()\n{\n    activemq::library::ActiveMQCPP::initializeLibrary();\n    CreateMessage();\n    activemq::core::ActiveMQConnectionFactory factory;\n    factory.setBrokerURI(_amqURI);\n    std::auto_ptr&lt;cms::TextMessage&gt; message;\n    std::auto_ptr&lt;cms::Connection&gt; connection(factory.createConnection(_username, _password));\n\n    connection-&gt;start();\n\n    std::auto_ptr&lt;cms::Session&gt; session(connection-&gt;createSession());\n    std::auto_ptr&lt;cms::Destination&gt; destionation(session-&gt;createTopic(_destination));\n    std::auto_ptr&lt;cms::MessageProducer&gt; producer(session-&gt;createProducer(destionation.get()));\n\n    producer-&gt;setDeliveryMode(cms::DeliveryMode::PERSISTENT);\n\n    for (int i = 0; i &lt; _countMessages; i++) {\n        std::stringstream ss;\n        ss &lt;&lt; i;\n        std::string number = ss.str();\n        message.reset(session-&gt;createTextMessage(number));\n        producer-&gt;send(message.get());\n        std::cout &lt;&lt; i &lt;&lt; std::endl;\n    }\n\n    //message.reset(session-&gt;createTextMessage(\"DONE\"));\n    //producer-&gt;send(message.get());\n\n    //connection-&gt;close();\n\n    //activemq::library::ActiveMQCPP::shutdownLibrary();\n\n    return 0;\n}\n</code></pre>\n\n<p>Consumer:</p>\n\n<pre><code>#include &lt;activemq\\library\\ActiveMQCPP.h&gt;\n#include &lt;cms\\Connection.h&gt;\n#include &lt;cms\\Session.h&gt;\n#include &lt;activemq\\core\\ActiveMQConnection.h&gt;\n#include &lt;activemq\\core\\ActiveMQConnectionFactory.h&gt;\n#include &lt;activemq\\core\\ActiveMQSession.h&gt;\n#include &lt;activemq\\core\\ActiveMQConsumer.h&gt;\n#include &lt;activemq\\core\\ActiveMQQueueBrowser.h&gt;\n#include &lt;activemq\\core\\PrefetchPolicy.h&gt;\n#include &lt;activemq/core/policies/DefaultPrefetchPolicy.h&gt;\n#include &lt;activemq\\util\\ActiveMQProperties.h&gt;\n#include &lt;activemq\\util\\Config.h&gt;\n#include &lt;decaf\\util\\Properties.h&gt;\n#include &lt;cms\\Queue.h&gt;\n#include &lt;cms\\Topic.h&gt;\n#include &lt;cms\\MapMessage.h&gt;\n#include &lt;cms\\MessageEnumeration.h&gt;\n#include &lt;cms\\CMSException.h&gt;\n#include &lt;cms\\MessageListener.h&gt;\n#include &lt;cms\\Message.h&gt;\n#include &lt;activemq\\commands\\Command.h&gt;\n#include &lt;decaf\\lang\\Pointer.h&gt;\n#include &lt;activemq\\transport\\Transport.h&gt;\n#include &lt;activemq\\transport\\TransportFilter.h&gt;\n#include &lt;activemq\\commands\\SessionInfo.h&gt;\n#include &lt;activemq\\commands\\ActiveMQMessage.h&gt;\n#include &lt;activemq\\commands\\BrokerInfo.h&gt;\n\n#include &lt;activemq\\exceptions\\ConnectionFailedException.h&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;decaf\\lang\\Throwable.h&gt;\n\nstd::string amqURI(\"failover:(tcp://host1:61616,tcp://host2:61616)?initialReconnectDelay=5000&amp;maxReconnectAttempts=2\");\n\nclass MsgListener : public cms::MessageListener\n{\npublic:\n    std::string _amqURI;\n    cms::Connection *_connection;\n    cms::Session* _session;\n    cms::Destination* _destination;\n    cms::MessageConsumer* _consumer;\n    bool _sessionTransacted;\n    bool _useTopic;\n\n    MsgListener(std::string amqURI, bool sessionTransacted, bool useTopic = false) : _amqURI(amqURI), _sessionTransacted(sessionTransacted), _useTopic(useTopic), _connection(NULL), _session(NULL), _destination(NULL), _consumer(NULL)\n    {\n        this-&gt;_connection = cms::ConnectionFactory::createCMSConnectionFactory(this-&gt;_amqURI)-&gt;createConnection();\n        this-&gt;_connection-&gt;start();\n\n        /*if (this-&gt;_sessionTransacted == true) {\n            this-&gt;_session = this-&gt;_connection-&gt;createSession(cms::Session::SESSION_TRANSACTED);\n        }\n        else {\n            this-&gt;_session = this-&gt;_connection-&gt;createSession(cms::Session::AUTO_ACKNOWLEDGE);\n        }*/\n\n        this-&gt;_session = this-&gt;_connection-&gt;createSession(cms::Session::DUPS_OK_ACKNOWLEDGE);\n\n        if (useTopic) {\n            this-&gt;_destination = this-&gt;_session-&gt;createTopic(\"Test.AMQ.bogcretu.Topic\");\n        }\n        else {\n            this-&gt;_destination = this-&gt;_session-&gt;createQueue(\"Test.AMQ.bogcretu.Topic\");\n        }\n\n        this-&gt;_consumer = this-&gt;_session-&gt;createConsumer(this-&gt;_destination);\n        this-&gt;_consumer-&gt;setMessageListener(this);\n\n        /*std::cout.flush();\n        std::cerr.flush();*/\n\n\n    }\n\n    ~MsgListener()\n    {\n\n    }\n\n    void onMessage(const cms::Message* CMSMessage)\n    {\n        static int count = 0;\n\n        try\n        {\n\n            const cms::TextMessage* textMessage = dynamic_cast&lt;const cms::TextMessage*&gt; (CMSMessage);\n            std::string text = \"\";\n            if (textMessage != NULL) {\n                text = textMessage-&gt;getText();\n            }\n            else {\n                text = \"NOT A TEXTMESSAGE!\";\n\n            }\n\n            std::cout &lt;&lt; \"(\" &lt;&lt; count &lt;&lt; \", \" &lt;&lt; text &lt;&lt; \")\" &lt;&lt; std::endl;\n            count++;\n\n        }\n        catch (cms::CMSException&amp; e)\n        {\n            e.printStackTrace();\n        }\n\n        if (this-&gt;_sessionTransacted) {\n            this-&gt;_session-&gt;commit();\n        }\n\n        std::this_thread::sleep_for(std::chrono::milliseconds(10));\n    }\n};\n\nint main()\n{\n    activemq::library::ActiveMQCPP::initializeLibrary();\n    MsgListener consumer(amqURI, true, true);\n    while (true);\n    //activemq::library::ActiveMQCPP::shutdownLibrary();\n}\n</code></pre>\n\n<p>Consumer_durable:</p>\n\n<pre><code>#include &lt;activemq\\library\\ActiveMQCPP.h&gt;\n#include &lt;cms\\Connection.h&gt;\n#include &lt;cms\\Session.h&gt;\n#include &lt;activemq\\core\\ActiveMQConnection.h&gt;\n#include &lt;activemq\\core\\ActiveMQConnectionFactory.h&gt;\n#include &lt;activemq\\core\\ActiveMQSession.h&gt;\n#include &lt;activemq\\core\\ActiveMQConsumer.h&gt;\n#include &lt;activemq\\core\\ActiveMQQueueBrowser.h&gt;\n#include &lt;activemq\\core\\PrefetchPolicy.h&gt;\n#include &lt;activemq/core/policies/DefaultPrefetchPolicy.h&gt;\n#include &lt;activemq\\util\\ActiveMQProperties.h&gt;\n#include &lt;activemq\\util\\Config.h&gt;\n#include &lt;decaf\\util\\Properties.h&gt;\n#include &lt;cms\\Queue.h&gt;\n#include &lt;cms\\Topic.h&gt;\n#include &lt;cms\\MapMessage.h&gt;\n#include &lt;cms\\MessageEnumeration.h&gt;\n#include &lt;cms\\CMSException.h&gt;\n#include &lt;cms\\MessageListener.h&gt;\n#include &lt;cms\\Message.h&gt;\n#include &lt;activemq\\commands\\Command.h&gt;\n#include &lt;decaf\\lang\\Pointer.h&gt;\n#include &lt;activemq\\transport\\Transport.h&gt;\n#include &lt;activemq\\transport\\TransportFilter.h&gt;\n#include &lt;activemq\\commands\\SessionInfo.h&gt;\n#include &lt;activemq\\commands\\ActiveMQMessage.h&gt;\n#include &lt;activemq\\commands\\BrokerInfo.h&gt;\n\n#include &lt;activemq\\exceptions\\ConnectionFailedException.h&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;decaf\\lang\\Throwable.h&gt;\n\nstd::string amqURI(\"failover:(tcp://host1:61616,tcp://host2:61616)?initialReconnectDelay=5000&amp;maxReconnectAttempts=2\");\n\nclass MsgListener : public cms::MessageListener\n{\npublic:\n    std::string _amqURI;\n    cms::Connection *_connection;\n    cms::Session* _session;\n    cms::Destination* _destination;\n    cms::MessageConsumer* _consumer;\n    bool _sessionTransacted;\n    bool _useTopic;\n\n    MsgListener(std::string amqURI, bool sessionTransacted, bool useTopic = false) : _amqURI(amqURI), _sessionTransacted(sessionTransacted), _useTopic(useTopic), _connection(NULL), _session(NULL), _destination(NULL), _consumer(NULL)\n    {\n        this-&gt;_connection = cms::ConnectionFactory::createCMSConnectionFactory(this-&gt;_amqURI)-&gt;createConnection();\n        this-&gt;_connection-&gt;start();\n\n        /*if (this-&gt;_sessionTransacted == true) {\n            this-&gt;_session = this-&gt;_connection-&gt;createSession(cms::Session::SESSION_TRANSACTED);\n        }\n        else {\n            this-&gt;_session = this-&gt;_connection-&gt;createSession(cms::Session::AUTO_ACKNOWLEDGE);\n        }*/\n\n        this-&gt;_session = this-&gt;_connection-&gt;createSession(cms::Session::DUPS_OK_ACKNOWLEDGE);\n\n        if (useTopic) {\n            this-&gt;_destination = this-&gt;_session-&gt;createTopic(\"Test.AMQ.bogcretu.Topic\");\n        }\n        else {\n            this-&gt;_destination = this-&gt;_session-&gt;createQueue(\"Test.AMQ.bogcretu.Topic\");\n        }\n\n        //this-&gt;_consumer = this-&gt;_session-&gt;createConsumer(this-&gt;_destination);\n\n\n\n        static const cms::Topic * topic = dynamic_cast&lt;const cms::Topic*&gt;(this-&gt;_destination);\n        this-&gt;_consumer = this-&gt;_session-&gt;createDurableConsumer(topic, \"sub_name\", \"\");\n        this-&gt;_consumer-&gt;setMessageListener(this);\n\n        /*std::cout.flush();\n        std::cerr.flush();*/\n\n\n    }\n\n    ~MsgListener()\n    {\n\n    }\n\n    void onMessage(const cms::Message* CMSMessage)\n    {\n        static int count = 0;\n\n        try\n        {\n\n            const cms::TextMessage* textMessage = dynamic_cast&lt;const cms::TextMessage*&gt; (CMSMessage);\n            std::string text = \"\";\n            if (textMessage != NULL) {\n                text = textMessage-&gt;getText();\n            }\n            else {\n                text = \"NOT A TEXTMESSAGE!\";\n            }\n\n            std::cout &lt;&lt; \"(\" &lt;&lt; count &lt;&lt; \", \" &lt;&lt; text &lt;&lt; \")\" &lt;&lt; std::endl;\n            count++;\n\n        }\n        catch (cms::CMSException&amp; e)\n        {\n            e.printStackTrace();\n        }\n\n        if (this-&gt;_sessionTransacted) {\n            this-&gt;_session-&gt;commit();\n        }\n\n        std::this_thread::sleep_for(std::chrono::milliseconds(10));\n    }\n};\n\nint main()\n{\n    activemq::library::ActiveMQCPP::initializeLibrary();\n    MsgListener consumer(amqURI, true, true);\n    while (true);\n    //activemq::library::ActiveMQCPP::shutdownLibrary();\n}\n</code></pre>\n"}, {"tags": ["java", "c++", "java-native-interface", "wrapper"], "comments": [{"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573046847, "post_id": 58731233, "comment_id": 103752954, "body": "Go read the JNI docs again. Embedding JVMs in native (C/C++) apps is perfectly possible"}, {"owner": {"reputation": 1098, "user_id": 7447660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ok0v3.jpg?s=128&g=1", "display_name": "Koenigsberg", "link": "https://stackoverflow.com/users/7447660/koenigsberg"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573047004, "post_id": 58731233, "comment_id": 103753050, "body": "It might, still reading. I have looked for the keyword <i>embed</i> after your comment and came accross this as well."}, {"owner": {"reputation": 1098, "user_id": 7447660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ok0v3.jpg?s=128&g=1", "display_name": "Koenigsberg", "link": "https://stackoverflow.com/users/7447660/koenigsberg"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573047062, "post_id": 58731233, "comment_id": 103753092, "body": "Let me review the other question, if there are no significant differences, then I will accept the duplicate mark. Thanks in advance"}, {"owner": {"reputation": 1098, "user_id": 7447660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ok0v3.jpg?s=128&g=1", "display_name": "Koenigsberg", "link": "https://stackoverflow.com/users/7447660/koenigsberg"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573047333, "post_id": 58731233, "comment_id": 103753261, "body": "If I understand correctly, this creates and initializes a JVM when executing native code. I am left wondering where the Java source is stored in this case?"}, {"owner": {"reputation": 1098, "user_id": 7447660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ok0v3.jpg?s=128&g=1", "display_name": "Koenigsberg", "link": "https://stackoverflow.com/users/7447660/koenigsberg"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573047569, "post_id": 58731233, "comment_id": 103753420, "body": "I assume the Java source is passed to the JVM using <code>vm_args.classpath = ...;</code>, so it is still stored in a <code>.class</code> and can be decoompiled with relative ease, unless I misunderstand something."}, {"owner": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573047986, "post_id": 58731233, "comment_id": 103753634, "body": "If you are worried about decompiling your classes that is totally separate question and you should go read about custom classloaders, you can store your classes how ever you want as long as you can later provide them as a byte stream to the classloader."}, {"owner": {"reputation": 1098, "user_id": 7447660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ok0v3.jpg?s=128&g=1", "display_name": "Koenigsberg", "link": "https://stackoverflow.com/users/7447660/koenigsberg"}, "reply_to_user": {"reputation": 40434, "user_id": 504554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/006ffde9ed3fac6396222405fc5e9bf0?s=128&d=identicon&r=PG", "display_name": "hardillb", "link": "https://stackoverflow.com/users/504554/hardillb"}, "edited": false, "score": 0, "creation_date": 1573048521, "post_id": 58731233, "comment_id": 103753938, "body": "Then I consider this question answered. Thanks!"}], "owner": {"reputation": 1098, "user_id": 7447660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ok0v3.jpg?s=128&g=1", "display_name": "Koenigsberg", "link": "https://stackoverflow.com/users/7447660/koenigsberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 2, "closed_date": 1573048529, "answer_count": 0, "score": 0, "last_activity_date": 1573046951, "creation_date": 1573046681, "last_edit_date": 1592644375, "question_id": 58731233, "link": "https://stackoverflow.com/questions/58731233/is-it-possible-to-wrap-a-java-function-entirely-in-c", "closed_reason": "Duplicate", "title": "Is it possible to wrap a Java function entirely in C++?", "body": "<h3>Scenario</h3>\n<p>Suppose a Java application is being developed. Assume it contains functions which are in need of being hidden. Decompiling Java is not really an issue, besides a lot of information can be obtained from just opening the JAR with an archive manager, such as 7zip.</p>\n<p>There are tools such as ProGuard:</p>\n<p><a href=\"https://www.guardsquare.com/en/products/proguard/manual/examples#application\" rel=\"nofollow noreferrer\">https://www.guardsquare.com/en/products/proguard/manual/examples#application</a></p>\n<p>Such tools can be used to obfuscate the Java codebase, however, there are some issues with this, <em>e.g.</em> a lot of logic can still be derived with some, at best, moderate effort. In addition, some codebases cannot be effectively processed with ProGuard.</p>\n<p>Ultimately, there are just cases, where I need to use some Java API and pass it some credentials. But these credentials - no matter how safely stored -  can be read on runtime, by simply attaching a debugger and then viewing these in plain text, or if they are stored C++ side, they can be extracted with a new JAR by accessing the C++ function, etc.</p>\n<h3>Question</h3>\n<p>The problem itself is not really relevant to my question, but it got me wondering - <strong>is there a way to wrap entire Java functionality using C++, <em>i.e.</em> write functions in Java, then in some way package them into a DLL?</strong></p>\n<p>I am aware of the existence of JNI, where I can access C++ functionality provided via DLL using <code>native</code> functions (this is already heavily utilized in my application in fact). But what if I intend to store Java functions in a DLL and then provide them to the JVM directly, without having to unpack them into a JAR first? If you are thinking of a VM - this is somewhere along those lines.</p>\n<h3>Example</h3>\n<p>Suppose I have something like this in my Java codebase:</p>\n<pre><code>import io.sentry.Sentry;\nimport io.sentry.SentryClient;\n\npublic class SentryController\n{\n    private version = &quot;someversion&quot;;\n    private superSecretSentryString = getSecretStringFromKMS(); // beautiful alliteration\n\n    public SentryController()\n    {\n        Sentry.init( superSecretSentryString ); // stored safely in KMS, but easily read on runtime\n        Sentry.getStoredClient().setRelease( version ); \n\n        // ...\n    }\n\n    // ...\n\n}\n</code></pre>\n<p>Assume I do not want anyone to see this class and aim to move it to a DLL entirely, while still being able to use <code>import io.sentry.Sentry</code> and therefore be able to access the Sentry API.</p>\n<h3>Disclaimer</h3>\n<p>I am aware that in all likelihood no such API / wrapper exists, <em>i.e.</em> what I am looking for is not possible. This question is to assure that there is no possibility that I am unaware of.</p>\n<p>This question is a followup on this:</p>\n<p><a href=\"https://stackoverflow.com/questions/58708171/java-c-encryption-and-the-jni-interface?noredirect=1#comment103711007_58708171\">Java / C++ Encryption and the JNI interface</a></p>\n<p>I have considered putting it on the security SE:</p>\n<p><a href=\"https://security.stackexchange.com/\">https://security.stackexchange.com/</a></p>\n<p>However I think the sole question (bold print above) is detached from the reason described, <em>i.e.</em> I am not looking for a sensible way to prevent readout of credentials or decompilation of functions, but I am curious to know whether whole Java functionality can be encapsulated in a DLL.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1573046423, "post_id": 58731118, "comment_id": 103752671, "body": "Easy if you <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\">read line by line</a>."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1573047032, "post_id": 58731118, "comment_id": 103753070, "body": "<code>std::getline()</code> into a <code>std::string</code>. Then look for the # and use <code>std::istringstream</code> to get the values out of the string"}], "answers": [{"tags": [], "owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "is_accepted": false, "score": 0, "last_activity_date": 1573054621, "creation_date": 1573054621, "answer_id": 58733700, "question_id": 58731118, "link": "https://stackoverflow.com/questions/58731118/skip-some-lines-in-file-reading/58733700#58733700", "title": "Skip some lines in file reading", "body": "<p>Read the first line and ignore it. Read the other lines and process them:</p>\n\n<pre><code>using std::getline;\nusing std::string;\nusing std::ifstream;\n\nstring line;\nifstream file(\"FILENAME\");\ngetline(file, line);\nwhile(getline(file, line)) {\n    process(line);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12332188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3dd6273214f3f4f43e8f5aa3ba4ff93?s=128&d=identicon&r=PG&f=1", "display_name": "sylett", "link": "https://stackoverflow.com/users/12332188/sylett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1573054621, "creation_date": 1573046313, "last_edit_date": 1573046574, "question_id": 58731118, "link": "https://stackoverflow.com/questions/58731118/skip-some-lines-in-file-reading", "title": "Skip some lines in file reading", "body": "<p>I want to put 2 columns from a 2-column file into objects to do some math.How can i simply say to the computer \"Hey, don't start doing math from the first line of the file but instead do math after the line that has the hash-tag on it\". I have an example of the file below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3mkvY.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c++", "stl"], "answers": [{"comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 3, "creation_date": 1573046522, "post_id": 58731100, "comment_id": 103752741, "body": "I think your example will omit the final element?"}, {"owner": {"reputation": 165, "user_id": 2227806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa42b768aa2446807658bf55edc45062?s=128&d=identicon&r=PG", "display_name": "user24601", "link": "https://stackoverflow.com/users/2227806/user24601"}, "edited": false, "score": 0, "creation_date": 1573047468, "post_id": 58731100, "comment_id": 103753357, "body": "@Lightness Races with Monica, thank you for the explanation! (I&#39;d wish STL had some compile-time checks in this iterator, tho)"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "reply_to_user": {"reputation": 165, "user_id": 2227806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa42b768aa2446807658bf55edc45062?s=128&d=identicon&r=PG", "display_name": "user24601", "link": "https://stackoverflow.com/users/2227806/user24601"}, "edited": false, "score": 0, "creation_date": 1573048332, "post_id": 58731100, "comment_id": 103753823, "body": "@user24601 There is no check, because your code is valid, is just means something else. It converts the <code>uint32_t</code> value to a <code>char</code> value and then prints the character. That would make sense if your <code>uint32_t</code> contained values representing individual characters. <code>std::ostreambuf_iterator</code> is formatted output anyway."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1573049975, "post_id": 58731100, "comment_id": 103754699, "body": "@AlanBirtles: Good spot!"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 4, "last_activity_date": 1573050017, "last_edit_date": 1573050017, "creation_date": 1573046234, "answer_id": 58731100, "question_id": 58730979, "link": "https://stackoverflow.com/questions/58730979/why-stdostreambuf-iterator-truncates-integers/58731100#58731100", "title": "Why std::ostreambuf_iterator truncates integers?", "body": "<blockquote>\n  <p>I'm copying a sorted vector of uint32_t numbers into a binary stream via <code>std::copy(numbers.begin(), numbers.end(), std::ostreambuf_iterator&lt;char&gt;{stream})</code>, but it truncates numbers, turns them into 1-byte numbers.</p>\n</blockquote>\n\n<p>Yep &mdash; you asked it to!</p>\n\n<p>You have a range of <code>uint32_t</code>, then you're using a <code>char</code> iterator.</p>\n\n<p>So each element is converted to a <code>char</code> as it goes through.</p>\n\n<p><code>std::ostreambuf_iterator&lt;char&gt;</code> doesn't automatically alias input elements with a different type. This would be illegal in most cases, plus it would have to do buffering to provide (in this example) four outputs for each one input: now imagine you provided <code>char</code>s to a <code>ostreambuf_iterator&lt;uint32_t&gt;</code>, and realise that it would have to provide one output for each four inputs, which gets more complicated. This is just not what this iterator is for.</p>\n\n<p>You will want to treat the range as a range of <code>char</code> instead; fortunately, this is legal due to an aliasing exemption. We can't use vector iterators any more, but that's fine because we can get direct access to its contiguous data in the form of pointers, and do what we like with those pointers:</p>\n\n<pre><code>std::copy(\n   reinterpret_cast&lt;const char*&gt;(numbers.data()),\n   reinterpret_cast&lt;const char*&gt;(numbers.data() + numbers.size()),\n   std::ostreambuf_iterator&lt;char&gt;{stream}\n);\n</code></pre>\n\n<p>This is practically equivalent to your second example.</p>\n"}], "owner": {"reputation": 165, "user_id": 2227806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa42b768aa2446807658bf55edc45062?s=128&d=identicon&r=PG", "display_name": "user24601", "link": "https://stackoverflow.com/users/2227806/user24601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 58731100, "answer_count": 1, "score": 0, "last_activity_date": 1573050017, "creation_date": 1573045855, "question_id": 58730979, "link": "https://stackoverflow.com/questions/58730979/why-stdostreambuf-iterator-truncates-integers", "title": "Why std::ostreambuf_iterator truncates integers?", "body": "<p>I'm copying a sorted vector of uint32_t numbers into a binary stream via <code>std::copy(numbers.begin(), numbers.end(), std::ostreambuf_iterator&lt;char&gt;{stream})</code>, but it truncates numbers, turns them into 1-byte numbers.</p>\n\n<p>What's wrong with my code? I have got a workaround, but maybe it's possible to make the ostreambuf_iterator approach work properly? </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::ofstream chunk{ \"filename.txt\", std::ios::binary | std::ios::out };\n\n// this piece of code works not expected\nstd::copy(numbers.begin(), numbers.end(), std::ostreambuf_iterator&lt;char&gt;{chunk});\n\n// But this, alternative works good\nfor (auto&amp; v : numbers)\n    chunk.write((char*)&amp; v, sizeof uint32_t);\n</code></pre>\n\n<p>I expected to have this output:</p>\n\n<pre><code>0000 0000 0000 0000 0000 0000 0100 0000\n0100 0000 0100 0000 0100 0000 0100 0000\n</code></pre>\n\n<p>But my output is:</p>\n\n<pre><code>0000 0000 0000 0000 0000 0000 0101 0101\n0101 0101 0101 0101 0101 0101 0101 0101\n</code></pre>\n"}, {"tags": ["c++", "class", "oop", "inheritance", "inner-classes"], "comments": [{"owner": {"reputation": 163, "user_id": 12136642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6K70H.png?s=128&g=1", "display_name": "PhysicsPDF", "link": "https://stackoverflow.com/users/12136642/physicspdf"}, "reply_to_user": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 0, "creation_date": 1573045846, "post_id": 58730825, "comment_id": 103752331, "body": "Yes, sorry. Its just that I am actually working with plasma in a Penning-Malmberg trap."}, {"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 0, "creation_date": 1573045995, "post_id": 58730825, "comment_id": 103752402, "body": "Aside: it&#39;s conventional, and therefore makes code more readable, to start <code>class</code> names with a capital letter: <i>eg</i> <code>class Fish</code>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1573046205, "post_id": 58730825, "comment_id": 103752528, "body": "<i>There can be many different kind of fish in the same tank.</i> Different instances of <code>fish</code> or instances of different derived classes of <code>fish</code>? In the latter case, the <code>std::vector&lt;fish&gt;</code> is probably a bad choice."}, {"owner": {"reputation": 2771, "user_id": 5963279, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10207102799463401/picture?type=large", "display_name": "Thomas Cook", "link": "https://stackoverflow.com/users/5963279/thomas-cook"}, "edited": false, "score": 0, "creation_date": 1573050694, "post_id": 58730825, "comment_id": 103755143, "body": "Rather than giving the fish a reference to the fish tank, I would instead suggest adding methods to the fish that tell the fish what to do and the fish tank will call that method providing all arguments required (i.e. the fish tank width and height are passed in to make sure the fish doesn&#39;t leave the bounds of the tank)"}], "answers": [{"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1573046201, "creation_date": 1573046201, "answer_id": 58731088, "question_id": 58730825, "link": "https://stackoverflow.com/questions/58730825/how-to-design-a-class-that-will-always-be-a-member-of-another-class/58731088#58731088", "title": "How to design a Class that will always be a member of another class", "body": "<blockquote>\n  <p>Fish needs to know the properties of the <code>fishTank</code></p>\n</blockquote>\n\n<p>Then you might consider making <code>fish</code> a <code>friend</code> of <code>fishTank</code>:</p>\n\n<pre><code>class fishTank\n{\nprivate:\n    friend fish;\n    std::vector&lt;fish&gt; fishInTank;\n...\n</code></pre>\n\n<p>now any instance of <code>fish</code> can access all the <code>private</code> members of any given instance of <code>fishTank</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 12136642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6K70H.png?s=128&g=1", "display_name": "PhysicsPDF", "link": "https://stackoverflow.com/users/12136642/physicspdf"}, "edited": false, "score": 1, "creation_date": 1573048365, "post_id": 58731145, "comment_id": 103753846, "body": "<code>Fish</code> would still need to be declared as friend in <code>FishTank</code> right?"}, {"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "reply_to_user": {"reputation": 163, "user_id": 12136642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6K70H.png?s=128&g=1", "display_name": "PhysicsPDF", "link": "https://stackoverflow.com/users/12136642/physicspdf"}, "edited": false, "score": 1, "creation_date": 1573050439, "post_id": 58731145, "comment_id": 103754980, "body": "@PhysicsPDF If <code>Fish</code> needed to access <code>private</code> members of <code>tank</code> in <code>Fish::swim</code> then yes, <code>Fish</code> would need to be a <code>friend</code> of <code>FishTank</code>."}], "tags": [], "owner": {"reputation": 3092, "user_id": 701263, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f145997aeec8662800ea27abbe7e796a?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/701263/kyle"}, "is_accepted": false, "score": 2, "last_activity_date": 1573046396, "creation_date": 1573046396, "answer_id": 58731145, "question_id": 58730825, "link": "https://stackoverflow.com/questions/58730825/how-to-design-a-class-that-will-always-be-a-member-of-another-class/58731145#58731145", "title": "How to design a Class that will always be a member of another class", "body": "<p>Honestly, just like eating a Reeces, there is no right or correct way to do this. Me personally? The fish tank would have a vector of fish, and then if the fish need to swim for 1 tick, I would have a swim method on the fish tank. This would call each fish and tell them to swim, passing the fish tank as an argument to their swim method. Like so:</p>\n\n<pre><code>class FishTank;\n\nclass Fish {\n    public:\n        void swim(const FishTank* tank) {\n\n        }\n};\n\nclass FishTank {\n    private:\n        std::vector&lt;Fish&gt; allFish;\n\n    public:\n        void tick() {\n            for(Fish&amp; fish : allFish){\n                fish.swim(this);\n            }\n        }\n};\n</code></pre>\n\n<p>There are really a dozen and a half ways to go about this. There's a book I'd recommend reading that goes over stuff like this: <code>Design Patterns: Elements of Reusable Object-Oriented Software by Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides (ISBN 10: 0201633612)</code></p>\n"}, {"tags": [], "owner": {"reputation": 45749, "user_id": 21974, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/61d62f97373c96dea8ad1e774b127cdd?s=128&d=identicon&r=PG", "display_name": "ypnos", "link": "https://stackoverflow.com/users/21974/ypnos"}, "is_accepted": false, "score": 1, "last_activity_date": 1573046885, "last_edit_date": 1573046885, "creation_date": 1573046517, "answer_id": 58731172, "question_id": 58730825, "link": "https://stackoverflow.com/questions/58730825/how-to-design-a-class-that-will-always-be-a-member-of-another-class/58731172#58731172", "title": "How to design a Class that will always be a member of another class", "body": "<p>Your <code>Fish</code> class may be declared inside the <code>FishTank</code> class, even protected or private. This would make it harder/impossible to use outside of <code>Fish</code>. But there is no way to dictate it can only be a direct member of <code>FishTank</code>.</p>\n\n<pre><code>class FishTank {\nprivate:\n    class Fish {\n        Fish(const Fishtank &amp;parent);\n        \u2026\n    };\n    std::vector&lt;Fish&gt; fishInTank;\n</code></pre>\n\n<p>When the class is declared inside, it is automatically a friend of <code>FishTank</code> and can access all members of the tank, including private members.</p>\n\n<p>As Paul Evans notes, you can also use <code>friend</code> designation to achieve the latter effect. It is helpful if <code>Fish</code> is a complex class that would clutter the <code>FishTank</code> class declaration and better be kept in another header file. <code>Fish</code> would at least need to be declared public if your <code>FishTank</code> ever exposes fishes to the outside; also it might be a burden for any party that deals with <code>Fish</code> to include full <code>FishTank</code> header.</p>\n\n<p>You might also work with a namespace to explain the semantic grouping:</p>\n\n<pre><code>namespace fish_tank {\n    class Fish { \u2026 };\n    class Tank { \u2026 };\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 11981587, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBAdOdhIWvWZUvUACxroYq1DymWMA_dXDGvQEFEvw=k-s128", "display_name": "Ahmed Anter", "link": "https://stackoverflow.com/users/11981587/ahmed-anter"}, "is_accepted": false, "score": 1, "last_activity_date": 1573047896, "creation_date": 1573047896, "answer_id": 58731602, "question_id": 58730825, "link": "https://stackoverflow.com/questions/58730825/how-to-design-a-class-that-will-always-be-a-member-of-another-class/58731602#58731602", "title": "How to design a Class that will always be a member of another class", "body": "<p>Here is my way:</p>\n\n<pre><code>class FishTank;\nclass Fish\n{\nprotected:\n    FishTank* tank;\n    Fish(FishTank* t) { tank = t; };\npublic:\n    void swim();\n\n    friend class FishTank;\n};\n\nclass FishTank\n{\nprivate:\n    std::vector&lt;Fish*&gt; allFish;\npublic:\n    Fish* AddFish() {\n        Fish* f = new Fish(this);\n        allFish.push_back(f);\n        return f;\n    }\n    void tick() {\n        for (Fish* fish : allFish) {\n            fish-&gt;swim();\n        }\n    }\n    friend class Fish;\n};\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 12136642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6K70H.png?s=128&g=1", "display_name": "PhysicsPDF", "link": "https://stackoverflow.com/users/12136642/physicspdf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1573047896, "creation_date": 1573045330, "last_edit_date": 1573045891, "question_id": 58730825, "link": "https://stackoverflow.com/questions/58730825/how-to-design-a-class-that-will-always-be-a-member-of-another-class", "title": "How to design a Class that will always be a member of another class", "body": "<p>Imagine I have a <code>fishTank</code> class. This class will represent a fish tank, it has a size, some boundaries where fish can be, some obstacles where fish can not be, some water flow through the tank that moves the fish around, etc.</p>\n\n<pre><code>class fishTank\n{\nprivate:\n    double length;\n    double height;\n//And some more complex things that define a fish tank\npublic:\n     fishtank(double, double, ...);\n}\n</code></pre>\n\n<p>Now I need to add fish into the tank. What is the appropriate way of declaring my fish class? (Fish represents a large group of individual fish)</p>\n\n<ol>\n<li>My fish will always be inside a <code>fishTank</code>, there makes no sense for me to have fish alone.</li>\n<li>Fish needs to know the properties of the <code>fishTank</code>, everything in the fish class depends on the tank: How to load the fish in the tank depends on the size of the tank, the way the fish move depends on the size and properties of the trap, etc.</li>\n<li>There can be many different kind of fish in the same tank.</li>\n</ol>\n\n<p>My first attempt is to create the fish class and pass the tank as an argument in the fish constructor. Then add a vector of fish into the tank as a private member:</p>\n\n<pre><code>class fish\n{\nprivate:\n    //All properties of fish\npublic:\n    fish(const fishTank&amp; aTank, All other properties of fish);\n}\n\n\nclass fishTank\n{\nprivate:\n    std::vector&lt;fish&gt; fishInTank;\n    //Same as before\npublic:\n    //Same as before;\n}\n</code></pre>\n\n<p>Is this really the proper way of implementing what I need? I just don't think this is a good design, I will need the tank as arguments for the fish, and then add each fish into the tank itself. Does this make sense?</p>\n\n<p>Would this be the correct place to implement something like an abstract fish class, or nest fish inside the tank?</p>\n"}, {"tags": ["c++", "string", "int"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1573045005, "post_id": 58730697, "comment_id": 103751867, "body": "What do you think <code>cin.ignore()</code> is doing? Hint: print both answers after they are read by your program (i.e. after <code>getline()</code>)"}, {"owner": {"reputation": 624, "user_id": 10313238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb07a6132217066661cbe5571994450a?s=128&d=identicon&r=PG&f=1", "display_name": "Liza Catherine Ombyaw", "link": "https://stackoverflow.com/users/10313238/liza-catherine-ombyaw"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1573045364, "post_id": 58730697, "comment_id": 103752061, "body": "I think what does of <code>cin.ignore()</code> is to ignore the white space of the user&#39;s input. I just tried what you do about the hint, the 2nd answer of my 2nd question is &quot;language translator&quot; but when I tried to print it, it became &quot;anguage translator&quot;"}, {"owner": {"reputation": 624, "user_id": 10313238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb07a6132217066661cbe5571994450a?s=128&d=identicon&r=PG&f=1", "display_name": "Liza Catherine Ombyaw", "link": "https://stackoverflow.com/users/10313238/liza-catherine-ombyaw"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1573045899, "post_id": 58730697, "comment_id": 103752358, "body": "it works now! I remove <code>cin.ignore()</code> on my 2nd question. Thank you!"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1573046543, "post_id": 58730697, "comment_id": 103752750, "body": "Wouldn&#39;t be &quot;compiler&quot; a sufficient answer to the 2nd question as well? ;-) (Now, probably somebody else will correct me that &quot;interpreter&quot; might be a reasonable alternative.)"}, {"owner": {"reputation": 232, "user_id": 11297354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ji1Pg.jpg?s=128&g=1", "display_name": "Mori", "link": "https://stackoverflow.com/users/11297354/mori"}, "edited": false, "score": 0, "creation_date": 1573048576, "post_id": 58730697, "comment_id": 103753973, "body": "You declare int score without assigning it a value, leading to undefined behaviour."}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "edited": false, "score": 0, "creation_date": 1573048879, "post_id": 58730697, "comment_id": 103754149, "body": "Add debug output statements. They&#39;ll almost certainly tell you why it&#39;s not working the way you want. Put a cout of your data before each if-statement."}], "owner": {"reputation": 624, "user_id": 10313238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb07a6132217066661cbe5571994450a?s=128&d=identicon&r=PG&f=1", "display_name": "Liza Catherine Ombyaw", "link": "https://stackoverflow.com/users/10313238/liza-catherine-ombyaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573044928, "creation_date": 1573044928, "question_id": 58730697, "link": "https://stackoverflow.com/questions/58730697/c-adding-numbers-continuously-when-input-is-correct-or-equal", "title": "C++ Adding numbers continuously when input is correct or equal", "body": "<p>I want to program a Simple Quiz Program, basically, each answered correctly will add as 1 to score.</p>\n\n<p>I have 2 questions with 2 answers, if the user input is the same or answer it correctly what I have to my <code>aEasy1</code> and <code>aEasy2</code> each question answered correctly will add 1 to <code>score</code>. Unfortunately, even I input both questions correct, the result I get is only 1 instead of 2.</p>\n\n<p>Here are my codes:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\nusing namespace std;\n\nint main() {\n  int score;\n  string eAnswer1, eAnswer2, aEasy1, aEasy2;\n\n  aEasy1 = \"source code\";\n  aEasy2 = \"language translator\";\n\n  cout &lt;&lt; \"1st Question: It is a well-written set of instructions and statements to develop a program. Answer: \";\n  cin.ignore();\n  getline(cin, eAnswer1);\n  if (eAnswer1 == aEasy1) {\n    score = score + 1;\n  }\n\n  cout &lt;&lt; \"2nd Question: Source code must be translated to machine language using a? Answer: \";\n  cin.ignore();\n  getline(cin, eAnswer2);\n  if (eAnswer2 == aEasy2) {\n    score = score + 1;\n  }\n\n  cout &lt;&lt; score &lt;&lt; endl;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "c++17", "rvalue-reference"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 10299721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mQnnLqAacmU/AAAAAAAAAAI/AAAAAAAAAD0/szKrU2XNEZM/photo.jpg?sz=128", "display_name": "AbbysSoul", "link": "https://stackoverflow.com/users/10299721/abbyssoul"}, "edited": false, "score": 0, "creation_date": 1573081543, "post_id": 58732890, "comment_id": 103769312, "body": "Thank you for your answer. I actually do have an equivalent of <code>template&lt;&gt; Error</code> from your example to <a href=\"https://github.com/abbyssoul/libsolace/blob/master/include/solace/result.hpp#L66\" rel=\"nofollow noreferrer\">shuttle values</a> with Prefered/Unexpected meaning. And correcponding <a href=\"https://github.com/abbyssoul/libsolace/blob/master/include/solace/result.hpp#L247\" rel=\"nofollow noreferrer\">constructors</a>.  I was more concerned with getting rid of temp object where possible by going to direct convertion: <code>PreferredType -&gt; Restult&lt;PreferredType, Error&gt;</code> for functions returning <code>PreferredType</code>."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 0, "last_activity_date": 1573052155, "creation_date": 1573052155, "answer_id": 58732890, "question_id": 58730688, "link": "https://stackoverflow.com/questions/58730688/designing-own-result-either-should-success-type-and-error-type-always-be-destin/58732890#58732890", "title": "Designing own Result/Either: Should Success type and Error type always be destinct?", "body": "<p>If you are a <strong>symmetric</strong> either you want to convert from either type implicitly.  If you are passed something that can convert to both, you want to fail.</p>\n\n<p>If you are an <strong>asymmetric</strong> either, like a result, you want to implicitly convert from the <em>favored</em> type.  From the disfavored type, you want to only convert explicitly.</p>\n\n<pre><code>template&lt;class X&gt;\nstruct Error {\n  X x;\n};\n\ntemplate&lt;class V, class E&gt;\nstruct Result {\n  Result( V&amp;&amp; v );\n  Result( Error&lt;E&gt; e );\n  // or even:\n  template&lt;class O,\n    std::enable_if_t&lt; std::is_convertible_v&lt;O, E&gt;, bool &gt; = true\n  &gt;\n  Result( Error&lt;O&gt; e );\n};\n</code></pre>\n\n<p>Use looks like:</p>\n\n<pre><code>Result&lt;SomeType, int&gt; value = SomeType{...};\nEXPECT_TRUE(result.isOk());   // TRUE\n\n// Also\nResult&lt;SomeType, int&gt; value = Error{10};\nEXPECT_TRUE(result.isError());   // TRUE\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>Result&lt;SuccessType, int&gt; func() {\n  SuccessType result{...};\n...\n  return result;\n} \n</code></pre>\n\n<p>works, as does:</p>\n\n<pre><code>Result&lt;SuccessType, int&gt; func() {\n  return Error{10};\n} \n</code></pre>\n\n<p>implicit converting-to error state should be avoided, it is far too easy to access accidentally.</p>\n"}], "owner": {"reputation": 383, "user_id": 10299721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mQnnLqAacmU/AAAAAAAAAAI/AAAAAAAAAD0/szKrU2XNEZM/photo.jpg?sz=128", "display_name": "AbbysSoul", "link": "https://stackoverflow.com/users/10299721/abbyssoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58732890, "answer_count": 1, "score": 0, "last_activity_date": 1573052155, "creation_date": 1573044897, "question_id": 58730688, "link": "https://stackoverflow.com/questions/58730688/designing-own-result-either-should-success-type-and-error-type-always-be-destin", "title": "Designing own Result/Either: Should Success type and Error type always be destinct?", "body": "<p>I have an implementation of <code>Result</code>/<code>Either</code> for c++. The class features following <a href=\"https://github.com/abbyssoul/libsolace/blob/master/include/solace/result.hpp#L300\" rel=\"nofollow noreferrer\">type-converting constructor</a>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename V, typename E&gt;\nclass Result {\n...\n    template&lt;typename X&gt;\n    constexpr Result(X&amp;&amp; value);\n...\n};\n</code></pre>\n\n<p>The purpose of this is to enable code like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Result&lt;SomeType, int&gt; value = SomeType{...};\nEXPECT_TRUE(result.isOk());   // TRUE\n\n// Also\nResult&lt;SomeType, int&gt; value = 10;\nEXPECT_TRUE(result.isError());   // TRUE\n</code></pre>\n\n<p>This is important for function returning values:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Result&lt;SuccessType, int&gt; func() {\n  SuccessType result{...};\n...\n  return result;\n}\n...\n\nEXPECT_TRUE(func().isOk());\n</code></pre>\n\n<p>Now it turned out that such constructor is too permissive and leads to undesirable type conversion.s I'd like to constrain it. </p>\n\n<p>So the questions are:\n - Do you think it is useful to allow same-types for Value result and Error? For example: \n<code>Result&lt;MyTypeA, MyTypeA&gt; r{};</code> Do you have an example when error-type and success types are the same and it is useful?</p>\n\n<p>The motivation for this question is the fact that I can get rid of template&lt;> constructor but only if V and E are not the same types:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;class V, class E&gt;\nstruct Result {\n    constexpr result(V&amp;&amp; value);    \n    constexpr result(E&amp;&amp; value);\n...\n</code></pre>\n\n<ul>\n<li>Also, do you think having r-value only constructor is sufficient in practice?\nI can't think of Result&lt;> not being return value - and thus no point in not moving value out of intermediate object.</li>\n</ul>\n"}, {"tags": ["c++", "qt", "opengl-es", "freetype"], "comments": [{"owner": {"reputation": 2550, "user_id": 191012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5cd6859716d64ed0a877c7a8e8969135?s=128&d=identicon&r=PG", "display_name": "prideout", "link": "https://stackoverflow.com/users/191012/prideout"}, "edited": false, "score": 0, "creation_date": 1573060420, "post_id": 58730680, "comment_id": 103760840, "body": "The question is unclear: you said &quot;with orthographic projection it is drawing perfectly&quot; then later you said &quot;I am sure it is the issue with the settings in projection&quot;.  It sounds like you changed something in the code, and the result changed from good to bad.  However it is unclear what you changed."}, {"owner": {"reputation": 9, "user_id": 12331880, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUncVJz9X6vH9otvLPsIEqVbKfWIw7VmBbE7PYxg=k-s128", "display_name": "Arun Virupaksha", "link": "https://stackoverflow.com/users/12331880/arun-virupaksha"}, "reply_to_user": {"reputation": 2550, "user_id": 191012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5cd6859716d64ed0a877c7a8e8969135?s=128&d=identicon&r=PG", "display_name": "prideout", "link": "https://stackoverflow.com/users/191012/prideout"}, "edited": false, "score": 0, "creation_date": 1573107844, "post_id": 58730680, "comment_id": 103775106, "body": "Hi, Actually i meant without 3D objects and texture drawing it is working fine. But when I include both of them it is not working. The order of drawing is  1) 3D objects 2) Texture 3) Font"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12331880, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUncVJz9X6vH9otvLPsIEqVbKfWIw7VmBbE7PYxg=k-s128", "display_name": "Arun Virupaksha", "link": "https://stackoverflow.com/users/12331880/arun-virupaksha"}, "edited": false, "score": 0, "creation_date": 1573454833, "post_id": 58753139, "comment_id": 103874254, "body": "Hi prideout, Thank you very much. It worked for both orthographic and perspective projection.  I need one suggestion, Now i am using single viewport for both ortho and perspective projections, Is it a good practice to have different viewport for them ?"}, {"owner": {"reputation": 2550, "user_id": 191012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5cd6859716d64ed0a877c7a8e8969135?s=128&d=identicon&r=PG", "display_name": "prideout", "link": "https://stackoverflow.com/users/191012/prideout"}, "reply_to_user": {"reputation": 9, "user_id": 12331880, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUncVJz9X6vH9otvLPsIEqVbKfWIw7VmBbE7PYxg=k-s128", "display_name": "Arun Virupaksha", "link": "https://stackoverflow.com/users/12331880/arun-virupaksha"}, "edited": false, "score": 0, "creation_date": 1573486559, "post_id": 58753139, "comment_id": 103888528, "body": "It&#39;s fine to use the same <code>glViewport</code>, the only times you need to change the viewport are when the window resizes or if you&#39;re drawing multiple 3D views on the screen (e.g. a minimap in a corner)."}, {"owner": {"reputation": 9, "user_id": 12331880, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUncVJz9X6vH9otvLPsIEqVbKfWIw7VmBbE7PYxg=k-s128", "display_name": "Arun Virupaksha", "link": "https://stackoverflow.com/users/12331880/arun-virupaksha"}, "edited": false, "score": 0, "creation_date": 1573545547, "post_id": 58753139, "comment_id": 103906670, "body": "That&#39;s great. Thank you prideout. :)"}], "tags": [], "owner": {"reputation": 2550, "user_id": 191012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5cd6859716d64ed0a877c7a8e8969135?s=128&d=identicon&r=PG", "display_name": "prideout", "link": "https://stackoverflow.com/users/191012/prideout"}, "is_accepted": true, "score": 0, "last_activity_date": 1573144179, "creation_date": 1573144179, "answer_id": 58753139, "question_id": 58730680, "link": "https://stackoverflow.com/questions/58730680/issue-with-font-rendering-using-freetype-in-opengl-is-not-working/58753139#58753139", "title": "Issue with Font Rendering using Freetype in OpenGL is not working", "body": "<p>In your initialization function, you've set up some OpenGL state via <code>glVertexAttribPointer</code>, which later gets clobbered.</p>\n\n<p>To fix this, modify your text-rendering code so that it makes two calls <code>glVertexAttribPointer</code> after <code>glBindBuffer</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 12331880, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAUncVJz9X6vH9otvLPsIEqVbKfWIw7VmBbE7PYxg=k-s128", "display_name": "Arun Virupaksha", "link": "https://stackoverflow.com/users/12331880/arun-virupaksha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 58753139, "answer_count": 1, "score": -1, "last_activity_date": 1573144179, "creation_date": 1573044871, "last_edit_date": 1573053129, "question_id": 58730680, "link": "https://stackoverflow.com/questions/58730680/issue-with-font-rendering-using-freetype-in-opengl-is-not-working", "title": "Issue with Font Rendering using Freetype in OpenGL is not working", "body": "<p>I am facing an issue with font rendering. I am using the tutorial <a href=\"https://learnopengl.com/In-Practice/Text-Rendering\" rel=\"nofollow noreferrer\">https://learnopengl.com/In-Practice/Text-Rendering</a> for this.\nI am developing the application in OpenGLESV3.</p>\n\n<p>I have made different shader programs for 3D object drawing, for loading textures and lastly for the font rendering.\nI am drawing the fonts after the 3D objects and texture drawing is done.\nHowever the issue is that the font is not seen when i draw using orthographic projection. I am able to only see the 3D objects and texture. (Even though the shaders are different)</p>\n\n<p>when I only draw font only with orthographic projection it is drawing perfectly.</p>\n\n<p>I am sure it is the issue with the settings in projection, but i am unable to figure out the issue.\nCan anybody help please ?</p>\n\n<p>Here is the code inside my render loop</p>\n\n<pre><code>    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\nglViewport(0, 0, (GLsizei)SCR_WIDTH, (GLsizei)SCR_HEIGHT);\n\n/********************************* 3D objects Rendering ********************************************************/\nglUseProgram(shaderpgmPoints);\nprojection = glm::perspective(glm::radians(camspec.fov), (float)SCR_WIDTH / (float)SCR_HEIGHT, 0.1f, 100.0f);\nglUniformMatrix4fv(glGetUniformLocation(shaderpgmPoints, \"projection\"), 1, false, &amp;projection[0][0]);\n\nview = glm::lookAt(camspec.cameraPos, camspec.cameraPos + camspec.cameraFront, camspec.cameraUp);\n\nglUniformMatrix4fv(glGetUniformLocation(shaderpgmPoints, \"view\"), 1, false, &amp;view[0][0]);\n\nmodel = glm::mat4(1.0f);\nglUniformMatrix4fv(glGetUniformLocation(shaderpgmPoints, \"model\"), 1, false, &amp;model[0][0]);\n\nglEnableVertexAttribArray(0);\nglEnableVertexAttribArray(1);\n\nglBindBuffer(GL_ARRAY_BUFFER, quadBufferObject);\nglVertexAttribPointer(0, 4, GL_FLOAT, GL_FALSE, 0, 0);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 0, (void*)64);\n\nglEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\nglBindBuffer(GL_ARRAY_BUFFER, leftlaneBufferObject);\nglVertexAttribPointer(0, 4, GL_FLOAT, GL_FALSE, 0, 0);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 0, (void*)192);\n\n;\nglEnable(GL_PROGRAM_POINT_SIZE);\nglDrawArrays(GL_LINES, 0, 12);\nglDisable(GL_BLEND);\n\n\nglEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\nglBindBuffer(GL_ARRAY_BUFFER, rightlaneBufferObject);\nglVertexAttribPointer(0, 4, GL_FLOAT, GL_FALSE, 0, 0);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 0, (void*)32);\n\nglLineWidth(10.0f);\nglDrawArrays(GL_LINES, 0, 2);\nglDisable(GL_BLEND);\n\nglDisableVertexAttribArray(0);\nglDisableVertexAttribArray(1);\nglUseProgram(0);\n/********************************* 3D objects Rendering -End ********************************************************/\n\n\n/********************************* Texture Rendering ********************************************************/\nglUseProgram(shaderpgmTexture);\nglm::mat4 transform = glm::mat4(1.0f);\ntransform = glm::translate(transform, glm::vec3(0.0f, 0.0f, 0.0f));\nglUniformMatrix4fv(glGetUniformLocation(shaderpgmTexture, \"transform\"), 1, false, &amp;transform[0][0]);\n\nglEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\n\nglUniform1i(glGetUniformLocation(shaderpgmTexture, \"outputTexture\"), 1);\nglActiveTexture(GL_TEXTURE1);\nglBindTexture(GL_TEXTURE_2D, camTexture);\n\nglBindBuffer(GL_ARRAY_BUFFER, camTextureBufferObject);\n// position attribute\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 5 * sizeof(float), (void*)0);\nglEnableVertexAttribArray(0);\n// texture coord attribute\nglVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 5 * sizeof(float), (void*)(3 * sizeof(float)));\nglEnableVertexAttribArray(1);\n\nglDrawArrays(GL_QUADS, 0, 4);\n\nglDisable(GL_BLEND);\n\nglDisableVertexAttribArray(0);\nglDisableVertexAttribArray(1);\nglUseProgram(0);\n/********************************* Texture Rendering - End ********************************************************/\n\n/********************************* Font Rendering ********************************************************/\nglDisable(GL_DEPTH_TEST);\nglUseProgram(shaderpgmFont);\nglEnable(GL_CULL_FACE);\nglEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\nglm::mat4 project = glm::ortho(0.0f, static_cast&lt;GLfloat&gt;(SCR_WIDTH), 0.0f, static_cast&lt;GLfloat&gt;(SCR_HEIGHT));\nglUniformMatrix4fv(glGetUniformLocation(shaderpgmFont, \"projection\"), 1, false, &amp;project[0][0]);\nglUniform3f(glGetUniformLocation(shaderpgmFont, \"textColor\"), 1.0f, 0.0f, 0.0f);\nglActiveTexture(GL_TEXTURE0);\nGLfloat scale = 1.0f;\nGLfloat x = 10.0f;\nGLfloat y = 10.0f;\nstd::string text = \"THE\";\nstd::string::const_iterator c;\nfor (c = text.begin(); c != text.end(); c++)\n{\n    Character ch = Characters[*c];\n\n    GLfloat xpos = x + ch.Bearing.x * scale;\n    GLfloat ypos = y - (ch.Size.y - ch.Bearing.y) * scale;\n\n    GLfloat w = ch.Size.x * scale;\n    GLfloat h = ch.Size.y * scale;\n    GLfloat vertices[6][4] = {\n        { xpos,     ypos + h,   0.0, 0.0 },\n        { xpos,     ypos,       0.0, 1.0 },\n        { xpos + w, ypos,       1.0, 1.0 },\n\n        { xpos,     ypos + h,   0.0, 0.0 },\n        { xpos + w, ypos,       1.0, 1.0 },\n        { xpos + w, ypos + h,   1.0, 0.0 }\n    };\n\n    // Render glyph texture over quad\n    glBindTexture(GL_TEXTURE_2D, ch.TextureID);\n    // Update content of VBO memory\n    glBindBuffer(GL_ARRAY_BUFFER, FontVertexBufferObject);\n    glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(vertices), vertices); // Be sure to use glBufferSubData and not glBufferData\n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    glDrawArrays(GL_TRIANGLES, 0, 6);\n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    // Now advance cursors for next glyph (note that advance is number of 1/64 pixels)\n    x += (ch.Advance &gt;&gt; 6) * scale; // Bitshift by 6 to get value in pixels (2^6 = 64 (divide amount of 1/64th pixels by 64 to get amount of pixels))\n}\n\nglBindTexture(GL_TEXTURE_2D, 0);\nglDisable(GL_BLEND);\nglDisable(GL_CULL_FACE);\nglUseProgram(0);\nglEnable(GL_DEPTH_TEST);\n/********************************* Font Rendering - End********************************************************/\n</code></pre>\n\n<p>I am Initializing the font buffer like this</p>\n\n<pre><code>    glDisable(GL_DEPTH_TEST);\nglEnable(GL_CULL_FACE);\nglEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\nglUseProgram(shaderpgmFont);\n// FreeType\nFT_Library ft;\n// All functions return a value different than 0 whenever an error occurred\nif (FT_Init_FreeType(&amp;ft))\n    std::cout &lt;&lt; \"ERROR::FREETYPE: Could not init FreeType Library\" &lt;&lt; std::endl;\n\n// Load font as face\nFT_Face face;\nif (FT_New_Face(ft, \"fonts/arial.ttf\", 0, &amp;face))\n{\n    std::cout &lt;&lt; \"ERROR::FREETYPE: Failed to load font\" &lt;&lt; std::endl;\n}   \nelse\n{\n    // Set size to load glyphs as\n    FT_Set_Pixel_Sizes(face, 0, 48);\n\n    // Disable byte-alignment restriction\n    glPixelStorei(GL_UNPACK_ALIGNMENT, 1);\n\n    // Load first 128 characters of ASCII set\n    for (GLubyte c = 0; c &lt; 128; c++)\n    {\n        // Load character glyph \n        if (FT_Load_Char(face, c, FT_LOAD_RENDER))\n        {\n            std::cout &lt;&lt; \"ERROR::FREETYTPE: Failed to load Glyph\" &lt;&lt; std::endl;\n            continue;\n        }\n        // Generate texture\n        GLuint texture;\n        glGenTextures(1, &amp;texture);\n        glBindTexture(GL_TEXTURE_2D, texture);\n        glTexImage2D(\n            GL_TEXTURE_2D,\n            0,\n            GL_ALPHA,\n            face-&gt;glyph-&gt;bitmap.width,\n            face-&gt;glyph-&gt;bitmap.rows,\n            0,\n            GL_ALPHA,\n            GL_UNSIGNED_BYTE,\n            face-&gt;glyph-&gt;bitmap.buffer\n        );\n        // Set texture options\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n        // Now store character for later use\n        Character character = {\n            texture,\n            glm::ivec2(face-&gt;glyph-&gt;bitmap.width, face-&gt;glyph-&gt;bitmap.rows),\n            glm::ivec2(face-&gt;glyph-&gt;bitmap_left, face-&gt;glyph-&gt;bitmap_top),\n            face-&gt;glyph-&gt;advance.x\n        };\n        Characters.insert(std::pair&lt;GLchar, Character&gt;(c, character));\n    }\n    glBindTexture(GL_TEXTURE_2D, 0);\n    // Destroy FreeType once we're finished\n    FT_Done_Face(face);\n    FT_Done_FreeType(ft);\n\n\n\n    // Configure VAO/VBO for texture quads\n    glGenBuffers(1, &amp;FontVertexBufferObject);\n    glBindBuffer(GL_ARRAY_BUFFER, FontVertexBufferObject);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(GLfloat) * 6 * 4, NULL, GL_DYNAMIC_DRAW);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 2, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), 0);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), (void*)(2 * sizeof(GLfloat)));\n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n}\nglUseProgram(0);\nglDisable(GL_CULL_FACE);\nglDisable(GL_BLEND);\nglEnable(GL_DEPTH_TEST);\n</code></pre>\n"}]