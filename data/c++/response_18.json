[{"tags": ["c++", "makefile", "cmake", "mpi", "petsc"], "answers": [{"tags": [], "owner": {"reputation": 8422, "user_id": 2838364, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/49f4fa6b870a90ce4e02a5c24c5ddd48?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/2838364/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1431590623, "creation_date": 1431590623, "answer_id": 30232299, "question_id": 30227143, "link": "https://stackoverflow.com/questions/30227143/unable-to-generate-makefile-for-basic-petsc-program/30232299#30232299", "title": "Unable to generate makefile for basic PETSc program", "body": "<p>Based on <a href=\"https://github.com/jedbrown/cmake-modules/blob/master/FindPETSc.cmake\" rel=\"nofollow\">FindPETSC.cmake</a> it seems that the default options for <code>PETSC_ARCH</code> are: </p>\n\n<pre><code>linux-gnu-c-debug \nlinux-gnu-c-opt\nx86_64-unknown-linux-gnu \ni386-unknown-linux-gnu\n</code></pre>\n\n<p>or the one you have used in case of the <a href=\"http://www.mcs.anl.gov/petsc/documentation/installation.html\" rel=\"nofollow\">manual build</a>.</p>\n\n<p>CMake tries to find file <code>${PETSC_DIR}/${PETSC_ARCH}/include/petscconf.h</code> or \n<code>${PETSC_DIR}/bmake/${PETSC_ARCH}/petscconf.h</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 1000202, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e15c9d963ae15050550ad6a855561612?s=128&d=identicon&r=PG", "display_name": "M K", "link": "https://stackoverflow.com/users/1000202/m-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431590623, "creation_date": 1431561583, "question_id": 30227143, "link": "https://stackoverflow.com/questions/30227143/unable-to-generate-makefile-for-basic-petsc-program", "title": "Unable to generate makefile for basic PETSc program", "body": "<p>I have a very basic program using PETSC</p>\n\n<pre><code> #include \"PETSC/petsc.h\"\n #include \"PETSC/petscsys.h\"\n #include \"PETSC/petscmat.h\"\n\n int main(int argc, char *argv[]) {\n     PetscMPIInt    rank,size;\n     PetscInitialize(&amp;argc,&amp;argv,0,0);\n     MPI_Comm_size(PETSC_COMM_WORLD,&amp;size);\n     MPI_Comm_rank(PETSC_COMM_WORLD,&amp;rank);\n     PetscPrintf(PETSC_COMM_WORLD,\"Number of processors = %d, rank = %d\\n\",size,rank);\n     PetscSynchronizedPrintf(PETSC_COMM_WORLD,\"synchronized rank = %d\\n\",rank);\n\n     MPI_Barrier(PETSC_COMM_WORLD);\n PetscFinalize();\n     return 0;\n }\n</code></pre>\n\n<p>However, I got undefined reference errors to <code>PETSC_COMM_WORLD</code>, <code>PetscInitialize</code> and other junk, when I tried to compile using mpic++</p>\n\n<p>I am now trying to use <code>build</code> and cmake. This is my attempt at a <code>CMakeLists</code></p>\n\n<pre><code> CMAKE_MINIMUM_REQUIRED(VERSION 2.8)\n\n PROJECT(checkMPI)\n\n SET(CMAKE_MODULE_PATH \"${CMAKE_SOURCE_DIR}/cmake-modules\")\n\n set(PETSC_ARCH linux-gnu)\n set(PETSC_DIR l${PROJECT_SOURCE_DIR}/third-party/petsc)\n\n FIND_PACKAGE(PETSc REQUIRED)\n\n INCLUDE_DIRECTORIES(${PETSC_INCLUDES})\n ADD_DEFINITIONS(${PETSC_DEFINITIONS})\n\n ADD_EXECUTABLE(checkMPI checkMPI.cpp)\n\n TARGET_LINK_LIBRARIES(checkMPI ${PETSC_LIBRARIES})\n</code></pre>\n\n<p>In addition, I have a directory <code>cmake-modules</code> containing the cmake-modules for PETSc</p>\n\n<p>However, when I try to generate the makefile by typing <code>ccmake ..</code> and then <code>c</code>, I get the output </p>\n\n<pre><code>CMake Error at cmake-modules/FindPETSc.cmake:127 (message):\n   The pair PETSC_DIR=l/directory/HPC/third-party/petsc\n   PETSC_ARCH=linux-gnu do not specify a valid PETSc installation\n Call Stack (most recent call first):\n   CMakeLists.txt:10 (FIND_PACKAGE)\n\n CMake Error at /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:108\n(message):\n   PETSc could not be found.  Be sure to set PETSC_DIR and PETSC_ARCH.\n   (missing: PETSC_INCLUDES PETSC_LIBRARIES PETSC_EXECUTABLE_RUNS)\n Call Stack (most recent call first):\n   /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:315\n</code></pre>\n\n<p>Anyone can help?</p>\n"}, {"tags": ["c++", "c++11", "lambda", "rvalue-reference"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1431561518, "post_id": 30227097, "comment_id": 48557981, "body": "gcc 5.1 does not complain either."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1431563276, "post_id": 30227097, "comment_id": 48558480, "body": "Nit-pick: You&#39;re not assigning to a <code>std::function</code>. Although the syntax is very similar, <code>std::function&lt;..&gt; f = ..;</code> is an initialization rather than an assignment, since it defines a new object."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1431563328, "post_id": 30227097, "comment_id": 48558491, "body": "This is akin to the ordinary contravariance of function parameters."}], "answers": [{"tags": [], "owner": {"reputation": 4218, "user_id": 865281, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/435568f417505b4ccd67ee51253b5f5e?s=128&d=identicon&r=PG", "display_name": "Xaqq", "link": "https://stackoverflow.com/users/865281/xaqq"}, "is_accepted": false, "score": 8, "last_activity_date": 1431562680, "last_edit_date": 1431562680, "creation_date": 1431562178, "answer_id": 30227237, "question_id": 30227097, "link": "https://stackoverflow.com/questions/30227097/c11-lambda-can-be-assigned-to-stdfunction-with-incorrect-signature/30227237#30227237", "title": "C++11 lambda can be assigned to std::function with incorrect signature", "body": "<p>Please take this with a grain of salt. This is what I understand, but I am not sure.</p>\n\n<p>Consider the following output:</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n  std::cout &lt;&lt;  std::is_convertible&lt;s &amp;&amp;, s&amp;&gt;::value &lt;&lt; std::endl;       //false                                                      \n  std::cout &lt;&lt;  std::is_convertible&lt;s &amp;&amp;, const s&amp;&gt;::value &lt;&lt; std::endl; //true                                                     \n\n  std::cout &lt;&lt;  std::is_convertible&lt;const s &amp;, s&amp;&amp;&gt;::value &lt;&lt; std::endl; //false                                                     \n  return 0;\n}\n</code></pre>\n\n<p>This shows that it is possible to convert a <code>s &amp;&amp;</code> to a <code>const s&amp;</code>. This is why the <code>std::function</code>'s assignment is ok.</p>\n\n<blockquote>\n  <p>Dropping the const from the lambda's declaration does generate an\n  error as expected.</p>\n</blockquote>\n\n<p>Indeed this is because (as shown before), converting a <code>s &amp;&amp;</code> to a <code>s &amp;</code> is not possible.</p>\n\n<p>In the same way, trying the opposite:</p>\n\n<p><code>std::function&lt;void (const s &amp;)&gt; f = [](s &amp;&amp;p) { std::cout &lt;&lt; p.x; };</code> would fail because it is not possible to convert a <code>const s&amp;</code>\n to a <code>s &amp;&amp;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1431563354, "post_id": 30227383, "comment_id": 48558497, "body": "this also applies to class hierarchies, <code>std::function&lt;void(Derived*)&gt; f = [](Base *){ };</code>"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 1, "creation_date": 1431564832, "post_id": 30227383, "comment_id": 48558869, "body": "Nice answer, +1, it&#39;s the first time when I hear this. How does it work behind the scenes? Type erasure?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 1, "creation_date": 1431565038, "post_id": 30227383, "comment_id": 48558910, "body": "@vsoftco Yes, see for example <a href=\"http://stackoverflow.com/questions/14936539/how-stdfunction-works\">R. Martinho Fernandes&#39;s excellent answer here</a> for details."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1431565126, "post_id": 30227383, "comment_id": 48558933, "body": "@vsoft As an example, there is some object that has the described signature that std function has, and in it it calls the lambda."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1431565191, "post_id": 30227383, "comment_id": 48558948, "body": "@hvd, thanks for the link, addresses exactly what I wanted to know."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 24, "last_activity_date": 1431563108, "creation_date": 1431563108, "answer_id": 30227383, "question_id": 30227097, "link": "https://stackoverflow.com/questions/30227097/c11-lambda-can-be-assigned-to-stdfunction-with-incorrect-signature/30227383#30227383", "title": "C++11 lambda can be assigned to std::function with incorrect signature", "body": "<p>To expand on the existing comment and answer:</p>\n\n<p>The point of <code>std::function&lt;R(A...)&gt;</code> is that it can wrap any function or functor that can be called with <code>A...</code> and have the result stored in an <code>R</code>.</p>\n\n<p>So, for example,</p>\n\n<pre><code>std::function&lt;int(int)&gt; f = [](long l) { return l; };\n</code></pre>\n\n<p>is just peachy.</p>\n\n<p>So what you have to ask yourself when you see something like this: if you have a lambda taking <code>const T &amp;</code>, and you have an expression of type <code>T &amp;&amp;</code> (or, more accurately, you have an xvalue of type <code>T</code>), can you use that expression to call the lambda?</p>\n\n<p>Yes, you can.</p>\n\n<p>And if you can, then <code>std::function</code> is supposed to be able to store that functor. That's pretty much the main point of <code>std::function</code>.</p>\n"}], "owner": {"reputation": 201, "user_id": 4744427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c599b014135e6b84502597552889e57?s=128&d=identicon&r=PG&f=1", "display_name": "Eagle", "link": "https://stackoverflow.com/users/4744427/eagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 3, "accepted_answer_id": 30227383, "answer_count": 2, "score": 19, "last_activity_date": 1431563108, "creation_date": 1431561252, "question_id": 30227097, "link": "https://stackoverflow.com/questions/30227097/c11-lambda-can-be-assigned-to-stdfunction-with-incorrect-signature", "title": "C++11 lambda can be assigned to std::function with incorrect signature", "body": "<p>The following compiles and runs (under Apple LLVM version 6.1.0 and Visual C++ 2015):</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\nstruct s { int x; };\n\nint main(int argc, char **argv)\n{\n    std::function&lt;void (s &amp;&amp;)&gt; f = [](const s &amp;p) { std::cout &lt;&lt; p.x; };\n    f(s {1});\n    return 0;\n}\n</code></pre>\n\n<p>Why doesn't the assignment <code>std::function&lt;void (s &amp;&amp;)&gt; f = [](const s &amp;p) { std::cout &lt;&lt; p.x; };</code> generate an error? A function accepting an rvalue reference should not have the same signature as a function accepting a const lvalue reference, should it? Dropping the <code>const</code> from the lambda's declaration does generate an error as expected.</p>\n"}, {"tags": ["c++", "c++11", "stl", "static-libraries"], "comments": [{"owner": {"reputation": 8889, "user_id": 4538344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746edd669e07914179feb9f6957a06e3?s=128&d=identicon&r=PG", "display_name": "StenSoft", "link": "https://stackoverflow.com/users/4538344/stensoft"}, "edited": false, "score": 0, "creation_date": 1431563362, "post_id": 30227003, "comment_id": 48558502, "body": "Seems to me like a bug, that object should have weak linkage"}, {"owner": {"reputation": 355, "user_id": 2306328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b965b2e2581de00f1b648f05cda8a2?s=128&d=identicon&r=PG", "display_name": "Bos", "link": "https://stackoverflow.com/users/2306328/bos"}, "edited": false, "score": 0, "creation_date": 1431671481, "post_id": 30227003, "comment_id": 48606060, "body": "How do you set a int (7) to a const int* const ?"}, {"owner": {"reputation": 2284, "user_id": 2549876, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4012ce359fbdc0baf6863bcb94bce6f5?s=128&d=identicon&r=PG", "display_name": "Hector", "link": "https://stackoverflow.com/users/2549876/hector"}, "edited": false, "score": 0, "creation_date": 1431697907, "post_id": 30227003, "comment_id": 48622292, "body": "By shaving the outer layers of a program that no longer compiles. My mistake ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 2647431, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eeb2499381257d7f7f76cc6c4bda29aa?s=128&d=identicon&r=PG", "display_name": "Roger Leigh", "link": "https://stackoverflow.com/users/2647431/roger-leigh"}, "edited": false, "score": 0, "creation_date": 1438789103, "post_id": 30229794, "comment_id": 51595562, "body": "Thank you for this.  I&#39;ve been tearing my hair out trying to build icu, and see that it&#39;s referenced directly in the bug report."}, {"owner": {"reputation": 3149, "user_id": 646002, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ea180fe7ecd95902f4cccd40cf43541?s=128&d=identicon&r=PG", "display_name": "SirKnigget", "link": "https://stackoverflow.com/users/646002/sirknigget"}, "edited": false, "score": 0, "creation_date": 1444298669, "post_id": 30229794, "comment_id": 53848653, "body": "I have the exact same problem in VS2015. Removing the /Za flag in all my modules didn&#39;t solve it - any ideas?"}, {"owner": {"reputation": 2284, "user_id": 2549876, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4012ce359fbdc0baf6863bcb94bce6f5?s=128&d=identicon&r=PG", "display_name": "Hector", "link": "https://stackoverflow.com/users/2549876/hector"}, "reply_to_user": {"reputation": 3149, "user_id": 646002, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ea180fe7ecd95902f4cccd40cf43541?s=128&d=identicon&r=PG", "display_name": "SirKnigget", "link": "https://stackoverflow.com/users/646002/sirknigget"}, "edited": false, "score": 0, "creation_date": 1444299297, "post_id": 30229794, "comment_id": 53849071, "body": "@SirKnigget: check the workaround <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/1331482/bug-in-stl\" rel=\"nofollow noreferrer\">here</a>. Basically, you need to modify one of VS headers."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2549876, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4012ce359fbdc0baf6863bcb94bce6f5?s=128&d=identicon&r=PG", "display_name": "Hector", "link": "https://stackoverflow.com/users/2549876/hector"}, "is_accepted": true, "score": 6, "last_activity_date": 1431949120, "last_edit_date": 1431949120, "creation_date": 1431580840, "answer_id": 30229794, "question_id": 30227003, "link": "https://stackoverflow.com/questions/30227003/including-stl-in-static-libraries/30229794#30229794", "title": "Including STL in static libraries", "body": "<p>It is a <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/1331482/bug-in-stl\" rel=\"noreferrer\">bug</a>! The same library/program compiles under MSVC2013 without language extensions enabled. In MSVC2015, language extensions must be enabled.</p>\n"}], "owner": {"reputation": 2284, "user_id": 2549876, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4012ce359fbdc0baf6863bcb94bce6f5?s=128&d=identicon&r=PG", "display_name": "Hector", "link": "https://stackoverflow.com/users/2549876/hector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 30229794, "answer_count": 1, "score": 2, "last_activity_date": 1431949120, "creation_date": 1431560539, "question_id": 30227003, "link": "https://stackoverflow.com/questions/30227003/including-stl-in-static-libraries", "title": "Including STL in static libraries", "body": "<p>I have created a static library with the files alien.h and alien.cpp below. That library is linked by the file user.cpp. If one removes the line with the comment, then the code compiles, links, and runs as expected. As it is, the library and the program compile, the program however does not link. MSVC2015RC generates over 100 errors about <code>std::numeric_limits</code> being already defined.</p>\n\n<p><strong>Is there some setting that I should be aware of or is this a MSVC2015 bug?</strong></p>\n\n<p>File alien.h</p>\n\n<pre><code>#include &lt;vector&gt; // This line causes troubles.\n\nstruct alien\n{\n    const int * const value;\n};\n\nextern alien meh;\n</code></pre>\n\n<p>File alien.cpp</p>\n\n<pre><code>alien meh { 7 };\n</code></pre>\n\n<p>File user.cpp</p>\n\n<pre><code>#include \"alien.h\"\n#include &lt;iostream&gt;\n#pragma comment(lib, \"alien.lib\")\n\nint main()\n{\n    wcout &lt;&lt; meh.value;\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Error LNK2005 \"public: static int const std::numeric_limits::max_exponent\" (?max_exponent@?$numeric_limits@M@std@@2HB) already defined in alien.obj</p>\n</blockquote>\n"}, {"tags": ["c++", "processing-efficiency"], "comments": [{"owner": {"reputation": 1746, "user_id": 2636457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29162c5b215ddb5b900c713c5eb2be9c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2636457/levi"}, "edited": false, "score": 0, "creation_date": 1431560424, "post_id": 30226975, "comment_id": 48557669, "body": "To make your program (source) smaller: Remove all the newlines between your <code>int</code> declarations ;)"}, {"owner": {"reputation": 4933, "user_id": 2987253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa772cdc439443e5243e9d7aa41a9c6a?s=128&d=identicon&r=PG", "display_name": "Loocid", "link": "https://stackoverflow.com/users/2987253/loocid"}, "edited": false, "score": 6, "creation_date": 1431560500, "post_id": 30226975, "comment_id": 48557692, "body": "Use an array for <code>p1</code> to <code>p10</code>, then use a for loop to find the highest and the lowest elements."}, {"owner": {"reputation": 1746, "user_id": 2636457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29162c5b215ddb5b900c713c5eb2be9c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2636457/levi"}, "edited": false, "score": 1, "creation_date": 1431560697, "post_id": 30226975, "comment_id": 48557744, "body": "See <a href=\"http://www.cplusplus.com/doc/tutorial/arrays/\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.tutorialspoint.com/cplusplus/cpp_arrays.htm\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1431560818, "post_id": 30226975, "comment_id": 48557777, "body": "Use a <code>for</code> loop for the input."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 5, "creation_date": 1431561934, "post_id": 30226975, "comment_id": 48558087, "body": "I&#39;m voting to close this question as off-topic because code review."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1431563262, "post_id": 30226975, "comment_id": 48558476, "body": "I&#39;ll give you props for posting something that appears to work at least and shows logical thinking."}], "answers": [{"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1431561717, "post_id": 30227153, "comment_id": 48558032, "body": "Your solution looses the correlation between person (index) and the amount of pancakes or hamburgers eaten.  This is why I didn&#39;t sort in my answer."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1431644130, "post_id": 30227153, "comment_id": 48598223, "body": "@ThomasMatthews - so here I have added the discussion on how to reduce your code size, and why you should not bother with &#39;performance issues&#39;."}], "tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 0, "last_activity_date": 1431643700, "last_edit_date": 1431643700, "creation_date": 1431561620, "answer_id": 30227153, "question_id": 30226975, "link": "https://stackoverflow.com/questions/30226975/how-do-i-make-this-program-smaller-more-efficient/30227153#30227153", "title": "How do I make this program smaller, more efficient?", "body": "<p>Your comment is correct.</p>\n\n<p>revision:\ncreate a struct s1; </p>\n\n<p>with three values - person index, and hamburger count and pancake count.</p>\n\n<p>Fill and put the s1's into a vector</p>\n\n<p>use std::sort on the hamburger count. - print the value(s) you want.</p>\n\n<p>use std::sort on the pancake   count  - print the value(s) you want.</p>\n\n<p>The bigger count will be at one end (and smallest count at the other).</p>\n\n<hr>\n\n<p>revision 5/14/2015:</p>\n\n<p>Time to answer your question - how make smaller.  </p>\n\n<p>You simply identify the pattern ... and match it to a for loop.</p>\n\n<p>pattern idea 1 - The personId sequence is 1 to 10;</p>\n\n<p>Leads us to:</p>\n\n<pre><code>for (int personId = 1; personId &lt;= 10; ++personId)\n{\n\n}\n</code></pre>\n\n<p>For each person, your code prompts for counts - pancakes, then hamburgers:</p>\n\n<pre><code>for (int personId = 1; personId &lt;= 10; ++personId)\n{\n   cout &lt;&lt; \"How many pancakes did p\" &lt;&lt; personId &lt;&lt; \" eat?\" &lt;&lt; endl;\n   int p1 = 0;\n   cin &gt;&gt; p1;\n\n   cout &lt;&lt; \"How many hamburgers did p\" &lt;&lt; personId &lt;&lt; \" eat?\" &lt;&lt; endl;\n   int p2 = 0;\n   cin &gt;&gt; p2;\n\n   // perhaps these should be joined into a single prompt to get 2 numbers\n   // example:\n   cout &lt;&lt; \"Enter pancake count, then hamburger count: \" &lt;&lt; endl;\n   int p1 = 0;\n   int p2 = 0;\n   cin &gt;&gt; p1 &gt;&gt; p2;\n   // error handling is somewhat easier in the 1st style.\n\n}\n</code></pre>\n\n<p>To determine which is the least, or most, I recommend you put these items into a vector to sort.</p>\n\n<pre><code>struct S1 {\n    int personId;\n    int pancakeCount;\n    int hamburgerCount;\n\n    // define ctor\n    S1(void) : personId(0), pancakeCount(0), hamburgerCount(0)\n    {\n    }\n};\n\nvector&lt;S1&gt; s1Vec;\n\nfor (int personId = 1; personId &lt;= 10; ++personId)\n{\n   cout &lt;&lt; \"How many pancakes did p\" &lt;&lt; personId &lt;&lt; \" eat?\" &lt;&lt; endl;\n   int p1 = 0;\n   cin &gt;&gt; p1;\n\n   cout &lt;&lt; \"How many hamburgers did p\" &lt;&lt; personId &lt;&lt; \" eat?\" &lt;&lt; endl;\n   int p2 = 0;\n   cin &gt;&gt; p2;\n\n   {\n       S1 s1; // declare an instance, and fill in\n       s1.personId = personId;\n       s1.pancackecount = p1;\n       s1.hamburgerCount = p2;\n\n       s1Vec.push_back(s1);  // default cpy-ctor will capture into vec\n   } // THIS brace triggers the dtor of s1 ... currently does nothing,\n     // but sometimes the intermediate structs / classes need cleaning\n}\n\n// now you have all ids and counts captured to the vector\n\n// sort s1Vec by pancakeCount, and \n//  print out s1Vec.begin() and .end()\n\n// sort s1Vec by hamburgerCount, and\n//   print out s1.begin() and .end()\n</code></pre>\n\n<p>I suggest you add a show method to S1...</p>\n\n<pre><code>struct S1 {\n    int personId;\n    int pancakeCount;\n    int hamburgerCount;\n\n    // define ctor to initialize values\n    S1(void) : personId(0), pancakeCount(0), hamburgerCount(0)\n    {\n    }\n\n    std::string show(void)\n    {\n       stringstream ss;\n       ss &lt;&lt; \"person: \" &lt;&lt; personId\n           &lt;&lt; \"    p1: \" &lt;&lt; pancakeCount\n           &lt;&lt; \"    p2: \" &lt;&lt; hamburgerCount &lt;&lt; endl;\n       return (ss.str());\n    }\n\n    std::string showP1(void)\n    {\n       stringstream ss;\n       cout &lt;&lt; \"person: \" &lt;&lt; personId\n            &lt;&lt; \"    p1: \" &lt;&lt; pancakeCount &lt;&lt; endl;\n       return (ss.str());\n    }\n\n    std::string showP2(void)\n    {\n       stringstream ss;\n       cout &lt;&lt; \"person: \" &lt;&lt; personId\n            &lt;&lt; \"    p2: \" &lt;&lt; hamburgerCount &lt;&lt; endl;\n       return (ss.str());\n    }\n\n};\n</code></pre>\n\n<p>Good luck.</p>\n\n<p>This reduces size of your code by using a loop and the struct.  </p>\n\n<p>Your code can be considered an 'unrolled' loop, which is something you might consider for performance issues.  But hey, <strong>user I/O (prompts and responses) can never be</strong> high performance.</p>\n"}, {"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 2, "last_activity_date": 1431615097, "last_edit_date": 1431615097, "creation_date": 1431561628, "answer_id": 30227156, "question_id": 30226975, "link": "https://stackoverflow.com/questions/30226975/how-do-i-make-this-program-smaller-more-efficient/30227156#30227156", "title": "How do I make this program smaller, more efficient?", "body": "<h2>Vector of Pancake Quantities</h2>\n\n<p>Try this:</p>\n\n<pre><code>typedef std::vector&lt;unsigned int&gt; Pancake_Container;\nconst unsigned int MAXIMUM_PARTICIPANTS = 10;\nPancake Container pancake_quantities(MAXIMUM_PARTICIPANTS);\nfor (unsigned int i = 0U; i &lt; MAXIMUM_PARTICIPANTS; ++i)\n{\n  static const char prompt_text1[] = \"\\nHow many pancakes did participant #\";\n  static const char prompt_ending[] = \" eat? \";\n  cout.write(prompt_text1, sizeof(prompt_text1) - 1U);\n  cout &lt;&lt; i;\n  cout.write(prompt_ending, sizeof(prompt_ending) - 1U));\n  unsigned int quantity = 0U;\n  cin &gt;&gt; quantity;\n  pancake_quantities[i] = quantity;\n}\n\nunsigned int max_person_index = 0U;\nunsigned int max_pancakes_eaten = 0U;\nunsigned int min_person_index = 0U;\nunsigned int min_pancakes_eaten = MAX_UINT;\nfor (unsigned int i = 0U; i &lt; MAXIMUM_PARTICIPANTS; ++i)\n{\n  const unsigned int quantity = pancake_quantities[i];\n  if (quantity &gt; max_pancakes_eaten)\n  {\n    max_person_index = i;\n    max_pancakes_eaten = quantity;\n  }\n  if (quantity &lt; min_pancakes_eaten)\n  {\n    min_person_index = i;\n    min_pancakes_eaten = quantity;\n  }\n}\n\ncout &lt;&lt; \"Person #\" &lt;&lt; max_person_index &lt;&lt; \" ate \" &lt;&lt; max_pancakes_eaten &lt;&lt; \"\\n\";\ncout &lt;&lt; \"Person #\" &lt;&lt; min_person_index &lt;&lt; \" ate \" &lt;&lt; min_pancakes_eaten &lt;&lt; \"\\n\";\n</code></pre>\n\n<h2>Vector of Structures</h2>\n\n<p>This one allows sorting to figure out the maximum and minimum.</p>\n\n<pre><code>struct Pancake_Info\n{\n    unsigned int id;\n    unsigned int quantity;\n    Pancake_Info() : id(0), quantity(0)\n        {}\n    bool operator &lt; (const Pancake_Info&amp; other)\n        {\n            return quantity &lt; other.quantity;\n        }\n};\n\ntypedef std::vector&lt;Pancake_Info&gt; Pancake_Container;\nPancake_Container pancake_quantities;\nfor (unsigned int i = 0U; i &lt; MAXIMUM_PARTICIPANTS; ++i)\n{\n    static const char prompt_text1[]  = \"\\nHow many pancakes did participant #\";\n    static const char prompt_ending[] = \" eat? \";\n    cout.write(prompt_text1, sizeof(prompt_text1) - 1U);\n    cout &lt;&lt; i;\n    cout.write(prompt_ending, sizeof(prompt_ending) - 1U);\n    unsigned int quantity = 0U;\n    Pancake_Info p_i;\n    cin &gt;&gt; p_i.quantity;\n    p_i.id = i;\n    pancake_quantities.push_back(p_i);\n}\nstd::sort(pancake_quantities.begin(), pancake_quantities.end());\ncout &lt;&lt; \"Minimum of \"\n     &lt;&lt; pancake_quantities[0].quantity\n     &lt;&lt; \" eaten by person \"\n     &lt;&lt; pancake_quantities[0].id\n     &lt;&lt; \"\\n\";\ncout &lt;&lt; \"Maximum of \"\n     &lt;&lt; pancake_quantities[MAXIMUM_PARTICIPANTS - 1].quantity\n     &lt;&lt; \" eaten by person \"\n     &lt;&lt; pancake_quantities[MAXIMUM_PARTICIPANTS - 1].id\n     &lt;&lt; \"\\n\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 0, "last_activity_date": 1431616898, "last_edit_date": 1431616898, "creation_date": 1431616176, "answer_id": 30240829, "question_id": 30226975, "link": "https://stackoverflow.com/questions/30226975/how-do-i-make-this-program-smaller-more-efficient/30240829#30240829", "title": "How do I make this program smaller, more efficient?", "body": "<p>I don't see why the answer has to be so complicated.</p>\n\n<p>It can be done very easy with <code>vector</code>:</p>\n\n<pre><code>  auto num_eaten = std::vector&lt;int&gt;(10);\n\n  for (auto i = 0u; i &lt; num_eaten.size(); ++i) {\n    cout &lt;&lt; \"Enter number of hamburgers eaten by \" &lt;&lt; (i + 1) &lt;&lt; \"&gt; \";\n    cin &gt;&gt; num_eaten[i];\n  }\n\n  auto min_it = std::min_element(num_eaten.begin(), num_eaten.end());\n  cout &lt;&lt; (std::distance(num_eaten.begin(), min_it) + 1) &lt;&lt; \" ate the least\"\n       &lt;&lt; endl;\n\n  auto max_it = std::max_element(num_eaten.begin(), num_eaten.end());\n  cout &lt;&lt; (std::distance(num_eaten.begin(), max_it) + 1) &lt;&lt; \" ate the most\"\n       &lt;&lt; endl;\n</code></pre>\n\n<p>or with <code>map</code>:</p>\n\n<pre><code>  auto eaten = std::unordered_map&lt;int, int&gt;{};\n\n  for (auto i = 1; i &lt; 10; ++i) {\n    cout &lt;&lt; \"Enter number of hamburgers eaten by \" &lt;&lt; i &lt;&lt; \"&gt; \";\n    cin &gt;&gt; eaten[i];\n  }\n\n  auto min_it = std::min_element(\n      eaten.begin(), eaten.end(),\n      [](auto const &amp;lhs, auto const &amp;rhs) { return lhs.second &lt; rhs.second; });\n  cout &lt;&lt; min_it-&gt;first &lt;&lt; \" ate the least: \" &lt;&lt; min_it-&gt;second &lt;&lt; endl;\n\n  auto max_it = std::min_element(\n      eaten.begin(), eaten.end(),\n      [](auto const &amp;lhs, auto const &amp;rhs) { return lhs.second &gt; rhs.second; });\n\n  cout &lt;&lt; max_it-&gt;first &lt;&lt; \" ate the most: \" &lt;&lt; max_it-&gt;second &lt;&lt; endl;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4398858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y44g9.jpg?s=128&g=1", "display_name": "Charles James", "link": "https://stackoverflow.com/users/4398858/charles-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1432694585, "answer_count": 3, "score": 0, "last_activity_date": 1431643700, "creation_date": 1431560343, "question_id": 30226975, "link": "https://stackoverflow.com/questions/30226975/how-do-i-make-this-program-smaller-more-efficient", "closed_reason": "Not suitable for this site", "title": "How do I make this program smaller, more efficient?", "body": "<p>I was doing a practice question that went like this:</p>\n\n<p>Write a program that asks the user to enter the number of Hamburgers eaten\nby ten different people (p1, p2, ... etc.)</p>\n\n<p>Once the data has been entered the program must analyze the data and output which person ate the least hamburgers, and outputs the person who ate the most Hamburgers. </p>\n\n<p>I know my code isn't ideal(to say the least, but I was determined to just finish it so I could have something to go off of for this question. If you're willing to help, don't be afraid to throw some more complex things at me, that's how I learn, right?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n #include &lt;string&gt; \n\nusing namespace std;\n\nint main()\n{\n    int p1 = 0;\n\n    int p2 = 0;\n\n    int p3 = 0;\n\n    int p4 = 0;\n\n    int p5 = 0;\n\n    int p6 = 0;\n\n    int p7 = 0;\n\n    int p8 = 0;\n\n    int p9 = 0;\n\n    int p10 = 0;\n\n\n    cout &lt;&lt; \"How many pancakes did p1 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p1;\n\n    cout &lt;&lt; \"How many pancakes did p2 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p2;\n\n    cout &lt;&lt; \"How many pancakes did p3 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p3;\n\n    cout &lt;&lt; \"How many pancakes did p4 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p4;\n\n    cout &lt;&lt; \"How many pancakes did p5 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p5;\n\n    cout &lt;&lt; \"How many pancakes did p6 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p6;\n\n    cout &lt;&lt; \"How many pancakes did p7 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p7;\n\n    cout &lt;&lt; \"How many pancakes did p8 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p8;\n\n    cout &lt;&lt; \"How many pancakes did p9 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p9;\n\n    cout &lt;&lt; \"How many pancakes did p10 eat?\" &lt;&lt; endl;\n    cin &gt;&gt; p10;\n\n\n    // LARGE section of if statements incoming\n\n\n    // Test to see which person ate the least pancakes\n\n    if (p1 &lt; p2 &amp;&amp; p1 &lt; p3 &amp;&amp; p1 &lt; p4 &amp;&amp; p1 &lt; p5 &amp;&amp; p1 &lt; p6 &amp;&amp; p1 &lt; p7 &amp;&amp; p1 &lt; p8 &amp;&amp; p1 &lt; p9 &amp;&amp; p1 &lt; p10)\n    {\n        cout &lt;&lt; \"p1 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p2 &lt; p1 &amp;&amp; p2 &lt; p3 &amp;&amp; p2 &lt; p4 &amp;&amp; p2 &lt; p5 &amp;&amp; p2 &lt; p6 &amp;&amp; p2 &lt; p7 &amp;&amp; p2 &lt; p8 &amp;&amp; p2 &lt; p9 &amp;&amp; p2 &lt; p10)\n    {\n        cout &lt;&lt; \"p2 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p3 &lt; p1 &amp;&amp; p3 &lt; p2 &amp;&amp; p3 &lt; p4 &amp;&amp; p3 &lt; p5 &amp;&amp; p3 &lt; p6 &amp;&amp; p3 &lt; p7 &amp;&amp; p3 &lt; p8 &amp;&amp; p3 &lt; p9 &amp;&amp; p3 &lt; p10)\n    {\n        cout &lt;&lt; \"p3 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p4 &lt; p1 &amp;&amp; p4 &lt; p2 &amp;&amp; p4 &lt; p3 &amp;&amp; p4 &lt; p5 &amp;&amp; p4 &lt; p6 &amp;&amp; p4 &lt; p7 &amp;&amp; p4 &lt; p8 &amp;&amp; p4 &lt; p9 &amp;&amp; p4 &lt; p10)\n    {\n        cout &lt;&lt; \"p4 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p5 &lt; p1 &amp;&amp; p5 &lt; p2 &amp;&amp; p5 &lt; p3 &amp;&amp; p5 &lt; p4 &amp;&amp; p5 &lt; p6 &amp;&amp; p5 &lt; p7 &amp;&amp; p5 &lt; p8 &amp;&amp; p5 &lt; p9 &amp;&amp; p5 &lt; p10)\n    {\n        cout &lt;&lt; \"p5 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p6 &lt; p1 &amp;&amp; p6 &lt; p2 &amp;&amp; p6 &lt; p3 &amp;&amp; p6 &lt; p4 &amp;&amp; p6 &lt; p5 &amp;&amp; p6 &lt; p7 &amp;&amp; p6 &lt; p8 &amp;&amp; p6 &lt; p9 &amp;&amp; p6 &lt; p10)\n    {\n        cout &lt;&lt; \"p6 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p7 &lt; p1 &amp;&amp; p7 &lt; p2 &amp;&amp; p7 &lt; p3 &amp;&amp; p7 &lt; p4 &amp;&amp; p7 &lt; p5 &amp;&amp; p7 &lt; p6 &amp;&amp; p7 &lt; p7 &amp;&amp; p7 &lt; p9 &amp;&amp; p7 &lt; p10)\n    {\n        cout &lt;&lt; \"p7 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p8 &lt; p1 &amp;&amp; p8 &lt; p2 &amp;&amp; p8 &lt; p3 &amp;&amp; p8 &lt; p4 &amp;&amp; p8 &lt; p5 &amp;&amp; p8 &lt; p6 &amp;&amp; p8 &lt; p7 &amp;&amp; p8 &lt; p9 &amp;&amp; p8 &lt; p10)\n    {\n        cout &lt;&lt; \"p8 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p9 &lt; p1 &amp;&amp; p9 &lt; p2 &amp;&amp; p9 &lt; p3 &amp;&amp; p9 &lt; p4 &amp;&amp; p9 &lt; p5 &amp;&amp; p9 &lt; p6 &amp;&amp; p9 &lt; p7 &amp;&amp; p9 &lt; p8 &amp;&amp; p9 &lt; p10)\n    {\n        cout &lt;&lt; \"p9 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p10 &lt; p1 &amp;&amp; p10 &lt; p2 &amp;&amp; p10 &lt; p3 &amp;&amp; p10 &lt; p4 &amp;&amp; p10 &lt; p5 &amp;&amp; p10 &lt; p6 &amp;&amp; p10 &lt; p7 &amp;&amp; p10 &lt; p8 &amp;&amp; p10 &lt; p9)\n    {\n        cout &lt;&lt; \"p10 ate the least pancakes.\" &lt;&lt; endl;\n    }\n\n\n    // Test to see who ate the most pancakes\n\n    if (p1 &gt; p2 &amp;&amp; p1 &gt; p3 &amp;&amp; p1 &gt; p4 &amp;&amp; p1 &gt; p5 &amp;&amp; p1 &gt; p6 &amp;&amp; p1 &gt; p7 &amp;&amp; p1 &gt; p8 &amp;&amp; p1 &gt; p9 &amp;&amp; p1 &gt; p10)\n    {\n        cout &lt;&lt; \"p1 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p2 &gt; p1 &amp;&amp; p2 &gt; p3 &amp;&amp; p2 &gt; p4 &amp;&amp; p2 &gt; p5 &amp;&amp; p2 &gt; p6 &amp;&amp; p2 &gt; p7 &amp;&amp; p2 &gt; p8 &amp;&amp; p2 &gt; p9 &amp;&amp; p2 &gt; p10)\n    {\n        cout &lt;&lt; \"p2 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p3 &gt; p1 &amp;&amp; p3 &gt; p2 &amp;&amp; p3 &gt; p4 &amp;&amp; p3 &gt; p5 &amp;&amp; p3 &gt; p6 &amp;&amp; p3 &gt; p7 &amp;&amp; p3 &gt; p8 &amp;&amp; p3 &gt; p9 &amp;&amp; p3 &gt; p10)\n    {\n        cout &lt;&lt; \"p3 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p4 &gt; p1 &amp;&amp; p4 &gt; p2 &amp;&amp; p4 &gt; p3 &amp;&amp; p4 &gt; p5 &amp;&amp; p4 &gt; p6 &amp;&amp; p4 &gt; p7 &amp;&amp; p4 &gt; p8 &amp;&amp; p4 &gt; p9 &amp;&amp; p4 &gt; p10)\n    {\n        cout &lt;&lt; \"p4 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p5 &gt; p1 &amp;&amp; p5 &gt; p2 &amp;&amp; p5 &gt; p3 &amp;&amp; p5 &gt; p4 &amp;&amp; p5 &gt; p6 &amp;&amp; p5 &gt; p7 &amp;&amp; p5 &gt; p8 &amp;&amp; p5 &gt; p9 &amp;&amp; p5 &gt; p10)\n    {\n        cout &lt;&lt; \"p5 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p6 &gt; p1 &amp;&amp; p6 &gt; p2 &amp;&amp; p6 &gt; p3 &amp;&amp; p6 &gt; p4 &amp;&amp; p6 &gt; p5 &amp;&amp; p6 &gt; p7 &amp;&amp; p6 &gt; p8 &amp;&amp; p6 &gt; p9 &amp;&amp; p6 &gt; p10)\n    {\n        cout &lt;&lt; \"p6 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p7 &gt; p1 &amp;&amp; p7 &gt; p2 &amp;&amp; p7 &gt; p3 &amp;&amp; p7 &gt; p4 &amp;&amp; p7 &gt; p5 &amp;&amp; p7 &gt; p6 &amp;&amp; p7 &gt; p7 &amp;&amp; p7 &gt; p9 &amp;&amp; p7 &gt; p10)\n    {\n        cout &lt;&lt; \"p7 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p8 &gt; p1 &amp;&amp; p8 &gt; p2 &amp;&amp; p8 &gt; p3 &amp;&amp; p8 &gt; p4 &amp;&amp; p8 &gt; p5 &amp;&amp; p8 &gt; p6 &amp;&amp; p8 &gt; p7 &amp;&amp; p8 &gt; p9 &amp;&amp; p8 &gt; p10)\n    {\n        cout &lt;&lt; \"p8 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p9 &gt; p1 &amp;&amp; p9 &gt; p2 &amp;&amp; p9 &gt; p3 &amp;&amp; p9 &gt; p4 &amp;&amp; p9 &gt; p5 &amp;&amp; p9 &gt; p6 &amp;&amp; p9 &gt; p7 &amp;&amp; p9 &gt; p8 &amp;&amp; p9 &gt; p10)\n    {\n        cout &lt;&lt; \"p9 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n    if (p10 &gt; p1 &amp;&amp; p10 &gt; p2 &amp;&amp; p10 &gt; p3 &amp;&amp; p10 &gt; p4 &amp;&amp; p10 &gt; p5 &amp;&amp; p10 &gt; p6 &amp;&amp; p10 &gt; p7 &amp;&amp; p10 &gt; p8 &amp;&amp; p10 &gt; p9)\n    {\n        cout &lt;&lt; \"p10 ate the most pancakes.\" &lt;&lt; endl;\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "box2d"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1431561445, "post_id": 30226941, "comment_id": 48557960, "body": "Why is <code>envPtr</code> likely to cause trouble? Is something going to try to delete it? Or is it going to live longer than the smart pointer that manages its life-time?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1431561903, "post_id": 30226941, "comment_id": 48558077, "body": "But the pointer will  remain valid as long as you don&#39;t delete it and as long as there exists a <code>shared_ptr</code> holding its value. If someone steals your weapon, are you going to hunt down every  <code>shared_ptr</code> and delete it?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1431562308, "post_id": 30226941, "comment_id": 48558197, "body": "Without knowing more about your architecture its impossible to say. But my gut feeling is using a raw pointer here is probably the right thing to do. However I am curious about your use of <code>shared_ptr</code> for a <code>Weapon</code>? Can two entities really be holding the same weapon at the same time?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1431562334, "post_id": 30226941, "comment_id": 48558205, "body": "No this problem is not as problematic as most people have with raw pointers. I can actually manage it kind of easily but its always nice to have a smart pointer take care of it and let the developer go full retard :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1431562548, "post_id": 30226941, "comment_id": 48558267, "body": "Well the weapon is only one out of many entities in the game which all have different functionality. For instance a crate on collision can delete the ground while another crate can spawn a coin when it collides with the ground. So for instance if two crates hit the same ground object, one will try to delete it while the other one is going to use the pointer to see what it collided with in order to spawn the coin, which might result in a crash. I&#39;m not having any problems at all so i guess the architecture is good but only wanted peoples input regarding raw pointers and shared_ptr"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "edited": false, "score": 0, "creation_date": 1431561729, "post_id": 30227036, "comment_id": 48558034, "body": "Looks like this can solve my problem. Going to experiment with it, cheers."}], "tags": [], "owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "is_accepted": true, "score": 2, "last_activity_date": 1431560794, "creation_date": 1431560794, "answer_id": 30227036, "question_id": 30226941, "link": "https://stackoverflow.com/questions/30226941/c-raw-pointer-to-shared-ptr/30227036#30227036", "title": "c++ - raw pointer to shared_ptr", "body": "<p>If <code>Environment</code> has <a href=\"http://en.cppreference.com/w/cpp/memory/enable_shared_from_this\" rel=\"nofollow\"><code>std::enable_shared_from_this</code></a><code>&lt;Environment&gt;</code> as a parent class then, yes. Just call <code>envPtr-&gt;shared_from_this()</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2946316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 1, "accepted_answer_id": 30227036, "answer_count": 1, "score": 2, "last_activity_date": 1431560794, "creation_date": 1431560165, "last_edit_date": 1431560709, "question_id": 30226941, "link": "https://stackoverflow.com/questions/30226941/c-raw-pointer-to-shared-ptr", "title": "c++ - raw pointer to shared_ptr", "body": "<p>I'm using box2d and as you already may know, it holds a void* to an object which i can use as reference when collisions occur between different entities. Problem is that the original item is saved inside a shared_ptr since the ownership is unknown and different classes (example player class) can 'equip' another class (weapon). </p>\n\n<p>I'm just wondering if its possible to put this pointer inside a shared_ptr and refer to the same object as the original one?</p>\n\n<p>This is an example:</p>\n\n<pre><code>std::vector&lt;std::shared_ptr&lt;Environment&gt;&gt; listEnvironment;\nlistEnvironment.push_back(std::make_shared(new Weapon()));\n\n//takes a void pointer\nbox2d-&gt;userId = listEnvironment.back().get();\n\n//some shit happens somewhere else and collision occurs and I get pointer back from box2d's callback:\n\nEnvironment* envPtr = static_cast&lt;Environment*&gt;(box2d-&gt;userId);\n</code></pre>\n\n<p>As you can see envPtr is going to cause trouble.\nIs there a way to refer to the old smart-pointer and increase its reference value?</p>\n\n<p>PS:</p>\n\n<p>In actuality every class creates an box2d body which holds a 'this' pointer so i don't actually have the address to the smart-pointer either. The example above is kind narrowed down to give you a hint of the problem i'm facing.</p>\n\n<p>Best regards\nnilo</p>\n"}, {"tags": ["c++", "recv", "detours"], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 0, "last_activity_date": 1431577834, "creation_date": 1431577834, "answer_id": 30229258, "question_id": 30226873, "link": "https://stackoverflow.com/questions/30226873/c-detour-on-winsock-recv-hooking-custom-packet/30229258#30229258", "title": "C++ Detour on winsock recv hooking - custom packet", "body": "<p><code>msg2</code> isn't a null-terminated string. In fact it has an interior null. So using <code>strlen()</code> and <code>strcat()</code> with it is never going to work.</p>\n\n<p>Similarly you neither know nor care what's already in <code>buf,</code> so calling <code>strcat()</code> and <code>strlen()</code> on that is both pointless and dangerous: if it contains no nulls at all you will over-run it, and at best over-report the length, and at worst crash.</p>\n\n<p>And you're not adjusting <code>ret</code> for the extra data added into the buffer.</p>\n\n<p>And no useful purpose is accomplished by declaring the unused <code>tmp[]</code> variable.</p>\n\n<p>Try this:</p>\n\n<pre><code>if (fake_recv) {                                        \n    fake_recv = false;\n    printf(\"Fake1-&gt; Length:%d Received:%d\", len, ret);\n    int len2 = min(len-ret, sizeof msg2);\n    memcpy(&amp;buf[ret], msg2, len2);\n    ret += len2;\n    printf(\"Fake2-&gt; Length:%d Received:%d\", len, ret);\n    return ret;         \n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4003233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1608d9c007ce91eaf3aa64e328854df1?s=128&d=identicon&r=PG&f=1", "display_name": "h4b00", "link": "https://stackoverflow.com/users/4003233/h4b00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 30229258, "answer_count": 1, "score": 0, "last_activity_date": 1431774142, "creation_date": 1431559840, "last_edit_date": 1431774142, "question_id": 30226873, "link": "https://stackoverflow.com/questions/30226873/c-detour-on-winsock-recv-hooking-custom-packet", "title": "C++ Detour on winsock recv hooking - custom packet", "body": "<p>I'm trying to add additional packet in <code>MyRecv</code> function, but  I don't know why it doesn't working. I tried to parse incoming packets and function works fine.\nSo probably my way to sending custom packet to application isn't properly.</p>\n\n<p>In general assumption I just want send prepared packet to application.\nThis packet i took from WPE PRO.</p>\n\n<p>Code with MyRecv function:</p>\n\n<pre><code>INT WINAPI MyRecv(SOCKET sock, CHAR* buf, INT len, INT flags) {\n  CHAR buffer[256];\n\n  char msg2[] = { 0x1B, 0, 0x04, 0x06, 0, 0x5A, 0x65, 0x6E, 0x74, 0x61,\n                  0x78, 0x06, 0, 0x5A, 0x65, 0x6E, 0x74, 0x61, 0x78, 0x05, 0x07, 0,\n                  0x66, 0x61, 0x6A, 0x6E, 0x69, 0x65, 0x65 };\n\n  int ret = precv(sock, buf, len, flags);\n  if (ret &lt;= 0) {\n    return ret;\n  }\n\n  if (fake_recv) {\n    char tmp[256];\n    fake_recv = false;\n    printf(\"Fake1-&gt; Lenght:%d Size:%d\", len, strlen(buf));\n    strcat(buf, msg2);\n    printf(\"Fake2-&gt; Lenght:%d Size:%d\", len, strlen(buf));\n    return ret;\n  }\n\n  return ret;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "function"], "comments": [{"owner": {"reputation": 1746, "user_id": 2636457, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29162c5b215ddb5b900c713c5eb2be9c?s=128&d=identicon&r=PG", "display_name": "Levi", "link": "https://stackoverflow.com/users/2636457/levi"}, "edited": false, "score": 0, "creation_date": 1431560057, "post_id": 30226865, "comment_id": 48557564, "body": "Can you give us a sample of the output?"}], "answers": [{"comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "reply_to_user": {"reputation": 13, "user_id": 4796294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b3f988c1d6f410dddbdd77a7e70233?s=128&d=identicon&r=PG&f=1", "display_name": "Gigi_Duru", "link": "https://stackoverflow.com/users/4796294/gigi-duru"}, "edited": false, "score": 0, "creation_date": 1431561629, "post_id": 30226937, "comment_id": 48558007, "body": "Be careful with changing code in your question once an answer is posted. My answer does not reflect the new code in your question. Others should note my answer is based on the <a href=\"http://stackoverflow.com/revisions/30226865/1\">original question</a>"}, {"owner": {"reputation": 13, "user_id": 4796294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b3f988c1d6f410dddbdd77a7e70233?s=128&d=identicon&r=PG&f=1", "display_name": "Gigi_Duru", "link": "https://stackoverflow.com/users/4796294/gigi-duru"}, "edited": false, "score": 0, "creation_date": 1431563510, "post_id": 30226937, "comment_id": 48558537, "body": "The function &quot;multiplier&quot; is still there. I just added the rest of the code."}], "tags": [], "owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "is_accepted": true, "score": 0, "last_activity_date": 1431560145, "creation_date": 1431560145, "answer_id": 30226937, "question_id": 30226865, "link": "https://stackoverflow.com/questions/30226865/function-to-multiply-2-arrays/30226937#30226937", "title": "Function to multiply 2 arrays", "body": "<p><code>k</code> never gets incremented, so you keep storing the value of the multiplied arrays in the first element of <code>array_result</code>. You could try:</p>\n\n<p><code>array_result[k++] = array11[i] * array22[j];</code></p>\n\n<p>That will use the value of <code>k</code> and then increment it afterwards. You should also consider default-initialising your <code>array_result</code> like so:</p>\n\n<p><code>int array_result[dim3] = {}; // initialise all values to 0</code></p>\n\n<p>That would mean you wouldn't get random numbers and you'd see all numbers but the first were 0.</p>\n"}], "owner": {"reputation": 13, "user_id": 4796294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b3f988c1d6f410dddbdd77a7e70233?s=128&d=identicon&r=PG&f=1", "display_name": "Gigi_Duru", "link": "https://stackoverflow.com/users/4796294/gigi-duru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 30226937, "answer_count": 1, "score": 1, "last_activity_date": 1431561491, "creation_date": 1431559826, "last_edit_date": 1431561491, "question_id": 30226865, "link": "https://stackoverflow.com/questions/30226865/function-to-multiply-2-arrays", "title": "Function to multiply 2 arrays", "body": "<p>I need to make a function that multiplies 2 arrays and puts the result in a third array that I will print using another \"print function\".\nSo If I input array11: 5, 10, 20; and array22: 1, 2; I should get this result:\nresult_array:5, 10, 10, 20, 20, 40. So each element from the first array is multiplied with each element from the second array and stored in a third array.</p>\n\n<p>But I don't get the expected result. Instead I get some random numbers.\nCan you help me figure out what am I doing wrong?</p>\n\n<ul>\n<li><code>array11</code> and <code>array22</code> are the first 2 arrays</li>\n<li><code>array_result</code> is the resulting array</li>\n<li><code>dim1</code> and <code>dim2</code> are the dimensions of the first 2 arrays</li>\n<li><p><code>dim3</code> is the dimension of the third array which is calculated outside the\nfunction like this: </p>\n\n<pre><code>dim3 = dim1 * dim2;\n</code></pre></li>\n</ul>\n\n\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nvoid remplir(int array[], int dim);\nvoid aficher(int array[], int dim);\nvoid multiplier(int array11[], int array22[], int dim1, int dim2, int dim3);\n\nint main() {\nint dim1 = 0, dim2 = 0, dim3;\ncout &lt;&lt; \"La dimension de la 1ere table?\" &lt;&lt; endl;\ncin &gt;&gt; dim1;\nwhile (dim1 &gt; 20) {\n    cout &lt;&lt; \"La dimension maximum est 20! Reessayez!\" &lt;&lt; endl;\n    cin &gt;&gt; dim1;\n\n}\nint array1[dim1];\nremplir(array1, dim1);\naficher(array1, dim1);\n\ncout &lt;&lt; \"La dimension de la 2eme table?\" &lt;&lt; endl;\ncin &gt;&gt; dim2;\nwhile (dim2 &gt; 20) {\n    cout &lt;&lt; \"La dimension maximum est 20! Reessayez!\" &lt;&lt; endl;\n    cin &gt;&gt; dim2;\n\n}\nint array2[dim2];\nremplir(array2, dim2);\naficher(array2, dim2);\ncout&lt;&lt;\"////////////////////////////////////////////////////////\"&lt;&lt;endl;\n\ndim3 = dim1 * dim2;\nmultiplier(array1, array2, dim1, dim2, dim3);\ncout &lt;&lt; \"dim3 = \" &lt;&lt; dim3 &lt;&lt; endl;\nreturn 0;\n\n}\n\nvoid remplir(int array[], int dim) {\nint i = 0;\nfor (i = 0; i &lt; dim; i = i + 1) {\n    cout &lt;&lt; \"Entrez la case numero \" &lt;&lt; i &lt;&lt; endl;\n    cin &gt;&gt; array[i];\n\n}\n}\nvoid aficher(int array[], int dim) {\nint i = 0;\nfor (i = 0; i &lt; dim; i = i + 1) {\n    cout &lt;&lt; \"indice \" &lt;&lt; i &lt;&lt; \" = \" &lt;&lt; array[i] &lt;&lt; endl;\n\n}\n}\n\nvoid multiplier(int array11[], int array22[], int dim1, int dim2, int dim3) {\nint i, j, k = 0;\nint resultat[dim3]; //resulting array\nfor (i = 0; i &lt;= dim1 - 1; i = i + 1) {\n    for (j = 0; j &lt;= dim2 - 1; j = j + 1) {\n        resultat[k++] = array11[i] * array22[j];\n    }\n}\naficher(resultat, dim3); //function that prints the resulting array\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "object", "struct"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 3, "creation_date": 1431559473, "post_id": 30226770, "comment_id": 48557408, "body": "It might help to show an example of what you&#39;re looking at.  Is this a collection of plain old data or something else?  <code>struct</code> and <code>class</code> are really the same thing with different default permissions."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1431560166, "post_id": 30226770, "comment_id": 48557599, "body": "@RetiredNinja: <code>class</code> and <code>struct</code> are essentially the same in C++, but certainly not in C.  You could not pass a polymorphic C++ class object to C code that is expecting a flat C-style struct, the layouts would not match.  So outside of trivial cases, there is likely going to need some conversions made from one to the other.  But you are right, we need an example of the OP&#39;s use case."}], "answers": [{"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 2, "last_activity_date": 1431561299, "creation_date": 1431561299, "answer_id": 30227106, "question_id": 30226770, "link": "https://stackoverflow.com/questions/30226770/best-way-to-convert-c-object-c-struct/30227106#30227106", "title": "Best way to convert C++ object &lt;--&gt; C struct?", "body": "<p>Use <code>extern \"C\"</code> to declare your C structures:</p>\n\n<pre><code>extern \"C\" {\n    struct some_c_struct {\n        int field1;\n        char *p;\n    };\n};\n</code></pre>\n\n<p>Then, in your C++ code you can use <code>some_c_struct</code> just like any other C++ <code>class</code> or <code>struct</code>, with guaranteed C compatibility, and successfully pass them to and from the C code library that you're using.</p>\n\n<p>Practically speaking, the <code>extern \"C\"</code> declaration isn't needed, but all the language lawyers demand it. Additionally, your struct cannot use any C++-specific features, like virtual functions.</p>\n"}], "owner": {"reputation": 1135, "user_id": 2676680, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a81470e51785d066f1c490330cd847a5?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Darnell", "link": "https://stackoverflow.com/users/2676680/matthew-darnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1431608635, "creation_date": 1431559242, "question_id": 30226770, "link": "https://stackoverflow.com/questions/30226770/best-way-to-convert-c-object-c-struct", "title": "Best way to convert C++ object &lt;--&gt; C struct?", "body": "<p>So basically I am trying to integrate a custom C library into an existing C++ project. I have various C++ objects that will need to be stored/loaded into a C DB and interface with various C functions. I need to convert my C++ objects into C structs, and back again. I have made progress, but am running into memory allocation issues.</p>\n\n<p>I know I haven't included any code here, but I am just wondering if there are any general tips for this task? I have seen the void* used in extern \"C\" for generic C++ objects, but I really need to load/save data from/to C++ objects and C structs.</p>\n\n<p>If I haven't worded this correctly, please ask!</p>\n"}, {"tags": ["c++", "memory-management", "vector"], "comments": [{"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1431559365, "post_id": 30226750, "comment_id": 48557376, "body": "Most standard libraries allocate big blocks of memory from the OS, then break them into little pieces to satisfy allocation requests from the program. Most only release those big blocks back to the OS when the program exits, or (possibly) when you call some special, internal function to tell them to release memory if they can (e.g., <code>_heapmin()</code> with Microsoft compilers)."}, {"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "reply_to_user": {"reputation": 12989, "user_id": 2994596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YU9Zw.png?s=128&g=1", "display_name": "SleuthEye", "link": "https://stackoverflow.com/users/2994596/sleutheye"}, "edited": false, "score": 0, "creation_date": 1431559703, "post_id": 30226750, "comment_id": 48557465, "body": "@SleuthEye the custom data type is the dynamic bitset from Boost."}, {"owner": {"reputation": 12989, "user_id": 2994596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YU9Zw.png?s=128&g=1", "display_name": "SleuthEye", "link": "https://stackoverflow.com/users/2994596/sleutheye"}, "edited": false, "score": 0, "creation_date": 1431560065, "post_id": 30226750, "comment_id": 48557566, "body": "note that according to <a href=\"http://en.cppreference.com/w/cpp/container/vector/shrink_to_fit\" rel=\"nofollow noreferrer\">cppreference</a>: <code>shrink_to_fit</code> &quot;... is a non-binding request to reduce capacity() to size(). It depends on the implementation if the request is fulfilled&quot;. See also <a href=\"http://stackoverflow.com/q/23502291/2994596\">this related question</a>"}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431561152, "post_id": 30226750, "comment_id": 48557883, "body": "see <a href=\"http://stackoverflow.com/questions/1119134/how-do-malloc-and-free-work\" title=\"how do malloc and free work\">stackoverflow.com/questions/1119134/how-do-malloc-and-free-w&zwnj;&#8203;ork</a> <code>new</code> and <code>delete</code> (which are what <code>std::vector</code> most likely uses internally) are usually implemented by calling <code>malloc</code> and <code>free</code>"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1431562427, "post_id": 30226750, "comment_id": 48558233, "body": "Doing a bit of looking, it appears gcc does release free memory back to the OS if there&#39;s enough of it. It looks like <a href=\"http://man7.org/linux/man-pages/man3/mallopt.3.html\" rel=\"nofollow noreferrer\"><code>mallopt(M_TRIM_THRESHOLD, ...</code></a> should let you adjust that threshold low enough to get it to at least try to release extra memory back to the OS when desired (but be aware that messing with this is probably a poor idea for most code/circumstances)."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431563043, "post_id": 30226750, "comment_id": 48558413, "body": "You could adapt the allocator <a href=\"http://stackoverflow.com/a/11703840/315052\">in this answer</a> and change the arena&#39;s allocate and deallocate functions to directly call <code>mmap()</code> and <code>munmap()</code>."}], "owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431559660, "creation_date": 1431559067, "last_edit_date": 1431559660, "question_id": 30226750, "link": "https://stackoverflow.com/questions/30226750/c-empty-vector-swap-and-shrink-to-fit-dont-release-memory-of-vector", "title": "C++ : Empty vector swap and shrink_to_fit() don&#39;t release memory of vector", "body": "<p>My code is something like this. The vector in question is a vector of <code>dynamic bitset</code> from the boost library:  </p>\n\n<pre><code>while(someCondition){\n      vector&lt;dynamic_bitset&lt;&gt; &gt; myvector;  \n      //some code here\n      myvector.push_back(dynamic_bitset&lt;&gt; x) ;\n      //some more code\n\n      //myvector use is over now, release it.\n      myvector.clear();\n      myvector.shrink_to_fit();\n      //or swap myvector with empty vector\n}  \n</code></pre>\n\n<p>As above, <code>myvector</code> is created and cleared every iteration of the while loop. I'm analyzing the memory usage of this code by running it in GDB, and in parallel, looking at the memory consumption displayed by the <code>top</code> command. (There are reasons I can't use valgrind).  </p>\n\n<p>I can see that when I <code>push_back</code> new elements into <code>myvector</code> the memory usage percentage for this program goes up in the <code>top</code> command output. However, when I clear the vector and shrink it (or even if I swap it with empty vector), the usage percentage under <code>top</code> doesn't lower. So, in every iteration of the loop the memory usage keeps increasing and eventually uses up most of the RAM.  </p>\n\n<p>How do I prevent this from happening? I'd like the memory of the vector to be released back to the OS every iteration of the <code>while</code> loop. Perhaps, <code>top</code> is not the right way to analyze memory but I've no other option. Any ideas?</p>\n"}, {"tags": ["c++", "pointers", "visual-studio-2013", "lvalue", "unmodifiable"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1431558658, "post_id": 30226655, "comment_id": 48557202, "body": "Show us the declaration of <code>getNode</code>, at least."}], "answers": [{"comments": [{"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1431574833, "post_id": 30227773, "comment_id": 48561168, "body": "I agree with your answer, it was a while ago that I had to learn that same struggle, when I was new to and learning c++! The good thing is once you understand what is happening behind the scenes and know what to look for it eventually gets easier to work with. The only thing I struggle with in c++ anymore is when templates become complex when multiple inheritance &amp; specialization comes into play. I&#39;m not doing to bad for being self taught :)"}], "tags": [], "owner": {"reputation": 4212, "user_id": 4892076, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/s6vwT.png?s=128&g=1", "display_name": "jaggedSpire", "link": "https://stackoverflow.com/users/4892076/jaggedspire"}, "is_accepted": false, "score": 2, "last_activity_date": 1431566452, "creation_date": 1431566452, "answer_id": 30227773, "question_id": 30226655, "link": "https://stackoverflow.com/questions/30226655/pointer-being-treated-as-an-unmodifiable-lvalue-in-visual-studio-2013/30227773#30227773", "title": "Pointer being treated as an unmodifiable lvalue in Visual Studio 2013", "body": "<p>The return type of your function should be a reference type--otherwise you're telling the compiler to copy construct an object from the value you're returning, and use that as the return value.  </p>\n\n<p>I've written an example, which can be found <a href=\"http://coliru.stacked-crooked.com/a/e507c994814e575e\" rel=\"nofollow\">here</a>. It constructs a vector to pass in to the getting function for simplicity's sake, which returns a dereferenced pointer to one of the component objects. If you examine the output of the program, it will merrily inform you that it is copy constructing the value, not getting a reference to it--any changes you make to a node 'retrieved' from the <code>getNode</code> function will be made to a node copy-constructed from the node you want.</p>\n\n<p>I suspect this is also why you're getting an issue with non-modifiable lvalues, since you're attempting to assign values to temporary variables.</p>\n\n<p>tl;dr:<br>\nYour <code>getNode</code> function is returning a temporary object. Make it return a reference, instead.</p>\n"}], "owner": {"reputation": 13, "user_id": 4897717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23dd2f4a81cd19ce03be25f4e63a192e?s=128&d=identicon&r=PG&f=1", "display_name": "Keith Larson", "link": "https://stackoverflow.com/users/4897717/keith-larson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431566452, "creation_date": 1431558451, "last_edit_date": 1431559380, "question_id": 30226655, "link": "https://stackoverflow.com/questions/30226655/pointer-being-treated-as-an-unmodifiable-lvalue-in-visual-studio-2013", "title": "Pointer being treated as an unmodifiable lvalue in Visual Studio 2013", "body": "<p>getNode():</p>\n\n<pre><code>    Node&lt;type&gt; getNode(int position) {\n        Node&lt;type&gt; *item = head;\n        for (int i = 0; i &lt; position; ++i) {\n            item = item-&gt;next;\n        }\n        return *item;\n    };\n</code></pre>\n\n<p>Node Swapping Code:</p>\n\n<pre><code>        Node&lt;Guitar*&gt; temp;\n        temp.element = list.getNode(l).element;\n        temp.next = list.getNode(l).next;\n        list.getNode(l).element = list.getNode(h).element;\n        list.getNode(l).next = list.getNode(h).next;\n        list.getNode(h).element = temp.element;\n        list.getNode(h).next = temp.next;\n</code></pre>\n\n<p>I am working on a project for my computer science class and it is due in a couple of days. I want to sort a linked list using quicksort which is fairly simple, but I have been struggling with a strange issue while swapping nodes in the list. For reference, the getNode() function returns a node at a certain index in the list and the nodes hold a pointer to a guitar object along with the a next node pointer. I have been experimenting for hours now and I figured out that the line such as this, \"list.getNode(h).element = temp.element;\" is saying that the pointer to a guitar object in a node in the list is being assigned the value of the pointer in the temp object. This would normally work but I get an error at this point saying that the left side is not a modifiable lvalue. However I could make a pointer and put it on the left side of the assignment operator without any errors. Also, the left hand side has no error when I use the dereferencing operator (*) in front, but this does not successfully swap the nodes. I must be missing something.</p>\n"}, {"tags": ["c++", "string", "templates", "c++11", "variadic-templates"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1431557330, "post_id": 30226373, "comment_id": 48556824, "body": "Name lookup problems. In particular, when the first (general) variadic version is defined, the later two overloads are not in scope, and unqualified lookup for <code>c</code> will not consider them. Declare them all, and then define them."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1431557657, "post_id": 30226373, "comment_id": 48556920, "body": "Incidentally, the single-argument version for <code>String</code> and <code>const char *</code> should not be specializations."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3995702"}, "edited": false, "score": 0, "creation_date": 1431558653, "post_id": 30226600, "comment_id": 48557200, "body": "That fixed the issue. You&#39;re right about the single argument ones as well, I think I was stuck in the template mindset and failed to realize those weren&#39;t quite right. Thanks a lot, it makes sense and works properly now."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 4, "last_activity_date": 1431558127, "creation_date": 1431558127, "answer_id": 30226600, "question_id": 30226373, "link": "https://stackoverflow.com/questions/30226373/variadic-template-function-name-lookup-fails-to-find-specializations/30226600#30226600", "title": "Variadic template function name lookup fails to find specializations", "body": "<p>In</p>\n\n<pre><code>template&lt;typename T, typename... Args&gt;\ninline String c(T a, Args... args)\n{\n    return Ogre::StringConverter::toString( a ) + c(args...);\n}\n</code></pre>\n\n<p>unqualified name lookup for <code>c</code> in <code>c(args...)</code> is performed in the template definition context, which means that it only finds overloads of <code>c</code> declared up to this point, and will not find your later <code>c</code> overloads. (ADL is performed using both the definition and the instantiation contexts, but in your case it looks like there's no ADL.)</p>\n\n<p>Declare them all first:</p>\n\n<pre><code>template&lt;typename T, typename... Args&gt;\ninline String c(T a, Args... args);\ntemplate&lt;typename... Args&gt;\ninline String c(String s, Args... args);\ntemplate&lt;typename... Args&gt;\ninline String c( const char s[], Args... args);\n</code></pre>\n\n<p>before you define them, so that all three overloads can be found.</p>\n\n<hr>\n\n<p>Incidentally, you should not use specializations for the single-argument case. Delete the <code>template&lt;&gt;</code> and use overloads instead. As written right now, <code>U::c(\"\");</code> will not behave the way you want it to.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/1d4725640d1bae9a\" rel=\"nofollow noreferrer\">Demo</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3995702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 30226600, "answer_count": 1, "score": 3, "last_activity_date": 1431563572, "creation_date": 1431556683, "last_edit_date": 1495542815, "question_id": 30226373, "link": "https://stackoverflow.com/questions/30226373/variadic-template-function-name-lookup-fails-to-find-specializations", "title": "Variadic template function name lookup fails to find specializations", "body": "<p>I am attempting to program a string concatenation function which utilizes my 3D library's string conversion functions, implemented with a variadic template.</p>\n\n<p>The library's conversion function behaves unusually if a string (either const char[] literal or std::string) is passed to it. as it does not actually possess functions for those types, so I want to specialize the template to pull those out and not run them through the converter. Optimization would be a good reason even if the converter handled them.</p>\n\n<pre><code>template&lt;typename T&gt;\ninline String c(T a)\n{\n    return Ogre::StringConverter::toString( a );\n}\ntemplate&lt;&gt;\ninline String c(String s)\n{\n    return s;\n}\ntemplate&lt;&gt;\ninline String c(const char s[])\n{\n    return s;\n}\n\ntemplate&lt;typename T, typename... Args&gt;\ninline String c(T a, Args... args)\n{\n    return Ogre::StringConverter::toString( a ) + c(args...);\n}\ntemplate&lt;typename... Args&gt;\ninline String c(String s, Args... args)\n{\n    return s + c(args...);\n}\ntemplate&lt;typename... Args&gt;\ninline String c( const char s[], Args... args)\n{\n    return s + c(args...);\n}\n</code></pre>\n\n<p>However, when I compile my program, string literals sometimes fall through the const char[] specialization and are handled by the base, unspecialized template. The command:</p>\n\n<pre><code>U::c( \"This is dMap[500][500]: \", dMap[500][500], \" and this is 5: \", 5, \".\" )\n</code></pre>\n\n<p>returns</p>\n\n<blockquote>\n  <p>This is dMap[500][500]: 112true5.</p>\n</blockquote>\n\n<p>\"true\" being what toString returns if a string literal is passed to it. Debugging confirms that the second string literal is caught by the generic <code>String c(T a, Args... args)</code>, but not the first or third, which are handled by the specialization.</p>\n\n<p>This seems related to the problem mentioned in <a href=\"https://stackoverflow.com/questions/28265984/selecting-string-literal-type-for-template-specialization\">Selecting string literal type for template specialization</a>, but changing my template parameter declaration match those suggested in that solution, <code>inline String c( const char (&amp;s) [N], Args... args )</code>, cause the first parameter to be caught by the specialized template, but not the second or third. Something unusual is happening here and I cannot figure out what it is.</p>\n"}, {"tags": ["c++", "class", "object", "initialization"], "comments": [{"owner": {"reputation": 8582, "user_id": 439751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4b40ae065359026d01fa30223812d83?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/439751/james"}, "edited": false, "score": 1, "creation_date": 1431556376, "post_id": 30226284, "comment_id": 48556540, "body": "Yes that is a memory leak"}, {"owner": {"reputation": 1027, "user_id": 3163389, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sRjPz.jpg?s=128&g=1", "display_name": "moonwalker", "link": "https://stackoverflow.com/users/3163389/moonwalker"}, "edited": false, "score": 0, "creation_date": 1431557348, "post_id": 30226284, "comment_id": 48556834, "body": "use <code>m_animal-&gt;name</code> rather than <code>m_animal.name</code> because its a pointer."}], "answers": [{"comments": [{"owner": {"reputation": 8582, "user_id": 439751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4b40ae065359026d01fa30223812d83?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/439751/james"}, "edited": false, "score": 2, "creation_date": 1431556495, "post_id": 30226324, "comment_id": 48556574, "body": "You should set m_animal to nullptr/NULL after the delete or you could end up in a double delete situation. The OP should probably use shared_ptr."}, {"owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "reply_to_user": {"reputation": 8582, "user_id": 439751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4b40ae065359026d01fa30223812d83?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/439751/james"}, "edited": false, "score": 4, "creation_date": 1431556562, "post_id": 30226324, "comment_id": 48556594, "body": "@James: There is no problem with the code as I have given it; in this case <code>m_animal</code> is assigned a new value immediately after the <code>delete</code>. However, if you&#39;re not going to give the pointer a new value straight away, then yes it would be useful to assign <code>NULL</code>."}, {"owner": {"reputation": 663, "user_id": 2195567, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/33159b8791121aae132909022eef3954?s=128&d=identicon&r=PG", "display_name": "Ricky", "link": "https://stackoverflow.com/users/2195567/ricky"}, "edited": false, "score": 0, "creation_date": 1431557542, "post_id": 30226324, "comment_id": 48556894, "body": "Worked great, only question I have now is... \t So in my about example, when I create a new animal from m_animal2... If I no longer use m_animal2, do I have to use delete m_animal2?"}, {"owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "reply_to_user": {"reputation": 663, "user_id": 2195567, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/33159b8791121aae132909022eef3954?s=128&d=identicon&r=PG", "display_name": "Ricky", "link": "https://stackoverflow.com/users/2195567/ricky"}, "edited": false, "score": 0, "creation_date": 1431557778, "post_id": 30226324, "comment_id": 48556953, "body": "@Ricky: That depends. Do you want to keep <code>m_animal2</code> around for any reason? If not, then you can delete it. Your copy constructor makes a <i>copy</i> of the name, and doesn&#39;t keep a reference to the copied object. (Also, I think you&#39;d have to use <code>new Animal(*m_animal2)</code> to properly invoke the copy constructor without a compile error.)"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1431558257, "post_id": 30226324, "comment_id": 48557093, "body": "@GregHewgill If the <code>new</code> throws, though, you may get a double delete."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431560439, "post_id": 30226324, "comment_id": 48557672, "body": "@GregHewgill: if you <code>delete</code> a pointer and not set it to NULL right away, then go to <code>new</code> an assignment to that pointer and <code>new</code> throws, the pointer will be left with its original <code>delete</code>d value.  Later code could then check the pointer and try to <code>delete</code> it again, thus the double-delete issue. So, if you are going to use raw <code>new</code>/<code>delete</code> calls, you should use <code>delete m_animal; m_animal = NULL; m_animal = new Animal(...);</code> as a safety catch against <code>new</code> failing."}, {"owner": {"reputation": 8582, "user_id": 439751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4b40ae065359026d01fa30223812d83?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/439751/james"}, "edited": false, "score": 0, "creation_date": 1431562104, "post_id": 30226324, "comment_id": 48558139, "body": "@GregHewgill as others have pointed this may not be exception safe. There is a problem"}, {"owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "edited": false, "score": 2, "creation_date": 1431562444, "post_id": 30226324, "comment_id": 48558238, "body": "In the OP&#39;s example code, there is no <code>try</code> block and the pointers are declared in the same scope as the <code>new</code>/<code>delete</code>. As such, there is no possibility of exception handling causing a double delete, because by the time any exception is caught, the pointer in question is well out of scope. Having said that, yes, of course you&#39;re all correct, the addition of exception handling does require additional considerations to be applied to code construction. Similarly, so do multithreading and shared memory, two other things that could invalidate my example. But those aren&#39;t part of the question."}], "tags": [], "owner": {"reputation": 821764, "user_id": 893, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/747ffa5da3538e66840ebc0548b8fd58?s=128&d=identicon&r=PG", "display_name": "Greg Hewgill", "link": "https://stackoverflow.com/users/893/greg-hewgill"}, "is_accepted": true, "score": 4, "last_activity_date": 1431556391, "creation_date": 1431556391, "answer_id": 30226324, "question_id": 30226284, "link": "https://stackoverflow.com/questions/30226284/how-do-i-un-initialize-an-object-in-c/30226324#30226324", "title": "How do I un-initialize an object in C++?", "body": "<p>You <em>do</em> want to use <code>delete m_animal;</code>. You can do this:</p>\n\n<pre><code>std::cout &lt;&lt; m_animal.name &lt;&lt; endl;\ndelete m_animal;\nm_animal = new Animal(m_animal2);\nstd::cout &lt;&lt; m_animal.name &lt;&lt; endl;\n</code></pre>\n\n<p>After calling <code>delete m_animal</code>, you can no longer use <em>what <code>m_animal</code> pointed to</em>, but you can certainly use the <code>m_animal</code> pointer again.</p>\n"}, {"comments": [{"owner": {"reputation": 663, "user_id": 2195567, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/33159b8791121aae132909022eef3954?s=128&d=identicon&r=PG", "display_name": "Ricky", "link": "https://stackoverflow.com/users/2195567/ricky"}, "edited": false, "score": 0, "creation_date": 1431557500, "post_id": 30226378, "comment_id": 48556884, "body": "So in my about example, when I create a new animal from m_animal2... If I no longer use m_animal2, do I have to use delete m_animal2?"}, {"owner": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "reply_to_user": {"reputation": 663, "user_id": 2195567, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/33159b8791121aae132909022eef3954?s=128&d=identicon&r=PG", "display_name": "Ricky", "link": "https://stackoverflow.com/users/2195567/ricky"}, "edited": false, "score": 0, "creation_date": 1431557781, "post_id": 30226378, "comment_id": 48556955, "body": "Yes, when you don&#39;t want to use any more use need to delete it."}], "tags": [], "owner": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1431556701, "creation_date": 1431556701, "answer_id": 30226378, "question_id": 30226284, "link": "https://stackoverflow.com/questions/30226284/how-do-i-un-initialize-an-object-in-c/30226378#30226378", "title": "How do I un-initialize an object in C++?", "body": "<p>If you create an object with the <code>new</code> operator, then you need to delete it with the <code>delete</code> operator.</p>\n\n<pre><code>Animal* animal = new Animal( \"Pig\" );\n\n// Using the animal ...\n\ndelete animal;\nanimal = nullptr;\n</code></pre>\n\n<p>You need to use the <code>new</code> - <code>delete</code> pair to avoid memory leaks.</p>\n"}, {"comments": [{"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1431571171, "post_id": 30226696, "comment_id": 48560345, "body": "My bad - I did not read your paragraph 1 properly ... sorry about the duplicate answer.  +1 Great minds and all that."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1431585281, "post_id": 30226696, "comment_id": 48564585, "body": "But if you choose to use this method, remember that you must not have given the object anywhere else, since reusing the object for another animal will also change the object that is pointed to elsewhere. So especially as a beginner it might be better to just use new objects every time."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 2, "last_activity_date": 1431558754, "creation_date": 1431558754, "answer_id": 30226696, "question_id": 30226284, "link": "https://stackoverflow.com/questions/30226284/how-do-i-un-initialize-an-object-in-c/30226696#30226696", "title": "How do I un-initialize an object in C++?", "body": "<p>You could just add a <code>clear</code> member function that (for example) sets the name to an empty string. This means \"Leroy\" no longer exists, but an <code>Animal</code> in a valid state exists, so you can use it to hold some other animal without deleting the old one and allocating a new one.</p>\n\n<p>This, however, still leaves an Animal object--just one that doesn't have a name. If you want to separate allocation from creation/destruction of the objects in the memory, you can allocate raw memory with <code>operator new</code>, then use a placement new to create an object in that memory. When you want to destroy the object, you can directly invoke its destructor, which will truly destroy the object (but leave the memory allocated).</p>\n\n<p>When you're done with the memory, you can use <code>operator delete</code> to delete the memory.</p>\n\n<p>Aside: this is pretty much what <code>std::vector</code>, for one example, does with its memory block. While it's probably <em>more</em> useful when you're dealing with multiple objects, there's nothing particularly wrong with doing it for a single object either.</p>\n\n<p>Aside #2: in most cases, you don't need (or really want) to use <code>new</code> or <code>delete</code> directly as you've shown above. In quite a few cases, you can use an <code>std::shared_ptr</code> or <code>std::unique_ptr</code> instead, with <code>std::make_shared</code> or <code>std::make_unique</code> to allocate the object.</p>\n"}, {"tags": [], "owner": {"reputation": 1027, "user_id": 3163389, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sRjPz.jpg?s=128&g=1", "display_name": "moonwalker", "link": "https://stackoverflow.com/users/3163389/moonwalker"}, "is_accepted": false, "score": 0, "last_activity_date": 1431558825, "creation_date": 1431558825, "answer_id": 30226709, "question_id": 30226284, "link": "https://stackoverflow.com/questions/30226284/how-do-i-un-initialize-an-object-in-c/30226709#30226709", "title": "How do I un-initialize an object in C++?", "body": "<p>Since these two are pointers to Animal class. This should work too:</p>\n\n<pre><code>std::cout &lt;&lt; m_animal-&gt;name &lt;&lt; endl;\nm_animal = m_animal2;\nstd::cout &lt;&lt; m_animal-&gt;name &lt;&lt; endl;\n</code></pre>\n\n<p>No need to allocate memory for an animal third time, even if one of them gets deleted before, its inefficient code. Then you should delete only one of these pointers and set them both to <code>nullptr</code>. Using an <code>std::shared_ptr</code> may be a more robust solution though.</p>\n"}, {"tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 1, "last_activity_date": 1431703205, "last_edit_date": 1431703205, "creation_date": 1431560430, "answer_id": 30226990, "question_id": 30226284, "link": "https://stackoverflow.com/questions/30226284/how-do-i-un-initialize-an-object-in-c/30226990#30226990", "title": "How do I un-initialize an object in C++?", "body": "<p>Sometimes (but not for this mcve), it is simpler to use an init() method.</p>\n\n<p>Though I prefer the initialization list such as you have used here (after the ctor), you will sometimes run into system start up sequence options where the ctor parameter is <em>not</em> yet available and thus can not be filled in by the ctor. This is a particular problem when two or more instances (of same or different class) have pointers to the other (as in working and protect hw control)</p>\n\n<p>So, you might consider the following, which solves sequencing and mutual dependency challenges by providing an  init() method. </p>\n\n<pre><code>class Animal\n{\npublic:\n    Animal()\n    {\n        init(\"New Animal\")\n    }\n\n    Animal(const std::string name)\n    {\n        init(name);\n    }\n\n    Animal(const Animal&amp; animal)\n    {\n        init(animal.m_name); \n    }\n\n    void init(std::string name)\n    {\n       m_name.erase(); // clear the previous attribute \n       //           (not really needed here, but included for clarity)\n       m_name = name;  // fill in new attribute \n\n       // and continue with both clear (when needed) and init's \n       // of all the other data attributes \n       // in an order similar to the initialization list.\n       // note that the compiler won't be able to notify you\n       // of out of order initialization issues.\n   }\n\nprivate:\n    const std::string name;\n};\n</code></pre>\n\n<hr>\n\n<p>So, is init() good for anything else?  </p>\n\n<p>You asked </p>\n\n<blockquote>\n  <p>how do I un-initialize an object.</p>\n</blockquote>\n\n<p>In this case, you can simply use \"init(...)\" to simultaneously </p>\n\n<p>a) clear out the previous state info (when necessary)</p>\n\n<p>b) initialize the state info as if newly created</p>\n\n<p>and</p>\n\n<p>c) <strong>avoid</strong> the relatively costly delete and new of the other approach.</p>\n"}], "owner": {"reputation": 663, "user_id": 2195567, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/33159b8791121aae132909022eef3954?s=128&d=identicon&r=PG", "display_name": "Ricky", "link": "https://stackoverflow.com/users/2195567/ricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 30226324, "answer_count": 5, "score": 0, "last_activity_date": 1431878541, "creation_date": 1431556201, "last_edit_date": 1431878541, "question_id": 30226284, "link": "https://stackoverflow.com/questions/30226284/how-do-i-un-initialize-an-object-in-c", "title": "How do I un-initialize an object in C++?", "body": "<p>I'm not 100% certain I worded the title for this right so here's what I want to be able to do...</p>\n\n<p>I have a class that gets defined like so...</p>\n\n<pre><code>class Animal\n{\npublic:\n    Animal() : m_name(\"New Animal\")\n    {\n    }\n\n    Animal(const std::string&amp; name) : m_name(name)\n    {\n    }\n\n    Animal(const Animal&amp; animal) : m_name(animal.name)\n    {\n    }\n\nprivate:\n    const std::string name;\n};\n</code></pre>\n\n<p>I then initialize an object of this class like so...</p>\n\n<pre><code>Animal* m_animal = new Animal(\"Leroy\");\n</code></pre>\n\n<p>At some point in my program, the user will click a button that will cause m_animal to become empty. Meaning that the pet named Leroy should not longer exist..</p>\n\n<p>I assumed I could use delete m_animal, but once I call this I can no longer use m_animal without causing a memory allocation error.</p>\n\n<p>So I guess my question is...\nWould me using the following code cause a memory leak since the pet named Leroy was not deleted... and if so what are alternatives on how to get this done?</p>\n\n<pre><code>m_pet = NULL;\n</code></pre>\n\n<p>The entire process would look like this...</p>\n\n<pre><code>Animal* m_animal = new Animal(\"Leroy\");\nAnimal* m_animal2 = new Animal(\"Boo\");\nstd::cout &lt;&lt; m_animal.name &lt;&lt; endl;\nm_animal = NULL;\nm_animal = new Animal(m_animal2);\nstd::cout &lt;&lt; m_animal.name &lt;&lt; endl;\n</code></pre>\n"}, {"tags": ["c++", "string", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 4397, "user_id": 539285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a5509c378b4bb7a2795d958a3b45fdee?s=128&d=identicon&r=PG", "display_name": "Ilyssis", "link": "https://stackoverflow.com/users/539285/ilyssis"}, "edited": false, "score": 0, "creation_date": 1431592321, "post_id": 30226445, "comment_id": 48567968, "body": "Thx for the vector solution!"}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 3, "last_activity_date": 1431557796, "last_edit_date": 1431557796, "creation_date": 1431557102, "answer_id": 30226445, "question_id": 30226253, "link": "https://stackoverflow.com/questions/30226253/c-multidimensional-string-array-initialization-stdmap/30226445#30226445", "title": "C++ Multidimensional string array initialization (std::map)", "body": "<p>If the integers acting as keys in the internal map are going to be contiguous, you could just use a vector instead:</p>\n\n<pre><code>std::map&lt;std::string, std::vector&lt;std::string&gt;&gt; oParam;\n</code></pre>\n\n<p>With that, the initialization you've given should work.</p>\n\n<p>If you continue to use a <code>std::map</code> instead, you'll have to do a couple of things. First, it supports sparse keys, so you'll need to specify the key for each string you want to insert. Second, you'll need to enclose all the items to insert into one map in braces, something like this:</p>\n\n<pre><code>std::map&lt;std::string, std::map&lt;int, std::string&gt;&gt; oParam {\n    { \"pA\", { { 0, \"a\" }, { 1, \"b\" }, { 2, \"c\" } } },\n    { \"pB\", { { 0, \"x\" }, { 1, \"y\" }, { 2, \"z\" } } }\n};\n</code></pre>\n"}], "owner": {"reputation": 4397, "user_id": 539285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a5509c378b4bb7a2795d958a3b45fdee?s=128&d=identicon&r=PG", "display_name": "Ilyssis", "link": "https://stackoverflow.com/users/539285/ilyssis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 30226445, "answer_count": 1, "score": 2, "last_activity_date": 1431557796, "creation_date": 1431556058, "question_id": 30226253, "link": "https://stackoverflow.com/questions/30226253/c-multidimensional-string-array-initialization-stdmap", "title": "C++ Multidimensional string array initialization (std::map)", "body": "<p>I have this special array of strings in c++:</p>\n\n<pre><code>#include &lt;map&gt;\n#include &lt;string&gt;\n\nstd::map&lt;std::string, std::map&lt;int, std::string&gt;&gt; oParam;\noParam[\"pA\"][0] = \"a\";\noParam[\"pA\"][1] = \"b\";\noParam[\"pA\"][2] = \"c\";\noParam[\"pB\"][0] = \"x\";\noParam[\"pB\"][1] = \"y\";\noParam[\"pB\"][2] = \"z\";\n</code></pre>\n\n<p>But I would like to initialize it with an <strong>initialization list</strong>, something like this:</p>\n\n<pre><code>std::map&lt;std::string, std::map&lt;int, std::string&gt;&gt; oParam{\n    { \"pA\", { \"a\", \"b\", \"c\" } },\n    { \"pB\", { \"x\", \"y\", \"z\" } },\n};\n</code></pre>\n\n<p>But this is giving me an error. Am I missing some brackets?</p>\n"}, {"tags": ["c++", "class"], "comments": [{"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1431554961, "post_id": 30226010, "comment_id": 48555965, "body": "Why can&#39;t you use friend? Seems like that is what you want."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431555623, "post_id": 30226010, "comment_id": 48556266, "body": "Make <code>B</code> a private inner class of <code>A</code>."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1431556198, "post_id": 30226010, "comment_id": 48556470, "body": "<code>friend</code> is your best friend in this scenario"}, {"owner": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "edited": false, "score": 0, "creation_date": 1431565193, "post_id": 30226010, "comment_id": 48558949, "body": "Id like it so that class A cannot access private members of class B, yet at the same time only class A can have a class B"}, {"owner": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431565409, "post_id": 30226010, "comment_id": 48558997, "body": "@juanchopanza thanks for mentioning private inner classes or otherwise known as nested classes, just read about it and it is very useful"}], "answers": [{"comments": [{"owner": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "edited": false, "score": 0, "creation_date": 1431564929, "post_id": 30227030, "comment_id": 48558885, "body": "Thanks this was helpful, but it also brought me another question, if you wouldn&#39;t mind of course. Can the same thing with B_Implementation be said about any classes that are only declared in a .cpp?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "reply_to_user": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "edited": false, "score": 0, "creation_date": 1431565237, "post_id": 30227030, "comment_id": 48558960, "body": "@DiegoLiu Yes, if there is no header file the compiler only knows about the class when it is compiling the <code>.cpp</code> file that contains it."}], "tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": true, "score": 2, "last_activity_date": 1431560761, "creation_date": 1431560761, "answer_id": 30227030, "question_id": 30226010, "link": "https://stackoverflow.com/questions/30226010/a-class-that-can-only-be-created-by-another-class-without-using-friend/30227030#30227030", "title": "A class that can only be created by another class, without using friend", "body": "<p>Rather than having a private constructor you could make your <code>class B</code> \"private\" by not placing it in any header files.</p>\n\n<p>You can achieve this by using an <em>interface</em> class.</p>\n\n<p>The client programmer can not instantiate the <em>interface</em> class because it is pure-virtual and it can not instantiate the implementation because it has not been declared.</p>\n\n<p>The only way to instantiate it is through a factory function like this:</p>\n\n<p><strong>The public interface:</strong></p>\n\n<pre><code>// classes.h\n\n// pure virtual interface\nstruct B\n{\n    virtual ~B() {}\n\n    virtual void func_1() = 0;\n    virtual void func_2() = 0;\n};\n\nclass A\n{\npublic:\n    // factory method\n    B* create_B();\n};\n</code></pre>\n\n<p><strong>The \"private\" implementation:</strong></p>\n\n<pre><code>// classes.cpp\n\n#include \"classes.h\"\n\n// the *actual* class B\nclass B_Implementation\n: public B\n{\npublic:\n    void func_1() override\n    {\n        // do stuff\n    }\n\n    void func_2() override\n    {\n        // do stuff\n    }\n};\n\nB* A::create_B()\n{\n    return new B_Implementation;\n}\n</code></pre>\n\n<p><strong>The usage:</strong></p>\n\n<pre><code>int main()\n{\n    A a;\n\n    auto b = std::unique_ptr&lt;B&gt;(a.create_B());\n}\n</code></pre>\n\n<p>If this method is not appropriate to your situation then <code>friend</code> is your only friend.</p>\n"}], "owner": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 30227030, "answer_count": 1, "score": 0, "last_activity_date": 1431560761, "creation_date": 1431554797, "question_id": 30226010, "link": "https://stackoverflow.com/questions/30226010/a-class-that-can-only-be-created-by-another-class-without-using-friend", "title": "A class that can only be created by another class, without using friend", "body": "<p>I'd like to have two non-inheritance-related and non-friends classes, class A and class B. However, i also want that class B can only be instantiated by class A, assuming that class B has a private constructor.</p>\n\n<p>Is there any workaround this without having to use templates?</p>\n"}, {"tags": ["c++", "string", "c++11"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 3, "creation_date": 1431554853, "post_id": 30226005, "comment_id": 48555916, "body": "<a href=\"http://coliru.stacked-crooked.com/a/b4a620e2db97afae\" rel=\"nofollow noreferrer\">Shouldn&#39;t even compile</a>"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1431554855, "post_id": 30226005, "comment_id": 48555917, "body": "OMG not that GCC bug again..."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1431554925, "post_id": 30226005, "comment_id": 48555951, "body": "@chris <a href=\"http://stackoverflow.com/questions/21481462/what-does-string-array-mean-and-why-does-it-work\" title=\"what does string array mean and why does it work\">stackoverflow.com/questions/21481462/&hellip;</a>; <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=60009\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=60009</a>"}, {"owner": {"reputation": 307, "user_id": 4656495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-SoN5oXm5aZo/AAAAAAAAAAI/AAAAAAAAAFs/wGtk2brX-8c/photo.jpg?sz=128", "display_name": "wazeeer", "link": "https://stackoverflow.com/users/4656495/wazeeer"}, "edited": false, "score": 0, "creation_date": 1431554986, "post_id": 30226005, "comment_id": 48555977, "body": "hi. could you please clarify what that is."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1431555015, "post_id": 30226005, "comment_id": 48555988, "body": "@T.C., Your comment brought back memories of annoyingly common questions. Too bad I haven&#39;t encountered this one."}, {"owner": {"reputation": 2985, "user_id": 2304737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IyQzE.png?s=128&g=1", "display_name": "mr5", "link": "https://stackoverflow.com/users/2304737/mr5"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1431581857, "post_id": 30226005, "comment_id": 48563146, "body": "@chris &quot;error: use of undeclared identifier &#39;city&#39;; did you mean &#39;city1&#39;?&quot;"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 2985, "user_id": 2304737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IyQzE.png?s=128&g=1", "display_name": "mr5", "link": "https://stackoverflow.com/users/2304737/mr5"}, "edited": false, "score": 0, "creation_date": 1431624296, "post_id": 30226005, "comment_id": 48588052, "body": "@mr5, My code was taken from the question before it got changed, but thanks for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 307, "user_id": 4656495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-SoN5oXm5aZo/AAAAAAAAAAI/AAAAAAAAAFs/wGtk2brX-8c/photo.jpg?sz=128", "display_name": "wazeeer", "link": "https://stackoverflow.com/users/4656495/wazeeer"}, "edited": false, "score": 0, "creation_date": 1431555788, "post_id": 30226072, "comment_id": 48556334, "body": "He gets it, kudos @wazeeer, but for the TL;DR crowd, T.C., you should move the note about why it printed the address instead of the string closer to the top of the answer since that section is the answer."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1431555951, "post_id": 30226072, "comment_id": 48556388, "body": "@user4581301 I dunno, to me the answer is &quot;it shouldn&#39;t be printing anything because it won&#39;t compile&quot;..."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": false, "score": 18, "last_activity_date": 1431556074, "last_edit_date": 1431556074, "creation_date": 1431555129, "answer_id": 30226072, "question_id": 30226005, "link": "https://stackoverflow.com/questions/30226005/why-does-printing-a-string-array-output-hexadecimal/30226072#30226072", "title": "Why does printing a string array output hexadecimal?", "body": "<p>The first line <em>shouldn't</em> compile, but there's a <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=60009\" rel=\"noreferrer\">GCC bug</a> that makes it compile and behave equivalently to something like</p>\n\n<pre><code>std::string city1[] = {\"toronto\", \"toronto\", \"toronto\", \"toronto\",\n                       \"toronto\", \"toronto\", \"toronto\", \"toronto\"};\n</code></pre>\n\n<p>(8, because <code>\"toronto\"</code> is 8 characters including the terminating null. Yes, that means that if you used <a href=\"https://en.wikipedia.org/wiki/Lake_Chaubunagungamaug\" rel=\"noreferrer\"><code>\"Chargoggagoggmanchauggagoggchaubunagungamaugg\"</code></a>, it would create an array of 46 strings, each storing <code>\"Chargoggagoggmanchauggagoggchaubunagungamaugg\"</code>.)</p>\n\n<p>Needless to say, you shouldn't rely on a compiler bug.</p>\n\n<p>Under GCC's buggy behavior, <code>city1</code> would be an array of <code>std::string</code>s; there's no operator <code>&lt;&lt;</code> overload that support printing such a thing. Instead, in <code>std::cout &lt;&lt; city1</code>, the array decays to a pointer to its first element, and the address stored in the pointer is printed instead.</p>\n\n<p>You probably meant to write <code>std::string city1 = \"toronto\";</code>. One string, not an array of it.</p>\n"}, {"tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": true, "score": 2, "last_activity_date": 1431577681, "creation_date": 1431577681, "answer_id": 30229224, "question_id": 30226005, "link": "https://stackoverflow.com/questions/30226005/why-does-printing-a-string-array-output-hexadecimal/30229224#30229224", "title": "Why does printing a string array output hexadecimal?", "body": "<p>The answer given by T.C. is correct, I would also like to mention that if you was expecting to print out \"toronto\" to the console using cout then you would want to do this:</p>\n\n<pre><code>include &lt;string&gt;\ninclude &lt;iostream&gt;\n\nint main() {\n    using namespace std;\n\n    // string city1[] = \"toronto\"; // Compiler Error - Do Next Line Instead\n    string city1[] = { \"toronto\" };\n    cout &lt;&lt; city1[0];\n\n    return 0;\n}\n</code></pre>\n\n<p>Any time you want to initialize an array of any type during declaration you need to use = { };  To set each array's element separated by commas. Look at this code sample:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nint main() {\n    using namespace std;\n\n    string cities[] = { \"New York\", \"Philadelphia\", \"Chicago\", \"Boston\" };\n\n    // Same As Above Except Size Of Array Is Defined First Then The Elements\n    string cities[4];\n    cities[0] = \"New York\";\n    cities[1] = \"Philadelphia\";\n    cities[2] = \"Chicago\";\n    cities[3] = \"Boston\";\n\n    unsigned index = 0;\n    for ( ; index &lt; 4; index++ ) {\n        cout &lt;&lt; cities[index] &lt;&lt; endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>If you are not initializing the array when declaring it then you must specify the array's size.</p>\n\n<pre><code>int main() {\n    int iArray[]; // Compiler Error\n    int iArray[] = { 4, 3, 2, 1, 6 }; // Okay and is the same as\n\n    int iArray[5];  // Okay\n    iArray[0] = 4;\n    iArray[1] = 3;\n    iArray[2] = 2;\n    iArray[3] = 1;\n    iArray[4] = 6;\n\n    return 0;\n</code></pre>\n\n<p>}</p>\n\n<p>If you are not using the bracket operator with an index value to send to the console output stream std::cout then the hex value you are getting is correct as\nT.C had already stated; it is returning the address of the first index. This is why in c / c++ arrays and pointers are similar (they are not the same, but behave almost like one another). The main difference with arrays is that they are constant in size, the size has to be known at compile time, and can not be dynamically changed in size without having to store the contents into a temp variable while creating a new array with a larger size then copying all the data into the new array and then cleaning up the old array. With pointers they do not behave this way, pointers can be dynamically allocated on the heap using new, but also must be deleted when that variable has no more use to prevent memory leaks, if the pointer is delete before hand and something tries to access it that memory address is no longer valid and doesn't belong to the caller, these are normally seen as unhandled exceptions, heap corruption, etc. and will crash your program. The same goes for arrays when you try to index them past their bounds.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main() {\n    // Arrays Are 0 Indexed\n    int iArray[3] = { 1, 2, 3 };\n\n    // If you try to do this to access the last element\n    std::cout &lt;&lt; iArray[3] &lt;&lt; std::endl; // Program Will Crash\n\n    // Since Arrays Are 0 Indexed And The Size Of The Array Is 3\n    // The 3rd Value Is Indexed At 2, And By Trying To Index Location Of Array\n    // At 3, This Memory Doesn't Belong To You, And It Is Undefined Behavior.\n    // This Memory Could Contain Nothing, Random Data, Or Even Data That Belongs To \n    // Something Else Which If Changed Can Even Cause System Failure          \n\n    return 0;\n} \n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 4656495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-SoN5oXm5aZo/AAAAAAAAAAI/AAAAAAAAAFs/wGtk2brX-8c/photo.jpg?sz=128", "display_name": "wazeeer", "link": "https://stackoverflow.com/users/4656495/wazeeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 1, "accepted_answer_id": 30229224, "answer_count": 2, "score": 7, "last_activity_date": 1431577681, "creation_date": 1431554783, "last_edit_date": 1431556125, "question_id": 30226005, "link": "https://stackoverflow.com/questions/30226005/why-does-printing-a-string-array-output-hexadecimal", "title": "Why does printing a string array output hexadecimal?", "body": "<p>Why does the following program print \"0x2ffee4\" to the console?</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main() {\n    string city1[] = \"toronto\";\n    cout &lt;&lt; city1;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "pointers", "tiling"], "comments": [{"owner": {"reputation": 17, "user_id": 4789656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b997e4ea28b66227082ed86ffd6f0de?s=128&d=identicon&r=PG&f=1", "display_name": "mikeysaxton", "link": "https://stackoverflow.com/users/4789656/mikeysaxton"}, "edited": false, "score": 0, "creation_date": 1431554186, "post_id": 30225817, "comment_id": 48555608, "body": "I essentially want to make all of my orientations directly adjacent to one another in memory."}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 1, "creation_date": 1431554397, "post_id": 30225817, "comment_id": 48555705, "body": "I don&#39;t understand what you&#39;re doing now and what would make your life easier. Maybe post more code or rephrase the question?"}, {"owner": {"reputation": 17, "user_id": 4789656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b997e4ea28b66227082ed86ffd6f0de?s=128&d=identicon&r=PG&f=1", "display_name": "mikeysaxton", "link": "https://stackoverflow.com/users/4789656/mikeysaxton"}, "edited": false, "score": 0, "creation_date": 1431556201, "post_id": 30225817, "comment_id": 48556473, "body": "I do mean pointers to pointers. I want to have a convenient way of accessing my eight 2-d matrices (where I have already generated and stored in memory. I did not include this part of the code. I will if need be). The problem i&#39;m having is that my 4 of my matrices are hxw and 4 are wxh.  I would like something like           Orientation[8]"}, {"owner": {"reputation": 17, "user_id": 4789656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b997e4ea28b66227082ed86ffd6f0de?s=128&d=identicon&r=PG&f=1", "display_name": "mikeysaxton", "link": "https://stackoverflow.com/users/4789656/mikeysaxton"}, "edited": false, "score": 0, "creation_date": 1431556240, "post_id": 30225817, "comment_id": 48556492, "body": "orientation [0] = pointer; orientation[1] = p_0;  etc..."}], "answers": [{"comments": [{"owner": {"reputation": 91305, "user_id": 19410, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/175f1d55c73ce5cb1d071dc4d0f1a333?s=128&d=identicon&r=PG", "display_name": "Alex Reynolds", "link": "https://stackoverflow.com/users/19410/alex-reynolds"}, "edited": false, "score": 3, "creation_date": 1431554909, "post_id": 30226006, "comment_id": 48555944, "body": "Arrays are zero-indexed in C and C++. This would cause an overflow and probably segfault."}, {"owner": {"reputation": 17, "user_id": 4789656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b997e4ea28b66227082ed86ffd6f0de?s=128&d=identicon&r=PG&f=1", "display_name": "mikeysaxton", "link": "https://stackoverflow.com/users/4789656/mikeysaxton"}, "edited": false, "score": 0, "creation_date": 1431557228, "post_id": 30226006, "comment_id": 48556796, "body": "Thanks for your input, even if your indices are off in the for loop. I don&#39;t think this method will work in my case, though."}], "tags": [], "owner": {"reputation": 63, "user_id": 4889700, "user_type": "registered", "profile_image": "https://graph.facebook.com/637233486413429/picture?type=large", "display_name": "Alejandro Villalon", "link": "https://stackoverflow.com/users/4889700/alejandro-villalon"}, "is_accepted": false, "score": -3, "last_activity_date": 1431554784, "creation_date": 1431554784, "answer_id": 30226006, "question_id": 30225817, "link": "https://stackoverflow.com/questions/30225817/how-to-store-symmetries-of-a-polyomino-using-pointers-to-pointers/30226006#30226006", "title": "How to store symmetries of a Polyomino using pointers-to-pointers?", "body": "<p>you can just declare a array of pointers double with size 8 like this</p>\n\n<p>double* Arrptr[8];</p>\n\n<p>and then to store the addresses you just have to use a loop which could be a for loop to store each value in an array but you will have to save one by one on the array this solution it will be better</p>\n\n<pre><code>double *arrptr[8];\nfor (int i=1;i&lt;=8;i++)\n{\n    /*generate values getting them from the user or \n    you can generate them with your method*/\n\n    cout &lt;&lt; \"Enter orientations/n\";\n    cin &gt;&gt; arrptr[i];\n\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 4789656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b997e4ea28b66227082ed86ffd6f0de?s=128&d=identicon&r=PG&f=1", "display_name": "mikeysaxton", "link": "https://stackoverflow.com/users/4789656/mikeysaxton"}, "edited": false, "score": 0, "creation_date": 1431969487, "post_id": 30226091, "comment_id": 48713859, "body": "I would like to do this for simple &quot;book-keeping&quot; reasons. I feel like it may be convenient to have all of my matrices grouped together. It may be useless in the end. However, thank you for the reply! This helped a bunch"}], "tags": [], "owner": {"reputation": 2704, "user_id": 2828147, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VILaH.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2828147/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1431563990, "last_edit_date": 1431563990, "creation_date": 1431555202, "answer_id": 30226091, "question_id": 30225817, "link": "https://stackoverflow.com/questions/30225817/how-to-store-symmetries-of-a-polyomino-using-pointers-to-pointers/30226091#30226091", "title": "How to store symmetries of a Polyomino using pointers-to-pointers?", "body": "<p>The elements of an array are stored at consecutive places in memory, so you can get the addresses and do some computations on it like this :</p>\n\n<pre><code>int arr[] = { 0, 1, 2, 3, 4, 5 };\nint* a = &amp;arr[0]; // Address of the beginning of the array (i.e index 0)\nint* b = a + 3;   // Address of index 3, behind the scene it does a + (3 * sizeof(int))\n\ncout &lt;&lt; \"index 0 : \" &lt;&lt; *a &lt;&lt; endl;\ncout &lt;&lt; \"index 3 : \" &lt;&lt; *b &lt;&lt; endl &lt;&lt; endl;\n\nint d = 0, e = 1, f = 2;\nint* arr2[] = { &amp;d, &amp;e, &amp;f }; // Array of pointers\nint** address = &amp;arr2[1];     // Pointer to a pointer\nint*** address_of_handle = &amp;address; // Address of that pointer\ncout &lt;&lt; \"index 1 : \" &lt;&lt; ***address_of_handle;\n</code></pre>\n\n<p>But apart from getting familiar with pointers I wonder why you wanna do this?</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 4889700, "user_type": "registered", "profile_image": "https://graph.facebook.com/637233486413429/picture?type=large", "display_name": "Alejandro Villalon", "link": "https://stackoverflow.com/users/4889700/alejandro-villalon"}, "is_accepted": false, "score": 0, "last_activity_date": 1431639948, "creation_date": 1431639948, "answer_id": 30247926, "question_id": 30225817, "link": "https://stackoverflow.com/questions/30225817/how-to-store-symmetries-of-a-polyomino-using-pointers-to-pointers/30247926#30247926", "title": "How to store symmetries of a Polyomino using pointers-to-pointers?", "body": "<p>im sorry but he is wrong you can start your array in 0 or 1 as long as you stopped your array in the exact position if you try to reach memory outside of the array you will have overflow problem alex you should read a little bit more of C/C++ </p>\n"}], "owner": {"reputation": 17, "user_id": 4789656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b997e4ea28b66227082ed86ffd6f0de?s=128&d=identicon&r=PG&f=1", "display_name": "mikeysaxton", "link": "https://stackoverflow.com/users/4789656/mikeysaxton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1431639948, "creation_date": 1431554003, "last_edit_date": 1431573238, "question_id": 30225817, "link": "https://stackoverflow.com/questions/30225817/how-to-store-symmetries-of-a-polyomino-using-pointers-to-pointers", "title": "How to store symmetries of a Polyomino using pointers-to-pointers?", "body": "<p>Okay so I'm working on coding a discrete tiling problem. I am storing my object called a <a href=\"http://en.wikipedia.org/wiki/Polyomino\" rel=\"nofollow\"><strong>polyomino</strong></a> like so:</p>\n\n<pre><code> pointer = new int*[h];\n p_0 = new int*[h];\n p_1 = new int*[h];\n p_2 = new int*[w];\n p_3 = new int*[w];\n p_4 = new int*[w];\n p_5 = new int*[h];\n p_6 = new int*[w];\n\n for (i=0 ; i &lt; h ; i++)\n     pointer[i] = new int[w];\n     p_0[i] = new int[w];\n     p_1[i] = new int[w];\n     p_5[i]=new int[w];\n\n     } \n     for(i=0 ; i &lt; w ; i++){\n     p_2[i]=new int[h];\n     p_3[i]=new int[h];\n     p_4[i]=new int[h];\n     p_6[i]=new int[h];\n     }\n\n  for (i=0; i&lt;h ; i++){\n     for(j=0; j&lt;w ; j++){\n        cout &lt;&lt; \"What is the \" &lt;&lt; i+1;\n          cout &lt;&lt; \", \" &lt;&lt; j+1;\n           cout &lt;&lt; endl;\n             cin &gt;&gt; k;\n              if(k != 0)\n                pointer[i][j]=1;      \n                 else\n                  pointer[i][j]=0;\n\n      } \n\n\n} \n</code></pre>\n\n<p>Then I am generating all 8 possible orientations (the <a href=\"http://en.wikipedia.org/wiki/Polyomino#Symmetries_of_polyominoes\" rel=\"nofollow\"><em>group of symmetries</em></a> of the square) and storing them into 7 other double pointers. I was wondering if there was a way that I can make array of size 8 that holds the address for each one of my double pointers. </p>\n\n<p>If I could do this, this would make my life a lot easier when checking the board to be tiled for empty spaces and then placing them. \nI would like something like:</p>\n\n<pre><code>         orientation[8];\n         orientation[0]=pointer;\n         orientation[1]=p_0;\n         orientation[2]=p_1;\n         orientation[3]=p_2;\n         orientation[4]=p_3;\n</code></pre>\n\n<p>and so on. The problem is that there are two different sizes; one being hxw and the other being wxh. My first though was to do something like:</p>\n\n<pre><code>     int** orientation;\n     orientation = new int*[8]\n\n     for(i=0;i&lt;8&lt;;i++)\n       orientation[i]=new int*[h*w];\n</code></pre>\n\n<p>Thanks a bunch in advance.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1431554049, "post_id": 30225772, "comment_id": 48555544, "body": "You need to declare <code>foo</code> before you call it."}, {"owner": {"reputation": 841, "user_id": 970312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3476fdb045fd4b0d2a0294924bf5aebf?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/970312/nick"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431554373, "post_id": 30225772, "comment_id": 48555696, "body": "That is not correct for a template context, and it not how ADL works. And also please note, with the non-const overload the code is legit."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431554504, "post_id": 30225772, "comment_id": 48555759, "body": "Whatever. You clearly understand this very well."}, {"owner": {"reputation": 841, "user_id": 970312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3476fdb045fd4b0d2a0294924bf5aebf?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/970312/nick"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431554806, "post_id": 30225772, "comment_id": 48555892, "body": "Not clearly, not very well..  I simply fell into this pitfall and trying to understand what is going on..   If you think about it, it is quite an easy to miss C++-esque detail.  Consider a real code where the general template (<code>bar</code>) is hidden deep down in some include hierarchy, and you are trying to implement a simple facade class (<code>Wig</code>) that contains bunch of implementation data (int) and want to present a &quot;friendly&quot; version of <code>bar</code>.  No more templates, and everything is <code>const</code>.  Yet, the compilers croak."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431555251, "post_id": 30225772, "comment_id": 48556093, "body": "If you were to provide <code>void foo(const struct Wig&amp;) {}</code> before the function template <code>bar</code> the code would compile. That is what I meant in my first comment and it is correct."}, {"owner": {"reputation": 841, "user_id": 970312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3476fdb045fd4b0d2a0294924bf5aebf?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/970312/nick"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431561881, "post_id": 30225772, "comment_id": 48558070, "body": "There is no <code>foo(.. Wig&amp;)</code> at all.  Not before, not after.  There is <code>bar(Wig&amp;)</code> which forwards an internal <code>int</code> to an existing <code>foo</code>.  Sorry, the symbol names are not very clear."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431582934, "post_id": 30225772, "comment_id": 48563582, "body": "I said &quot;You need to declare foo before you call it.&quot; The reason you get a compiler error is because you&#39;re instantiating the function template and it cannot find an appropriate <code>foo</code> function to call. If you provide that function <i>before</i> the function template definition, the code compiles. It is very simple."}], "answers": [{"comments": [{"owner": {"reputation": 841, "user_id": 970312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3476fdb045fd4b0d2a0294924bf5aebf?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/970312/nick"}, "edited": false, "score": 0, "creation_date": 1431562620, "post_id": 30225826, "comment_id": 48558295, "body": "Great answer! Thanks for the pointers to the standard and explaining how template enters into ranking."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 7, "last_activity_date": 1431554574, "last_edit_date": 1431554574, "creation_date": 1431554036, "answer_id": 30225826, "question_id": 30225772, "link": "https://stackoverflow.com/questions/30225772/template-function-overload-with-const/30225826#30225826", "title": "template function overload with const", "body": "<p>For the <code>bar(w)</code> call, overload resolution compares</p>\n\n<pre><code>void bar&lt;Wig&gt;(Wig&amp;); // instantiated from the template\nvoid bar(const Wig &amp;);\n</code></pre>\n\n<p>Binding to a reference to a less cv-qualified type is better ([over.ics.rank], bullet 3.2.6), so the first signature is chosen. That template attempts to call <code>foo</code> on a <code>Wig</code>, but there's no such thing, hence the error.</p>\n\n<p>With the extra non-const overload, we are now comparing (plus the <code>const Wig &amp;</code> that's worse than either):</p>\n\n<pre><code>void bar&lt;Wig&gt;(Wig&amp;); // instantiated from the template\nvoid bar(Wig&amp;);\n</code></pre>\n\n<p>The parameter types are identical, so the two are indistinguishable by ranking conversion sequences, and instead the tiebreaker in [over.match.best] bullet 1.6 selects the non-template over the function template specialization.</p>\n"}], "owner": {"reputation": 841, "user_id": 970312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3476fdb045fd4b0d2a0294924bf5aebf?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/970312/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 30225826, "answer_count": 1, "score": 0, "last_activity_date": 1431554574, "creation_date": 1431553799, "question_id": 30225772, "link": "https://stackoverflow.com/questions/30225772/template-function-overload-with-const", "title": "template function overload with const", "body": "<p>Here is a bit of code: </p>\n\n<pre><code>template&lt;class T&gt;\ninline void bar(T&amp; t) {\n   foo(t); // intention is that foo() is found by ADL\n}\n\nstruct Wig {\n   int i;\n};\n\nvoid foo(int){ }\n\n// some convenience overload\ninline void bar(const Wig&amp; w) { foo(w.i);  }\n\n// The bit that if uncommented, \"fixes\" the problem\n//inline void bar(Wig&amp; w) {   foo(w.i); }\n\nint main()\n{\n   Wig w;\n   bar(w);\n   return 0;\n}\n</code></pre>\n\n<p>Clang 3.5 and Gcc 4.7, spit out the following error:</p>\n\n<pre><code>template-function-overload.cpp:12:4: error: no matching function for call to 'foo'\n   foo(t);\n   ^~~\ntemplate-function-overload.cpp:29:4: note: in instantiation of function template specialization\n      'bar&lt;Wig&gt;' requested here\n   bar(w);\n   ^\ntemplate-function-overload.cpp:19:6: note: candidate function not viable: no known conversion from\n      'Wig' to 'int' for 1st argument\nvoid foo(int){ }\n     ^\n</code></pre>\n\n<p>So it doesn't look like a compiler issue. </p>\n\n<p>Also, commenting out the non-const overload fixes the error. </p>\n\n<p>Why is this code incorrect, and why a non-const overload required?</p>\n"}, {"tags": ["c++", "database", "perl", "optimization", "file-io"], "comments": [{"owner": {"reputation": 113221, "user_id": 100754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7804ebae32fbadef38537d74a915c22f?s=128&d=identicon&r=PG", "display_name": "Sinan &#220;n&#252;r", "link": "https://stackoverflow.com/users/100754/sinan-%c3%9cn%c3%bcr"}, "edited": false, "score": 0, "creation_date": 1431554640, "post_id": 30225745, "comment_id": 48555821, "body": "Consider gzipping the file to tradeoff CPU for reduced IO. Also, how many columns? Are the data changing or stable? Run a local copy of memcached? Or map the file to memory? It all depends on what exactly you are doing."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1431554643, "post_id": 30225745, "comment_id": 48555823, "body": "Consider a pipeline architecture.  One thread reads the data; when enough data is read, it wakes up the computation thread.  The computation get the data and produces results.  It sends or notifies the &quot;Writing&quot; thread of the results.  The writing thread outputs the results.  Remember these three activities are happening &quot;simultaneously&quot;.  Much like shoving stuff through a pipe."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1431554824, "post_id": 30225745, "comment_id": 48555901, "body": "Fastest solution is to buy another 16GB of ram and run ramdisk"}, {"owner": {"reputation": 140851, "user_id": 1120273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4cbcb185abce0204cf5ac705ba32d53a?s=128&d=identicon&r=PG", "display_name": "Dietmar K&#252;hl", "link": "https://stackoverflow.com/users/1120273/dietmar-k%c3%bchl"}, "edited": false, "score": 0, "creation_date": 1431555335, "post_id": 30225745, "comment_id": 48556137, "body": "I&#39;m confused! 1GB used to be big but definitely isn&#39;t anymore. Taking 10 minutes to read 1GB of data is definitely too slow. On a 10GB ethernet card you get more than your file worth every second and although it may not be trivial program keep up with this rate. You may need to reconsider your data structure. Of course, you could build your data structure in shared memory and have one process cling to the data while others are simply reading it. Reasonably simple to do with C++. I have no idea how to do it with perl (perl isn&#39;t my primary language)."}, {"owner": {"reputation": 25590, "user_id": 59135, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/90c563665ec03a1b9e80671bb95deeed?s=128&d=identicon&r=PG", "display_name": "daotoad", "link": "https://stackoverflow.com/users/59135/daotoad"}, "edited": false, "score": 2, "creation_date": 1431556509, "post_id": 30225745, "comment_id": 48556578, "body": "Try profiling your code during the extract phase.  It will help you identify what is taking so long.  Devel::NYTProf is the gold standard in perl profilers these days."}, {"owner": {"reputation": 2797, "user_id": 4123698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883acd9ee061b3a325ba22b1fee3daca?s=128&d=identicon&r=PG&f=1", "display_name": "harvey", "link": "https://stackoverflow.com/users/4123698/harvey"}, "edited": false, "score": 3, "creation_date": 1431563137, "post_id": 30225745, "comment_id": 48558437, "body": "This sounds like a good candidate to import your data to a database such as MySQL, this will allow you to have data laoded into memmory, properly indexed is setup correctly, and accessible from multiple processess/languages."}, {"owner": {"reputation": 1463, "user_id": 3169872, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/56860a51bd310b5d8569602a75455749?s=128&d=identicon&r=PG&f=1", "display_name": "DoctorMoisha", "link": "https://stackoverflow.com/users/3169872/doctormoisha"}, "edited": false, "score": 0, "creation_date": 1431580666, "post_id": 30225745, "comment_id": 48562768, "body": "Is database faster? Because it seems to me, that reading from database is similar to reading from file."}, {"owner": {"reputation": 4663, "user_id": 3967089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d00715119003023d62918dcc603ca7?s=128&d=identicon&r=PG&f=1", "display_name": "Calle Dybedahl", "link": "https://stackoverflow.com/users/3967089/calle-dybedahl"}, "edited": false, "score": 0, "creation_date": 1431585789, "post_id": 30225745, "comment_id": 48564816, "body": "It&#39;s possible to use SysV shared memory to transport data between processes. Have a look at the module IPC::Shareable on CPAN. Also, think about the file format. Parsing it probably takes much more time than just getting the data into your process from the outside (and databases definitely have that problem too). And as already said, do profile so you <i>know</i> where the time is spent, and thus what part to optimize."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1431598360, "post_id": 30225745, "comment_id": 48571411, "body": "What kind of data is stored in your large file? If it is mostly numbers, and you have a DirectX 11 capable video card even if you are not on a windows machine, you should be able to use HLSL Compute Shaders to store and process the data after the file is read. I am not sure if GLSL has something similar but they could. You would need a fairly new video card with at least 1-2GB of Video Ram. It is faster to compute data there then across the bus and you have less chances for cache misses. This depends on a proper batch class for sending the data over to the graphics card for computation..."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1431598658, "post_id": 30225745, "comment_id": 48571558, "body": "(continued...) Once the computations are done you can pass the information back in batches to your local application and either store them into structures or write them to a file/s. Both HLSL &amp; GLSL work very efficient with 4x4 matrices using floats or doubles due to the architecture of the GPU and onboard video ram."}], "answers": [{"tags": [], "owner": {"reputation": 2182, "user_id": 1102638, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7c9fbc08343c7fbfc9c5888d8e803e05?s=128&d=identicon&r=PG", "display_name": "Vadim Pushtaev", "link": "https://stackoverflow.com/users/1102638/vadim-pushtaev"}, "is_accepted": false, "score": 1, "last_activity_date": 1431596695, "last_edit_date": 1495541659, "creation_date": 1431596695, "answer_id": 30234103, "question_id": 30225745, "link": "https://stackoverflow.com/questions/30225745/how-to-avoid-reloading-big-data-on-program-start/30234103#30234103", "title": "How to avoid reloading big data on program start", "body": "<p>On my current system Perl copies the whole 1GB file in memory in 2 seconds. So I believe your problem is not reading the file but parsing it.</p>\n\n<p>So the straightforward solution I can think of is to <em>preparse it</em> by, for instance, converting your data into actual <em>code source</em>. I mean, you can prepare your data and <em>hardcode it</em> in your script directly (using another file of course).</p>\n\n<p>However, if <em>reading</em> is an actual problem (which I doubt) you can use database that store the data in the memory (<a href=\"https://stackoverflow.com/questions/4343225/mysql-how-to-keep-entire-myisam-table-in-memory\">example</a>). It will be faster anyway just because your database reads the data once upon starting and you don't restart your database as often as your program.</p>\n"}, {"tags": [], "owner": {"reputation": 7948, "user_id": 4899330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857a19fa016a8fc6c0a3250f03f108a9?s=128&d=identicon&r=PG&f=1", "display_name": "doqtor", "link": "https://stackoverflow.com/users/4899330/doqtor"}, "is_accepted": false, "score": 1, "last_activity_date": 1431597952, "creation_date": 1431597952, "answer_id": 30234530, "question_id": 30225745, "link": "https://stackoverflow.com/questions/30225745/how-to-avoid-reloading-big-data-on-program-start/30234530#30234530", "title": "How to avoid reloading big data on program start", "body": "<p>The idea for solving this type of problems can be as follows:</p>\n\n<p>Go for 3 programs:</p>\n\n<ul>\n<li>Reader</li>\n<li>Analyzer</li>\n<li>Writer</li>\n</ul>\n\n<p>and exchange data between them using shared memory.</p>\n\n<p>For that big file I guess you have considerable amount of data of one object type which you can store in circular buffer in shared memory (I recommend using boost::interprocess).</p>\n\n<p>Reader will continuously read data from the input file and store it in shared memory.\nIn the meantime, once is enough data read for doing calculations, the Analyzer will start processing it and store results into another circular buffer shared memory file.\nOnce there are some calculations in the second shared memory the Writer will read them and store them into final output file.</p>\n\n<p>You need to make sure all the processes are synchronized properly so that they do their job simultanouesly and you don't lose the data (the data is not being overwritten before is processed or saved into final file).</p>\n"}, {"tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": false, "score": 1, "last_activity_date": 1431601203, "creation_date": 1431601203, "answer_id": 30235652, "question_id": 30225745, "link": "https://stackoverflow.com/questions/30225745/how-to-avoid-reloading-big-data-on-program-start/30235652#30235652", "title": "How to avoid reloading big data on program start", "body": "<p>I like the answer doqtor gives, but to prevent data from being overwritten, a nice helper class to enable and disable critical sections of code within a thread will do the trick.</p>\n\n<pre><code>// Note: I think sealed may be specific to Visual Studio Compiler.\n//       CRITICAL_SECTION is defined in Windows.h - If on another OS, \n//       look for similar structure.\nclass BlockThread sealed {\nprivate:\n    CRITICAL_SECTION* m_pCriticalSection;\n\npublic:\n    explicit BlockThread( CRITICAL_SECTION&amp; criticalSection );\n    ~BlockThread();\n\nprivate:\n    BlockThread( const BlockThread&amp; c );\n    BlockThread&amp; operator=( const BlockThread&amp; c ); // Not Implement\n};\n\nBlockThread::BlockThread( CRITICAL_SECTION&amp; criticalSection ) {\n    m_pCriticalSection = &amp;criticalSection;\n}\n\nBlockThread::~BlockThread() {\n    LeaveCriticalSection( m_pCriticalSection\n}\n</code></pre>\n\n<p>A class such as this would allow you to block specific threads if you are within the bounds of a critical section where shared memory is being used \nand another thread currently has access to it. This will cause this thread \nof code to be locked until the current thread is done its work and this\nclass goes out of scope.</p>\n\n<p>To use this class with in another class is fairly simple: in the class that you\nwant to block a thread within its .cpp file you need to create a static variable of this type and call the API's function to initialize it. Then\nyou can use the BlockThread class to lock this thread.</p>\n\n<p>SomeClass.cpp</p>\n\n<pre><code>#include \"SomeClass.h\"\n#include \"BlockThread.h\" \n\nstatic CRITICAL_SECTION s_criticalSection;\n\nSomeClass::SomeClass {\n    // Do This First\n    InitializeCriticalSection( &amp;s_criticalSection );\n\n    // Class Stuff Here      \n}\n\nSomeClass::~SomeClass() {\n    // Class Stuff Here\n\n    // Do This Last\n    DeleteCriticalSection( &amp;s_criticalSection );\n}\n\n// To Use The BlockThread\nSomeClass::anyFunction() {\n    // When Your Condition Is Met &amp; You Know This Is Critical\n    // Call This Before The Critical Computation Code.\n    BlockThread blockThread( s_criticalSection );\n} \n</code></pre>\n\n<p>And that is about it, once this object goes out of scope the static member\nis cleaned up within the objects destructor and when this object goes out\nof scope so does the BlockThread class and its Destructor cleans it up there.\nAnd now this shared memory can be used. You would usually want to use this class if you are traversing over containers to either add, insert, or find and access elements when this data is a shared type.</p>\n\n<p>As for the 3 different threads running in memory on the same data set a good concept is to have 3 or 4 buffers each about 4MB in size and have them work in a rotating order. Buff1 gets data then Buff2 gets data, while Buff2 is getting data Buff 1 is either parsing the data it or passing it off to be stored for computation, then Buff1 waits until Buff3 or 4 is done, pending on how many buffers you have. Then this process starts again. This is the same principle that is used with Sound Buffers when reading in sound files for doing an Audio Stream, or sending batches of triangles to a graphics card. Another words it is a Batch type process. </p>\n"}], "owner": {"reputation": 1463, "user_id": 3169872, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/56860a51bd310b5d8569602a75455749?s=128&d=identicon&r=PG&f=1", "display_name": "DoctorMoisha", "link": "https://stackoverflow.com/users/3169872/doctormoisha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1431601203, "creation_date": 1431553678, "last_edit_date": 1431580465, "question_id": 30225745, "link": "https://stackoverflow.com/questions/30225745/how-to-avoid-reloading-big-data-on-program-start", "title": "How to avoid reloading big data on program start", "body": "<p>My question is all about tips and tricks. I'm currently working on project, where I have one very big(~1Gb) file with data. First, I need to <strong>extract</strong> data. This extraction takes 10 mins. Then I do <strong>calculations</strong>. Next calculation depends on previous. Let's call them calculation1, calculation2 and so on. Assuming, that I've done extraction part right, I currently face two problems:</p>\n\n<ol>\n<li>Every time I launch program it works 10 mins least. I cannot avoid it, so I have to plan debugging.</li>\n<li>For every next calculation it takes more time.</li>\n</ol>\n\n<p>Thinking of first problem, I assumed, that some sort of database may help, if database is faster, than reading file, which I doubt.</p>\n\n<p>Second problem might be overcomed if I split my big program in smaller programs, each of which will do: <em>read file-do stuff-write file</em>. So next stage always can read file from previous, for debug. But it introduces many wasted code for file I/O.</p>\n\n<p>I think that both these problems could be solved by some strategy like: write, and test extract module, than launch it and let it extract all data into RAM. Than write calculation1, and launch it to somehow <strong>grab data directly</strong> from RAM of extract module. And so on with every next calculation. So my questions are:</p>\n\n<ol>\n<li>Are there tips and tricks to minimize loads from files?</li>\n<li>Are there ways to share RAM and objects between programs?</li>\n</ol>\n\n<p>By the way I write this task on Perl because I need it quick, but I'll  rewrite it on C++ or C# later, so any language-specific or language-agnostic answers welcome.</p>\n\n<p>Thank you!</p>\n\n<p>[EDIT]</p>\n\n<p>File of data does not change it is like big immutable source of knowledge. And it is not exactly 1Gb and it does not take 10 minutes to read it. I just wanted to say, that file is big and time to read it is considerable. On my machine 1 Gb read+parse file into right objects takes about minute. Which is still pretty bad.</p>\n\n<p>[/EDIT]</p>\n"}, {"tags": ["c++", "registrykey"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4893663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CRvyw.jpg?s=128&g=1", "display_name": "Leo Noob Lin", "link": "https://stackoverflow.com/users/4893663/leo-noob-lin"}, "edited": false, "score": 0, "creation_date": 1431556063, "post_id": 30225792, "comment_id": 48556428, "body": "Hey, looks like I&#39;m getting somewhere! Now it makes the Test key at the right directory, but I want it to contain &quot;TestText&quot;, but when I run the program, it writes to the key: &quot;\u6554\u7473\u6554\u7478&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1431560975, "post_id": 30225792, "comment_id": 48557829, "body": "<code>(LPBYTE)TEXT(&quot;TestText&quot;)</code> is a big red flag"}], "tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": true, "score": 5, "last_activity_date": 1456527636, "last_edit_date": 1456527636, "creation_date": 1431553873, "answer_id": 30225792, "question_id": 30225655, "link": "https://stackoverflow.com/questions/30225655/c-why-does-my-code-put-a-registry-key-at-the-wrong-directory/30225792#30225792", "title": "C++ Why does my code put a registry key at the wrong directory?", "body": "<pre><code>RegSetKeyValue(HKEY_CURRENT_USER, ...\n</code></pre>\n\n<p>This is the bug.  You need to use the <code>keyExample</code> you got when you opened the key you wanted.  Like this:</p>\n\n<pre><code>RegSetKeyValue(keyExample, ...\n</code></pre>\n\n<p>And for your ANSI/Unicode problem, you need to use the <code>TEXT()</code> macro for your actual data, not just its name:</p>\n\n<pre><code>RegSetKeyValue(keyExample, TEXT(\"Test\"), 0, REG_SZ, TEXT(\"TestText\"), lstrlen(TEXT(\"TestText\"))*sizeof(TCHAR))\n</code></pre>\n\n<p>It's generally easier to forget all the legacy backward compatible stuff related to the TEXT/TCHAR menus and to directly call the W versions of the Windows API functions with long strings.</p>\n"}], "owner": {"reputation": 13, "user_id": 4893663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CRvyw.jpg?s=128&g=1", "display_name": "Leo Noob Lin", "link": "https://stackoverflow.com/users/4893663/leo-noob-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 2, "accepted_answer_id": 30225792, "answer_count": 1, "score": 1, "last_activity_date": 1456527636, "creation_date": 1431553265, "last_edit_date": 1431553892, "question_id": 30225655, "link": "https://stackoverflow.com/questions/30225655/c-why-does-my-code-put-a-registry-key-at-the-wrong-directory", "title": "C++ Why does my code put a registry key at the wrong directory?", "body": "<p>So, I want to put a registry key at the directory HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, and I want it to be called Test, and have it contain \"TestText\", but instead this code puts a new key at HKCU\\Test and the program writes random Chinese characters in the registry key. Anyone help?</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;string&gt;\n#include &lt;time.h&gt;\nusing namespace std;\n\nint main()\n{\n     HKEY keyExample;\n\n    if (RegOpenKey(HKEY_CURRENT_USER, TEXT(\"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\\"), &amp;keyExample) != ERROR_SUCCESS)\n    {\n        RegCloseKey(keyExample);\n        return 69;\n    }\n     if (RegSetKeyValue(HKEY_CURRENT_USER, TEXT(\"Test\"), 0, REG_SZ, (LPBYTE)\"TestText\", strlen(\"TestText\")*sizeof(char)) != ERROR_SUCCESS)\n     {\n         RegCloseKey(keyExample);\n         cout &lt;&lt; \"Unable to set registry value value_name\";\n     }\n\n     RegCloseKey(keyExample);\n     return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "xcode", "visual-studio", "pointers", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1431553366, "post_id": 30225584, "comment_id": 48555277, "body": "You need to read about &quot;the rule of three&quot;."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1431553640, "post_id": 30225584, "comment_id": 48555385, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">What is The Rule of Three?</a>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1431554285, "post_id": 30225584, "comment_id": 48555653, "body": "You don&#39;t need all that code.  I can create issues with your program easily: <code>int main() { sparseMatrix&lt;int&gt;a(10,10); sparseMatrix&lt;int&gt; b = a;}</code>  Boom, double deletion error when a and b are destroyed, which is undefined behavior."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1431555172, "post_id": 30225584, "comment_id": 48556060, "body": "Definitely read the Rule of Three. Great advice and, contrary to what you might expect, it has nothing to with overachieving Sith."}, {"owner": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 0, "creation_date": 1431555223, "post_id": 30225584, "comment_id": 48556087, "body": "Can someone explain the downvote? I don&#39;t think this is a low quality question."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1431553823, "post_id": 30225670, "comment_id": 48555451, "body": "@molbdnilo when the broken function returns it copies the object on the stack, but only as far as copying the pointers in the matrix object. Then when the function is done the copy, the destructor for the matrix on the stack is called and the destructor deletes the yArray and xArray, making those locations invalid in the returned copy."}], "tags": [], "owner": {"reputation": 55, "user_id": 4497382, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gsbhRseRYp0/AAAAAAAAAAI/AAAAAAAAAaU/nSCunX5iK2s/photo.jpg?sz=128", "display_name": "Andras Fekete", "link": "https://stackoverflow.com/users/4497382/andras-fekete"}, "is_accepted": false, "score": 0, "last_activity_date": 1431553332, "creation_date": 1431553332, "answer_id": 30225670, "question_id": 30225584, "link": "https://stackoverflow.com/questions/30225584/why-does-returning-a-data-structure-rather-than-a-pointer-mess-with-the-integrit/30225670#30225670", "title": "Why does returning a data structure rather than a pointer mess with the integrity of my data?", "body": "<p>The problem is that you're allocating 'matrix' inside both of the readFile functions. Upon returning from the function, both variables are deallocated. However, returning the value (eradFile) the matrix is copied into your variable of the calling function, whereas returning the pointer (readFileBROKEN) is just returning the address where the matrix used to be stored.</p>\n\n<p>To fix this, you should allocate the 'matrix' variable, and pass in a reference to the function. Then the function can return a void while stuffing the matrix properly.</p>\n"}, {"comments": [{"owner": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 0, "creation_date": 1431554083, "post_id": 30225725, "comment_id": 48555562, "body": "Okay, thank you I understand now. But why is this not a problem in xcode?"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 1, "creation_date": 1431554167, "post_id": 30225725, "comment_id": 48555599, "body": "@DJMcMayhem <b>both</b> xcode <b>and</b> Visual Studio are exhibiting undefined behavior."}, {"owner": {"reputation": 501, "user_id": 4562676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4499a73c0034783da2ab032cb054869c?s=128&d=identicon&r=PG", "display_name": "tomse", "link": "https://stackoverflow.com/users/4562676/tomse"}, "reply_to_user": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 0, "creation_date": 1431554339, "post_id": 30225725, "comment_id": 48555680, "body": "@DJMcMayhem I can&#39;t say anything about xcode - but the problem should occur with every standard confirming c++ compiler when copying the object"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 0, "creation_date": 1431554426, "post_id": 30225725, "comment_id": 48555718, "body": "@DJMcMayhem <code>But why is this not a problem in xcode?</code>  You are programming in C++.  If it is pointed out what the problem is, it is a moot point where it &quot;works&quot;.  C++ has something called <code>undefined behavior</code>, and that is what is happening here."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1431554920, "post_id": 30225725, "comment_id": 48555949, "body": "It is also known as &quot;Getting Lucky.&quot; Someday you will make a small change, recompile, and it just stops working. Not fun explaining that one to the boss. &quot;Honestly I just changed a log message!&quot;"}, {"owner": {"reputation": 501, "user_id": 4562676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4499a73c0034783da2ab032cb054869c?s=128&d=identicon&r=PG", "display_name": "tomse", "link": "https://stackoverflow.com/users/4562676/tomse"}, "reply_to_user": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 0, "creation_date": 1431554978, "post_id": 30225725, "comment_id": 48555970, "body": "@DJMcMayhem I&#39;ve never used c++11/14 compilers with move semantics, so maybe you use different compilers and this point makes a difference - don&#39;t know..."}], "tags": [], "owner": {"reputation": 501, "user_id": 4562676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4499a73c0034783da2ab032cb054869c?s=128&d=identicon&r=PG", "display_name": "tomse", "link": "https://stackoverflow.com/users/4562676/tomse"}, "is_accepted": false, "score": 2, "last_activity_date": 1431553964, "last_edit_date": 1431553964, "creation_date": 1431553598, "answer_id": 30225725, "question_id": 30225584, "link": "https://stackoverflow.com/questions/30225584/why-does-returning-a-data-structure-rather-than-a-pointer-mess-with-the-integrit/30225725#30225725", "title": "Why does returning a data structure rather than a pointer mess with the integrity of my data?", "body": "<p>Your function:</p>\n\n<pre><code>sparseMatrix&lt;basic&gt; readFileBROKEN(string pathToFile)\n</code></pre>\n\n<p>returns a copy of the object (which is OK), but <code>sparseMatrix</code> does not define a copy constructor, so the default generated will be used which creates a shallow copy by just copying the adresses inside the returned object.\nBut the memory where the address points to is deleted when you leave your function (because the destructor of the locally created object is called).</p>\n\n<p>To solve this you have to define your own copy contructor in <code>sparseMatrix</code> which copies all the content of the object.</p>\n\n<pre><code>sparseMatrix(const sparseMatrix&amp; rhs) :\n  width(rhs.width),\n  height(rhs.height),\n  xArray(nullptr),\n  yArray(nullptr)\n{\n  ... and now copy all the content from rhs.xArray to this-&gt;xArray,\n  (same for yArray)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "edited": false, "score": 0, "creation_date": 1431554954, "post_id": 30226012, "comment_id": 48555961, "body": "I agree, this makes the most sense."}, {"owner": {"reputation": 501, "user_id": 4562676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4499a73c0034783da2ab032cb054869c?s=128&d=identicon&r=PG", "display_name": "tomse", "link": "https://stackoverflow.com/users/4562676/tomse"}, "edited": false, "score": 0, "creation_date": 1431555246, "post_id": 30226012, "comment_id": 48556092, "body": "But the problem stiil exists even if circumvented, in this case the class should be made uncopyable to avoid the same probem in the future."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1431555272, "post_id": 30226012, "comment_id": 48556099, "body": "I think so, but having the copy constructor&#39;s a good idea if you find yourself shuffling matrixes around. Even if you don&#39;t have to now, you might have to duplicate later. Better to write now than debug later."}, {"owner": {"reputation": 501, "user_id": 4562676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4499a73c0034783da2ab032cb054869c?s=128&d=identicon&r=PG", "display_name": "tomse", "link": "https://stackoverflow.com/users/4562676/tomse"}, "edited": false, "score": 0, "creation_date": 1431592759, "post_id": 30226012, "comment_id": 48568175, "body": "instead of an out-parameter returning the sparseMatrix as <code>auto_ptr</code> (or <code>unique_ptr</code>) would be the better way. This has the advantage that the dimensions of the matrix must not be known before reading the file (dimensions could be part of the file), furthermore there is no need to check an additional bool, either the returned <code>auto_ptr</code> contains a <code>nullptr</code> or not."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": true, "score": 3, "last_activity_date": 1431556088, "last_edit_date": 1431556088, "creation_date": 1431554804, "answer_id": 30226012, "question_id": 30225584, "link": "https://stackoverflow.com/questions/30225584/why-does-returning-a-data-structure-rather-than-a-pointer-mess-with-the-integrit/30226012#30226012", "title": "Why does returning a data structure rather than a pointer mess with the integrity of my data?", "body": "<p>tomse's answer is correct and  gives the why and a fix, but it's an unnecessarily expensive fix for this problem. His suggestion of the copy constructor also solves numerous future problems such as the classics <em>Why did my vector eat my data?</em> and <em>Dude, where's my segfault?</em> Make the copy constructor. Don't use it unless you have to.</p>\n\n<p>I think Andras Fekete got the problem right, but his post is kind of garbled. His solution is bang on, though.</p>\n\n<p>Define your function like this:</p>\n\n<pre><code>bool readFile(string pathToFile, sparseMatrix&lt;basic&gt; &amp; matrix)\n</code></pre>\n\n<p>Remove the definition of matrix inside the function in favour of the one passed in.</p>\n\n<p>Return false on error so you know the matrix is bad (or use exceptions).</p>\n\n<p>Create the matrix in the calling function and pass it into the revised reader function.</p>\n\n<pre><code>sparseMatrix&lt;basic&gt; matrix(100, 100);\nif readFile(\"C:/users/jmhjr/desktop/testdata.txt\", matrix);\n</code></pre>\n\n<p>That puts you right back where you were with the pointer version, but without the pointer and without having to do the extra work of copying data you didn't need to copy.</p>\n"}], "owner": {"reputation": 6553, "user_id": 3524982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5NAb1.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/3524982/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 30226012, "answer_count": 3, "score": -1, "last_activity_date": 1431556088, "creation_date": 1431552927, "question_id": 30225584, "link": "https://stackoverflow.com/questions/30225584/why-does-returning-a-data-structure-rather-than-a-pointer-mess-with-the-integrit", "title": "Why does returning a data structure rather than a pointer mess with the integrity of my data?", "body": "<p>I'm building a sparse matrix class that holds two arrays (row and column) of pointers to doubly linked lists (down and right). Sort of like this:</p>\n\n<pre><code> rows\nc0123456789\no1\nl2\nu3\nm4  A--&gt;B--&gt;\nn5  |   |\ns6  |   V\n 7  V   D--&gt;\n 8  C--&gt;\n 9  \n</code></pre>\n\n<p>Both arrays are initialized to have <code>nullptr</code> in every space until something is inserted in that place.</p>\n\n<p>I have a function \"readFile\" that reads in objects from a text file and inserts them into this sparse matrix. For some reason, before this function returns, all of the data in it is fine, but after I return, I get random memory locations in my arrays. Here is main.cpp</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n#include \"sparseMatrix.h\"\n\nusing namespace std;\n\nclass basic \n{\nprivate:\n    int x, y;\n    string word;\n    basic *down;\n    basic *right;\npublic:\n    basic(int x, int y, string word)\n    {\n        this-&gt;x = x;\n        this-&gt;y = y;\n        this-&gt;word = word;\n        down = nullptr;\n        right = nullptr;\n    }\n    int getX()\n    {\n        return x;\n    }\n    int getY()\n    {\n        return y;\n    }\n    basic *getRight()\n    {\n        return right;\n    }\n    void setRight(basic *newRight)\n    {\n        right = newRight;\n    }\n    basic *getDown()\n    {\n        return down;\n    }\n    void setDown(basic *newDown)\n    {\n        down = newDown;\n    }\n    void print()\n    {\n        cout &lt;&lt; \"X: \" &lt;&lt; x &lt;&lt; \", Y: \" &lt;&lt; y &lt;&lt; \", word: \" &lt;&lt; word &lt;&lt; \".\\n\";\n    }\n};\n\nsparseMatrix&lt;basic&gt; readFileBROKEN(string pathToFile);\nsparseMatrix&lt;basic&gt; *readFile(string pathToFile);\n\nint main()\n{\n    cout &lt;&lt; \"Working:\\n\\n\";\n    sparseMatrix&lt;basic&gt; *workingMatrix = readFile(\"C:/users/jmhjr/desktop/testdata.txt\");\n    cout &lt;&lt; \"After returning, here are all the locations that are NOT nullptr:\\n\";\n    workingMatrix-&gt;printyArray();\n    cin.get();\n\n    cout &lt;&lt; \"Not working:\\n\\n\";\n    sparseMatrix&lt;basic&gt; brokenMatrix = readFileBROKEN(\"C:/users/jmhjr/desktop/testdata.txt\");\n    cout &lt;&lt; \"After returning, here are all the locations that are NOT nullptr:\\n\";\n    brokenMatrix.printyArray();\n    cin.get();\n\n    delete workingMatrix;\n\n}\n\nsparseMatrix&lt;basic&gt; readFileBROKEN(string pathToFile)\n{\n    ifstream inputFile;\n    inputFile.open(pathToFile);\n    if (inputFile.fail())\n    {\n        cout &lt;&lt; \"Couldn't open \" &lt;&lt; pathToFile &lt;&lt; \"!\\n\";\n        exit(-1);\n    }\n\n    sparseMatrix&lt;basic&gt; matrix(100, 100);\n\n    while (!inputFile.eof())\n    {\n        int x, y;\n        string word;\n        inputFile &gt;&gt; x &gt;&gt; y &gt;&gt; word;\n        basic data(x, y, word);\n        matrix.insert(data);\n    }\n    cout &lt;&lt; \"Before returning, here are all the locations that are NOT nullptr:\\n\";\n    matrix.printyArray();\n    cout &lt;&lt; \"press ENTER to return\\n\";\n    cin.get();\n    return matrix;\n}\n\nsparseMatrix&lt;basic&gt; *readFile(string pathToFile)\n{\n    ifstream inputFile;\n    inputFile.open(pathToFile);\n    if (inputFile.fail())\n    {\n        cout &lt;&lt; \"Couldn't open \" &lt;&lt; pathToFile &lt;&lt; \"!\\n\";\n        exit(-1);\n    }\n\n    sparseMatrix&lt;basic&gt; *matrix = new sparseMatrix&lt;basic&gt;(100, 100);\n\n    while (!inputFile.eof())\n    {\n        int x, y;\n        string word;\n        inputFile &gt;&gt; x &gt;&gt; y &gt;&gt; word;\n        basic data(x, y, word);\n        matrix-&gt;insert(data);\n    }\n    cout &lt;&lt; \"Before returning, here are all the locations that are NOT nullptr:\\n\";\n    matrix-&gt;printyArray();\n    cout &lt;&lt; \"press ENTER to return\\n\";\n    cin.get();\n    return matrix;\n}\n</code></pre>\n\n<p>and here is sparseMatrix.h:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>template &lt;class dataType&gt;\nclass sparseMatrix\n{\nprivate:\n        //The dimensions of the sparse matrix.\n    int width;\n    int height;\n        //Dynamic array of pointers to heads of linked lists.\n    dataType** xArray;\n    dataType** yArray;\n\npublic:\n        //Constructor. Sets everything in the two arrays to nullptr.\n    sparseMatrix(int height, int width)\n    {\n        this-&gt;width = width;\n        this-&gt;height = height;\n        xArray = new dataType*[width];\n        yArray = new dataType*[height];\n        for (int row = 0; row &lt; height; row++)\n        {\n            this-&gt;yArray[row] = nullptr;\n        }\n        for (int col = 0; col &lt; width; col++)\n        {\n            this-&gt;xArray[col] = nullptr;\n        }\n    }\n\n        //Deconstructor. First goes through the matrix and looks for every city it can find, and deletes\n        //all of those. Then when it's done, it deletes the two dynamic arrays.\n    ~sparseMatrix()\n    {\n        dataType *currentdataType;\n        dataType *next;\n        for (int row = 0; row &lt; height; row++)\n        {\n            currentdataType = yArray[row];\n            while (currentdataType != nullptr)\n            {\n                next = currentdataType-&gt;getRight();\n                delete currentdataType;\n                currentdataType = next;\n            }\n        }\n        delete [] yArray;\n        delete [] xArray;\n    }\n\n\n        //Creates a copy of the data we are passed, then creates links to this copy.\n    void insert(dataType data)\n    {\n            //Make sure the data is valid.\n        if (data.getX() &lt; 0 || data.getX() &gt;= width || data.getY() &lt; 0 || data.getY() &gt;= height)\n        {\n            std::cout &lt;&lt; \"That dataType doesn't fit into the sparse matrix!\\n\";\n            data.print();\n            std::cin.get();\n        }\n\n        else\n        {\n                //Copy the data we were passed.\n            dataType *newData = new dataType(data);\n\n                //Easy case. If nothing is in this row, set yArray[row] to the address of this data.\n            if (yArray[data.getY()] == nullptr)\n            {\n                yArray[data.getY()] = newData;\n            }\n\n                //Not so easy case. Move forward (right) until we find the right location, then set links.\n            else\n            {\n                dataType *current = yArray[data.getY()];\n                while (current-&gt;getRight() != nullptr)\n                {\n                    current = current-&gt;getRight();\n                }\n                current-&gt;setRight(newData);\n            }\n\n                //Easy case. If nothing is in this col, set xArray[col] to the address of this data.\n            if (xArray[data.getX()] == nullptr)\n            {\n                xArray[data.getX()] = newData;\n            }\n\n                //Not so easy case. Move forward (down) until we find the right location, then set links.\n            else\n            {\n                dataType *current = xArray[data.getX()];\n                while (current-&gt;getDown() != nullptr)\n                {\n                    current = current-&gt;getDown();\n                }\n                current-&gt;setDown(newData);\n            }\n        }\n    }\n    void printyArray()\n    {\n        for (int r = 0; r &lt; height; r++)\n        {\n            if (yArray[r] != nullptr)\n            {\n                std::cout &lt;&lt; r &lt;&lt; ' ';\n                //yArray[r]-&gt;print();\n            }\n        }\n    }\n};\n</code></pre>\n\n<p>readFile reads everything in from a file that looks like this:</p>\n\n<pre><code>0   0   hello\n5   2   world\n6   8   foo\n9   5   bar\n...\n</code></pre>\n\n<p>As expected, before returning, the only locations that are NOT nullptr are the ones that I have inserted into. (0, 2, 8 and 5). However when the function returns, EVERY SINGLE location in the array is not nullptr. I added a second function which returns a pointer to dynamically allocated sparseMatrix object, rather then returning the object itself, and this fixed it. However, I don't understand why. It seems like these two functions should behave identically the same way.</p>\n\n<p>Also, the part that is most confusing to me, why does this run perfectly fine in Xcode, but not in Visual Studio?</p>\n"}, {"tags": ["c++", "visual-studio-2010", "winbgi"], "comments": [{"owner": {"reputation": 5969, "user_id": 4320665, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0cDQG.png?s=128&g=1", "display_name": "ryanyuyu", "link": "https://stackoverflow.com/users/4320665/ryanyuyu"}, "edited": false, "score": 1, "creation_date": 1431553062, "post_id": 30225580, "comment_id": 48555158, "body": "If this is more about the IDE instead of the programming, perhaps you could consider migrating your question to <a href=\"http://superuser.com/\">Super User</a>.  Just make sure to not cross-post on both sites."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1431554044, "post_id": 30225580, "comment_id": 48555542, "body": "I think the question is not about IDEs but the <code>WinBGIm</code> emulation library that provides BGI support."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1431554108, "post_id": 30225580, "comment_id": 48555575, "body": "<b><i>So, after initiating graphics mode window Alt + Enter combo isn&#39;t working.</i></b> Is this happening when your program is running or is the program stopped (in the debugger) at a breakpoint ?"}, {"owner": {"reputation": 1, "user_id": 4897549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c7ec9a01adb71d3fac1b4f9bd2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitrii95", "link": "https://stackoverflow.com/users/4897549/dmitrii95"}, "edited": false, "score": 0, "creation_date": 1431554613, "post_id": 30225580, "comment_id": 48555807, "body": "drescherjm, it happens when program is running. It works correctly, window just doesn&#39;t expand at fullscreen."}, {"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "reply_to_user": {"reputation": 5969, "user_id": 4320665, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0cDQG.png?s=128&g=1", "display_name": "ryanyuyu", "link": "https://stackoverflow.com/users/4320665/ryanyuyu"}, "edited": false, "score": 0, "creation_date": 1431609999, "post_id": 30225580, "comment_id": 48578598, "body": "@ryanyuyu IDE questions are off-topic on StackOverflow? Can you link some reference for that? (Not that this question is about an IDE, mind you)"}, {"owner": {"reputation": 5969, "user_id": 4320665, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0cDQG.png?s=128&g=1", "display_name": "ryanyuyu", "link": "https://stackoverflow.com/users/4320665/ryanyuyu"}, "reply_to_user": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1431610211, "post_id": 30225580, "comment_id": 48578754, "body": "@Steve no they are not necessarily off-topic (since they are still related to programming).  It&#39;s just that Super User might be a <i>better fit</i> for these kind of questions.  The way the question is phrased, it sounds like more of a how to use the software, which Super User is expecting, while SO is more concentrated on code.  Granted, I am not active on Super User, but that&#39;s my impression."}], "owner": {"reputation": 1, "user_id": 4897549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c7ec9a01adb71d3fac1b4f9bd2dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitrii95", "link": "https://stackoverflow.com/users/4897549/dmitrii95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431589642, "creation_date": 1431552911, "last_edit_date": 1431589642, "question_id": 30225580, "link": "https://stackoverflow.com/questions/30225580/fullscreen-in-vs-2010-using-winbgim-library", "title": "Fullscreen in VS 2010 using WinBGIm library", "body": "<p>I was using Borland C++ 3.1 (mostly for graphics purposes), and to open program in fullscreen mode I was using Alt + Enter combination.</p>\n\n<p>But lately, I had to switch to Visual Studio 2010, and to continue work with graphics I installed WinBGIm library. So, after initiating graphics mode window Alt + Enter combo isn't working.</p>\n\n<p>Anyone else encountered this problem? I find it kinda hard to work with small objects in 640x480 window.</p>\n"}, {"tags": ["c++", "compiler-errors", "linker-errors", "c++builder-5"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431558641, "post_id": 30225296, "comment_id": 48557196, "body": "Sounds like a bug in TwineCompiler.  You should <a href=\"http://www.jomitech.com/bnf.php?p=TwineCompile4\" rel=\"nofollow noreferrer\">file a bug report</a> with its author."}], "owner": {"reputation": 29, "user_id": 2532027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7319a4f8205548208e28e6bb67f5b80e?s=128&d=identicon&r=PG", "display_name": "Jonathan Wiens", "link": "https://stackoverflow.com/users/2532027/jonathan-wiens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431551576, "creation_date": 1431551576, "question_id": 30225296, "link": "https://stackoverflow.com/questions/30225296/compiler-generating-invalid-object-file", "title": "Compiler generating invalid object file", "body": "<p>I am working on merging some new trunk code into a feature branch on one of our large legacy projects.  This project is written in C++ using C++Builder 5.0.  We also use TwineCompile 3 to speed up our build times.  </p>\n\n<p>After the merge, I now sometimes get the following error when compiling:</p>\n\n<pre><code>[ilink32 Error] Unresolved external '__fastcall TPrintTick\u00dc\u00a9  ::Add(int, int, int, bool, TTicketType, int, bool, bool, bool)' referenced from C:\\PROJECTS\\PRODUCT\\V3.12.X\\SOURCE\\OBJ\\PROCESSOR.OBJ\n</code></pre>\n\n<p>This error only shows up when doing a release build with compiler optimizations turned off (which is how we typically release our code).  If I re-enable compiler optimizations, or if I do a debug build, the error does not appear.  Additionally, if I disable TwineCompile, the problem disappears.</p>\n\n<p>Running TDump on the 'processor.obj' object file shows that it has a reference to an external function TPrintTick\u00dc\u00a9  ::Add.  This function should actually be TPrintTicketQueue::Add.  File processor.cpp contains the following code in one of the functions:</p>\n\n<pre><code>PrintTicketQueue.Add(/*parameters here*/);\n</code></pre>\n\n<p>For reference, file printTicketQueue.h (which is included by processor.cpp) has the following code:</p>\n\n<pre><code>class TPrintTicketQueue\n{\n    public:\n          /* Some more code here */\n\n        void __fastcall Add(int jobID, int ticketID, int numID, bool labelPrint, TTicketType type, int count = 1, bool remote = false, bool print = true, bool printLabelOnly = false);\n};\n\nextern TPrintTicketQueue PrintTicketQueue;\n</code></pre>\n\n<p>To further confuse matters, if I attempt to create a local pointer to a TPrintTicketObject in <em>any</em> function in processor.cpp, I get the following error:</p>\n\n<pre><code>[C++ Error] processor.cpp(291, 18): E2451 Undefined symbol 'TPrintTicketQueue'\n</code></pre>\n\n<p>Despite knowing that printTicketQueue.h has been included in processor.cpp, and thus TPrintTicketQueue should be defined.</p>\n\n<p>I'm at a loss to explain what is happening here.  Has anyone encountered a similar problem with C++Builder 5.0 or TwineCompile?  Is there any way to solve or work around this problem?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 2, "creation_date": 1431552059, "post_id": 30225291, "comment_id": 48554642, "body": "I think you want <code>return readMass()</code> in your error case."}, {"owner": {"reputation": 7982, "user_id": 2679626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ae2587956371769336745ff9ef4dab0?s=128&d=identicon&r=PG", "display_name": "Denilson Amorim", "link": "https://stackoverflow.com/users/2679626/denilson-amorim"}, "edited": false, "score": 0, "creation_date": 1431552093, "post_id": 30225291, "comment_id": 48554663, "body": "Also see <a href=\"http://stackoverflow.com/questions/2525352/problem-of-using-cin-twice\">this</a> and <a href=\"http://stackoverflow.com/questions/5131647/why-would-we-call-cin-clear-and-cin-ignore-after-reading-input\">this</a>."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 1, "creation_date": 1431552437, "post_id": 30225291, "comment_id": 48554851, "body": "<code>clear()</code> is to <a href=\"http://www.cplusplus.com/reference/ios/ios/clear/\" rel=\"nofollow noreferrer\">clear</a>  the error flags"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 3245832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a9d916df487c4761f3a41210b9f51b?s=128&d=identicon&r=PG&f=1", "display_name": "user3245832", "link": "https://stackoverflow.com/users/3245832/user3245832"}, "is_accepted": false, "score": 3, "last_activity_date": 1431552334, "last_edit_date": 1431552334, "creation_date": 1431552166, "answer_id": 30225416, "question_id": 30225291, "link": "https://stackoverflow.com/questions/30225291/how-to-clear-the-buffer-of-an-istringstream-object-in-c/30225416#30225416", "title": "how to clear the buffer of an istringstream object in c++?", "body": "<p><a href=\"http://www.cplusplus.com/reference/sstream/istringstream/str/\" rel=\"nofollow\"><code>iss.str(\"\");</code></a></p>\n\n<p>I'd also recommend putting this inside of a while loop instead of recursively calling the function</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1431553014, "creation_date": 1431553014, "answer_id": 30225602, "question_id": 30225291, "link": "https://stackoverflow.com/questions/30225291/how-to-clear-the-buffer-of-an-istringstream-object-in-c/30225602#30225602", "title": "how to clear the buffer of an istringstream object in c++?", "body": "<p>You need to call <code>str(\"\")</code> to reset the actual buffer, and also call <code>clear()</code> to reset the error flags.</p>\n\n<p>I would suggest you implement the function as a simple loop instead of a recursive call, and just use a new <code>istringstream</code> on each loop iteration:</p>\n\n<pre><code>float readMass()\n{\n    string weight;\n\n    while (getline(cin, weight))\n    {\n        float weightValue;\n        string massUnit;\n\n        istringstream iss(weight);    \n        if (iss &gt;&gt; weightValue &gt;&gt; massUnit)\n        {\n            if (massUnit == \"lb\")\n                return weightValue / 2.20462;\n\n            if (massUnit == \"kg\")\n                return weightValue;\n        }\n\n        cout &lt;&lt; \"Please enter a correct weight and mass indicator: \\n\";\n    }\n\n    return 0.0f;\n}\n</code></pre>\n\n<p>But, if you want it recursive, then you don't need to worry about resetting the <code>istringstream</code> since you will never be using it again, the next recursion will use a new <code>istringstream</code> instance:</p>\n\n<pre><code>float readMass()\n{\n    string weight;\n    getline(cin, weight);\n\n    float weightValue;\n    string massUnit;\n\n    istringstream iss(weight);\n    if (iss &gt;&gt; weightValue &gt;&gt; massUnit)\n    {\n        if (massUnit == \"lb\")\n            return weightValue / 2.20462;\n\n        if (massUnit == \"kg\")\n            return weightValue;\n    }\n\n    cout &lt;&lt; \"Please enter a correct weight and mass indicator: \\n\";\n    return readMass();\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4897507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe76471bd6c0435e56c007c6a45e394?s=128&d=identicon&r=PG&f=1", "display_name": "Clau", "link": "https://stackoverflow.com/users/4897507/clau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1431553014, "creation_date": 1431551570, "question_id": 30225291, "link": "https://stackoverflow.com/questions/30225291/how-to-clear-the-buffer-of-an-istringstream-object-in-c", "title": "how to clear the buffer of an istringstream object in c++?", "body": "<p>I am trying to validate the input in a way that the user always has to enter kg or lb, if it doesn't do it will ask the user to reenter. It works until that point but it doesn't read the new input. I know that I need to clear the buffer but iss.clear() is not working. </p>\n\n<pre><code>float readMass()\n{\n    string weight;\n    getline(cin, weight);\n\n    float weightValue;\n    string massUnit;\n    istringstream iss(weight);\n    streampos pos = iss.tellg();\n\n    iss &gt;&gt; weightValue &gt;&gt; massUnit;\n\n    if (massUnit == \"lb\")\n    {\n        weightValue = weightValue / 2.20462;\n    }\n    else if (massUnit == \"kg\")\n    {\n        weightValue = weightValue;\n    }\n    else\n    {\n        cout &lt;&lt; \"Please enter a correct weight and mass indicator: \\n\";\n        iss.clear();\n        readMass();\n    }\n\n    return weightValue;\n}\n</code></pre>\n"}, {"tags": ["c++", "omnet++", "inet"], "comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1431557337, "post_id": 30225285, "comment_id": 48556827, "body": "&quot;no matching <i>function</i> for call&quot; ?? is that really the error message?"}, {"owner": {"reputation": 148, "user_id": 3579012, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f761373087a82a372f07bed21072a96b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3579012/peter"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1431561064, "post_id": 30225285, "comment_id": 48557861, "body": "<code>no matching function for call to \u2018check_and_cast(cModule*&amp;)\u2019 </code> its the exact error. I apologize that I haven&#39;t notice last time"}, {"owner": {"reputation": 148, "user_id": 3579012, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f761373087a82a372f07bed21072a96b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3579012/peter"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1431561433, "post_id": 30225285, "comment_id": 48557957, "body": "@Karoly ovrath - I even tried to look for it omnet google group, where I got this tread :- <a href=\"https://groups.google.com/forum/#!topic/omnetpp/2CNpYn6E_14\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/omnetpp/2CNpYn6E_14</a> , which implies that the varaible name (mobility) should not be same as object name (mobilitymod).."}, {"owner": {"reputation": 1487, "user_id": 4786271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd121447bed041136af416d31980d080?s=128&d=identicon&r=PG&f=1", "display_name": "user4786271", "link": "https://stackoverflow.com/users/4786271/user4786271"}, "edited": false, "score": 0, "creation_date": 1431605183, "post_id": 30225285, "comment_id": 48575494, "body": "try <code>dynamic_cast</code> instead of <code>check_and_cast</code>, something in the lines of: <code>mobility = dynamic_cast&lt;Veins::TraCIMobility*&gt;(tmpMobility);</code> and then add an assert: <code>ASSERT(mobility);</code>"}, {"owner": {"reputation": 1487, "user_id": 4786271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd121447bed041136af416d31980d080?s=128&d=identicon&r=PG&f=1", "display_name": "user4786271", "link": "https://stackoverflow.com/users/4786271/user4786271"}, "edited": false, "score": 0, "creation_date": 1431609842, "post_id": 30225285, "comment_id": 48578493, "body": "did you have the <code>Enter_Method(&quot;&lt;method_name&gt;&quot;)</code> macro in the <i>public</i> method that is called from outside? And maybe the method you are trying to call is a just a prototype without the actual implementation..."}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 3579012, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f761373087a82a372f07bed21072a96b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3579012/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1433750010, "creation_date": 1433750010, "answer_id": 30703786, "question_id": 30225285, "link": "https://stackoverflow.com/questions/30225285/omnet-access-method-of-another-submodule-error-no-matching-function-for-call-t/30703786#30703786", "title": "Omnet access method of another submodule error - no matching function for call to \u2018check_and_cast(cModule*&amp;)\u2019", "body": "<p>Well I figure out the problem. First thing I needed to add header file of mobility module in my current sub module to get the definitions. So I included- </p>\n\n<pre><code>#include \"MassMobility.h\"\n#include \"StationaryMobility.h\"\n</code></pre>\n\n<p>then in code I did following modification:-</p>\n\n<pre><code>cModule* parentmod = getParentModule();\ncModule* mobilitymod = parentmod-&gt;getParentModule()-&gt;getSubmodule(\"mobility\");\nMassMobility* massMobilityMod = dynamic_cast&lt;MassMobility*&gt;(mobilitymod);\nEV&lt;&lt;\"Current position is &lt;&lt;\"massMobilityMod-&gt;getCurrentPosition();\n</code></pre>\n\n<p>So the reason for the errors is the lack of definitions, which is provided by the header files in this solution. </p>\n"}], "owner": {"reputation": 148, "user_id": 3579012, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f761373087a82a372f07bed21072a96b?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3579012/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 30703786, "answer_count": 1, "score": 1, "last_activity_date": 1433750010, "creation_date": 1431551527, "last_edit_date": 1431605845, "question_id": 30225285, "link": "https://stackoverflow.com/questions/30225285/omnet-access-method-of-another-submodule-error-no-matching-function-for-call-t", "title": "Omnet access method of another submodule error - no matching function for call to \u2018check_and_cast(cModule*&amp;)\u2019", "body": "<p><strong>Error:</strong> no matching function for call to \u2018check_and_cast(cModule*&amp;)\u2019</p>\n\n<p>I am trying to use the current position from another module \"mobility\" with n class type MassMobility.</p>\n\n<pre><code>cModule* parentmod = getParentModule();\n\ncModule* mobilitymod = parentmod-&gt;getParentModule()-&gt;getSubmodule(\"mobility\");\nEV&lt;&lt;\"Current module is \"&lt;&lt;mobilitymod-&gt;getFullName() &lt;&lt;endl;\n\nMassMobility* mobility = check_and_cast&lt;MassMobility *&gt;(mobilitymod);\nmobility-&gt;getCurrentPosition();\n</code></pre>\n\n<p>I am getting compile time error :- <code>no matching function for call to \u2018check_and_cast(cModule*&amp;)\u2019</code>. But still I am able to get the functions from the mobility object as shown in last line. Can anybody please suggest me how can I correct it.</p>\n"}, {"tags": ["c++", "function", "vector"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1431552345, "post_id": 30225278, "comment_id": 48554800, "body": "<code>ret_vec</code> takes a copy of a vector, attempts to copy the copy the long way (and doesn&#39;t do that right), and returns the copy of the copy."}], "answers": [{"tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": false, "score": 10, "last_activity_date": 1431552266, "last_edit_date": 1431552266, "creation_date": 1431551577, "answer_id": 30225297, "question_id": 30225278, "link": "https://stackoverflow.com/questions/30225278/return-vector-from-a-function-c/30225297#30225297", "title": "Return vector from a function C++", "body": "<blockquote>\n  <p>I am trying to return a vector with the values in the reverse order</p>\n</blockquote>\n\n<p>The simplest approach would be to use C++:</p>\n\n<pre><code>vector&lt;int&gt; reverse_vec(const vector&lt;int&gt;&amp; n)\n{\n  vector&lt;int&gt; ret(n.rbegin(), n.rend());\n  return ret;\n}\n</code></pre>\n\n<p>Here, reverse iterators are used to construct a vector with the contents of the input vector reversed. Alternatively, if you want to reverse a vector in place, use <a href=\"http://en.cppreference.com/w/cpp/algorithm/reverse\"><code>std::reverse</code></a>:</p>\n\n<pre><code>vector&lt;int&gt; v = ....\nstd::reverse(v.begin(), v.end()); // v is now reversed\n</code></pre>\n\n<p>As for problems with your code, an obvious one is that you are accessing a vector out of bounds here:</p>\n\n<pre><code>vector &lt;int&gt; n2; // empty vector\n\nfor (int i = 0; i&lt; n.size(); ++i){\n    n2[i] = n[i]; // oops! n2 accessed out of bounds!\n}\n</code></pre>\n\n<p>The fix is not to use this code at all and go for the simple option.</p>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 3581442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c7a638579046483e2851fffd8dc49355?s=128&d=identicon&r=PG&f=1", "display_name": "Doan", "link": "https://stackoverflow.com/users/3581442/doan"}, "is_accepted": true, "score": 1, "last_activity_date": 1525719824, "last_edit_date": 1525719824, "creation_date": 1431552555, "answer_id": 30225496, "question_id": 30225278, "link": "https://stackoverflow.com/questions/30225278/return-vector-from-a-function-c/30225496#30225496", "title": "Return vector from a function C++", "body": "<p>In the following function</p>\n\n<pre><code>vector&lt;int&gt; ret_vec(vector&lt;int&gt;n){\n    vector &lt;int&gt; n2;\n\n    for (int i = 0; i&lt; n.size(); ++i){\n        n2[i] = n[i];\n    }\n\n    return n2;\n}\n</code></pre>\n\n<p>You are just copy the content of the parameter vector. (I thing you forgot a space between the parameter and the typ of it)</p>\n\n<p>You can revers the order like this way, too (its reverse it \"by hand\"):</p>\n\n<pre><code>vector&lt;int&gt; ret_vec(vector&lt;int&gt; n){\n    vector &lt;int&gt; n2;\n\n    for(int i=n1.size()-1; i&lt;=0; --i) \n    { \n        n2.push_back(n1[i]);\n    }\n\n    return n2;\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 4777280, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-3Ln-mKzY6YY/AAAAAAAAAAI/AAAAAAAAVr0/rzc7K7pho_A/photo.jpg?sz=128", "display_name": "Eduardo Hashimoto", "link": "https://stackoverflow.com/users/4777280/eduardo-hashimoto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5507, "favorite_count": 0, "accepted_answer_id": 30225496, "answer_count": 2, "score": 3, "last_activity_date": 1525719824, "creation_date": 1431551503, "question_id": 30225278, "link": "https://stackoverflow.com/questions/30225278/return-vector-from-a-function-c", "title": "Return vector from a function C++", "body": "<p>I am trying to return a vector with the values in the reverse order (e.g, I enter a vector with 0,1,2,3,4 and the function return a vector with 4,3,2,1,0).</p>\n\n<p>The compiler says: Segmentation fault.</p>\n\n<p>In my tests I observed that probably my problem is in the assignment <code>new2 = ret_vec(numbers);</code>, but I don't know what is going on.</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nvector&lt;int&gt; ret_vec(vector&lt;int&gt;n){\n    vector &lt;int&gt; n2;\n\n    for (int i = 0; i&lt; n.size(); ++i){\n        n2[i] = n[i];\n    }\n\n    return n2;\n}\n\nvoid initializer(int s, vector&lt;int&gt;&amp; n){\n\n    for (int i = 0; i&lt; s; ++i){\n        n.push_back(i);\n    }\n}\n\nvoid print_vector(vector&lt;int&gt; n){\n\n    for (int i = 0; i&lt;n.size(); ++i){\n        cout &lt;&lt; n[i] &lt;&lt; \" \";\n    }\n}\n\nint main () {\n    vector &lt;int&gt; numbers;\n    int size;\n\n    cin &gt;&gt; size;\n    initializer(size,numbers);\n\n    vector &lt;int&gt; new2(numbers.size());\n\n    cout &lt;&lt; \"Old \";\n    print_vector(numbers);\n\n    new2 =  ret_vec(numbers);\n\n    cout &lt;&lt; \"New \";\n    print_vector(new2);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio", "visual-c++"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1431552007, "post_id": 30225208, "comment_id": 48554611, "body": "(1) Source code can change depending on the order of the included files. Think about the order of #define(s) and/or #ifdef(s) for example."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1431552063, "post_id": 30225208, "comment_id": 48554647, "body": "Each one of these questions, alone, would be a good question here.  Some or all might be duplicates.  I think you&#39;re limiting the answers you get by asking for &quot;an answer&quot; to a large bundle of questions.  I predict mostly comments here choosing one question to answer."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1431552136, "post_id": 30225208, "comment_id": 48554686, "body": "From what you&#39;ve shown, most of your confusion regarding how VS pch works is covered by the <a href=\"https://msdn.microsoft.com/en-us/library/szfdksca.aspx\" rel=\"nofollow noreferrer\">documention by MS</a>. The fundamental purpose of PCH is to precompile that which is used by your project <b>and</b> has very low or ideally <b>no</b> volatility. Project-defined headers generally do <i>not</i> fit into that category, while runtime library headers, 3rd-party headers, etc., generally <i>do</i>."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1431552289, "post_id": 30225208, "comment_id": 48554770, "body": "I usually only include external header files for precompiling.  System header files, header files for prebuilt libraries etc."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1431552530, "post_id": 30225208, "comment_id": 48554898, "body": "(4) It&#39;s compiler specific. But can be cross-platform with a cross-platform compiler."}], "answers": [{"comments": [{"owner": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 0, "creation_date": 1431555074, "post_id": 30225481, "comment_id": 48556022, "body": "So on my Q 2, am I understanding you correctly that the answer is basically yes, it does violate preferred encapsulation practices, due to the implementation / limitations of C/C++? i.e. Including header1.h and header2.h in the precompiled header in your example would result in both of those being included in both source files, even though it&#39;s only needed in the one."}, {"owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "reply_to_user": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 1, "creation_date": 1431592310, "post_id": 30225481, "comment_id": 48567963, "body": "@cp.engr Yes, that is correct, you will pretty much always have extra stuff included that you do not need. Usually, this doesn&#39;t matter though.. For example, if you precompiled all of the C standard library headers, or even all of the <code>std</code> namespace, it wouldn&#39;t be a problem. On large projects, you likely have the files grouped somehow, for example &quot;encryption&quot; and &quot;image manipulation&quot;, and you can have a special precomp for each, if you don&#39;t want the headers mixing in."}], "tags": [], "owner": {"reputation": 2742, "user_id": 2771245, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/vhsVn.jpg?s=128&g=1", "display_name": "mtijanic", "link": "https://stackoverflow.com/users/2771245/mtijanic"}, "is_accepted": false, "score": 0, "last_activity_date": 1431553017, "last_edit_date": 1431553017, "creation_date": 1431552488, "answer_id": 30225481, "question_id": 30225208, "link": "https://stackoverflow.com/questions/30225208/c-c-precompiled-headers-encapsulation-how-to-and-why-is-config-required/30225481#30225481", "title": "C/C++ - precompiled headers - encapsulation, how to, and why is config required?", "body": "<blockquote>\n  <p>Why can't the compiler (or linker/IDE?) just have individual precompiled header object files, in the same way it does for the source files (i.e. .obj files)?</p>\n</blockquote>\n\n<p>The answer to 1 and 2 is in the way how precompiled headers work. Assume you have a <code>my_source_file.c</code>:</p>\n\n<pre><code>#include \"header1.h\"\n#include \"header2.h\"\n\nint func(int x) { return x+1; }\n</code></pre>\n\n<p><code>my_other_source_file.c</code>:</p>\n\n<pre><code>#include \"header1.h\"\n\nint func2(int x) { return x-1; } \n</code></pre>\n\n<p>When you call <code>compiler.exe my_source_file.c</code> the compiler starts parsing your file. All the internal variables of the compiler (things like which types have been defined, what variables declared, etc) are called the compiler state.</p>\n\n<p>After it has parsed <code>header1.h</code> it can save the state to the disk. Then, when compiling <code>my_other_source_file.c</code>, instead of parsing <code>header1.h</code> again, it can just load the state and continue.</p>\n\n<p>That state is a precompiled header. It is literally just a dump of all the compiler variables in the moment after it has parsed the entire header.</p>\n\n<p>Now, the question is why can't you have two state dumps, for <code>header1.h</code> and <code>header2.h</code> and just load them both.. Well, the states are not independent. The second file would be the state of <code>header1.h + header2.h</code>. So, what is usually done is you have one state which is after <em>all</em> the common header files have been compiled, and use that.</p>\n\n<p>In theory, you could have one for every combination and use the appropriate one, but that is much more hassle than it's worth.</p>\n\n<p>Some things that are side effects of how this is done:</p>\n\n<ul>\n<li><p>Different compilers (including even minor versions) have different variables, so you can't reuse the precomps.</p></li>\n<li><p>Since the dumped state started from the top of the file, your precomp must be the first include. There must be nothing that could influence the state (i.e. not #defines, typedefs, declarations) before including the precomp.</p></li>\n<li><p>Any defines passed by the command line (<code>-DMY_DEFINE=0</code>) will not be picked up in the precompiled header.</p></li>\n<li>Any defines passed by the command line while precompiling will be in effect for all source files that use the precomp.</li>\n</ul>\n\n<hr>\n\n<p>For 3), refer to MSFT <a href=\"https://msdn.microsoft.com/en-us/library/szfdksca.aspx\" rel=\"nofollow\">documentation</a>.</p>\n\n<p>For 4), most compilers support precompiled headers, and they generally work in the same way. You could configure your makefiles/build scripts to always precompile a certain header (e.g. <code>stdafx.h</code>) which would include all the other headers. As far as your source code goes, you'd always just <code>#include \"stdafx.h\"</code>, regardless of the platform.</p>\n"}, {"comments": [{"owner": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 0, "creation_date": 1431563751, "post_id": 30225598, "comment_id": 48558595, "body": "&quot;It might increase coupling and dependencies by making some names available across all files, but in general, this is not a problem.&quot; Maybe &#39;breaking encapsulation&#39; wasn&#39;t optimal phrasing, but my point is that doing this exposes a whole bunch of stuff that YAGN[I]. Personally, I think it obfuscates where things are coming from, and makes it harder to keep a module tightly focused. (&quot;Module&quot; not in the language-specific sense; often consisting of a .c and a .h file.) Else, e.g. why not have one include file for the whole STL?"}, {"owner": {"reputation": 2998, "user_id": 4885801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/m1Nbb.png?s=128&g=1", "display_name": "isanae", "link": "https://stackoverflow.com/users/4885801/isanae"}, "reply_to_user": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 0, "creation_date": 1431574858, "post_id": 30225598, "comment_id": 48561175, "body": "I&#39;d personally welcome an &quot;always available&quot; standard library, as long as it doesn&#39;t impact build time. Including 3rd-party headers in a pch might sound bad, but in general, it makes no difference. Coupling is important <i>within</i> your program, not with 3rd-party."}, {"owner": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 0, "creation_date": 1431576013, "post_id": 30225598, "comment_id": 48561498, "body": "You&#39;re not addressing my points. You&#39;re saying it doesn&#39;t matter, but not explaining why. &quot;Coupling is important within your program, not with 3rd-party.&quot; How did you make that determination? On what basis do you differentiate?"}, {"owner": {"reputation": 2998, "user_id": 4885801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/m1Nbb.png?s=128&g=1", "display_name": "isanae", "link": "https://stackoverflow.com/users/4885801/isanae"}, "reply_to_user": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 0, "creation_date": 1431576476, "post_id": 30225598, "comment_id": 48561597, "body": "Based on my experience and knowledge. How else? And it is hard to be verbose in comments. SO is not suited for chatting back in forth, so I&#39;ll edit my post in a few minutes with more information."}, {"owner": {"reputation": 2998, "user_id": 4885801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/m1Nbb.png?s=128&g=1", "display_name": "isanae", "link": "https://stackoverflow.com/users/4885801/isanae"}, "reply_to_user": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "edited": false, "score": 0, "creation_date": 1431578452, "post_id": 30225598, "comment_id": 48562142, "body": "@cp.engr I just added a rather long explanation. I hope you find it interesting."}], "tags": [], "owner": {"reputation": 2998, "user_id": 4885801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/m1Nbb.png?s=128&g=1", "display_name": "isanae", "link": "https://stackoverflow.com/users/4885801/isanae"}, "is_accepted": false, "score": 0, "last_activity_date": 1431578363, "last_edit_date": 1495542603, "creation_date": 1431552988, "answer_id": 30225598, "question_id": 30225208, "link": "https://stackoverflow.com/questions/30225208/c-c-precompiled-headers-encapsulation-how-to-and-why-is-config-required/30225598#30225598", "title": "C/C++ - precompiled headers - encapsulation, how to, and why is config required?", "body": "<blockquote>\n  <p>Why can't the compiler (or linker/IDE?) just have individual\n  precompiled header object files</p>\n</blockquote>\n\n<p>C and C++ have no concept of modules. The traditional compiler has a preprocessor phase (which may be invoked as a separate program) that will include the files and the whole thing will get compiled to intermediate code. The compiler per se does not see includes (or comments, or trigraphs, etc.).</p>\n\n<p>Add to this that the behaviour of a header file can change depending on the context in which it is included (think macros, for example) and you end up with either many precompiled versions of the same header, or an intermediate form that is basically the language itself.</p>\n\n<blockquote>\n  <p>Am I understanding correctly?</p>\n</blockquote>\n\n<p>Mostly. The actual name is irrelevant, as it can be specified in the project options. <code>stdafx.h</code> is a relic of the early development of MFC, which was originally named AFX (Application Framework eXtensions). The preprocessor also treats includes of the precompiled header differently, as they are not looked up in the include paths. If the name matches what is in the project settings, the <code>.pch</code> is used automatically.</p>\n\n<blockquote>\n  <p>Doesn't this break encapsulation</p>\n</blockquote>\n\n<p>Not really. Encapsulation is an object-oriented feature and has nothing to do with include files. It might increase coupling and dependencies by making some names available across all files, but in general, this is not a problem. Most includes in a precompiled header are standard headers or third-party libraries, that is, headers that may be large and fairly static.</p>\n\n<p>As an example, a project I'm currently working on includes GTK, standard headers, boost and various internal libraries. It can be assumed that these headers never change. Even if they changed once a day, I probably compile every minute or so on average, so it is more than worth it.</p>\n\n<p>The fact that all these names are available project-wide makes no difference. What would I gain by including <code>boost/tokenizer.hpp</code> in only one .cpp file? Perhaps some intellectual satisfaction of knowing that I can only use <code>boost::char_separator</code> in that particular file. But it certainly creates no problem. All these headers are part of a collection of utilities that my program can use. I am completely dependent on them, because I made a design decision early on to integrate them. I am tightly coupled with them by choice.</p>\n\n<p>However, this program needs to access system-specific graphical facilities, and it needs to be portable on (at least) Debian and Windows. Therefore, I centralized all these operations in two files: <code>windows.cpp</code> and <code>x11.cpp</code>. They both include their own <code>X11/Xlib.h</code> and <code>windows.h</code>. This makes sure I don't use non-portable stuff elsewhere (which would however quickly be caught as I keep switching back and forth) and it satisfies my obsession with design. In reality, they could have been in the precompiled header. It doesn't make much of a difference.</p>\n\n<p>Finally, none of the headers that are part of this specific program are in the precompiled header. <em>This</em> is where coupling and dependencies come into play. Reducing the number of available names forces you to think about design and architecture. If you try to use something and get an error saying that that name isn't declared, you don't blindly include the file. You stop and think: does it make sense for this name to be available here, or am I mixing up my user interface and data acquisition? It helps you separate the various parts of your program.</p>\n\n<p>It also serves as a \"compilation firewall\", where modifying a header won't require you to rebuild the whole thing. This is more of a language issue than anything else, but in practice, it's still damn useful.</p>\n\n<p>Trying to localize the GTK includes, for example, would not be helpful: all of my user interface uses it. I have no intention of supporting a different kind of toolkit. Indeed, I chose GTK because it was portable and I wouldn't have to port the interface myself.</p>\n\n<p>What would be the point of only including the GTK headers in the user interface files? Obviously, it will prevent me from using GTK in files where I don't need to. But this is not solving any problem. I'm not inadvertently using GTK in places I shouldn't. It only slows down my build time.</p>\n\n<blockquote>\n  <p>How do I utilize precompiled headers in Visual Studio</p>\n</blockquote>\n\n<p>This has been answered <a href=\"https://stackoverflow.com/a/4726838/4885801\">elsewhere</a>. If you need more help, I suggest you ask a new question, as this one is already pretty big.</p>\n\n<blockquote>\n  <p>Is there a cross-platform way to use or facilitate precompiled headers?</p>\n</blockquote>\n\n<p>A precompiled header is a feature provided by your compiler or build system. It is not inherently tied to a platform. If you are asking whether there is a portable way of using precompiled headers across compilers, then no. They are highly compiler-dependent.</p>\n"}], "owner": {"reputation": 1832, "user_id": 1995714, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/a31af2d7cce2d77e5d6c67b0415c6a2e?s=128&d=identicon&r=PG", "display_name": "cp.engr", "link": "https://stackoverflow.com/users/1995714/cp-engr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1431578363, "creation_date": 1431551194, "question_id": 30225208, "link": "https://stackoverflow.com/questions/30225208/c-c-precompiled-headers-encapsulation-how-to-and-why-is-config-required", "title": "C/C++ - precompiled headers - encapsulation, how to, and why is config required?", "body": "<p>I understand the idea that precompiling headers can speed up build times, but there are a handful of questions that have thus far prevented me from grokking them.</p>\n\n<ol>\n<li><p>Why does using precompiled headers require the developer to configure anything?</p>\n\n<p>Why can't the compiler (or linker/IDE?) just have individual precompiled header object files, in the same way it does for the source files (i.e. .obj files)? Dependencies are indicated by which source/header files include which other files, and it can already detect when source files change, so a regular build is normally not a full rebuild. Instead of requiring me to specify which headers get precompiled, etc., why isn't this all just always automatically on, and transparent to the developer?</p></li>\n<li><p>As I understand the precompiled headers methodology in Visual Studio, the idea is that you get this one big header file (stdafx.h) that includes all the other header files that you want to be precompiled, and then you include that in all your source files that use any of those headers.</p>\n\n<p>a. Am I understanding correctly?</p>\n\n<p>b. Doesn't this break encapsulation? Often effectively including various (likely) unrelated items that you don't, which makes it harder to tell what libraries you're actually using, and what comes from where.</p>\n\n<p>It seems to me that this implementation forces bad practices. What am I missing?</p></li>\n<li><p>How do I utilize precompiled headers in Visual Studio (2013)?</p></li>\n<li><p>Is there a cross-platform way to use or facilitate precompiled headers?</p></li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "clang", "llvm", "llvm-clang"], "comments": [{"owner": {"reputation": 5294, "user_id": 315046, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/074b5aae0a564bb72dc210c9c63abd87?s=128&d=identicon&r=PG", "display_name": "Peter Teoh", "link": "https://stackoverflow.com/users/315046/peter-teoh"}, "edited": false, "score": 0, "creation_date": 1526087847, "post_id": 30225194, "comment_id": 87620521, "body": "for a large complex piece of software involving generating and manipulating many bitcode files, you may want to consider the all the steps suggested by:   <a href=\"https://stackoverflow.com/questions/17459800/creating-and-using-llvm-bitcode-libraries\" title=\"creating and using llvm bitcode libraries\">stackoverflow.com/questions/17459800/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2011, "user_id": 5272893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2637f33878f35b750c76ccc428025a32?s=128&d=identicon&r=PG&f=1", "display_name": "serge-sans-paille", "link": "https://stackoverflow.com/users/5272893/serge-sans-paille"}, "is_accepted": false, "score": 0, "last_activity_date": 1441025111, "creation_date": 1441025111, "answer_id": 32311618, "question_id": 30225194, "link": "https://stackoverflow.com/questions/30225194/how-to-generate-llvm-bitcode-for-a-file-using-a-compilation-database/32311618#32311618", "title": "How to generate LLVM bitcode for a file using a compilation database?", "body": "<p>Instead of parsing the compilation database yourself, you could rely on the Python binding to do so. Judging from the <a href=\"https://github.com/llvm-mirror/clang/blob/master/bindings/python/tests/cindex/test_cdb.py#L37\" rel=\"nofollow\">test suite</a> of the binding, you could do something like:</p>\n\n<pre><code>cdb = CompilationDatabase.fromDirectory(kInputsDir)\ncmds = cdb.getAllCompileCommands()\n</code></pre>\n\n<p>and then slightly update the content of <code>cmds</code>.   </p>\n"}], "owner": {"reputation": 1362, "user_id": 689344, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b48fec46c0f0028d96b03edd07c1e294?s=128&d=identicon&r=PG", "display_name": "stepthom", "link": "https://stackoverflow.com/users/689344/stepthom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 828, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1441025111, "creation_date": 1431551146, "question_id": 30225194, "link": "https://stackoverflow.com/questions/30225194/how-to-generate-llvm-bitcode-for-a-file-using-a-compilation-database", "title": "How to generate LLVM bitcode for a file using a compilation database?", "body": "<p>I want to generate LLVM bitcode for a large number of C source files for which I have a <a href=\"http://clang.llvm.org/docs/JSONCompilationDatabase.html\" rel=\"nofollow\">compilation database </a>. Is there way to invoke <code>clang</code> such that it reads the compilation database and uses the appropriate flags?</p>\n\n<h2>Background</h2>\n\n<p>For toy programs, the command to generate LLVM bitcode is simple:</p>\n\n<pre><code>clang -emit-llvm -c foo.c -o foo.bc\n</code></pre>\n\n<p>However, source files in large projects require lots of additional compilation flags, including <code>-I</code>s and <code>-D</code>s and whatnot.</p>\n\n<p>I want to write a script that iterates over a large number of source files and calls <code>clang -emit-llvm ...</code> on each to generate LLVM bitcode. The difficulty is that each <code>clang -emit-llvm ...</code> command has to have the flags specific to that source file. I have a compilation database for these source files, which perfectly captures the flags needed for each individual source file. <strong>Is there a way to make <code>clang -emit-llvm ...</code> aware of my compilation database?</strong></p>\n\n<p>One solution I've thought of is to parse the compilation database myself and find the appropriate entry for each source file, and modify the <code>command</code> entry to (a) include <code>-emit-llvm</code> and (b) change <code>-o foo.o</code> to <code>-o foo.bc</code>, and then run the command. This might work, but seems a bit hacky.</p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "edited": false, "score": 3, "creation_date": 1431551504, "post_id": 30225187, "comment_id": 48554370, "body": "Are you including the header file <b>before</b> any other OpenGL files?"}, {"owner": {"reputation": 125, "user_id": 2898700, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0137e9788fdf2e97e64ad3c32803eb73?s=128&d=identicon&r=PG&f=1", "display_name": "Maxwell Miller", "link": "https://stackoverflow.com/users/2898700/maxwell-miller"}, "reply_to_user": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "edited": false, "score": 3, "creation_date": 1431553203, "post_id": 30225187, "comment_id": 48555216, "body": "You, good sir, are a genius. I thought I had, because I had seen that before, but then I thought myself, &quot;What about before the windows.h, because can&#39;t that have OGL stuff in it&quot;.  I move the gl3w.h into my standard header (I call it Atom.h) above the windows.h, and boom, no more error. Thank you so much. I lost sleep over this one."}], "owner": {"reputation": 125, "user_id": 2898700, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0137e9788fdf2e97e64ad3c32803eb73?s=128&d=identicon&r=PG&f=1", "display_name": "Maxwell Miller", "link": "https://stackoverflow.com/users/2898700/maxwell-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1091, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1431552832, "creation_date": 1431551116, "last_edit_date": 1431552832, "question_id": 30225187, "link": "https://stackoverflow.com/questions/30225187/when-trying-to-use-gl3w-h-error-c2146-syntax-error-missing-before-identi", "title": "When trying to use GL3W.h: error C2146: syntax error : missing &#39;;&#39; before identifier &#39;gl3wBindTexture&#39;", "body": "<p>I am trying to use GL3W to get the function pointers for an OpeGL framework that I am making. Anytime that I include gl3w.h in the project, I get 28 errors. Here they are: </p>\n\n<blockquote>\n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(74): error\n  C2146: syntax error : missing ';' before identifier 'gl3wBindTexture'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(74): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(140): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wCopyTexImage1D'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(140): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(141): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wCopyTexImage2D'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(141): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(142): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wCopyTexSubImage1D'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(142): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(143): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wCopyTexSubImage2D'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(143): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(178): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wDeleteTextures'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(178): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(195): error\n  C2146: syntax error : missing ';' before identifier 'gl3wDrawArrays'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(195): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(201): error\n  C2146: syntax error : missing ';' before identifier 'gl3wDrawElements'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(201): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(241): error\n  C2146: syntax error : missing ';' before identifier 'gl3wGenTextures'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(241): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(299): error\n  C2146: syntax error : missing ';' before identifier 'gl3wGetPointerv'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(299): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(410): error\n  C2146: syntax error : missing ';' before identifier 'gl3wIsTexture'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(410): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(464): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wPolygonOffset'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(464): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(572): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wTexSubImage1D'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(572): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(573): error\n  C2146: syntax error : missing ';' before identifier\n  'gl3wTexSubImage2D'</p>\n  \n  <p>1>c:\\projects\\project_boxes\\exlib\\ogl_headers\\gl\\gl3w.h(573): error\n  C4430: missing type specifier - int assumed. Note: C++ does not\n  support default-int 2>  Killer1_Engine.vcxproj ->\n  C:\\Projects\\Killer1_Engine\\Build\\Killer1_Engine....\\Bin\\Win32Debug\\Killer1_Engine_Win32_Debug.lib\n  ========== Build: 1 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========</p>\n</blockquote>\n\n<p>I downloaded the source code from the GL3W site, and have tried it both after compiling the code into a static library (.lib) and with just including the .c file, and the headers. When I compile the library, it works without issues, but its whenever I link to it that I have issues. I would really like to use this library, but I have no idea what I am doing wrong. </p>\n"}, {"tags": ["c++", "qt", "state-machine"], "comments": [{"owner": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1431551799, "post_id": 30225139, "comment_id": 48554529, "body": "Why do you want to do this ? Isn&#39;t your initial state fixed ?"}, {"owner": {"reputation": 115, "user_id": 792081, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/ac3bfa5a84fe5188688c951c894e8a78?s=128&d=identicon&r=PG", "display_name": "ruddy", "link": "https://stackoverflow.com/users/792081/ruddy"}, "reply_to_user": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1431552045, "post_id": 30225139, "comment_id": 48554636, "body": "My application is a phone basically. User can press prior to a call the AutoAnswer button. If a call comes in and it goes to the mega INCALLSESSION state. That INCALLSESSION initial sub state should be TALKING if AutoAnswer=true and RINGING if AutoAnswer=false"}, {"owner": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1431552231, "post_id": 30225139, "comment_id": 48554737, "body": "Okay, but you need to know where to start your machine. So I think you need to setup your state machine and when you want to start it, you need to setup you initial state there with a conditional expression."}, {"owner": {"reputation": 115, "user_id": 792081, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/ac3bfa5a84fe5188688c951c894e8a78?s=128&d=identicon&r=PG", "display_name": "ruddy", "link": "https://stackoverflow.com/users/792081/ruddy"}, "reply_to_user": {"reputation": 2559, "user_id": 4789375, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/LRyDO.png?s=128&g=1", "display_name": "p.i.g.", "link": "https://stackoverflow.com/users/4789375/p-i-g"}, "edited": false, "score": 0, "creation_date": 1431552441, "post_id": 30225139, "comment_id": 48554856, "body": "My state machine is well setup. What I&#39;m talking about here is substates inside another state. So, I have states &quot;IDLE&quot; and  &quot;InCallSession&quot;. Then &quot;Talking&quot; and &quot;Ringing&quot; are substates of &quot;InCallSession&quot;. So, at the end, then the EventNewCall is triggered, the state machine should go to &quot;Ringing&quot; or &quot;Talking&quot; based on the AutoAnswer value."}, {"owner": {"reputation": 1763, "user_id": 1238317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nWFwS.jpg?s=128&g=1", "display_name": "fider", "link": "https://stackoverflow.com/users/1238317/fider"}, "edited": false, "score": 0, "creation_date": 1442475181, "post_id": 30225139, "comment_id": 53099521, "body": "You can always inherit from QStateMachine class and overwrite this method like: {     static bool initialized = false;     if (false == initialized){         initialized = true;         QStateMachine::setInitialState(..);     } }"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 503542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188da64f0d27ec46e7319a6109f43fed?s=128&d=identicon&r=PG", "display_name": "Francis", "link": "https://stackoverflow.com/users/503542/francis"}, "is_accepted": false, "score": 0, "last_activity_date": 1563303057, "creation_date": 1563303057, "answer_id": 57063729, "question_id": 30225139, "link": "https://stackoverflow.com/questions/30225139/qt-state-machine-how-to-set-guard-on-initial-state/57063729#57063729", "title": "Qt state machine : How to set guard on initial state?", "body": "<p>I've worked with statecharts frameworks and it doesn't seem like Qt treats this as normal transition.  I think you'll have to create a \"init\" puedo-state that setInitialState will go into and then you have to set guards when you transition out of that state.</p>\n"}], "owner": {"reputation": 115, "user_id": 792081, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/ac3bfa5a84fe5188688c951c894e8a78?s=128&d=identicon&r=PG", "display_name": "ruddy", "link": "https://stackoverflow.com/users/792081/ruddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563303057, "creation_date": 1431550982, "last_edit_date": 1431553359, "question_id": 30225139, "link": "https://stackoverflow.com/questions/30225139/qt-state-machine-how-to-set-guard-on-initial-state", "title": "Qt state machine : How to set guard on initial state?", "body": "<p>From Qt state machine documentation, I can set, in a main state, the initial substate.</p>\n\n<pre><code>QStateMachine machine;\nQState *s1 = new QState();\nmachine.addState(s1);\nmachine.setInitialState(s1);\n</code></pre>\n\n<p>I can also add guard to transition between different states.</p>\n\n<p>But how can I add a guard on an initial state.</p>\n\n<pre><code>QState *s1 = new QState();\nQState *s2 = new QState();\nmachine.addState(s1);\nmachine.addState(s2);\nmachine.setInitialState(s1, ifblabla_istrue);\nmachine.setInitialState(s2, ifblabla_isfalse);\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2012"], "comments": [{"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "edited": false, "score": 0, "creation_date": 1431551125, "post_id": 30225133, "comment_id": 48554157, "body": "you&#39;re likely corrupting the heap with that error (just an observation at this point)"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 0, "creation_date": 1431551292, "post_id": 30225133, "comment_id": 48554254, "body": "Please provide us definition of QuanitiyColor and Patter_init."}, {"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "edited": false, "score": 0, "creation_date": 1431551424, "post_id": 30225133, "comment_id": 48554321, "body": "are you freeing any memory above the loop by the way?"}, {"owner": {"reputation": 23, "user_id": 4299420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh4.googleusercontent.com/-d92iz7BuBYw/AAAAAAAAAAI/AAAAAAAAABA/i6yqipnFEKk/photo.jpg?sz=128", "display_name": "BiLLiXx", "link": "https://stackoverflow.com/users/4299420/billixx"}, "edited": false, "score": 0, "creation_date": 1431551552, "post_id": 30225133, "comment_id": 48554403, "body": "int* QuatityColot; int** Pattern;"}, {"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "edited": false, "score": 0, "creation_date": 1431551694, "post_id": 30225133, "comment_id": 48554479, "body": "@BiLLiXx are you allocating memory inside those arrays? You declared some pointer but there&#39;s no memory initially inside it yet"}, {"owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "edited": false, "score": 0, "creation_date": 1431552094, "post_id": 30225133, "comment_id": 48554664, "body": "Are those the two arrays you are using in your code samples btw? To clarify are those two seperate arrays you are using <code>delete</code> on or are those the arrays you are using in your for loop above"}, {"owner": {"reputation": 23, "user_id": 4299420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh4.googleusercontent.com/-d92iz7BuBYw/AAAAAAAAAAI/AAAAAAAAABA/i6yqipnFEKk/photo.jpg?sz=128", "display_name": "BiLLiXx", "link": "https://stackoverflow.com/users/4299420/billixx"}, "edited": false, "score": 0, "creation_date": 1431552191, "post_id": 30225133, "comment_id": 48554714, "body": "Of course, but this loop is at the begining of the itteration, those arrays are locals to the itteration, and if I know well, they&#39;ll be free at the end of each itteration ?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4299420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh4.googleusercontent.com/-d92iz7BuBYw/AAAAAAAAAAI/AAAAAAAAABA/i6yqipnFEKk/photo.jpg?sz=128", "display_name": "BiLLiXx", "link": "https://stackoverflow.com/users/4299420/billixx"}, "edited": false, "score": 0, "creation_date": 1431551594, "post_id": 30225244, "comment_id": 48554427, "body": "Ok, I&#39;ll see it! but the thing,  tis this loop is not allocating memory, and it is athe begining of itteration, anyway, I&#39;ll see !"}, {"owner": {"reputation": 23, "user_id": 4299420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh4.googleusercontent.com/-d92iz7BuBYw/AAAAAAAAAAI/AAAAAAAAABA/i6yqipnFEKk/photo.jpg?sz=128", "display_name": "BiLLiXx", "link": "https://stackoverflow.com/users/4299420/billixx"}, "edited": false, "score": 0, "creation_date": 1431558036, "post_id": 30225244, "comment_id": 48557029, "body": "is Application Verfier compatible just with VS 2008;2005 ?"}], "tags": [], "owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "is_accepted": false, "score": 2, "last_activity_date": 1431551353, "last_edit_date": 1495540691, "creation_date": 1431551353, "answer_id": 30225244, "question_id": 30225133, "link": "https://stackoverflow.com/questions/30225133/a-bizarre-project-exe-has-triggered-a-breakpoint/30225244#30225244", "title": "a bizarre &quot;Project.exe has triggered a breakpoint.&quot;?", "body": "<p><code>Critical error detected c0000374</code> is a sign of heap corruption, which means you might be doing bad things with memory e.g. writing after the end of a buffer, or writing to a buffer after it's been freed back to the heap. </p>\n\n<p>I don't see any tell tale signs in that small loop, but likely you are writing past the memory location of QuantityColor or something similar. </p>\n\n<p><a href=\"https://stackoverflow.com/a/1010811/1409312\">Debugging heap corruption errors</a></p>\n"}], "owner": {"reputation": 23, "user_id": 4299420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://lh4.googleusercontent.com/-d92iz7BuBYw/AAAAAAAAAAI/AAAAAAAAABA/i6yqipnFEKk/photo.jpg?sz=128", "display_name": "BiLLiXx", "link": "https://stackoverflow.com/users/4299420/billixx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2948, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431551353, "creation_date": 1431550965, "question_id": 30225133, "link": "https://stackoverflow.com/questions/30225133/a-bizarre-project-exe-has-triggered-a-breakpoint", "title": "a bizarre &quot;Project.exe has triggered a breakpoint.&quot;?", "body": "<p>just don't tell me google that, because I did it for the last 48 hours.\nthis is my problem; I create a lon program, which execute many itterations; but in few itterations, this error comes ...</p>\n\n<pre><code>Critical error detected c0000374\nProject.exe has triggered a breakpoint.\nThe program '[4452] Project.exe' has exited with code 0 (0x0).\n</code></pre>\n\n<p>so, Visual Studio 2012 opens newaop.cpp; which contains few line</p>\n\n<pre><code>// newaop -- operator new[](size_t) REPLACEABLE\n#include &lt;new&gt;\n\nvoid *__CRTDECL operator new[](size_t count) _THROW1(std::bad_alloc)\n     {  // try to allocate count bytes for an array\nreturn (operator new(count));\n}\n\n/*\n * Copyright (c) 1992-2007 by P.J. Plauger.  ALL RIGHTS RESERVED.\n * Consult your license regarding permissions and restrictions.\n V5.03:0009 */\n</code></pre>\n\n<p>pointing to the return line...\nI searched so many; but nothing works; the problem in that, my program works for few itterations\nI tried to locate the instructions generating this erreor (with cout's) and I found this loop</p>\n\n<pre><code>for (int i = OriginalCadre.X.x + 1; i &lt; OriginalCadre.X.x + OriginalCadre.height; i++){\n            for (int j = OriginalCadre.X.y + 1; j &lt; OriginalCadre.X.y + OriginalCadre.width; j++){\n                QuantityColor[Pattern_init[i][j]] ++;\n            }\n        }\n</code></pre>\n\n<p>this loop works at the begening for few itterations; which is bizarre !</p>\n"}, {"tags": ["c++", "windows", "winapi", "audio"], "comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 4, "creation_date": 1431551089, "post_id": 30225106, "comment_id": 48554138, "body": "If your goal is to continuously play the one sound, why not pas <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd743680%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">SND_LOOP</a> in to <code>PlaySound</code>"}, {"owner": {"reputation": 135, "user_id": 1649760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a54522dac8bb0273631d2872886b45?s=128&d=identicon&r=PG&f=1", "display_name": "Saubar", "link": "https://stackoverflow.com/users/1649760/saubar"}, "edited": false, "score": 0, "creation_date": 1431551411, "post_id": 30225106, "comment_id": 48554314, "body": "similar question is already asked <a href=\"http://stackoverflow.com/questions/5934059/how-do-i-detect-when-the-sound-has-finished-playing-when-using-playsound-in-win3\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1431620112, "post_id": 30225399, "comment_id": 48585536, "body": "This may solve your immediate problem, but does not answer the question you asked."}], "tags": [], "owner": {"reputation": 69, "user_id": 4889183, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b2116fc4ec4b77a4ae21880540c331c?s=128&d=identicon&r=PG&f=1", "display_name": "ThatCoderBryan", "link": "https://stackoverflow.com/users/4889183/thatcoderbryan"}, "is_accepted": false, "score": 2, "last_activity_date": 1431552075, "creation_date": 1431552075, "answer_id": 30225399, "question_id": 30225106, "link": "https://stackoverflow.com/questions/30225106/c-determine-if-a-sound-is-done-playing/30225399#30225399", "title": "C++ Determine If A Sound Is Done Playing", "body": "<p>The solution to my program is just to add in SND_LOOP.</p>\n"}], "owner": {"reputation": 69, "user_id": 4889183, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b2116fc4ec4b77a4ae21880540c331c?s=128&d=identicon&r=PG&f=1", "display_name": "ThatCoderBryan", "link": "https://stackoverflow.com/users/4889183/thatcoderbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1431552075, "creation_date": 1431550866, "last_edit_date": 1431551631, "question_id": 30225106, "link": "https://stackoverflow.com/questions/30225106/c-determine-if-a-sound-is-done-playing", "title": "C++ Determine If A Sound Is Done Playing", "body": "<p>For my program, I want to play a theme song. How can I know when it's done playing so then I could just call the song to play again? Here is my code to play the sound:</p>\n\n<pre><code>    #include &lt;iostream&gt;\n    #include &lt;Windows.h&gt;\\\n\n    #pragma comment (lib , \"winmm.lib\") // Used for sound\n\n    using namespace std;\n\n    int main()\n    {\n\n        PlaySound(TEXT(\"Background Music.wav\"), NULL, SND_FILENAME|SND_ASYNC);\n\n        return 0;\n    }   \n</code></pre>\n"}, {"tags": ["python", "c++", "vector"], "comments": [{"owner": {"reputation": 16556, "user_id": 839689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=128&d=identicon&r=PG", "display_name": "Nayuki", "link": "https://stackoverflow.com/users/839689/nayuki"}, "edited": false, "score": 1, "creation_date": 1431550558, "post_id": 30224951, "comment_id": 48553847, "body": "2D - so make a tuple of tuples?"}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "reply_to_user": {"reputation": 16556, "user_id": 839689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=128&d=identicon&r=PG", "display_name": "Nayuki", "link": "https://stackoverflow.com/users/839689/nayuki"}, "edited": false, "score": 0, "creation_date": 1431621812, "post_id": 30224951, "comment_id": 48586550, "body": "Thanks Nayuki. But I don&#39;t know how will it work. Can you please elaborate a little?"}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "reply_to_user": {"reputation": 16556, "user_id": 839689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=128&d=identicon&r=PG", "display_name": "Nayuki", "link": "https://stackoverflow.com/users/839689/nayuki"}, "edited": false, "score": 0, "creation_date": 1431628479, "post_id": 30224951, "comment_id": 48590489, "body": "As far as I am able to understand there is no direct way for this. We should break the 2-D vector into 2 1-D vectors and pass them all one by one. Just a guess. Woking on implementing it."}, {"owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "reply_to_user": {"reputation": 16556, "user_id": 839689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=128&d=identicon&r=PG", "display_name": "Nayuki", "link": "https://stackoverflow.com/users/839689/nayuki"}, "edited": false, "score": 0, "creation_date": 1432160994, "post_id": 30224951, "comment_id": 48814534, "body": "Tuple of tuples is very time and memory consuming. Is there any other way?"}], "owner": {"reputation": 263, "user_id": 4897442, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d672bfd441175c6343b835fe2e7913b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sajal Jain", "link": "https://stackoverflow.com/users/4897442/sajal-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1431550388, "creation_date": 1431550244, "last_edit_date": 1431550388, "question_id": 30224951, "link": "https://stackoverflow.com/questions/30224951/pass-vectorvectorfloat-from-c-to-python", "title": "Pass vector&lt;vector&lt;float&gt; &gt; from C++ to Python", "body": "<p>I am calling a Python module from C++ module. In my C++ module I have a <code>vector&lt;vector&lt;float&gt;&gt; data(size)</code>\nNow, i want to pass this to python where I will be doing some manipulations onto it.\nI see that the command <code>PyFloat_FromDouble</code> returns a <code>PyObject</code> and converts double to float. Now, I want my data to be in float and I get the result in <code>PyObject</code> form which I can further pass to python by <code>PyTuple_SetItem</code>.</p>\n\n<p>Does anyone knows how to pass a <code>vector&lt;vector&lt;float&gt; &gt;</code> to Python from C++. I am able to pass a 1D <code>vector&lt;double&gt;</code> to Python from C++ but need to pass 2D vector.</p>\n"}, {"tags": ["c++", "heap"], "owner": {"reputation": 35, "user_id": 4658391, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007439132020/picture?type=large", "display_name": "Julia Rundstr&#246;m", "link": "https://stackoverflow.com/users/4658391/julia-rundstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431550082, "creation_date": 1431550082, "question_id": 30224904, "link": "https://stackoverflow.com/questions/30224904/building-d-max-heap-bottom-up", "title": "Building d-max-heap bottom-up", "body": "<p>I have problem when I try to build a d-max-heap bottom up. The code works when I use low random numbers in the heap, but does not work when I have large numbers in the heap. The problem is probably in my buildBottomUp function. I am not sure if I have understood what the right way to build a bottom up heap is. This is my code:</p>\n\n<p>This is my header file</p>\n\n<pre><code>#ifndef FUNCTIONS_H\n#define FUNCTIONS_H\n\n#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\nusing namespace std;\n\ntemplate &lt;typename Comparable&gt;\nvoid buildHeapBottomUp(Comparable arr[], int n, int d){\n    int current = 0;\n    for (int i = n-1; i &gt; 0; i--){\n        current = i;\n        comparable++;\n        while (arr[current] &gt; arr[(current - 1) / d]){\n            swap(arr[current], arr[(current - 1) / d]);\n            current = (current - 1) / d;\n            comparable++;\n        }\n    }\n}\n\ntemplate &lt;typename Comparable&gt; \nbool checkIfHeap(Comparable arr[], int n, int d){\n    bool dMaxHeap = true;\n    int current = 0;\n    for (int i = 1; i &lt; n; i++){\n        current = i;\n        if(arr[current] &gt; arr[(current - 1) / d]){\n            dMaxHeap = false;\n        }\n    }\n    return dMaxHeap;\n}\n\ntemplate &lt;typename Comparable&gt;\nComparable removeFromHeap(Comparable heap[], int n, int d){\n    int current = n;\n    int numberOfChildren = d; \n    comparable = comparable + 1;\n    while (heap[0] &lt; heap[numberOfChildren]){\n        swap(heap[0], heap[numberOfChildren]);\n        numberOfChildren = numberOfChildren--;\n        comparable = comparable + 1;\n    }\n    Comparable largest = heap[0];\n    swap(heap[0], heap[current]);\n    return largest;\n}\n\ntemplate &lt;typename Comparable&gt; \nvoid sortUsingBottomUpConstructionOfHeap(Comparable arr[], int n, int d){\n    comparable = 0;\n    int i = 0;\n    int counter = n;\n    Comparable *tmp = new Comparable[n];\n    while (i &lt; n){\n        Comparable largest = removeFromHeap(arr, counter, d);\n        counter--;\n        tmp[counter] = largest;\n        buildHeapBottomUp(arr, counter, d);\n        i++;\n    }\n    counter = n - 1;\n    for (int k = 0; k &lt; n; k++){\n        arr[k] = tmp[counter];\n        counter--;\n    }\n}\n#endif\n</code></pre>\n\n<p>This is my main file</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"functions.h\"\n\nusing namespace std;\n\nint comparable = 0;\n\nint main(){    \n    srand(time(NULL));\n    int n;\n    int d;\n    int insertValues = 0;\n    int *arr;\n    int maxValue;\n\n    cout &lt;&lt; \"How many elements do you want in your D-Heap? \" &lt;&lt; endl;\n    cin &gt;&gt; n;\n    cout &lt;&lt; \"How many children do you want in your D-Heap? \" &lt;&lt; endl;\n    cin &gt;&gt; d;\n    cout &lt;&lt; \"Choose max value in your D-heap \";\n    cin &gt;&gt; maxValue;\n    cout &lt;&lt; \"\\n\" &lt;&lt; endl;\n    arr = new int[n];\n\n    fillArrayWithRandomNumbers(arr, n, maxValue);\n    cout &lt;&lt; \"Array before build\\n\" &lt;&lt; endl;\n    /*for (int i = 0; i &lt; n; i++){\n        cout &lt;&lt; arr[i] &lt;&lt; \", \";\n    }*/    \n\n    }\n    comparable = 0;\n    buildHeapBottomUp(arr, n, d);\n    if (checkIfHeap(arr, n, d)){\n        cout &lt;&lt; \"\\n\\nArray after build Top down\" &lt;&lt; endl;\n        cout &lt;&lt; \"You got\" &lt;&lt; \" \" &lt;&lt; comparable &lt;&lt; \" \" &lt;&lt; \"comparison when you build max-heap\\n\" &lt;&lt; endl;\n        /*for (int i = 0; i &lt; n; i++){\n        cout &lt;&lt; arr[i] &lt;&lt; \", \";\n        }*/\n        comparable = 0;\n        sortUsingBottomUpConstructionOfHeap(arr, n, d);\n        cout &lt;&lt; \"\\n\\nArray after sort Top down\" &lt;&lt; endl;\n        cout &lt;&lt; \"You got\" &lt;&lt; \" \" &lt;&lt; comparable &lt;&lt; \" \" &lt;&lt; \"comparison when you sort max-heap\\n\" &lt;&lt; endl;\n        /*for (int i = 0; i &lt; n; i++){\n        cout &lt;&lt; arr[i] &lt;&lt; \", \";\n        }*/\n    }\n    else{\n        cout &lt;&lt; \"the build function for Bottom up do not work!\" &lt;&lt; endl;\n    }\n    cin.ignore();\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "priority-queue", "vertex"], "comments": [{"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431551981, "post_id": 30224855, "comment_id": 48554599, "body": "can you just use a priority_queue of <code>Edge</code>&#39;s? You pretty much have that already.  <code>priority_queue&lt;Edge&gt; pq;</code>  after that, make your <code>Edge::operator&lt;</code> const and it would work.  If you dont want to do that, you&#39;d need to define some sort of comparator class, I think."}, {"owner": {"reputation": 419, "user_id": 4081250, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/163d5343158a5cf94cac72fa640f1ea8?s=128&d=identicon&r=PG&f=1", "display_name": "anonuser1234", "link": "https://stackoverflow.com/users/4081250/anonuser1234"}, "reply_to_user": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431552373, "post_id": 30224855, "comment_id": 48554821, "body": "@dwcanillas I can&#39;t, I need to access the Vertex that has the least amount of weight going to it. What&#39;s a comparator class?"}, {"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431552491, "post_id": 30224855, "comment_id": 48554883, "body": "You still would be able to do that, <code>pq.top().node</code>"}, {"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431552569, "post_id": 30224855, "comment_id": 48554917, "body": "or do you want to sort by the total weight going to each vertex?  If that is the case, why are you making a priority queue in the vertex class itself?"}, {"owner": {"reputation": 419, "user_id": 4081250, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/163d5343158a5cf94cac72fa640f1ea8?s=128&d=identicon&r=PG&f=1", "display_name": "anonuser1234", "link": "https://stackoverflow.com/users/4081250/anonuser1234"}, "reply_to_user": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431553236, "post_id": 30224855, "comment_id": 48555234, "body": "@dwcanillas, I need to do it as an assignment, its a requirement that I use a priority queue to access the vertex that has the minimum edge going to it. And I feel soooooooo stupid. I&#39;m sorry sometimes when I&#39;m stuck on something for so long I fail to see the obvious answer. Thank you so much."}, {"owner": {"reputation": 18716, "user_id": 240457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ffaa31b18c7c5ac916d95f172b7ac?s=128&d=identicon&r=PG", "display_name": "mcdowella", "link": "https://stackoverflow.com/users/240457/mcdowella"}, "edited": false, "score": 0, "creation_date": 1431578529, "post_id": 30224855, "comment_id": 48562172, "body": "<a href=\"http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#Using_a_priority_queue\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a> gives you pseudo-code for Dijkstra&#39;s algorithm, showing you how to associate a priority with a vertex - it is the minimum cost path to that vertex found so far."}], "owner": {"reputation": 419, "user_id": 4081250, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/163d5343158a5cf94cac72fa640f1ea8?s=128&d=identicon&r=PG&f=1", "display_name": "anonuser1234", "link": "https://stackoverflow.com/users/4081250/anonuser1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431549857, "creation_date": 1431549857, "question_id": 30224855, "link": "https://stackoverflow.com/questions/30224855/storing-vertex-in-a-priority-queue-base-on-the-weight-of-edges-c", "title": "Storing vertex in a priority queue base on the weight of edges (C++)", "body": "<p>I am having a difficult time trying to implement my code. So basically I created a class called vertex, each vertex then points to other vertices creating a graph and an adjacency list, to implement this I created a struct inside my class Vertex called Edge. Each edge has a weight and a Vertex to which it is pointing to. Heres my code to give you a better understanding.</p>\n\n<pre><code>Vertex {\npublic:\n    void setPQ() {\n    for( int i = 0; i &lt; adjList.size(); ++i) {\n        pq.push( adjList[i].node );\n    }\n}\nprivate:\n    struct Edge {\n        Vertex* node; // The vertex the edge is pointing to\n        int thatVertex;\n        float weight;\n\n        Egde( ) {\n            thatVertex = 0;\n            weight = 0;\n        }\n        bool operator&lt;( const Edge &amp; rhs) {\n            return this.weight &lt; rhs.weight;\n        }\n    };\n\n    vector&lt; Edge &gt; adjList;\n    int thisVertex;\n    int dist;\n    bool known = false;\n    piority_queue&lt; Vertex*, vector&lt;Vertex*&gt;, Edge &gt; pq;\n};\n</code></pre>\n\n<p>I'm implementing Dijkstra algorithm so thats why I have known and dist and other stuff. What I want to do is in each Vertex (or node) have a priority queue and in that queue, I want to store all vertices that <code>this</code> is pointing to. In other words, I want to store all vertices that are adjacent to <code>this</code> vertex and sort it using the weight of an Edge. How am I suppose to do this? I need to compare the weight of an edge and then store the Vertex of what that Edge contains. I have no idea how to do this and I don't even think my implementation is correct. Can someone help me and explain how am I suppose to do this?</p>\n\n<p>Thank you </p>\n"}, {"tags": ["c++", "algorithm", "memcpy"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1431550080, "post_id": 30224850, "comment_id": 48553609, "body": "Hmmm, consider <a href=\"http://img.photobucket.com/albums/v102/Arsenaultb/flowchart.jpg\" rel=\"nofollow noreferrer\">does it work</a>?"}, {"owner": {"reputation": 4040, "user_id": 1923699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iTCs2.jpg?s=128&g=1", "display_name": "Tyler Jandreau", "link": "https://stackoverflow.com/users/1923699/tyler-jandreau"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1431550137, "post_id": 30224850, "comment_id": 48553635, "body": "@chux Not my call to make it &quot;fancy&quot;, nice graphic though!"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1431550248, "post_id": 30224850, "comment_id": 48553683, "body": "Most likely code would run slower. Memcpy is highly tuned function, using SSEx instructions and what not to do copy really fast."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 4, "creation_date": 1431550355, "post_id": 30224850, "comment_id": 48553740, "body": "@SeverinPappadeux The only way to know is to measure. <code>std::copy</code> will probably invoke <code>memcpy</code> under the hood anyway."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1431550802, "post_id": 30224850, "comment_id": 48553972, "body": "@juanchopanza concur. On my implementation trivially-copyables have <code>std::copy</code> overloads that do just that."}, {"owner": {"reputation": 1223, "user_id": 2366842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db1f21d133e897903c931feb815012b?s=128&d=identicon&r=PG", "display_name": "user2366842", "link": "https://stackoverflow.com/users/2366842/user2366842"}, "edited": false, "score": 0, "creation_date": 1431552266, "post_id": 30224850, "comment_id": 48554757, "body": "When in doubt, leave it alone...probably the last thing you want to have happen is for something to blow up on you because you changed it to use std::copy in place of memcopy and have to go back and revert all your changes."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1431550854, "last_edit_date": 1431550854, "creation_date": 1431550482, "answer_id": 30224999, "question_id": 30224850, "link": "https://stackoverflow.com/questions/30224850/memcpy-or-stdcopy-for-my-particular-application/30224999#30224999", "title": "memcpy or std::copy for my particular application", "body": "<pre><code>std::copy(ptr, ptr + sizeof(T), t);\n</code></pre>\n\n<p>is not right.</p>\n\n<p>First of all, I don't think you can pass an object of type <code>void*</code> in a call to <code>std::copy</code></p>\n\n<p>Even if you did something like:</p>\n\n<pre><code>T* ptr = static_cast&lt;T*&gt;(FunctionToReturnPointer());\n...\nstd::copy(ptr, ptr + sizeof(T), t);\n</code></pre>\n\n<p>there are problems.</p>\n\n<p>Say <code>T == int</code> and <code>sizeof(int)</code> is <code>4</code>.</p>\n\n<p>That usage of <code>std::copy</code> will try to copy:</p>\n\n<p><code>*t</code> to <code>*ptr</code><br>\n <code>*(t+1)</code> to <code>*(ptr+1)</code><br>\n <code>*(t+2)</code> to <code>*(ptr+2)</code> and<br>\n <code>*(t+3)</code> to <code>*(ptr+3)</code></p>\n\n<p>Your code hasn't allocated memory for those many objects, and will lead to undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "is_accepted": false, "score": 2, "last_activity_date": 1431552100, "last_edit_date": 1431552100, "creation_date": 1431550938, "answer_id": 30225121, "question_id": 30224850, "link": "https://stackoverflow.com/questions/30224850/memcpy-or-stdcopy-for-my-particular-application/30225121#30225121", "title": "memcpy or std::copy for my particular application", "body": "<p>How about neither? Just let the the object's default copy assignment work by using properly typed pointers:</p>\n\n<pre><code>descriptor_t* descriptor_p = new descriptor_t;\n*descriptor_p = *(descriptor_t*)(FunctionToReturnPointer());\n</code></pre>\n\n<p>One line:</p>\n\n<pre><code>descriptor_t* descriptor_p = new descriptor_t(*(descriptor_t*)(FunctionToReturnPointer()));\n</code></pre>\n\n<p>Template version:</p>\n\n<pre><code>template&lt;typename T&gt;\nT* MakeNewCopy(void* p) { return new T(*static_cast&lt;T*&gt;(p)); }\n\nauto p = MakeNewCopy&lt;descriptor_t&gt;(FunctionToReturnPointer());\n</code></pre>\n\n<p>This will be much cleaner than what it seems like you have now but the compiler cannot help you if you give the wrong type to the template so \"safe\" is a relative term. Any time you use a void* and cast it you are taking the gloves off. Try to contain that behavior a much as possible so that your code is almost only ever dealing with properly typed pointers. </p>\n"}, {"comments": [{"owner": {"reputation": 4040, "user_id": 1923699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iTCs2.jpg?s=128&g=1", "display_name": "Tyler Jandreau", "link": "https://stackoverflow.com/users/1923699/tyler-jandreau"}, "edited": false, "score": 0, "creation_date": 1431552000, "post_id": 30225250, "comment_id": 48554608, "body": "I like this solution the best. Thank you very much."}, {"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 0, "creation_date": 1431552560, "post_id": 30225250, "comment_id": 48554915, "body": "A template class with one function should just be a template function."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1431552149, "last_edit_date": 1431552149, "creation_date": 1431551373, "answer_id": 30225250, "question_id": 30224850, "link": "https://stackoverflow.com/questions/30224850/memcpy-or-stdcopy-for-my-particular-application/30225250#30225250", "title": "memcpy or std::copy for my particular application", "body": "<p>Do you really need to dynamically allocate copies on the heap at all?</p>\n\n<pre><code>// provide a casting class that can do everything\ntemplate &lt;typename T&gt;\nclass CastClass {\n    public:\n    static T Cast() {\n        T *ptr = (T*) FunctionToReturnPointer();\n        return *ptr; // return a copy of the data\n    }\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>descriptor_t descriptor_p = CastClass&lt;descriptor_t&gt;::Cast();\n</code></pre>\n\n<p>If you do need a pointer, then at least use <code>unique_ptr</code> to manage it:</p>\n\n<pre><code>// provide a casting class that can do everything\ntemplate &lt;typename T&gt;\nclass CastClass {\n    public:\n    static std::unique_ptr&lt;T&gt; Cast() {\n        T *ptr = (T*) FunctionToReturnPointer();\n        return new T(*ptr); // return a managed pointer to a copy of the data\n    }\n};\n</code></pre>\n\n<p></p>\n\n<pre><code>std::unique_ptr&lt;descriptor_t&gt; descriptor_p = CastClass&lt;descriptor_t&gt;::Cast();\n</code></pre>\n"}], "owner": {"reputation": 4040, "user_id": 1923699, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iTCs2.jpg?s=128&g=1", "display_name": "Tyler Jandreau", "link": "https://stackoverflow.com/users/1923699/tyler-jandreau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 30225250, "answer_count": 3, "score": 1, "last_activity_date": 1431552149, "creation_date": 1431549841, "question_id": 30224850, "link": "https://stackoverflow.com/questions/30224850/memcpy-or-stdcopy-for-my-particular-application", "title": "memcpy or std::copy for my particular application", "body": "<p>I'm attempting to author a <code>C++</code> wrapper to some legacy <code>C</code> code to increase it's type safety and make it less of a PITA to use. The legacy code interacts with pointers in shared memory. POD structures are cast from these pointers. Since it's shared memory, these structures are guaranteed to be POD. </p>\n\n<p>The <code>C</code> code is littered with <code>memcpy</code> instances. I was wondering if it would be a good idea to use <code>std::copy</code> rather than <code>memcpy</code> in this instance, or if it would be better to leave it alone. </p>\n\n<p>For example, the original code (represented in pseudo-code): </p>\n\n<pre><code>// we cast from a void pointer return from the shared memory segment\nvoid *ptr = FunctionToReturnPointer();\ndescriptor_p = (descriptor_t*)new char[sizeof(descriptor_t)];\nmemcpy(descriptor_p, ptr, sizeof(descriptor_t));\n</code></pre>\n\n<p>where <code>descriptor_t</code> is a POD structure. In my solution, I'd probably do something like this (represented in pseudo-code):</p>\n\n<pre><code>// provide a casting class that can do everything\ntemplate &lt;typename T&gt;\nclass CastClass {\n    static T* Cast() {\n        void *ptr = FunctionToReturnPointer();\n        T *t = new T;\n        std::copy(ptr, ptr + sizeof(T), t);\n        return t;\n    }\n};\n\n// And how I would use the function\ndescriptor_p = CastClass&lt;descriptor_t&gt;::Cast();\n</code></pre>\n\n<p>So here are my questions: </p>\n\n<ol>\n<li>Is it beneficial to do this? Or is this a fool's errand?</li>\n<li>Am I adding any type-safety to the code?</li>\n<li>Is my usage of <code>std::copy</code> algorithm correct?</li>\n</ol>\n"}, {"tags": ["c++", "unique-ptr"], "answers": [{"tags": [], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 9, "last_activity_date": 1431550667, "last_edit_date": 1431550667, "creation_date": 1431549678, "answer_id": 30224805, "question_id": 30224759, "link": "https://stackoverflow.com/questions/30224759/if-i-take-a-raw-pointer-of-a-unique-ptr-and-then-use-reset-is-the-raw-pointer-s/30224805#30224805", "title": "If I take a raw pointer of a unique_ptr and then use reset, is the raw pointer still guaranteed to be valid?", "body": "<p>No, not at all. You will get undefined behaviour, as the raw pointer managed by the <code>unique_ptr</code> is changed by the <code>reset</code>. In fact, the <code>unique_ptr</code> deletes the managed pointer and reallocates a new one, so your old pointer will keep pointing to the old address, which is no longer valid. Your code is equivalent to this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    int* managed = new int(51); // equivalent to unique_ptr(new int(51));\n    int* bar = managed; // equivalent of unique_ptr::get\n    delete managed; managed = new int(3); // equivalent to unique_ptr::reset(new int(3))\n    std::cout &lt;&lt; *bar &lt;&lt; std::endl; // Wrong!!! Undefined behaviour, bar is dangling!\n}\n</code></pre>\n\n<p>Your first code snippet is indeed correct, since you are not changing any address there, you are just changing the variable the pointer points to, so of course dereferencing the pointer will get you the updated value.</p>\n"}, {"comments": [{"owner": {"reputation": 1224, "user_id": 1572626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/6dc99607cfc06eed4636695a0d16531e?s=128&d=identicon&r=PG", "display_name": "wrhall", "link": "https://stackoverflow.com/users/1572626/wrhall"}, "edited": false, "score": 0, "creation_date": 1431549940, "post_id": 30224809, "comment_id": 48553534, "body": "If I set <code>bar = foo.get()</code> and then later decide that I&#39;m going to change foo, can I just call <code>foo.release()</code> and let bar assume ownership without explicit assignment? I can&#39;t really think of a use-case, but I&#39;m curious if that will work correctly."}, {"owner": {"reputation": 138660, "user_id": 298661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3445f56229632874a44596385ed6d40c?s=128&d=identicon&r=PG", "display_name": "Puppy", "link": "https://stackoverflow.com/users/298661/puppy"}, "reply_to_user": {"reputation": 1224, "user_id": 1572626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/6dc99607cfc06eed4636695a0d16531e?s=128&d=identicon&r=PG", "display_name": "wrhall", "link": "https://stackoverflow.com/users/1572626/wrhall"}, "edited": false, "score": 1, "creation_date": 1431550178, "post_id": 30224809, "comment_id": 48553656, "body": "@wrhall: No, you cannot. That would be tremendously unsafe. The unique_ptr <i>always</i> owns the pointer. That&#39;s it&#39;s sole purpose. You can only prevent that by using <code>release()</code>, which is a terrible function that you should never call."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 138660, "user_id": 298661, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3445f56229632874a44596385ed6d40c?s=128&d=identicon&r=PG", "display_name": "Puppy", "link": "https://stackoverflow.com/users/298661/puppy"}, "edited": false, "score": 0, "creation_date": 1431550644, "post_id": 30224809, "comment_id": 48553894, "body": "@Puppy even if it&#39;s bad practice, is it technically correct? Looking at the documentation, it seems that <code>release()</code> <i>Releases the ownership of the managed object if any. get() returns <code>nullptr</code> after the call.</i> So it looks to me that <code>release()</code> really does <code>return managed_ptr;</code> and marks the <code>unique_ptr</code> as &quot;non-managing&quot;, so future <code>get()</code> return <code>nullptr</code>. Do you know if this is indeed the case?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1431550762, "post_id": 30224809, "comment_id": 48553948, "body": "Yes, that is what <code>release()</code> does. And yes, if you <code>get()</code> the pointer first and then <code>release()</code> it later, your pointer will still be valid (provided the <code>unique_ptr</code> was not changed prior to the <code>release()</code>)."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 8, "last_activity_date": 1431549689, "creation_date": 1431549689, "answer_id": 30224809, "question_id": 30224759, "link": "https://stackoverflow.com/questions/30224759/if-i-take-a-raw-pointer-of-a-unique-ptr-and-then-use-reset-is-the-raw-pointer-s/30224809#30224809", "title": "If I take a raw pointer of a unique_ptr and then use reset, is the raw pointer still guaranteed to be valid?", "body": "<p>No, if you reset a <code>unique_ptr</code>, it will delete the pointer it owns.</p>\n\n<p>You can do:</p>\n\n<pre><code>int* bar = foo.release();\n</code></pre>\n\n<p>This causes <code>foo</code> to give up ownership of its pointer and return it.</p>\n"}, {"tags": [], "owner": {"reputation": 11256, "user_id": 53420, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7b22f0b3304066470193db063a024ea2?s=128&d=identicon&r=PG", "display_name": "RED SOFT ADAIR", "link": "https://stackoverflow.com/users/53420/red-soft-adair"}, "is_accepted": false, "score": 0, "last_activity_date": 1431549760, "creation_date": 1431549760, "answer_id": 30224830, "question_id": 30224759, "link": "https://stackoverflow.com/questions/30224759/if-i-take-a-raw-pointer-of-a-unique-ptr-and-then-use-reset-is-the-raw-pointer-s/30224830#30224830", "title": "If I take a raw pointer of a unique_ptr and then use reset, is the raw pointer still guaranteed to be valid?", "body": "<p>No, std::unique_ptr.reset will delete the existing pointer. </p>\n\n<p>See <a href=\"http://www.cplusplus.com/reference/memory/unique_ptr/reset/\" rel=\"nofollow\">http://www.cplusplus.com/reference/memory/unique_ptr/reset/</a></p>\n\n<p>For your purpuse use <a href=\"http://www.cplusplus.com/reference/memory/unique_ptr/release/\" rel=\"nofollow\">release</a>.</p>\n"}], "owner": {"reputation": 1224, "user_id": 1572626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/6dc99607cfc06eed4636695a0d16531e?s=128&d=identicon&r=PG", "display_name": "wrhall", "link": "https://stackoverflow.com/users/1572626/wrhall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1364, "favorite_count": 1, "accepted_answer_id": 30224805, "answer_count": 3, "score": 5, "last_activity_date": 1431550667, "creation_date": 1431549494, "question_id": 30224759, "link": "https://stackoverflow.com/questions/30224759/if-i-take-a-raw-pointer-of-a-unique-ptr-and-then-use-reset-is-the-raw-pointer-s", "title": "If I take a raw pointer of a unique_ptr and then use reset, is the raw pointer still guaranteed to be valid?", "body": "<p>Eg I'm pretty sure this works.</p>\n\n<pre><code>int foo = 51;\nint* bar = &amp;foo;\nfoo = 3;\n</code></pre>\n\n<p>So bar is still valid, and <code>*bar == 3</code>.</p>\n\n<p>What about if we say</p>\n\n<pre><code>std::unique_ptr&lt;int&gt; foo(new int(51));  // should probably use make_unique\nint* bar = foo.get();\nfoo.reset(new int(3));\n</code></pre>\n\n<p>Am I guaranteed that <code>*bar == 3</code>?\nOr am I causing undefined behavior by continuing to reference bar?</p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 6445, "user_id": 118939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a39de83db7f4bc77f124e682ef7ca871?s=128&d=identicon&r=PG", "display_name": "meklarian", "link": "https://stackoverflow.com/users/118939/meklarian"}, "edited": false, "score": 0, "creation_date": 1431549744, "post_id": 30224737, "comment_id": 48553428, "body": "I don&#39;t see any issues with your sample code. Perhaps you have a transformation in effect that is set by the caller? See: <a href=\"https://www.opengl.org/archives/resources/faq/technical/transformations.htm\" rel=\"nofollow noreferrer\">opengl.org/archives/resources/faq/technical/transformations.&zwnj;&#8203;htm</a>"}, {"owner": {"reputation": 41878, "user_id": 257465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/882a999c825707d8bfa799ee20bda1f2?s=128&d=identicon&r=PG", "display_name": "tzaman", "link": "https://stackoverflow.com/users/257465/tzaman"}, "edited": false, "score": 1, "creation_date": 1431549783, "post_id": 30224737, "comment_id": 48553444, "body": "How are you setting up your viewport? This seems like an aspect ratio issue."}], "answers": [{"comments": [{"owner": {"reputation": 8130, "user_id": 2713740, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1f024ede163fdaebe61807ad5c88f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/2713740/luca"}, "edited": false, "score": 0, "creation_date": 1431550813, "post_id": 30224841, "comment_id": 48553981, "body": "Thanks. That did the trick! I had no idea about this. Quite new to graphics!"}], "tags": [], "owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "is_accepted": true, "score": 2, "last_activity_date": 1431549803, "creation_date": 1431549803, "answer_id": 30224841, "question_id": 30224737, "link": "https://stackoverflow.com/questions/30224737/opengl-generating-ellipse-in-code/30224841#30224841", "title": "OpenGL: Generating ellipse in code", "body": "<p>It is a circle in clip space. Note that the horizontal extent is half the screen's width and the vertical extent is half the screen's height. The viewport transformation that maps clip space (-1 to 1 on both axes) to screen space basically performs a scaling and translation, which causes the deformation of the circle.</p>\n\n<p>To prevent this from happening, you need to set up an appropriate projection transform, e.g. with <code>glOrtho</code>.</p>\n"}], "owner": {"reputation": 8130, "user_id": 2713740, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1f024ede163fdaebe61807ad5c88f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/2713740/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2867, "favorite_count": 0, "closed_date": 1431550784, "accepted_answer_id": 30224841, "answer_count": 1, "score": 1, "last_activity_date": 1431549803, "creation_date": 1431549428, "question_id": 30224737, "link": "https://stackoverflow.com/questions/30224737/opengl-generating-ellipse-in-code", "closed_reason": "Duplicate", "title": "OpenGL: Generating ellipse in code", "body": "<p>I have been trying to generate an ellipse using OpenGL and I have a feeling I have got something very wrong. I am trying to use an ellipse generating code but for simplicity, I have set the length of the major and minor axes equal. This should give me a circle but somehow that is not what is rendered with OpenGL and I am not sure what is wrong.</p>\n\n<p>So the code is as follows:</p>\n\n<pre><code>glPushAttrib(GL_CURRENT_BIT);\nglColor3f(1.0f, 0.0f, 0.0f);\nglLineWidth(2.0);\n\n// Draw center\nglBegin(GL_POINTS);\nglVertex2d(0, 0);\nglEnd();\n\nglBegin(GL_LINE_LOOP);\n// This should generate a circle\nfor (GLfloat i = 0; i &lt; 360; i++)\n{\n    float x = cos(i*M_PI/180.f) * 0.5; // keep the axes radius same\n    float y = sin(i*M_PI/180.f) * 0.5;\n    glVertex2f(x, y);\n}\n\nglEnd();\nglPopAttrib();\n</code></pre>\n\n<p>This should generate a circle as far as I can think. However. I get something like the attached image, which is not a circle. I am not sure what I am doing wrong.</p>\n\n<p><img src=\"https://i.stack.imgur.com/i7zFi.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c++", "visual-studio-2013"], "comments": [{"owner": {"reputation": 1436, "user_id": 812933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otbCL.jpg?s=128&g=1", "display_name": "Griffin", "link": "https://stackoverflow.com/users/812933/griffin"}, "edited": false, "score": 0, "creation_date": 1431550311, "post_id": 30224721, "comment_id": 48553720, "body": "I&#39;m not clear what you are asking. Are you looking for <a href=\"https://msdn.microsoft.com/en-us/library/acd0tfbe.aspx\" rel=\"nofollow noreferrer\">&lt;see&gt;</a> in documentation comments?"}, {"owner": {"reputation": 380, "user_id": 4745517, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/439547162879341/picture?type=large", "display_name": "rikimaru2013", "link": "https://stackoverflow.com/users/4745517/rikimaru2013"}, "reply_to_user": {"reputation": 1436, "user_id": 812933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/otbCL.jpg?s=128&g=1", "display_name": "Griffin", "link": "https://stackoverflow.com/users/812933/griffin"}, "edited": false, "score": 0, "creation_date": 1431605871, "post_id": 30224721, "comment_id": 48575940, "body": "Find a litle bit that i seach - combination Ctrl + , and Ctrl + ; . Then install VS Productive Power Tool and use Ctrl + Click. But i still looking for another thing.  Have comments like: /* add class to vector at Foo.cpp <i>/ /</i> add class to startup settings at bar.cpp */  I&#39;d like clicked on it that openning tabs in VS2013"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1431721645, "post_id": 30224721, "comment_id": 48636124, "body": "I know that if a line in the Output window starts with the file name and line number, you can double-click to go to that line of the file. I don&#39;t know if there&#39;s any way to do the same with a code comment."}], "answers": [{"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1431721558, "post_id": 30268001, "comment_id": 48636093, "body": "If I understand the problem correctly, the necessary file might not even be open in a tab yet."}], "tags": [], "owner": {"reputation": 133, "user_id": 4465747, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7FUKM.jpg?s=128&g=1", "display_name": "David Loughnane", "link": "https://stackoverflow.com/users/4465747/david-loughnane"}, "is_accepted": false, "score": 0, "last_activity_date": 1431720886, "creation_date": 1431720886, "answer_id": 30268001, "question_id": 30224721, "link": "https://stackoverflow.com/questions/30224721/visual-studio-references-to-cpp-file/30268001#30268001", "title": "Visual studio references to cpp file", "body": "<p>ctrl + tab will give you a shortcut to move between code tabs, although it won't bring you directly to  specific tab</p>\n"}, {"tags": [], "owner": {"reputation": 801, "user_id": 204868, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6c96951ce031aa3bf93397db21df0a80?s=128&d=identicon&r=PG", "display_name": "Juliano", "link": "https://stackoverflow.com/users/204868/juliano"}, "is_accepted": false, "score": 1, "last_activity_date": 1431725124, "creation_date": 1431725124, "answer_id": 30268984, "question_id": 30224721, "link": "https://stackoverflow.com/questions/30224721/visual-studio-references-to-cpp-file/30268984#30268984", "title": "Visual studio references to cpp file", "body": "<p>This is not very elegant, but you could do this workaround.\nWrite in A.cpp:</p>\n\n<pre><code>#if(0)\n#include \"B.cpp\"\n#endif\n</code></pre>\n\n<p>Then you can place the cursor above \"B.cpp\" and type <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>G</kbd> or right-click and select \"Open document B.cpp\"</p>\n"}], "owner": {"reputation": 380, "user_id": 4745517, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/439547162879341/picture?type=large", "display_name": "rikimaru2013", "link": "https://stackoverflow.com/users/4745517/rikimaru2013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1431725124, "creation_date": 1431549379, "last_edit_date": 1431594643, "question_id": 30224721, "link": "https://stackoverflow.com/questions/30224721/visual-studio-references-to-cpp-file", "title": "Visual studio references to cpp file", "body": "<p>How can I add some links between files to allow jumping from different cpp/h files included into Visual Studio 2013. </p>\n\n<p>Like: writing code into A.cpp - in code comments allow jump to B.cpp. I have a lot of tabs, and spending a lot of time for switching. Very big project</p>\n"}, {"tags": ["c++", "opengl", "gdi"], "answers": [{"tags": [], "owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "is_accepted": false, "score": 5, "last_activity_date": 1431549155, "creation_date": 1431549155, "answer_id": 30224668, "question_id": 30224588, "link": "https://stackoverflow.com/questions/30224588/opengl-flashing/30224668#30224668", "title": "OpenGL Flashing?", "body": "<p>Two problems with your program:</p>\n\n<ol>\n<li><p>Setting a background brush for a OpenGL window will make the OS visibly clear the window with the brush before sending WM_PAINT (upon which you overdraw with OpenGL). By using InvalidateRect you're triggering this erase-with-background before WM_PAINT</p></li>\n<li><p>Double buffered OpenGL pixelformats and drawing with the GDI don't go well together. If you want to draw text you'll have to do it differently. For example drawing to a DIBSECTION DC and then drawing that bitmap per using a textured quad. Or using a font rasterizer that addresses OpenGL  (FTGL, Glyphy or the likes).</p></li>\n</ol>\n"}], "owner": {"reputation": 51, "user_id": 4897401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a67a1e68c7385947e4a4adeb0e1ff994?s=128&d=identicon&r=PG&f=1", "display_name": "tony perez", "link": "https://stackoverflow.com/users/4897401/tony-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431549155, "creation_date": 1431548830, "last_edit_date": 1431548964, "question_id": 30224588, "link": "https://stackoverflow.com/questions/30224588/opengl-flashing", "title": "OpenGL Flashing?", "body": "<p>I'm trying to draw some text in OpenGL while the program draw a cube or any Opengl native so, when I try to put the text on the screen it flashes very fast and I don't know why, I tried to change the Sleep value and nothing... </p>\n\n<p>The code is below; <a href=\"http://gyazo.com/2cb75802048bd54b3c8a7fd2aa1be749\" rel=\"nofollow\">here is a GIF showing the problem</a>.</p>\n\n<p>The green background is the cube, the camera is very close to the background, you can move back with the <code>NUM_2</code>.</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sstream&gt;\n#include \"default.h\"\n\nusing namespace std;\n\nLRESULT CALLBACK WindowProc(HWND, UINT, WPARAM, LPARAM);\nDWORD WINAPI WorkLoop(LPVOID PARAMS);\nvoid keyScan (MSG msg, Camera cam);\n\nHDC hDC;\nHGLRC hRC;\nHWND hwnd;\n\nRECT WBounds;\n\n\nint WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)\n{\n    WNDCLASSEX wcex;\n    MSG msg;\n    BOOL bQuit = FALSE;\n\n    wcex.cbSize = sizeof(WNDCLASSEX);\n    wcex.style = CS_OWNDC;\n    wcex.lpfnWndProc = WindowProc;\n    wcex.cbClsExtra = 0;\n    wcex.cbWndExtra = 0;\n    wcex.hInstance = hInstance;\n    wcex.hIcon = LoadIcon(NULL, IDI_APPLICATION);\n    wcex.hCursor = LoadCursor(NULL, IDC_ARROW);\n    wcex.hbrBackground = (HBRUSH)GetStockObject(BLACK_BRUSH);\n    wcex.lpszMenuName = NULL;\n    wcex.lpszClassName = \"GLSample\";\n    wcex.hIconSm = LoadIcon(NULL, IDI_APPLICATION);;\n    Screen ();\n\n    if (!RegisterClassEx(&amp;wcex))\n        return 0;\n\n\n    hwnd = CreateWindowEx(0,\n                          \"GLSample\",\n                          \"OpenGL Testing\",\n                          WS_OVERLAPPEDWINDOW,\n                          Scr.sx/2-630,\n                          Scr.sy/2-450,\n                          1260,\n                          900,\n                          NULL,\n                          NULL,\n                          hInstance,\n                          NULL);\n\n    GetClientRect(hwnd, &amp;WBounds);\n\n    ShowWindow(hwnd, nCmdShow);\n    EnableOpenGL(hwnd, &amp;hDC, &amp;hRC);  ///ENABLE OPENGL\n\n    Camera cam = Camera (0, 0, -1);\n\n    CreateThread(0, 0x1000, &amp;WorkLoop, 0, 0, 0);\n\n    while (!bQuit)\n    {\n        if (PeekMessage(&amp;msg, NULL, 0, 0, PM_REMOVE))\n        {\n            if (msg.message == WM_QUIT) bQuit = TRUE;\n            else\n            {\n                keyScan (msg, cam);\n                TranslateMessage(&amp;msg);\n                DispatchMessage(&amp;msg);\n            }\n        }\n        else\n        {\n            renderSimulation (cam);\n            SwapBuffers (hDC);\n        }\n        Sleep(1);\n    }\n\n    DisableOpenGL(hwnd, hDC, hRC);\n    DestroyWindow(hwnd);\n    return msg.wParam;\n}\n\nDWORD WINAPI WorkLoop(LPVOID PARAMS)\n{\n    while (true)\n    {\n        InvalidateRect(hwnd, &amp;WBounds, true);\n        Sleep(33);\n    }\n    ExitThread(0);\n}\n\n\nfloat x = 0.0f, y = 0.0f, z = 0.0f;\nfloat rx = 0.0f, ry = 0.0f, rz = 0.0f;\nchar* textas = \"test\";\n\nvoid keyScan (MSG p, Camera cam)\n{\n    if (p.message == WM_KEYDOWN)\n    {\n        if (p.wParam == ARROW_RIGHT)      {x += 0.1; cam.SetCameraPosition (x, y, z);}\n        else if (p.wParam == ARROW_LEFT)  {x -= 0.1; cam.SetCameraPosition (x, y, z);}\n        else if (p.wParam == ARROW_UP)    {y += 0.1; cam.SetCameraPosition (x, y, z);}\n        else if (p.wParam == ARROW_DOWN)  {y -= 0.1; cam.SetCameraPosition (x, y, z);}\n        else if (p.wParam == NUM_8)       {z += 0.1; cam.SetCameraPosition (x, y, z);}\n        else if (p.wParam == NUM_2)       {z -= 0.1; cam.SetCameraPosition (x, y, z);}\n        else if (p.wParam == L)           SetFullScreen (p.hwnd, hDC, hRC);\n        else if (p.wParam == K)           textas = \"cambiado\";\n    }\n}\n\nHFONT Font = CreateFont(40, 0, 0, 0,FW_NORMAL, FALSE, FALSE, FALSE, DEFAULT_CHARSET,OUT_TT_PRECIS, CLIP_DEFAULT_PRECIS,ANTIALIASED_QUALITY, FF_MODERN, TEXT(\"Arial\"));\nHPEN BoxPen = CreatePen(PS_SOLID, 1, RGB(0, 255, 0));\nHPEN OutlinePen = CreatePen(PS_SOLID, 3, RGB(0, 0, 0));\nHPEN CHPen = CreatePen(PS_SOLID, 1, RGB(0, 0, 0));\nHBRUSH CHBrush = CreateSolidBrush(RGB(0, 255, 0));\n\nvoid drawtext(HDC hdc, int x, int y, const char * text)\n{\n    SetBkMode (hdc, TRANSPARENT);\n    SetTextColor(hdc, RGB(0, 255, 0));\n    SetBkColor(hdc, RGB(255, 255, 255));\n    TextOutA(hdc, x, y, text, strlen(text));\n}\n\n/*void Draw(HDC hdc, int x, int y, float dist)\n{\n    int width = 20000 / dist;\n    int height = 45000 / dist;\n    SelectObject(hdc, OutlinePen);\n    SelectObject(hdc, WHITE_BRUSH);\n    Rectangle(hdc, x - (width / 2), y - height, x + (width / 2), y);\n    SelectObject(hdc, BoxPen);\n    Rectangle(hdc, x - (width / 2), y - height, x + (width / 2), y);\n    SetTextAlign(hdc, TA_CENTER | TA_NOUPDATECP);\n    std::stringstream ss2;\n    ss2 &lt;&lt; \"Dist: \" &lt;&lt; dist &lt;&lt; \" m\";\n    drawtext(hdc, x, y + 90, ss2.str().c_str());\n}*/\n\nLRESULT CALLBACK WindowProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)\n{\n    switch (uMsg)\n    {\n        case WM_PAINT:\n        {\n            int win_width = WBounds.right - WBounds.left;\n            int win_height = WBounds.bottom + WBounds.left;\n            PAINTSTRUCT ps;\n            HDC Memhdc;\n            HDC hdc;\n            HBITMAP Membitmap;\n            hdc = BeginPaint(hwnd, &amp;ps);\n            Memhdc = CreateCompatibleDC (hdc);\n            Membitmap = CreateCompatibleBitmap (hdc, win_width, win_height);\n            SelectObject (Memhdc, Membitmap);\n            //FillRect (Memhdc, &amp;WBounds, WHITE_BRUSH);\n            SelectObject (Memhdc, Font);\n            SetTextAlign (Memhdc, TA_LEFT | TA_NOUPDATECP);\n            drawtext(Memhdc, 100, 100, textas);\n\n            //Draw (Memhdc, 20, 50, 90.0);\n\n            /*SelectObject(Memhdc, CHPen);\n            SelectObject(Memhdc, CHBrush);*/\n\n            BitBlt (hdc, 0, 0, win_width, win_height, Memhdc, 0, 0, SRCCOPY);\n            DeleteObject(Membitmap);\n            DeleteDC(Memhdc);\n            DeleteDC(hdc);\n            EndPaint(hwnd, &amp;ps);\n            ValidateRect(hwnd, &amp;WBounds);\n        }\n        case WM_KEYDOWN:\n        {\n            switch (wParam)\n            {\n                case VK_ESCAPE:\n                    PostQuitMessage(0);\n            }\n        }\n        case WM_ERASEBKGND:\n            return 1;\n        default:\n            return DefWindowProc(hwnd, uMsg, wParam, lParam);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 1, "creation_date": 1431549146, "post_id": 30224565, "comment_id": 48553147, "body": "You need the HashTable definition and declarations for headOne and tableSize. I guessed at those things and it compiles for me so the problem is probably in the missing parts. Also show your includes and using statements."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2269281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5848869646d9ec24bd93e9aa868c39b9?s=128&d=identicon&r=PG", "display_name": "Mikeson", "link": "https://stackoverflow.com/users/2269281/mikeson"}, "edited": false, "score": 0, "creation_date": 1441675604, "post_id": 30224649, "comment_id": 52759097, "body": "I was using string.h instead I think it was."}], "tags": [], "owner": {"reputation": 1498, "user_id": 2797746, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/TaPVN.jpg?s=128&g=1", "display_name": "Alexandre Severino", "link": "https://stackoverflow.com/users/2797746/alexandre-severino"}, "is_accepted": true, "score": 0, "last_activity_date": 1431549080, "creation_date": 1431549080, "answer_id": 30224649, "question_id": 30224565, "link": "https://stackoverflow.com/questions/30224565/link-list-no-operator-matches/30224649#30224649", "title": "Link List - no operator &#39;&lt;&lt;&#39; matches", "body": "<p>In order to be able to <code>cout</code> a <code>std::string</code> you have to include:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "is_accepted": false, "score": 0, "last_activity_date": 1431549541, "creation_date": 1431549541, "answer_id": 30224771, "question_id": 30224565, "link": "https://stackoverflow.com/questions/30224565/link-list-no-operator-matches/30224771#30224771", "title": "Link List - no operator &#39;&lt;&lt;&#39; matches", "body": "<p>This works:</p>\n\n<pre><code>// Missing includes and using\n#include &lt;string&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\n// missing struct\nstruct HashTable {\n    HashTable* next;\n    HashTable* child;\n    string word;\n    int number;\n};\n\n// missing vars\nHashTable ht;\nHashTable* headOne = &amp;ht;\nint tableSize = 5;\n\n// Unchanged\nvoid print()\n{\n HashTable *marker = headOne;\n HashTable *inList;\n for( int i = 0; i &lt; tableSize; i++ )\n {\n    cout &lt;&lt; i &lt;&lt; \": \" &lt;&lt; marker -&gt; number &lt;&lt; endl;\n    if(marker-&gt;child != NULL)\n    {\n        inList = marker;\n        do\n        {\n            string w = inList -&gt; word; \n            cout &lt;&lt; w &lt;&lt; endl;\n            inList = inList -&gt; child;\n        }\n        while(inList != NULL);  \n    }\n    marker = marker -&gt; next;\n }//end for loop\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 0, "last_activity_date": 1431551520, "creation_date": 1431551520, "answer_id": 30225283, "question_id": 30224565, "link": "https://stackoverflow.com/questions/30224565/link-list-no-operator-matches/30225283#30225283", "title": "Link List - no operator &#39;&lt;&lt;&#39; matches", "body": "<blockquote>\n  <p>I read somewhere I may have to overload it but why?</p>\n</blockquote>\n\n<p>Because there's no overload that matches your need.</p>\n\n<blockquote>\n  <p>And how would I over load it for a link list.</p>\n</blockquote>\n\n<p>You can do this outside of your class or struct:<br>\n(where <code>T</code> is the type of the object that you want to print)</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const T&amp; obj)\n{\n  /* write obj to stream */\n  return os;\n}\n</code></pre>\n\n<p>This is just an example that prints a vector:</p>\n\n<pre><code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, vector&lt;int&gt;&amp; obj)\n{\n  for (auto &amp;i : obj)\n    os &lt;&lt; i &lt;&lt; \" \";\n  return os;\n}\n</code></pre>\n\n<p>Then I would be able to simply do this <code>cout &lt;&lt; n.vec;</code> where <code>n</code> is the class object and <code>vec</code> the name of a vector of ints.</p>\n"}], "owner": {"reputation": 15, "user_id": 2269281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5848869646d9ec24bd93e9aa868c39b9?s=128&d=identicon&r=PG", "display_name": "Mikeson", "link": "https://stackoverflow.com/users/2269281/mikeson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 30224649, "answer_count": 3, "score": 0, "last_activity_date": 1431551687, "creation_date": 1431548730, "last_edit_date": 1431551687, "question_id": 30224565, "link": "https://stackoverflow.com/questions/30224565/link-list-no-operator-matches", "title": "Link List - no operator &#39;&lt;&lt;&#39; matches", "body": "<p>My c++ is really poor. Anyhow with the code snippet bellow why do I get a error on the &lt;&lt; in the do while loop when outside of it I get no error. The error is: no operator \"&lt;&lt;\" matches these operands. However the string w picks up the word fine. I read somewhere I may have to overload it but why? And how would I over load it for a link list.\nThanks in advance.</p>\n\n<pre><code>void print()\n{\n HashTable *marker = headOne;\n HashTable *inList;\n for( int i = 0; i &lt; tableSize; i++ )\n {\n    cout &lt;&lt; i &lt;&lt; \": \" &lt;&lt; marker-&gt;number &lt;&lt; endl;\n    if(marker-&gt;child != NULL)\n    {\n        inList = marker;\n        do\n        {\n            string w = inList-&gt;word; \n            cout &lt;&lt; w &lt;&lt; endl;\n            inList = inList-&gt;child;\n        }\n        while(inList != NULL);  \n    }\n    marker = marker-&gt;next;\n }//end for loop\n}\n</code></pre>\n"}, {"tags": ["c++", "sorting"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431548116, "post_id": 30224338, "comment_id": 48552635, "body": "Oh where to start.  Maybe you should double check how to <a href=\"http://www.cplusplus.com/doc/tutorial/classes/\" rel=\"nofollow noreferrer\">create a class</a>"}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1431548221, "post_id": 30224338, "comment_id": 48552688, "body": "and double check <a href=\"https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\">how NOT to read a file</a>."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 1, "creation_date": 1431548548, "post_id": 30224338, "comment_id": 48552852, "body": "You use UNIIX tools. <code>sort -k2 &lt;fileName&gt;</code>. You don&#39;t need to write code for this."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1431549048, "post_id": 30224338, "comment_id": 48553094, "body": "Maybe you could write a <i>comparison function</i> for use with <code>std::sort</code>?  I&#39;d give you an example, but I don&#39;t know how to search the internet for &quot;c++ example sort function&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1891, "user_id": 995218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZKQoe.jpg?s=128&g=1", "display_name": "atkins", "link": "https://stackoverflow.com/users/995218/atkins"}, "is_accepted": false, "score": 3, "last_activity_date": 1431548906, "creation_date": 1431548906, "answer_id": 30224608, "question_id": 30224338, "link": "https://stackoverflow.com/questions/30224338/sorting-a-list-by-last-name/30224608#30224608", "title": "Sorting a list by last name", "body": "<p>Your syntax for access modifiers is incorrect (you're using Java style rather than C++). In C++ you would declare this fully public class like this:</p>\n\n<pre><code> class EmployeeInformation {\n public:\n   string firstName;\n   string lastName;\n   string title;\n   string phonenumber;\n   //...\n};\n</code></pre>\n\n<p>If you really do want to make all the data public, you could also use a struct instead of a class, since the members of structs are public by default.</p>\n"}, {"tags": [], "owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "is_accepted": false, "score": 2, "last_activity_date": 1431549131, "creation_date": 1431549131, "answer_id": 30224661, "question_id": 30224338, "link": "https://stackoverflow.com/questions/30224338/sorting-a-list-by-last-name/30224661#30224661", "title": "Sorting a list by last name", "body": "<p>First of all your variable declaration in class is wrong.Then in the constructor,you are not telling the data types.See this</p>\n\n<pre><code> class EmployeeInformation {\npublic:\nstring firstName;\nstring lastName;\nstring title;\nstring phonenumber;\n\nEmployeeInformation(string &amp;firstName,string &amp;lastName,string &amp;title,string &amp;phonenumber)\n{\nthis-&gt;firstName = firstName;\nthis-&gt;lastName = lastName;\nthis-&gt;title = title;            //there is no variable named initial in class\nthis-&gt;phonenumber = phonenumber; //there is no variable named id in class\n}\n};\n</code></pre>\n\n<p>Then you are missing a semicolon.</p>\n\n<pre><code>sort(employees.begin(), employees.end(), [](EmployeeInformation a, EmployeeInformation b) { return a.lastName &lt; b.lastName; });  //there should be a semicolon after return statement\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 7, "last_activity_date": 1431559366, "last_edit_date": 1492087236, "creation_date": 1431549318, "answer_id": 30224707, "question_id": 30224338, "link": "https://stackoverflow.com/questions/30224338/sorting-a-list-by-last-name/30224707#30224707", "title": "Sorting a list by last name", "body": "<p>Lot of minor errors.</p>\n\n<h2>Public section.</h2>\n\n<p>In C++ public is followed by ':' to mark a section. Also you need to include the <code>string</code> definition. Which lives in the <code>std::</code> namespace.</p>\n\n<pre><code>  public: std::string firstName;\n  public: std::string lastName;\n  public: std::string title;\n  public: std::string phonenumber;\n</code></pre>\n\n<h2>C++ is a very pedantic on types.</h2>\n\n<p>You need to specify the types of all parameters:</p>\n\n<pre><code>EmployeeInformation(string const&amp; firstName, string const &amp; lastName, string const&amp; title, string const&amp; phonenumber)\n</code></pre>\n\n<h2>unknown names:</h2>\n\n<pre><code>this-&gt;initials = title;\n  //  ^^^^^^^^   Not a member of this class. Did you mean title.\nthis-&gt;id = phoneumber;\n  //  ^^         Not a member of this class. Did you mean phoneumber\n</code></pre>\n\n<h2>Statements are terminated by ';'</h2>\n\n<pre><code>return a.lastName &lt; b.lastName\n                       //      ^^^^^   missing here.\n</code></pre>\n\n<p>Once you have those fixed it compiles. But I would take the fixed version to <a href=\"https://codereview.stackexchange.com/\">code review</a> for a more detailed break down.</p>\n\n<h2>When all complete main looks like this:</h2>\n\n<pre><code>int main(int argc, char**argv)\n{\n    std::ifstream file(\"employees.txt\");\n\n    // Read data into vector\n    std::vector&lt;EmployeeInformation&gt; employees(std::istream_iterator&lt;EmployeeInformation&gt;(file),\n                                               (std::istream_iterator&lt;EmployeeInformation&gt;()));\n\n    // Sort container.\n    std::sort(std::begin(employees), std::end(employees),\n              [](EmployeeInformation const&amp; lhs, EmployeeInformation const&amp; rhs) { return lhs.lastName &lt; rhs.lastName;});\n\n    // Copy container to stream.\n    std::copy(std::begin(employees), std::end(employees),\n              std::ostream_iterator&lt;EmployeeInformation&gt;(std::cout));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 61, "user_id": 4896021, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155516520820612/picture?type=large", "display_name": "Noor Chaudhry", "link": "https://stackoverflow.com/users/4896021/noor-chaudhry"}, "edited": false, "score": 0, "creation_date": 1431554362, "post_id": 30224751, "comment_id": 48555688, "body": "The same way you print out anything else - pass the desired values to <code>std::cout</code> as needed. I updated my answer to show that."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 4, "last_activity_date": 1431554343, "last_edit_date": 1431554343, "creation_date": 1431549467, "answer_id": 30224751, "question_id": 30224338, "link": "https://stackoverflow.com/questions/30224338/sorting-a-list-by-last-name/30224751#30224751", "title": "Sorting a list by last name", "body": "<p>Your class is not declared correctly. For instance, you cannot omit data types from the constructor's parameters.</p>\n\n<p>You are also not reading the file correctly.</p>\n\n<p>Try something more like this:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\nusing namespace std;\n\nclass EmployeeInformation\n{\npublic:\n    string firstName;\n    string lastName;\n    string title;\n    string phoneNumber;\n\n    EmployeeInformation(const string &amp;_firstName, const string &amp;_lastName, const string &amp;_title, const string &amp;_phonenumber) :\n        firstName(_firstName),\n        lastName(_lastName),\n        title(_title),\n        phoneNumber(_phoneNumber)\n    {\n    }\n};\n\nint main(int argc, char**argv)\n{\n    ifstream file;\n\n    file.open(\"employees.txt\");\n    if (!file.is_open())\n    {\n        cout &lt;&lt; \"Error opening file\";\n        return 0;\n    }\n\n    vector&lt;EmployeeInformation&gt; employees;\n    string line;\n\n    while (getline(file, line))\n    {\n        string firstName, lastName, title, phonenumber;\n        istringstream iss(line);\n        iss &gt;&gt; firstName &gt;&gt; lastName &gt;&gt; title &gt;&gt; phonenumber;\n        EmployeeInformation person(firstName, lastName, title, phonenumber);\n        employees.push_back(person);\n    }\n\n    sort(employees.begin(), employees.end(), [](const EmployeeInformation &amp;a, const EmployeeInformation &amp;b) { return a.lastName &lt; b.lastName; });\n\n    for (EmployeeInformation i : employees)\n    {\n        // print person info in sorted order\n        cout &lt;&lt; i.lastName &lt;&lt; \" \" &lt;&lt; i.firstName &lt;&lt; \" \" &lt;&lt; i.title &lt;&lt; \" \" i.phoneNumber &lt;&lt; endl;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4896021, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10155516520820612/picture?type=large", "display_name": "Noor Chaudhry", "link": "https://stackoverflow.com/users/4896021/noor-chaudhry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3119, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1431559366, "creation_date": 1431547911, "last_edit_date": 1431551805, "question_id": 30224338, "link": "https://stackoverflow.com/questions/30224338/sorting-a-list-by-last-name", "title": "Sorting a list by last name", "body": "<p>Jason Chimera SE 7039990101</p>\n\n<p>Mike Knuble SSE 7039990102</p>\n\n<p>Karl Alzner JSE 7039990202</p>\n\n<p>Tom Poti SE 7039990203</p>\n\n<p>Alex Ovechkin EGM 7039990001</p>\n\n<p>I am trying to read in the information above from a file and sort it by last name.  How can I fix this error: </p>\n\n<p>Error:expected a ':' </p>\n\n<p>for the strings I declared in the EmployeeInformation class?</p>\n\n<pre><code> class EmployeeInformation {\n  public string firstName;\n  public string lastName;\n  public string title;\n  public string phonenumber;\n\nEmployeeInformation(&amp;firstName, &amp;lastName, &amp;title, &amp;phonenumber)\n{\n    this-&gt;firstName = firstName;\n    this-&gt;lastName = lastName;\n    this-&gt;initials = title;\n    this-&gt;id = phoneumber;\n}\n};\n\n\n #include &lt;vector&gt;\n #include &lt;algorithm&gt;\n #include &lt;iostream&gt;\n #include &lt;fstream&gt;\n\n using namespace std;\n\nint main(int argc, char**argv) {\n\nifstream file;\nfile.open(\"employees.txt\");\n\nif (!file.is_open())\n    cout &lt;&lt; \"Error opening file\";\n\nvector&lt;EmployeeInformation&gt; employees;\nwhile (!file.eof())\n{\n\n    string firstName, lastName, title, phonenumber;\n    file &gt;&gt; firstName &gt;&gt; lastName &gt;&gt; title &gt;&gt; phonenumber;\n    EmployeeInformation person(firstName, lastName, title, phonenumber);\n    employees.push_back(person);\n    // end file\n}\nsort(employees.begin(), employees.end(), [](EmployeeInformation a, EmployeeInformation b) { return a.lastName &lt; b.lastName });\n\nfor (EmployeeInformation i : employees)\n    // print person info in sorted order\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "opencv", "unsigned-integer", "opencv-mat"], "comments": [{"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 1, "creation_date": 1431547784, "post_id": 30224275, "comment_id": 48552470, "body": "<code>Marker.at&lt;int&gt;(row, col)</code> // &lt;-- Marker.at&lt;uchar&gt;"}, {"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1431547851, "post_id": 30224275, "comment_id": 48552500, "body": "in other words, your Mat got initialized all ok, you&#39;re just accessing it wrong , while checking the result. (btw, try to avoid writing per-pixel loops, rather do <code>cout &lt;&lt; Marker &lt;&lt; endl;</code> )"}, {"owner": {"reputation": 620, "user_id": 4750105, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/717120f6863dcca04e190d6b7eac04aa?s=128&d=identicon&r=PG&f=1", "display_name": "SemtexB", "link": "https://stackoverflow.com/users/4750105/semtexb"}, "reply_to_user": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1431548316, "post_id": 30224275, "comment_id": 48552743, "body": "<code>Marker.at&lt;int&gt;(row, col)</code> does not work the output is <code>Marker: , , , , , ,  , , , , , ,  , , , , , ,  , , , , , ,  , , , , , ,  , , , , , , </code>. This though <code>cout &lt;&lt; Marker &lt;&lt; endl;</code> works and the output is a zeros matrix. Now the question is the what is the type <code>Marker.at&lt;???&gt;(row, col)</code> ?"}, {"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1431548967, "post_id": 30224275, "comment_id": 48553053, "body": "again, the opencv folks already have a solution here, which is: print out the whole Mat at a time. (cout &lt;&lt; Marker &lt;&lt; endl;)"}, {"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1431549155, "post_id": 30224275, "comment_id": 48553156, "body": "again, with opencv, - if you&#39;re trying to write your own per-pixel things, - chances are high, that you&#39;ve missed some higher order function, that does the very same thing without errors and faster."}], "answers": [{"comments": [{"owner": {"reputation": 620, "user_id": 4750105, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/717120f6863dcca04e190d6b7eac04aa?s=128&d=identicon&r=PG&f=1", "display_name": "SemtexB", "link": "https://stackoverflow.com/users/4750105/semtexb"}, "edited": false, "score": 0, "creation_date": 1431548437, "post_id": 30224324, "comment_id": 48552808, "body": "Output for <code>Marker.at&lt;uint8_t&gt;(row, col) </code>: <code>Marker: , , , , , ,  , , , , , ,  , , , , , ,  , , , , , ,  , , , , , ,  , , , , , , </code>.  And for <code>dynamic_cast&lt;int&gt;(Marker_thresh.at&lt;uint8_t&gt;(row, col))</code> the error message is <code>&#39;int&#39; is not a reference or pointer</code>..."}, {"owner": {"reputation": 620, "user_id": 4750105, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/717120f6863dcca04e190d6b7eac04aa?s=128&d=identicon&r=PG&f=1", "display_name": "SemtexB", "link": "https://stackoverflow.com/users/4750105/semtexb"}, "edited": false, "score": 0, "creation_date": 1431549408, "post_id": 30224324, "comment_id": 48553271, "body": "<code>cout &lt;&lt; static_cast&lt;int&gt;(Marker.at&lt;uint8_t&gt;(row, col)) &lt;&lt;&quot;, &quot;;</code> works also, thank you! And what type do I have to use, when I want to change a certain value in <code>Marker</code>? <code>Marker.at&lt;uchar&gt;(row,col)=255;</code>? Is <code>uchar</code> the correct type?"}], "tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": true, "score": 4, "last_activity_date": 1431548787, "last_edit_date": 1431548787, "creation_date": 1431547868, "answer_id": 30224324, "question_id": 30224275, "link": "https://stackoverflow.com/questions/30224275/opencv-matzeros-not-filled-with-0/30224324#30224324", "title": "OpenCV Mat::zeros not filled with 0", "body": "<p>Your <code>Mat</code> object is instantiated with <code>CV_8UC1</code>, that is, containing <code>MarkerSize*MarkerSize</code> 8 bit unsigned elements. But you iterate over it as if it container <code>int</code>s, going out of bounds in the iteration. For example, by accessing the elements with</p>\n\n<pre><code>Marker.at&lt;uint8_t&gt;(row, col)\n</code></pre>\n\n<p>Note that to print this you may have to cast to a different integer type, because <code>uint8_t</code> could be interpreted by <code>std::cout</code> as a <code>char</code>. For example</p>\n\n<pre><code>cout &lt;&lt; static_cast&lt;int&gt;(Marker.at&lt;uint8_t&gt;(row, col)) &lt;&lt;\", \";\n</code></pre>\n"}], "owner": {"reputation": 620, "user_id": 4750105, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/717120f6863dcca04e190d6b7eac04aa?s=128&d=identicon&r=PG&f=1", "display_name": "SemtexB", "link": "https://stackoverflow.com/users/4750105/semtexb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 0, "accepted_answer_id": 30224324, "answer_count": 1, "score": 1, "last_activity_date": 1431548787, "creation_date": 1431547685, "question_id": 30224275, "link": "https://stackoverflow.com/questions/30224275/opencv-matzeros-not-filled-with-0", "title": "OpenCV Mat::zeros not filled with 0", "body": "<p>I have this code:</p>\n\n<pre><code>Mat Marker = Mat::zeros(MarkerSize, MarkerSize, CV_8UC1);\n\ncout &lt;&lt; \"Marker:\" &lt;&lt; endl;\nfor (int row=0; row&lt;MarkerSize; row++)\n{\nfor (int col=0; col&lt;MarkerSize; col++)\ncout &lt;&lt; Marker.at&lt;int&gt;(row, col)&lt;&lt;\", \";\n\ncout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>where <code>MarkerSize=6</code> and <code>CV_8UC1</code> is preferably not changeable (for solution).</p>\n\n<p>But I get this output:</p>\n\n<pre><code>Marker:\n0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 0, 0, \n0, 0, 0, 0, 65536, -1664876544, \n0, 0, 0, 1, 1141152964, 289879, \n0, 65536, -1664876544, 1817658372, 1531445252, 2147447774,\n</code></pre>\n\n<p>How come and how can I fix it?</p>\n"}, {"tags": ["c++", "c++11", "boost", "vector", "stdvector"], "comments": [{"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 0, "creation_date": 1431548075, "post_id": 30224225, "comment_id": 48552612, "body": "Try:    boost::dynamic_pointer_cast&lt;CalibrationModels::Aus&gt;(vec.at(0&zwnj;&#8203;))-&gt;fK3"}], "answers": [{"tags": [], "owner": {"reputation": 2942, "user_id": 4821282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fcf596fdff8b28c477a9105501c8a2?s=128&d=identicon&r=PG&f=1", "display_name": "phantom", "link": "https://stackoverflow.com/users/4821282/phantom"}, "is_accepted": true, "score": 4, "last_activity_date": 1431548337, "creation_date": 1431548337, "answer_id": 30224451, "question_id": 30224225, "link": "https://stackoverflow.com/questions/30224225/changing-values-in-polymorphic-boostshared-ptr-inside-stdvector/30224451#30224451", "title": "Changing values in polymorphic boost::shared_ptr (inside std::vector)", "body": "<p>The problem you have is that <code>px</code> is a private member of the smart pointer. To access your class boost provides the <code>-&gt;</code> operator. You can use that to access the pointer as you would use it for a regular pointer. This would change your line to this:</p>\n\n<pre><code>boost::dynamic_pointer_cast&lt;CalibrationModels::Aus&gt;(vec.at(0))-&gt;fK3 = 1.3221e-9;\n                                                              ^^ Difference here\n</code></pre>\n\n<p>Note that, if you actually need the value, you can use the <code>get()</code> method to get the pointer that is stored in the <code>shared_ptr</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4893109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/248285880b547baa4c9c628d5f0633b9?s=128&d=identicon&r=PG&f=1", "display_name": "Lgum", "link": "https://stackoverflow.com/users/4893109/lgum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 30224451, "answer_count": 1, "score": -2, "last_activity_date": 1431548337, "creation_date": 1431547505, "question_id": 30224225, "link": "https://stackoverflow.com/questions/30224225/changing-values-in-polymorphic-boostshared-ptr-inside-stdvector", "title": "Changing values in polymorphic boost::shared_ptr (inside std::vector)", "body": "<p>I have the following base calibration struct:</p>\n\n<pre><code>struct Standard\n{\npublic:\n    unsigned long ulCamID;\n    std::string sCalibrationModel;\n    float fC;\n    float fXh;\n    float fYh;\n    Standard()\n    {\n        ulCamID = 0;\n        fC = fXh = fYh = 0.0;\n    }\n    virtual ~Standard()\n    {\n\n    }\n};\n</code></pre>\n\n<p>And derived structs such as:</p>\n\n<pre><code>struct Aus: public Standard\n{\npublic:\n    float fK1;\n    float fK2;\n    float fK3;\n    float fP1;\n    float fP2;\n    float fB1;\n    float fB2;\n    Aus()\n    {\n        fC = fXh = fYh = fK1 = fK2 = fK3 = fP1 = fP2 = fB1 = fB2 = 0.0;\n    }\n};\n</code></pre>\n\n<p>Because I do not know at compile how many Calibrations I will need, nor which calibration models, I thought it convenient to put it into a std::vector and use boost::shared_ptr to point to them. I do this like so:</p>\n\n<pre><code>typedef boost::shared_ptr&lt;CalibrationModels::Standard&gt; shr_ptr;\nstd::vector&lt;shr_ptr&gt; vec;\nshr_ptr p(new CalibrationModels::Aus);\nvec.push_back(p);\np.reset(new CalibrationModels::Brown);\nvec.push_back(p);\n</code></pre>\n\n<p>This seems to work fine (the debugger reports that the pointers inside the vector point to the derived struct). However, I have difficulties now to access/change the values inside the vector. If I try something like this:</p>\n\n<pre><code>boost::dynamic_pointer_cast&lt;CalibrationModels::Aus&gt;(vec.at(0)).px-&gt;fK3 = 1.3221e-9\n</code></pre>\n\n<p>It tells me that px is private ( \u2018boost::shared_ptr::element_type* boost::shared_ptr::px\u2019 is private element_type * px; ).</p>\n\n<p>What is the proper way to access and manipulate the values inside those pointers to derived structs?</p>\n"}, {"tags": ["c++", "parallel-processing", "floating-point", "aggregate", "floating-point-precision"], "comments": [{"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 1, "creation_date": 1431592367, "post_id": 30224123, "comment_id": 48567987, "body": "To get as accurate as possible a sum, I would use <a href=\"http://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow noreferrer\">Kahan summation</a>. The code for multiplication is not correct if you are assuming IEEE 754 binary floating point."}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1431613224, "post_id": 30224123, "comment_id": 48580875, "body": "I also don&#39;t see why you need to get into the far-more-complicated-than-you-think details of multiplication. What matters is your processor will multiply two numbers producing the closest representable value to their product."}, {"owner": {"reputation": 2796, "user_id": 4211034, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bd1fa92a66c6c5ee1f7c069384818bb6?s=128&d=identicon&r=PG&f=1", "display_name": "LyingOnTheSky", "link": "https://stackoverflow.com/users/4211034/lyingonthesky"}, "reply_to_user": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1431627767, "post_id": 30224123, "comment_id": 48590052, "body": "@PatriciaShanahan It isn&#39;t paralleizable, or is it? Multiplying too many numbers (billions) will have great error, and I have enough power to even sort those numbers, so why not?"}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1431628715, "post_id": 30224123, "comment_id": 48590625, "body": "The main concern I would have with multiplying billions of floating point numbers is exponent overflow or underflow. Sorting would increase the risk of an intermediate result being much larger or smaller than the final product. The one billionth root of the largest finite double is about 1.0000007097829648. The one billionth root of the smallest positive double is about 0.9999992555602052. (Assuming IEEE 754 64 bit binary)"}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1431629058, "post_id": 30224123, "comment_id": 48590820, "body": "If there is a risk of overflow or underflow it might be worth while summing the logarithms. Calculating the logarithms is embarrassingly parallelizable. The addition could be sorted or Kahan."}, {"owner": {"reputation": 2796, "user_id": 4211034, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bd1fa92a66c6c5ee1f7c069384818bb6?s=128&d=identicon&r=PG&f=1", "display_name": "LyingOnTheSky", "link": "https://stackoverflow.com/users/4211034/lyingonthesky"}, "reply_to_user": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 0, "creation_date": 1431689351, "post_id": 30224123, "comment_id": 48616266, "body": "@PatriciaShanahan Actually at the end I need to look at the logarithm so it&#39;s pretty much solves my problem, but I will let this question be open."}], "answers": [{"comments": [{"owner": {"reputation": 2796, "user_id": 4211034, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bd1fa92a66c6c5ee1f7c069384818bb6?s=128&d=identicon&r=PG&f=1", "display_name": "LyingOnTheSky", "link": "https://stackoverflow.com/users/4211034/lyingonthesky"}, "edited": false, "score": 0, "creation_date": 1431692413, "post_id": 30258896, "comment_id": 48618313, "body": "I am using GPU, it&#39;s a bit problemic to run a loop inside GPU, I will try something."}], "tags": [], "owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "is_accepted": false, "score": 1, "last_activity_date": 1431691362, "last_edit_date": 1431691362, "creation_date": 1431690854, "answer_id": 30258896, "question_id": 30224123, "link": "https://stackoverflow.com/questions/30224123/how-to-aggregate-floating-point-array-and-get-precise-result-with-parallelizable/30258896#30258896", "title": "How to aggregate floating point array and get precise result with parallelizable method?", "body": "<p>The main problem with multiplying billions of doubles is exponent overflow and underflow. Assuming double is IEEE 754 64-bit binary floating point, the one billionth root of the largest finite double is about 1.0000007097829648. The one billionth root of the smallest positive double is about 0.9999992555602052. Multiplying a billion numbers each of which is greater than 1.0000007097829648 will give an infinite results. Multiplying a billion numbers each less than 0.9999992555602052 will underflow to zero.</p>\n\n<p>The simplest solution is to add the logarithms of the inputs to get the logarithm of their product. The logarithms calculation parallelizes extremely well.</p>\n\n<p>For accuracy, the sum of the logarithms should be calculated using <a href=\"http://en.wikipedia.org/wiki/Kahan_summation_algorithm\" rel=\"nofollow\">Kahan summation</a> to get O(1) error growth. For performance, it should be done in parallel, suggesting <a href=\"http://en.wikipedia.org/wiki/Pairwise_summation\" rel=\"nofollow\">pairwise summation</a>.</p>\n\n<p>It may be worth experimenting with a compromise. Have each processor do Kahan summation of a subset of the inputs, then have one processor do Kahan summation of those sums.</p>\n\n<p>Alternatively, have one thread do a full Kahan summation but feed chunks of logarithms to it as they are generated by all the other threads.</p>\n"}], "owner": {"reputation": 2796, "user_id": 4211034, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bd1fa92a66c6c5ee1f7c069384818bb6?s=128&d=identicon&r=PG&f=1", "display_name": "LyingOnTheSky", "link": "https://stackoverflow.com/users/4211034/lyingonthesky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431691362, "creation_date": 1431547135, "question_id": 30224123, "link": "https://stackoverflow.com/questions/30224123/how-to-aggregate-floating-point-array-and-get-precise-result-with-parallelizable", "title": "How to aggregate floating point array and get precise result with parallelizable method?", "body": "<p>To get the precise sum of a floating point array I just have to sort them and add every pair, then again and add pairs (of those sums of pairs) until I have just one element. (Correct?)</p>\n\n<p>How I do it when I want to find the multiple sum. (correct word?)</p>\n\n<p>I am assuming that multiplying two floating points numbers does: (Is it right too?)</p>\n\n<pre><code>// sign -&gt; -1 or 1\n// mantissa -&gt; 0.5 ... &lt;1.0 (Never actual 1.0)\n\nnew_sign = x_sign * y_sign\nnew_exponent = x_exponent + y_exponent\nnew_mantissa = x_mantissa * y_mantissa\n\nif (new_mantissa &lt; 0.5) {\n    new_mantissa *= 2.0\n    new_exponent--\n}\n</code></pre>\n\n<p>There's no precision problem with <code>new_sign</code> nor <code>new_exponent</code>, I shouldn't give attention to them. I should see precise lose with <code>new_mantissa</code>. So should I sort the floating point by their mantissa, and then what? What said is correct?</p>\n\n<p>If I am not in the correct direction, then what is the correct direction to achieve this effect?</p>\n"}, {"tags": ["c++", "struct", "osdev"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 1, "creation_date": 1431546793, "post_id": 30223983, "comment_id": 48551929, "body": "All like <i>all</i> or all like <code>Revision + RsdtAddress + Checksum + ...</code>? Or just the total size or what?"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 2, "creation_date": 1431546845, "post_id": 30223983, "comment_id": 48551957, "body": "You would add up the <code>sizeof</code> each element. Note that you cannot just ask for <code>sizeof(RSDPDescriptor)</code> because that would include padding."}, {"owner": {"reputation": 3688, "user_id": 1111557, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f2b40cacf02c8fa3f91429ef441912ac?s=128&d=identicon&r=PG", "display_name": "inetknght", "link": "https://stackoverflow.com/users/1111557/inetknght"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 4, "creation_date": 1431546871, "post_id": 30223983, "comment_id": 48551968, "body": "@Cyber: <code>__attribute__ ((packed))</code> has padding?"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 3688, "user_id": 1111557, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f2b40cacf02c8fa3f91429ef441912ac?s=128&d=identicon&r=PG", "display_name": "inetknght", "link": "https://stackoverflow.com/users/1111557/inetknght"}, "edited": false, "score": 2, "creation_date": 1431546935, "post_id": 30223983, "comment_id": 48552007, "body": "@inetknght Good catch, you are correct!"}, {"owner": {"reputation": 364, "user_id": 2765089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/200fa6bf8eb4335c7a3661c90a76d376?s=128&d=identicon&r=PG&f=1", "display_name": "Makerimages", "link": "https://stackoverflow.com/users/2765089/makerimages"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1431547806, "post_id": 30223983, "comment_id": 48552478, "body": "@Barry The sum of all the bytes, not the number of bytes."}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 2765089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/200fa6bf8eb4335c7a3661c90a76d376?s=128&d=identicon&r=PG&f=1", "display_name": "Makerimages", "link": "https://stackoverflow.com/users/2765089/makerimages"}, "edited": false, "score": 0, "creation_date": 1431548242, "post_id": 30224331, "comment_id": 48552700, "body": "Going to give this a try tomorrow."}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": true, "score": 5, "last_activity_date": 1431547893, "creation_date": 1431547893, "answer_id": 30224331, "question_id": 30223983, "link": "https://stackoverflow.com/questions/30223983/c-add-up-all-bytes-in-a-structure/30224331#30224331", "title": "C++ add up all bytes in a structure", "body": "<p>Here is some code that shows two ways to do it.</p>\n\n<p>The first way is easier and more efficient, but will give the wrong result for a struct that doesn't have the packed attribute (since it will incorrectly include the padding bytes in its tally).</p>\n\n<p>The second approach will work on any struct, padded or packed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntemplate&lt;typename T&gt; int CountBytes(const T &amp; t)\n{\n   int count = 0;\n   const unsigned char * p = reinterpret_cast&lt;const unsigned char *&gt;(&amp;t);\n   for (int i=0; i&lt;sizeof(t); i++) count += p[i];\n   return count;\n}\n\nstruct RSDPDescriptor {\n    char Signature[8];\n    unsigned char Checksum;\n    char OEMID[6];\n    unsigned char Revision;\n    unsigned int RsdtAddress;\n} __attribute__ ((packed));\n\nint main(int, char **)\n{\n   struct RSDPDescriptor x;\n\n   int byteCountFast = CountBytes(x);\n   printf(\"Fast result (only works correctly if the struct is packed) is:  %i\\n\", byteCountFast);\n\n   int byteCountSafe = CountBytes(x.Signature) + CountBytes(x.Checksum) + CountBytes(x.OEMID) + CountBytes(x.Revision) + CountBytes(x.RsdtAddress);\n   printf(\"Safe result (will work even if there is padding) is:  %i\\n\", byteCountSafe);\n\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 364, "user_id": 2765089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/200fa6bf8eb4335c7a3661c90a76d376?s=128&d=identicon&r=PG&f=1", "display_name": "Makerimages", "link": "https://stackoverflow.com/users/2765089/makerimages"}, "edited": false, "score": 0, "creation_date": 1431548164, "post_id": 30224400, "comment_id": 48552651, "body": "Kernel programming - can&#39;t use std:: stuff."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 364, "user_id": 2765089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/200fa6bf8eb4335c7a3661c90a76d376?s=128&d=identicon&r=PG&f=1", "display_name": "Makerimages", "link": "https://stackoverflow.com/users/2765089/makerimages"}, "edited": false, "score": 3, "creation_date": 1431548199, "post_id": 30224400, "comment_id": 48552671, "body": "@Makerimages Things like what you actually want to do and restrictions you have belong in the question."}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "reply_to_user": {"reputation": 364, "user_id": 2765089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/200fa6bf8eb4335c7a3661c90a76d376?s=128&d=identicon&r=PG&f=1", "display_name": "Makerimages", "link": "https://stackoverflow.com/users/2765089/makerimages"}, "edited": false, "score": 0, "creation_date": 1431548434, "post_id": 30224400, "comment_id": 48552804, "body": "@Makerimages <code>std::accumulate</code> is usually a header-only implementation. (aka the code ends up as part of your object file. It doesn&#39;t come from a standard precompiled library.) So you sould be fine. (But I would double check your particular compiler first.)"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 6, "last_activity_date": 1431548108, "creation_date": 1431548108, "answer_id": 30224400, "question_id": 30223983, "link": "https://stackoverflow.com/questions/30223983/c-add-up-all-bytes-in-a-structure/30224400#30224400", "title": "C++ add up all bytes in a structure", "body": "<p>I would just forward to <a href=\"http://en.cppreference.com/w/cpp/algorithm/accumulate\"><code>std::accumulate</code></a>:</p>\n\n<pre><code>template &lt;typename T&gt;\nsize_t sum_bytes(const T&amp; obj) {\n    const unsigned char* p = reinterpret_cast&lt;const unsigned char*&gt;(&amp;obj);\n    return std::accumulate(p, p + sizeof(T), 0u);\n}\n</code></pre>\n"}], "owner": {"reputation": 364, "user_id": 2765089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/200fa6bf8eb4335c7a3661c90a76d376?s=128&d=identicon&r=PG&f=1", "display_name": "Makerimages", "link": "https://stackoverflow.com/users/2765089/makerimages"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1566, "favorite_count": 0, "accepted_answer_id": 30224331, "answer_count": 2, "score": -1, "last_activity_date": 1431548108, "creation_date": 1431546611, "last_edit_date": 1431548003, "question_id": 30223983, "link": "https://stackoverflow.com/questions/30223983/c-add-up-all-bytes-in-a-structure", "title": "C++ add up all bytes in a structure", "body": "<p>Given a packed struct like this:</p>\n\n<pre><code>struct RSDPDescriptor {\n    char Signature[8];\n    uint8_t Checksum;\n    char OEMID[6];\n    uint8_t Revision;\n    uint32_t RsdtAddress;\n} __attribute__ ((packed));\n</code></pre>\n\n<p>How can I sum all of the individual bytes in it?</p>\n"}, {"tags": ["c++", "c", "dll", "operating-system"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1431546418, "post_id": 30223897, "comment_id": 48551739, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/19418908/creating-a-portable-library-to-run-on-both-linux-and-windows\">Creating a portable library to run on both linux and windows</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1431546623, "post_id": 30223897, "comment_id": 48551833, "body": "This is one of the big things pre processor directives are used for."}, {"owner": {"reputation": 476, "user_id": 4866874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1tfCr.jpg?s=128&g=1", "display_name": "the accountant", "link": "https://stackoverflow.com/users/4866874/the-accountant"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431546997, "post_id": 30223897, "comment_id": 48552044, "body": "@NathanOliver thanks , so that means the libraries have different implementations for different OS&#39;s and when compiling my program the correct implementation will be taken from the static library ?"}, {"owner": {"reputation": 476, "user_id": 4866874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1tfCr.jpg?s=128&g=1", "display_name": "the accountant", "link": "https://stackoverflow.com/users/4866874/the-accountant"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1431547101, "post_id": 30223897, "comment_id": 48552101, "body": "@Ken White thanks , the question you put  emphasizes that there are different dlls for different OS&#39;s, is that correct ?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1431547177, "post_id": 30223897, "comment_id": 48552145, "body": "@big.heart Yes.  You basically have code to deal with each OS in the program and you use the pre processor to determine which code to actually use."}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 1, "creation_date": 1431547351, "post_id": 30223897, "comment_id": 48552254, "body": "See also <a href=\"http://stackoverflow.com/questions/5919996/how-to-detect-reliably-mac-os-x-ios-linux-windows-in-c-preprocessor#5920028\" title=\"how to detect reliably mac os x ios linux windows in c preprocessor%235920028\">stackoverflow.com/questions/5919996/&hellip;</a>"}, {"owner": {"reputation": 476, "user_id": 4866874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1tfCr.jpg?s=128&g=1", "display_name": "the accountant", "link": "https://stackoverflow.com/users/4866874/the-accountant"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431547353, "post_id": 30223897, "comment_id": 48552256, "body": "@NathanOliver, I got it, but what about the dynamic linking ? are the dll&#39;s have different implementations inside their binary code that will execute differently at run time depends on the OS&#39;s they are on ?"}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 1, "creation_date": 1431547429, "post_id": 30223897, "comment_id": 48552288, "body": "@big.heart generally there is a seperate .dll (or .so for linux or .dylib for OS X) for each operating system."}], "answers": [{"tags": [], "owner": {"reputation": 1379, "user_id": 4682920, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ri6Av.png?s=128&g=1", "display_name": "Imobilis", "link": "https://stackoverflow.com/users/4682920/imobilis"}, "is_accepted": false, "score": 1, "last_activity_date": 1431547762, "last_edit_date": 1431547762, "creation_date": 1431547428, "answer_id": 30224204, "question_id": 30223897, "link": "https://stackoverflow.com/questions/30223897/how-can-libraries-achieve-portability-among-different-os/30224204#30224204", "title": "how can libraries achieve portability among different OS", "body": "<p>A quick example..</p>\n\n<pre><code>#ifdef OS_WINDOWS\n   //definition for Windows\n#else\n  //define it for Unix\n#endif\n</code></pre>\n\n<p>They use pre-processor to determine OS, some pointer tricks to determine endianness. Nothing too complex in general.\nOnce stds determine the OS, using the pre-defined definitions.. they use the appropriate code that relates.</p>\n\n<pre><code>// Real-life example:\nif(definition == 2) system(\"cls\");\nelse system(\"clear\");\n</code></pre>\n"}], "owner": {"reputation": 476, "user_id": 4866874, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1tfCr.jpg?s=128&g=1", "display_name": "the accountant", "link": "https://stackoverflow.com/users/4866874/the-accountant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431547762, "creation_date": 1431546306, "question_id": 30223897, "link": "https://stackoverflow.com/questions/30223897/how-can-libraries-achieve-portability-among-different-os", "title": "how can libraries achieve portability among different OS", "body": "<p>like c/c++ standard libraries.</p>\n\n<p>since the functions in the standard library eventually will call a specific OS API's to do it's jobs , how can these language libraries achieve portability, if I wanted to compile my code to run on other Os.\nwill the libraries change it's code(the calls to the particular Os APIs) ?, is there different versions of these libraries target different OS's  ?. or what ?\nthanks in advance.</p>\n"}, {"tags": ["c++", "multithreading", "locking", "free", "atomic"], "comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1431546210, "post_id": 30223815, "comment_id": 48551627, "body": "The example for <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/compare_exchange\" rel=\"nofollow noreferrer\"><code>compare_exchange_weak</code></a> actually implements a lock free <code>stack::push</code>."}, {"owner": {"reputation": 41, "user_id": 3672687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXYZv.jpg?s=128&g=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/3672687/maksim"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1431546362, "post_id": 30223815, "comment_id": 48551713, "body": "@Barry, field <code>node* next</code> actually should look like <code>std::atomic&lt;node*&gt; next</code>"}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431547997, "post_id": 30223815, "comment_id": 48552572, "body": "you may be hitting a compiler bug: <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/819819/std-atomic-compare-exchange-weak-has-spurious-write-which-can-cause-race-conditions\" rel=\"nofollow noreferrer\">msvc</a>, <a href=\"http://lists.cs.uiuc.edu/pipermail/llvmbugs/2014-February/032833.html\" rel=\"nofollow noreferrer\">clang</a>, and <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=60272\" rel=\"nofollow noreferrer\">gcc</a> all had problems compiling compare_exchange_* correctly. See <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic/compare_exchange\" rel=\"nofollow noreferrer\">example</a> from cppreference.com."}, {"owner": {"reputation": 41, "user_id": 3672687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXYZv.jpg?s=128&g=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/3672687/maksim"}, "reply_to_user": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431548842, "post_id": 30223815, "comment_id": 48552992, "body": "@programmerjake compare_exchange really can&#39;t take the first argument if it&#39;s an atomic. It&#39;s not a bug"}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1431551495, "post_id": 30223815, "comment_id": 48554364, "body": "Unless there&#39;s something you&#39;re not telling us, start by making next non-atomic."}, {"owner": {"reputation": 41, "user_id": 3672687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXYZv.jpg?s=128&g=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/3672687/maksim"}, "reply_to_user": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1431552728, "post_id": 30223815, "comment_id": 48554996, "body": "@Cubbi Like in the first variant? And what is the next step?"}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 0, "creation_date": 1431553470, "post_id": 30223815, "comment_id": 48555327, "body": "@Maksim given that your first example appears to be lifted straight from Listing 7.3 of Concurrency in Action, debug"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3672687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXYZv.jpg?s=128&g=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/3672687/maksim"}, "edited": false, "score": 0, "creation_date": 1431556027, "post_id": 30225771, "comment_id": 48556419, "body": "Thank you, but still, how to implement this with <code>std::atomic&lt;node*&gt;</code> next?"}], "tags": [], "owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "is_accepted": false, "score": 1, "last_activity_date": 1431553795, "creation_date": 1431553795, "answer_id": 30225771, "question_id": 30223815, "link": "https://stackoverflow.com/questions/30223815/c-how-to-make-lock-free-stack-push-atomic/30225771#30225771", "title": "c++ how to make lock free stack push atomic", "body": "<p>One problem with the test is the line <code>sum.store(sum.load() + *val);</code></p>\n\n<p>Use atomic ops, such as <code>sum += *val;</code></p>\n"}, {"tags": [], "owner": {"reputation": 759, "user_id": 1043152, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R4HNs.png?s=128&g=1", "display_name": "JATothrim", "link": "https://stackoverflow.com/users/1043152/jatothrim"}, "is_accepted": false, "score": 1, "last_activity_date": 1487002461, "creation_date": 1487002461, "answer_id": 42208620, "question_id": 30223815, "link": "https://stackoverflow.com/questions/30223815/c-how-to-make-lock-free-stack-push-atomic/42208620#42208620", "title": "c++ how to make lock free stack push atomic", "body": "<p>The first variant is garbage, because you can't guarantee atomicity on stores to node::next pointer. It would possible to use memory fence/barrier with non-atomic next-pointers, but I wouldn't trust such implementation.\nYour second variant is more close to correct implementation.\nHowever you forgot the most important thing from the push() CAS-loop:</p>\n\n<pre><code>void push(const T&amp; val) {\n    node* new_node = new node(val);\n    new_node-&gt;next = head.load();\n    node* local_next = new_node-&gt;next.load();\n    while (!head.compare_exchange_weak(local_next, new_node)); \n}\n</code></pre>\n\n<p>Here the code allocates new node, loads and stores <code>head</code> pointer to <code>new_node-&gt;next</code>. Next, code saves already known stack <code>head</code> pointer value to <code>local_next</code>. (unnecessary step) Then code tries update stack <code>head</code> to <code>new_node</code> without updating <code>new_node-&gt;next</code>. This would be fine you were on singe core machine running single thread without pre-emption and the CAS would succeed 100% of time. ;)</p>\n\n<p>When the CAS fails, it loads current fresh value of <code>head</code> into <code>local_next</code> and the code is stuck in infinite loop, because <code>new_node</code> will never be equal to <code>local_next</code>. So you got the last part wrong.</p>\n\n<p>To make a functional CAS-loop the failing thread <strong>must</strong> reload and recompute what ever data it was trying to update. This means you must update <code>new_node-&gt;next</code> from <code>head</code> before re-trying the CAS.\nThis does not solve the ABA problem of CAS-loops, but I leave it out from my answer. I suggest reading more about CAS-operation and its pitfalls.</p>\n\n<p>Because CAS operation does a load operation the fix is very simple, just store <code>local_next</code> to <code>new_node-&gt;next</code> after failing CAS.\nHere is more valid (untested) version:</p>\n\n<pre><code>node* new_node = new node(val);\nnode* local_head = head.load();\nnew_node-&gt;next.store(local_head);\nwhile(!head.compare_exchange_weak(local_head, new_node) {\n    new_node-&gt;next.store(local_head);\n}\n</code></pre>\n\n<p>You'll to do similiar thing to your pop() implementation.</p>\n"}], "owner": {"reputation": 41, "user_id": 3672687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dXYZv.jpg?s=128&g=1", "display_name": "Maksim", "link": "https://stackoverflow.com/users/3672687/maksim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1487002461, "creation_date": 1431545999, "last_edit_date": 1431550074, "question_id": 30223815, "link": "https://stackoverflow.com/questions/30223815/c-how-to-make-lock-free-stack-push-atomic", "title": "c++ how to make lock free stack push atomic", "body": "<p>I need to write a <code>void push(const T&amp; val)</code> implementation for lock free stack.\nThe problem is that compare_exchange_weak expects non atomic <code>node*</code> but I must use <code>std::atomic&lt;node*&gt; next</code> field instead of regular <code>node* next</code>.\nI tried to solve this problem by doing this</p>\n\n<pre><code>void push(const T&amp; val) {\n    node* new_node = new node(val);\n    node* local_next = new_node-&gt;next.load();\n    while (!head.compare_exchange_weak(local_next, new_node));\n}\n</code></pre>\n\n<p>But creating if <code>local_next</code> makes things even worse. I tested 2 variants of code. The first one has non-atomic field <code>node* next</code> and I lost about 20-30 elements in the test code below. And using the second variant I got a deadlock.</p>\n\n<p>Test code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;atomic&gt;\n#include \"lock_free_stack.h\"\n\nusing namespace std;\n\nvoid test(lock_free_stack&lt;int&gt;&amp; st, atomic&lt;int&gt;&amp; sum) {\n    st.push(1);\n    shared_ptr&lt;int&gt; val(st.pop());\n    while (val == nullptr) { }\n    sum.store(sum.load() + *val);\n}\n\nint main(int argc, const char * argv[]) {\n    atomic&lt;int&gt; sum;\n    sum.store(0);\n    for (int i = 0; i &lt; 100; ++i) {\n        lock_free_stack&lt;int&gt; st;\n        thread t1(test, ref(st), ref(sum));\n        thread t2(test, ref(st), ref(sum));\n        thread t3(test, ref(st), ref(sum));\n        thread t4(test, ref(st), ref(sum));\n        thread t5(test, ref(st), ref(sum));\n        thread t6(test, ref(st), ref(sum));\n        thread t7(test, ref(st), ref(sum));\n        thread t8(test, ref(st), ref(sum));\n        t1.join();\n        t2.join();\n        t3.join();\n        t4.join();\n        t5.join();\n        t6.join();\n        t7.join();\n        t8.join();\n    }\n    if (sum.load() == 800) {\n        cout &lt;&lt; \"CORRECT\" &lt;&lt; endl;\n    } else {\n        cout &lt;&lt; \"TIME TO REWRITE STACK \" &lt;&lt; sum &lt;&lt; endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>And the code of my lock free stack (first variant):</p>\n\n<pre><code>#ifndef lock_free_stack_hard_lock_free_stack_h\n#define lock_free_stack_hard_lock_free_stack_h\n\ntemplate &lt;typename T&gt;\nclass lock_free_stack {\nprivate:\n    struct node {\n        node* next;\n        std::shared_ptr&lt;T&gt; value;\n        node (const T&amp; val) : value(std::make_shared&lt;T&gt;(val)) { }\n    };\n    std::atomic&lt;node*&gt; head;\n    std::shared_ptr&lt;T&gt; default_value;\n\npublic:\n    lock_free_stack() : head(nullptr), default_value(std::make_shared&lt;T&gt;()) { }\n\n    void push(const T&amp; val) {\n        node* new_node = new node(val);\n        new_node-&gt;next = head.load();\n        while (!head.compare_exchange_weak(new_node-&gt;next, new_node));\n    }\n\n    std::shared_ptr&lt;T&gt; pop() {\n        node* old_head = head.load();\n        while (old_head &amp;&amp; !head.compare_exchange_weak(old_head, old_head-&gt;next));\n        if (old_head) {\n            return old_head-&gt;value;\n        } else {\n            return std::shared_ptr&lt;T&gt;();\n        }\n    }\n};\n\n#endif\n</code></pre>\n\n<p>And the second variant: </p>\n\n<pre><code>#ifndef lock_free_stack_hard_lock_free_stack_h\n    #define lock_free_stack_hard_lock_free_stack_h\n\n    template &lt;typename T&gt;\n    class lock_free_stack {\n    private:\n        struct node {\n            std::atomic&lt;node*&gt; next;\n            std::shared_ptr&lt;T&gt; value;\n            node (const T&amp; val) : value(std::make_shared&lt;T&gt;(val)) { }\n        };\n        std::atomic&lt;node*&gt; head;\n        std::shared_ptr&lt;T&gt; default_value;\n\n    public:\n        lock_free_stack() : head(nullptr), default_value(std::make_shared&lt;T&gt;()) { }\n\n        void push(const T&amp; val) {\n            node* new_node = new node(val);\n            new_node-&gt;next = head.load();\n            node* local_next = new_node-&gt;next.load();\n            while (!head.compare_exchange_weak(local_next, new_node)); \n        }\n\n        std::shared_ptr&lt;T&gt; pop() {\n            node* old_head = head.load();\n            while (old_head &amp;&amp; !head.compare_exchange_weak(old_head, old_head-&gt;next));\n            if (old_head) {\n                return old_head-&gt;value;\n            } else {\n                return std::shared_ptr&lt;T&gt;();\n            }\n        }\n    };\n\n    #endif\n</code></pre>\n\n<p>So the final question is how to create that <code>local_next</code> correctly?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1431545886, "post_id": 30223741, "comment_id": 48551463, "body": "@Cetshwayo Maybe you should simply enter and compile the original code should not you?:)"}, {"owner": {"reputation": 724, "user_id": 609579, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cff6826c1faad4528b1ce15dda1f0e6d?s=128&d=identicon&r=PG", "display_name": "Mads", "link": "https://stackoverflow.com/users/609579/mads"}, "edited": false, "score": 0, "creation_date": 1431545915, "post_id": 30223741, "comment_id": 48551479, "body": "I spot several errors your code. First off: It&#39;s temp[1], not &quot;temp[1]&quot;. &quot;temp[1]&quot; is a string. And in actuality I guess you want temp[i] and not temp[1]."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "edited": false, "score": 0, "creation_date": 1431546453, "post_id": 30223792, "comment_id": 48551753, "body": "Thanks yet it is still not working. Now instead of an error message I am getting nothing."}, {"owner": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "edited": false, "score": 0, "creation_date": 1431546748, "post_id": 30223792, "comment_id": 48551911, "body": "the error message is 6:26 &quot;MAXTEMPS is used unitialized in the function[-Wunitialized]"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "edited": false, "score": 0, "creation_date": 1431546787, "post_id": 30223792, "comment_id": 48551923, "body": "Because <code>MAXTEMPS</code> is uninitialized, <code>int MAXTEMPS;</code>. You need to assign a value to it, like <code>int MAXTEMPS = 10</code>;"}, {"owner": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "edited": false, "score": 0, "creation_date": 1431546849, "post_id": 30223792, "comment_id": 48551960, "body": "what is the difference between const int and int?"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "edited": false, "score": 0, "creation_date": 1431546893, "post_id": 30223792, "comment_id": 48551984, "body": "You are not allowed to modify a <code>const</code> variable, you can modify a non-<code>const</code> variable. It would really help you to sit down with an introductory C++ text, many of these things are covered."}, {"owner": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "edited": false, "score": 0, "creation_date": 1431547101, "post_id": 30223792, "comment_id": 48552102, "body": "Believe it are not I do have a text. I have a test on Monday. Horrible instructor etc..so I&#39;m trying to do the best I can under the circumstances. Nonetheless, what do you mean I can not modify it, as oppose to what? I initialized the int MAXTEMPS = 5, and the program work. What difference does it make to use the const*?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1431547110, "post_id": 30223792, "comment_id": 48552106, "body": "@Cyber. Your comment is backwards :)"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1431547149, "post_id": 30223792, "comment_id": 48552123, "body": "@chris <code>Cyber.insert(COFFEE)</code>"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 2, "last_activity_date": 1431546068, "last_edit_date": 1431546068, "creation_date": 1431545921, "answer_id": 30223792, "question_id": 30223741, "link": "https://stackoverflow.com/questions/30223741/array-code-why-wont-it-compile/30223792#30223792", "title": "Array Code-Why Won&#39;t it Compile?", "body": "<p>You are trying to <code>cin</code> to a literal for some reason</p>\n\n<pre><code>cin &gt;&gt; \"Temp[1]\";\n</code></pre>\n\n<p>Get rid of the quotes, use correct capitalization, and use the index variable <code>i</code>.</p>\n\n<pre><code>cin &gt;&gt; temp[i];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 507, "user_id": 2656778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edd3d03b8193f4312e8d29e3853ef90d?s=128&d=identicon&r=PG", "display_name": "Naor Hadar", "link": "https://stackoverflow.com/users/2656778/naor-hadar"}, "is_accepted": false, "score": 0, "last_activity_date": 1431546788, "creation_date": 1431546788, "answer_id": 30224024, "question_id": 30223741, "link": "https://stackoverflow.com/questions/30223741/array-code-why-wont-it-compile/30224024#30224024", "title": "Array Code-Why Won&#39;t it Compile?", "body": "<p>First, the variable:</p>\n\n<pre><code>int MAXTEMPS;\n</code></pre>\n\n<p>is not initialized, as the original code shows, it needs to be equal to 5.</p>\n\n<pre><code>int MAXTEMPS = 5;\n</code></pre>\n\n<p>Second, you cant get input (cin) with a string literal, and you don't wont to use one index to get the input all so (temp[1]), so do this:</p>\n\n<pre><code>cin &gt;&gt; temp[i];\n</code></pre>\n\n<p>you should also consider using tabs when you enter a block (better to understand the code in my opinion)</p>\n"}], "owner": {"reputation": 115, "user_id": 4893782, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXJIN.jpg?s=128&g=1", "display_name": "Cetshwayo", "link": "https://stackoverflow.com/users/4893782/cetshwayo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 30223792, "answer_count": 2, "score": -6, "last_activity_date": 1431547420, "creation_date": 1431545696, "last_edit_date": 1431547420, "question_id": 30223741, "link": "https://stackoverflow.com/questions/30223741/array-code-why-wont-it-compile", "title": "Array Code-Why Won&#39;t it Compile?", "body": "<p>Why is this code not compiling. The error message I am getting is  </p>\n\n<pre><code>In function 'int main()':\n10:15: error: cannot bind 'std::istream {aka std::basic_istream&lt;char&gt;}' lvalue to 'std::basic_istream&lt;char&gt;&amp;&amp;'\nIn file included from /usr/include/c++/4.9/iostream:40:0,\n                 from 1:\n/usr/include/c++/4.9/istream:872:5: note: initializing argument 1 of 'std::basic_istream&lt;_CharT, _Traits&gt;&amp; std::operator&gt;&gt;(std::basic_istream&lt;_CharT, _Traits&gt;&amp;&amp;, _Tp&amp;) [with _CharT = char; _Traits = std::char_traits&lt;char&gt;; _Tp = const char [8]]'\n     operator&gt;&gt;(basic_istream&lt;_CharT, _Traits&gt;&amp;&amp; __is, _Tp&amp; __x)\n     ^\n\n\n\n\n#include &lt;iostream&gt;\nusing namespace std;\nint main()\n{\n    int MAXTEMPS;\n    int i, temp [MAXTEMPS];\n    for(i=0; i&lt; MAXTEMPS; i++) \n    {\n        cout&lt;&lt;\"Enter a Temperature:\" ;\n        cin&gt;&gt; \"Temp[1]\";\n    }\n    cout&lt;&lt;endl; \n\n    for(i=0; i&lt;MAXTEMPS; i++)\n    cout&lt;&lt;\"Temperature \"&lt;&lt;i&lt;&lt;\" is\" &lt;&lt;temp[i]&lt;&lt;endl; \n    return 0; \n}\n</code></pre>\n\n<p>Original code: <img src=\"https://i.stack.imgur.com/dQBvO.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c++", "jpeg", "filepath", "fltk"], "comments": [{"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1431861160, "post_id": 30223733, "comment_id": 48670014, "body": "Did you build the fltkjpeg.lib or did it come as a set of libraries?  If you have the fltk source, just single step into Fl_JPEG_Image and find out why it is not loading.  If you can&#39;t step into Fl_JPEG_Image, ensure that you&#39;re writing out the debug symbols to a suitably named pdb file (not vxxx.pdb which is the MS default)"}, {"owner": {"reputation": 51, "user_id": 3626423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d81a00c930920f7dea81c43c8089fa54?s=128&d=identicon&r=PG&f=1", "display_name": "joasisk", "link": "https://stackoverflow.com/users/3626423/joasisk"}, "reply_to_user": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1431888112, "post_id": 30223733, "comment_id": 48678096, "body": "the lib used is downloaded from fltk&#39;s page"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 3626423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d81a00c930920f7dea81c43c8089fa54?s=128&d=identicon&r=PG&f=1", "display_name": "joasisk", "link": "https://stackoverflow.com/users/3626423/joasisk"}, "is_accepted": true, "score": 0, "last_activity_date": 1431890244, "last_edit_date": 1431890244, "creation_date": 1431888074, "answer_id": 30290692, "question_id": 30223733, "link": "https://stackoverflow.com/questions/30223733/open-image-with-fltk-on-windows/30290692#30290692", "title": "open image with FLTK on windows", "body": "<p>Actually the solution is simple:</p>\n\n<p>Despite using <em>Windows</em> you have to enter <em>Unix</em> style path, so instead of backward <code>\"\\\\\"</code> simply use <code>\"/\"</code> so the path should look like this: <code>\"e:/zaloha/Pictures/my/DSC_0242.jpg\"</code></p>\n"}], "owner": {"reputation": 51, "user_id": 3626423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d81a00c930920f7dea81c43c8089fa54?s=128&d=identicon&r=PG&f=1", "display_name": "joasisk", "link": "https://stackoverflow.com/users/3626423/joasisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "accepted_answer_id": 30290692, "answer_count": 1, "score": 0, "last_activity_date": 1431890244, "creation_date": 1431545676, "last_edit_date": 1431890183, "question_id": 30223733, "link": "https://stackoverflow.com/questions/30223733/open-image-with-fltk-on-windows", "title": "open image with FLTK on windows", "body": "<p>I'm having problem: I was trying to add image to my _fl_group_ but was not able to do so.</p>\n\n<p>I was trying to identify where the problem occurs and according to specification on <em>fltk's</em> webpage, if image is opened with <code>fl_JPEG_image(const char* path)</code> constructor correctly, calling <code>im-&gt;w()</code> should <code>return &gt; 0</code> but it does not.</p>\n\n<p>I don't know if I'm entering path correctly (in proper way)? I'm on win and the path to file is <code>\"e:\\\\zaloha\\\\Pictures\\\\my\\\\DSC_0242.jpg\"</code> and that is the way I typed it but after opening width is still 0 here is my code:</p>\n\n<pre><code>Fl_JPEG_Image* im = new Fl_JPEG_Image(\"e:\\\\zaloha\\\\Pictures\\\\my\\\\DSC_0242.jpg\");\ndouble w = im-&gt;w();\ndouble h = im-&gt;h();\ndouble d = im-&gt;d();\nimages.push_back(im);\nFl_Box* box = new Fl_Box(10,10,600,400);\nbox-&gt;image(im);\nPic_GR-&gt;add(box);\n</code></pre>\n\n<p>so as a result I have no image draw.</p>\n"}, {"tags": ["c++", "qt", "user-interface", "command-line"], "comments": [{"owner": {"reputation": 1219, "user_id": 229204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/29b2eca6604bbf8544d4ce99bf3b9dde?s=128&d=identicon&r=PG", "display_name": "gollumullog", "link": "https://stackoverflow.com/users/229204/gollumullog"}, "edited": false, "score": 0, "creation_date": 1431551501, "post_id": 30223650, "comment_id": 48554367, "body": "I was able to replicate on an old server 2000 machine (don&#39;t ask).  keyboard commands work (to close message windows that you can&#39;t see),   it shows up in the task window and the app bar, but you can&#39;t bring up the right click menu from the app bar."}, {"owner": {"reputation": 4083, "user_id": 2169277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6847992b611dad2388150de645242c?s=128&d=identicon&r=PG", "display_name": "Amartel", "link": "https://stackoverflow.com/users/2169277/amartel"}, "edited": false, "score": 0, "creation_date": 1431590408, "post_id": 30223650, "comment_id": 48567078, "body": "I think, your problem is similar to this: <a href=\"http://stackoverflow.com/questions/53232/how-can-i-run-a-windows-gui-application-on-as-a-service\" title=\"how can i run a windows gui application on as a service\">stackoverflow.com/questions/53232/&hellip;</a> . The solution here would be to split it into two: one, that can be launched as service, and the other, that will be launched on user login."}, {"owner": {"reputation": 1219, "user_id": 229204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/29b2eca6604bbf8544d4ce99bf3b9dde?s=128&d=identicon&r=PG", "display_name": "gollumullog", "link": "https://stackoverflow.com/users/229204/gollumullog"}, "reply_to_user": {"reputation": 4083, "user_id": 2169277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6847992b611dad2388150de645242c?s=128&d=identicon&r=PG", "display_name": "Amartel", "link": "https://stackoverflow.com/users/2169277/amartel"}, "edited": false, "score": 0, "creation_date": 1432223861, "post_id": 30223650, "comment_id": 48846927, "body": "Thank you for the comment, I think the issue is it is transparent whenever it is run on a remote machine or virtualization.  I never have the problem when running it locally."}], "owner": {"reputation": 1219, "user_id": 229204, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/29b2eca6604bbf8544d4ce99bf3b9dde?s=128&d=identicon&r=PG", "display_name": "gollumullog", "link": "https://stackoverflow.com/users/229204/gollumullog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432223920, "creation_date": 1431545339, "last_edit_date": 1492085618, "question_id": 30223650, "link": "https://stackoverflow.com/questions/30223650/transparent-ui-hidden-ui-after-bringtoforeground", "title": "Transparent UI / hidden UI after BringToForeground", "body": "<p>I am programming in C++ using Qt (on Windows), I have a GUI application that can be run on the command line so that users can schedule it to be run using Scheduled Tasks.</p>\n\n<p>Everything was working fine (I think), except when a user tried to schedule the task with the \"run when user is logged on or not\" option is checked.  In this instance the application would run fine, but not pop up the GUI.</p>\n\n<p>I thought maybe my problem was similar to this: <a href=\"https://serverfault.com/questions/101671/scheduled-tasks-w-gui-issue\">https://serverfault.com/questions/101671/scheduled-tasks-w-gui-issue</a></p>\n\n<p>I thought I found the issue because my GetProcID call was returning a list of ProcessId's and I was only using the first one it returned, which caused some issues.  That process ID was then passed to BringToForeground.</p>\n\n<p>After this change it now brings up a transparent, or non-existent other than the application icon on some machines (basically every test except my 3 machines that can debug).  Works exactly as required on my test machines.</p>\n\n<p>The application works well if the GUI app is already running and you make the same call on the command line (it passes the call to that process to run).  The app also works fine in normal UI mode, (no command line params passed)</p>\n\n<p><img src=\"https://i.stack.imgur.com/M8SJS.png\" alt=\"UI after command line call\"></p>\n\n<p>EDIT:\nDoes anyone have any ideas what might cause this?  I am thinking it has something to do with the app not starting on the correct Desktop, but don't have a ton of experience with those and have no idea where to even begin.</p>\n\n<p>EDIT 2: Only seem to have the issue when it is run remotely, or through virtualization.  (still confirming if this is truly the case)</p>\n"}, {"tags": ["c++", "linux", "gzip", "pcap"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431546744, "post_id": 30223628, "comment_id": 48551909, "body": "related: <a href=\"http://stackoverflow.com/questions/5354553/lightweight-library-for-reading-zip-files\" title=\"lightweight library for reading zip files\">stackoverflow.com/questions/5354553/&hellip;</a>"}, {"owner": {"reputation": 1785, "user_id": 4680870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClLL3.png?s=128&g=1", "display_name": "tivn", "link": "https://stackoverflow.com/users/4680870/tivn"}, "edited": false, "score": 1, "creation_date": 1431547243, "post_id": 30223628, "comment_id": 48552181, "body": "Looks like there is function to read from a FILE pointer: <code>pcap_fopen_offline</code> ( with <code>f</code> ). This is not usable?"}, {"owner": {"reputation": 3281, "user_id": 1624277, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Qdnwb.png?s=128&g=1", "display_name": "e271p314", "link": "https://stackoverflow.com/users/1624277/e271p314"}, "edited": false, "score": 0, "creation_date": 1431547998, "post_id": 30223628, "comment_id": 48552573, "body": "This is actually a great point, I&#39;ll try to see if I can use it."}, {"owner": {"reputation": 1632, "user_id": 4178025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/159c588df64aaa5d1b2c96c1461e85cf?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/4178025/diego"}, "reply_to_user": {"reputation": 1785, "user_id": 4680870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ClLL3.png?s=128&g=1", "display_name": "tivn", "link": "https://stackoverflow.com/users/4680870/tivn"}, "edited": false, "score": 2, "creation_date": 1431555877, "post_id": 30223628, "comment_id": 48556365, "body": "To complement @tivn&#39;s point, there&#39;s <code>fmemopen</code> which will make you a <code>FILE*</code> out of a chunk of memory"}, {"owner": {"reputation": 3281, "user_id": 1624277, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Qdnwb.png?s=128&g=1", "display_name": "e271p314", "link": "https://stackoverflow.com/users/1624277/e271p314"}, "edited": false, "score": 0, "creation_date": 1431578460, "post_id": 30223628, "comment_id": 48562146, "body": "This is a great comment too, I&#39;ll see if I can put things together"}], "owner": {"reputation": 3281, "user_id": 1624277, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Qdnwb.png?s=128&g=1", "display_name": "e271p314", "link": "https://stackoverflow.com/users/1624277/e271p314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1431545682, "creation_date": 1431545256, "last_edit_date": 1431545682, "question_id": 30223628, "link": "https://stackoverflow.com/questions/30223628/how-to-associate-stream-content-with-a-file-name-without-actually-writing-the-co", "title": "How to associate stream content with a file name without actually writing the content to disk?", "body": "<p>I have an interface that reads files of few types. The interface has <code>read</code> and <code>open</code> methods (and few more). <code>open</code> receives a file name (const char*) and opens the file for reading. Currently I support two file types, pcap and raw binary. Recently I discovered that all the files that I'm suppose to read are actually zipped (in gzip format) but other than that all remains the same (after I unzip the files everything works as designed). I would like to add to the open method unzip capability, so first the file will be unzipped (in memory, without writing the unzipped content to disk) and pass the unzipped content to the actual implementations. The main problem is that the <code>open</code> implementation expects a file name, in case of pcap the <code>open</code> implementation calls <code>pcap_open_offline</code> which doesn't receive a stream or a buffer. Ideally I would be able to create some sort of a file (pipe, link or whatever) and to associate it with the content I extracted from the zipped file. Any idea how can I do it? here is a little code to make it easier to understand what I'm doing</p>\n\n<pre><code>class FileReader //interface\n{\npublic:\n void open(const char* name)\n {\n  // unzip file here\n  open_impl(name);\n }\n virtual size_t read() = 0;\nprotected:\n virtual void open_impl(const char* name) = 0;\n};\n\nclass PcapReader: public FileReader\n{\npublic:\n size_t read() {...}\nprotected:\n virtual void open_impl(const char* name)\n {\n   pcap_open_offline(name, error_buffer);\n }\n char error_buffer[1024];\n};\n</code></pre>\n"}, {"tags": ["c++", "debugging", "gcc", "gdb"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1431545538, "post_id": 30223477, "comment_id": 48551285, "body": "backwards compability is evil, isnt it?"}, {"owner": {"reputation": 1310, "user_id": 2266428, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/W8K6m.png?s=128&g=1", "display_name": "J E Carter II", "link": "https://stackoverflow.com/users/2266428/j-e-carter-ii"}, "edited": false, "score": 0, "creation_date": 1431546156, "post_id": 30223477, "comment_id": 48551602, "body": "Is the code base actively maintained on a repository like github?  Could this be cleaned up in the source code, maybe updated on the repository, or could you fork it and clean it up there?  If you&#39;re stuck with GDB tripping over this, that may be your best option.... though count the cost in hours to do so."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1431547395, "post_id": 30223477, "comment_id": 48552274, "body": "Have you tried using <code>$$</code> to escape it?"}, {"owner": {"reputation": 129, "user_id": 3448056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0db1a133fec07738533ec7f8f0bcca96?s=128&d=identicon&r=PG&f=1", "display_name": "SirNuke", "link": "https://stackoverflow.com/users/3448056/sirnuke"}, "edited": false, "score": 0, "creation_date": 1431562667, "post_id": 30223477, "comment_id": 48558304, "body": "It&#39;s a proprietary codebase, and one recently introduced to my company by way of acquisition.  I&#39;m trying to make my case that&#39;s it&#39;s worth refactoring that quirk out.  I&#39;m using the dual argument of It&#39;s Worth Refactoring That Quirk Out and Srsly This Code Is Like Five Years Old... Just Why?  Also, $$ doesn&#39;t work either; I&#39;ll add that to the list."}, {"owner": {"reputation": 4831, "user_id": 689394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d1795a5234cffedd9ed3ad59f4cad3?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/689394/matt"}, "edited": false, "score": 0, "creation_date": 1431584775, "post_id": 30223477, "comment_id": 48564391, "body": "2 more things that don&#39;t work: #define dollar(x) $##x (gdb) p this-&gt;dollar(x) with -g3 or the macro define equivalent"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 3, "creation_date": 1431621093, "post_id": 30223477, "comment_id": 48586131, "body": "Try <code>(gdb) python import gdb; print (gdb.parse_and_eval(&quot;t&quot;)[&#39;$x&#39;])</code>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1431657531, "post_id": 30223477, "comment_id": 48601738, "body": "If it were possible to use a UCN, it would be &#39;\\u0024x&#39;, not &#39;\\044x&#39;. But UCNs don&#39;t work either :("}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1431913773, "post_id": 30223477, "comment_id": 48684413, "body": "Gdb 7.2 did support python scripting, so if your gdb 7.2 doesn&#39;t have it, I&#39;d guess that either your system doesn&#39;t have the necessary python shared library installed, or your gdb was specially compiled with python disabled. To resolve your question, you may need to install python or may need to recompile gdb (either with python support enabled or with a change, if we can find one, to the C expression parser to allow member names that begin with $). Are any of those things possible in your environment?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 4899188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810b61bdaee8f94a019b83caf5406eaf?s=128&d=identicon&r=PG&f=1", "display_name": "narz", "link": "https://stackoverflow.com/users/4899188/narz"}, "is_accepted": false, "score": 1, "last_activity_date": 1431611796, "creation_date": 1431611796, "answer_id": 30239265, "question_id": 30223477, "link": "https://stackoverflow.com/questions/30223477/manipulating-c-member-variables-that-begin-with-in-gdb/30239265#30239265", "title": "Manipulating C++ member variables that begin with $ in GDB", "body": "<p>If you got the gdb version with python extensions, maybe the \"explore\" feature will help.</p>\n\n<p>See <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Data.html#Data\" rel=\"nofollow\">https://sourceware.org/gdb/onlinedocs/gdb/Data.html#Data</a></p>\n\n<pre><code>\n  (gdb) explore cs\n     The value of `cs' is a struct/class of type `struct ComplexStruct' with\n     the following fields:\n\n       ss_p = \n        arr = \n\n     Enter the field number of choice:\n</code></pre>\n\n<p>Since you don't need the variable name, you should be able to step around the '$' issue. </p>\n"}], "owner": {"reputation": 129, "user_id": 3448056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0db1a133fec07738533ec7f8f0bcca96?s=128&d=identicon&r=PG&f=1", "display_name": "SirNuke", "link": "https://stackoverflow.com/users/3448056/sirnuke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 2, "answer_count": 1, "score": 10, "last_activity_date": 1431699644, "creation_date": 1431544627, "last_edit_date": 1431699644, "question_id": 30223477, "link": "https://stackoverflow.com/questions/30223477/manipulating-c-member-variables-that-begin-with-in-gdb", "title": "Manipulating C++ member variables that begin with $ in GDB", "body": "<p>I'm working with a C++ code base with a very peculiar coding style, including prefixing member variables in classes with '$'.  For anyone who's never come across this before, it's not formally part of C++ standards, but <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Dollar-Signs.html#Dollar-Signs\" rel=\"nofollow\">lurks around for backwards compatibility</a>.</p>\n\n<p>As an example of what I'm talking about:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass T { public: int $x; int y; };\n\nint main()\n{\n  T *t = new T();\n  t-&gt;$x = t-&gt;y = 42;\n  std::cout &lt;&lt; \"t-&gt;$x = \" &lt;&lt; t-&gt;$x &lt;&lt; std::endl;\n  delete t;\n  return 0;\n}\n</code></pre>\n\n<p>This introduces a problem in GDB.  GDB normally uses $ prefixed variables as a magic convenience variable (such as referring to previous values).  Fire up GDB, set a breakpoint at the cout statement, and try to print <code>t-&gt;$x</code>.</p>\n\n<p><code>p t</code> runs fine.  <code>p *t</code> runs fine.  <code>p t-&gt;y</code> runs fine.  <code>p t-&gt;$x</code> returns a syntax error, presumably expecting the $ to refer to a convenience variable.</p>\n\n<p>Ideally, I'd strip the $s out entirely and spend the rest of my days hunting down whoever thought that was a good idea (especially for a modern codebase).  That's not realistic, but I still need to be able to use GDB for debugging.</p>\n\n<p>I'm hoping there's a magic escape character, but nothing I've searched for or tried has worked.  </p>\n\n<p>Examples: </p>\n\n<ul>\n<li><code>p this-&gt;'\\044descriptor'</code> </li>\n<li><code>p this-&gt;'$descriptor'</code></li>\n<li><code>p this-&gt;'$'descriptor</code></li>\n<li><code>p this-&gt;\\$descriptor</code></li>\n<li><code>p this-&gt;\\\\$descriptor</code> </li>\n<li><code>p this-&gt;'\\$descriptor'</code> </li>\n<li><code>p this-&gt;'\\\\044descriptor'</code></li>\n<li><code>p this-&gt;$$descriptor</code></li>\n<li><code>p this-&gt;'$$descriptor'</code></li>\n</ul>\n\n<p>and so on.</p>\n\n<p>In this particular case, I can run the getter function (<code>p this-&gt;getDescriptor()</code>).  An uglier workaround is to print the entire class contents (<code>p *this</code>).  I'm not sure I can rely on both of those indefinitely; some of the classes are fairly large, and most member variables don't have getters.</p>\n\n<p>This could potentially be classified as a bug in GDB, depending on whether it's a good idea to rip up input to support this.  However, even if it was fixed, I'm stuck on GDB 7.2 for the given architecture/build environment.</p>\n\n<p>Any ideas?</p>\n\n<p>UPDATE: <code>python import gdb; print (gdb.parse_and_eval(\"t\")['$x'])</code> as suggested in the comment works if you have python builtin (which I don't have, unfortunately).</p>\n"}, {"tags": ["c++", "header-files", "circular-dependency"], "comments": [{"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431544669, "post_id": 30223453, "comment_id": 48550792, "body": "Can&#39;t you just declare the function to be <code>inline</code> in the cpp file?"}, {"owner": {"reputation": 8390, "user_id": 1404049, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/vkpuK.png?s=128&g=1", "display_name": "Fallenreaper", "link": "https://stackoverflow.com/users/1404049/fallenreaper"}, "edited": false, "score": 1, "creation_date": 1431544695, "post_id": 30223453, "comment_id": 48550799, "body": "What do you think <code>#ifndef</code> does? lol, it will define it only once."}, {"owner": {"reputation": 781, "user_id": 4880927, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/37a8c893d6860d6e02be07984c1c4e11?s=128&d=identicon&r=PG&f=1", "display_name": "Kemal", "link": "https://stackoverflow.com/users/4880927/kemal"}, "reply_to_user": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431545667, "post_id": 30223453, "comment_id": 48551354, "body": "@dwcanillas I assume you are implicitly suggesting that that I delete <code>#include &lt;A.h&gt;</code> from <b>class B</b> and make a forward declaration there  instead. Let&#39;s suppose I did that. Then I would have to include <b>B.cpp</b> <b>everywhere</b> that I want the function to be inlined. Is there a way that doesn&#39;t require such duplications?"}, {"owner": {"reputation": 781, "user_id": 4880927, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/37a8c893d6860d6e02be07984c1c4e11?s=128&d=identicon&r=PG&f=1", "display_name": "Kemal", "link": "https://stackoverflow.com/users/4880927/kemal"}, "reply_to_user": {"reputation": 8390, "user_id": 1404049, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/vkpuK.png?s=128&g=1", "display_name": "Fallenreaper", "link": "https://stackoverflow.com/users/1404049/fallenreaper"}, "edited": false, "score": 0, "creation_date": 1431545953, "post_id": 30223453, "comment_id": 48551496, "body": "@Fallen The intention is to use it as a &quot;header guard&quot; to avoid multiple inclusions of the headers. Could you kindly be clearer if you are suggesting a solution?"}, {"owner": {"reputation": 8390, "user_id": 1404049, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/vkpuK.png?s=128&g=1", "display_name": "Fallenreaper", "link": "https://stackoverflow.com/users/1404049/fallenreaper"}, "edited": false, "score": 0, "creation_date": 1431546672, "post_id": 30223453, "comment_id": 48551873, "body": "The files get called, but it wont redefine the headers, hense the purpose of the header guard.   So, in main, A gets called from main, B gets called from A, A is attempted to be called from B but kicked back, return from the stack calls.  The files might get called, but after that first few, it wont redefine it anymore..  So you defined it, but it will not redefine them, no?   As a side note, what about using proper inheritance?  How can A and B inherit from eachother."}], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 609579, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cff6826c1faad4528b1ce15dda1f0e6d?s=128&d=identicon&r=PG", "display_name": "Mads", "link": "https://stackoverflow.com/users/609579/mads"}, "edited": false, "score": 0, "creation_date": 1431546090, "post_id": 30223663, "comment_id": 48551567, "body": "This technique is called &#39;forward declaration&#39;. You are letting your compiler know that the class exists."}, {"owner": {"reputation": 781, "user_id": 4880927, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/37a8c893d6860d6e02be07984c1c4e11?s=128&d=identicon&r=PG&f=1", "display_name": "Kemal", "link": "https://stackoverflow.com/users/4880927/kemal"}, "edited": false, "score": 1, "creation_date": 1431547327, "post_id": 30223663, "comment_id": 48552244, "body": "Every step blew up in my face with this language so far, so I am a bit nervous about an <code>#include</code> outside the header guard, but I see the point."}, {"owner": {"reputation": 123, "user_id": 1833765, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7b45a110fba31e5b37c60978bc8d3b7?s=128&d=identicon&r=PG", "display_name": "Artem Pisarenko", "link": "https://stackoverflow.com/users/1833765/artem-pisarenko"}, "edited": false, "score": 0, "creation_date": 1614800201, "post_id": 30223663, "comment_id": 117498400, "body": "Unfortunately, the only way to get rid of <code>#include</code> outside guard is to make wrapper header <code>A_B.h</code> (with its own guard) which includes guard-less <code>A.h</code> and <code>B.h</code> in proper order and then use this wrapper everywhere. In order to further protect user from direct inclusion of these headers you may <code>#ifndef</code> wrapper guard macro <code>A_B_H</code> in these headers with <code>#error</code>."}], "tags": [], "owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "is_accepted": true, "score": 7, "last_activity_date": 1431545396, "creation_date": 1431545396, "answer_id": 30223663, "question_id": 30223453, "link": "https://stackoverflow.com/questions/30223453/c-circular-dependency-in-header-files/30223663#30223663", "title": "C++ Circular Dependency in Header Files", "body": "<p>You could use this:</p>\n\n<p>A.h</p>\n\n<pre><code>#include &lt;B.h&gt;\n#ifndef A_H\n#define A_H\n\nclass A \n{\npublic:\n    B b1;\n    int m_a;\n};\n\n#endif // A_H\n</code></pre>\n\n<p>B.h</p>\n\n<pre><code>#ifndef B_H\n#define B_H\n\nclass A;\n\nclass B \n{\npublic:\n    int f(A &amp;a);\n};\n\n#include &lt;A.h&gt;\n\ninline int B::f(A &amp;a)\n{\n    return a.m_a;\n}\n\n#endif // B_H\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;A.h&gt; // these could be in any order\n#include &lt;B.h&gt;\n\nint main() \n{\n    A a;\n    B b;\n\n    std::cout &lt;&lt; \"Calling b.f(a): \" &lt;&lt; b.f(a) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 781, "user_id": 4880927, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/37a8c893d6860d6e02be07984c1c4e11?s=128&d=identicon&r=PG&f=1", "display_name": "Kemal", "link": "https://stackoverflow.com/users/4880927/kemal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2368, "favorite_count": 0, "accepted_answer_id": 30223663, "answer_count": 1, "score": 2, "last_activity_date": 1431545396, "creation_date": 1431544549, "question_id": 30223453, "link": "https://stackoverflow.com/questions/30223453/c-circular-dependency-in-header-files", "title": "C++ Circular Dependency in Header Files", "body": "<p>Is it possible to avoid circular dependency in the following header files <strong>without</strong> turning data member <strong>b1</strong> in <strong>class A</strong> to a pointer/reference, and <strong>without</strong> relaxing the inline function requirement in <strong>class B</strong>?</p>\n\n<p>A.h:</p>\n\n<pre><code>#ifndef A_H\n#define A_H\n#include &lt;B.h&gt; // Required, as data member b1 is not a pointer/reference\n\nclass A {\n    public:\n        B b1; // I want to keep this as as it is.\n        int m_a;\n};\n\n#endif\n</code></pre>\n\n<p>B.h:</p>\n\n<pre><code>#ifndef B_H\n#define B_H\n#include &lt;A.h&gt; // Required, as f() calls a member function of class A\n\nclass B {\n    public:\n       int f(A &amp;a){return a.m_a;} // I want this to be an inline function.\n};\n\n#endif\n</code></pre>\n\n<p>...and let's say main.ccp is:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;A.h&gt;\n#include &lt;B.h&gt;\n\nint main() {\n    A a;\n    B b;\n\n    std::cout &lt;&lt; \"Calling b.f(a): \" &lt;&lt; b.f(a) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["java", "c++", "performance", "optimization"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1431544812, "post_id": 30223441, "comment_id": 48550866, "body": "How did you measure the time? If you measure the time only for one case, the timing will strongly depend on the random sequences and <code>&gt;</code> vs <code>&gt;=</code> will have only minor impact. To get really meaningful numbers for times you have to measure many different sequences and average"}, {"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1431544910, "post_id": 30223441, "comment_id": 48550924, "body": "@tobi303 look at the code. You can run it in a loop via the 3rd runtime parameter (Java) or <code>-DRUNS=XXX</code> (C++, compiler directive). And the results are reproducible."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1431545411, "post_id": 30223441, "comment_id": 48551193, "body": "would be interesting to count the number of swaps in both cases to see how this relates to the runtime. I mean in case A is slower, this is definitely not due to the number of swaps, so maybe in case A is faster, the reason is also not simply the number of swaps but some more subtle effects"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1431545509, "post_id": 30223441, "comment_id": 48551262, "body": "@Turing85: But did you rerun the test?"}, {"owner": {"reputation": 1444, "user_id": 125344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca32d6118803a7598eb24f53e87f249b?s=128&d=identicon&r=PG", "display_name": "Kevin Condon", "link": "https://stackoverflow.com/users/125344/kevin-condon"}, "edited": false, "score": 0, "creation_date": 1431545681, "post_id": 30223441, "comment_id": 48551358, "body": "It would also be interesting to see if the results hold when calling <code>bubbleSortB()</code> first and then <code>bubbleSortA()</code>. With Java I often suspect memory allocation and gc causes unexpected results. Although getting the same results in C++ would suggest something more general is going on here."}, {"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1431545874, "post_id": 30223441, "comment_id": 48551450, "body": "@user2357112 yes. As I said: three different machines, same exact result."}, {"owner": {"reputation": 1444, "user_id": 125344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca32d6118803a7598eb24f53e87f249b?s=128&d=identicon&r=PG", "display_name": "Kevin Condon", "link": "https://stackoverflow.com/users/125344/kevin-condon"}, "edited": false, "score": 0, "creation_date": 1431545896, "post_id": 30223441, "comment_id": 48551470, "body": "You might also want to add a <code>System.gc()</code> prior to each bubble sort method call to help equalize the playing field between the tests. Also, allocate plenty of heap (<code>-xms256m -xmx256m</code>) and make sure the process isn&#39;t being swapped."}, {"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "reply_to_user": {"reputation": 1444, "user_id": 125344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca32d6118803a7598eb24f53e87f249b?s=128&d=identicon&r=PG", "display_name": "Kevin Condon", "link": "https://stackoverflow.com/users/125344/kevin-condon"}, "edited": false, "score": 0, "creation_date": 1431545935, "post_id": 30223441, "comment_id": 48551489, "body": "@KevinCondon Tested this as well. Changing the order around (first <code>sortB</code>, then <code>sortA</code>) did not change the results."}, {"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1431546347, "post_id": 30223441, "comment_id": 48551699, "body": "@tobi303 added the number of swaps."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1431557565, "post_id": 30223441, "comment_id": 48556901, "body": "@Turing85 One crude way to test if this is related to branch misprediction without getting into a profiler is to just ensure that that all of your elements are unique instead of completely random. For the C++ side, you can use std::sort and std::unique."}], "answers": [{"tags": [], "owner": {"reputation": 9041, "user_id": 3216312, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/532212e9b26bc1e386a9f13dd8fa520a?s=128&d=identicon&r=PG&f=1", "display_name": "Petr", "link": "https://stackoverflow.com/users/3216312/petr"}, "is_accepted": false, "score": 11, "last_activity_date": 1431546043, "creation_date": 1431546043, "answer_id": 30223822, "question_id": 30223441, "link": "https://stackoverflow.com/questions/30223441/vs-in-bubble-sort-causes-significant-performance-difference/30223822#30223822", "title": "&gt; vs. &gt;= in bubble sort causes significant performance difference", "body": "<p>I think this can indeed be explained by branch misprediction.</p>\n\n<p>Consider, for example, LIMIT=11, and <code>sortB</code>. On first iteration of the outer loop, it will very quickly stumble upon one of elements equal to 10. So it will have <code>a[j]=10</code>, and therefore definitely <code>a[j]</code> will be <code>&gt;=a[next]</code>, as there are no elements that are greater than 10. Therefore, it will perform a swap, then do one step in <code>j</code> only to find that <code>a[j]=10</code> once again (the same swapped value). So once again it will be <code>a[j]&gt;=a[next]</code>, and so one. Every comparison except several at the very beginning will be true. Similarly it will run on the next iterations of the outer loop.</p>\n\n<p>Not the same for <code>sortA</code>. It will start roughly the same way, stumble upon <code>a[j]=10</code>, do some swaps in a similar manner, but only to a point when it finds <code>a[next]=10</code> too. Then the condition will be false, and no swap will be done. An so on: every time it stumbles on <code>a[next]=10</code>, the condition is false and no swaps are done. Therefore, this condition is true 10 times out of 11 (values of <code>a[next]</code> from 0 to 9), and false in 1 case out of 11. Nothing strange that branch prediction fails.</p>\n"}, {"comments": [{"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "edited": false, "score": 2, "creation_date": 1431547108, "post_id": 30223885, "comment_id": 48552105, "body": "Your argument seems sensible. Is there any way to test your hypothesis?"}, {"owner": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "reply_to_user": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "edited": false, "score": 1, "creation_date": 1431551375, "post_id": 30223885, "comment_id": 48554286, "body": "Quick answer is to control the input arrays to something such that the sorts for A/B do the same swaps in the same order (at least roughly). Exactly how to do this I don&#39;t know. You could also look at how random the swap order is &quot;somehow&quot; and see if that correlates to the sort times."}, {"owner": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "reply_to_user": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "edited": false, "score": 1, "creation_date": 1431555739, "post_id": 30223885, "comment_id": 48556319, "body": "For cases where <code>LIMIT &gt;= ARRAY_SIZE</code> you can do a test case where the array is composed of unique numbers. For example, in the case of <code>a[i] = ARRAY_SIZE - i</code> you get a swap on every loop and identical times for the A/B sorts."}, {"owner": {"reputation": 9041, "user_id": 3216312, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/532212e9b26bc1e386a9f13dd8fa520a?s=128&d=identicon&r=PG&f=1", "display_name": "Petr", "link": "https://stackoverflow.com/users/3216312/petr"}, "reply_to_user": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "edited": false, "score": 0, "creation_date": 1431580993, "post_id": 30223885, "comment_id": 48562851, "body": "@Turing85, note that my answer does in fact explain, <i>why</i> is this difference in number of swaps."}, {"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "reply_to_user": {"reputation": 9041, "user_id": 3216312, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/532212e9b26bc1e386a9f13dd8fa520a?s=128&d=identicon&r=PG&f=1", "display_name": "Petr", "link": "https://stackoverflow.com/users/3216312/petr"}, "edited": false, "score": 0, "creation_date": 1431582607, "post_id": 30223885, "comment_id": 48563441, "body": "@Petr why there is a larger number of swaps was obvious for me. I just was not able to correlate this fact with the branch misprediction. And the chosen answer gave (in my sight) the best explanation with the best argumentation."}, {"owner": {"reputation": 20582, "user_id": 112407, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/c5ypV.jpg?s=128&g=1", "display_name": "Rune FS", "link": "https://stackoverflow.com/users/112407/rune-fs"}, "edited": false, "score": 0, "creation_date": 1432069029, "post_id": 30223885, "comment_id": 48766421, "body": "That the Java and C++ implementation behaves similarly is also a strong indicator for branch prediction being at the root since the chip is the same"}], "tags": [], "owner": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "is_accepted": true, "score": 45, "last_activity_date": 1431603859, "last_edit_date": 1431603859, "creation_date": 1431546265, "answer_id": 30223885, "question_id": 30223441, "link": "https://stackoverflow.com/questions/30223441/vs-in-bubble-sort-causes-significant-performance-difference/30223885#30223885", "title": "&gt; vs. &gt;= in bubble sort causes significant performance difference", "body": "<p>I think it may indeed be due to branch prediction. If you count the number of swaps compared to the number of inner sort iterations you find:</p>\n\n<p><strong>Limit = 10</strong></p>\n\n<ul>\n<li>A = 560M swaps / 1250M loops</li>\n<li>B = 1250M swaps / 1250M loops (0.02% less swaps than loops)</li>\n</ul>\n\n<p><strong>Limit = 50000</strong></p>\n\n<ul>\n<li>A = 627M swaps / 1250M loops</li>\n<li>B = 850M swaps / 1250M loops</li>\n</ul>\n\n<p>So in the <code>Limit == 10</code> case the swap is performed 99.98% of the time in the B sort which is obviously favourable for the branch predictor. In the <code>Limit == 50000</code> case the swap is only hit randomly 68% so the branch predictor is less beneficial.</p>\n"}, {"comments": [{"owner": {"reputation": 2841, "user_id": 1641381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/crUHq.jpg?s=128&g=1", "display_name": "kevinsa5", "link": "https://stackoverflow.com/users/1641381/kevinsa5"}, "edited": false, "score": 0, "creation_date": 1431555877, "post_id": 30224411, "comment_id": 48556364, "body": "I don&#39;t think you are correct about <code>&lt;</code> being faster than <code>&lt;=</code>.  Processor instructions are discretized; each instruction must take an integer number of clock cycles-- there&#39;s no &quot;time saved&quot; unless you can squeeze a whole clock out of it.  See <a href=\"http://stackoverflow.com/a/12135533\">stackoverflow.com/a/12135533</a>"}, {"owner": {"reputation": 2841, "user_id": 1641381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/crUHq.jpg?s=128&g=1", "display_name": "kevinsa5", "link": "https://stackoverflow.com/users/1641381/kevinsa5"}, "edited": false, "score": 0, "creation_date": 1431555980, "post_id": 30224411, "comment_id": 48556401, "body": "Note that I&#39;m talking about native code only.  I suppose it&#39;s possible that a JVM implementation could perform that &quot;optimization&quot;, but I&#39;d guess that it would just use the native instructions rather than cook up its own solution.  But that&#39;s just a guess."}, {"owner": {"reputation": 1517, "user_id": 3419534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Rzyx7.jpg?s=128&g=1", "display_name": "ClickRick", "link": "https://stackoverflow.com/users/3419534/clickrick"}, "edited": false, "score": 4, "creation_date": 1431564374, "post_id": 30224411, "comment_id": 48558756, "body": "On what do you base your assertion that &lt;= uses an extra step to subtract an extra 1? At the x86 level, for example, a <code>cmp</code> followed by a <code>jl</code> will take exactly the same amount of time, successful branch prediction permitting, as a <code>cmp</code> followed by a <code>jle</code>. <a href=\"http://stackoverflow.com/questions/12135518/is-faster-than\">stackoverflow.com/questions/12135518/is-faster-than</a> has more details."}, {"owner": {"reputation": 5615, "user_id": 1858327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i9v0b.jpg?s=128&g=1", "display_name": "Captain Man", "link": "https://stackoverflow.com/users/1858327/captain-man"}, "reply_to_user": {"reputation": 1517, "user_id": 3419534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Rzyx7.jpg?s=128&g=1", "display_name": "ClickRick", "link": "https://stackoverflow.com/users/3419534/clickrick"}, "edited": false, "score": 0, "creation_date": 1431575637, "post_id": 30224411, "comment_id": 48561383, "body": "@ClickRick The assembly I learned was for SPARC which used a reduced instruction set. Maybe it didn&#39;t have <code>jle</code>? Or maybe I heard this false assumption somewhere too. Not 100% sure where I got this now that I really consider it. I suppose theoretically though that how any particular OS&#39;s/Architecture&#39;s JVM interpreted it could make some difference, but I would now assume they all do this in a single cycle."}, {"owner": {"reputation": 1517, "user_id": 3419534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Rzyx7.jpg?s=128&g=1", "display_name": "ClickRick", "link": "https://stackoverflow.com/users/3419534/clickrick"}, "edited": false, "score": 2, "creation_date": 1431591875, "post_id": 30224411, "comment_id": 48567744, "body": "@CaptainMan According to <a href=\"http://www.cs.northwestern.edu/~agupta/_projects/sparc_simulator/SPARC%20INSTRUCTION%20SET-1.htm\" rel=\"nofollow noreferrer\">cs.northwestern.edu/~agupta/_projects/sparc_simulator/&hellip;</a> the SPARC supports both <code>bl</code> and <code>ble</code> instructions, which is entirely unsurprising to me."}, {"owner": {"reputation": 5615, "user_id": 1858327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i9v0b.jpg?s=128&g=1", "display_name": "Captain Man", "link": "https://stackoverflow.com/users/1858327/captain-man"}, "reply_to_user": {"reputation": 1517, "user_id": 3419534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Rzyx7.jpg?s=128&g=1", "display_name": "ClickRick", "link": "https://stackoverflow.com/users/3419534/clickrick"}, "edited": false, "score": 0, "creation_date": 1431612670, "post_id": 30224411, "comment_id": 48580460, "body": "@Click I am utterly at a loss how I came to this then. Maybe I heard something like <code>for (int i = 0; i &lt;= thing.size() - 1; i++)</code> had to do an extra operation when I was learning and over the years associated it with <code>&lt;=</code> (the <code>- 1</code> doesn&#39;t help haha). I&#39;ll add an edit that my answer is wrong unless the JVM for some particular OS/Architecture is implemented oddly."}], "tags": [], "owner": {"reputation": 5615, "user_id": 1858327, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i9v0b.jpg?s=128&g=1", "display_name": "Captain Man", "link": "https://stackoverflow.com/users/1858327/captain-man"}, "is_accepted": false, "score": 3, "last_activity_date": 1431613097, "last_edit_date": 1431613097, "creation_date": 1431548144, "answer_id": 30224411, "question_id": 30223441, "link": "https://stackoverflow.com/questions/30223441/vs-in-bubble-sort-causes-significant-performance-difference/30224411#30224411", "title": "&gt; vs. &gt;= in bubble sort causes significant performance difference", "body": "<blockquote>\n  <p><strong>Edit 2:</strong> This answer is probably wrong in most cases, lower when I say everything above is correct is still true, but the lower portion is not true for most processor architectures, see the comments. However, I will say that it's still <em>theoretically</em> possible there is some JVM on some OS/Architecture that does this, but that JVM is probably poorly implemented or it's a weird architecture. Also, this is theoretically possible in the sense that most conceivable things are theoretically possible, so I'd take the last portion with a grain of salt.</p>\n</blockquote>\n\n<p>First, I am not sure about the C++, but I can talk some about the Java.</p>\n\n<p>Here is some code,</p>\n\n<pre><code>public class Example {\n\n    public static boolean less(final int a, final int b) {\n        return a &lt; b;\n    }\n\n    public static boolean lessOrEqual(final int a, final int b) {\n        return a &lt;= b;\n    }\n}\n</code></pre>\n\n<p>Running <code>javap -c</code> on it I get the bytecode</p>\n\n<pre><code>public class Example {\n  public Example();\n    Code:\n       0: aload_0\n       1: invokespecial #8                  // Method java/lang/Object.\"&lt;init&gt;\":()V\n       4: return\n\n  public static boolean less(int, int);\n    Code:\n       0: iload_0\n       1: iload_1\n       2: if_icmpge     7\n       5: iconst_1\n       6: ireturn\n       7: iconst_0\n       8: ireturn\n\n  public static boolean lessOrEqual(int, int);\n    Code:\n       0: iload_0\n       1: iload_1\n       2: if_icmpgt     7\n       5: iconst_1\n       6: ireturn\n       7: iconst_0\n       8: ireturn\n}\n</code></pre>\n\n<p>You'll notice the only difference is <code>if_icmpge</code> (if compare greater/equal) versus <code>if_icmpgt</code> (if compare greater than).</p>\n\n<p>Everything above is fact, the rest is my best guess as to how <code>if_icmpge</code> and <code>if_icmpgt</code> are handled based on a college course I took on assembly language. To get a better answer you should look up how your JVM handles these. My guess is that C++ also compiles down to a similar operation.</p>\n\n<blockquote>\n  <p>Edit: Documentation on <code>if_i&lt;cond&gt;</code> is <a href=\"http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.if_icmp_cond\" rel=\"nofollow\">here</a></p>\n</blockquote>\n\n<p>The way computers compare numbers is subtracting one from the other and checking if that number is 0 or not, so when doing <code>a &lt; b</code> if subtracts <code>b</code> from <code>a</code> and sees if the result is less than 0 by checking the sign of the value (<code>b - a &lt; 0</code>). To do <code>a &lt;= b</code> though it has to do an additional step and subtract 1 (<code>b - a - 1 &lt; 0</code>).</p>\n\n<p>Normally this is a very miniscule difference, but this isn't <em>any</em> code, this is freaking bubble sort! O(n^2) is the average number of times we are doing this particular comparison because it's in the inner most loop.</p>\n\n<p>Yes, it may have something to do with branch prediction I am not sure, I am not an expert on that, but I think this may also play a non-insignificant role.</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 3323967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRjWx.jpg?s=128&g=1", "display_name": "fala", "link": "https://stackoverflow.com/users/3323967/fala"}, "is_accepted": false, "score": 9, "last_activity_date": 1431623286, "last_edit_date": 1431623286, "creation_date": 1431589103, "answer_id": 30231889, "question_id": 30223441, "link": "https://stackoverflow.com/questions/30223441/vs-in-bubble-sort-causes-significant-performance-difference/30231889#30231889", "title": "&gt; vs. &gt;= in bubble sort causes significant performance difference", "body": "<p>Using the C++ code provided (time counting removed) with the <code>perf stat</code> command I got results that confirm the brach-miss theory. </p>\n\n<p>With <code>Limit = 10</code>, BubbleSortB highly benefits from branch prediction (0.01% misses) but with <code>Limit = 50000</code> branch prediction fails even more (with 15.65% misses) than in BubbleSortA (12.69% and 12.76% misses respectively).</p>\n\n<p><strong>BubbleSortA Limit=10:</strong></p>\n\n<pre><code>Performance counter stats for './bubbleA.out':\n\n   46670.947364 task-clock                #    0.998 CPUs utilized          \n             73 context-switches          #    0.000 M/sec                  \n             28 CPU-migrations            #    0.000 M/sec                  \n            379 page-faults               #    0.000 M/sec                  \n117,298,787,242 cycles                    #    2.513 GHz                    \n117,471,719,598 instructions              #    1.00  insns per cycle        \n 25,104,504,912 branches                  #  537.904 M/sec                  \n  3,185,376,029 branch-misses             #   12.69% of all branches        \n\n   46.779031563 seconds time elapsed\n</code></pre>\n\n<p><strong>BubbleSortA Limit=50000:</strong></p>\n\n<pre><code>Performance counter stats for './bubbleA.out':\n\n   46023.785539 task-clock                #    0.998 CPUs utilized          \n             59 context-switches          #    0.000 M/sec                  \n              8 CPU-migrations            #    0.000 M/sec                  \n            379 page-faults               #    0.000 M/sec                  \n118,261,821,200 cycles                    #    2.570 GHz                    \n119,230,362,230 instructions              #    1.01  insns per cycle        \n 25,089,204,844 branches                  #  545.136 M/sec                  \n  3,200,514,556 branch-misses             #   12.76% of all branches        \n\n   46.126274884 seconds time elapsed\n</code></pre>\n\n<p><strong>BubbleSortB Limit=10:</strong></p>\n\n<pre><code>Performance counter stats for './bubbleB.out':\n\n   26091.323705 task-clock                #    0.998 CPUs utilized          \n             28 context-switches          #    0.000 M/sec                  \n              2 CPU-migrations            #    0.000 M/sec                  \n            379 page-faults               #    0.000 M/sec                  \n 64,822,368,062 cycles                    #    2.484 GHz                    \n137,780,774,165 instructions              #    2.13  insns per cycle        \n 25,052,329,633 branches                  #  960.179 M/sec                  \n      3,019,138 branch-misses             #    0.01% of all branches        \n\n   26.149447493 seconds time elapsed\n</code></pre>\n\n<p><strong>BubbleSortB Limit=50000:</strong></p>\n\n<pre><code>Performance counter stats for './bubbleB.out':\n\n   51644.210268 task-clock                #    0.983 CPUs utilized          \n          2,138 context-switches          #    0.000 M/sec                  \n             69 CPU-migrations            #    0.000 M/sec                  \n            378 page-faults               #    0.000 M/sec                  \n144,600,738,759 cycles                    #    2.800 GHz                    \n124,273,104,207 instructions              #    0.86  insns per cycle        \n 25,104,320,436 branches                  #  486.101 M/sec                  \n  3,929,572,460 branch-misses             #   15.65% of all branches        \n\n   52.511233236 seconds time elapsed\n</code></pre>\n"}], "owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3790, "favorite_count": 11, "accepted_answer_id": 30223885, "answer_count": 4, "score": 76, "last_activity_date": 1600894869, "creation_date": 1431544473, "last_edit_date": 1600894869, "question_id": 30223441, "link": "https://stackoverflow.com/questions/30223441/vs-in-bubble-sort-causes-significant-performance-difference", "title": "&gt; vs. &gt;= in bubble sort causes significant performance difference", "body": "<p>I just stumbled upon something. At first I thought it might be a case of branch misprediction like it is <a href=\"https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array\">in this case</a>, but I cannot explain why branch misprediction should cause this behaviour.</p>\n<p>I implemented two versions of Bubble Sort in Java and did some performance testing:</p>\n<pre><code>import java.util.Random;\n\npublic class BubbleSortAnnomaly {\n\n    public static void main(String... args) {\n        final int ARRAY_SIZE = Integer.parseInt(args[0]);\n        final int LIMIT = Integer.parseInt(args[1]);\n        final int RUNS = Integer.parseInt(args[2]);\n\n        int[] a = new int[ARRAY_SIZE];\n        int[] b = new int[ARRAY_SIZE];\n        Random r = new Random();\n        for (int run = 0; RUNS &gt; run; ++run) {\n            for (int i = 0; i &lt; ARRAY_SIZE; i++) {\n                a[i] = r.nextInt(LIMIT);\n                b[i] = a[i];\n            }\n\n            System.out.print(&quot;Sorting with sortA: &quot;);\n            long start = System.nanoTime();\n            int swaps = bubbleSortA(a);\n\n            System.out.println(  (System.nanoTime() - start) + &quot; ns. &quot;\n                               + &quot;It used &quot; + swaps + &quot; swaps.&quot;);\n\n            System.out.print(&quot;Sorting with sortB: &quot;);\n            start = System.nanoTime();\n            swaps = bubbleSortB(b);\n\n            System.out.println(  (System.nanoTime() - start) + &quot; ns. &quot;\n                               + &quot;It used &quot; + swaps + &quot; swaps.&quot;);\n        }\n    }\n\n    public static int bubbleSortA(int[] a) {\n        int counter = 0;\n        for (int i = a.length - 1; i &gt;= 0; --i) {\n            for (int j = 0; j &lt; i; ++j) {\n                if (a[j] &gt; a[j + 1]) {\n                    swap(a, j, j + 1);\n                    ++counter;\n                }\n            }\n        }\n        return (counter);\n    }\n\n    public static int bubbleSortB(int[] a) {\n        int counter = 0;\n        for (int i = a.length - 1; i &gt;= 0; --i) {\n            for (int j = 0; j &lt; i; ++j) {\n                if (a[j] &gt;= a[j + 1]) {\n                    swap(a, j, j + 1);\n                    ++counter;\n                }\n            }\n        }\n        return (counter);\n    }\n\n    private static void swap(int[] a, int j, int i) {\n        int h = a[i];\n        a[i] = a[j];\n        a[j] = h;\n    }\n}\n</code></pre>\n<p>As we can see, the only difference between those two sorting methods is the <code>&gt;</code> vs. <code>&gt;=</code>. When running the program with <code>java BubbleSortAnnomaly 50000 10 10</code>, one would obviously expect that <code>sortB</code> is slower than <code>sortA</code> because it has to execute more <code>swap(...)</code>s. But I got the following (or similar) output on three different machines:</p>\n<pre><code>Sorting with sortA: 4.214 seconds. It used  564960211 swaps.\nSorting with sortB: 2.278 seconds. It used 1249750569 swaps.\nSorting with sortA: 4.199 seconds. It used  563355818 swaps.\nSorting with sortB: 2.254 seconds. It used 1249750348 swaps.\nSorting with sortA: 4.189 seconds. It used  560825110 swaps.\nSorting with sortB: 2.264 seconds. It used 1249749572 swaps.\nSorting with sortA: 4.17  seconds. It used  561924561 swaps.\nSorting with sortB: 2.256 seconds. It used 1249749766 swaps.\nSorting with sortA: 4.198 seconds. It used  562613693 swaps.\nSorting with sortB: 2.266 seconds. It used 1249749880 swaps.\nSorting with sortA: 4.19  seconds. It used  561658723 swaps.\nSorting with sortB: 2.281 seconds. It used 1249751070 swaps.\nSorting with sortA: 4.193 seconds. It used  564986461 swaps.\nSorting with sortB: 2.266 seconds. It used 1249749681 swaps.\nSorting with sortA: 4.203 seconds. It used  562526980 swaps.\nSorting with sortB: 2.27  seconds. It used 1249749609 swaps.\nSorting with sortA: 4.176 seconds. It used  561070571 swaps.\nSorting with sortB: 2.241 seconds. It used 1249749831 swaps.\nSorting with sortA: 4.191 seconds. It used  559883210 swaps.\nSorting with sortB: 2.257 seconds. It used 1249749371 swaps.\n</code></pre>\n<p>When I set the parameter for <code>LIMIT</code> to, e.g., <code>50000</code> (<code>java BubbleSortAnnomaly 50000 50000 10</code>), I get the expected results:</p>\n<pre><code>Sorting with sortA: 3.983 seconds. It used  625941897 swaps.\nSorting with sortB: 4.658 seconds. It used  789391382 swaps.\n</code></pre>\n<p>I ported the program to C++ to determine whether this problem is Java-specific. Here is the C++ code.</p>\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\n\n#include &lt;omp.h&gt;\n\n#ifndef ARRAY_SIZE\n#define ARRAY_SIZE 50000\n#endif\n\n#ifndef LIMIT\n#define LIMIT 10\n#endif\n\n#ifndef RUNS\n#define RUNS 10\n#endif\n\nvoid swap(int * a, int i, int j)\n{\n    int h = a[i];\n    a[i] = a[j];\n    a[j] = h;\n}\n\nint bubbleSortA(int * a)\n{\n    const int LAST = ARRAY_SIZE - 1;\n    int counter = 0;\n    for (int i = LAST; 0 &lt; i; --i)\n    {\n        for (int j = 0; j &lt; i; ++j)\n        {\n            int next = j + 1;\n            if (a[j] &gt; a[next])\n            {\n                swap(a, j, next);\n                ++counter;\n            }\n        }\n    }\n    return (counter);\n}\n\nint bubbleSortB(int * a)\n{\n    const int LAST = ARRAY_SIZE - 1;\n    int counter = 0;\n    for (int i = LAST; 0 &lt; i; --i)\n    {\n        for (int j = 0; j &lt; i; ++j)\n        {\n            int next = j + 1;\n            if (a[j] &gt;= a[next])\n            {\n                swap(a, j, next);\n                ++counter;\n            }\n        }\n    }\n    return (counter);\n}\n\nint main()\n{\n    int * a = (int *) malloc(ARRAY_SIZE * sizeof(int));\n    int * b = (int *) malloc(ARRAY_SIZE * sizeof(int));\n\n    for (int run = 0; RUNS &gt; run; ++run)\n    {\n        for (int idx = 0; ARRAY_SIZE &gt; idx; ++idx)\n        {\n            a[idx] = std::rand() % LIMIT;\n            b[idx] = a[idx];\n        }\n\n        std::cout &lt;&lt; &quot;Sorting with sortA: &quot;;\n        double start = omp_get_wtime();\n        int swaps = bubbleSortA(a);\n\n        std::cout &lt;&lt; (omp_get_wtime() - start) &lt;&lt; &quot; seconds. It used &quot; &lt;&lt; swaps\n                  &lt;&lt; &quot; swaps.&quot; &lt;&lt; std::endl;\n\n        std::cout &lt;&lt; &quot;Sorting with sortB: &quot;;\n        start = omp_get_wtime();\n        swaps = bubbleSortB(b);\n\n        std::cout &lt;&lt; (omp_get_wtime() - start) &lt;&lt; &quot; seconds. It used &quot; &lt;&lt; swaps\n                  &lt;&lt; &quot; swaps.&quot; &lt;&lt; std::endl;\n    }\n\n    free(a);\n    free(b);\n\n    return (0);\n}\n</code></pre>\n<p>This program shows the same behaviour. Can someone explain what exactly is going on here?</p>\n<p>Executing <code>sortB</code> first and then <code>sortA</code> does not change the results.</p>\n"}, {"tags": ["c++", "c++11", "asynchronous", "future"], "answers": [{"comments": [{"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1431545425, "post_id": 30223543, "comment_id": 48551201, "body": "&quot;Can a lambda returning void end with...&quot; Yes. See the first example in my answer."}, {"owner": {"reputation": 10644, "user_id": 722294, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/93c0ad362f097b52bf81c30d116e7319?s=128&d=identicon&r=PG", "display_name": "Jared Hoberock", "link": "https://stackoverflow.com/users/722294/jared-hoberock"}, "edited": false, "score": 0, "creation_date": 1431550344, "post_id": 30223543, "comment_id": 48553731, "body": "Thanks for the suggestion!"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 6, "last_activity_date": 1431545678, "last_edit_date": 1431545678, "creation_date": 1431544915, "answer_id": 30223543, "question_id": 30223186, "link": "https://stackoverflow.com/questions/30223186/adapting-a-function-that-returns-stdfuturet-to-stdfutureu/30223543#30223543", "title": "Adapting a function that returns std::future&lt;T&gt; to std::future&lt;U&gt;", "body": "<p>I think you are using the wrong primitive.</p>\n\n<p>Here I build everything up with a different primitive -- a sink.</p>\n\n<p>A sink can consume data via <code>operator()(T&amp;&amp;)&amp;</code>.  It then returns some result via <code>operator()()&amp;&amp;</code>.</p>\n\n<p>Here is a <code>async_sink</code> function:</p>\n\n<pre><code>template&lt;class Container, class Sink&gt;\nstd::future&lt;std::result_of_t&lt;std::decay_t&lt;Sink&gt;()&gt;&gt;\nasync_sink(Container&amp;&amp; c, Sink&amp;&amp; sink)\n{\n  return std::async(\n    [c=std::forward&lt;Container&gt;(c), sink=std::forward&lt;Sink&gt;(sink)]\n  {\n    for( auto&amp;&amp; x : std::move(c) ) {\n      sink( x );\n    }\n\n    return std::move(sink)();\n  });\n} \n</code></pre>\n\n<p>Here is an implementation of a <code>sink</code> that puts things into a container, then returns it:</p>\n\n<pre><code>template&lt;class C&gt;\nstruct container_sink_t {\n  C c;\n  template&lt;class T&gt;\n  void operator()( T&amp;&amp; t ){\n    c.emplace_back( std::forward&lt;T&gt;(t) );\n  }\n  C operator()()&amp;&amp;{\n    return std::move(c);\n  }\n};\n</code></pre>\n\n<p>Here is a sink that takes a function and a sink and composes them:</p>\n\n<pre><code>template&lt;class F, class S&gt;\nstruct compose_sink_t {\n  F f;\n  S s;\n  template&lt;class T&gt;\n  void operator()(T&amp;&amp; t){\n    s(\n      f(std::forward&lt;T&gt;(t))\n    );\n  }\n  std::result_of_t&lt;S()&gt; operator()()&amp;&amp;{\n    return std::move(s)();\n  }\n};\n\ntemplate&lt;class C, class F&gt;\ncompose_sink_t&lt;std::decay_t&lt;F&gt;, container_sink_t&lt;C&gt;&gt;\ntransform_then_container_sink( F&amp;&amp; f ) {\n  return {std::forward&lt;F&gt;(f)};\n}\n</code></pre>\n\n<p>Here is a sink that takes a function, calls it, and returns <code>void</code>:</p>\n\n<pre><code>template&lt;class F&gt;\nstruct void_sink_t {\n  F f;\n  template&lt;class T&gt;\n  void operator()(T&amp;&amp; t)\n  {\n    f(std::forward&lt;T&gt;(t));\n  }\n  void operator()() {}\n};\ntemplate&lt;class F&gt;\nvoid_sink_t&lt;std::decay_t&lt;F&gt;&gt; void_sink(F&amp;&amp;f){return {std::forward&lt;F&gt;(f)}; }\n</code></pre>\n\n<p>now your map is:</p>\n\n<pre><code>template&lt;class Container, class T, class Function&gt;\nstd::future&lt;Container&gt; async_map(const std::vector&lt;T&gt;&amp; in, Function f)\n{\n  return async_sink(\n    in,\n    transform_then_container_sink&lt;Container&gt;(std::forward&lt;F&gt;(f))\n  );\n}\n</code></pre>\n\n<p>and your for_each is:</p>\n\n<pre><code>template&lt;class T, class Function&gt;\nstd::future&lt;void&gt; async_for_each(const std::vector&lt;T&gt;&amp; in, Function f)\n{\n  return async_sink(\n    in,\n    void_sink(std::forward&lt;F&gt;(f))\n  );\n}\n</code></pre>\n\n<p>I freely use C++14 features, because they made the code better.  You can replace the move-into-container with a copy for a touch less efficiency, and write your own <code>_t</code> aliases.</p>\n\n<p>The above code has not been tested or run, so there are probably bugs in it.  There is one issue I'm uncertain of -- can a lambda returning void end with a <code>return void_func()</code> in that context? -- but as that uglyness is in one spot, it can be worked around even if it doesn't work.</p>\n"}], "owner": {"reputation": 10644, "user_id": 722294, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/93c0ad362f097b52bf81c30d116e7319?s=128&d=identicon&r=PG", "display_name": "Jared Hoberock", "link": "https://stackoverflow.com/users/722294/jared-hoberock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1431545678, "creation_date": 1431543600, "last_edit_date": 1495542115, "question_id": 30223186, "link": "https://stackoverflow.com/questions/30223186/adapting-a-function-that-returns-stdfuturet-to-stdfutureu", "title": "Adapting a function that returns std::future&lt;T&gt; to std::future&lt;U&gt;", "body": "<p>Suppose I have an asynchronous functional map primitive which takes a <code>std::vector</code> as input and returns a <code>std::future</code> to a <code>Container</code> of my choice as output:</p>\n\n<pre><code>template&lt;class Container, class T, class Function&gt;\nstd::future&lt;Container&gt; async_map(const std::vector&lt;T&gt;&amp; in, Function f)\n{\n  return std::async([=]\n  {\n    Container result(in.size());\n\n    for(size_t i = 0; i &lt; in.size(); ++i)\n    {\n      result[i] = f(in[i]);\n    }\n\n    return result;\n  });\n} \n</code></pre>\n\n<p>I'd like to build an analogous <code>async_for_each</code> function by adapting <code>async_map</code>:</p>\n\n<pre><code>template&lt;class T, class Function&gt;\nstd::future&lt;void&gt; async_for_each(const std::vector&lt;T&gt;&amp; in, Function f);\n</code></pre>\n\n<p>The problem is that <code>async_for_each</code> returns <code>std::future&lt;void&gt;</code>, while <code>async_map</code> returns <code>std::future&lt;Container&gt;</code>, and <code>void</code> is not a <code>Container</code>.</p>\n\n<p>I can get something close to what I want by constructing a type which fulfills the <code>Container</code> requirements but ignores assignments to it (<code>empty_container</code> in my initial attempt), but a <code>std::future</code> of this type is still not <code>std::future&lt;void&gt;</code>.</p>\n\n<p>I have the following constraints on my solution:</p>\n\n<ul>\n<li>There must be only one implementation of <code>async_map</code>, with the given function signature (i.e., no <code>async_map&lt;void&gt;</code> specialization)</li>\n<li>There must be only one <code>std::future</code> created (i.e., no <code>.then()</code>-style continuation)</li>\n</ul>\n\n<p>I was hoping there is an efficient way to convert between <code>std::future</code>s of related types (or cast a <code>std::future&lt;T&gt;</code> to <code>std::future&lt;void&gt;</code>), but the answer to <a href=\"https://stackoverflow.com/questions/29616135/how-to-convert-stdfuturet-to-stdfuturevoid\">this question</a> suggests it is not possible.</p>\n\n<p>Random ideas:</p>\n\n<ul>\n<li>Can <code>async_for_each</code> wrap its function in a clever way to solve this problem?</li>\n<li>Can the type used for <code>Container</code> act like <code>void</code> in <code>async_for_each</code>, but act like <code>Container</code> in <code>async_map</code>?</li>\n</ul>\n\n<p>My initial attempt is below. Is it possible to build what I want given these constraints?</p>\n\n<pre><code>#include &lt;future&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\ntemplate&lt;class Container, class T, class Function&gt;\nstd::future&lt;Container&gt; async_map(const std::vector&lt;T&gt;&amp; in, Function f)\n{\n  return std::async([=]\n  {\n    Container result(in.size());\n\n    for(size_t i = 0; i &lt; in.size(); ++i)\n    {\n      result[i] = f(in[i]);\n    }\n\n    return result;\n  });\n}\n\nstruct empty_container\n{\n  empty_container(size_t) {}\n\n  struct empty\n  {\n    template&lt;class T&gt;\n    empty operator=(const T&amp;) const { return empty(); }\n  };\n\n  empty operator[](size_t) { return empty(); }\n};\n\ntemplate&lt;class Function&gt;\nstruct invoke_and_ignore_result\n{\n  Function f;\n\n  template&lt;class T&gt;\n  empty_container::empty operator()(T&amp;&amp; x) const\n  {\n    f(std::forward&lt;T&gt;(x));\n    return empty_container::empty();\n  }\n};\n\ntemplate&lt;class T, class Function&gt;\n//std::future&lt;void&gt; async_for_each(const std::vector&lt;T&gt;&amp; in, Function f)\nstd::future&lt;empty_container&gt; async_for_each(const std::vector&lt;T&gt;&amp; in, Function f)\n{\n  invoke_and_ignore_result&lt;Function&gt; g{f};\n\n  std::future&lt;empty_container&gt; f1 = async_map&lt;empty_container&gt;(in, g);\n\n  return f1;\n}\n\nint main()\n{\n  std::vector&lt;int&gt; vec(5, 13);\n\n  async_for_each(vec, [](int x)\n  {\n    std::cout &lt;&lt; x &lt;&lt; \" \";\n  }).wait();\n\n  std::cout &lt;&lt; std::endl;\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "libssh"], "answers": [{"tags": [], "owner": {"reputation": 2200, "user_id": 1519323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zUWVH.png?s=128&g=1", "display_name": "davepmiller", "link": "https://stackoverflow.com/users/1519323/davepmiller"}, "is_accepted": true, "score": 1, "last_activity_date": 1431713705, "creation_date": 1431713705, "answer_id": 30266201, "question_id": 30223185, "link": "https://stackoverflow.com/questions/30223185/libssh-c-wrapper-basic-remote-connection-segfaults-when-leaving-scope/30266201#30266201", "title": "LibSSH C++ wrapper - Basic remote connection segfaults when leaving scope", "body": "<p>After beating on it awhile, we have a working solution. The first hurdle was recognizing that the remote host must be a \"known host\". After that, for me, it was necessary to then source the environment before running my executable. \nLast, I needed to give it some time to crunch with <code>sleep( 1 )</code>. Enjoy.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n#include &lt;libssh/libsshpp.hpp&gt;\n\nint main()\n{\n    int port = 22;\n\n    //Can use SSH_LOG_PROTOCOL here for verbose output\n    int verbosity = SSH_LOG_NOLOG;\n\n    ssh::Session session;\n\n    try\n    {\n        session.setOption( SSH_OPTIONS_LOG_VERBOSITY, &amp;verbosity );\n        session.setOption( SSH_OPTIONS_PORT, &amp;port );\n        session.setOption( SSH_OPTIONS_USER, \"user\" );\n        session.setOption( SSH_OPTIONS_HOST, \"192.168.52.101\" );\n\n        session.connect();\n\n        if( session.isServerKnown() != SSH_SERVER_KNOWN_OK )\n        {\n            if( session.writeKnownhost() != SSH_OK )\n            {\n                cout &lt;&lt; \"writeKnownHost failed\" &lt;&lt; endl;\n            }\n            else\n            {\n                session.connect();\n            }\n        }\n\n        if( session.userauthPassword( \"password\" ) != SSH_AUTH_SUCCESS )\n        {\n            cout &lt;&lt; \"failed auth\" &lt;&lt; endl;\n        }\n\n        ssh::Channel channel( session );\n        channel.openSession();\n        //Source environment if necessary, run executable\n        channel.requestExec( \"source /path/to/set_env.sh; /path/to/executable/...\" );\n        channel.close();\n        channel.sendEof();\n\n        //Unfortunate brute force step, the exec call needed some time\n        sleep( 1 );\n\n    }\n    catch( ssh::SshException e )\n    {\n        std::cout &lt;&lt; \"Error during connection : \";\n        std::cout &lt;&lt; e.getError() &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 2200, "user_id": 1519323, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zUWVH.png?s=128&g=1", "display_name": "davepmiller", "link": "https://stackoverflow.com/users/1519323/davepmiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 0, "accepted_answer_id": 30266201, "answer_count": 1, "score": 1, "last_activity_date": 1431713705, "creation_date": 1431543600, "question_id": 30223185, "link": "https://stackoverflow.com/questions/30223185/libssh-c-wrapper-basic-remote-connection-segfaults-when-leaving-scope", "title": "LibSSH C++ wrapper - Basic remote connection segfaults when leaving scope", "body": "<p>I'm new to <code>libssh</code> and trying to connect to a remote machine to run some commands. All of the connections and commands return without error, but then the program segfaults when leaving scope. What am I doing wrong?    </p>\n\n<h2>Code</h2>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\n#define SSH_NO_CPP_EXCEPTIONS\n#include &lt;libssh/libsshpp.hpp&gt;\n\nint main()\n{\n    ssh::Session session;\n\n    //Set options\n    session.setOption(SSH_OPTIONS_HOST, \"192.168.200.101\");\n    session.setOption( SSH_OPTIONS_USER, \"user\" );\n\n    //Connect to host\n    session.connect();\n\n    //Authenticate user\n    session.userauthPassword( \"password\" );\n\n    //Open channel\n    ssh::Channel channel( session );\n    channel.openSession();\n\n    //Do something\n    channel.requestExec( \"ps_aux\" );\n\n    //Close channel\n    channel.sendEof();\n    channel.close();\n\n    //Disconnect\n    session.disconnect();\n\n    return 0;\n}\n</code></pre>\n\n<h2>GDB Trace</h2>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x00007ffff3a70a2f in ssh_channel_free () from /usr/local/lib/libssh.so.4\n(gdb) where\n#0  0x00007ffff3a70a2f in ssh_channel_free () from /usr/local/lib/libssh.so.4\n#1  0x000000000059f436 in ssh::Channel::~Channel() ()\n#2  0x000000000059e603 in main ()\n</code></pre>\n"}, {"tags": ["c++", "opengl", "3d"], "answers": [{"comments": [{"owner": {"reputation": 8130, "user_id": 2713740, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1f024ede163fdaebe61807ad5c88f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/2713740/luca"}, "edited": false, "score": 0, "creation_date": 1431544169, "post_id": 30223198, "comment_id": 48550485, "body": "Yeah, I figured that out just as I posted but I have other issues as well! I will post a new question to highlight that...!"}], "tags": [], "owner": {"reputation": 18263, "user_id": 39912, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/06e1d13822161fadef62a4faa30010e7?s=128&d=identicon&r=PG", "display_name": "Anteru", "link": "https://stackoverflow.com/users/39912/anteru"}, "is_accepted": true, "score": 6, "last_activity_date": 1431543643, "creation_date": 1431543643, "answer_id": 30223198, "question_id": 30223156, "link": "https://stackoverflow.com/questions/30223156/opengl-rotating-an-ellipse/30223198#30223198", "title": "opengl: rotating an ellipse", "body": "<p>You're working in the XY plane, so you can't really rotate around a vector in XY. Instead, you want to rotate along the unit Z axis (<code>glRotate (angle, 0, 0, 1);</code>). Imagine your screen being the XY coordinate system and the Z axis pointing inwards. What you want is to rotate around the Z axis, so your XY plane remains in the XY plane.</p>\n"}], "owner": {"reputation": 8130, "user_id": 2713740, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1f024ede163fdaebe61807ad5c88f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Luca", "link": "https://stackoverflow.com/users/2713740/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "accepted_answer_id": 30223198, "answer_count": 1, "score": 1, "last_activity_date": 1431543643, "creation_date": 1431543494, "question_id": 30223156, "link": "https://stackoverflow.com/questions/30223156/opengl-rotating-an-ellipse", "title": "opengl: rotating an ellipse", "body": "<p>I am having trouble rotating an ellipse in OpenGL. So, I have some code to draw an ellipse as follows:</p>\n\n<pre><code>glPushAttrib(GL_CURRENT_BIT);\nglColor3f(1.0f, 0.0f, 0.0f);\nglLineWidth(2.0);\nglPushMatrix();\nglTranslatef(0, 0, 0); // ellipse centre   \nglBegin(GL_LINE_LOOP);\nfloat inc = (float) M_PI / 500.0;\nfor (GLfloat i = 0; i &lt; M_PI * 2; i+=inc)\n{\n    float x = cos(i) * 0.4;\n    float y = sin(i) * 0.4;\n    glVertex2f(x, y);\n}\nglEnd();\nglPopMatrix();\nglPopAttrib();\n</code></pre>\n\n<p>This produces a picture as so:<img src=\"https://i.stack.imgur.com/IUNSy.png\" alt=\"enter image description here\"></p>\n\n<p>Now what I want to do is rotate this ellipse clockwise. So I added a glrotate in between but the result was not what I had expected.</p>\n\n<p>So, I did something like:</p>\n\n<pre><code>glPushAttrib(GL_CURRENT_BIT);\nglColor3f(1.0f, 0.0f, 0.0f);\nglLineWidth(2.0);\nglPushMatrix();\nglTranslatef(0, 0, 0);    \nglRotatef(-90, 1, 1, 0);\nglBegin(GL_LINE_LOOP);\nfloat inc = (float) M_PI / 500.0;\nfor (GLfloat i = 0; i &lt; M_PI * 2; i+=inc)\n{\n    float x = cos(i) * 0.4;\n    float y = sin(i) * 0.4;\n    glVertex2f(x, y);\n}\n\nglEnd();\nglPopMatrix();\nglPopAttrib();\n</code></pre>\n\n<p>This produced an image which was simply collapsed. What I wanted to do was rotate the ellipse along its center by the specified degrees. Also, I tried playing around with the various parameters of glRotatef but could not get it do as I expected. The resulting image looks like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/j79mh.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c++", "json", "docker"], "answers": [{"comments": [{"owner": {"reputation": 1145, "user_id": 160799, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01978d932c826147b4154c90b92663b?s=128&d=identicon&r=PG", "display_name": "Gregor", "link": "https://stackoverflow.com/users/160799/gregor"}, "edited": false, "score": 0, "creation_date": 1443818046, "post_id": 30224399, "comment_id": 53658664, "body": "Cool, but still clunky, they should really provide a clean schema, also for the new Registry V2 API. So now I only need a Go-&gt;JSON schema converter so I can generate my Java POJOs;=)"}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": true, "score": 3, "last_activity_date": 1431548105, "creation_date": 1431548105, "answer_id": 30224399, "question_id": 30223136, "link": "https://stackoverflow.com/questions/30223136/docker-remote-api-json-schema-definition/30224399#30224399", "title": "Docker Remote API JSON schema definition", "body": "<p>First of all, there's the <a href=\"https://docs.docker.com/reference/api/docker_remote_api/\" rel=\"nofollow\">official remote API documentation</a>. However, since it contains \"only\" example requests and no authoritative schema definitions, it's probably not what you're looking for.</p>\n\n<p>There does <strong>not seem to be</strong> an official <a href=\"http://json-schema.org/\" rel=\"nofollow\">JSON schema</a> for the Docker remote API. However, the API responses are directly generated from corresponding <strong>Go structs</strong> which you can all find in a single file in the <a href=\"https://github.com/docker/docker/blob/master/api/types/types.go\" rel=\"nofollow\">source code repository</a>.</p>\n\n<p>For example, consider the definition of the <code>Container</code> response type:</p>\n\n<pre><code>// GET  \"/containers/json\"\ntype Port struct {\n    IP          string\n    PrivatePort int\n    PublicPort  int\n    Type        string\n}\n\ntype Container struct {\n    ID         string            `json:\"Id\"`\n    Names      []string          `json:\",omitempty\"`\n    Image      string            `json:\",omitempty\"`\n    Command    string            `json:\",omitempty\"`\n    Created    int               `json:\",omitempty\"`\n    Ports      []Port            `json:\",omitempty\"`\n    SizeRw     int               `json:\",omitempty\"`\n    SizeRootFs int               `json:\",omitempty\"`\n    Labels     map[string]string `json:\",omitempty\"`\n    Status     string            `json:\",omitempty\"`\n}\n</code></pre>\n\n<p>This basically contains all possible keys and their data types that you might encounter when requesting the <code>/containers/json</code> URI. All other resource representations can also be found the same way.</p>\n"}], "owner": {"reputation": 1207, "user_id": 3195698, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TawcY.jpg?s=128&g=1", "display_name": "UnSat", "link": "https://stackoverflow.com/users/3195698/unsat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 30224399, "answer_count": 1, "score": 1, "last_activity_date": 1431548174, "creation_date": 1431543407, "last_edit_date": 1431548174, "question_id": 30223136, "link": "https://stackoverflow.com/questions/30223136/docker-remote-api-json-schema-definition", "title": "Docker Remote API JSON schema definition", "body": "<p>I have a program which communicates with docker dameon remotely using REST api. It receives the information about images, containers, repositories in json format. I want to translate this REST API output from json format into C++ structures. </p>\n\n<p>JSON format is always takes the form of key, value pair where key is string, but value could be string, number, array, etc. </p>\n\n<p>I would like to know if there is standard schema definition for docker json objects?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "serialization", "boost", "boost-serialization"], "comments": [{"owner": {"reputation": 465, "user_id": 1851837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f39fdc3a5c2445c6e3b32a19df9e3bb?s=128&d=identicon&r=PG", "display_name": "jgyou", "link": "https://stackoverflow.com/users/1851837/jgyou"}, "edited": false, "score": 0, "creation_date": 1431543402, "post_id": 30222898, "comment_id": 48550006, "body": "I assume that <code>outers</code> is declared somewhere else in the real main()?"}, {"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "reply_to_user": {"reputation": 465, "user_id": 1851837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f39fdc3a5c2445c6e3b32a19df9e3bb?s=128&d=identicon&r=PG", "display_name": "jgyou", "link": "https://stackoverflow.com/users/1851837/jgyou"}, "edited": false, "score": 0, "creation_date": 1431543441, "post_id": 30222898, "comment_id": 48550032, "body": "Yes, <code>outers</code> is a vector of <code>outer</code> class instances."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1431543481, "post_id": 30222898, "comment_id": 48550060, "body": "Can you move that into the posted code?  (all variables you use, etc)  MCVE are appreciated.  And fix indentation, etc."}, {"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1431543666, "post_id": 30222898, "comment_id": 48550181, "body": "@Yakk Made the edits."}, {"owner": {"reputation": 465, "user_id": 1851837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f39fdc3a5c2445c6e3b32a19df9e3bb?s=128&d=identicon&r=PG", "display_name": "jgyou", "link": "https://stackoverflow.com/users/1851837/jgyou"}, "edited": false, "score": 1, "creation_date": 1431543729, "post_id": 30222898, "comment_id": 48550219, "body": "Did you include the vector serialization header?"}, {"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "edited": false, "score": 0, "creation_date": 1431543767, "post_id": 30222898, "comment_id": 48550247, "body": "Yes, that&#39;s included."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1431543811, "post_id": 30222898, "comment_id": 48550268, "body": "Please finish the MCVE -- it should be complete.  Include a minimal set of headers you need to include.  Confirm that when you compile and run your MCVE you get exactly the problem you are asking about."}, {"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1431544049, "post_id": 30222898, "comment_id": 48550411, "body": "@Yakk Edited. That&#39;s the entire code in one cpp file, self-contained."}], "answers": [{"comments": [{"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "edited": false, "score": 0, "creation_date": 1431545048, "post_id": 30223405, "comment_id": 48550995, "body": "Thank you so much, was a great help!"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 3, "last_activity_date": 1431545264, "last_edit_date": 1431545264, "creation_date": 1431544369, "answer_id": 30223405, "question_id": 30222898, "link": "https://stackoverflow.com/questions/30222898/boost-serialization-unable-to-restore-saved-objects/30223405#30223405", "title": "Boost serialization unable to restore saved objects", "body": "<p>Missing: </p>\n\n<pre><code>#include &lt;boost/serialization/export.hpp&gt;\n</code></pre>\n\n<p>You need to close the output archive/stream before reading the file back:</p>\n\n<pre><code>int main() {\n    {\n        std::ofstream ofs(\"filename.dat\");\n\n        std::vector&lt;outer&gt; outers(5);\n        std::iota(outers.begin(), outers.end(), 0u);\n\n        {\n            boost::archive::text_oarchive oa(ofs);\n            oa &lt;&lt; outers;\n        }\n    }\n\n    {\n        // read class state from archive\n        std::vector&lt;outer&gt; _outers;\n        std::ifstream ifs(\"filename.dat\");\n        boost::archive::text_iarchive ia(ifs);\n        ia &gt;&gt; _outers;\n\n        for(auto&amp; outer : _outers) {\n            std::cout &lt;&lt; \"outer \" &lt;&lt; outer.a &lt;&lt; \"\\n\";\n\n            for (auto&amp; inner: outer.inners)\n                std::cout &lt;&lt; \"   inner \" &lt;&lt; inner.a &lt;&lt; \"\\n\";\n        }\n    }\n}\n</code></pre>\n\n<h2>Full Demo</h2>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/9425c119ac7e9993\" rel=\"nofollow\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/archive/text_oarchive.hpp&gt;\n#include &lt;boost/archive/text_iarchive.hpp&gt;\n#include &lt;boost/serialization/export.hpp&gt;\n#include &lt;boost/serialization/vector.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nclass outer {\n    friend class boost::serialization::access;\n\n  public:\n    int a;\n    class inner {\n        friend class boost::serialization::access;\n\n      public:\n        int a;\n        inner(int a) { this-&gt;a = a; }\n        template &lt;class Archive&gt; void serialize(Archive &amp;ar, unsigned) { ar &amp;a; }\n        inner() {}\n    };\n    std::vector&lt;inner&gt; inners;\n    outer(int a = 0) : a(a), inners {a+1} { }\n\n    template &lt;class Archive&gt; void serialize(Archive &amp;ar, unsigned) {\n        ar &amp;a;\n        ar &amp;inners;\n    }\n};\n\n\nBOOST_CLASS_EXPORT(outer)\n\nint main(int, char *[]) {\n    {\n        std::ofstream ofs(\"filename.dat\");\n\n        std::vector&lt;outer&gt; outers(5);\n        std::iota(outers.begin(), outers.end(), 0u);\n\n        {\n            boost::archive::text_oarchive oa(ofs);\n            oa &lt;&lt; outers;\n        }\n    }\n\n    {\n        // read class state from archive\n        std::vector&lt;outer&gt; _outers;\n        std::ifstream ifs(\"filename.dat\");\n        boost::archive::text_iarchive ia(ifs);\n        ia &gt;&gt; _outers;\n\n        for(auto&amp; outer : _outers) {\n            std::cout &lt;&lt; \"outer \" &lt;&lt; outer.a &lt;&lt; \"\\n\";\n\n            for (auto&amp; inner: outer.inners)\n                std::cout &lt;&lt; \"   inner \" &lt;&lt; inner.a &lt;&lt; \"\\n\";\n        }\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>outer 0\n   inner 1\nouter 1\n   inner 2\nouter 2\n   inner 3\nouter 3\n   inner 4\nouter 4\n   inner 5\n</code></pre>\n"}], "owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 30223405, "answer_count": 1, "score": 4, "last_activity_date": 1431545264, "creation_date": 1431542665, "last_edit_date": 1431544737, "question_id": 30222898, "link": "https://stackoverflow.com/questions/30222898/boost-serialization-unable-to-restore-saved-objects", "title": "Boost serialization unable to restore saved objects", "body": "<p>This is how my class looks:  </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/dynamic_bitset/dynamic_bitset.hpp&gt;\n#include &lt;vector&gt;\n\n#include &lt;fstream&gt;\n\n// include headers that implement a archive in simple text format\n#include &lt;boost/archive/text_oarchive.hpp&gt;\n#include &lt;boost/archive/text_iarchive.hpp&gt;\n#include &lt;boost/serialization/vector.hpp&gt;\n\nusing namespace std;\nusing namespace boost;\n\nclass outer{\n    friend class boost::serialization::access;\n    public:\n        int a;\n        class inner{\n            friend class boost::serialization::access;\n            public:\n                int a;\n                inner(int a){\n                    this-&gt;a = a;\n                }\n                template&lt;class Archive&gt;\n                void serialize(Archive &amp; ar,const unsigned int version){\n                    ar &amp; a;\n                }\n                inner(){\n                }\n        };\n        vector&lt;inner&gt; inners;\n        outer(int a){\n            this-&gt;a = a;    \n            inners.push_back(inner(this-&gt;a+1));     \n        }\n        outer(){\n        }\n\n        template&lt;class Archive&gt;\n        void serialize(Archive &amp; ar,const unsigned int version){\n            ar &amp; a;\n            ar &amp; inners;\n        }\n};\n\nvector&lt;outer&gt; outers;\nvector&lt;outer&gt; _outers;\n\nBOOST_CLASS_EXPORT(outer);\n\nint main(int, char*[]) {\n    int i;\n    std::ofstream ofs(\"filename.dat\");\n    for(i=0;i&lt;5;i++)\n        outers.push_back(outer(i)); \n\n    boost::archive::text_oarchive oa(ofs);\n    oa &lt;&lt; outers;\n    std::ifstream ifs(\"filename.dat\");\n        boost::archive::text_iarchive ia(ifs);\n        // read class state from archive\n        ia &gt;&gt; _outers;\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I create a vector of <code>outer</code> class instances and write it out to a text stream (which seems to work fine). But when I read it back, I get the error:<br>\n<em>terminate called after throwing an instance of 'boost::archive::archive_exception'\n  what():  input stream error</em></p>\n\n<p>The above is the entire self-contained code, compiled with:  </p>\n\n<pre><code>g++ -I /path/to/boost test.cpp -lboost_serialization\n</code></pre>\n\n<p>How do I fix this, any ideas? </p>\n"}, {"tags": ["c#", "c++", "visual-studio-2010", "dll", "pinvoke"], "comments": [{"owner": {"reputation": 4150, "user_id": 178014, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d9fae1c8ba6b8a95e37249a91cc2330e?s=128&d=identicon&r=PG", "display_name": "Kratz", "link": "https://stackoverflow.com/users/178014/kratz"}, "edited": false, "score": 3, "creation_date": 1431543403, "post_id": 30222710, "comment_id": 48550007, "body": "Since you are seeing increased memory usage, it might be a start to review the unmanaged PInvoke calls, and how data is being marshalled. Its a deep subject, but failing to pin memory, allowing memory to be garbage collected while unmaged code is still using it, including possible race conditions from threading on this data, could all cause abnomal crashes. I wish you luck, it&#39;s a tough cookie to crack."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1431555027, "post_id": 30222710, "comment_id": 48555996, "body": "You need to debug this. Instrument and inspect. Not really a subject for SO which is narrower."}, {"owner": {"reputation": 58019, "user_id": 397952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eea5083041d267828ea9fd38f2e2d699?s=128&d=identicon&r=PG", "display_name": "JNK", "link": "https://stackoverflow.com/users/397952/jnk"}, "reply_to_user": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1431699053, "post_id": 30222710, "comment_id": 48623150, "body": "@CaptainObvlious I don&#39;t think asking for a METHOD makes this off-topic."}], "answers": [{"tags": [], "owner": {"reputation": 593, "user_id": 858339, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4a1a8179ccf35c55c9d3a8c28b8314a0?s=128&d=identicon&r=PG", "display_name": "alexg", "link": "https://stackoverflow.com/users/858339/alexg"}, "is_accepted": false, "score": 1, "last_activity_date": 1432231769, "creation_date": 1432231769, "answer_id": 30381289, "question_id": 30222710, "link": "https://stackoverflow.com/questions/30222710/ms-vc-runtime-library-error-running-managed-c-application/30381289#30381289", "title": "MS VC++ Runtime Library Error Running Managed C# Application", "body": "<p>After extensive attempts to isolate the reason of the crash, Debug Diagnostic Tool (v2 Update 1) from <a href=\"http://blogs.msdn.com/b/debugdiag/\" rel=\"nofollow\">Microsoft</a> provided the needed information.</p>\n\n<p>We used Debug Diag's Crash/Hang Analyzer for the process we were dealing with.\nUnder Tools / Options &amp; Settings / Symbol Search Path For Analaysis we specified the locations of the .PDB files for all of our components (.Net application, C++ DLLs, etc.)</p>\n\n<p>Once crashed, Debug Diag's resulting call stack pinpointed exactly to the call to the unmanaged 3rd party DLL we're utilizing that resulted in access violation exception / crash.</p>\n"}], "owner": {"reputation": 593, "user_id": 858339, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4a1a8179ccf35c55c9d3a8c28b8314a0?s=128&d=identicon&r=PG", "display_name": "alexg", "link": "https://stackoverflow.com/users/858339/alexg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432231769, "creation_date": 1431542064, "last_edit_date": 1431556866, "question_id": 30222710, "link": "https://stackoverflow.com/questions/30222710/ms-vc-runtime-library-error-running-managed-c-application", "title": "MS VC++ Runtime Library Error Running Managed C# Application", "body": "<p>We have a managed C# application (MS Visual Studio 2010, target framework: .Net 4 Client Profile) that uses unmanaged COM objects via Interop and also utilizes P/Invoke to call functions in our own DLL (C++). P/Invoke calls are made from <code>System.Threading.Task</code> procedures and can therefore take place concurrently. We limit the total number of simultaneous tasks to 10.</p>\n\n<p>The application can run for quite some time, continuously creating tasks and invoking unmanaged functions. At some point a dialog box pops up - <em>Microsoft Visual C++ Runtime Library / Runtime Error! / The application has requested the Runtime to terminate it in an unusual way</em>...</p>\n\n<p>There are no event log entries created as a result of the dialog box. \n<img src=\"https://i.stack.imgur.com/IouU2.png\" alt=\"enter image description here\"> </p>\n\n<p><strong>While the dialog box is displayed</strong>, the application continues to run, though its memory utilization continues to climb. As monitored in TaskManager and VMMap (Sysinternals), the memory use increases for another 5-10 minutes and then the application crashes.   </p>\n\n<p>The question is - <strong>why does the application continue to run even after the error dialog box comes up?</strong></p>\n\n<p>Right before the crash, i.e., as the memory is exhausted, <code>System.OutOfMemoryException</code>'s are thrown by any code that tries to allocate memory, and are caught by C#.</p>\n\n<p>So at this point the application event log has a new entry indicates the following:</p>\n\n<p><code>Faulting module name: KERNELBASE.dll, version: 6.1.7601.18798\n Exception code: 0xe0434352\n Fault offset: 0x0000c42d\n Description: The process was terminated due to an unhandled exception.\n Exception Info: System.AccessViolationException</code></p>\n\n<p>No further information is available; dump files are not generated.\nOur unmanaged components (COM DLL, DLL) do not appear as the faulting modules.</p>\n\n<p>Here's a list of tools we utilized so far:</p>\n\n<ul>\n<li><p>DbgView to view ATL traces from components involved.</p></li>\n<li><p>VMMap to investigate fragmentation, heap, etc.  </p></li>\n<li><p>DebugDiag to check for memory leaks, analyze managed and unmanaged memory, call stack, etc.  </p></li>\n</ul>\n\n<p>If there are any other techniques or methods that can be used to determine the actual sequence of invocations that result in MS C++ Runtime error, any constructive suggestion would be appreciated.</p>\n"}, {"tags": ["c++", "templates", "c++11"], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1431542433, "post_id": 30222792, "comment_id": 48549414, "body": "Well, that&#39;s also always a perennial favorite. +1"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1431542540, "post_id": 30222792, "comment_id": 48549480, "body": "Maybe put the tag dispatch overloads into <code>namespace details</code>, so if your IDE does overload auto completion, they don&#39;t show up."}], "tags": [], "owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "is_accepted": true, "score": 12, "last_activity_date": 1431543155, "last_edit_date": 1431543155, "creation_date": 1431542297, "answer_id": 30222792, "question_id": 30222659, "link": "https://stackoverflow.com/questions/30222659/partial-specialization-for-pointer-as-function-return-type/30222792#30222792", "title": "Partial specialization for pointer as function return type", "body": "<p>Use tag dispatching to delegate the calls to helper functions that do different things based on whether <code>T</code> is a pointer type or not.</p>\n\n<pre><code>namespace detail\n{\ntemplate&lt;class T&gt;\nT foo(Bar&amp; bar, const char* key, std::false_type /*not is_pointer*/) {\n    return bar.value&lt;T&gt;(key);\n}\n\ntemplate&lt;class T&gt;\nT foo(Bar&amp; bar, const char* key, std::true_type /*is_pointer*/) {\n    return (T)bar.value&lt;void*&gt;(key);\n}\n}\n\ntemplate&lt;class T&gt;\nT foo(Bar&amp; bar, const char* key) {\n    return detail::foo&lt;T&gt;(bar, key, std::is_pointer&lt;T&gt;{});\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 822, "user_id": 408952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c7e8c3cad50793da3ac91faeb9d0fff7?s=128&d=identicon&r=PG&f=1", "display_name": "user408952", "link": "https://stackoverflow.com/users/408952/user408952"}, "edited": false, "score": 1, "creation_date": 1431544978, "post_id": 30222801, "comment_id": 48550960, "body": "I did not know about <code>std::enable_if</code>, thanks for teaching me something new. I would like to mark your post as answer as well, but I went with @Praetorian&#39;s post."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 8, "last_activity_date": 1431542324, "creation_date": 1431542324, "answer_id": 30222801, "question_id": 30222659, "link": "https://stackoverflow.com/questions/30222659/partial-specialization-for-pointer-as-function-return-type/30222801#30222801", "title": "Partial specialization for pointer as function return type", "body": "<p>Partial specialization for functions is not part of the language.</p>\n\n<p>You could for example:</p>\n\n<ol>\n<li>Delegate to some class template. Class templates can be partially specialized.</li>\n<li><p>Use SFINAE.</p>\n\n<pre><code>template&lt;class T&gt;\ntypename std::enable_if&lt;std::is_pointer&lt;T&gt;::value, T&gt;::type\nfoo(Bar&amp; bar, const char* key) {return (T)bar.value&lt;void*&gt;(key);}\n\ntemplate&lt;class T&gt;\ntypename std::enable_if&lt;!std::is_pointer&lt;T&gt;::value, T&gt;::type\nfoo(Bar&amp; bar, const char* key) {return bar.value&lt;T&gt;(key);}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 822, "user_id": 408952, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c7e8c3cad50793da3ac91faeb9d0fff7?s=128&d=identicon&r=PG&f=1", "display_name": "user408952", "link": "https://stackoverflow.com/users/408952/user408952"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "accepted_answer_id": 30222792, "answer_count": 2, "score": 4, "last_activity_date": 1431543155, "creation_date": 1431541881, "question_id": 30222659, "link": "https://stackoverflow.com/questions/30222659/partial-specialization-for-pointer-as-function-return-type", "title": "Partial specialization for pointer as function return type", "body": "<p>I have a template wrapper function that returns a value like this:</p>\n\n<pre><code>template&lt;class T&gt;\nT foo(Bar&amp; bar, const char* key) {\n    return bar.value&lt;T&gt;(key);\n}\n</code></pre>\n\n<p>But I want it to handle pointer types a bit different, like this:</p>\n\n<pre><code>template&lt;class T&gt;\nT foo(Bar&amp; bar, const char* key) {\n    return (T)bar.value&lt;void*&gt;(key);\n}\n</code></pre>\n\n<p>So that I can do:</p>\n\n<pre><code>int x = foo&lt;int&gt;(bar, \"x\");\nBaz* b = foo&lt;Baz*&gt;(bar, \"b\");\n</code></pre>\n\n<p>Writing it like above obviously gives me an error because of multiple definitions. Is there any other way to do this? I would prefer do not add a cast to each function that uses a pointer.</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>template&lt;class T&gt;\nT foo(Bar&amp; bar, const char* key) {\n    if(std::is_pointer&lt;T&gt;::value)\n        return (T)bar.value&lt;void*&gt;(key);\n    else\n        return bar.value&lt;T&gt;(key);\n}\n</code></pre>\n\n<p>But that doesn't work either because there are QVariants involved and they produce an error by just instantiating one of its template functions with an unknown pointer type (the <code>bar.value&lt;T&gt;</code>).</p>\n"}, {"tags": ["c++", "noexcept"], "comments": [{"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 4, "creation_date": 1431541776, "post_id": 30222608, "comment_id": 48549060, "body": "A signal is not an exception."}, {"owner": {"reputation": 10461, "user_id": 2043536, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/65bebfc03affca934d168c23b535b463?s=128&d=identicon&r=PG", "display_name": "sircodesalot", "link": "https://stackoverflow.com/users/2043536/sircodesalot"}, "edited": false, "score": 2, "creation_date": 1431541952, "post_id": 30222608, "comment_id": 48549162, "body": "This is definitely a solid question. But as you said &#39;a signal is not an exception&#39;, <code>noexcept</code> simply states that it won&#39;t throw exceptions - which it doesn&#39;t - but doesn&#39;t make any other guarantees about abnormal behavior (i.e. produces undefined behavior / restarts your system / formats your hard drive, etc.)"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 6, "creation_date": 1431542171, "post_id": 30222608, "comment_id": 48549284, "body": "<code>noexcept</code> is more than just a marker for functions that in their current implementation do not throw exceptions: It is also a guarantee for the user that this function <i>will never</i> throw exceptions. That is, users will depend on this guarantee, and you won&#39;t be able to add bounds checking later (e.g. in a test/debug config) without risking to abort the whole program."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1431542349, "post_id": 30222608, "comment_id": 48549372, "body": "@dyp That&#39;s an answer."}, {"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1431542891, "post_id": 30222608, "comment_id": 48549687, "body": "Yes, that&#39;s right. If I decide to ignore bound checkings now, I can&#39;t checking it later. I agree with you. But that isn&#39;t my question (although it&#39;s a good point). I&#39;ve refreshed my question to make more explicit what I&#39;m trying to ask."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1431543086, "post_id": 30222608, "comment_id": 48549793, "body": "<i>&quot;<code>noexcept</code> also implicitly says the function is safe and it will finish its execution without computational errors.&quot;</i> This would only be a convention. There&#39;s nothing in the semantics of <code>noexcept</code> that implies it. I have never seen such a convention - and, on the other hand, seen functions marked as <code>noexcept</code> that do have Undefined Behaviour, e.g. if preconditions are violated."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "edited": false, "score": 0, "creation_date": 1431543099, "post_id": 30222608, "comment_id": 48549802, "body": "Note that even though you can introduce signal handlers for <code>SIGSEGV</code> via <code>std::signal</code>, the implied pointer arithmetic in an invalid out-of-bounds access is still undefined behavior. (Edit: Hmm, my question was stupid, actually, nvm)"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1431618538, "post_id": 30222608, "comment_id": 48584575, "body": "@dyp N3279 seems like a convention in that vain."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1431619911, "post_id": 30222608, "comment_id": 48585438, "body": "@ShafikYaghmour Not necessarily: It is a conservative application of <code>noexcept</code> - I think we all agree that a no-fail, no-throw function can/should be marked as <code>noexcept</code>. However, the user cannot deduce from <code>noexcept</code> that the function cannot fail. For example, N3279 also suggests (&quot;may&quot;) applying <code>noexcept</code> to <i>&quot;Library functions designed for compatibility with \u201cC\u201d code&quot;</i>. So nofail &amp; nothrow =&gt; noexcept, but not noexcept =&gt; nofail. (Per convention, <code>vector</code> etc assume that for special member functions, noexcept =&gt; nofail.)"}], "answers": [{"tags": [], "owner": {"reputation": 2246, "user_id": 2532437, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/92a8d1c768c39236e7a96a9620c59ac8?s=128&d=identicon&r=PG", "display_name": "Ben Key", "link": "https://stackoverflow.com/users/2532437/ben-key"}, "is_accepted": false, "score": 0, "last_activity_date": 1431544735, "creation_date": 1431544735, "answer_id": 30223498, "question_id": 30222608, "link": "https://stackoverflow.com/questions/30222608/c-noexcept-for-a-function-not-throwing-exceptions-but-can-cause-a-memory-fail/30223498#30223498", "title": "C++ noexcept for a function not throwing exceptions, but can cause a memory failure", "body": "<p>One option is to add bounds checking and cause an out of range value to do something meaningful, such as return last as in the following.</p>\n\n<pre><code>T&amp; operator[](size_t i)\n{\n    static T default;\n    if (i &gt;= length &amp;&amp; length &gt; 0)\n    {\n        return v[length - 1];\n    }\n    else if (i &gt;= length &amp;&amp; length == 0)\n    {\n        return default;\n    }\n    return v[i];\n}\n</code></pre>\n\n<p>This is non standard but is, in my opinion, acceptable if you clearly document the behavior. This allows for a no exception and no signal guarantee.</p>\n"}, {"comments": [{"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1431552431, "post_id": 30225086, "comment_id": 48554846, "body": "Yes. I agree with that quotes. But in the other side, if I don&#39;t declare these non-throwig function as <code>noexcept</code>, I don&#39;t allow the compiler to apply its optimizations for noexcept functions. So, perhaps there should be two keywords, noexcept and nofail (with a semantic in such a way the later implies the former; but the opposite is not true)."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1431615854, "post_id": 30225086, "comment_id": 48582802, "body": "@Peregring-lk I updated my answer with the proposal that covers the standard library practice which I find helpful in thinking about this. I would also see this <a href=\"https://akrzemi1.wordpress.com/2011/06/10/using-noexcept/\" rel=\"nofollow noreferrer\">article as well</a> it is old but detailed."}], "tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 5, "last_activity_date": 1479721417, "last_edit_date": 1479721417, "creation_date": 1431550806, "answer_id": 30225086, "question_id": 30222608, "link": "https://stackoverflow.com/questions/30222608/c-noexcept-for-a-function-not-throwing-exceptions-but-can-cause-a-memory-fail/30225086#30225086", "title": "C++ noexcept for a function not throwing exceptions, but can cause a memory failure", "body": "<p>This is a tough question and brings up some of the key issues covered in <a href=\"https://akrzemi1.wordpress.com/2014/04/24/noexcept-what-for/\" rel=\"nofollow noreferrer\">noexcept \u2014 what for? from \nAndrzej's C++ blog </a> which says, I will attempt to quote the minimum here (<em>emphasis mine</em>):</p>\n\n<blockquote>\n  <p>In this post I would like to share my observation on where using noexcept really adds value. It is less often than what one might expect, and <strong>it does not have that much to do with throwing or not throwing exceptions. The conclusion surprises me a bit</strong>, and I hesitate to present it because it is counter to the advice I hear from people I consider authorities on the subject. </p>\n</blockquote>\n\n<p>and:</p>\n\n<blockquote>\n  <p>Given this negative attitude to noexcept, can it be considered useful at all? Yes. The <strong>noexcept feature was introduced very late into C++11 to address one particular issue with move semantics</strong>. It has been described here by Douglas Gregor and David Abrahams. </p>\n</blockquote>\n\n<p>and then he goes on to given an unusual move assignment definition and argues that what we really want to convey is not that it does not throw exceptions but that it does not fail, but that is very difficult problem but it is out real intent:</p>\n\n<blockquote>\n  <p>[...]This is because the information that noexcept really is intended to\n  convey is that the function never fails; not that it never throws! We\n  can see above that a function can fail but still not throw, but it\n  still qualifies for noexcept(false). Perhaps the keyword should have\n  been called nofail. The never-fail guarantee cannot be checked by the\n  compiler (much like any other failure-safety guarantee), therefore the\n  only thing we can do is to declare it.</p>\n  \n  <p>This is part of a more general observation, that what we are\n  interested in is really failure safety in program components rather\n  than exception safety. No matter if you use exceptions, error return\n  values, errno or what</p>\n  \n  <p>ever else, the reasoning about basic (no leak, invariant preserved), strong (commit or rollback) and never-fail guarantee should still hold.</p>\n</blockquote>\n\n<p>So if we take a similar position then, it would seem the answer is no, if not appropriate to use <code>noexcept</code> and that seems to be where you are leaning. I don't think it is clear cut answer. </p>\n\n<p>He also notes <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3248.pdf\" rel=\"nofollow noreferrer\">proposal N3248: noexcept\nPrevents Library Validation</a>. Which in turn was the basis for <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3279.pdf\" rel=\"nofollow noreferrer\">N3279: Conservative use of noexcept in the Library</a>. This paper defines narrow and wide contracts as did N3248:</p>\n\n<blockquote>\n  <p><strong>Wide Contracts</strong></p>\n  \n  <p>A wide contract for a function or operation does not\n  specify any undefined behavior. Such a contract has no preconditions:\n  A function with a wide contract places no additional runtime\n  constraints on its arguments, on any object state, nor on any external\n  global state. Examples of functions having wide contracts would be\n  vector::begin() and vector::at(size_type) . Examples of\n  functions not having a wide contract would be vector::front() and\n  vector::operator[](size_type) .</p>\n  \n  <p><strong>Narrow Contracts</strong></p>\n  \n  <p>A narrow contract is a contract which is not wide. Narrow contracts for a \n  functions or operations result in undefined behavior when called in a\n  manner that violates the documented contract. Such a contract\n  specifies at least one precondition involving its arguments, object\n  state, or some external global state, such as the initialization of a \n  static object. Good examples of standard functions with narrow\n  contracts are vector::front() and vector::operator[](size_type)\n  .</p>\n</blockquote>\n\n<p>and recommends:</p>\n\n<blockquote>\n  <p>Each library function having a wide contract, that the LWG agree\n  cannot throw, should be marked as unconditionally noexcept.</p>\n</blockquote>\n\n<p>and implies that functions with narrow contracts should not be <code>noexcept</code>, which is backed up by <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-active.html#2337\" rel=\"nofollow noreferrer\">LWG issue 2337</a> which says:</p>\n\n<blockquote>\n  <p>[...]These design considerations override our general policy against noexcept for narrow-contract functions. [...]</p>\n</blockquote>\n\n<p>So if we want to be conservative and follow standard library practice then it would seem since <code>operator[]</code> does not have a wide contract it should not be marked <code>noexcept</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 90, "user_id": 4848077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e45f6834d8652cd3c89d0b6a352aed7?s=128&d=identicon&r=PG&f=1", "display_name": "Violeta Marin", "link": "https://stackoverflow.com/users/4848077/violeta-marin"}, "is_accepted": false, "score": 1, "last_activity_date": 1431553743, "last_edit_date": 1431553743, "creation_date": 1431553353, "answer_id": 30225676, "question_id": 30222608, "link": "https://stackoverflow.com/questions/30222608/c-noexcept-for-a-function-not-throwing-exceptions-but-can-cause-a-memory-fail/30225676#30225676", "title": "C++ noexcept for a function not throwing exceptions, but can cause a memory failure", "body": "<p>The fact: either you use <strong>noexcept</strong> or not, the function can still throw <strong>SIGSEGV</strong>.</p>\n\n<p>Now, I think the answer is subjective and depends on one's personal perspective. What would you expect from a <strong>noexcept</strong> function? Would you expect that it never fails (even if <strong>noexcept</strong> does not offer such guarantee)? How will you handle a <em>non-safe</em> function in comparison with a \"<em>safe</em>\" function? Will it be a big difference in the project? If your answer is yes, than you perhaps should not use <strong>noexcept</strong>.</p>\n\n<p>On the other hand, by not using it (when you know for certain it cannot throw exceptions) would make another programmer worry about providing a try-clause when calling this function.</p>\n\n<p>From <em>Bjarne Stroustroup</em> \"<em>The C++ Programming Language</em>\", 4th edition:</p>\n\n<blockquote>\n  <p>Declaring a function noexcept can be most valuable for a programmer\n  reasoning about a program and for a compiler optimizing a program. The\n  programmer need not worry about providing try-clauses (for dealing\n  with failures in a noexcept function) and an optimizer need not worry\n  about control paths from exception handling.</p>\n  \n  <p>So, is it inappropiate to mark <strong>noexcept</strong> a function which isn't\n  safe?</p>\n</blockquote>\n\n<p>My personal point of view is No, it is not bad practice or \"immoral\" to use it, all the more so as it can have some benefits. </p>\n"}], "owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 3, "accepted_answer_id": 30225086, "answer_count": 3, "score": 13, "last_activity_date": 1479721417, "creation_date": 1431541678, "last_edit_date": 1431542678, "question_id": 30222608, "link": "https://stackoverflow.com/questions/30222608/c-noexcept-for-a-function-not-throwing-exceptions-but-can-cause-a-memory-fail", "title": "C++ noexcept for a function not throwing exceptions, but can cause a memory failure", "body": "<p>For example, it's pretty common to have two separate ways to access elements of a private array, overloading the array subscripting operator, or defining <code>at</code>:</p>\n\n<pre><code>T&amp; operator[](size_t i) { return v[i]; }\nT const&amp; operator[](size_t i) const { return v[i]; }\n\nT&amp; at(size_t i)\n{\n     if (i &gt;= length)\n         throw out_of_range(\"You shall not pass!\");\n\n     return v[i];\n}\n\nT const&amp; at(size_t i) const\n{\n     if (i &gt;= length)\n         throw out_of_range(\"You shall not pass!\");\n\n     return v[i];\n}\n</code></pre>\n\n<p>The <code>at</code> version can throw an exception, but the array subscripting operator can't.</p>\n\n<p>My question is, altough the <code>operator[]</code> doesn't throw an exception, can it be marked as <code>noexcept</code> even knowing it can raise a SIGSEGV signal, or is it only a bad practice?</p>\n\n<p>I want to point out a signal (as SIGSEGV) is not an exception. Being literal interpreting the <code>noexcept</code> meaning, a <code>noexcept</code> function is one that claims it won't throw exceptions. It says nothing about anything else (including signals).</p>\n\n<p>But, a <code>noexcept</code> function has more meaning than that, at least for clientes of my code. <code>noexcept</code> also implicitly says the function is safe and it will finish its execution without computational errors.</p>\n\n<p>So, is it inappropiate to mark <code>noexcept</code> a function which isn't safe?</p>\n"}, {"tags": ["c++", "debugging", "gdb", "64-bit"], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1431567898, "creation_date": 1431567898, "answer_id": 30227971, "question_id": 30222558, "link": "https://stackoverflow.com/questions/30222558/gdb-not-seeing-correct-function-argument-values-even-though-they-are-set/30227971#30227971", "title": "GDB not seeing correct function argument values even though they are set", "body": "<p>This is either a bug in your GCC (which version are you using?) or a bug in GDB.</p>\n\n<p>Since you are apparently running an <em>old</em> CVS snapshot of GDB, I suggest first trying a <em>stable</em> GDB release instead.</p>\n"}], "owner": {"reputation": 493, "user_id": 744011, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0cc5f24a9608c371bc699cb552a8141e?s=128&d=identicon&r=PG", "display_name": "Jason Rohrer", "link": "https://stackoverflow.com/users/744011/jason-rohrer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431567898, "creation_date": 1431541531, "question_id": 30222558, "link": "https://stackoverflow.com/questions/30222558/gdb-not-seeing-correct-function-argument-values-even-though-they-are-set", "title": "GDB not seeing correct function argument values even though they are set", "body": "<p>First time trying to debug on a quad-core Xeon after 15 years of successful x86 GDB use.</p>\n\n<p>Linux DellT3500 3.16.0-23-generic #31-Ubuntu SMP Tue Oct 21 17:56:17 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</p>\n\n<p>GNU gdb (Ubuntu 7.8-1ubuntu4) 7.8.0.20141001-cvs</p>\n\n<p>g++ compiler flags:</p>\n\n<pre><code>-Wall -Wwrite-strings -Wchar-subscripts -Wparentheses -gstabs+ -DLINUX  -O0\n</code></pre>\n\n<p>Setting a breakpoint in a certain class member function shows <strong>this=0x0</strong> and the other parameter incorrectly when the breakpoint happens.  But inserting a <strong>printf</strong> in the code right after that shows that <strong>this</strong> and the parameter are actually set correctly:</p>\n\n<pre><code>Breakpoint 1, PlayGamePage::actionPerformed (this=0x0, inTarget=0x7fffffffdf90)\n    at PlayGamePage.cpp:725\n725     printf( \"hey, this = %x, inTarget = %x\\n\", this );\n(gdb) next\nhey, this = b6cc50, inTarget = b6ce18\n727   if( inTarget == &amp;mCommitButton &amp;&amp;\n(gdb) print this\n$1 = (PlayGamePage * const) 0x0\n(gdb) print inTarget\n$2 = (GUIComponent *) 0x7fffffffdf90\n(gdb)\n</code></pre>\n\n<p>But you can see how GDB can't even print these values correctly, even though they are set and printable by the code with <strong>printf</strong>.  This is is a big problem, because GDB has no access to printing member variables.</p>\n\n<p>Also, the rest of the function body uses <strong>this</strong> extensively and inTarget extensively (accessing class members and testing inTarget), and the code functions as expected.  No crashes or misbehavior, so this is set correctly in the code, but GDB can't see it.</p>\n\n<p>Going up the stack:</p>\n\n<pre><code>(gdb) up\n#1  0x000000000040a11f in ActionListenerList::fireActionPerformed (\n    this=0xb6cf98, inTarget=0xb6cf48)\n    at ../../minorGems/ui/event/ActionListenerList.h:134\n134         listener-&gt;actionPerformed( inTarget );\n</code></pre>\n\n<p>See that <strong>inTarget</strong> matches what <strong>printf</strong> sees down in the <strong>actionPerformed</strong> function body.  Also, gdb can print these values fine at this point:</p>\n\n<pre><code>(gdb) print inTarget\n$5 = (GUIComponent *) 0xb6cf48\n(gdb) print listener\n$6 = (ActionListener *) 0xb6ce18\n</code></pre>\n\n<p><strong>listener</strong> should match <strong>this</strong> down in the function body, and it does according to printf, but gdb sees <strong>this=0x0</strong> instead.</p>\n\n<p>Yes, this is a virtual function that is being called (PlayGamePage implements the ActionListener interface, overriding the actionPerformed virtual function).</p>\n\n<p>I just placed a breakpoint in exactly the same code in GDB on 32-bit x86, and it sees both this and inTarget correctly and can print them correctly, with values matching what the code's printf shows.</p>\n"}, {"tags": ["c++", "c++11", "comments"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 3, "creation_date": 1431541390, "post_id": 30222509, "comment_id": 48548838, "body": "Might be for some documentation generating tool like doxygen, but I haven&#39;t seen this particular notation before"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431541534, "post_id": 30222509, "comment_id": 48548916, "body": "Could be a code standard that whoever produced the application uses."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1431541563, "post_id": 30222509, "comment_id": 48548932, "body": "As far as C++ is concerned, they&#39;re simply comments; the content is irrelevant. Some external tool probably processes them."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 1, "creation_date": 1431543474, "post_id": 30222509, "comment_id": 48550053, "body": "Probably related to Doxygen or similar. It treats either <code>&#47;&#47;&#47;</code> or <code>&#47;&#47;!</code> as a special comment from which it extracts documentation."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1431541561, "creation_date": 1431541561, "answer_id": 30222567, "question_id": 30222509, "link": "https://stackoverflow.com/questions/30222509/what-is-the-meaning-of/30222567#30222567", "title": "What is the meaning of &quot;//! [#]&quot;", "body": "<p>No, the compiler does not process <code>//! [3]</code> in a meaningful way.  It ignores it (well, that and everything until the end of the line).</p>\n\n<p>Maybe it was generated by some tool.  Maybe the developer used it to jump from the start to the end of some block easily.  Maybe the developer was very excited about numbers in square brackets.</p>\n\n<p>I'd ask the developer who wrote that code.</p>\n"}], "owner": {"reputation": 21716, "user_id": 2401769, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wkEbw.jpg?s=128&g=1", "display_name": "Matias Cicero", "link": "https://stackoverflow.com/users/2401769/matias-cicero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "closed_date": 1431546323, "answer_count": 1, "score": -2, "last_activity_date": 1431541561, "creation_date": 1431541335, "question_id": 30222509, "link": "https://stackoverflow.com/questions/30222509/what-is-the-meaning-of", "closed_reason": "Duplicate", "title": "What is the meaning of &quot;//! [#]&quot;", "body": "<p>I was inspecting some application's source code and I found this:</p>\n\n<pre><code>//! [1]\n\n... some code ...\n\n//! [1]\n\n//! [2]\n\n... some code ....\n\n//! [2]\n\n//! [3]\n\n... some more code ...\n\n//! [3]\n</code></pre>\n\n<p>What is the meaning of these comments?\nIt appears to me they were wrotten just to split the code in \"<em>sections</em>\", much like the <code>#region</code> and <code>#endregion</code> in C#.</p>\n\n<p>But do they have an inner meaning besides that?\nAre these comments processed by the compiler?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1431540933, "post_id": 30222340, "comment_id": 48548563, "body": "basically, <b>don&#39;t use <code>operator&gt;&gt;</code>.</b> It&#39;s clumsy, it&#39;s quirky, it&#39;s hard to use correctly. Use <code>std::getline()</code> instead."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1431541185, "post_id": 30222340, "comment_id": 48548716, "body": "@TheParamagneticCroissant: It&#39;s not really all that difficult to use correctly--in fact, using it correctly is pretty much identical to using <code>std::getline</code> correctly. In both cases, you want to do it inside a condition, such as <code>while (std::cin &gt;&gt; num)</code> or <code>while (std::getline(infile, buffer))</code>."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1431541630, "post_id": 30222340, "comment_id": 48548976, "body": "@JerryCoffin that&#39;s not the problem here (OP is fortunately not using the oh-so-frequent <code>while(!eof)</code> anti-pattern). The problem is that the behavior of <code>&gt;&gt;</code> is dependent on the particular overload, the semantics of each overload differing subtly, and who can keep all the overloads in their mind? (not to mention the sloppy automatic &quot;helpful&quot; handling of whitespace that just gets in the way.) \u2013 <code>getline()</code> has easy-to-remember, uniform semantics, it does only one thing and does it well. In particular, it does not attempt to <i>parse</i> the input (which <code>operator&gt;&gt;</code> tries, and boy does it fail.)"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1431542010, "post_id": 30222340, "comment_id": 48549195, "body": "@TheParamagneticCroissant: It sort of is the problem (or at least one of the problems) though. It goes into an infinite loop because it doesn&#39;t detect that its last attempt at parsing input failed, so it just keeps re-trying. A <code>while (std:cin &gt;&gt; num)</code> would at least detect that the attempt at reading had failed and quit trying."}, {"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1431543431, "post_id": 30222340, "comment_id": 48550022, "body": "@JerryCoffin yes, that&#39;s correct."}, {"owner": {"reputation": 69, "user_id": 2914216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3cade43b5769a8070c0aa8ad7d3045c?s=128&d=identicon&r=PG&f=1", "display_name": "mrAnderson", "link": "https://stackoverflow.com/users/2914216/mranderson"}, "reply_to_user": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1431551233, "post_id": 30222340, "comment_id": 48554218, "body": "@JerryCoffin I still dont understand why it goes into infinite loop, after cin fails. How cin gets filled with 0 everytime after that?"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 2, "creation_date": 1431555338, "post_id": 30222340, "comment_id": 48556139, "body": "The non-numeric characters you entered were put into an input buffer. Each time through the loop, <code>cin</code> attempts to interpret those characters as a number, but can&#39;t. Since you&#39;re not doing anything to remove them from the buffer, it repeatedly attempts to read those same characters as a number, failing every time. You need to get them out of the buffer, then get more input from the user. You can do that by reading an entire line with <code>std::getline</code>, then trying to convert its contents to a number, and if it fails, read another line (exactly as @TheParamagneticCroissant advised above)."}], "owner": {"reputation": 69, "user_id": 2914216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3cade43b5769a8070c0aa8ad7d3045c?s=128&d=identicon&r=PG&f=1", "display_name": "mrAnderson", "link": "https://stackoverflow.com/users/2914216/mranderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1431541200, "answer_count": 0, "score": 0, "last_activity_date": 1431613076, "creation_date": 1431540714, "last_edit_date": 1431613076, "question_id": 30222340, "link": "https://stackoverflow.com/questions/30222340/c-cin-input-in-a-while-loop-gives-weird-behavior-when-a-char-is-input-instead", "closed_reason": "Duplicate", "title": "c++ cin input in a while loop, gives weird behavior when a char is input instead of int", "body": "<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nint main()\n{\n  int num;\n  while(1){\n    cin&gt;&gt;num;\n    cout&lt;&lt;num&lt;&lt;endl;\n  }\n  return 0;\n}\n</code></pre>\n\n<p>When I try to run this code, it outputs value of 'num' everytime I input an int. But when I type a string or char for input,it stops asking for input from the next iteration and starts outputting 0 in an infinite loop.\nCan anyone explain reason behind this?</p>\n"}, {"tags": ["c++", "while-loop"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 3, "creation_date": 1431540571, "post_id": 30222287, "comment_id": 48548368, "body": "instead of setting a flag to true, you can just <code>break;</code> outside of the loop."}], "answers": [{"tags": [], "owner": {"reputation": 1498, "user_id": 2797746, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/TaPVN.jpg?s=128&g=1", "display_name": "Alexandre Severino", "link": "https://stackoverflow.com/users/2797746/alexandre-severino"}, "is_accepted": true, "score": 3, "last_activity_date": 1431540985, "last_edit_date": 1431540985, "creation_date": 1431540721, "answer_id": 30222342, "question_id": 30222287, "link": "https://stackoverflow.com/questions/30222287/implementing-retry-in-while-loop/30222342#30222342", "title": "implementing retry in while loop", "body": "<p>Just like @Borgleader pointed out, the <code>flag</code> variable is unnecessary. You can stick with a <code>break</code> instruction and check after the loop if the count is still bigger than zero. If so, means your task succeeded.</p>\n\n<pre><code>unsigned int count = 5;\nwhile(count &gt; 0) {\n    DataOperation opt = DataUser::Insert(data_point);\n    if(opt == DataOperation::DataEnum) {\n        UserPointData exist = DataUser::FindUser(data_point-&gt;user_id());\n        if(exist) {\n           exist-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n            break; // success.\n        }\n    } else {\n        // insert in data_point\n        data_point-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n        break; // success.\n    }\n    count--;\n}\n\nif (count &gt; 0) { /* succeeded within 5 tries. */ }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40610, "user_id": 67566, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/9d0Vk.jpg?s=128&g=1", "display_name": "James Black", "link": "https://stackoverflow.com/users/67566/james-black"}, "is_accepted": false, "score": 1, "last_activity_date": 1431540939, "last_edit_date": 1431540939, "creation_date": 1431540835, "answer_id": 30222372, "question_id": 30222287, "link": "https://stackoverflow.com/questions/30222287/implementing-retry-in-while-loop/30222372#30222372", "title": "implementing retry in while loop", "body": "<p>The only change I would make is </p>\n\n<pre><code>if(opt == DataOperation::DataEnum) {\n    UserPointData exist = DataUser::FindUser(data_point-&gt;user_id());\n    if(exist) {\n       exist-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n        flag = true;\n    } else {\n      count--;\n    }\n</code></pre>\n\n<p>I am not crazy about you setting count to 5 then counting down, as it is more obvious if you increment until you reach 5, but this will work.</p>\n\n<p>You may want to <code>break</code> instead of setting flag, unless you are planning on using flag to differentiate between finding a match or exiting due to the conditional.</p>\n"}, {"tags": [], "owner": {"reputation": 3200, "user_id": 1038709, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/beb90c989dab16915affaec83961931e?s=128&d=identicon&r=PG", "display_name": "Se&#231;kin Sava\u015f&#231;\u0131", "link": "https://stackoverflow.com/users/1038709/se%c3%a7kin-sava%c5%9f%c3%a7%c4%b1"}, "is_accepted": false, "score": 2, "last_activity_date": 1431541549, "creation_date": 1431541549, "answer_id": 30222562, "question_id": 30222287, "link": "https://stackoverflow.com/questions/30222287/implementing-retry-in-while-loop/30222562#30222562", "title": "implementing retry in while loop", "body": "<p>If you will use <code>count</code> variable only for that purpose, I suggest you to use a for loop so <code>count</code> will not be visible and memory of it will be reclaimed after exiting the scope of the loop. And use <code>break</code> statement to immediately exit the loop.</p>\n\n<pre><code>for(auto count = 0; count&lt;5; ++count) {\n    DataOperation opt = DataUser::Insert(data_point);\n    if(opt == DataOperation::DataEnum) {\n        UserPointData exist = DataUser::FindUser(data_point-&gt;user_id());\n        if(exist) {\n           exist-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n            break;\n        }\n    } else {\n        // insert in data_point\n        data_point-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n        break;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "is_accepted": false, "score": 3, "last_activity_date": 1431541643, "creation_date": 1431541643, "answer_id": 30222593, "question_id": 30222287, "link": "https://stackoverflow.com/questions/30222287/implementing-retry-in-while-loop/30222593#30222593", "title": "implementing retry in while loop", "body": "<p>What you are doing seems fine but possibly more complicated than it needs to be.</p>\n\n<p>For example you don't need to set a flag to exit you can simply call <code>break;</code>.</p>\n\n<p>Here is a pattern I sometimes use that maybe simpler:</p>\n\n<pre><code>bool succeed_at_doing_stuff()\n{\n    std::cout &lt;&lt; \"trying\" &lt;&lt; '\\n';\n    return false;\n}\n\nint main()\n{\n    int retries = 3;\n\n    while(retries--) // will exit when retries == 0, retries then becomes -1\n    {\n        if(succeed_at_doing_stuff())\n            break; // no need to set a flag\n\n        // take alternative action\n    }\n\n    if(retries &lt; 0) // retries was decremented after last check\n    {\n        std::cerr &lt;&lt; \"error: gave up - too many retries\" &lt;&lt; std::endl;\n        return 1;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9423, "user_id": 2809564, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9dbbaaa9c03d7a256eef869bf1d635e3?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/2809564/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3802, "favorite_count": 0, "accepted_answer_id": 30222342, "answer_count": 4, "score": 0, "last_activity_date": 1431541643, "creation_date": 1431540512, "last_edit_date": 1431540813, "question_id": 30222287, "link": "https://stackoverflow.com/questions/30222287/implementing-retry-in-while-loop", "title": "implementing retry in while loop", "body": "<p>I am trying to implement a retry in the while loop. I want to retry 5 times and if the flag becomes true.</p>\n\n<pre><code>bool flag = false;\nunsigned int count = 5;\nwhile(!flag &amp;&amp; count &gt; 0) {\n    DataOperation opt = DataUser::Insert(data_point);\n    if(opt == DataOperation::DataEnum) {\n        UserPointData exist = DataUser::FindUser(data_point-&gt;user_id());\n        if(exist) {\n           exist-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n            flag = true;\n        }\n    } else {\n        // insert in data_point\n        data_point-&gt;attributeData.put(key, value, len_value, client_id, last_modified_date);\n        flag = true;\n    }\n    count--;\n}\n</code></pre>\n\n<ul>\n<li>So if flag becomes true, then I will exit out of the loop </li>\n<li>Second case, if flag is false for 5 times, then I will exit out of the loop as well.</li>\n</ul>\n\n<p>Does this look right what I am doing?</p>\n"}, {"tags": ["c++", "ios", "objective-c", "istream"], "comments": [{"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 4, "creation_date": 1431540048, "post_id": 30222138, "comment_id": 48548094, "body": "well for one you shouldnt use <code>eof()</code>: <a href=\"http://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong\" title=\"why is iostreameof inside a loop condition considered wrong\">stackoverflow.com/questions/5605125/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5432, "user_id": 267386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27db5b6e20d2fd32e295d3e09a946f8f?s=128&d=identicon&r=PG", "display_name": "rooster117", "link": "https://stackoverflow.com/users/267386/rooster117"}, "edited": false, "score": 0, "creation_date": 1431547935, "post_id": 30222369, "comment_id": 48552537, "body": "Thank you, I realize now that i wasn&#39;t zeroing the buffer. My issue still remains though and I realize my question didn&#39;t explain it enough. I&#39;ll try to come up with a minimized version of the code to make it readable"}, {"owner": {"reputation": 5432, "user_id": 267386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27db5b6e20d2fd32e295d3e09a946f8f?s=128&d=identicon&r=PG", "display_name": "rooster117", "link": "https://stackoverflow.com/users/267386/rooster117"}, "edited": false, "score": 1, "creation_date": 1431554827, "post_id": 30222369, "comment_id": 48555903, "body": "My question was not the problem. I think I finally got to the bottom of it and I was passing in a vector of ifstreams to a method expecting istreams and I believe it was not closing correctly when I was trying to close the files eventually causing some limit to be reached. It was a weird error."}, {"owner": {"reputation": 5432, "user_id": 267386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27db5b6e20d2fd32e295d3e09a946f8f?s=128&d=identicon&r=PG", "display_name": "rooster117", "link": "https://stackoverflow.com/users/267386/rooster117"}, "edited": false, "score": 0, "creation_date": 1431555049, "post_id": 30222369, "comment_id": 48556010, "body": "Thank you for all of your help. It gave me some clues to find the root of the issue."}], "tags": [], "owner": {"reputation": 267, "user_id": 1738864, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100001675888510/picture?type=large", "display_name": "Alexandru Nedelcu", "link": "https://stackoverflow.com/users/1738864/alexandru-nedelcu"}, "is_accepted": true, "score": 3, "last_activity_date": 1431540819, "creation_date": 1431540819, "answer_id": 30222369, "question_id": 30222138, "link": "https://stackoverflow.com/questions/30222138/count-eventually-0-even-though-read-successful/30222369#30222369", "title": "count eventually 0 even though read successful", "body": "<p>I think I need more code to  be able to give a  better  answer, but from  your code, I can tell  you where I'd first look:</p>\n\n<blockquote>\n  <p>istream::gcount returns the number of characters extracted by the last unformatted\n  input operation performed on the object.</p>\n</blockquote>\n\n<p>This means that when the end of the file is reached, gcount will return 0, because the last reading operation was't able to read any new data.</p>\n\n<p>Now, it  is normal to  have  some  random  bits in the  buffer,  since the  space was allocated, but  you never zeroed the buffer. Therefore, the  buffer will  contain some random bits from  the  memory  where it  was randomly  allocated.  In order  to  avoid confusion, you can add a statement that will clear any garbage that the buffer initially has,  by adding this statement,  right after its allocation:</p>\n\n<pre><code>memset(buffer, 0, sizeof(buffer));\n</code></pre>\n\n<p>In other words, when your gcount returns 0, it means that there was no new bit of data read from iStreams[i].</p>\n\n<p>I hope this helps!</p>\n\n<p>-- Alex</p>\n"}], "owner": {"reputation": 5432, "user_id": 267386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27db5b6e20d2fd32e295d3e09a946f8f?s=128&d=identicon&r=PG", "display_name": "rooster117", "link": "https://stackoverflow.com/users/267386/rooster117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 30222369, "answer_count": 1, "score": 0, "last_activity_date": 1431540819, "creation_date": 1431539969, "question_id": 30222138, "link": "https://stackoverflow.com/questions/30222138/count-eventually-0-even-though-read-successful", "title": "count eventually 0 even though read successful", "body": "<p>I am writing an iOS app which uses a piece of c++ code which is reading pieces of data from a file using istream. The code works but its used repeatedly and it eventually hits a limit of reads and then something goes wrong. It appears to read in successfully but gcount returns 0. This is not specific to a certain file or case because after the app is restarted everything will pick up from where it left off and fail once the limit is hit again. It feels like there is some istream session that gets into a bad state that I can't get out of. I am closing the files I open.</p>\n\n<p>This is how I open the streams</p>\n\n<pre><code>iFiles.push_back(new ifstream([[[arrayOfPaths objectAtIndex:i] absoluteString] cStringUsingEncoding:NSASCIIStringEncoding] , ios::in | ios::binary));\n</code></pre>\n\n<p>Then I have a loop where I read in pieces of this file:</p>\n\n<pre><code>while (!iStreams[0]-&gt;eof())\n{\n    vector&lt;vector&lt;int64_t&gt; &gt; matrix;\n    int length = 0;\n    for (int i = 0; i &lt; rows; i++)\n    {\n        char * buffer = new char [DEMUX_BUFFER];\n\n        iStreams[i]-&gt;read(buffer, DEMUX_BUFFER);\n\n        int int64Groups;\n\n        if(iStreams[i]-&gt;gcount() == 0)\n        {\n            //this is the catch for the bad case but buffer contains something even though count is 0\n        }\n        .....\n</code></pre>\n\n<p>This is a hard question to ask so please let me know if you need more information. I am hopping someone out there has had a similar issue. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "windows", "com", "wmi", "wbem"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431542403, "post_id": 30221837, "comment_id": 48549396, "body": "<code>&quot;ROOT\\CIMV2&quot;</code> needs to be <code>&quot;ROOT\\\\CIMV2&quot;</code>.  And where is your error checking on any of the COM calls? And how are you populating <code>vtProductKey</code>? Please provide a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 78, "user_id": 3140390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3551a0c38b235a6d196223088790849?s=128&d=identicon&r=PG&f=1", "display_name": "banal", "link": "https://stackoverflow.com/users/3140390/banal"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431542568, "post_id": 30221837, "comment_id": 48549505, "body": "@Remy - That is a typo. Assume that this is working code with error checking and successfully invokes other wmi methods. I will fix the string in question."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431542643, "post_id": 30221837, "comment_id": 48549548, "body": "please don&#39;t make people assume. Please provide the &quot;actual&quot; code, not &quot;simplified&quot; code."}, {"owner": {"reputation": 78, "user_id": 3140390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3551a0c38b235a6d196223088790849?s=128&d=identicon&r=PG&f=1", "display_name": "banal", "link": "https://stackoverflow.com/users/3140390/banal"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431542800, "post_id": 30221837, "comment_id": 48549637, "body": "@Remy Apologies, posting actual code will violate company policy. Thanks."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431544917, "post_id": 30221837, "comment_id": 48550927, "body": "Hence the need for a MCVE that reproduces the same problem. Nothing in this code example is proprietary, though, other than the value of <code>vtProductKey</code>."}, {"owner": {"reputation": 78, "user_id": 3140390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3551a0c38b235a6d196223088790849?s=128&d=identicon&r=PG&f=1", "display_name": "banal", "link": "https://stackoverflow.com/users/3140390/banal"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431550865, "post_id": 30221837, "comment_id": 48554006, "body": "@Remy - legal considerations also cover code not just inputs to code that could be sensitive. In any case I have put in a sanitized mcve into my question."}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 1170447, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/ab7770d11c40e4e78ac2edc30d6ce111?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1170447/alex"}, "edited": false, "score": 0, "creation_date": 1536818564, "post_id": 30340647, "comment_id": 91562159, "body": "Have the same problem I guess. I didn&#39;t get what this means &quot;The method call was being made on the class not the instance&quot;. Can you tell what to change in the original code you posted to make it work?"}], "tags": [], "owner": {"reputation": 78, "user_id": 3140390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3551a0c38b235a6d196223088790849?s=128&d=identicon&r=PG&f=1", "display_name": "banal", "link": "https://stackoverflow.com/users/3140390/banal"}, "is_accepted": false, "score": 1, "last_activity_date": 1432098235, "creation_date": 1432098235, "answer_id": 30340647, "question_id": 30221837, "link": "https://stackoverflow.com/questions/30221837/error-wbem-e-invalid-method-parameters-from-execmethod/30340647#30340647", "title": "Error WBEM_E_INVALID_METHOD_PARAMETERS from ExecMethod", "body": "<p>I have since figured what the issue was. The method call was being made on the class not the instance.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11978488, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCZp_17FTrv08z78EE97275S6Zwi0DNwj2jJMDErw=k-s128", "display_name": "anjlairaj", "link": "https://stackoverflow.com/users/11978488/anjlairaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1580726034, "creation_date": 1580726034, "answer_id": 60037428, "question_id": 30221837, "link": "https://stackoverflow.com/questions/30221837/error-wbem-e-invalid-method-parameters-from-execmethod/60037428#60037428", "title": "Error WBEM_E_INVALID_METHOD_PARAMETERS from ExecMethod", "body": "<p>This code will work properly:</p>\n\n<pre><code> IEnumWbemClassObject * enum_obj;\n    hres = pSvc&gt;CreateInstanceEnum(_bstr_t(L\"SoftwareLicensingService\"),WBEM_FLAG_RETURN_IMMEDIATELY , NULL ,&amp;enum_obj);\n\n\n   IWbemClassObject * spInstance;\n   ULONG uNumOfInstances = 0;\n   hres = enum_obj-&gt;Next(10000, 1,&amp;spInstance,&amp;uNumOfInstances);\n\n   VARIANT path;\n   hres = spInstance-&gt;Get(_bstr_t(\"__Path\"), 0,&amp;path, 0, 0);\n\n   IWbemClassObject *results = NULL;\n   hres = pSvc-&gt;ExecMethod( path.bstrVal, _bstr_t( L\"InstallProductKey\" ), 0,\n   NULL,NULL,&amp;results, NULL );\n</code></pre>\n\n<p>This code is not only for this class and method.Generally for any class you can get the  objectPath(1st parameter of ExecMethod()) and use it.This code mentioned is for Calling a method without parameters.</p>\n\n<p>The code for  method calling with parameters is available <a href=\"https://docs.microsoft.com/en-us/windows/win32/wmisdk/example--calling-a-provider-method\" rel=\"nofollow noreferrer\">here</a>.In some cases, calling ExecMethod with input parameters for a method returns WBEM_E_INVALID_METHOD_PARAMETERS error. In that case you can get the object path first and then call GetObejct and GetMethod functions.</p>\n"}], "owner": {"reputation": 78, "user_id": 3140390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3551a0c38b235a6d196223088790849?s=128&d=identicon&r=PG&f=1", "display_name": "banal", "link": "https://stackoverflow.com/users/3140390/banal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1580726034, "creation_date": 1431538968, "last_edit_date": 1431551656, "question_id": 30221837, "link": "https://stackoverflow.com/questions/30221837/error-wbem-e-invalid-method-parameters-from-execmethod", "title": "Error WBEM_E_INVALID_METHOD_PARAMETERS from ExecMethod", "body": "<p>I am attempting to use <em>SoftwareLicensingService::InstallProductKey</em> to install a product key on Windows 7 through WMI/C++ in a Service. However every time I attempt to call the method via <em>IWbemServices::ExecMethod</em> I get <em>0x8004102f</em> which is <em>WBEM_E_INVALID_METHOD_PARAMETERS</em>. I thought this was something to do with the product key I am passing, but I have since then tried similar code for <em>Win32_WindowsProductActivation::ActivateOnline</em> [which is a no parameter method available on XP] with the same error. Does anyone know what is suspect in my code fragment below (I have skipped some cleanup code to be brief) ? The same sequence of code successfully invokes other WMI methods however.</p>\n\n<pre><code>int _tmain(int argc, _TCHAR* argv[])\n{\n    HRESULT hr = S_OK;\n    IWbemLocator *pLoc = NULL;\n    IWbemServices *pServices = NULL;\n    IWbemClassObject *pInputParamsClass = NULL;\n    IWbemClassObject *pInputParams = NULL;\n    IWbemClassObject *pOutputParams = NULL;\n    IWbemClassObject *pLicensingClsObj = NULL;\n    VARIANT vtProductKey = {0};\n    VARIANT vtPath = {0};\n\n\n    hr =  CoInitializeEx(0, COINIT_MULTITHREADED);\n    if(FAILED(hr))\n        goto cleanup;\n\nhr =  CoInitializeSecurity(NULL, -1, NULL, NULL, RPC_C_AUTHN_LEVEL_DEFAULT, \n            RPC_C_IMP_LEVEL_IMPERSONATE, NULL, EOAC_NONE, NULL);\n_ASSERT(SUCCEEDED(hr));\nif(FAILED(hr))\n    goto cleanup;\n\nhr = CoCreateInstance(CLSID_WbemLocator, 0, CLSCTX_INPROC_SERVER, \n            IID_IWbemLocator, (LPVOID *)&amp;pLoc);\n_ASSERT(SUCCEEDED(hr) &amp;&amp; (NULL != pLoc));\nif(FAILED(hr) || (NULL == pLoc))\n    goto cleanup;\n\nhr = pLoc-&gt;ConnectServer(_bstr_t(L\"ROOT\\\\CIMV2\"), NULL, NULL, 0, NULL, \n            0, 0, &amp;pServices);\n_ASSERT(SUCCEEDED(hr) &amp;&amp; (NULL != pServices));\nif(FAILED(hr) || (NULL == pServices))\n    goto cleanup;\n\nhr = CoSetProxyBlanket(pServices, RPC_C_AUTHN_WINNT, \n   RPC_C_AUTHZ_NONE, NULL, RPC_C_AUTHN_LEVEL_CALL, RPC_C_IMP_LEVEL_IMPERSONATE,\n   NULL, EOAC_NONE);\n_ASSERT(SUCCEEDED(hr));\nif(FAILED(hr))\n    goto cleanup;\n\nhr = pServices-&gt;GetObject(_bstr_t(L\"SoftwareLicensingService\"), \n                        0, NULL, &amp;pLicensingClsObj, NULL);\n_ASSERT(SUCCEEDED(hr) &amp;&amp; (NULL != pLicensingClsObj));\nif(FAILED(hr) || (NULL == pLicensingClsObj))\n    goto cleanup;\n\nhr = pLicensingClsObj-&gt;Get(L\"__Path\", 0, &amp;vtPath, 0, 0);\n_ASSERT(SUCCEEDED(hr));\nif(FAILED(hr))\n    goto cleanup;\n\nhr = pLicensingClsObj-&gt;GetMethod(L\"InstallProductKey\", 0, \n            &amp;pInputParamsClass, NULL);\n_ASSERT(SUCCEEDED(hr) &amp;&amp; (NULL != pInputParamsClass));\nif(FAILED(hr) || (NULL == pInputParamsClass))\n    goto cleanup;\n\nhr = pInputParamsClass-&gt;SpawnInstance(0, &amp;pInputParams);\n_ASSERT(SUCCEEDED(hr) &amp;&amp; (NULL != pInputParams));\nif(FAILED(hr) || (NULL == pInputParams))\n    goto cleanup;\n\nvtProductKey.vt = VT_BSTR;\nvtProductKey.bstrVal = SysAllocString(L\"XXXXXXXXXXXXXXXXXXXXXXXXX\");\nhr = pInputParams-&gt;Put(L\"ProductKey\", 0, &amp;vtProductKey, 0);\n_ASSERT(SUCCEEDED(hr));\nif(FAILED(hr))\n    goto cleanup;\n\nhr = pServices-&gt;ExecMethod(vtPath.bstrVal, \n            _bstr_t(L\"InstallProductKey\"), \n            0, NULL, pInputParams, \n            &amp;pOutputParams, NULL);\n_ASSERT(SUCCEEDED(hr) &amp;&amp; (NULL != pOutputParams));\nif(FAILED(hr) || (NULL == pOutputParams))\n    goto cleanup;\n\nhr = S_OK;//all success\n\ncleanup:\nif(NULL != pLoc)\n{\n    pLoc-&gt;Release();\n    pLoc = NULL;\n}\nif(NULL != pServices)\n{\n    pServices-&gt;Release();\n    pServices = NULL;\n}\n(VOID)CoUninitialize();\nreturn hr;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "constructor", "initialization"], "comments": [{"owner": {"reputation": 10110, "user_id": 1715829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0yet.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/1715829/buddy"}, "edited": false, "score": 1, "creation_date": 1431539010, "post_id": 30221816, "comment_id": 48547473, "body": "Nope, but you can change the value from your Agriculture constructor.  Or consider adding parameters to Product&#39;s constructor so you can pass in the correct initial values."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1431539024, "post_id": 30221816, "comment_id": 48547486, "body": "The question is rather obscure. Please care to clarify it with an appropriate coding example (in other words, <b>show your code</b>)."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1431539119, "post_id": 30221816, "comment_id": 48547532, "body": "Sure you can.  Use the constructor in Agriculture to make the appropriate calls to your Product parent."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1431539247, "post_id": 30221816, "comment_id": 48547596, "body": "I think you would benefit from showing what you want to do with some code."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1431550162, "post_id": 30221816, "comment_id": 48553648, "body": "Nope. Also why would you want to. Note: Virtual functions will not work corrrectly until all the constructs have finished executing so you have no access to derived class members."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4481304, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7717ff25ec7697e2b762c24d41224e45?s=128&d=identicon&r=PG&f=1", "display_name": "Assaf Karavani", "link": "https://stackoverflow.com/users/4481304/assaf-karavani"}, "edited": false, "score": 0, "creation_date": 1431540398, "post_id": 30221959, "comment_id": 48548264, "body": "I have many types of products (Agriculture,Diary, etc..) and I want that whenever I construct a type of product, for example an agriculture I want the product&#39;s constructor to act differently for each type, can I at least do that?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "reply_to_user": {"reputation": 25, "user_id": 4481304, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7717ff25ec7697e2b762c24d41224e45?s=128&d=identicon&r=PG&f=1", "display_name": "Assaf Karavani", "link": "https://stackoverflow.com/users/4481304/assaf-karavani"}, "edited": false, "score": 1, "creation_date": 1431541022, "post_id": 30221959, "comment_id": 48548610, "body": "@AssafKaravani make two constructors"}, {"owner": {"reputation": 25, "user_id": 4481304, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7717ff25ec7697e2b762c24d41224e45?s=128&d=identicon&r=PG&f=1", "display_name": "Assaf Karavani", "link": "https://stackoverflow.com/users/4481304/assaf-karavani"}, "edited": false, "score": 1, "creation_date": 1431541489, "post_id": 30221959, "comment_id": 48548885, "body": "I used your recommendation and it worked! Thanks a lot!"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 25, "user_id": 4481304, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7717ff25ec7697e2b762c24d41224e45?s=128&d=identicon&r=PG&f=1", "display_name": "Assaf Karavani", "link": "https://stackoverflow.com/users/4481304/assaf-karavani"}, "edited": false, "score": 0, "creation_date": 1431541501, "post_id": 30221959, "comment_id": 48548900, "body": "@AssafKaravani  I could imagine that you use my recommendation (i.e. a second constructor, as highlighted by <i>user3528438</i>) using an enum parameter indicating what kind of family of products you construct.  This answers your need and uses an acceptable way.  However this introduces a dependency of the base class to its derived which is not a good design practice either.  You should post another question with some more code and describing what is so different between your Product constructions.  Perhaps there&#39;s another way to achieve this."}], "tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": true, "score": 3, "last_activity_date": 1431540486, "last_edit_date": 1431540486, "creation_date": 1431539366, "answer_id": 30221959, "question_id": 30221816, "link": "https://stackoverflow.com/questions/30221816/pre-constructor-initialization/30221959#30221959", "title": "Pre-constructor initialization", "body": "<p>If you have: </p>\n\n<pre><code>class Product { ... };\nclass Agriculture : public Product { ...}; \n</code></pre>\n\n<p>you can't escape the standard rule that the base object is constructed before the derived object.  You have no chance to intervene in this order, nor set anything in <code>Product</code> before it's constructor starts.  </p>\n\n<p><strong>Recommendation:</strong></p>\n\n<p>The best design for your need would be to foresee a <code>Product</code> constructor that takes as additional parameter(s) the value(s) that you want to set: </p>\n\n<pre><code> class Product {\n     string origin; \n public:  \n     Product () : origin(\"tbd\") { } \n     Product (string withorigin) { ...}\n     void setOrigin (string myorigin) { origin=myorigin; }  \n };\n class Agriculture : public Product {\n public: \n     Agriculture () : Product (\"Earth\") { ...} \n };\n</code></pre>\n\n<p><strong>Workaround:</strong></p>\n\n<p>If such design would not fit your needs, the only thing you could imagine, would be to have a static member in <code>Product</code>.  This member would then be independent of any <code>Product</code>, and could thus be set before an object is constructed.  </p>\n\n<pre><code> class Product {\n     static string defaultCurrency; \n     string currency;\n public:  \n     Product () : currency(defaultCurrency) { ... } \n     static void setDefaultCurrency (string cur) { defaultCurrency=cur; }  \n };\n class Agriculture : public Product { ...  };\n\n int main() {\n     Product::setDefaultCurrency(\"EUR\"); \n     Agriculture a1; \n }\n</code></pre>\n\n<p>It's more error prone: the construction result depends on order of operations not related to the construction.  This could be a problem for example in case of multithreading, if several threads construct objects at same moment.  </p>\n"}, {"comments": [{"owner": {"reputation": 185, "user_id": 3645734, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/291d4fcc90f5294827d2aa156d3df76f?s=128&d=identicon&r=PG&f=1", "display_name": "JackChen255", "link": "https://stackoverflow.com/users/3645734/jackchen255"}, "edited": false, "score": 0, "creation_date": 1431541197, "post_id": 30222430, "comment_id": 48548726, "body": "If you want to &quot; I want that whenever I construct a type of product, for example an agriculture I want the product&#39;s constructor to act differently for each type&quot;, you can define a virtual function in Product, then implement different versions to set values in each derived class"}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1431550247, "post_id": 30222430, "comment_id": 48553682, "body": "Note: You can <b>NOT</b> call virtual methods during construction."}], "tags": [], "owner": {"reputation": 185, "user_id": 3645734, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/291d4fcc90f5294827d2aa156d3df76f?s=128&d=identicon&r=PG&f=1", "display_name": "JackChen255", "link": "https://stackoverflow.com/users/3645734/jackchen255"}, "is_accepted": false, "score": 1, "last_activity_date": 1431541051, "creation_date": 1431541051, "answer_id": 30222430, "question_id": 30221816, "link": "https://stackoverflow.com/questions/30221816/pre-constructor-initialization/30222430#30222430", "title": "Pre-constructor initialization", "body": "<p>Product constructor is called firstly, and you set some values inside this constructor. So why you still want to initialize one of the product's members via a set method first?</p>\n"}], "owner": {"reputation": 25, "user_id": 4481304, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7717ff25ec7697e2b762c24d41224e45?s=128&d=identicon&r=PG&f=1", "display_name": "Assaf Karavani", "link": "https://stackoverflow.com/users/4481304/assaf-karavani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1419, "favorite_count": 0, "accepted_answer_id": 30221959, "answer_count": 2, "score": 1, "last_activity_date": 1431541458, "creation_date": 1431538888, "question_id": 30221816, "link": "https://stackoverflow.com/questions/30221816/pre-constructor-initialization", "title": "Pre-constructor initialization", "body": "<p>My problem is like this, I have a class named \"Product\" and another class named \"Agriculture\", the \"Agriculture\" class is inheriting the \"Product\" class.</p>\n\n<p>When I summon the \"Agriculture\" constructor obviously the \"Product\" constructor is summoned first.</p>\n\n<p>The question is, can I initialize one of the product's members via a set method first?</p>\n"}, {"tags": ["c++", "ifstream"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431538853, "post_id": 30221785, "comment_id": 48547383, "body": "How are you compiling this?  If you are using MSVS then typically you need to put the file in the same directory that the source files are in."}, {"owner": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1431538986, "post_id": 30221785, "comment_id": 48547463, "body": "I am compiling with MSVS and when I run console exe from command prompt then folder is coming out exe folder."}, {"owner": {"reputation": 1453, "user_id": 3195614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qw0hw.jpg?s=128&g=1", "display_name": "Zach P", "link": "https://stackoverflow.com/users/3195614/zach-p"}, "edited": false, "score": 0, "creation_date": 1431539170, "post_id": 30221785, "comment_id": 48547552, "body": "The current working directory string is null because it is in your local project folder, therefore it is the default one (and it doesn&#39;t need to specify anything special). The point is, that the file is not in your project folder (notice that when using VS, for example, you should put the files you use where your code is, and not where the executable is)."}, {"owner": {"reputation": 3785, "user_id": 2388257, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/4QzSp.jpg?s=128&g=1", "display_name": "Hi-Angel", "link": "https://stackoverflow.com/users/2388257/hi-angel"}, "edited": false, "score": 1, "creation_date": 1431539302, "post_id": 30221785, "comment_id": 48547629, "body": "Just write a full path to a file. And by the way, aren&#39;t you see in the ouput: the function <code>get_working_path()</code> didn&#39;t return a path."}, {"owner": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "edited": false, "score": 0, "creation_date": 1431539522, "post_id": 30221785, "comment_id": 48547776, "body": "I tried with full path like &quot;C:\\\\cmd.txt&quot; , &quot;c:\\cmd.txt&quot; and copied to project folder next to .cpp file. It is really strange why not working."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1431550010, "post_id": 30221785, "comment_id": 48553571, "body": "If you are running this in VS. You can set up the current working directory in the project options. Set this to the same directory where your file lives. Alternatively explicitly set the working directory. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365530%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">SetCurrentDirectory</a>"}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "edited": false, "score": 0, "creation_date": 1431539157, "post_id": 30221848, "comment_id": 48547549, "body": "file is already in project folder but still not picking for reading."}, {"owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "reply_to_user": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "edited": false, "score": 0, "creation_date": 1431539426, "post_id": 30221848, "comment_id": 48547714, "body": "@NeerajKaushik it works for me. Are you sure you have the .txt file in the same folder as main.cpp(or your main source file)?"}, {"owner": {"reputation": 4312, "user_id": 3880254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/13dffa84d85f3ed70e7156867822246d?s=128&d=identicon&r=PG&f=1", "display_name": "InQusitive", "link": "https://stackoverflow.com/users/3880254/inqusitive"}, "reply_to_user": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "edited": false, "score": 1, "creation_date": 1431539588, "post_id": 30221848, "comment_id": 48547822, "body": "@NeerajKaushik It works for me too. You haven&#39;t kept the cmd.txt file in your prog.exe folder. Recheck."}, {"owner": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "edited": false, "score": 0, "creation_date": 1431540207, "post_id": 30221848, "comment_id": 48548178, "body": "I tried both option. Can it be any settings related to project? or is there any possibility to attache project here?"}, {"owner": {"reputation": 1009, "user_id": 2453661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a44afa0c663b486bff7891d92df52c?s=128&d=identicon&r=PG", "display_name": "Alberto M", "link": "https://stackoverflow.com/users/2453661/alberto-m"}, "edited": false, "score": 0, "creation_date": 1431548099, "post_id": 30221848, "comment_id": 48552625, "body": "On which IDE are you programming? For example Code::Blocks uses as execution dir a different folder than the dir of the .exe file."}], "tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 0, "last_activity_date": 1431539333, "last_edit_date": 1431539333, "creation_date": 1431539009, "answer_id": 30221848, "question_id": 30221785, "link": "https://stackoverflow.com/questions/30221785/reading-from-text-file-is-not-working-c/30221848#30221848", "title": "Reading from text file is not working C++", "body": "<p><code>ifstream myfile(\"cmd.txt\");</code> doesn't create the file for you.<br>\nSo make sure the file <em>\"cmd.txt\"</em> exists in your project directory together with your main.cpp <br>(or main source file).</p>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "is_accepted": false, "score": 0, "last_activity_date": 1431621730, "creation_date": 1431621730, "answer_id": 30242711, "question_id": 30221785, "link": "https://stackoverflow.com/questions/30221785/reading-from-text-file-is-not-working-c/30242711#30242711", "title": "Reading from text file is not working C++", "body": "<p>This code is working fine. I did very silly mistake :(. Actually I found that folder settings in machine is to hide known extensions of files. I deliberately put name as \"cmd.txt\" however actual name came up as \"cmd.txt.txt\" and because of this code is not finding this file.. </p>\n\n<p>I corrected file name as \"cmd.txt\" and code is working now.</p>\n\n<p>Thanks guys for jumping very quick on this question.</p>\n"}], "owner": {"reputation": 316, "user_id": 1096548, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/Dh5Wh.jpg?s=128&g=1", "display_name": "Neeraj Kaushik", "link": "https://stackoverflow.com/users/1096548/neeraj-kaushik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13800, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1611954135, "creation_date": 1431538776, "question_id": 30221785, "link": "https://stackoverflow.com/questions/30221785/reading-from-text-file-is-not-working-c", "title": "Reading from text file is not working C++", "body": "<p>I am simply want to read text from a file and don't know why code is not working. I have already put correct text file name on folder from where program is running. I must be doing something small. Please highlight issue in code below:</p>\n\n<pre><code>// ConsoleApplication1.cpp : Defines the entry point for the console application.\n//\n#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\n#include&lt;cstdio&gt;\n\nusing namespace std;\n\n#ifdef WIN32\n#include &lt;direct.h&gt;\n#define GetCurrentDir _getcwd\n#else\n#include &lt;unistd.h&gt;\n#define GetCurrentDir getcwd\n#endif\n\nstd::string get_working_path() {\n    char cwd[1024];\n    if (GetCurrentDir(cwd, sizeof(cwd)) != NULL)\n        return std::string(cwd);\n    else\n        return std::string(\"\");\n}\n\nint main() {\n\n    string line;\n    //ofstream myfile;\n    //myfile.open(\"cmesymbols.txt\", ios::out | ios::app | ios::binary);\n    ifstream myfile(\"cmd.txt\");\n\n    if (myfile.is_open()) {\n        while (getline(myfile, line))\n        {\n            cout &lt;&lt; line &lt;&lt; '\\n';\n        }\n        myfile.close();\n    }\n    else\n        std::cout &lt;&lt; \"File not found in cwd: \" &lt;&lt; get_working_path();\n\n    myfile.close();\n\n    return 0;\n\n\n\n}\n</code></pre>\n\n<p>Output: File not found in cwd: </p>\n"}, {"tags": ["c++", "compression", "huffman-code", "lossless-compression"], "comments": [{"owner": {"reputation": 97521, "user_id": 565635, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7b4b3e7c9ac68b7d2c93ad02d0b9c79d?s=128&d=identicon&r=PG", "display_name": "orlp", "link": "https://stackoverflow.com/users/565635/orlp"}, "edited": false, "score": 1, "creation_date": 1431538903, "post_id": 30221766, "comment_id": 48547413, "body": "You can&#39;t store the Huffman tree <i>inside</i> your Huffman encoding - the decoder must know it before decoding. Without knowing how your decoder is set up this answer is impossible to answer."}, {"owner": {"reputation": 67, "user_id": 3953728, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/3e7e884129fe50cd4f054200e8f566ea?s=128&d=identicon&r=PG&f=1", "display_name": "TheSalamander", "link": "https://stackoverflow.com/users/3953728/thesalamander"}, "reply_to_user": {"reputation": 97521, "user_id": 565635, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7b4b3e7c9ac68b7d2c93ad02d0b9c79d?s=128&d=identicon&r=PG", "display_name": "orlp", "link": "https://stackoverflow.com/users/565635/orlp"}, "edited": false, "score": 0, "creation_date": 1431538985, "post_id": 30221766, "comment_id": 48547462, "body": "@orlp I haven&#39;t started writing the decoder yet since I am trying to figure this out first. I guess what I am trying to say is that I need to dedicate some portion of my huffman encoding to somehow representing the tree. My professor is not allowing us to pass the Huffman tree to the decoder."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1431539518, "post_id": 30221766, "comment_id": 48547774, "body": "Typically, the huffman tree is passed as a header pacakge for the data.  This does decrease overall efficiency, but can be mitigated by having a lot of encoded data.  or the huffman frequency data can be encoded with a more efficient compressor, but that is also probably beyond scope."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1431539412, "post_id": 30221865, "comment_id": 48547706, "body": "Or use a dynamic huffman encoding system, but that is probably way beyond scope here..."}], "tags": [], "owner": {"reputation": 97521, "user_id": 565635, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7b4b3e7c9ac68b7d2c93ad02d0b9c79d?s=128&d=identicon&r=PG", "display_name": "orlp", "link": "https://stackoverflow.com/users/565635/orlp"}, "is_accepted": false, "score": 2, "last_activity_date": 1431539049, "creation_date": 1431539049, "answer_id": 30221865, "question_id": 30221766, "link": "https://stackoverflow.com/questions/30221766/need-a-way-to-write-my-huffman-tree-to-my-encoding/30221865#30221865", "title": "Need a way to write my Huffman tree to my encoding", "body": "<p>You can't store the Huffman tree <em>inside</em> your Huffman encoding - the decoder must know it before decoding.</p>\n\n<p>You must <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow\">serialize</a> your Huffman tree and prepend it to your Huffman encoded data. Your decoder must deserialize the tree before decoding.</p>\n"}, {"tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": false, "score": 0, "last_activity_date": 1431542604, "creation_date": 1431542604, "answer_id": 30222883, "question_id": 30221766, "link": "https://stackoverflow.com/questions/30221766/need-a-way-to-write-my-huffman-tree-to-my-encoding/30222883#30222883", "title": "Need a way to write my Huffman tree to my encoding", "body": "<p>You don't want to or need to transmit the tree.  All you need to send is the number of bits for each symbol.  From that you can construct the same <a href=\"http://en.wikipedia.org/wiki/Canonical_Huffman_code\" rel=\"nofollow\">canonical code</a> on both ends.</p>\n"}], "owner": {"reputation": 67, "user_id": 3953728, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/3e7e884129fe50cd4f054200e8f566ea?s=128&d=identicon&r=PG&f=1", "display_name": "TheSalamander", "link": "https://stackoverflow.com/users/3953728/thesalamander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1431542604, "creation_date": 1431538715, "question_id": 30221766, "link": "https://stackoverflow.com/questions/30221766/need-a-way-to-write-my-huffman-tree-to-my-encoding", "title": "Need a way to write my Huffman tree to my encoding", "body": "<p>I'm working on an efficient implementation of Huffman compression, but it needs to be done in a unique way: I need to find a way to write my Huffman tree to my encoding before passing it on to the decoder, as for this specific project we are only allowed to pass one pointer to the decoder. I cannot pass the tree itself, because then I would be unable to pass the encoding.</p>\n\n<p>Does anyone has a good way of efficiently storing my Huffman tree in my Huffman encoding?</p>\n\n<p>I'm currently implementing this using C++.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1431540000, "post_id": 30221660, "comment_id": 48548068, "body": "<code>iostream</code>s (there is no <code>std::stream</code>) operate <i>on</i> the stream. They&#39;ve no idea where they&#39;re reading from; that&#39;s handled in <code>std::streambuf</code>, which you want to customize to abstract other data sources/destinations."}, {"owner": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "reply_to_user": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1431540200, "post_id": 30221660, "comment_id": 48548174, "body": "@black I looked into streambuf, but it does not provide the kind of flow control I want for my event driven application. I hoped for some std read/write interface."}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431545845, "post_id": 30221660, "comment_id": 48551443, "body": "what about creating a thread for the stream or (if you&#39;re on unixes) use <a href=\"http://www.kegel.com/dkftpbench/nonblocking.html\" rel=\"nofollow noreferrer\"><code>O_NONBLOCK</code></a>. for <code>streambuf</code> try <a href=\"http://www.cplusplus.com/reference/streambuf/streambuf/showmanyc/\" rel=\"nofollow noreferrer\"><code>streambuf::showmanyc</code></a> and for <code>istream</code> use <a href=\"http://www.cplusplus.com/reference/istream/basic_istream/readsome/\" rel=\"nofollow noreferrer\"><code>istream::readsome</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "edited": false, "score": 0, "creation_date": 1431540735, "post_id": 30221757, "comment_id": 48548461, "body": "@MartinSchlott: I agree 100%.  I <i>really</i> wish there was a non-blocking function to check available bytes :("}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431546218, "post_id": 30221757, "comment_id": 48551631, "body": "actually there is a way: using <code>istream::readsome</code> and <code>streambuf::showmanyc</code> (see my other comment on the question)"}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431549994, "post_id": 30221757, "comment_id": 48553559, "body": "@MooingDuck actually if <code>streambuf</code>&#39;s internal buffer is empty it will call <code>streambuf::showmanyc</code> which gives the number of <code>char</code>s to returned by <code>underflow</code>. see <a href=\"http://www.cplusplus.com/reference/fstream/basic_filebuf/showmanyc/\" rel=\"nofollow noreferrer\"><code>filebuf::showmanyc</code></a>"}, {"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 1, "creation_date": 1431550344, "post_id": 30221757, "comment_id": 48553730, "body": "@MooingDuck i meant that your custom <code>streambuf</code> for a socket can return the number of characters currently in the kernel buffers. see FIONREAD in <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms738573%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\"><code>ioctlsocket</code></a>"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431550787, "post_id": 30221757, "comment_id": 48553960, "body": "@programmerjake: Valid point.  writing a <code>showmanyc</code> is an excellent idea!"}], "tags": [], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "is_accepted": true, "score": 2, "last_activity_date": 1431550727, "last_edit_date": 1495535049, "creation_date": 1431538687, "answer_id": 30221757, "question_id": 30221660, "link": "https://stackoverflow.com/questions/30221660/own-stdistream-with-callback-or-event-to-avoid-pull-or-blocking-read/30221757#30221757", "title": "Own std::istream with callback or event to avoid pull or blocking read", "body": "<p><strike>std::iostream is blocking, and contains no standard way to detect how many bytes are available.  You'll have to introduce your interface.</strike></p>\n\n<p><code>std::istream::readsome</code> and will do a non-blocking read <em>from it's internal buffer</em>, but won't check the socket to see if it needs to refill the buffer.  It can work for you sometimes, but at other times they will simply insist there is no more data, even when data has been sent to the program.   For more information, see this question: <a href=\"https://stackoverflow.com/q/27098420/845092\">C++ std::istream readsome doesn't read anything</a></p>\n\n<p><a href=\"https://stackoverflow.com/users/2597900/programmerjake\">ProgrammerJake</a> points out that <a href=\"http://en.cppreference.com/w/cpp/io/basic_streambuf/showmanyc\" rel=\"nofollow noreferrer\"><code>basic_streambuf::showmanyc</code></a> is the interface you're looking for, but is only implemented usefully in some C++ implementations.  However, since you're making a replacement buffer anyway, you can simply overload/implement this function however you desire in your buffer class!</p>\n"}, {"tags": [], "owner": {"reputation": 4175, "user_id": 1082038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEql2.jpg?s=128&g=1", "display_name": "Nevin", "link": "https://stackoverflow.com/users/1082038/nevin"}, "is_accepted": false, "score": -1, "last_activity_date": 1431542094, "creation_date": 1431542094, "answer_id": 30222724, "question_id": 30221660, "link": "https://stackoverflow.com/questions/30221660/own-stdistream-with-callback-or-event-to-avoid-pull-or-blocking-read/30222724#30222724", "title": "Own std::istream with callback or event to avoid pull or blocking read", "body": "<p>Have you looked at <a href=\"http://think-async.com/\" rel=\"nofollow\">asio</a>?  It provides a <a href=\"http://think-async.com/Asio/asio-1.10.6/doc/asio/reference/ip__tcp/iostream.html\" rel=\"nofollow\">tcp::iostream</a> that may do what you need.</p>\n"}], "owner": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 30221757, "answer_count": 2, "score": 1, "last_activity_date": 1431550727, "creation_date": 1431538343, "last_edit_date": 1431540121, "question_id": 30221660, "link": "https://stackoverflow.com/questions/30221660/own-stdistream-with-callback-or-event-to-avoid-pull-or-blocking-read", "title": "Own std::istream with callback or event to avoid pull or blocking read", "body": "<p>I want to use an own implementation of std::istream to encapsulate a tcp/ip socket. The main problem I face at the moment is, that in an event driven system I do not want to block the read operation. What I searching for is a standard way to register a callback/event to tell the consuming unit that there are bytes to read. I did not find something in the std::iostream area. Is there a conform solution or have I still to introduce my own interface with function binding?</p>\n"}, {"tags": ["c++", "mfc", "richtextbox"], "comments": [{"owner": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "edited": false, "score": 0, "creation_date": 1431538541, "post_id": 30221426, "comment_id": 48547168, "body": "My guess is its something related to the tab control. Perhaps a z-order issue with the tab control behind the rich edit control? Is the rich edit a child of the tab control or a sibling? If you switch back to a <code>CEdit</code> do you have the same problems? Can you duplicate what order of events you need to do to get the display issue, or events that don&#39;t have the display issue?"}, {"owner": {"reputation": 141, "user_id": 2295168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1aa0adcb31af7e1b221055659eb64dc?s=128&d=identicon&r=PG", "display_name": "Marcel Fyrgon Marci\u0161", "link": "https://stackoverflow.com/users/2295168/marcel-fyrgon-marci%c5%a1"}, "reply_to_user": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "edited": false, "score": 0, "creation_date": 1431539770, "post_id": 30221426, "comment_id": 48547929, "body": "RichEdit is child to dialog. Tab doesn&#39;t have any children (its there only to have something to click on and change text of edit box). It shouldn&#39;t be like tab is over edit box as I can select and change content of the editbox. What I do is: ActivateDlg (Select Correct Tab, UpdateData on dlg, ShowWindow - hide/show), SetFoccus, SetSel  Maybe one more thing: when the control is going to be grayed for just a moment the content is showed as it should but is grayed after that brief moment (~0.5s)"}, {"owner": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "edited": false, "score": 0, "creation_date": 1431541767, "post_id": 30221426, "comment_id": 48549054, "body": "It is likely something specific to your app as a simple test with a rich edit over a tab control seems to work fine for me. Its going to be hard for anyone to give you specific advice without a SSCCE(<a href=\"http://www.sscce.org/\" rel=\"nofollow noreferrer\">sscce.org</a>). I would do more testing in your program to see exactly what behaviour/events cause it and see if you can duplicate that in a short test program can could be posted here."}, {"owner": {"reputation": 141, "user_id": 2295168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1aa0adcb31af7e1b221055659eb64dc?s=128&d=identicon&r=PG", "display_name": "Marcel Fyrgon Marci\u0161", "link": "https://stackoverflow.com/users/2295168/marcel-fyrgon-marci%c5%a1"}, "reply_to_user": {"reputation": 6039, "user_id": 439599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b60ad58b64cdd58cd3bbc7ec30a0fe?s=128&d=identicon&r=PG", "display_name": "uesp", "link": "https://stackoverflow.com/users/439599/uesp"}, "edited": false, "score": 0, "creation_date": 1431962940, "post_id": 30221426, "comment_id": 48709731, "body": "I&#39;m not really able to reproduce it on small scale according to SSCCE (thx for the link anyway, might be handy) but I have a new repro for this. It also happens when I copy paste or write text into the richtextbox that is too long for it to show whole so it shows vScrollBar on the bottom edge. Text and the scrollbar are both grayed now. Control is defined as: <code>CONTROL         &quot;&quot;,IDC_STATEEDIT,&quot;RichEdit20A&quot;,ES_MULTILINE | ES_AUTOHSCROLL | ES_WANTRETURN | WS_VSCROLL | WS_HSCROLL | WS_TABSTOP,3,52,133,218</code>"}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 2295168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1aa0adcb31af7e1b221055659eb64dc?s=128&d=identicon&r=PG", "display_name": "Marcel Fyrgon Marci\u0161", "link": "https://stackoverflow.com/users/2295168/marcel-fyrgon-marci%c5%a1"}, "is_accepted": false, "score": 0, "last_activity_date": 1432128587, "last_edit_date": 1432128587, "creation_date": 1432044802, "answer_id": 30328151, "question_id": 30221426, "link": "https://stackoverflow.com/questions/30221426/mfc-richtextbox2-0-grayed/30328151#30328151", "title": "mfc RichTextBox2.0 grayed", "body": "<p>OK I finally got it.</p>\n\n<p>Sry for messing things here, looks like what I described problem wasn't really a clue to solve this.</p>\n\n<p>I found the culprint behind all this in calling this CWnd method for my text box</p>\n\n<p><code>SetWindowPos(&amp;CWnd::wndBottom, 0, 0, width, height, SWP_NOMOVE);</code></p>\n\n<p>When I've used <code>MoveWindow(left,top,right,bottom,repaint)</code> it was working fine but when I left at least one SetWindowPos (set some other control) it was screwed.</p>\n\n<p>I don't really understand why this is such an issue for the CRichEditCtrl that was just OK for CEdit so if you know guys, let me know please.</p>\n"}], "owner": {"reputation": 141, "user_id": 2295168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1aa0adcb31af7e1b221055659eb64dc?s=128&d=identicon&r=PG", "display_name": "Marcel Fyrgon Marci\u0161", "link": "https://stackoverflow.com/users/2295168/marcel-fyrgon-marci%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432128587, "creation_date": 1431537608, "question_id": 30221426, "link": "https://stackoverflow.com/questions/30221426/mfc-richtextbox2-0-grayed", "title": "mfc RichTextBox2.0 grayed", "body": "<p>I'm using mfc in C++ app. I had CEdit controls and changed them for CRichEditCtrl.\nApp is graph editor with internal code in nodes where TextBox is holding the code in dialog in separate window from wnd with graph. If node is clicked, that wnd and dialog is showed (different nodes have different wnds and are hidden when inactive)</p>\n\n<p>My problem is that if I have some longer text in that text box whole area of the text box is grayed. Text is still there, caret can be set by mouse click but nothing is visible until I do something special. For example: by selecting text by mouse click&amp;drag, lines containing the text are once again white and text visible. Other possibility is scrolling, lines that get out of scope will be fine.</p>\n\n<p>I managed to fix this by calling Invalidate on this control but:</p>\n\n<ol>\n<li>I don't really understand why this is happening</li>\n<li>I have implemented search and selecting found words in the text but this graying still occurs instead of selecting first text. When selecting second word in that node and control, whole text box is again clean and working as it should but when going out and in with the search result situation repeats.</li>\n</ol>\n\n<p>On the picture, you can see the rich text box between red fields (BG of dialog holding the controls). On the left the control is nice white control with text. On the right is the same control after search but grayed and after clicking into it and selecting some text with two \"unrevealed\" pieces of code.</p>\n\n<p>Any advice why this is happening and/or how can I get rid of this behavior?</p>\n\n<p><img src=\"https://i.stack.imgur.com/KcfdF.png\" alt=\"Compare fine state and messed up grayed state of RichtextBox\"></p>\n\n<p>Strange thing is that when I experimented with some solutions Calling Invalidate() made it behaving well for some cases but calling UpdateWindow() after invalidate messed thing up again.</p>\n"}, {"tags": ["c++", "unix", "tcp", "client-server"], "comments": [{"owner": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 2, "creation_date": 1431537724, "post_id": 30221371, "comment_id": 48546681, "body": "check the status returned from read"}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "reply_to_user": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 0, "creation_date": 1431537926, "post_id": 30221371, "comment_id": 48546795, "body": "cant some reads be 0 as say server is not publishing anything as there are no new data ? And more importantly i want to know why server is not allowed to bind the same port again as no one is already listening to it ?"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1431537938, "post_id": 30221371, "comment_id": 48546803, "body": "When the first connection closes, does the server go back to call accept() on the socket that it is listening on to get the next incoming connection?"}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431538029, "post_id": 30221371, "comment_id": 48546851, "body": "Unless i use SO_REUSEADDR it does not and shows Already in use message"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431538057, "post_id": 30221371, "comment_id": 48546866, "body": "You don&#39;t want to blindly use <code>SO_REUSEADDR</code> if there is the possibility that you really do have another instance of your server running still using the port. Your stack probably still has a TCP context in TIME-WAIT state."}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431538289, "post_id": 30221371, "comment_id": 48546999, "body": "Yes , but my prime question is why server is not able to listen again and bind to same port when no one else is listening on it ? My main concern is server and client running on same host , is that reason ? if so why ?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431538477, "post_id": 30221371, "comment_id": 48547134, "body": "The TCP stack doesn&#39;t distinguish listening socket from connected socket, so closing the listening socket is translated into a send of FIN event, which means the socket gets moved into TIME-WAIT state (you could argue this is a bug, but this is de facto behavior for most stacks). So, before you can rebind to the same port, you have to wait 2 x MSL. Terminating the process early just means that a regular close happens on the socket."}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431538621, "post_id": 30221371, "comment_id": 48547217, "body": "But in my case we since client is just reading . It does not come to know that connection is terminated and connection remains established. So when Server again tries to bind it it gets address already in use"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431538670, "post_id": 30221371, "comment_id": 48547256, "body": "You are not testing if <code>read()</code> returns 0, which would be the hint that the server side is closed."}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431538772, "post_id": 30221371, "comment_id": 48547337, "body": "Will read be not 0 in case server is in say idle state ?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431538822, "post_id": 30221371, "comment_id": 48547370, "body": "Only if you have a broken version of <code>read()</code> that is not following POSIX semantics for dealing with sockets. <code>read()</code> has slightly different semantics depending on the device associated with the file descriptor. But, we are talking about TCP sockets."}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431539278, "post_id": 30221371, "comment_id": 48547620, "body": "So a check for if read() returns 0 . And in that case close connction and try to reconnect till server is up should work for me ?"}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431540188, "post_id": 30221371, "comment_id": 48548166, "body": "This is not true . I added the check but my client process still does not die. ` n = read(sockfd,buffer,255);     \tif (n &lt; 0)           \terror(&quot;ERROR reading from socket&quot;); \tbzero(buffer,256);     \tprintf(&quot;%s\\n&quot;,buffer); xyz@xyz:~$ netstat -a | grep -i 2001 tcp        0      0 localhost:47058         localhost:2001          CLOSE_WAIT  tcp        0      0 localhost:2001          localhost:47058         FIN_WAIT2"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1431541986, "post_id": 30221371, "comment_id": 48549181, "body": "How is testing for less than 0 a check for equal to 0?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1431544956, "post_id": 30221371, "comment_id": 48550951, "body": "Look, if the read result is less than zero, it&#39;s important becasue an error has been signaled.  If the read result equals zero, it&#39;s important because it means that the connection has been closed by the peer.  If the read result is greater than zero, , it&#39;s important because it&#39;s the only way of telling how many bytes have been loaded into the buffer.  You must correctly handle ALL 3 cases."}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431545615, "post_id": 30221371, "comment_id": 48551325, "body": "I am doing that now. But question now is Server takes some time before we can bind , listen and accept again . Is this TTL or some other configuration parameter  ?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1431563191, "post_id": 30221371, "comment_id": 48558450, "body": "You don&#39;t need to zero the buffer: this is cargo-cult programming. You do need to take note of the value of <code>n</code>: for example, <code>printf(&quot;Here is the message: %.*s \\n&quot;,n,buffer);</code>"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431563570, "post_id": 30221371, "comment_id": 48558552, "body": "@jxh Closing the listening socket does <b>NOT</b> send a <code>FIN</code> or move the socket into <code>TIME_WAIT</code> state. Closing an <i>accepted</i> socket does that, or the connected socket in the client. The reason <code>bind()</code> fails without <code>SO_REUSEADDR</code> is that an accepted socket may be still in <code>TIME_WAIT</code> state."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1431564990, "post_id": 30221371, "comment_id": 48558898, "body": "@EJP: Ah, thanks for that. Is this a protocol generic behavior thing, though? It seems it shouldn&#39;t bother the TIME_WAIT on the connected socket to allow a new listener to bind."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1431566256, "post_id": 30221371, "comment_id": 48559182, "body": "@EJP: It seems if there is still a connected socket (perhaps in FIN_WAIT), the listening port is left in an &quot;inuse&quot; state, a reference counting thing."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431566294, "post_id": 30221371, "comment_id": 48559191, "body": "@jxh It doesn&#39;t &#39;bother the TIME_WAIT&#39;, it&#39;s the other way around. That connection in TIME_WAIT is using the port you&#39;re re-using. There is no &#39;reference counting&#39;. The port in LISTEN state disappears immediately."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1431566406, "post_id": 30221371, "comment_id": 48559221, "body": "@EJP: I understand now, however, it should be the connected socket / TCP pcb that is in TIME_WAIT, not the port number itself."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1431566780, "post_id": 30221371, "comment_id": 48559344, "body": "@jxh Agreed, there is a tendency to use &#39;connection&#39; and &#39;socket&#39; and even &#39;port&#39; as though they mean one thing instead of three different things."}], "answers": [{"comments": [{"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431543030, "post_id": 30222433, "comment_id": 48549763, "body": "I tried this . But when i close socket on client side after read =0 <code>if (n == 0)  { \t  &#47;&#47; error(&quot;ERROR reading from socket&quot;); \t  close(sockfd);           reconnect(argv[1], portno); \t}</code>"}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431544616, "post_id": 30222433, "comment_id": 48550753, "body": "This works for me now . But then i have to make sure reconnect by client is started after sometime say two minute . As starting client again takes a little while and address already in use is thrown. But after a minute it is allowed to bind and listen which was not happening"}, {"owner": {"reputation": 77122, "user_id": 106671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a910ad61c5827193f003a11be5dacb14?s=128&d=identicon&r=PG", "display_name": "Nikolai Fetissov", "link": "https://stackoverflow.com/users/106671/nikolai-fetissov"}, "reply_to_user": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431544923, "post_id": 30222433, "comment_id": 48550929, "body": "In TCP/IP world we usually call processes that do <code>bind(2)</code>, <code>listen(2)</code>, <code>accept(2)</code> sequence a <b><i>server</i></b>, and the ones that do <code>connect(2)</code> a <b><i>client</i></b>. Yours are both, so you have to apply same rules to both sides (e.g. set the <code>SO_REUSEADDR</code> on the listening sockets)."}, {"owner": {"reputation": 77122, "user_id": 106671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a910ad61c5827193f003a11be5dacb14?s=128&d=identicon&r=PG", "display_name": "Nikolai Fetissov", "link": "https://stackoverflow.com/users/106671/nikolai-fetissov"}, "reply_to_user": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 1, "creation_date": 1431545036, "post_id": 30222433, "comment_id": 48550987, "body": "You want to distinguish an error (<code>-1</code>) and EOF (zero) returned from socket reads. First is a real problem, second is a valid protocol condition."}, {"owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431545141, "post_id": 30222433, "comment_id": 48551049, "body": "I am not using SO_REUSEADDR now. I am checking for read return 0 and if so sleep for some time and reconnect. But server takes some time to bind , listen and accept which you can say is around 2 minutes. I am now using check <code>==0</code> for read."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "edited": false, "score": 0, "creation_date": 1431563110, "post_id": 30222433, "comment_id": 48558431, "body": "@Invictus <code>n == 0</code> is not an <code>&quot;error reading from socket&quot;</code>. It is a normal end of stream condition. And when you <i>do</i> get an error you should call <code>perror()</code>, or use <code>strerror()</code> <code>errno</code> in the message you print."}], "tags": [], "owner": {"reputation": 77122, "user_id": 106671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a910ad61c5827193f003a11be5dacb14?s=128&d=identicon&r=PG", "display_name": "Nikolai Fetissov", "link": "https://stackoverflow.com/users/106671/nikolai-fetissov"}, "is_accepted": true, "score": 1, "last_activity_date": 1431541083, "creation_date": 1431541083, "answer_id": 30222433, "question_id": 30221371, "link": "https://stackoverflow.com/questions/30221371/server-socket-programming-tcp-connection-address-already-in-use/30222433#30222433", "title": "Server Socket Programming TCP Connection Address already in use", "body": "<p>Looks like you are a bit confused about how TCP works.</p>\n\n<p>When you terminate and re-start the server, the client is no longer connected, so it needs to close its end of the TCP connection, i.e. call <a href=\"http://man7.org/linux/man-pages/man2/close.2.html\" rel=\"nofollow\"><code>close(2)</code></a> on the socket descriptor, then create a new <a href=\"http://man7.org/linux/man-pages/man2/socket.2.html\" rel=\"nofollow\"><code>socket(2)</code></a> and <a href=\"http://man7.org/linux/man-pages/man2/connect.2.html\" rel=\"nofollow\"><code>connect(2)</code></a> it again.</p>\n\n<p>You are probably missing 0 (zero) returned from the <a href=\"http://man7.org/linux/man-pages/man2/read.2.html\" rel=\"nofollow\"><code>read(2)</code></a> on the client socket that means the other end has closed its end of the connection.</p>\n"}, {"tags": [], "owner": {"reputation": 3265, "user_id": 2606938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gIUB.jpg?s=128&g=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/2606938/prabhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1431542334, "creation_date": 1431542334, "answer_id": 30222803, "question_id": 30221371, "link": "https://stackoverflow.com/questions/30221371/server-socket-programming-tcp-connection-address-already-in-use/30222803#30222803", "title": "Server Socket Programming TCP Connection Address already in use", "body": "<blockquote>\n  <p>. When i kill server process and try to run again it says Address already in Use. When using SO_REUSEADDR it allows me to reuse the port but client no more receives data from server.</p>\n</blockquote>\n\n<p>You cannot have your client continue as if nothing happened to server . Client should detect broken connection and do socket close from its end and restart the connection establishment  process all over again. Old connection is gone for good.  </p>\n"}], "owner": {"reputation": 3034, "user_id": 1103956, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ffc86d67cb7545ecc15b598701b76871?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/1103956/invictus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "accepted_answer_id": 30222433, "answer_count": 2, "score": 1, "last_activity_date": 1431560555, "creation_date": 1431537445, "last_edit_date": 1431560555, "question_id": 30221371, "link": "https://stackoverflow.com/questions/30221371/server-socket-programming-tcp-connection-address-already-in-use", "title": "Server Socket Programming TCP Connection Address already in use", "body": "<p>This works for me now . But then i have to make sure reconnect by client is started after sometime say two minute . As starting client again takes a little while and address already in use is thrown. But after a minute it is allowed to bind and listen which was not happening. Is this TTL time i need to wait ?</p>\n\n<p>I wrote a server socket program in which I have server and client running on same host . The server only writes (no read operation by server) while client only reads from server ( no write done by client). When I kill server process and try to run again it says Address already in Use. When using SO_REUSEADDR it allows me to reuse the port but client no more receives data from server. Part of server code </p>\n\n<pre><code>while(1)\n{\n  write(newsockfd,\"I got your message\",18); //Server Publishes data all day\n}\n</code></pre>\n\n<p>part of client code:-</p>\n\n<pre><code>while(1)\n{ \n   n = read(sockfd,buffer,255);//Read all server publishes and store them\n   if (n == 0) \n        error(\"ERROR reading from socket\");\n   printf(\"Here is the message: %s \\n\",buffer);\n   bzero(buffer,256); //Buffer set to Null again\n}\n</code></pre>\n\n<p>If on connection I try netstat -a I can see my server listening to port say 20001 to which i bind it. But I cannot still see establish connection even when both client ans server are running . Client keeps printing data received from \nserver. As I kill server process, I see client just printing newline as buffer set to NULL after every read. Now my question is if there is connection already establish which is now terminated does this prevents Server from listening on same port ? My main Question If so why is no other process listening to that port ? SO_REUSEADDR allows server to bind and REUSE ADDR . Is this because Server and client running on same host ? How to handle in case the termination is ungraceful (secondary question). After adding read check as in comment I still see client running and netstat gives me below output:-</p>\n\n<pre><code>  xyz@xyz:~$ netstat -a | grep -i 2001\n  tcp        0      0 localhost:47058         localhost:2001  CLOSE_WAIT \n  tcp        0      0 localhost:2001          localhost:47058 FIN_WAIT2  \n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "operators", "cin", "istream"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1431537345, "post_id": 30221268, "comment_id": 48546497, "body": "Ask yourself what&#39;s the point of the <code>is</code> parameter to your operator if you&#39;re just going to hit <code>cin</code> in <code>setAge</code> anyway ? <code>setAge</code> should do just that: take an <code>int</code> parameter and set the <code>age</code> member. Leave how you get the value to pass in for that out of it."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1431537812, "last_edit_date": 1431537812, "creation_date": 1431537497, "answer_id": 30221385, "question_id": 30221268, "link": "https://stackoverflow.com/questions/30221268/problems-with-istream-operator/30221385#30221385", "title": "Problems with istream&amp; operator &gt;&gt;", "body": "<blockquote>\n  <p>In my function <code>istream&amp; operator &gt;&gt; (istream &amp;is, Student&amp; a)</code>, I didn't use <code>is</code> but still return it at the end of the function. I still get the correct answer with <code>cin &gt;&gt; a</code>. Can anyone explain why?</p>\n</blockquote>\n\n<p>Because <code>Student::setAge()</code> is accessing <code>cin</code> directly, which is the same stream that <code>is</code> happens to be pointing at in your example.</p>\n\n<p>This is not the correct design.  A member setter should not be prompting the user for input.  You should prompt for input first, then pass the value to your setter afterwards.  The class should be agnostic about where its values are coming from.</p>\n\n<p>Use something more like this instead:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass Student\n{\nprivate:\n    int age;\npublic:\n    Student() : age(0){}\n    Student (int age1) : age(age1) {}\n    void setAge(int value);\n    int getAge(){return age;}\n    void readFrom(istream&amp; is);\n};\n\nistream&amp; operator &gt;&gt; (istream &amp;is, Student&amp; a)\n{\n    a.readFrom(is);\n    return is;\n}\n\nvoid Student::readFrom(istream&amp; is){\n    is &gt;&gt; age;\n}\n\nvoid Student::setAge(int value){\n    age = value;\n}\n\nint main()\n{\n    Student a;\n    int age;\n    cout &lt;&lt; \"input age of the student: \"&lt;&lt; endl;\n    cin &gt;&gt; age;\n    a.setAge(age);\n    cout &lt;&lt; \"Age of Student is \" &lt;&lt; a.getAge() &lt;&lt; \"?\";\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12893, "user_id": 922712, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/58c323703912545891e23986ae04e2fa?s=128&d=identicon&r=PG", "display_name": "user93353", "link": "https://stackoverflow.com/users/922712/user93353"}, "is_accepted": false, "score": 5, "last_activity_date": 1431537810, "creation_date": 1431537810, "answer_id": 30221485, "question_id": 30221268, "link": "https://stackoverflow.com/questions/30221268/problems-with-istream-operator/30221485#30221485", "title": "Problems with istream&amp; operator &gt;&gt;", "body": "<p>This works fine because you are calling </p>\n\n<pre><code>cin &gt;&gt; a;\n</code></pre>\n\n<p>If instead you did this</p>\n\n<pre><code>ifstream ifs (\"test.txt\", ifstream::in);\nifs &gt;&gt; a;\n</code></pre>\n\n<p>Then your program will read from standard input instead of the file (test.txt) like it's supposed to be doing.</p>\n\n<p>The correct implementation would be </p>\n\n<pre><code>istream&amp; operator &gt;&gt; (istream &amp;is, Student&amp; a)\n{\n    return is &gt;&gt; a.age;\n}\n</code></pre>\n\n<p>Now if you call </p>\n\n<pre><code>cin &gt;&gt; a;\n</code></pre>\n\n<p>it would read from standard input  </p>\n\n<p>and if you call</p>\n\n<pre><code>ifs &gt;&gt; a;\n</code></pre>\n\n<p>it would read from the file.</p>\n"}, {"tags": [], "owner": {"reputation": 602, "user_id": 797396, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a2bd94537b14d881761688b937b9a211?s=128&d=identicon&r=PG", "display_name": "radato", "link": "https://stackoverflow.com/users/797396/radato"}, "is_accepted": false, "score": 0, "last_activity_date": 1431538841, "creation_date": 1431538841, "answer_id": 30221803, "question_id": 30221268, "link": "https://stackoverflow.com/questions/30221268/problems-with-istream-operator/30221803#30221803", "title": "Problems with istream&amp; operator &gt;&gt;", "body": "<p>Actually there are quite a few points to make in your example.</p>\n\n<p>Firstly a setter should have a parameter. By convention, a <em>setter</em> always gets a parameter which alters the class and then the <em>getter</em> is parameterless and should be <strong>const</strong>.</p>\n\n<p>Secondly, your implementation of setAge directly accesses std::cin. If you look at my example you will see that I do make use of the is parameter. That separates the setAge from the source of the parameter and allows for better OOD.</p>\n\n<p>Thirdly, my implementation also provides better abstraction because the input stream is could be any stream (for example a file, or maybe a stream from the internet)</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass Student\n{\nprivate:\n    int age;\npublic:\n    Student() : age(0){}\n    Student(int age1) : age(age1) {}\n    void setAge(int age1);\n    int getAge() const { return age; }\n    friend istream&amp; operator &gt;&gt; (istream&amp; is, Student&amp; a);\n};\n\nistream&amp; operator &gt;&gt; (istream &amp;is, Student&amp; a)\n{\n    int age1;\n    is &gt;&gt; age1;\n    a.setAge(age1);\n    return is;\n}\nvoid Student::setAge(int age1){\n    age = age1;\n}\n\nint main(int argc, char* argv[])\n{\n    Student a;\n    cout &lt;&lt; \"input age of the student: \" &lt;&lt; endl;\n    cin &gt;&gt; a;\n    cout &lt;&lt; \"Age of Student is \" &lt;&lt; a.getAge() &lt;&lt; \"?\" &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1431539028, "creation_date": 1431539028, "answer_id": 30221857, "question_id": 30221268, "link": "https://stackoverflow.com/questions/30221268/problems-with-istream-operator/30221857#30221857", "title": "Problems with istream&amp; operator &gt;&gt;", "body": "<blockquote>\n  <p>I didn't use <code>is</code></p>\n</blockquote>\n\n<p>Yes you did. You just used it from a different function, is all.</p>\n\n<p>It's the same stream because it's <code>cin</code> in both cases.</p>\n\n<p>If you ever wanted to extract from a different stream then your code would be broken. This is why we prefer to use the argument to <code>operator&gt;&gt;</code> rather than sort of guessing at what it was (<code>cin</code>).</p>\n"}], "owner": {"reputation": 901, "user_id": 4418033, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/499b51847b38863627f544d943f691b5?s=128&d=identicon&r=PG&f=1", "display_name": "pexea12", "link": "https://stackoverflow.com/users/4418033/pexea12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1431539028, "creation_date": 1431537108, "last_edit_date": 1431537254, "question_id": 30221268, "link": "https://stackoverflow.com/questions/30221268/problems-with-istream-operator", "title": "Problems with istream&amp; operator &gt;&gt;", "body": "<p>I am still wondering about istream operator>>.\nIn my function <code>istream&amp; operator &gt;&gt; (istream &amp;is, Student&amp; a)</code>, I didn't use <code>is</code> but still return it at the end of the function. I still get the correct answer with <code>cin &gt;&gt; a</code>. Can anyone explain why?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass Student\n{\nprivate:\n    int age;\npublic:\n    Student() : age(0){}\n    Student (int age1) : age(age1) {}\n    void setAge();\n    int getAge(){return age;}\n    friend istream&amp; operator &gt;&gt; (istream&amp; is, Student&amp; a);\n};\n\nistream&amp; operator &gt;&gt; (istream &amp;is, Student&amp; a)\n{\n    a.setAge();\n    return is;\n}\nvoid Student::setAge(){\n    int age1;\n    cout &lt;&lt; \"input age of the student: \"&lt;&lt; endl;\n    cin &gt;&gt; age1;\n    age = age1;\n}\n\nint main()\n{\n    Student a;\n    cin &gt;&gt; a;\n    cout &lt;&lt; \"Age of Student is \" &lt;&lt; a.getAge() &lt;&lt; \"?\";\n}\n</code></pre>\n"}, {"tags": ["c++", "makefile"], "comments": [{"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1431536977, "post_id": 30221164, "comment_id": 48546292, "body": "Where is <code>&#47;Fo</code> in that output? Where is <code>transitionList.exe</code> in that makefile snippet? Is that <b>exact</b> error from this <b>exact</b> makefile snippet?"}, {"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1431537138, "post_id": 30221164, "comment_id": 48546376, "body": "I just posted the error message. the /Fo is here:  C:\\&lt;path&gt;&gt;make test cl /Fo&#39;.\\include\\lists\\&#39; include\\lists\\transitionList.cpp  entire makefile in edit"}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1431537236, "post_id": 30221164, "comment_id": 48546428, "body": "Put the <b>entire</b> error message in the post. And make sure you use the right file/etc. names in the makefile and output you post."}, {"owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "reply_to_user": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "edited": false, "score": 0, "creation_date": 1431537670, "post_id": 30221164, "comment_id": 48546657, "body": "Ok, I put in the entire error now"}], "owner": {"reputation": 3257, "user_id": 3578468, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c7957773c9ae23195b8a064ade49af29?s=128&d=identicon&r=PG&f=1", "display_name": "lo tolmencre", "link": "https://stackoverflow.com/users/3578468/lo-tolmencre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431537344, "creation_date": 1431536733, "last_edit_date": 1431537344, "question_id": 30221164, "link": "https://stackoverflow.com/questions/30221164/cl-compiler-produces-exe-with-obj-flag-enabled", "title": "Cl compiler produces exe with obj flag enabled", "body": "<p>I am having issues compiling object files with CL compiler. I have a Makefile with rules like this:</p>\n\n<pre><code>TRANSITION_H = include\\lists\\transition.h\nTRANSITION_CPP = include\\lists\\transition.cpp\nTRANSITION_O = include\\lists\\transition.obj\nTRANSITION_OP = '.\\include\\lists\\'\n\nCPPCOMPILER = cl\nTO_OBJ = /Fo\n\n$(TRANSITION_O) : $(TRANSITION_CPP) $(TRANSITION_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(TRANSITION_OP) $(TRANSITION_CPP)\n\nstatistics: $(STATS)\n\n$(STATS): $(TRANSITION_O)\n</code></pre>\n\n<p>when I run make statistics I get</p>\n\n<pre><code>/out:transitionList.exe\n.\\include\\lists\\transitionList.obj\nLINK : fatal error LNK1561: entry point must be defined\nmake: *** [include\\lists\\transitionList.obj] Error 2\n</code></pre>\n\n<p>So, it is producing exe files somehow... but then again it's not. Because it generates a .obj file in the correct directory, but says /out: .exe</p>\n\n<p>Can somebody explain to me whats going wrong here?</p>\n\n<h1>edit</h1>\n\n<p>whole makefile:</p>\n\n<pre><code>########################################################################\n# variables\n########################################################################\n\nLIST_H = include\\lists\\list.h\nLIST_CPP = include\\lists\\list.cpp\nLIST_O = include\\lists\\list.obj\nLIST_OP = '.\\include\\lists\\'\n\nTRANSITION_H = include\\lists\\transition.h\nTRANSITION_CPP = include\\lists\\transition.cpp\nTRANSITION_O = include\\lists\\transition.obj\nTRANSITION_OP = '.\\include\\lists\\'\n\nTRANSITION_LIST_H = include\\lists\\transitionList.h\nTRANSITION_LIST_CPP = include\\lists\\transitionList.cpp\nTRANSITION_LIST_O = include\\lists\\transitionList.obj\nTRANSITION_LIST_OP = '.\\include\\lists\\'\n\nSTRING_LIST_H = include\\lists\\stringList.h\nSTRING_LIST_CPP = include\\lists\\stringList.cpp\nSTRING_LIST_O = 'include\\lists\\stringList.obj\nSTRING_LIST_OP = '.\\include\\lists\\'\n\nELEMENT_H = include\\lists\\element.h\nELEMENT_CPP = include\\lists\\element.cpp\nELEMENT_O = include\\lists\\element.obj\nELEMENT_OP = '.\\include\\lists\\'\n\nTEST_CPP = include\\lists\\test.cpp\nTEST_BIN = test.exe\n\nAUXILS_H = include\\auxils.h\nAUXILS_CPP = include\\auxils.cpp\nAUXILS_O = include\\auxils.obj\nAUXILS_P = '.\\include\\'\n\nTRIE_H = include\\trie\\trie.h\nTRIE_CPP = include\\trie\\trie.cpp\nTRIE_O = include\\trie\\trie.obj\nTRIE_OP = '.\\include\\trie\\'\n\nHMM_H = include\\hmm\\hmm.h\nHMM_O = include\\hmm\\hmm.obj\nHMM_OP = '.\\include\\hmm\\'\n\nTRELLIS_H = include\\hmm\\trellis.h\nTRELLIS_O = include\\hmm\\trellis.obj\nTRELLIS_OP = '.\\include\\hmm\\'\n\nTRAINER_H = include\\trainer\\trainer.h\nTRAINER_O = include\\trainer\\trainer.obj\nTRAINER_OP = '.\\include\\trainer\\'\n\nCPPCOMPILER = cl\nTO_OBJ = /Fo\n\n# doxygen-file\nDOC_INDEX = doc\\html'.\\index.html\n\n# corpus file\ncorpus = '.'.\\data\\tiger.txt'\n# comment tag\ntag = \\#\nin = 'data\\testfile.txt'\n\nSTATS = data\\HMM\\all_trans.dat\n\n\n########################################################################\n# targets\n########################################################################\n\n\n$(TRANSITION_O) : $(TRANSITION_CPP) $(TRANSITION_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(TRANSITION_OP) $(TRANSITION_CPP)\n\n$(TRANSITION_LIST_O) : $(TRANSITION_LIST_CPP) $(TRANSITION_LIST_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(TRANSITION_LIST_OP) $(TRANSITION_LIST_CPP)\n\n$(STRING_LIST_O) : $(STRING_LIST_CPP) $(STRING_LIST_H) $(LIST_O) \\\n    $(ELEMENT_O)\n    $(CPPCOMPILER) $(TO_OBJ)$(STRING_LIST_OP) $(STRING_LIST_CPP)\n\n$(AUXILS_O) : $(AUXILS_CPP) $(AUXILS_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(AUXILS_OP) $(AUXILS_CPP)\n\n$(ELEMENT_O) : $(ELEMENT_CPP) $(ELEMENT_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(ELEMENT_OP) $(ELEMENT_CPP)\n\n$(LIST_O) : $(LIST_CPP) $(LIST_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(LIST_OP) $(LIST_CPP)\n\n$(TRIE_O) : $(TRIE_CPP) $(TRIE_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(TRIE_OP) $(TRIE_CPP)\n\n$(HMM_O) : $(HMM_H) $(TRELLIS_H)\n    $(CPPCOMPILER) $(TO_OBJ)$(HMM_OP) $(HMM_H)\n\n# make documentation\ndocumentation: $(DOC_INDEX)\n\n$(DOC_INDEX):\n    doxygen doc\\hmm.doxygen\n    mv html doc\n\nclean:\n    rm -rf doc\\html\n    rm -rf doc\\latex\n    find . -name '*.obj' -delete\n    find . -name '*.exe' -delete\n    find . -name '*.gch' -delete\n    find . -name '*.out' -delete\n    find . -name '*.png' -delete\n    find . -name '*.dat' -delete\n\n# gathers statistics from corpus file to train HMM on. Requires\n# one token-tag-tuple per line. call format:\n# 'make statistics corpus=&lt;corpus file&gt; tag=&lt;comment tag char&gt;'\nstatistics: $(STATS)\n\n$(STATS): $(TRANSITION_O) $(TRANSITION_LIST_O) $(AUXILS_O) $(LIST_O) \\\n    $(ELEMENT_O) $(TRIE_O) $(STRING_LIST_O)\n\n    $(CPPCOMPILER) \\src\\train.cpp $(TRANSITION_O) \\\n    $(TRANSITION_LIST_O) $(AUXILS_O) $(LIST_O) $(ELEMENT_O) $(TRIE_O) \\\n    $(STRING_LIST_O)\n    mv train.exe \\bin\\train.exe\n    cd bin; train.exe $(corpus) '$(tag)'\n\n# taggs sentences in input file. Requires a sentence to occupy a line\n# all by itself; call format: 'make test in=&lt;file&gt;'\ntest: $(TRANSITION_O) $(TRANSITION_LIST_O) $(AUXILS_O) $(LIST_O) \\\n    $(ELEMENT_O) $(TRIE_O) $(STRING_LIST_O) $(STATS) $(HMM_O)\n\n    $(CPPCOMPILER) \\src\\hmm_test.cpp $(TRANSITION_O) \\\n    $(TRANSITION_LIST_O) $(AUXILS_O) $(LIST_O) $(ELEMENT_O) $(TRIE_O) \\\n    $(STRING_LIST_O)\n    mv hmm_test.exe \\bin\\hmm_test.exe\n    cd bin; hmm_test.exe .'.\\$(in)\n</code></pre>\n\n<p>entire error:</p>\n\n<pre><code>C:\\&lt;path&gt;&gt;make test\ncl /Fo'.\\include\\lists\\' include\\lists\\transition.cpp\nMicrosoft (R) C/C++ Optimizing Compiler Version 18.00.31101 for x86\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\ntransition.cpp\nC:\\Program Files (x86)\\Microsoft Visual Studio 12.0\\VC\\INCLUDE\\xlocale(337) : warning C4530: C++ exception handler used, but unwind semantics are not\nenabled. Specify /EHsc\nMicrosoft (R) Incremental Linker Version 12.00.31101.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:transition.exe\n.\\include\\lists\\transition.obj\nLINK : fatal error LNK1561: entry point must be defined\nmake: *** [include\\lists\\transition.obj] Error 2\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1431536854, "post_id": 30221138, "comment_id": 48546211, "body": "The presence of the cast should already be raising alarm bells."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 4, "creation_date": 1431536892, "post_id": 30221138, "comment_id": 48546229, "body": "<i>C++ is designed to protect against Murphy, not Machiavelli</i> (Bjarne Stroustrup)"}], "owner": {"reputation": 127, "user_id": 4853937, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Yr4s2.jpg?s=128&g=1", "display_name": "Prashant Mishra", "link": "https://stackoverflow.com/users/4853937/prashant-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1431536989, "answer_count": 0, "score": 0, "last_activity_date": 1431536798, "creation_date": 1431536648, "last_edit_date": 1431536798, "question_id": 30221138, "link": "https://stackoverflow.com/questions/30221138/accessing-private-data-members-from-the-outside-class-using-pointers", "closed_reason": "Duplicate", "title": "accessing private data members from the outside class using pointers", "body": "<p>As I understand, private data members are only accessible from within the class. There is a way in which I can access or change the private data of a class but doing so violates the object oriented programming concepts. The following code would help you out as to how to access the private data members.</p>\n\n<pre><code>class sample\n{    \nprivate:      \n    int i;\n\npublic:    \n    sample(int a)\n    {    \n        i=a;\n    }\n\n    void display()\n    {\n        cout&lt;&lt;i&lt;&lt;endl;\n    }\n};\n\nvoid main()\n{\n    sample s(97);\n    s.display();\n    int *p=(int*)&amp;s;\n    *p=43;\n    s.display();\n}\n</code></pre>\n\n<p>So here we can easily access the data at that address which is nothing but the private data. Am I right? </p>\n"}, {"tags": ["c++", "arrays", "vector", "multidimensional-array"], "comments": [{"owner": {"reputation": 3302, "user_id": 2034041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgYSR.png?s=128&g=1", "display_name": "Varaquilex", "link": "https://stackoverflow.com/users/2034041/varaquilex"}, "edited": false, "score": 1, "creation_date": 1431535570, "post_id": 30220734, "comment_id": 48545451, "body": "Why not use <code>std::set&lt;vector &lt;vector &lt;vector&lt;type&gt; &gt; &gt;</code> ?"}, {"owner": {"reputation": 1563, "user_id": 1261507, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SIc7J.png?s=128&g=1", "display_name": "Philipp Braun", "link": "https://stackoverflow.com/users/1261507/philipp-braun"}, "reply_to_user": {"reputation": 3302, "user_id": 2034041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgYSR.png?s=128&g=1", "display_name": "Varaquilex", "link": "https://stackoverflow.com/users/2034041/varaquilex"}, "edited": false, "score": 0, "creation_date": 1431535691, "post_id": 30220734, "comment_id": 48545514, "body": "I have used subvectors therefore I think it becomes clear that I have used this type ..."}, {"owner": {"reputation": 1563, "user_id": 1261507, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SIc7J.png?s=128&g=1", "display_name": "Philipp Braun", "link": "https://stackoverflow.com/users/1261507/philipp-braun"}, "reply_to_user": {"reputation": 3302, "user_id": 2034041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgYSR.png?s=128&g=1", "display_name": "Varaquilex", "link": "https://stackoverflow.com/users/2034041/varaquilex"}, "edited": false, "score": 0, "creation_date": 1431535894, "post_id": 30220734, "comment_id": 48545644, "body": "I did not get any serious comments here only downvotes. No idea what this is here ..."}, {"owner": {"reputation": 3302, "user_id": 2034041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgYSR.png?s=128&g=1", "display_name": "Varaquilex", "link": "https://stackoverflow.com/users/2034041/varaquilex"}, "edited": false, "score": 1, "creation_date": 1431536002, "post_id": 30220734, "comment_id": 48545708, "body": "Oh, that I missed. I have no idea why you get downvoted, but here, take my upvote."}, {"owner": {"reputation": 1563, "user_id": 1261507, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SIc7J.png?s=128&g=1", "display_name": "Philipp Braun", "link": "https://stackoverflow.com/users/1261507/philipp-braun"}, "reply_to_user": {"reputation": 3302, "user_id": 2034041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgYSR.png?s=128&g=1", "display_name": "Varaquilex", "link": "https://stackoverflow.com/users/2034041/varaquilex"}, "edited": false, "score": 0, "creation_date": 1431536071, "post_id": 30220734, "comment_id": 48545765, "body": "Thanks still hoping that someone can help me out."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1431536201, "post_id": 30220734, "comment_id": 48545828, "body": "@Philipp Braun What is the combination? Is it a three-dimensional subvector? Do you need to have a vector of unique three-dimensional subvectors?"}, {"owner": {"reputation": 2085, "user_id": 4371080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb71c0f8f249373532fd27cc817c563?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Sarofeen", "link": "https://stackoverflow.com/users/4371080/christian-sarofeen"}, "edited": false, "score": 1, "creation_date": 1431536274, "post_id": 30220734, "comment_id": 48545871, "body": "This example does not appear that difficult, however, it doesn&#39;t appear you&#39;ve given us enough information to be useful. Please provide a short compilable example."}, {"owner": {"reputation": 1563, "user_id": 1261507, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SIc7J.png?s=128&g=1", "display_name": "Philipp Braun", "link": "https://stackoverflow.com/users/1261507/philipp-braun"}, "edited": false, "score": 0, "creation_date": 1431536303, "post_id": 30220734, "comment_id": 48545885, "body": "like stated in the description combinations is a multidimensional vector containing several three-dimensional subvectors"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 3302, "user_id": 2034041, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/zgYSR.png?s=128&g=1", "display_name": "Varaquilex", "link": "https://stackoverflow.com/users/2034041/varaquilex"}, "edited": false, "score": 0, "creation_date": 1431536315, "post_id": 30220734, "comment_id": 48545896, "body": "@Varaquilex please strive to upvote questions because they are useful, clear, and show research effort.  Don&#39;t vote to &quot;undo&quot; someone else&#39;s vote."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1431536422, "post_id": 30220734, "comment_id": 48545965, "body": "What are &quot;double vectors&quot;?  What is a &quot;combinations container&quot;?  What was the result of what you tried?"}, {"owner": {"reputation": 1891, "user_id": 995218, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZKQoe.jpg?s=128&g=1", "display_name": "atkins", "link": "https://stackoverflow.com/users/995218/atkins"}, "edited": false, "score": 0, "creation_date": 1431536606, "post_id": 30220734, "comment_id": 48546073, "body": "@PhilippBraun Did you possibly mean &quot;duplicate&quot; vectors rather than &quot;double&quot; vectors?"}], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1431546358, "last_edit_date": 1431546358, "creation_date": 1431536795, "answer_id": 30221185, "question_id": 30220734, "link": "https://stackoverflow.com/questions/30220734/deleting-subvectors-in-a-multidimensional-vector-after-checking-for-doubles/30221185#30221185", "title": "Deleting Subvectors in a Multidimensional Vector after Checking for Doubles", "body": "<p>If I have understood correctly then the code snippet can look like</p>\n\n<pre><code>auto last = combinations.begin();\nfor ( auto current = combinations.begin(); current != combinations.end(); ++current )\n{\n    auto first = combinations.begin();\n    while ( first != last &amp;&amp; *first != *current ) ++first;\n\n    if ( first == last )\n    {\n        if ( last == current ) ++last;\n        else *last++ = *current;\n    }\n}\n\ncombinations.erase( last, combinations.end() );\n</code></pre>\n\n<p>The inner loop can be substituted for standard algorithm <code>std::find</code>. For example</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n\n//... \n\nauto last = combinations.begin();\nfor ( auto current = combinations.begin(); current != combinations.end(); ++current )\n{\n    if ( std::find( combinations.begin(), last, *current ) == last )\n    {\n        if ( last == current ) ++last;\n        else *last++ = *current;\n    }\n}\n\ncombinations.erase( last, combinations.end() );\n</code></pre>\n\n<p>I suppose that the original vector shall not be sorted. Otherwise you could sort it and apply algorithm <code>std::unique</code>.</p>\n"}], "owner": {"reputation": 1563, "user_id": 1261507, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SIc7J.png?s=128&g=1", "display_name": "Philipp Braun", "link": "https://stackoverflow.com/users/1261507/philipp-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 30221185, "answer_count": 1, "score": -2, "last_activity_date": 1431546358, "creation_date": 1431535351, "last_edit_date": 1431535752, "question_id": 30220734, "link": "https://stackoverflow.com/questions/30220734/deleting-subvectors-in-a-multidimensional-vector-after-checking-for-doubles", "title": "Deleting Subvectors in a Multidimensional Vector after Checking for Doubles", "body": "<p>I have created a container with several combinations of a three dimensional vector. Structure looks similar to this:</p>\n\n<pre><code>combinations[4096][4][4][4]; // only want to show element number here\nstd::vector&lt;std::vector&lt;std::vector&lt;std::vector&lt;int&gt;&gt;&gt;&gt; combinations; // used in my code\n</code></pre>\n\n<p>My problem currently is that I am not sure how I can delete all the double vectors in the combinations container. So far I have tried this:</p>\n\n<pre><code>for(int i=0; i&lt;combinations.size(); i++){\n    // Counter Part Combinations\n    for(int j=0; j&lt;combinations.size(); j++){\n        if (j!=i) {\n            if (combinations[i]==combinations[j]) {\n                combinations.erase(combinations.begin()+j*64, combinations.begin()+(j+1)*64);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "vector", "move"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1431535305, "post_id": 30220667, "comment_id": 48545294, "body": "Could you make a concise sample (<a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>) for your concerns."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 1, "creation_date": 1431535833, "post_id": 30220667, "comment_id": 48545602, "body": "@mah, that would be a dumb reason to close a question anyway, but the link goes to another SO question."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1431536931, "post_id": 30220667, "comment_id": 48546251, "body": "@mah: The link is just for background, and is summarised in the question. It&#39;s not necessary to follow it to answer the question."}], "answers": [{"comments": [{"owner": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 0, "creation_date": 1431536883, "post_id": 30220755, "comment_id": 48546223, "body": "move semantics gave me the impression that one object can get the ownership of all the data from the original object, so it is fast. Here is my confusion, how can only changing ownership makes stack allocated become on heap?"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 1, "creation_date": 1431555481, "post_id": 30220755, "comment_id": 48556203, "body": "@Allanqunzi: move semantics transfer ownership of some resource (managed by a pointer or other lightweight handle) from one object to another. The object itself, and the data it directly contains, stays where it is."}], "tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": false, "score": 3, "last_activity_date": 1431535418, "creation_date": 1431535418, "answer_id": 30220755, "question_id": 30220667, "link": "https://stackoverflow.com/questions/30220667/push-back-an-object-which-has-only-move-constructor-to-a-vector/30220755#30220755", "title": "push back an object which has only move constructor to a vector", "body": "<p>Moving an object transfers state from one object to another; the two objects are separate, and at different locations, and remain separate objects at the same locations afterwards.</p>\n\n<p>So the answer to the question is yes: the object in the vector is on the heap, wherever the object used to initialise it resides.</p>\n"}, {"comments": [{"owner": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 0, "creation_date": 1431536130, "post_id": 30220837, "comment_id": 48545793, "body": "do I have to use <code>std::move(t)</code>?"}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "reply_to_user": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 1, "creation_date": 1431536528, "post_id": 30220837, "comment_id": 48546027, "body": "Here you do, because otherwise <code>t</code> is passed as <code>thread&amp;</code> instead of <code>thread&amp;&amp;</code>, which will attempt to copy the thread and result in a compile error since there is no copy constructor for <code>std::thread</code>. The compiler can&#39;t automatically infer the move for you, because there are many types that can be both copied and moved; basically, only temporary objects are moved automatically (because they resolve to the r-value reference type and not the l-value reference type), and everything else has to be manually moved."}, {"owner": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 0, "creation_date": 1431537849, "post_id": 30220837, "comment_id": 48546752, "body": "so move semantics doesn&#39;t necessarily mean efficient. E.g. if I have a <code>C</code> array of 1000 elements as a data member in a class, when implementing the move constructor, I still have to copy each element into a new <code>C</code> array which may be quite slow."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "reply_to_user": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 1, "creation_date": 1431539852, "post_id": 30220837, "comment_id": 48547991, "body": "Right. Except that if you have a data member that&#39;s an array, you can create it on the heap instead of having it baked in to the object with a fixed number of elements. At that point, the member is not really the array itself, but a pointer to the first element of the array. Which means that you can implement the move constructor to copy only the pointer, then make the moved item&#39;s pointer point to null. So the array doesn&#39;t have to be copied after all, because the moved object doesn&#39;t have to refer to the same data afterwards. This is how <code>std::vector</code> implements its move, by the way."}, {"owner": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "edited": false, "score": 0, "creation_date": 1431540200, "post_id": 30220837, "comment_id": 48548173, "body": "Thanks, I think I got it."}], "tags": [], "owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "is_accepted": true, "score": 7, "last_activity_date": 1431535669, "creation_date": 1431535669, "answer_id": 30220837, "question_id": 30220667, "link": "https://stackoverflow.com/questions/30220667/push-back-an-object-which-has-only-move-constructor-to-a-vector/30220837#30220837", "title": "push back an object which has only move constructor to a vector", "body": "<p>The instance stored in the vector will always be a different object than the one you push in, even if it's moved. Moving an object merely invokes the move constructor instead of the copy constructor for the corresponding object being created in the vector.</p>\n\n<p>So yes, you can push a moveable-only type into a vector, but no, it does not somehow magically transform a patch of stack space into a patch of heap space. It merely creates a new object in the vector with the <em>contents</em> of the object on the stack moved into it. How the contents are moved (i.e. what a move is, exactly) is up to each object to decide -- and that's what move constructors do.</p>\n\n<p>The syntax for doing this might look like so:</p>\n\n<pre><code>std::vector&lt;std::thread&gt; threads;\nstd::thread t([]() { /* do something */ });\n\n// You need `std::move` here to force the object to be treated as\n// an r-value and get moved instead of trying to be copied.\nthreads.push_back(std::move(t));\n\n// At this point `t` still exists (until the end of scope), but\n// its contents (while valid) are indeterminate. It does not refer\n// to the running thread any more.\n\nthreads.back().join();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5688, "user_id": 946259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4004ce6f0abf3ab0f19648730c50d9d6?s=128&d=identicon&r=PG", "display_name": "ZunTzu", "link": "https://stackoverflow.com/users/946259/zuntzu"}, "is_accepted": false, "score": 0, "last_activity_date": 1431536101, "creation_date": 1431536101, "answer_id": 30220962, "question_id": 30220667, "link": "https://stackoverflow.com/questions/30220667/push-back-an-object-which-has-only-move-constructor-to-a-vector/30220962#30220962", "title": "push back an object which has only move constructor to a vector", "body": "<p>Calling a move constructor in C++11 doesn't actually move anything. It is just a mechanism to manage object life-cycle and ownership.</p>\n\n<p>Calling a move constructor actually means: \"copy this object, and by the way you can cannibalize any data structure already allocated for this object because I will not use it anymore\".</p>\n"}], "owner": {"reputation": 3018, "user_id": 2345484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1899ae171c0663708dde115790f44918?s=128&d=identicon&r=PG", "display_name": "Allanqunzi", "link": "https://stackoverflow.com/users/2345484/allanqunzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 2, "accepted_answer_id": 30220837, "answer_count": 3, "score": 2, "last_activity_date": 1431536101, "creation_date": 1431535174, "last_edit_date": 1495542712, "question_id": 30220667, "link": "https://stackoverflow.com/questions/30220667/push-back-an-object-which-has-only-move-constructor-to-a-vector", "title": "push back an object which has only move constructor to a vector", "body": "<p>This is a rather general question. In this post <a href=\"https://stackoverflow.com/questions/10366474/where-does-a-stdvector-allocate-its-memory\">Where does a std::vector allocate its memory?</a> it says that <code>vector</code> allocates its elements in the heap by default. In C++11, there is move semantics and <code>vector</code> supports this. What if I have an object which has only move constructor, and I have declared this object in the stack, now I want to <code>push_back</code> this object into a <code>vector</code>, is the one being pushed back still in the heap? </p>\n\n<p>An example might be pushing back a stack declared <code>std::thread t1(someFunc)</code> into a <code>vector</code>, as following</p>\n\n<pre><code>int main(){\n      std::thread t1(someFunc);\n      std::vector&lt;std::thread&gt; threads;\n      threads.push_back(t1); // is the one being pushed back in the heap\n                             // or in the stack? Is the answer generally\n                             // true for objects which have only move\n                             // constructors?\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2013", "stdstring"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 4, "creation_date": 1431534774, "post_id": 30220520, "comment_id": 48544982, "body": "<b><i>I&#39;m migrating to VS2013 and now I&#39;m getting some rather strange LNK2005 errors on std::string methods and operators.</i></b> Are you using VS2013 for all dependencies (including Qt)?"}, {"owner": {"reputation": 9, "user_id": 2970183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70518f07640a693345a7eb8f3ded887?s=128&d=identicon&r=PG&f=1", "display_name": "user2970183", "link": "https://stackoverflow.com/users/2970183/user2970183"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1431535072, "post_id": 30220520, "comment_id": 48545154, "body": "Yes.  I&#39;ve rebuilt Qt using VS2013."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1431536939, "post_id": 30220520, "comment_id": 48546262, "body": "Are you sure you&#39;re linking against the VS2013 CRT? EDIT: Wait, I see you&#39;re passing <code>&#47;NODEFAULTLIB:MSVCRT</code>. How is that supposed to work?"}, {"owner": {"reputation": 9, "user_id": 2970183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70518f07640a693345a7eb8f3ded887?s=128&d=identicon&r=PG&f=1", "display_name": "user2970183", "link": "https://stackoverflow.com/users/2970183/user2970183"}, "edited": false, "score": 0, "creation_date": 1431537274, "post_id": 30220520, "comment_id": 48546460, "body": "In &#39;Debug&#39; configurations (as I&#39;m currently building), MSVCPRTD and MSVCRTD are used.  MSVCRT is the Release configuration CRT."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1431541115, "post_id": 30220520, "comment_id": 48548684, "body": "When you need to force <code>&#47;NODEFAULTLIB:MSVCRT</code> that most likely means you have more than 1 CRT between your project and its dependencies possibly linking the wrong version of Visual Studio, wrong configuration or inconsistent runtime settings."}, {"owner": {"reputation": 9, "user_id": 2970183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70518f07640a693345a7eb8f3ded887?s=128&d=identicon&r=PG&f=1", "display_name": "user2970183", "link": "https://stackoverflow.com/users/2970183/user2970183"}, "edited": false, "score": 0, "creation_date": 1431543567, "post_id": 30220520, "comment_id": 48550111, "body": "I added the various /NODEFAULTLIB ... options mostly for completeness/verboseness, but when I remove the /NODEFAULTLIB:MSVCRT option I get the following: <code>1&gt;LINK : warning LNK4098: defaultlib &#39;MSVCRT&#39; conflicts with use of other libs; use &#47;NODEFAULTLIB:library</code>"}, {"owner": {"reputation": 9, "user_id": 2970183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70518f07640a693345a7eb8f3ded887?s=128&d=identicon&r=PG&f=1", "display_name": "user2970183", "link": "https://stackoverflow.com/users/2970183/user2970183"}, "edited": false, "score": 0, "creation_date": 1431543845, "post_id": 30220520, "comment_id": 48550297, "body": "I also renamed the VS 2008 directory to <code>C:\\Program Files (x86)\\Microsoft Visual Studio 9.0.xxxxx</code> to prevent cross-version use.  Problem still exists...."}, {"owner": {"reputation": 9, "user_id": 2970183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70518f07640a693345a7eb8f3ded887?s=128&d=identicon&r=PG&f=1", "display_name": "user2970183", "link": "https://stackoverflow.com/users/2970183/user2970183"}, "edited": false, "score": 0, "creation_date": 1431547815, "post_id": 30220520, "comment_id": 48552481, "body": "More details.  I did a <code>dumpbin &#47;all model.dll</code> on both versions (VS2008 and VS2013) and found that, indeed, the VS2013 version included std::string implementations (<code>??4?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@&zwnj;&#8203;std@@QAEAAV01@PBD@Z (public: class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; &amp; __thiscall std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::operator=(char const *))</code>) but the VS2008 version did not.  Still searching...."}], "owner": {"reputation": 9, "user_id": 2970183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70518f07640a693345a7eb8f3ded887?s=128&d=identicon&r=PG&f=1", "display_name": "user2970183", "link": "https://stackoverflow.com/users/2970183/user2970183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1035, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431981746, "creation_date": 1431534638, "last_edit_date": 1431981746, "question_id": 30220520, "link": "https://stackoverflow.com/questions/30220520/getting-error-lnk2005-in-visual-studio-2013-on-stdstring-methods-and-operators", "title": "Getting error LNK2005 in Visual Studio 2013 on std::string methods and operators", "body": "<p>I have a Qt-based project that I have been building and using Visual Studio 2008 for about 5 years.  I build and use both 'Debug' and 'Release' build configurations.</p>\n\n<p>I'm migrating to VS2013 and now I'm getting some rather strange LNK2005 errors on std::string methods and operators.</p>\n\n<p>The code base is broken into two libraries and a bunch of UI directories.  In Debug build configuration the two libraries are built into DLLs and then must be specified in the PATH when running one of the UIs.  In Release mode everything is compiled statically into a single executable.  Works great.</p>\n\n<p>The two libraries are 'model' and 'engine'.  The 'model' is built first and the 'engine' is then built.  The 'engine' uses the 'model' (library).</p>\n\n<p>When the 'engine' is linked, I get a bunch of the following errors, all dealing with std::string:</p>\n\n<pre><code>    1&gt;model.lib(model.dll) : error LNK2005: \"public: class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; \n        &amp; __thiscall std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::operator=(class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; const &amp;)\" \n        (??4?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV01@ABV01@@Z) \n        already defined in NamedObject.obj\n\n    1&gt;model.lib(model.dll) : error LNK2005: \"public:\n        int __thiscall std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::compare(class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; const &amp;)const \" \n        (?compare@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QBEHABV12@@Z) \n        already defined in NamedObject.obj\n</code></pre>\n\n<p>The first looks like the 'std::string::operator=(const std::string &amp;)' operator.  The 'NamedObect' class is in 'engine' and does NOT override 'std::string::operator=()'.  In fact, 'NamedObject' is basically a simple wrapper around a 'std::string' attribute, an accessor and a 'bool operator== (const NamedObject &amp;)' method, that looks like the following:</p>\n\n<pre><code>    bool\n    NamedObject::operator== (const NamedObject &amp;v)\n    { return (name == v.name); }\n</code></pre>\n\n<p>There are many other LNK2005 errors like this, but this one is fairly isolated to a small class.</p>\n\n<p>Things I've checked/verified:</p>\n\n<ul>\n<li>I'm compiling and linking with consistent '/Mxx' compiler options (/MDd) in this case.</li>\n<li>The '-Zc:wchar_t' option is specified in both the Makefiles for the 'model' and 'engine'.</li>\n<li>Both libraries link with '/NOLOGO /DYNAMICBASE /NXCOMPAT /DEBUG /NODEFAULTLIB:LIBCMT /NODEFAULTLIB:LIBCPMT /NODEFAULTLIB:LIBCMTD /NODEFAULTLIB:LIBCPMTD /NODEFAULTLIB:MSVCRT /NODEFAULTLIB:MSVCPRT /DLL'</li>\n<li>A 'dumpbin /dependencies' on the various object files reveal '/DEFAULTLIB:msvcprtd /DEFAULTLIB:MSVCRTD /DEFAULTLIB:OLDNAMES'.</li>\n</ul>\n\n<p>I. Am. Stuck.</p>\n\n<p><strong>EDIT</strong>. More details. I did a dumpbin /all model.dll on both versions (VS2008 and VS2013) and found that, indeed, the VS2013 version included std::string implementations: <code>??4?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV01@PBD@Z (public: class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; &amp; __thiscall std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;::operator=(char const *))</code> </p>\n\n<p>but the VS2008 version did not.</p>\n\n<p><strong>EDIT 2</strong> Well, I decided to give this the 'ol college try.....  I've isolated this to just a few small classes (and yes, everything is compiled with the same version of the compiler, same VS solution, etc., etc....).</p>\n\n<p>Here's what I have for the declaration of a simple 'model' class.  I'll explain later about some stuff.  You can sort of figger out what the implementation of the methods are.....</p>\n\n<pre><code># pragma once \n# if defined(WIN32) &amp;&amp; defined(BUILD_DLL)\n#     if defined(MODEL_EXPORT_API) // inside DLL\n#         define MODEL_EXPORTAPI __declspec(dllexport)\n#         define MODEL_EXPIMP_TEMPLATE\n#     else // outside DLL\n#         define MODEL_EXPORTAPI __declspec(dllimport)\n#         define MODEL_EXPIMP_TEMPLATE extern\n#     endif\n# else\n#     define MODEL_EXPORTAPI\n# endif\n\n# include &lt;string&gt;\n# if defined (WIN32)\n    MODEL_EXPIMP_TEMPLATE template class MODEL_EXPORTAPI std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;;\n# endif\n\nnamespace model { namespace exceptions {\n    class MODEL_EXPORTAPI FlowException {\n    public:\n        FlowException(const std::string &amp; m);\n        virtual ~FlowException();\n        virtual const char *  what() const;\n    private:\n         // Copy constructor and assignment operator are private and\n        // unimplemented.\n        FlowException(const FlowException &amp;);\n        FlowException &amp;    operator=(const FlowException &amp;);\n\n        std::string _msg;\n   };\n} }\n</code></pre>\n\n<p>For 'engine' classes.  This one is similar to the 'model' class above.  Again, you can figger out what the implementation would be...</p>\n\n<pre><code># pragma once\n\n# include &lt;string&gt;\n\n# if    defined(WIN32) &amp;&amp; defined(BUILD_DLL)\n#    if defined(FLOWENGINE_EXPORT_API) // inside DLL\n#       define FLOWENGINE_EXPORTAPI   __declspec(dllexport)\n#       define FLOWENGINE_EXPIMP_TEMPLATE\n#    else // outside DLL\n#       define FLOWENGINE_EXPORTAPI   __declspec(dllimport)\n#       define FLOWENGINE_EXPIMP_TEMPLATE extern\n#    endif\n# else\n#    define FLOWENGINE_EXPORTAPI\n# endif\n\nnamespace flowEngine { namespace core {\n\nclass NamedObject {\npublic:\n    NamedObject(const std::string &amp; n);\n\n    virtual ~NamedObject();\n\n    bool        operator== (const NamedObject &amp; v) const;\n\n    const char *    getName() const;\n\nprivate:\n    // Copy constructor and assignment operator are private and\n    // unimplemented.\n    NamedObject(const NamedObject &amp;);\n    NamedObject &amp;   operator=(const NamedObject &amp;);\n\n    std::string     _name;\n};\n} }\n</code></pre>\n\n<p>Now for the tests. </p>\n\n<ol>\n<li><p>If I don't have that 'MODEL_EXPIMP_TEMPLATE template class...' line in the 'model exception' class, then I get 'warning C4251: 'model::exceptions::FlowException::_msg' : class 'std::basic_string,std::allocator>' needs to have dll-interface to be used by clients of class 'model::exceptions::FlowException'' on each reference of that header file and this example links.</p>\n\n<ol start=\"2\">\n<li><p>If I 'include' that 'exception' class in the model into a class in the engine, and w/o that 'MODEL_EXPIMP_TEMPLATE template class...' line this example works (both libraries link).</p></li>\n<li><p>If I include that 'exception' class in the model into a class in the engine WITH THE ''MODEL_EXPIMP_TEMPLATE template class...' line in the exception class, then this example fails when the engine library is linked with: '1>model.lib(model.dll) : error LNK2005: \"public: __thiscall std::basic_string,class std::allocator >::basic_string,class std::allocator >(char const *)\" (??0?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@PBD@Z) already defined in NamedObject.obj'</p></li>\n</ol></li>\n</ol>\n\n<p>Now what?  In one case the compiler is telling to fix the code and when I do links fail....</p>\n"}, {"tags": ["c++", "pointers", "crash"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1431534884, "post_id": 30220506, "comment_id": 48545037, "body": "First of all, enable more warnings, it&#39;s always good to have extra warnings enabled when developing. Secondly, run in a debugger to locate the crash. The debugger will stop at the location of the crash, and let you examine (and walk up) the function call stack and also let you examine values of variables at each level. Of course you need to build with debug-info for it to work."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4686187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d3eb6f580404b844d559aaf0d66737f?s=128&d=identicon&r=PG&f=1", "display_name": "romikps", "link": "https://stackoverflow.com/users/4686187/romikps"}, "edited": false, "score": 0, "creation_date": 1431535679, "post_id": 30220669, "comment_id": 48545507, "body": "Thank you! It helped. Such  a stupid mistake :). I expected I messed something up again with pointers."}], "tags": [], "owner": {"reputation": 560, "user_id": 1057105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1eed3b357556c214ba12853c78a3173?s=128&d=identicon&r=PG", "display_name": "artoonie", "link": "https://stackoverflow.com/users/1057105/artoonie"}, "is_accepted": false, "score": 1, "last_activity_date": 1431535177, "creation_date": 1431535177, "answer_id": 30220669, "question_id": 30220506, "link": "https://stackoverflow.com/questions/30220506/c-program-crashes-graph-implementation/30220669#30220669", "title": "C++ program crashes. Graph implementation", "body": "<p>Several of your if statements use = instead of ==. If you enable warnings in your compiler, you will find something like:</p>\n\n<pre><code>test.cpp:69:36: warning: using the result of an assignment as a condition without parentheses [-Wparentheses]\n            if (vertices[i]-&gt;value = val)\n                ~~~~~~~~~~~~~~~~~~~^~~~~\ntest.cpp:69:36: note: place parentheses around the assignment to silence this warning\n            if (vertices[i]-&gt;value = val)\n                                   ^\n                (                       )\ntest.cpp:69:36: note: use '==' to turn this assignment into an equality comparison\n            if (vertices[i]-&gt;value = val)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 4686187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d3eb6f580404b844d559aaf0d66737f?s=128&d=identicon&r=PG&f=1", "display_name": "romikps", "link": "https://stackoverflow.com/users/4686187/romikps"}, "edited": false, "score": 0, "creation_date": 1431536406, "post_id": 30220784, "comment_id": 48545953, "body": "Thank you very much! It worked. I was using the command line and therefore missed that mistake. I thought I did something wrong with pointers."}], "tags": [], "owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "is_accepted": true, "score": 0, "last_activity_date": 1431535533, "creation_date": 1431535533, "answer_id": 30220784, "question_id": 30220506, "link": "https://stackoverflow.com/questions/30220506/c-program-crashes-graph-implementation/30220784#30220784", "title": "C++ program crashes. Graph implementation", "body": "<p>Your if expression is assigning not comparing.</p>\n\n<pre><code>Vertex* findVertex(unsigned val)\n{\n    for (unsigned i = 0; i &lt; vertices.size(); i++)\n        if (vertices[i]-&gt;value = val)  // WHOOPS!\n            return vertices[i];\n    return nullptr;\n}\n</code></pre>\n\n<p>Change to:</p>\n\n<pre><code>Vertex* findVertex(unsigned val)\n{\n    for (unsigned i = 0; i &lt; vertices.size(); i++)\n        if (vertices[i]-&gt;value == val)  // FIXED\n            return vertices[i];\n    return nullptr;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4686187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d3eb6f580404b844d559aaf0d66737f?s=128&d=identicon&r=PG&f=1", "display_name": "romikps", "link": "https://stackoverflow.com/users/4686187/romikps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 30220784, "answer_count": 2, "score": -1, "last_activity_date": 1431537671, "creation_date": 1431534595, "last_edit_date": 1431537671, "question_id": 30220506, "link": "https://stackoverflow.com/questions/30220506/c-program-crashes-graph-implementation", "title": "C++ program crashes. Graph implementation", "body": "<p>I'm trying to implement a Graph data structure which uses an adjacency list. To populate, I have to read data from a file. The file is a text file where the first line contains two numbers. The first is the number of vertices n and the second is the number of edges m. After this line there will be m lines with three numbers. The first two numbers represent the source and destination vertex for the undirected edge. The third number (positive integer) is the weight for that edge.</p>\n\n<p>The file's contents look like this:</p>\n\n<pre><code>5 7\n0 1 3\n0 2 4\n0 3 5\n1 4 10\n2 5 20\n3 4 6\n4 5 4\n</code></pre>\n\n<p>But for some reason the code I've written so far makes the program crash. And compiler doesn't give any hints as to the reason.\nI'd really appreciate some advice. I've read quite a lot about pointers, references in C++, but still finding them confusing. So a good resource to understand them better would really be helpful.  </p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;sstream&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nstruct Vertex\n{\n    unsigned value;\n    vector&lt;Vertex*&gt; adjList;\n    vector&lt;unsigned&gt; weights;\n};\n\nclass Graph\n{\nprivate:\n    unsigned vertex_count, edge_count;\n    vector&lt;Vertex*&gt; vertices;\n\n\npublic:\n    Graph(string fileName)\n    {\n        ifstream myFile(fileName);\n\n        if (myFile.is_open())\n        {\n            // Processing the first line of the file\n            string aLine;\n            getline(myFile, aLine);\n            stringstream aString(aLine);\n\n            aString &gt;&gt; vertex_count;\n            aString &gt;&gt; edge_count;\n\n            // Processing the rest of the file\n            unsigned vert1, vert2, weight;\n            while (getline(myFile, aLine))\n            {\n                aString= stringstream(aLine);\n                aString &gt;&gt; vert1;\n                aString &gt;&gt; vert2;\n                aString &gt;&gt; weight; \n                addRelation(vert1, vert2, weight);\n            }\n        }\n        else\n            cout &lt;&lt; \"Unable to open file.\";\n    }\n\n    ~Graph()\n    {\n        for (unsigned i = 0; i &lt; vertices.size(); i++)\n            delete vertices[i];\n    }\n\n    void addVertex(unsigned val)\n    {\n        Vertex* newVertex = new Vertex;\n        newVertex-&gt;value = val;\n        vertices.push_back(newVertex);\n    }\n\n    Vertex* findVertex(unsigned val)\n    {\n        for (unsigned i = 0; i &lt; vertices.size(); i++)\n            if (vertices[i]-&gt;value = val)\n                return vertices[i];\n        return nullptr;\n    }\n\n    void addRelation(unsigned vert1, unsigned vert2, unsigned weight)\n    {\n        Vertex* vertex1 = findVertex(vert1);\n        if (vertex1 == nullptr) {\n            addVertex(vert1);\n            vertex1 = findVertex(vert1);\n        }\n\n        Vertex* vertex2 = findVertex(vert2);\n        if (vertex2 == nullptr) {\n            addVertex(vert2);\n            vertex2 = findVertex(vert2);\n        }\n\n        vertex1-&gt;adjList.push_back(vertex2);\n        vertex1-&gt;weights.push_back(weight);\n\n        vertex2-&gt;adjList.push_back(vertex1);\n        vertex2-&gt;weights.push_back(weight);\n    }\n};\n\nint main()\n{\n    Graph myG(\"graph.txt\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "unix"], "comments": [{"owner": {"reputation": 77122, "user_id": 106671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a910ad61c5827193f003a11be5dacb14?s=128&d=identicon&r=PG", "display_name": "Nikolai Fetissov", "link": "https://stackoverflow.com/users/106671/nikolai-fetissov"}, "edited": false, "score": 2, "creation_date": 1431535041, "post_id": 30220421, "comment_id": 48545141, "body": "Try closing the newly created file <i>before</i> reading the directory."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1431535071, "post_id": 30220421, "comment_id": 48545153, "body": "curiously that code  works for me. Perhaps someone can find some clues if you add the kernel version/architecture/filesystem etc. you&#39;re using. Some trials with calling fsync() on the still open descripors might be worthwhile too."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1431539074, "post_id": 30220421, "comment_id": 48547515, "body": "<code>r = ::open( name, 0 );</code> Syntax error. Are you confusing C and C++ ?"}, {"owner": {"reputation": 595, "user_id": 1274868, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/bf94875f746c352d74cd9863420dc62c?s=128&d=identicon&r=PG", "display_name": "Lobster", "link": "https://stackoverflow.com/users/1274868/lobster"}, "edited": false, "score": 0, "creation_date": 1431546734, "post_id": 30220421, "comment_id": 48551900, "body": "Closing file before reading the directory doesn&#39;t fix the problem, file is still invisible I am using: Linux version 2.6.32-38-generic (Ubuntu 10.04) I also tried using fsync function - when I use it on file descriptor it does nothing, when I use it on directory descriptor I got EINVAL error code (Invalid argument) Oh, yes, sorry that code is C++, not pure C, my mistake"}], "answers": [{"tags": [], "owner": {"reputation": 538, "user_id": 4098628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d6dc62ac2b1b581d62f13f8525ff233?s=128&d=identicon&r=PG&f=1", "display_name": "Azwaw", "link": "https://stackoverflow.com/users/4098628/azwaw"}, "is_accepted": false, "score": 3, "last_activity_date": 1431548484, "last_edit_date": 1431548484, "creation_date": 1431547843, "answer_id": 30224321, "question_id": 30220421, "link": "https://stackoverflow.com/questions/30220421/unix-file-descriptor/30224321#30224321", "title": "Unix file descriptor", "body": "<p>Try to do an fsync on your directory. You should open directory with O_RDONLY flags. O_WRONLY will fail. Create a file and sync may not sync metadata for this file. More informations in <a href=\"http://blog.httrack.com/blog/2013/11/15/everything-you-always-wanted-to-know-about-fsync/\" rel=\"nofollow\">this article</a></p>\n"}], "owner": {"reputation": 595, "user_id": 1274868, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/bf94875f746c352d74cd9863420dc62c?s=128&d=identicon&r=PG", "display_name": "Lobster", "link": "https://stackoverflow.com/users/1274868/lobster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1431548484, "creation_date": 1431534337, "last_edit_date": 1431546943, "question_id": 30220421, "link": "https://stackoverflow.com/questions/30220421/unix-file-descriptor", "title": "Unix file descriptor", "body": "<p>Today I found very interesting behavior of file descriptors in Linux. Look at that code:</p>\n\n<pre><code>#include &lt;dirent.h&gt;     /* Defines DT_* constants */\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;errno.h&gt;\n\n\n#define handle_error(msg) \\\ndo { trace(msg); exit(0); } while (0)\n#define trace printf\n\nint createFile(const char* name) {\n    int r;\n    r = ::open( name, 0 );\n    if (r &lt; 0)\n    {\n        trace(\"create file : %s\\n\", name);\n        r = ::open( name, O_CREAT, 0666 );\n        if (r &lt; 0)\n            trace(\"error r &lt; 0 %d\\n\",errno);\n    }\n    return r;\n}\n\nint createDir(const char* name) {\n    int r = ::mkdir( name, 0777 );\n    if (r != 0) {\n        trace(\"error r!=0\\n\");\n    }\n    r = open(name, 0);\n    if (r &lt; 0) {\n        trace(\"error create dir r &lt;0\\n\");\n    }\n    return r;\n}\n\nstruct linux_dirent {\n    long           d_ino;\n    off_t          d_off;\n    unsigned short d_reclen;\n    char           d_name[];\n};\n\n#include &lt;sys/types.h&gt;\n#include &lt;dirent.h&gt;\nvoid test123(int fd) {\n    int nread;\n    char buf[1024];\n    unsigned char buffer[1024];\n    struct linux_dirent *d;\n    int bpos,r;\n    char d_type;\n\n\n    if (fd == -1)\n        handle_error(\"open\");\n\n    for ( ; ; ) {\n        nread = syscall(SYS_getdents, fd, buf, 1024);\n        if (nread == -1)\n            handle_error(\"getdents\");\n\n        if (nread == 0)\n            break;\n\n        trace(\"--------------- nread=%d ---------------\\n\", nread);\n        trace(\"i-node#  file type  d_reclen  d_off   d_name\\n\");\n        for (bpos = 0; bpos &lt; nread;) {\n            d = (struct linux_dirent *) (buf + bpos);\n            trace(\"%8ld  \", d-&gt;d_ino);\n            d_type = *(buf + bpos + d-&gt;d_reclen - 1);\n            trace(\"%4d %10lld  %s\\n\", d-&gt;d_reclen,\n                  (long long) d-&gt;d_off, d-&gt;d_name);\n            bpos += d-&gt;d_reclen;\n        }\n    }\n}\n\n\nint main(int argc, const char * argv[]) {\n\n\n\n    int dir = createDir(\"test\");\n\n    int file = createFile(\"test/file.gg\");\n\n    test123(dir);\n    close(dir);\n    close(file);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>in that code I create folder, save its file descriptor, create file in that folder and after I want to print all files in that directory via file descriptors. However I get this output:</p>\n\n<pre><code>create file : test/file.gg\n--------------- nread=32 ---------------\ni-node#  file type  d_reclen  d_off   d_name\n   48879    16          1  .\n   48880    16          2  ..\n</code></pre>\n\n<p>There is no file.gg file in that folder. So, my question is - how it can be and how to work correctly with file descriptors? As I understand file descriptor is just an index in local for process table with all opened files and directories. But it is looks like that folder descriptor caches somehow files in that folder.\nHow to work correctly with descriptors in my case?</p>\n"}, {"tags": ["c++", "arrays", "loops", "struct"], "comments": [{"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 1, "creation_date": 1431534523, "post_id": 30220404, "comment_id": 48544816, "body": "please provide the code where you are declaring <code>polygon</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1431534616, "post_id": 30220404, "comment_id": 48544881, "body": "Your posted code has no IO whatsoever, so we have no idea how that output is being produced <i>at all</i>. And add the declarations of <code>arrayx</code> and <code>arrayy</code> to the missing-persons list. If all three are arrays <code>[5]</code> then your loop is exceeding the boundary declarations due to <code>j &lt;= k</code> in the for-conditional rather than <code>j &lt; k</code>."}, {"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 1, "creation_date": 1431534799, "post_id": 30220404, "comment_id": 48544995, "body": "You&#39;ll need to provide a full working example. Why are arrayx and arrayy 0? Are they pointers that haven&#39;t been given an allocation yet? That would be a big problem."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1431535976, "post_id": 30220404, "comment_id": 48545687, "body": "It still isn&#39;t right. You still haven&#39;t included the declarations of any of the vars requested in the first two comments. The list of things missing to make this a <a href=\"https://stackoverflow.com/help/mcve\"><b>Minimum, Complete and Verifiable Example</b></a> is still non-trivial, including <code>int main {</code> isn&#39;t even valid C++. Regardless, your for-loop is wrong. It should be <code>j &lt; n</code>, not <code>j &lt;= k</code>, and depending on the declarations of <code>polygons</code>, <code>arrayx</code>, and <code>arrayy</code> that continue to elude us, the upper <code>while</code> loop is likely also wrong."}, {"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 0, "creation_date": 1431536001, "post_id": 30220404, "comment_id": 48545707, "body": "polygon, arrayx and arrayy are not declared anywhere. Please provide code that will compile."}, {"owner": {"reputation": 158, "user_id": 2576748, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N4PTZ.jpg?s=128&g=1", "display_name": "isifzade", "link": "https://stackoverflow.com/users/2576748/isifzade"}, "edited": false, "score": 0, "creation_date": 1431536162, "post_id": 30220404, "comment_id": 48545806, "body": "I have changed, please look again. If you will have any question, please inform me"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1431536427, "post_id": 30220404, "comment_id": 48545967, "body": "@isifzade Did you consider to inspect your code stepping through line by line with a debugger?"}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 2576748, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N4PTZ.jpg?s=128&g=1", "display_name": "isifzade", "link": "https://stackoverflow.com/users/2576748/isifzade"}, "edited": false, "score": 0, "creation_date": 1431536671, "post_id": 30221097, "comment_id": 48546108, "body": "OMG! it works now. Thank you!"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1431536505, "creation_date": 1431536505, "answer_id": 30221097, "question_id": 30220404, "link": "https://stackoverflow.com/questions/30220404/cannot-give-value-to-struck-array-variable-in-a-loop/30221097#30221097", "title": "cannot give value to struck array/variable in a loop", "body": "<p>You are not going to be able to assign anything to the array as the array is empty</p>\n\n<pre><code>Point polygon[]={};\n</code></pre>\n\n<p>This should be causing a compiler error as 0 sized arrays are not allowed in standard C++.</p>\n"}], "owner": {"reputation": 158, "user_id": 2576748, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N4PTZ.jpg?s=128&g=1", "display_name": "isifzade", "link": "https://stackoverflow.com/users/2576748/isifzade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "closed_date": 1431580590, "accepted_answer_id": 30221097, "answer_count": 1, "score": -2, "last_activity_date": 1431536505, "creation_date": 1431534282, "last_edit_date": 1431536349, "question_id": 30220404, "link": "https://stackoverflow.com/questions/30220404/cannot-give-value-to-struck-array-variable-in-a-loop", "closed_reason": "Not suitable for this site", "title": "cannot give value to struck array/variable in a loop", "body": "<p>I am trying to give coordinates to polygon. <code>arrayx</code> and <code>arrayy</code> are the arrays which contain my x and y coordinates. The problem is, I cannot give the values of my arrays to <code>polygon</code> Point structure. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nstruct Point\n{\n    int x,y;\n};\n\nint main()\n{    \n\n  Point polygon[]={};\n  int n=0, arrayx[1024] = {0} , arrayy[1024] = {0};\n\n   //input\n   ifstream iFile;\n   iFile.open(\"in.txt\");\n\n        while(iFile &gt;&gt; arrayx[n] &gt;&gt; arrayy[n])\n        {\n\n            n = n + 1;\n        }\n\n    iFile.close(); \n\n    int k=n;          \n    for (int j=0; j&lt;= k; j++)\n    {\n        polygon[j] = (Point){arrayx[j],arrayy[j]}; //something wrong here\n\n        //output\n        ofstream myfile;\n        myfile.open (\"out3.txt\", ios::app);\n        myfile  &lt;&lt;\"k = \" &lt;&lt;k &lt;&lt; \"----\" &lt;&lt;j &lt;&lt; \") polygon.x = \"&lt;&lt; polygon[j].x  &lt;&lt;\" arrayx = \"&lt;&lt;arrayx[j] &lt;&lt; \" polygon[j].y = \"&lt;&lt; polygon[j].y  &lt;&lt;\" arrayy = \"&lt;&lt;arrayy[j] &lt;&lt; \"\\n\";\n        myfile.close();\n    }\n}\n</code></pre>\n\n<p>I also tried change  code like below:</p>\n\n<pre><code>polygon[j].x = arrayx[j];\npolygon[j].y = arrayy[j];\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>260 673\n565 735\n780 619\n746 408\n333 400\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>k = 260 \nj = 673    \npolygon[j].x = 7209071     \narrayx = 0 \npolygon[j].y = 7471220 \narrayy = 0\n</code></pre>\n\n<p>Suddenly <code>k</code> changes its value to 260. variable of loop <code>j</code> goes to 673, (not j=0,1,2,3,4,5 only one time loping and breaks) even <code>arrays[673]</code> are empty, <code>polygon</code> gets some numbers. </p>\n\n<p>I do not have much experience about c++, it is hard to me solve it by alone. </p>\n"}, {"tags": ["c++", "arrays", "access-violation", "voxels"], "comments": [{"owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431546688, "post_id": 30220398, "comment_id": 48551881, "body": "I have a open-source voxel world implemented in c++; I did it by creating a <a href=\"https://github.com/programmerjake/voxels-0.7/blob/master/include/util/block_iterator.h\" rel=\"nofollow noreferrer\"><code>BlockIterator</code></a> class that handles translating from global positions to chunks/chunk local positions. also here&#39;s the definition for a <a href=\"https://github.com/programmerjake/voxels-0.7/blob/master/include/util/basic_block_chunk.h#L41\" rel=\"nofollow noreferrer\">block chunk</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "reply_to_user": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "edited": false, "score": 0, "creation_date": 1431557744, "post_id": 30220398, "comment_id": 48556947, "body": "After skimming the 1370 odd lines I fail to see how that is supposed to help me (mainly because I don&#39;t have the time to study the code in depth and actually decipher what all those lines do in relation to each other and if I did have that sort of time I would download the source to something like minetest and start reading that)."}], "answers": [{"tags": [], "owner": {"reputation": 1744, "user_id": 2597900, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7a6a8c9e5f836f6874969a8a59801fb6?s=128&d=identicon&r=PG", "display_name": "programmerjake", "link": "https://stackoverflow.com/users/2597900/programmerjake"}, "is_accepted": false, "score": 1, "last_activity_date": 1431560509, "last_edit_date": 1431560509, "creation_date": 1431559633, "answer_id": 30226833, "question_id": 30220398, "link": "https://stackoverflow.com/questions/30220398/check-neighbouring-voxels-efficiently-in-3d-array-of-size-n/30226833#30226833", "title": "Check neighbouring voxels efficiently in 3D array of size n", "body": "<p>I would use something like:</p>\n\n<pre><code>class BlockChunk final\n{\npublic:\n    static constexpr int sizeXShift = 4, sizeYshift = 8, sizeZshift = 4;\n    static constexpr int sizeX = 1 &lt;&lt; sizeXShift; // 2 ** sizeXShift\n    static constexpr int sizeY = 1 &lt;&lt; sizeYShift; \n    static constexpr int sizeZ = 1 &lt;&lt; sizeZShift;\n    static constexpr int sizeXRelativeMask = sizeX - 1; // mask to get position mod sizeX (faster than % because negative inputs to % return negative answers which need more adjusting whereas masking always returns the positive answer)\n    static constexpr int sizeYRelativeMask = sizeY - 1;\n    static constexpr int sizeZRelativeMask = sizeZ - 1;\n    static constexpr int sizeXChunkBaseMask = ~sizeXRelativeMask; // mask to get position - relativePosition (aka chunk base position)\n    static constexpr int sizeYChunkBaseMask = ~sizeYRelativeMask;\n    static constexpr int sizeZChunkBaseMask = ~sizeZRelativeMask;\nprivate:\n    Block blocks[sizeX][sizeY][sizeZ];\npublic:\n    const PositionI basePosition;\n    BlockChunk(PositionI basePosition)\n        : basePosition(basePosition)\n    {\n    }\n    Block &amp;at(PositionI relative)\n    {\n        assert(relative.x &gt;= 0 &amp;&amp; relative.x &lt; sizeX);\n        assert(relative.y &gt;= 0 &amp;&amp; relative.y &lt; sizeY);\n        assert(relative.z &gt;= 0 &amp;&amp; relative.z &lt; sizeZ); // these asserts are important for finding out-of-bounds bugs\n        return blocks[relative.x][relative.y][relative.z];\n    }\n    static PositionI getRelativePosition(PositionI p)\n    {\n        p.x &amp;= sizeXRelativeMask;\n        p.y &amp;= sizeYRelativeMask;\n        p.z &amp;= sizeZRelativeMask;\n        return p;\n    }\n    static PositionI getChunkBasePosition(PositionI p)\n    {\n        p.x &amp;= sizeXChunkBaseMask;\n        p.y &amp;= sizeYChunkBaseMask;\n        p.z &amp;= sizeZChunkBaseMask;\n        return p;\n    }\n};\n\nclass BlockIterator;\n\nclass BlockWorldBase\n{\n    friend class BlockIterator;\nprivate:\n    std::unordered_map&lt;PositionI, std::shared_ptr&lt;BlockChunk&gt;&gt; chunks;\n    BlockChunk *getOrMakeChunk(PositionI chunkBasePosition)\n    {\n        std::shared_ptr&lt;BlockChunk&gt; &amp;chunk = chunks[chunkBasePosition];\n        if(chunk == nullptr)\n            chunk = std::make_shared&lt;BlockChunk&gt;(chunkBasePosition);\n        return chunk.get();\n    }\n};\n\nclass BlockWorld;\n\nclass BlockIterator final\n{\n    friend class BlockWorld;\nprivate:\n    BlockChunk *chunk;\n    BlockWorldBase *world;\n    PositionI chunkBasePosition, relativePosition;\n    void updateChunk()\n    {\n        chunk = world-&gt;getOrMakeChunk(chunkBasePosition);\n    }\n    BlockIterator(BlockWorldBase *world, PositionI position)\n        : chunk(), \n        world(world),\n        chunkBasePosition(BlockChunk::getChunkBasePosition(position)),\n        relativePosition(BlockChunk::getRelativePosition(position))\n    {\n        updateChunk();\n    }\npublic:\n    PositionI getPosition() const\n    {\n        return relativePosition + chunkBasePosition;\n    }\n    Block &amp;get()\n    {\n        return chunk-&gt;at(relativePosition);\n    }\n    BlockIterator &amp;operator +=(PositionI deltaPosition) // move to point to a new block\n    {\n        PositionI newRelativePosition = relativePosition + deltaPosition;\n        if(BlockChunk::getRelativePosition(newRelativePosition) != newRelativePosition) // if the new position is outside of this chunk\n        {\n            relativePosition = BlockChunk::getRelativePosition(newRelativePosition);\n            chunkBasePosition += BlockChunk::getChunkBasePosition(newRelativePosition);\n            updateChunk();\n        }\n        else\n        {\n            relativePosition = newRelativePosition;\n        }\n    }\n    friend BlockIterator operator +(PositionI p, BlockIterator bi)\n    {\n        bi += p;\n        return bi;\n    }\n    friend BlockIterator operator +(BlockIterator bi, PositionI p)\n    {\n        bi += p;\n        return bi;\n    }\n};\n\nclass BlockWorld final : public BlockWorldBase\n{\npublic:\n    BlockIterator getIterator(PositionI p)\n    {\n        return BlockIterator(this, p);\n    }\n};\n</code></pre>\n\n<p>If you leave the asserts in and access thru BlockIterator you shouldn't ever seg-fault</p>\n\n<pre><code>void drawBlock(Renderer &amp;renderer, BlockIterator bi)\n{\n    BlockIterator nxBlockIterator = bi + PositionI(-1, 0, 0);\n    BlockIterator pxBlockIterator = bi + PositionI(1, 0, 0);\n    BlockIterator nyBlockIterator = bi + PositionI(0, -1, 0);\n    BlockIterator pyBlockIterator = bi + PositionI(0, 1, 0);\n    BlockIterator nzBlockIterator = bi + PositionI(0, 0, -1);\n    BlockIterator pzBlockIterator = bi + PositionI(0, 0, 1);\n    if(nxBlockIterator.get().isPXFaceBlocked())\n        bi.get().renderNXFace(renderer, bi);\n    if(pxBlockIterator.get().isNXFaceBlocked())\n        bi.get().renderPXFace(renderer, bi);\n    if(nyBlockIterator.get().isPYFaceBlocked())\n        bi.get().renderNYFace(renderer, bi);\n    if(pyBlockIterator.get().isNYFaceBlocked())\n        bi.get().renderPYFace(renderer, bi);\n    if(nzBlockIterator.get().isPZFaceBlocked())\n        bi.get().renderNZFace(renderer, bi);\n    if(pzBlockIterator.get().isNZFaceBlocked())\n        bi.get().renderPZFace(renderer, bi);\n    bi.get().renderCenter(renderer, bi);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19025, "user_id": 17826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a7aca325b6be746ea9e9ae17ff5b6b?s=128&d=identicon&r=PG", "display_name": "Mark Bessey", "link": "https://stackoverflow.com/users/17826/mark-bessey"}, "is_accepted": false, "score": 0, "last_activity_date": 1431560641, "creation_date": 1431560641, "answer_id": 30227015, "question_id": 30220398, "link": "https://stackoverflow.com/questions/30220398/check-neighbouring-voxels-efficiently-in-3d-array-of-size-n/30227015#30227015", "title": "Check neighbouring voxels efficiently in 3D array of size n", "body": "<p>You don't show how the b_blocks variable is declared or initialized, but given that you're getting a segmentation error, it's likely you declared it as a smaller size than your CHUNK_SIZE. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2717116"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1431560641, "creation_date": 1431534257, "question_id": 30220398, "link": "https://stackoverflow.com/questions/30220398/check-neighbouring-voxels-efficiently-in-3d-array-of-size-n", "title": "Check neighbouring voxels efficiently in 3D array of size n", "body": "<p>My voxel system uses a flat 3D array dynamically allocated at runtime for each chunk, however generating millions of cubes per chunk isn't feasible so I need to optimize.</p>\n\n<p>The first optimization I intend to implement is of course to not generate mesh data for occluded voxels, this is a good idea on paper but I don't know how to do it.</p>\n\n<p>All my attempts have ended up with hard to debug memory allocation issues and as such I have to throw the towel in and ask more knowledgeable people as I'm at loss.</p>\n\n<p>My current incarnation of this is as such</p>\n\n<pre><code>int8_t x = 0, y= 0, z = 0;\nconst int MAX = CHUNKSIZE-1;\nconst int MIN = 0;\n\n\nint8_t sPosX = (x - 1 &lt; MIN) ? x : x-1;\nint8_t sPosY = (y - 1 &lt; MIN) ? y : y-1;\nint8_t sPosZ = (z - 1 &lt; MIN) ? z : z-1;\n\nint8_t ePosX = (x + 1 &gt; MAX) ? x : x+1;\nint8_t ePosY = (y + 1 &gt; MAX) ? y : y+1;\nint8_t ePosZ = (z + 1 &gt; MAX) ? z : z+1;\nint8_t a=sPosX, b=sPosY, c=sPosZ;\nint8_t add = 0;\n\n\nBlockType BT = BT_grass;\nscene::SMesh* mesh = new scene::SMesh();\nfor(x = 0; x &lt;= MAX; x++)\n{\n    for(y = 0; y &lt;= MAX; y++)\n    {\n        for(z = 0; z &lt;= MAX; z++)\n        {\n            cm = b_blocks[x][y][z].material;\n            //b_blocks[x][y][z].setFlags(0xFE, BT);\n            if( !b_blocks[x][x][z].isActive() )\n            {\n                continue;\n            }\n            else\n            {\n                if(sPosX == MIN)\n                {\n                    createCube(x,y,z,c,mesh,cm);\n                }\n\n                else\n                {\n                    if(a&lt;=ePosX) \n                    {\n                        if(b&lt;=ePosY) \n                        {\n                            if(c&lt;=ePosZ) \n                            {\n                                printf(\"x %d, y %d, z %d\\n\", x, y, z);\n                                if(!b_blocks[x][y][z].isActive())\n                                {\n                                    add = 1;\n                                }\n                            }\n                        }\n                    }\n                    if(add == 1)\n                    {\n                        createCube(x,y,z,c,mesh,cm);\n                        add = 0;\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The if(sPosX == MIN) is a hack I implemented to not segfault on generating the chunk (otherwise it segfaults with a memory access violation on generating block[CHUNKSIZE][CHUNKSIZE][CHUNKSIZE], which isn't very nice.\nThis hack inadvertently makes sure that all cubes are generated however and is just as unappealing.</p>\n\n<p>The concise questions here are as follows:\nWhat part of my logic is broken? (presumably all of it) and how would one properly check neighbouring blocks in a fast manner that does not cause an out of bounds error? (I tried by manually coding exceptions for every last corner case but that proved to be unmaintainable and was orders of magnitude slower and prone to segfaulting)</p>\n"}, {"tags": ["c++", "serialization", "vector"], "comments": [{"owner": {"reputation": 471, "user_id": 3967987, "user_type": "registered", "profile_image": "https://graph.facebook.com/533007798/picture?type=large", "display_name": "ivanw", "link": "https://stackoverflow.com/users/3967987/ivanw"}, "edited": false, "score": 0, "creation_date": 1431534378, "post_id": 30220376, "comment_id": 48544717, "body": "<a href=\"http://stackoverflow.com/questions/3523832/serialization-of-complex-structures-in-c\" title=\"serialization of complex structures in c\">stackoverflow.com/questions/3523832/&hellip;</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1431534920, "post_id": 30220376, "comment_id": 48545066, "body": "If you say <i>serialize</i>, do you want to save a text format, or binary data? The former could be handled by overwriting <code>std::ostream operator&lt;&lt;()</code>, and <code>std::istream operator&gt;&gt;()</code> specialized for your class."}, {"owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "edited": false, "score": 0, "creation_date": 1431534961, "post_id": 30220376, "comment_id": 48545094, "body": "I want it in binary format.."}], "answers": [{"tags": [], "owner": {"reputation": 272, "user_id": 4891104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aec6d4aa61032ee5e2f727772f0c1ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Semen Tykhonenko", "link": "https://stackoverflow.com/users/4891104/semen-tykhonenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1431535285, "creation_date": 1431535285, "answer_id": 30220709, "question_id": 30220376, "link": "https://stackoverflow.com/questions/30220376/c-serializing-a-vector-of-class-instances/30220709#30220709", "title": "C++ : serializing a vector of class instances", "body": "<p>You can write outers size, and after that write each outer using the following function. After that you can read each outer back using read function.</p>\n\n<pre><code>void write(ostream&amp; os, outer a)\n{\n  os.write((const char*)a.a(), sizeof(int));\n  // write inners size\n  os.write((const char*)a.all_inners.size(), sizeof(size_t));\n  for(const inner&amp; in : a.all_inners)\n  {\n    os.write((const char*)in.a, sizeof(int));\n  }\n}\n\nvoid read(istream&amp; is, outer&amp; a)\n{\n  is.read((char*)a.a, sizeof(int));\n  size_t size;\n  is.read((char*)size, sizeof(size_t));\n  a.all_inners.resize(size);\n  for(int i = 0; i &lt; size; i++)\n  {\n    int value;\n    is.read((char*)value, sizeof(int));\n    a.all_inners[i].a = value;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 4052, "user_id": 681911, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b6a148a0324041ca20efca580cec1e4d?s=128&d=identicon&r=PG", "display_name": "sanjeev mk", "link": "https://stackoverflow.com/users/681911/sanjeev-mk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431535285, "creation_date": 1431534198, "question_id": 30220376, "link": "https://stackoverflow.com/questions/30220376/c-serializing-a-vector-of-class-instances", "title": "C++ : serializing a vector of class instances", "body": "<p>I want to save a vector of class instances to a file, to be able to load them in later.</p>\n\n<p>This is how the class looks like (roughly):    </p>\n\n<pre><code>class outer{\n    public:\n        int a;\n        class inner{\n            public:\n                int a;\n                inner(int a){\n                     this-&gt;a = a;\n                }\n        };\n\n        vector&lt;inner&gt; all_inners;\n        outer(int a){\n            this-&gt;a = a;\n            all_inners.push_back(inner(this-&gt;a+1));\n        }\n};\n</code></pre>\n\n<p>The vector of class <code>outer</code> instances, and how it might be populated:  </p>\n\n<pre><code>vector&lt;outer&gt; all_outers;\nint i;\nvoid some_function(){\n    for(i=0; i&lt;5;i++)\n        all_outers.push_back(outer(i));\n}\n</code></pre>\n\n<p>I want to serialize the <code>all_outers</code> vector to a file, and when I read it back in, I'd like to have the exact same state of the class instances (including the inner class instances) as it was when written to the file.<br>\nIs something like this possible?  </p>\n"}, {"tags": ["c++", "debugging", "dll", "visual-studio-2005"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2694887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f5600e00f2a981b049d0a20688c429b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Knudson", "link": "https://stackoverflow.com/users/2694887/jack-knudson"}, "edited": false, "score": 0, "creation_date": 1431534941, "post_id": 30220557, "comment_id": 48545082, "body": "Thanks for the response. That&#39;s a good point. And yes, the build settings are on &quot;debug,&quot; and additionally, I&#39;ve set the linker to generate debug info as well"}, {"owner": {"reputation": 51, "user_id": 2694887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f5600e00f2a981b049d0a20688c429b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Knudson", "link": "https://stackoverflow.com/users/2694887/jack-knudson"}, "edited": false, "score": 0, "creation_date": 1431535271, "post_id": 30220557, "comment_id": 48545271, "body": "I&#39;ve also tried making a &quot;clean&quot; build, restarting VS, deleting the .bin/.obj files, and deleting the .suo file. To no avail."}, {"owner": {"reputation": 51, "user_id": 2694887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f5600e00f2a981b049d0a20688c429b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Knudson", "link": "https://stackoverflow.com/users/2694887/jack-knudson"}, "edited": false, "score": 0, "creation_date": 1431537439, "post_id": 30220557, "comment_id": 48546557, "body": "Furthermore, in the output dialog, it actually says that symbols were loaded for the necessary files in question, but it says that the .dll was not built with debug information. Help!"}], "tags": [], "owner": {"reputation": 9996, "user_id": 2360695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/542ff60c0222369f65f9af25daacc03d?s=128&d=identicon&r=PG", "display_name": "ScottMcP-MVP", "link": "https://stackoverflow.com/users/2360695/scottmcp-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1431534790, "creation_date": 1431534790, "answer_id": 30220557, "question_id": 30220351, "link": "https://stackoverflow.com/questions/30220351/debugging-a-c-program-that-uses-a-3rd-party-dll/30220557#30220557", "title": "Debugging a C++ Program that uses a 3rd party dll", "body": "<p>Visual Studio has no problem debugging exe files that use DLLs for which you do not have source code. This is commonly the case for programs that use the built-in Windows DLLs, for example. Are you debugging a debug build of your exe project? </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2694887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f5600e00f2a981b049d0a20688c429b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Knudson", "link": "https://stackoverflow.com/users/2694887/jack-knudson"}, "is_accepted": true, "score": 0, "last_activity_date": 1431537827, "creation_date": 1431537827, "answer_id": 30221494, "question_id": 30220351, "link": "https://stackoverflow.com/questions/30220351/debugging-a-c-program-that-uses-a-3rd-party-dll/30221494#30221494", "title": "Debugging a C++ Program that uses a 3rd party dll", "body": "<p>Resolved:</p>\n\n<p>Configuration Properties -> C/C++ -> General -> Debug Information Format was disabled. Setting this to Program Database (/Zi) fixed this issue.</p>\n"}], "owner": {"reputation": 51, "user_id": 2694887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6f5600e00f2a981b049d0a20688c429b?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Knudson", "link": "https://stackoverflow.com/users/2694887/jack-knudson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 30221494, "answer_count": 2, "score": 0, "last_activity_date": 1431537827, "creation_date": 1431534108, "question_id": 30220351, "link": "https://stackoverflow.com/questions/30220351/debugging-a-c-program-that-uses-a-3rd-party-dll", "title": "Debugging a C++ Program that uses a 3rd party dll", "body": "<p>I'm currently working on a project that uses a 3rd party .dll to interface with some hardware, and wanted to debug my code that uses this library. However, none of the breakpoints that I set are hit during execution of the code. Instead, the breakpoints are hollow and a pop-up bubble states \"This breakpoint will not currently be hit. No symbols have been loaded for this document\". I think this is because of the fact that I'm using a 3rd party dll for which I do not have the source code.</p>\n\n<p>I found many, many answers for debugging .dlls, but I could not find any for debugging code that uses other .dlls. My question is how can I step through my code, and get these breakpoints to work properly?</p>\n\n<p>I'm using MS VS 2005.</p>\n"}, {"tags": ["c++", "c", "exception"], "comments": [{"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1431534069, "post_id": 30220263, "comment_id": 48544493, "body": "@iharob: But the question is about the interaction between C and C++ (specifically, throwing an exception in a function called from C)."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1431534223, "post_id": 30220263, "comment_id": 48544595, "body": "Isn&#39;t there something possible like setting an <code>at_exit()</code> handler IIRC?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1431534238, "post_id": 30220263, "comment_id": 48544605, "body": "@MikeSeymour I see, is there a way to do that? I don&#39;t think you can link to a c++ library from a c program that uses c++ specific features like function overloading or exceptions. Suppose that you were to declare the function prototype in c, what would it look like? it would require <code>extern &quot;C&quot;</code> in the c++ program, which might prevent function overloading or exceptions, I am just guessing of course."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1431534321, "post_id": 30220263, "comment_id": 48544685, "body": "@iharob: This is a C++ program with one function written in C, not a C program. As for what it would look like: it would look just like the code in the question. Perhaps you should read the question before commenting further."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1431534610, "post_id": 30220263, "comment_id": 48544874, "body": "Under what conditions does the library call <code>exit</code>?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1431534772, "post_id": 30220263, "comment_id": 48544979, "body": "There are two reasons for a library to invoke <code>exit()</code>. The first is total and utter cluelessness of the programmer who thinks that this is a valid way to handle errors. I&#39;d prefer keeping distance from such libraries. The other case is a fatal condition that normal error handling can&#39;t fix, like e.g. the vital plugin directory doesn&#39;t exist or some programming error is detected. Even there, using <code>abort()</code> instead to trigger the debugger would be the preferred choice. With that in mind, I&#39;d second David&#39;s question why the library calls <code>exit()</code> at all."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1431535183, "post_id": 30220263, "comment_id": 48545222, "body": "FWIW this code works for me with GCC 4.8.1 on Linux; but other compilers might behave differently when exceptions propagate through C functions."}, {"owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "edited": false, "score": 0, "creation_date": 1431535224, "post_id": 30220263, "comment_id": 48545251, "body": "<code>exit()</code> is called under &quot;error conditions when the program should close&quot; but my question isn&#39;t &quot;is this a good way to do things?&quot;. I have to use this library, can&#39;t change it, and I&#39;m trying to make things play nicer with C++."}, {"owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "reply_to_user": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1431535927, "post_id": 30220263, "comment_id": 48545660, "body": "@MikeSeymour I had been trying this on 32-bit RHEL 6 (GCC 4.4.7-11) so I tried it on a 64-bit RHEL 7 machine (GCC 4.8.3-9) and it worked just fine. I then tried on a 64-bit RHEL 6 machine and it worked as well. So is this just a bug with GCC on 32-bit systems?"}, {"owner": {"reputation": 771, "user_id": 1203839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58aff6504ff14291eb19032b17b0e469?s=128&d=identicon&r=PG", "display_name": "Gerard", "link": "https://stackoverflow.com/users/1203839/gerard"}, "edited": false, "score": 3, "creation_date": 1431536010, "post_id": 30220263, "comment_id": 48545716, "body": "If all else fails, you can run the library via <code>fork</code> calls."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1431538161, "post_id": 30220263, "comment_id": 48546920, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6: <code>at_exit()</code> doesn&#39;t really help here. The program still terminates after any registered functions are called. You could have an <code>at_exit()</code>-registered function call something that continues doing the program&#39;s work, but when <code>exit()</code> is called again after that (including normal termination of <code>main()</code>), the behavior is undefined."}, {"owner": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "edited": false, "score": 0, "creation_date": 1431539545, "post_id": 30220263, "comment_id": 48547794, "body": "I don&#39;t have handy access to a x86 machine to check, but having done broadly similar things before, I suggest you look at gcc&#39;s <code>-nostdlib</code> and <code>-print-libgcc-file-name</code> options. What&#39;s happening, I think, is that <code>g++</code> is invoking the linker with the standard runtime <i>in front of</i> the file with your redefinition of <code>exit</code>, and the linker search order therefore finds the standard <code>exit</code> first. You want the search order to be <code>main</code>, (your module defining <code>exit</code>), and <i>then</i> <code>-lgcc</code>. So something like <code>g++ -nostdlib test_exception_c.o test_exception_cpp.o -o test_exception -lgcc</code> might do it."}, {"owner": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "edited": false, "score": 0, "creation_date": 1431540546, "post_id": 30220263, "comment_id": 48548346, "body": "Afterthought: it&#39;s probably obvious, but you should use <code>g++ -v</code> to look at the linker line that <code>g++</code> generates, which may make it clear, by the order of the arguments to the linker, where the problem is coming from."}, {"owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "reply_to_user": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "edited": false, "score": 0, "creation_date": 1431542534, "post_id": 30220263, "comment_id": 48549478, "body": "@NormanGray The order of everything was basically the same with the minor exception being that x64 had extra paths to lib64. Here were the differences in parameters: &quot;--with-arch=i686 vs --with-arch_32=i686&quot;, &quot;-march=i686 vs Nothing&quot; and &quot;-m elf_i386 vs -m el_x86_64&quot;."}, {"owner": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "edited": false, "score": 0, "creation_date": 1431547890, "post_id": 30220263, "comment_id": 48552515, "body": "@DaveJohansen <code>exit</code> might well be in <code>lib64</code> (probably, but I don&#39;t know). Myself, I would try <code>-nostdlib</code> and friends, to push <code>lib64</code> to the end of the list. It would rule that out, at least."}, {"owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "reply_to_user": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "edited": false, "score": 0, "creation_date": 1431551768, "post_id": 30220263, "comment_id": 48554519, "body": "@NormanGray I know that my version of <code>exit</code> is being called because it prints that &quot;terminate called after throwing ...&quot; and that wouldn&#39;t be happening if my version of <code>exit</code> wasn&#39;t being called. Also, linking with <code>-nostdlib</code> causes a bunch of undefined references so I don&#39;t believe that that is the issue."}, {"owner": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "edited": false, "score": 0, "creation_date": 1431552192, "post_id": 30220263, "comment_id": 48554715, "body": "@DaveJohansen Ah well. Onward and upward, eh..."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1431840350, "post_id": 30220263, "comment_id": 48665397, "body": "Even if this worked, this would have the side-effect of breaking <code>exit</code> in legitimate cases \u2026"}], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "edited": false, "score": 0, "creation_date": 1431963592, "post_id": 30283636, "comment_id": 48710207, "body": "I agree completely with the advice. Sorry I wasn&#39;t more clear in the original post. My intention was not to &quot;recall the library&quot; or &quot;stop the program from exiting&quot;, but just to let all of the destructors be called so that resources could be released properly and such."}, {"owner": {"reputation": 414, "user_id": 4889365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OlLkh.jpg?s=128&g=1", "display_name": "denis bider", "link": "https://stackoverflow.com/users/4889365/denis-bider"}, "reply_to_user": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "edited": false, "score": 0, "creation_date": 1432042583, "post_id": 30283636, "comment_id": 48748823, "body": "As much as possible, a program should use resources in such a way that it&#39;s sufficient for the OS to release them when the program exits. There are circumstances, such as system shutdown, when the OS will kill your program without further notice. The program may also be killed by a user. It may be killed by an SSH server upon SSH session ending - which in turn may be caused by something as simple and uncontrollable as network disconnect.  If logging or signaling or other output is required to indicate the reason for exit, I would trigger that from a function that executes on exit. Then, exit."}], "tags": [], "owner": {"reputation": 414, "user_id": 4889365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OlLkh.jpg?s=128&g=1", "display_name": "denis bider", "link": "https://stackoverflow.com/users/4889365/denis-bider"}, "is_accepted": false, "score": 2, "last_activity_date": 1431840002, "creation_date": 1431840002, "answer_id": 30283636, "question_id": 30220263, "link": "https://stackoverflow.com/questions/30220263/can-exit-from-a-library-be-replaced-with-throwing-an-exception/30283636#30283636", "title": "Can exit() from a library be replaced with throwing an exception?", "body": "<p>I understand you may not want to read this, but it's most likely a mistake to continue executing a program after <em>any</em> part of it has attempted to call <code>exit()</code> or similar.</p>\n\n<p>If part of the program called <code>exit()</code>, you have no guarantees about the state of the program at that point. You don't know if the heap is in a consistent state. You don't know if the stack is any good. If you convert the <code>exit()</code> into a <code>throw</code>, the <em>very</em> least you're likely to encounter are memory leaks each time this happens. You don't know if the library that caused this error can be safely called again.</p>\n\n<p>If you have inspected the library's source code, and you're certain that no corruption will result, then the cleanest solution would be to modify the library itself, so that it throws instead of exiting.</p>\n\n<p>If changing the library is not permissible, the other clean and correct solution is to put all usage of the library into a separate process which you can monitor and restart.</p>\n"}, {"tags": [], "owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1431963484, "creation_date": 1431963484, "answer_id": 30307419, "question_id": 30220263, "link": "https://stackoverflow.com/questions/30220263/can-exit-from-a-library-be-replaced-with-throwing-an-exception/30307419#30307419", "title": "Can exit() from a library be replaced with throwing an exception?", "body": "<p>The above code works, but on x86 before gcc 4.6, -fexceptions or -funwind-tables needs to be added when building the C code so that the stack unwinding can happen. You can see the <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1222110#c5\" rel=\"nofollow\">details here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 0, "last_activity_date": 1431982713, "creation_date": 1431982713, "answer_id": 30312712, "question_id": 30220263, "link": "https://stackoverflow.com/questions/30220263/can-exit-from-a-library-be-replaced-with-throwing-an-exception/30312712#30312712", "title": "Can exit() from a library be replaced with throwing an exception?", "body": "<p>Unless your C++ implementation is broken, it will call destructors for global variables when <code>exit</code> is called (GCC is not broken, as least all the versions I've tried).  So you only need to clean up stuff that won't be cleaned up by destructors of global vars.</p>\n\n<p>For global stuff on the heap, you can use <code>atexit</code> to register a cleanup function that will be called when <code>exit</code> is called -- this cleanup function can <code>delete</code> any heap objects that need to be cleaned up.</p>\n\n<p>Destructors for stuff on the stack is much trickier.  The best solution is probably to ensure that such destructors don't need to be called -- anything that MUST be cleaned up before exit should be referred to by a global (possibly using static members of classes) that does the cleanup in its destructor.</p>\n"}], "owner": {"reputation": 809, "user_id": 231489, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f037f47f50552082db2a66adb255652?s=128&d=identicon&r=PG", "display_name": "Dave Johansen", "link": "https://stackoverflow.com/users/231489/dave-johansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 1, "closed_date": 1431985555, "accepted_answer_id": 30307419, "answer_count": 3, "score": 7, "last_activity_date": 1431982713, "creation_date": 1431533822, "last_edit_date": 1431963654, "question_id": 30220263, "link": "https://stackoverflow.com/questions/30220263/can-exit-from-a-library-be-replaced-with-throwing-an-exception", "closed_reason": "Duplicate", "title": "Can exit() from a library be replaced with throwing an exception?", "body": "<p>I'm working with a C/Fortran library from C++ and the library calls exit(). I would like it to throw an exception so that the destructors in my C++ program will be called. I have been able to create my one definition of exit that throws an exception, but then terminate is still called. Is there to prevent terminate from being called and allow the normal exception handling to happen?</p>\n\n<p>UPDATE: In the comments it was pointed out that this works on x64 but fails on x86, so the main question is \"is there is a way to make x86 work like x64?\".</p>\n\n<p>UPDATE2: See my response about why this wasn't working on x86 and how to fix it.</p>\n\n<p>Here's my test code:</p>\n\n<p>test_exception.c</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nvoid call_c() { exit(1); }\n</code></pre>\n\n<p>test_exception.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdexcept&gt;\n\nextern \"C\" void call_c();\n\nextern \"C\" void exit(int value)\n{\n  throw std::runtime_error(std::string(\"Throwing an exception: \") + char('0' + value));\n}\n\nint main()\n{\n  try {\n    call_c();\n  } catch (const std::exception &amp;e) {\n    std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n    return 1;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>Built with the following commands:</p>\n\n<pre><code>gcc -c test_exception.c -o test_exception_c.o\ng++ -c test_exception.cpp -o test_exception_cpp.o\ng++ test_exception_c.o test_exception_cpp.o -o test_exception\n</code></pre>\n"}, {"tags": ["python", "c++", "boost", "ctypes", "boost-python"], "comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1431541351, "post_id": 30220223, "comment_id": 48548812, "body": "<code>ctypes.POINTER</code> is a factory function, not a type. The class is <code>ctypes._Pointer</code>, but generally you shouldn&#39;t directly subclass it because ctypes caches pointer types for the sake of type checking."}, {"owner": {"reputation": 1199, "user_id": 3973163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80bac6c38b821d0a9883dbb2f1454a42?s=128&d=identicon&r=PG", "display_name": "Symon", "link": "https://stackoverflow.com/users/3973163/symon"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1431544195, "post_id": 30220223, "comment_id": 48550504, "body": "@eryksun: It&#39;s necessary to have foo() as C++ function. I intentionally simplified the example for describing the issue of argument passing. In my project there is object&#39;s constructor instead of foo()."}, {"owner": {"reputation": 1199, "user_id": 3973163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80bac6c38b821d0a9883dbb2f1454a42?s=128&d=identicon&r=PG", "display_name": "Symon", "link": "https://stackoverflow.com/users/3973163/symon"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1431550023, "post_id": 30220223, "comment_id": 48553581, "body": "@eryksun: It&#39;s a plain C struct. I don&#39;t even know its members because it matters to &quot;old&quot; code only."}, {"owner": {"reputation": 1199, "user_id": 3973163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80bac6c38b821d0a9883dbb2f1454a42?s=128&d=identicon&r=PG", "display_name": "Symon", "link": "https://stackoverflow.com/users/3973163/symon"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1431582284, "post_id": 30220223, "comment_id": 48563316, "body": "@eryksun: No, I shouldn&#39;t. It&#39;s sufficient to have just a pointer. However, that is not the subject of the topic. The main problem is how to get rid of ctypes.addressof(). In other words, how to obtain value of ctypes._Pointer instance without using ctypes.addressof()?"}, {"owner": {"reputation": 1199, "user_id": 3973163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80bac6c38b821d0a9883dbb2f1454a42?s=128&d=identicon&r=PG", "display_name": "Symon", "link": "https://stackoverflow.com/users/3973163/symon"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1431585350, "post_id": 30220223, "comment_id": 48564609, "body": "@eryksun: You missed the line of comment: <code># some calls to old python (e.g. initialization of x).</code>"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 2, "creation_date": 1431586855, "post_id": 30220223, "comment_id": 48565326, "body": "You could just pass the pointer as a Python integer. The most efficient way to get that is <code>p = ctypes.c_void_p.from_buffer(x).value</code>. Still, whether in Python or C++ or whether calling <code>addressof</code> and dereferencing or the <code>from_buffer</code> method, there&#39;s no legitimate way around calling a ctypes function to get at the internal <a href=\"https://hg.python.org/cpython/file/b4cbecbc0781/Modules/_ctypes/ctypes.h#l46\" rel=\"nofollow noreferrer\"><code>b_ptr</code> field</a> of the object. I suppose you could be evil enough to use <code>b_ptr</code> directly..."}, {"owner": {"reputation": 1199, "user_id": 3973163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80bac6c38b821d0a9883dbb2f1454a42?s=128&d=identicon&r=PG", "display_name": "Symon", "link": "https://stackoverflow.com/users/3973163/symon"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1431597954, "post_id": 30220223, "comment_id": 48571166, "body": "@eryksun: Thanks a lot. <code>ctypes.c_void_p.value</code> suits perfectly. I can change definition of PDUMMY to <code>PDUMMY = ctypes.c_void_p</code>."}], "owner": {"reputation": 1199, "user_id": 3973163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80bac6c38b821d0a9883dbb2f1454a42?s=128&d=identicon&r=PG", "display_name": "Symon", "link": "https://stackoverflow.com/users/3973163/symon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431582450, "creation_date": 1431533685, "last_edit_date": 1431582450, "question_id": 30220223, "link": "https://stackoverflow.com/questions/30220223/how-to-pass-ctypes-pointer-to-boost-python", "title": "How to pass ctypes.POINTER to boost.python", "body": "<p>I have following code:</p>\n\n<p>old_lib.h:</p>\n\n<pre><code>struct DUMMY\n{\n    // some members\n};\n</code></pre>\n\n<p>module.cpp:</p>\n\n<pre><code>#include &lt;boost/python.hpp&gt;\n#include \"old_lib.h\"\n\nnamespace py = boost::python;\n\nvoid foo(py::object const&amp; p)\n{\n    // How to get rid of ctypes.addressof()?\n    static py::object ctypes_addressof = py::import(\"ctypes\").attr(\"addressof\");\n    DUMMY *ptr = *reinterpret_cast&lt;DUMMY**&gt;(uintptr_t(py::extract&lt;uintptr_t&gt;(ctypes_addressof(p))));\n}\n\nBOOST_PYTHON_MODULE(module)\n{\n    py::def(\"foo\", &amp;foo, args(\"p\"));\n}\n</code></pre>\n\n<p>old_python.py:</p>\n\n<pre><code>import ctypes\nclass DUMMY(ctypes.Structure):\n    _pack_ = 4\nPDUMMY = POINTER(DUMMY)\n# some old stuff using PDUMMY\n</code></pre>\n\n<p>new_python.py:</p>\n\n<pre><code>from module import foo\nfrom old_python import PDUMMY\nx = PDUMMY()\n# some calls to old python (e.g. initialization of x)\nfoo(x)\n</code></pre>\n\n<p>It's supposed that python code is unchangeable.</p>\n\n<p><strong>How to get rid of ctypes.addressof()?</strong> I guess, calling of it is more expensive than just extracting of value, especially in case of frequent calls of foo().\n<strong>UPD: In other words, how to obtain a value of ctypes._Pointer instance without using ctypes.addressof()?</strong></p>\n\n<p>Is there a way to specify a type of argument as 'foo(PDUMMY p)' and write converter from ctypes.POINTER to PDUMMY?</p>\n"}, {"tags": ["c++", "arrays", "c++11", "mingw", "stdarray"], "comments": [{"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1431533487, "post_id": 30220104, "comment_id": 48544123, "body": "Because objects with static storage duration are often stored in a special section of the executable (that is implementation-dependent, of course). Hence, the larger your object, the larger that section."}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1431533497, "post_id": 30220104, "comment_id": 48544127, "body": "Yes, singleton. Static var values are stored in the program file, and apparently GCC doesn&#180;t care that most values are 0. Other than that, a 4Mio static array looks wrong. Such a large stack array isn&#180;t even possible (usual systems+settings), so just don&#180;t make such arrays without dynamic stuff."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "reply_to_user": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1431533663, "post_id": 30220104, "comment_id": 48544237, "body": "@DarkFalcon: But zero-initialised objects are usually not stored in the executable, since that&#39;s very wasteful; they&#39;re given an entry in a <code>.bss</code> section so they can be initialised at runtime. Presumably, this particular compiler doesn&#39;t do that for local static variables for some reason."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1431533905, "post_id": 30220104, "comment_id": 48544399, "body": "FWIW, the code gives me a 8kb executable on Linux. It must be a quirk of MinGW. I suggest you stop trying to use Windows, no good ever came from that."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 1, "creation_date": 1431537961, "post_id": 30220104, "comment_id": 48546815, "body": "@MikeSeymour this has nothing to do with (your subjective opinion on)  windows ! With MSVC13 I have an executable of 10kb, using the native toolchain."}, {"owner": {"reputation": 7982, "user_id": 2679626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ae2587956371769336745ff9ef4dab0?s=128&d=identicon&r=PG", "display_name": "Denilson Amorim", "link": "https://stackoverflow.com/users/2679626/denilson-amorim"}, "reply_to_user": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1431538108, "post_id": 30220104, "comment_id": 48546893, "body": "@MikeSeymour Blame your fellow GNUs"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1431555260, "post_id": 30220104, "comment_id": 48556097, "body": "@christope: it certainly appears to have everything to do with the use of this toolchain on Windows. I merely suggested my favoured approach to dealing with problems involving Windows. Other approaches are, of course, possible if you have some reason for using that platform."}], "answers": [{"tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 6, "last_activity_date": 1431533680, "creation_date": 1431533680, "answer_id": 30220216, "question_id": 30220104, "link": "https://stackoverflow.com/questions/30220104/why-does-the-size-of-my-binary-depend-on-the-size-of-my-array/30220216#30220216", "title": "Why does the size of my binary depend on the size of my array?", "body": "<blockquote>\n  <p><em>\"Apparently, the effect is caused by the struct being a Singleton. Yet I still don't see any plausible reasoning why the compiler would bloat the binary. \"</em></p>\n</blockquote>\n\n<p>Yes, your observation is correct. Your singleton instance has <em>static storage duration</em>. The fact that the size of the array determines your binary code size, is because all of the initialization for your singleton object is done at compile time and probably goes to the <code>.text</code> section.</p>\n\n<p>But that's all dependent on the currently used compiler implementation, and optimization levels.</p>\n"}], "owner": {"reputation": 504, "user_id": 2660439, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EVvzk.jpg?s=128&g=1", "display_name": "Rene R.", "link": "https://stackoverflow.com/users/2660439/rene-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1431533680, "creation_date": 1431533298, "question_id": 30220104, "link": "https://stackoverflow.com/questions/30220104/why-does-the-size-of-my-binary-depend-on-the-size-of-my-array", "title": "Why does the size of my binary depend on the size of my array?", "body": "<p>I've recently stumbled upon a very strange code bloat effect that I really cannot explain to myself... The following is a working minimal example:</p>\n\n<pre><code>#include &lt;array&gt;\n\nconst int SIZE = 4000000;\n\nstruct Foo\n{\n    static Foo&amp; GetInstance()\n    {\n        static Foo instance;\n        return instance;\n    }\n\n    std::array&lt;float, SIZE&gt; Bar;\n};\n\nint main()\n{\n    Foo::GetInstance().Bar[0] = 1.0f;\n    return 0;\n}\n</code></pre>\n\n<p>The resulting binary (built with GCC MinGW 4.9.2 x86_64 posix sjlj) is <strong>15.28 MB</strong> in size. However if you set e.g. <code>SIZE = 1</code> you get a <strong>17 KB</strong> binary instead.</p>\n\n<p>So why does the size of the binary depend on the size of the array here? Apparently, the effect is caused by the struct being a Singleton. Yet I still don't see any plausible reasoning why the compiler would bloat the binary. Thanks for your help!</p>\n\n<p>(Tested with and without optimization and with the <code>-std=c++11</code> flag only. Btw this also happens with C-style arrays...)</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1431532626, "post_id": 30219814, "comment_id": 48543569, "body": "<code>+val</code>, if you like to do it that way."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1431533295, "post_id": 30219814, "comment_id": 48543999, "body": "This is about input. That was about output. I&#39;m not sure the equivalent is clear enough to call them dupes."}, {"owner": {"reputation": 530, "user_id": 2050326, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/bcaf341befc72444d63ece72dadc5619?s=128&d=identicon&r=PG", "display_name": "Richard Johnson", "link": "https://stackoverflow.com/users/2050326/richard-johnson"}, "edited": false, "score": 0, "creation_date": 1431541523, "post_id": 30219814, "comment_id": 48548912, "body": "I did find the information I wanted though. I did not know that stringstream has an overload for char so that it is interpreted as an ascii character instead of an int."}], "owner": {"reputation": 530, "user_id": 2050326, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/bcaf341befc72444d63ece72dadc5619?s=128&d=identicon&r=PG", "display_name": "Richard Johnson", "link": "https://stackoverflow.com/users/2050326/richard-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1431532559, "answer_count": 0, "score": 0, "last_activity_date": 1431532514, "creation_date": 1431532438, "last_edit_date": 1431532514, "question_id": 30219814, "link": "https://stackoverflow.com/questions/30219814/how-to-get-stringstream-to-interpret-char-as-an-int-without-casting", "closed_reason": "Duplicate", "title": "How to get stringstream to interpret char as an int without casting", "body": "<p>I have some code for converting an int to a string</p>\n\n<pre><code>char val = 0x79;\n\nstd::stringstream str1, str2;\n\nstr1 &lt;&lt; std::hex &lt;&lt; val;   \nstr2 &lt;&lt; std::hex &lt;&lt; (short) val;\nstd::cout &lt;&lt; str1.str() &lt;&lt; std::endl;\nstd::cout &lt;&lt; str2.str() &lt;&lt; std::endl;\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>y    \n79\n</code></pre>\n\n<p>The second output is what I want but I don't like having to cast the char\nto a short. Is there a way to get the output I want without the cast?</p>\n"}, {"tags": ["c++", "database", "ubuntu"], "answers": [{"tags": [], "owner": {"reputation": 77122, "user_id": 106671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a910ad61c5827193f003a11be5dacb14?s=128&d=identicon&r=PG", "display_name": "Nikolai Fetissov", "link": "https://stackoverflow.com/users/106671/nikolai-fetissov"}, "is_accepted": false, "score": 3, "last_activity_date": 1431532785, "creation_date": 1431532785, "answer_id": 30219931, "question_id": 30219754, "link": "https://stackoverflow.com/questions/30219754/ubuntu-no-such-file-or-directory-include-string/30219931#30219931", "title": "Ubuntu - No such file or directory #include &lt;string&gt;", "body": "<p>You are writing C++ code, but trying to compile it as C - <code>gcc</code> is the C language front-end, so use <code>g++</code> instead. Also rename your source files from <code>.c</code> to <code>.cpp</code> to get automatic support from <code>make(1)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 272, "user_id": 4891104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aec6d4aa61032ee5e2f727772f0c1ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Semen Tykhonenko", "link": "https://stackoverflow.com/users/4891104/semen-tykhonenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1431532863, "creation_date": 1431532863, "answer_id": 30219961, "question_id": 30219754, "link": "https://stackoverflow.com/questions/30219754/ubuntu-no-such-file-or-directory-include-string/30219961#30219961", "title": "Ubuntu - No such file or directory #include &lt;string&gt;", "body": "<p><code>#include&lt;string&gt;</code> is C++ header. You are using C++ code in .c file, it is incorrect. Probably you should rename main.c to main.cpp and use g++ instead of gcc</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 2464662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002390472a5f408d1d3def9d56adb91a?s=128&d=identicon&r=PG", "display_name": "didinino", "link": "https://stackoverflow.com/users/2464662/didinino"}, "is_accepted": false, "score": 0, "last_activity_date": 1596616458, "creation_date": 1596616458, "answer_id": 63261328, "question_id": 30219754, "link": "https://stackoverflow.com/questions/30219754/ubuntu-no-such-file-or-directory-include-string/63261328#63261328", "title": "Ubuntu - No such file or directory #include &lt;string&gt;", "body": "<p>For those who run into this question and use make instead of explicitly call gcc:</p>\n<pre><code>make VERBOSE=1\n</code></pre>\n<p>will indicate whether its gcc or g++</p>\n"}], "owner": {"reputation": 1, "user_id": 4889044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c960ddbf0641d322eb4348c5b21eb5d?s=128&d=identicon&r=PG&f=1", "display_name": "malkocoglu", "link": "https://stackoverflow.com/users/4889044/malkocoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3091, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1596616458, "creation_date": 1431532270, "last_edit_date": 1431532430, "question_id": 30219754, "link": "https://stackoverflow.com/questions/30219754/ubuntu-no-such-file-or-directory-include-string", "title": "Ubuntu - No such file or directory #include &lt;string&gt;", "body": "<p>i am trying to write a code like this: (not finished) </p>\n\n<pre><code> #include\"header.h\"\n #include&lt;stdlib&gt;\n #include&lt;stdio.h&gt;\n #include&lt;libpq-fe.h&gt;\n #include&lt;string&gt;\n\n int main(){\n  std::string pguser = \"XYZ\";\n  std::string pgpassword = \"XYZ\";\n  std::string pghost=\"XYZ\";\n  std::string pgdbname = \"XYZ\";\n  int i;\n  PGconn *conn;\n  PGresult *res;\n\n  connstr = \"user=\";\n  connstr += pguser;\n  connstr +=\"password=\";\n  connstr += pgpassword;\n  connstr +=\"host=\";\n  connstr += pghost;\n  connstr +=\"dbname=\";\n  connstr += pgdbname;   \n\n  //DB-Login\n  conn = db_login(const string &amp;user, const string &amp;password, const string        &amp;host, const string &amp;dbname);\n  if(conn == true){\n  printf(\"LOGIN SUCCESFULLY\");\n  }else{\n     printf(\"LOGIN FAILED\");\n  }\n\n  return 0;\n\n  }\n</code></pre>\n\n<p>My Header.h</p>\n\n<pre><code> #ifndef DB_H\n #define DB_H\n\n #include &lt;string&gt;\n\n using namespace std;\n\n int db_login(const string &amp;user, const string &amp;password, const string  &amp;host, const string &amp;dbname);\n #endif\n</code></pre>\n\n<p>I just wanted to test it (sudo gcc main.c header.h -o test)\nThe Result i get is : No such file or directory #include string </p>\n\n<p>I searched for an solution and tried it out but i get the same error.\n(also installed -> sudo apt-get install build-essential\n)</p>\n\n<p>Please Help</p>\n"}, {"tags": ["c++", "copy-constructor"], "comments": [{"owner": {"reputation": 10922, "user_id": 224286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f3d72b765bb4aed80f3138ca74606d9?s=128&d=identicon&r=PG", "display_name": "Collin", "link": "https://stackoverflow.com/users/224286/collin"}, "edited": false, "score": 2, "creation_date": 1431532206, "post_id": 30219664, "comment_id": 48543274, "body": "Are you sure you don&#39;t want to be using a pointer to <code>base_noncopy_base</code>? Otherwise, why inherit from it at all?"}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 1, "creation_date": 1431532234, "post_id": 30219664, "comment_id": 48543290, "body": "if you have the sorce code, can&#39;t you just change it?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1431532241, "post_id": 30219664, "comment_id": 48543299, "body": "are you sure that this is design-by-mistake? Maybe there are good reasons not to copy object of this class (or subclasses)"}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 1, "creation_date": 1431532487, "post_id": 30219664, "comment_id": 48543484, "body": "Do you really want to slice the object, copying just the base part to a new object? Are you sure you don&#39;t want a base-class reference or pointer to the existing object?"}, {"owner": {"reputation": 1235, "user_id": 533510, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/266cd5923db54ae0e7e49c7a48575c14?s=128&d=identicon&r=PG", "display_name": "ribamar", "link": "https://stackoverflow.com/users/533510/ribamar"}, "reply_to_user": {"reputation": 10922, "user_id": 224286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f3d72b765bb4aed80f3138ca74606d9?s=128&d=identicon&r=PG", "display_name": "Collin", "link": "https://stackoverflow.com/users/224286/collin"}, "edited": false, "score": 0, "creation_date": 1431533837, "post_id": 30219664, "comment_id": 48544352, "body": "@Collin , at MiKe I added the Edit 1, so now it is easier to see why I was using full objects. at David where did I tell I have it? I need to edit the question so. at tobi303 Who knows? But that doesn&#39;t change the question &quot;would there be any possibility of hacking the deletion of a function out?&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": false, "score": 4, "last_activity_date": 1431532658, "creation_date": 1431532658, "answer_id": 30219892, "question_id": 30219664, "link": "https://stackoverflow.com/questions/30219664/undelete-bad-designed-deleted-c-functions/30219892#30219892", "title": "Undelete bad designed deleted C++ functions", "body": "<p>If you want to \"use <code>base_noncopy_derived</code> as a <code>base_noncopy_base</code>\", then use a reference or pointer rather than creating a new object:</p>\n\n<pre><code>base_noncopy_derived d;\nbase_noncopy_base &amp; b = d;\n</code></pre>\n\n<p>Your commented-out code attempts to slice the base class, creating a new object by copying just part of <code>d</code>. This is rarely a sensible thing to do, and the reason why base classes tend to be abstract or non-copyable.</p>\n\n<p>If you really want to do this, then you'll have to change the definition of the base class so that it doesn't delete the copy functions. There's no way to \"undelete\" them.</p>\n"}], "owner": {"reputation": 1235, "user_id": 533510, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/266cd5923db54ae0e7e49c7a48575c14?s=128&d=identicon&r=PG", "display_name": "ribamar", "link": "https://stackoverflow.com/users/533510/ribamar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431533196, "creation_date": 1431532012, "last_edit_date": 1431533196, "question_id": 30219664, "link": "https://stackoverflow.com/questions/30219664/undelete-bad-designed-deleted-c-functions", "title": "Undelete bad designed deleted C++ functions", "body": "<p>Due to a mistake when designing an interface, a third-party software provider deleted a function, like the copy constructor in class base_noncopy_base:</p>\n\n<pre><code>class base_noncopy_base {\n    base_noncopy_base(const base_noncopy_base&amp;);\n    public:\n    base_noncopy_base() {}\n};\n</code></pre>\n\n<p>That class is supposed to be inherited, like:</p>\n\n<pre><code>class base_noncopy_derived : public base_noncopy_base {\n    // whatever ....\n};\n</code></pre>\n\n<p>But now, it is no longer allowed to use base_noncopy_derived as a base_noncopy_base:</p>\n\n<pre><code>int main() {\n    base_noncopy_derived d;\n    // base_noncopy_base b1 = d; // won't compile\n    // base_noncopy_base b2(d); // won't compile\n    // base_noncopy_base b3((base_noncopy_derived)d); // won't compile\n}\n</code></pre>\n\n<p>It is possible to <code>const_cast</code> a <code>const</code> member, and I have seen some hacks out there to access private members from outside a class, of course, only to be used in emergency cases. I am wondering:  would there be any possibility of hacking the deletion of a function out?</p>\n\n<p>Edit 1:</p>\n\n<p>Elaborating further the question:</p>\n\n<p>The actual problem arises from other third-party functions functions, like:</p>\n\n<pre><code>void base_noncopy_function1(base_noncopy_base &amp;b) {\n}\n\nvoid base_noncopy_function2(base_noncopy_base b) {\n</code></pre>\n\n<p>}</p>\n\n<p>I can use something like:</p>\n\n<pre><code>base_noncopy_base *b4 = &amp;d;\nbase_noncopy_function1(*b4);\n</code></pre>\n\n<p>But not </p>\n\n<pre><code>base_noncopy_function2(*b4);\n</code></pre>\n"}, {"tags": ["c++", "fstream"], "comments": [{"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 2, "creation_date": 1431531711, "post_id": 30219490, "comment_id": 48542905, "body": "Apart from the indentation, which makes it unnecessarily hard for us to read it?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1431531758, "post_id": 30219490, "comment_id": 48542951, "body": "And you are sure that <code>fsfile2</code> resides in the same directory where your program is running?"}, {"owner": {"reputation": 1999, "user_id": 2866898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c3f789c8dff46eed3cfa22ee7abc00?s=128&d=identicon&r=PG", "display_name": "Arkanosis", "link": "https://stackoverflow.com/users/2866898/arkanosis"}, "edited": false, "score": 1, "creation_date": 1431531985, "post_id": 30219490, "comment_id": 48543123, "body": "Does the file already exist? If not, then add ios::app or ios::trunc to the flags."}, {"owner": {"reputation": 131, "user_id": 4684922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/858635567512006/picture?type=large", "display_name": "Mudit Kapoor", "link": "https://stackoverflow.com/users/4684922/mudit-kapoor"}, "edited": false, "score": 0, "creation_date": 1431532083, "post_id": 30219490, "comment_id": 48543187, "body": "No. i think that is the problem. Thank you. By the way can you give me indentation tips. I am a beginner."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1431533361, "post_id": 30219490, "comment_id": 48544043, "body": "Your <code>fs.read</code> will try to read what&#39;s <i>after</i> the &quot;wow&quot; you just wrote. If you want to read the &quot;wow&quot; back, you need to seek back to the file start, or close &amp; reopen."}], "answers": [{"tags": [], "owner": {"reputation": 811, "user_id": 4895040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YLzeG.jpg?s=128&g=1", "display_name": "raymelfrancisco", "link": "https://stackoverflow.com/users/4895040/raymelfrancisco"}, "is_accepted": false, "score": 1, "last_activity_date": 1431538254, "last_edit_date": 1431538254, "creation_date": 1431532170, "answer_id": 30219720, "question_id": 30219490, "link": "https://stackoverflow.com/questions/30219490/input-output-with-fstream/30219720#30219720", "title": "Input Output with fstream", "body": "<h2>Solution:</h2>\n\n<blockquote>\n  <p>Please add a file extension to the filename. \n  If it's a text file, it will be</p>\n</blockquote>\n\n<pre><code>\"fsfile2.txt\"\n</code></pre>\n\n<blockquote>\n  <p>Then, I tried removing</p>\n</blockquote>\n\n<pre><code>ios::in\n</code></pre>\n\n<blockquote>\n  <p>since the first process only writes to file, and  by removing that, the file is created and \"wow\" is also written at it.</p>\n  \n  <p>In order for these lines</p>\n</blockquote>\n\n<pre><code>fs.read((char*)str,sizeof(str));\ncout&lt;&lt;str&lt;&lt;endl;\n</code></pre>\n\n<blockquote>\n  <p>to work, \n  You need to close the stream after writing to it, then open the stream in read mode, then read the contents. Take note that closing the stream will save the edited file.</p>\n</blockquote>\n\n<h2>Additional:</h2>\n\n<p>You can also change</p>\n\n<pre><code>fs.write(\"wow\",sizeof(\"wow\"));\n</code></pre>\n\n<p>to</p>\n\n<pre><code>fs &lt;&lt; \"wow\";\n</code></pre>\n\n<p>You can do the same when reading from file,</p>\n\n<pre><code>fs &gt;&gt; str;\n</code></pre>\n\n<p>You can also use the string class of C++, instead of char array so that the number of characters inside the file won't be your problem anymore.</p>\n\n<pre><code>#include &lt;string&gt;\nstring str;\n</code></pre>\n\n<p>Checking for <strong>EOF</strong> (end-of-file) is recommended since files are read line by line. Once you add a new line and add a character to the line, the code that doesn't loop until EOF will only read the first line of the file.</p>\n\n<p>In order to solve this, it is recommended to loop until EOF is reached.</p>\n\n<pre><code>while(!fs.eof()) {\n     fs &gt;&gt; str;\n     cout &lt;&lt; str &lt;&lt; endl;\n}\n</code></pre>\n\n<blockquote>\n  <p><strong>So here is the improved snippet:</strong></p>\n</blockquote>\n\n<pre><code>#include &lt;string&gt;\n\nfs.open(\"fsfile2.txt\", ios::out); // ios::out for write only\nif(fs.is_open()) {\n\n    // writes \"wow\" to file\n    fs &lt;&lt; \"wow\"; \n\n    // closes the file\n    fs.close();\n\n    // ios::in for read only\n    fs.open(\"fsfile2.txt\", ios::in); \n\n    // better to define variable just before using it\n    string str;\n\n    // loops until end-of-file\n    while(!fs.eof()) {\n\n        // reads a line from file, stores it to str\n        fs &gt;&gt; str;\n\n        // shows str to screen\n        cout &lt;&lt; str &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p><strong>*Note:</strong> I removed</p>\n</blockquote>\n\n<pre><code>ios::binary\n</code></pre>\n\n<blockquote>\n  <p>Since your code is not dealing with binary files yet. </p>\n</blockquote>\n\n<p><strong>I tried these and it worked fine! Have a nice day!</strong></p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 4689424, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/DeZvg.jpg?s=128&g=1", "display_name": "Akim", "link": "https://stackoverflow.com/users/4689424/akim"}, "is_accepted": false, "score": 1, "last_activity_date": 1431532250, "creation_date": 1431532250, "answer_id": 30219749, "question_id": 30219490, "link": "https://stackoverflow.com/questions/30219490/input-output-with-fstream/30219749#30219749", "title": "Input Output with fstream", "body": "<p>Try this code</p>\n\n<pre><code>fs.open(\"fsfile2\", ios::app|ios::in|ios::out|ios::binary);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 4708788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8y221.gif?s=128&g=1", "display_name": "anatp2015", "link": "https://stackoverflow.com/users/4708788/anatp2015"}, "is_accepted": false, "score": 1, "last_activity_date": 1431532451, "last_edit_date": 1495541665, "creation_date": 1431532451, "answer_id": 30219818, "question_id": 30219490, "link": "https://stackoverflow.com/questions/30219490/input-output-with-fstream/30219818#30219818", "title": "Input Output with fstream", "body": "<p>By using the open() like you are that file will not be created if that is your goal.\nIf you want to create a new file please look at: <a href=\"https://stackoverflow.com/questions/15667530/fstream-wont-create-a-file\">fstream won&#39;t create a file</a></p>\n\n<p>If the file exists, you are not looking for it in the right path. Or change the file name to the full path or put the executable in the folder where the file is.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 272, "user_id": 4891104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aec6d4aa61032ee5e2f727772f0c1ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Semen Tykhonenko", "link": "https://stackoverflow.com/users/4891104/semen-tykhonenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1431533060, "creation_date": 1431533060, "answer_id": 30220026, "question_id": 30219490, "link": "https://stackoverflow.com/questions/30219490/input-output-with-fstream/30220026#30220026", "title": "Input Output with fstream", "body": "<p>Probably, you do not have permissions to create files in the directory, where your executable is.</p>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 1, "last_activity_date": 1432392602, "last_edit_date": 1432392602, "creation_date": 1431533360, "answer_id": 30220134, "question_id": 30219490, "link": "https://stackoverflow.com/questions/30219490/input-output-with-fstream/30220134#30220134", "title": "Input Output with fstream", "body": "<p><code>fstream fs;</code> does not create a new file for you.<br>\nYou need to make sure that the file exists in your project directory.<br>\nOn the other hand, if you were to use <code>ofstream fs(\"file.txt\");</code> it would create the file for you. Or use only ios::out when you open fstream fs, this will create the file for you.<br></p>\n"}], "owner": {"reputation": 131, "user_id": 4684922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/858635567512006/picture?type=large", "display_name": "Mudit Kapoor", "link": "https://stackoverflow.com/users/4684922/mudit-kapoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1432392602, "creation_date": 1431531535, "last_edit_date": 1431534518, "question_id": 30219490, "link": "https://stackoverflow.com/questions/30219490/input-output-with-fstream", "title": "Input Output with fstream", "body": "<p>Can anyone tell me what is wrong with this code? I always get not open.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nusing namespace std;\n\nint main(){\n    fstream fs;\n    fs.open(\"fsfile2\",ios::in|ios::out|ios::binary);\n    if(fs.is_open()){\n    fs.write(\"wow\",sizeof(\"wow\"));\n    char str[20];\n    fs.read((char*)str,sizeof(str));\n    cout&lt;&lt;str&lt;&lt;endl;}\n    else \n        cout&lt;&lt;\"Not open\\n\";\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 3, "creation_date": 1431531156, "post_id": 30219293, "comment_id": 48542524, "body": "isn&#39;t this undefined behavior? <a href=\"http://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points\" title=\"undefined behavior and sequence points\">stackoverflow.com/questions/4176328/&hellip;</a>"}, {"owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 0, "creation_date": 1431531202, "post_id": 30219293, "comment_id": 48542558, "body": "Aside from it giving an error in this case due to operator precedence you shouldn&#39;t use multiple post/prefix increments in the same expression, it can give <a href=\"http://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points\">undefined behavior</a>."}, {"owner": {"reputation": 35, "user_id": 4591815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94884faa3b486644d2c4ec8722745711?s=128&d=identicon&r=PG&f=1", "display_name": "Anant Giria", "link": "https://stackoverflow.com/users/4591815/anant-giria"}, "edited": false, "score": 0, "creation_date": 1431531288, "post_id": 30219293, "comment_id": 48542612, "body": "No, it give an error."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1431531472, "post_id": 30219293, "comment_id": 48542734, "body": "++ doesn&#39;t return a lvalue, so how can you increase it?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1431531573, "post_id": 30219293, "comment_id": 48542812, "body": "@PaulR Not really a duplicate of that one. The question is about operator precedence, not sequence points."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1431531625, "post_id": 30219293, "comment_id": 48542841, "body": "Note sure -7 is fair. This is not the normal <code>++i + i++</code> nonsense."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4591815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94884faa3b486644d2c4ec8722745711?s=128&d=identicon&r=PG&f=1", "display_name": "Anant Giria", "link": "https://stackoverflow.com/users/4591815/anant-giria"}, "edited": false, "score": 0, "creation_date": 1431531780, "post_id": 30219383, "comment_id": 48542967, "body": "Thank you for the explanation."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1431534234, "post_id": 30219383, "comment_id": 48544602, "body": "I&#39;m pretty sure your semi-guess is correct, and the two increments are not sequenced, so the result would be undefined behavior (it certainly was in C++98/03, and while the new sequencing rules have made <i>some</i> things defined that didn&#39;t used to be, I don&#39;t think this is one of them)."}], "tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": true, "score": 7, "last_activity_date": 1431531571, "last_edit_date": 1431531571, "creation_date": 1431531231, "answer_id": 30219383, "question_id": 30219293, "link": "https://stackoverflow.com/questions/30219293/why-does-x-give-compile-error/30219383#30219383", "title": "Why does ++x++ give compile error?", "body": "<p>The result of the post-increment expression, <code>a++</code> is an <em>rvalue</em>; a temporary with the value that <code>a</code> had before incrementing. As an <em>rvalue</em>, you can use its value, but you can't modify it. Specifically, you can't apply pre-increment it, as the compiler says.</p>\n\n<p>If you were to change the precedence to do the pre-increment first:</p>\n\n<pre><code>(++a)++\n</code></pre>\n\n<p>then this would compile: the result of pre-increment is an <em>lvalue</em> denoting the object that's been modified. However, this might have undefined behaviour; I'm not sure whether the two modifications and the various uses of the value are sequenced.</p>\n\n<p>Summary: don't try to write tricky expressions with multiple side-effects.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 6, "last_activity_date": 1431531239, "creation_date": 1431531239, "answer_id": 30219387, "question_id": 30219293, "link": "https://stackoverflow.com/questions/30219293/why-does-x-give-compile-error/30219387#30219387", "title": "Why does ++x++ give compile error?", "body": "<p>Conceptually, the postfix <code>++</code> has higher precedence than prefix <code>++</code>.</p>\n\n<p>So <code>a++</code> will be computed first. But this is not an lvalue (as it's the previous value of <code>a</code>). It therefore cannot be pre-incremented. Hence the compiler output.</p>\n\n<p>More importantly though, the behaviour of the whole expression <code>++a++</code> is <em>undefined</em> due to their being no <em>sequencing</em> point in the expression.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4591815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94884faa3b486644d2c4ec8722745711?s=128&d=identicon&r=PG&f=1", "display_name": "Anant Giria", "link": "https://stackoverflow.com/users/4591815/anant-giria"}, "edited": false, "score": 0, "creation_date": 1431532099, "post_id": 30219400, "comment_id": 48543203, "body": "I did not used it in my code.I just wanted to know the reason for compile error."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1431531769, "last_edit_date": 1431531769, "creation_date": 1431531279, "answer_id": 30219400, "question_id": 30219293, "link": "https://stackoverflow.com/questions/30219293/why-does-x-give-compile-error/30219400#30219400", "title": "Why does ++x++ give compile error?", "body": "<p>First of all, that's terrible programming style. Depending on your needs, you can easily write:</p>\n\n<pre><code>++a;\ncout &lt;&lt; a++ &lt;&lt;\"\\n\";\n</code></pre>\n\n<p>or</p>\n\n<pre><code>a++;\ncout &lt;&lt; ++a &lt;&lt;\"\\n\";\n</code></pre>\n\n<p>Coming to the compiler error...</p>\n\n<p>Due to operator precedence,  <code>++a++</code> is the same as <code>++(a++)</code>. However, <code>a++</code> evaluates to an rvalue. Using the prefix increment operator on an rvalue is not allowed. That will be analogous to using <code>++10</code>, which is not legal.</p>\n"}, {"tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 1, "last_activity_date": 1575524141, "last_edit_date": 1575524141, "creation_date": 1431535198, "answer_id": 30220680, "question_id": 30219293, "link": "https://stackoverflow.com/questions/30219293/why-does-x-give-compile-error/30220680#30220680", "title": "Why does ++x++ give compile error?", "body": "<p>Just for what it's worth (not much, IMO) if you make the <code>a</code> in question the proper type, it's possible to get this to compile <em>and</em> have defined behavior. The trick (and in this case it's a dirty, evil trick) is to overload the post-fix increment operator to return an lvalue:</p>\n\n<pre><code>class dirty_evil_trick {\n    int val;\npublic:\n    dirty_evil_trick() : val(0) {}\n\n    // to demonstrate, I'll just make postfix increment act like prefix increment.\n    dirty_evil_trick operator++(int) {  \n        ++val;\n        return *this;\n    }\n\n    dirty_evil_trick operator++() { \n        ++val;\n        return *this;\n    }\n\n    operator int(){ return val; }\n};\n</code></pre>\n\n<p>As implied by the name, this is (at least in my opinion) truly horrible code. We've made both the prefix and postfix increment operators act like prefix increment. So, for example, if we exercise it as follows:</p>\n\n<pre><code>int main(){ \n    dirty_evil_trick a;\n    std::cout &lt;&lt; ++a++;\n}\n</code></pre>\n\n<p>...it should print out <code>2</code>. And, since invoking the operator overload functions imposes ordering constraints, we should be able to count on that result with all conforming compilers.</p>\n\n<p>I'll repeat once more though: this is not intended as advice about how you should write code. It's really just a demonstration of what the error message you got meant, and how you can write code that <em>does</em> let this actually work (or, at least compile and do <em>something</em>. Whether that qualifies as \"working\" is a whole 'nother question).</p>\n"}], "owner": {"reputation": 35, "user_id": 4591815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94884faa3b486644d2c4ec8722745711?s=128&d=identicon&r=PG&f=1", "display_name": "Anant Giria", "link": "https://stackoverflow.com/users/4591815/anant-giria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 30219383, "answer_count": 4, "score": -3, "last_activity_date": 1575524141, "creation_date": 1431530991, "last_edit_date": 1431587063, "question_id": 30219293, "link": "https://stackoverflow.com/questions/30219293/why-does-x-give-compile-error", "title": "Why does ++x++ give compile error?", "body": "<p>I am having confusion with the return value of post-increment and pre-increment operator.Whether it returns r-value or l-value.</p>\n\n<pre><code>    #include&lt;iostream&gt;\n    using namespace std;\n    int main(){\n        int a=10;\n        cout&lt;&lt;++a++&lt;&lt;\"\\n\";\n    }\n</code></pre>\n\n<p>The following code give a compile error.</p>\n\n<pre><code>error: lvalue required as increment operator\n</code></pre>\n\n<p>Why is there an error?</p>\n\n<p>How does the compiler evaluates the expression <code>++a++</code>?</p>\n"}, {"tags": ["c++", "oop", "io"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 2, "creation_date": 1431531372, "post_id": 30219154, "comment_id": 48542676, "body": "<code>using Gabi::Herbs::Filesystem; using Gabi::Herbs::IO;</code> strictly <b>in local scope</b> could be the first step."}], "answers": [{"comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 1, "creation_date": 1431540812, "post_id": 30220045, "comment_id": 48548499, "body": "This doesn&#39;t need a class at all, here a simple function would do."}, {"owner": {"reputation": 4010, "user_id": 1812187, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MRXi9.png?s=128&g=1", "display_name": "Carlton", "link": "https://stackoverflow.com/users/1812187/carlton"}, "edited": false, "score": 0, "creation_date": 1431607794, "post_id": 30220045, "comment_id": 48577205, "body": "To maintain flexibility, you could pass additional arguments to the constructor to specify how the file should be decoded (ASCII, UTF8, etc)."}], "tags": [], "owner": {"reputation": 4010, "user_id": 1812187, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MRXi9.png?s=128&g=1", "display_name": "Carlton", "link": "https://stackoverflow.com/users/1812187/carlton"}, "is_accepted": true, "score": 1, "last_activity_date": 1431533108, "creation_date": 1431533108, "answer_id": 30220045, "question_id": 30219154, "link": "https://stackoverflow.com/questions/30219154/how-to-get-rid-of-long-initialization-without-losing-flexibililty/30220045#30220045", "title": "How to get rid of long initialization without losing flexibililty", "body": "<p>Maybe create a new class, like this:</p>\n\n<pre><code>class FileReaderDecoder\n{\n    Gabi::Herbs::Filesystem::FileReader filereader;\n    Gabi::Herbs::IO::ReaderBuffering reader;\n    Gabi::Herbs::TextIO::Decoder decoder;\n\npublic:\n    FileReaderDecoder(std::string file_name)\n    {/*Initialize the three member variables like you did in your own code*/}\n\n    //Add accessor functions here to get the data from the decoded file, e.g.:\n    std::string GetData(int start, int size);\n}\n</code></pre>\n\n<p>Then the call reduces to, e.g.</p>\n\n<pre><code>FileReaderDecoder file_rd_dec(\"herbs/textio/test_utf8.txt\");\nfile_rd_dec.GetData(0, 16);\n</code></pre>\n"}], "owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 30220045, "answer_count": 1, "score": 0, "last_activity_date": 1431533108, "creation_date": 1431530600, "last_edit_date": 1431531196, "question_id": 30219154, "link": "https://stackoverflow.com/questions/30219154/how-to-get-rid-of-long-initialization-without-losing-flexibililty", "title": "How to get rid of long initialization without losing flexibililty", "body": "<p>Consider this example</p>\n\n<pre><code>Gabi::Herbs::Filesystem::FileReader filereader\n    {\n    Gabi::Herbs::Filesystem::FileIn\n        {Gabi::Herbs::Filesystem::Path(GABI_HERBS_STR(\"herbs/textio/test_utf8.txt\")),0}\n        ,0\n    };\nGabi::Herbs::IO::ReaderBuffering reader(filereader,128);\nGabi::Herbs::TextIO::Decoder decoder(reader,Gabi::Herbs::TextIO::ConverterUTF8::factory);\n</code></pre>\n\n<p>It is C++ but it could be any language with support for OOP. So</p>\n\n<ol>\n<li>Use a Path abstraction to distinguish a file path from a general string</li>\n<li>Create a random access file. This does not move any file pointer</li>\n<li>Read the file using a FileReader [FileIn has been copy constructed through reference counting]. The reader will start zero bytes from begin of file.</li>\n<li>Since it is a text file, it is good to use buffered I/O. This reduces the number of syscalls needed. In this case, it fetches 128 bytes at each call.</li>\n<li>A text file may be coded in many different ways. Create a decoder that tries to decode the file.</li>\n</ol>\n\n<p>How can I create a wrapper in this case so I do not need to create three objects, and two temporary objects? It is possible to use merge classes, but then some flexibility is lost.</p>\n"}, {"tags": ["c++", "c", "windows", "sockets"], "comments": [{"owner": {"reputation": 188, "user_id": 4620155, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6885869e748858183218b08b906dd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mercious", "link": "https://stackoverflow.com/users/4620155/mercious"}, "edited": false, "score": 0, "creation_date": 1431530570, "post_id": 30219088, "comment_id": 48542098, "body": "Eh  ... you don&#39;t close the socket and keep using it?"}, {"owner": {"reputation": 277, "user_id": 4293446, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9da46dcbbff4536a052417625b06e5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Pan Wolodyjowsky", "link": "https://stackoverflow.com/users/4293446/pan-wolodyjowsky"}, "reply_to_user": {"reputation": 188, "user_id": 4620155, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6885869e748858183218b08b906dd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mercious", "link": "https://stackoverflow.com/users/4620155/mercious"}, "edited": false, "score": 0, "creation_date": 1431530638, "post_id": 30219088, "comment_id": 48542150, "body": "&quot;closesocket(s);&quot; hm?"}, {"owner": {"reputation": 188, "user_id": 4620155, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6885869e748858183218b08b906dd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mercious", "link": "https://stackoverflow.com/users/4620155/mercious"}, "edited": false, "score": 0, "creation_date": 1431530730, "post_id": 30219088, "comment_id": 48542211, "body": "I&#39;m saying the better way is: Don&#39;t close the socket and keep using it. What makes you think that you need to close the socket? It&#39;s connection to the server is maintained, even after receiving a set of data. There is no reason to close it after each successfull recv() call."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1431530874, "post_id": 30219088, "comment_id": 48542321, "body": "Both of your codes are wrong, but primarily your server. Your server accepts a new connection before sending a new message, and does not close the previous connection.  Your client thus has to reconnect each time.  You need to change both sides to reuse the existing connection they already have. And you need to frame your messages so the client knows where one message ends and the next message begins. You cannot assume a 1-to-1 relationship between <code>send()</code> and <code>recv()</code> in TCP, only in UDP."}], "answers": [{"tags": [], "owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "is_accepted": true, "score": 1, "last_activity_date": 1431531635, "last_edit_date": 1431531635, "creation_date": 1431531023, "answer_id": 30219309, "question_id": 30219088, "link": "https://stackoverflow.com/questions/30219088/reusing-sockets-with-winsocket-client-server-application/30219309#30219309", "title": "reusing sockets with WinSocket client/server application", "body": "<p>well , some of things here are not very common.</p>\n\n<p>first, you usually name your variables in English, not other languages that are written in latin alphabet. I may get downvote for that, but that is the common practice for a reason.</p>\n\n<p>second of all, I'd prefere use the C++ standard over OS specific API. \nwhy not go with <code>std::thread</code> instead of WinApi thread? it's much more simple, short and elegant.</p>\n\n<p>third, you code is 100% procedural. you don't have a standard C++ socket class, but it doesn't mean you can't (or shouldn't) write your own Socket class which handles in elegant way the creation, binding, sending and receiving functionality.</p>\n\n<p>fourth, <code>s</code> is not a good name for a variable even if MSDN examples so. <code>acceptingSocket</code> might be. </p>\n\n<p>about your actual question:\nyou have many options here, the 3 I can think of:<br/>\n1) not close the socket and keep on receiving data inside a while loop.<br/> \npros: easy to write. when the server has new data the client gets it right away.\ncons: this is not a good way when your server has more the few connections at each time because then it will crash.</p>\n\n<p>2) let the server pack the data. then the client open a connection in pre-defined intervals, ask for all the accumulated data at once and receive it.<br/>\npros: the most CPU resource saving out of the three\noptions.\ncons : your client will not get the data right away, but in a pre-defined intervals</p>\n\n<p>3) let the client send the local IP and port to the server in the begining of each session. then let the client keep a bounded socket on the local host waiting for connections. every time the server has something new to tell the client - it just use the saved IP and port to connect to the client, send the data and close the connection. the client then returns to wait for new connections. this way<br>\npros: in this case the server will have as few as possible connections in each time, wich is a good thing if you intent your server to server many clients.\ncons: the weight actually falls on the client, which in many cases no the best thing to do.</p>\n"}, {"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 1, "last_activity_date": 1431532145, "creation_date": 1431532145, "answer_id": 30219710, "question_id": 30219088, "link": "https://stackoverflow.com/questions/30219088/reusing-sockets-with-winsocket-client-server-application/30219710#30219710", "title": "reusing sockets with WinSocket client/server application", "body": "<p>The usual one-connection approach is:</p>\n\n<pre><code>Create socket\nbind socket\nListen on socket\nnewsocket = accept on socket\nwhile no accept errors\n    while newsocket connected and error free\n        process newsocket\n    newsocket = accept on socket\n</code></pre>\n\n<p>Multiple connections can be handles several ways.</p>\n\n<p>Multithreaded:</p>\n\n<pre><code>create thread pool\nCreate socket\nbind socket\nListen on socket\nwhile no errors\n    newsocket = accept on socket\n    hand newsocket off to thread pool for processing\n</code></pre>\n\n<p>Monothread <a href=\"http://www.freebsd.org/cgi/man.cgi?query=select\" rel=\"nofollow\">select</a> based</p>\n\n<pre><code>Create socket\nbind socket\nListen on socket\nadd socket to readFD  list\nwhile no errors\n    select on readFD list\n    if socket selected\n        newsocket = accept on socket\n        add newsocket to readFD  list\n    while other sockets selected\n        process other sockets\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 4293446, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9da46dcbbff4536a052417625b06e5c5?s=128&d=identicon&r=PG&f=1", "display_name": "Pan Wolodyjowsky", "link": "https://stackoverflow.com/users/4293446/pan-wolodyjowsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 30219309, "answer_count": 2, "score": 1, "last_activity_date": 1435334053, "creation_date": 1431530422, "last_edit_date": 1435334053, "question_id": 30219088, "link": "https://stackoverflow.com/questions/30219088/reusing-sockets-with-winsocket-client-server-application", "title": "reusing sockets with WinSocket client/server application", "body": "<p>I have 2 simple applications, one client and one server. The client connects to the server and the server sends data to the client. In the main loop of the client application, I'm closing the socket and creating a new one every time I want to receive another piece of information. It works but it doesn't look right to me. Is this right? Do I really need to close and reopen a socket every time, or is there another way to do this?</p>\n\n<p>client:</p>\n\n<pre><code>    int main(){\n    DWORD id;\n    SOCKET s;\n    struct sockaddr_in sa;\n    WSADATA wsas;\n    WORD wersja;\n    int recv_size;\n    LPTHREAD_START_ROUTINE WINAPI funkcja = getCommend;\n\n    watek = CreateThread(NULL, 0, funkcja, 0, 0, &amp;id);\n\n\n\n    wersja = MAKEWORD(2, 0);\n    WSAStartup(wersja, &amp;wsas);\n\n\n    memset((void *)(&amp;sa), 0, sizeof(sa));\n    sa.sin_family = AF_INET;\n    sa.sin_port = htons(PORT);\n    sa.sin_addr.s_addr = inet_addr(\"25.62.229.110\");\n\n    int result;\n    s = socket(AF_INET, SOCK_STREAM, 0);\n    result = connect(s, (struct sockaddr FAR *) &amp;sa, sizeof(sa));\n    if (result == SOCKET_ERROR)\n    {\n        printf(\"\\nB\u0142\u0105d po\u0142\u0105czenia!\");\n        return 1;\n    }\n\n    int a;\n    if ((recv_size = recv(s, server_reply, SIZE, 0)) == SOCKET_ERROR)\n    {\n        printf(\"recv failed\\n\");\n    }\n    else{\n        while (result != SOCKET_ERROR){\n            //printf(\"%s\\n\", server_reply);     \n            closesocket(s);\n            Sleep(1000);\n            s = socket(AF_INET, SOCK_STREAM, 0);\n            result = connect(s, (struct sockaddr FAR *) &amp;sa, sizeof(sa));\n            if (result == SOCKET_ERROR){\n                break;\n            }\n            result = recv_size = recv(s, server_reply, SIZE, 0);\n        }\n    }\n    getchar();\n    closesocket(s);\n    TerminateThread(watek, NULL);\n    WSACleanup();\n    return 1;\n}\n</code></pre>\n\n<p>server:</p>\n\n<pre><code>int main(){\nDWORD id;\nSOCKET s, new_socket;\nLPTHREAD_START_ROUTINE WINAPI funkcja = getCommend;\nstruct sockaddr_in sa, sc;\nWSADATA wsas;\nint c;\nwatek = CreateThread(NULL,0,funkcja,0,0,&amp;id);\n\nWSAStartup(MAKEWORD(1, 1), &amp;wsas);\n\ns = socket(AF_INET, SOCK_STREAM, 0);\n\n//memset((void *)(&amp;sa), 0, sizeof(sa));\nsa.sin_family = AF_INET;\nsa.sin_port = htons(PORT);\nsa.sin_addr.s_addr = htonl(INADDR_ANY);\nbind(s, (struct sockaddr FAR*)&amp;sa, sizeof(sa));\nlisten(s, 5);\nputs(\"Czekam na polaczenie...\");\nc = sizeof(struct sockaddr_in);\nwhile ((new_socket = accept(s, (struct sockaddr *)&amp;sc, &amp;c)) != INVALID_SOCKET)\n{\n    //puts(\"polaczenie zaakceptowane\");\n    send(new_socket, message, strlen(message), 0);\n}\nif (new_socket == INVALID_SOCKET)\n{\n    printf(\"Nie udane po\u0142aczenie, blad nr : %d\", WSAGetLastError());\n    return 1;\n}\nTerminateThread(watek, NULL);   \ngetchar();\n}\n</code></pre>\n"}, {"tags": ["c++", "graphics", "sfml"], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1431530581, "post_id": 30219004, "comment_id": 48542109, "body": "@Thomas The latter option? I&#39;m not actually a game programmer, but I&#39;d always prefer the option to pass an interface at class creation instead of using a <i>Singleton</i> reference. Using a <i>Factory</i> to do so might come in handy. <i>Factories</i> are good subjects for <i>Singletons</i>."}, {"owner": {"reputation": 1659, "user_id": 3893615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6747082a887efbb8cc4785b7c4279cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Kvothe", "link": "https://stackoverflow.com/users/3893615/kvothe"}, "edited": false, "score": 0, "creation_date": 1431531712, "post_id": 30219004, "comment_id": 48542909, "body": "Thanks, I&#39;ll use the latter option for now and look into Factories - an initial glance at the link makes me think I may be in a bit over my head with them."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 1659, "user_id": 3893615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6747082a887efbb8cc4785b7c4279cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Kvothe", "link": "https://stackoverflow.com/users/3893615/kvothe"}, "edited": false, "score": 0, "creation_date": 1431531966, "post_id": 30219004, "comment_id": 48543106, "body": "@Kvothe In fact the <i>Factory pattern</i>, is a whole bunch of options how to setup a system and populate it with class instances of a certain kind. The crucial point is to use interfaces from the client sides, without knowing about concrete object instances."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": true, "score": 6, "last_activity_date": 1431530915, "last_edit_date": 1431530915, "creation_date": 1431530227, "answer_id": 30219004, "question_id": 30218822, "link": "https://stackoverflow.com/questions/30218822/passing-control-of-a-drawing-window-deeper-into-a-program/30219004#30219004", "title": "Passing control of a drawing window &quot;deeper&quot; into a program?", "body": "<p>I'm afraid you have to decide to do a choice between using a <a href=\"http://www.oodesign.com/singleton-pattern.html\" rel=\"nofollow\"><em>Singleton</em></a> (<code>GameMaster</code>) that allows access to the main window, or pass a reference to it with your dependent class objects.</p>\n\n<p>I personally would prefer the latter (I won't consider adding another constructor parameter to a couple of classes as <em>bloat</em>), because the overall flexibility of the class design would be better than using a <em>Singleton</em>.</p>\n\n<hr>\n\n<p>You may consider, to outsource your <code>World</code> class assembly code to a separate <a href=\"http://www.oodesign.com/factory-pattern.html\" rel=\"nofollow\"><code>Factory</code> class</a>. This one could hold the necessary main window object as a member and pass it to all of the created <code>World</code>, <code>Battle</code>, etc. instances necessary to assemble the <code>World</code>, initiate the game mission respectively.</p>\n"}, {"comments": [{"owner": {"reputation": 1659, "user_id": 3893615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6747082a887efbb8cc4785b7c4279cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Kvothe", "link": "https://stackoverflow.com/users/3893615/kvothe"}, "edited": false, "score": 0, "creation_date": 1431531813, "post_id": 30219110, "comment_id": 48542987, "body": "Thanks. I&#39;m going to use this approach now (your answer is just as good as the accepted one - but I can only accept one...)"}], "tags": [], "owner": {"reputation": 15257, "user_id": 1409312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4TCzB.jpg?s=128&g=1", "display_name": "Syntactic Fructose", "link": "https://stackoverflow.com/users/1409312/syntactic-fructose"}, "is_accepted": false, "score": 3, "last_activity_date": 1431530885, "last_edit_date": 1431530885, "creation_date": 1431530490, "answer_id": 30219110, "question_id": 30218822, "link": "https://stackoverflow.com/questions/30218822/passing-control-of-a-drawing-window-deeper-into-a-program/30219110#30219110", "title": "Passing control of a drawing window &quot;deeper&quot; into a program?", "body": "<p>I had a similar design issue during my first application, here is how I set my program up:</p>\n\n<h2><strong>App.hpp</strong></h2>\n\n<pre><code>class App{\n    public:\n    // Constructor simply creates main window, specify context settings\n    // and set position of main window to center of screen\n    App(sf::VideoMode mode);\n    ~App();\n\n    // init functions for setting up windows / graphics beforehand\n\n    // The main loop of the program, while active, run calculates the delta time\n    // for game movement, handles window events for both the console and window,\n    void run();\n\n    private:\n        sf::Window d_main_window; // main window for program.\n        // other data ...\n        // bool for main loop , etc.. etc..\n};\n</code></pre>\n\n<p>App is the window handling class, and contains any functions that are used to initialize any graphics (openGL) or set up the program so it can be ready to run. Then the main loop is started with <code>app.run()</code></p>\n\n<h2><strong>ParticleContainer.hpp</strong></h2>\n\n<pre><code>class ParticleContainer {\n    public:\n        ParticleContainer(/* params */);\n        ~ParticleContainer\n\n        // object specific functions\n\n        drawParticles();\n\n    private:\n        sf::Window *d_parent_window;  // window is passed into the constr\n                                      // now we can draw from inside particle\n        // additional params\n        // vec of all particle objects\n};\n</code></pre>\n\n<p>The particle container object contains a pointer to the parent window, so it can draw particles to the screen. This design would allow you to create discrete objects that had the ability to draw itself to the screen, taking away the problem of some cluttered draw class. if you create a new object, all you need to do it pass the parent window pointer in giving it the ability to draw itself. </p>\n"}], "owner": {"reputation": 1659, "user_id": 3893615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6747082a887efbb8cc4785b7c4279cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Kvothe", "link": "https://stackoverflow.com/users/3893615/kvothe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 30219004, "answer_count": 2, "score": 5, "last_activity_date": 1431530915, "creation_date": 1431529723, "question_id": 30218822, "link": "https://stackoverflow.com/questions/30218822/passing-control-of-a-drawing-window-deeper-into-a-program", "title": "Passing control of a drawing window &quot;deeper&quot; into a program?", "body": "<p>I am using <code>SFML 2.3</code> to control the graphics in my program. I need a class to be able to access the window, to draw to it even if that class was not the one that originally created the window (does not have ownership). E.g. the <code>Battle</code> class needs to be able to draw the battle scene and manipulate characters there but the <code>World</code> class would need the window before and after <code>Battle</code> to show the player's movements in the main game.</p>\n\n<p>How should the window object be handled? My initial thought is to have a <code>GameMaster</code> class that has the window as a static member. But rather than blunder along with this method I thought it better to check what the usual consensus was.</p>\n\n<p>I realise I could always pass a reference to the window to each class that needs it but this would make the constructors for all the classes that need to manipulate the window quite bloated.</p>\n"}, {"tags": ["c++", "pointers", "c++11"], "comments": [{"owner": {"reputation": 13218, "user_id": 1348273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/IYjFG.jpg?s=128&g=1", "display_name": "Lingxi", "link": "https://stackoverflow.com/users/1348273/lingxi"}, "edited": false, "score": 0, "creation_date": 1431529775, "post_id": 30218714, "comment_id": 48541511, "body": "What do you mean by <i>implicit conversion from the <code>0</code> literal to <code>nullptr</code> no longer being considered idiomatic</i>?"}, {"owner": {"reputation": 3004, "user_id": 1359034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e97eaac4d6ba8f0c3f95900f02b45b42?s=128&d=identicon&r=PG", "display_name": "dwcanillas", "link": "https://stackoverflow.com/users/1359034/dwcanillas"}, "edited": false, "score": 0, "creation_date": 1431529823, "post_id": 30218714, "comment_id": 48541547, "body": "<code>if (ptr)</code> is well defined and in the standard.  It is safe to use."}, {"owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "edited": false, "score": 0, "creation_date": 1431529954, "post_id": 30218714, "comment_id": 48541643, "body": "That you should prefer to write <code>int *p = nullptr;</code> over <code>int *p = 0;</code>. To be consistent with calling <code>foo(nullptr)</code> instead of <code>foo(0)</code>, because the later causes problems with overloads."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1431529977, "post_id": 30218714, "comment_id": 48541655, "body": "I don&#39;t think there is any syntax difference here since the compiler knows how to compare 0 with (void*)0 , thus it&#39;s a matter of preferable choice"}, {"owner": {"reputation": 1541, "user_id": 3111536, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9555afb668ee02d47b4737a74e93d4fa?s=128&d=identicon&r=PG&f=1", "display_name": "rashmatash", "link": "https://stackoverflow.com/users/3111536/rashmatash"}, "edited": false, "score": 0, "creation_date": 1431530061, "post_id": 30218714, "comment_id": 48541704, "body": "Considering the definition of &#39;idiomatic&#39; which is &quot;to use, contain, or denote expressions that are natural to a native speaker&quot; I&#39;d say that <code>if(ptr)</code> is more idiomatic since its origin is in the very base of <code>C++</code> which is <code>C</code>."}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1431530799, "post_id": 30218714, "comment_id": 48542271, "body": "If you add to your question &quot;only answers that provide an argument by an objective measure&quot; like by size (would go for &quot;if(p)&quot;) or least number of implicit conversions (would go for the other), and if you would not ask for THE best but would just ask for arguments for the different styles, I would vote for reopen because then it is not opinion based."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1431531219, "post_id": 30218714, "comment_id": 48542571, "body": "Personally, I prefer <code>if (ptr != nullptr)</code> (or, in C, <code>if (ptr != NULL)</code>, because it&#39;s more explicit. Of course both are equivalent to <code>if (ptr)</code>; I just find the more explicit forms clearer. Plenty of smart and competent programmers prefer the more terse form <code>if (ptr)</code>."}, {"owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "reply_to_user": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1431531714, "post_id": 30218714, "comment_id": 48542911, "body": "@JohannesSchaub-litb: I asked for an objective reason now, is this version better?"}], "owner": {"reputation": 476, "user_id": 4792865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bada01b5d11bcdaa68b42d55945ab273?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4792865/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 763, "favorite_count": 0, "closed_date": 1431529778, "answer_count": 0, "score": 7, "last_activity_date": 1431531315, "creation_date": 1431529413, "last_edit_date": 1431531315, "question_id": 30218714, "link": "https://stackoverflow.com/questions/30218714/idiomatic-way-to-compare-to-nullptr-ifp-vs-if-p-nullptr", "closed_reason": "Opinion-based", "title": "Idiomatic way to compare to nullptr: if(p) vs if (p != nullptr)", "body": "<p>What is the idiomatic way of comparing a pointer to <code>nullptr</code>?</p>\n\n<pre><code>if (ptr) ...\nif (!ptr) ...\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if (ptr != nullptr) ...\n</code></pre>\n\n<p>I know both are equivalent, but which is preferable?</p>\n\n<p>Personally I find the first version easier to read. But with the implicit conversion from the <code>0</code> literal to <code>nullptr</code> no longer being considered idiomatic (say for initialization), I wonder if the same is true for the implicit conversion of a pointer to <code>bool</code>.</p>\n\n<p>Is there any objective reason to prefer one over the other?</p>\n\n<p>As an analogy, consider a function <code>void foo(void*)</code>. Here, calling <code>foo(nullptr)</code> instead of relying on the implicit conversion <code>foo(0)</code> is better, because the latter breaks once we add an overload of <code>void foo(int)</code>.</p>\n"}, {"tags": ["c++", "algorithm"], "comments": [{"owner": {"reputation": 5811, "user_id": 2726734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkA2E.jpg?s=128&g=1", "display_name": "ryanpattison", "link": "https://stackoverflow.com/users/2726734/ryanpattison"}, "edited": false, "score": 0, "creation_date": 1431529915, "post_id": 30218677, "comment_id": 48541618, "body": "<code>sizeof(temp)</code> wont give you what you think."}, {"owner": {"reputation": 14673, "user_id": 296460, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FGDo8.jpg?s=128&g=1", "display_name": "shuttle87", "link": "https://stackoverflow.com/users/296460/shuttle87"}, "edited": false, "score": 0, "creation_date": 1431532262, "post_id": 30218677, "comment_id": 48543310, "body": "This strikes me as a pretty good example of a situation where using containers such as <code>std::array</code> or <code>std::vector</code> would make life a whole lot easier."}], "answers": [{"comments": [{"owner": {"reputation": 5811, "user_id": 2726734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkA2E.jpg?s=128&g=1", "display_name": "ryanpattison", "link": "https://stackoverflow.com/users/2726734/ryanpattison"}, "edited": false, "score": 3, "creation_date": 1431531733, "post_id": 30219289, "comment_id": 48542928, "body": "or even <code>memset(temp, 0, sizeof(*temp) * n);</code>"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1431531873, "last_edit_date": 1431531873, "creation_date": 1431530986, "answer_id": 30219289, "question_id": 30218677, "link": "https://stackoverflow.com/questions/30218677/find-maximum-sum-rectangle/30219289#30219289", "title": "Find maximum sum rectangle", "body": "<pre><code>memset(temp, 0, sizeof(temp));\n</code></pre>\n\n<p>doesn't do what you expect it to do since <code>sizef(temp)</code> evaluates to just the size of a pointer.</p>\n\n<p>Replace that line with:</p>\n\n<pre><code>memset(temp, 0, sizeof(int)*n);\n</code></pre>\n\n<p>With that change, things work OK in my tests.</p>\n\n<p>You can also use:</p>\n\n<pre><code>memset(temp, 0, sizeof(*temp)*n);\n</code></pre>\n"}], "owner": {"reputation": 1164, "user_id": 3733985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/ulgSV.jpg?s=128&g=1", "display_name": "maryam", "link": "https://stackoverflow.com/users/3733985/maryam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 30219289, "answer_count": 1, "score": -2, "last_activity_date": 1431532085, "creation_date": 1431529325, "last_edit_date": 1431532085, "question_id": 30218677, "link": "https://stackoverflow.com/questions/30218677/find-maximum-sum-rectangle", "title": "Find maximum sum rectangle", "body": "<p>I write this code for <code>Maximum sum rectangle in a 2D matrix</code> problem. But it return false answer. For example for this instance return 0 while the correct answer is 15. User first give size of array then enter elements. What is my mistake?</p>\n\n<h3>Example</h3>\n\n<pre><code>0 -2 -7 0\n9 2 -6 2\n-4 1 -4 1\n-1 8 0 -2\n</code></pre>\n\n<h3>Code</h3>\n\n<pre><code>int kadane(int* arr, int* start, int* finish, int n)\n{\n    int sum = 0, maxSum = INT_MIN, i;\n    *finish = -1;\n    int local_start = 0;\n    for (i = 0; i &lt; n; ++i)\n    {\n        sum += arr[i];\n        if (sum &lt; 0)\n        {\n            sum = 0;\n            local_start = i+1;\n        }\n        else if (sum &gt; maxSum)\n        {\n            maxSum = sum;\n            *start = local_start;\n            *finish = i;\n        }\n    }\n    if (*finish != -1)\n        return maxSum;\n    maxSum = arr[0];\n    *start = *finish = 0;\n    for (i = 1; i &lt; n; i++)\n    {\n        if (arr[i] &gt; maxSum)\n        {\n            maxSum = arr[i];\n            *start = *finish = i;\n        }\n    }\n    return maxSum;\n}\n\nvoid findMaxSum(int** M,int n)\n{\n    int maxSum = INT_MIN, finalLeft, finalRight, finalTop, finalBottom;\n    int left, right, i;\n    int* temp=new int[n];\n    int sum, start, finish;\n    for (left = 0; left &lt;n; ++left)\n    {\n        memset(temp, 0, sizeof(temp));\n        for (right = left; right &lt; n; ++right)\n        {\n            for (i = 0; i &lt; n; ++i)\n                temp[i] += M[i][right];\n            sum = kadane(temp, &amp;start, &amp;finish, n);\n            if (sum &gt; maxSum)\n            {\n                maxSum = sum;\n                finalLeft = left;\n                finalRight = right;\n                finalTop = start;\n                finalBottom = finish;\n            }\n        }\n    }\n    printf(\"(Top, Left) (%d, %d)\\n\", finalTop, finalLeft);\n    printf(\"(Bottom, Right) (%d, %d)\\n\", finalBottom, finalRight);\n    printf(\"Max sum is: %d\\n\", maxSum);\n}\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n    int N;\n    cout&lt;&lt;\"enter size of 2d array\"&lt;&lt;endl;\n    cin&gt;&gt;N;\n    int** M;\n    M=new int*[N];\n    for(int i=0;i&lt;N;i++)\n    {\n        M[i]=new int [N];\n    }\n\n    for(int i=0;i&lt;N;i++)\n    {\n        for(int j=0;j&lt;N;j++)\n        {\n            cin&gt;&gt;M[i][j];\n        }\n    }\n    findMaxSum(M,N);\n    /*for(int i=0;i&lt;N;i++)\n      {\n      delete []M[i];\n      M[i]=0;\n      }\n      delete []M;*/\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "string", "function-calls"], "comments": [{"owner": {"reputation": 13218, "user_id": 1348273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/IYjFG.jpg?s=128&g=1", "display_name": "Lingxi", "link": "https://stackoverflow.com/users/1348273/lingxi"}, "edited": false, "score": 0, "creation_date": 1431528878, "post_id": 30218475, "comment_id": 48540761, "body": "<code>basic_string::c_str</code> returns <code>const char*</code>."}, {"owner": {"reputation": 41100, "user_id": 1938163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/WV0Fi.png?s=128&g=1", "display_name": "Marco A.", "link": "https://stackoverflow.com/users/1938163/marco-a"}, "edited": false, "score": 0, "creation_date": 1431529113, "post_id": 30218475, "comment_id": 48540948, "body": "Oh well, it&#39;s a duplicate anyway."}], "answers": [{"tags": [], "owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "is_accepted": true, "score": 0, "last_activity_date": 1431528905, "creation_date": 1431528905, "answer_id": 30218522, "question_id": 30218475, "link": "https://stackoverflow.com/questions/30218475/using-constructor-call-as-function-parameter/30218522#30218522", "title": "Using constructor call as function parameter", "body": "<p>The temporary will be destroyed at the end of the full expression, after the function returns. So it's fine as long as the function doesn't store a pointer or reference to the argument somewhere; that won't be valid later.</p>\n"}], "owner": {"reputation": 881, "user_id": 4315825, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d021fbb10873466ac1a1abadeab0e886?s=128&d=identicon&r=PG&f=1", "display_name": "Kackao", "link": "https://stackoverflow.com/users/4315825/kackao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1431529051, "accepted_answer_id": 30218522, "answer_count": 1, "score": -2, "last_activity_date": 1431529070, "creation_date": 1431528799, "question_id": 30218475, "link": "https://stackoverflow.com/questions/30218475/using-constructor-call-as-function-parameter", "closed_reason": "Duplicate", "title": "Using constructor call as function parameter", "body": "<p>Is it a good idea to use constructor calls as arguments? E.g. something like</p>\n\n<pre><code>doSomething(ClassA(someConstructorParameter));\n</code></pre>\n\n<p>Will the object be destroyed when the function terminates? Or if you have a function that takes a char* and you don't want it to mess up a string, would</p>\n\n<pre><code>someFunction(string(str).c_str());\n</code></pre>\n\n<p>be a bad idea?</p>\n"}]