[{"tags": ["c++", "c", "wrapper"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1559779219, "post_id": 56469366, "comment_id": 99530142, "body": "Instead of <code>char</code> with seemingly arbitrary lengths, where 30 characters is bound to be way too small in many cases, use <code>char*</code>. You may find that bridging C <code>char[]</code> or <code>char*</code> to C++ <code>std::string</code> isn&#39;t possible without C++."}, {"owner": {"reputation": 1570, "user_id": 1544015, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/5GvtW.jpg?s=128&g=1", "display_name": "Vlad Novakovsky", "link": "https://stackoverflow.com/users/1544015/vlad-novakovsky"}, "edited": false, "score": 0, "creation_date": 1559779756, "post_id": 56469366, "comment_id": 99530229, "body": "Why do you pass confGlobal_wpr  - method requires confGlobal"}, {"owner": {"reputation": 1570, "user_id": 1544015, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/5GvtW.jpg?s=128&g=1", "display_name": "Vlad Novakovsky", "link": "https://stackoverflow.com/users/1544015/vlad-novakovsky"}, "edited": false, "score": 0, "creation_date": 1559779952, "post_id": 56469366, "comment_id": 99530262, "body": "To use c++ code you need define wrapper functions with C calling convention,( extern C) and call them in your C project. Inside those exported functions you can use C++ code."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1559781998, "post_id": 56469366, "comment_id": 99530551, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31903005/how-to-mix-c-and-c-correctly\" title=\"how to mix c and c correctly\">stackoverflow.com/questions/31903005/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "is_accepted": false, "score": 1, "last_activity_date": 1559779368, "creation_date": 1559779368, "answer_id": 56469476, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c/56469476#56469476", "title": "How to create wrapper for using C++ code in C?", "body": "<p>Structs that contain anything other than primitive data types common to C and C++ largely can't be wrapped in the way you want. In this particular case, you have <code>::std::string</code>s in your struct. And they definitely can't be accessed reasonably from C at all.</p>\n\n<p>Additionally, the structs contain <code>bool</code> and I don't know if newer versions of the C standard have <code>bool</code> or define it in such a way that it will result in layout compatible structs with C++ implementations on the same platform.</p>\n\n<p>There are solutions to this problem. But they involve using opaque pointers to the struct in C, and always calling functions to access its methods. I will try to whip up an example of how this might work for a really simple struct.</p>\n\n<p>Looking more carefully at your code, it looks like you need a sort of thunk layer that takes the C struct and (in C++) hand-converts it to the C++ struct and returns a pointer to a dynamically allocated C++ struct that you can then pass to other C++ functions that have been exposed to C.</p>\n"}, {"comments": [{"owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "edited": false, "score": 0, "creation_date": 1559814999, "post_id": 56469585, "comment_id": 99540606, "body": "Thanks so much. I&#39;ve made your modifications in my code and, for the moment, works great. Now, I understand a little bit the wrapper facts and I need to wrap many another struct and methods. One more question: how I destroy the pointer wrapped struct (confGlobal) and pointer wrapper class (ct_api_wpr)? I&#39;m adding destroy methods on my original ask."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1559832291, "post_id": 56469585, "comment_id": 99550403, "body": "I didn&#39;t realize you could use <code>extern &quot;C&quot;</code> on structs. Do you have to? Does it even do anything? I suspect it doesn&#39;t."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "edited": false, "score": 1, "creation_date": 1559853035, "post_id": 56469585, "comment_id": 99559631, "body": "@crossmax well, it&#39;s weird for the API itself because it&#39;s actually a singleton.  So technically, <code>my_api_create</code> could simply be <code>my_api_initialize</code> and return no pointer.  For the <code>confGlobal_wpr</code> your destroy function would simply be <code>void confGlobal_destroy(confGlobal_wpr* confGlobal) { delete confGlobal; }</code> and similar for <code>confPartner_wpr</code>."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1559853365, "post_id": 56469585, "comment_id": 99559745, "body": "@Omnifarious I&#39;m not 100% sure actually, since the structs are already forward-declared as <code>extern &quot;C&quot;</code> in the header.  What I did was basically the same as wrapping the definitions in <code>extern &quot;C&quot;</code>.  But it might not be required, and so this might be wrong.  Certainly in the traditional use of <code>extern</code>, it&#39;s only required on the declaration to my knowledge.  I haven&#39;t needed to write a C++ library wrapper in C for about 20 years ;)  If you find the answer, please drop a note back in here."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 2, "last_activity_date": 1559780591, "creation_date": 1559780591, "answer_id": 56469585, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c/56469585#56469585", "title": "How to create wrapper for using C++ code in C?", "body": "<p>You're forgetting that <code>CT_API::Instance</code> doesn't understand the \"handle\" types that you have created in C to wrap the C++ structures.  This is precisely what the error message is telling you, if you read it.  You must translate those back to the appropriate C++ types.</p>\n\n<p>Firstly, since you are using \"create\"-style routines to build the structures and return them as a pointer, you should consider making your <code>my_api_create</code> function accept pointers instead.  Particularly because the resulting handle types are forward-declared structs with no definition visible in C and it will not be possible for your C client to dereference them.</p>\n\n<p>That highlights another issue. You are also not using these handles correctly from C++.</p>\n\n<p>So, one thing at a time...</p>\n\n<p>Your creation routine in C should be declared as:</p>\n\n<pre><code>my_api_wpr *my_api_create(struct confGlobal_wpr* cGlobal, struct confPartner_wpr* cPartner);\n</code></pre>\n\n<p>On the C++ side, you need to actually <em>define</em> your handle types.  Something like:</p>\n\n<pre><code>extern \"C\" struct confGlobal_wpr {\n    struct confGlobal instance;\n};\n\nextern \"C\" struct confPartner_wpr {\n    struct confPartner instance;\n};\n\nextern \"C\" struct my_api_wpr {\n    my_API *ptr;\n};\n</code></pre>\n\n<p>Now, your creation:</p>\n\n<pre><code>confGlobal_wpr *confGlobal_create(unsigned int device,\n                                  char *name,\n                                  int number,\n                                  char *uid,\n                                  char *message,\n                                  unsigned char mode)\n{\n    confGlobal_wpr *cg = new confGlobal_wpr;\n    struct confGlobal&amp; cGlobal = cg-&gt;instance; //&lt;-- note the reference\n    // TODO: populate cGlobal as usual\n    return cg;\n}\n\nconfPartner_wpr *confPartner_create(product_wpr tableProducts_wpr[],\n                                    unsigned char numProducts,\n                                    category_wpr tableCategories_wpr[],\n                                    unsigned char numCategories,\n                                    subCategory_wpr tableSubCategories_wpr[],\n                                    unsigned char numSubCategories)\n{\n    confPartner_wpr *cc = new confPartner_wpr;\n    struct confPartner&amp; cPartner = cc-&gt;instance; //&lt;-- note the reference\n    // TODO: populate cPartner as usual\n    return cc;\n}\n\nmy_api_wpr *my_api_create(struct confGlobal_wpr* cGlobal, struct confPartner_wpr* cPartner)\n{\n    my_api_wpr *my_api = new my_api_wpr;\n    my_api-&gt;ptr = CT_API::Instance(cGlobal-&gt;instance, cPartner-&gt;instance);\n    return my_api;\n}\n</code></pre>\n\n<p>You should also add corresponding <code>_destroy</code> methods for all the above.</p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 1544015, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/5GvtW.jpg?s=128&g=1", "display_name": "Vlad Novakovsky", "link": "https://stackoverflow.com/users/1544015/vlad-novakovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1559785067, "last_edit_date": 1559785067, "creation_date": 1559781016, "answer_id": 56469619, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c/56469619#56469619", "title": "How to create wrapper for using C++ code in C?", "body": "<p>To use C++ code in C project you need define wrapper functions with C calling convention - extern \"C\"(turning off C++ name mangling/decoration) , and call them and only them in your C project. Inside those C functions you can use C++ code. Pass to C wrapper functions only types that C understands. You can create intermediate structures for passing data to C wrapper functions. Then you need copy data to types that C++ class expects. In you particular case you incorrectly pass confGlobal_wpr wrapper struct but C++ method requires confGlobal, and compiler complains on this directly.</p>\n\n<p>Below is observable snippet how to use C++ code from C code:\nFoo.h</p>\n\n<pre><code>#include &lt;string&gt;\n\nclass Bar\n{\npublic:\n    Bar(std::string s) : s_(s)\n    {\n    }\n    std::string s_;\n};\n\nclass Foo\n{\npublic:\n    Foo(Bar) {}\n};\n</code></pre>\n\n<p>CWrappers.h // include this header to C project</p>\n\n<pre><code>struct BarWrapper\n{\n    char data[100] = \"\";\n};\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nBarWrapper createFoo(char *c);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>Wrapper.cpp</p>\n\n<pre><code>#include &lt;algorithm&gt;\n\n#include \"Foo.h\"\n#include \"CWrappers.h\"\n\n// input and output to this C function should be understandable for C\nBarWrapper createFoo(char *c)\n{\n    // inside you can use C++\n    std::string data(c);\n    Bar bar(data);\n    Foo * foo = new Foo(bar);\n    BarWrapper barWrapper;\n    std::copy(data.begin(), data.end(), barWrapper.data);\n    return barWrapper; // pack data to C struct wrapper (that has no C++ specific)\n}\n</code></pre>\n\n<p>C Project</p>\n\n<pre><code>        #include \"CWrappers.h\"\n\n        int main()\n        {\n            BarWrapper barWrapper = createFoo((char *)\"test\");\n        }\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 1490798, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/026c4f962ea7482ef15032805d0d46d4?s=128&d=identicon&r=PG", "display_name": "crossmax", "link": "https://stackoverflow.com/users/1490798/crossmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "accepted_answer_id": 56469585, "answer_count": 3, "score": 3, "last_activity_date": 1559815495, "creation_date": 1559778191, "last_edit_date": 1559815495, "question_id": 56469366, "link": "https://stackoverflow.com/questions/56469366/how-to-create-wrapper-for-using-c-code-in-c", "title": "How to create wrapper for using C++ code in C?", "body": "<p>I'm trying to do a C wrapper for a C++ third-party library because I need to use it in my C project.\nI've seen examples of a C++ class wrapper but I don't undertood the process and I can't wrapper a C++ struct.</p>\n\n<p>struct I want to wrapper:</p>\n\n<pre><code>struct confGlobal{\n    long int device;\n    string name;\n    int number;\n    string uid;\n    string message;\n    bool mode;\n\n    confiGlobal():device{LONG_MAX}, number{INT_MAX}{}\n};\n\nstruct product{\n    string id;\n    string name;\n};\nstruct category{\n    unsigned char id;\n    string name;\n    string description;\n\n    category():id{UCHAR_MAX}{}\n};\nstruct subCategory{\n    unsigned char id;\n    string name;\n    string description;\n    unsigned char idRoot;\n\n    subCategory():id{UCHAR_MAX}, idRoot{UCHAR_MAX}{}\n};\nstruct confPartner{\n    vector&lt;struct product&gt; tableProduct;\n    vector&lt;struct category&gt; tableCategory;\n    vector&lt;struct subCategory&gt; tableSubCategory;\n};\n</code></pre>\n\n<p>For call to this method:</p>\n\n<pre><code>class my_API {\npublic:\n    static my_API* Instance(struct confGlobal cGlobal,\n                        struct confPartner cPartner);\n   ... another methods ...\nprivate:\n    virtual ~my_API();\n    struct confGlobal cGlobal;\n    struct confPertner cPartner;\n};\n</code></pre>\n\n<p>I need to fill this structs and call <code>my_API::Instance()</code> from C but my attempts have been unsuccessful.</p>\n\n<p>wrapper.h</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\nstruct confGlobal_wpr; // An opaque type that we'll use as a handle\ntypedef struct confGlobal_wpr confGlobal_wpr;\nconfGlobal_wpr *confGlobal_create(unsigned int device,\n                     char *name,\n                     int number,\n                     char *uid,\n                     char *message,\n                     unsigned char mode);\n\nstruct product_wpr{\n    char id[4];\n    char name[30];\n};\ntypedef struct product_wpr product_wpr;\n\nstruct category_wpr{\n    unsigned char id;\n    char name[3];\n    char description[30];\n};\ntypedef struct category_wpr category_wpr;\n\nstruct subcategory_wpr{\n    unsigned char id;\n    char name[3];\n    char description[30];\n    unsigned char idRoot;\n};\ntypedef struct subCategory_wpr subCategory_wpr;\nstruct confPartner_wpr; // An opaque type that we'll use as a handle\ntypedef struct confPartner_wpr confPartner_wpr;\nconfPartner_wpr *confPartner_create(Product_wpr tableProducts[],\n                     unsigned char numProducts,\n                     Category_wpr tableCategories[],\n                     unsigned char numCategories,\n                     SubCategory_wpr tableSubCategories[],\n                     unsigned char numSubCategories);\n\nstruct my_api_wpr;\ntypedef struct my_api_wpr my_api_wpr;\n\nmy_api_wpr *my_api_create(struct confGlobal_wpr cGlobal,\n                     struct confPartner_wpr cPartner);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>wrapper.cpp</p>\n\n<pre><code>confGlobal_wpr *confGlobal_create(unsigned int device,\n                     char *name,\n                     int number,\n                     char *uid,\n                     char *message,\n                     unsigned char mode)\n{\n    confGlobal_wpr *cg;\n    struct confGlobal confiGlobal;\n    confiGlobal.name = name;\n    confiGlobal.device = device;\n    confiGlobal.number = number;\n    confiGlobal.uid = uid;\n    confiGlobal.message = message;\n    if (mode == 0)\n        confiGlobal.mode = false;\n    else\n        confiGlobal.mode = true;\n    return cg;\n}\nvoid confGlobal_destroy(confGlobal_wpr *cg)\n{\n    if (cg == NULL)\n        return;\n    delete static_cast&lt;confGlobal_wpr *&gt;(cg-&gt;instance); // ERROR: invalid static_cast from type \u2018confGlobal\u2019 to type \u2018confGlobal_wpr*\u2019\n    free(cg);\n}\n\nconfPartner_wpr *confPartner_create(product_wpr tableProducts_wpr[],\n                     unsigned char numProducts,\n                     category_wpr tableCategories_wpr[],\n                     unsigned char numCategories,\n                     subCategory_wpr tableSubCategories_wpr[], \n                     unsigned char numSubCategories)\n{\n    unsigned char i=0;\n\n    confPartner_wpr *cc;\n    struct confPartner cPartner;\n    vector&lt; struct product&gt; tableProduct;\n    vector&lt; struct category&gt; tableCategory;\n    vector&lt; struct subCategory&gt; tableSubCategory;\n\n    for (i=0; i&lt;numProducts; i++)\n    {\n        struct product p;\n        p.id = tableProducts_wpr[i].id;\n        p.name = tableProducts_wpr[i].name;\n        tableProduct.push_back(p);\n    }\n    cPartner.tableProduct = tableProducts;\n\n    for (i=0; i&lt;numCategories; i++)\n    {       \n        struct category c;\n        c.id = tableCategories_wpr[i].id;\n        c.nombre = tableCategories_wpr[i].name;\n        c.descripcion = tableCategories_wpr[i].description;\n        tableCategory.push_back(c);\n    }\n    cPartner.tableCategory = tableCategory;\n\n    for (i=0; i&lt;numSubCategories; i++)\n    {\n        struct subZona sc;\n        sc.id = tableSubCategories_wpr[i].id;\n        sc.name = tableSubCategories_wpr[i].name;\n        sc.description = tableSubCategories_wpr[i].description;\n        sc.idRoot = tableSubCategories_wpr[i].idRoot;\n        tableSubCategory.push_back(sc);     \n    }\n    cPartner.tableSubCategory = tableSubCategory;\n    return cc;\n\n}\n\nmy_api_wpr *my_api_create(struct confGlobal_wpr confiGlobal_wpr,\n                      struct confPartner_wpr confiPartner_wpr)\n{\n    my_api_wpr *my_api;\n    my_API *obj;\n    my_api = (typeof(my_api))malloc(sizeof(*my_api));\n    obj    = my_API::Instance(confiGlobal_wpr, confiConsorcio_wpr);\n    /* With this compile and linked OK\n    confGlobal cg;\n    confPartner cc;\n    obj    = my_API::Instance(cg, cc);\n    */\n    my_api-&gt;obj = obj;\n\n    return my_api;\n}\nvoid my_api_destroy(ct_api_wpr *my_api)\n{\n    if (my_api == NULL)\n        return;\n    delete static_cast&lt;my_API *&gt;(my_api-&gt;ptr_api); // ERROR: \u2018virtual my_API::~my_API()\u2019 is private within this context\n    free(my_api);\n}\n</code></pre>\n\n<p>The output error when compile and linked with:</p>\n\n<pre><code>g++ -shared -o libwrapper.so *.cpp wrapper.h -l:libthird-party.a -L. -ldl -lrt -Wl,-rpath /usr/local/lib -lc\n</code></pre>\n\n<pre><code>In function \u2018my_api_wpr* my_api_create(confGlobal_wpr, confPartner_wpr)\u2019:\nerror: no matching function for call to \u2018my_API::Instance(confGlobal_wpr&amp;, confPartner_wpr&amp;)\u2019\n  obj    = my_API::Instance(confiGlobal_wpr, confiConsorcio_wpr);\n                                                               ^\nmy_API.h:30:20: note: candidate: static my_API* my_API::Instance(confGlobal, confPartner)\n     static my_API* Instance(struct confGlobal cGlobal, struct confiPartner cPartner);\n                    ^~~~~~~~\nmy_API.h:30:20: note:   no known conversion for argument 1 from \u2018confGlobal_wpr\u2019 to \u2018confGlobal\u2019\n</code></pre>\n"}, {"tags": ["c++", "string", "substring"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1559777194, "post_id": 56469245, "comment_id": 99529805, "body": "Do you have to check prefix/suffix before removing them?"}, {"owner": {"reputation": 99, "user_id": 5541604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5d603acfdcb7f0bebc02cd0e533c95?s=128&d=identicon&r=PG&f=1", "display_name": "slimjourney", "link": "https://stackoverflow.com/users/5541604/slimjourney"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559777581, "post_id": 56469245, "comment_id": 99529874, "body": "@Jarod42 The start and end delimiters are the same, and theyre always located at the very ends. Updated my question for others to see."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5541604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5d603acfdcb7f0bebc02cd0e533c95?s=128&d=identicon&r=PG&f=1", "display_name": "slimjourney", "link": "https://stackoverflow.com/users/5541604/slimjourney"}, "edited": false, "score": 0, "creation_date": 1559778606, "post_id": 56469374, "comment_id": 99530051, "body": "Thanks for the suggestions, though I&#39;m only working with C++11 right now. but definitely I&#39;ll try the <code>.assign()</code> also."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 2, "last_activity_date": 1559778267, "creation_date": 1559778267, "answer_id": 56469374, "question_id": 56469245, "link": "https://stackoverflow.com/questions/56469245/remove-substring-from-both-ends-of-an-stdstring/56469374#56469374", "title": "Remove substring from both ends of an std::string?", "body": "<p>The only problem with your code is that <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/substr\" rel=\"nofollow noreferrer\"><code>.substr()</code></a> creates a new <code>std::string</code>, resulting in an expensive allocation (unless the result is small enough for SSO to work).</p>\n\n<p>Use <a href=\"https://en.cppreference.com/w/cpp/string/basic_string_view\" rel=\"nofollow noreferrer\"><code>std::string_view</code></a> to fix that:</p>\n\n<pre><code>str = std::string_view(str).substr(sub.length(), str.length() - sub.length() * 2);\n</code></pre>\n\n<p>Alternatively, use <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/assign\" rel=\"nofollow noreferrer\"><code>.assign()</code></a>:</p>\n\n<pre><code>str.assign(str.begin() + sub.length(), str.end() - sub.length());\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 2, "creation_date": 1559778517, "post_id": 56469380, "comment_id": 99530036, "body": "A needless extra-allocation is certainly not <i>efficient</i>."}, {"owner": {"reputation": 99, "user_id": 5541604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5d603acfdcb7f0bebc02cd0e533c95?s=128&d=identicon&r=PG&f=1", "display_name": "slimjourney", "link": "https://stackoverflow.com/users/5541604/slimjourney"}, "edited": false, "score": 0, "creation_date": 1559778734, "post_id": 56469380, "comment_id": 99530075, "body": "Thanks for suggesting the function, though its only done in one place in the code. I&#39;ll keep my current code in my question then since I&#39;m using C++11 for now."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1559779567, "post_id": 56469380, "comment_id": 99530196, "body": "@Deduplicator: Why do you call it <i>extra</i>?  We don\u2019t know enough to say whether the <code>string</code> created is used for something that would not support a pointer/length pair.  (For example, the source could be already a <code>const std::string</code> and the result could be used with a <code>const char*</code>.)"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1559779645, "post_id": 56469380, "comment_id": 99530210, "body": "Considering that there is a solution without any allocation, the one allocation is &quot;extra&quot;."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1559779720, "post_id": 56469380, "comment_id": 99530222, "body": "@Deduplicator: Show how to get the result as a NTBS without allocating or writing to the original and we\u2019re set."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1559781212, "post_id": 56469380, "comment_id": 99530439, "body": "@Davis: Now you are moving the goal-posts."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1559787182, "post_id": 56469380, "comment_id": 99531426, "body": "@Deduplicator: As I said, we don\u2019t have enough information to exclude that as the use case.  So it <b>might</b> be inefficient; I already conditioned \u201cefficient\u201d on needing the result as a <code>std::string</code>."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": true, "score": 1, "last_activity_date": 1559778329, "creation_date": 1559778329, "answer_id": 56469380, "question_id": 56469245, "link": "https://stackoverflow.com/questions/56469245/remove-substring-from-both-ends-of-an-stdstring/56469380#56469380", "title": "Remove substring from both ends of an std::string?", "body": "<p>What you have is correct (for this constrained case) and efficient (assuming that you need a <code>std::string</code> result; <code>std::string_view</code> might be good if you\u2019re using C++17).  If it\u2019s ugly, make it a function so that the rest of the code can use</p>\n\n<pre><code>std::string mid=remove2(whole, delim);\n</code></pre>\n\n<p>\u2026although that\u2019s <em>not</em> efficient in the case of</p>\n\n<pre><code>remove2(whole, \"literal\")\n</code></pre>\n\n<p>which allocates memory just to count the characters whose number is already known at compile time.  If that matters, you could add an overload that took a length and write</p>\n\n<pre><code>remove2(whole, sizeof(\"literal\")-1)\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5541604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5d603acfdcb7f0bebc02cd0e533c95?s=128&d=identicon&r=PG&f=1", "display_name": "slimjourney", "link": "https://stackoverflow.com/users/5541604/slimjourney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 56469380, "answer_count": 2, "score": 1, "last_activity_date": 1559778329, "creation_date": 1559777038, "last_edit_date": 1559777958, "question_id": 56469245, "link": "https://stackoverflow.com/questions/56469245/remove-substring-from-both-ends-of-an-stdstring", "title": "Remove substring from both ends of an std::string?", "body": "<p>I'm trying to remove some start and end delimiters in a std::string. Is there a built in or better way to do this?</p>\n\n<p>Here is my current way:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::string sub = \"~test.txt~\";\nstd::string str = \"~test.txt~The quick brown fox jumps over the lazy dog.~test.txt~\";\n\nstr = str.substr(sub.length(), str.length() - sub.length() * 2);\n</code></pre>\n\n<p>Start and end delimiters are exactly the same, and they are located at the very edges.</p>\n\n<p>Expected value is <code>The quick brown fox jumps over the lazy dog.</code>.</p>\n"}, {"tags": ["c++", "graphics", "raytracing", "phong"], "answers": [{"comments": [{"owner": {"reputation": 310, "user_id": 2752471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db0f898d45f128b4f8f755eeb6494bae?s=128&d=identicon&r=PG&f=1", "display_name": "user2752471", "link": "https://stackoverflow.com/users/2752471/user2752471"}, "edited": false, "score": 0, "creation_date": 1560293370, "post_id": 56469568, "comment_id": 99686702, "body": "Thanks for the explanation, very interesting, One doubt that came up on my head was about the exposure value. It&#39;s a user defined value right? Is there a way to obtain a good idea of some nice start values, or I have to guess it and see how it looks like?"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 310, "user_id": 2752471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db0f898d45f128b4f8f755eeb6494bae?s=128&d=identicon&r=PG&f=1", "display_name": "user2752471", "link": "https://stackoverflow.com/users/2752471/user2752471"}, "edited": false, "score": 1, "creation_date": 1560355390, "post_id": 56469568, "comment_id": 99711909, "body": "@user2752471: The article I linked to in #2 uses a generic constant K to account for aperature, shutter speed, and sensitivity of the film.  I&#39;d start by setting that to 1 and then adjust it as necessary, either by doubling it or halving it, until you get something that looks right.  In a physical simulation, the brightness of your light sources would have actual physical units and you could work out a reasonable value.  But most ray tracers just use an imaginary, qualitative unit that ranges from &quot;very dark&quot; to &quot;very bright.&quot;"}], "tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 2, "last_activity_date": 1559780404, "creation_date": 1559780404, "answer_id": 56469568, "question_id": 56469172, "link": "https://stackoverflow.com/questions/56469172/artifacts-with-phong-shading-and-ray-tracing/56469568#56469568", "title": "Artifacts with phong shading and ray-tracing", "body": "<p>First suggestion:  Don't represent the intensity of light sources using 0.0 - 255.0.  Use 0.0 to 1.0.  Scaling and accumulation will work better.  When it's time to display, you map the final intensity to a pixel value in the 0 - 255 range.</p>\n\n<p>If you represent your \"brightest\" light as 255, and your scene has one such light, then you can get away with it.  But if you then add a second light, any given pixel could potentially be illuminated by both lights and end up twice as bright as the brightest thing you can represent, which is basically what's happening in your first example--most of your pixels are too bright to display.</p>\n\n<p>To normalize for lights, you'd have to have extra divisions and multiplications by <code>number_of_lights * 255</code>.  That gets messy.  Intensity scales and accumulates linearly, but pixel values don't.  So work with intensity and convert to pixel values at the end.</p>\n\n<p>To do the mapping, you have a few options.</p>\n\n<ol>\n<li><p>Find the lowest and highest intensities in your image, and use a linear mapping to transform them into pixel values from 0 - 255.</p>\n\n<p>For example, if your lowest intensity is 0.1, and your highest is 12.6, then you can compute each pixel value like this:</p>\n\n<pre><code>pixel_value = (intensity - 0.1) / (12.6 - 0.1) * 255;\n</code></pre>\n\n<p>This isn't very realistic (physically) but it's sufficient to get decent results regardless of how much (or little) light you have in the scene.  You're effectively doing a crude \"auto-exposure.\"  Unfortunately, your \"dark\" scenes will seem too bright and your bright scenes may seem to dark.</p></li>\n<li><p>The actual response curve of eyes and film to light intensity is not linear.  It's usually an s-shaped curve, which can often be approximated by something like:</p>\n\n<pre><code>response = 1 - exp(intensity / exposure);\npixel_value = 255 * response;  // clamp to 0 - 255\n</code></pre>\n\n<p>There's a really good explanation of the <a href=\"http://web.archive.org/web/20160305200308/http://freespace.virgin.net/hugo.elias/graphics/x_posure.htm\" rel=\"nofollow noreferrer\">exposure equation here</a>.  Basically, adding a second light of equal intensity should not make the pixels twice as bright because that's not really how we (or film) perceives brightness.</p>\n\n<p>Response curves can be even more complicated.  Old-school photo-sensitive film has strange properties.  For example, a long exposure with film can result in a different image than an \"equivalent\" exposure taken with a fast shutter.</p></li>\n</ol>\n\n<p>When you want to get super accurate, you also look at things like the gamma of your viewing system, which tries to account for non-linearities not only in perception, but also in the display and sensor.  If I understand correctly, HDR is ultimately about careful mapping of measured intensity to display values in order to preserve contrast across a wide range of intensities.</p>\n\n<p>Finally, while it's not directly related to the problem you showed, it looks like you reversed the diffuse and specular material properties in the snippet of code you included:</p>\n\n<pre><code>final_color = diffuse_color * mat.ks + specular_color * mat.kd;\n</code></pre>\n\n<p>I assume you meant to use <code>mat.ks</code> for specular and <code>mat.kd</code> for diffuse.  This might make things confusing when you're trying to adjust these values.</p>\n"}, {"comments": [{"owner": {"reputation": 310, "user_id": 2752471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db0f898d45f128b4f8f755eeb6494bae?s=128&d=identicon&r=PG&f=1", "display_name": "user2752471", "link": "https://stackoverflow.com/users/2752471/user2752471"}, "edited": false, "score": 0, "creation_date": 1560294070, "post_id": 56469699, "comment_id": 99686878, "body": "Hi @Lemon Drop. Thanks for the throughout explanation. In the case of the Lo(wo) = Le(wo) + \u222b f(wi, wo) * (wi . n) * Li(wi) dwi, the kd and ks coefficients cannot leave the summing that represents the integral precisely why? It&#39;s part of the f (wi,wo) right? So moving it outside will affect the (wi . n) * Li(wi) dwi part of the equation, while it shouldn&#39;t?"}, {"owner": {"reputation": 1993, "user_id": 2085551, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0485ff74077d28fd59bce3e84212de8?s=128&d=identicon&r=PG", "display_name": "Lemon Drop", "link": "https://stackoverflow.com/users/2085551/lemon-drop"}, "reply_to_user": {"reputation": 310, "user_id": 2752471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db0f898d45f128b4f8f755eeb6494bae?s=128&d=identicon&r=PG&f=1", "display_name": "user2752471", "link": "https://stackoverflow.com/users/2752471/user2752471"}, "edited": false, "score": 1, "creation_date": 1560306002, "post_id": 56469699, "comment_id": 99688833, "body": "@user2752471 I suppose in a simpler lighting model the kd and ks can probably be written outside too, but in general it&#39;s just not since it does make the BRDF a bit more confusing to read when it&#39;s separated out like that, not to mention it&#39;d require two loops when only one is really needed. Additionally some BRDFs base ks on fresnel and derive kd from that, so it becomes dependent anyways on things within the integral such as wi which would prevent it from being extracted as a constant."}], "tags": [], "owner": {"reputation": 1993, "user_id": 2085551, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0485ff74077d28fd59bce3e84212de8?s=128&d=identicon&r=PG", "display_name": "Lemon Drop", "link": "https://stackoverflow.com/users/2085551/lemon-drop"}, "is_accepted": false, "score": 3, "last_activity_date": 1559784230, "last_edit_date": 1559784230, "creation_date": 1559782041, "answer_id": 56469699, "question_id": 56469172, "link": "https://stackoverflow.com/questions/56469172/artifacts-with-phong-shading-and-ray-tracing/56469699#56469699", "title": "Artifacts with phong shading and ray-tracing", "body": "<p>If you look at the general definition for the Phong reflection model, it is usually a summation over all the light sources with the form:</p>\n\n<p><code>\u03a3 kd * (L . N) * i + ks * (R . V)^a * i</code></p>\n\n<p>In this case <code>kd</code> and <code>ks</code> are the diffuse and specular constants, <code>L</code>, <code>N</code> and <code>R</code> are the relevant vectors, <code>a</code> is the shininess and <code>i</code> is the intensity of the current incoming light. Your version is slightly different as you can rewrite this in the way you did by splitting the summation and moving the constants out, but this is not as common a way to do it:</p>\n\n<p><code>kd * \u03a3 ((L . N) * i) + ks * \u03a3 ((R . V)^a * i)</code></p>\n\n<p>The reason why that is not done as much is due to how the general rendering equation works, which is typically in the form of an integral over a hemisphere at a point:</p>\n\n<p><code>Lo(wo) = Le(wo) + \u222b f(wi, wo) * (wi . n) * Li(wi) dwi</code></p>\n\n<p>In this case <code>Lo</code> is the outgoing radiance along a direction <code>wo</code>, <code>Le</code> is the emissive contribution in a direction, <code>f</code> is the BRDF, <code>n</code> is the normal of the surface and <code>Li</code> is the incoming radiance contribution in the incoming direction <code>wi</code> (which is what is being integrated over). In practicality this is implemented as a summation, showing once more that the lighting contribution at a point in a direction is type of weighted sum of each individual lighting calculation in a direction. In the case of a simple renderer with point lights such as yours, this is simply the sum of each light's contribution, since it is assumed light can only come from a light source and not the environment itself. This isn't really a problem but if you ever plan on implementing a more complex lighting model then you'll have to rewrite your program's structure a bit.</p>\n\n<p>The main issue however I suspect is just the fact that lighting in a ray traced scene is typically done in a linear space with no bounds, meaning that light will not always stay in the range 0-1 as you have observed. Lights can be represented with values much greater than 1 to differentiate for example the sun from a simple desk light, or in your case likely the combination of many small lights is causing the values on the surface to be much more than 1 when combined. While this is not a problem during rendering (and in fact must be this way for proper results), it is a problem for when you decide to finally present the image as monitors only accept either 8 bit or in the case of more modern HDR display devices, 10 bit color for each channel, meaning that somehow you must represent the entire floating point range of radiance in your scene as a much more limited integer range.</p>\n\n<p>This process of going from HDR to LDR is typically done through tonemapping which is effectively an operation to squeeze the range of values down into something presentable in an \"intelligent\" way, whatever that may be. Various factors can be incorporated into tonemapping such as exposure which can be derived even from physically simulated camera properties such as its shutter speed, aperture and ISO (as we are used to how cameras capture the world as seen in movies and photographs), or can be crudely approximated as many video games do, or it can be ignored altogether. Additionally, the curve and \"style\" of the tonemapping operation is completely subjective, usually selected based on what looks appropriate for the content in question or chosen specifically by artists in the case of something such as a movie or a video game, meaning you can pretty much just choose whatever looks best to you as there is no one right answer (again it's usually based on the S shape curve film exhibits due to the widespread usage of cameras in media).</p>\n\n<p>Even after the range of values has been converted to something more reasonable for display output however, the color space may still be incorrect and depending on how you are writing it to a display device, it may need to be gamma corrected by putting the values through an OETF (opto-electronic transfer function) to encode the output an electronic signal for the monitor. Typically, you do not have to worry about color space as most people all work on monitors in sRGB (a slight variant of Rec. 709) and use it directly in their applications, so unless you go out of your way to make the color space in your ray tracer something other than that, then it is nothing to worry about. On the other hand, gamma correction typically must be done as the default framebuffer in APIs such as OpenGL, Direct3D or Vulkan is usually in gamma space already (whereas lighting math as mentioned before is done in linear space), though if you're outputting to something such as an image then it might not be needed depending on the format.</p>\n\n<p>As a summary though, you pretty much just need to apply a tonemapping operator and potentially gamma correct your final color output to get something looking reasonably correct. If you need a quick and dirty one you can try <code>x / (x + 1)</code> (otherwise known as Reinhard tonemapping) where x would be the output from the ray tracing. You can multiply the input to this function by some arbitrary constant as well for a simple \"exposure\" adjustment if the output is too dark. Finally, if your output device is expecting something in gamma space, then you can take the tonemapped output and apply the function <code>x^(1.0 / 2.2)</code> to it (note this is a slight simplification of the proper sRGB OETF but it's fine to use as long as you keep that in mind) to get it into gamma space, though again if you're outputting to an image this is not usually needed, but still something to keep in mind. Another thing to note is that tonemapping will typically output on the range 0-1, so if you do need to convert to 8 bit integers by multiplying by 255 or whatever an output image format for example may expect, this should be done after everything rather than before any of this, as multiplying it earlier will pretty much do nothing except make the scene look a lot brighter.</p>\n\n<p>I'd also like to mention if you are ever planning on developing this ray tracer further into something more detailed such as a path tracer, using a Phong lighting model will not be sufficient due to its violation of the energy conservation properties expected by the rendering equation. Many BRDFs exist, even a relatively simple Phong-based one (with some slight modifications to get it to behave properly), so such a change would not require too much additional code but would improve the visual fidelity of the renderer and make it more future proof if more complex behavior is ever implemented.</p>\n"}], "owner": {"reputation": 310, "user_id": 2752471, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/db0f898d45f128b4f8f755eeb6494bae?s=128&d=identicon&r=PG&f=1", "display_name": "user2752471", "link": "https://stackoverflow.com/users/2752471/user2752471"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1559784230, "creation_date": 1559776426, "question_id": 56469172, "link": "https://stackoverflow.com/questions/56469172/artifacts-with-phong-shading-and-ray-tracing", "title": "Artifacts with phong shading and ray-tracing", "body": "<p>I am currently experimenting different artifacts when implementing phong shading on my ray-tracer.</p>\n\n<p>The first case case happens when I implement the specular lighting calculation the way I suppose to be right: adding the contributions of the light sources cumulatively with:</p>\n\n<pre><code>specular_color += light_intensity * std::pow (std::max(0.f,reflected*camera_dir),mat.ns); \n</code></pre>\n\n<p><img src=\"https://i.postimg.cc/dQpWKCXR/teapot-overflow.jpg\" alt=\"teapot-overflow\"/><br/><br/></p>\n\n<p>However, if I do not accumulate the contribution, by means of </p>\n\n<pre><code>specular_color = light_intensity * std::pow (std::max(0.f,reflected*camera_dir),mat.ns);\n</code></pre>\n\n<p>I get this:</p>\n\n<p><img src=\"https://i.postimg.cc/g2PNxWGn/teapot-sem-verflow.jpg\" alt=\"teapot-sem-verflow\"/><br/><br/></p>\n\n<p>Seems closer, but still with some artifacts.</p>\n\n<p>Printing some of the values assumed by the specular_color variable (that is a 3 float object) I receive values as high as</p>\n\n<blockquote>\n  <p>specular_color (200) after: 1534.73 1534.73 1534.73</p>\n</blockquote>\n\n<p>for pixel of x and y=200 with + sign added</p>\n\n<p>without it I receive:</p>\n\n<blockquote>\n  <p>specular_color (200) after: 0 0 0</p>\n</blockquote>\n\n<p>All these float values are clamped with</p>\n\n<pre><code>a [ctr] = min (final_color.blue*255.0f,255.0f);\n     a [ctr+1] = min (final_color.green*255.0f,255.0f);\n     a [ctr+2] = min (final_color.red*255.0f,255.0f); \n</code></pre>\n\n<p>for file writing</p>\n\n<p>And final_value is nothing more than:</p>\n\n<pre><code>final_color = diffuse_color * mat.ks + specular_color * mat.kd;\n</code></pre>\n\n<p>The components of specular_color (light_intensity,reflected,camera_dir) seems to be right, since are used in other places without problems.</p>\n\n<p>So I would appreciate any suggestions of where an error might be and how to fix it.</p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1559776881, "post_id": 56469144, "comment_id": 99529743, "body": "If you need to iterate content, <code>std::vector</code> (or <code>QVector</code> or even <code>QList</code>) might be more appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 1206, "user_id": 9524116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9O3IU.jpg?s=128&g=1", "display_name": "Pedro Martins de Souza", "link": "https://stackoverflow.com/users/9524116/pedro-martins-de-souza"}, "edited": false, "score": 0, "creation_date": 1559777788, "post_id": 56469265, "comment_id": 99529911, "body": "I see. But since I would only use QVector only to <i>read</i> each element without removing nor changing it, would it really be troublesome? When editing, adding or removing elements, my idea is to still work with the LIFO ordering concept."}, {"owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "reply_to_user": {"reputation": 1206, "user_id": 9524116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9O3IU.jpg?s=128&g=1", "display_name": "Pedro Martins de Souza", "link": "https://stackoverflow.com/users/9524116/pedro-martins-de-souza"}, "edited": false, "score": 0, "creation_date": 1559779119, "post_id": 56469265, "comment_id": 99530129, "body": "hmm, not sure what you mean by &quot;troublesome&quot;? When adding/removing/accessing last element you can use QVector&#39;s push_back(), pop_back() and back()(or last()) members instead of QStack&#39;s push(), pop() and top()."}, {"owner": {"reputation": 837, "user_id": 7583635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbJ9A.jpg?s=128&g=1", "display_name": "Martin Konrad", "link": "https://stackoverflow.com/users/7583635/martin-konrad"}, "edited": false, "score": 0, "creation_date": 1559781799, "post_id": 56469265, "comment_id": 99530523, "body": "I don&#39;t see a reason why you shouldn&#39;t leverage the <code>QVector</code> properties of <code>QStack</code>. <a href=\"https://doc.qt.io/archives/qt-4.8/qstack.html#public-functions\" rel=\"nofollow noreferrer\">They are explicitly documented as part of the API</a>. Keep in mind, though, that many C++ programmers might not be familiar with the characteristics of the Qt containers. Instead they might expect <code>QStack</code> to behave like a pure stack (e.g. like <code>std::stack</code>). That&#39;s why I usually prefer the standard library containers."}], "tags": [], "owner": {"reputation": 542, "user_id": 10865566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b1030e5af9ef662afc6d7a806d0182?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/10865566/david"}, "is_accepted": true, "score": 2, "last_activity_date": 1559778755, "last_edit_date": 1559778755, "creation_date": 1559777251, "answer_id": 56469265, "question_id": 56469144, "link": "https://stackoverflow.com/questions/56469144/how-can-i-iterate-through-the-elements-of-a-qstack-object/56469265#56469265", "title": "How can I iterate through the elements of a QStack object?", "body": "<p>QStack inherits from QVector so you <em>can</em> (but most likely <em>shouldn't</em>) iterate same way as you do with QVector. </p>\n\n<pre><code>QStack &lt;int&gt; stack;\nstack.push(1);\nstack.push(2);\nstack.push(3);\n\nfor (int i : stack)\n{\n    std::cout &lt;&lt; i &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>However, there is a very good chance that you should <strong>NOT</strong> be using stack if you need to iterate. Just use the actual QVector.</p>\n\n<p>The point of using a Stack is to \"enforce\" LIFO (Last In First Out) ordering on items. If you are iterating over them in any particular order you are breaking the order enforced by Stack and so (very likely) should NOT be using a stack in the first place.</p>\n\n<p>P.S. This was focused on QStack, but the same reasoning applies to QQueue as well. Differences are that Queue enforces FIFO (First In First Out) ordering and in QT QQueue inherits from QList, so replace it with QList not QVector.</p>\n"}, {"tags": [], "owner": {"reputation": 837, "user_id": 7583635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbJ9A.jpg?s=128&g=1", "display_name": "Martin Konrad", "link": "https://stackoverflow.com/users/7583635/martin-konrad"}, "is_accepted": false, "score": 0, "last_activity_date": 1559784990, "last_edit_date": 1559784990, "creation_date": 1559783809, "answer_id": 56469835, "question_id": 56469144, "link": "https://stackoverflow.com/questions/56469144/how-can-i-iterate-through-the-elements-of-a-qstack-object/56469835#56469835", "title": "How can I iterate through the elements of a QStack object?", "body": "<p><a href=\"https://doc.qt.io/qt-5/containers.html#the-container-classes\" rel=\"nofollow noreferrer\">The Qt documentation</a> says about <code>QStack</code>:</p>\n\n<blockquote>\n  <p>This is a convenience subclass of QVector that provides \"last in, first out\" (LIFO) semantics. It adds the following functions to those already present in QVector: push(), pop(), and top().</p>\n</blockquote>\n\n<p>As <a href=\"https://stackoverflow.com/users/10865566/david\">David</a> pointed out you can iterate over the entries in a <code>QStack</code> the same way you iterate over a <code>QVector</code>:</p>\n\n<pre><code>QStack &lt;int&gt; stack;\nstack.push(1);\nstack.push(2);\nstack.push(3);\n\nfor (int i : stack)\n{\n    std::cout &lt;&lt; i &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>BTW: The <a href=\"https://en.cppreference.com/w/cpp/container\" rel=\"nofollow noreferrer\">standard library's documentation</a> comes with a similar page describing the properties of it's containers - these pages are generally very helpful when deciding which container to use.</p>\n"}], "owner": {"reputation": 1206, "user_id": 9524116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9O3IU.jpg?s=128&g=1", "display_name": "Pedro Martins de Souza", "link": "https://stackoverflow.com/users/9524116/pedro-martins-de-souza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 56469265, "answer_count": 2, "score": 0, "last_activity_date": 1559785032, "creation_date": 1559776189, "last_edit_date": 1559785032, "question_id": 56469144, "link": "https://stackoverflow.com/questions/56469144/how-can-i-iterate-through-the-elements-of-a-qstack-object", "title": "How can I iterate through the elements of a QStack object?", "body": "<p>I've started using Qt's classes recently in my university, and got kinda impressed with its efficiency. Going through the documentation, I found some information about <a href=\"https://doc.qt.io/qt-5/qstack.html\" rel=\"nofollow noreferrer\">QStack</a> and <a href=\"https://doc.qt.io/qt-5/qqueue.html\" rel=\"nofollow noreferrer\">QQueue</a>, both classes useful for projects I'm developing.</p>\n\n<p>However, I've been facing quite a puzzle: <strong>how can I iterate through all elements of a QStack object?</strong></p>\n\n<p>For example, let's say I want to iterate through the elements of the <code>stack</code> object in the example below (<a href=\"https://doc.qt.io/qt-5/qstack.html\" rel=\"nofollow noreferrer\">extracted from Qt's documentation about QStack</a>):</p>\n\n<pre><code>QStack&lt;int&gt; stack;\nstack.push(1);\nstack.push(2);\nstack.push(3);\nwhile (!stack.isEmpty())\n    cout &lt;&lt; stack.pop() &lt;&lt; endl;\n</code></pre>\n\n<p>I managed to do so by removing each element of the stack, one by one, and saving them on a temp list, but this seems like a terrible way to solve this problem. What else could I do?</p>\n"}, {"tags": ["c++", "visual-studio-2017", "mfc"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1559927894, "post_id": 56468932, "comment_id": 99586569, "body": "Please add a tag to indicate the version of Visual Studio you are using."}, {"owner": {"reputation": 951, "user_id": 1076116, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/jl97U.jpg?s=128&g=1", "display_name": "ShinT", "link": "https://stackoverflow.com/users/1076116/shint"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1560554456, "post_id": 56468932, "comment_id": 99788313, "body": "@IInspectable added!"}], "owner": {"reputation": 951, "user_id": 1076116, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/jl97U.jpg?s=128&g=1", "display_name": "ShinT", "link": "https://stackoverflow.com/users/1076116/shint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 586, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1560554416, "creation_date": 1559774317, "last_edit_date": 1560554416, "question_id": 56468932, "link": "https://stackoverflow.com/questions/56468932/what-may-cause-resource-h-to-have-negative-values-defined-for-mfc-controls", "title": "What may cause resource.h to have negative values defined for MFC controls?", "body": "<p>Currently, we have <code>#define IDC_*</code> added to the point that we have reached 32767 (0x7FFF).</p>\n\n<p>Now that we tried to add 32768 (0x8000), all the sudden it became a negative value (<code>#define IDC_TEST_BUTTON -32768</code> which is also 0x8000). From there on, <code>#define</code> statements are incrementing starting from -32768 (such as -32767, -32766, etc). </p>\n\n<p>Our <code>_APS_NEXT_CONTROL_VALUE</code> is pointing to 32769, as it should be.</p>\n\n<p>I thought maybe this is a bug with Microsoft's use of <code>unsigned short</code> and <code>signed short</code>, so I created a new MFC project and intentionally set the <code>_APS_NEXT_CONTROL_VALUE</code> to 32768 and started adding controls in the designer. However, in this case, <code>#define IDC_TEST_BUTTON 32768</code> and <code>_APS_NEXT_CONTROL_VALUE</code> became 32769, as expected.</p>\n\n<p>I searched my entire program's <code>resource.h</code> to see if there are any possible duplicate numbers, since that seems to cause <code>#define</code> statements to become negative. But I could not find any.</p>\n\n<p>According to <a href=\"https://docs.microsoft.com/en-us/cpp/mfc/tn020-id-naming-and-numbering-conventions?view=vs-2019\" rel=\"nofollow noreferrer\">Microsoft's documentation</a>, IDC is allowed up to the value of 0xDFFF, so 0x8000 is well within the allowed ID.</p>\n\n<p>Does anybody have any clue why this is happening?</p>\n"}, {"tags": ["c++", "templates", "visual-c++"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1559774645, "post_id": 56468782, "comment_id": 99529329, "body": "There&#39;s nothing wrong with the shown code. No comment on the mental state of MSVC."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559776161, "post_id": 56468782, "comment_id": 99529614, "body": "Small variations makes the code compile <a href=\"https://godbolt.org/z/LmVYGb\" rel=\"nofollow noreferrer\">Demo</a>."}, {"owner": {"reputation": 241, "user_id": 10359240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5x6cp.png?s=128&g=1", "display_name": "Nazinho", "link": "https://stackoverflow.com/users/10359240/nazinho"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559776238, "post_id": 56468782, "comment_id": 99529625, "body": "@Jarod42 Tried your edit and it worked. But I&#39;m still having a hard time understanding why MSVC screams when omitting the parameter name."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559776361, "post_id": 56468782, "comment_id": 99529646, "body": "Other problematic variation <a href=\"https://godbolt.org/z/fpDsdb\" rel=\"nofollow noreferrer\">Demo</a>. msvc seems to have problem to <i>&quot;collapse&quot;</i> declarations. It even compiles invalid code <a href=\"https://godbolt.org/z/RIYndD\" rel=\"nofollow noreferrer\">Demo</a>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559776632, "post_id": 56468782, "comment_id": 99529691, "body": "Definitively msvc bug."}], "owner": {"reputation": 241, "user_id": 10359240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5x6cp.png?s=128&g=1", "display_name": "Nazinho", "link": "https://stackoverflow.com/users/10359240/nazinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1559919395, "creation_date": 1559773187, "question_id": 56468782, "link": "https://stackoverflow.com/questions/56468782/msvc-chokes-in-forward-class-template-declaration", "title": "MSVC chokes in forward class template declaration", "body": "<p>MSVC fails to compile</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\ntemplate&lt;int N, int = N&gt;\nstruct A;\n\ntemplate&lt;int, int V&gt;\nstruct A{static constexpr int VALUE = V;};\n\nint main() {\n  A&lt;1&gt; a;\n  std::cout &lt;&lt; a.VALUE;\n}\n</code></pre>\n\n<p>with <code>(3): error C2065: 'N': unknown identifier</code>\n<code>(10): error C2975: 'V': invalid template argument 'A', constant expression expected</code> (roughly translated).</p>\n\n<p><strong>clang</strong> compiles it silently.</p>\n\n<p>So, the question: rotten code or demented MSVC?</p>\n\n<p>MSVC version = <strong>VS 2019</strong>.</p>\n"}, {"tags": ["c++", "udp", "recvfrom"], "comments": [{"owner": {"reputation": 4258, "user_id": 1085699, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4Bql4.jpg?s=128&g=1", "display_name": "Nathaniel Johnson", "link": "https://stackoverflow.com/users/1085699/nathaniel-johnson"}, "edited": false, "score": 0, "creation_date": 1559772181, "post_id": 56468592, "comment_id": 99528701, "body": "<a href=\"http://forums.codeguru.com/showthread.php?513945-select-accept-fails-183-ERROR_ALREADY_EXSISTS\" rel=\"nofollow noreferrer\">forums.codeguru.com/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 9431120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30924aabd6417d67647dc82be7c38291?s=128&d=identicon&r=PG&f=1", "display_name": "cHorse", "link": "https://stackoverflow.com/users/9431120/chorse"}, "reply_to_user": {"reputation": 4258, "user_id": 1085699, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4Bql4.jpg?s=128&g=1", "display_name": "Nathaniel Johnson", "link": "https://stackoverflow.com/users/1085699/nathaniel-johnson"}, "edited": false, "score": 0, "creation_date": 1559772586, "post_id": 56468592, "comment_id": 99528813, "body": "@NathanielJohnson That forum post doesn&#39;t seem to be talking about recvfrom. In any case the error message mentioned doesn&#39;t make any sense in context."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1559772935, "post_id": 56468592, "comment_id": 99528918, "body": "There is no possible way that <code>WSAGetLastError()</code> can report 183 (<code>ERROR_ALREADY_EXISTS</code>) for a failed <code>recvfrom()</code> call. That error code has to be coming from something else, which implies there is a mistake in your error handling code. Since <code>WSAGetLastError()</code> just maps to <code>GetLastError()</code>, are you making ANY other function call after the failed <code>recvfrom()</code> and before the <code>WSAGetLastError()</code> that could be resetting the calling thread&#39;s error code? Please <a href=\"https://stackoverflow.com/posts/56468592/edit\">edit</a> your question to show your actual code."}, {"owner": {"reputation": 11, "user_id": 9431120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30924aabd6417d67647dc82be7c38291?s=128&d=identicon&r=PG&f=1", "display_name": "cHorse", "link": "https://stackoverflow.com/users/9431120/chorse"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559773133, "post_id": 56468592, "comment_id": 99528974, "body": "@RemyLebeau As you can see from the above code there isn&#39;t much to be done wrong. I agree that the error code makes no sense which is why I&#39;m here."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559773297, "post_id": 56468592, "comment_id": 99529016, "body": "As I suspected, you ARE calling something else (specifically, <code>logError(&quot;Bytes recieved: &quot;, bytesRecv);</code>) before calling <code>WSAGetLastError()</code>.  So clearly <code>logError()</code> is doing something internally that resets the error code before you have a chance to read it in your <code>if (bytesRecv == SOCKET_ERROR)</code> block. That call to <code>logError()</code> needs to be moved inside of the <code>if (bytesRecv &gt; 0)</code> block.  And FYI, UDP supports 0-length datagrams, so you should be using <code>&gt;= 0</code> instead of <code>&gt; 0</code>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1559773689, "post_id": 56468592, "comment_id": 99529107, "body": "Your <code>logError()</code> function uses a <code>std::ofstream</code> to <b>append to an existing file</b>.  To do that, <code>ofstream</code> will ultimately have to call <code>CreateFile()</code> with the <code>OPEN_ALWAYS</code> flag, for which the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea\" rel=\"nofollow noreferrer\">documentation</a> states: &quot;<i>Opens a file, always. <b>If the specified file exists, the function succeeds and the last-error code is set to ERROR_ALREADY_EXISTS (183).</b> If the specified file does not exist and is a valid path to a writable location, the function creates a file and the last-error code is set to zero.</i>&quot;"}, {"owner": {"reputation": 11, "user_id": 9431120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30924aabd6417d67647dc82be7c38291?s=128&d=identicon&r=PG&f=1", "display_name": "cHorse", "link": "https://stackoverflow.com/users/9431120/chorse"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559773927, "post_id": 56468592, "comment_id": 99529170, "body": "@RemyLebeau I&#39;ve posted the <code>logError()</code>  function. It&#39;s just appending the string and integer to a file. The reason it&#39;s being called there is an attempt to verify that the number of bytes received is the number of bytes expected. Admittedly the function should be called something else. Thanks for the info on the datagram length."}, {"owner": {"reputation": 11, "user_id": 9431120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30924aabd6417d67647dc82be7c38291?s=128&d=identicon&r=PG&f=1", "display_name": "cHorse", "link": "https://stackoverflow.com/users/9431120/chorse"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559774020, "post_id": 56468592, "comment_id": 99529193, "body": "@RemyLebeau how do I give you credit for solving the mystery?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559774244, "post_id": 56468592, "comment_id": 99529240, "body": "I posted an answer for you."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1559774986, "last_edit_date": 1559774986, "creation_date": 1559774235, "answer_id": 56468924, "question_id": 56468592, "link": "https://stackoverflow.com/questions/56468592/getting-undocumented-error-code-from-recvfrom/56468924#56468924", "title": "Getting undocumented error code from recvfrom", "body": "<p>The problem is not with <code>WSAGetLastError()</code> itself.  The real problem is that you are calling <code>logError()</code> before calling <code>WSAGetLastError()</code>, and <code>logError()</code> ends up resetting the last error code to 183.</p>\n\n<p><code>logError()</code> uses a <code>std::ofstream</code> to open a file for appending.  On Windows, that operation will ultimately call <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea\" rel=\"nofollow noreferrer\"><code>CreateFile()</code></a> with the <code>OPEN_ALWAYS</code> flag, for which its documentation states:</p>\n\n<blockquote>\n  <p>Opens a file, always.</p>\n  \n  <p>If the specified file exists, the function succeeds <strong>and the last-error code is set to ERROR_ALREADY_EXISTS (183)</strong>.</p>\n  \n  <p>If the specified file does not exist and is a valid path to a writable location, the function creates a file <strong>and the last-error code is set to zero</strong>.</p>\n  \n  <p>...</p>\n  \n  <p>If the function fails, the return value is INVALID_HANDLE_VALUE. To get extended error information, <strong>call GetLastError</strong>.</p>\n</blockquote>\n\n<p>Internally, <code>WSAGetLastError()</code> simply maps to <code>GetLastError()</code> (a well-known but undocumented implementation detail).  So, no matter whether the <code>CreateFile()</code> succeeds or fails in opening the file, the error code reported by <code>WSAGetLastError()</code> will get reset to the result of the open operation.</p>\n\n<p>Your call to <code>logError()</code> is in the wrong place.  It needs to be moved inside of your <code>if (bytesRecv &gt; 0)</code> block (BTW, UDP supports 0-length datagrams, so you should be using <code>&gt;=</code> instead of <code>&gt;</code>):</p>\n\n<pre><code>while (true)\n{\n    //  get data from the server\n    bytesRecv = recvfrom(m_socket, (char*)&amp;receiveData, sizeof(ReceiveData), 0, (struct sockaddr *) &amp;server_addr, &amp;server_addr_len);\n    // if data was received from the server\n    if (bytesRecv &gt;= 0)\n    {\n        logError(\"Bytes received: \", bytesRecv); // &lt;-- moved here!!!\n        //Data packet processing code\n    }\n    else // if (bytesRecv == SOCKET_ERROR)\n    {\n        logError(\"Error: Reading data: \", WSAGetLastError());\n        break;\n    }\n}\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>while (true)\n{\n    //  get data from the server\n    bytesRecv = recvfrom(m_socket, (char*)&amp;receiveData, sizeof(ReceiveData), 0, (struct sockaddr *) &amp;server_addr, &amp;server_addr_len);\n    // if data was received from the server\n    if (bytesRecv == SOCKET_ERROR)\n    {\n        logError(\"Error: Reading data: \", WSAGetLastError());\n        break;\n    }\n\n    logError(\"Bytes received: \", bytesRecv); // &lt;-- moved here!!!\n    //Data packet processing code\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9431120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30924aabd6417d67647dc82be7c38291?s=128&d=identicon&r=PG&f=1", "display_name": "cHorse", "link": "https://stackoverflow.com/users/9431120/chorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "accepted_answer_id": 56468924, "answer_count": 1, "score": 0, "last_activity_date": 1559774986, "creation_date": 1559771970, "last_edit_date": 1559773572, "question_id": 56468592, "link": "https://stackoverflow.com/questions/56468592/getting-undocumented-error-code-from-recvfrom", "title": "Getting undocumented error code from recvfrom", "body": "<p>When attempting to read UDP packets using <code>recvfrom</code> the function returns -1 indicating an error. I of course then call <code>WSAGetLastError</code> to find out what the problem is. The reported error number is 183. I cant seem to find any reference as to what that number means.</p>\n\n<p><strong>Edit:</strong></p>\n\n<pre><code>while (bytesRecv != SOCKET_ERROR)\n    {\n        //  get data from the server\n        bytesRecv = recvfrom(m_socket, (char*)&amp;receiveData, sizeof(ReceiveData), 0, (struct sockaddr *) &amp;server_addr, &amp;server_addr_len);\n        logError(\"Bytes recieved: \", bytesRecv);\n        // if data was recieved from the server\n        if (bytesRecv &gt; 0)\n        {\n            //Data packet processing code\n        }\n        else\n        {\n            if (bytesRecv == SOCKET_ERROR)\n            {\n                logError(\"Error: Reading data: \", WSAGetLastError());\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<pre><code>void logError(const std::string &amp;text, int errorCode)\n{\n    std::ofstream log_file(\"error_log_file.txt\", std::ios_base::out | std::ios_base::app);\n\n    log_file &lt;&lt; text &lt;&lt; errorCode &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1559771832, "post_id": 56468536, "comment_id": 99528587, "body": "fyi <code>B::x[0] = 0;</code> also works ... investigating."}, {"owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1559772390, "post_id": 56468536, "comment_id": 99528747, "body": "Seeing the edit it looks like B isn&#39;t fully defined at the point where you try to access it (because B is a template), although it should (because we are in a function definition). Is there a language lawyer around that can clarify this?"}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "reply_to_user": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1559772529, "post_id": 56468536, "comment_id": 99528787, "body": "@Timo - But if you move the definition B::Initialise out of line it still fails same error."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1559772665, "post_id": 56468536, "comment_id": 99528832, "body": "That&#39;s because <code>A&lt;S&gt;</code> is nothing until <code>S</code> is known, so you must qualify the name to ensure it&#39;s a member of parent class."}, {"owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "reply_to_user": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 0, "creation_date": 1559772699, "post_id": 56468536, "comment_id": 99528841, "body": "@davidbak that&#39;s what I&#39;m saying. It looks like B isn&#39;t fully defined but it should be inside a function definition, no matter if inside or outside the class definition."}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "reply_to_user": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1559772731, "post_id": 56468536, "comment_id": 99528850, "body": "@Jack, correct because <code>A&lt;S&gt;::x[0] = 0</code> does work!"}, {"owner": {"reputation": 491, "user_id": 7050363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155467616653228/picture?type=large", "display_name": "Ashley Duncan", "link": "https://stackoverflow.com/users/7050363/ashley-duncan"}, "edited": false, "score": 0, "creation_date": 1559772751, "post_id": 56468536, "comment_id": 99528859, "body": "Thanks everyone for your help and the suggestion of the duplicate post.  And I searched so hard for an answer too and didn&#39;t find it.  Must have been googling it all wrong!"}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "reply_to_user": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1559772789, "post_id": 56468536, "comment_id": 99528870, "body": "@Timo - ah, didn&#39;t know that &quot;fully defined&quot; didn&#39;t depend on seeing the &quot;whole&quot; decl in some way (thus that defining the method out-of-line wouldn&#39;t make a difference)"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1559772825, "post_id": 56468536, "comment_id": 99528878, "body": "And in the second example, base class <code>A&lt;5&gt;</code> is not a dependent type, so its members can be seen for lookup."}], "owner": {"reputation": 491, "user_id": 7050363, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155467616653228/picture?type=large", "display_name": "Ashley Duncan", "link": "https://stackoverflow.com/users/7050363/ashley-duncan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1559772562, "answer_count": 0, "score": 3, "last_activity_date": 1559772227, "creation_date": 1559771623, "last_edit_date": 1559772227, "question_id": 56468536, "link": "https://stackoverflow.com/questions/56468536/c-cant-accesss-protected-member-variable-without-this-pointer-in-template-clas", "closed_reason": "Duplicate", "title": "C++ Cant accesss protected member variable without this pointer in template class", "body": "<p>Can someone please enlighten me on why this-> is required to access a parent class member variable in this scenario?</p>\n\n<pre><code>template &lt;int S&gt;\nclass A\n{\nprotected:\n    int x[S];\n};\n\ntemplate &lt;int S&gt;\nclass B : public A&lt;S&gt;\n{\n    void Initialise()\n    {\n        this-&gt;x[0] = 0; // OK\n        x[0] = 0;       // error: 'x' was not declared in this scope\n    }\n};\n</code></pre>\n\n<p>Thanks in advance...</p>\n\n<p>EDIT:</p>\n\n<p>This compiles OK:</p>\n\n<pre><code>template &lt;int S&gt;\nclass A\n{\nprotected:\n    int x[S];\n};\n\nclass B : public A&lt;5&gt;\n{\n    void Initialise()\n    {\n        this-&gt;x[0] = 0; // OK\n        x[0] = 0;       // OK\n    }\n};\n</code></pre>\n"}, {"tags": ["c++", "clang"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559771319, "post_id": 56468430, "comment_id": 99528426, "body": "PSA: <a href=\"https://en.wikipedia.org/wiki/Standard_Template_Library\" rel=\"nofollow noreferrer\">The STL is effectively dead</a>. C++ uses the &quot;Standard Library&quot;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559771398, "post_id": 56468430, "comment_id": 99528449, "body": "This could be a quirk of WSL. Have you tried on a Linux install, like even Ubuntu in a VM or container? <a href=\"https://www.vagrantup.com\" rel=\"nofollow noreferrer\">Vagrant</a> is great for this sort of quick testing."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1559771505, "post_id": 56468430, "comment_id": 99528485, "body": "@paxdiablo Works on my machine with clang (Apple LLVM version 10.0.1 (clang-1001.0.46.4))."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1559771788, "post_id": 56468430, "comment_id": 99528571, "body": "@paxdiablo Can you elaborate? clang has no issues with this code even with <code>-Wall</code>. Are you referring to <code>main(void)</code>?"}, {"owner": {"reputation": 101, "user_id": 4167452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf5d745fdb2ac3a625187257961717?s=128&d=identicon&r=PG&f=1", "display_name": "David Brownell", "link": "https://stackoverflow.com/users/4167452/david-brownell"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559833861, "post_id": 56468430, "comment_id": 99551314, "body": "@tadman - thanks for taking a look - here are some answers to your questions: - This isn&#39;t a quirk of WSL - I see the same behavior with Linux running in a VM and within docker. - Things with this test work as expected when using clang as a front end for GCC and MSVC. I only see this problem when trying to use clang without the backing toolchains."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4167452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf5d745fdb2ac3a625187257961717?s=128&d=identicon&r=PG&f=1", "display_name": "David Brownell", "link": "https://stackoverflow.com/users/4167452/david-brownell"}, "edited": false, "score": 1, "creation_date": 1559833575, "post_id": 56468646, "comment_id": 99551164, "body": "Unfortunately, these suggestions don&#39;t address the specific problems mentioned in the original question (although, my hunch is that they will address the very next set of problems that I run into after fixing the original ones).   I am still stuck with preprocessor problems associated withi missing include files (although the files I see errors with are different on Linux and Windows)."}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 101, "user_id": 4167452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf5d745fdb2ac3a625187257961717?s=128&d=identicon&r=PG&f=1", "display_name": "David Brownell", "link": "https://stackoverflow.com/users/4167452/david-brownell"}, "edited": false, "score": 0, "creation_date": 1559840127, "post_id": 56468646, "comment_id": 99554340, "body": "If you follow the instructions there shouldn&#39;t be any problems with headers or linkage. It is possible that clang can&#39;t find the location of libc++ in which case you can explicitly specify it as shown in the  linked article"}], "tags": [], "owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 4, "last_activity_date": 1559773431, "last_edit_date": 1559773431, "creation_date": 1559772263, "answer_id": 56468646, "question_id": 56468430, "link": "https://stackoverflow.com/questions/56468430/clang-without-gcc-or-msvc/56468646#56468646", "title": "Clang without GCC or MSVC", "body": "<h1>For linux</h1>\n\n<p>On linux clag will default to using gnu's implementation of the standard library which is <code>libstdc++</code>. To use llvm's implementation - <code>libc++</code> - you first need to install it. On ubuntu, for instance: <code>sudo apt install libc++-9-dev libc++abi-9-dev</code>. You might need to add the apple repos. Follow <a href=\"https://apt.llvm.org/\" rel=\"nofollow noreferrer\">these instructions</a> for more systems and latest versions. Then you need to explicit specify it when compiling: <code>-stdlib=libc++</code>. Please see <a href=\"https://libcxx.llvm.org/docs/UsingLibcxx.html\" rel=\"nofollow noreferrer\">https://libcxx.llvm.org/docs/UsingLibcxx.html</a></p>\n\n<p>For linking install lld (<code>sudo apt install lld-9</code>) then specify it when compiling with <code>-fuse-ld=lld</code></p>\n"}], "owner": {"reputation": 101, "user_id": 4167452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf5d745fdb2ac3a625187257961717?s=128&d=identicon&r=PG&f=1", "display_name": "David Brownell", "link": "https://stackoverflow.com/users/4167452/david-brownell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3155, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1559773431, "creation_date": 1559771063, "last_edit_date": 1559772531, "question_id": 56468430, "link": "https://stackoverflow.com/questions/56468430/clang-without-gcc-or-msvc", "title": "Clang without GCC or MSVC", "body": "<p>I'd like to use clang without GCC on Linux and without MSVC on Windows. My understanding is that this wasn't possible in the past due to:</p>\n\n<ol>\n<li>A LLVM linker wasn't available.</li>\n<li>A compatible STL wasn't available.</li>\n</ol>\n\n<p>However, my impression what that this should be possible with <a href=\"http://releases.llvm.org/download.html\" rel=\"noreferrer\">v8.0.0</a> as there is now a <a href=\"https://lld.llvm.org/\" rel=\"noreferrer\">viable linker</a> and a compatible <a href=\"https://libcxx.llvm.org/\" rel=\"noreferrer\">STL library</a>. </p>\n\n<p>Unfortunately, I get different errors on Linux and Windows when exercising this scenario (see more info below).</p>\n\n<p>Can you help me out with this? Unfortunately, I've found it a bit challenging to find a definitive answer through various searches.</p>\n\n<p>Thanks for the help!</p>\n\n<p><strong>Test Code: test.cpp</strong></p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nint main(void) {\n    std::vector&lt;int&gt; const v{ 1, 2, 3 };\n\n    std::cout &lt;&lt; \"Hello world\\n\";\n    std::cout &lt;&lt; v[0] &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>\n\n<p><strong>Linux output</strong></p>\n\n<p>The following output is from Windows Subsystem for Linux, but the behavior is the same on a proper Linux install.</p>\n\n<pre><code>clang -v /mnt/c/Temp/test.cpp -I/mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/include/c++/v1\nclang version 8.0.0 (tags/RELEASE_800/final)\nTarget: x86_64-unknown-linux-gnu\nThread model: posix\nInstalledDir: /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/bin\nFound candidate GCC installation: /usr/lib/gcc/x86_64-linux-gnu/8\nFound candidate GCC installation: /usr/lib/gcc/x86_64-linux-gnu/8.0.1\n \"/mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/bin/clang-8\" -cc1 -triple x86_64-unknown-linux-gnu -emit-obj -mrelax-all -disable-free -disable-llvm-verifier -discard-value-names -main-file-name test.cpp -mrelocation-model static -mthread-model posix -mdisable-fp-elim -fmath-errno -masm-verbose -mconstructor-aliases -munwind-tables -fuse-init-array -target-cpu x86-64 -dwarf-column-info -debugger-tuning=gdb -v -resource-dir /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/lib/clang/8.0.0 -I /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/include/c++/v1 -internal-isystem /usr/local/include -internal-isystem /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/lib/clang/8.0.0/include -internal-externc-isystem /include -internal-externc-isystem /usr/include -fdeprecated-macro -fdebug-compilation-dir /mnt/c/Code/v3/Common/cpp/Clang/8 -ferror-limit 19 -fmessage-length 200 -fobjc-runtime=gcc -fcxx-exceptions -fexceptions -fdiagnostics-show-option -fcolor-diagnostics -o /tmp/test-284194.o -x c++ /mnt/c/Temp/test.cpp -faddrsig\nclang -cc1 version 8.0.0 based upon LLVM 8.0.0 default target x86_64-unknown-linux-gnu\nignoring nonexistent directory \"/include\"\n#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/include/c++/v1\n /usr/local/include\n /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/lib/clang/8.0.0/include\n /usr/include\nEnd of search list.\nIn file included from /mnt/c/Temp/test.cpp:1:\nIn file included from /mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/include/c++/v1/vector:273:\n/mnt/c/Code/v3/Common/cpp/Clang/8/Tools/Clang/v8.0.0/Ubuntu/wsl/include/c++/v1/__config:206:12: fatal error: 'features.h' file not found\n#  include &lt;features.h&gt;\n           ^~~~~~~~~~~~\n1 error generated.\n</code></pre>\n\n<p><strong>Windows Output</strong></p>\n\n<pre><code>clang -v c:\\temp\\test.cpp\nclang version 8.0.0 (tags/RELEASE_800/final)\nTarget: x86_64-pc-windows-msvc\nThread model: posix\nInstalledDir: C:\\Code\\v3\\Common\\cpp\\Clang\\8\\Tools\\Clang\\v8.0.0\\Windows\\DefaultEnv\\bin\nclang: warning: unable to find a Visual Studio installation; try running Clang from a developer command prompt [-Wmsvc-not-found]\n \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Clang\\\\8\\\\Tools\\\\Clang\\\\v8.0.0\\\\Windows\\\\DefaultEnv\\\\bin\\\\clang.exe\" -cc1 -triple x86_64-pc-windows-msvc19.11.0 -emit-obj -mrelax-all -mincremental-linker-compatible -disable-free -disable-llvm-verifier -discard-value-names -main-file-name test.cpp -mrelocation-model pic -pic-level 2 -mthread-model posix -fmath-errno -masm-verbose -mconstructor-aliases -munwind-tables -target-cpu x86-64 -dwarf-column-info -momit-leaf-frame-pointer -v -resource-dir \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Clang\\\\8\\\\Tools\\\\Clang\\\\v8.0.0\\\\Windows\\\\DefaultEnv\\\\lib\\\\clang\\\\8.0.0\" -internal-isystem \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Clang\\\\8\\\\Tools\\\\Clang\\\\v8.0.0\\\\Windows\\\\DefaultEnv\\\\lib\\\\clang\\\\8.0.0\\\\include\" -internal-isystem \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Clang\\\\8\\\\Tools\\\\Clang\\\\v8.0.0\\\\Windows\\\\DefaultEnv\\\\include\\\\c++\\\\v1\" -internal-isystem \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Common\\\\Libraries\\\\C++\\\\Catch2\\\\v2.7.0\" -internal-isystem \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Common\\\\Libraries\\\\C++\\\\GSL\\\\v2.0.0\\\\include\" -fdeprecated-macro -fdebug-compilation-dir \"C:\\\\Code\\\\v3\\\\Common\\\\cpp\\\\Clang\\\\8\" -ferror-limit 19 -fmessage-length 200 -fno-use-cxa-atexit -fms-extensions -fms-compatibility -fms-compatibility-version=19.11 -std=c++14 -fdelayed-template-parsing -fobjc-runtime=gcc -fcxx-exceptions -fexceptions -fdiagnostics-show-option -fcolor-diagnostics -o \"C:\\\\Users\\\\brownell\\\\AppData\\\\Local\\\\Temp\\\\test-9329b0.o\" -x c++ \"c:\\\\temp\\\\test.cpp\" -faddrsig\nclang -cc1 version 8.0.0 based upon LLVM 8.0.0 default target x86_64-pc-windows-msvc\n#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n C:\\Code\\v3\\Common\\cpp\\Clang\\8\\Tools\\Clang\\v8.0.0\\Windows\\DefaultEnv\\lib\\clang\\8.0.0\\include\n C:\\Code\\v3\\Common\\cpp\\Clang\\8\\Tools\\Clang\\v8.0.0\\Windows\\DefaultEnv\\include\\c++\\v1\n C:\\Code\\v3\\Common\\cpp\\Common\\Libraries\\C++\\Catch2\\v2.7.0\n C:\\Code\\v3\\Common\\cpp\\Common\\Libraries\\C++\\GSL\\v2.0.0\\include\nEnd of search list.\nIn file included from c:\\temp\\test.cpp:1:\nIn file included from C:\\Code\\v3\\Common\\cpp\\Clang\\8\\Tools\\Clang\\v8.0.0\\Windows\\DefaultEnv\\include\\c++\\v1\\vector:274:\nIn file included from C:\\Code\\v3\\Common\\cpp\\Clang\\8\\Tools\\Clang\\v8.0.0\\Windows\\DefaultEnv\\include\\c++\\v1\\iosfwd:96:\nC:\\Code\\v3\\Common\\cpp\\Clang\\8\\Tools\\Clang\\v8.0.0\\Windows\\DefaultEnv\\include\\c++\\v1\\wchar.h:119:15: fatal error: 'wchar.h' file not found\n#include_next &lt;wchar.h&gt;\n              ^~~~~~~~~\n1 error generated.\n</code></pre>\n"}, {"tags": ["c++", "overloading", "sfinae", "typetraits", "enable-if"], "comments": [{"owner": {"reputation": 40655, "user_id": 1023390, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/2g9CZ.jpg?s=128&g=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/1023390/walter"}, "edited": false, "score": 1, "creation_date": 1559769843, "post_id": 56468171, "comment_id": 99527884, "body": "why? why? do you need this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1559770004, "post_id": 56468171, "comment_id": 99527941, "body": "Why do you need to differentiate between the two? I don&#39;t even think it&#39;s possible, but again, what is important about string literals vs <code>char *</code>s?"}, {"owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "edited": false, "score": 0, "creation_date": 1559770298, "post_id": 56468171, "comment_id": 99528043, "body": "See <a href=\"https://stackoverflow.com/questions/56446068/in-c-why-overload-a-function-on-a-const-char-array-and-a-private-struct-wra\">this</a> question I asked yesterday to understand why I need this. I would like to improve an open source library."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1559770817, "post_id": 56468171, "comment_id": 99528236, "body": "<i>I have not been able to write a function that is able to differentiate between a char array and a string literal</i> A string literal <b>is</b> a char array.  They have the exact same type so you can&#39;t differentiate them.  It is even an lvalue so you can&#39;t differentiate based on lvalue/rvalueness."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1559771021, "post_id": 56468171, "comment_id": 99528322, "body": "You may be able to achieve your actual goal using <code>consteval</code> from C++20, but I don&#39;t think there&#39;s any way using only C++17."}, {"owner": {"reputation": 4290, "user_id": 311314, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9098882126e0907a9df39856ef1b5bfa?s=128&d=identicon&r=PG", "display_name": "Nathan Ernst", "link": "https://stackoverflow.com/users/311314/nathan-ernst"}, "edited": false, "score": 0, "creation_date": 1559788160, "post_id": 56468171, "comment_id": 99531553, "body": "Compilers prefer non-template overloads to a perhaps better fitting templated overload. Dont know the reason for this, but it&#39;s been the behavior since before C++11."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "edited": false, "score": 0, "creation_date": 1559817999, "post_id": 56473444, "comment_id": 99542184, "body": "Thanks for your answer @L. F.! I&#39;m disappointed that this is not possible because I feel like I found a situation in which it would be very beneficial if it were."}], "tags": [], "owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "is_accepted": true, "score": 2, "last_activity_date": 1559808844, "creation_date": 1559808844, "answer_id": 56473444, "question_id": 56468171, "link": "https://stackoverflow.com/questions/56468171/overload-resolution-for-char-char-array-and-string-literals-using-constexpr/56473444#56473444", "title": "Overload resolution for char*, char array, and string literals using constexpr, SFINAE and/or type_traits", "body": "<p>Per <a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.prim.id.unqual\" rel=\"nofollow noreferrer\">[expr.prim.id.unqual]</a>:</p>\n\n<blockquote>\n  <p>[...] The type of the expression is the type of the identifier. The\n  result is the entity denoted by the <em>identifier</em>. The expression is an\n  lvalue if the entity is a function, variable, or data member and a\n  prvalue otherwise; it is a bit-field if the identifier designates a\n  bit-field ([dcl.struct.bind]).</p>\n</blockquote>\n\n<p>Therefore, given a declaration</p>\n\n<pre><code>const char arr[] = \"foo\";\n</code></pre>\n\n<p>The expression <code>arr</code> is an lvalue of type <code>const char[4]</code>.</p>\n\n<hr>\n\n<p>Per <a href=\"https://timsong-cpp.github.io/cppwp/n4659/lex.string#8\" rel=\"nofollow noreferrer\">[lex.string]/8</a>:</p>\n\n<blockquote>\n  <p>Ordinary string literals and UTF-8 string literals are also referred\n  to as narrow string literals. A narrow string literal has type \u201carray\n  of <em>n</em> <code>const char</code>\u201d, where <em>n</em> is the size of the string as defined\n  below, and has static storage duration.</p>\n</blockquote>\n\n<p>And per <a href=\"https://timsong-cpp.github.io/cppwp/n4659/expr.prim.literal\" rel=\"nofollow noreferrer\">[expr.prim.literal]</a>:</p>\n\n<blockquote>\n  <p>A <em>litera</em> is a primary expression. Its type depends on its form. A\n  string literal is an lvalue; all other literals are prvalues.</p>\n</blockquote>\n\n<p>Therefore, the expression <code>\"foo\"</code> is an lvalue of type <code>const char[4]</code>.</p>\n\n<hr>\n\n<p>Conclusion: a function is unable to differentiate between a (const) char array and a string literal.</p>\n"}], "owner": {"reputation": 367, "user_id": 3266738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4949adf69e0d8df5cb474352648313bf?s=128&d=identicon&r=PG&f=1", "display_name": "user3266738", "link": "https://stackoverflow.com/users/3266738/user3266738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 56473444, "answer_count": 1, "score": 3, "last_activity_date": 1559808844, "creation_date": 1559769611, "last_edit_date": 1559808397, "question_id": 56468171, "link": "https://stackoverflow.com/questions/56468171/overload-resolution-for-char-char-array-and-string-literals-using-constexpr", "title": "Overload resolution for char*, char array, and string literals using constexpr, SFINAE and/or type_traits", "body": "<p>I have run into an interesting challenge that I have been trying to solve for hours, but after much research and many failed attempts, I find myself asking this question.</p>\n\n<p>I would like to write 3 overloaded functions that each take one of the following types: <code>const char*</code>, <code>const char(&amp;)[N]</code> and <code>string literal (e.g. \"BOO\")</code>. I understand that a string literal is simply a char array, but please bear with me while I explain my approach.</p>\n\n<p>The two functions below are able to differentiate between the first two types (<code>const char*</code> and <code>const char(&amp;)[N]</code>) thanks to the wrapper class <code>CharPtrWrapper</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n\nclass CharPtrWrapper\n{\npublic:\n    CharPtrWrapper(const char* charPtr)\n        : m_charPtr(charPtr)\n    {\n\n    }\n\n    const char * m_charPtr;\n};\n\nvoid processStr(CharPtrWrapper charPtrWrapper)\n{\n    std::cout &lt;&lt; \"From function that takes a CharPtrWrapper = \" &lt;&lt; charPtrWrapper.m_charPtr &lt;&lt; '\\n';\n}\n\ntemplate&lt;std::size_t N&gt;\nvoid processStr(const char (&amp;charArr)[N])\n{\n    std::cout &lt;&lt; \"From function that takes a \\\"const char(&amp;)[N]\\\" = \" &lt;&lt; charArr &lt;&lt; '\\n';\n}\n\nint main()\n{\n    const char* charPtr = \"ABC\";\n    processStr(charPtr);\n\n    const char charArr[] = {'X', 'Y', 'Z', '\\0'};\n    processStr(charArr);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>From function that takes a CharPtrWrapper = ABC\nFrom function that takes a \"const char(&amp;)[N]\" = XYZ\n</code></pre>\n\n<p>Now, if I call <code>processStr</code> with a string literal (e.g. <code>processStr(\"BOO\")</code>), the version that takes a <code>const char(&amp;)[N]</code> gets called, which makes sense, since a string literal is simply a char array.</p>\n\n<p>Here is where I reach the crux of the problem. I have not been able to write a function that is able to differentiate between a char array and a string literal. One thing I thought might work was to write a version that takes an rvalue reference:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;std::size_t N&gt;\nvoid processStr(const char (&amp;&amp;charArr)[N])\n{\n    std::cout &lt;&lt; \"From function that takes a \\\"const char(&amp;&amp;)[N]\\\" = \" &lt;&lt; charArr &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>But it turns out that string literals are lvalues. I have also played with different versions that use <code>std::enable_if</code> and <code>std::is_array</code>, but I still don't get the result I'm looking for.</p>\n\n<p>So I guess my question is the following: is it possible to differentiate between char arrays and string literals in modern C++?</p>\n"}, {"tags": ["c++", "opencv", "stdbind"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1559769801, "post_id": 56467988, "comment_id": 99527865, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12662891/how-can-i-pass-a-member-function-where-a-free-function-is-expected\">How can I pass a member function where a free function is expected?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 0, "last_activity_date": 1559769741, "creation_date": 1559769741, "answer_id": 56468190, "question_id": 56467988, "link": "https://stackoverflow.com/questions/56467988/stdbind-troubles-with-cvfacefn-facedetector/56468190#56468190", "title": "std::bind troubles with cv::face::FN_FaceDetector", "body": "<p>A bound function has state, and as such cannot be converted to a function pointer.  You will need a free function or static member function.</p>\n\n<p>Luckily, that third <code>void* userData</code> parameter exists.  You can use that to pass a pointer to your object:</p>\n\n<pre><code>bool LBPDetector::load_face_cascade(const std::string &amp;path) {\n    //...    \n    m_face_cascade = new cv::CascadeClassifier(path);\n    m_impl-&gt;setFaceDetector(LBPDetector::face_cascade_static, this);\n    return true;\n}\n\nbool LBPDetector::face_cascade_static(cv::InputArray img, cv::OutputArray ROIs, void *data)\n{\n    return reinterpret_cast&lt;LBPDetector*&gt;(data)-&gt;face_cascade_impl(img, ROIs);\n}\n\nbool LBPDetector::face_cascade_impl(cv::InputArray img, cv::OutputArray ROIs)\n{\n    //...\n    cv::CascadeClassifier *cascade = m_face_cascade;\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 11423991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5971c8edc230ed47093d9520321676d?s=128&d=identicon&r=PG&f=1", "display_name": "acr", "link": "https://stackoverflow.com/users/11423991/acr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56468190, "answer_count": 1, "score": 1, "last_activity_date": 1559769741, "creation_date": 1559768632, "question_id": 56467988, "link": "https://stackoverflow.com/questions/56467988/stdbind-troubles-with-cvfacefn-facedetector", "title": "std::bind troubles with cv::face::FN_FaceDetector", "body": "<p>I'm writing a class that basically wraps the cv::face::FacemarkLBF OpenCV class for face detection and facial landmark detection.\nAs part of this effort, I wrote my own face detector function, which is a class member since it uses parameters that may change at any time. Doing this, I fail to pass this member function to OpenCV successfully.</p>\n\n<p>When the method (face_cascade_impl) is static (with static parameters to cv::CascadeClassifier::detectMultiScale), all is fine (compilation and runtime). However, I need to bind the instance member function now that I want to use class member parameters.</p>\n\n<p>Here is my face_cascade_impl function that I need to pass to the OpenCV FacemarkLBF instance:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool LBPDetector::face_cascade_impl(cv::InputArray img, cv::OutputArray ROIs, void *data) {\n    cv::Mat gray;\n    cv::UMat gray_umat;\n    std::vector&lt;cv::Rect&gt; faces;\n    cv::CascadeClassifier *cascade = reinterpret_cast&lt;cv::CascadeClassifier *&gt;(data);\n\n    // respect input mat type: separate codepaths for mat/umat\n    if (img.isUMat()) {\n        // convert to 8-bit single channel if necessary\n        if (img.channels() &gt; 1) {\n            cv::cvtColor(img, gray_umat, cv::COLOR_BGR2GRAY);\n            cv::equalizeHist(gray_umat, gray_umat);\n        } else {\n            cv::equalizeHist(img, gray_umat);\n        }\n    } else {\n        if (img.channels() &gt; 1) {\n            cv::cvtColor(img, gray, cv::COLOR_BGR2GRAY);\n            cv::equalizeHist(gray, gray);\n        } else {\n            cv::equalizeHist(img, gray);\n        }\n    }\n\n    // detect faces\n    if (img.isUMat()) {\n        cascade-&gt;detectMultiScale(gray_umat, faces, m_params.cascade_scale_factor,\n                                  m_params.cascade_min_neighbours, m_params.cascade_flags,\n                                  m_params.cascade_min_size);\n    } else {\n        cascade-&gt;detectMultiScale(gray, faces, m_params.cascade_scale_factor,\n                                  m_params.cascade_min_neighbours, m_params.cascade_flags,\n                                  m_params.cascade_min_size);\n    }\n\n    cv::Mat(faces).copyTo(ROIs);\n    return true;\n};\n</code></pre>\n\n<p>Said cv::face::FacemarkLBF instance is created in my LBPDetector constructor:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>LBPDetector::LBPDetector() {\n    m_impl = cv::face::FacemarkLBF::create(m_facemark_params);\n    m_face_cascade = nullptr;\n    m_facemark_model_loaded = false;\n\n    m_params.cascade_scale_factor = 1.1;\n    m_params.cascade_min_neighbours = 3;\n    m_params.cascade_flags = cv::CASCADE_SCALE_IMAGE;\n    m_params.cascade_min_size = cv::Size(30, 30);\n}\n</code></pre>\n\n<p>Now there is another member function that actually initializes that instance and loads a face cascade model:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool LBPDetector::load_face_cascade(const std::string &amp;path) {\n    m_facemark_model_loaded = false;\n\n    if (path.empty()) {\n        return false;\n    }\n\n    m_face_cascade = new cv::CascadeClassifier(path);\n    m_impl-&gt;setFaceDetector(std::bind(&amp;LBPDetector::face_cascade_impl, this,\n                                      std::placeholders::_1, std::placeholders::_2,\n                                      std::placeholders::_3), m_face_cascade);\n    return true;\n}\n</code></pre>\n\n<p>However, the above code fails to compile.</p>\n\n<p>Here's the GCC error message:</p>\n\n<pre><code>lbp_detector.cpp:77:29: error: no viable conversion from 'typename _Bind_helper&lt;__is_socketlike&lt;bool (LBPDetector::*)(const _InputArray &amp;, const _OutputArray &amp;, void *)&gt;::value, bool (LBPDetector::*)(const _InputArray &amp;, const _OutputArray &amp;, void *), LBPDetector *, const _Placeholder&lt;1&gt; &amp;, const _Placeholder&lt;2&gt; &amp;, const _Placeholder&lt;3&gt; &amp;&gt;::type' (aka '_Bind&lt;bool (sph::face::LBPDetector::*(sph::face::LBPDetector *, std::_Placeholder&lt;1&gt;, std::_Placeholder&lt;2&gt;, std::_Placeholder&lt;3&gt;))(const cv::_InputArray &amp;, const cv::_OutputArray &amp;, void *)&gt;') to 'cv::face::FN_FaceDetector' (aka 'bool (*)(const cv::_InputArray &amp;, const cv::_OutputArray &amp;, void *)')\nfacemark_train.hpp:351:50: note: passing argument to parameter 'detector' here\n</code></pre>\n\n<p>My system is Fedora 30 with GCC 9:</p>\n\n<pre><code>COLLECT_GCC=/usr/bin/gcc\nCOLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/9/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nZiel: x86_64-redhat-linux\nKonfiguriert mit: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,objc,obj-c++,ada,go,d,lto --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --enable-plugin --enable-initfini-array --with-isl --enable-offload-targets=nvptx-none --without-cuda-driver --enable-gnu-indirect-function --enable-cet --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux\nThread-Modell: posix\ngcc-Version 9.1.1 20190503 (Red Hat 9.1.1-1) (GCC) \n</code></pre>\n"}, {"tags": ["c++", "qt", "user-interface"], "answers": [{"comments": [{"owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "edited": false, "score": 0, "creation_date": 1559812280, "post_id": 56468482, "comment_id": 99539135, "body": "<code>setText()</code> does not disable the validator. However, the string passed to <code>setText()</code> is not checked against the validator. This means that you can end up in a situation where the text of the <code>QLineEdit</code> is invalid for the validator, in this situation the validator will be effectively temporarily disabled until the text is not invalid anymore."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "edited": false, "score": 0, "creation_date": 1559833377, "post_id": 56468482, "comment_id": 99551066, "body": "@BenjaminT That doesn&#39;t make sense to me. The text is always invalid for the validator, unless <code>is_active_ == false</code>. In fact, I can create a validator that always returns <code>QValidator::Invalid</code>. <code>setText()</code> will make it stop working."}, {"owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "edited": false, "score": 0, "creation_date": 1559841512, "post_id": 56468482, "comment_id": 99554905, "body": "That&#39;s because you have to consider both the <code>QValidator</code> and the <code>QLineEdit</code>. Initially the <code>QLineEdit</code> considers its current text valid (regardless of the validator), when the user tries to input text the validator is checked and returns <code>Invalid</code>. The QLineEdit detects that the text will go from valid to invalid and prevent the change. However, once <code>setText()</code> has been called, even if the QLineEdit accepts the new text, it will detects it is invalid. Then when the user input texts, the QLineEdit detects the text will go from invalid to invalid and will accept the change."}], "tags": [], "owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1559771723, "last_edit_date": 1559771723, "creation_date": 1559771378, "answer_id": 56468482, "question_id": 56467940, "link": "https://stackoverflow.com/questions/56467940/how-to-display-a-blinking-cursor-in-qlineedit-during-read-only/56468482#56468482", "title": "How to display a blinking cursor in QLineEdit during read-only", "body": "<p>Romha Korev's answer will appear to work, but it won't catch everything. It can still be possible to paste or drag&amp;drop text into the line edit, or as a result of a locale dependent input-method keyboard event. I don't know all the various ways text can end up being entered into the line edit that way. You'd be hunting for holes to plug.</p>\n\n<p>So I propose to abuse a <a href=\"https://doc.qt.io/qt-5/qvalidator.html\" rel=\"nofollow noreferrer\">QValidator</a> for this. Do not set your line edit to read-only mode. Create your own validator that blocks all input unless you specifically disable it:</p>\n\n<pre><code>class InputBlockerValidator final: public QValidator\n{\n    Q_OBJECT\n\npublic:\n    void enable()\n    { is_active_ = true; }\n\n    void disable()\n    { is_active_ = false; }\n\n    QValidator::State validate(QString&amp; /*input*/, int&amp; /*pos*/) const override\n    {\n        if (is_active_) {\n            return QValidator::Invalid;\n        }\n        return QValidator::Acceptable;\n    }\n\nprivate:\n    bool is_active_ = true;\n};\n</code></pre>\n\n<p>Now set an instance of this as the validator of your line edit:</p>\n\n<pre><code>// ...\nprivate:\n    QLineEdit lineedit_;\n    InputBlockerValidator validator_;\n// ...\n\nlineedit_.setValidator(&amp;validator_);\n</code></pre>\n\n<p>Then, whenever you insert text into the line edit, disable and re-enable the validator:</p>\n\n<pre><code>validator_.disable();\nlineedit_.insert(text_to_be_inserted);\nvalidator_.enable();\n</code></pre>\n\n<p>Do not ever call <code>setText()</code> on the line edit. For some reason, this permanently prevents the validator from blocking input. I don't know if this is intended or a Qt bug. Only use <code>insert()</code>. To simulate <code>setText()</code>, use <code>clear()</code> followed by <code>insert()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "is_accepted": false, "score": 1, "last_activity_date": 1559771529, "creation_date": 1559771529, "answer_id": 56468513, "question_id": 56467940, "link": "https://stackoverflow.com/questions/56467940/how-to-display-a-blinking-cursor-in-qlineedit-during-read-only/56468513#56468513", "title": "How to display a blinking cursor in QLineEdit during read-only", "body": "<p>Create a class whiwh inherits from <code>QLineEdit</code> and ignore the key events (events triggered when the user press a key). It will make your line edit read only but without the look-and-feel:</p>\n\n<pre><code>class LineEdit: public QLineEdit\n{\n    Q_OBJECT\npublic:\n    LineEdit(QWidget* parent=nullptr): QLineEdit(parent)\n    {\n    }\n    virtual void keyPressEvent(QKeyEvent* event)\n    {\n        event-&gt;ignore();\n    }\n\npublic slots:\n    void add(QString const&amp; textToAdd)\n    {\n        setText(text() + textToAdd);\n    }\n};\n</code></pre>\n\n<p>An usage example (the timer simulates the virtual keyboard):</p>\n\n<pre><code>LineEdit* line = new LineEdit;\nline-&gt;show();\n\nQTimer timer;\ntimer.setInterval(2000);\nQObject::connect(&amp;timer, &amp;QTimer::timeout, [=]() { line-&gt;add(\"a\"); });\ntimer.start();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "edited": false, "score": 0, "creation_date": 1563810452, "post_id": 56475636, "comment_id": 100814575, "body": "After further consideration, the project requirements required me too set an upper limit for the value of the text box. I went with the QIntValidator. After some additional consideration. I kept the keyboard function in tact becuase this will limit the input values to be on digits and can be used as a redundancy as a secondary input in the event the primary interface device fails"}], "tags": [], "owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1559816663, "creation_date": 1559816663, "answer_id": 56475636, "question_id": 56467940, "link": "https://stackoverflow.com/questions/56467940/how-to-display-a-blinking-cursor-in-qlineedit-during-read-only/56475636#56475636", "title": "How to display a blinking cursor in QLineEdit during read-only", "body": "<p>Other answers have given you technical solutions to your question. However, I think that you are going in a wrong direction. You want a QLineEdit that is read only, but with a cursor and still accepts input from a virtual keyboard... yeah, so it is not really read only... It is not smelling good.\nAnd in general, arbitrarily and actively disabling standard functions is not a good idea. Especially, if it means hacking your way around standard widget behaviors an semantics to do it.</p>\n\n<p>Let's think from the start. What is the issue of accepting input from a keyboard?\nFrom your question I would dare to guess that you want to make sure that the QLineEdit only accepts digits, and forbid the user to input other characters.</p>\n\n<p>If I am right what you want is a <code>QValidator</code>, either a <code>QIntvalidator</code> or a <code>QRegExpValidator</code>. Then you can let the users use a keyboard, but they will only be able to input digits, like they would with your virtual keyboard.</p>\n"}], "owner": {"reputation": 608, "user_id": 3904858, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/34b74f56d8756f1278d689152c004200?s=128&d=identicon&r=PG&f=1", "display_name": "philm", "link": "https://stackoverflow.com/users/3904858/philm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 1, "accepted_answer_id": 56475636, "answer_count": 3, "score": 3, "last_activity_date": 1559816663, "creation_date": 1559768441, "question_id": 56467940, "link": "https://stackoverflow.com/questions/56467940/how-to-display-a-blinking-cursor-in-qlineedit-during-read-only", "title": "How to display a blinking cursor in QLineEdit during read-only", "body": "<p>title pretty much says it all. I have a read-only text box on a form where users can edit the contents of this text box through buttons on the form. The form is basically a keypad. As users click the buttons, a digit will be added to the value in the text box.</p>\n\n<p>Technically, the final application will be running on a machine with no keyboard but a touchscreen. Users interact with the application using the touchscreen and they should not be installing keyboards on the machine but in the event they do, I am making the text box read-only.</p>\n\n<p>Now, how can I have the text box's cursor still blink even though it is read only?</p>\n\n<p>I am wondering if I need to do something similar to this user's solution:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25180628/hide-qlineedit-blinking-cursor\">Hide QLineEdit blinking cursor</a></p>\n\n<p>I have also tried using the setFocus method and I am looking into style sheets. However, nothing has panned out.</p>\n"}, {"tags": ["c++", "qt", "sockets", "server", "client"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 2, "creation_date": 1559768462, "post_id": 56467905, "comment_id": 99527367, "body": "Where do you assign <code>tcpServer</code> with an actual object?"}, {"owner": {"reputation": 45, "user_id": 10238182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8c45f80f54013ac7b71f74eec8bc8f?s=128&d=identicon&r=PG&f=1", "display_name": "spoon252", "link": "https://stackoverflow.com/users/10238182/spoon252"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1559769683, "post_id": 56467905, "comment_id": 99527821, "body": "Oh yes, i have edited the server cpp code. Now i dont have an exception, but still slot aint firing. I also edited the output"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1559807549, "post_id": 56467905, "comment_id": 99536803, "body": "I don&#39;t see your problem, can you clarify a bit more?"}, {"owner": {"reputation": 45, "user_id": 10238182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8c45f80f54013ac7b71f74eec8bc8f?s=128&d=identicon&r=PG&f=1", "display_name": "spoon252", "link": "https://stackoverflow.com/users/10238182/spoon252"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1559809347, "post_id": 56467905, "comment_id": 99537667, "body": "In the first post I forgot to put object <code>tcpServer = new QTcpServer(this);</code> After putting that, it runs without null exception but still doesn&#39;t fire OnNewConnection()"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 1, "creation_date": 1559814477, "post_id": 56467905, "comment_id": 99540307, "body": "Your class <code>myserver</code> both inherits from <code>QTcpServer</code> <i>and</i> has a <code>QTcpServer *</code> member?  That doesn&#39;t look right."}, {"owner": {"reputation": 45, "user_id": 10238182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8c45f80f54013ac7b71f74eec8bc8f?s=128&d=identicon&r=PG&f=1", "display_name": "spoon252", "link": "https://stackoverflow.com/users/10238182/spoon252"}, "edited": false, "score": 0, "creation_date": 1559821927, "post_id": 56467905, "comment_id": 99544267, "body": "I see. How do you think that should be done?"}, {"owner": {"reputation": 45, "user_id": 10238182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8c45f80f54013ac7b71f74eec8bc8f?s=128&d=identicon&r=PG&f=1", "display_name": "spoon252", "link": "https://stackoverflow.com/users/10238182/spoon252"}, "edited": false, "score": 1, "creation_date": 1559823146, "post_id": 56467905, "comment_id": 99544924, "body": "Edit: It works as expected when I added this line <code>connect(this,SIGNAL(newConnection()),this,SLOT(onNewConnecti&zwnj;&#8203;on()));</code> and I didn&#39;t need any QTcpServer  members since my &quot;server&quot; class already inherited from it. Thanks everyone"}], "owner": {"reputation": 45, "user_id": 10238182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a8c45f80f54013ac7b71f74eec8bc8f?s=128&d=identicon&r=PG&f=1", "display_name": "spoon252", "link": "https://stackoverflow.com/users/10238182/spoon252"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559769551, "creation_date": 1559768256, "last_edit_date": 1559769551, "question_id": 56467905, "link": "https://stackoverflow.com/questions/56467905/cannot-connect-nullnewconnection-to-myserveronnewconnection-newcon", "title": "&quot;Cannot connect (null)::newConnection() to myserver::onNewConnection()&quot; - newConnection signal not called", "body": "<p>I tried to run simple client-server app in QT. Problem is with \"connect\" on server side - newConnection slot isn't executed and exception appears (like in title). </p>\n\n<p>***************myserver.cpp***********</p>\n\n<pre><code>#include \"myserver.h\"\n\nmyserver::myserver(){}\nmyserver::~myserver(){}\n\nvoid myserver::startServer()\n{\n    qDebug()&lt;&lt;\"Starting startServer()\";\n    tcpServer = new QTcpServer(this);\n    if (this-&gt;listen(QHostAddress::Any,1000))\n    {\n        qDebug()&lt;&lt;\"Listening\";\n    }\n    else\n    {\n        qDebug()&lt;&lt;\"Not listening\";\n    }\n}\n\nvoid myserver::incomingConnection(int socketDescriptor)\n{\n    qDebug()&lt;&lt;\"incomingConnection() started\";\n    socket=new QTcpSocket(this);\n    socket-&gt;setSocketDescriptor(socketDescriptor);\n    connect(tcpServer,SIGNAL(newConnection()),this,SLOT(onNewConnection()));\n    qDebug()&lt;&lt;socketDescriptor&lt;&lt;\"Client connected\";\n}\n\nvoid myserver::onNewConnection()\n{\n    qDebug()&lt;&lt;\"onNewConnection() started\";\n}\n</code></pre>\n\n<p>**********myserver.h**************</p>\n\n<pre><code>#ifndef MYSERVER_H\n#define MYSERVER_H\n\n#include &lt;QTcpServer&gt;\n#include &lt;QTcpSocket&gt;\n\nclass myserver: public QTcpServer\n{\n     Q_OBJECT\n\npublic:\n    myserver();\n    ~myserver();\n    QTcpSocket* socket;\n    QTcpServer *tcpServer=nullptr;\n\npublic slots:\n    void startServer();\n    void incomingConnection(int socketDescriptor);\n    void onNewConnection();\n};\n\n#endif // MYSERVER_H\n</code></pre>\n\n<p>***********testClient.cpp**************</p>\n\n<pre><code>#include \"myclient.h\"\n#include \"ui_myclient.h\"\n\nmyclient::myclient(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::myclient)\n{\n    ui-&gt;setupUi(this);\n    socket=new QTcpSocket(this);\n    connect(socket,SIGNAL(connected()),this,SLOT(socketMap()));\n}\n\nmyclient::~myclient()\n{\n    delete ui;\n}\n\nvoid myclient::on_pushButton_clicked()\n{\n    socket-&gt;connectToHost(\"127.0.0.1\",1000);\n    if(socket-&gt;isOpen())\n    {\n        qDebug()&lt;&lt;\"Connected!\";\n    }\n    else {\n        qDebug()&lt;&lt;\"Not connected\";\n    }\n}\n\nvoid myclient::socketMap()\n{\n    qDebug()&lt;&lt;\"socketMap() started\";\n}\n</code></pre>\n\n<p>I expected onNewConnection() being called when client connects. Also I have checked client side and connection is confirmed.</p>\n\n<p>This is console output on server:</p>\n\n<pre><code>Starting startServer()\nListening\nincomingConnection() started\n948 Client connected\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1559768194, "post_id": 56467848, "comment_id": 99527269, "body": "Why do you write all types twice?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1559768202, "post_id": 56467848, "comment_id": 99527270, "body": "You have a lot of syntax issues with this code. Sounds like you could use a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a> to help you with the syntax for classes and templates."}, {"owner": {"reputation": 23, "user_id": 11606115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd99b9010421b85517e1134c4d03fffa?s=128&d=identicon&r=PG&f=1", "display_name": "user485611", "link": "https://stackoverflow.com/users/11606115/user485611"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1559769471, "post_id": 56467848, "comment_id": 99527744, "body": "@JVApen Haha, I didn&#39;t know what I was doing. :)"}, {"owner": {"reputation": 23, "user_id": 11606115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd99b9010421b85517e1134c4d03fffa?s=128&d=identicon&r=PG&f=1", "display_name": "user485611", "link": "https://stackoverflow.com/users/11606115/user485611"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559769528, "post_id": 56467848, "comment_id": 99527766, "body": "@NathanOliver Thank you, some good suggestions there! Will definitely check some of them out"}], "answers": [{"comments": [{"owner": {"reputation": 4599, "user_id": 2055064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/815c89ab1784fd780fe7faf44ebfc79f?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2055064/thomas"}, "edited": false, "score": 0, "creation_date": 1559768916, "post_id": 56468015, "comment_id": 99527527, "body": "while this looks much nicer it still gives me the same error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 4599, "user_id": 2055064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/815c89ab1784fd780fe7faf44ebfc79f?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2055064/thomas"}, "edited": false, "score": 0, "creation_date": 1559769106, "post_id": 56468015, "comment_id": 99527609, "body": "@Thomas Well, let&#39;s put it this way, what error are you getting? That might help us answer."}, {"owner": {"reputation": 4599, "user_id": 2055064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/815c89ab1784fd780fe7faf44ebfc79f?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2055064/thomas"}, "edited": false, "score": 0, "creation_date": 1559769403, "post_id": 56468015, "comment_id": 99527716, "body": "@NicoSchertler same as the OP, see <a href=\"http://coliru.stacked-crooked.com/a/2a08709fdc6faa2e\" rel=\"nofollow noreferrer\">coliru</a>"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "reply_to_user": {"reputation": 4599, "user_id": 2055064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/815c89ab1784fd780fe7faf44ebfc79f?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2055064/thomas"}, "edited": false, "score": 0, "creation_date": 1559769707, "post_id": 56468015, "comment_id": 99527830, "body": "@Thomas Yours also compiles. You only get a warning that <code>result</code> is unused. The error message that you see is from the comment and not an actual error message."}, {"owner": {"reputation": 4599, "user_id": 2055064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/815c89ab1784fd780fe7faf44ebfc79f?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/2055064/thomas"}, "edited": false, "score": 0, "creation_date": 1559769786, "post_id": 56468015, "comment_id": 99527858, "body": "@NicoSchertler never mind, i&#39;m just blind. it&#39;s an unused variable warning with the comment displaying the unused variable text ... (shame)"}], "tags": [], "owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "is_accepted": true, "score": 2, "last_activity_date": 1559768772, "creation_date": 1559768772, "answer_id": 56468015, "question_id": 56467848, "link": "https://stackoverflow.com/questions/56467848/how-to-define-function-with-different-templates-as-input/56468015#56468015", "title": "How to define function with different templates as input", "body": "<p>I am not sure what you were trying to do with all the scope operators. You don't need them. Simply use the proper types. I have added const references because it looked reasonable for this scenario. They are not strictly required.</p>\n\n<pre><code>template &lt;class T&gt;\nCat&lt;T&gt; operator*(const Dog&lt;T&gt;&amp; m, const Cat&lt;T&gt;&amp; v)\n{\n    Cat&lt;T&gt; return_cat(1);\n    return return_cat;\n}\n\nint main(int argc, char* argv[])\n{    \n    Cat&lt;double&gt; new_cat(2);    \n    Dog&lt;double&gt; new_dog(4);    \n    Cat&lt;double&gt; result = new_dog * new_cat;    \n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 11606115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd99b9010421b85517e1134c4d03fffa?s=128&d=identicon&r=PG&f=1", "display_name": "user485611", "link": "https://stackoverflow.com/users/11606115/user485611"}, "edited": false, "score": 1, "creation_date": 1559769876, "post_id": 56468072, "comment_id": 99527900, "body": "Thanks for clarifying about the different types, I wasn&#39;t aware! Would upvote, but can&#39;t yet"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559770799, "post_id": 56468072, "comment_id": 99528229, "body": "Prefer <code>Cat&lt;decltype(std::declval&lt;T1&gt;()+std::declval&lt;T2&gt;()))&gt;</code> for the return type in the second case, so a short cat multiplied by a long dog is a long cat?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559770899, "post_id": 56468072, "comment_id": 99528270, "body": "@Bathsheba Didn&#39;t know that was a thing. Really awesome."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "is_accepted": false, "score": 0, "last_activity_date": 1559769049, "creation_date": 1559769049, "answer_id": 56468072, "question_id": 56467848, "link": "https://stackoverflow.com/questions/56467848/how-to-define-function-with-different-templates-as-input/56468072#56468072", "title": "How to define function with different templates as input", "body": "<p>I'm not sure what your intended use of <code>operator*()</code> is, but generally it will look something like this:</p>\n\n<pre><code>template &lt;class T&gt; \nCat&lt;T&gt; operator*(Dog&lt;T&gt; m, Cat&lt;T&gt; v)\n</code></pre>\n\n<p>This allows a cat and dog to be multiplied if their template class is the same.</p>\n\n<p>If they are not the same (that is, cat and dog have different types), you will want something like this instead:</p>\n\n<pre><code>template &lt;class T1, class T2&gt; \nCat&lt;T2&gt; operator*(Dog&lt;T1&gt; m, Cat&lt;T2&gt; v)\n</code></pre>\n\n<p>This allows for cat and dog to have different types and be multiplied together.</p>\n"}, {"tags": [], "owner": {"reputation": 70, "user_id": 2733837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68db816e58d0ff50f62f826d941699f?s=128&d=identicon&r=PG&f=1", "display_name": "Valeca", "link": "https://stackoverflow.com/users/2733837/valeca"}, "is_accepted": false, "score": 0, "last_activity_date": 1559770829, "creation_date": 1559770829, "answer_id": 56468394, "question_id": 56467848, "link": "https://stackoverflow.com/questions/56467848/how-to-define-function-with-different-templates-as-input/56468394#56468394", "title": "How to define function with different templates as input", "body": "<p>To simplify it a little bit for easier \"reading\" and not \"mixing\" dogs with cats :), you can play with this overload </p>\n\n<pre><code>template &lt;class T&gt;\nclass Animal\n{\n  private:\n    T size;\n  public:\n  Animal(T size1) {\n    size = size1;\n  }\n  T getSize() {\n     return size;\n}\nAnimal&lt;T&gt; operator*(Animal&lt;T&gt; animal1)\n{\n  T a = animal1.getSize();\n  T b = this-&gt;getSize();\n  Animal&lt;T&gt; animal = Animal&lt;T&gt;(a*b);\n  return animal;\n }\n</code></pre>\n\n<p>};</p>\n\n<p>int main(int argc, char* argv[])\n  {</p>\n\n<pre><code>Animal&lt;double&gt; cat(2);\nAnimal&lt;double&gt; dog(4);\nAnimal&lt;double&gt; result( dog*cat );\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 23, "user_id": 11606115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd99b9010421b85517e1134c4d03fffa?s=128&d=identicon&r=PG&f=1", "display_name": "user485611", "link": "https://stackoverflow.com/users/11606115/user485611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56468015, "answer_count": 3, "score": 2, "last_activity_date": 1559770829, "creation_date": 1559767995, "last_edit_date": 1559769071, "question_id": 56467848, "link": "https://stackoverflow.com/questions/56467848/how-to-define-function-with-different-templates-as-input", "title": "How to define function with different templates as input", "body": "<p>I am completely new to C++ (and Stack Overflow), so please bear with me. I am trying to create two templates and a function that takes inputs from both templates. </p>\n\n<p>I have tried to make some sample code that resembles my code, and which reproduces the error. Basically I have two templates Dog and Cat, and want to create an operator function which takes an instance of Dog and Cat respectively, but I am really struggling with how to write the function header. After having spent a lot of time reading Stack Overflow posts, I have thrown in keywords 'template' and 'typename' in an attempt to make it work, but I keep getting errors. Currently the error is </p>\n\n<blockquote>\n  <p>candidate template ignored: couldn't infer template argument 'T'</p>\n</blockquote>\n\n<pre><code>template &lt;class T&gt; class Dog\n{\nprivate:\n    int size;\n\npublic:\n  Dog(int size1)\n    {\n        size = size1;\n    }\n};\n\ntemplate &lt;class T&gt; class Cat\n{\nprivate:\n    int size;\n\npublic:\n    Cat(int size1)\n    {\n        size = size1;\n    }\n\n};\n\ntemplate &lt;class T&gt; // What to write here?\ntypename Cat&lt;T&gt;::template Cat&lt;T&gt; operator*(typename Dog&lt;T&gt;::template Dog&lt;T&gt; m,typename Cat&lt;T&gt;::template Cat&lt;T&gt; v)\n{\n    Cat&lt;int&gt; return_cat(1);\n    return return_cat;\n}\n\nint main(int argc, char* argv[]) \n{\n\n    Cat&lt;double&gt;::Cat&lt;double&gt; new_cat(2);\n\n    Dog&lt;double&gt;::Dog&lt;double&gt; new_dog(4);\n\n    Cat&lt;double&gt;::Cat&lt;double&gt; result = new_dog*new_cat; // ERROR couldn't infer template argument 'T'\n\n    return 0;\n}\n</code></pre>\n\n<p>My question is: How should I define the function header for the <code>operator*</code> function to avoid any errors?</p>\n"}, {"tags": ["c++", "templates", "operator-overloading", "either"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559766362, "post_id": 56467480, "comment_id": 99526512, "body": "From what I see, <code>triple</code> is a function. Did you try calling it, like you do with <code>result::success</code>? Voted to close as a typo."}, {"owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1559766591, "post_id": 56467480, "comment_id": 99526608, "body": "@AlgirdasPreid\u017eius the idea is to supply the function as an argument to the <code>&gt;&gt;=</code> operator. What kind of typo is there?"}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1559767976, "post_id": 56467480, "comment_id": 99527200, "body": "On top of formerlyknownas_463035818&#39;s answer, <code>auto res5b = res4 &gt;&gt;= triple &gt;&gt;= triple;</code> will not work without additional operator for two function pointers or an explicit brackets around <code>res4 &gt;&gt;= triple</code>, because <code>operator &gt;&gt;=</code> is a right-to-left one. It will try first to apply <code>&gt;&gt;=</code> on <code>triple</code> and <code>triple</code>."}, {"owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "edited": false, "score": 0, "creation_date": 1559777013, "post_id": 56467480, "comment_id": 99529770, "body": "I wrote a detailed post explaining how to implement <code>Result</code> cleanly and efficiently so that it&#39;s a sum type. It solves your issues, and it avoids using <code>std::function</code> so that the compiler can inline everything. The syntax ends up being a lot closer to Haskell&#39;s"}], "answers": [{"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 4, "last_activity_date": 1559769776, "last_edit_date": 1559769776, "creation_date": 1559767542, "answer_id": 56467770, "question_id": 56467480, "link": "https://stackoverflow.com/questions/56467480/overloading-operator-on-a-templated-class/56467770#56467770", "title": "Overloading operator on a templated class", "body": "<p>This works</p>\n\n<pre><code>auto f = std::function&lt; result&lt;int, std::string&gt;(int)&gt;(triple);\nauto res5a = res4 &gt;&gt;= f;\n</code></pre>\n\n<p>I cannot give a good concise explanation, only that much: Type deduction does not take into acount conversions and <code>triple</code> is a <code>result&lt;int,std::string&gt;()(int)</code> not a <code>std::function</code>. </p>\n\n<p>You dont have to use <code>std::function</code> but you can accept any callable with something like:</p>\n\n<pre><code>template &lt;typename G&gt;\nauto operator&gt;&gt;=(G func) -&gt; decltype(func(std::declval&lt;S&gt;())) {\n    if (pick == true) {\n        return func(succ);\n    } else {\n        return failure(fail);\n    }\n}\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/3BTs1ApfpBgnzjS0\" rel=\"nofollow noreferrer\">Live Demo</a></p>\n\n<p>Note that <code>std::function</code> comes with some overhead. It uses type erasure to be able to store all kinds of callables. When you want to pass only one callable there is no need to pay that cost.</p>\n\n<p>For the second line @Yksisarvinen's comment already summarizes it. For the sake of completeness I simply quote it here</p>\n\n<blockquote>\n  <p><code>auto res5b = res4 &gt;&gt;= triple &gt;&gt;= triple;</code> will not work without\n  additional operator for two function pointers or an explicit brackets\n  around <code>res4 &gt;&gt;= triple</code>, because <code>operator &gt;&gt;=</code> is a right-to-left one.\n  It will try first to apply <code>&gt;&gt;=</code> on triple and triple.</p>\n</blockquote>\n\n<p>PS: I dont know Either and your code is a bit more functional style than what I am used to, maybe you can get similar out of <a href=\"https://en.cppreference.com/w/cpp/types/conditional\" rel=\"nofollow noreferrer\"><code>std::conditional</code></a>?</p>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1559770627, "creation_date": 1559770627, "answer_id": 56468348, "question_id": 56467480, "link": "https://stackoverflow.com/questions/56467480/overloading-operator-on-a-templated-class/56468348#56468348", "title": "Overloading operator on a templated class", "body": "<p>So, in C++, a <code>std::function</code> is not the base class of anything of interest.  You cannot deduce the type of a <code>std::function</code> from a function or a lambda.</p>\n\n<p>So your:</p>\n\n<pre><code>/// Chain two computations.\ntemplate &lt;typename T&gt;\nresult&lt;T,F&gt; operator&gt;&gt;=(std::function&lt;result&lt;T,F&gt;(S)&gt; func)\n</code></pre>\n\n<p>will only deduce when passed an actual <code>std::function</code>.</p>\n\n<p>Now, what you really mean is \"something that takes an S and returns a <code>result&lt;T,F&gt;</code> for some type <code>T</code>\".</p>\n\n<p>This isn't how you say it in C++.</p>\n\n<p>As noted, <code>&gt;&gt;=</code> is right-associative.  I might propose <code>-&gt;*</code> instead, which is left-to-right.</p>\n\n<p>Second, your <code>failure</code> static function won't work right, as it returns the wrong type often.</p>\n\n<pre><code>template&lt;class F&gt;\nstruct failure {\n  F t;\n};\ntemplate&lt;class F&gt;\nfailure(F)-&gt;failure{F};\n</code></pre>\n\n<p>then add a constructor taking a <code>failure&lt;F&gt;</code>.</p>\n\n<pre><code>/// Chain two computations.\ntemplate&lt;class Self, class Rhs,\n  std::enable_if_t&lt;std::is_same&lt;result, std::decay_t&lt;Self&gt;&gt;{}, bool&gt; = true\n&gt;\nauto operator-&gt;*( Self&amp;&amp; self, Rhs&amp;&amp; rhs )\n-&gt; decltype( std::declval&lt;Rhs&gt;()( std::declval&lt;Self&gt;().succ ) )\n{\n  if (self.pick == true) {\n    return std::forward&lt;Rhs&gt;(rhs)(std::forward&lt;Self&gt;(self).succ);\n  } else {\n    return failure{std::forward&lt;Self&gt;(self).fail};\n  }\n}\n</code></pre>\n\n<p>I am now carefully paying attention to r/lvalue ness of the types involved, and will move if possible.</p>\n\n<pre><code>template&lt;class F&gt;\nstruct failure {\n    F f;\n};\ntemplate&lt;class F&gt;\nfailure(F&amp;&amp;)-&gt;failure&lt;std::decay_t&lt;F&gt;&gt;;\n\ntemplate&lt;class S&gt;\nstruct success {\n    S s;\n};\ntemplate&lt;class S&gt;\nsuccess(S&amp;&amp;)-&gt;success&lt;std::decay_t&lt;S&gt;&gt;;\n\n\ntemplate &lt;class S, class F&gt;\nclass result\n{\n  private:\n    std::variant&lt;S, F&gt; state;\n\n  public:\n    bool successful() const {\n      return state.index() == 0;\n    }\n\n    template&lt;class Self,\n        std::enable_if_t&lt; std::is_same&lt;result, std::decay_t&lt;Self&gt;&gt;{}, bool&gt; = true\n    &gt;\n    friend decltype(auto) s( Self&amp;&amp; self ) {\n        return std::get&lt;0&gt;(std::forward&lt;Self&gt;(self).state);\n    }\n    template&lt;class Self,\n        std::enable_if_t&lt; std::is_same&lt;result, std::decay_t&lt;Self&gt;&gt;{}, bool&gt; = true\n    &gt;\n    friend decltype(auto) f( Self&amp;&amp; self ) {\n        return std::get&lt;1&gt;(std::forward&lt;Self&gt;(self).state);\n    }\n\n    /// Chain results of two computations.\n    template&lt;class Self, class Rhs,\n        std::enable_if_t&lt; std::is_same&lt;result, std::decay_t&lt;Self&gt;&gt;{}, bool&gt; = true\n    &gt;\n    friend std::decay_t&lt;Rhs&gt; operator&amp;&amp;(Self&amp;&amp; self, Rhs&amp;&amp; rhs) {\n      if (self.successful()) {\n        return success{s(std::forward&lt;Rhs&gt;(rhs))};\n      } else {\n        return failure{f(std::forward&lt;Self&gt;(self))};\n      }\n    }\n\n    /// Chain two computations.\n    template&lt;class Self, class Rhs,\n        std::enable_if_t&lt; std::is_same&lt;result, std::decay_t&lt;Self&gt;&gt;{}, bool&gt; = true\n    &gt;        \n    friend auto operator-&gt;*(Self&amp;&amp;self, Rhs&amp;&amp; rhs)\n    -&gt; decltype( std::declval&lt;Rhs&gt;()( s( std::declval&lt;Self&gt;() ) ) )\n    {\n      if (self.successful()) {\n        return std::forward&lt;Rhs&gt;(rhs)(s(std::forward&lt;Self&gt;(self)));\n      } else {\n        return failure{f(std::forward&lt;Self&gt;(self))};\n      }\n    }\n\n    template&lt;class T&gt;\n    result( success&lt;T&gt; s ):\n      state(std::forward&lt;T&gt;(s.s))\n    {}\n    template&lt;class T&gt;\n    result( failure&lt;T&gt; f ):\n      state(std::forward&lt;T&gt;(f.f))\n    {}\n    explicit operator bool() const { return successful(); }\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/bee6a90d56eea699\" rel=\"nofollow noreferrer\">live example</a>.</p>\n\n<p>Uses <a href=\"/questions/tagged/c%2b%2b17\" class=\"post-tag\" title=\"show questions tagged &#39;c++17&#39;\" rel=\"tag\">c++17</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 8888, "user_id": 4967403, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjcvA.jpg?s=128&g=1", "display_name": "J. Antonio Perez", "link": "https://stackoverflow.com/users/4967403/j-antonio-perez"}, "is_accepted": false, "score": 1, "last_activity_date": 1559777420, "last_edit_date": 1559777420, "creation_date": 1559776942, "answer_id": 56469237, "question_id": 56467480, "link": "https://stackoverflow.com/questions/56467480/overloading-operator-on-a-templated-class/56469237#56469237", "title": "Overloading operator on a templated class", "body": "<h1>Implementing <code>Result</code> cleanly and efficently</h1>\n\n<p>C++ can represent a <code>Result</code> type just as cleanly and efficiently as haskell. Like Haskell, C++ has true <em>sum types</em>, and we can encapsulate the entirety of their functionality with a tagged union. In addition, by taking advantage of implicit construction, we can represent <code>Success</code> and <code>Failure</code> as types instead of static member functions (this makes things a lot cleaner). </p>\n\n<h2>Defining <code>Success</code> and <code>Failure</code></h2>\n\n<p>These are really simple. They're just wrapper classes, so we can implement them as aggregates. In addition, using C++17's template deduction guides, we won't have to specify the template parameters for <code>Failure</code> and <code>Success</code>. Instead, we'll just be able to write <code>Success{10}</code>, or <code>Failure{\"Bad arg\"}</code>. </p>\n\n<pre><code>template &lt;class F&gt;\nclass Failure {\n   public: \n    F value;\n};\ntemplate&lt;class F&gt;\nFailure(F) -&gt; Failure&lt;F&gt;; \n\ntemplate &lt;class S&gt;\nclass Success {\n   public:\n    S value;\n\n    // This allows chaining from an initial Success\n    template&lt;class Fun&gt;\n    auto operator&gt;&gt;(Fun&amp;&amp; func) const {\n        return func(value); \n    }\n};\ntemplate &lt;class S&gt;\nSuccess(S) -&gt; Success&lt;S&gt;; \n</code></pre>\n\n<h2>Defining <code>Result</code></h2>\n\n<p><code>Result</code> is a sum type. That means it can be either a success or a failure, but not both. We can represent this with a union, which we'll tag with a <code>was_success</code> bool. </p>\n\n<pre><code>template &lt; class S, class F&gt;\nclass Result {\n    union {\n        Success&lt;S&gt; success; \n        Failure&lt;F&gt; failure; \n    };\n    bool was_success = false; // We set this just to ensure it's in a well-defined state\n   public:\n    // Result overloads 1 through 4\n    Result(Success&lt;S&gt; const&amp; s) : success(s), was_success(true) {}\n    Result(Failure&lt;F&gt; const&amp; f) : failure(f), was_success(false) {}\n    Result(Success&lt;S&gt;&amp;&amp; s) : success(std::move(s)), was_success(true) {}\n    Result(Failure&lt;F&gt;&amp;&amp; f) : failure(std::move(f)), was_success(false) {}\n\n    // Result overloads 5 through 8\n    template&lt;class S2&gt;\n    Result(Success&lt;S2&gt; const&amp; s) : success{S(s.value)}, was_success(true) {}\n    template&lt;class F2&gt;\n    Result(Failure&lt;F2&gt; const&amp; f) : failure{F(f.value)}, was_success(false) {}\n    template&lt;class S2&gt;\n    Result(Success&lt;S2&gt;&amp;&amp; s) : success{S(std::move(s.value))}, was_success(true) {}\n    template&lt;class F2&gt;\n    Result(Failure&lt;F2&gt;&amp;&amp; f) : failure{F(std::move(f.value))}, was_success(false) {}\n\n    // Result overloads 9 through 10\n    Result(Result const&amp;) = default;\n    Result(Result&amp;&amp;) = default; \n\n    template&lt;class S2&gt; \n    Result&lt;S2, F&gt; operator&amp;&amp;(Result&lt;S2, F&gt; const&amp; res) {\n        if(was_success) {\n            return res; \n        } else {\n            return Failure{failure}; \n        }\n    }\n\n    template&lt;class Fun, class Ret = decltype(valueOf&lt;Fun&gt;()(success.value))&gt;\n    auto operator&gt;&gt;(Fun&amp;&amp; func) const\n        -&gt; Ret\n    {\n        if(was_success) {\n            return func(success.value); \n        } else {\n            return failure; \n        }\n    }\n\n    ~Result() {\n        if(was_success) {\n            success.~Success&lt;S&gt;(); \n        } else {\n            failure.~Failure&lt;F&gt;(); \n        }\n    }\n};\n</code></pre>\n\n<h3>Explaining <code>Result(...)</code></h3>\n\n<p>A result is either constructed from a success or a failure. </p>\n\n<ul>\n<li>Overloads 1 through 4 just handle the basic copy and move construction from <code>Success</code> and <code>Failure</code> objects;</li>\n<li>Overloads 5 trhough 8 handle the case where we want to do an implicit conversion (as in the case of a string literal to a <code>std::string.</code> </li>\n<li>Overloads 9 and 10 handle move and copy construction of <code>Result</code>. </li>\n</ul>\n\n<h3>Explaining <code>operator&gt;&gt;</code></h3>\n\n<p>This is pretty similar to your implementation of <code>operator&gt;&gt;=</code>, and i'll explain the reasoning behind my changes. </p>\n\n<pre><code>    template&lt;class Fun, class Ret = decltype(valueOf&lt;Fun&gt;()(success.value))&gt;\n    auto operator&gt;&gt;(Fun&amp;&amp; func) const\n        -&gt; Ret\n    {\n        if(was_success) {\n            return func(success.value); \n        } else {\n            return failure; \n        }\n    }\n</code></pre>\n\n<p><strong>Why not use <code>std::function</code>?</strong> <code>std::function</code> is a type-erasing wrapper. That means that it uses virtual function calls under the hood, which slow things down. By using an unconstrained template, we make it much easier for the compiler to optimize stuff. </p>\n\n<p><strong>Why use <code>&gt;&gt;</code> instead of <code>&gt;&gt;=</code>?</strong> I used <code>&gt;&gt;</code> because <code>&gt;&gt;=</code> has weird behavior since it's an assignment operator. The statement <code>a &gt;&gt;= b &gt;&gt;= c</code> is actually <code>a &gt;&gt;= (b &gt;&gt;= c)</code>, which is not what we intended. </p>\n\n<p><strong>What does <code>class Ret = decltype(valueOf&lt;Fun&gt;()(success.value))</code> do?</strong> That defines a template parameter which is defaulted to the return type of the function you pass. This enables us to avoid using <code>std::function</code> while also allowing us to use lambdas. </p>\n\n<h3>Explaining <code>~Result()</code></h3>\n\n<p>Because <code>Result</code> contains a union, we have to manually specify how to destruct it. (Classes containing <code>Result</code> <em>won't</em> have to do this - once we specify it inside <code>Result</code>, everything behaves like normal). This is pretty straight-forward. If it contains the <code>Success</code> object, we destroy that one. Otherwise, we destroy the <code>failure</code> one. </p>\n\n<pre><code>   // Result class\n\n   ~Result() {\n        if(was_success) {\n            success.~Success&lt;S&gt;(); \n        } else {\n            failure.~Failure&lt;F&gt;(); \n        }\n    }\n</code></pre>\n\n<h1>Updating your example for my implementation</h1>\n\n<p>Now that we've written a <code>Result</code> class, we can update your definitions of <code>triple</code> and <code>main</code>. </p>\n\n<h2>New definition of <code>triple</code></h2>\n\n<p>Pretty straight-forward; we just replaced your <code>success</code> and <code>failure</code> functions with the <code>Success</code> and <code>Failure</code> types. </p>\n\n<pre><code>auto triple(int val) -&gt; Result&lt;int, std::string&gt;\n{\n    if (val &lt; 100) {\n      return Success{val * 3};\n    } else {\n        return Failure{\"can't go over 100\"};\n    }\n}\n</code></pre>\n\n<h2>New definition of <code>main</code></h2>\n\n<p>I added a <code>print</code> function so we can actually see some output. It's just a lambda. There are two computations done, one for <code>ans</code> and the other for <code>ans2</code>. The one for <code>ans</code> prints 18, because <code>triple</code> doesn't push the number over 100, but the one for <code>ans2</code> doesn't print anything because it results in a failure. </p>\n\n<pre><code>\nint main(int argc, char* argv[])\n{\n    auto print = [](auto value) -&gt; Result&lt;decltype(value), std::string&gt; {\n        std::cout &lt;&lt; \"Obtained value: \" &lt;&lt; value &lt;&lt; '\\n';\n        return Success{value}; \n    };\n    auto ans = Success{2} &gt;&gt; triple &gt;&gt; triple &gt;&gt; print;\n    auto ans2 = Success{2} &gt;&gt; triple &gt;&gt; triple &gt;&gt; triple &gt;&gt; triple &gt;&gt; triple &gt;&gt; print;\n}\n</code></pre>\n\n<h3><a href=\"https://godbolt.org/z/JnzfOR\" rel=\"nofollow noreferrer\">You can play with the code here!</a></h3>\n"}], "owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1559777420, "creation_date": 1559766154, "question_id": 56467480, "link": "https://stackoverflow.com/questions/56467480/overloading-operator-on-a-templated-class", "title": "Overloading operator on a templated class", "body": "<p>Here is a definition of a <code>Result</code> class that aims to simulate the logic of the Either monad from Haskell (<code>Left</code> is <code>Failure</code>; <code>Right</code> is <code>Success</code>).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;string&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;typename S, typename F&gt;\nclass result\n{\n  private:\n    S succ;\n    F fail;\n    bool pick;\n\n  public:\n    /// Chain results of two computations.\n    template &lt;typename T&gt;\n    result&lt;T,F&gt; operator&amp;&amp;(result&lt;T,F&gt; _res) {\n      if (pick == true) {\n        return _res;\n      } else {\n        return failure(fail);\n      }\n    }\n\n    /// Chain two computations.\n    template &lt;typename T&gt;\n    result&lt;T,F&gt; operator&gt;&gt;=(std::function&lt;result&lt;T,F&gt;(S)&gt; func) {\n      if (pick == true) {\n        return func(succ);\n      } else {\n        return failure(fail);\n      }\n    }\n\n    /// Create a result that represents success.\n    static result success(S _succ) {\n      result res;\n      res.succ = _succ;\n      res.pick = true;\n\n      return res;\n    }\n\n    /// Create a result that represents failure.\n    static result failure(F _fail) {\n      result res;\n      res.fail = _fail;\n      res.pick = false;\n\n      return res;\n    }\n};\n</code></pre>\n\n<p>When trying to compose two results using the <code>&amp;&amp;</code> operator, all is well:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int\nmain(int argc, char* argv[])\n{\n  // Works!\n  auto res1 = result&lt;int, std::string&gt;::success(2);\n  auto res2 = result&lt;int, std::string&gt;::success(3);\n  auto res3 = res1 &amp;&amp; res2;\n}\n</code></pre>\n\n<p>But when attempting to chain computations on top of the result, a compilation error appears:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>result&lt;int, std::string&gt;\ntriple(int val)\n{\n  if (val &lt; 100) {\n    return result&lt;int, std::string&gt;::success(val * 3);\n  } else {\n    return result&lt;int, std::string&gt;::failure(\"can't go over 100!\");\n  }\n}\n\nint\nmain(int argc, char* argv[])\n{\n  // Does not compile!\n  auto res4 = result&lt;int, std::string&gt;::success(2);\n  auto res5a = res4 &gt;&gt;= triple;\n  auto res5b = res4 &gt;&gt;= triple &gt;&gt;= triple;\n}\n</code></pre>\n\n<p>The error from <code>clang++</code> is as follows:</p>\n\n<pre><code>minimal.cpp:82:21: error: no viable overloaded '&gt;&gt;='\n  auto res5a = res4 &gt;&gt;= triple;\n               ~~~~ ^   ~~~~~~\nminimal.cpp:26:17: note: candidate template ignored: could not match\n      'function&lt;result&lt;type-parameter-0-0, std::__1::basic_string&lt;char,\n      std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt; (int)&gt;' against\n      'result&lt;int, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;,\n      std::__1::allocator&lt;char&gt; &gt; &gt; (*)(int)'\n    result&lt;T,F&gt; operator&gt;&gt;=(std::function&lt;result&lt;T,F&gt;(S)&gt; func) {\n                ^\nminimal.cpp:83:32: error: invalid operands to binary expression ('result&lt;int,\n      std::string&gt; (int)' and 'result&lt;int, std::string&gt; (*)(int)')\n  auto res5b = res4 &gt;&gt;= triple &gt;&gt;= triple;\n</code></pre>\n\n<p>Any idea as to how to fix this issue?</p>\n"}, {"tags": ["c++", "c++17", "shared-ptr", "smart-pointers", "kdb"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1559765740, "post_id": 56467356, "comment_id": 99526255, "body": "Have you considered &#39;new&#39;ing a new shared_ptr and passing that along to the other language?"}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559766084, "post_id": 56467356, "comment_id": 99526391, "body": "Giving away the raw ptr of your shared ptr is dangerous."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559766286, "post_id": 56467356, "comment_id": 99526472, "body": "There may be ways to do this, but I highly doubt any of them qualify as <i>good</i>. You want to explicitly circumvent a safety mechanism that was explicitly put in place by <code>library</code> (shared ownership management). You are firmly committed to entering bad code territory."}, {"owner": {"reputation": 1418, "user_id": 5946921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa6d24b5cd68697ac3f92d8b7e608ea7?s=128&d=identicon&r=PG&f=1", "display_name": "Will Da Silva", "link": "https://stackoverflow.com/users/5946921/will-da-silva"}, "edited": false, "score": 0, "creation_date": 1559766370, "post_id": 56467356, "comment_id": 99526516, "body": "I&#39;m not expecting some magical perfect solution, but there&#39;s no harm in asking."}, {"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559766489, "post_id": 56467356, "comment_id": 99526558, "body": "I would create long living class and keep a strong ref of shared ptr, and give up my ownership whenever I want"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1559766494, "post_id": 56467356, "comment_id": 99526561, "body": "@WillDaSilva I&#39;m certainly not trying to criticize the question. Sometimes you find yourself in a tough spot where you need <i>any</i> solution, even a bad one. I meant to comment on the last sentence that I think there probably aren&#39;t any <b>good</b> ways, only <i>ways</i>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559767499, "post_id": 56467356, "comment_id": 99527014, "body": "Tough luck. C-style interface is incompatible with C++ features (such as shared pointers). If you are using a library which wants a pointer disguised as not a pointer, which it manages itself, you are pretty much programming in C. So you go back to old C days of manual management of the resources."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1559768789, "last_edit_date": 1559768789, "creation_date": 1559766023, "answer_id": 56467450, "question_id": 56467356, "link": "https://stackoverflow.com/questions/56467356/how-to-interface-between-a-foreign-language-and-a-c-library-which-returns-shar/56467450#56467450", "title": "How to interface between a foreign language and a C++ library which returns shared pointers", "body": "<p>The only way to extend the lifetime of such a shared object is to store the <code>shared_ptr</code> in memory until the shared object is no longer needed.</p>\n\n<p>For instance, you could <code>new</code> a separate <code>std::shared_ptr</code> and return that to the foreign language, and then <code>delete</code> it when you are done using it:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>using Foo_sharedptr = std::shared_ptr&lt;library::Foo&gt;;\n\nextern \"C\" K k_new_foo() {\n    Foo_sharedptr ptr = library::Foo::Create();\n    Foo_sharedptr *ptr2 = new Foo_sharedptr(ptr);\n    return kj(reinterpret_cast&lt;J&gt;(ptr2));\n}\n\nextern \"C\" void k_free_foo(K foo) {\n    delete reinterpret_cast&lt;Foo_sharedptr*&gt;(foo-&gt;j);\n    r0(foo);\n}\n</code></pre>\n\n<p>Alternatively, you could store the <code>shared_ptr</code> in a global container that you own, and then pass around values that refer to its elements:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>using Foo_ptr = library::Foo*;\nusing Foo_sharedptr = std::shared_ptr&lt;library::Foo&gt;;\nusing FooMap = std::map&lt;Foo_ptr, Foo_sharedptr&gt;;\n\nstatic FooMap g_foos;\n// wrapped with a std::mutex if you need multithread safety...\n\nextern \"C\" K k_new_foo() {\n    Foo_sharedptr foo = library::Foo::Create();\n    Foo_ptr ptr = foo.get();\n    g_foos[ptr] = foo;\n    return kj(reinterpret_cast&lt;J&gt;(ptr));\n}\n\nextern \"C\" void k_free_foo(K foo) {\n    Foo_ptr ptr = reinterpret_cast&lt;Foo_ptr&gt;(foo-&gt;j);\n    FooMap::iterator iter = g_foos.find(ptr);\n    if (iter != g_foos.end()) g_foos.erase(iter);\n    r0(foo);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559767026, "post_id": 56467549, "comment_id": 99526790, "body": "I&#39;d prefer to see an intermediate cast to a <code>intptr_t</code> then casting that to a <code>long long</code> with some static_asserts for size checks, but what you suggest is elegant."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559767100, "post_id": 56467549, "comment_id": 99526829, "body": "@Bathsheba I can agree with that, however, I can&#39;t write that code 100% correct without consulting a compiler"}], "tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": false, "score": 2, "last_activity_date": 1559767312, "last_edit_date": 1559767312, "creation_date": 1559766525, "answer_id": 56467549, "question_id": 56467356, "link": "https://stackoverflow.com/questions/56467356/how-to-interface-between-a-foreign-language-and-a-c-library-which-returns-shar/56467549#56467549", "title": "How to interface between a foreign language and a C++ library which returns shared pointers", "body": "<p>I see your point, having to go through that is a mess. </p>\n\n<p>Let me assume you don't just have a new method, you also have an explicit delete method. In that case, you could allocate a shared_ptr.</p>\n\n<pre><code>extern \"C\" K k_new_foo() {\n    // not using auto for the sake of clarity in the example\n    std::shared_ptr&lt;library::Foo&gt; ptr = library::Foo::Create();\n    // return the raw pointer as a long long int in a kdb object\n    return kj(reinterpret_cast&lt;long long&gt;(new std::shared_ptr&lt;library::Foo&gt;(ptr)));\n}\n\nextern \"C\" void k_delete_foo(K k) {\n     delete reinterpret_cast&lt;std::shared_ptr&lt;library::Foo&gt; *&gt;(k.foo));\n}\n\nextern \"C\" void k_thread_foo(K k) {\n     auto &amp;ptr = *reinterpret_cast&lt;std::shared_ptr&lt;library::Foo&gt; *&gt;(k.foo));\n     std::thread{[ptr]{ /* Do something */ }}.detach();\n}\n</code></pre>\n\n<p>For sure, this ain't a nice way of coding. However, it does allow you to retain the <code>shared_ptr</code> for all of your C++ code, while having possible memory leaks/ub when incorrectly used from another language.</p>\n\n<p>If you want to protect against incorrect usage. You could instead collect all pointers in some kind of global variable. That way, you could first check if that pointer is shared to the other language. Instead of passing the new shared_ptr, you could share the raw pointer with it and behavior could become a bit more defined as, at exit, all destructors will be called. The disadvantage includes more bookkeeping, which will be noticeable as a performance penalty.</p>\n\n<p>If you just want to attach ownership to a raw pointer you pass along, without such a deletor method, I can only recommend you some kind of memory leak by collecting everything in a global vector.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559768005, "post_id": 56467658, "comment_id": 99527207, "body": "You would just need to provide a way for other languages to refer to items in that container. I suppose <code>k_new_foo</code> could return the <code>shared_ptr</code>&#39;s raw pointer as the reference value, and then <code>k_delete_foo</code> could search the container for that pointer"}, {"owner": {"reputation": 4175, "user_id": 1082038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEql2.jpg?s=128&g=1", "display_name": "Nevin", "link": "https://stackoverflow.com/users/1082038/nevin"}, "edited": false, "score": 0, "creation_date": 1559777433, "post_id": 56467658, "comment_id": 99529852, "body": "If you are just keeping objects alive, can&#39;t you just use a container of <code>shared_ptr&lt;void&gt;</code> to not keep track of objects on a per type basis?"}], "tags": [], "owner": {"reputation": 4567, "user_id": 1320751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eee0011ba2ca995b31e464fc2e2ad885?s=128&d=identicon&r=PG", "display_name": "Anon Mail", "link": "https://stackoverflow.com/users/1320751/anon-mail"}, "is_accepted": false, "score": 1, "last_activity_date": 1559766998, "creation_date": 1559766998, "answer_id": 56467658, "question_id": 56467356, "link": "https://stackoverflow.com/questions/56467356/how-to-interface-between-a-foreign-language-and-a-c-library-which-returns-shar/56467658#56467658", "title": "How to interface between a foreign language and a C++ library which returns shared pointers", "body": "<p>What you could do is maintain a container of <code>shared_ptr&lt;Foo&gt;</code> in your interface.  Your <code>k_new_foo</code> function would save a copy of the shared_ptr in that container.  Then a <code>k_delete_foo</code> function would remove the shared_ptr from the container.</p>\n\n<p>This won't work if there are too many different object types to keep track of.</p>\n"}], "owner": {"reputation": 1418, "user_id": 5946921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa6d24b5cd68697ac3f92d8b7e608ea7?s=128&d=identicon&r=PG&f=1", "display_name": "Will Da Silva", "link": "https://stackoverflow.com/users/5946921/will-da-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 56467450, "answer_count": 3, "score": 2, "last_activity_date": 1559768789, "creation_date": 1559765588, "question_id": 56467356, "link": "https://stackoverflow.com/questions/56467356/how-to-interface-between-a-foreign-language-and-a-c-library-which-returns-shar", "title": "How to interface between a foreign language and a C++ library which returns shared pointers", "body": "<p>I'm writing a library which interfaces between kdb+ (although this question is applicable to foreign language interfaces in general), and a C++ library where most of the API calls return a <code>std::shared_ptr</code>. When interfacing with most libraries with kdb+, it is typical to create objects using the library's API, then return their raw pointer as a <code>long long</code> so that the kdb+ programmer can send the object back into the library however they choose.</p>\n\n<p>Shared pointers make this difficult. Minimal example:</p>\n\n<pre><code>extern \"C\" K k_new_foo() {\n    // not using auto for the sake of clarity in the example\n    std::shared_ptr&lt;library::Foo&gt; ptr = library::Foo::Create();\n    // return the raw pointer as a long long int in a kdb object\n    return kj(reinterpret_cast&lt;long long&gt;(ptr.get()));\n}\n// ptr goes out of scope -&gt; the library::Foo is freed prematurely \n</code></pre>\n\n<p>What I would like to know is if there is some way to extend the lifetime of the <code>std::shared_ptr</code> indefinitely, or to otherwise prevent the destruction of the data it points to until the programmer manually frees it from within kdb+ using another call to this interface library. I'm well aware that what I'm asking for defeats the purpose of using smart pointers; I'd love to know a <em>good</em> way of handling this if such a thing exists, and is practical.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1559765197, "post_id": 56467265, "comment_id": 99526042, "body": "Take a look at the generated code to see what really happens."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1559765444, "post_id": 56467265, "comment_id": 99526125, "body": "Remember that there can be a great number of things going on on a modern multi processing system all at the same time. It can be very hard to get precise time measurements from a clock as a result. Program gets the start time, start performing computation, waits for a shared resource used by another process for a while, completes task. Next time it might not have to wait. It might wait longer. It may be forced to wait multiple times. A very finicky business, timing a program."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559765727, "post_id": 56467265, "comment_id": 99526249, "body": "what compiler options did you use? optimizations turned on?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559765784, "post_id": 56467265, "comment_id": 99526272, "body": "That said, my above comment does not justify the order of magnitude difference reported by the Asker."}, {"owner": {"reputation": 89, "user_id": 11594134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594bb0552b0ed6696d63ff599639ea92?s=128&d=identicon&r=PG&f=1", "display_name": "user11594134", "link": "https://stackoverflow.com/users/11594134/user11594134"}, "edited": false, "score": 0, "creation_date": 1559766051, "post_id": 56467265, "comment_id": 99526379, "body": "I use Visual Studio 2012. Usually I use multithreading so the program can have 100% CPU usage. I thought this might be a better comparison. Optimization is set to Maximize Speed (/O2)"}, {"owner": {"reputation": 1022, "user_id": 5401214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a528a41d62d3f2304368b8322c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert Lange", "link": "https://stackoverflow.com/users/5401214/norbert-lange"}, "edited": false, "score": 0, "creation_date": 1559767950, "post_id": 56467265, "comment_id": 99527190, "body": "You would need to look at the generated code. Hypothetically the compiler could always query the map and skip the assignment after the static variable has been initialized.  Might be a bad optimization for your case, maybe to use some atomic CAS instead of branches."}, {"owner": {"reputation": 89, "user_id": 11594134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594bb0552b0ed6696d63ff599639ea92?s=128&d=identicon&r=PG&f=1", "display_name": "user11594134", "link": "https://stackoverflow.com/users/11594134/user11594134"}, "reply_to_user": {"reputation": 1022, "user_id": 5401214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a528a41d62d3f2304368b8322c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert Lange", "link": "https://stackoverflow.com/users/5401214/norbert-lange"}, "edited": false, "score": 0, "creation_date": 1559769209, "post_id": 56467265, "comment_id": 99527647, "body": "@NorbertLange You ideal is really helpful. Here is something I got from assembly \tstatic double res = m[i]; 000000013F83D454  mov         eax,104h   .... 000000013F83D49C  call        std::map&lt;int,double,std::less&lt;int&gt;,std::allocator&lt;std::pair&lt;&zwnj;&#8203;int const ,double&gt; &gt; &gt;::operator[] (013F831320h)   ... 000000013F83D4B4  call        _Init_thread_footer (013F8314C4h)"}, {"owner": {"reputation": 89, "user_id": 11594134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594bb0552b0ed6696d63ff599639ea92?s=128&d=identicon&r=PG&f=1", "display_name": "user11594134", "link": "https://stackoverflow.com/users/11594134/user11594134"}, "reply_to_user": {"reputation": 1022, "user_id": 5401214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a528a41d62d3f2304368b8322c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert Lange", "link": "https://stackoverflow.com/users/5401214/norbert-lange"}, "edited": false, "score": 0, "creation_date": 1559769312, "post_id": 56467265, "comment_id": 99527683, "body": "@NorbertLange It did seems that m[i] is still called. I just wonder if there are some settings in Visual Studio 2012 to ignore execute m[i] from the second time"}, {"owner": {"reputation": 1022, "user_id": 5401214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a528a41d62d3f2304368b8322c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert Lange", "link": "https://stackoverflow.com/users/5401214/norbert-lange"}, "edited": false, "score": 0, "creation_date": 1559812522, "post_id": 56467265, "comment_id": 99539256, "body": "No idea, but do you really want to depend on compilerspecific behavior? If you want to make sure code is only called once, use std::call_once"}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1559765565, "post_id": 56467343, "comment_id": 99526168, "body": "While this is good information, it doesn&#39;t explain how two functions, both using static initialization, have such a difference."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559765705, "post_id": 56467343, "comment_id": 99526238, "body": "@Evg thread-safeness normally has no effect on performance (at least on hardware I am familiar with) due to double-check locking."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559765798, "post_id": 56467343, "comment_id": 99526280, "body": "@NathanOliver good point, let me edit to answer the question better."}, {"owner": {"reputation": 89, "user_id": 11594134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594bb0552b0ed6696d63ff599639ea92?s=128&d=identicon&r=PG&f=1", "display_name": "user11594134", "link": "https://stackoverflow.com/users/11594134/user11594134"}, "edited": false, "score": 0, "creation_date": 1559769445, "post_id": 56467343, "comment_id": 99527733, "body": "Thanks so much for the answer. I saw the assembly code but it seems that map did get called. Maybe I did something wrong in the optimization for Visual Studio 2012. Any good idea on this"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 7, "last_activity_date": 1559766436, "last_edit_date": 1559766436, "creation_date": 1559765499, "answer_id": 56467343, "question_id": 56467265, "link": "https://stackoverflow.com/questions/56467265/c-static-variable-in-function-performance/56467343#56467343", "title": "c++ static variable in function performance", "body": "<p>Having function-local static variables would ever so slightly penalize you. Since static values need to be initialized once, and only once, there has to be a flag which would be checked on every function execution, set to '<em>yes, please initialize</em>' before the function is entered first time and reset to '<em>no, please no longer initialize</em>' after such initialization has happened.</p>\n\n<p>Otherwise, compiler would have no way to guarantee you a single initialization.</p>\n\n<p>However, compiler guarantees you that once the variable has been initialized, no further initialization will take place, and the declaration will be skipped: <a href=\"https://en.cppreference.com/w/cpp/language/storage_duration#Static_local_variables\" rel=\"noreferrer\">https://en.cppreference.com/w/cpp/language/storage_duration#Static_local_variables</a></p>\n\n<p>We can look at a sample codegen to confirm this assumption with the compiler: <a href=\"https://gcc.godbolt.org/z/Q-Dni_\" rel=\"noreferrer\">https://gcc.godbolt.org/z/Q-Dni_</a> It is clear that if the variable is already initialized, a declaration is skipped and <code>k</code> is not called. Conclusion: your difference in time comes from somewhere else.</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559769746, "post_id": 56468080, "comment_id": 99527844, "body": "That&#39;s a fantastic find!"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1559769908, "last_edit_date": 1559769908, "creation_date": 1559769082, "answer_id": 56468080, "question_id": 56467265, "link": "https://stackoverflow.com/questions/56467265/c-static-variable-in-function-performance/56468080#56468080", "title": "c++ static variable in function performance", "body": "<p>From <a href=\"http://quick-bench.com/-AK4m84TYNLcI_7YFbz6AB7Mx1Y\" rel=\"nofollow noreferrer\">quick-bench</a></p>\n\n<p>It seems that <code>getDirect</code> is inlined contrary to <code>getFromMap</code>.</p>\n\n<p>Probably due to size of code to call <code>m[i]</code> in the initialization case.</p>\n\n<p>(version with <code>at</code> is even faster that your <code>getDirect</code> <a href=\"http://quick-bench.com/F-1UqQGHX7njMIEGJ5OkXDS-vy0\" rel=\"nofollow noreferrer\">Demo</a> :) )</p>\n"}], "owner": {"reputation": 89, "user_id": 11594134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594bb0552b0ed6696d63ff599639ea92?s=128&d=identicon&r=PG&f=1", "display_name": "user11594134", "link": "https://stackoverflow.com/users/11594134/user11594134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 56467343, "answer_count": 2, "score": 2, "last_activity_date": 1559769918, "creation_date": 1559765128, "last_edit_date": 1559769918, "question_id": 56467265, "link": "https://stackoverflow.com/questions/56467265/c-static-variable-in-function-performance", "title": "c++ static variable in function performance", "body": "<p>I am not quite familiar with static variable in a function in C++. I know it is only initialize once. e.g.</p>\n\n<pre><code>void func(map&lt;int, int&gt;&amp; m){\n   static int a = m[0];\n}\n</code></pre>\n\n<p>I would expect static int a = m[0] would only execute once when I first call the function, but it seems to me that every time I call the function, it cost some time to execute m[0]. Here is one test I do. the program itself does not make sense (it will always return the same number) but just want to show the performance as a example</p>\n\n<pre><code>    double getDirect(int i, map&lt;int, double&gt;&amp; m){\n    static double res = i;\n    return res;\n    }\n\n    double getFromMap(int i, map&lt;int, double&gt;&amp; m){\n    static double res = m[i];\n    return res;\n    }\n</code></pre>\n\n<p>in main function</p>\n\n<pre><code>clock_t t;\nt = clock();\nlong long i = 0;\nmap&lt;int, double&gt; m;\nfor(int i = 0; i &lt; 10; i++){\n    m.insert(make_pair(i, i));\n}\n#pragma omp parallel for private(i)\nfor(i = 0; i &lt; size; i++){\n    for(int j = 0; j &lt; 10; j++)\n        double res = getDirect(j, m);\n}\n\nt = clock()-t;\ncout &lt;&lt; \" It cost \" &lt;&lt; t &lt;&lt; \" clicks (\" &lt;&lt; ((float)t) / CLOCKS_PER_SEC &lt;&lt; \" sec) to run.\" &lt;&lt; endl;\n\nt = clock();\n#pragma omp parallel for private(i)\nfor(i = 0; i &lt; size; i++){\n    for(int j = 0; j &lt; 10; j++)\n        double res = getFromMap(j, m);        \n}\nt = clock()-t;\ncout &lt;&lt; \" It cost \" &lt;&lt; t &lt;&lt; \" clicks (\" &lt;&lt; ((float)t) / CLOCKS_PER_SEC &lt;&lt; \" sec) to run.\" &lt;&lt; endl;\n</code></pre>\n\n<p>I would expect the time between the two would be really similar. But the result is</p>\n\n<p>It cost 14055 clicks (14.055 sec) to run.\n It cost 150636 clicks (150.636 sec) to run.</p>\n\n<p>The getFromMap is much slower. Is this because m[i] is still executed every time? If not, what is the reason? If so, what is a good way to by-pass this performance cost? Thanks.</p>\n\n<p>Here is some follow up. I get the assembly code\\</p>\n\n<pre><code>    static double res = m[i];\n000000013F83D454  mov         eax,104h  \n000000013F83D459  mov         eax,eax  \n000000013F83D45B  mov         ecx,dword ptr [_tls_index (013F8503C8h)]  \n000000013F83D461  mov         rdx,qword ptr gs:[58h]  \n000000013F83D46A  mov         rcx,qword ptr [rdx+rcx*8]  \n000000013F83D46E  mov         eax,dword ptr [rax+rcx]  \n000000013F83D471  cmp         dword ptr [res+0Ch (013F85035Ch)],eax  \n000000013F83D477  jle         getFromMap+0A9h (013F83D4B9h)  \n000000013F83D479  lea         rcx,[res+0Ch (013F85035Ch)]  \n000000013F83D480  call        _Init_thread_header (013F831640h)  \n000000013F83D485  cmp         dword ptr [res+0Ch (013F85035Ch)],0FFFFFFFFh  \n000000013F83D48C  jne         getFromMap+0A9h (013F83D4B9h)  \n000000013F83D48E  lea         rdx,[i]  \n000000013F83D495  mov         rcx,qword ptr [m]  \n000000013F83D49C  call        std::map&lt;int,double,std::less&lt;int&gt;,std::allocator&lt;std::pair&lt;int const ,double&gt; &gt; &gt;::operator[] (013F831320h)  \n000000013F83D4A1  movsd       xmm0,mmword ptr [rax]  \n000000013F83D4A5  movsd       mmword ptr [res (013F850360h)],xmm0  \n000000013F83D4AD  lea         rcx,[res+0Ch (013F85035Ch)]  \n000000013F83D4B4  call        _Init_thread_footer (013F8314C4h)\n</code></pre>\n\n<p>It did seem that m[i] is still called after the first time. I also did a single thread test with a smaller size, but the difference is even larger (a ratio about 100).</p>\n\n<p>Any idea on how to set up visual studio 2012 so that it stops calling m[i] after the first time? Thanks so much for your help</p>\n"}, {"tags": ["c++", "casting", "auto"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559765239, "post_id": 56467239, "comment_id": 99526063, "body": "<code>auto</code> is used in declarations, not in expressions. That is why <code>auto</code> works for things like <code>auto i = 0;</code>, but not for things like <code>static_cast&lt;const auto&amp;&gt;(i)</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1559765330, "post_id": 56467239, "comment_id": 99526093, "body": "I can kind of see how <code>static_cast&lt;const auto&amp;&gt;</code> would be nice, but it is not needed.  You can just use <a href=\"https://en.cppreference.com/w/cpp/utility/as_const\" rel=\"nofollow noreferrer\"><code>std::as_const</code></a>.  Your last example can use <code>decltype(x)(x)</code> instead to get a copy."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1559765863, "post_id": 56467239, "comment_id": 99526310, "body": "I would expect the behaviour of <code>static_cast&lt;auto&amp;&amp;&gt;(x)</code> to depend only on the expression <code>x</code>, not the declaration of <code>x</code>. So I don&#39;t think it would be a good idea for it to do something like <code>std::forward&lt;decltype(x)&gt;(x)</code>."}, {"owner": {"reputation": 827, "user_id": 4399500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991872b06e2e7100b01c107e8816b18?s=128&d=identicon&r=PG&f=1", "display_name": "DanielS", "link": "https://stackoverflow.com/users/4399500/daniels"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559765919, "post_id": 56467239, "comment_id": 99526333, "body": "@SergeyA To my knowledge that is a very common way and is often used as a macro definition, see countless SE/SO posts. If you want to forward an expression, you can use <code>static_cast&lt;decltype(x)&amp;&amp;&gt;(x)</code>, which is even worse."}, {"owner": {"reputation": 827, "user_id": 4399500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991872b06e2e7100b01c107e8816b18?s=128&d=identicon&r=PG&f=1", "display_name": "DanielS", "link": "https://stackoverflow.com/users/4399500/daniels"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559766181, "post_id": 56467239, "comment_id": 99526437, "body": "@NathanOliver It is true that all these example uses can be achieved by other means. But on the other hand, shouldn&#39;t <code>auto</code> be consistent with regular types?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559766472, "post_id": 56467239, "comment_id": 99526555, "body": "Well, <code>auto</code> isn&#39;t a regular type, it&#39;s a place holder, like <code>T</code> in a template.  It needs to be initialized with something to get a type.  In <code>static_cast&lt;const auto&amp;&gt;</code>, the <code>&lt;const auto&amp;&gt;</code> part expects a type, but you can&#39;t have one since <code>auto</code> by itself is not a type.  It might be possible to adapt the language to get this to work but you would need to submit a paper and work out all of the mechanics of how the new way would work and how it won&#39;t break what already exists (C++ really likes its backwards compatibility)."}, {"owner": {"reputation": 827, "user_id": 4399500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991872b06e2e7100b01c107e8816b18?s=128&d=identicon&r=PG&f=1", "display_name": "DanielS", "link": "https://stackoverflow.com/users/4399500/daniels"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559766741, "post_id": 56467239, "comment_id": 99526671, "body": "@NathanOliver I kind of felt that there is probably a rationale as to why this wasn&#39;t allowed in the first place, seeing how it is so similar to <code>const auto&amp; ii = i;</code>"}, {"owner": {"reputation": 827, "user_id": 4399500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991872b06e2e7100b01c107e8816b18?s=128&d=identicon&r=PG&f=1", "display_name": "DanielS", "link": "https://stackoverflow.com/users/4399500/daniels"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559766835, "post_id": 56467239, "comment_id": 99526711, "body": "@SergeyA Sorry but did you read my reply? I said that my original version is widely used as a macro definition (which it is), and that <code>static_cast&lt;decltype(x)&amp;&amp;&gt;(x)</code> <i>can</i> be used instead."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559766945, "post_id": 56467239, "comment_id": 99526762, "body": "@DanielS this is true. I will remove my comments."}], "owner": {"reputation": 827, "user_id": 4399500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3991872b06e2e7100b01c107e8816b18?s=128&d=identicon&r=PG&f=1", "display_name": "DanielS", "link": "https://stackoverflow.com/users/4399500/daniels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 869, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559765013, "creation_date": 1559765013, "question_id": 56467239, "link": "https://stackoverflow.com/questions/56467239/c-auto-in-static-cast", "title": "C++ auto in static_cast", "body": "<p>The <code>auto</code> keyword can be used in many contexts and combined with other language elements, as in <code>const auto&amp;</code> or <code>auto&amp;&amp;</code>. However, it cannot be used in cast operations. Consider the following example (which does not compile):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;class T&gt; void foo(T&amp;&amp; t) {}\n\nint main() {\n    int i = 0;\n    foo(static_cast&lt;const auto&amp;&gt;(i)); // This could call foo(const int&amp;)\n}\n</code></pre>\n\n<p>The cast would obviously work with <code>int</code> instead of <code>auto</code>, but being able to use <code>auto</code> in casts would be useful in generic code, for instance:</p>\n\n<ul>\n<li>You could use <code>const auto&amp;</code> (as above) to explicitly call an overloaded function with a const lvalue ref.</li>\n<li>Similarly, you could use <code>static_cast&lt;auto&amp;&amp;&gt;</code> as a less verbose version of <code>std::forward&lt;decltype(x)&gt;(x)</code>.</li>\n<li>Thinking a bit further, <code>static_cast&lt;auto&gt;(x)</code> or something like <code>auto(x)</code> could be a way of explicitly copying an object.</li>\n</ul>\n\n<p><strong>(Note that explicit types instead of <code>auto</code> can be used in all these scenarios.)</strong></p>\n\n<p>To be honest, I intuitively expected this syntax to work (because it mirrors the way <code>auto</code> can be used in declarations), but to my mild surprise it didn't. Since it is such an obvious syntax, I am wondering whether there are specific reasons why it is disallowed? Or is it simply a case of nobody considering/proposing it as a feature?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559765518, "post_id": 56467246, "comment_id": 99526147, "body": "do you know where it is actually specified that <code>T</code> must have a <code>operator==</code>? I was looking for it on <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\">cppref</a> but other than in the possible implementation i didnt find where it is explicitly mentioned"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559765600, "post_id": 56467246, "comment_id": 99526188, "body": "maybe it is isimply implied by &quot;find searches for an element equal to value&quot;"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559765941, "post_id": 56467246, "comment_id": 99526342, "body": "@formerlyknownas_463035818: It&#39;s under [alg.find]: &quot;Returns: The first iterator i in the range [first, last) for which the following corresponding conditions hold: *i == value, pred(*i) != false [...] Returns last if no such iterator is found.&quot; <a href=\"http://eel.is/c++draft/alg.find#1.1\" rel=\"nofollow noreferrer\">link to standard draft</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559766147, "post_id": 56467246, "comment_id": 99526421, "body": "thank you. Usually cppref is rather accurate, so i guess &quot;equal to value&quot; is meant to be read as <code>*i == value</code>."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559766178, "post_id": 56467246, "comment_id": 99526435, "body": "So, to summarize. <code>T</code> doesn&#39;t necessarily need to have an <code>operator==</code>, but an <code>operator==</code> that compares the two types must be found by ADL. Which means we could define a free-standing <code>operator==</code> for two Person objects"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559766242, "post_id": 56467246, "comment_id": 99526458, "body": "@formerlyknownas_463035818: I usually keep the latest draft of the standard around for reference when I want to see the &quot;real&quot; rules (language-lawyer type stuff)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559766627, "post_id": 56467246, "comment_id": 99526624, "body": "thanks again, yes probably I should consult the standard more often, cppreference is awesome because it is written in simpler terms buts thats also a limitation"}], "tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": true, "score": 2, "last_activity_date": 1559765042, "creation_date": 1559765042, "answer_id": 56467246, "question_id": 56467157, "link": "https://stackoverflow.com/questions/56467157/find-elem-in-a-list-with-datatype-class/56467246#56467246", "title": "find elem in a list with datatype class", "body": "<p>C++ doesn't define an <code>==</code> for you. You need to tell it how to compare two <code>Person</code> objects for equivalence. The most straightforward way is to provide <code>operator==</code></p>\n\n<pre><code>class Person {\npublic:\n    int kontostand;\n    string email;\n    int alter;\n\n    Person(int kontostand_, string email_, int alter_)\n    {\n        kontostand = kontostand_;\n        email = email_;\n        alter = alter_;\n    }\n    bool operator==(const Person&amp; other) const\n    {\n        return other.kontostand == kontostand &amp;&amp;\n                other.email == email &amp;&amp;\n                other.alter == alter;\n    }\n};\n</code></pre>\n\n<h3><a href=\"https://wandbox.org/permlink/yeYjt1Jix7YpZlFn\" rel=\"nofollow noreferrer\">Demo</a></h3>\n\n<p>The other option is to use <a href=\"https://en.cppreference.com/w/cpp/algorithm/find\" rel=\"nofollow noreferrer\"><code>std::find_if</code></a> and provide your own comparator:</p>\n\n<pre><code> auto x = std::find_if(myPerson.begin(), myPerson.end(), [&amp;Kunde](const Person&amp; other){\n    return other.kontostand == Kunde.kontostand &amp;&amp;\n    other.email == Kunde.email &amp;&amp;\n    other.alter == Kunde.alter;});\n</code></pre>\n\n<h3><a href=\"https://wandbox.org/permlink/VBR2iomROLKMRsxK\" rel=\"nofollow noreferrer\">Demo 2</a></h3>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1559765123, "creation_date": 1559765123, "answer_id": 56467260, "question_id": 56467157, "link": "https://stackoverflow.com/questions/56467157/find-elem-in-a-list-with-datatype-class/56467260#56467260", "title": "find elem in a list with datatype class", "body": "<p><code>find</code> tries to compare elements in the list (how else could it tell if <code>Kunde</code> is in the lsit?) by using <code>==</code>. There is no <code>operator==</code> for <code>Person</code>, you need to define it. Something along the line of</p>\n\n<pre><code>class Person {\npublic:\n    int kontostand;\n    string email;\n    int alter;\n\n    Person(int kontostand, string email, int alter) : \n        kontostand(kontostand),\n        email(email),\n        alter(alter)\n    {}\n    bool operator==(const Person&amp; other) const {\n        return (kontostand == other.kontostand) \n            &amp;&amp; (email == other.email)\n            &amp;&amp; (alter == other.alter);\n    }\n};\n</code></pre>\n\n<p>Better use the initializer list for the constructor. In your code the memebrs are first default initialized and then you assign the values. With the initializer list the members are only initialized.</p>\n"}], "owner": {"reputation": 68, "user_id": 11409588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a016de13bd0b2f13d068dab879fde1c?s=128&d=identicon&r=PG&f=1", "display_name": "akameme", "link": "https://stackoverflow.com/users/11409588/akameme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56467246, "answer_count": 2, "score": 1, "last_activity_date": 1559765123, "creation_date": 1559764603, "last_edit_date": 1559764844, "question_id": 56467157, "link": "https://stackoverflow.com/questions/56467157/find-elem-in-a-list-with-datatype-class", "title": "find elem in a list with datatype class", "body": "<p>I have trouble to find a elem in a list </p>\n\n<p>i read the documentation for the find function and its all good for datatypes like \"int, string, etc. \" but when im using a class as: </p>\n\n<pre><code>list&lt;Person&gt; mylist \n</code></pre>\n\n<p>i got some issues. </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;list&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\n\nclass Person {\npublic:\n    int kontostand;\n    string email;\n    int alter;\n\n    Person(int kontostand_, string email_, int alter_)\n    {\n        kontostand = kontostand_;\n        email = email_;\n        alter = alter_;\n    }\n};\n\nint main()\n{\n\n    list&lt;Person&gt; myPerson;\n\n    Person Kunde(2, \"test\", 1);\n    Person Kunde2(3, \"test2\", 2);\n    myPerson.push_back(Kunde);\n    myPerson.push_back(Kunde2);\n\n    list&lt;Person&gt;::iterator x;\n\n        //troouble at this line\n    x = find(myPerson.begin(), myPerson.end(), Kunde);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>the result is: \"no match for 'operator=='(operand types are 'Person' and 'const Person')</p>\n\n<p>how to find the Element in a List ?</p>\n"}, {"tags": ["c#", "c++", "webassembly", "uno-platform"], "comments": [{"owner": {"reputation": 6413, "user_id": 5555803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4823cf23548ba1e4634ad67e78468e67?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Alikhanov", "link": "https://stackoverflow.com/users/5555803/orkhan-alikhanov"}, "edited": false, "score": 0, "creation_date": 1559763068, "post_id": 56466822, "comment_id": 99525170, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/dotnet/how-to-call-native-dlls-from-managed-code-using-pinvoke?view=vs-2019\" rel=\"nofollow noreferrer\">This</a> might be useful."}, {"owner": {"reputation": 161, "user_id": 4961485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204208428427146/picture?type=large", "display_name": "Stan Wijckmans", "link": "https://stackoverflow.com/users/4961485/stan-wijckmans"}, "reply_to_user": {"reputation": 6413, "user_id": 5555803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4823cf23548ba1e4634ad67e78468e67?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Alikhanov", "link": "https://stackoverflow.com/users/5555803/orkhan-alikhanov"}, "edited": false, "score": 0, "creation_date": 1559763893, "post_id": 56466822, "comment_id": 99525481, "body": "@OrkhanAlikhanov I don&#39;t think that&#39;s going to work. I don&#39;t really have a native dll: my C++ should also be wasm and run cross platform in the browser. And even if it would be a native dll then I doubt PInvoking is going to work, it&#39;s not the good old CLR afterall."}, {"owner": {"reputation": 161, "user_id": 4961485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204208428427146/picture?type=large", "display_name": "Stan Wijckmans", "link": "https://stackoverflow.com/users/4961485/stan-wijckmans"}, "reply_to_user": {"reputation": 6413, "user_id": 5555803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4823cf23548ba1e4634ad67e78468e67?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Alikhanov", "link": "https://stackoverflow.com/users/5555803/orkhan-alikhanov"}, "edited": false, "score": 0, "creation_date": 1559804656, "post_id": 56466822, "comment_id": 99535493, "body": "Ok @OrkhanAlikhanov, PInvoke does seem to be the way to go, but needs to be properly set up in the project first."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 4961485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204208428427146/picture?type=large", "display_name": "Stan Wijckmans", "link": "https://stackoverflow.com/users/4961485/stan-wijckmans"}, "edited": false, "score": 1, "creation_date": 1559804586, "post_id": 56467404, "comment_id": 99535468, "body": "Thanks, this is what I&#39;m looking for!"}], "tags": [], "owner": {"reputation": 4806, "user_id": 26346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce469a4b695184aa5e087d76db1d81e?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me Laban", "link": "https://stackoverflow.com/users/26346/j%c3%a9r%c3%b4me-laban"}, "is_accepted": true, "score": 7, "last_activity_date": 1559782549, "last_edit_date": 1559782549, "creation_date": 1559765817, "answer_id": 56467404, "question_id": 56466822, "link": "https://stackoverflow.com/questions/56466822/can-c-be-called-from-c-compiled-to-wasm/56467404#56467404", "title": "Can C++ be called from C# compiled to wasm?", "body": "<p>P/Invoke is supported since last month by the mono-wasm runtime, using two modes:</p>\n\n<ul>\n<li><a href=\"https://github.com/emscripten-core/emscripten/wiki/Linking\" rel=\"noreferrer\">Dynamic linking</a> of an arbitrary WebAssembly module, when running with the mono interpreter</li>\n<li>Static linking of LLVM bitcode files generated by prior emscripten invocations, when running under mono's AOT</li>\n</ul>\n\n<p>The latter is being worked on at the moment in the Uno.Wasm.Bootstrapper <a href=\"https://github.com/nventive/Uno.Wasm.Bootstrap/pull/94\" rel=\"noreferrer\">in this PR</a>.</p>\n\n<p>It has the exact same behavior another .NET runtime may have, which means that C++ cannot be access directly, and you'll have to expose a C API to be able to use it.</p>\n\n<p>There are some caveats with the use of C++, where the runtime needs to be forcibly included in the mono runtime's binaries, making it larger. This may change soon, since emscripten is moving to a full LLVM backend.</p>\n\n<p>Some documentation is for the Uno.Wasm.Bootstrapper is <a href=\"https://github.com/nventive/Uno.Wasm.Bootstrap#webassembly-module-linking-support\" rel=\"noreferrer\">available here</a>.</p>\n"}], "owner": {"reputation": 161, "user_id": 4961485, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204208428427146/picture?type=large", "display_name": "Stan Wijckmans", "link": "https://stackoverflow.com/users/4961485/stan-wijckmans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 4, "accepted_answer_id": 56467404, "answer_count": 1, "score": 9, "last_activity_date": 1563201046, "creation_date": 1559762832, "last_edit_date": 1563201046, "question_id": 56466822, "link": "https://stackoverflow.com/questions/56466822/can-c-be-called-from-c-compiled-to-wasm", "title": "Can C++ be called from C# compiled to wasm?", "body": "<p>Does anyone know if it's currently possible to call C++ from C# compiled to wasm (or an Uno Platform app to be more precise)?</p>\n\n<p>I'm fairly new to WebAssembly but I managed to compile a C++ function to wasm and call it from JavaScript.\nI also got the quick start project from Uno (which allows you to compile UWP apps written in C#/XAML to wasm and run them in the browser) running.</p>\n\n<p>I write both C# and C++ on a daily basis, but what I can't figure out is the \"interopping between 2 languages\" + WebAssembly combo.\nI assume I need to compile the code in both languages to 2 separate wasm files and then somehow link them together or load the C++ one at runtime.\nIs what I want to do even possible at all today?</p>\n\n<p>EDIT: To be clear: the idea is that all code is eventually compiled to wasm.</p>\n"}, {"tags": ["c++", "linux", "raspberry-pi", "eigen", "eigen3"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1559792881, "post_id": 56466668, "comment_id": 99532308, "body": "I bet if you build the Eigen library and your code with <code>-Wcast-align</code> it will produce some findings, especially when using <code>doubles</code>. For your code, I think you need to reduce it more. For example, I can&#39;t seem to find where things like <code>burner_array</code> and <code>token_double</code> are declared. You should be able to <code>cat test.cxx</code> and we should be able to run it. Also see <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1559793227, "post_id": 56466668, "comment_id": 99532353, "body": "One thing I will say, it is OK to store a double as an array of bytes like in <code>std::string alfa_str</code>. But you can&#39;t cast them to a <code>double</code> and compute on them. To compute with them you have to move them from the <code>string</code> to a <code>double</code> datatype; probably using a <code>memcpy</code>."}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1559804668, "post_id": 56466668, "comment_id": 99535498, "body": "I agree with @jww. You need to drastically reduce your code (it should be only a few lines necessary to reproduce the error). And for the Rasperry, also tell us what compiler and compilation options you are using!"}, {"owner": {"reputation": 9447, "user_id": 2899559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7b94e56f041fd09320f9763d82861af?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Ginsburg", "link": "https://stackoverflow.com/users/2899559/avi-ginsburg"}, "edited": false, "score": 0, "creation_date": 1559819540, "post_id": 56466668, "comment_id": 99542980, "body": "Did you try <a href=\"http://eigen.tuxfamily.org/dox-devel/group__TopicUnalignedArrayAssert.html#where\" rel=\"nofollow noreferrer\">this section</a> to help determine what part of your code is triggering the assertion?"}, {"owner": {"reputation": 11, "user_id": 11605683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mf_abvEkvHg/AAAAAAAAAAI/AAAAAAAAF90/T01jvJqFGtU/photo.jpg?sz=128", "display_name": "Jack O&#39;Neill", "link": "https://stackoverflow.com/users/11605683/jack-oneill"}, "reply_to_user": {"reputation": 9447, "user_id": 2899559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7b94e56f041fd09320f9763d82861af?s=128&d=identicon&r=PG&f=1", "display_name": "Avi Ginsburg", "link": "https://stackoverflow.com/users/2899559/avi-ginsburg"}, "edited": false, "score": 0, "creation_date": 1559831227, "post_id": 56466668, "comment_id": 99549870, "body": "Thanks for the help so far. I did follow through that link @AviGinsburg. I think I&#39;m using GCC 6.3 but am in the process of installing GCC 9 as we speak. Hopefully that will let me compile C++17? Also I will definitely look into reducing my code thanks"}, {"owner": {"reputation": 14588, "user_id": 6870253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7ce91530d2dddae7b9fc2bd828ed78?s=128&d=identicon&r=PG&f=1", "display_name": "chtz", "link": "https://stackoverflow.com/users/6870253/chtz"}, "edited": false, "score": 0, "creation_date": 1559836953, "post_id": 56466668, "comment_id": 99552936, "body": "gcc 6.x should be C++17 capable as well"}], "owner": {"reputation": 11, "user_id": 11605683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mf_abvEkvHg/AAAAAAAAAAI/AAAAAAAAF90/T01jvJqFGtU/photo.jpg?sz=128", "display_name": "Jack O&#39;Neill", "link": "https://stackoverflow.com/users/11605683/jack-oneill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559761992, "creation_date": 1559761992, "question_id": 56466668, "link": "https://stackoverflow.com/questions/56466668/eigen-library-matrix-alignment-error-when-running-code-on-the-raspberry-pi-but-n", "title": "Eigen library matrix alignment error when running code on the Raspberry Pi but not in Linux", "body": "<p>I'm writing some c++ code to be run on a Raspberry Pi, using the Eigen library to work with my arrays and matrices. The code I wrote works on Linux, but when I run it on the Raspberry Pi it throws this error:</p>\n\n<pre><code>Eigen::internal::matrix_array&lt;T, Size, MatrixOptions, Align&gt;::internal::matrix_array()\n[with T = double, int Size = 2, int MatrixOptions = 2, bool Align = true]:\nAssertion `(reinterpret_cast&lt;size_t&gt;(array) &amp; (sizemask)) == 0 &amp;&amp; \"this assertion\nis explained here: http://eigen.tuxfamily.org/dox-devel/group__TopicUnalignedArrayAssert.html\n     READ THIS WEB PAGE !!! ****\"' failed.\n</code></pre>\n\n<p>I read through the link given to me in the error and tried redefining the various definitions throughout my code by following its instructions to no avail. I am performing a large number of matrix operations and have been unable to determine where exactly things are going wrong. </p>\n\n<p>To keep things a lot less cluttered here are my class definitions, omitting everything except the function definitions:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class TileBlock{\npublic:\n    TileBlock();\n    TileBlock(REGION_BD &amp;region_bd, std::shared_ptr&lt;Tile&gt; linked_tile, int Hin);\n    TileBlock(REGION_BD &amp;REGION_BD, std::shared_ptr&lt;Tile&gt; linked_tile, int Hin,\n                        std::string alfa_str,\n                        std::string bta_str,\n                        std::string w_lower_str,\n                        std::string w_upper_str,\n                        std::string x_str,\n                        std::string w_str,\n                        std::string w_sol_str,\n\n                        std::string y_exit_str,\n                        std::string z_exit_str,\n                        std::string bta_smp_str,\n                        std::string alfa_sol_str,\n                        std::string alfa_smp_str,\n                        std::string w_smp_str,\n                        std::string x_smp_str);\n    ~TileBlock();\npublic:\n    void cbta();\n    void cbra(int idx_r_from,REGION_BD &amp;theRegion,double r_min,\n                long int N_REGION_TOTAL, Eigen::RowVectorXi&amp; region_target_2,\n                Eigen::RowVectorXi&amp; region_neighbors);\n    static int find_sample(Eigen::RowVectorXd&amp; ySmp, double y);\n\nprivate:\n    void cbta_s1(double w, double d,\n            Eigen::RowVectorXd&amp; xSmp,\n            Eigen::Matrix&lt;double,2,N_CBTA_W&gt;&amp; btaSmp,\n            Eigen::Matrix&lt;double,2,1&gt;&amp; returnMatrix);\n\n    void cbta_s2(double w, double d,\n            Eigen::RowVectorXd&amp; xSmp,\n            Eigen::Matrix&lt;double,2,N_CBTA_W&gt;&amp; btaSmp,\n            Eigen::Matrix&lt;double,2,1&gt;&amp; returnMatrix);\n\n    void interp_broken_seg(Eigen::RowVectorXd&amp; x_data,\n            Eigen::Matrix&lt;double,2,Eigen::Dynamic&gt;&amp; y_data,\n            Eigen::RowVectorXd&amp; x_interp,\n            Eigen::Matrix&lt;double,2,Eigen::Dynamic&gt;&amp; y_interp);\n\n    template &lt;typename Derived1, typename Derived2&gt;\n    void remove_inf_values(Eigen::MatrixBase&lt;Derived1&gt;&amp; v,\n            Eigen::MatrixBase&lt;Derived2&gt;&amp; returnMatrix);\n\n    template &lt;typename Derived_a, typename Derived_b&gt;\n    void find_zeros(Eigen::MatrixBase&lt;Derived_a&gt;&amp; fSmp,\n            Eigen::MatrixBase&lt;Derived_b&gt;&amp; returnMatrix);\n\n    double pi2pi(double x);\n\n};\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Tile{\npublic:\n    Tile(int H, Eigen::Matrix&lt;int,Eigen::Dynamic,4&gt; tile_vertices);\n    Tile(std::string traversal_type_str,\n         std::string traversal_faces_str,\n         std::string cell_xform_str,\n         std::string channel_data_str,\n         std::string cell_edge_str,\n         std::string cell_vertices_str,\n         std::string connectivity_str);\n    ~Tile();\npublic:\n\n    Eigen::Matrix&lt;int,Eigen::Dynamic,4&gt; channel_data;\n    Eigen::Matrix&lt;double,4,Eigen::Dynamic&gt; cell_vertices;\n    Eigen::Matrix&lt;int,Eigen::Dynamic,1&gt; traversal_type;\n    Eigen::Matrix&lt;int,Eigen::Dynamic,2&gt; cell_xform;\n    Eigen::Matrix&lt;int,Eigen::Dynamic,1&gt; traversal_faces;\n    Eigen::Matrix&lt;double,Eigen::Dynamic,4&gt; cell_edge;\n\n    std::shared_ptr&lt;TileBlock&gt; tile_block;\n\n    std::shared_ptr&lt;Eigen::SparseMatrix&lt;int,Eigen::RowMajor&gt;&gt; connectivity;\n\n    void set_tile_data(int, Eigen::Matrix&lt;int,Eigen::Dynamic,4&gt;);\n\n    void addTileBlock(REGION_BD &amp;region_bd, std::shared_ptr&lt;TileBlock&gt; this_tile, int H);\n\n    void setMatricesFromJSON(std::string traversal_type_str,\n                             std::string traversal_faces_str,\n                             std::string cell_xform_str,\n                             std::string channel_data_str,\n                             std::string cell_edge_str,\n                             std::string cell_vertices_str);\n\n    void setConnectivityFromJSON(std::string connectivity_str);\n\n};\n\n</code></pre>\n\n<p>Now, The following code snippet is where I believe I am running into trouble. It's located in the definition of the <code>setMatricesFromJSON</code> function:</p>\n\n<pre><code>    /******* cell_vertices_str *******/\n    temp_char_double[cell_vertices_str.size() +1];\n    strcpy(temp_char_double, cell_vertices_str.c_str());\n\n    burner_array.clear();\n    token_double = strtok (temp_char_double,\"[\");\n\n    counter = 0;\n    while (token_double != NULL)\n    {   \n        burner_array.push_back(token_double);\n        token_double = strtok (NULL, \"[\");\n        counter++;\n    }\n\n    ss.clear();\n    ss &lt;&lt; burner_array[0];\n\n    ss &gt;&gt; test_str;\n    n = std::count(test_str.begin(), test_str.end(), ',');\n    cell_vertices = Matrix4Xd::Zero(counter,n);\n    test_str.clear();\n    ss.clear();\n\n\n    for (size_t i = 0; i &lt; counter; i++)\n    {   \n        std::vector&lt;double&gt; ind_num_array;\n        char *token_double;\n        token_double = strtok (burner_array[i],\",]\");\n        int j = 0;\n        std::stringstream ss;\n        while (token_double != NULL)\n        {\n            ss.clear(); \n            ss &lt;&lt; token_double;\n            double temp_val;\n            ss &gt;&gt; temp_val;\n            ind_num_array.push_back(temp_val);\n            token_double = strtok (NULL, \",]\");\n            j++;\n        }\n\n        for (size_t k = 0; k &lt; j; k++)\n        {\n            this-&gt;cell_vertices(i,k) = ind_num_array[k];\n        }\n    }\n\n</code></pre>\n\n<p>The code runs on Linux with no problems. However, when I try to run it on my Raspberry Pi I receive the aforementioned error. I am also quite new to c++ and there is quite a lot of code I didn't include here since there is quite a lot of it and I want to be as precise as I can in my question. Thanks for any and all help you can give me! I've been trying to solve this issue for quite a while now.</p>\n"}, {"tags": ["c++", "compilation"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1559761978, "post_id": 56466648, "comment_id": 99524704, "body": "Ask yourself: If a <code>Test</code> contains a <code>Test</code>, when would you ever stop constructing <code>Test</code>&#39;s?"}, {"owner": {"reputation": 789, "user_id": 586262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/420fc762de5589a5f411931bdb86bbbc?s=128&d=identicon&r=PG&f=1", "display_name": "bladeWalker", "link": "https://stackoverflow.com/users/586262/bladewalker"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1559762185, "post_id": 56466648, "comment_id": 99524809, "body": "Question is not &quot;why self is not allowed&quot;. The question is &quot;why container of self is allowed?&quot;."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559762249, "post_id": 56466648, "comment_id": 99524835, "body": "The vector could be empty at first, so there wouldn&#39;t be a recursive construction. Adding an element to the vector would then again create a vector, but that one would be empty again at the beginning..."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 0, "creation_date": 1559762358, "post_id": 56466648, "comment_id": 99524873, "body": "The answer to the question is essentially equivalent to &quot;why a pointer of type <code>T</code> is allowed inside <code>T</code>?&quot;. Try to construct an <code>std::array&lt;T, 1&gt;</code> inside the <code>T</code> class."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559762360, "post_id": 56466648, "comment_id": 99524875, "body": "I don&#39;t agree on the duplicate. The duplicates obviously seems to be clear to OP, but she/he&#39;s wondering about the difference with containers!"}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559762384, "post_id": 56466648, "comment_id": 99524891, "body": "@Aconcagua agree. Voted to reopen."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1559762516, "post_id": 56466648, "comment_id": 99524938, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41913578/how-can-i-declare-a-member-vector-of-the-same-class\" title=\"how can i declare a member vector of the same class\">stackoverflow.com/questions/41913578/&hellip;</a>"}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559762622, "post_id": 56466648, "comment_id": 99524980, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 That seems to be the correct dupe."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559762672, "post_id": 56466648, "comment_id": 99524995, "body": "TLDR of the duplicate is that <code>std::vector</code> of incomplete type has been made explicitly legal in C++17 with the right allocator and the default allocator allows it."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 1, "creation_date": 1559762705, "post_id": 56466648, "comment_id": 99525008, "body": "@NikosC. I was overruled before having the chance to add it to the dupe links :-P"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559762937, "post_id": 56466648, "comment_id": 99525124, "body": "Could be worse. You could have been under-ruled. Remember &quot;Measure once, cut twice. Measure twice, cut once.&quot; And I think that&#39;s my moment of peak absurdity for today. It&#39;s all downhill from here."}], "owner": {"reputation": 789, "user_id": 586262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/420fc762de5589a5f411931bdb86bbbc?s=128&d=identicon&r=PG&f=1", "display_name": "bladeWalker", "link": "https://stackoverflow.com/users/586262/bladewalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "closed_date": 1559762591, "answer_count": 0, "score": 0, "last_activity_date": 1559762597, "creation_date": 1559761890, "question_id": 56466648, "link": "https://stackoverflow.com/questions/56466648/c-allows-member-container-of-self-type-but-not-member-object", "closed_reason": "Duplicate", "title": "C++ allows member container of self type but not member object?", "body": "<p>In the following sample code, C++ allows container of self class. But if a single object is created it's not allowed. I understand that class can have pointer to self type or static member object.</p>\n\n<p>But how is container of self (not self pointer) is allowed? How is compiler able to get 'complete definition' for vector members?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nclass Test {\n    std::vector&lt;Test&gt; list; //but this works\n    static Test t3; // this is allowed too\n    // Test t2; // definition of 'class Test' is not complete\n\npublic:\n    Test() {\n        std::cout &lt;&lt; \"Test()\" &lt;&lt;  std::endl;\n        std::cout &lt;&lt; list.size() &lt;&lt;  std::endl;\n    }\n\n};\n\nint main() {\n    Test t;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "stdvector"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1559761782, "post_id": 56466508, "comment_id": 99524622, "body": "dont do all at once. if you need to read numbers from a file and fill a vector then first do that until you know it works, only then move to the next point. Its not really clear what is the problem with your code btw. Do you get errors?"}, {"owner": {"reputation": 15, "user_id": 11544360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IsdduW7-e04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkxlvffPJ9hNv5QbBy2kogfGNalw/mo/photo.jpg?sz=128", "display_name": "kazimieras tamoliunas", "link": "https://stackoverflow.com/users/11544360/kazimieras-tamoliunas"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559763312, "post_id": 56466508, "comment_id": 99525253, "body": "readData() function works well and prints the array. I just want to know how to perfect operations with the array/vector that results or how for real assign the array to vector. I get errors all the time, the last one was that cpp didnt like + and * operations in the for loop."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1559763582, "post_id": 56466508, "comment_id": 99525365, "body": "@kazimierastamoliunas you declared your vector incorrectly, most of the errors will go away once you&#39;ve fixed that."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11544360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IsdduW7-e04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkxlvffPJ9hNv5QbBy2kogfGNalw/mo/photo.jpg?sz=128", "display_name": "kazimieras tamoliunas", "link": "https://stackoverflow.com/users/11544360/kazimieras-tamoliunas"}, "edited": false, "score": 0, "creation_date": 1559812702, "post_id": 56466884, "comment_id": 99539358, "body": "Seems reasonable, thank you very much!"}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": true, "score": 1, "last_activity_date": 1559763473, "last_edit_date": 1559763473, "creation_date": 1559763166, "answer_id": 56466884, "question_id": 56466508, "link": "https://stackoverflow.com/questions/56466508/how-to-assign-elements-to-a-vector/56466884#56466884", "title": "How to assign elements to a vector?", "body": "<p>This is wrong</p>\n\n<pre><code>std::vector&lt;int&gt; grader[SIZE];\n</code></pre>\n\n<p>that's an array of vectors which I'm sure is not what you want</p>\n\n<p>Try this</p>\n\n<pre><code>std::vector&lt;int&gt; grader(SIZE);\n</code></pre>\n\n<p>That's a vector of size <code>SIZE</code>. Once you've declared your vector in the correct way you can use it exactly like an array.</p>\n\n<p>This is wrong</p>\n\n<pre><code>for (f = 0; f &lt; SIZE; f += 15)\n{\n    for (int i = f + 4; i &lt; i + 3; i++)\n    {\n        x = 1 / AC * (A * (grader[i] + grader[i + 3] + grader[i + 6] + \n                           grader[i + 9]) + C * grader[i - 3]);\n        cout &lt;&lt; x &lt;&lt; \" \";\n    }\n}\n</code></pre>\n\n<p>when <code>f</code> equals <code>SIZE - 1</code>, <code>i</code> equals <code>f + 4</code> or <code>SIZE + 3</code>, so <code>grader[i]</code> will be an out-of-bounds access. This would be true whether <code>grader</code> was a vector or an array.</p>\n\n<p>This is wrong</p>\n\n<pre><code>for (int i = f + 4; i &lt; i + 3; i++)\n</code></pre>\n\n<p><code>i &lt; i + 3</code> is always true. So that's clearly not what you intended.</p>\n\n<p>Vectors are easy, your mistakes are either in the syntax, or completely unrelated to vectors.</p>\n"}], "owner": {"reputation": 15, "user_id": 11544360, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IsdduW7-e04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkxlvffPJ9hNv5QbBy2kogfGNalw/mo/photo.jpg?sz=128", "display_name": "kazimieras tamoliunas", "link": "https://stackoverflow.com/users/11544360/kazimieras-tamoliunas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1559763164, "accepted_answer_id": 56466884, "answer_count": 1, "score": 0, "last_activity_date": 1559763473, "creation_date": 1559761145, "last_edit_date": 1559762221, "question_id": 56466508, "link": "https://stackoverflow.com/questions/56466508/how-to-assign-elements-to-a-vector", "closed_reason": "Duplicate", "title": "How to assign elements to a vector?", "body": "<p>I can't understand how one can assign some sort of sequence (eg number sequence) from an external file into a <code>vector</code>/array. If it's just a couple of numbers then you just write them in brackets. What if you have 100000 numbers? I hope someone will be qualified enough to answer that.</p>\n\n<p>I need to write a script which would sum particular members of an array. The array is being extracted from one file and put in the other. However I need it more to be a <code>vector</code>, but I can't understand how it works. After I assign values and somehow initialise that <code>vector</code>, I also need to specify that <code>vector</code> members are numbers and then add them up.</p>\n\n<p>Adding procedure in main.</p>\n\n<p>These 2 for cycles should search for particular members of vector. So the first cycle as f = 0, i should add:</p>\n\n<p>x = 1 / AC * ( A * ( grader[4th member] +  grader[4 + 3 = 7th member] +  grader[4 + 6 = 10th member] +  grader[4 + 9 = 13th member] ) + C * grader[4 - 3 = 1st member] )</p>\n\n<p>then print it in the file + \" \" field separator, then</p>\n\n<p>x = 1 / AC * ( A * ( grader[5th member] +  grader[5 + 3 = 8th member] +  grader[5 + 6 = 11th member] +  grader[5 + 9 = 14th member] ) + C * grader[5 - 3 = 2nd member] )</p>\n\n<p>and finally</p>\n\n<p>x = 1 / AC * ( A * ( grader[6th member] +  grader[6 + 3 = 9th member] +  grader[6 + 6 = 12th member] +  grader[6 + 9 = 15th member] ) + C * grader[6 - 3 = 3nd member] )</p>\n\n<p>cout &lt;&lt; endl;</p>\n\n<p>Then the first for cycle should do the same just f should be 15 members up like this: f = 15, so i = 15 + 4 = 19</p>\n\n<p>x = 1 / AC * ( A * ( grader[19th member] +  grader[19 + 3 = 22th member] +  grader[4 + 6 = 10th member] +  grader[4 + 9 = 13th member] ) + C * grader[4 - 3 = 1st member] )</p>\n\n<p>and so on...</p>\n\n<p>P.S. I don't show input file because extracting procedure works. Somebody already helped me with that. Hopefully the code and the array will be sufficient.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;cmath&gt;\n#include &lt;set&gt;\n\nusing namespace std;\nconst double A = 2.66E-23, B = 4.65E-23, AC = 1.53E-22, c = 0;\nconst int SIZE = 360;\ndouble grades[SIZE];\nvoid readData()\n{\n    ifstream ifs;\n    ofstream ofs;\n    ifstream inFile(\"out.txt\", std::ifstream::in);\n    ofstream of(\"out1.txt\", std::ofstream::out);\n    streambuf* origBuf = cout.rdbuf();\n    cout.rdbuf(of.rdbuf());\n    //inFile.open(inFileName.c_str());\n    if (inFile.is_open())\n    {\n        std::string s; // to read 2 letters like Ti in your input after   edition\n\n        for (int i = 0; i &lt; SIZE; i++)\n        {\n            if ((i % 3) == 0)\n            {\n                if (!(inFile &gt;&gt; s))\n                {\n                    std::cerr &lt;&lt; std::endl\n                              &lt;&lt; \"error when reading letter(s) line \"\n                              &lt;&lt; (i / 3) + 1 &lt;&lt; std::endl;\n                    return;\n                }\n            }\n\n            if (!(inFile &gt;&gt; grades[i]))\n            {\n                std::cerr &lt;&lt; std::endl &lt;&lt; \"error when reading the \" &lt;&lt; i + 1\n                          &lt;&lt; \" nth double\" &lt;&lt; std::endl;\n                return;\n            }\n            std::cout &lt;&lt; grades[i] &lt;&lt; \" \";\n        }\n        cout &lt;&lt; endl;\n        // std::cout &lt;&lt; grades[i] &lt;&lt; \" \";\n\n    }\n    else\n    { //Error message   \n        std::cerr &lt;&lt; \"Can't find input file \" &lt;&lt; inFile &lt;&lt; std::endl;\n    }\n    cout.rdbuf(origBuf);\n    ifs.close();\n    ofs.close();\n    return;\n}\nint main()\n{\n    readData();\n    std::vector&lt;int&gt; grader[SIZE];\n    double x;\n    int f = SIZE;\n    for (f = 0; f &lt; SIZE; f += 15)\n    {\n        for (int i = f + 4; i &lt; i + 3; i++)\n        {\n            x = 1 / AC * (A * (grader[i] + grader[i + 3] + grader[i + 6] + \n                               grader[i + 9]) + C * grader[i - 3]);\n            cout &lt;&lt; x &lt;&lt; \" \";\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Array that I want to be a <code>vector</code>:</p>\n\n<p>3.07097 5.31908 5.50539 -3.37566 6.15709 4.24421 4.97241 6.00196 6.76656 -1.53792 5.17956 5.60283 4.9001 3.92165 5.40794 3.07098 4.6307 1.83512 3.64437 3.94783 0.573947 3.37567 3.7927 3.0963 3.71667 6.02814 1.93257 1.53791 4.77024 1.7377 1.23741 2.14326 5.50539 0.664021 1.46039 4.24421 0.932722 1.30525 6.76656 0.591709 3.5407 5.60283 2.77048 2.28278 5.40794 3.07098 0.344186 1.83512 3.37567 1.18219 0.573947 3.64437 1.02706 3.0963 1.53791 0.204662 1.93257 -0.591718 6.4091 1.7377 6.14195 0 5.50539 2.71164 7.30721 4.24421 7.02003 0.155135 6.76656 0.946195 6.20444 5.60283 5.25459 1.25791 5.40794 6.78321 2.48745 1.83512 5.90513 2.33231 0.573947 5.90513 2.64258 3.0963 7.67057 1.22954 1.93257 -0.946203 3.74536 1.7377 -2.47483 4.9749 20.1864 -1.59675 4.81976 18.9252 -1.59675 5.13003 21.4476 5.25459 3.71699 20.2838 -3.36219 6.2328 20.089 2.47482 4.9749 9.17565 1.59674 5.13003 10.4368 1.59674 4.81976 7.91448 3.36219 6.2328 9.0782 3.36219 3.71699 9.27307 1.23741 7.11816 20.1864 0.664017 6.43529 18.9252 0.932718 6.28015 21.4476 4.9001 1.05324 20.2838 2.77047 7.25768 20.089 -1.23742 2.83164 9.17565 -0.664026 3.51451 10.4368 -0.932727 3.66965 7.91448 -0.591714 1.4342 9.0782 5.8463 2.69211 9.27307 1.23741 2.83164 20.1864 0.932718 3.66965 18.9252 0.664017 3.51451 21.4476 2.77048 2.69211 20.2838 0.591714 1.4342 20.089 -1.23742 7.11816 9.17565 -0.932727 6.28015 10.4368 -0.664026 6.43529 7.91448 -2.77047 7.25768 9.0782 3.71668 1.05324 9.27307 5.5458 0.344186 12.8459 4.97241 1.02706 14.1071 5.24111 1.18219 11.5847 0.591709 6.4091 12.7485 7.07886 0.204662 12.9433 5.5458 4.6307 12.8459 5.24111 3.7927 14.1071 4.97241 3.94783 11.5847 -1.53792 4.77024 12.7485 4.9001 6.02814 12.9433 1.83357 2.48745 12.8459 2.71165 2.64258 14.1071 2.71165 2.33231 11.5847 0.946195 3.74536 12.7485 0.946199 1.22954 12.9433 2.47482 0 16.5162 -2.71164 7.30721 15.255 1.59674 0.155135 17.7773 -0.946203 6.20444 16.6136 3.36219 1.25791 16.4187 3.07097 5.31908 16.5162 3.37566 6.15709 15.255 3.64437 6.00196 17.7773 1.53791 5.17956 16.6136 3.71668 3.92165 16.4187 -1.23741 2.14326 16.5162 -0.664021 1.46039 15.255 7.68405 1.30525 17.7773 -0.591718 3.5407 16.6136 5.8463 2.28278 16.4187</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1559761282, "post_id": 56466498, "comment_id": 99524420, "body": "That code shouldn&#39;t compile. The line <code>int *p=&amp;a;</code> is not correctly typed."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1559761388, "post_id": 56466498, "comment_id": 99524460, "body": "If you want to print a pointer, you need format specifier <code>%p</code>, otherwise you invoke undefined behaviour. Until fixed, <i>anything</i> could happen..."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1559761500, "post_id": 56466498, "comment_id": 99524501, "body": "the code is giving me the following output ...it runs  @Brian"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1559761542, "post_id": 56466498, "comment_id": 99524518, "body": "<code>int *p=a;</code> Why? <code>&amp;a</code> is a <i>pointer-to-int</i> <code>[5]</code>, not <i>pointer-to-int</i>. See: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 4, "creation_date": 1559761572, "post_id": 56466498, "comment_id": 99524530, "body": "@gokulgoku: just because it runs with no <i>apparent</i> errors doesn&#39;t mean it&#39;s correct. You should have gotten at least a couple of warnings."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761644, "post_id": 56466498, "comment_id": 99524564, "body": "Still it contains undefined behaviour. On modern systems, it is pretty likely that pointer size is larger than unsigned int \u2013 so in best case, you&#39;re just cutting off part of address. In worst case, some part of the address might be interpreted as next argument. As said already, you invoke UB, anything could happen, your programme might crash, give bad output or even silently ignore and go on."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1559761881, "post_id": 56466498, "comment_id": 99524665, "body": "Arrays decay automatically to pointers when needed: <code>int* p = a;</code> is all you need. Taking the address of <code>a</code> results in another pointer type: <code>int(*p)[5] = &amp;a;</code> would be the correct one..."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761999, "post_id": 56466498, "comment_id": 99524714, "body": "@Aconcagua  i just cut off some part of the address for simplicity ...i didn&#39;t know there can some logic there too ...:)"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559762138, "post_id": 56466498, "comment_id": 99524786, "body": "@gokulgoku If you <i>want</i> to cut off, then do a cast: <code>printf(&quot;%u&quot;, (unsigned int)p);</code> and you are on the safe side."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559762811, "post_id": 56466498, "comment_id": 99525055, "body": "Rolled back. Changing <code>int *p=&amp;a;</code> to <code>int *p=a;</code> defeats the comments and attempts to answer your own question."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559763076, "post_id": 56466498, "comment_id": 99525176, "body": "@Aconcagua   thanks i got it...i have another doubt when we had 1 to &amp;a we reach to address after the end of the array ..so &amp;a+1 gives an address after the array a but why *(&amp;a+1) also give the same address"}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1559763271, "post_id": 56466498, "comment_id": 99525235, "body": "@WeatherVane actually i wanted answer for *p=a;  .. but i didn&#39;t notice that i wrote the code wrong until i got answers related to it ....that&#39;s why i edited it"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1559764859, "post_id": 56466498, "comment_id": 99525898, "body": "See also <a href=\"https://stackoverflow.com/questions/31087537/why-does-a-b-have-the-same-behavior-as-a-b/31088592#31088592\" title=\"why does a b have the same behavior as a b\">stackoverflow.com/questions/31087537/&hellip;</a> ."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559767806, "post_id": 56466498, "comment_id": 99527145, "body": "@gokulgoku <code>&amp;a + 1</code> results in the same address as <code>(char*)a + sizeof(a)</code>, just because this is the nature of incrementing a pointer by 1. Then with <code>&amp;a+1</code>, you get a pointer to an array of size 5. If you now dereference this pointer, you get (as the array decays!) a pointer to this arrays&#39; first element. But the address of the array itself and the address of its first element are always the same (similarly as in C \u2013 but not in C++ \u2013 the first member of a struct has always the same address as the struct itself)."}, {"owner": {"reputation": 12572, "user_id": 8534008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2af9937cac66f08b6ee6e4219cc0d?s=128&d=identicon&r=PG&f=1", "display_name": "GBlodgett", "link": "https://stackoverflow.com/users/8534008/gblodgett"}, "edited": false, "score": 0, "creation_date": 1559775314, "post_id": 56466498, "comment_id": 99529458, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4445706/post-increment-and-pre-increment-concept\">Post-increment and Pre-increment concept?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559761668, "post_id": 56466533, "comment_id": 99524576, "body": "even if i change it to int *p=a;   why am i getting the same output?"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559761806, "post_id": 56466533, "comment_id": 99524632, "body": "@gokulgoku Added a paragraph in the answer explaining it."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559762828, "post_id": 56466533, "comment_id": 99525064, "body": "thanks i got it...i have another doubt when we had 1 to &amp;a we reach to address after the end of the array ..so &amp;a+1 gives an address after the array a but why *(&amp;a+1) also give the same address"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559763073, "post_id": 56466533, "comment_id": 99525173, "body": "@gokulgoku That&#39;s because <code>*(&amp;a + 1)</code> is equal to <code>(&amp;a)[1]</code>, and the type of that is an array (of five <code>int</code>). And as any array it <i>decay</i> to a pointer to its first element. It&#39;s the same decay that happens for <code>a</code>."}, {"owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559764089, "post_id": 56466533, "comment_id": 99525566, "body": "well i tried hard but i couldn&#39;t understand it can you please help me to understand it better ...thanks!!"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "edited": false, "score": 0, "creation_date": 1559765072, "post_id": 56466533, "comment_id": 99525989, "body": "@gokulgoku I feel it&#39;s starting to get off-topic for this question now, but I&#39;ve updated with more information that hopefully should help you understand what&#39;s going on."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1559765025, "last_edit_date": 1559765025, "creation_date": 1559761290, "answer_id": 56466533, "question_id": 56466498, "link": "https://stackoverflow.com/questions/56466498/why-a-pointer-value-is-assigned-before-the-increment-operation-is-performed/56466533#56466533", "title": "why a pointer value is assigned before the increment operation is performed", "body": "<p>There seems to be some misunderstanding in how pointers and arrays work together.</p>\n\n<p>The expression <code>&amp;a</code> is a pointer to the array itself, and has the type <code>int (*)[5]</code>.</p>\n\n<p>What you seem to expect is to get a pointer to the first element, which would be <code>&amp;a[0]</code>, or plain <code>a</code> (as that decays to a pointer to the arrays first element):</p>\n\n<pre><code>int *p = a;\n</code></pre>\n\n<p>That it works is not a coincidence, because a pointer to the array just happens to point to the same address as the location of the first element. The addresses are equal, but the types of <code>&amp;a</code> and <code>&amp;a[0]</code> are different. This semantic difference really is crucial.</p>\n\n<hr>\n\n<p>Regarding the issue about the <code>++</code> operator, it's simply how it works.</p>\n\n<p>The result of the suffix increase or decrease operators is the <em>old</em> value. So when you do <code>p++</code> you get the <em>old</em> pointer, before the increase.</p>\n\n<p>If we take</p>\n\n<pre><code>i = *p++;\n</code></pre>\n\n<p>it's (somewhat simplified) equivalent to</p>\n\n<pre><code>int *temporary_old_p = p;\np = p + 1;\ni = *temporary_old_p;\n</code></pre>\n\n<hr>\n\n<p>Furthermore, the <code>\"%u\"</code> format for a pointer is invalid. To print a <code>void *</code> pointer (a cast is really needed to be correct) you should use the <code>\"%p\"</code> format specifier.</p>\n\n<p>Mismatching format-specifier and argument type leads to <em>undefined behavior</em>.</p>\n\n<hr>\n\n<p>Regarding the problem with <code>*(&amp;a + 1)</code>, lets draw the array <code>a</code> how it looks in memory, with a few arrows to show pointers:</p>\n\n<pre>\n+------+------+------+------+------+------\n| a[0] | a[1] | a[2] | a[3] | a[4] | ....\n+------+------+------+------+------+------\n^                                  ^\n|                                  |\n&a[0]                              |\n|                                  |\n&a                                 &a + 1\n</pre>\n\n<p>Since the type of <code>&amp;a</code> is <code>int (*)[5]</code>, then it follows that the type of <code>&amp;a + 1</code> should also be <code>int (*)[5]</code>.</p>\n\n<p>If we dereference the pointer <code>&amp;a</code> (as in <code>*(&amp;a)</code>) then we get the actual array <code>a</code>. Arrays, like <code>a</code>, decay to a pointer to its first element, <code>&amp;a[0]</code>. This pointer is pointing to the same location as <code>&amp;a</code> (as shown in the \"drawing\" above).</p>\n\n<p>If we change <code>&amp;a</code> to <code>&amp;a + 1</code>, then we get <code>*(&amp;a + 1)</code> in the dereference. It's the \"second\" array (is it existed). Just like <code>*(&amp;a)</code> is an array of five <code>int</code>, so is <code>*(&amp;a + 1)</code>. This array decays to a pointer to its first element <code>&amp;(*(&amp;a + 1))[0]</code>.</p>\n\n<p>Or perhaps think that <code>&amp;a</code> is equal to <code>&amp;a + 0</code>. Then it would be easy to see that <code>*(&amp;a)</code> would be equal to <code>*(&amp;a + 0)</code>. And we know that <code>*(&amp;a)</code> is equal to <code>a</code> which is equal to <code>&amp;a[0]</code>, which also means that <code>*(&amp;a + 0)</code> have to be equal to <code>&amp;(*(&amp;a + 0))[0]</code>. That should make it easy to see what <code>&amp;(*(&amp;a + 1))[0]</code> might be.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 8, "last_activity_date": 1559761414, "creation_date": 1559761414, "answer_id": 56466555, "question_id": 56466498, "link": "https://stackoverflow.com/questions/56466498/why-a-pointer-value-is-assigned-before-the-increment-operation-is-performed/56466555#56466555", "title": "why a pointer value is assigned before the increment operation is performed", "body": "<p>The semantics of the postfix <code>++</code> operator are that the expression <code>p++</code> evaluates to the <em>current</em> value of <code>p</code>, and as a <em>side effect</em> <code>p</code> is incremented.  Effectively, <code>i = *p++;</code> is the same as</p>\n\n<pre><code>i = *p;\np++;\n</code></pre>\n\n<p>The semantics of the <em>prefix</em> <code>++</code> operator are that the expression evaluates to the current value of <code>p</code> <em>plus one</em>, and as a side effect <code>p</code> is incremented.  <code>i = *++p;</code> would effectively be the same as</p>\n\n<pre><code>i = *(p + 1);\np++;\n</code></pre>\n\n<p>Precedence <em>does not</em> control order of evaluation - it only controls parsing (which operators are grouped with which operands).  </p>\n"}], "owner": {"reputation": 33, "user_id": 10852641, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q_0Ee9_ZX-k/AAAAAAAAAAI/AAAAAAAAARA/WG9XqlOP9-Y/photo.jpg?sz=128", "display_name": "gokul goku", "link": "https://stackoverflow.com/users/10852641/gokul-goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 56466533, "answer_count": 2, "score": 0, "last_activity_date": 1559765078, "creation_date": 1559761108, "last_edit_date": 1559765078, "question_id": 56466498, "link": "https://stackoverflow.com/questions/56466498/why-a-pointer-value-is-assigned-before-the-increment-operation-is-performed", "title": "why a pointer value is assigned before the increment operation is performed", "body": "<p>Why does <code>*p++</code> first assign the value to <code>i</code> and then increment the <code>p</code> pointer, even though <code>++</code> post-increment has a higher precedence, and associativity is from Right-to-Left?</p>\n\n<pre><code>int main()\n{\n    int a[]={55,66,25,35,45};\n    int i;\n    int *p=&amp;a;\n    printf(\"%u \\n\",p);\n    i=*p++;\n    printf(\" %u  %d\",p,i);\n    printf(\"\\n %d\",*p);\n\n    return 0;\n}\n</code></pre>\n\n<pre>\n4056\n4060 55\n66\n</pre>\n"}, {"tags": ["c++", "c++11", "stl"], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1559761289, "post_id": 56466515, "comment_id": 99524423, "body": "Even better use <code>RegistrationMap::value_type</code> instead of using <code>std::pair</code> explicitly"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 3, "last_activity_date": 1559761166, "creation_date": 1559761166, "answer_id": 56466515, "question_id": 56466369, "link": "https://stackoverflow.com/questions/56466369/create-a-set-difference-vector-from-two-maps/56466515#56466515", "title": "Create a set_difference vector from two maps", "body": "<p><code>std::set_difference</code> can write its output to any output iterator, so there is no problem with writing the output into a vector:</p>\n\n<pre><code>std::vector&lt;std::pair&lt;int, Info&gt;&gt; redundantRegs;\nstd::set_difference(map1.begin(), map1.end(), map2.begin(), map2.end(),\n                    std::back_inserter(redundantRegs),\n                    ...);\n</code></pre>\n\n<p>(Note: In your comparator, change <code>std::pair&lt;int, Info&gt;</code> to <code>std::pair&lt;const int, Info&gt;</code> to avoid unnecessary copies.)</p>\n"}, {"tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 2, "last_activity_date": 1559762051, "last_edit_date": 1559762051, "creation_date": 1559761792, "answer_id": 56466632, "question_id": 56466369, "link": "https://stackoverflow.com/questions/56466369/create-a-set-difference-vector-from-two-maps/56466632#56466632", "title": "Create a set_difference vector from two maps", "body": "<p>You can use <code>std::set_difference</code> but instead of <code>std::inserter</code> you better use <code>std::back_inserter</code> as that is most efficient on <code>std::vector</code>, and create <code>std::vector</code> accordingly:</p>\n\n<pre><code>std::vector&lt;RegistrationMap::value_type&gt; redundantRegs;;\nstd::set_difference(map1.begin(), map1.end(), map2.begin(), map2.end(), \n                    std::back_inserter(redundantRegs) );\n</code></pre>\n\n<p>Note: in the way you wrote it you do not need to write comparator explicitly, default one will work just fine. If you do not use default one, you better get it from the <code>std::map</code> using <code>std::map::value_comp()</code> instead of writing it explicitly as sorting criteria must match for map and <code>std::set_difference</code>:</p>\n\n<pre><code>std::set_difference(map1.begin(), map1.end(), map2.begin(), map2.end(), \n                    std::back_inserter(redundantRegs),\n                    map1.value_comp() );\n</code></pre>\n\n<p><a href=\"https://ideone.com/lrYI61\" rel=\"nofollow noreferrer\">Live example</a></p>\n"}], "owner": {"reputation": 5541, "user_id": 9967571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EwjwT.png?s=128&g=1", "display_name": "jignatius", "link": "https://stackoverflow.com/users/9967571/jignatius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 56466515, "answer_count": 2, "score": 3, "last_activity_date": 1559762051, "creation_date": 1559760544, "question_id": 56466369, "link": "https://stackoverflow.com/questions/56466369/create-a-set-difference-vector-from-two-maps", "title": "Create a set_difference vector from two maps", "body": "<p>Currently I am getting the set difference of two maps and then iterating through the resulting map.</p>\n\n<p>Ideally I want to create a vector of the difference instead of a map. That way I iterate more efficiently.</p>\n\n<pre><code>typedef std::map&lt;int, Info&gt; RegistrationMap;\n\nRegistrationMap redundantRegs;\nstd::set_difference(map1.begin(), map1.end(), map2.begin(), map2.end(), \nstd::inserter(redundantRegs, redundantRegs.begin()),\n    [](const std::pair&lt;int, Info&gt; &amp;p1, const std::pair&lt;int, Info&gt; &amp;p2 {return p1.first &lt; p2.first;});\n\nfor (auto reg : redundantRegs)\n{\n    map2[hiu.first].Status = \"delete\";\n}\n</code></pre>\n\n<p>How would you create a vector of the set difference instead? Can this be done within the set_difference function?</p>\n\n<p>I'm looking for the most efficient way possible of getting the difference.</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1559760608, "post_id": 56466338, "comment_id": 99524131, "body": "Related : <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three/4172724#4172724\">Rule of 3/5/0</a>. <code>operator+</code> returns a copy of <code>temp1</code> and your compiler generated copy constructor will not do the right thing. Your operators are technically fine, though <code>operator+</code> should be <code>const</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559762639, "post_id": 56466338, "comment_id": 99524985, "body": "Since this is C++, don&#39;t use <code>calloc</code>, instead <code>std::tuple</code> or <code>std::array</code>. If this is a 3D vector, maybe just declare <code>double x, y, z</code> and be done with it."}, {"owner": {"reputation": 25, "user_id": 7321403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e3913507b342dd3f6c39c202c92951?s=128&d=identicon&r=PG&f=1", "display_name": "herhor67", "link": "https://stackoverflow.com/users/7321403/herhor67"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559772071, "post_id": 56466338, "comment_id": 99528672, "body": "Thanks Francois, I&#39;ll give it a try.  Thanks @tadman, will replace calloc. Can&#39;t change vector though, this is sample task for my test, and I want to do it precisely."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1559772990, "post_id": 56466338, "comment_id": 99528931, "body": "@herhor67 That&#39;s why I suggested <code>x,y,z</code> as those are more meaningful names. You could also do a simple non-dynamic array: <code>double arr[3]</code>. There&#39;s zero point to the dynamic part here, it just over-complicates things. If you were doing it C++ style you&#39;d actually do <code>double* arr = new double[3]</code> but that&#39;s still over-complicating it, just in a more C++ way."}], "owner": {"reputation": 25, "user_id": 7321403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e3913507b342dd3f6c39c202c92951?s=128&d=identicon&r=PG&f=1", "display_name": "herhor67", "link": "https://stackoverflow.com/users/7321403/herhor67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1559760689, "answer_count": 0, "score": 0, "last_activity_date": 1559760499, "creation_date": 1559760373, "last_edit_date": 1559760499, "question_id": 56466338, "link": "https://stackoverflow.com/questions/56466338/how-to-make-and-overload-so-that-sum-ab-works", "closed_reason": "Duplicate", "title": "How to make = and + overload so that &quot;sum=a+b&quot; works", "body": "<p>I need to overload assignment and addition operators of my class, so that sum = a+c works.</p>\n\n<p>a=b works, a+=b works, a=b=c works, but the sum crashes every time. Only possible solution I found, was to create new class that will wait with the addition, but is it really working and the easiest way?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>class v3d {\npublic:\n    double* arr;\n    v3d() {\n        arr = (double*)calloc(3, sizeof(double));\n    }\n    ~v3d() {\n        free(arr);\n    }\n    v3d operator + (const v3d&amp; b)\n    {\n        v3d temp1;\n        temp1.arr[0] = arr[0] + b.arr[0];\n        temp1.arr[1] = arr[1] + b.arr[1];\n        temp1.arr[2] = arr[2] + b.arr[2];\n        return temp1;\n    }\n    v3d&amp; operator = (const v3d&amp; b)\n    {\n        this-&gt;arr[0] = b.arr[0];\n        this-&gt;arr[1] = b.arr[1];\n        this-&gt;arr[2] = b.arr[2];\n        return *this;\n    }\n};\n\nint main()\n{\n    v3d a, b, sum;\n    // set a and b to some values\n\n    sum = a + b;\n    // print sum\n}\n</code></pre>\n\n<p>I expect it to add both vectors and assign result to sum.\nVS shows such error:\n<code>HEAP[vector3d.exe]: Invalid address specified to RtlValidateHeap( 003B0000, 003DE448 )</code>\nThanks in advance.</p>\n"}, {"tags": ["c++", "gcc", "clang", "intrinsics", "avx2"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 4, "creation_date": 1559760742, "post_id": 56466300, "comment_id": 99524190, "body": "Usually when I have a block of code with different compilation options, I put it in a different file and configure that one file to have the special options."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559760926, "post_id": 56466300, "comment_id": 99524269, "body": "I thought there might be some syntactic sugar like <code>#pragma diagnostic push</code> / <code>pop</code> the warnings."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1559761611, "post_id": 56466300, "comment_id": 99524546, "body": "Could be, but few <code>pragma</code>s are portable between compilers. The relationship between GCC and clang is friendlier than most, so you might get lucky. I try to avoid luck. It just causes problems in the future."}], "answers": [{"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1559777275, "post_id": 56467633, "comment_id": 99529828, "body": "More importantly, a function can&#39;t inline into a caller with different target attributes (even with link-time optimization), so only use this on &quot;large enough&quot; functions, not single-vector helper functions."}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559802776, "post_id": 56467633, "comment_id": 99534707, "body": "@PeterCordes <code>can&#39;t inline into a caller with different target attributes</code> Why not lineable? That&#39;s such a bummer. Because we can protect user machine with <code>__get_cpuid()</code> by ourselves anyway. It&#39;s weird because not inlining-able like this seems not like C-style at all. This is kind of overprotective. What if I write with hand written asm block? Will they compile?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1559802976, "post_id": 56467633, "comment_id": 99534794, "body": "@sandthorn: It&#39;s a missed optimization that <code>if(supports_AVX2) { avx2_version(); }</code> can&#39;t inline.  Within a single function, gcc / clang doesn&#39;t know how to optimize while still making sure that no AVX2 instructions run <i>outside</i> of that condition.  e.g. if you had multiple <code>if(AVX2)</code> blocks, normal optimization might hoist a load out of them and do it before, for reuse across multiple blocks."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1559803150, "post_id": 56467633, "comment_id": 99534866, "body": "@sandthorn: you can&#39;t safely use <code>if (__get_cpuid(...) == ...) { some avx2 intrinsics; }</code> because you can only compile a function containing that if you use <code>-mavx2</code> or a target option.  So that gives the compiler freedom to use AVX2 instructions <i>anywhere</i> in the function.  The only way to get finer grained would be inline asm (the compiler doesn&#39;t know anything about what you put in inline asm, and the assembler doesn&#39;t do target-checking)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559803199, "post_id": 56467633, "comment_id": 99534885, "body": "But don&#39;t actually use inline asm; <b>normally the right solution is to make separate versions of the function containing the long-running loop</b>, and dispatch to it via function pointers.  That makes sure that you&#39;re not branching on target options <i>inside</i> a tight loop.  This makes sure the compiler is able to fully optimize the whole function containing the whole hot loop for the target microarch you care about, e.g. Nehalem vs. Sandybridge vs. Haswell vs. Ryzen vs. Bulldozer vs. low-power Silvermont vs. baseline fallback with just SSE2 <code>tune=generic</code>"}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559803331, "post_id": 56467633, "comment_id": 99534937, "body": "@PeterCordes <code>because you can only compile a function containing that if you use -mavx2</code> That&#39;s exact limitation point in my question. Why can&#39;t we expose some specific features only in certain lines of code?"}, {"owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559803563, "post_id": 56467633, "comment_id": 99535011, "body": "@PeterCordes <b>&quot;normally the right solution is to make separate versions of the function containing the long-running loop, , and dispatch to it via function pointers. That makes sure that you&#39;re not branching on target options inside a tight loop.&quot;</b> is such a very good general guideline. superb."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "edited": false, "score": 1, "creation_date": 1559803563, "post_id": 56467633, "comment_id": 99535012, "body": "@sandthorn: Why? because gcc/clang have the limitation of only doing this at function granularity. Like I said this is normally totally fine and what you want anyway (to take target branching out of hot loops).  If you want to improve gcc by submitting a patch that lets it inline and optimize while keeping track of target options, go right ahead.  I expect it would be a huge amount of work, but sure maybe it would let GCC hoist an <code>if(AVX2)</code> out of a loop and let get efficient machine code from C source that &quot;looks&quot; really inefficient (with dispatch inside hot loops) instead of the normal way."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559803606, "post_id": 56467633, "comment_id": 99535032, "body": "xD, oh you posted that &quot;why?&quot; question before reading my last comment where I described the existing efficient way."}], "tags": [], "owner": {"reputation": 1829, "user_id": 3601420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuFHu.png?s=128&g=1", "display_name": "Functino", "link": "https://stackoverflow.com/users/3601420/functino"}, "is_accepted": true, "score": 3, "last_activity_date": 1559766894, "creation_date": 1559766894, "answer_id": 56467633, "question_id": 56466300, "link": "https://stackoverflow.com/questions/56466300/how-to-turn-on-mavx2-for-only-particular-part-of-source-code/56467633#56467633", "title": "How to turn on -mavx2 for only particular part of source code?", "body": "<p>Try <code>__attribute__((target(\"avx2\")))</code>. Both <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Function-Attributes.html#index-target-function-attribute\" rel=\"nofollow noreferrer\">GCC</a> and <a href=\"https://clang.llvm.org/docs/AttributeReference.html#target\" rel=\"nofollow noreferrer\">Clang</a> support it.</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;immintrin.h&gt;\n\n__attribute__((target(\"avx2\")))\nint add_with_avx2(int a, int b) {\n    __m256i av = _mm256_set_epi32(a, 0, 0, 0, 0, 0, 0, 0);\n    __m256i bv = _mm256_set_epi32(b, 0, 0, 0, 0, 0, 0, 0);\n    __m256i result = _mm256_add_epi32(av, bv);\n    return ((int*)&amp;result)[7];\n}\n\nint main(void) {\n    return add_with_avx2(5, 6);\n}\n</code></pre>\n\n<p>However, it's probably a better idea to put the functions that need intrinsics in a seperate file, in case you ever need to use a compiler that doesn't have this feature.</p>\n"}], "owner": {"reputation": 2332, "user_id": 6370128, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/bab55197dff82f919cd8e4ddbdd81d79?s=128&d=identicon&r=PG&f=1", "display_name": "sandthorn", "link": "https://stackoverflow.com/users/6370128/sandthorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 1, "accepted_answer_id": 56467633, "answer_count": 1, "score": 2, "last_activity_date": 1559790855, "creation_date": 1559760159, "last_edit_date": 1559790855, "question_id": 56466300, "link": "https://stackoverflow.com/questions/56466300/how-to-turn-on-mavx2-for-only-particular-part-of-source-code", "title": "How to turn on -mavx2 for only particular part of source code?", "body": "<p>Could I force compiler to compile some intrinsic functions outside <code>-march</code> setting in some particular part of code? </p>\n\n<p>Of course, the rest would remain within <code>-march</code> setting.</p>\n\n<p>Is it possible to enable <code>-mavx2</code> on only specific part of source code?</p>\n\n<p>Or is the only way that I must compile <code>-mavx2</code> section separately?</p>\n"}, {"tags": ["c++", "if-constexpr"], "comments": [{"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 2, "creation_date": 1559760258, "post_id": 56466282, "comment_id": 99523979, "body": "Add an static assert"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 3, "creation_date": 1559760358, "post_id": 56466282, "comment_id": 99524022, "body": "<code>if constexpr</code> doesn&#39;t make sense here.  <code>static_assert(std::is_integral_v&lt;T&gt;)</code> seems like it would be a simpler approach."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 1, "creation_date": 1559760516, "post_id": 56466282, "comment_id": 99524077, "body": "@MilesBudnek <i>&quot;if none of my if constexprs match&quot;</i> This implies OP has several <code>if constexpr</code>s chained in their actual code."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559760592, "post_id": 56466282, "comment_id": 99524120, "body": "Having multiple type-checks like that is not considered good code, and could even be a sign of bad design. Perhaps you should consider overloading or specialization instead?"}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559761426, "post_id": 56466282, "comment_id": 99524473, "body": "@Some How is it considered not good code? By whom? This is just another way of writing a series of template specialisations for a fixed set of types. You could even argue this is a more natural expression of the concept (it&#39;s not entirely equivalent though)."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1559763271, "post_id": 56466282, "comment_id": 99525236, "body": "@rubenvb It can quickly become a very tangled mess that is hard to read, understand and maintain. In C++ there are cleaner and simpler solutions to overcome or work around the lack of introspection in the language."}], "answers": [{"tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 11, "last_activity_date": 1559761136, "last_edit_date": 1559761136, "creation_date": 1559760472, "answer_id": 56466352, "question_id": 56466282, "link": "https://stackoverflow.com/questions/56466282/stop-compilation-if-if-constexpr-does-not-match/56466352#56466352", "title": "Stop compilation if `if constexpr` does not match", "body": "<p>The soltuion is to use <code>static_assert</code>.</p>\n\n<p>But we can't simply do <code>static_assert(false, \"whatever\");</code> in the <code>else</code> branch, because since the condition doesn't depend on the template parameter, assertion might fire early (when the compiler first sees your function body, even if the <code>else</code> branch is never actually taken).</p>\n\n<p>The condition of <code>static_assert</code> has to somehow depend on <code>T</code>, to delay the assertion check until your template is instantinated.</p>\n\n<p>This is what I've been using:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;auto A, typename...&gt; auto value = A;\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>if constexpr (foo)\n{\n    ...\n}\nelse if constexpr (bar)\n{\n    ...\n}\nelse\n{\n    static_assert(value&lt;false, T&gt;, \"Invalid template parameter.\");\n}\n</code></pre>\n\n<hr>\n\n<p>Note that if you only have <strong>one</strong> <code>if constexpr</code> (rather than an <code>if</code> <code>else if</code> chain), then none of that is needed.</p>\n\n<p>Simply move the condition from <code>if</code> to a <code>static_assert</code> and remove the <code>if</code>.</p>\n"}], "owner": {"reputation": 1241, "user_id": 778278, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cdb404d93b5f670c0f339b3bbf6d82c6?s=128&d=identicon&r=PG", "display_name": "Marten", "link": "https://stackoverflow.com/users/778278/marten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "accepted_answer_id": 56466352, "answer_count": 1, "score": 3, "last_activity_date": 1559761136, "creation_date": 1559760065, "question_id": 56466282, "link": "https://stackoverflow.com/questions/56466282/stop-compilation-if-if-constexpr-does-not-match", "title": "Stop compilation if `if constexpr` does not match", "body": "<p>I have a template function that checks the type of a template argument with an <code>if constexpr</code> such as</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T&gt;\nbool something(T arg) {\n  if constexpr (std::is_integral_v&lt;T&gt;) {\n    return true;\n  } else {\n    // What can I write here so that something&lt;double&gt;(0.0) does not compile?\n  }\n\n  return false;\n}\n</code></pre>\n\n<p>How can I make the code fail to compile if none of my <code>if constexpr</code>s match?</p>\n"}, {"tags": ["c++", "c", "eclipse", "eclipse-cdt", "stdio"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760157, "post_id": 56466264, "comment_id": 99523926, "body": "Look into the folder where the compiler is installed. Then, add that folder to Eclipse &quot;include list&quot;."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760345, "post_id": 56466264, "comment_id": 99524016, "body": "@Ripi2 it does not contain an &quot;include&quot; folder. Only ones I have that have &quot;include&quot; are related to java."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 2, "creation_date": 1559760462, "post_id": 56466264, "comment_id": 99524052, "body": "Have you installed a compiler as well? CDT does not come with its own compiler, but requires another one, e. g. MinGW or MinGW64. Then you need to make sure CDT finds the compiler, it should then find the include directories as well."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760655, "post_id": 56466264, "comment_id": 99524153, "body": "<i>&quot;it does not contain an &quot;include&quot; folder&quot;</i> See <a href=\"https://help.eclipse.org/2019-03/topic/org.eclipse.cdt.doc.user/reference/cdt_u_prop_general_pns_inc.htm\" rel=\"nofollow noreferrer\">C/C++ Project Properties, Paths and Symbols, Includes</a>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1559760747, "post_id": 56466264, "comment_id": 99524192, "body": "@Ripi2 That&#39;s for the non-standard headers. If you need to include the standard header files there, you&#39;ve obviously done something wrong."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559760839, "post_id": 56466264, "comment_id": 99524238, "body": "@Aconcagua can I still used Eclipse while having MinGW&#39;s include folder?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1559761179, "post_id": 56466264, "comment_id": 99524380, "body": "@GeorgeXavier Not sure what exactly you mean... At first, you will have to install MinGW. Then easiest is including the path to gcc.exe (directory only) in windows&#39; PATH variable. Normally, CDT should find the rest then by itself. If you opt for MinGW 64, earlier you additionally needed to rename one of the exe-files. Not sure any more which one it was \u2013 and if if that problem yet persists at all. Might with your outdated eclipse version, though."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761376, "post_id": 56466264, "comment_id": 99524451, "body": "@Aconcagua ok I have the includes folder, now how do I link it to eclipse? I already put the path in the environmental variables."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761475, "post_id": 56466264, "comment_id": 99524488, "body": "@GeorgeXavier The standard libraries should get linked automatically, too. Did you get a linker error? That would surprise me now..."}, {"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1559761528, "post_id": 56466264, "comment_id": 99524511, "body": "@Aconcagua nvm the most recent comment, it can find it now. Now I think a completely unassociated binary-not-found error, so header problem solved. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "edited": false, "score": 1, "creation_date": 1559767919, "post_id": 56467774, "comment_id": 99527183, "body": "It was not having the minGW &quot;include&quot; folder, Then attaching it to the path I got it working."}], "tags": [], "owner": {"reputation": 689, "user_id": 10894713, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1ZLMy80urgE/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZNWEGF20lE4QqIHv3k4pakqRon-A/mo/photo.jpg?sz=128", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/10894713/mehdi"}, "is_accepted": true, "score": 2, "last_activity_date": 1559767575, "creation_date": 1559767575, "answer_id": 56467774, "question_id": 56466264, "link": "https://stackoverflow.com/questions/56466264/eclipse-cdt-include-folder/56467774#56467774", "title": "Eclipse CDT Include Folder", "body": "<p>Go to project properties, C/C++ General -> Paths and Symbols and for Language GNU C you should see the compiler default include folders.</p>\n\n<p>If not, you might have a path problem.</p>\n\n<p>And i think <a href=\"https://codeyarns.com/2015/10/01/unresolved-inclusion-warning-in-eclipse/\" rel=\"nofollow noreferrer\">This</a> helps you! </p>\n"}], "owner": {"reputation": 191, "user_id": 11369664, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j3pOKhSdLp4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfz0reuFZPBqvHnAgjvTXcWBoIr2A/mo/photo.jpg?sz=128", "display_name": "George Xavier", "link": "https://stackoverflow.com/users/11369664/george-xavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1160, "favorite_count": 0, "accepted_answer_id": 56467774, "answer_count": 1, "score": 2, "last_activity_date": 1581760275, "creation_date": 1559760006, "last_edit_date": 1581760275, "question_id": 56466264, "link": "https://stackoverflow.com/questions/56466264/eclipse-cdt-include-folder", "title": "Eclipse CDT Include Folder", "body": "<p>I am a C++ newb. I have the Eclipse Luna IDE for Windows 10 and downloaded the Eclipse C/C++ IDE CDT 9.4 plugin. I have some code which has </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n\n<p>which is giving me \"unresolved inclusion\". Based on my research it means I do not have some include folder. I cannot find it on my Windows machine and all the help I've found is with ubuntu or Linux-based operating systems. So how do I get this to work? How do I get the folder?</p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559760558, "post_id": 56466251, "comment_id": 99524105, "body": "The pure virtual is there for forcing you to implement. Why pure if you don&#39;t want to implemebt then?"}, {"owner": {"reputation": 163, "user_id": 4545027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f132bc93db7bd53548dd3a44d6caeee4?s=128&d=identicon&r=PG&f=1", "display_name": "Ruoyun Huang", "link": "https://stackoverflow.com/users/4545027/ruoyun-huang"}, "reply_to_user": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559760699, "post_id": 56466251, "comment_id": 99524169, "body": "This is to refactor legacy code. :-) The plan of introducing this BaseB is to provide an interface for unification purpose."}, {"owner": {"reputation": 163, "user_id": 4545027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f132bc93db7bd53548dd3a44d6caeee4?s=128&d=identicon&r=PG&f=1", "display_name": "Ruoyun Huang", "link": "https://stackoverflow.com/users/4545027/ruoyun-huang"}, "reply_to_user": {"reputation": 6260, "user_id": 10933809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IR53l.jpg?s=128&g=1", "display_name": "Oblivion", "link": "https://stackoverflow.com/users/10933809/oblivion"}, "edited": false, "score": 0, "creation_date": 1559760822, "post_id": 56466251, "comment_id": 99524228, "body": "To answer my own question. After reading more posts, I found this: <a href=\"https://stackoverflow.com/questions/19528338/how-to-override-a-function-in-another-base-class\" title=\"how to override a function in another base class\">stackoverflow.com/questions/19528338/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 3264950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hgedi.jpg?s=128&g=1", "display_name": "lucas.exe", "link": "https://stackoverflow.com/users/3264950/lucas-exe"}, "is_accepted": false, "score": 0, "last_activity_date": 1559760697, "creation_date": 1559760697, "answer_id": 56466400, "question_id": 56466251, "link": "https://stackoverflow.com/questions/56466251/how-to-resolve-function-name-collision-in-c-muti-inheritance/56466400#56466400", "title": "How to resolve function name collision in c++ muti-inheritance?", "body": "<p>You need to define a function because <code>DoSomething</code> is a pure-virtual function in <code>BaseB</code> class. But you can call the <code>DoSomething</code> from <code>BaseA</code> class in your implementation:</p>\n\n<pre><code>void DoSomething(){\n    BaseA::DoSomething();\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4545027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f132bc93db7bd53548dd3a44d6caeee4?s=128&d=identicon&r=PG&f=1", "display_name": "Ruoyun Huang", "link": "https://stackoverflow.com/users/4545027/ruoyun-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "closed_date": 1559760960, "answer_count": 1, "score": 0, "last_activity_date": 1559760697, "creation_date": 1559759968, "question_id": 56466251, "link": "https://stackoverflow.com/questions/56466251/how-to-resolve-function-name-collision-in-c-muti-inheritance", "closed_reason": "Duplicate", "title": "How to resolve function name collision in c++ muti-inheritance?", "body": "<p>I am inheriting from two classes. Both classes contain the same function name, but one being implemented and one being pure virtual. Is there any way that I can just use the one already implement?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n\nclass BaseA {\npublic:\n    void DoSomething() {\n        value += 1;\n        std::cout&lt;&lt;\"DoSomething():\"&lt;&lt; value&lt;&lt;endl;\n    }\n\n    int value;\n};\n\n\nclass BaseB {\npublic:\n      virtual void DoSomething() =0;\n};\n\n\nclass Derived : public BaseA, public BaseB {\npublic:\n    Derived() { value = 0; }\n\n    // Compiler complains DoSomething() is not implemented.\n    // Can we just use BaseA.DoSomething()?\n};\n\nint main() {\n    Derived* obj = new Derived();\n    obj-&gt;DoSomething();\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1640, "user_id": 3871961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d1352dc24db7622120ce9b523a2b96?s=128&d=identicon&r=PG&f=1", "display_name": "xiawi", "link": "https://stackoverflow.com/users/3871961/xiawi"}, "edited": false, "score": 0, "creation_date": 1559759562, "post_id": 56466072, "comment_id": 99523693, "body": "Are you allowed to used dynamically allocated array ?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11605613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b1c9YOaDtdI/AAAAAAAAAAI/AAAAAAAABOs/grJYMivmUWw/photo.jpg?sz=128", "display_name": "Free Renca", "link": "https://stackoverflow.com/users/11605613/free-renca"}, "edited": false, "score": 0, "creation_date": 1559759470, "post_id": 56466130, "comment_id": 99523655, "body": "That fixes it, but wouldn&#39;t using a pointer make it faster? Or am i wrong?  Second way does not work."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 31, "user_id": 11605613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b1c9YOaDtdI/AAAAAAAAAAI/AAAAAAAABOs/grJYMivmUWw/photo.jpg?sz=128", "display_name": "Free Renca", "link": "https://stackoverflow.com/users/11605613/free-renca"}, "edited": false, "score": 1, "creation_date": 1559759763, "post_id": 56466130, "comment_id": 99523768, "body": "@FreeRenca How would using a pointer be faster than using a pointer?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1559760947, "post_id": 56466130, "comment_id": 99524282, "body": "Is that second snippet valid? <code>&amp;array1</code> has type <code>uint_fast8_t (*)[100]</code>.  You can&#39;t have one of those in an array of <code>uint_fast8_t*</code>."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 4, "last_activity_date": 1559759474, "last_edit_date": 1559759474, "creation_date": 1559759352, "answer_id": 56466130, "question_id": 56466072, "link": "https://stackoverflow.com/questions/56466072/pass-array-with-pointer-using-if-operator-statement/56466130#56466130", "title": "Pass array with pointer, using if (? operator) statement", "body": "<p>Because it is not the pointer but array of pointers</p>\n\n<pre><code>   uint_fast8_t *array = which_one ? array2 : array1; \n</code></pre>\n\n<p>Or </p>\n\n<pre><code>  uint_fast8_t *array[] = {which_one ? &amp;array2 : &amp;array1}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11605613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b1c9YOaDtdI/AAAAAAAAAAI/AAAAAAAABOs/grJYMivmUWw/photo.jpg?sz=128", "display_name": "Free Renca", "link": "https://stackoverflow.com/users/11605613/free-renca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56466130, "answer_count": 1, "score": 1, "last_activity_date": 1559759474, "creation_date": 1559759136, "question_id": 56466072, "link": "https://stackoverflow.com/questions/56466072/pass-array-with-pointer-using-if-operator-statement", "title": "Pass array with pointer, using if (? operator) statement", "body": "<p>How do i do this?</p>\n\n<pre><code>uint_fast8_t array1[100];\nuint_fast8_t array2[100];\n\nvoid get_a(bool which_one)\n{\nuint_fast8_t *array[] = which_one ? &amp;array2 : &amp;array1; //doesn't work\n}\n</code></pre>\n\n<p>This throws a error saying \"Can't convert uint_fast8_t(*)[100] to uint_fast8_t *[]\"</p>\n"}, {"tags": ["c++", "operator-overloading", "ostream"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1559759461, "post_id": 56466033, "comment_id": 99523646, "body": "It&#39;s unclear to me which of these questions you want an answer to."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 2, "creation_date": 1559759466, "post_id": 56466033, "comment_id": 99523651, "body": "The professor isn&#39;t saying, &quot;You should always write <code>t &lt;&lt; cout &lt;&lt; endl</code>&quot;, but the professor is instead testing your understanding of operators and operator overloading."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559760908, "post_id": 56466033, "comment_id": 99524261, "body": "<code>ostream&amp; operator&lt;&lt;(ostream&amp; o, T&amp; t)</code> should be <code>ostream&amp; operator&lt;&lt;(ostream&amp; o, const T&amp; t)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1559759467, "creation_date": 1559759467, "answer_id": 56466152, "question_id": 56466033, "link": "https://stackoverflow.com/questions/56466033/is-it-possible-to-cout-object-in-c-like-this-obj-cout-endl/56466152#56466152", "title": "Is it possible to cout object in C++ like this obj &lt;&lt; cout &lt;&lt; endl", "body": "<p>As any <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list/388282#388282\">good book</a> or tutorial should tell you, for any operator <code>X</code> the expression <code>a X b</code> will (if a suitable overload is found) be equal to <code>operatorX(a, b)</code>.</p>\n\n<p>Or if <code>a</code> (in <code>a X b</code>) have overloaded the operator as a member function, then it's equal to <code>a.operatorX(b)</code>.</p>\n\n<p>If we now take <code>cout &lt;&lt; t</code>, that will call either <code>operator&lt;&lt;(cout, t)</code> or <code>cout.operator&lt;&lt;(t)</code> depending on the type of <code>t</code>.</p>\n\n<p>As should be easy to guess, reversing the order to <code>t &lt;&lt; cout</code> would then be <code>operator&lt;&lt;(t, cout)</code> or <code>t.operator&lt;&lt;(cout)</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9591348, "user_type": "registered", "profile_image": "https://graph.facebook.com/2380924391933332/picture?type=large", "display_name": "Srecko Kostic", "link": "https://stackoverflow.com/users/9591348/srecko-kostic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1559759467, "creation_date": 1559758939, "last_edit_date": 1559759075, "question_id": 56466033, "link": "https://stackoverflow.com/questions/56466033/is-it-possible-to-cout-object-in-c-like-this-obj-cout-endl", "title": "Is it possible to cout object in C++ like this obj &lt;&lt; cout &lt;&lt; endl", "body": "<p>We had a class where professor asked us to overload <code>ostream</code> to print object this way (<em>saying we have object t</em>)</p>\n\n<pre><code>cout &lt;&lt; t &lt;&lt; endl;\n</code></pre>\n\n<p>Then we were asked to cout the same object this way</p>\n\n<pre><code>t &lt;&lt; cout &lt;&lt; endl;\n</code></pre>\n\n<p>How does this work and why?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>ostream&amp; operator&lt;&lt;(ostream&amp; o, T&amp; t)\n{\n   return o &lt;&lt; t.member;\n}\n\n// This is usual way and \"normal\" that I know about but won't work on both ways\n</code></pre>\n\n<p>Expected output is the same, but second way is confusing. Why would anyone want to use it?</p>\n"}, {"tags": ["c++", "floating-point", "c++14", "catch2", "floating-point-comparison"], "answers": [{"tags": [], "owner": {"reputation": 344, "user_id": 4095225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tm2gn.jpg?s=128&g=1", "display_name": "RaviStrs", "link": "https://stackoverflow.com/users/4095225/ravistrs"}, "is_accepted": true, "score": 8, "last_activity_date": 1581958213, "last_edit_date": 1581958213, "creation_date": 1581953539, "answer_id": 60265706, "question_id": 56466022, "link": "https://stackoverflow.com/questions/56466022/what-is-the-canonical-way-to-check-for-approximate-zeros-in-catch2/60265706#60265706", "title": "What is the canonical way to check for approximate zeros in Catch2?", "body": "<pre><code>(a == Approx(b).margin(1e-12))\n</code></pre>\n\n<p><a href=\"https://github.com/catchorg/Catch2/blob/master/projects/SelfTest/UsageTests/Approx.tests.cpp\" rel=\"noreferrer\">From the Catch2 GitHub</a></p>\n"}], "owner": {"reputation": 9958, "user_id": 225186, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dbc60362bf2df08202ff198e00085a5c?s=128&d=identicon&r=PG", "display_name": "alfC", "link": "https://stackoverflow.com/users/225186/alfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 1, "accepted_answer_id": 60265706, "answer_count": 1, "score": 4, "last_activity_date": 1581958213, "creation_date": 1559758882, "last_edit_date": 1577790546, "question_id": 56466022, "link": "https://stackoverflow.com/questions/56466022/what-is-the-canonical-way-to-check-for-approximate-zeros-in-catch2", "title": "What is the canonical way to check for approximate zeros in Catch2?", "body": "<p><strong>What is the canonical way to compare to approximate zeros in Catch2?</strong></p>\n\n<p>I found this way given a tolerance of 1e-12, but it is not clear it is the best way:</p>\n\n<pre><code>TEST(\"a approx. equal to b\", \"[test]\"){\n    REQUIRE( a - b == (0_a).margin(1e-12) );\n}\n</code></pre>\n\n<p>I am not asking how to compare floats in general. I know that is not a simple problem. I am asking how to use Catch2 given a certain tolerance known in advance.</p>\n\n<p>What follows didn't work, because relative (epsilon) errors do not behave well near zero:</p>\n\n<pre><code>TEST(\"a approx. equal to b\", \"[test]\"){\n    REQUIRE( a - b == (0_a).epsilon(1e-5) );\n}\n</code></pre>\n\n<hr>\n\n<p>Other possible (not so nice)( alternatives seem to be</p>\n\n<pre><code>TEST(\"a approx. equal to b\", \"[test]\"){\n    REQUIRE( std::abs( a - b ) &lt; 1e-12 );\n}\n</code></pre>\n\n<pre><code>TEST(\"a approx. equal to b\", \"[test]\"){\n    REQUIRE_THAT( a - b, WithinULP(0., ???));\n}\n</code></pre>\n\n<pre><code>TEST(\"a approx. equal to b\", \"[test]\"){\n    REQUIRE_THAT( a, WithinULP(b, ???));\n}\n</code></pre>\n"}, {"tags": ["c++", "dll", "shared-libraries", "qt-creator"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1559763086, "post_id": 56465876, "comment_id": 99525178, "body": "Did you try: man ldconfig"}, {"owner": {"reputation": 335, "user_id": 9006830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXT3z.jpg?s=128&g=1", "display_name": "RoboticForest", "link": "https://stackoverflow.com/users/9006830/roboticforest"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1559764517, "post_id": 56465876, "comment_id": 99525729, "body": "I have not, nor do I know what that is. However, I just got it working a moment ago! Should I update my question, or post an answer separately?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1559765481, "post_id": 56465876, "comment_id": 99526133, "body": "It&#39;s ok to post answers to your own question."}], "answers": [{"tags": [], "owner": {"reputation": 335, "user_id": 9006830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXT3z.jpg?s=128&g=1", "display_name": "RoboticForest", "link": "https://stackoverflow.com/users/9006830/roboticforest"}, "is_accepted": true, "score": 2, "last_activity_date": 1559768347, "last_edit_date": 1592644375, "creation_date": 1559768347, "answer_id": 56467924, "question_id": 56465876, "link": "https://stackoverflow.com/questions/56465876/my-project-cant-find-its-libraries-when-run-manually-from-the-terminal/56467924#56467924", "title": "My project can&#39;t find its libraries when run manually from the terminal", "body": "<h1>Short Answer</h1>\n<p>I ran in to multiple problems all at once.</p>\n<ul>\n<li>First problem: Broken symbolic links (they're like shortcuts in Windows).</li>\n<li>Second: My lib needed to be copied in to a different system directory than is generally recommended.</li>\n<li>Third: Qt Creator and QMake made passing custom linker options difficult.</li>\n</ul>\n<hr />\n<h1>The Details</h1>\n<p>When Qt Creator compiles my library it automatically creates three symbolic links to it with different layouts of the version numbers.</p>\n<pre><code>&gt; ll\nlib-engine.so -&gt; lib-engine.so.0.1.0\nlib-engine.so.0 -&gt; lib-engine.so.0.1.0\nlib-engine.so.0.1 -&gt; lib-engine.so.0.1.0\nlib-engine.so.0.1.0 (original library file)\n</code></pre>\n<p>For some reason (I don't know why) each time I moved the links in to a system directory like <code>usr/local/lib</code> the links would break. I didn't notice this at first, or even think to check, because that's never happened to me before. Moving a link has always worked in the past. To get around this I just manually created the links within the directories they would reside in.</p>\n<p>Broken links aside, putting the library in to <code>usr/local/lib</code> still didn't work, but <code>usr/lib</code> and <code>/usr/lib/x86_64-linux-gnu</code> (recommended in the blog linked below) did work!</p>\n<p>Those fixes actually came after a different fix I looked in to after reading <a href=\"https://aimlesslygoingforward.com/blog/2014/01/19/bundling-shared-libraries-on-linux/\" rel=\"nofollow noreferrer\">this blog</a> and <a href=\"https://www.eyrie.org/%7Eeagle/notes/rpath.html\" rel=\"nofollow noreferrer\">this article</a> it linked to.</p>\n<p>There it said to add <code>-Wl,-rpath,'$ORIGIN/lib'</code> to the gcc build options to embed a library search path in to the application itself. This set of options would allow me to put my library files where ever I wanted (specifically, in a directory called /lib in the application's working directory).</p>\n<p>Unfortunately, that had two problems of its own. First, Qt Creator doesn't (from what I can tell) allow you to specify custom build options for individual subprojects through the GUI, so I had to figure out how to add linker options using the project file, assuming that was possible, which it was.</p>\n<p>Second, QMake messed up the gcc options, embedding in to my application <code>Library rpath: [RIGIN/lib]</code> instead of <code>Library rpath: [lib]</code> like it's supposed to.</p>\n<p>In the end, changing the proposed linker options of...</p>\n<pre><code>-Wl,-rpath,'$ORIGIN/lib'\n</code></pre>\n<p>... to the following QMake project file line...</p>\n<pre><code>QMAKE_LFLAGS += -Wl,-rpath,'lib'\n</code></pre>\n<p>... work out nicely. Using both fixes I can now either install my library on my system or put it in to a /lib folder and the program will run.</p>\n"}], "owner": {"reputation": 335, "user_id": 9006830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VXT3z.jpg?s=128&g=1", "display_name": "RoboticForest", "link": "https://stackoverflow.com/users/9006830/roboticforest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 56467924, "answer_count": 1, "score": 0, "last_activity_date": 1559768347, "creation_date": 1559758177, "question_id": 56465876, "link": "https://stackoverflow.com/questions/56465876/my-project-cant-find-its-libraries-when-run-manually-from-the-terminal", "title": "My project can&#39;t find its libraries when run manually from the terminal", "body": "<p>I'm creating a library for the first time. So far it's working from the IDE (Qt Creator), but not from the terminal when I run its testing program manually.</p>\n\n<p>There are two parts to my project, the library, and the sandbox for testing it. I've created a project in Qt Creator that includes two subprojects (one to build the lib, and one to build the tester) and both compile without errors. When I run the sandbox from the IDE the library is dynamically linked to the sandbox, the function <code>greeting()</code> is loaded in from it, then called, and prints \"Welcome to the library!\" to <code>std::cout</code>. However, if I open the build folder in the terminal and run the sandbox directly using <code>./sandbox</code> I get:</p>\n\n<pre><code>./sandbox: error while loading shared libraries: libengine.so.1: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>I took this to mean that I needed to properly install my custom library, <code>libengine.so.1</code>. When I looked up how to do that I found that I just needed to copy the library files in to either, <code>/usr/lib</code> or <code>/usr/local/lib</code>, but neither of those worked and I'm still getting the above error. In the past, that simple solution did work for me when compiling a 3rd party library (SDL, I think) and I don't know what I'm missing that would mean it wouldn't work now. So far I haven't yet found any more detailed information and I don't know what I'm doing wrong or have missed.</p>\n\n<p>How do I make my sandbox program see its companion library when I run it directly from the command line?</p>\n\n<p><strong>NOTE</strong>: I'm specifically asking about Linux/Ubuntu. If I later run into problems under Windows I'll be back. :-)</p>\n"}, {"tags": ["c++", "codeblocks", "winsock"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1559758870, "post_id": 56465874, "comment_id": 99523375, "body": "Did <code>bind</code> and <code>listen</code> succeed? Have the program check the error codes from both and report and handle failure. Hard to tell if something&#39;s wrong if you don&#39;t check."}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 2, "creation_date": 1559760550, "post_id": 56465874, "comment_id": 99524099, "body": "You are passing interger value to function which takes <code>const char*</code> - <code>inet_addr(INADDR_ANY);</code> should be replaced by <code>htonl(INADDR_ANY);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1559771012, "post_id": 56466716, "comment_id": 99528316, "body": "I&#39;ll gleefully trade a <code>std::vector</code> for that <code>malloc</code> if permitted by the program requirements."}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559772126, "post_id": 56466716, "comment_id": 99528688, "body": "@user4581301 Yes, of course you are right, it is tagged with C++ so <code>std::vector</code> might be used here. My intention was to indicate the problem with allocated buffer. For me the sequence of following functions <code>bind,listen,recv</code> is always associated  with C language - clumpy and painful, so my first idea was to use <code>malloc</code>. I would propose vector if OP used e.g. boost::asio api :)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1559775508, "post_id": 56466716, "comment_id": 99529495, "body": "I would just use a fixed array instead: <code>char buffer[10];</code> or <code>std::array&lt;char, 10&gt; buffer;</code> then <code>sizeof(buffer)</code> will work"}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": false, "score": 1, "last_activity_date": 1559762237, "creation_date": 1559762237, "answer_id": 56466716, "question_id": 56465874, "link": "https://stackoverflow.com/questions/56465874/c-winsock-server-accept-function-returns-10022-error/56466716#56466716", "title": "C++ winsock server accept function returns 10022 error", "body": "<p><code>inet_addr</code> takes <code>const char*</code> which represents IPv4 address in numbers and dots notation. You are passing <code>INADDR_ANY</code> to this function, it compiles but doesn't work as expected because <code>INADDR_ANY</code> equals 0, so <code>inet_addr</code> is called with null pointer. You should check the return code of this function, -1 indicates the error. And I assume you got it.</p>\n\n<p>If you want to bind any local address you should use <code>INADDR_ANY</code> with <code>htonl</code>:</p>\n\n<pre><code>serverAddr.sin_addr.S_un.S_addr = htonl(INADDR_ANY);\n</code></pre>\n\n<hr>\n\n<p>This </p>\n\n<pre><code>char *buffer;\nrecv(client, buffer, sizeof(buffer), 0);\n</code></pre>\n\n<p>leads to undefined behaviour. buffer is uninitialized. This call of <code>recv</code> wants to read 4/8 bytes - <code>sizeof(buffer)</code>, and write into uninitialized <em>buffer</em> pointer. You need to create a buffer with some initial size, for example by calling malloc/calloc:</p>\n\n<pre><code>char * buffer = malloc(10);\nrecv(client,buffer,10,0);\n// free buffer after data was read\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 2, "last_activity_date": 1559788393, "creation_date": 1559788393, "answer_id": 56470241, "question_id": 56465874, "link": "https://stackoverflow.com/questions/56465874/c-winsock-server-accept-function-returns-10022-error/56470241#56470241", "title": "C++ winsock server accept function returns 10022 error", "body": "<p>10022 is <code>WSAEINVAL</code>.  Per the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winsock2/nf-winsock2-accept\" rel=\"nofollow noreferrer\"><code>accept()</code></a> documentation:</p>\n\n<blockquote>\n  <p>WSAEINVAL<br>\n  The <code>listen</code> function was not invoked prior to <code>accept</code>. </p>\n</blockquote>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinSock/windows-sockets-error-codes-2\" rel=\"nofollow noreferrer\">Windows Socket Error Codes</a> documentation also says:</p>\n\n<blockquote>\n  <p>WSAEINVAL<br>\n  10022</p>\n  \n  <p>Invalid argument.</p>\n  \n  <p>Some invalid argument was supplied (for example, specifying an invalid level to the <code>setsockopt</code> function). In some instances, it also refers to the current state of the socket\u2014for instance, <strong>calling <code>accept</code> on a socket that is not listening</strong>.</p>\n</blockquote>\n\n<p>OK, so lets look at your <code>listen()</code> call:</p>\n\n<pre><code>listen(server1, SOMAXCONN);\n</code></pre>\n\n<p>Nothing out of the ordinary there, assuming <code>server1</code> is a valid socket (which you do check for, but you don't stop your program if <code>socket()</code> failed).</p>\n\n<p>You are not checking for any <code>listen()</code> errors.  Per the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winsock2/nf-winsock2-listen\" rel=\"nofollow noreferrer\"><code>listen()</code></a> documentation, one of the possible errors is:</p>\n\n<blockquote>\n  <p>WSAEINVAL<br>\n  The socket has not been bound with <code>bind</code>. </p>\n</blockquote>\n\n<p>OK, so lets look at your <code>bind()</code> call next:</p>\n\n<pre><code>bind(server1, (SOCKADDR *)&amp;serverAddr, sizeof(serverAddr));\n</code></pre>\n\n<p>Again, you are not checking for any <code>bind()</code> errors.  Per the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winsock/nf-winsock-bind\" rel=\"nofollow noreferrer\"><code>bind()</code></a> documentation, one of the possible errors is:</p>\n\n<blockquote>\n  <p>WSAEADDRNOTAVAIL<br>\n  The requested address is not valid in its context.</p>\n  \n  <p>This error is returned if the specified address pointed to by the name parameter is not a valid local IP address on this computer.</p>\n</blockquote>\n\n<p>Which you are likely to get, because you are not populating <code>serverAddr</code> correctly, specifically on this line:</p>\n\n<pre><code>serverAddr.sin_addr.S_un.S_addr = inet_addr(INADDR_ANY);\n</code></pre>\n\n<p><code>INADDR_ANY</code>is defined as <code>0</code>, so you are setting the <code>S_addr</code> field to the result of <code>inet_addr(0)</code>, which is not valid so <code>INADDR_NONE</code> (0xFFFFFFFF) is returned, which again, you are not checking for. The correct assignment is to use <code>INADDR_ANY</code> as-is instead:</p>\n\n<pre><code>serverAddr.sin_addr.S_un.S_addr = INADDR_ANY;\n</code></pre>\n\n<p>So, to wrap up, your error handling is inadequate, allowing errors to accumulate until you finally decide to do for errors all the way on <code>accept()</code>, which is way too late.  You need to check EVERY function result for failure along the way, and STOP when you do encounter an error.</p>\n"}], "owner": {"reputation": 11, "user_id": 11605535, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-paeHgRyuaAQ/AAAAAAAAAAI/AAAAAAAAAEE/uzVpJTfTbEM/photo.jpg?sz=128", "display_name": "Mike Batista", "link": "https://stackoverflow.com/users/11605535/mike-batista"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559848158, "creation_date": 1559758176, "last_edit_date": 1559848158, "question_id": 56465874, "link": "https://stackoverflow.com/questions/56465874/c-winsock-server-accept-function-returns-10022-error", "title": "C++ winsock server accept function returns 10022 error", "body": "<p>I got rid of the error, now I seem to be stuck on something else. </p>\n\n<p>I have separate Winsock client and server programs on Code::Blocks. I'm trying to send a message from the client to the server, but the server program seems to freeze before the accept() function, doing nothing beyond the \"Listening for incoming connections.\" output. The message in the client buffer never shows up in the server console.</p>\n\n<p>It definitely looks like there's something going on with the accept function in the server program. That seems to be where the server program freezes. I tried to type a random cout line after that and there was no output for it.</p>\n\n<p>The client seems to freeze, too, after \"Message Sent.\" But then after a few minutes I get \"recv failed\" then \"Reply Received\" and then a line of what seems like emoticons. I think I have the image linked below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/qVPyJ.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Here's my client code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;winsock2.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;ws2tcpip.h&gt;\n#include &lt;stdio.h&gt;\n#pragma comment(lib, \"ws2_32.lib\")\n\nusing namespace std;\n\nint main()\n{\n\n    WSADATA wsaData;\n    SOCKET sock;\n    sockaddr_in server;\n    char *buffer, server_reply[2000];\n    int recv_size;\n\n    int iResult;\n\niResult = WSAStartup(MAKEWORD(2,2), &amp;wsaData);\nif (iResult != 0) {\n    printf(\"WSAStartup failed: %d\\n\", iResult);\n} else {\n     printf(\"WSAStartup successful!: %d\\n\", iResult);\n}\n\nsock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\nif (sock == INVALID_SOCKET){\n    printf(\"Socket not created.\\n\");\n} else {\n    printf(\"Socket created.\\n\");\n}\n\n    server.sin_addr.S_un.S_addr = inet_addr(\"127.0.0.1\");\n    server.sin_family = AF_INET;\n    server.sin_port = htons(80);\n\n    if(connect(sock, (SOCKADDR *)&amp;server, sizeof(server)) != 0){\n        printf(\"Connect Error : %d\" , WSAGetLastError());\n    } else {\n        printf(\"Connected\\n\");\n    };\n\n    buffer = \"Hello there!\";\n    send(sock, buffer, sizeof(buffer), 0);\n\n        printf(\"Message Sent.\\n\");\n\n\n    if((recv_size = recv(sock , server_reply , 2000 , 0)) == SOCKET_ERROR)\n    {\n        puts(\"recv failed\");\n    }\n\n    puts(\"Reply received\\n\");\n    //Add a NULL terminating character to make it a proper string before printing\n    server_reply[recv_size] = '\\0';\n    puts(server_reply);\n\n\n    closesocket(sock);\n    WSACleanup();\n\n    return 0;\n}\n</code></pre>\n\n<p>Here's my server code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;winsock2.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;ws2tcpip.h&gt;\n#include &lt;stdio.h&gt;\n#pragma comment(lib, \"ws2_32.lib\")\n\nusing namespace std;\n\nint main()\n{\n\n    WSADATA wsaData;\n    SOCKET server1, client;\n    sockaddr_in serverAddr, clientAddr;\n\n\n    int iResult;\n\niResult = WSAStartup(MAKEWORD(2,2), &amp;wsaData);\nif (iResult != 0) {\n    printf(\"WSAStartup failed: %d\\n\", iResult);\n} else {\n     printf(\"WSAStartup successful!: %d\\n\", iResult);\n}\n\nserver1 = socket(AF_INET, SOCK_STREAM, 0);\nif (server1 == INVALID_SOCKET){\n    printf(\"Socket not created.\\n\");\n} else {\n    printf(\"Socket created.\\n\");\n}\n\n    serverAddr.sin_addr.S_un.S_addr = INADDR_ANY;\n    serverAddr.sin_family = AF_INET;\n    serverAddr.sin_port = htons(8888);\n\n    if(bind(server1, (SOCKADDR *)&amp;serverAddr, sizeof(serverAddr)) == SOCKET_ERROR){\n        printf(\"Bind failed. : %d\" , WSAGetLastError());\n    } else {\n        printf(\"Bind successful.\\n\");\n    }\n\n    if(listen(server1, SOMAXCONN) != 0){\n        printf(\"Server not listening. : %d\" , WSAGetLastError());\n    } else {\n        cout &lt;&lt; \"Listening for incoming connections...\" &lt;&lt; endl;\n    }\n\n\n\n    char buffer[1024];\n    int clientAddrSize = sizeof(clientAddr);\n    if((client = accept(server1, (SOCKADDR *)&amp;clientAddr, &amp;clientAddrSize)) == INVALID_SOCKET)\n    {\n        printf(\"Connect Error : %d\" , WSAGetLastError());\n    } else {\n        cout &lt;&lt; \"Client connected!\" &lt;&lt; endl;\n        recv(client, buffer, sizeof(buffer), 0);\n        cout &lt;&lt; \"Client says: \" &lt;&lt; buffer &lt;&lt; endl;\n        memset(buffer, 0, sizeof(buffer));\n\n        closesocket(client);\n        closesocket(server1);\n        cout &lt;&lt; \"Client disconnected.\" &lt;&lt; endl;\n    }\n    WSACleanup();\n\n    return 0;\n}\n</code></pre>\n\n<p>I'm trying to build a Winsock server program to use with my client program using C++ in CodeBlocks. However, the accept function returns error code 10022, which from what I've read means invalid argument. I don't see how any of my arguments in the accept function are invalid. Thanks for any help!</p>\n\n<pre><code>int main()\n{\n\n    WSADATA wsaData;\n    SOCKET server1, client;\n    sockaddr_in serverAddr, clientAddr;\n\n\n    int iResult;\n\niResult = WSAStartup(MAKEWORD(2,2), &amp;wsaData);\nif (iResult != 0) {\n    printf(\"WSAStartup failed: %d\\n\", iResult);\n} else {\n     printf(\"WSAStartup successful!: %d\\n\", iResult);\n}\n\nserver1 = socket(AF_INET, SOCK_STREAM, 0);\nif (server1 == INVALID_SOCKET){\n    printf(\"Socket not created.\\n\");\n} else {\n    printf(\"Socket created.\\n\");\n}\n\n    serverAddr.sin_addr.S_un.S_addr = inet_addr(INADDR_ANY);\n    serverAddr.sin_family = AF_INET;\n    serverAddr.sin_port = htons(8888);\n\n    bind(server1, (SOCKADDR *)&amp;serverAddr, sizeof(serverAddr));\n    listen(server1, SOMAXCONN);\n\n    cout &lt;&lt; \"Listening for incoming connections...\" &lt;&lt; endl;\n\n    char *buffer;\n    int clientAddrSize = sizeof(clientAddr);\n    if((client = accept(server1, (SOCKADDR *)&amp;clientAddr, &amp;clientAddrSize)) == INVALID_SOCKET)\n    {\n        printf(\"Connect Error : %d\" , WSAGetLastError());\n    } else {\n        cout &lt;&lt; \"Client connected!\" &lt;&lt; endl;\n        recv(client, buffer, sizeof(buffer), 0);\n        cout &lt;&lt; \"Client says: \" &lt;&lt; buffer &lt;&lt; endl;\n        memset(buffer, 0, sizeof(buffer));\n\n        closesocket(client);\n        closesocket(server1);\n        cout &lt;&lt; \"Client disconnected.\" &lt;&lt; endl;\n    }\n    WSACleanup();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "encryption", "crypto++"], "answers": [{"tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": true, "score": 4, "last_activity_date": 1559882611, "last_edit_date": 1559882611, "creation_date": 1559760514, "answer_id": 56466366, "question_id": 56465807, "link": "https://stackoverflow.com/questions/56465807/aes-ccm-encryption-and-plaintext-length-exceeds-maximum-message-length/56466366#56466366", "title": "AES/CCM Encryption and Plaintext Length Exceeds Maximum Message Length", "body": "<blockquote>\n  <p>My question is, how do I encrypt/decrypt a plaintext which is longer than 16777215 bytes?</p>\n</blockquote>\n\n<p>CCM mode is specified in NIST <a href=\"https://csrc.nist.gov/publications/detail/sp/800-38c/final\" rel=\"nofollow noreferrer\">SP800-38c</a>. Section A.1, Length Requirements, discusses maximum plain text under a security context. A security context is the <em>{key, iv}</em> combination (with some hand waiving).</p>\n\n<p>I believe you have three choices. First, you can increase the length of the IV. The larger the iv, the more plain text you can encrypt. The max iv length is 13 so it does not scale up forever.</p>\n\n<p>Second, you have to re-key or change the iv before you hit the maximum plain text under the context. You can find the maximum plain text length using <a href=\"https://github.com/weidai11/cryptopp/blob/master/ccm.h\" rel=\"nofollow noreferrer\"><code>MaxMessageLength()</code></a>. Crypto++ tracks the number of bytes processed via <a href=\"https://github.com/weidai11/cryptopp/blob/master/authenc.h\" rel=\"nofollow noreferrer\"><code>m_totalMessageLength</code></a>, but it is not exposed to user programs. You will have to track it yourself.</p>\n\n<p>Third, you can change algorithms. An algorithm like <a href=\"https://www.cryptopp.com/wiki/ChaCha20Poly1305\" rel=\"nofollow noreferrer\">ChaCha20Poly1305</a> allows you to encrypt 2^38-1 64-byte blocks. That is just under 2^44 bytes or about 256 GB. You should be safe with ChaCha20Poly1305.</p>\n\n<hr>\n\n<p>Crypto++ tells you the maximum number of bytes via <a href=\"https://github.com/weidai11/cryptopp/blob/master/ccm.h\" rel=\"nofollow noreferrer\"><code>MaxMessageLength()</code></a>. In the case of CCM it is based on the iv length, and tracked through <code>m_L</code> in the code below.</p>\n\n<pre><code>lword MaxMessageLength() const\n    {return m_L&lt;8 ? (W64LIT(1)&lt;&lt;(8*m_L))-1 : W64LIT(0)-1;}\n</code></pre>\n\n<p><code>MaxMessageLength()</code> is used in <a href=\"https://github.com/weidai11/cryptopp/blob/master/authenc.cpp\" rel=\"nofollow noreferrer\"><code>authenc.cpp</code></a>. <code>ProcessData()</code> throws an exception when the limit is hit:</p>\n\n<pre><code>if (m_state &gt;= State_IVSet &amp;&amp; length &gt; MaxMessageLength()-m_totalMessageLength)\n    throw InvalidArgument(AlgorithmName() + \": message length exceeds maximum\");\nm_totalMessageLength += length;\n</code></pre>\n\n<hr>\n\n<pre><code>const int TAG_SIZE = 8;\nCCM&lt; AES, TAG_SIZE &gt;::Encryption e;\nCCM&lt; AES, TAG_SIZE &gt;::Decryption d;\n</code></pre>\n\n<p>Your tag size is a tad bit on the small side. You might want to use the maximum size, if your protocol allows it.</p>\n\n<hr>\n\n<p>I recommend you switch algorithms. CCM is a bastard mode that got standardized in the early 2000's through some Wireless Working Group. Then, NIST adopted it because it was already standardized.</p>\n\n<p>At the time CCM was standardized there were better <a href=\"https://www.cryptopp.com/wiki/Authenticated_Encryption\" rel=\"nofollow noreferrer\">Authenticated Encryption</a> modes available, like CWC, OCB, EAX and GCM. Unfortunately the damage was done. And now you have algorithms like Bernstein's ChaChaPoly1305.</p>\n\n<p>You might also want to checkout <a href=\"https://www.cryptopp.com/wiki/AEAD_Comparison\" rel=\"nofollow noreferrer\">AEAD Comparison</a> on the Crypto++ wiki. The comparison shows CCM is about the worst of the authenticated encryption modes.</p>\n"}], "owner": {"reputation": 45, "user_id": 11605474, "user_type": "registered", "profile_image": "https://graph.facebook.com/949814348473669/picture?type=large", "display_name": "Tomi Jerenko", "link": "https://stackoverflow.com/users/11605474/tomi-jerenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 56466366, "answer_count": 1, "score": 3, "last_activity_date": 1559882611, "creation_date": 1559757864, "last_edit_date": 1559760800, "question_id": 56465807, "link": "https://stackoverflow.com/questions/56465807/aes-ccm-encryption-and-plaintext-length-exceeds-maximum-message-length", "title": "AES/CCM Encryption and Plaintext Length Exceeds Maximum Message Length", "body": "<p>I am trying to perform an encryption and decryption in Crypto++ library using AES128 cipher with CCM mode of operation. I have a problem when I try to encrypt string longer than 16777215 bytes.</p>\n\n<p>My code:</p>\n\n<pre><code>const int TAG_SIZE = 8;\nCCM&lt; AES, TAG_SIZE &gt;::Encryption e;\nCCM&lt; AES, TAG_SIZE &gt;::Decryption d;\n\ne.SetKeyWithIV( key, sizeof(key), iv, sizeof(iv) );\ne.SpecifyDataLengths( 0, plain.size(), 0 );\n\n//Encryption\nStringSource ss1(\n  plain,\n  true,\n  new AuthenticatedEncryptionFilter(\n    e,\n    new StringSink(cipher)\n   )\n);\n\nd.SetKeyWithIV( key, sizeof(key), iv, sizeof(iv) );\nd.SpecifyDataLengths( 0, plain.size(), 0 );\n\n//Decryption\nAuthenticatedDecryptionFilter df( d,\n  new StringSink(recovered)\n);\nStringSource ss2(\n  cipher,\n  true,\n  new Redirector(df)\n);\n</code></pre>\n\n<p>When I try to encrypt/decrypt a plaintext which is size of a CD (737280000), I get the following error:</p>\n\n<blockquote>\n  <p>\"terminate called after throwing an instance of 'CryptoPP::InvalidArgument'\n    what():  AES/CCM: message length 737280000 exceeds the maximum of 16777215\"</p>\n</blockquote>\n\n<p>My question is, how do I encrypt/decrypt a plaintext which is longer than 16777215 bytes?</p>\n"}, {"tags": ["c++", "c++17", "shared-ptr", "weak-ptr", "enable-shared-from-this"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1559756817, "post_id": 56465544, "comment_id": 99522585, "body": "For the second question, initializing a new <code>std::shared_ptr</code> instead of failing on <code>shared_from_this</code>, you can&#39;t assume how the object&#39;s lifetime is currently being managed. Unless it&#39;s owned by a raw pointer that the user won&#39;t <code>delete</code>, there really isn&#39;t a scenario where this will lead to anything good. For example, what happens if I tried <code>shared_from_this</code> with automatic storage duration?"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 1, "creation_date": 1559760315, "post_id": 56465544, "comment_id": 99524007, "body": "<code>the std::shared_ptr constructor checks the std::weak_ptr, and if it is not initialized, initializes it and uses the std::weak_ptr control block for the std::shared_ptr</code> I don&#39;t think this is accurate. <a href=\"https://en.cppreference.com/w/cpp/memory/enable_shared_from_this/enable_shared_from_this\" rel=\"nofollow noreferrer\">cppreference</a> states that the <code>weak_ptr</code> is value initialized. I would assume that means no check is made. So adding the check would add cost to every construction that does not require it."}, {"owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559769064, "post_id": 56465544, "comment_id": 99527588, "body": "@Fran&#231;oisAndrieux fair enough on the point about the object not assuming that <code>this</code> is a pointer from which a shared pointer could/should be created."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559867974, "post_id": 56465544, "comment_id": 99563123, "body": "Having multiple smart pointers to the &quot;same object&quot; (whatever that means) isn&#39;t inherently a bad idea."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1559757374, "post_id": 56465701, "comment_id": 99522776, "body": "The question is why the language doesn&#39;t have a feature where OP&#39;s code would work, based on <code>C</code> knowing it already has an owning <code>std::shared_ptr</code>. OP clearly communicated that they know their code is problematic."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559759157, "post_id": 56465701, "comment_id": 99523504, "body": "@Fran&#231;oisAndrieux: &quot;<i>OP clearly communicated that they know their code is problematic.</i>&quot; I disagree. You don&#39;t generally ask why your problematic code isn&#39;t made unproblematic. The existence of the question suggests, at least, that the OP doesn&#39;t think their code <i>should be</i> particularly problematic."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559759609, "post_id": 56465701, "comment_id": 99523709, "body": "@Fran&#231;oisAndrieux: But... the code <i>is bad</i>. That is the answer: it&#39;s not allowed because a user doing this is doing the wrong thing, so we don&#39;t let users do the wrong thing. Even though it <i>could</i> be &quot;fixed&quot;, to &quot;fix&quot; it would be to say that the incoherent code is not incoherent."}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 4, "creation_date": 1559759779, "post_id": 56465701, "comment_id": 99523777, "body": "@NicolBolas The question is <i>why</i> does <code>enable_shared_from_this</code> behave this way. The fact that the code is bad, and why, is explained in the question. Re-stating that is hardly an answer."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559760886, "post_id": 56465701, "comment_id": 99524255, "body": "@Fran&#231;oisAndrieux &quot;<i>An analogue would be answering the question &quot;I dropped my phone and it broke, so why don&#39;t companies make tougher phones?&quot;</i>&quot; I would say that a better analog is &quot;I put my phone in front of my car tires and accelerated over it, and it broke. Why don&#39;t companies make phones that you can drive over?&quot; The point of the answer here is that you&#39;re not <i>supposed</i> to be able to do these things. They&#39;re not allowed because they&#39;re not <i>supposed</i> to be allowed."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1559761690, "post_id": 56465701, "comment_id": 99524584, "body": "@Fran&#231;oisAndrieux: &quot;<i>Maybe nobody though of it, maybe the solution doesn&#39;t account for a technical limitation, maybe it&#39;s a trade off with something else that&#39;s more important.</i>&quot; Or maybe it has nothing to do with technical limitations and has more to do with &quot;we don&#39;t want to facilitate misuse of the API&quot;. Which is the point being made here: you aren&#39;t supposed to be able to do it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1559761729, "post_id": 56465701, "comment_id": 99524601, "body": "@NicolBolas Okay, I see what you mean and it makes sense. That might be a good answer, but it isn&#39;t what this answer provides. Edit : If that <i>is</i> what the answer is trying to communicate, even rereading it with this interpretation in mind, I don&#39;t see it."}, {"owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1559769241, "post_id": 56465701, "comment_id": 99527659, "body": "@NicolBolas you&#39;re explaining how to write code that will work given the way the standard library works today. I understand that already. I&#39;m asking why the library works that way, instead of an arguably better way, which I describe in the question."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559868230, "post_id": 56465701, "comment_id": 99563181, "body": "&quot;<i>Creating two shared_ptrs to the same pointer is undefined behaviour</i>&quot; Since when?"}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": -1, "last_activity_date": 1559757330, "creation_date": 1559757330, "answer_id": 56465701, "question_id": 56465544, "link": "https://stackoverflow.com/questions/56465544/why-does-stdenable-shared-from-this-allow-multiple-stdshared-ptr-instances/56465701#56465701", "title": "Why does std::enable_shared_from_this allow multiple std::shared_ptr instances?", "body": "<p>Creating two <code>shared_ptr</code>s to the same pointer is undefined behaviour and is nothing to do with <code>std::enable_shared_from_this</code>. Your code should be:</p>\n\n<pre><code>struct C : std::enable_shared_from_this&lt;C&gt; {};\n\nC *p = new C();\nstd::shared_ptr&lt;C&gt; p1(p);\n\nstd::shared_ptr&lt;C&gt; p2 = p-&gt;shared_from_this();\n\nstd::shared_ptr&lt;C&gt; p3(p1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 1, "creation_date": 1559769657, "post_id": 56466686, "comment_id": 99527814, "body": "Thanks, this is pretty clear. You&#39;re saying that creating two <code>std::shared_ptr</code> instances from the same raw pointer is normally bad/undefined behavior, so it shouldn&#39;t suddenly start working just because the underlying object happens to be of some magic class. Makes sense."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1559769991, "post_id": 56466686, "comment_id": 99527939, "body": "Yes, indeed. Which on it&#39;s own isn&#39;t a big issue, though, it becomes a headache if you need to maintain a big code base where one of the base classes changes semantics."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1559868208, "post_id": 56466686, "comment_id": 99563175, "body": "Many small changes can silently break that uses <code>enable_shared_from_this</code> notably changing to private inheritance (for what many ppl believe is an implementation detail), change in stdlib impl if you made a stdlib function friend to fix the previous issue, turning an object (created with <code>make_shared</code>) into a member subobject..."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1559891025, "post_id": 56466686, "comment_id": 99567919, "body": "@curiousguy Exactly my point. Making the standard library friend ain&#39;t a good idea, so that&#39;s one of the cases I&#39;m least afraid of"}], "tags": [], "owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "is_accepted": true, "score": 5, "last_activity_date": 1559762071, "creation_date": 1559762071, "answer_id": 56466686, "question_id": 56465544, "link": "https://stackoverflow.com/questions/56465544/why-does-stdenable-shared-from-this-allow-multiple-stdshared-ptr-instances/56466686#56466686", "title": "Why does std::enable_shared_from_this allow multiple std::shared_ptr instances?", "body": "<p>If I understand your question correctly, you would assume that calling the constructor <code>shared_ptr</code> a second time would logically reuse the control block stored in shared_from_this.</p>\n\n<p>From your point of view, this looks logical. Let's assume for a moment that <code>C</code> is part of a library your are maintaining and the usage of <code>C</code> is part of a user of your library.</p>\n\n<pre><code>struct C : std::enable_shared_from_this&lt;C&gt; {};\n\nC *p = new C();\nstd::shared_ptr&lt;C&gt; p1(p);\nstd::shared_ptr&lt;C&gt; p3(p); // Valid given your assumption\n</code></pre>\n\n<p>Now, you found a way to no longer need the <code>enable_shared_from_this</code> and in the next version of your library, this gets updated to:</p>\n\n<pre><code>struct C {};\n\nC *p = new C();\nstd::shared_ptr&lt;C&gt; p1(p);\nstd::shared_ptr&lt;C&gt; p3(p); // Now a bug\n</code></pre>\n\n<p>Suddenly, perfectly valid code becomes invalid without any compiler error/warning, because of upgrading your library. Where possible this should be prevented.</p>\n\n<p>At the same time, it will cause a lot of confusion. Cause depending on the implementation of the class you put in shared_ptr, it's either defined or undefined behavior. It's less confusing to make it undefined every single time.</p>\n\n<p><code>enable_shared_from_this</code> is a standard workaround for getting a hold of a <code>shared_ptr</code> if you don't have a <code>shared_ptr</code>. A classic example:</p>\n\n<pre><code> struct C : std::enable_shared_from_this&lt;C&gt;\n {\n     auto func()\n     {\n         return std::thread{[c = this-&gt;shared_from_this()]{ /*Do something*/ }};\n     }\n\n     NonCopyable nc;\n };\n</code></pre>\n\n<p>Adding your mentioned extra functionality does add extra code whenever you don't need it, just for the check. Not that it would matter that much, though, zero overhead abstractions ain't nearly zero overhead abstractions. </p>\n"}, {"comments": [{"owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 3, "creation_date": 1559957669, "post_id": 56495305, "comment_id": 99594228, "body": "If you keep reading you&#39;ll also see this: &quot;The ownership of an object can only be shared with another shared_ptr by copy constructing or copy assigning its value to another shared_ptr. Constructing a new shared_ptr using the raw underlying pointer owned by another shared_ptr leads to undefined behavior.&quot;"}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "reply_to_user": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1559962241, "post_id": 56495305, "comment_id": 99594690, "body": "@WillisBlackburn Thank you needed some clarification on that!"}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 1, "creation_date": 1560114059, "post_id": 56495305, "comment_id": 99621812, "body": "To weight in: you can only transfer ownership once. This would be more obvious when using <code>unique_ptr</code> for ownership, as you have to move it. That&#39;s why the general consensus is to replace new/delete with <code>make_unique</code> whenever possible."}], "tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": false, "score": 0, "last_activity_date": 1559914193, "creation_date": 1559914193, "answer_id": 56495305, "question_id": 56465544, "link": "https://stackoverflow.com/questions/56465544/why-does-stdenable-shared-from-this-allow-multiple-stdshared-ptr-instances/56495305#56495305", "title": "Why does std::enable_shared_from_this allow multiple std::shared_ptr instances?", "body": "<p>This is not an answer to the question but more of a reply to user <a href=\"https://stackoverflow.com/users/2466431/jvapen\">jvapen</a> based on his answer to this question.</p>\n\n<p>You had stated this in your answer:</p>\n\n<blockquote>\n<pre><code>struct C {};\n\nC *p = new C();\nstd::shared_ptr&lt;C&gt; p1(p);\nstd::shared_ptr&lt;C&gt; p3(p); // Now a bug\n</code></pre>\n</blockquote>\n\n<p>What I'm not seeing here is how line 5 <code>std::shared_ptr&lt;C&gt; p3(p);</code> is now a bug. According to <a href=\"https://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">cppreference:shared_ptr</a> they specifically state this:</p>\n\n<blockquote>\n  <p><code>std::shared_ptr</code> is a smart pointer that retains shared ownership of an object through a pointer. Several <code>shared_ptr</code> objects may own the same object.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1560172528, "post_id": 56512140, "comment_id": 99637807, "body": "&quot;And I think one can make a strong case for that pattern in special cases.&quot; Could you give some examples?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1560183478, "post_id": 56512140, "comment_id": 99643351, "body": "A simple example is when an object is never destroyed (or not before program termination) and you want to create non owning smart pointers to it; creating multiple independent <code>shared_ptr</code> obviously is not worse than creating just one."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1560192624, "post_id": 56512140, "comment_id": 99647197, "body": "The 1st para of the answer contains some actually: &quot;<i>smart pointer that is either actually non owning (it does nothing when the last copy is reset/destroyed), or carries a copy of the original smart pointer in the control block (in the deleter object) such that when the secondary reference count goes to zero the primary refcount is decremented</i>&quot; (Now you can find these ideas downright <i>bizarre</i> and even believe they are anti-patterns. It&#39;s subjective.)"}, {"owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1560430191, "post_id": 56512140, "comment_id": 99739533, "body": "I was looking for examples of code that uses shared-pointers-to-shared-pointers or &quot;non-owning&quot; shared pointers and some explanation of why such uses are necessary. You suggested that such uses could be confusing and/or bizarre but that a strong case could me made for using them. I&#39;m wondering what that strong case would be."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1560436506, "post_id": 56512140, "comment_id": 99743734, "body": "@WillisBlackburn Non owning shared owning pointer is needed when you use a library component that takes a <code>const shared_ptr&lt;T&gt;&amp;</code> (or <code>shared_ptr&lt;T&gt;</code>) and copies it in order <b>to extend the lifetime of the managed object</b>. A non owning object of course cannot extend the lifetime of anything but for a global object that is never destroyed (or only at program termination) that will be OK. You tell the library that it can extend the lifetime of an object when it really can&#39;t, but it doesn&#39;t matter."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "edited": false, "score": 0, "creation_date": 1560469184, "post_id": 56512140, "comment_id": 99757070, "body": "@WillisBlackburn If you have many threads using a common shared object (mostly read only) you might want to avoid the RMW atomic operation on a common shared object; you could use secondary <code>shared_ptr</code> that hold a primary <code>shared_ptr</code> so that instead of one refcount object you have many different objects and less ping pong occur between cores. Of course at the end of the day more RMW have to be performed as there are more atomic objects but with less sharing, more locality. I have no tested and I don&#39;t know any real world use and practical test of that idea."}], "tags": [], "owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "is_accepted": false, "score": -1, "last_activity_date": 1560056900, "creation_date": 1560056900, "answer_id": 56512140, "question_id": 56465544, "link": "https://stackoverflow.com/questions/56465544/why-does-stdenable-shared-from-this-allow-multiple-stdshared-ptr-instances/56512140#56512140", "title": "Why does std::enable_shared_from_this allow multiple std::shared_ptr instances?", "body": "<p>Creating a secondary smart pointer that is either actually non owning (it does nothing when the last copy is reset/destroyed), or carries a copy of the original smart pointer in the control block (in the deleter object) such that when the secondary reference count goes to zero the primary refcount is decremented, is a very rare occurrence and would probably be confusing for most programmers, but it isn't inherently illegal. (And I think one can make a strong case for that pattern in special cases.)</p>\n\n<p>On the other hand, the existence <code>shared_from_this</code> strongly suggests that there is only one owning <code>shared_ptr</code>, and so having <code>shared_from_this</code> should probably be avoided when multiple sets of <code>std::shared_ptr</code> are expected. Explicit management of self referential non owning pointers is safer as it makes such issues evident in user code, unlike the implicit behavior of <code>std::enable_shared_from_this</code>.</p>\n"}], "owner": {"reputation": 7348, "user_id": 2684196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/45AEF.jpg?s=128&g=1", "display_name": "Willis Blackburn", "link": "https://stackoverflow.com/users/2684196/willis-blackburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 56466686, "answer_count": 4, "score": 2, "last_activity_date": 1560211921, "creation_date": 1559756652, "last_edit_date": 1560211921, "question_id": 56465544, "link": "https://stackoverflow.com/questions/56465544/why-does-stdenable-shared-from-this-allow-multiple-stdshared-ptr-instances", "title": "Why does std::enable_shared_from_this allow multiple std::shared_ptr instances?", "body": "<p>There are several questions that cover the behavior of <code>std::enable_shared_from_this</code>, but I don't think that this is a duplicate.</p>\n\n<p>Classes that inherit from <code>std::enable_shared_from_this</code> carry a <code>std::weak_ptr</code> member. When the application creates a <code>std::shared_ptr</code> pointing to a subclass of <code>std::enable_shared_from_this</code>, the <code>std::shared_ptr</code> constructor checks the <code>std::weak_ptr</code>, and if it is not initialized, initializes it and uses the <code>std::weak_ptr</code> control block for the <code>std::shared_ptr</code>. However, if the <code>std::weak_ptr</code> is already initialized, the constructor just creates a new <code>std::shared_ptr</code> with a new control block. This sets the application up to crash when the reference count of one of the two <code>std::shared_ptr</code> instances goes to zero and deletes the underlying object.</p>\n\n<pre><code>struct C : std::enable_shared_from_this&lt;C&gt; {};\n\nC *p = new C();\nstd::shared_ptr&lt;C&gt; p1(p);\n\n// Okay, p1 and p2 both have ref count = 2\nstd::shared_ptr&lt;C&gt; p2 = p-&gt;shared_from_this();\n\n// Bad: p3 has ref count 1, and C will be deleted twice\nstd::shared_ptr&lt;C&gt; p3(p);\n</code></pre>\n\n<p>My question is: why does the library behave this way? If the <code>std::shared_ptr</code> constructor knows that the object is a <code>std::enable_shared_from_this</code> subclass and bothers to check the <code>std::weak_ptr</code> field, why doesn't it always use same control block for the new <code>std::shared_ptr</code>, thus avoiding a potential crash?</p>\n\n<p>And for that matter, why does the method <code>shared_from_this</code> fail when the <code>std::weak_ptr</code> member is not initialized, instead of just initializing it and returning a <code>std::shared_ptr</code>?</p>\n\n<p>It seems strange that the library works the way that it does, since it fails in situations when it could easily succeed. I'm wondering if there were design considerations/limitations that I don't understand.</p>\n\n<p>I am using Clang 8.0.0 in C++17 mode.</p>\n"}, {"tags": ["c++", "vector", "stl", "iterator"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559756738, "post_id": 56465463, "comment_id": 99522554, "body": "an iterator being invalid is nothing you can reliably check, because &quot;invalid&quot; means it is invalid to dereference it. You cannot dereference it to see if it is still valid"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559756806, "post_id": 56465463, "comment_id": 99522580, "body": "its similar to an invalid pointer. When you dereference it you have undefined behaviour and you might get what you expect or you might not"}, {"owner": {"reputation": 1, "user_id": 10354090, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QKgkY2KORYo/AAAAAAAAAAI/AAAAAAAAAUA/pIjIZhh2fG4/photo.jpg?sz=128", "display_name": "Jojo", "link": "https://stackoverflow.com/users/10354090/jojo"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559758473, "post_id": 56465463, "comment_id": 99523211, "body": "Understood. Do you know why this would happen on Linux but not on macOS?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559761482, "post_id": 56465463, "comment_id": 99524493, "body": "sorry, my first comment was not quite correct. You do know that iterators are invalidated via <code>push_back</code> when the new size is greater than the vectors capacity. Check <code>capacity()</code> to see if both use the same allocation pattern (usually in powers of 2). However, when the iterators are invalid, dereferencing them is undefined behaviour and thats exactly the same on Linux and macOS, the values you get as output are meaningless"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559761542, "post_id": 56465463, "comment_id": 99524517, "body": "this is also related: <a href=\"https://stackoverflow.com/questions/16904454/what-is-iterator-invalidation\" title=\"what is iterator invalidation\">stackoverflow.com/questions/16904454/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 10354090, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QKgkY2KORYo/AAAAAAAAAAI/AAAAAAAAAUA/pIjIZhh2fG4/photo.jpg?sz=128", "display_name": "Jojo", "link": "https://stackoverflow.com/users/10354090/jojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1559756402, "answer_count": 0, "score": 0, "last_activity_date": 1559758118, "creation_date": 1559756312, "last_edit_date": 1559758118, "question_id": 56465463, "link": "https://stackoverflow.com/questions/56465463/difference-between-iterator-invalidation-after-stdvectorpush-back-in-linux", "closed_reason": "Duplicate", "title": "Difference Between Iterator Invalidation After std::vector::push_back() in Linux vs. macOS", "body": "<p>I was recently writing some code to explore iterator invalidation and I came across something I can't quite wrap my head around. Basically, when I add values to the end of a vector such that it must be resized, only the first two elements of the vector are invalidated while the rest remain the same. This only happens on my machine running Ubuntu 18.4.02. When compiled on my Mac (10.04 Mojave), the output of the program suggests that there are no invalid iterators at all.</p>\n\n<p>I've compiled with gcc and clang and the same thing happens after compiling with both.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n  std::vector&lt;int&gt; vec{1, 2, 3, 4, 5, 6, 7, 8, 9};\n  std::cout &lt;&lt; \"vec.size() = \" &lt;&lt; vec.size() &lt;&lt; std::endl;\n\n  for(auto&amp; i : vec)\n  {\n    std::cout &lt;&lt; \"vec element: \" &lt;&lt; i &lt;&lt; std::endl;\n    if( i &lt; 5 )\n    {\n      std::cout &lt;&lt; \"Pushing back...\" &lt;&lt; std::endl;\n      vec.push_back(i + vec.back());\n    }\n  }\n\n  std::cout &lt;&lt; \"vec.size() = \" &lt;&lt; vec.size() &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"Done!\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The output on my Linux machine is this:</p>\n\n<pre><code>vec.size() = 9\nvec element: 1\nPushing back...\nvec element: 0\nPushing back...\nvec element: 3\nPushing back...\nvec element: 4\nPushing back...\nvec element: 5\nvec element: 6\nvec element: 7\nvec element: 8\nvec element: 9\nvec.size() = 13\nDone!\n</code></pre>\n\n<p>The output on my Mac is this:</p>\n\n<pre><code>vec.size() = 9\nvec element: 1\nPushing back...\nvec element: 2\nPushing back...\nvec element: 3\nPushing back...\nvec element: 4\nPushing back...\nvec element: 5\nvec element: 6\nvec element: 7\nvec element: 8\nvec element: 9\nvec.size() = 13\nDone!\n</code></pre>\n\n<p>On the Linux machine, after pushing the first new value to the end of <code>vec</code>, <code>vec[1]</code> is wrong but the rest of the vector is correct. I decided to step through the program in GDB to try and get a better understanding of what was happening. I found that after that first push the capacity of the vector changed (as you'd expect), as did the addresses of its elements (also expected). But, when I looked at the original location in memory of <code>vec</code>'s elements, the values of the first two elements were set to zero while <code>vec[2]</code> through <code>vec[7]</code> were intact.</p>\n\n<p>I have read the <a href=\"https://stackoverflow.com/questions/6438086/iterator-invalidation-rules\">iterator invalidation rules</a>, but they don't really explain why the first two elements of the vector would be zero after resizing while the other elements would remain the same, and why this only happens on my Linux machine and not my Mac, which is really what I'm most curious about.</p>\n\n<p>Thanks in advance for your insight!</p>\n"}, {"tags": ["c++", "cmake", "linker", "sdl"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559758171, "post_id": 56465435, "comment_id": 99523099, "body": "The <code>FindSDL2_image.cmake</code> script you show clearly states that one need to link with the library, contained in <code>SDL2_IMAGE_LIBRARIES</code> variable. I am unable to find usage of this variable in your <code>CMakeLists.txt</code> (except in the commented line). You can always run <code>make VERBOSE=1</code> to see which actual parameters (and libraries among them) are passed to the linker."}, {"owner": {"reputation": 29, "user_id": 11563361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef93d34a150ccd844f71d524302b38a?s=128&d=identicon&r=PG", "display_name": "P.I.N.H.E.A.D.", "link": "https://stackoverflow.com/users/11563361/p-i-n-h-e-a-d"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559763351, "post_id": 56465435, "comment_id": 99525273, "body": "Thanks, I was dimly aware that I needed to uncomment that line, I had used the wrong target to  begin the parameter array for the call.   I also was having second thoughts that I was on the right track.  So I commented it out  because it was throwing an error as it was. Then, I sort of forgot about it as I delved into possible alternatives."}, {"owner": {"reputation": 29, "user_id": 11563361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef93d34a150ccd844f71d524302b38a?s=128&d=identicon&r=PG", "display_name": "P.I.N.H.E.A.D.", "link": "https://stackoverflow.com/users/11563361/p-i-n-h-e-a-d"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559763362, "post_id": 56465435, "comment_id": 99525276, "body": "So I uncommented it...set it to another library as its initial parameter &quot;loaders&quot; which may not be correct, I also used the VERBOSE =1 flag.  I have made small progress perhaps. The error mafic.cpp:(.text+0x2c): undefined reference to `IMG_Load&#39;  has dissapeared. So now i will investigate which executables and headers deal with the remaining undefined functions and try to tackle them individually or en masse whichever is most convenient.  Unless one is a step ahead of me and knows the error of my ways or can expedite the process with clever questioning about the dilapidated state of my code."}, {"owner": {"reputation": 29, "user_id": 11563361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef93d34a150ccd844f71d524302b38a?s=128&d=identicon&r=PG", "display_name": "P.I.N.H.E.A.D.", "link": "https://stackoverflow.com/users/11563361/p-i-n-h-e-a-d"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559787276, "post_id": 56465435, "comment_id": 99531444, "body": "Ok, I seem to have worked out the kinks.  A magnitude harder than I led myself and others to believe.. - Probably did it the wrong way, but doesn&#39;t seem like many are going about it the way I am.  I just went through and linked the libraries in my cmake file by doing this  target_link_libraries(loaders                        -lSDLmain) target_link_libraries(loaders                        -lSDL)         target_link_libraries(loaders                        -lSDL2_ttf)  target_link_libraries(loaders                        -lSDL2_mixer)  and downloading and istalling libs as needed."}, {"owner": {"reputation": 29, "user_id": 11563361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef93d34a150ccd844f71d524302b38a?s=128&d=identicon&r=PG", "display_name": "P.I.N.H.E.A.D.", "link": "https://stackoverflow.com/users/11563361/p-i-n-h-e-a-d"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1559787517, "post_id": 56465435, "comment_id": 99531465, "body": "How do you mark these post as solved?"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1559898278, "post_id": 56465435, "comment_id": 99571373, "body": "&quot;How do you mark these posts as solved?&quot; Questions are solved only when someone writes an answer that you <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accept</a>. You can write an answer yourself, and accept it. You cannot answer a question in comments."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 11563361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef93d34a150ccd844f71d524302b38a?s=128&d=identicon&r=PG", "display_name": "P.I.N.H.E.A.D.", "link": "https://stackoverflow.com/users/11563361/p-i-n-h-e-a-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1559922199, "creation_date": 1559922199, "answer_id": 56497525, "question_id": 56465435, "link": "https://stackoverflow.com/questions/56465435/how-to-link-to-the-code-that-defines-the-sdl-image-h-functions/56497525#56497525", "title": "How to link to the code that defines the sdl_image.h functions?", "body": "<p>Ok, I seem to have worked out the kinks. A magnitude harder than I led myself and others to believe.. - Probably did it the wrong way, but doesn't seem like many are going about it the way I am. I just went through and linked the libraries in my cmake file by doing this target_link_libraries(loaders -lSDLmain) target_link_libraries(loaders -lSDL) target_link_libraries(loaders -lSDL2_ttf) target_link_libraries(loaders -lSDL2_mixer) and downloading and istalling libs as needed.  All this being said, i still have many problems, but i think it's a step closer. </p>\n"}], "owner": {"reputation": 29, "user_id": 11563361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef93d34a150ccd844f71d524302b38a?s=128&d=identicon&r=PG", "display_name": "P.I.N.H.E.A.D.", "link": "https://stackoverflow.com/users/11563361/p-i-n-h-e-a-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559983803, "creation_date": 1559756100, "last_edit_date": 1559983803, "question_id": 56465435, "link": "https://stackoverflow.com/questions/56465435/how-to-link-to-the-code-that-defines-the-sdl-image-h-functions", "title": "How to link to the code that defines the sdl_image.h functions?", "body": "<p>I'm trying to add sound and music to my openGL project.  I'm using Cmake. I get undefined reference errors and have tried for days using many methods and suggestions I've read about, but I am over my head apparently. </p>\n\n<p>I have installed the libraries that I think are needed, I have configured and make installed, tried, finding the packages, added module code to help facilitate it. I am somewhat aware not all of these methods are likely useful in my case. Or maybe I need to have these libraries in my project folder and on my system ...installed. Ok, not super clear about that. I am using Ubuntu Linux  with codeblocks to edit my scripts, but not to compile. </p>\n\n<p>My cmakelists.text</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.0)\n\n\nproject (maficengine LANGUAGES C CXX ASM)\n\n\n\nset(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} \"${CMAKE_SOURCE_DIR}/external/\")\n\n\n\n\nfind_package(OpenGL REQUIRED)\n#FIND_PACKAGE(SDL2_MIXER)\nfind_package(SDL2 REQUIRED)\nfind_package(SDL2_image REQUIRED)\n\ninclude_directories(${SDL2_INCLUDE_DIRS} ${SDL2_IMAGE_INCLUDE_DIRS})\n#target_link_libraries(maficengine ${SDL2_LIBRARIES} ${SDL2_IMAGE_LIBRARIES})\n\nfind_file(SDL2_INCLUDE_DIR NAME SDL.h HINTS SDL2)\nfind_library(SDL2_LIBRARY NAME SDL2)\n\nset(SDL2_INCLUDE_DIR /usr/include/SDL2)\nset(SDL2_LIBRARY /usr/lib/x86_64-linux-gnu/libSDL2.so)\n#file(GLOB_RECURSE SOURCE_FILES/usr/lib/x86_64-linux-gnu\n#   ${CMAKE_SOURCE_DIR}/src/*.c\n#   ${CMAKE_SOURCE_DIR}/src/*.cpp)\n\nINCLUDE(FindPkgConfig)\nPKG_SEARCH_MODULE(SDL2 REQUIRED sdl2)\nPKG_SEARCH_MODULE(SDL REQUIRED sdl)\n\nset(SDL_INCLUDE_DIR \"/usr/include/SDL2\")\nset(SDL_LIBRARY \"SDL2\")\ninclude(FindSDL)\n\nif(SDL_FOUND)\n  message(STATUS \"SDL FOUND\")\n  elseif(!SDL_FOUND)\n     message(STATUS \"SDL not FOUND\")\nendif()\n\n\nfind_library(SDL_MIXER_LIBRARY\n  NAMES SDL2_mixer\n  HINTS\n    ENV SDLMIXERDIR\n    ENV SDLDIR\n  PATH_SUFFIXES lib\n)\n\nif( CMAKE_BINARY_DIR STREQUAL CMAKE_SOURCE_DIR )\n    message( FATAL_ERROR \"Please select another Build Directory ! (and give it a clever name, like bin_Visual2012_64bits/)\" )\nendif()\nif( CMAKE_SOURCE_DIR MATCHES \" \" )\n    message( \"Your Source Directory contains spaces. If you experience problems when compiling, this can be the cause.\" )\nendif()\nif( CMAKE_BINARY_DIR MATCHES \" \" )\n    message( \"Your Build Directory contains spaces. If you experience problems when compiling, this can be the cause.\" )\nendif()\n\nfile(GLOB SOURCES \"external/myCustomHeaders/*.cpp\")\n\n\n\n\n\n\nadd_library(loaders SHARED ${SOURCES}\n${SDL2_INCLUDE_DIR}\nexternal/SDL2_image-2.0.4/SDL_image.h\nexternal/myCustomHeaders/include/loadTexture.h\nexternal/myCustomHeaders/loadTexture.cpp\n/usr/include/SDL2/SDL.h\n/usr/include/SDL/SDL_image.h\nexternal/SDL2_mixer-2.0.4/SDL_mixer.h\n)\ninclude_directories( external/myCustomHeaders/include )\ninclude_directories( external/SDL2_mixer-2.0.4/acinclude )\ninclude_directories( ${CMAKE_CURRENT_SOURCE_DIR}external/SDL2_mixer-2.0.4 )\ninclude_directories(/usr/include/SDL2)\ninclude_directories(/usr/include/SDL)\ninclude_directories(${SDL2_INCLUDE_DIRS})\ninclude(FindPackageHandleStandardArgs)\n\nfind_path(\n  SDL_MIXER_INCLUDE_DIR\n  PATHS\n  /usr/include/SDL\n  /usr/include/SDL2\n  /usr/include\n  /usr/local/include\n  /sw/include\n  /opt/local/include\n  ${SDL_MIXER_ROOT_DIR}/include\n  DOC \"The directory where SDL_mixer.h resides\")\n\n\nlink_directories(external/myCustomHeaders/include)\nlink_directories(external/myCustomHeaders)\nlink_directories(external/SDL2_mixer-2.0.4)\nlink_directories(/usr/include/SDL2)\nlink_directories(/usr/include/SDL)\n# Compile external dependencies\nadd_subdirectory (external)\n\n\n# On Visual 2005 and above, this module can set the debug working directory\ncmake_policy(SET CMP0026 OLD)\ncmake_policy(SET CMP0079  NEW)\n\nlist(APPEND CMAKE_MODULE_PATH \"${CMAKE_SOURCE_DIR}/external/rpavlik-cmake-modules-fe2273\")\ninclude(CreateLaunchers)\ninclude(MSVCMultipleProcessCompile) # /MP\n\nif(INCLUDE_DISTRIB)\n    add_subdirectory(distrib)\nendif(INCLUDE_DISTRIB)\n\n\n\ninclude_directories(\n    external/AntTweakBar-1.16/include/\n    external/glfw-3.1.2/include/\n    external/glm-0.9.7.1/\n    external/glew-1.13.0/include/\n    external/assimp-3.0.1270/include/\n    external/bullet-2.81-rev2613/src/\n    external/myCustomHeaders/include\n    common/\n)\n\nset(ALL_LIBS\n    ${OPENGL_LIBRARY}\n    glfw\n    GLEW_1130\n    loaders\n\n)\n\nadd_definitions(\n    -DTW_STATIC\n    -DTW_NO_LIB_PRAGMA\n    -DTW_NO_DIRECT3D\n    -DGLEW_STATIC\n    -D_CRT_SECURE_NO_WARNINGS\n)\n\n# Tutorial 17\nadd_executable(mageengine\n${SDL2_LIBRARY}\n    Mafic/mafic.cpp\n    common/shader.cpp\n    common/shader.hpp\n    common/controls.cpp\n    common/controls.hpp\n    common/texture.cpp\n    common/texture.hpp\n    common/objloader.cpp\n    common/objloader.hpp\n    common/vboindexer.cpp\n    common/vboindexer.hpp\n    common/quaternion_utils.cpp\n    common/quaternion_utils.hpp\n    Mafic/StandardShading.vertexshader\n    Mafic/StandardShading.fragmentshader\n)\n\n\nset_target_properties(loaders\n   PROPERTIES LINKER_LANGUAGE CXX)\n\n#target_sources(loaders\n# PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/myCustomHeaders/loadTexture.h\n# )\ntarget_link_libraries(mageengine\n    ${ALL_LIBS}\n    ANTTWEAKBAR_116_OGLCORE_GLFW\n    ${SDL2_LIBRARIES}\n\n   loaders\n)\n#target_link_libraries(${maficengine } SDL2::Main SDL2::Image)\n\n# Xcode and Visual working directories\nset_target_properties(mageengine PROPERTIES XCODE_ATTRIBUTE_CONFIGURATION_BUILD_DIR \"${CMAKE_CURRENT_SOURCE_DIR}/Mafic/\")\ncreate_target_launcher(mageengine WORKING_DIRECTORY \"${CMAKE_CURRENT_SOURCE_DIR}/Mafic/\")\n\nSOURCE_GROUP(common REGULAR_EXPRESSION \".*/common/.*\" )\nSOURCE_GROUP(shaders REGULAR_EXPRESSION \".*/.*shader$\" )\n\n\nif (NOT ${CMAKE_GENERATOR} MATCHES \"Xcode\" )\n\nadd_custom_command(\n   TARGET mageengine POST_BUILD\n   COMMAND ${CMAKE_COMMAND} -E copy \"${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_CFG_INTDIR}/mageengine${CMAKE_EXECUTABLE_SUFFIX}\" \"${CMAKE_CURRENT_SOURCE_DIR}/Mafic/\"\n)\n  #target_link_libraries(mageengine LINK_PUBLIC ${mylibrary}\n  # )\n\nelseif (${CMAKE_GENERATOR} MATCHES \"Xcode\" )\n\nendif (NOT ${CMAKE_GENERATOR} MATCHES \"Xcode\" )\n\n</code></pre>\n\n<p>this is my module code that I'm using, I assume its possibly being used by cmake</p>\n\n<pre><code>\n# Locate SDL_image library\n#\n# This module defines:\n#\n# ::\n#\n#   SDL2_IMAGE_LIBRARIES, the name of the library to link against\n#   SDL2_IMAGE_INCLUDE_DIRS, where to find the headers\n#   SDL2_IMAGE_FOUND, if false, do not try to link against\n#   SDL2_IMAGE_VERSION_STRING - human-readable string containing the version of SDL_image\n#\n#\n#\n# For backward compatibility the following variables are also set:\n#\n# ::\n#\n#   SDLIMAGE_LIBRARY (same value as SDL2_IMAGE_LIBRARIES)\n#   SDLIMAGE_INCLUDE_DIR (same value as SDL2_IMAGE_INCLUDE_DIRS)\n#   SDLIMAGE_FOUND (same value as SDL2_IMAGE_FOUND)\n#\n#\n#\n# $SDLDIR is an environment variable that would correspond to the\n# ./configure --prefix=$SDLDIR used in building SDL.\n#\n# Created by Eric Wing.  This was influenced by the FindSDL.cmake\n# module, but with modifications to recognize OS X frameworks and\n# additional Unix paths (FreeBSD, etc).\n\n#=============================================================================\n# Copyright 2005-2009 Kitware, Inc.\n# Copyright 2012 Benjamin Eikel\n#\n# Distributed under the OSI-approved BSD License (the \"License\");\n# see accompanying file Copyright.txt for details.\n#\n# This software is distributed WITHOUT ANY WARRANTY; without even the\n# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n# See the License for more information.\n#=============================================================================\n# (To distribute this file outside of CMake, substitute the full\n#  License text for the above reference.)\n\nfind_path(SDL2_IMAGE_INCLUDE_DIR SDL_image.h\n        HINTS\n        ENV SDL2IMAGEDIR\n        ENV SDL2DIR\n        PATH_SUFFIXES SDL2\n        # path suffixes to search inside ENV{SDLDIR}\n        include/SDL2 include\n        PATHS ${SDL2_IMAGE_PATH}\n        )\n\nif(CMAKE_SIZEOF_VOID_P EQUAL 8)\n    set(VC_LIB_PATH_SUFFIX lib/x64)\nelse()\n    set(VC_LIB_PATH_SUFFIX lib/x86)\nendif()\n\nfind_library(SDL2_IMAGE_LIBRARY\n        NAMES SDL2_image\n        HINTS\n        ENV SDL2IMAGEDIR\n        ENV SDL2DIR\n        PATH_SUFFIXES lib ${VC_LIB_PATH_SUFFIX}\n        PATHS ${SDL2_IMAGE_PATH}\n        )\n\nif(SDL2_IMAGE_INCLUDE_DIR AND EXISTS \"${SDL2_IMAGE_INCLUDE_DIR}/SDL_image.h\")\n    file(STRINGS \"${SDL2_IMAGE_INCLUDE_DIR}/SDL_image.h\" SDL2_IMAGE_VERSION_MAJOR_LINE REGEX \"^#define[ \\t]+SDL_IMAGE_MAJOR_VERSION[ \\t]+[0-9]+$\")\n    file(STRINGS \"${SDL2_IMAGE_INCLUDE_DIR}/SDL_image.h\" SDL2_IMAGE_VERSION_MINOR_LINE REGEX \"^#define[ \\t]+SDL_IMAGE_MINOR_VERSION[ \\t]+[0-9]+$\")\n    file(STRINGS \"${SDL2_IMAGE_INCLUDE_DIR}/SDL_image.h\" SDL2_IMAGE_VERSION_PATCH_LINE REGEX \"^#define[ \\t]+SDL_IMAGE_PATCHLEVEL[ \\t]+[0-9]+$\")\n    string(REGEX REPLACE \"^#define[ \\t]+SDL_IMAGE_MAJOR_VERSION[ \\t]+([0-9]+)$\" \"\\\\1\" SDL2_IMAGE_VERSION_MAJOR \"${SDL2_IMAGE_VERSION_MAJOR_LINE}\")\n    string(REGEX REPLACE \"^#define[ \\t]+SDL_IMAGE_MINOR_VERSION[ \\t]+([0-9]+)$\" \"\\\\1\" SDL2_IMAGE_VERSION_MINOR \"${SDL2_IMAGE_VERSION_MINOR_LINE}\")\n    string(REGEX REPLACE \"^#define[ \\t]+SDL_IMAGE_PATCHLEVEL[ \\t]+([0-9]+)$\" \"\\\\1\" SDL2_IMAGE_VERSION_PATCH \"${SDL2_IMAGE_VERSION_PATCH_LINE}\")\n    set(SDL2_IMAGE_VERSION_STRING ${SDL2_IMAGE_VERSION_MAJOR}.${SDL2_IMAGE_VERSION_MINOR}.${SDL2_IMAGE_VERSION_PATCH})\n    unset(SDL2_IMAGE_VERSION_MAJOR_LINE)\n    unset(SDL2_IMAGE_VERSION_MINOR_LINE)\n    unset(SDL2_IMAGE_VERSION_PATCH_LINE)\n    unset(SDL2_IMAGE_VERSION_MAJOR)\n    unset(SDL2_IMAGE_VERSION_MINOR)\n    unset(SDL2_IMAGE_VERSION_PATCH)\nendif()\n\nset(SDL2_IMAGE_LIBRARIES ${SDL2_IMAGE_LIBRARY})\nset(SDL2_IMAGE_INCLUDE_DIRS ${SDL2_IMAGE_INCLUDE_DIR})\n\ninclude(FindPackageHandleStandardArgs)\n\nFIND_PACKAGE_HANDLE_STANDARD_ARGS(SDL2_image\n        REQUIRED_VARS SDL2_IMAGE_LIBRARIES SDL2_IMAGE_INCLUDE_DIRS\n        VERSION_VAR SDL2_IMAGE_VERSION_STRING)\n\n# for backward compatibility\nset(SDLIMAGE_LIBRARY ${SDL2_IMAGE_LIBRARIES})\nset(SDLIMAGE_INCLUDE_DIR ${SDL2_IMAGE_INCLUDE_DIRS})\nset(SDLIMAGE_FOUND ${SDL2_IMAGE_FOUND})\n\nmark_as_advanced(SDL2_IMAGE_LIBRARY SDL2_IMAGE_INCLUDE_DIR)\n\n</code></pre>\n\n<p>My Cmake error output,  I am a beginner with cmake btw, so laugh all you will.</p>\n\n<pre><code>CMakeFiles/mageengine.dir/Mafic/mafic.cpp.o: In function `load_image(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;)':\nmafic.cpp:(.text+0x2c): undefined reference to `IMG_Load'\nmafic.cpp:(.text+0x43): undefined reference to `SDL_DisplayFormat'\nCMakeFiles/mageengine.dir/Mafic/mafic.cpp.o: In function `init()':\nmafic.cpp:(.text+0x133): undefined reference to `SDL_SetVideoMode'\nmafic.cpp:(.text+0x152): undefined reference to `TTF_Init'\nmafic.cpp:(.text+0x17c): undefined reference to `Mix_OpenAudio'\nmafic.cpp:(.text+0x19e): undefined reference to `SDL_WM_SetCaption'\nCMakeFiles/mageengine.dir/Mafic/mafic.cpp.o: In function `load_files()':\nmafic.cpp:(.text+0x21c): undefined reference to `TTF_OpenFont'\nmafic.cpp:(.text+0x25b): undefined reference to `Mix_LoadMUS'\nmafic.cpp:(.text+0x298): undefined reference to `Mix_LoadWAV_RW'\nmafic.cpp:(.text+0x2bf): undefined reference to `Mix_LoadWAV_RW'\nmafic.cpp:(.text+0x2e6): undefined reference to `Mix_LoadWAV_RW'\nmafic.cpp:(.text+0x30d): undefined reference to `Mix_LoadWAV_RW'\nCMakeFiles/mageengine.dir/Mafic/mafic.cpp.o: In function `clean_up()':\nmafic.cpp:(.text+0x3ba): undefined reference to `Mix_FreeChunk'\nmafic.cpp:(.text+0x3c9): undefined reference to `Mix_FreeChunk'\nmafic.cpp:(.text+0x3d8): undefined reference to `Mix_FreeChunk'\nmafic.cpp:(.text+0x3e7): undefined reference to `Mix_FreeChunk'\nmafic.cpp:(.text+0x3f6): undefined reference to `Mix_FreeMusic'\nmafic.cpp:(.text+0x405): undefined reference to `TTF_CloseFont'\nmafic.cpp:(.text+0x40a): undefined reference to `Mix_CloseAudio'\nmafic.cpp:(.text+0x40f): undefined reference to `TTF_Quit'\ncollect2: error: ld returned 1 exit status\nCMakeFiles/mageengine.dir/build.make:197: recipe for target 'mageengine' failed\nmake[2]: *** [mageengine] Error 1\nCMakeFiles/Makefile2:75: recipe for target 'CMakeFiles/mageengine.dir/all' failed\nmake[1]: *** [CMakeFiles/mageengine.dir/all] Error 2\nMakefile:129: recipe for target 'all' failed\nmake: *** [all] Error 2\n\n</code></pre>\n"}, {"tags": ["javascript", "c++", "qt", "qwebengineview"], "answers": [{"tags": [], "owner": {"reputation": 1446, "user_id": 4267439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5c28773944047f7cb533b3707cac4e0e?s=128&d=identicon&r=PG&f=1", "display_name": "rok", "link": "https://stackoverflow.com/users/4267439/rok"}, "is_accepted": true, "score": 0, "last_activity_date": 1560087474, "creation_date": 1560087474, "answer_id": 56515044, "question_id": 56465364, "link": "https://stackoverflow.com/questions/56465364/qwebengineview-show-page-only-upon-javascript-script-finish/56515044#56515044", "title": "QWebEngineView show page only upon javascript script finish", "body": "<p>The best I was able to do was this:</p>\n\n<p>Before running jquery and waitForKeyElement I hide the entire body</p>\n\n<pre><code>ui-&gt;webView-&gt;page()-&gt;runJavaScript(\"$('body').hide();\");\nui-&gt;webView-&gt;page()-&gt;runJavaScript(jQuery);\nui-&gt;webView-&gt;page()-&gt;runJavaScript(waitForKeyElement);\n</code></pre>\n\n<p>Then in the waitForKeyElement.js my scrollpage function became:</p>\n\n<pre><code>function scrollpage (jNode) {\n  tables = document.getElementsByClassName(\"x-content\");\n  table = tables[0];\n  table.style.backgroundColor=\"transparent\";\n  document.body.style.backgroundColor = \"transparent\";\n  $('body').show();\n  window.scrollTo(0, 80);\n}\n</code></pre>\n\n<p>This is of curse not the best solution, but is acceptable for my purpose.</p>\n"}], "owner": {"reputation": 1446, "user_id": 4267439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5c28773944047f7cb533b3707cac4e0e?s=128&d=identicon&r=PG&f=1", "display_name": "rok", "link": "https://stackoverflow.com/users/4267439/rok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 56515044, "answer_count": 1, "score": 0, "last_activity_date": 1560087474, "creation_date": 1559755793, "question_id": 56465364, "link": "https://stackoverflow.com/questions/56465364/qwebengineview-show-page-only-upon-javascript-script-finish", "title": "QWebEngineView show page only upon javascript script finish", "body": "<p>I'm developing a C++ Qt application with a web view. \nThis is what I'm trying to do: I want to show a webpage (I don't have control on it, so I cannot modify it but I'm sure on what this page do, so don't worry for unexpected behavior) to the user, but only after running some javascript on it.\nThe problem is I'm not able to wait for the javascript. \nI use Qt, QWebEngineView to load the page and to inject javascript file on it using:</p>\n\n<pre><code>void MainWindow::pageloaded(bool ok)\n{\n    ui-&gt;webView-&gt;page()-&gt;runJavaScript(jQuery);\n    ui-&gt;webView-&gt;page()-&gt;runJavaScript(waitForKeyElement,[this](const QVariant &amp;v) { qDebug() &lt;&lt; v.toString();ui-&gt;webView-&gt;show();});\n}\n</code></pre>\n\n<p><code>jquery</code> is just the file <code>jquery.min.js</code> and <code>waitForKeyElement</code> is <a href=\"https://gist.github.com/BrockA/2625891\" rel=\"nofollow noreferrer\">this</a> and basically wait for elements of the page to appear in the DOM.\nAt the end of the latter file I appended my function:</p>\n\n<pre><code>waitForKeyElements (\".x-live-elements\", scrollpage);\nfunction scrollpage (jNode) {\n    window.scrollTo(0, 80);\n    tables = document.getElementsByClassName(\"x-content\");\n    table = tables[0];\n    table.style.backgroundColor=\"transparent\";\n    document.body.style.backgroundColor = \"transparent\";\n}\n</code></pre>\n\n<p>Basically when an element of the class <code>.x-live-elements</code> appears in the DOM, using the callback it scroll down the page and set background of a table and entire body to transparent. This is working, but I'd like to keep the page hidden until this is complete, now the user see the job running for a moment. At the beginning I call the method <code>hide()</code> for the webview, but how to call <code>show()</code> when the javascript is done ?\nMy idea was to add this at the end of <code>waitForKeyElement.js</code> file:</p>\n\n<pre><code>(function (){\n    while(true){\n        var bodyStyle = window.getComputedStyle(document.body, null);\n        var bgcolor = bodyStyle.backgroundColor;\n        var transparent = 'rgba(0, 0, 0, 0)';\n        if (bgcolor === transparent){\n            break;\n        }\n    } \n    a = \"done\";\n    return a; \n})();\n</code></pre>\n\n<p>When the background of the page become transparent (this is basically the last javascript instruction I need) it means that the job is done, so the function should return and callback of runJavascript invoked.. but it doesn't work. It get stuck in the while loop forever and never return, the if condition is never met.\nI know runJavascript is not synchronous, and the callback is fired soon as the javascript file reach the end, but with the while loop I should overcome this.. \nAny help ? </p>\n"}, {"tags": ["c++", "qt", "user-interface", "camera", "ros"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559757928, "post_id": 56465292, "comment_id": 99522990, "body": "It is unclear what your exact problem is. If I understand correctly, you have Qt 5.9.1 application, and you want to use 3rd party library/framework (Ros) with it, but there is exiting adaptation layer (rqt?) which only supports Qt 4? Are you sure about that, have you tried? Because rqt page at ROS Wiki also mentions Qt 5.3 as minimum requirement for something. Also, rqt seems to be maintained, and Qt 4 is no longer supported (for free), so it&#39;d be odd if maintained software required unmaintained Qt version..."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559758183, "post_id": 56465292, "comment_id": 99523104, "body": "Also, &quot;some other IDE&quot;? Qt is not an IDE. Are you confusing Qt (framework) and Qt Creator (general purpose IDE with lot of Qt support built in)."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559758278, "post_id": 56465292, "comment_id": 99523141, "body": "Also, asking for recommendations for external resources is explicitly off topic here, so I would remove that last part of your question. Then clarify what exactly is your problem. SO is geared towards questions about specific problems, not vague &quot;how do I do this complex thing&quot; questions."}, {"owner": {"reputation": 129, "user_id": 11583695, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cmghD6MbkFw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcT1G-dXABy7mLBZnrd1hHZWAer2A/mo/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11583695/brian-kreidberg"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559760229, "post_id": 56465292, "comment_id": 99523960, "body": "I am looking a for anyway to get around this problem?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559770703, "post_id": 56465292, "comment_id": 99528186, "body": "What problem? What error do you get? Which step fails, when you try it?"}, {"owner": {"reputation": 129, "user_id": 11583695, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cmghD6MbkFw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcT1G-dXABy7mLBZnrd1hHZWAer2A/mo/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11583695/brian-kreidberg"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559828047, "post_id": 56465292, "comment_id": 99547835, "body": "on qt version 5.7 or lower there is an option to make a ros program but in 5.8 or higher which is what I need because I am using the multimedia library there is no ros option on the ros website it says you can import a qt project into rqt but the page that is suppose to help you do it is still being developed does anyone know how to do this?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559847228, "post_id": 56465292, "comment_id": 99557272, "body": "So what happens if you try to use it with newer Qt than 5.7?"}, {"owner": {"reputation": 129, "user_id": 11583695, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cmghD6MbkFw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcT1G-dXABy7mLBZnrd1hHZWAer2A/mo/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11583695/brian-kreidberg"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1559848657, "post_id": 56465292, "comment_id": 99557828, "body": "there is no option to make a ros package with the newer qt when I try that is the problem"}], "owner": {"reputation": 129, "user_id": 11583695, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cmghD6MbkFw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcT1G-dXABy7mLBZnrd1hHZWAer2A/mo/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11583695/brian-kreidberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1587365151, "creation_date": 1559755497, "last_edit_date": 1587365151, "question_id": 56465292, "link": "https://stackoverflow.com/questions/56465292/how-do-you-use-ros-with-qt-5-8-or-higher", "title": "How do you use ROS with Qt 5.8 or higher?", "body": "<p>I have made a user interface for a robot that requires the <code>QCamera</code> class, which is only available for Qt 5.8 or higher, to display the camera of the robot. I want to be able to communicate with the user interface and send it values from C++ code to display using ROS. I have put a lot of time into this interface and would hate to scrap it but every tutorial I am finding on the internet on how to connect ROS to Qt is for an older versions of Qt.</p>\n\n<p>Is it possible to use ROS with Qt 5.8 or ideally Qt 5.9.1 since that is what I have currently installed. Or is there a way to display a camera image in Qt 4.8 without the library multimedia widgets.</p>\n\n<p>If I do have to scrap this whole thing anyone have a software recommendation for some other IDE I can use with ROS, possibly RQt? If it is possible could someone give me a link to a good Qt 5.9.1 or 5.12 tutorial on how to install it with ROS cause I am having a hard time finding it.</p>\n"}, {"tags": ["c#", "c++", "visual-studio", "unit-testing", "pinvoke"], "comments": [{"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1559756286, "post_id": 56465218, "comment_id": 99522409, "body": "What I usually do is copy (using post-build events in project, or manually) the .dll(s) at the referencing project&#39;s root (the .dll is a project item) and choose &quot;Copy If Newer&quot; in Visual Studio properties. This way, the .dll will always be copied aside the output of the referencing project (including dependent projects) each time you build it (if it has changed)"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559758054, "post_id": 56465218, "comment_id": 99523043, "body": "<a href=\"https://stackoverflow.com/questions/3863419/are-there-any-better-ways-to-copy-a-native-dll-to-the-bin-folder\" title=\"are there any better ways to copy a native dll to the bin folder\">stackoverflow.com/questions/3863419/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11605290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZL4QNMXINOg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfTvnXDNJAmbpVIuY7s6Ljad10h3g/mo/photo.jpg?sz=128", "display_name": "ivte", "link": "https://stackoverflow.com/users/11605290/ivte"}, "edited": false, "score": 0, "creation_date": 1559825236, "post_id": 56465218, "comment_id": 99546106, "body": "Thanks, this seems to work."}], "owner": {"reputation": 1, "user_id": 11605290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZL4QNMXINOg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfTvnXDNJAmbpVIuY7s6Ljad10h3g/mo/photo.jpg?sz=128", "display_name": "ivte", "link": "https://stackoverflow.com/users/11605290/ivte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587366494, "creation_date": 1559755135, "last_edit_date": 1587366494, "question_id": 56465218, "link": "https://stackoverflow.com/questions/56465218/how-to-force-the-deployment-of-p-invoked-c-library-together-with-the-c-tests", "title": "How to force the deployment of P/Invoked C++ library together with the C# tests on VS Test Explorer?", "body": "<p>I'm trying to make a unit test for a C# library, runnable through the standard Test Explorer UI in Visual Studio 2019. The exact framework, such as xUnit or NUnit, doesn't matter (although I would prefer to use one that is shipped with VS by default, to make it easier for other people to contribute to the project). The issue is that the library P/Invokes some C++ code from another project that it depends on.</p>\n\n<p>This always results in errors such as</p>\n\n<blockquote>\n  <p><code>Message: System.DllNotFoundException : Unable to load DLL 'CppImplementation.dll' or one of its dependencies: The specified module could not be found. (Exception from HRESULT: 0x8007007E)</code></p>\n</blockquote>\n\n<p>Looks like the issue is that running through [Test]->[Run]->[All Tests] completely ignores the Working Directory settings for any of the projects, and deploys the tests somewhere before running them. The C++ dll is not being deployed, so later the code fails to find it anywhere.</p>\n\n<p>The way I'm calling the C++ methods from C# is:</p>\n\n<pre><code>[DllImport(\"CppImplementation.dll\", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]\nprivate static extern int someFunction();\n</code></pre>\n\n<p>I tried creating .testsettings file in the solution and setting it as active. There I checked \"Enable deployment\" and added the compiled C++ .dll to the list of \"Additional files and directories to deploy\" (which already looks weird, because it doesn't look like I can customize this list per configuration, and I would prefer to deploy the correct version, but for now I would be happy to make it work in at least one).</p>\n\n<p>This seems to have no effect whatsoever. The .dll is not getting copied anywhere, and all tests still fail to find it.</p>\n\n<p>I am looking for a way to either force the deployment, or maybe somehow reconfigure the tests to do the right thing anyway. The closer it is to \"the normal way to do it in VS2019\" the better, due to the nature of the project.</p>\n"}, {"tags": ["c++", "floating-point"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 3, "creation_date": 1559754615, "post_id": 56465027, "comment_id": 99521731, "body": "<a href=\"https://en.wikipedia.org/wiki/Machine_epsilon\" rel=\"nofollow noreferrer\">Handy reading</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1559754668, "post_id": 56465027, "comment_id": 99521753, "body": "you cannot avoid rounding error. How do you calculate the crossing points? Different formulas that have the same exact solution can have widly differing numerical stability"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 3, "creation_date": 1559754999, "post_id": 56465027, "comment_id": 99521888, "body": "A couple of somewhat related readings: <a href=\"https://pbrt.org/fp-error-section.pdf\" rel=\"nofollow noreferrer\">pbrt.org/fp-error-section.pdf</a> and <a href=\"https://fenix.tecnico.ulisboa.pt/downloadFile/1689468335601264/Its-Really-Not-a-Rendering-Bug-You-see....pdf\" rel=\"nofollow noreferrer\">fenix.tecnico.ulisboa.pt/downloadFile/1689468335601264/&hellip;</a>"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1559755122, "post_id": 56465027, "comment_id": 99521941, "body": "Sometimes, iterative procedures can help: in your case, if the obtained point is not on the surface exactly, you can perform a projection of this point to the surface. But as noticed above, we cannot be very helpful without more details"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1559755332, "post_id": 56465027, "comment_id": 99522039, "body": "Instead of comparing for exact equality, it&#39;s common to use some reasonable epsilon (say 0.005 for example) and consider values as equal if they are within that epsilon of each other."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1559755673, "post_id": 56465027, "comment_id": 99522170, "body": "@JesperJuhl You have to be super careful when doing that though, to <i>never</i> do that in something that requires a &quot;strict weak ordering&quot; like most standard algorithms or data structures."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1559755981, "post_id": 56465027, "comment_id": 99522283, "body": "A different approach (which may or not be useful to you) is that of <a href=\"https://www.cgal.org/exact.html\" rel=\"nofollow noreferrer\">CGAL</a>."}, {"owner": {"reputation": 405, "user_id": 9177422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c14c092c695c495f5800a92ebfd0b4a?s=128&d=identicon&r=PG&f=1", "display_name": "maurock", "link": "https://stackoverflow.com/users/9177422/maurock"}, "edited": false, "score": 0, "creation_date": 1559756228, "post_id": 56465027, "comment_id": 99522383, "body": "Thank you for your comments! I updated my question, posting the relevant code that I use for to calculate the intersection."}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "is_accepted": false, "score": 0, "last_activity_date": 1559755216, "creation_date": 1559755216, "answer_id": 56465244, "question_id": 56465027, "link": "https://stackoverflow.com/questions/56465027/c-deal-with-floating-point-errors-in-geometric-interpolation/56465244#56465244", "title": "C++ - Deal with floating point errors in geometric interpolation", "body": "<p>You could look into using <code>std::numeric_limits&lt;T&gt;::epsilon</code> for your float/double comparison. And see if your result is in the region +-epsilon.</p>\n\n<p>An alternative would be to not ray trace towards a point. Maybe just place relatively small box or sphere there.</p>\n"}], "owner": {"reputation": 405, "user_id": 9177422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c14c092c695c495f5800a92ebfd0b4a?s=128&d=identicon&r=PG&f=1", "display_name": "maurock", "link": "https://stackoverflow.com/users/9177422/maurock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559756142, "creation_date": 1559754335, "last_edit_date": 1559756142, "question_id": 56465027, "link": "https://stackoverflow.com/questions/56465027/c-deal-with-floating-point-errors-in-geometric-interpolation", "title": "C++ - Deal with floating point errors in geometric interpolation", "body": "<p><strong>Problem</strong></p>\n\n<p>I am writing a ray tracer as a use case for a specific machine learning approach in Computer Graphics.</p>\n\n<p>My problem is that, when I try to find the intersection between a ray and a surface, the result is not exact. <br></p>\n\n<p>Basically, if I am scattering a ray from <i>point O </i> towards a surface located at <i>(x,y,z)</I>, where z = 81, I would expect the solution to be something like <i>S = (x,y,81)</i>.<br> The problem is: I get a solution like <i>(x,y,81.000000005)</i>. <br>\nThis is of course a problem, because following operations depend on that solution, and it needs to be the exact one. \n<br></p>\n\n<p><strong>Question</strong></p>\n\n<p>My question is: how do people in Computer Graphics deal with this problem? I tried to change my variables from <code>float</code> to <code>double</code> and it does not solve the problem. </p>\n\n<p><strong>Alternative solutions</strong></p>\n\n<p>I tried to use the function <code>std::round()</code>. This can only help in specific situations, but not when the exact solution contains one or more significant digits. <br>\nSame for <code>std::ceil()</code> and <code>std::floor()</code>.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>This is how I calculate the intersection with a surface (rectangle) parallel to the <i>xz</i> axes. <br>\nFirst of all, I calculate the distance <code>t</code> between the origin of my Ray and the surface. In case my Ray, in that specific direction, does not hit the surface, <code>t</code> is returned as 0.</p>\n\n<pre><code>class Rectangle_xy: public Hitable {\npublic:\n    float x1, x2, y1, y2, z;\n    ... \n\n    float intersect(const Ray &amp;r) const { // returns distance, 0 if no hit\n        float t = (y - r.o.y) / r.d.y;      // ray.y = t* dir.y\n        const float&amp; x = r.o.x + r.d.x * t;\n        const float&amp; z = r.o.z + r.d.z * t;\n        if (x &lt; x1 || x &gt; x2 || z &lt; z1 || z &gt; z2 || t &lt; 0) {\n            t = 0;\n            return 0;\n        } else {\n            return t;\n        }\n    ....\n    }\n</code></pre>\n\n<p>Specifically, given a Ray and the <code>id</code> of an object in the list (that I want to hit):</p>\n\n<pre><code>inline Vec hittingPoint(const Ray &amp;r, int &amp;id) {\n    float t;                             // distance to intersection\n    if (!intersect(r, t, id))\n        return Vec();\n    const Vec&amp; x = r.o + r.d * t;// ray intersection point (t calculated in intersect())\n    return x ;\n}\n</code></pre>\n\n<p>The function <code>intersect()</code> in the previous snippet of code checks for every Rectangle in the List <code>rect</code> if I intersect some object: </p>\n\n<pre><code>inline bool intersect(const Ray &amp;r, float &amp;t, int &amp;id) {\n    const float&amp; n = NUMBER_OBJ; //Divide allocation of byte of the whole scene, by allocation in byte of one single element\n    float d;\n    float inf = t = 1e20;\n    for (int i = 0; i &lt; n; i++) {\n        if ((d = rect[i]-&gt;intersect(r)) &amp;&amp; d &lt; t) { // Distance of hit point\n            t = d;\n            id = i;\n        }\n    }\n\n    // Return the closest intersection, as a bool\n    return t &lt; inf;\n}\n</code></pre>\n\n<p>The coordinate is then obtained using the geometric interpolation between a line and a surface in the 3D space: <br></p>\n\n<pre><code>Vec&amp; x = r.o + r.d * t;\n</code></pre>\n\n<p>where: <br>\n<code>r.o</code>: it represents the ray origin. It's defined as a r.o : Vec(<code>float a, float b, float c</code>) <br>\n<code>r.d</code> : this is the direction of the ray. As before: r.d: Vec(<code>float d, float e, float f</code>).\n<code>t</code>: <code>float</code> representing the distance between the object and the origin.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559753609, "post_id": 56464842, "comment_id": 99521292, "body": "You probably want template template parameter. or maybe something similar to <code>std::allocator::rebind&lt;U&gt;</code>."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559753656, "post_id": 56464842, "comment_id": 99521308, "body": "I can&#39;t fully understand <i><code>&#47;&#47; &lt;- want to change T to arbitrary type (int for example) without changing T</code></i>? What do you want to achieve here, what&#39;s the use case?"}, {"owner": {"reputation": 1090, "user_id": 358850, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/VUbet.jpg?s=128&g=1", "display_name": "Yury", "link": "https://stackoverflow.com/users/358850/yury"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559753817, "post_id": 56464842, "comment_id": 99521368, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 In most code TDerivedClass&lt;T&gt; is used, but in some cases I have function for comparision of TDerivedClass&lt;T&gt; and TDerivedClass&lt;&gt; with arbitrary other T"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559753970, "post_id": 56464842, "comment_id": 99521425, "body": "So why not using template specialization and maybe SFINAE in first place? <code>TDerivedClass&lt;int&gt; c;</code> is a runtime thing, but shouldn&#39;t."}, {"owner": {"reputation": 465, "user_id": 4715518, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KXsCxW7jiNI/AAAAAAAAAAI/AAAAAAAAADE/re2tSvSBz2c/photo.jpg?sz=128", "display_name": "hoo2", "link": "https://stackoverflow.com/users/4715518/hoo2"}, "edited": false, "score": 0, "creation_date": 1559753995, "post_id": 56464842, "comment_id": 99521438, "body": "I&#39;m not sure I understand it correctly. But if <code>int</code> is the problem, why can you not make it a template parameter to Base? If that&#39;s not the case and you want <code>int</code> to be part of Derived then probably you need something like Jarod42&#39;s suggestion."}, {"owner": {"reputation": 1090, "user_id": 358850, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/VUbet.jpg?s=128&g=1", "display_name": "Yury", "link": "https://stackoverflow.com/users/358850/yury"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559754250, "post_id": 56464842, "comment_id": 99521563, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 template specialization is only for specific types, I don&#39;t want to list all possible T types."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1559754630, "post_id": 56464842, "comment_id": 99521735, "body": "@Yury <i>&quot;template specialization is only for specific types&quot;</i> Yes. <i>&quot;I don&#39;t want to list all possible T types.&quot;</i> You shouldn&#39;t have to, you can use <code>std::enable_if</code> stuff, to point out what specifically should be specialized, there are even helpers to <a href=\"https://en.cppreference.com/w/cpp/types\" rel=\"nofollow noreferrer\">determine categories of `T</a>."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 3, "last_activity_date": 1559753713, "creation_date": 1559753713, "answer_id": 56464896, "question_id": 56464842, "link": "https://stackoverflow.com/questions/56464842/not-fully-specified-template-as-template-argument-in-c/56464896#56464896", "title": "Not fully specified template as template argument in C++", "body": "<p>You probably want template template parameter:</p>\n\n<pre><code>template &lt;typename T, template &lt;typename&gt; class TDerivedClass&gt;\nclass Base\n{\npublic:\n    void f()\n    {\n        std::vector&lt;T&gt; a;\n        TDerivedClass&lt;T&gt; b;\n        TDerivedClass&lt;int&gt; c;\n    }\n};\n\ntemplate&lt;typename T&gt;\nclass Derived1 : public Base&lt;T, Derived1&gt;\n{\n\n};\n\ntemplate&lt;typename T&gt;\nclass Derived2 : public Base&lt;T, Derived2&gt;\n{\n\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": true, "score": 2, "last_activity_date": 1559753875, "creation_date": 1559753875, "answer_id": 56464934, "question_id": 56464842, "link": "https://stackoverflow.com/questions/56464842/not-fully-specified-template-as-template-argument-in-c/56464934#56464934", "title": "Not fully specified template as template argument in C++", "body": "<p>You can pass the template class specifically:</p>\n\n<pre><code>template&lt;typename T, template&lt;typename&gt; class TDerivedTemplate&gt;\nclass Base\n{\n    using TDerivedClass = TDerivedTemplate&lt;T&gt;;\npublic:\n    void f()\n    {\n        std::vector&lt;T&gt; a;\n        TDerivedClass b;\n        TDerivedTemplate&lt;int&gt; c;\n    }\n};\n\ntemplate&lt;typename T&gt;\nclass Derived1 : public Base&lt;T, Derived1&gt;  // Pass the template (Derived1) to instantiate new classes from\n{\n\n};\n\n// Since you're changing the pattern anyways, you might as well\n// have it detect the template from the type\n\ntemplate&lt;typename TDerivedClass&gt;\nclass Base;\n\ntemplate&lt;template&lt;typename&gt; class TDerivedTemplate, typename T&gt;\nclass Base&lt;TDerivedTemplate&lt;T&gt;&gt; {\n    using TDerivedClass = TDerivedTemplate&lt;T&gt;;\npublic:\n    void f() { /* Same as above */ }\n}\n\ntemplate&lt;typename T&gt;\nclass Derived1 : public Base&lt;Derived1&lt;T&gt;&gt;\n// Automatically gets the template. Also means it's harder to use Base&lt;&gt; wrong.\n{\n\n};\n</code></pre>\n\n<p>Or you can use a <code>rebind</code> type trait:</p>\n\n<pre><code>template&lt;typename ToRebind, typename... NewTypes&gt;\nstruct rebind;\n\ntemplate&lt;template&lt;typename...&gt; class Template, typename... CurrentTypes, typename... NewTypes&gt;\nstruct rebind&lt;Template&lt;CurrentTypes...&gt;, NewTypes...&gt; {\n    using type = Template&lt;NewTypes...&gt;;\n}\n\n// Used like\n    TDerivedClass b;\n    typename rebind&lt;TDerivedClass, int&gt;::type c;\n</code></pre>\n"}], "owner": {"reputation": 1090, "user_id": 358850, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/VUbet.jpg?s=128&g=1", "display_name": "Yury", "link": "https://stackoverflow.com/users/358850/yury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56464934, "answer_count": 2, "score": 0, "last_activity_date": 1559753914, "creation_date": 1559753409, "last_edit_date": 1559753914, "question_id": 56464842, "link": "https://stackoverflow.com/questions/56464842/not-fully-specified-template-as-template-argument-in-c", "title": "Not fully specified template as template argument in C++", "body": "<p>In curiously recurring template pattern I need to change nested type <code>T</code> of <code>TDerivedClass&lt;T&gt;</code> type. Is there a way to specify <code>Base</code> by not fully specified <code>Derived1</code> class? Something like that: <code>class Derived1 : public Base&lt;T, Derived1&lt;\"NOT SPECIFIED TYPE SYNTAX\"&gt;&gt;</code>, and then fully specify <code>Derived1</code> but inside <code>Base</code> functions as <code>TDerivedClass&lt;int&gt;</code>. Or is there any other way to change <code>T</code> for this specific part of code?</p>\n\n<pre><code>template&lt;typename T, typename TDerivedClass&gt;\nclass Base\n{\npublic:\n    void f()\n    {\n        std::vector&lt;T&gt; a;\n        TDerivedClass b;\n        TDerivedClass&lt;int&gt; c; // &lt;- want to change T to arbitrary type (to int for example) without changing T\n    }\n};\n\ntemplate&lt;typename T&gt;\nclass Derived1 : public Base&lt;T, Derived1&lt;T&gt;&gt;\n{\n\n};\n\ntemplate&lt;typename T&gt;\nclass Derived2 : public Base&lt;T, Derived2&lt;T&gt;&gt;\n{\n\n};\n</code></pre>\n"}, {"tags": ["c++", "binaryfiles"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1559753808, "post_id": 56464722, "comment_id": 99521365, "body": "You should (learn to) use a debugger. Step though your code one line at a time until the values of your variables differ from what you expect. Your file reading code looks OK to me, BTW."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1559754207, "post_id": 56464722, "comment_id": 99521548, "body": "Marginally related reading: <a href=\"https://stackoverflow.com/questions/22984956/tellg-function-give-wrong-size-of-file\">tellg() function give wrong size of file?</a> Using <code>tellg</code> to get the size of the file falls into the &quot;Usually works, but not guaranteed&quot; camp."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1559754404, "post_id": 56464722, "comment_id": 99521636, "body": "Sidenote: Prefer a <code>std::vector&lt;char&gt; buf(n);</code> to <code>char *buf = new char[n];</code> <code>vector</code> leaves you with fewer opportunities for error."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1559754516, "post_id": 56464722, "comment_id": 99521688, "body": "Sidenote to sidenote: Read <a href=\"https://en.cppreference.com/w/cpp/container/vector_bool\" rel=\"nofollow noreferrer\"><code>std::vector&lt;bool&gt;</code></a> before trying the same trick with <code>bool</code>. <code>vector</code>s of <code>bool</code> are so weird that they get their own documentation page."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1559786200, "post_id": 56464722, "comment_id": 99531245, "body": "<i>&quot;I think my problem is [...]&quot;</i> -- Good, you have a hypothesis. The next step of the scientific method is to test that hypothesis. A debugger could help with that. Or maybe you want to write out your <code>s</code> array after you finish constructing it. Whichever method you choose, let us know the result."}], "answers": [{"tags": [], "owner": {"reputation": 70, "user_id": 2733837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68db816e58d0ff50f62f826d941699f?s=128&d=identicon&r=PG&f=1", "display_name": "Valeca", "link": "https://stackoverflow.com/users/2733837/valeca"}, "is_accepted": false, "score": 0, "last_activity_date": 1559758544, "last_edit_date": 1559758544, "creation_date": 1559758136, "answer_id": 56465865, "question_id": 56464722, "link": "https://stackoverflow.com/questions/56464722/how-to-read-binary-files-properly/56465865#56465865", "title": "How to read binary files properly?", "body": "<p>For this part:</p>\n\n<pre><code>for (int i = 0; i &lt; n / 8; i++) {\n\n    for (int j = 7; j &gt;= 0; j--) {\n\n        s[(i) * 8 + 7 - j] = (bool)((buf[i] &gt;&gt; j) &amp; 1);\n    }\n }\n</code></pre>\n\n<p>when you add elements to s array, looks like you switch the position of bytes inside each character: the last bit in character in buf goes into the first bit in character in s array, because the shift initially is 7, so you take first bit in char from buf[], but for s[] it looks to be 0, resulting in swapping. It is easy to verify with debugger though, as from code it is not so obvious. Thanks.</p>\n"}], "owner": {"reputation": 1, "user_id": 4399851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PGzCdvQ9sgI/AAAAAAAAAAI/AAAAAAAAACs/TQV-bJv7_wI/photo.jpg?sz=128", "display_name": "Alexandra Neverovskaya", "link": "https://stackoverflow.com/users/4399851/alexandra-neverovskaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1559758544, "creation_date": 1559752807, "question_id": 56464722, "link": "https://stackoverflow.com/questions/56464722/how-to-read-binary-files-properly", "title": "How to read binary files properly?", "body": "<p>I have a problem with the NIST/Diehard Binary Matrix test. It's about dividing a binary sequence into a 32x32 matrix and calculating its rank. After calculating ranks I need to compute a xi^2 value and then calculate p-value(must be from 0 to 1). I'm getting p-value extremely small even in a random sequence. </p>\n\n<p>I've tried to hardcode some small examples and getting my p-value right though I think my problem is in reading a binary sequence file and getting bits from it. </p>\n\n<p>This is reading from a file and converting to bits sequence.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>ifstream fin(\"seq1.bin\", ios::binary);\n    fin.seekg(0, ios::end);\n    int n = fin.tellg();\n    unsigned int start, end;\n    char *buf = new char[n];\n    fin.seekg(0, ios::beg);\n    fin.read(buf, n);\n    n *= 8;\n    bool *s = new bool[n];\n    for (int i = 0; i &lt; n / 8; i++) {\n        for (int j = 7; j &gt;= 0; j--) {\n            s[(i) * 8 + 7 - j] = (bool)((buf[i] &gt;&gt; j) &amp; 1);\n        }\n    }\n</code></pre>\n\n<p>Then I form my matrix and calculate it's rank </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>    int *ranks = new int[N];\n\n    for (int i = 0; i &lt; N; i++) {\n        bool *arr = new bool[m*q];\n        copy(s + i * m*q, s +(i * m*q) + (m * q), arr);\n        ranks[i] = binary_rank(arr, m, q);\n    }\n</code></pre>\n\n<p>Cheking occurance in ranks</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int count_occurrences(int arr[], int n, int x){\n    int result = 0;\n    for (int i = 0; i &lt; n; i++)\n        if (x == arr[i])\n            result++;\n    return result;\n}\n</code></pre>\n\n<p>Calculating xi^2 and p-value</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>double calculate_xi(int fm, int fm_1, int remaining, int N) {\n    double N1 = 0.2888*N;\n    double N2 = 0.5776*N;\n    double N3 = 0.1336*N;\n    double x1 = (fm - N1)*(fm - N1) / N1;\n    double x2 = (fm_1 - N2)*(fm_1 - N2) / N2;\n    double x3 = (remaining - N3)*(remaining - N3) / N3;\n    return x1 + x2 + x3;\n}\ndouble calculate_pvalue(double xi2) {\n    return exp(-(xi2 / 2));\n}\n</code></pre>\n\n<p>I expect p-value between 0 and 1 but getting 0 every time. It's because of the extremely big xi^2 value and I couldn't find what I've done wrong. Could you please help me to get things right.</p>\n"}, {"tags": ["c++", "object-slicing"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1559753000, "post_id": 56464702, "comment_id": 99521073, "body": "<code>_gameObjects</code> is fine. A pointer or reference avoids the object slicing. <code>Gameobject g = b;</code> is not fine."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559753276, "post_id": 56464702, "comment_id": 99521196, "body": "^ ... or even better use a <i>smart pointer</i> like <code>std::unique_ptr&lt;GameObject&gt;</code> or <code>std::shared_ptr&lt;GameObject&gt;</code> to store in the container."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1559753958, "post_id": 56464702, "comment_id": 99521422, "body": "<code>GameObject g</code> wouldn&#39;t even compile because <code>GameObject</code> contains a &quot;pure virtual&quot; method (i.e. one required to be implemented by subclasses). So you can&#39;t create an object of type <code>GameObject</code>."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 5, "last_activity_date": 1559753118, "creation_date": 1559753118, "answer_id": 56464783, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing/56464783#56464783", "title": "Avoiding object slicing", "body": "<p>Object slicing happens when you directly store objects in a container. No slicing can occur when you store pointers (or better smart pointers) to objects. So it you store a <code>Ball</code> in a <code>vector&lt;GameObject&gt;</code> it will be sliced, but if you store a <code>Ball *</code> in a <code>vector&lt;GameObject *&gt;</code>, all will be fine.</p>\n"}, {"tags": [], "owner": {"reputation": 674, "user_id": 11443248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cd00135ccb2cd2cd510a706b1932a9?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Willmon", "link": "https://stackoverflow.com/users/11443248/kyle-willmon"}, "is_accepted": false, "score": 1, "last_activity_date": 1559753478, "creation_date": 1559753478, "answer_id": 56464853, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing/56464853#56464853", "title": "Avoiding object slicing", "body": "<p>The quick answer to your question is that object slicing is not an issue when you do <code>_gameObjects.push_back( new Ball( ... ))</code> because <code>new</code> allocates enough memory for a <code>Ball</code>-sized object.</p>\n\n<p>Here's the explanation. Object slicing is an issue where the compiler believes an object to be smaller than it actually is. So in your code example:</p>\n\n<pre><code>Ball b;\nGameObject g = b;\n</code></pre>\n\n<p>The compiler has reserved enough space for a <code>GameObject</code> named <code>g</code>, and yet you are trying to put a <code>Ball</code> (<code>b</code>) there. But a <code>Ball</code> may be bigger than a <code>GameObject</code>, and then data will get lost and bad stuff will likely start to happen.</p>\n\n<p>However, when you do <code>new Ball(...)</code> or <code>new GameObject(...)</code>, the compiler knows exactly how much space to allocate because it knows the true type of the object. Then, what you store is actually a <code>Ball*</code> or <code>GameObject*</code>. And you can safely store a <code>Ball*</code> in a <code>GameObject*</code> type because the pointers are the same size, so object slicing does not occur. The memory pointed at can be any number of different sizes, but the pointers will always be the same size.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1559755613, "last_edit_date": 1559755613, "creation_date": 1559754301, "answer_id": 56465020, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing/56465020#56465020", "title": "Avoiding object slicing", "body": "<blockquote>\n  <p>Btw why do we need to say <code>virtual</code> for it?</p>\n</blockquote>\n\n<p>If you don't declare a function to be virtual, then you cannot call the function with virtual dispatch. When a function is called virtually through a pointer or reference to a base class, then the call is dispatched to an override in the most derived class (if any exist). In other words, <code>virtual</code> allows runtime polymorphism.</p>\n\n<p>If the function is non-virtual, then the function can only be dispatched statically. When a function is called statically, the function of the compile time type is called. So, if a function is called statically though a base pointer, then the base function is called, not a derived override.</p>\n\n<blockquote>\n  <p>BTW Why would we use pointers here? why not just pure GameObjects?</p>\n</blockquote>\n\n<p><code>GameObject</code> is an abstract class, so you cannot have concrete objects of that type. Since you cannot have a concrete <code>GameObject</code>, you cannot have an array (nor vector) of them either. <code>GameObject</code> instances can only exist as a base class sub object of a derived type.</p>\n\n<blockquote>\n  <p><code>new</code> returns a pointer to the object correct?</p>\n</blockquote>\n\n<p><code>new</code> creates an object in dynamic storage, and returns pointer to that object.</p>\n\n<p>By the way, if you fail to call <code>delete</code> on the pointer before losing the pointer value, you have a memory leak. Oh, and if you attempt to <code>delete</code> something twice, or <code>delete</code> something that didn't originate from <code>new</code>, the behaviour of your program will be undefined. Memory allocation is difficult, and you should always use smart pointers to manage it. A vector of bare owning pointers such as in your example is a very bad idea.</p>\n\n<p>Furthermore, deleting an object through a base object pointer has undefined behaviour unless the destructor of the base class is virtual. The destructor of <code>GameObject</code> is not virtual, so there is no way for your program to avoid either UB or memory leak. Both options are bad. Solution is to make the destructor of <code>GameObject</code> virtual.</p>\n\n<blockquote>\n  <p>Avoiding object slicing</p>\n</blockquote>\n\n<p>You can avoid accidental object slicing by making the base class abstract. Since there can not be concrete instances of an abstract class, you cannot accidentally \"slice off\" the base of a derived object.</p>\n\n<p>For example:</p>\n\n<pre><code>Ball b;\nGameObject g = b;\n</code></pre>\n\n<p>is ill-formed because <code>GameObject</code> is an abstract class. The compiler might say something like this:</p>\n\n<pre><code>main.cpp: In function 'int main()':\nmain.cpp:16:20: error: cannot allocate an object of abstract type 'GameObject'\n GameObject g = b;\n                ^\nmain.cpp:3:7: note:   because the following virtual functions are pure within 'GameObject':\n class GameObject\n       ^~~~~~~~~~\nmain.cpp:7:18: note:    'virtual void GameObject::Draw()'\n     virtual void Draw( ) = 0;\n                  ^~~~\nmain.cpp:16:16: error: cannot declare variable 'g' to be of abstract type 'GameObject'\n     GameObject g = b;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "is_accepted": false, "score": 1, "last_activity_date": 1559759421, "last_edit_date": 1559759421, "creation_date": 1559755111, "answer_id": 56465206, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing/56465206#56465206", "title": "Avoiding object slicing", "body": "<p>I will attempt to answer the various questions you have asked, although others may have a more technical explanation in their answers.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>virtual void Draw( ) = 0;\n</code></pre>\n\n<blockquote>\n  <p>Why do we need to say virtual for it?</p>\n</blockquote>\n\n<p>In simple terms, the <code>virtual</code> keyword tells the C++ compiler that the function can be redefined in a child class. When you go to call <code>ball.Draw()</code> the compiler knows that <code>Ball::Draw()</code> should be executed if it exists in the <code>Ball</code> class instead of <code>GameObject::Draw()</code>.</p>\n\n<hr>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::vector&lt;GameObject*&gt; _gameObjects;\n</code></pre>\n\n<blockquote>\n  <p>Why would we use pointers here?</p>\n</blockquote>\n\n<p>This is a good idea because object slicing does happen when the container has to allocate space for and contain the objects themselves. Remember that a pointer is a constant size, regardless of what it points to. When you have to resize the container or move elements around, the pointers are much easier and faster to move. And you can always cast a pointer to <code>GameObject</code> back into a pointer to <code>Ball</code> if you are certain that is a valid thing to do.</p>\n\n<hr>\n\n<blockquote>\n  <p><code>new</code> returns a pointer to the object correct?</p>\n</blockquote>\n\n<p>Yes, what <code>new</code> is doing is constructing an instance of that class on the heap and then returning a pointer to that instance.<br>\nI strongly recommend that you learn how to use <a href=\"https://en.cppreference.com/book/intro/smart_pointers\" rel=\"nofollow noreferrer\">smart pointers</a> though. These can automatically delete objects when they are no longer referenced. Kind of like what a garbage collector does in a language like Java or C#.</p>\n\n<hr>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>new Ball( -1, 1, boardWidth / 2, boardHeight / 2 );\n</code></pre>\n\n<blockquote>\n  <p>...or is that automatically assigning it as a GameObject too?</p>\n</blockquote>\n\n<p>Yes, if <code>Ball</code> inherits the <code>GameObject</code> class, then a pointer to a <code>Ball</code> will also be a valid pointer to a <code>GameObject</code>. As you'd expect, you can't access the members of <code>Ball</code> from a pointer to a <code>GameObject</code> though.</p>\n\n<hr>\n\n<blockquote>\n  <p>Does it have to do with creating an object via new vs just Ball ball for example?</p>\n</blockquote>\n\n<p>I will explain the difference between the two ways to instantiate a <code>Ball</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>Ball ballA = Ball();\nBall* ballB = new Ball();\n</code></pre>\n\n<p>For <code>ballA</code> we are declaring that the <code>ballA</code> variable is an instance of <code>Ball</code> that will \"live\" in the stack memory. We use the <code>Ball()</code> constructor to initialize the <code>ballA</code> variable to an instance of a <code>Ball</code>. Since this is a stack variable the <code>ballA</code> instance will be destroyed once the program exits the scope in which it is declared.</p>\n\n<p>For <code>ballB</code> we are declaring that the <code>ballB</code> variable is a pointer to an instance of <code>Ball</code> that will live in the heap memory. We use the <code>new Ball()</code> statement to first allocate heap memory for a <code>Ball</code> and then construct it with the <code>Ball()</code> constructor. Finally that <code>new</code> statement evaluates to a pointer which is assigned to <code>ballB</code>.\nNow when the program exits the scope where <code>ballB</code> is declared, the pointer is destroyed but the instance it pointed to is left on the heap. If you didn't save the value of that pointer somewhere else you will be unable to free the memory used by that <code>Ball</code> instance. This is why smart pointers are useful because they internally keep track of whether the instance is still referenced anywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1559757002, "last_edit_date": 1559757002, "creation_date": 1559755226, "answer_id": 56465245, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing/56465245#56465245", "title": "Avoiding object slicing", "body": "<p>This has to do with values.</p>\n\n<pre><code>Ball b;\nGameObject g;\n</code></pre>\n\n<p>The value of <code>b</code> is the different values of it's variables.</p>\n\n<p>The value of <code>g</code> is likewise the different values of it's variables.</p>\n\n<p>When <code>b</code> is assigned to <code>g</code>, the variables of a \"subobject\" of <code>b</code> (inherited from <code>GameObject</code> ) are assigned to variables of <code>g</code>. This is slicing.</p>\n\n<p>Now about the functions.</p>\n\n<p>To the compiler a member function of a class is a pointer to a memory where the code of the function resides.</p>\n\n<p>A non-virtual function is always a constant pointer value.</p>\n\n<p>But a virtual function can have different values depending on which class they were declared in.</p>\n\n<p>So to tell the compiler that it should create a placeholder for the function pointer, the keyword <code>virtual</code> is used.</p>\n\n<p>Now back to the assignment of values.</p>\n\n<p>We know assigning different types of variables to each other can cause slicing. So to solve this issue indirection is used - a pointer to the object.</p>\n\n<p>A pointer always needs the same amount of strorage for any pointer of a type. And when a pointer is assigned, the underlying structure is left unchanged, only the pointer is copied which overrides the previous pointer.</p>\n\n<p>When we call a virtual function on <code>g</code> which has been sliced, we might be calling the correct <code>function</code> from <code>b</code>, but the sliced <code>g</code> object doesn't have all the fields needed by the <code>b</code> function, so an error can occur.</p>\n\n<p>But calling using a pointer to the object, the original object <code>b</code> is used, which has all the required fields used by the virtual function of <code>b</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1559756036, "post_id": 56465393, "comment_id": 99522302, "body": "Sorry for the wall of text, but your question is a bit ... vague and unfocused. I hope I could clear up at least some issues."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1559755930, "creation_date": 1559755930, "answer_id": 56465393, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing/56465393#56465393", "title": "Avoiding object slicing", "body": "<p>The fundamental issue is copying an object (which is not an issue in languages where classes are \"reference types\", but in C++ the default is to pass things by value, i.e. making a copy). \"Slicing\" means copying the value of a bigger object (of type <code>B</code>, which derives from <code>A</code>) into a smaller object (of type <code>A</code>). Because <code>A</code> is smaller, only a partial copy is made.</p>\n\n<p>When you create a container, its elements are full objects of their own. For example:</p>\n\n<pre><code>std::vector&lt;int&gt; v(3);  // define a vector of 3 integers\nint i = 42;\nv[0] = i;  // copy 42 into v[0]\n</code></pre>\n\n<p><code>v[0]</code> is an <code>int</code> variable, just like <code>i</code>.</p>\n\n<p>The same thing happens with classes:</p>\n\n<pre><code>class Base { ... };\nstd::vector&lt;Base&gt; v(3);  // instantiates 3 Base objects\nBase x(42);\nv[0] = x;\n</code></pre>\n\n<p>The last line copies the contents of the <code>x</code> object into the <code>v[0]</code> object.</p>\n\n<p>If we change the type of <code>x</code> like this:</p>\n\n<pre><code>class Derived : public Base { ... };\nstd::vector&lt;Base&gt; v(3);\nDerived x(42, \"hello\");\nv[0] = x;\n</code></pre>\n\n<p>... then <code>v[0] = x</code> tries to copy the contents of a <code>Derived</code> object into a <code>Base</code> object. What happens in this case is that all members declared in <code>Derived</code> are ignored. Only the data members declared in the base class <code>Base</code> are copied, because that's all <code>v[0]</code> has room for.</p>\n\n<p>What a pointer gives you is the ability to avoid copying. When you do</p>\n\n<pre><code>T x;\nT *ptr = &amp;x;\n</code></pre>\n\n<p>, <code>ptr</code> is not a copy of <code>x</code>, it just points to <code>x</code>.</p>\n\n<p>Similarly, you can do</p>\n\n<pre><code>Derived obj;\nBase *ptr = &amp;obj;\n</code></pre>\n\n<p><code>&amp;obj</code> and <code>ptr</code> have different types (<code>Derived *</code> and <code>Base *</code>, respectively), but C++ allows this code anyway. Because <code>Derived</code> objects contain all members of <code>Base</code>, it's OK to let a <code>Base</code> pointer point at a <code>Derived</code> instance.</p>\n\n<p>What this gives you is essentially a reduced interface to <code>obj</code>. When accessed through <code>ptr</code>, it only has the methods declared in <code>Base</code>. But because no copying was done, all data (including the <code>Derived</code> specific parts) are still there and can be used internally.</p>\n\n<p>As for <code>virtual</code>: Normally, when you call a method <code>foo</code> through an object of type <code>Base</code>, it will invoke exactly <code>Base::foo</code> (i.e. the method defined in <code>Base</code>). This happens even if the call is made through a pointer that actually points at a derived object (as described above) with a different implementation of the method:</p>\n\n<pre><code>class Base {\n    public:\n    void foo() const { std::cout &lt;&lt; \"hello from Base::foo\\n\"; }\n};\n\nclass Derived : public Base {\n    public:\n    void foo() const { std::cout &lt;&lt; \"hello from Derived::foo\\n\"; }\n};\n\nDerived obj;\nBase *ptr = &amp;obj;\nobj.foo();  // calls Derived::foo\nptr-&gt;foo();  // calls Base::foo, even though ptr actually points to a Derived object\n</code></pre>\n\n<p>By marking <code>foo</code> as <code>virtual</code>, we force the method call to use the actual type of the object, instead of the declared type of the pointer the call is made through:</p>\n\n<pre><code>class Base {\n    public:\n    virtual void foo() const { std::cout &lt;&lt; \"hello from Base::foo\\n\"; }\n};\n\nclass Derived : public Base {\n    public:\n    void foo() const { std::cout &lt;&lt; \"hello from Derived::foo\\n\"; }\n};\n\nDerived obj;\nBase *ptr = &amp;obj;\nobj.foo();  // calls Derived::foo\nptr-&gt;foo();  // also calls Derived::foo\n</code></pre>\n\n<p><code>virtual</code> has no effect on normal objects because there the declared type and the actual type are always the same. It only affects method calls made through pointers (and references) to objects, because those have the ability to refer to other objects (of potentially different types).</p>\n\n<p>And that is another reason to store a collection of pointers: When you have several different subclasses of <code>GameObject</code>, all of which implement their own custom <code>draw</code> method, you want the code to pay attention to the actual types of the objects, so the right method gets called in each case. If <code>draw</code> weren't virtual, your code would attempt to invoke <code>GameObject::draw</code>, which doesn't exist. Depending on how exactly you code it, this either wouldn't compile in the first place or abort at runtime.</p>\n"}], "owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 2, "accepted_answer_id": 56465393, "answer_count": 6, "score": 2, "last_activity_date": 1559759421, "creation_date": 1559752721, "last_edit_date": 1559753685, "question_id": 56464702, "link": "https://stackoverflow.com/questions/56464702/avoiding-object-slicing", "title": "Avoiding object slicing", "body": "<p>So I am refreshing on C++, and honestly it's been awhile. I made a console pong game as a sort of refresher task and got some input on using polymorphism for my classes to derive from a base \"GameObject\" (that has some base methods for drawing objects to the screen).</p>\n\n<p>One of the pieces of input was (and I had subsequently asked about) was how memory worked when deriving from base classes. Since I hadn't really done much advanced C++.</p>\n\n<p>For instance lets say we have a base class, for now it just has a \"draw\" method (Btw why do we need to say <code>virtual</code> for it?), since all other derived objects really only share one common method, and that's being drawn:</p>\n\n<pre><code>class GameObject\n{\npublic:\n\n    virtual void Draw( ) = 0;\n};\n</code></pre>\n\n<p>we also have a ball class for instance:</p>\n\n<pre><code>class Ball : public GameObject\n</code></pre>\n\n<p>The input I received is that in a proper game these would probably be kept in some sort of vector of GameObject pointers. Something like this: <code>std::vector&lt;GameObject*&gt; _gameObjects;</code> </p>\n\n<p>(So a vector of pointers to GameObjects) (BTW Why would we use pointers here? why not just pure GameObjects?). We would instantiate one of these gameObjects with something like:</p>\n\n<pre><code>_gameObjects.push_back( new Ball( -1, 1, boardWidth / 2, boardHeight / 2 ); ); \n</code></pre>\n\n<p>(<code>new</code> returns a pointer to the object correct? IIRC). From my understanding if I tried to do something like:</p>\n\n<pre><code>Ball b;\nGameObject g = b;\n</code></pre>\n\n<p>That things would get messed up (as seen here: <a href=\"https://stackoverflow.com/questions/274626/what-is-object-slicing\">What is object slicing?</a>)</p>\n\n<p>However...am I not simply creating Derived objects on their own when I do the <code>new Ball( -1, 1, boardWidth / 2, boardHeight / 2 );</code> or is that automatically assigning it as a GameObject too? I can't really figure out why one works and one doesn't. Does it have to do with creating an object via <code>new</code> vs just <code>Ball ball</code> for example?</p>\n\n<p>Sorry if the question makes no sense, im just trying to understand how this object slicing would happen. </p>\n"}, {"tags": ["c++", "pass-by-reference"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 2, "creation_date": 1559752473, "post_id": 56464631, "comment_id": 99520844, "body": "Remove <code>const</code> in <code>const std::vector&lt;std::vector&lt;double&gt;&gt;&amp;</code>? Note that any modifications to <code>avg</code> will then be visible outside of <code>assign</code> though."}, {"owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1559752605, "post_id": 56464631, "comment_id": 99520904, "body": "is that the only way? I was hoping I could keep the <code>const</code> to ensure <code>avg</code>&#39;s values don&#39;t change"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1559752637, "post_id": 56464631, "comment_id": 99520921, "body": "Then use <code>double const* ptr = &amp;avg[k-1][0];</code>"}], "answers": [{"tags": [], "owner": {"reputation": 8084, "user_id": 2896626, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd83959d7fe39c658d2e49cfecfe4b6?s=128&d=identicon&r=PG&f=1", "display_name": "Paul92", "link": "https://stackoverflow.com/users/2896626/paul92"}, "is_accepted": true, "score": 3, "last_activity_date": 1559752654, "creation_date": 1559752654, "answer_id": 56464688, "question_id": 56464631, "link": "https://stackoverflow.com/questions/56464631/how-assign-const-reference-to-pointer-within-function-in-c/56464688#56464688", "title": "How assign const reference to pointer within function in C++?", "body": "<p>You cannot modify a <code>const</code> object either directly or indirectly. This includes its assignment to objects that can be modified (non-const).</p>\n\n<p>There are 2 options: either make <code>ptr</code> const, or remove the constness of the argument. The former would make the pointer read only (which might be fine or not), while the later would open the reference to changes (which is not really a good thing in most of the cases).</p>\n\n<p>You can also consider if you really need to have that pointer.</p>\n"}], "owner": {"reputation": 1430, "user_id": 5739619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dc9137cd10cc63c14d4c774bc81ef98a?s=128&d=identicon&r=PG&f=1", "display_name": "user5739619", "link": "https://stackoverflow.com/users/5739619/user5739619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 56464688, "answer_count": 1, "score": 0, "last_activity_date": 1559752654, "creation_date": 1559752444, "question_id": 56464631, "link": "https://stackoverflow.com/questions/56464631/how-assign-const-reference-to-pointer-within-function-in-c", "title": "How assign const reference to pointer within function in C++?", "body": "<p>I had a function</p>\n\n<pre><code>void assign(std::vector&lt;std::vector&lt;double&gt;&gt; avg, int k) {\n    double* ptr=&amp;avg[k-1][0]\n    //other stuff, but above is only line involving \"avg\" variable\n}\n</code></pre>\n\n<p>But the function was running slower than I wanted because I passed by value instead of reference. If I tried the below:</p>\n\n<pre><code>void assign(const std::vector&lt;std::vector&lt;double&gt;&gt;&amp; avg, int k) {\n    double* ptr=&amp;avg[k-1][0]\n    //other stuff\n}\n</code></pre>\n\n<p>Then I get the error <code>cannot convert from const_Ty * to double*</code>. How can I have the function pass <code>avg</code> by reference?</p>\n"}, {"tags": ["c++", "embedded", "arduino-due"], "comments": [{"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1559788886, "post_id": 56464605, "comment_id": 99531659, "body": "I&#39;ll post an answer regarding the syntax, but you could make this question more useful to others if you came up with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. That would entail two key steps: strip out unneeded code and add needed definitions. Since this is basically a syntax question, you could strip out most functions that do not make use of <code>_callbackPt</code>. Also, for the needed definitions, just some dummy definitions to allow compilation would suffice."}, {"owner": {"reputation": 145, "user_id": 10069961, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tNs4Wl3aEdA/AAAAAAAAAAI/AAAAAAAAF-M/TUOudyzzNz4/photo.jpg?sz=128", "display_name": "Daan van Driel", "link": "https://stackoverflow.com/users/10069961/daan-van-driel"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1560241293, "post_id": 56464605, "comment_id": 99660539, "body": "@JaMiT Thanks for the quick reply. I&#39;ll try to make rewrite my question."}], "answers": [{"tags": [], "owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "is_accepted": false, "score": 1, "last_activity_date": 1559788972, "creation_date": 1559788972, "answer_id": 56470295, "question_id": 56464605, "link": "https://stackoverflow.com/questions/56464605/how-to-make-a-function-pointer-array-of-typedefined-functions/56470295#56470295", "title": "How to make a function pointer array of typedefined functions", "body": "<blockquote>\n  <p>a value of type \"<code>AnimUpdateCallback (Animator::*)(const AnimationParam &amp;param)</code>\" cannot be used to initialize an entity of type \"<code>AnimUpdateCallback (*)(const AnimationParam &amp;param)</code>\"</p>\n</blockquote>\n\n<p>This is true. I don't see the code that causes this error, but presumably you are using a non-static member function of <code>Animator</code> to initialize an element of your array. (Is that what <code>wipeColorAnim</code> is? A member function? It's not declared within the question.) Since non-static member functions have a hidden parameter (the <code>this</code> pointer), they are not signature-compatible with non-member functions. If your member function does not need the <code>this</code> parameter, declare it <code>static</code>. (If it does require <code>this</code>, you have a bigger design problem.)</p>\n\n<blockquote>\n  <p>what the datatype of the callback functions in my class should be (<code>void</code> or <code>AnimUpdateCallback</code>)?</p>\n</blockquote>\n\n<p>Well, <code>void</code> is not a function type, so I suppose that is out, leaving you with only one choice... (Unless you meant the return type, rather than the data type? The data type would be the function signature, encompassing both the return type and the types of the parameters.)</p>\n\n<blockquote>\n  <p>why <code>(const AnimationParam &amp;param)</code> has to be added at the end of <code>(*_callbackPt[NUMBER_OF_ANIMATIONS])</code>, otherwise I get an error that the data types are not matching as well</p>\n</blockquote>\n\n<p>I suppose a good way to explain this is to look at what the declarations would declare.</p>\n\n<pre><code> AnimUpdateCallback (*_callbackPt[NUMBER_OF_ANIMATIONS])(const AnimationParam &amp;param);\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ &lt;-- an array of pointers\n</code></pre>\n\n<p>The innermost piece is an array of pointers to something. To see the type they point to, condense the innermost piece to just an asterisk:</p>\n\n<pre><code> AnimUpdateCallback (*)(const AnimationParam &amp;param);\n</code></pre>\n\n<p>This is a pointer to a function that takes a single parameter (of type <code>const AnimationParam &amp;</code>) and returns a value whose type is <code>AnimUpdateCallback</code>. The \"<code>param</code>\" identifier is superfluous here.</p>\n\n<p>Without the part on the end, you have simply</p>\n\n<pre><code> AnimUpdateCallback (*_callbackPt[NUMBER_OF_ANIMATIONS]);\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ &lt;-- an array of pointers\n</code></pre>\n\n<p>This time the pointed-to type is easier to see: <code>AnimUpdateCallback</code>.</p>\n\n<p>So in either case, you have a way to get a value of the type <code>AnimUpdateCallback</code>. In the former case, you would access an element of your array, invoke the function it points to, and look at the returned value, for example: <code>_callbackPt[0](param)</code>. In the latter case, you would just access an element of your array, for example: <code>_callbackPt[0]</code>. The correct form depends upon how you intend to use this array. (The declaration of <code>NeoPixelAnimator</code> is not directly in the question, so I don't know what it expects as parameters to <code>NeoPixelAnimator::StartAnimation()</code>.)</p>\n"}], "owner": {"reputation": 145, "user_id": 10069961, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tNs4Wl3aEdA/AAAAAAAAAAI/AAAAAAAAF-M/TUOudyzzNz4/photo.jpg?sz=128", "display_name": "Daan van Driel", "link": "https://stackoverflow.com/users/10069961/daan-van-driel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559788972, "creation_date": 1559752330, "last_edit_date": 1559788489, "question_id": 56464605, "link": "https://stackoverflow.com/questions/56464605/how-to-make-a-function-pointer-array-of-typedefined-functions", "title": "How to make a function pointer array of typedefined functions", "body": "<p>I am trying to implement the NeopixelAnimator class of this library: <a href=\"https://github.com/Makuna/NeoPixelBus\" rel=\"nofollow noreferrer\">https://github.com/Makuna/NeoPixelBus</a>.</p>\n\n<p>I created an animator class that contains an instance of the library's NeoPixelAnimator class. To run animations I have to call: <code>.StartAnimation(uint16_t indexAnimation, uint16_t duration, UpdateCallback animUpdate)</code>.</p>\n\n<p>My goal is to make a queue of animations that are being animated after one another. The second animation should start when the first has been completed. Since the library itself does not provide a way to do this I created a vector representing the queue, it contains the Animation to be animated and it's colour.</p>\n\n<p>The problem is that the <code>.StartAnimation()</code> function expects a <code>UpdateCallback</code> parameter which is a callback function that is fired whenever the <code>.UpdateAnimations()</code> function is being called.</p>\n\n<p>The animations will be triggered by switches connected to the Arduino Due that call the <code>.add()</code> function (not in the example code). For now, I want to test if it works by adding one animation in <code>.init()</code>.</p>\n\n<p>My plan was to create an array of function pointers that are pointing to those callback functions. The problem is that I can't get the data types to match up. </p>\n\n<p>Help would be greatly appreciated. Also, feedback on how to approach these kinds of problems and to build up the code would be greatly appreciated.</p>\n\n<p>I'm using platformIO with the Arduino library on an Arduino Due board.</p>\n\n<p>defines.h:</p>\n\n<pre><code>//Amount of different animations should correspond to the number of callback functions\n#define NUMBER_OF_ANIMATIONS 2\n\n//Animation ID's:\n#define WIPE_ANIM 0\n\n//Colour ID's:\n#define GREEN 0\n</code></pre>\n\n<p>animator.h:</p>\n\n<pre><code>#include &lt;arduino.h&gt;\n#include &lt;NeoPixelAnimator.h&gt;\n#include &lt;NeoPixelBrightnessBus.h&gt;\n#include &lt;array&gt;\n#include &lt;vector&gt;\n\nclass Animator\n{\npublic:\nprivate:\n\n//NeoPixel animation time management object\n    NeoPixelAnimator animations;\n\n//Neopixel strip communication object\n    NeoPixelBrightnessBus&lt;NeoGrbFeature, Neo800KbpsMethod&gt; strip1; //NeoPixel strip 1 object\n\n//Array of AnimUpdateCallback function pointers to the animation callback functions\n     AnimUpdateCallback (*_callbackPt[NUMBER_OF_ANIMATIONS])(const AnimationParam &amp;param);\n\n//Vector of arrays to store animations to be animated (animId, colorId)\n    std::vector&lt;std::array&lt;uint8_t, 2&gt;&gt; _animationQueue;\n\npublic:\n    Animator();\n    void init();\n    void run();\n    void add(uint8_t animId, uint8_t colorId);\n\nprivate:\n    void updateQueue();\n</code></pre>\n\n<p>animator.cpp:</p>\n\n<pre><code>#include &lt;Animator.h&gt;\n\n//Default constructor\nAnimator::Animator() : strip1(NUMBER_OF_LEDS_1, LED_PIN_1),\n                       _callbackPt{wipeColorAnim, wipeColorAnim}\n{\n}\n\n//Inititalisation function, inits strips, sets brightness for strips, sets inital color with wipeColorAnim()\nvoid Animator::init()\n{\n    strip1.Begin();\n\n    strip1.SetBrightness(100);\n\n    add(WIPE_ANIM, GREEN);        //wipeColor strip1 with Green\n}\n\n//Add aniamtion to the queue\nvoid Animator::add(uint8_t animId, uint8_t colorId)\n{\n    //Create array storing the animation ID and its color\n    std::array&lt;uint8_t, 2&gt; animation{animId, colorId};\n\n    //Add the animation to the end of the queue\n    _animationQueue.push_back(animation);\n}\n\n//Loop this function to update animations\nvoid Animator::run()\n{\n    //if there is an animation running\n    if (animations.IsAnimating())\n    {\n\n        animations.UpdateAnimations(); //update running animation\n        strip1.Show();\n    }\n    else\n    {\n        updateQueue();\n    }\n}\n\n//Checks whether there is an animation in the queue if so it's started\nvoid Animator::updateQueue()\n{\n    //if there is an animation waiting in the queue\n    if (!_animationQueue.empty())\n    {\n        //Start next animation in queue on channel 0 with specified time and animUpdate callback function (channel, time, callback)\n        animations.StartAnimation(0, _animationQueue[0][1], _callbackPt[_animationQueue[0][0]]);\n\n        //Remove the just started animation from the queue\n        _animationQueue.erase(_animationQueue.begin());\n    }\n}\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>Animator animator;\n\nvoid setup()\n{\n\n    animator.init();\n}\n\nvoid loop()\n{\n    //Put new animation requests in queue and update animations\n    animator.run();\n}\n</code></pre>\n\n<p>platformio.ini:</p>\n\n<pre><code>[env:due]\nlib_ldf_mode = chain+\nplatform = atmelsam\nboard = due\nframework = arduino\nmonitor_speed = 115200\nmonitor_port = COM16\n\nlib_deps = \n    NeoPixelBus\n\n</code></pre>\n\n<p>calling <code>animations.StartAnimation(0, _animationQueue[0][1], _callbackPt[_animationQueue[0][0]]);</code> doesn't give any compilation errors. Trying to instatntiate the callback functions in the function pointer array does though: </p>\n\n<p>a value of type \"<code>AnimUpdateCallback (Animator::*)(const AnimationParam &amp;param)</code>\" cannot be used to initialize an entity of type \"<code>AnimUpdateCallback (*)(const AnimationParam &amp;param)</code>\"</p>\n\n<p>My main confusion is:</p>\n\n<ul>\n<li><p>what the datatype of the callback functions in my class should be (<code>void</code> or <code>AnimUpdateCallback</code>)?</p></li>\n<li><p>why <code>(const AnimationParam &amp;param)</code> has to be added at the end of <code>(*_callbackPt[NUMBER_OF_ANIMATIONS])</code>, otherwise I get an error that the data types are not matching as well</p></li>\n</ul>\n"}, {"tags": ["c++", "function", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1559751765, "post_id": 56464438, "comment_id": 99520473, "body": "Why not simply: <code>void functoupper(std::string&amp; myString)</code>. The condition here should be <code>while(i &lt; myString.size());</code> then."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 6, "creation_date": 1559751773, "post_id": 56464438, "comment_id": 99520480, "body": "It&#39;s pretty clear: If it&#39;s const you cant alter it. You need to make a copy. As this is C++, just use <code>std::string</code> and forget about C strings."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1559751870, "post_id": 56464438, "comment_id": 99520520, "body": "<code>std::transform(begin(name), end(name), begin(name), std::toupper)</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1559752275, "post_id": 56464438, "comment_id": 99520739, "body": "<code>std::cout &lt;&lt; &quot;Hello, &quot; &lt;&lt; functoupper(myString) &lt;&lt; &quot;!\\n&quot;;</code> is nonsense regardless. The function returns <code>void</code>."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1559752406, "post_id": 56464438, "comment_id": 99520812, "body": "Since you are using C++, I suggest using the C++ header file <code>#include &lt;cstdlib&gt;</code>."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559754043, "post_id": 56464438, "comment_id": 99521464, "body": "@Someprogrammerdude: little nitpicking - <code>transform</code> works most of the time, <a href=\"https://stackoverflow.com/questions/735204/convert-a-string-in-c-to-upper-case\">but not always</a>."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1559753995, "post_id": 56464593, "comment_id": 99521439, "body": "Consider using <code>std::vector</code> instead of <code>new[]</code>.  Also, when using <code>toupper()</code>, you need to cast <code>char</code> values to <code>unsigned char</code> or you can end up with bad results when <code>char</code> is signed, which means you should not use <code>toupper</code> as the actual <code>transform</code> predicate, use a lambda or functor that casts chars as needed."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1559837114, "post_id": 56464593, "comment_id": 99553022, "body": "If you are going to use <code>string::size()</code> to allocate a <code>char[]</code> array, consider using <code>string::copy()</code> instead of <code>strcpy()</code> to copy the string&#39;s chars into the array"}], "tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 2, "last_activity_date": 1559814883, "last_edit_date": 1559814883, "creation_date": 1559752261, "answer_id": 56464593, "question_id": 56464438, "link": "https://stackoverflow.com/questions/56464438/passing-c-style-string-char-to-function-argument/56464593#56464593", "title": "Passing C-Style string char * to function argument", "body": "<p>As @Someprogrammerdude and @RemyLebeau comment, why not <s>simply</s>:</p>\n\n<pre><code>std::transform(std::begin(name), std::end(name), std::begin(name), \n    [](const unsigned char c)\n    {\n        return std::toupper(c);\n    });\n</code></pre>\n\n<p>But if you must do it via a <code>char*</code>, then you'll need to copy the data over first, something like:</p>\n\n<pre><code>char myString* = new char[name.size() + 1];\nstrcpy(myString, name.c_str());\n</code></pre>\n\n<p>EDIT: Thanks to the helpful comments by @RemyLebeau</p>\n\n<p>Better still avoid all the memory management issues with the above by simply coping your <code>std::string</code> into a <code>std::vector</code>:</p>\n\n<pre><code>std::vector&lt;char&gt; myVec(std::begin(name), std::end(name));\nmyVec.push_back(`\\0`);\n</code></pre>\n\n<p>and then call your <code>char*</code> function with:</p>\n\n<pre><code>functoupper(myVec.data());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1559753877, "last_edit_date": 1559753877, "creation_date": 1559753493, "answer_id": 56464858, "question_id": 56464438, "link": "https://stackoverflow.com/questions/56464438/passing-c-style-string-char-to-function-argument/56464858#56464858", "title": "Passing C-Style string char * to function argument", "body": "<p>The <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/c_str\" rel=\"nofollow noreferrer\"><code>std::string::c_str()</code></a> method returns a pointer to <code>const char</code> data, but your function expects a pointer to non-const <code>char</code> data.  That is why you are getting an error.</p>\n\n<p>You could use <a href=\"https://en.cppreference.com/w/cpp/language/const_cast\" rel=\"nofollow noreferrer\"><code>const_cast</code></a> to cast away the <code>const</code> (but that is not really advisable):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char *myString = const_cast&lt;char*&gt;(name.c_str());\nfunctoupper(myString);\nstd::cout &lt;&lt; \"Hello, \" &lt;&lt; name &lt;&lt; \"!\\n\";\n</code></pre>\n\n<p>You could use the non-const <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/operator_at\" rel=\"nofollow noreferrer\"><code>std::string::operator[]</code></a> to access the string's underlying character data (just be careful because prior to C++11, characters were not <em>required</em> to be stored contiguously in memory, but <em>most</em> <code>std::string</code> implementations did):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>functoupper(&amp;name[0]);\nstd::cout &lt;&lt; \"Hello, \" &lt;&lt; name &lt;&lt; \"!\\n\";\n</code></pre>\n\n<p>In C++17 and later, you can use the non-const <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/data\" rel=\"nofollow noreferrer\"><code>std::string::data()</code></a> method instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>functoupper(name.data());\nstd::cout &lt;&lt; \"Hello, \" &lt;&lt; name &lt;&lt; \"!\\n\";\n</code></pre>\n\n<p>That being said, heed this warning when using <a href=\"https://en.cppreference.com/w/cpp/string/byte/toupper\" rel=\"nofollow noreferrer\"><code>toupper()</code></a>:</p>\n\n<blockquote>\n  <p>Like all other functions from <code>&lt;cctype&gt;</code>, the behavior of <code>std::toupper</code> is undefined if the argument's value is neither representable as <code>unsigned char</code> nor equal to <code>EOF</code>. To use these functions safely with plain <code>char</code>s (or <code>signed char</code>s), the argument should first be converted to <code>unsigned char</code> ... Similarly, they should not be directly used with standard algorithms when the iterator's value type is <code>char</code> or <code>signed char</code>. Instead, convert the value to <code>unsigned char</code> first</p>\n</blockquote>\n\n<p>With that said, try something more like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;cctype&gt;\n\nvoid functoupper(char *myString)\n{\n    for (int i = 0; myString[i] != '\\0'; ++i) {\n        unsigned char z = static_cast&lt;unsigned char&gt;(myString[i]);\n        myString[i] = static_cast&lt;char&gt;(std::toupper(z));\n    }\n}\n\nint main() {\n\n    std::string name;\n\n    std::cout &lt;&lt; \"Please, enter your full name in small caps: \";\n    std::getline(std::cin, name);\n    functoupper(&amp;name[0]); // or name.data()\n    std::cout &lt;&lt; \"Hello, \" &lt;&lt; name &lt;&lt; \"!\\n\";\n\n    return 0;   \n}\n</code></pre>\n\n<p>That being said, you should just pass the entire <code>std::string</code> as-is into your function instead, and then you can manipulate it as needed, for instance with the <a href=\"https://en.cppreference.com/w/cpp/algorithm/transform\" rel=\"nofollow noreferrer\"><code>std::transform()</code></a> algorithm:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cctype&gt;\n\nvoid functoupper(std::string &amp;myString)\n{\n    std::transform(myString.begin(), myString.end(), myString.begin(),\n      [](unsigned char ch){ return std::toupper(ch); }\n    );\n}\n\nint main() {\n\n    std::string name;\n\n    std::cout &lt;&lt; \"Please, enter your full name in small caps: \";\n    std::getline(std::cin, name);\n    functoupper(name);\n    std::cout &lt;&lt; \"Hello, \" &lt;&lt; name &lt;&lt; \"!\\n\";\n\n    return 0;   \n}\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cctype&gt;\n\nstd::string functoupper(std::string myString)\n{\n    std::transform(myString.begin(), myString.end(), myString.begin(),\n      [](unsigned char ch){ return std::toupper(ch); }\n    );\n    return myString;\n}\n\nint main() {\n\n    std::string name;\n\n    std::cout &lt;&lt; \"Please, enter your full name in small caps: \";\n    std::getline(std::cin, name);\n    std::cout &lt;&lt; \"Hello, \" &lt;&lt; functoupper(name) &lt;&lt; \"!\\n\";\n\n    return 0;   \n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 10529173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b98ea6c41fc69698428033e6ef7e163?s=128&d=identicon&r=PG&f=1", "display_name": "M Garcia", "link": "https://stackoverflow.com/users/10529173/m-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1101, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559814883, "creation_date": 1559751668, "last_edit_date": 1559752254, "question_id": 56464438, "link": "https://stackoverflow.com/questions/56464438/passing-c-style-string-char-to-function-argument", "title": "Passing C-Style string char * to function argument", "body": "<p>I want to change the characters in a string passed by user, converted into a C-style string and passed as an argument to a function with a char * argument:</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;\n\nvoid functoupper(char *myString)\n{\n    int i=0;\n    char z;\n    do {\n        z= myString[i];\n        myString[i]=toupper(z);\n        ++i;\n    } while(myString[i]!=0);\n}\n\nint main() {\n\n    std::string name;\n\n    std::cout &lt;&lt; \"Please, enter your full name in small caps: \";\n    std::getline (std::cin,name);\n    const char *myString = name.c_str();\n    std::cout &lt;&lt; \"Hello, \" &lt;&lt; functoupper(myString) &lt;&lt; \"!\\n\";\n\n    return 0;   \n}\n</code></pre>\n\n<p>I get error error: invalid conversion from 'const char*' to 'char*' [-fpermissive] when calling function functoupper(myString) in main().</p>\n"}, {"tags": ["c++", "windows", "windows-services"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559752370, "post_id": 56464413, "comment_id": 99520791, "body": "IIRC you can solve service dependencies in the Service Configuration from the System Configuration. I only have a German System, thus screenshots won&#39;t be very helpful, sorry. You may get better results about your question at <a href=\"https://superuser.com/\">SE Superuser</a> probably."}, {"owner": {"reputation": 551, "user_id": 3819404, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9a13f1a16feb74da624196650a7151ab?s=128&d=identicon&r=PG&f=1", "display_name": "user3819404", "link": "https://stackoverflow.com/users/3819404/user3819404"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559752707, "post_id": 56464413, "comment_id": 99520950, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 i have tried using dependency, but that delays start of my test service itself. i would rather like to make cryptsvc start early rather than delaying my service."}], "owner": {"reputation": 551, "user_id": 3819404, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9a13f1a16feb74da624196650a7151ab?s=128&d=identicon&r=PG&f=1", "display_name": "user3819404", "link": "https://stackoverflow.com/users/3819404/user3819404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587365791, "creation_date": 1559751582, "last_edit_date": 1587365791, "question_id": 56464413, "link": "https://stackoverflow.com/questions/56464413/handling-windows-cryptographic-services-cryptsvc-dependency", "title": "Handling Windows Cryptographic Services (cryptsvc) dependency", "body": "<p>I have a Windows service say <code>test</code> which has a dependency on <code>cryptsvc</code>. In some systems (like windows XP), <code>cryptsvc</code> starts later than my service.</p>\n\n<p>One way to handle this is adding <code>cryptsvc</code> as dependent service in my test service.\nBut this will delay the start of <code>test</code> service as well.</p>\n\n<p>I tried manually starting of <code>cryptsvc</code> using <code>startservice()</code> as part of my service initialization, something like below:</p>\n\n<pre><code>SERVICE_STATUS Status;\nStatus.dwCurrentState = SERVICE_START_PENDING;\nsetservicestatus(hTestService, &amp;Status);\nServiceInit();\nStatus.dwCurrentState = SERVICE_RUNNING;\nsetservicestatus(hTestService, &amp;Status);\n</code></pre>\n\n<p>And</p>\n\n<pre><code>ServiceInit()\n{\n  // launch a worker thread that\n  // calls startservice() to start cryptsvc.\n}\n</code></pre>\n\n<p>But the call to <code>startservice()</code> seems to block for some time and eventually ends with 1056 error (There is already an instance running).</p>\n\n<p>How can I ensure crypt service starts as early as possible, or how can I start crypt service as part of my service initialization. Note that I don't want to strictly ensure that crypt service comes up before my service gets up, but crypt service should be up as soon as possible.</p>\n"}, {"tags": ["c++", "boost", "beast"], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1559751861, "creation_date": 1559751861, "answer_id": 56464484, "question_id": 56464380, "link": "https://stackoverflow.com/questions/56464380/string-view-points-to-another-string/56464484#56464484", "title": "string_view points to another string", "body": "<p>Error is from:</p>\n\n<pre><code>boost::beast::string_view message = \"The resource '\" + target.to_string() + \"' was not found.\";\n</code></pre>\n\n<p>You build a temporary <code>string</code> which end at end of the statement.\nSo you have dangling view next line.</p>\n\n<p>You have to build string there directly.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 4, "last_activity_date": 1559754755, "last_edit_date": 1559754755, "creation_date": 1559751930, "answer_id": 56464507, "question_id": 56464380, "link": "https://stackoverflow.com/questions/56464380/string-view-points-to-another-string/56464507#56464507", "title": "string_view points to another string", "body": "<p>Your error comes from</p>\n\n<pre><code>boost::beast::string_view message = \"The resource '\" + target.to_string() + \"' was not found.\";\n</code></pre>\n\n<p>You create a temporary string on the right hand side, and set the view to point to it.  After the line ends, that temporary string is destroyed and your view now points to invalid memory.</p>\n\n<p>What you need to do is pass the temporary directly to the function, like this:</p>\n\n<pre><code>return prepareError(req, \"The resource '\" + target.to_string() + \"' was not found.\", beast_http::status::not_found);\n</code></pre>\n\n<p>Or, capture the result into a <code>std::string</code> variable, and then pass that to the function.</p>\n"}], "owner": {"reputation": 2228, "user_id": 1708349, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9f3eac41340547d9d27853a9abc66cb6?s=128&d=identicon&r=PG", "display_name": "benjist", "link": "https://stackoverflow.com/users/1708349/benjist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 56464507, "answer_count": 2, "score": 1, "last_activity_date": 1559754755, "creation_date": 1559751454, "question_id": 56464380, "link": "https://stackoverflow.com/questions/56464380/string-view-points-to-another-string", "title": "string_view points to another string", "body": "<p>I'm using Boost 1.70 and found a rather puzzling issue where sometimes boost::string_view seems to point to another string. </p>\n\n<p>This is the function call where a boost::string_view is created as follows:</p>\n\n<pre><code>boost::beast::string_view message = \"The resource '\" + target.to_string() + \"' was not found.\";\nreturn prepareError(req, message, beast_http::status::not_found);\n</code></pre>\n\n<p>And this is the prepareError() method which gets called where something really odd happens. The fist version uses message.to_string() while constructing a string variable:</p>\n\n<pre><code>    template&lt;class Body, class Allocator&gt;\n    beast_http::response&lt;beast_http::string_body&gt; prepareError(beast_http::request&lt;Body, beast_http::basic_fields&lt;Allocator&gt;&gt;&amp; req,\n        boost::beast::string_view message, beast_http::status statusCode) {\n        beast_http::response&lt;beast_http::string_body&gt; res{statusCode, req.version()};\n        res.set(beast_http::field::server, SERVER_VERSION_STRING);\n        res.set(beast_http::field::content_type, MIMETYPE_JSON);\n        if (_allowCrossOrigin) {\n            res.set(beast_http::field::access_control_allow_origin, \"*\");\n        }\n        res.keep_alive(req.keep_alive());\n        int sc = (int)statusCode;\n        std::string json = std::string(\"{\\n  error_code:\") +\n                            std::to_string(sc) + std::string(\",\\n\") +\n                            std::string(\"  error_description:\\\"\") +\n                            message.to_string() + std::string(\"\\\"\\n}\");\n\n        res.body() = json;\n        res.prepare_payload();\n        return res;\n    } \n</code></pre>\n\n<p>This json variable will contain the following string for example:</p>\n\n<pre><code>Printing description of json:\n(std::__1::string) json = \"{\\n  error_code:404,\\n  error_description:\\\"{\\n  error_code:404,\\n  error_descript\\\"\\n}\"\n</code></pre>\n\n<p>This is really odd. In the debugger the message variable contains an empty string. And as you can see from the method call this should not be the expected result for that string.</p>\n\n<p>This is the same method with the only difference that there is a temporary assignment of the message variable, which is a string_view, to a std::string.</p>\n\n<pre><code>    template&lt;class Body, class Allocator&gt;\n    beast_http::response&lt;beast_http::string_body&gt; prepareError(beast_http::request&lt;Body, beast_http::basic_fields&lt;Allocator&gt;&gt;&amp; req,\n        boost::beast::string_view message, beast_http::status statusCode) {\n        beast_http::response&lt;beast_http::string_body&gt; res{statusCode, req.version()};\n        res.set(beast_http::field::server, SERVER_VERSION_STRING);\n        res.set(beast_http::field::content_type, MIMETYPE_JSON);\n        if (_allowCrossOrigin) {\n            res.set(beast_http::field::access_control_allow_origin, \"*\");\n        }\n        res.keep_alive(req.keep_alive());\n        int sc = (int)statusCode;\n        std::string msg = message.to_string();\n        std::string json = std::string(\"{\\n  error_code:\") +\n                            std::to_string(sc) + std::string(\",\\n\") +\n                            std::string(\"  error_description:\\\"\") +\n                            msg + std::string(\"\\\"\\n}\");\n\n        res.body() = json;\n        res.prepare_payload();\n        return res;\n    }\n</code></pre>\n\n<p>This gives the expected string:</p>\n\n<pre><code>Printing description of json:\n(std::__1::string) json = \"{\\n  error_code:404,\\n  error_description:\\\"The resource '/zones' was not found.\\\"\\n}\"\n</code></pre>\n"}, {"tags": ["c++", "language-lawyer", "constant-expression"], "comments": [{"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1559753855, "post_id": 56464361, "comment_id": 99521382, "body": "Weird, I thought the converted expression refers to the prvalue expression that is the result of the lvalue-to-rvalue conversion."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1559754678, "post_id": 56464361, "comment_id": 99521759, "body": "@PasserBy To me it is strange to refer to the result of the lvalue-to-rvalue conversion as an expression, as I consider an expression only what I write in the program. Anyway, in order to determine whether an expression is a <i>core constant expression</i> one has to consider what happens during its evaluation. If &quot;the converted expression&quot; refers to the prvalue expression that is the result of the lvalue-to-rvalue conversion, what exactly is covered by the evaluation of such an expression? [continued]"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1559754867, "post_id": 56464361, "comment_id": 99521842, "body": "If, for example, the original expression is <code>f()</code> where <code>f</code> is declared as <code>int&amp; f();</code>, does the evaluation of &quot;the converted expression&quot; include the statements executed inside the function <code>f</code>?"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1559759198, "post_id": 56464361, "comment_id": 99523526, "body": "@user42768: It\u2019s considered an expression because things like value categories and the rules for constant evaluation are defined in terms of expressions (and consider just how many implicit expressions are introduced by, say, an implicitly defined assignment operator).  Yes, the contents of <code>f</code> are considered; the <a href=\"http://eel.is/c++draft/dcl.constexpr#3\" rel=\"nofollow noreferrer\">restrictions on constexpr</a> functions are not nearly strong enough by themselves."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1559865218, "post_id": 56464361, "comment_id": 99562699, "body": "@PasserBy: The standard <a href=\"http://eel.is/c++draft/basic.lval#3.sentence-2\" rel=\"nofollow noreferrer\">disagrees</a> about values having value categories, although it\u2019s awfully close to correct to say that certain expressions just have reference type."}], "answers": [{"comments": [{"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1559761379, "post_id": 56465999, "comment_id": 99524453, "body": "Thank you for your answer. My first question was whether the &quot;implicitly converted to a prvalue&quot; wording means that in order for an expression to be considered an &quot;integral constant expression&quot; it has to be used in a context that requires it to be converted to a prvalue, not necessarily about the conversion itself. [continued]"}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1559761384, "post_id": 56465999, "comment_id": 99524457, "body": "For my second question, you are saying that the &quot;converted expression&quot; wording means the &quot;conversion process&quot;. I understand that semantically it is related to that, however (syntactically) I expect the term &quot;converted expression&quot; to refer to an expression (whether it is the one &quot;as written&quot; or the one after the lvalue-to-rvalue conversion)."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 0, "creation_date": 1559763683, "post_id": 56465999, "comment_id": 99525398, "body": "@user42768: I added some explanation about the prvalue conversion circumstances.  As for an expression, it is the expression written, given a certain contextual interpretation (as for an <code>if</code> condition, which might invoke <code>operator bool</code>)."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1559797700, "post_id": 56465999, "comment_id": 99533195, "body": "<i>&quot;the initializer is a prvalue anyway&quot;</i>, huh? <code>constexpr int i = 42; constexpr int j = i;</code> isn&#39;t a prvalue initializer, but the result of applying l-t-r is."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1559800125, "post_id": 56465999, "comment_id": 99533844, "body": "@PasserBy: Of course I meant that it is converted to a prvalue (like <code>int i;</code> in <code>i+1</code>) regardless of whether it turns out to be a constant expression, such that it doesn\u2019t matter whether the lvalue-to-rvalue conversion is allowable in a constant expression."}, {"owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "edited": false, "score": 1, "creation_date": 1559844223, "post_id": 56465999, "comment_id": 99556077, "body": "@DavisHerring So you are saying that &quot;the converted expression&quot; means the original expression plus the context in which it is used, which means that the evaluation of &quot;the converted expression&quot; comprises both the evaluation of the original expression and also the evaluation of the required conversion."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 1, "last_activity_date": 1559763562, "last_edit_date": 1559763562, "creation_date": 1559758770, "answer_id": 56465999, "question_id": 56464361, "link": "https://stackoverflow.com/questions/56464361/c-integral-constant-expression-definition/56465999#56465999", "title": "C++ integral constant expression definition", "body": "<p>The statement that an integral constant expression <em>is</em> implicitly converted to a prvalue means that the lvalue-to-rvalue conversion is applied to any expression used as an integral constant expression.  In the one case where an expression <em>might</em> be an integral constant expression\u2014initializing a non-local object of const-qualified integer type that might be usable in constant expressions\u2014the initializer is a prvalue anyway, so no change of interpretation can occur.</p>\n\n<p>Beyond that, both of your questions have the same answer: whatever conversions are necessary to bring the expression (as written) to a prvalue integral type must also be allowed in a core constant expression (see, for example, <a href=\"http://eel.is/c++draft/expr.const#4.7\" rel=\"nofollow noreferrer\">/4.7</a> just before your citation and <a href=\"http://eel.is/c++draft/expr.const#6\" rel=\"nofollow noreferrer\">/6</a> just after it).  The \u201cconverted expression\u201d comprises the conversion in the <code>T t=e;</code> interpretation, not just the <em>id-expression</em> <code>t</code> (which would, for instance, always be an lvalue).</p>\n"}, {"tags": [], "owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "is_accepted": false, "score": 1, "last_activity_date": 1560074757, "last_edit_date": 1560074757, "creation_date": 1560067874, "answer_id": 56512975, "question_id": 56464361, "link": "https://stackoverflow.com/questions/56464361/c-integral-constant-expression-definition/56512975#56512975", "title": "C++ integral constant expression definition", "body": "<p>I looked at clang's source code, specifically, at the function \"<a href=\"https://github.com/llvm-mirror/clang/blob/fecd5a1c92f86f9dd15e8aea516c0e7d21f46dac/lib/Sema/SemaOverload.cpp#L5401\" rel=\"nofollow noreferrer\">CheckConvertedConstantExpression</a>\" inside \"SemaOverload.cpp\". The operations performed there are as follows:</p>\n\n<ol>\n<li>find the required implicit conversion sequence</li>\n<li>check to see if only conversions listed in <a href=\"http://eel.is/c++draft/expr.const#7\" rel=\"nofollow noreferrer\">http://eel.is/c++draft/expr.const#7</a> are used</li>\n<li>perform the implicit conversion (at this step I believe a new expression is created, e.g. if the original expression is <code>f()</code> which is of class type <code>A</code> with a user-defined conversion function to int, and the context requires an <code>int</code>, then the new expression should be <code>f().operator int()</code>) </li>\n<li>check if any narrowing conversions are required</li>\n<li>evaluate the expression generated at step 3 (which implicitly checks if it is a <code>constant expression</code>)</li>\n</ol>\n\n<p>So I believe that, as stated in @Davis Herring's <a href=\"https://stackoverflow.com/a/56465999/3766405\">answer</a>, the term \"converted expression\" means a new expression whose evaluation comprises both the evaluation of the original expression, as written in the program, and the evaluation of any required conversion.</p>\n"}], "owner": {"reputation": 1791, "user_id": 3766405, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ba50b15daf0e2845b9bc8cb9274e2613?s=128&d=identicon&r=PG&f=1", "display_name": "user42768", "link": "https://stackoverflow.com/users/3766405/user42768"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1560074757, "creation_date": 1559751388, "last_edit_date": 1559752812, "question_id": 56464361, "link": "https://stackoverflow.com/questions/56464361/c-integral-constant-expression-definition", "title": "C++ integral constant expression definition", "body": "<p>In the current C++ standard there is the following paragraph (<a href=\"http://eel.is/c++draft/expr.const#5\" rel=\"nofollow noreferrer\">expr.const#5</a>) (emphasis mine):</p>\n\n<blockquote>\n  <p>An integral constant expression is an expression of integral or unscoped enumeration type, <strong>implicitly converted to a prvalue</strong>, where <strong>the converted expression</strong> is a core constant expression. [\u2009Note: Such expressions may be used as bit-field lengths, as enumerator initializers if the underlying type is not fixed ([dcl.enum]), and as alignments. \u2014\u2009end note\u2009]</p>\n</blockquote>\n\n<p>I have two questions regarding this definition:</p>\n\n<ol>\n<li><p>Does the phrase \"implicitly converted to a prvalue\" mean that for an expression to be considered an \"integral constant expression\" it must appear in a context that forces it to be implicitly converted to a prvalue?</p></li>\n<li><p>What does \"the converted expression\" refer to? I know that this question is addressed in <a href=\"https://stackoverflow.com/q/34018046\">Clarification of converted constant expression definition</a>. The answer given there is that \"the converted expression\" is <code>t</code>, after the following initialization: <code>T t = expr;</code>. However, I do not see how evaluating that expression (<code>t</code>) would match any of the rules given in [expr.const#4] (paragraph describing required conditions for an expression to be considered a <em>core constant expression</em>) which would make it unqualified to be a <em>core constant expression</em>.</p></li>\n</ol>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++", "cmake", "include"], "answers": [{"tags": [], "owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "is_accepted": true, "score": 4, "last_activity_date": 1559751313, "last_edit_date": 1559751313, "creation_date": 1559750753, "answer_id": 56464214, "question_id": 56464122, "link": "https://stackoverflow.com/questions/56464122/cmake3-how-to-process-cmakelists-txt-include-commands-and-view-result/56464214#56464214", "title": "cmake3 - how to process CMakeLists.txt include commands and view result", "body": "<p>The simplest way is to use <code>--trace</code> or <code>--trace-expand</code> flags.\nBoth of them make <code>cmake</code> print every line it executes into stderr.\nFor <code>--trace</code> it prints lines as they are read<sup>1</sup>, for <code>--trace-expand</code> all variables get expanded first.</p>\n\n<p>I usually end up with call redirecting stderr to <code>cmake.log</code> file:</p>\n\n<pre><code>cmake . --trace-expand 2&gt; cmake.log\n</code></pre>\n\n<p>If the output is too long<sup>2</sup> for your needs, you may try to reduce it with <code>--trace-source=&lt;file&gt;</code>. \nExtract from <code>--help</code>: <code>Trace only this CMake file/module. Multiple options allowed.</code></p>\n\n<p><sup>1</sup> Quotation marks <code>\"\"</code> are sometimes lost.</p>\n\n<p><sup>2</sup> It is really long... First pass over almost empty project yields 14k+ lines of log. Successive calls only 500+. There is a lot of stuff happening in CMake guts.</p>\n"}], "owner": {"reputation": 11004, "user_id": 1526115, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/356837a43b2988e17e9fc3c6c7a6cc36?s=128&d=identicon&r=PG", "display_name": "kmiklas", "link": "https://stackoverflow.com/users/1526115/kmiklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 56464214, "answer_count": 1, "score": 1, "last_activity_date": 1559751313, "creation_date": 1559750347, "question_id": 56464122, "link": "https://stackoverflow.com/questions/56464122/cmake3-how-to-process-cmakelists-txt-include-commands-and-view-result", "title": "cmake3 - how to process CMakeLists.txt include commands and view result", "body": "<p>How can a CMakeLists.txt file be viewed with include commands executed, and included code in place?</p>\n\n<p>Example: Imagine a CMakeLists.txt that has multiple includes, like so:</p>\n\n<pre><code>include(version)\ninclude(options)\ninclude(programs)\ninclude(settings)\ninclude(stuff)\n// etc..\n</code></pre>\n\n<p>Is it possible to generate and view the assembled result after all the includes in CMakeLists.txt are processed? Ty :^)</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 9, "creation_date": 1559750116, "post_id": 56464005, "comment_id": 99519662, "body": "You can&#39;t put statements outside of functions. Move the three erroring lines inside your test case."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1559750871, "post_id": 56464005, "comment_id": 99520041, "body": "I&#39;m voting to close this question as off-topic."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 3, "creation_date": 1559751097, "post_id": 56464005, "comment_id": 99520139, "body": "What is <code>int(&quot;c&quot;%97)</code> supposed to be?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9642728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e53b4aabbfc7459f1776d1ac5614b756?s=128&d=identicon&r=PG&f=1", "display_name": "pte", "link": "https://stackoverflow.com/users/9642728/pte"}, "is_accepted": false, "score": 0, "last_activity_date": 1559756095, "creation_date": 1559756095, "answer_id": 56465433, "question_id": 56464005, "link": "https://stackoverflow.com/questions/56464005/the-set-and-class-does-not-name-a-type/56465433#56465433", "title": "the set and class does not name a type", "body": "<p>It seems like you are using Catch2. See this tutorial [<a href=\"https://github.com/catchorg/Catch2/blob/master/docs/tutorial.md#test-cases-and-sections][1]\" rel=\"nofollow noreferrer\">https://github.com/catchorg/Catch2/blob/master/docs/tutorial.md#test-cases-and-sections][1]</a></p>\n\n<p>As @Quentin mentioned, move the setups into TEST_CASE. I would also recommend adding sections as shown in the tutorial. Catch runs the setup for every section.</p>\n"}], "owner": {"reputation": 9, "user_id": 11545368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13eb4c1db2fe9c20a7062ad7cd5b85bf?s=128&d=identicon&r=PG&f=1", "display_name": "nutka", "link": "https://stackoverflow.com/users/11545368/nutka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559756095, "creation_date": 1559749960, "last_edit_date": 1559753845, "question_id": 56464005, "link": "https://stackoverflow.com/questions/56464005/the-set-and-class-does-not-name-a-type", "title": "the set and class does not name a type", "body": "<p>In peca1 and par1, lines 7,8 and 9, my program return: peca1, par1 does not name a type.</p>\n\n<pre><code>#include \"Piece.hpp\"\n#include \"doctest.h\"\n\nPiece peca1 = Piece(\"N\", \"a4\", \"c3\");\nstd::pair&lt;int, int&gt; par1;\n\npar1.first = int(\"c\"%97);\npar1.second = 3;\npeca1.checkMovements();\n\nTEST_CASE(\"TESTE N-check\"){\n    CHECK(peca1.currentPosition == par1);\n}\n</code></pre>\n"}, {"tags": ["c++", "node.js", "ubuntu", "npm", "poco-libraries"], "comments": [{"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1559752094, "post_id": 56463987, "comment_id": 99520642, "body": "It&#39;s a possible duplicate of <a href=\"https://unix.stackexchange.com/questions/408425/trying-to-install-debian-package-npm-makes-apt-get-to-remove-libssl-dev\" title=\"trying to install debian package npm makes apt get to remove libssl dev\">unix.stackexchange.com/questions/408425/&hellip;</a>"}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 0, "creation_date": 1559752200, "post_id": 56463987, "comment_id": 99520703, "body": "As described in the duplicate I also recommend to not use a nodejs and npm version from package manager. Install it manually"}], "owner": {"reputation": 99, "user_id": 7110270, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6207c682458086fa32063b8b87968a37?s=128&d=identicon&r=PG", "display_name": "FridmanChan", "link": "https://stackoverflow.com/users/7110270/fridmanchan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1587365606, "creation_date": 1559749891, "last_edit_date": 1587365606, "question_id": 56463987, "link": "https://stackoverflow.com/questions/56463987/installing-libpoco-and-npm-conflict", "title": "Installing libpoco and NPM conflict", "body": "<p>I've got Ubuntu 18.04 on my machine. I need to work on two projects: first on C++, second: front-end app with Angular which use for development mode NPM and Node.js.\nThe question is when I try to configure my environment with executing POCO it's killing NPM and the other way round NPM causes the same with POCO.</p>\n\n<pre><code>sudo app-get install libpoco-dev\nsudo apt-get install libssh-dev\nsudo apt-get install libssl-dev\nsudo apt-get install nodejs\nsudo apt-get install npm\n</code></pre>\n\n<p>After it I can see that symbolic links of POCO disappeared \nif I'm trying to reinstall POCO - it starts to delete NPM.</p>\n\n<p>The question is - is it possible to fix -> or better that application environment will be on different servers? Thanks</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1559749837, "post_id": 56463943, "comment_id": 99519499, "body": "It&#39;s an issue of <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\"><i>operator precedence</i></a>."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1559749915, "post_id": 56463970, "comment_id": 99519538, "body": "Can&#39;t believe it is not a duplicate of a duplicate."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559750072, "post_id": 56463970, "comment_id": 99519634, "body": "N.B. an online tool for this <a href=\"https://stackoverflow.com/a/56464040/560648\">sort of exists</a>"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 3, "last_activity_date": 1559749832, "creation_date": 1559749832, "answer_id": 56463970, "question_id": 56463943, "link": "https://stackoverflow.com/questions/56463943/why-pointer-data-works-whereas-double-pointer-data-doesnt/56463970#56463970", "title": "why pointer-&gt;data works , whereas *double_pointer-&gt;data doesn&#39;t?", "body": "<p>Because <code>*p-&gt;data</code> is <code>*(p-&gt;data)</code>, not <code>(*p)-&gt;data</code>.</p>\n\n<p>Read about <a href=\"https://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 6305495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1JQ3L5wfvGk/AAAAAAAAAAI/AAAAAAAAAdg/ILNRlb7zlSE/photo.jpg?sz=128", "display_name": "nihal dixit", "link": "https://stackoverflow.com/users/6305495/nihal-dixit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1559751032, "answer_count": 1, "score": -2, "last_activity_date": 1559749832, "creation_date": 1559749751, "question_id": 56463943, "link": "https://stackoverflow.com/questions/56463943/why-pointer-data-works-whereas-double-pointer-data-doesnt", "closed_reason": "Not suitable for this site", "title": "why pointer-&gt;data works , whereas *double_pointer-&gt;data doesn&#39;t?", "body": "<p>I have a class 'node' which has two members data and *next. When I am accessing data using pointer then it is working fine whereas when i am accessing it using double pointer , it is throwing an error . Can anyone explain me why this is happening?</p>\n\n<pre><code>class node{\npublic:\n    int data;\n    node *next;\n};\n\npush(&amp;a,8);\n\nvoid push(node **p , int x){\n*p-&gt;data = 11;\n}\n</code></pre>\n\n<p>Why this <em>p->data showing error:\nrequest for member \u2018data\u2019 in \u2018</em> p\u2019, which is of pointer type \u2018node*\u2019</p>\n"}, {"tags": ["c++", "struct"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1559749988, "post_id": 56463941, "comment_id": 99519582, "body": "You can, if you declared a <code>Child::Child(Base const &amp;)</code> constructor. The C-style cast is unnecessary though, just do <code>Child tmp(s);</code>."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1559750003, "post_id": 56463941, "comment_id": 99519590, "body": "No. The child may have extra members that don&#39;t exist in the base class. Where would their values come from?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 3, "creation_date": 1559750010, "post_id": 56463941, "comment_id": 99519595, "body": "&quot;<i>Can I simply cast a Parent-struct in a child-struct in c++?</i>&quot; No. <code>s</code> is not a `Child. Consider learning from a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 2, "creation_date": 1559750086, "post_id": 56463941, "comment_id": 99519642, "body": "I would highly suggest looking through the <a href=\"https://stackoverflow.com/q/332030/332733\">c++ casting question</a> C style casts are incredibly dangerous."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1559750598, "post_id": 56463941, "comment_id": 99519915, "body": "You cast on the wrong direction, a Child is a Base but not the reverse. May be also you wanted to work on pointer ?"}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 5882964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4bba69cf340a06d8626e067d9a8ba6a?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar", "link": "https://stackoverflow.com/users/5882964/arun-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1559754482, "creation_date": 1559754482, "answer_id": 56465069, "question_id": 56463941, "link": "https://stackoverflow.com/questions/56463941/casting-with-structs-c/56465069#56465069", "title": "Casting with structs c++", "body": "<p>A struct is a type consisting of a sequence of members whose storage is allocated in an ordered sequence If the sequence is a mismatch, the conversion may not work.</p>\n\n<p>Within a struct object, addresses of its elements (and the addresses of the bit field allocation units) increase in order in which the members were defined. A pointer to a struct can be cast to a pointer to its first member (or, if the member is a bit field, to its allocation unit). Likewise, a pointer to the first member of a struct can be cast to a pointer to the enclosing struct. There may be unnamed padding between any two members of a struct or after the last member, but not before the first member. The size of a struct is at least as large as the sum of the sizes of its members.</p>\n\n<p>First of all, If you are using c++. Why would you like to perform c style casting between <code>Base</code>  and <code>Child</code>?</p>\n\n<p>C++ provided <code>static_cast</code> for non-polymorphic conversion and <code>dynamic_cast</code> for the polymorphic conversion.</p>\n\n<p>There is more info about these casts:\n<a href=\"https://stackoverflow.com/questions/28002/regular-cast-vs-static-cast-vs-dynamic-cast/28026#28026\">Regular cast vs. static_cast vs. dynamic_cast</a>?</p>\n"}], "owner": {"reputation": 23, "user_id": 10662791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pg7f1mQuQBo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hVFmLX7V3AfWpAN7cY4OY2FDyqNQ/mo/photo.jpg?sz=128", "display_name": "Ferdinand Stickstoff", "link": "https://stackoverflow.com/users/10662791/ferdinand-stickstoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559754482, "creation_date": 1559749750, "question_id": 56463941, "link": "https://stackoverflow.com/questions/56463941/casting-with-structs-c", "title": "Casting with structs c++", "body": "<p>Can I simply cast a Parent-struct in a child-struct in c++?</p>\n\n<p>I tried to cast: </p>\n\n<pre><code>Base s;\nChild tmp = (Child)s;\n</code></pre>\n\n<p>and got this error:\nNo matching conversion for C-style cast from ...</p>\n\n<p>Can anyone help me to solve this error?</p>\n"}, {"tags": ["c++", "parsing", "arm", "embedded", "gnu"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1559748054, "post_id": 56463423, "comment_id": 99518473, "body": "What is the type of <code>TempStr</code>?  You should just be able to get a pointer to the first digit and then pass that to <code>atof</code>."}, {"owner": {"reputation": 33, "user_id": 11223032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tqt0W.jpg?s=128&g=1", "display_name": "Zurn", "link": "https://stackoverflow.com/users/11223032/zurn"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559748241, "post_id": 56463423, "comment_id": 99518566, "body": "TempStr is a char*. It&#39;s a string line copied from a .txt file on an SD card using FatFs. I&#39;ll edit the question above to include that info."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11223032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tqt0W.jpg?s=128&g=1", "display_name": "Zurn", "link": "https://stackoverflow.com/users/11223032/zurn"}, "edited": false, "score": 0, "creation_date": 1559752073, "post_id": 56463931, "comment_id": 99520630, "body": "That certainly works for now. Thanks a lot... I will have to revisit this as the project progresses (and my skills improve) however to try and figure something out that doesn&#39;t depend on a perfect input (in case someone types the config.txt lines wrong). If anyone has any suggestions I&#39;d love to hear them. That was the benefit of sscanf, it could look past the garbage and the just take the numbers."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 33, "user_id": 11223032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tqt0W.jpg?s=128&g=1", "display_name": "Zurn", "link": "https://stackoverflow.com/users/11223032/zurn"}, "edited": false, "score": 0, "creation_date": 1559752317, "post_id": 56463931, "comment_id": 99520759, "body": "@Zurn For that, if you just want to extract the floating point number then you can scan through the line until you find a <code>.</code>.  Then you go forward and back from there until you run you hit non-numeric characters.  Then copy that into its own buffer and pass it to <code>atof</code>.  Do note that there is no 100% bullet proof way to accept any arbitrary input.  Sometimes you&#39;ll just have to issue an error and end processing, or fall back to some default value and log that you have done so."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1559760729, "post_id": 56463931, "comment_id": 99524186, "body": "Advancing past the space is unnecessary <code>atof()</code> skips leading whitespace.  A minor point is that the question asks for the value in a <code>float</code>."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 0, "last_activity_date": 1559749724, "creation_date": 1559749724, "answer_id": 56463931, "question_id": 56463423, "link": "https://stackoverflow.com/questions/56463423/is-there-an-easy-way-to-parse-a-float-from-a-string-in-c-gnu-arm-embedded/56463931#56463931", "title": "Is there an easy way to parse a float from a string in C++ GNU ARM embedded?", "body": "<p>If you are guaranteed that your input will be in the form of</p>\n\n<pre><code>text floating_point_number\n</code></pre>\n\n<p>then once you have <code>TempStr</code> you can advance a pointer through it until you reach the space, and then go one position further to get to the floating point part of the string.  Then you pass that pointer to <code>atof</code> to get the value out of the remainder of string.  That would look like</p>\n\n<pre><code>char* fp = TempStr;\nwhile (*fp != ' ') ++fp; // get to the space\ndouble value = atof(++fp); // advance to floating point part and pass to atof\n</code></pre>\n\n<p>If you don't need <code>TempStr</code> after you get the value then you can get rid of <code>fp</code> and just use</p>\n\n<pre><code>while (*TempStr != ' ') ++TempStr ; // get to the space\ndouble value = atof(++TempStr); // advance to floating point part and pass to atof\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 0, "last_activity_date": 1559762655, "last_edit_date": 1559762655, "creation_date": 1559761143, "answer_id": 56466506, "question_id": 56463423, "link": "https://stackoverflow.com/questions/56463423/is-there-an-easy-way-to-parse-a-float-from-a-string-in-c-gnu-arm-embedded/56466506#56466506", "title": "Is there an easy way to parse a float from a string in C++ GNU ARM embedded?", "body": "<p>It can be done as follows:</p>\n\n<pre><code>float presmax = (float)atof( strchr( TempStr, ' ' ) ;\n</code></pre>\n\n<p>The cast is only necessary because your question specifically asks for <code>float</code> and <code>atof()</code> returns a <code>double</code>.  The cast would be implicit in any event, so:</p>\n\n<pre><code>float presmax = atof( strchr( TempStr, ' ' ) ;\n</code></pre>\n\n<p>is also acceptable.</p>\n\n<p><code>strchr()</code> returns a pointer to the first space character, and <code>atof()</code> ignores any leading space.  If your config file might use a TAB character, then:</p>\n\n<pre><code>float presmax = (float)atof( strpbrk( TempStr, \" \\t\" ) ;\n</code></pre>\n\n<p>It will fail if either <code>strchr()</code> or <code>strpbrk()</code> return NULL when the delimiter is not found, so you might make it more robust thus:</p>\n\n<pre><code>#define PRESMAX_DEFAULT 1.0f\n\nconst char* prestr = strchr( TempStr ) ;\nfloat presmax = prestr == NULL ? PRESMAX_DEFAULT : (float)atof( prestr ) ;\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11223032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tqt0W.jpg?s=128&g=1", "display_name": "Zurn", "link": "https://stackoverflow.com/users/11223032/zurn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 56463931, "answer_count": 2, "score": 1, "last_activity_date": 1559762655, "creation_date": 1559747909, "last_edit_date": 1559749186, "question_id": 56463423, "link": "https://stackoverflow.com/questions/56463423/is-there-an-easy-way-to-parse-a-float-from-a-string-in-c-gnu-arm-embedded", "title": "Is there an easy way to parse a float from a string in C++ GNU ARM embedded?", "body": "<p>I have this string in my C++ GNU ARM embedded system: </p>\n\n<pre><code>char* TempStr = \"pressure 0.85\";\n</code></pre>\n\n<p>I need the number value stored as a separate float variable called presmax. </p>\n\n<p>Up until now the number to be parsed has always been an integer, so I could use sscanf without any issues. However, as I have read about extensively on the web (and experienced first hand), sscanf doesn't typically work on floats in embedded systems (without some extensive configuration/loss of flash space).</p>\n\n<p>I'm wondering if anyone has any suggestions. Perhaps I could parse the \"0.85\" as a char array? I'm not quite sure how to do that, though it would allow me to use atof() to turn it into a float, as I've done elsewhere in the program. </p>\n\n<p>I realize the other option is to write a function, however I'm quite an amateur programmer so if there's a more robust/time effective solution I'd best take it. </p>\n\n<p><strong>UPDATE:</strong>\nIn case it helps, TempStr is a string copied from a .txt file on an SD card using FatFs. Here's the full code that reads two lines and stores the results in TempStr each time. I parse the string into its respective variable each time TempStr is stored:</p>\n\n<pre><code>FILINFO fno;\nFIL fsrc;\nint FileEnd = 0;\nint CurrentLine = 0;\nint pressmax = 0;\nint timemax = 0;\nchar* TempStr;\nWCHAR CharBuffer[100];\n\nres = f_stat(\"config.txt\", &amp;fno);                               //check for config.txt file\nres = f_open(&amp;fsrc, \"config.txt\", FA_READ | FA_OPEN_ALWAYS);    //open config.txt file\n\n//first line\nTempStr = f_gets((char*)CharBuffer, sizeof(fsrc), &amp;fsrc);      \nCurrentLine ++;\nFileEnd = FileEnd + strlen(TempStr) + 1;\n\n//sscanf(TempStr, \"%*s %i\", &amp;presmax);       //what I did when presmax was an int\n\n//second line\nwhile ((f_eof(&amp;fsrc) == 0)){                                   \n        TempStr = f_gets((char*)CharBuffer, sizeof(fsrc), &amp;fsrc);\n        CurrentLine ++;\n        FileEnd = FileEnd + strlen(TempStr) + 1;\n}\n\n//sscanf(TempStr, \"%*s %i\", &amp;timemax);     \n</code></pre>\n\n<p>Using GNU ARM Build tools on an STM32L w/Eclipse. </p>\n"}, {"tags": ["c++", "string", "initialization", "string-literals", "memset"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 16, "creation_date": 1559747640, "post_id": 56463341, "comment_id": 99518249, "body": "<code>&quot;t&quot;</code> and <code>&#39;t&#39;</code> are not the same."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 16, "creation_date": 1559747865, "post_id": 56463341, "comment_id": 99518371, "body": "most online learning resources for c++ are crap and afaik that site is no exception, give this a try instead: <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/388242/&hellip;</a>"}, {"owner": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "edited": false, "score": 0, "creation_date": 1559747913, "post_id": 56463341, "comment_id": 99518392, "body": "I used single quote &#39;t&#39; but still get extra characters in the output."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1559747969, "post_id": 56463341, "comment_id": 99518429, "body": "It is no longer a properly zero-terminated C string after you do this.  You lost the 0.  Consider passing sizeof(str)-1 instead."}, {"owner": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559748080, "post_id": 56463341, "comment_id": 99518494, "body": "@HansPassant  Then how to use it? Is it deprecated and not used nowadays?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 8, "creation_date": 1559748196, "post_id": 56463341, "comment_id": 99518541, "body": "Why even use <code>memset</code> in C++? The reason old C functions exists is for backwards compability."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 13, "creation_date": 1559748197, "post_id": 56463341, "comment_id": 99518542, "body": "It is a loaded gun, you aimed it at your left foot and pulled the trigger.  You have to aim right."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559748208, "post_id": 56463341, "comment_id": 99518547, "body": "this is quite relevant: <a href=\"https://stackoverflow.com/a/8590379/4117728\">stackoverflow.com/a/8590379/4117728</a>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1559748266, "post_id": 56463341, "comment_id": 99518582, "body": "Also, use <code>std::string</code> instead of <code>char[]</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1559748388, "post_id": 56463341, "comment_id": 99518633, "body": "@HansPassant So he should shoot his right foot then?  ;)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1559748432, "post_id": 56463341, "comment_id": 99518660, "body": "@dbush: Or possibly worse..."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 8, "creation_date": 1559748689, "post_id": 56463341, "comment_id": 99518835, "body": "You should not change question underneath people who are answering it. If you take a comment or answer in and it is still not working, you can ask another question, but this sort of editing, which replaces once question with another, is destructive"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 3, "creation_date": 1559750671, "post_id": 56463341, "comment_id": 99519946, "body": "Don&#39;t use <code>std::memset</code>, use <a href=\"https://en.cppreference.com/w/cpp/algorithm/fill\" rel=\"nofollow noreferrer\">std::fill</a>, its just as fast and safer."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559751688, "post_id": 56463341, "comment_id": 99520435, "body": "Questions refering to given answers or containing an edit with something that belongs into an answer always look a bit odd imho.  You can answer your can question, though"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 4, "creation_date": 1559794306, "post_id": 56463341, "comment_id": 99532544, "body": "If you look closely at the page you cited and count a bit, you&#39;ll notice that <code>&quot;geeksforgeeks&quot;</code> has 13 characters, and that row of t&#39;s that represents the output has 14. So the example code produces extra output, too. As you can see from the answers, that&#39;s not unexpected -- the code is simply wrong."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1559808618, "post_id": 56463341, "comment_id": 99537354, "body": "You really ought to avoid <code>using namespace std</code> - it is a bad habit to get into, and <a href=\"/q/1452721\">can silently change the meaning of your program</a> when you&#39;re not expecting it.  Get used to using the namespace prefix (<code>std</code> is intentionally very short), or importing <i>just the names you need</i> into the <i>smallest reasonable scope</i>.  Is it really so hard to write <code>std::memset</code>?"}, {"owner": {"reputation": 113, "user_id": 1964024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f71577b3b4b3c56c005d5a146ae4f41?s=128&d=identicon&r=PG", "display_name": "Shamtam", "link": "https://stackoverflow.com/users/1964024/shamtam"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559825239, "post_id": 56463341, "comment_id": 99546107, "body": "@HansPassant Is shooting at the right foot any better? =P"}, {"owner": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1559918872, "post_id": 56463341, "comment_id": 99582046, "body": "@SergeyA I am not sure why this question is put on hold, it has complete MWE, addresses the question correctly and does not have vulgar words or anything bad comments."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559921208, "post_id": 56463341, "comment_id": 99583317, "body": "@astro123 original question had <code>&quot;t&quot;</code> in double quotes, and I voted to close it as a typo (clearly memset doesn&#39;t accept pointers as it&#39;s second argument). And than you edited the question, completely changing it&#39;s meaning  - not it became a valid answerable question, but doing so, you invalidate previous answers, which is actually not that great."}, {"owner": {"reputation": 922, "user_id": 938140, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/4eaeed48a41290db9582c3b1d08f2d64?s=128&d=identicon&r=PG", "display_name": "Wouter van Ooijen", "link": "https://stackoverflow.com/users/938140/wouter-van-ooijen"}, "edited": false, "score": 0, "creation_date": 1560275453, "post_id": 56463341, "comment_id": 99680270, "body": "IMO the only correct answer to this question is &quot;You don&#39;t&quot; - at least not while you are learning C++. Mybe when you are an expert. And even then, probably not."}], "answers": [{"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1559748312, "post_id": 56463494, "comment_id": 99518599, "body": "unfortunately it really is <code>sizeof</code> in the orginial example. A pity that such code is used to &quot;teach&quot; c++ :("}, {"owner": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "edited": false, "score": 0, "creation_date": 1559748337, "post_id": 56463494, "comment_id": 99518611, "body": "I am learning C++, and learning online from <a href=\"https://www.geeksforgeeks.org/memset-in-cpp/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/memset-in-cpp</a>, The example is taken from there, nothing warnings were given there. Thanks for the usage info."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559748395, "post_id": 56463494, "comment_id": 99518636, "body": "Updated to address both comments."}, {"owner": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "edited": false, "score": 0, "creation_date": 1559748489, "post_id": 56463494, "comment_id": 99518687, "body": "Also, I am from Python background, where a single quote and double quotes are the same, so I got another error also."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "edited": false, "score": 3, "creation_date": 1559748530, "post_id": 56463494, "comment_id": 99518727, "body": "@astro123 Another reason to work from a good book instead. There are different kinds of literals in C++, which is completely different from Python."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 6, "creation_date": 1559748773, "post_id": 56463494, "comment_id": 99518886, "body": "This site (geeksforgeeks) should be forever banned."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "edited": false, "score": 6, "creation_date": 1559780583, "post_id": 56463494, "comment_id": 99530349, "body": "@astro123: <i>learning online from geeksforgeeks.org/memset-in-cpp</i>  There&#39;s your first problem.  That tutorial has a serious bug in its tiny example.  This is not rare on geeksforgeeks.org.  There is <i>some</i> good stuff, but it&#39;s often mixed in with bad stuff, and <i>until you&#39;re already an expert</i> you won&#39;t know how to tell the difference.  Unlike Stack Overflow, geeksforgeeks doesn&#39;t have a voting mechanism for people to review posts and indicate their quality, so you have no way of knowing which ones to trust."}, {"owner": {"reputation": 806, "user_id": 5116726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/896265d01f444fe655496d6e23716e32?s=128&d=identicon&r=PG&f=1", "display_name": "mbrig", "link": "https://stackoverflow.com/users/5116726/mbrig"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1559845119, "post_id": 56463494, "comment_id": 99556456, "body": "@PeterCordes its a shame SO Documentation went the way it did... there&#39;s clearly a demand for voted-on, curated tutorials. I&#39;m sure somebody will figure out the right design, eventually."}, {"owner": {"reputation": 162, "user_id": 5208982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d5dc8c1f360273e02778fb2ac5956d?s=128&d=identicon&r=PG&f=1", "display_name": "grovkin", "link": "https://stackoverflow.com/users/5208982/grovkin"}, "edited": false, "score": 0, "creation_date": 1559851270, "post_id": 56463494, "comment_id": 99558880, "body": "Why &quot;don&#39;t&quot;?  Isn&#39;t the implementation of memset often significantly faster?  <code>fill</code> may not always be implemented to use an assembly directive (not even at -O4), while memset should always be using it if it&#39;s available.  Also strlen should never be used.  Just never.  if you know the size of the string at compile time (and sizeof does) use it.  If you don&#39;t know it at compile time, <code>strlen</code> is unsafe."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 162, "user_id": 5208982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d5dc8c1f360273e02778fb2ac5956d?s=128&d=identicon&r=PG&f=1", "display_name": "grovkin", "link": "https://stackoverflow.com/users/5208982/grovkin"}, "edited": false, "score": 0, "creation_date": 1559902914, "post_id": 56463494, "comment_id": 99573718, "body": "@grovkin No, a mainstream implementation will delegate to <code>memset</code> via specialisation, i.e. when the template args suggest it&#39;s called for (optimisation level not required) - <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_algobase.h#L717\" rel=\"nofollow noreferrer\">e.g. libstdc++</a>. There&#39;s no need to try to &quot;beat the toolchain&quot;, because it&#39;s better than us. On the other hand, you sacrifice your type safety and I <i>have</i> seen long-standing hidden bugs when someone&#39;s changed a type and not scanned for all its uses, one of which was a naughty <code>memset</code> on what had previously been a C array."}, {"owner": {"reputation": 162, "user_id": 5208982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d5dc8c1f360273e02778fb2ac5956d?s=128&d=identicon&r=PG&f=1", "display_name": "grovkin", "link": "https://stackoverflow.com/users/5208982/grovkin"}, "edited": false, "score": 0, "creation_date": 1559934742, "post_id": 56463494, "comment_id": 99589223, "body": "@LightnessRacesinOrbit you would expect templates to be specialized for char*, but I have seen compilers used in production code (I think it was Sun&#39;s) being 10x slower when using <code>copy()</code> instead of <code>memcpy</code> on vectors.  Just because there are mechanisms in the language to handle this, doesn&#39;t mean that the compiler you use handles it.  And when the issue is of practical rather than theoretical importance, you have to use the tools you rather than the ones you think you should have."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 162, "user_id": 5208982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d5dc8c1f360273e02778fb2ac5956d?s=128&d=identicon&r=PG&f=1", "display_name": "grovkin", "link": "https://stackoverflow.com/users/5208982/grovkin"}, "edited": false, "score": 0, "creation_date": 1559954013, "post_id": 56463494, "comment_id": 99593803, "body": "@grovkin Such a blatantly substandard implementation should not be used in the first place."}, {"owner": {"reputation": 162, "user_id": 5208982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d5dc8c1f360273e02778fb2ac5956d?s=128&d=identicon&r=PG&f=1", "display_name": "grovkin", "link": "https://stackoverflow.com/users/5208982/grovkin"}, "edited": false, "score": 0, "creation_date": 1559954581, "post_id": 56463494, "comment_id": 99593886, "body": "@LightnessRacesinOrbit again, when the issue is of practical rather than theoretical importance, you have to use the tools you have rather than the ones you think you should have.  I see that you still have strlen in the answer, btw.  That function should never be used.  In any code.... ever."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 32, "last_activity_date": 1559903225, "last_edit_date": 1559903225, "creation_date": 1559748202, "answer_id": 56463494, "question_id": 56463341, "link": "https://stackoverflow.com/questions/56463341/how-to-use-memset-while-handling-strings-in-c/56463494#56463494", "title": "How to use memset while handling strings in C++?", "body": "<blockquote>\n  <p>Error when using single quotes 't' This prints extra characters.</p>\n</blockquote>\n\n<p>That's because you overwrote the null terminator.</p>\n\n<p>The terminator is part of the array's size (an array is not magic), though <a href=\"https://stackoverflow.com/a/8590379/560648\">it's not part of the <em>logical</em> string size</a>.</p>\n\n<p>So, I think you meant:</p>\n\n<pre><code>memset(str, 't', strlen(str));\n//               ^^^^^^\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Error when using \"t\" with double quotes</p>\n</blockquote>\n\n<p>Completely different thing. You told the computer to set every character in the string, to a string. Doesn't make sense; won't compile.</p>\n\n<hr>\n\n<blockquote>\n  <p>How to use memset in C++?</p>\n</blockquote>\n\n<p>Don't.</p>\n\n<p>Either use the type-safe <code>std::fill</code>, in combination with <code>std::begin</code> and <code>std::end</code>:</p>\n\n<pre><code>std::fill(std::begin(str), std::end(str)-1, 't');\n</code></pre>\n\n<p><em>(If you're worried about performance, don't be: this will just delegate to <code>memset</code> where possible via template specialisation, optimisation not required, without sacrificing type-safety; <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/stl_algobase.h#L717\" rel=\"nofollow noreferrer\">example here in libstdc++</a>.)</em></p>\n\n<p>Or just a <code>std::string</code> to begin with. \ud83d\ude0a</p>\n\n<hr>\n\n<blockquote>\n  <p>I was learning the fuction memset in C++ from <a href=\"https://www.geeksforgeeks.org/memset-in-cpp/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/memset-in-cpp/</a> where the example is given as below</p>\n</blockquote>\n\n<p>Don't attempt to learn C++ from random websites. Get yourself <a href=\"https://stackoverflow.com/q/388242/560648\">a good book</a> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 19, "creation_date": 1559757152, "post_id": 56463565, "comment_id": 99522702, "body": "The original post clearly indicates that the user is trying to learn C++. Please mention at least that none of this is relevant if you use <code>std::string</code>, which should be used here instead instead of using this complicated <code>C</code> stuff. (It might be relevant to know, though not at the beginning of a course)"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 8, "creation_date": 1559823228, "post_id": 56463565, "comment_id": 99544971, "body": "@JVApen  The original post clearly indicates that the user is trying to know how to use memset with character arrays.:)"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1559835921, "post_id": 56463565, "comment_id": 99552443, "body": "Good answer.  If you want it to be better for the OP: note the difference in the type system.  C++ has a static type system, where variables have a fixed static type.  Python has a fully dynamic type system, where values have a type and variables do not.  This is probably the source of his confusion involving <code>&#39;t&#39;</code> and <code>&quot;t&quot;</code>."}, {"owner": {"reputation": 14978, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1559856629, "post_id": 56463565, "comment_id": 99560731, "body": "What do you mean by &quot;<i>simulates</i> strings&quot;?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1559914539, "post_id": 56463565, "comment_id": 99579629, "body": "@Ray You are mistaken. For starters a correct declaration will look like const char *str = &quot;geeksforgeeks&quot;; And in any case string literals in C and C++ are immutable. Any attempt to change a string literal results in undefined behaviour."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1559919822, "post_id": 56463565, "comment_id": 99582521, "body": "@VladfromMoscow You&#39;re right, of course. I wasn&#39;t paying close enough attention to exactly what was being done after the strlen call. I revise my suggestion to: You might want to also explain that if the string were declared as <code>const char *str = &quot;geeksforgeeks&quot;;</code>, sizeof will no longer report the length of the string, but rather the size of the pointer. (Even if declaring it as a pointer to string literal in this particular example leads to further problems, I&#39;ve seen enough people make the mistake of doing sizeof of a pointer to string that I think it&#39;s worth covering why that doesn&#39;t work.)"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1559920075, "post_id": 56463565, "comment_id": 99582668, "body": "@Ray Thanks. But it&#39;ll be too broad answer to a simple question.:)"}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 69, "last_activity_date": 1559824359, "last_edit_date": 1559824359, "creation_date": 1559748452, "answer_id": 56463565, "question_id": 56463341, "link": "https://stackoverflow.com/questions/56463341/how-to-use-memset-while-handling-strings-in-c/56463565#56463565", "title": "How to use memset while handling strings in C++?", "body": "<p>This declaration</p>\n\n<pre><code>char str[] = \"geeksforgeeks\";\n</code></pre>\n\n<p>declares a character array that contains a string that is a sequence of characters including the terminating zero symbol <code>'\\0'</code>.</p>\n\n<p>You can imagine the declaration the following equivalent way</p>\n\n<pre><code>char str[] = \n{ \n    'g', 'e', 'e', 'k', 's', 'f', 'o', 'r', 'g', 'e', 'e', 'k', 's', '\\0'\n};\n</code></pre>\n\n<p>This call of the function <code>memset</code></p>\n\n<pre><code>memset(str, 't', sizeof(str));\n</code></pre>\n\n<p>overrides all characters of the array including the terminating zero.</p>\n\n<p>So the next statement</p>\n\n<pre><code>cout &lt;&lt; str &lt;&lt; endl;\n</code></pre>\n\n<p>results in undefined behaviour because it outpuuts characters until the terminating zero is encountered.</p>\n\n<p>You could write instead</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n\nint main()\n{\n    char str[] = \"geeksforgeeks\";\n\n    std::memset( str, 't', sizeof( str ) - 1 );\n\n    std::cout &lt;&lt; str &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Or the following way</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n\nint main()\n{\n    char str[] = \"geeksforgeeks\";\n\n    std::memset( str, 't', std::strlen( str ) );\n\n    std::cout &lt;&lt; str &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>That is keeping the terminating zero unchanged in the array.</p>\n\n<p>If you want to override all characters of the array including the terminating zero, then you should substitute this statement</p>\n\n<pre><code>std::cout &lt;&lt; str &lt;&lt; '\\n';\n</code></pre>\n\n<p>for this statement</p>\n\n<pre><code>std::cout.write( str, sizeof( str ) ) &lt;&lt; '\\n';\n</code></pre>\n\n<p>as it is shown in the program below because the array now does not contain a string.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n\nint main()\n{\n    char str[] = \"geeksforgeeks\";\n\n    std::memset( str, 't', sizeof( str ) );\n\n    std::cout.write( str, sizeof( str ) ) &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>As for this call</p>\n\n<pre><code>memset(str, \"t\", sizeof(str));\n</code></pre>\n\n<p>then the type of the second argument (that is the type <code>const char *</code>) does not correspond to the type of the second function parameter that has the type <code>int</code>. See the declaration of the function</p>\n\n<pre><code>void * memset ( void * ptr, int value, size_t num );\n</code></pre>\n\n<p>Thus the compiler issues an error message.</p>\n\n<p>Apart from character arrays (that are used very often even in C++) you can use also the standard class <code>std::string</code> (or <code>std::basic_string</code>) that simulates strings.</p>\n\n<p>In this case there is no need to use the standard C function memset to fill a string with a single character. The simplest way to do this is the following</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    std::string s( \"geeksforgeeks\" );\n\n    s.assign( s.length(), 't' );\n\n    std::cout &lt;&lt; s &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Another way is to use the standard algorithm <code>std::fill</code> or <code>std::fill_n</code> declared in the header <code>&lt;algorithm&gt;</code>. For example</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::string s( \"geeksforgeeks\" );\n\n    std::fill( std::begin( s ), std::end( s ), 't' );\n\n    std::cout &lt;&lt; s &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    std::string s( \"geeksforgeeks\" );\n\n    std::fill_n( std::begin( s ), s.length(), 't' );\n\n    std::cout &lt;&lt; s &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>You even can use the method <code>replace</code> of the class <code>std::string</code> one of the following ways</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    std::string s( \"geeksforgeeks\" );\n\n    s.replace( 0, s.length(), s.length(), 't' );\n\n    std::cout &lt;&lt; s &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n    std::string s( \"geeksforgeeks\" );\n\n    s.replace( std::begin( s ), std::end( s ), s.length(), 't' );\n\n    std::cout &lt;&lt; s &lt;&lt; '\\n';\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559780810, "post_id": 56464048, "comment_id": 99530376, "body": "<i>potentially-overlapping subobject</i> of what?  It&#39;s not automatically UB to modify the object-representation of other objects in C++.  For example, <code>uint32_t</code> has a fully defined object representation (except for the endian byte-order).  So it&#39;s not clear what kind of overlap you&#39;re talking about, because <code>memset</code> only takes one pointer arg; the other args are by value.  That phrasing makes sense for <code>memcpy</code> which forbids overlap, unlike <code>memmove</code>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1559814511, "post_id": 56464048, "comment_id": 99540323, "body": "@PeterCordes To be fair, that phrase was plagiarised from cppreference.com. So if it&#39;s wrong, cppreference.com needs to be corrected."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559815066, "post_id": 56464048, "comment_id": 99540646, "body": "@LightnessRacesinOrbit: on cppref, that phrase is a hyperlink to <a href=\"https://en.cppreference.com/w/cpp/language/object#Subobjects\" rel=\"nofollow noreferrer\">a definition</a> that makes sense.  It&#39;s somewhat plausible for it to be UB if a memset might be modifying the bytes of another object as well (because the pointer is to a subojected of a struct that&#39;s declared with <code>[[no_unique_address]]</code> allowing a compiler to do whatever it wants, including create bitfields for narrow or bool types I guess).  I&#39;m less clear on the &quot;base class subobject&quot; part; possibly that&#39;s UB because it could overwrite a vtable pointer?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1579632270, "post_id": 56464048, "comment_id": 105828377, "body": "@PeterCordes - it&#39;s talking about <a href=\"https://godbolt.org/z/tiYnfW\" rel=\"nofollow noreferrer\">something like this</a>. Here, <code>base</code> is trivially copyable, but it not safe for <code>memset</code> (or <code>memmove</code>) or because it is a potentially overlapping subobject. Note that <code>sizeof(base) == 8</code>, yet when it is used as a base of <code>derived</code> (which itself has a <code>char</code> member), <code>sizeof(derived) == 8</code>! So the members of derived are stored in the padding of <code>base</code>. Hence it is unsafe to overwrite an arbitrary <code>base&amp;</code> with <code>memset</code> since you&#39;d also clobber the derived member in this case."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1579632823, "post_id": 56464048, "comment_id": 105828594, "body": "Note also how this is reflected in the code generation on gcc for zeroing <code>base</code> in <code>b = base{}</code>: it does a <code>qword</code> and <code>byte</code> write, because it can&#39;t safely extend that to a single <code>qword</code> write because the padding may be reused. Then see <code>base2</code> and <code>derived2</code>: these are identical except that <code>base2</code> is <code>struct</code> not <code>class</code>. Then it becomes an aggregate and I guess overlapping is banned (note how the <code>b = base2{}</code> codegen changes)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1579641760, "post_id": 56464048, "comment_id": 105832218, "body": "@BeeOnRope: You mean <code>dword</code> + <code>byte</code> to zero <code>base</code> (you said qword twice).  Interesting.  The only difference between class and struct is that class defaults to <code>private:</code> while struct defaults to <code>public:</code>.  It appears that putting derived members into the padding of the base depends only on visibility, and switches if you use those tags to have private members in the base2 struct and public members of the base class.  <a href=\"https://godbolt.org/z/3VLeiS\" rel=\"nofollow noreferrer\">godbolt.org/z/3VLeiS</a>"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1579654257, "post_id": 56464048, "comment_id": 105835938, "body": "@Peter Yes, it&#39;s to do with visibility although I wasn&#39;t sure why. As above I thought it was keying off whether base was an Aggregate or not (basically the most POD-like thing C++ offers). It is not keying off of standard layout, that I checked."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1579655062, "post_id": 56464048, "comment_id": 105836104, "body": "@BeeOnRope: I think it might be a design decision that could have gone either way.  Or maybe not: according to <a href=\"https://itanium-cxx-abi.github.io/cxx-abi/abi.html#POD\" rel=\"nofollow noreferrer\">itanium-cxx-abi.github.io/cxx-abi/abi.html#POD</a> <i>This ABI uses the definition of POD only to decide <b>whether to allocate objects in the tail-padding of a base-class subobject</b>. While the standards have broadened the definition of POD over time, they have also forbidden the programmer from directly reading or writing the underlying bytes of a base-class subobject with, say, memcpy.</i>  (x86-64 uses the same C++ ABI).  With some stuff about how POD in C++ has evolved."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1579660605, "post_id": 56464048, "comment_id": 105837075, "body": "@PeterCordes - right, well the designed decision must be in the context of the platform ABI, not just at the compiler level, since everyone has to agree on this, right? Anyways, the only property that I found that wasn&#39;t contradicted by practice, regarding whether padding could be used by a derived class was &quot;aggregate&quot;. See <a href=\"https://godbolt.org/z/jBeRwD\" rel=\"nofollow noreferrer\">here</a>. <code>base</code> is POD, trivial, and standard layout, but it still not safe. It is not aggregate, however. Of course, this is not a proof :)."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1579661383, "post_id": 56464048, "comment_id": 105837209, "body": "@BeeOnRope: Ah, I wasn&#39;t aware that &quot;aggregate&quot; had a specific technical meaning which included having no private / protected members.  <a href=\"//stackoverflow.com/q/4178175\">What are Aggregates and PODs and how/why are they special?</a>.  I haven&#39;t checked this, but I think from the C++ ABI&#39;s notes on &quot;POD&quot; that (some draft of) ISO C++ must say that you can step on the padding of an aggregate, but not necessarily in general for any POD / trivially-copyable type.  So you can put derived members in that padding when the base is not an aggregate.  That&#39;s what this C++ ABI chooses to agree on."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1579661669, "post_id": 56464048, "comment_id": 105837259, "body": "@PeterCordes - yes, I just finished reading (skimming) that FAQ also :). I don&#39;t find the word aggregate in the Itanium ABI you linked. The ABI was written long along, before a lot of the changes in the C++ standard mentioned in the FAQ, and before some of the terms even existed. In particular, finer distinctions were introduced in later standard that the ABI doc wouldn&#39;t know about. 1/x"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1579661755, "post_id": 56464048, "comment_id": 105837273, "body": "I didn&#39;t read the ABI, but based on searches I can&#39;t find language covering the case. It mentions &quot;base class subobject&quot;  in the section you linked as one type &quot;potentially-overlapping subobject&quot; (the other one being data members with <code>no_unique_address</code>), but all further referces to &quot;base class subobject&quot; don&#39;t seem relevant (they are about vtables), and further refs to &quot;p-o subobject&quot; all seem to concern the data member case, not the base-class case. I&#39;m making a specific question on the topic, will link it here."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1579662425, "post_id": 56464048, "comment_id": 105837368, "body": "@PeterCordes - <a href=\"https://stackoverflow.com/questions/59852054/under-what-conditions-is-it-safe-to-use-stdmemcpy-to-copy-between-objects\">FYI</a>."}], "tags": [], "owner": {"reputation": 133, "user_id": 5882964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4bba69cf340a06d8626e067d9a8ba6a?s=128&d=identicon&r=PG&f=1", "display_name": "Arun Kumar", "link": "https://stackoverflow.com/users/5882964/arun-kumar"}, "is_accepted": false, "score": 5, "last_activity_date": 1559814529, "last_edit_date": 1559814529, "creation_date": 1559750121, "answer_id": 56464048, "question_id": 56463341, "link": "https://stackoverflow.com/questions/56463341/how-to-use-memset-while-handling-strings-in-c/56464048#56464048", "title": "How to use memset while handling strings in C++?", "body": "<p>This is the correct syntax for memset...</p>\n\n<pre><code>void* memset( void* dest, int ch, std::size_t count );\n</code></pre>\n\n<blockquote>\n  <p>Converts the value ch to unsigned char and copies it into each of the first count characters of the object pointed to by dest. If the object is a potentially-overlapping subobject or is not TriviallyCopyable (e.g., scalar, C-compatible struct, or an array of trivially copyable type), the behaviour is undefined. If count is greater than the size of the object pointed to by dest, the behaviour is undefined.</p>\n</blockquote>\n\n<p>(<a href=\"https://en.cppreference.com/w/cpp/string/byte/memset\" rel=\"nofollow noreferrer\">source</a>)</p>\n\n<p>For the first syntax <code>memset(str, 't', sizeof(str));</code>. The compiler complained because of extra size. It prints 18 times <code>tttttttttttttt!R@</code>. I suggest try with  <code>sizeof(str) -1</code> for char array.  </p>\n\n<p>For Second syntax <code>memset(str, \"t\", sizeof(str));</code> you are providing the second parameter is a string. This is the reason compiler complains error: invalid conversion from \u2018const char*\u2019 to \u2018int\u2019</p>\n"}, {"comments": [{"owner": {"reputation": 162, "user_id": 5208982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d5dc8c1f360273e02778fb2ac5956d?s=128&d=identicon&r=PG&f=1", "display_name": "grovkin", "link": "https://stackoverflow.com/users/5208982/grovkin"}, "edited": false, "score": 2, "creation_date": 1559851119, "post_id": 56470141, "comment_id": 99558834, "body": "And to be even more precise, when passing &quot;t&quot;, one passes the address of &#39;t&#39; in &quot;t&quot;.  So if it were converted to the <code>int</code> parameter in <code>memset</code>, it would be the pointer to &#39;t&#39; getting converted to <code>int</code>, rather than the value of the string getting converted to <code>int</code>."}], "tags": [], "owner": {"reputation": 79, "user_id": 4797233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353c7012e8e85acf9eaf1f19588b696e?s=128&d=identicon&r=PG&f=1", "display_name": "Valhalla", "link": "https://stackoverflow.com/users/4797233/valhalla"}, "is_accepted": false, "score": 5, "last_activity_date": 1559787249, "creation_date": 1559787249, "answer_id": 56470141, "question_id": 56463341, "link": "https://stackoverflow.com/questions/56463341/how-to-use-memset-while-handling-strings-in-c/56470141#56470141", "title": "How to use memset while handling strings in C++?", "body": "<p>Vlad has helpfully answered the first part of your question, but I feel like the second part could be explained a little more intuitively:</p>\n\n<p>As others have mentioned, <code>'t'</code> is a <em>character</em> whereas <code>\"t\"</code> is a <em>string</em>, and strings have a null terminator at the end. This makes <code>\"t\"</code> an array of not one but <em>two</em> characters - <code>['t', '\\0']</code>! This makes memset's error more intuitive - it can coerce a single <code>char</code> to an <code>int</code> easily enough, but it chokes when it's given an array of <code>char</code>s. Just like in Python, <code>int(['t', '\\0'])</code> (or <code>ord(['t', '\\0'])</code>) doesn't compute.</p>\n"}], "owner": {"reputation": 3360, "user_id": 10799544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe2b60d63cb82f884964d6d30715d51?s=128&d=identicon&r=PG&f=1", "display_name": "astro123", "link": "https://stackoverflow.com/users/10799544/astro123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7136, "favorite_count": 4, "closed_date": 1559871420, "accepted_answer_id": 56463565, "answer_count": 4, "score": 29, "last_activity_date": 1599924743, "creation_date": 1559747582, "last_edit_date": 1599924743, "question_id": 56463341, "link": "https://stackoverflow.com/questions/56463341/how-to-use-memset-while-handling-strings-in-c", "closed_reason": "Not suitable for this site", "title": "How to use memset while handling strings in C++?", "body": "<p>I am from Python background and recently learning C++. I was learning a C/C++ function called <code>memset</code> and following the online example from website <a href=\"https://www.geeksforgeeks.org/memset-in-cpp/\" rel=\"noreferrer\">https://www.geeksforgeeks.org/memset-in-cpp/</a> where I got some compilation errors:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>/**\n * @author      : Bhishan Poudel\n * @file        : a02_memset_geeks.cpp\n * @created     : Wednesday Jun 05, 2019 11:07:03 EDT\n * \n * Ref: \n */\n\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cstring&gt;\n\nusing namespace std;\n\nint main(int argc, char *argv[]){\n    char str[] = \"geeksforgeeks\";\n\n    //memset(str, \"t\", sizeof(str));\n    memset(str, 't', sizeof(str));\n\n    cout &lt;&lt; str &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Error when using single quotes 't'</strong><br>\nThis prints extra characters.</p>\n\n<pre><code>tttttttttttttt!R@`\n</code></pre>\n\n<p><strong>Error when using \"t\" with double quotes</strong>   </p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ g++ -std=c++11 a02_memset_geeks.cpp \na02_memset_geeks.cpp:17:5: error: no matching function for call to 'memset'\n    memset(str, \"t\", sizeof(str));\n    ^~~~~~\n/usr/include/string.h:74:7: note: candidate function not viable: no known\n      conversion from 'const char [2]' to 'int' for 2nd argument\nvoid    *memset(void *, int, size_t);\n         ^\n1 error generated.\n</code></pre>\n\n<p>How to use the memset in C++ ?</p>\n\n<p><strong>Further Study</strong><br>\nExcellent tutorial with shortcomings of <code>memset</code> is given here:\n<a href=\"https://web.archive.org/web/20170702122030/https:/augias.org/paercebal/tech_doc/doc.en/cp.memset_is_evil.html\" rel=\"noreferrer\">https://web.archive.org/web/20170702122030/https:/augias.org/paercebal/tech_doc/doc.en/cp.memset_is_evil.html</a></p>\n"}, {"tags": ["c++", "amazon-web-services"], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 3578847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8bd432751efd697d54ac5f981f07c6f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3578847", "link": "https://stackoverflow.com/users/3578847/user3578847"}, "edited": false, "score": 0, "creation_date": 1559747963, "post_id": 56463304, "comment_id": 99518421, "body": "Thank you very much! After being stuck for countless hours I was able to build it successfully!! Now I get a runtime exception: Assertion Failed: s_HttpClientFactory, not sure if it&#39;s related or not, will look into it"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1559747469, "creation_date": 1559747469, "answer_id": 56463304, "question_id": 56463178, "link": "https://stackoverflow.com/questions/56463178/linking-error-conflict-for-sendmessagea-method/56463304#56463304", "title": "linking error/conflict for SendMessageA method", "body": "<p>The problem is that the Windows system headers define the macro <code>SendMessage</code> to expand to either <code>SendMessageA</code> or <code>SendMessageW</code> depending on the existence of the <code>UNICODE</code> macro.</p>\n\n<p>It does this for a <em>lot</em> of functions in the Windows API, which of course means that there will be clashes with other code using symbols that turn out to be macros in Windows.</p>\n\n<p>One possible solution is to <code>#undef SendMessage</code> after <code>#include &lt;windows.h&gt;</code>. Which might not be possible if the code you try to build comes from a third party.</p>\n"}, {"tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": false, "score": 1, "last_activity_date": 1559747758, "creation_date": 1559747758, "answer_id": 56463385, "question_id": 56463178, "link": "https://stackoverflow.com/questions/56463178/linking-error-conflict-for-sendmessagea-method/56463385#56463385", "title": "linking error/conflict for SendMessageA method", "body": "<p>You may want to take a look at <a href=\"https://blogs.msmvps.com/gdicanio/2015/06/22/the-sticky-preprocessor-based-tchar-model-part-2-wheres-my-function/\" rel=\"nofollow noreferrer\">this blog post</a> for a detailed explanation.</p>\n\n<p>You may try with:</p>\n\n<pre><code>#undef SendMessage\n</code></pre>\n\n<p><em>before</em> including the AWS headers (similarly to the <code>#undef GetObject</code> you cited in your question).</p>\n"}], "owner": {"reputation": 305, "user_id": 3578847, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8bd432751efd697d54ac5f981f07c6f0?s=128&d=identicon&r=PG&f=1", "display_name": "user3578847", "link": "https://stackoverflow.com/users/3578847/user3578847"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 56463304, "answer_count": 2, "score": 1, "last_activity_date": 1559747758, "creation_date": 1559747023, "last_edit_date": 1559747517, "question_id": 56463178, "link": "https://stackoverflow.com/questions/56463178/linking-error-conflict-for-sendmessagea-method", "title": "linking error/conflict for SendMessageA method", "body": "<p>I have built the aws-cpp-sdk the following way:</p>\n\n<pre><code>cmake -G \"Visual Studio 15 2017 Win64\" -DCMAKE_BUILD_TYPE=Debug -DBUILD_ONLY=\"s3;sqs;sns\"\n</code></pre>\n\n<p>and after that I ran:</p>\n\n<pre><code>MSBuild.exe INSTALL.vcxproj\n</code></pre>\n\n<p>Which produced the following files in the \"*C:\\Program Files\\aws-cpp-sdk-all*\" directory:</p>\n\n<pre><code>aws-c-common.dll\naws-c-event-stream.dll\naws-checksums.dll\naws-cpp-sdk-access-management.dll\naws-cpp-sdk-access-management.lib\naws-cpp-sdk-cognito-identity.dll\naws-cpp-sdk-cognito-identity.lib\naws-cpp-sdk-core.dll\naws-cpp-sdk-core.lib\naws-cpp-sdk-iam.dll\naws-cpp-sdk-iam.lib\naws-cpp-sdk-sns.dll\naws-cpp-sdk-sns.lib\naws-cpp-sdk-sqs.dll\naws-cpp-sdk-sqs.lib\n\naws-c-common.lib\naws-c-event-stream.lib\naws-checksums.lib\n</code></pre>\n\n<p>along with the <em>include</em> directory. I have included all the headers and all the libraries:</p>\n\n<pre><code>#include &lt;aws/core/Aws.h&gt;\n#include &lt;aws/core/auth/AWSCredentials.h&gt;\n#include &lt;aws/core/client/ClientConfiguration.h&gt;\n#include &lt;aws/core/utils/logging/DefaultLogSystem.h&gt;\n#include &lt;aws/core/utils/logging/AWSLogging.h&gt;\n#include &lt;aws/sns/model/PublishRequest.h&gt;\n#include &lt;aws/sns/model/PublishResult.h&gt;\n#include &lt;aws/s3/model/ListObjectsRequest.h&gt;\n#include &lt;aws/core/utils/Outcome.h&gt;\n#include &lt;aws/s3/model/Bucket.h&gt;\n#include &lt;aws/sqs/SQSClient.h&gt;\n#include &lt;aws/sqs/model/SendMessageRequest.h&gt;\n\n#pragma comment( lib, \"aws-cpp-sdk-core.lib\"         )\n#pragma comment( lib, \"aws-c-common.lib\"         )\n#pragma comment( lib, \"aws-c-event-stream.lib\"   )\n#pragma comment( lib, \"aws-checksums.lib\"        )\n\n#pragma comment( lib, \"aws-cpp-sdk-core.lib\"     )\n#pragma comment( lib, \"aws-cpp-sdk-iam.lib\"  )\n#pragma comment( lib, \"aws-cpp-sdk-sqs.lib\"      )\n#pragma comment( lib, \"aws-cpp-sdk-sns.lib\"      )\n#pragma comment( lib, \"aws-cpp-sdk-cognito-identity.lib\"         )\n#pragma comment( lib, \"aws-cpp-sdk-access-management.lib\"        )\n\n...\n\nAws::SQS::SQSClient                 sqs;\nAws::SQS::Model::SendMessageRequest sm_req;\n\nsm_req.SetQueueUrl( \"https://sqs.amazonaws.com/123123\" );\nsm_req.SetMessageBody( stringJSONFormatted.c_str() );\n\nauto sm_out = sqs.SendMessage(sm_req);\nif (sm_out.IsSuccess())\n    Logger::Log( \"Message sent successfully to the AWS SQS\" );\nelse\n    Logger::Log( \"FAILED to send message send to AWS SQS\" );\n</code></pre>\n\n<p>But whenever I build this I get:</p>\n\n<pre><code>__declspec(dllimport) public: virtual class Aws::Utils::Outcome&lt;class Aws::SQS::Model::SendMessageResult,class Aws::Client::AWSError&lt;enum Aws::SQS::SQSErrors&gt; &gt; \n__cdecl Aws::SQS::SQSClient::SendMessageA(class Aws::SQS::Model::SendMessageRequest const &amp;)const \n(__imp_?SendMessageA@SQSClient@SQS@Aws@@UEBA?AV?$Outcome@VSendMessageResult@Model@SQS@Aws@@V?$AWSError@W4SQSErrors@SQS@Aws@@@Client@4@@Utils@3@AEBVSendMessageRequest@Model@23@@Z) \nfatal error LNK1120: 1 unresolved externals\n</code></pre>\n\n<p>I tried everything I could find, I even re-built the library many times with different arguments, but still the same problem persists. it seems it has something do with <strong>AWS::SQSClient::SendMessageA</strong> name conflicting with some kind of Windows method (but I'm probably wrong). There was one solution which stated, if I define this before the <em>AWS</em> headers, it should build:</p>\n\n<pre><code>#undef GetObject\n</code></pre>\n\n<p>but still the same error. Any suggestions please?</p>\n"}, {"tags": ["c++", "algorithm"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1559747032, "post_id": 56463164, "comment_id": 99517880, "body": "Why would you define <code>steps</code> to be <code>int</code> and then only to cast it to <code>ll</code> on return?"}, {"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 3, "creation_date": 1559747065, "post_id": 56463164, "comment_id": 99517901, "body": "Aside: don&#39;t use the pre-processor if you can avoid it, use <code>using ll = long long;</code> instead."}, {"owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "edited": false, "score": 0, "creation_date": 1559747174, "post_id": 56463164, "comment_id": 99517987, "body": "You&#39;ve called the variables <code>a</code> and <code>b</code> in your description, but <code>n</code> and <code>k</code> in the code - that&#39;s a bit confusing!"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "reply_to_user": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "edited": false, "score": 2, "creation_date": 1559747196, "post_id": 56463164, "comment_id": 99518002, "body": "@PaulEvans Even that is a no-no in my book. Just obfuscates the code."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559747201, "post_id": 56463164, "comment_id": 99518005, "body": "Continuing the stylistic comments, using names such as <code>ll</code> might seem like a good idea, but it&#39;s really not. Few other will know what it means, which leads to others having trouble understanding your code. If you want to create type-aliases, name them more &quot;semantically&quot;, like a descriptive name that tells readers what the type is for. And if you can&#39;t come up with a good descriptive name, then just leave it and use the full standard type name."}, {"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1559747451, "post_id": 56463164, "comment_id": 99518151, "body": "@DeiDei You take the <code>long long</code> road, and I&#39;ll take the <code>ll</code> road... :P All kidding aside, you have a point.  That would be unacceptable in industrial grade code."}, {"owner": {"reputation": 79, "user_id": 11244919, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gq-XA0rx-Pc/AAAAAAAAAAI/AAAAAAAAFxo/jb3jY5uJlsw/photo.jpg?sz=128", "display_name": "infrustration", "link": "https://stackoverflow.com/users/11244919/infrustration"}, "edited": false, "score": 0, "creation_date": 1559747626, "post_id": 56463164, "comment_id": 99518240, "body": "I just use <code>ll</code> in the code so that it looks shorter. I will change it back to <code>long long</code> when I send this to my teacher"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559747743, "post_id": 56463164, "comment_id": 99518306, "body": "@infrustration: You can make the code briefer more legitimately: e.g. <code>while (n)</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1559747805, "post_id": 56463164, "comment_id": 99518339, "body": "Are you sure this is the complete problem? There&#39;s never a decision to make; you just need to follow a rule, and you can trivially restate the second rule as &quot;subtracting the remainder&quot;."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1559747827, "post_id": 56463164, "comment_id": 99518352, "body": "I&#39;m voting to close this question as off-topic because it is a code review question, and thus belongs on <a href=\"https://codereview.stackexchange.com/\">the code review site</a>."}, {"owner": {"reputation": 79, "user_id": 11244919, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gq-XA0rx-Pc/AAAAAAAAAAI/AAAAAAAAFxo/jb3jY5uJlsw/photo.jpg?sz=128", "display_name": "infrustration", "link": "https://stackoverflow.com/users/11244919/infrustration"}, "reply_to_user": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559747889, "post_id": 56463164, "comment_id": 99518378, "body": "@Evg smallest number of operations"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 3, "creation_date": 1559748030, "post_id": 56463164, "comment_id": 99518455, "body": "Hint: You don&#39;t need to subtract 1 at a time. You can subtract by more than 1 (and increase the number of steps accordingly) to ensure that the next step will be division."}], "answers": [{"tags": [], "owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "is_accepted": true, "score": 8, "last_activity_date": 1559748355, "creation_date": 1559748355, "answer_id": 56463538, "question_id": 56463164, "link": "https://stackoverflow.com/questions/56463164/ways-to-go-from-a-number-to-0-the-fastest-way/56463538#56463538", "title": "Ways to go from a number to 0 the fastest way", "body": "<p>The algorithm can be improved given these observations:</p>\n\n<ol>\n<li>If <code>n&lt;k</code> then <code>k|(n-m)</code> will never hold for any positive m. So the answer is <code>n</code> steps.</li>\n<li>If <code>(k|n)</code> does not hold then the biggest number <code>m, m&lt;n</code> for which it does is <code>n - (n%k)</code>. So it takes <code>n%k</code> steps until (k|m) holds again.</li>\n</ol>\n\n<p>Actually all that you need is to keep doing division with remainder using <code>std::div</code> (or rely on compiler to optimize) and increase steps by remainder+1.</p>\n\n<pre><code>steps=0\nwhile(n&gt;0)\n     mod = n%k\n     n = n/k\n     steps+=mod + 1\nreturn steps\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1559763980, "post_id": 56465280, "comment_id": 99525519, "body": "&quot;Convert n to base k&quot; That&#39;s already what my algorithm does, instead of printing the digits it sums them. Then it just adds number of division. Without any external C++ packages. But this is valid algorithm too."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 1, "last_activity_date": 1559755424, "creation_date": 1559755424, "answer_id": 56465280, "question_id": 56463164, "link": "https://stackoverflow.com/questions/56463164/ways-to-go-from-a-number-to-0-the-fastest-way/56465280#56465280", "title": "Ways to go from a number to 0 the fastest way", "body": "<p>This can be done with an even simpler main program.</p>\n\n<p>Convert <code>n</code> to base <code>k</code>.  Let <code>d</code> be the number of digits in this number.\nTo get to 0, you will divide by <code>k</code> <code>(d-1)</code> times.\nThe number of times you subtract <code>1</code> is the digital sum of this number.</p>\n\n<p>For instance, consider n=314, k=3.</p>\n\n<p>314 in base 3 is <code>102122</code>.  This has 6 digits; the digital sum is 8.\nYou will have 6-1+8 steps ... 13 steps to 0.</p>\n\n<p>Use your C++ packages to convert to the new base, convert the digits to integers, and do the array sum.  This pushes all the shift-count work into module methods.</p>\n\n<p>Granted this won't work for weird values of <code>k</code>, but you can also steal available conversion packages instead of writing your own.</p>\n"}], "owner": {"reputation": 79, "user_id": 11244919, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gq-XA0rx-Pc/AAAAAAAAAAI/AAAAAAAAFxo/jb3jY5uJlsw/photo.jpg?sz=128", "display_name": "infrustration", "link": "https://stackoverflow.com/users/11244919/infrustration"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 1, "accepted_answer_id": 56463538, "answer_count": 2, "score": 0, "last_activity_date": 1559755424, "creation_date": 1559746962, "last_edit_date": 1559747973, "question_id": 56463164, "link": "https://stackoverflow.com/questions/56463164/ways-to-go-from-a-number-to-0-the-fastest-way", "title": "Ways to go from a number to 0 the fastest way", "body": "<p>So, I have a homework like this:</p>\n\n<p>Given two number <code>n</code> and <code>k</code> that can reach the <code>long long</code> limit, we do such operation: </p>\n\n<ul>\n<li>assign <code>n = n / k</code> if <code>n</code> is divisible by <code>k</code></li>\n<li>reduce <code>n</code> by <code>1</code> if <code>n</code> is not divisible by <code>k</code></li>\n</ul>\n\n<p>Find the smallest number of operations to go from <code>n</code> to <code>0</code>.</p>\n\n<p>This is my solution</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define ll long long\n\nll smallestSteps(ll n, ll k) {\n    int steps = 0;\n    if (n &lt; k) return n;\n    else if (n == k) return 2;\n    else {\n        while (n != 0) {\n            if (n % k == 0) {\n                n /= k;\n                steps++;\n            }\n            else {\n                n--;\n                steps++;\n            }\n        }\n        return (ll)steps;\n    }\n}\n</code></pre>\n\n<p>This solution is <code>O(n/k)</code> I think?</p>\n\n<p>But I think that <code>n</code> and <code>k</code> could be extremely big, and thus the program could exceed the time limit of 1s. Is there any better way to do this?</p>\n\n<p>Edit 1: I use <code>ll</code> for it to be shorter</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1559754123, "post_id": 56463111, "comment_id": 99521508, "body": "You need to use std::vector instead."}], "answers": [{"comments": [{"owner": {"reputation": 894, "user_id": 1919486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/hbjXo.png?s=128&g=1", "display_name": "paceholder", "link": "https://stackoverflow.com/users/1919486/paceholder"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1559752396, "post_id": 56463992, "comment_id": 99520804, "body": "This results in a code as if we were writing <code>int array[]</code> or <code>int * array</code>. But syntactically the variable is used to initialize an array of the certain length. In modern C++ nothing prevents you from initializing a non-static integral variable inside the class definition. Just in this specific context it does not work out."}], "tags": [], "owner": {"reputation": 894, "user_id": 1919486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/hbjXo.png?s=128&g=1", "display_name": "paceholder", "link": "https://stackoverflow.com/users/1919486/paceholder"}, "is_accepted": true, "score": 0, "last_activity_date": 1559752534, "last_edit_date": 1559752534, "creation_date": 1559749912, "answer_id": 56463992, "question_id": 56463111, "link": "https://stackoverflow.com/questions/56463111/why-use-static-keyword-before-public-data-member/56463992#56463992", "title": "why use &quot;static&quot; keyword before public data member?", "body": "<p>This expression defines a stack-allocated array of a fixed length. The length of the array must be known at compile time:</p>\n\n<pre><code>int array[students]\n</code></pre>\n\n<p>adding the <code>static</code> keyword inlines the length of the array as a compile-time constant.</p>\n\n<p>To allow in-class initialization as in your example you actually need to define the variable const and static as follows:</p>\n\n<pre><code>static const int students = 10;\n</code></pre>\n\n<p>You could find some details on arrays here <a href=\"http://www.cplusplus.com/doc/tutorial/arrays/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/doc/tutorial/arrays/</a></p>\n\n<p>Addition: passing an array of fixed length as a parameter results in passing a pointer, the length is ignored. Therefore, you could simply omit the \"length\" of the passed array and use your in-class variable as a constant for iterating through the array.</p>\n"}], "owner": {"reputation": 33, "user_id": 10639969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y5jqGL8Y1W4/AAAAAAAAAAI/AAAAAAAAABM/Qarsy9Labqo/photo.jpg?sz=128", "display_name": "reza moslemi", "link": "https://stackoverflow.com/users/10639969/reza-moslemi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56463992, "answer_count": 1, "score": 0, "last_activity_date": 1559752534, "creation_date": 1559746789, "last_edit_date": 1559751273, "question_id": 56463111, "link": "https://stackoverflow.com/questions/56463111/why-use-static-keyword-before-public-data-member", "title": "why use &quot;static&quot; keyword before public data member?", "body": "<p>I have an integer data member called \"students\" in public part of my class and is used as an argument in the constructor.\ngradebook.h:</p>\n\n<pre><code>class gradebook\n{\npublic:\n    int students = 10;\n    gradebook(string, int[]);\n    void SetCourseName(string _coursename);\n    ...\nprivate:\n    string coursename;\n    ...\n};\n</code></pre>\n\n<p>gradebook.cpp:</p>\n\n<pre><code>#include \"gradebook.h\"\n\ngradebook::gradebook(string s1, int array[students])\n{\n    SetCourseName(s1);\n}\nvoid gradebook::SetCourseName(string _coursename)\n{\n    coursename = _coursename;\n}\n</code></pre>\n\n<p>when I try to compile the code receive this error:</p>\n\n<pre><code>invalid use of non-static data member 'gradebook::students'\ngradebook::gradebook(string s1, int array[students])\n                                          ^\n</code></pre>\n\n<p>if I put 'static const' before 'int student = 10' the problem gets away.</p>\n\n<p>why?</p>\n"}, {"tags": ["c++", "sdl-2"], "comments": [{"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 1, "creation_date": 1559752817, "post_id": 56463097, "comment_id": 99521006, "body": "Think about how often update() is called. Is it 60x per second? If you want the character to &quot;step&quot; 32 pixels but only once per second, then only update the position once in every 60 calls to <code>update()</code>. If you want the character to slide between tiles but only stop when it is aligned to grid then you have to use a slower speed and check for grid alignment to know when to stop."}], "answers": [{"tags": [], "owner": {"reputation": 820, "user_id": 1675589, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a35386e8014459e87a744f8a00b0f3c1?s=128&d=identicon&r=PG", "display_name": "Michel Rouzic", "link": "https://stackoverflow.com/users/1675589/michel-rouzic"}, "is_accepted": false, "score": 1, "last_activity_date": 1561484215, "last_edit_date": 1561484215, "creation_date": 1561483872, "answer_id": 56759261, "question_id": 56463097, "link": "https://stackoverflow.com/questions/56463097/c-and-sdl2-grid-movement-is-too-fast/56759261#56759261", "title": "C++ and SDL2 Grid movement is too fast", "body": "<p>If you want only one step per press then in your <code>update()</code> function you need to zero your velocity vector after you're done using it, that will make it step only once, but you also have to check <code>event.key.repeat</code> and only accept events when it's 0 to avoid repeating the event ~30 times/second as long as the key is held down. If you want the stepping to repeat after a given delay then you'll need to store the return value (a <code>uint32_t</code> or <code>Uint32</code> if you prefer) of <code>SDL_GetTicks();</code> taken the moment a SDL_KEYUP event was received (with repeats ignored) then check if enough milliseconds have passed to repeat the stepping then add the time threshold to the stored time value to properly wait for the next repeating.</p>\n\n<p>Also you're zeroing your velocity vector every time any key is released, which in some cases you don't want. It might be better to add to the vector for each SDL_KEYDOWN event and subtract to under for each SDL_KEYUP, for matching keys of course. Also if you're gonna use WASD you should use scancodes instead of keysym, or your control scheme will be quite awkward on non-QWERTY layouts.</p>\n\n<p>Also there's probably no need for <code>SDL_Delay()</code>, just use Vsync which is set when you initialise your renderer with something like <code>renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_PRESENTVSYNC);</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 8029177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10d4fcd187c3591b57aca2c074179304?s=128&d=identicon&r=PG&f=1", "display_name": "Grossik", "link": "https://stackoverflow.com/users/8029177/grossik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561484215, "creation_date": 1559746744, "last_edit_date": 1559747357, "question_id": 56463097, "link": "https://stackoverflow.com/questions/56463097/c-and-sdl2-grid-movement-is-too-fast", "title": "C++ and SDL2 Grid movement is too fast", "body": "<p>My grid movement is too fast. This problem is due to speed, but I can't change it. Because then the grid doesn't work.</p>\n\n<pre><code>    if (Game::event.type == SDL_KEYDOWN) {\n        if (Game::event.key.keysym.sym == SDLK_w || Game::event.key.keysym.sym == SDLK_UP) {\n            transform-&gt;velocity.y = -1;\n        }\n        else if (Game::event.key.keysym.sym == SDLK_s || Game::event.key.keysym.sym == SDLK_DOWN) {\n            transform-&gt;velocity.y = 1;\n        }\n        else if (Game::event.key.keysym.sym == SDLK_d || Game::event.key.keysym.sym == SDLK_RIGHT) {\n            transform-&gt;velocity.x = 1;\n        }\n        else if (Game::event.key.keysym.sym == SDLK_a || Game::event.key.keysym.sym == SDLK_LEFT) {\n            transform-&gt;velocity.x = -1;\n        }\n    } else if (Game::event.type == SDL_KEYUP) {\n        transform-&gt;velocity.x = 0;\n        transform-&gt;velocity.y = 0;\n    }\n</code></pre>\n\n<p>And update for player position:</p>\n\n<pre><code>void update() override {\n    position.x += round(velocity.x * 32);\n    position.y += round(velocity.y * 32);\n}\n</code></pre>\n\n<p>Problem is in update player position, but if there weren't *32 player gets out from grid. (32 is grid size)</p>\n\n<p>Any idea how to solve it?</p>\n\n<p>And yes, I use SDL_Delay.</p>\n"}, {"tags": ["c++", "multithreading", "reference", "stl", "iterator"], "answers": [{"tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 1, "last_activity_date": 1559747973, "creation_date": 1559747973, "answer_id": 56463439, "question_id": 56463053, "link": "https://stackoverflow.com/questions/56463053/passing-reference-to-iterator-with-stdthread-fails-if-container-is-not-a-refer/56463439#56463439", "title": "Passing reference to iterator with std::thread fails if container is not a reference in calling function", "body": "<p>Function <code>parallelStuff</code> expects to get <em>const iterators</em> and you have to provide them.</p>\n\n<p>You can get <em>const iterators</em>:</p>\n\n<ol>\n<li>by calling <code>cbegin</code>/<code>cend</code> on an object </li>\n</ol>\n\n<p>or</p>\n\n<ol start=\"2\">\n<li>by call <code>begin</code>/<code>end</code> on <em>const object</em></li>\n</ol>\n\n<p>In the line below</p>\n\n<pre><code>auto member = foo.member();\n</code></pre>\n\n<p><em>auto type deduction</em> works which discards referenceness and constness from initializer. So <code>member</code> is just declared as <code>vector&lt;int&gt;</code>. So <code>begin</code>/<code>end</code> returns <code>vector&lt;int&gt;::iterator</code> what doesn't match to arguments of <code>parallelStuff</code>.</p>\n\n<p>To get <em>const iterators</em> on non-const object just call <code>cbegin</code>/<code>cend</code>:</p>\n\n<pre><code>auto it = member.cbegin();\nauto end = member.cend();\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/pbYLeJ\" rel=\"nofollow noreferrer\">LIVE DEMO</a></p>\n\n<hr>\n\n<p>This works</p>\n\n<pre><code>auto&amp; member\n</code></pre>\n\n<p>because <code>member</code> is deduced to be <code>const vector&lt;int&gt;&amp;</code>, so <code>begin</code> / <code>end</code> called on const object returns const iterators - <code>vector&lt;int&gt;::const_iterator</code> which matches to <code>parallelStuff</code> declaration.</p>\n"}], "owner": {"reputation": 61, "user_id": 5586698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2b427ea015eaa822b9e256e205a3a9f?s=128&d=identicon&r=PG&f=1", "display_name": "mable", "link": "https://stackoverflow.com/users/5586698/mable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 56463439, "answer_count": 1, "score": 1, "last_activity_date": 1559747973, "creation_date": 1559746589, "question_id": 56463053, "link": "https://stackoverflow.com/questions/56463053/passing-reference-to-iterator-with-stdthread-fails-if-container-is-not-a-refer", "title": "Passing reference to iterator with std::thread fails if container is not a reference in calling function", "body": "<p>here is my problem:</p>\n\n<p>I have a class with a container member, say a <code>std::vector</code>. I have a funtion, say <code>parallelStuff</code>, that takes <em>references</em> to iterators of this container and does stuff with it. I want to execute said function in parallel using <code>std::thread</code></p>\n\n<p>I have implemented this and it works fine. Now I wanted to write a very similar setup with one small difference: In the working version, in the function that invokes threads on <code>parallelStuff</code>, I get the iterators from a reference to the container.</p>\n\n<p>If, however, I obtain the iterators from a non-reference container, compilation fails.</p>\n\n<p>This is a working minimal example to replicate the issue:</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;vector&gt;\n\nclass Foo {\npublic:\n    Foo() {}\n    auto const &amp; member() { return member_; }\n    void parallelStuff(std::vector&lt;int&gt;::const_iterator &amp; it,\n                       std::vector&lt;int&gt;::const_iterator const &amp; end) {\n        // do stuff while it != end\n    }\nprivate:\n    std::vector&lt;int&gt; member_;\n};\n\n\nint main(int argc, char * argv[]) {\n    auto foo = Foo();\n    auto&amp; member = foo.member();\n    // auto member = foo.member();  &lt;-- copy instead of reference, this fails!\n    auto it = member.begin();\n    auto end = member.end();\n    auto t = std::thread(&amp;Foo::parallelStuff, &amp;foo,\n                         std::ref(it), std::ref(end));\n    t.join();\n\n    return 0;\n}\n\n</code></pre>\n\n<p>As said, if I use a copy of <code>member</code> instead of a reference, I get the error</p>\n\n<pre><code>/usr/include/c++/8/thread:120:17: error: static assertion failed: std::thread arguments must be invocable after conversion to rvalues\n</code></pre>\n\n<p>Googling the error message only led me to a <a href=\"http://www.davidespataro.it/modern-c-concurrency-how-to-use-a-thread-object-correctly-and-common-pitfalls/\" rel=\"nofollow noreferrer\">site</a> explaining that I need to wrap reference parameters in <code>std::ref()</code> which I already do. </p>\n\n<p>Does anyone understand what is going wrong here and can please explain it (and how to fix this)?</p>\n\n<p>Many thanks!</p>\n\n<p>PS: Im using <code>gcc version 8.3.0 (Ubuntu 8.3.0-6ubuntu1~18.04)</code> with <code>-std=c++17</code></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 1, "creation_date": 1559747435, "post_id": 56462988, "comment_id": 99518143, "body": "Welcome to Stack Overflow. This is a code review question, which dos not really belong on this site, but I notice that you calculate <code>n % 10</code> three times, when once would suffice. Also, the modulus operator might be significantly faster than repeated subtraction."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1559750095, "post_id": 56462988, "comment_id": 99519650, "body": "Input the number as a string.  Convert the digit from text to number using: <code>number = string[i] - &#39;0&#39;;</code>  This is faster than using division and remainder operations."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1559751027, "post_id": 56462988, "comment_id": 99520112, "body": "BTW, you don&#39;t need to use classes to contain functions.  You can declare and define them outside of the class, as <i>free standing functions</i>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11604478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3f338683ae18811aae6adcba19b957?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/11604478/abcd"}, "edited": false, "score": 0, "creation_date": 1559835817, "post_id": 56464455, "comment_id": 99552390, "body": "thanks all \u2665 but with paragraph L R: 79066480162306286 331124487134727415 the program is faulty in timelimit"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "reply_to_user": {"reputation": 1, "user_id": 11604478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3f338683ae18811aae6adcba19b957?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/11604478/abcd"}, "edited": false, "score": 0, "creation_date": 1559836026, "post_id": 56464455, "comment_id": 99552500, "body": "Do you know how much it is faulty?"}, {"owner": {"reputation": 1, "user_id": 11604478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3f338683ae18811aae6adcba19b957?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/11604478/abcd"}, "edited": false, "score": 0, "creation_date": 1559836319, "post_id": 56464455, "comment_id": 99552648, "body": "I think there is some formula for R up to 10 caps 18"}, {"owner": {"reputation": 1, "user_id": 11604478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3f338683ae18811aae6adcba19b957?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/11604478/abcd"}, "edited": false, "score": 0, "creation_date": 1559836644, "post_id": 56464455, "comment_id": 99552798, "body": "It is faulty at timelimit,with R = 10 ^ 8 then time = 1021: ((( ."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "reply_to_user": {"reputation": 1, "user_id": 11604478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3f338683ae18811aae6adcba19b957?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/11604478/abcd"}, "edited": false, "score": 0, "creation_date": 1559842223, "post_id": 56464455, "comment_id": 99555234, "body": "1021s instead of 1s ??"}], "tags": [], "owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "is_accepted": false, "score": 0, "last_activity_date": 1559752708, "last_edit_date": 1559752708, "creation_date": 1559751739, "answer_id": 56464455, "question_id": 56462988, "link": "https://stackoverflow.com/questions/56462988/sum-and-sum-of-squares-of-digits-coprime/56464455#56464455", "title": "Sum and sum of squares of digits -coprime", "body": "<p>As mentioned in comments, you can calculate the sum and the sum of squares in one loop, avoiding multiple calls of same <code>%</code> operation.</p>\n\n<p>Moreover, to calculate that two numbers are coprime, it is better to use the version of Euclide's algorithm that uses modulo instead of substractions. The code is below.</p>\n\n<p>In this code, I use the fact that the sum of squares is greater or equal the sum.<br>\nI also use the fact that if the sum is a multiple of 2, it is also the case for the sum of squares.</p>\n\n<p>If this code is not fast enough, you can try the suggestion in a comment to first convert the number to a string.</p>\n\n<p>Another possibility would be the check if both numbers are multiple of 3 or 5, before calculating the GCD, as GCD calculation can be longer. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;tuple&gt;\n\nstd::pair&lt;long long, long long&gt; getSum_pow(long long n) {\n    long long int sum = 0; \n    long long int sumP = 0; \n    while (n != 0) {\n        long long r = n%10;\n        sum += r; \n        sumP += r*r; \n        n = n/10; \n    }  \n    return {sumP, sum}; \n};\n\nint main() {\n\n    long long TONG = 0, a, b;\n    long long int m, n;\n    std::cin &gt;&gt; n &gt;&gt; m;\n\n    for(; n &lt;= m; n++) {\n        std::tie (a, b) = getSum_pow(n);\n        if (b%2 == 0) continue;\n        while (b != 0) {\n            a = a%b;\n            std::swap (a, b);\n        }\n        if (a == 1) {\n            TONG++;\n        }\n    }\n\n    std::cout &lt;&lt; TONG;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11604478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3f338683ae18811aae6adcba19b957?s=128&d=identicon&r=PG&f=1", "display_name": "ABCD", "link": "https://stackoverflow.com/users/11604478/abcd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559752708, "creation_date": 1559746387, "last_edit_date": 1559746524, "question_id": 56462988, "link": "https://stackoverflow.com/questions/56462988/sum-and-sum-of-squares-of-digits-coprime", "title": "Sum and sum of squares of digits -coprime", "body": "<blockquote>\n  <p>For the paragraph L, R\n   its sum of digits and the sum of its squares (in the decimal) is co- \n   prime.\n   Count how many numbers in the paragraph L, R meet the above conditions</p>\n</blockquote>\n\n<p>I was stuck on the sub21 \n exceeds time limit when R = 10^8 and Max R = 10^18:</p>\n\n<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nclass tinhtong \n{ \n    public: \n    long long getSum(long long n) \n    {  \n    long long int sum = 0; \n    while (n != 0) \n    { \n     sum = sum + (n % 10); \n     n = n/10; \n    }  \n return sum; \n    } \n};\n\nclass binhphuong \n{ \n    public: \n    long long getpow(long long n) \n    {  \n    long long poww = 0; \n    while (n != 0) \n    { \n     poww = poww + (n % 10)*(n % 10); \n     n = n/10; \n    }  \n return poww; \n    } \n};\n\nint main()\n{\n    tinhtong g;\n    binhphuong h;\n    long long TONG=0,k,l,ucln;\n    long long int m,n;\n    cin&gt;&gt;n&gt;&gt;m;\n    for(n;n&lt;=m;n++)\n        {\n            ucln=0;\n            k=g.getSum(n);\n            l=h.getpow(n);\n            while(k!=0 &amp;&amp; l!=0)\n                {\n                    if(k&gt;l)\n                    k-=l;\n                else\n                    l-=k;\n                }\n            if(k==0)\n                ucln=l;\n            else \n                ucln=k;\n        if (ucln==1) \n            TONG++;\n        }\n    cout&lt;&lt;TONG;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi", "com"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1559747110, "post_id": 56462922, "comment_id": 99517937, "body": "no, you not need do this. you simply finally return result of <code>CreateBitmapFromWicBitmap</code>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1559747121, "post_id": 56462922, "comment_id": 99517945, "body": "No, CreateBitmapFromWicBitmap() already did that.  So a single Release() call in the code that uses your function is enough to destroy it again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11157650"}, "edited": false, "score": 0, "creation_date": 1559747326, "post_id": 56462922, "comment_id": 99518082, "body": "Do you know in which case do I need to <code>AddRef()</code> ? any rules regarding AddRef"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1559747838, "post_id": 56462922, "comment_id": 99518362, "body": "in general <a href=\"https://docs.microsoft.com/en-us/windows/desktop/com/rules-for-managing-reference-counts\" rel=\"nofollow noreferrer\">Rules for Managing Reference Counts</a> but you need understand referece counting yourself. also <a href=\"https://docs.microsoft.com/en-us/windows/desktop/learnwin32/managing-the-lifetime-of-an-object\" rel=\"nofollow noreferrer\">Managing the Lifetime of an Object</a>"}], "answers": [{"tags": [], "owner": {"reputation": 37828, "user_id": 1629821, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/861cfc0de6bf99a544b500eac16229eb?s=128&d=identicon&r=PG", "display_name": "Mr.C64", "link": "https://stackoverflow.com/users/1629821/mr-c64"}, "is_accepted": true, "score": 1, "last_activity_date": 1559749630, "last_edit_date": 1559749630, "creation_date": 1559748483, "answer_id": 56463576, "question_id": 56462922, "link": "https://stackoverflow.com/questions/56462922/do-i-need-to-addref-if-returning-pointer-to-pointer-com-object-from-function/56463576#56463576", "title": "Do I need to AddRef() if returning pointer to pointer COM object from function?", "body": "<blockquote>\n<pre><code>hr = pRenderTarget-&gt;CreateBitmapFromWicBitmap(\n        pConverter,\n        0,\n        ppBitmap);\n</code></pre>\n</blockquote>\n\n<p>The <code>ID2D1Bitmap</code> object returned by successful calls of the <code>CreateBitmapFromWicBitmap</code> method above, <em>already</em> has a proper reference count set. So, you <em>shouldn't</em> call <code>AddRef</code> on it.</p>\n\n<p>You only need to invoke <code>Release</code> on the <code>ID2D1Bitmap*</code> COM interface pointer when you're done with the object.</p>\n\n<p>On the contrary, if you explicitly invoke <code>AddRef</code> one more time on the returned pointer, you will need a proper <em>additional</em> matching <code>Release</code> call, or the returned object won't free itself.</p>\n\n<p>Note that, since we are discussing C++ code (not C code), you can <em>simplify</em> all this COM interface pointer life-cycle management code using <em>smart</em> pointers like <a href=\"https://docs.microsoft.com/en-us/cpp/atl/reference/ccomptr-class\" rel=\"nofollow noreferrer\"><code>ATL::CComPtr</code></a>, instead of raw pointers to COM interfaces.</p>\n\n<p><code>CComPtr</code> will <em>automatically</em> invoke <code>AddRef</code> and <code>Release</code> on the wrapped raw COM interface pointers (for example, at the end of scope, <code>Release</code> will be invoked by the <code>~CComPtr</code> destructor), so you don't have to pay attention to these COM object life-time details. Moreover, also in case of exceptions, <code>Release</code> will be invoked automatically as well, so you won't leak COM objects when exceptions are thrown.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11157650"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 56463576, "answer_count": 1, "score": 1, "last_activity_date": 1559749630, "creation_date": 1559746123, "question_id": 56462922, "link": "https://stackoverflow.com/questions/56462922/do-i-need-to-addref-if-returning-pointer-to-pointer-com-object-from-function", "title": "Do I need to AddRef() if returning pointer to pointer COM object from function?", "body": "<p>Below is a function that loads resource image from executable into <code>ID2D1Bitmap</code> pointer.</p>\n\n<p>My question is, do I need to call <code>AddRef()</code> on <code>ID2D1Bitmap** ppBitmap</code> function parameter?</p>\n\n<p>for example at the end of the function do I need this:</p>\n\n<pre><code>(*ppBitmap)-&gt;AddRef();\n</code></pre>\n\n<p>I see code around internet do such call sometimes, sometimes not but I'm unable to understand when this is valid and when not?</p>\n\n<p>Note: For minimum compilable code I provide whole function, excluding error checking implementation.</p>\n\n<pre><code>#include &lt;sdkddkver.h&gt;\n#include &lt;Windows.h&gt;\n#include &lt;wincodec.h&gt;   // WIC\n#include &lt;d2d1.h&gt;       // ID2D1Bitmap\n\n//\n// Loads resource Image from executable\n// into ID2D1Bitmap* pointer\n//\ntemplate&lt;typename RenderType&gt;\nHRESULT LoadResourceImage(\n    IWICImagingFactory* pFactory,\n    PCTSTR szFilename,\n    PCTSTR szFileType,\n    RenderType* pRenderTarget,\n    ID2D1Bitmap** ppBitmap)\n{\n    HRESULT hr = S_OK;\n    DWORD dwImageSize = 0;\n    HMODULE hModule = GetModuleHandle(nullptr);\n\n    HRSRC hResource = nullptr;\n    HGLOBAL hResourceData = nullptr;\n    void* pImageFile = nullptr;\n    IWICStream* pStream = nullptr;\n    IWICFormatConverter* pConverter = nullptr;\n    IWICBitmapFrameDecode* pFrameDecode = nullptr;\n    IWICBitmapDecoder* pDecoder = nullptr;\n\n    if (!hModule)\n    {\n        ShowError(__FILENAME__, __LINE__);\n        goto done;\n    }\n\n    hResource = FindResource(hModule, szFilename, szFileType);\n    if (!hResource)\n    {\n        ShowError(__FILENAME__, __LINE__);\n        goto done;\n    }\n\n    if (FAILED(hr = hResource ? S_OK : E_FAIL))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    dwImageSize = SizeofResource(hModule, hResource);\n    if (!dwImageSize)\n    {\n        ShowError(__FILENAME__, __LINE__);\n        goto done;\n    }\n\n    if (FAILED(hr = dwImageSize ? S_OK : E_FAIL))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    hResourceData = LoadResource(hModule, hResource);\n    if (!hResourceData)\n    {\n        ShowError(__FILENAME__, __LINE__);\n        goto done;\n    }\n\n    if (FAILED(hr = hResourceData ? S_OK : E_FAIL))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    pImageFile = LockResource(hResourceData);\n    if (!pImageFile)\n    {\n        ShowError(__FILENAME__, __LINE__);\n        goto done;\n    }\n\n    if (FAILED(hr = pImageFile ? S_OK : E_FAIL))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    if (FAILED(hr = pFactory-&gt;CreateStream(&amp;pStream)))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    hr = pStream-&gt;InitializeFromMemory(\n        reinterpret_cast&lt;BYTE*&gt;(pImageFile), dwImageSize);\n\n    if (FAILED(hr))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    hr = pFactory-&gt;CreateDecoderFromStream(\n        pStream,\n        nullptr,\n        WICDecodeMetadataCacheOnDemand,\n        &amp;pDecoder);\n\n    if (FAILED(hr))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    if (FAILED(hr = pDecoder-&gt;GetFrame(0, &amp;pFrameDecode)))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    if (FAILED(hr = pFactory-&gt;CreateFormatConverter(&amp;pConverter)))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    hr = pConverter-&gt;Initialize(\n        pFrameDecode,\n        GUID_WICPixelFormat32bppPRGBA,\n        WICBitmapDitherTypeNone,\n        nullptr,\n        0.f,\n        WICBitmapPaletteTypeCustom);\n\n    if (FAILED(hr))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\n    hr = pRenderTarget-&gt;CreateBitmapFromWicBitmap(\n        pConverter,\n        0,\n        ppBitmap);\n\n    if (FAILED(hr))\n    {\n        ShowError(__FILENAME__, __LINE__, hr);\n        goto done;\n    }\n\ndone:\n    SafeRelease(&amp;pFrameDecode);\n    SafeRelease(&amp;pDecoder);\n    SafeRelease(&amp;pConverter);\n    SafeRelease(&amp;pStream);\n\n    return hr;\n}\n</code></pre>\n"}, {"tags": ["c++", "command-line", "catch2"], "owner": {"reputation": 1649, "user_id": 3516684, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5e55f57a1d9ea8a126a070aa68c060de?s=128&d=identicon&r=PG&f=1", "display_name": "Sparkler", "link": "https://stackoverflow.com/users/3516684/sparkler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 2, "answer_count": 0, "score": 4, "last_activity_date": 1587355280, "creation_date": 1559745450, "last_edit_date": 1587355280, "question_id": 56462724, "link": "https://stackoverflow.com/questions/56462724/how-to-access-custom-command-line-options-from-within-a-catch2-test-case", "title": "How to access custom command line options from within a Catch2 test case?", "body": "<p>I added my own command line option using a <a href=\"https://github.com/catchorg/Catch2/blob/master/docs/own-main.md#adding-your-own-command-line-options\" rel=\"nofollow noreferrer\">custom main file</a><sup>&dagger;</sup>:</p>\n\n<p><sup>&dagger;</sup><a href=\"https://github.com/catchorg/Catch2/blob/master/docs/own-main.md#adding-your-own-command-line-options\" rel=\"nofollow noreferrer\">https://github.com/catchorg/Catch2/blob/master/docs/own-main.md#adding-your-own-command-line-options</a></p>\n\n<pre><code>  // ...\n  auto cli \n    = session.cli() // Get Catch's composite command line parser\n    | Opt( height, \"height\" ) // bind variable to a new option, with a hint string\n        [\"-g\"][\"--height\"]    // the option names it will respond to\n        (\"how high?\");        // description string for the help output\n\n  // ...\n}\n</code></pre>\n\n<p>Now I want to use the <code>height</code> command line option from within a test case. What would be the best way to do this?</p>\n"}, {"tags": ["c++", "multithreading", "qt", "thread-safety", "qthread"], "comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 3, "creation_date": 1559745285, "post_id": 56462602, "comment_id": 99516850, "body": "As long as your signal-connection is a QueuedConnection, Qt&#39;s signal/slots mechanism will make sure that the slot gets called from within the slot-object&#39;s thread:  <a href=\"https://doc.qt.io/qt-5/qt.html#ConnectionType-enum\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qt.html#ConnectionType-enum</a>"}], "owner": {"reputation": 175, "user_id": 10255810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be1163b9e12692d4b611f67f7ca5b2c2?s=128&d=identicon&r=PG&f=1", "display_name": "rrd", "link": "https://stackoverflow.com/users/10255810/rrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1587355564, "creation_date": 1559745028, "last_edit_date": 1587355564, "question_id": 56462602, "link": "https://stackoverflow.com/questions/56462602/can-a-qobject-living-in-one-thread-emit-a-signal-from-another-thread", "title": "Can a QObject living in one thread emit a signal from another thread?", "body": "<p>I have an object <code>a</code> created in the main thread, where its signals are connected to slots of another object, <code>b</code>, that also lives in the main thread.</p>\n\n<p>Then I create an object <code>c</code> and move it to a <code>worker</code> thread, where it will <strong>periodically</strong> access object <code>a</code> through a pointer, change its state and emit its signals. </p>\n\n<p>Here is the code: </p>\n\n<p>(<strong>Note:</strong> some lines were purposely ignored to keep the example short.) </p>\n\n<pre><code>class A : public QObject\n{\n    Q_OBJECT\n    friend class C;\nsignals:\n    void sigA();\nprivate:\n    quint8 _m1;\n    quint8 _m2;\n};\n\nclass B : public QObject\n{\n    Q_OBJECT\npublic slots:\n    void slotB();\n};\n\nclass C : public QObject\n{\n    Q_OBJECT\npublic:\n    C(A* a) : _a{a}, _timer{new QTimer{this}}\n    {\n        _timer-&gt;setInterval(5);\n        connect(_timer, &amp;QTimer::timeout, this, &amp;C::doSomeWork);\n    }\n\npublic slots:\n    void start() { _timer-&gt;start(); }\n\nprivate slots:\n    void doSomeWork()\n    {\n        // update members of `a`\n        emit _a-&gt;sigA();\n        // ...\n    }\n\nprivate:\n    A* _a;\n    QTimer* _timer;\n};\n\nint main(int argc, char* argv[])\n{\n    QApplication app(argc, argv);\n\n    A* a {new A};\n    B* b {new B};\n    QObject::connect(a, &amp;A::sigA, b, &amp;B::slotB);\n\n    QThread* worker {new QThread};\n    C* c {new C{a}};    \n    c-&gt;moveToThread(worker);\n\n    QObject::connect(worker, &amp;QThread::started, c, &amp;C::start);    \n    worker-&gt;start();\n\n    return app.exec();\n}\n</code></pre>\n\n<p>I hope <em><code>a</code> signals</em>, emitted from thread <code>worker</code>, will trigger <em><code>b</code> slots</em> in the main thread. And I hope I'll have no concurrency problems because <code>a</code> members are 8-bit sized. </p>\n\n<p>But <code>c</code>, that lives in thread <code>worker</code>, will be posting events in the main thread event queue. I am not using any synchronization primitive, so I'm afraid I may run into problems. </p>\n\n<p>Is it OK to use the signal/slot mechanism the way I'm using it in the code example? Is there something I need to worry about?</p>\n"}, {"tags": ["c++", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 562, "user_id": 2721822, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Sn6dE.png?s=128&g=1", "display_name": "Hani Gotc", "link": "https://stackoverflow.com/users/2721822/hani-gotc"}, "edited": false, "score": 1, "creation_date": 1559747395, "post_id": 56462750, "comment_id": 99518118, "body": "thank you so much @sauqresKittles for your help. I was really confused on what to do with header.  Much appreciated help"}], "tags": [], "owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "is_accepted": true, "score": 3, "last_activity_date": 1559746784, "last_edit_date": 1559746784, "creation_date": 1559745568, "answer_id": 56462750, "question_id": 56462415, "link": "https://stackoverflow.com/questions/56462415/cmake-error-cannot-determine-link-language-for-target/56462750#56462750", "title": "CMake Error: Cannot determine link language for target", "body": "<p>Try this in your <code>SmartSingleton/CMakeLists.txt</code> file:</p>\n\n<p><code>set_target_properties(SmartSingleton PROPERTIES LINKER_LANGUAGE CXX)</code></p>\n\n<p>This will directly tell CMake which language to use for that target.</p>\n\n<p>If your library is truly only header files though, you will likely receive the error you mention also. Consider making this library an <code>INTERFACE</code> library:</p>\n\n<pre><code>add_library(SmartSingleton INTERFACE)\ntarget_include_directories(SmartSingleton INTERFACE include/)\n</code></pre>\n\n<p>Here are the <a href=\"https://cmake.org/cmake/help/latest/command/add_library.html#interface-libraries\" rel=\"nofollow noreferrer\">docs</a> for <code>INTERFACE</code> libraries.</p>\n"}], "owner": {"reputation": 562, "user_id": 2721822, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Sn6dE.png?s=128&g=1", "display_name": "Hani Gotc", "link": "https://stackoverflow.com/users/2721822/hani-gotc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2823, "favorite_count": 0, "closed_date": 1559746135, "accepted_answer_id": 56462750, "answer_count": 1, "score": 0, "last_activity_date": 1559747185, "creation_date": 1559744369, "last_edit_date": 1559747185, "question_id": 56462415, "link": "https://stackoverflow.com/questions/56462415/cmake-error-cannot-determine-link-language-for-target", "closed_reason": "Duplicate", "title": "CMake Error: Cannot determine link language for target", "body": "<p>I created the following Directory:</p>\n\n<pre><code>FrameWork/\n\u251c\u2500\u2500 CMakeLists.txt ==&gt; contains only add_subdirectory(UtilsBasic)\n\u2514\u2500\u2500 UtilsBasic\n    \u251c\u2500\u2500 CMakeLists.txt ==&gt; Contains only add_subdirectory(SmartSingleton)\n    \u2514\u2500\u2500 SmartSingleton\n        \u251c\u2500\u2500 CMakeLists.txt\n        \u251c\u2500\u2500 include\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 SmartSingleton.hpp\n</code></pre>\n\n<hr>\n\n<p>The <code>CMakeLists.txt</code> in <code>SmartSingleton</code> directory contains:</p>\n\n<pre><code>set(codeprod_list\n        include/SmartSingleton.hpp)\n\nUSR_add_shared_lib(SmartSingleton \"${codeprod_list}\")\ntarget_link_libraries(SmartSingleton PUBLIC Common)\ntarget_include_directories(SmartSingleton PUBLIC include/)\n</code></pre>\n\n<hr>\n\n<p>The main <code>CMakeLists.txt</code> of the project is the following:</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.4)\n\nproject (MyProject)\nUSR_init_project(MyProject)\n\nadd_subdirectory(src/FrameWork)\n</code></pre>\n\n<hr>\n\n<h2>Error</h2>\n\n<blockquote>\n  <p>-- Configuring done CMake Error: CMake can not determine linker language for target: SmartSingleton CMake Error: Cannot determine link\n  language for target \"SmartSingleton\".</p>\n</blockquote>\n\n<p>I don't understand Why I am getting that Error. I mean In the <code>Framework</code> I created a link to <code>UtilsBasic</code> and in turn a link to <code>SmartSingleton</code>.</p>\n"}, {"tags": ["c++", "vector", "find"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1559743595, "post_id": 56462084, "comment_id": 99515870, "body": "&quot;it doesn&#39;t detect <b>conllu</b>&quot;: maybe because you check for <b>.conllu</b>."}, {"owner": {"reputation": 29, "user_id": 11207562, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HLWYawVX_Mw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reu8Gja3rClfyb5lkRmisb-u_PVPw/mo/photo.jpg?sz=128", "display_name": "Quentin Lam", "link": "https://stackoverflow.com/users/11207562/quentin-lam"}, "edited": false, "score": 0, "creation_date": 1559743797, "post_id": 56462084, "comment_id": 99515981, "body": "In fact I want to detect if for example : <b>el_gdt-ud-dev.conllu</b> there is ** conllu** in the name of the file"}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 1, "creation_date": 1559743850, "post_id": 56462084, "comment_id": 99516023, "body": "Find checks for equality. If you want to detect substrings in the match you&#39;re going to have to provide it a function to check, possibly with find_if"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559743959, "post_id": 56462084, "comment_id": 99516077, "body": "only now I understood what the last paragraph is about, tried to make it more clear, roll back if you dont like it"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559743983, "post_id": 56462084, "comment_id": 99516100, "body": "<code>find</code> search for value, here you want string <b>ending</b> (or maybe containing) <code>&quot;.conllu&quot;</code>. you have to use <code>find_if</code> with appropriate predicate."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1559744013, "post_id": 56462084, "comment_id": 99516118, "body": "you dont want to find a string &quot;conllu&quot; In the vector but you want to find a string that contains &quot;conllu&quot;, thats two different things"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559744205, "post_id": 56462084, "comment_id": 99516229, "body": "BTW, since C++17, you have <code>std::file_system</code> to be more generic."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1559745262, "post_id": 56462084, "comment_id": 99516840, "body": "...and for pre-C++17, there&#39;s <a href=\"https://www.boost.org/doc/libs/release/libs/filesystem/doc/index.htm\" rel=\"nofollow noreferrer\">Boost.Filesystem</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 2, "last_activity_date": 1563532009, "last_edit_date": 1563532009, "creation_date": 1559746688, "answer_id": 56463083, "question_id": 56462084, "link": "https://stackoverflow.com/questions/56462084/how-to-check-whether-a-word-is-present-into-a-vector/56463083#56463083", "title": "How to check whether a word is present into a vector", "body": "<p>If you want to check if a <code>std::vector&lt;std::string&gt;</code> contains a specific <code>std::string</code>, you just have to do something like:</p>\n\n<pre><code>bool contains(const std::string &amp; word, const std::vector&lt;std::string&gt; &amp; set)\n{\n    bool found(false);\n    for(size_t i = 0; !found &amp;&amp; (i &lt; set.size()); ++i)\n    {\n        if(set[i] == word)\n            found = true;\n    }\n    return found;\n}\n</code></pre>\n\n<p>Now, if you want to check if a <code>std::string</code> contains a specific \"substring\", this is more complicated.<br/>I did it this way:</p>\n\n<pre><code>bool contains(const std::string &amp; pattern, const std::string &amp; str)\n{\n    bool found(false);\n\n    bool ongoing(false);\n    size_t cursor(0);\n    for(size_t i = 0; (!pattern.empty()) &amp;&amp; !found &amp;&amp; (i &lt; str.length()); ++i)\n    {\n        if(ongoing)\n        {\n            if(str[i] == pattern[0])\n            {\n                cursor = 1;\n            }\n            else if(str[i] == pattern[cursor])\n            {\n                if(cursor == pattern.length()-1)\n                    found = true;\n                else\n                    ++cursor;\n            }\n            else\n            {\n                ongoing = false;\n                cursor = 0;\n            }\n        }\n        else\n        {\n            if(str[i] == pattern[0])\n            {\n                if(pattern.size() == 1)\n                    found = true;\n                else\n                {\n                    ongoing = true;\n                    ++cursor;\n                }\n            }\n        }\n    }\n\n    return found;\n}\n</code></pre>\n\n<p>I tested it in all cases and it worked successfully.</p>\n\n<p>I hope it can help.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> I would be very surprised if there is no existing library that already has implemented this kind of function. But, if we want to implement it ourselves, this is a way to do it.</p>\n\n<hr>\n\n<p><strong>EDIT 2:</strong> I realized that my string search function had a problem with patterns that contains the same letter multiple times.<br/>Therefore, I have written a much better (simple/concise/functional/efficient) implementation of this function that can handle all possible cases:</p>\n\n<pre><code>bool contains(const std::string &amp; str, const std::string &amp; pattern)\n{\n    bool found(false);\n\n    if(!pattern.empty() &amp;&amp; (pattern.length() &lt; str.length()))\n    {\n        for(size_t i = 0; !found &amp;&amp; (i &lt;= str.length()-pattern.length()); ++i)\n        {\n            if((str[i] == pattern[0]) &amp;&amp; (str.substr(i, pattern.length()) == pattern))\n            {\n                found = true;\n            }\n        }\n    }\n\n    return found;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "is_accepted": true, "score": 1, "last_activity_date": 1559750452, "creation_date": 1559750452, "answer_id": 56464152, "question_id": 56462084, "link": "https://stackoverflow.com/questions/56462084/how-to-check-whether-a-word-is-present-into-a-vector/56464152#56464152", "title": "How to check whether a word is present into a vector", "body": "<p>You need to search each string in the vector for the substring <code>.conllu</code>. I would suggest a loop and <code>std::string::find</code>.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nint main() {\n    std::vector&lt;std::string&gt; v = { \"nope\", \"yes.conllu\", \"also.conllu\", \"nothere\" };\n\n    for (auto&amp; str : v) {\n        if (str.find(\".conllu\") != std::string::npos) {\n            std::cout &lt;&lt; \"Found .conllu in \" &lt;&lt; str &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11207562, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HLWYawVX_Mw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reu8Gja3rClfyb5lkRmisb-u_PVPw/mo/photo.jpg?sz=128", "display_name": "Quentin Lam", "link": "https://stackoverflow.com/users/11207562/quentin-lam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "closed_date": 1559750694, "accepted_answer_id": 56464152, "answer_count": 2, "score": 1, "last_activity_date": 1563532009, "creation_date": 1559743305, "last_edit_date": 1559744204, "question_id": 56462084, "link": "https://stackoverflow.com/questions/56462084/how-to-check-whether-a-word-is-present-into-a-vector", "closed_reason": "Duplicate", "title": "How to check whether a word is present into a vector", "body": "<p>I am using a vector to retrieve the names of the files into a path.\nI only want to get a certain type of file. That's why I am trying to use .find to detect if the file has the <strong>conllu</strong> format. I want to find out if a string  contains \"conllu\" or not</p>\n\n<pre><code>void read_directory(const std::string&amp; name, stringvec&amp; v)\n{\n    std::string pattern(name);\n    pattern.append(\"\\\\*\");\n    WIN32_FIND_DATA data;\n    HANDLE hFind;\n\n    if ((hFind = FindFirstFile(pattern.c_str(), &amp;data)) != INVALID_HANDLE_VALUE) {\n        while (FindNextFile(hFind, &amp;data) != 0) {\n            v.push_back(data.cFileName);\n        } \n        FindClose(hFind);\n    }\n}\nstd::vector&lt;std::string&gt; v;\nstd::vector&lt;std::string&gt;::iterator it;\nread_directory(\"path\", v);\nit = find(v.begin(), v.end(), \".conllu\");\nif (it != v.end())\n    std::cout &lt;&lt; \"Element found in myvector: \" &lt;&lt; *it &lt;&lt; '\\n';\n</code></pre>\n\n<p>Example of file names in the vector :</p>\n\n<pre><code>.gitignore\nCONTRIBUTING.md\nel_gdt-ud-dev.conllu\n</code></pre>\n"}, {"tags": ["c++", "constructor", "initializer-list", "list-initialization"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1559743062, "post_id": 56461977, "comment_id": 99515578, "body": "My rule of thumb (even though it is 100% accurate), <code>{}</code> is always list initialization.  If you don&#39;t want a list, use <code>()</code> instead."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559743107, "post_id": 56461977, "comment_id": 99515604, "body": "The second initialization is <a href=\"https://en.cppreference.com/w/cpp/language/list_initialization\" rel=\"nofollow noreferrer\"><i>list</i> initialization</a>, not <a href=\"https://en.cppreference.com/w/cpp/language/direct_initialization\" rel=\"nofollow noreferrer\">direct initialization</a>."}, {"owner": {"reputation": 1172, "user_id": 2312686, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb7b61692ac9cdc805439bbcef2e1a8d?s=128&d=identicon&r=PG", "display_name": "matovitch", "link": "https://stackoverflow.com/users/2312686/matovitch"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559743275, "post_id": 56461977, "comment_id": 99515701, "body": "@Someprogrammerdude Indeed but in the list-initialization link you provide, they say &quot;both explicit and non-explicit constructors are considered&quot; so why doesn&#39;t it default on the same one ? Is there a way to know ?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1559743320, "post_id": 56461977, "comment_id": 99515716, "body": "@Someprogrammerdude While it is list initialization, it is actually direct list initialization, which is considered direct initialization: <a href=\"https://timsong-cpp.github.io/cppwp/dcl.init#16\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/dcl.init#16</a>"}, {"owner": {"reputation": 1172, "user_id": 2312686, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb7b61692ac9cdc805439bbcef2e1a8d?s=128&d=identicon&r=PG", "display_name": "matovitch", "link": "https://stackoverflow.com/users/2312686/matovitch"}, "edited": false, "score": 0, "creation_date": 1559743407, "post_id": 56461977, "comment_id": 99515756, "body": "Well I think I&#39;ve found my answer reading a bit: <a href=\"https://stackoverflow.com/a/18224556/2312686\">stackoverflow.com/a/18224556/2312686</a>  &quot;The <code>initializer_list&lt;&gt;</code> constructor is preferred to the other constructors&quot;"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1559743569, "post_id": 56461977, "comment_id": 99515850, "body": "Unfortunately for you <code>static_cast&lt;std::size_t&gt;(2)</code> is a valid constexpr literal for <code>char</code> (and so no narrowing error)."}, {"owner": {"reputation": 1172, "user_id": 2312686, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb7b61692ac9cdc805439bbcef2e1a8d?s=128&d=identicon&r=PG", "display_name": "matovitch", "link": "https://stackoverflow.com/users/2312686/matovitch"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559743627, "post_id": 56461977, "comment_id": 99515879, "body": "Maybe someone could mark it as a duplicate of <a href=\"https://stackoverflow.com/q/27144054/2312686\">stackoverflow.com/q/27144054/2312686</a> (I think I cannot). What is strange though here is that the <code>static_cast</code> doesn&#39;t help. &lt;- Thanks @Jarod42"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1559743639, "post_id": 56461977, "comment_id": 99515889, "body": "@NathanOliver If I read <a href=\"https://en.cppreference.com/w/cpp/language/direct_initialization\" rel=\"nofollow noreferrer\">this page</a> correctly, case (2) is about &quot;object of <b>non-class</b> type&quot; and it adds &quot;(note: for class types and other uses of braced-init-list, see list-initialization)&quot; too."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1559743916, "post_id": 56461977, "comment_id": 99516048, "body": "@Jarod42 Is this duplicate really sufficient to answer the question? For me, your comment is as important as the information contains in the duplicate."}, {"owner": {"reputation": 1172, "user_id": 2312686, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb7b61692ac9cdc805439bbcef2e1a8d?s=128&d=identicon&r=PG", "display_name": "matovitch", "link": "https://stackoverflow.com/users/2312686/matovitch"}, "reply_to_user": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 0, "creation_date": 1559744279, "post_id": 56461977, "comment_id": 99516259, "body": "@Holt I proposed the duplicate but I&#39;m not a SO power user so I will gladly let you debate it. ;) Maybe there is a question somewhere about implicit cast of literals, there is then a combinatorics computation to determine the number of valid questions from the number of &quot;atomic&quot; topics."}], "owner": {"reputation": 1172, "user_id": 2312686, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb7b61692ac9cdc805439bbcef2e1a8d?s=128&d=identicon&r=PG", "display_name": "matovitch", "link": "https://stackoverflow.com/users/2312686/matovitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "closed_date": 1559743783, "answer_count": 0, "score": 0, "last_activity_date": 1559742909, "creation_date": 1559742909, "question_id": 56461977, "link": "https://stackoverflow.com/questions/56461977/direct-list-initialization-which-constructor-will-be-used", "closed_reason": "Duplicate", "title": "Direct list initialization, which constructor will be used?", "body": "<p>Recently, I found a bug in my code due to the use of \"modern\" 'direct list initialization' syntax. The gist of the issue looks like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main()\n{   \n    std::cout &lt;&lt; std::string(static_cast&lt;std::size_t&gt;(2), 'y');\n    std::cout &lt;&lt; std::string{static_cast&lt;std::size_t&gt;(2), 'x'};\n\n    return 0;\n}\n</code></pre>\n\n<p>With the following compilation command:</p>\n\n<pre><code>g++ -std=c++11 main.cpp &amp;&amp; ./a.out | xxd\n</code></pre>\n\n<p>I get the following result:</p>\n\n<pre><code>00000000: 7979 0278                                yy.x\n</code></pre>\n\n<p>Where we can see that the strings were not initialized in the same way. The first one use the <code>fill</code> string constructor which repeat the char <code>'y'</code> twice. But for the second one, it seems the braces are interpreted as a <code>std::initializer_list&lt;char&gt;</code>, hence the <code>0x02</code> in the binary output.</p>\n\n<p>Both <code>g++</code> and <code>clang++</code> produce the same behavior, so I suppose this is to be expected.</p>\n\n<p>The question is then, how do I know if/when my braces are interpreted as an argument list for a constructor or as a single <code>std::initializer_list</code> ? </p>\n"}, {"tags": ["c++", "c++11", "lambda", "c++14"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1559742678, "post_id": 56461842, "comment_id": 99515335, "body": "The type of a lambda is <i>implementation defined</i>, as will its size be. There&#39;s really no use-case to get its size."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1559742700, "post_id": 56461842, "comment_id": 99515359, "body": "@sethuPavanK There is used an alignemnt for the type double."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1559743457, "post_id": 56461842, "comment_id": 99515790, "body": "I was expecting <code>1</code> from my side... (as capture is useless)."}], "owner": {"reputation": 1, "user_id": 9901380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GWfAn.png?s=128&g=1", "display_name": "sethuPavanK", "link": "https://stackoverflow.com/users/9901380/sethupavank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 1, "closed_date": 1559742694, "answer_count": 0, "score": 0, "last_activity_date": 1559742763, "creation_date": 1559742515, "last_edit_date": 1559742763, "question_id": 56461842, "link": "https://stackoverflow.com/questions/56461842/why-is-the-size-of-lambda-memory-not-12", "closed_reason": "Duplicate", "title": "Why is the size of lambda memory not 12?", "body": "<p>I came across this issue whilearning lambdas,\nThis was run from Visual Studio 2017 in Debug X86 mode </p>\n\n<pre><code>int main()\n{\n  int i=0;\n  double j=0;\n  auto lambda = [i,j]()\n    {\n      std::cout&lt;&lt;sizeof(j)&lt;&lt;std::endl;\n      std::cout&lt;&lt;sizeof(i)&lt;&lt;std::endl;\n    };    \n    l();\n  std::cout&lt;&lt;sizeof(lambda);\n}\n</code></pre>\n\n<p>If both fields are <code>int</code>s I get a size of <code>8</code> (4+4). For a <code>double</code> and an <code>int</code> I was expecting an output of <code>12</code>(8+4), but instead it gives me <code>16</code>.</p>\n"}, {"tags": ["c++", "class", "pointers", "constants"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1559742577, "post_id": 56461811, "comment_id": 99515269, "body": "I fail to understand what you are confused about. If one dereferences <code>const A*</code>, one is left with <code>const A</code>, no?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559742613, "post_id": 56461811, "comment_id": 99515287, "body": "<code>p</code> is a pointer to <code>const</code> object, while <code>print</code> is not marked as const function. What is surprising?"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1559742668, "post_id": 56461811, "comment_id": 99515327, "body": "@SergeyA It&#39;s surprising if you think of const correctness as being enforced on a primary-expression basis rather than through the type system."}, {"owner": {"reputation": 97, "user_id": 9433179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f65699e9c4b74f3edc5805b43121f?s=128&d=identicon&r=PG&f=1", "display_name": "no one ever", "link": "https://stackoverflow.com/users/9433179/no-one-ever"}, "edited": false, "score": 1, "creation_date": 1559742755, "post_id": 56461811, "comment_id": 99515394, "body": "then const A* p = new A();  and  const A* p =   new  const A();  has no difference right ?"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1559742854, "post_id": 56461811, "comment_id": 99515451, "body": "They are <i>slightly</i> different, but not in a particularly useful way, and I&#39;ve never seen <code>new const A</code> in real code. See <a href=\"https://stackoverflow.com/questions/1927477/can-a-heap-allocated-object-be-const-in-c\" title=\"can a heap allocated object be const in c\">stackoverflow.com/questions/1927477/&hellip;</a> ."}, {"owner": {"reputation": 97, "user_id": 9433179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f65699e9c4b74f3edc5805b43121f?s=128&d=identicon&r=PG&f=1", "display_name": "no one ever", "link": "https://stackoverflow.com/users/9433179/no-one-ever"}, "edited": false, "score": 1, "creation_date": 1559742912, "post_id": 56461811, "comment_id": 99515492, "body": "why does the object that created is type-casted to const ? I mean I create a non-const integer and const integer that points to that integer ."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 2, "creation_date": 1559743022, "post_id": 56461811, "comment_id": 99515554, "body": "Because you did it when you assigned it to a variable of type <code>const A*</code>. C++ lets you implicitly cast a non-const object to a const type, since that&#39;s a completely safe thing to do."}, {"owner": {"reputation": 97, "user_id": 9433179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f65699e9c4b74f3edc5805b43121f?s=128&d=identicon&r=PG&f=1", "display_name": "no one ever", "link": "https://stackoverflow.com/users/9433179/no-one-ever"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 1, "creation_date": 1559743056, "post_id": 56461811, "comment_id": 99515573, "body": "@Sneftel thanks, now I understand :)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1559744578, "post_id": 56461811, "comment_id": 99516433, "body": "please include error messages verbatim instead of paraphrasing them. Calling it &quot;classic&quot; is a bit misplaced imho, what is classic about it?"}, {"owner": {"reputation": 97, "user_id": 9433179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f65699e9c4b74f3edc5805b43121f?s=128&d=identicon&r=PG&f=1", "display_name": "no one ever", "link": "https://stackoverflow.com/users/9433179/no-one-ever"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559745375, "post_id": 56461811, "comment_id": 99516902, "body": "@formerlyknownas_463035818 okey"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 9433179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f65699e9c4b74f3edc5805b43121f?s=128&d=identicon&r=PG&f=1", "display_name": "no one ever", "link": "https://stackoverflow.com/users/9433179/no-one-ever"}, "edited": false, "score": 0, "creation_date": 1559743022, "post_id": 56461854, "comment_id": 99515553, "body": "Hmm you say  the object created by new is const ? Why because I can point a const integer pointer to a non-const integer .  Is there a reason ?  ---- I got my Answer ----"}], "tags": [], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "is_accepted": true, "score": 6, "last_activity_date": 1559742555, "creation_date": 1559742555, "answer_id": 56461854, "question_id": 56461811, "link": "https://stackoverflow.com/questions/56461811/how-does-member-function-understand-that-the-object-is-obtained-by-dereferencing/56461854#56461854", "title": "How does member-function understand that the object is obtained by dereferencing a const pointer?", "body": "<p>Variables have types and can therefore be const or non-const, but expressions have types too. The type of <code>(*p)</code> is <code>const A</code>, and you can't call a non-const method of a const type.</p>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 7291499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53a35675a4ad60e5233e83a4bde6ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Simo Simov", "link": "https://stackoverflow.com/users/7291499/simo-simov"}, "is_accepted": false, "score": 3, "last_activity_date": 1559743780, "creation_date": 1559743780, "answer_id": 56462224, "question_id": 56461811, "link": "https://stackoverflow.com/questions/56461811/how-does-member-function-understand-that-the-object-is-obtained-by-dereferencing/56462224#56462224", "title": "How does member-function understand that the object is obtained by dereferencing a const pointer?", "body": "<p>There is no difference between (1) and (2). (1) is syntax sugar for (2).\nYou should define the print method as const in order to call it for const object.</p>\n\n<pre><code>void print() const { ... }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1956, "user_id": 878915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0870e5d6b30b12a448c8b0a2fe1f20?s=128&d=identicon&r=PG", "display_name": "shargors", "link": "https://stackoverflow.com/users/878915/shargors"}, "is_accepted": false, "score": 3, "last_activity_date": 1559745405, "creation_date": 1559745405, "answer_id": 56462705, "question_id": 56461811, "link": "https://stackoverflow.com/questions/56461811/how-does-member-function-understand-that-the-object-is-obtained-by-dereferencing/56462705#56462705", "title": "How does member-function understand that the object is obtained by dereferencing a const pointer?", "body": "<p>As it has already been noted, expressions have types and the type of (*p) is const A. You cannot call a non-const function on an object of a const type but you can call const member function.  Member functions can have a const qualifier which will mark them to be able to be invoked on const objects or pointers to const objects.</p>\n\n<pre><code>void print() const\n{\n   std::cout&lt;&lt;a&lt;&lt;std::endl;\n}\n</code></pre>\n\n<p>This will make your code compile. and it looks like this is what you intended to do anyway.</p>\n"}], "owner": {"reputation": 97, "user_id": 9433179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d84f65699e9c4b74f3edc5805b43121f?s=128&d=identicon&r=PG&f=1", "display_name": "no one ever", "link": "https://stackoverflow.com/users/9433179/no-one-ever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 2, "accepted_answer_id": 56461854, "answer_count": 3, "score": 3, "last_activity_date": 1559747162, "creation_date": 1559742424, "last_edit_date": 1559747162, "question_id": 56461811, "link": "https://stackoverflow.com/questions/56461811/how-does-member-function-understand-that-the-object-is-obtained-by-dereferencing", "title": "How does member-function understand that the object is obtained by dereferencing a const pointer?", "body": "<p>I created a const pointer which points to an instance of abject allocated dynamically.I could not understand the object itself is const or not.</p>\n\n<p>Firstly I tried to call a non-const member function by using pointer, as expected it caused a compile error because (it is my explanation, don't know if it is true or not) this pointer created by the member function is assigned to that const pointer. It did not yield anything.</p>\n\n<p>Secondly I tried to dereference  the pointer and call that non-const member function. I thought that the this pointer created by member function now will not be a const pointer because compile can not know the object returned by <code>p</code> (namely <code>*p</code>) is returned by a const pointer or not. It turns out that I was mistaken.</p>\n\n<p>How does member-function understand that ?</p>\n\n<pre><code>#include&lt;iostream&gt;\n\nclass A\n{\n    int a=4;\npublic:\n    A()\n    {}\n\n void   print()\n    {\n        std::cout&lt;&lt;a&lt;&lt;std::endl;\n    }\n};\n\n\nint main()\n{\n    const A* p = new A();  \n\n   p-&gt;print(); //1 causes compile error\n   (*p).print(); //2 causes compile error\n\n\n  return 0;\n}\n</code></pre>\n\n<p>I thought the line labelled as 2 will not create a compile error.\nIt causes a compile error.The error message is:</p>\n\n<blockquote>\n<pre><code>\"a.cpp: In function \u2018int main()\u2019:\na.cpp:21:13: error: passing \u2018const A\u2019 as \u2018this\u2019 argument discards qualifiers [-fpermissive]\n    p-&gt;print(); //1 causes compile error\n             ^\na.cpp:10:9: note:   in call to \u2018void A::print()\u2019\n  void   print()\n         ^~~~~\na.cpp:22:15: error: passing \u2018const A\u2019 as \u2018this\u2019 argument discards qualifiers [-fpermissive]\n    (*p).print(); //2 causes compile error\n               ^\na.cpp:10:9: note:   in call to \u2018void A::print()\u2019\n  void   print()\n         ^~~~~\n</code></pre>\n</blockquote>\n\n<pre><code>\n</code></pre>\n"}, {"tags": ["c++", "templates", "lambda"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559742047, "post_id": 56461665, "comment_id": 99514937, "body": "you get an error for the code? Please include it in the question"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1559742144, "post_id": 56461665, "comment_id": 99515003, "body": "Are you trying to reinvent <code>std::function</code>?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1559742148, "post_id": 56461665, "comment_id": 99515005, "body": "Your code has UB. You capture the function-local variable <code>lambda</code> by reference and return that. Capture by value instead."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 2881646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HRiC0.png?s=128&g=1", "display_name": "mdsimmo", "link": "https://stackoverflow.com/users/2881646/mdsimmo"}, "edited": false, "score": 0, "creation_date": 1559742332, "post_id": 56461714, "comment_id": 99515121, "body": "what is wrong with capturing by reference? Isn&#39;t that the point of lambdas?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 379, "user_id": 2881646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HRiC0.png?s=128&g=1", "display_name": "mdsimmo", "link": "https://stackoverflow.com/users/2881646/mdsimmo"}, "edited": false, "score": 3, "creation_date": 1559742431, "post_id": 56461714, "comment_id": 99515184, "body": "@mdsimmo Please read the entire statement: &quot;You are capturing <b>local parameter</b> by reference.&quot; (emphasis mine)"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 379, "user_id": 2881646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HRiC0.png?s=128&g=1", "display_name": "mdsimmo", "link": "https://stackoverflow.com/users/2881646/mdsimmo"}, "edited": false, "score": 1, "creation_date": 1559742439, "post_id": 56461714, "comment_id": 99515188, "body": "@mdsimmo You are returning a reference to a function-local variable. That variable <i>dies</i> at the end of the function, so accessing the reference is Undefined Behavior."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 3, "last_activity_date": 1559742118, "creation_date": 1559742118, "answer_id": 56461714, "question_id": 56461665, "link": "https://stackoverflow.com/questions/56461665/c-use-templates-to-wrap-any-lambda-inside-another-lambda/56461714#56461714", "title": "c++: Use templates to wrap any lambda inside another lambda", "body": "<p>That code has undefined behavior.</p>\n\n<pre><code>auto logLambda(T lambda) {\n    return [&amp;lambda]\n</code></pre>\n\n<p>You are capturing local parameter by reference. </p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1559742598, "last_edit_date": 1559742598, "creation_date": 1559742273, "answer_id": 56461766, "question_id": 56461665, "link": "https://stackoverflow.com/questions/56461665/c-use-templates-to-wrap-any-lambda-inside-another-lambda/56461766#56461766", "title": "c++: Use templates to wrap any lambda inside another lambda", "body": "<p>Use Raii to handle both void and non-void return type,<br>\nand capture functor by value to avoid dangling reference,<br>\nand use generic lambda to avoid to have to specify argument your self</p>\n\n<p>It results something like:</p>\n\n<pre><code>template &lt;class F&gt;\nauto logLambda(F f) {\n    return [f](auto... args) -&gt; decltype(f(args...)) {\n        struct RAII {\n            RAII()  { std::cout &lt;&lt; \"STARTING \" &lt;&lt; std::endl; }\n            ~RAII() { std::cout &lt;&lt; \"END \" &lt;&lt; std::endl; }\n        } raii;\n\n        return f(args...);\n    };\n}\n</code></pre>\n\n<p>Call look like:</p>\n\n<pre><code>const char* hello = \"Hello\";\nlogLambda([=](const char* s){ std::cout &lt;&lt; hello &lt;&lt; \" \" &lt;&lt; s &lt;&lt; std::endl; })(\"world\");\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/a707c8388ac6a84a\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 379, "user_id": 2881646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HRiC0.png?s=128&g=1", "display_name": "mdsimmo", "link": "https://stackoverflow.com/users/2881646/mdsimmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 56461766, "answer_count": 2, "score": 0, "last_activity_date": 1559742824, "creation_date": 1559741929, "question_id": 56461665, "link": "https://stackoverflow.com/questions/56461665/c-use-templates-to-wrap-any-lambda-inside-another-lambda", "title": "c++: Use templates to wrap any lambda inside another lambda", "body": "<p>I want to make a function that can wrap any lambda to log start/end calls on it.</p>\n\n<p>The code below works except for:</p>\n\n<ol>\n<li><p>any lambda that has captures</p></li>\n<li><p>any lambda that returns void (although this can easily be fixed by writing a second function)</p></li>\n</ol>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\ntemplate &lt;class T, class... Inputs&gt;\nauto logLambda(T lambda) {\n    return [&amp;lambda](Inputs...inputs) {\n        std::cout &lt;&lt; \"STARTING \" &lt;&lt; std::endl;\n        auto result = lambda(inputs...);\n        std::cout &lt;&lt; \"END \" &lt;&lt; std::endl;\n        return result;\n    };\n}\n\nint main() {\n    int a = 1;\n    int b = 2;\n\n    // works\n    auto simple = []() -&gt; int {\n        std::cout &lt;&lt; \"Hello\" &lt;&lt; std::endl; return 1;\n    };\n    logLambda(simple)();\n\n    // works so long as explicit type is declared\n    auto with_args = [](int a, int b) -&gt; int {\n        std::cout &lt;&lt; \"A: \" &lt;&lt; a &lt;&lt; \" B: \" &lt;&lt; b &lt;&lt; std::endl;\n        return 1;\n    };\n    logLambda&lt;int(int, int), int, int&gt;(with_args)(a, b);\n\n    // Does not work\n    // error: no matching function for call to \u2018logLambda&lt;int(int), int&gt;(main()::&lt;lambda(int)&gt;&amp;)\u2019\n    auto with_captures = [&amp;a](int b) -&gt; int {\n        std::cout &lt;&lt; \"A: \" &lt;&lt; a &lt;&lt; \" B: \" &lt;&lt; b &lt;&lt; std::endl;\n        return 1;\n    };\n    logLambda&lt;int(int), int&gt;(with_captures)(b);\n\n}\n</code></pre>\n\n<p>Is there any way to do this? Macros are also acceptable</p>\n"}, {"tags": ["c++", "ios", "swift", "sqlite"], "comments": [{"owner": {"reputation": 28506, "user_id": 9223839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29dcd6d8b4c4a0720ee253013c91d3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Joakim Danielson", "link": "https://stackoverflow.com/users/9223839/joakim-danielson"}, "edited": false, "score": 0, "creation_date": 1559749646, "post_id": 56461441, "comment_id": 99519389, "body": "Is this a swift or c++ question? It looks like your database is in the users Document folder."}, {"owner": {"reputation": 61, "user_id": 11604235, "user_type": "registered", "profile_image": "https://graph.facebook.com/1948193395286461/picture?type=large", "display_name": "Joon Lee", "link": "https://stackoverflow.com/users/11604235/joon-lee"}, "reply_to_user": {"reputation": 28506, "user_id": 9223839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29dcd6d8b4c4a0720ee253013c91d3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Joakim Danielson", "link": "https://stackoverflow.com/users/9223839/joakim-danielson"}, "edited": false, "score": 0, "creation_date": 1559803331, "post_id": 56461441, "comment_id": 99534936, "body": "I developed an ios app using swift on xcode but my class requires that we need to have some c++ part in it so we decided to make the database in c++ and the app will just access the database to pull information. I have the building.db, the database file in the same folder as other swift files and also added the file in xcode project."}, {"owner": {"reputation": 609, "user_id": 8052783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3888bbe0bfb09017a322ad3b181e835b?s=128&d=identicon&r=PG&f=1", "display_name": "Dragisa Dragisic", "link": "https://stackoverflow.com/users/8052783/dragisa-dragisic"}, "edited": false, "score": 0, "creation_date": 1594309385, "post_id": 56461441, "comment_id": 111087583, "body": "@JoonLee Did you find solution for this?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 11604235, "user_type": "registered", "profile_image": "https://graph.facebook.com/1948193395286461/picture?type=large", "display_name": "Joon Lee", "link": "https://stackoverflow.com/users/11604235/joon-lee"}, "edited": false, "score": 0, "creation_date": 1559743056, "post_id": 56461532, "comment_id": 99515574, "body": "How do i find the DB_PATH in c++ file?"}], "tags": [], "owner": {"reputation": 9806, "user_id": 5036586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fmn9x.jpg?s=128&g=1", "display_name": "Hitesh Surani", "link": "https://stackoverflow.com/users/5036586/hitesh-surani"}, "is_accepted": false, "score": 0, "last_activity_date": 1559742276, "last_edit_date": 1559742276, "creation_date": 1559741529, "answer_id": 56461532, "question_id": 56461441, "link": "https://stackoverflow.com/questions/56461441/sqlite3-open-cannot-open-file-at-line/56461532#56461532", "title": "sqlite3_open cannot open file at line", "body": "<p>You just need to pass Database path instead of name</p>\n\n<pre><code>exit = sqlite3_open(DB_PATH, &amp;db);\n</code></pre>\n\n<p>Use <a href=\"https://developer.apple.com/documentation/foundation/nsstring/1414559-filesystemrepresentation\" rel=\"nofollow noreferrer\">fileSystemRepresentation</a> to convert string path to <code>char*</code></p>\n\n<pre><code>[strPath fileSystemRepresentation];\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11604235, "user_type": "registered", "profile_image": "https://graph.facebook.com/1948193395286461/picture?type=large", "display_name": "Joon Lee", "link": "https://stackoverflow.com/users/11604235/joon-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 957, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1559743398, "creation_date": 1559741195, "last_edit_date": 1559743398, "question_id": 56461441, "link": "https://stackoverflow.com/questions/56461441/sqlite3-open-cannot-open-file-at-line", "title": "sqlite3_open cannot open file at line", "body": "<p>I'm making a ios application using swift with c++ sqlite database. My problem is when I run the code in xcode, I get an error when trying to open the database in c++ file.\n[logging-persist] cannot open file at line 42263 of [95fbac39ba]</p>\n\n<p>I tried to get the correct file path like how we would use sqlite in swift and just copied and pasted that path to c++ file but it didn't work. The filepath I got was /Users/racelab/Library/Developer/CoreSimulator/Devices/1B9AB8BA-C000-42CC-8588-211E0928722F/data/Containers/Data/Application/F4C2A19E-10C5-4474-8DFD-D4105C859A19/Documents/buildings.db </p>\n\n<pre><code>double Database::getLatitude(const char* nameOfBuilding){\nint exit = 0;\n\nexit = sqlite3_open(\"buildings.db\", &amp;db);\n</code></pre>\n\n<p>I expect to get the correct filepath so that I can open sqlite3 database.</p>\n"}, {"tags": ["c++", "arrays", "multidimensional-array", "heap-memory"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559741100, "post_id": 56461384, "comment_id": 99514328, "body": "You don&#39;t need <i>pointer</i> on <code>vector</code>, <code>vector</code> would be enough."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1559741127, "post_id": 56461384, "comment_id": 99514338, "body": "2d vectors should be avoided as they have no guaranteed memory locality.  If you need a matrix, either get a good matrix library, or write your own using a flat vector and fake that it has multiple dimensions."}, {"owner": {"reputation": 15, "user_id": 7133619, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274784782561038/picture?type=large", "display_name": "Jens Eirik S&#230;thre", "link": "https://stackoverflow.com/users/7133619/jens-eirik-s%c3%a6thre"}, "edited": false, "score": 0, "creation_date": 1559741362, "post_id": 56461384, "comment_id": 99514460, "body": "I would like to not use a <code>std::vector</code>, if possible. I have two entities A and B, and just need a large matrix where I can read whether A is covered by B, which will be updated very often during the course of the simulation."}, {"owner": {"reputation": 15, "user_id": 7133619, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274784782561038/picture?type=large", "display_name": "Jens Eirik S&#230;thre", "link": "https://stackoverflow.com/users/7133619/jens-eirik-s%c3%a6thre"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559741603, "post_id": 56461384, "comment_id": 99514615, "body": "@Jarod42 I have learned Systems Programming in C where there are no classes, that&#39;s why I&#39;m not sure about how instances of classes are layout in memory. If I were to use no pointer, how would the compiler know that <code>coverage_matrix</code> is to be stored on the heap and not on the stack? Or does it even need to know?"}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 1, "creation_date": 1559741663, "post_id": 56461384, "comment_id": 99514661, "body": "Use <code>vector</code>. It is a good choice for this problem."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559741671, "post_id": 56461384, "comment_id": 99514668, "body": "internal of vector has pointer(s), but you don&#39;t need to have pointer to use it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559741676, "post_id": 56461384, "comment_id": 99514673, "body": "@JensEirikS&#230;thre Vector store it&#39;s data on the &quot;heap&quot;.  The vector itself is only a couple pointers in size."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1559741703, "post_id": 56461384, "comment_id": 99514692, "body": "<a href=\"//stackoverflow.com/a/10116675\">Heap allocate a 2D array (not array of pointers)</a>"}, {"owner": {"reputation": 15, "user_id": 7133619, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274784782561038/picture?type=large", "display_name": "Jens Eirik S&#230;thre", "link": "https://stackoverflow.com/users/7133619/jens-eirik-s%c3%a6thre"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559741881, "post_id": 56461384, "comment_id": 99514828, "body": "@Jarod42 okay. well, thanks! but I only have to take care of the deletion of a vector myself if I explicitly allocate it with the <code>new</code> keyword, am i right?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1559741884, "post_id": 56461384, "comment_id": 99514832, "body": "For a 2d array then you can do something like this <a href=\"https://stackoverflow.com/a/53038618/3807729\">stackoverflow.com/a/53038618/3807729</a>"}, {"owner": {"reputation": 15, "user_id": 7133619, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274784782561038/picture?type=large", "display_name": "Jens Eirik S&#230;thre", "link": "https://stackoverflow.com/users/7133619/jens-eirik-s%c3%a6thre"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1559741937, "post_id": 56461384, "comment_id": 99514865, "body": "@JohnnyMopp This would work if one of the dimension was known to be <code>const</code>, but I explicitly stated that it isn&#39;t. Hence the declaration will not work."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1559741976, "post_id": 56461384, "comment_id": 99514887, "body": "There is no point in allocating a <code>std::vector</code> using <code>new</code> because it already allocates its internal data on the heap."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1559741987, "post_id": 56461384, "comment_id": 99514893, "body": "@JohnnyMopp That answer is for C, not C++. They are distinct language which favor different kinds of solutions."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559741995, "post_id": 56461384, "comment_id": 99514897, "body": "@JensEirikS&#230;thre &quot;<i>but I only have to take care of the deletion of a vector myself if I explicitly allocate it with the new keyword</i>&quot; Why would you need to allocate <code>std::vector</code> with <code>new</code>? You don&#39;t need to do that.."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1559742232, "post_id": 56461384, "comment_id": 99515058, "body": "Beware if you need consecutive <code>bool</code> elements use a <code>vector&lt;char&gt;</code> and definitely not a <code>vector&lt;bool&gt;</code> which is a highly optimized programmer trap (it stores 8 booleans in a byte)"}, {"owner": {"reputation": 15, "user_id": 7133619, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274784782561038/picture?type=large", "display_name": "Jens Eirik S&#230;thre", "link": "https://stackoverflow.com/users/7133619/jens-eirik-s%c3%a6thre"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559742674, "post_id": 56461384, "comment_id": 99515333, "body": "@AlgirdasPreid\u017eius Okay. So the <code>coverage_matrix</code> vector itself will be on the stack. however, the data that it holds is allocated on the heap? So as soon as <code>coverage_matrix</code> goes out of the scope, will the allocated space for the data be freed?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1559742745, "post_id": 56461384, "comment_id": 99515387, "body": "@JensEirikS&#230;thre Short answer: yes. Long answer: Consider learning from a <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1559743052, "post_id": 56461870, "comment_id": 99515571, "body": "@Bob__ I read that as not a contiguous array of bool because it&#39;s compressed into less space. Note the condition on n. Although that and all other details of its optimization (or not) are implementation defined."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 0, "creation_date": 1559743197, "post_id": 56461870, "comment_id": 99515654, "body": "@KennyOstrom I added an addendum mentioning the implementation definedness."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1559744421, "last_edit_date": 1592644375, "creation_date": 1559742587, "answer_id": 56461870, "question_id": 56461384, "link": "https://stackoverflow.com/questions/56461384/multi-dimensional-array-as-a-class-member-to-be-allocated-on-the-heap/56461870#56461870", "title": "Multi-dimensional array as a class member to be allocated on the heap", "body": "<blockquote>\n<p>2-dimensional ... array ... of size <code>num_a * num_b</code> ... Due to its size, it needs to be alloacted on the heap.  It needs to be contiguous in memory</p>\n<pre><code>std::vector&lt;std::vector&lt;bool&gt;&gt;\n</code></pre>\n</blockquote>\n<p>In a vector of vectors, rows are contiguous within themselves, but not in relation to each other. This is the same as an array of pointers. So, this does not satisfy your need for contiguous layout.</p>\n<blockquote>\n<pre><code> new std::vector&lt;std::vector&lt;bool&gt;&gt;()\n</code></pre>\n</blockquote>\n<p>There is hardly ever a need to dynamically allocate a vector like this. It is best to be avoided for benefit of correctness, and performance.</p>\n<hr />\n<p>The only solution to allocating a contiguous array of dynamic size is to allocate a 1-dimensional array, where the rows are flatly one after the other. Like this for example:</p>\n<pre><code>std::vector&lt;bool&gt; matrix(num_a * num_b);\n</code></pre>\n<p>You can access the element [a][b] at index <code>a + num_a * b</code>.</p>\n<hr />\n<p>Note that <code>std::vector&lt;bool&gt;</code> is very special and different from other vectors. It does not contain any <code>bool</code> objects, but rather the bits are packed, and accessed through masking and shifting <sup>1</sup>. This makes the data structure very cache friendly, but operations more complicated. Whether this is good or bad for performance depends on what you do with it as well as the CPU arcitecture.</p>\n<p>More importantly than the performance consideration, this means that some guarantees that you can rely on with other arrays don't apply to <code>std::vector&lt;bool&gt;</code>. For example, you cannot take the address of an element, nor can you modify different elements in different threads without synchronisation. And regarding your particular case since there are no guarantee of bool objects, there certainly aren't guaranteed to be contiguous bool objects in the vector.</p>\n<p>So, if you need a regular array of <code>bool</code>, you need to work around the specialization when using a vector. For example:</p>\n<pre><code>enum boolean : bool {no, yes};\nstd::vector&lt;boolean&gt; matrix;\n</code></pre>\n<p><sup>1</sup> Technically, there is no guarantee of any particular representation. It is implementation defined.</p>\n"}], "owner": {"reputation": 15, "user_id": 7133619, "user_type": "registered", "profile_image": "https://graph.facebook.com/1274784782561038/picture?type=large", "display_name": "Jens Eirik S&#230;thre", "link": "https://stackoverflow.com/users/7133619/jens-eirik-s%c3%a6thre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56461870, "answer_count": 1, "score": 0, "last_activity_date": 1559744421, "creation_date": 1559740982, "last_edit_date": 1559741032, "question_id": 56461384, "link": "https://stackoverflow.com/questions/56461384/multi-dimensional-array-as-a-class-member-to-be-allocated-on-the-heap", "title": "Multi-dimensional array as a class member to be allocated on the heap", "body": "<p>I am programming a simulation for my bachelor's thesis and I'm not an expert in C++, and after having searched for quite some time now without finding a convenient answer, or question, for that matter, I resort to you guys.</p>\n\n<p>My problem is as follows. I have some class that has a couple of member fields <code>num_a</code> and <code>num_b</code> besides others that can be stored on the stack. Now both these values are roughly of size 1000-2000. What I need now is another class member for <code>SampleClass</code>, namely a 2-dimensional boolean array of size <code>num_a</code> * <code>num_b</code>. Due to its size, it needs to be alloacted on the heap. It needs to be contiguous in memory, so storing a pointer to pointers to arrays does not work for me.</p>\n\n<pre><code>SampleClass : Object {\n   public:\n         uint16_t num_a;\n         uint16_t num_b;\n         ??? // some data structure for my 2d array\n\n         // simple constructor\n         SampleClass(num_a, num_b);\n\n}\n</code></pre>\n\n<p>I declare my classes in a header file <code>.h</code> and implement the functions and the constructor in a source file <code>.cc</code>. </p>\n\n<p>As you see, the values of both <code>num_a</code> and <code>num_b</code> are not pre-determined and thus not <code>const</code>. My question is, how do I (in a simple way) declare this thing in the header file, and how do I initialize it in the constructor in the source file?</p>\n\n<p>A thing that I have found that uses vector is the following:</p>\n\n<pre><code>// header file\nstd::vector&lt;std::vector&lt;bool&gt;&gt; *coverage_matrix;\n\n// source file\ncoverage_matrix = new std::vector&lt;std::vector&lt;bool&gt;&gt;();\ncoverage_matrix-&gt;push_back(something); // do something with it\n</code></pre>\n\n<p>Does this last approach work and more importantly, is it as efficient as a solution that does not rely on <code>std::vector</code> would be? </p>\n\n<p>Thanks for your answers.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 3, "creation_date": 1559740625, "post_id": 56461253, "comment_id": 99514064, "body": "What do you think <code>[columnNumber]</code> means?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1559740669, "post_id": 56461253, "comment_id": 99514091, "body": "@Mari getTableColumns is a function without parameters. So this expression getTableColumns(                      [columnNumber]-&gt;getColumnValues()[i]) does not make sense."}, {"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 0, "creation_date": 1559741076, "post_id": 56461253, "comment_id": 99514312, "body": "why are you c style casting a string which is already a string to a string?"}, {"owner": {"reputation": 9, "user_id": 11590829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9bc9b127b7784879bc7279082f3af8e?s=128&d=identicon&r=PG&f=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/11590829/mari"}, "edited": false, "score": 0, "creation_date": 1559741191, "post_id": 56461253, "comment_id": 99514372, "body": "[columnNumber] is  iterator"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1559741271, "post_id": 56461253, "comment_id": 99514419, "body": "Ye gods. <code>if ((string)thisValue.compare((string)(getTableColumns()                  [columnNumber]-&gt;getColumnValues()[i])) == 0)</code> wants to be four statements, not one."}, {"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 0, "creation_date": 1559741362, "post_id": 56461253, "comment_id": 99514461, "body": "no it is not an iterator, it is an index to a pointer in _columns;"}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1559741524, "post_id": 56461253, "comment_id": 99514573, "body": "I suppose the <code>return _columns;</code> instruction does much more than you expect..."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1559741607, "post_id": 56461253, "comment_id": 99514618, "body": "You&#39;re gonna copy a lot this way"}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 1, "last_activity_date": 1559741267, "creation_date": 1559741267, "answer_id": 56461462, "question_id": 56461253, "link": "https://stackoverflow.com/questions/56461253/expression-must-have-pointer-to-object-type-vector-of-pointers/56461462#56461462", "title": "Expression must have pointer- to- object type (vector of pointers)", "body": "<p><code>Column::getColumnValues</code> is declared <code>void</code> yet you return a value and then later index into the result.</p>\n"}], "owner": {"reputation": 9, "user_id": 11590829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9bc9b127b7784879bc7279082f3af8e?s=128&d=identicon&r=PG&f=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/11590829/mari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559741325, "creation_date": 1559740467, "last_edit_date": 1559741325, "question_id": 56461253, "link": "https://stackoverflow.com/questions/56461253/expression-must-have-pointer-to-object-type-vector-of-pointers", "title": "Expression must have pointer- to- object type (vector of pointers)", "body": "<p>In my function <code>Delete</code> I have an error that says that <code>getTableColumns</code> must have a pointer-to-object type.</p>\n\n<p>Class Column is an abstract class.</p>\n\n<pre><code>class Table {\n\n    vector&lt;Column*&gt; _columns;\n    Column* value;\n    char* name;\npublic:\n    vector&lt;Column*&gt; getTableColumns() {\n        return _columns;\n    }\n\nvoid Delete(char* name, int columnNumber, string thisValue) {\n    for (int i = 0; i &lt;= findLongestColumn(); i++) {\n                if ((string)thisValue.compare((string)(getTableColumns()\n                     [columnNumber]-&gt;getColumnValues()[i])) == 0)//!!!error\n                {...}    \n        }\n}\n\n</code></pre>\n\n<pre><code>template &lt;typename T&gt;\nclass DataColumn : public Column {\n\n    vector&lt;T&gt; values;\n\npublic:\n    void getColumnValues()\n    {\n        return values;\n    }\n</code></pre>\n"}, {"tags": ["c++", "makefile", "sdl"], "comments": [{"owner": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 0, "creation_date": 1559740595, "post_id": 56460984, "comment_id": 99514052, "body": "Are the various SDL libraries in <code>lib</code> or <code>libs</code>?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559740778, "post_id": 56460984, "comment_id": 99514140, "body": "Are you using the proper libraries for your architecture?"}, {"owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "reply_to_user": {"reputation": 861, "user_id": 4156301, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jZcC1Xqf-d4/AAAAAAAAAAI/AAAAAAAAAKg/Px0JaE_dlVk/photo.jpg?sz=128", "display_name": "SilvanoCerza", "link": "https://stackoverflow.com/users/4156301/silvanocerza"}, "edited": false, "score": 0, "creation_date": 1559741190, "post_id": 56460984, "comment_id": 99514370, "body": "@SilvanoCerza they are in <code>lib</code>.. I only messed up the description of the problem, there should be <code>.&#47;lib</code>."}, {"owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559741368, "post_id": 56460984, "comment_id": 99514466, "body": "@Yastanub Yes, I believe so, I developed my game on Windows and It works. Now Im just trying to compile it in Linux for my school homework."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559741540, "post_id": 56460984, "comment_id": 99514578, "body": "Do you use 64 bit(x86_64/amd64) or 32 bit libraries(i386)?"}, {"owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559742245, "post_id": 56460984, "comment_id": 99515067, "body": "@Yastanub Im using x86 libs. I see, but my Ubuntu is 64bit, is that the problem?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1559827754, "post_id": 56460984, "comment_id": 99547628, "body": "It only depends what architecture your built binary is using."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "edited": false, "score": 0, "creation_date": 1559753853, "post_id": 56462987, "comment_id": 99521381, "body": "I made those changes and the situation improved. Now the linker successfully linked most of the functions, but it still have a problem with -lSDL2test .. When I try to make, it says <code>&#47;usr&#47;bin&#47;ld: cannot find -lSDL2test</code> which is weird because it should be installed as well during <code>apt-get install libsdl2-2.0</code>"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "edited": false, "score": 0, "creation_date": 1559756144, "post_id": 56462987, "comment_id": 99522351, "body": "@Mig1-5 You need to install the <i>development</i> libraries, e.g. <code>apt-get install libsdl2-dev</code> (or whatever it is called). The one you installed doesn&#39;t provide the <i>unversioned</i> symlinks, so that <code>ld</code> doesn&#39;t find it."}, {"owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "edited": false, "score": 0, "creation_date": 1559757052, "post_id": 56462987, "comment_id": 99522672, "body": "I already have development library, it says I have newest version, do you think I should reinstall or something?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "edited": false, "score": 0, "creation_date": 1559846575, "post_id": 56462987, "comment_id": 99557009, "body": "@Mig1-5 Are you sure that <code>SDL2test</code> is a library, where does it come from?"}, {"owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "edited": false, "score": 0, "creation_date": 1559894159, "post_id": 56462987, "comment_id": 99569344, "body": "Recently, I found out that it is a support library for debugging and my program can run without it. I have done some changes to my makefile and it works. Thanks for your effort :]"}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1559746815, "last_edit_date": 1559746815, "creation_date": 1559746379, "answer_id": 56462987, "question_id": 56460984, "link": "https://stackoverflow.com/questions/56460984/im-having-trouble-linking-sdl-libraries/56462987#56462987", "title": "Im having trouble linking SDL libraries", "body": "<p>Change:</p>\n\n<pre><code>LIBS = -Llib/SDL2 -Llib/SDL2main -Llib/SDL2test -Llib/SDL2_ttf\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>LIBS = -Llib -lSDL2 -lSDL2main -lSDL2test -lSDL2_ttf\n</code></pre>\n\n<hr>\n\n<p>The compiler rules are not entirely correct because the source file directory is missing in the prerequisites (they only work because <code>SRC_DIR</code> is <code>.</code>). </p>\n\n<p>All those compiler rules can be replaced with one pattern rule:</p>\n\n<pre><code>%.o: $(SRC_DIR)/%.cpp\n    $(CXX) -o $@ -c $(CXXFLAGS) $(INC) $^\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11604065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062ca284b52405f24f96cfc2b2f86060?s=128&d=identicon&r=PG&f=1", "display_name": "Mig1-5", "link": "https://stackoverflow.com/users/11604065/mig1-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559746815, "creation_date": 1559739457, "last_edit_date": 1559739839, "question_id": 56460984, "link": "https://stackoverflow.com/questions/56460984/im-having-trouble-linking-sdl-libraries", "title": "Im having trouble linking SDL libraries", "body": "<p>I'm creating a makefile for my 2D sandbox game and when I compil the final executable file, the linker doesn't recognize all the SDL functions.</p>\n\n<p>./libs -> all SDL libraries (SDL2.lib, SDL2test.lib, SDL2_ttf.lib)\n./include -> all SDL classes and functions</p>\n\n<pre><code>#variables\nSRC_DIR = .\nLIBS = -Llib/SDL2 -Llib/SDL2main -Llib/SDL2test -Llib/SDL2_ttf\nINC = -Iinclude\nBIN = theGame\nCXX = g++\nCXXFLAGS = -pedantic -Wall\nRM = rm\n\n#make\ntheGame: main.o Block.o Character.o FileAccess.o GameObject.o Item.o Ladder.o NPC.o Player.o Window.o World.o\n    $(CXX) $(CXXFLAGS) -o $(BIN) main.o Block.o Character.o FileAccess.o GameObject.o Item.o Ladder.o NPC.o Player.o Window.o World.o $(LIBS)\n\nmain.o: main.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nBlock.o: Block.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nCharacter.o: Character.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nFileAccess.o: FileAccess.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nGameObject.o: GameObject.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nItem.o: Item.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nLadder.o: Ladder.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nNPC.o: NPC.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nPlayer.o: Player.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nWindow.o: Window.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\nWorld.o: World.cpp\n    $(CXX) -c $(CXXFLAGS) $(INC) $(SRC_DIR)/$^\n\n</code></pre>\n\n<blockquote>\n  <p>g++ -pedantic -Wall -o theGame main.o Block.o Character.o FileAccess.o\n  GameObject.o Item.o Ladder.o NPC.o Player.o Window.o World.o\n  -Llib/SDL2 -Llib/SDL2main -Llib/SDL2test -Llib/SDL2_ttf main.o: In function <code>pollMenuEvents(Window&amp;)': main.cpp:(.text+0x23): undefined\n  reference to</code>SDL_PollEvent' main.o: In function <code>pollEvents(Window&amp;,\n  std::vector&lt;Character*, std::allocator&lt;Character*&gt; &gt;&amp;, World*)':\n  main.cpp:(.text+0xae): undefined reference to</code>SDL_PollEvent' Block.o:\n  In function <code>Block::draw(int, int) const': Block.cpp:(.text+0xf4):\n  undefined reference to</code>SDL_SetRenderDrawColor'\n  Block.cpp:(.text+0x10b): undefined reference to <code>SDL_RenderFillRect'\n  Ladder.o: In function</code>Ladder::draw(int, int) const':\n  Ladder.cpp:(.text+0x19a): undefined reference to\n  <code>SDL_SetRenderDrawColor' Ladder.cpp:(.text+0x1b1): undefined reference\n  to</code>SDL_RenderFillRect' Ladder.cpp:(.text+0x22e): undefined reference\n  to <code>SDL_SetRenderDrawColor' Ladder.cpp:(.text+0x245): undefined\n  reference to</code>SDL_RenderFillRect' Ladder.cpp:(.text+0x2dd): undefined\n  reference to <code>SDL_SetRenderDrawColor' Ladder.cpp:(.text+0x2f4):\n  undefined reference to</code>SDL_RenderFillRect' NPC.o: In function\n  <code>NPC::draw(int, int) const': NPC.cpp:(.text+0xbd0): undefined\n  reference to</code>SDL_SetRenderDrawColor' NPC.cpp:(.text+0xbe7): undefined\n  reference to `SDL_RenderFillRect'</p>\n</blockquote>\n\n<p>.\n.\n.</p>\n"}, {"tags": ["c++", "base64", "bit-manipulation", "tobase64string"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1559738970, "post_id": 56460792, "comment_id": 99513071, "body": "Did you try stepping through your code with a debugger, to see, what is the value, that is out of range?"}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559739112, "post_id": 56460792, "comment_id": 99513154, "body": "Are you talking about bits or bytes?"}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1559739134, "post_id": 56460792, "comment_id": 99513168, "body": "<code>using namespace std;</code> doesn&#39;t even save your <code>EncodeBlock</code> function a single byte. <a href=\"https://stackoverflow.com/q/1452721\">Why are you doing that?</a>"}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "reply_to_user": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559739227, "post_id": 56460792, "comment_id": 99513227, "body": "@Bart Isn&#39;t in[0] or in[1] 8 bits? that is 1 byte!"}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1559739249, "post_id": 56460792, "comment_id": 99513244, "body": "@L.F. that is redundant. please ignore"}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "edited": false, "score": 0, "creation_date": 1559739419, "post_id": 56460792, "comment_id": 99513353, "body": "@RC0993 it is, I now understand you are trying to shift the index based on the in vector."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559739523, "post_id": 56460792, "comment_id": 99513414, "body": "You should use a stream of unsigned char to avoid sign duplication in the right shift."}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "edited": false, "score": 0, "creation_date": 1559739659, "post_id": 56460792, "comment_id": 99513502, "body": "@AlainMerigotDo you mean <code>vector&lt;unsigned char&gt; in(3)</code> ?"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559739785, "post_id": 56460792, "comment_id": 99513577, "body": "Yes. Or cast to unsigned what you read before right shifting."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1559740631, "post_id": 56460792, "comment_id": 99514069, "body": "Remember that everything is implicitly converted to <code>int</code> or <code>unsigned int</code> (depending on the signedness of <code>char</code>) before shifting. <code>(255 &lt;&lt; 6) &gt;&gt; 2</code> is 4080; <code>(-1 &lt;&lt; 6) &gt;&gt; 2</code> is -16."}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1559740798, "post_id": 56460792, "comment_id": 99514146, "body": "@molbdnilo I am realising now that <code>(255 &lt;&lt; 6) &gt;&gt; 2 is 4080</code> is indeed happening, but I am not sure how to make it <code>(255 &lt;&lt; 6) &gt;&gt; 2 = 63</code>"}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "edited": false, "score": 0, "creation_date": 1559741334, "post_id": 56460792, "comment_id": 99514444, "body": "Just mask with 0x3f before using as an index."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1559741429, "post_id": 56460792, "comment_id": 99514505, "body": "Read about how to mask out specific bits in your favourite bit-manipulation literature."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1559741631, "post_id": 56460792, "comment_id": 99514635, "body": "For a good book on bit-twiddling, Hacker&#39;s Delight by Henry S. Warren, Jr. is a treasure trove."}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "edited": false, "score": 0, "creation_date": 1559741855, "post_id": 56460792, "comment_id": 99514814, "body": "Hey Thanks, Everyone for your inputs. the bit manipulation worked. Finally I had masked it like this <code>out[0] = cb64[(unsigned int) ((in[0] &gt;&gt; 2) &amp; 0x003f)];</code>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1559742668, "post_id": 56460792, "comment_id": 99515329, "body": "Are you still having issues <i>continuously reading</i> from the file? (per your question title)"}, {"owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "edited": false, "score": 0, "creation_date": 1559742707, "post_id": 56460792, "comment_id": 99515364, "body": "No...! It is now resolved"}], "answers": [{"tags": [], "owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "is_accepted": true, "score": 1, "last_activity_date": 1559800493, "creation_date": 1559800493, "answer_id": 56471596, "question_id": 56460792, "link": "https://stackoverflow.com/questions/56460792/how-to-read-n-bytes-from-a-file-continuously-untill-the-eof/56471596#56471596", "title": "How to read N bytes from a file continuously untill the EOF", "body": "<p>The resolution to this was to handle the bit manipulation correctly.</p>\n\n<p>the <code>char</code> 8 bits are operated and then casted to <code>unsigned int</code> introduces 24 bits extra into it which needed to be set to <code>0</code>.</p>\n\n<p>So,\n<code>out[0] = cb64[(unsigned int) ((in[0] &gt;&gt; 2) &amp; 0x003f)];</code><br>\n<code>out[1] = cb64[(unsigned int) ((((in[0] &lt;&lt; 6) &gt;&gt; 2) | (in[1] &gt;&gt; 4))) &amp; 0x003f)];</code> .. and so on handles the masking</p>\n"}], "owner": {"reputation": 790, "user_id": 10862144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPt16.png?s=128&g=1", "display_name": "RC0993", "link": "https://stackoverflow.com/users/10862144/rc0993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56471596, "answer_count": 1, "score": 0, "last_activity_date": 1559800493, "creation_date": 1559738847, "question_id": 56460792, "link": "https://stackoverflow.com/questions/56460792/how-to-read-n-bytes-from-a-file-continuously-untill-the-eof", "title": "How to read N bytes from a file continuously untill the EOF", "body": "<p>I am trying a wave to base 64 converter program.</p>\n\n<p>I am trying this following code snippet: </p>\n\n<pre><code>    vector&lt;char&gt; in(3);\n    std::string out = \"abcd\";         //four letter garbage value as initializer\n    ifstream file_ptr(filename.c_str(), ios::in | ios::binary);\n\n    unsigned int threebytes = 0;\n    //Apply the Base 64 encoding algorithm\n    do {\n        threebytes = (unsigned int) file_ptr.rdbuf()-&gt;sgetn(&amp;in[0], 3);\n        if (threebytes &gt; 0) {\n            EncodeBlock(in, out, (int)threebytes);  //Apply conversion algorithm to convert 3 bytes into 4\n            outbuff = outbuff + out;                //Append the 4 bytes got from above step to the output\n        }\n    } while (threebytes == in.size());\n\n    file_ptr.close();\n</code></pre>\n\n<p>In encode block where the Base64 encoding algorithm is written</p>\n\n<pre><code>void EncodeBlock(const std::vector&lt;char&gt;&amp; in, std::string&amp; out, int len) {\n    using namespace std;\n    cb64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n    out[0] = cb64[(int) (in[0] &gt;&gt; 2)];\n    out[1] = cb64[(int) (((in[0] &lt;&lt; 6) &gt;&gt; 2) | (in[1] &gt;&gt; 4))];\n    out[2] = (len &gt; 1) ?\n             cb64[(int) (((in[1] &lt;&lt; 4) &gt;&gt; 2) | (in[2] &gt;&gt; 6))] :\n             '=';\n    out[3] = (len &gt; 2) ?\n             cb64[(int) ((in[2] &lt;&lt; 2) &gt;&gt; 2)] :\n             '=';\n\n}\n</code></pre>\n\n<p>The <code>cb64</code> is a 64 length long string but the index generated by bit manipulation sometimes fall out of range (0 to 63).</p>\n\n<p><strong><em>Why!!!</em></strong></p>\n"}, {"tags": ["c++", "c++11", "language-lawyer", "default-constructor", "ctor-initializer"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 5, "creation_date": 1559738281, "post_id": 56460611, "comment_id": 99512666, "body": "As soon as you&#39;ve defined initialisers in the ctor you&#39;ve provided a ctor and it&#39;s no longer the default."}, {"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "edited": false, "score": 2, "creation_date": 1559738316, "post_id": 56460611, "comment_id": 99512688, "body": "Because &quot;Default ctor with member initializer list&quot; is not a default ctor. You can use inline initialization with &quot;=default&quot; though."}, {"owner": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 0, "creation_date": 1559738381, "post_id": 56460611, "comment_id": 99512725, "body": "<code>{}</code> is shorter than <code>=default</code> anyway."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "reply_to_user": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1559738441, "post_id": 56460611, "comment_id": 99512766, "body": "@Quimby that&#39;s not an argument, since this is always the case. Also that&#39;s not the reason for <code>=default</code>, see also the referenced C++ FAQ"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1559738537, "post_id": 56460611, "comment_id": 99512821, "body": "So what happens if you do this in a copy constructor? Would it initialize the member to the value you specified, or copy it (the default behavior)?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1559738579, "post_id": 56460611, "comment_id": 99512843, "body": "Could you explain what you would expect it to mean?"}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 8101, "user_id": 7691729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2568514188dfa24ecc3c1884e481834?s=128&d=identicon&r=PG&f=1", "display_name": "Quimby", "link": "https://stackoverflow.com/users/7691729/quimby"}, "edited": false, "score": 1, "creation_date": 1559738630, "post_id": 56460611, "comment_id": 99512869, "body": "@Quimby, <code>{}</code> and <code>= default;</code> are different in general."}, {"owner": {"reputation": 6009, "user_id": 642681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ac392dc9da2b8185ca0bdfb3c8b7501d?s=128&d=identicon&r=PG&f=1", "display_name": "unexpectedvalue", "link": "https://stackoverflow.com/users/642681/unexpectedvalue"}, "edited": false, "score": 2, "creation_date": 1559738740, "post_id": 56460611, "comment_id": 99512930, "body": "Indeed, <code>{}</code> and <code>=default</code> accomplish different things. <code>{}</code> is generally not what you want as it kills implicitly generated default move constructor/operator."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1559742219, "post_id": 56460611, "comment_id": 99515049, "body": "@JonathanPotter: <a href=\"https://en.cppreference.com/w/cpp/language/default_constructor\" rel=\"nofollow noreferrer\">I don&#39;t agree</a>: <i>&quot;A default constructor is a constructor which can be called with no arguments (either defined with an empty parameter list, or with default arguments provided for every parameter).&quot;</i> (unless you&#39;re talking about <i>defaulted</i> default ctors)"}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1559757732, "post_id": 56460611, "comment_id": 99522910, "body": "@andreee two different meanings of the word &quot;default&quot; :)"}], "answers": [{"comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1559740715, "post_id": 56460735, "comment_id": 99514115, "body": "Thanks, but as mentioned in my question, this is not what I was interested in."}, {"owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1559740748, "post_id": 56460735, "comment_id": 99514131, "body": "You mean, as you mentioned in an edit to your question after this answer had been posted?"}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1559740829, "post_id": 56460735, "comment_id": 99514169, "body": "Yes. But I also mentioned in-class initializers in my original post and that it doesn&#39;t pose a problem there (second last paragraph). That was just a remark, no offense :-)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559741826, "post_id": 56460735, "comment_id": 99514783, "body": "a default constructor is by definition one that can be called with no arguments. see here <a href=\"https://en.cppreference.com/w/cpp/language/default_constructor\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/default_constructor</a>"}], "tags": [], "owner": {"reputation": 1717, "user_id": 8690361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3678a10e6bc70a207a4a458c76b04c08?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8690361/steve"}, "is_accepted": false, "score": 2, "last_activity_date": 1559738634, "creation_date": 1559738634, "answer_id": 56460735, "question_id": 56460611, "link": "https://stackoverflow.com/questions/56460611/why-cant-i-use-default-for-default-ctors-with-a-member-initializer-list/56460735#56460735", "title": "Why can&#39;t I use =default for default ctors with a member initializer list", "body": "<p>It's disallowed because what you're trying to do by definition means it's no longer a default constructor. And there's a more elegant way of accomplishing what you want anyway:</p>\n\n<pre><code>class Foo {\n  int a {1};\n  int b {2};\npublic:\n  Foo() = default;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1559738886, "post_id": 56460739, "comment_id": 99513010, "body": "Regarding your last paragraph: What about in-class member initializers then? defining <code>int a = 1; int b = 2</code> in the class and using <code>Foo() = default;</code> works just fine. Wouldn&#39;t that be a contradiction?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 4, "creation_date": 1559738933, "post_id": 56460739, "comment_id": 99513044, "body": "@andreee - No. Because if you omit <code>Foo() = default</code>, the default member initializers are still in effect. That <i>is</i> what the compiler provided constructor will do."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1559740597, "post_id": 56460739, "comment_id": 99514053, "body": "Thanks, that makes sense now. I also liked <a href=\"https://stackoverflow.com/a/56460859/1753435\">@NathanOliver&#39;s answer</a> a lot, but I like this one slightly better (and you cannot accept two questions :-))."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 11, "last_activity_date": 1559739050, "last_edit_date": 1559739050, "creation_date": 1559738638, "answer_id": 56460739, "question_id": 56460611, "link": "https://stackoverflow.com/questions/56460611/why-cant-i-use-default-for-default-ctors-with-a-member-initializer-list/56460739#56460739", "title": "Why can&#39;t I use =default for default ctors with a member initializer list", "body": "<p><code>= default;</code> is an entire definition all on its own. It's enforced, first and foremost, grammatically:</p>\n\n<blockquote>\n  <p><strong>[dcl.fct.def.general]</strong></p>\n  \n  <p><a href=\"https://timsong-cpp.github.io/cppwp/n3337/dcl.fct.def.general#1\" rel=\"noreferrer\">1</a> Function definitions have the form</p>\n\n<pre>function-definition:\n    attribute-specifier-seq<sub>opt</sub> decl-specifier-seq<sub>opt</sub> declarator virt-specifier-seq<sub>opt</sub> function-body\n\nfunction-body:\n    ctor-initializer<sub>opt</sub> compound-statement\n    function-try-block\n    = default ;\n    = delete ; </pre>\n</blockquote>\n\n<p>So it's either a member initializer list with a compound statement, or just plain <code>= default;</code>, no mishmash.</p>\n\n<p>Furthermore, <code>= default</code> means something specific about how each member is initialized. It means <em>we explicitly</em> want to initialize everything like a compiler provided constructor would. That is in contradiction to \"doing something special\" with the members in the constructor's member initializer list. </p>\n"}, {"comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1559740686, "post_id": 56460741, "comment_id": 99514101, "body": "Thanks, but as mentioned in my question, this is not what I was interested in."}], "tags": [], "owner": {"reputation": 6009, "user_id": 642681, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ac392dc9da2b8185ca0bdfb3c8b7501d?s=128&d=identicon&r=PG&f=1", "display_name": "unexpectedvalue", "link": "https://stackoverflow.com/users/642681/unexpectedvalue"}, "is_accepted": false, "score": 3, "last_activity_date": 1559740168, "last_edit_date": 1559740168, "creation_date": 1559738643, "answer_id": 56460741, "question_id": 56460611, "link": "https://stackoverflow.com/questions/56460611/why-cant-i-use-default-for-default-ctors-with-a-member-initializer-list/56460741#56460741", "title": "Why can&#39;t I use =default for default ctors with a member initializer list", "body": "<p>This doesn't directly answer the question, however it is the c++ \"way\" is to use the <a href=\"https://en.cppreference.com/w/cpp/language/data_members\" rel=\"nofollow noreferrer\">default member initializer</a> instead, that it</p>\n\n<pre><code>class Foo {\n  int a = 1, b = 2;\npublic:\n  Foo() = default; \n};\n</code></pre>\n\n<p>The syntax you purpose is simply not a default, per se, constructor anymore.</p>\n"}, {"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 7, "last_activity_date": 1559759952, "last_edit_date": 1559759952, "creation_date": 1559739075, "answer_id": 56460859, "question_id": 56460611, "link": "https://stackoverflow.com/questions/56460611/why-cant-i-use-default-for-default-ctors-with-a-member-initializer-list/56460859#56460859", "title": "Why can&#39;t I use =default for default ctors with a member initializer list", "body": "<p>Doing <code>a{1}, b{2}</code> means you no longer can specify it as <code>default</code>.  A default function per <a href=\"https://timsong-cpp.github.io/cppwp/dcl.fct.def#default-1\" rel=\"nofollow noreferrer\">[dcl.fct.def.default]/1</a> is defined as</p>\n\n<blockquote>\n  <p>A function definition whose <em>function-body</em> is of the form <code>= default;</code> is called an <em>explicitly-defaulted</em> definition.</p>\n</blockquote>\n\n<p>And if we check what a <em>function-body</em> is in <a href=\"https://timsong-cpp.github.io/cppwp/dcl.fct.def#general-1\" rel=\"nofollow noreferrer\">[dcl.fct.def.general]/1</a> we see that it contains a <a href=\"https://timsong-cpp.github.io/cppwp/class.base.init#nt:ctor-initializer\" rel=\"nofollow noreferrer\"><em>ctor-initializer</em></a> which is a <a href=\"https://timsong-cpp.github.io/cppwp/class.base.init#nt:mem-initializer-list\" rel=\"nofollow noreferrer\"><em>mem-initializer-list</em></a></p>\n\n<p>This means you can't initialize members if you want a default definition provided by the compiler.</p>\n\n<p>What you can do to work around this is to specify the default values in the class directly, and then declare the constructor as default like</p>\n\n<pre><code>class Foo {\n  int a{1}, b{2};\npublic:\n  Foo() = default;\n\n};\n</code></pre>\n"}], "owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 56460739, "answer_count": 4, "score": 8, "last_activity_date": 1559759952, "creation_date": 1559738153, "last_edit_date": 1559739273, "question_id": 56460611, "link": "https://stackoverflow.com/questions/56460611/why-cant-i-use-default-for-default-ctors-with-a-member-initializer-list", "title": "Why can&#39;t I use =default for default ctors with a member initializer list", "body": "<p>Consider the following class:</p>\n\n<pre><code>class Foo {\n  int a, b;\npublic:\n  Foo() : a{1}, b{2} {} // Default ctor with member initializer list\n  //Foo() : a{1}, b{2} = default; // Does not work but why?\n};\n</code></pre>\n\n<p><em>(<strong>Edit</strong>: because it was mentioned in a couple of answers - I'm aware of in-class member initializiers, but that's not the point here)</em></p>\n\n<p>I think the second ctor definition would be more elegant and fit better into modern C++ code (see also <a href=\"https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rc-eqdefault\" rel=\"noreferrer\">why you should use <code>=default</code> if you have to be explicit about using the default semantics</a>). However, no common compiler seems to accept it. And cppreference is silent about it.</p>\n\n<p>My first thought was that a member initializer list in a way changes the \"default semantics\" as explained in the linked FAQ, because it may or may not default-construct members. But then we would have the same problem for in-class initializers, just that here <code>Foo() = default;</code> works just fine. </p>\n\n<p>So, why is it disallowed?</p>\n"}, {"tags": ["c++", "performance"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559737852, "post_id": 56460536, "comment_id": 99512428, "body": "<i>&quot;with the function below.&quot;</i>. it is missing."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 7, "creation_date": 1559737886, "post_id": 56460536, "comment_id": 99512444, "body": "We need the code AND the compilation flags to provide any reasonable answer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1559737960, "post_id": 56460536, "comment_id": 99512482, "body": "Did you compile both code with optimizations turned on?  Is the older GCC using an older standard library version?  FWIW, you should really upgrade.  GCC is on version 9 now and 4.4.6 only has experimental support for C++11 which you should really be using."}, {"owner": {"reputation": 1778, "user_id": 9063139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bze7O.png?s=128&g=1", "display_name": "Martin Morterol", "link": "https://stackoverflow.com/users/9063139/martin-morterol"}, "edited": false, "score": 0, "creation_date": 1559738052, "post_id": 56460536, "comment_id": 99512530, "body": "gcc 3.2.3 probably don&#39;t have the move semantic, BTW godbolt and wandbox don&#39;t have gcc3.2 support, too old :$"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1778, "user_id": 9063139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bze7O.png?s=128&g=1", "display_name": "Martin Morterol", "link": "https://stackoverflow.com/users/9063139/martin-morterol"}, "edited": false, "score": 0, "creation_date": 1559738089, "post_id": 56460536, "comment_id": 99512550, "body": "@MartinMorterol Nothing is being moved here."}, {"owner": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1559738244, "post_id": 56460536, "comment_id": 99512641, "body": "@NathanOliver yes both with optimizations turned on. I know I should use a newer compiler I&#39;m just curious what&#39;s the cause for this huge difference"}, {"owner": {"reputation": 1313, "user_id": 8258222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6746f3861d2831ea6a33e1e12cbd78d0?s=128&d=identicon&r=PG&f=1", "display_name": "helospark", "link": "https://stackoverflow.com/users/8258222/helospark"}, "edited": false, "score": 0, "creation_date": 1559738915, "post_id": 56460536, "comment_id": 99513031, "body": "Are you using <code>file_data</code> after calling the method? Maybe the newer gcc realizes that it is a dead code (if result is not used) and optimized the whole thing out?"}, {"owner": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "reply_to_user": {"reputation": 1313, "user_id": 8258222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6746f3861d2831ea6a33e1e12cbd78d0?s=128&d=identicon&r=PG&f=1", "display_name": "helospark", "link": "https://stackoverflow.com/users/8258222/helospark"}, "edited": false, "score": 0, "creation_date": 1559739221, "post_id": 56460536, "comment_id": 99513224, "body": "@helospark it&#39;s not the case it actually reads the file in both"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 1, "creation_date": 1559739963, "post_id": 56460536, "comment_id": 99513692, "body": "Its a pity that compiler explorer do not support such <a href=\"https://godbolt.org/z/p45POQ\" rel=\"nofollow noreferrer\">old version of gcc</a>. Anyway it looks like that problem is hidden somewhere deeper in library."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1559743105, "post_id": 56460536, "comment_id": 99515603, "body": "Since you are using <code>std::string</code>, you should <code>reserve</code> space (since you know the size).  The <code>reserve</code> will reduce the number of times the string memory is reallocated (which is causing a lot of your slowdown)."}, {"owner": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "edited": false, "score": 0, "creation_date": 1559746858, "post_id": 56460536, "comment_id": 99517778, "body": "I actually used reserve initially but I saw no performance difference and read online that assign ignores reserve (can&#39;t find the source atm) so dropped it. Do you think my source was wrong and reserve is still needed here?"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "edited": false, "score": 0, "creation_date": 1559740648, "post_id": 56460627, "comment_id": 99514078, "body": "Your second suggestion is fast. I used  ostringstream contents; contents &lt;&lt; ifs.rdbuf(); file_data = contents.str(); to overcome the slowness but still wonder how come there is such a huge difference when using istreambuf_iterator"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "edited": false, "score": 0, "creation_date": 1559744039, "post_id": 56460627, "comment_id": 99516130, "body": "I&#39;m suspecting that iterator version resizes string as data are growing. Now if capacity of string is to small then reallocation is needed (copy data). Now depending on strategy when and how much capacity of <code>std::string</code> should be changed, there might be a huge perforce difference. For example if (this is assumption) old library changes string capacity by constant amount and new library version scales capacity by some factor, performance difference for 70MB can be so big. Forcing allocating large amount of memory once prevents coping memory leading to large performance gain."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "edited": false, "score": 0, "creation_date": 1559744279, "post_id": 56460627, "comment_id": 99516260, "body": "Now in first attempt <code>assign</code> method might discard initial capacity and that is why it didn&#39;t help. All this should be verified - somewhere I have some code where I&#39;m feeding <code>std::base_string</code> with custom allocator which logs how <code>std::base_string</code> manages a memory."}], "tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1559740232, "last_edit_date": 1559740232, "creation_date": 1559738219, "answer_id": 56460627, "question_id": 56460536, "link": "https://stackoverflow.com/questions/56460536/same-code-huge-performance-difference-in-different-gcc-compilers/56460627#56460627", "title": "Same code huge performance difference in different gcc compilers", "body": "<p>Could you try tweak a bit this code (one extra line):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool ReadFile(const string&amp; path, string&amp; file_data)\n{\n    ifstream ifs(path.c_str(), ifstream::in | ifstream::ate);\n    if (!ifs) return false;\n    int size = ifs.tellg();\n    if (size==0) return false;\n    ifs.seekg(0, ios::beg);\n\n    file_data.reserve(size);\n    file_data.assign((istreambuf_iterator&lt;char&gt;(ifs)),\n       istreambuf_iterator&lt;char&gt;());\n\n    return true;\n}\n</code></pre>\n\n<p>and do measurement again<br>\nIn second attempt you can try this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool ReadFile(const string&amp; path, string&amp; file_data)\n{\n    ifstream ifs(path.c_str(), ifstream::in | ifstream::ate);\n    if (!ifs) return false;\n    int size = ifs.tellg();\n    if (size==0) return false;\n    ifs.seekg(0, ios::beg);\n\n    file_data.resize(size);\n    return ifs.read(&amp;file_data[0], size);\n}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 8364972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9890e08b8c017ec1e21eb44baabd95?s=128&d=identicon&r=PG&f=1", "display_name": "Musmus", "link": "https://stackoverflow.com/users/8364972/musmus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1559740232, "creation_date": 1559737780, "last_edit_date": 1559737935, "question_id": 56460536, "link": "https://stackoverflow.com/questions/56460536/same-code-huge-performance-difference-in-different-gcc-compilers", "title": "Same code huge performance difference in different gcc compilers", "body": "<p>Trying to understand the cause of the performance difference.\nI'm reading a ~70M file with the function below.\nRunning the code with:\ngcc 4.4.6 takes less than a second\ngcc 3.2.3  takes more than 6 minutes</p>\n\n<p>Most of the time is spend in the assign part.\nWhat was changed to make this speed difference between the 2 compilers ?</p>\n\n<pre><code>bool ReadFile(const string&amp; path, string&amp; file_data)\n{\n    ifstream ifs(path.c_str(), ifstream::in | ifstream::ate);\n    if (!ifs) return false;\n    int size = ifs.tellg();\n    if (size==0) return false;\n    ifs.seekg(0, ios::beg);\n    file_data.assign((istreambuf_iterator&lt;char&gt;(ifs)),\n       istreambuf_iterator&lt;char&gt;());\n\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c++", "arduino", "embedded"], "comments": [{"owner": {"reputation": 284, "user_id": 11562467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLZx.png?s=128&g=1", "display_name": "rjg", "link": "https://stackoverflow.com/users/11562467/rjg"}, "edited": false, "score": 3, "creation_date": 1559737885, "post_id": 56460523, "comment_id": 99512442, "body": "Why don&#39;t you pass it as an argument to the function? A library should have a clear interface and not depend on some global state created by macros."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1559737889, "post_id": 56460523, "comment_id": 99512445, "body": "You can use compile flags (like <code>-DUSER_DEF=5</code>, if you really want to do it that way. This assumes that by library you mean source files that are distributed and meant to be compiled in (Arduino-style) as opposed to a compiled object or archive meant to be linked into the program, with header files used to interface with it."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1559738010, "post_id": 56460523, "comment_id": 99512506, "body": "@ryyker That&#39;s a very platform-specific way of doing things, and doesn&#39;t work in say, an embedded environment."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1559738429, "post_id": 56460523, "comment_id": 99512758, "body": "C or C++? They have very different answers to the question &quot;how to declare a variable-sized array&quot;. Except in both languages you can of course use dynamic allocation as an option."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1559738507, "post_id": 56460523, "comment_id": 99512805, "body": "You can pass macro definitions on the command line, e.g. <code>-DNAME=value</code>.  People sometimes do this to control debugging for instance."}, {"owner": {"reputation": 167, "user_id": 5736354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4075b5fc167c126d70fc9b8b17683827?s=128&d=identicon&r=PG&f=1", "display_name": "ardayigit", "link": "https://stackoverflow.com/users/5736354/ardayigit"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1559738599, "post_id": 56460523, "comment_id": 99512849, "body": "@Lundin Arduino environment uses C++, but I want a code that can be used later in other microcontrollers, that may or not have C++ compilers (e.g. PIC)."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5736354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4075b5fc167c126d70fc9b8b17683827?s=128&d=identicon&r=PG&f=1", "display_name": "ardayigit", "link": "https://stackoverflow.com/users/5736354/ardayigit"}, "edited": false, "score": 0, "creation_date": 1559738739, "post_id": 56460642, "comment_id": 99512928, "body": "I want my code to be compatible with C. Thus, the array size must be defined at compile time (except if I use dynamic memory allocation)."}, {"owner": {"reputation": 428, "user_id": 5165289, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PF51Jtn1524/AAAAAAAAAAI/AAAAAAAAABM/8D6JrCYReME/photo.jpg?sz=128", "display_name": "Stf Kolev", "link": "https://stackoverflow.com/users/5165289/stf-kolev"}, "reply_to_user": {"reputation": 167, "user_id": 5736354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4075b5fc167c126d70fc9b8b17683827?s=128&d=identicon&r=PG&f=1", "display_name": "ardayigit", "link": "https://stackoverflow.com/users/5736354/ardayigit"}, "edited": false, "score": 1, "creation_date": 1559739086, "post_id": 56460642, "comment_id": 99513138, "body": "Well, judging by the answer above, I&#39;d suggest using dynamic memory allocation, since it will suit you best, or you can go for the <code>gcc -D USER_DEF=5 main.cc</code>. If you choose to go for the <code>D</code> flag, better protect it with something like <code>#ifndef USER_DEF #define USER_DEF 0 #endif</code>"}, {"owner": {"reputation": 832, "user_id": 10397400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp5mk.png?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/10397400/bart"}, "reply_to_user": {"reputation": 167, "user_id": 5736354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4075b5fc167c126d70fc9b8b17683827?s=128&d=identicon&r=PG&f=1", "display_name": "ardayigit", "link": "https://stackoverflow.com/users/5736354/ardayigit"}, "edited": false, "score": 0, "creation_date": 1559740099, "post_id": 56460642, "comment_id": 99513770, "body": "@ardayigit When sticking to C++ checkout std::array"}], "tags": [], "owner": {"reputation": 428, "user_id": 5165289, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PF51Jtn1524/AAAAAAAAAAI/AAAAAAAAABM/8D6JrCYReME/photo.jpg?sz=128", "display_name": "Stf Kolev", "link": "https://stackoverflow.com/users/5165289/stf-kolev"}, "is_accepted": false, "score": 1, "last_activity_date": 1559738281, "creation_date": 1559738281, "answer_id": 56460642, "question_id": 56460523, "link": "https://stackoverflow.com/questions/56460523/how-to-code-a-library-with-a-user-defined-parameter-in-c-c/56460642#56460642", "title": "How to code a library with a user defined parameter in C/C++?", "body": "<p>I'd usually go and suggest to check out the <a href=\"https://www.geeksforgeeks.org/templates-cpp/\" rel=\"nofollow noreferrer\">templates</a>, although, you can create user-defined variables, they are called function parameters. <a href=\"https://www.tutorialspoint.com/cplusplus/cpp_functions.htm\" rel=\"nofollow noreferrer\">Please take a look</a>\nTo sum it up, this is not what you call user-defined variable, because this is defined by the programmer, not by the user of the program. This is called a constant, whatsoever. If you want to create a compile-time constant, defined by you, you can take a look at <a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\">constexpr</a>.</p>\n\n<p>Also, let me explain to you why this doesn't work correctly. You guessed correctly, it's because it is not defined into the header file, but why? Because headers come first and then comes the main file. The header searches for the defined constant and fails to find it, and that is the reason why you get the <code>USER_DEF not declared in this scope</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1559738766, "creation_date": 1559738766, "answer_id": 56460769, "question_id": 56460523, "link": "https://stackoverflow.com/questions/56460523/how-to-code-a-library-with-a-user-defined-parameter-in-c-c/56460769#56460769", "title": "How to code a library with a user defined parameter in C/C++?", "body": "<p>The answer is that it doesn't make sense to use variable-sized arrays for a very restricted 8-bit system with very limited RAM. </p>\n\n<p>Instead you should have a fixed size array of <em>n</em> bytes. Let the user pick a number, then ensure that it is less or equal to <em>n</em>. Then keep track of the used size with a plain integer variable. You must always reserve memory for the worst case.</p>\n\n<p>The array must have static storage duration, since it will be too large to be allocated on the stack.</p>\n"}], "owner": {"reputation": 167, "user_id": 5736354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4075b5fc167c126d70fc9b8b17683827?s=128&d=identicon&r=PG&f=1", "display_name": "ardayigit", "link": "https://stackoverflow.com/users/5736354/ardayigit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559738766, "creation_date": 1559737741, "last_edit_date": 1559738480, "question_id": 56460523, "link": "https://stackoverflow.com/questions/56460523/how-to-code-a-library-with-a-user-defined-parameter-in-c-c", "title": "How to code a library with a user defined parameter in C/C++?", "body": "<p>Is it possible to code a library with a parameter that will be defined by the user at compile time without modifying the library? </p>\n\n<p>Library: </p>\n\n<p>test.h</p>\n\n<pre><code>#ifndef TEST_H\n#define TEST_H\n\n#define MAX_NB USER_DEF\n\nvoid myFunc(); \n\n#endif\n</code></pre>\n\n<p>test.cpp</p>\n\n<pre><code>#include \"test.h\"\n\nint arr[MAX_NB] = {0}; \n\nvoid myFunc() {\n\n    for (int i = 0: i &lt; MAX_NB; i++ ) {\n        // DO SOMETHING\n    }\n\n}\n</code></pre>\n\n<p>And the main code: </p>\n\n<pre><code>#define USER_DEF 5\n#include \"test.h\"\n\nvoid main() {\n\n    while (1) {\n        myFunc(); \n    }\n\n}\n</code></pre>\n\n<p>I suppose I am getting an error (USER_DEF not declared in this scope) because <code>USER_DEF</code> is not defined in the translation unit containing test.h and test.c, but I hope there is a way to do it, but I can't find it. </p>\n\n<p>My goal is to have an array with a user-defined size (code modified). </p>\n"}, {"tags": ["c++", "qt", "scale", "qgraphicsview", "qgraphicsscene"], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 11092567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c68ea55ffcdd5622ddb3c4f62350b58?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/11092567/george"}, "edited": false, "score": 0, "creation_date": 1559740357, "post_id": 56461066, "comment_id": 99513921, "body": "Thanks for the code you&#39;ve provided. Would you be so kind to explain the point of creating a new class?"}, {"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "reply_to_user": {"reputation": 432, "user_id": 11092567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c68ea55ffcdd5622ddb3c4f62350b58?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/11092567/george"}, "edited": false, "score": 0, "creation_date": 1559740445, "post_id": 56461066, "comment_id": 99513967, "body": "That&#39;s what I did in my example: I create a class <code>GraphicsScene</code> which inherits from <code>QGraphicsScene</code>"}], "tags": [], "owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "is_accepted": true, "score": 1, "last_activity_date": 1559739735, "creation_date": 1559739735, "answer_id": 56461066, "question_id": 56460462, "link": "https://stackoverflow.com/questions/56460462/is-there-qlabelsetscaledcontents-equivalent-function-for-qgraphicsscene-in-qt/56461066#56461066", "title": "Is there QLabel::setScaledContents equivalent function for QGraphicsScene in Qt?", "body": "<p>You just have to resize the scene when you insert your pixmap based on its size.</p>\n\n<p>If you define a new class inheriting from <code>QGraphicsScene</code>, you can handle it easily:</p>\n\n<pre><code>class GraphicsScene: public QGraphicsScene\n{\npublic:\n    GraphicsScene(QRect const&amp; rect, QObject* parent=nullptr): QGraphicsScene(rect, parent),\n        background(nullptr)\n    {}\n\n    QGraphicsPixmapItem *addPixmap(const QPixmap &amp;pixmap)\n    {\n        // We already have a background. Remove it\n        if (background)\n        {\n            removeItem(background);\n            delete background;\n        }\n        background = QGraphicsScene::addPixmap(pixmap);\n        // Move the pixmap\n        background-&gt;setPos(0, 0);\n        // Change the scene rect based on the size of the pixmap\n        setSceneRect(background-&gt;boundingRect());\n        return background;\n    }\nprivate:\n    QGraphicsPixmapItem* background;\n};\n</code></pre>\n\n<pre><code>    GraphicsScene* scene = new GraphicsScene(QRect());\n    QGraphicsView* view = new QGraphicsView();\n    view-&gt;setScene(scene);\n    view-&gt;show();\n\n    QPixmap pix1(QSize(2000, 2000));\n    pix1.fill(Qt::red);\n\n\n    QPixmap pix2(QSize(100, 300));\n    pix2.fill(Qt::green);\n\n    // The scene will be 2000x2000\n    QTimer::singleShot(1000, [=]() { scene-&gt;addPixmap(pix1); });\n    // The scene will be 100x300\n    QTimer::singleShot(10000, [=]() { scene-&gt;addPixmap(pix2); });\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 11092567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c68ea55ffcdd5622ddb3c4f62350b58?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/11092567/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56461066, "answer_count": 1, "score": 1, "last_activity_date": 1559739735, "creation_date": 1559737497, "last_edit_date": 1559738932, "question_id": 56460462, "link": "https://stackoverflow.com/questions/56460462/is-there-qlabelsetscaledcontents-equivalent-function-for-qgraphicsscene-in-qt", "title": "Is there QLabel::setScaledContents equivalent function for QGraphicsScene in Qt?", "body": "<p>I'm using QGraphicsView and QGraphicsScene to display an uploaded image and then show some drawing on it. I'm uploading and image like so:</p>\n\n<pre><code>void MeasuresWidget::on_openAction_triggered()\n{\n    QString fileName = QFileDialog::getOpenFileName(this,tr(\"Open File\"), QDir::currentPath());\n    if (!fileName.isEmpty())\n    {\n        QImage image(fileName);\n        if (image.isNull())\n        {\n            QMessageBox::information(this, tr(\"Measures Application\"), tr(\"Cannot load %1.\").arg(fileName));\n            return;\n        }\n        scene-&gt;clear();\n        scene-&gt;addPixmap(QPixmap::fromImage(image).scaledToWidth(w, Qt::SmoothTransformation));\n    }\n}\n</code></pre>\n\n<p>The problem i'm facing is that if i upload an image that is smaller than the one that was uploaded before, there appears to be empty space, i.e. scene maintains the size of previous image(the bigger one) and is bigger than current one. I tried maintaining original size of scene in individual variable and using <code>setSceneRect()</code> in each upload action:</p>\n\n<pre><code>//in constructor\n    originalRect = ui-&gt;graphicsView-&gt;rect();\n//in upload action\n    scene-&gt;setSceneRect(originalRect);\n</code></pre>\n\n<p>but result is that size of scene always stays the same and, if it's bigger than the actual image, cuts it. I used QLabel to display an image before and i used <code>QLabel::setScaledContents()</code> function and it worked fine for me. So, my question is can i achieve the same behaviour with QGraphicsScene?</p>\n\n<p><strong>Update 1:</strong>\nApplication behaves the way i want if i create new scene every upload action. The code now looks like:</p>\n\n<pre><code>void MeasuresWidget::on_openAction_triggered()\n{\n    scene = new QGraphicsScene(this);\n    ui-&gt;graphicsView-&gt;setScene(scene);\n    QString fileName = QFileDialog::getOpenFileName(this,tr(\"Open File\"), QDir::currentPath());\n    if (!fileName.isEmpty())\n    {\n        QImage image(fileName);\n        if (image.isNull())\n        {\n            QMessageBox::information(this, tr(\"Image Viewer\"), tr(\"Cannot load %1.\").arg(fileName));\n            return;\n        }\n        scene-&gt;clear();\n        scene-&gt;addPixmap(QPixmap::fromImage(image).scaledToWidth(w, Qt::SmoothTransformation));\n    }\n\n}\n</code></pre>\n\n<p>Is this ok? Can i achieve the behaviour i want without a need to create new scene every upload action?</p>\n"}, {"tags": ["c++", "visual-studio", "compilation", "cl"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1559737171, "post_id": 56460348, "comment_id": 99512067, "body": "Preprocessor output should not contain anything preprocessable. What fails if you try compiling it normally? Can you show the command line you&#39;re using?"}, {"owner": {"reputation": 1246, "user_id": 6556709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6389fba1f75367a547c52d9779902b20?s=128&d=identicon&r=PG&f=1", "display_name": "user6556709", "link": "https://stackoverflow.com/users/6556709/user6556709"}, "edited": false, "score": 2, "creation_date": 1559737406, "post_id": 56460348, "comment_id": 99512184, "body": "A preprocessed file is simply an ordinary C++ file. It can be compiled without any flags."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1559737761, "post_id": 56460348, "comment_id": 99512369, "body": "Just rename it to something with a <code>.c</code> extension and compile that without the <code>&#47;P</code> flag.    The preprocessor will still be executed (it is a phase of compilation) but, since the file is already preprocessed, should have no observable effect on the object file.    Bear in mind that a preprocessed file may make use of compiler-specific extensions, so you won&#39;t (typically) be able to compile the preprocessed code using another toolchain."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1559737787, "post_id": 56460348, "comment_id": 99512389, "body": "since output file has &quot;i&quot; extension compiler is unable to detect langue. So probably you have to use some flag to force language or add receptive extension to filename"}, {"owner": {"reputation": 2444, "user_id": 3197387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ec27435a4e7d85c8eb8b5e4799abc7?s=128&d=identicon&r=PG&f=1", "display_name": "Sisir", "link": "https://stackoverflow.com/users/3197387/sisir"}, "edited": false, "score": 0, "creation_date": 1559795119, "post_id": 56460348, "comment_id": 99532682, "body": "I already have the <code>.c</code> file, so I can directly compile it to <code>.obj</code> and <code>.lib</code> directly for that matter. What I am looking for is to move the compilation from preprocessing to compiling."}], "answers": [{"comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 1, "creation_date": 1559738467, "post_id": 56460593, "comment_id": 99512780, "body": "The <code>cl</code> flag for compiling C++ code is <code>&#47;TP</code> (and for C code, <code>&#47;TC</code>)."}, {"owner": {"reputation": 2444, "user_id": 3197387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ec27435a4e7d85c8eb8b5e4799abc7?s=128&d=identicon&r=PG&f=1", "display_name": "Sisir", "link": "https://stackoverflow.com/users/3197387/sisir"}, "edited": false, "score": 0, "creation_date": 1559796306, "post_id": 56460593, "comment_id": 99532909, "body": "As per [MSDN documentation] (<a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/tc-tp-tc-tp-specify-source-file-type?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/build/reference/&hellip;</a>) /Tp flag is to specify a source file which contains C++ code in it irrespective of the file extension"}, {"owner": {"reputation": 2444, "user_id": 3197387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ec27435a4e7d85c8eb8b5e4799abc7?s=128&d=identicon&r=PG&f=1", "display_name": "Sisir", "link": "https://stackoverflow.com/users/3197387/sisir"}, "edited": false, "score": 0, "creation_date": 1559796390, "post_id": 56460593, "comment_id": 99532927, "body": "Isn&#39;t there any option which can take the compilation from preprocessing to compiling without starting it from scratch?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 2444, "user_id": 3197387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ec27435a4e7d85c8eb8b5e4799abc7?s=128&d=identicon&r=PG&f=1", "display_name": "Sisir", "link": "https://stackoverflow.com/users/3197387/sisir"}, "edited": false, "score": 1, "creation_date": 1559814568, "post_id": 56460593, "comment_id": 99540353, "body": "@Sisir Yes that&#39;s what I said!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 2444, "user_id": 3197387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ec27435a4e7d85c8eb8b5e4799abc7?s=128&d=identicon&r=PG&f=1", "display_name": "Sisir", "link": "https://stackoverflow.com/users/3197387/sisir"}, "edited": false, "score": 0, "creation_date": 1559814573, "post_id": 56460593, "comment_id": 99540358, "body": "@Sisir No there isn&#39;t"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 4, "last_activity_date": 1559738546, "last_edit_date": 1559738546, "creation_date": 1559738050, "answer_id": 56460593, "question_id": 56460348, "link": "https://stackoverflow.com/questions/56460348/how-to-compile-a-preprocessed-file-into-object-file-using-vs-compiler/56460593#56460593", "title": "How to compile a preprocessed file into object file using VS compiler", "body": "<p>You don't need to do anything special. It's a valid C++ source file that just goes to your compiler. (Though it won't be a portable source file, since all the toolchain's own standard library gubbins, and whatever else, have been expanded.)</p>\n\n<p>The only trick here is that usually the \"intermediate\" step is done for you by the front-end, taking the preprocessed source and passing it to the \"real\" compiler. But you can still just do that yourself.</p>\n\n<p>However, you may want to rename it so it has a nice C++-like extension. Otherwise, you can pass <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/tc-tp-tc-tp-specify-source-file-type?view=vs-2019\" rel=\"nofollow noreferrer\"><code>/Tp</code></a> to force your file to be treated as C++, regardless of extension. (For GCC this would be <code>-x c++</code>.)</p>\n\n<p>The other thing to note is that it's then still going to run a preprocessing step on your file, not knowing that it's no longer needed (all the preproc directives have already been expanded by your first step), so that's a little wasted additional time. But then this is not (or should not be) a typical workflow.</p>\n\n<pre><code>cl /P Source.c\ncl /Tp Source.i\n</code></pre>\n"}], "owner": {"reputation": 2444, "user_id": 3197387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45ec27435a4e7d85c8eb8b5e4799abc7?s=128&d=identicon&r=PG&f=1", "display_name": "Sisir", "link": "https://stackoverflow.com/users/3197387/sisir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 56460593, "answer_count": 1, "score": 1, "last_activity_date": 1559738546, "creation_date": 1559737066, "question_id": 56460348, "link": "https://stackoverflow.com/questions/56460348/how-to-compile-a-preprocessed-file-into-object-file-using-vs-compiler", "title": "How to compile a preprocessed file into object file using VS compiler", "body": "<p>cl.exe (Visual Studio C/C++ language compiler) compiles source file to preprocessed file with the /P flag e.g. <code>cl /P Source.c</code> creates Source.i</p>\n\n<p>I want to compile this Source.i (not the Source.c) into Source.obj. How should I do it? Can't a find a flag that takes preprocessed file as an input.</p>\n"}, {"tags": ["c++", "opengl", "glut", "freeglut", "opengl-compat"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1559737925, "post_id": 56460346, "comment_id": 99512466, "body": "You just draw one line. OpenGL does not accumulate/store what you have drawn before. You have to redraw <b>all</b> lines in every frame."}, {"owner": {"reputation": 49, "user_id": 10600191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cO7js.png?s=128&g=1", "display_name": "Foti K&#235;rkeshi", "link": "https://stackoverflow.com/users/10600191/foti-k%c3%abrkeshi"}, "reply_to_user": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1559738124, "post_id": 56460346, "comment_id": 99512569, "body": "Yeah seems logical. Thanks for the response!"}], "answers": [{"tags": [], "owner": {"reputation": 556, "user_id": 11101640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b024c96f1cb84087061f46e8ba1657?s=128&d=identicon&r=PG&f=1", "display_name": "Magma", "link": "https://stackoverflow.com/users/11101640/magma"}, "is_accepted": true, "score": 3, "last_activity_date": 1559738424, "creation_date": 1559738424, "answer_id": 56460681, "question_id": 56460346, "link": "https://stackoverflow.com/questions/56460346/drawing-zig-zag-line-using-glutpostredisplay/56460681#56460681", "title": "Drawing zig-zag line using glutPostRedisplay()", "body": "<p>All your old lines disappear because you call <code>glClear</code>, which clears your screen. Calling glClear every frame is a good idea, but now after calling glClear, you only draw a single line segment between the last two points you clicked on.</p>\n\n<p>What you could do to make it work is just skip the call to <code>glClear</code>, but that's really not the way OpenGL is intended to be used, and it's not flexible at all (what if you want to make the lines wiggle a bit, or change color?). Additionally it is error-prone, especially with double-buffering. Suppose you click twice on consecutive frames. One of your line segments only ever gets drawn in one frame, so it is only ever drawn to one of the two buffers. This will make your segment appear to flicker on your screen. Or if you change your window size, you'll definitely lose some of the information in your screen buffers (if not the entire buffer contents).</p>\n\n<p>What you need to do is keep track of all the points you want to draw, in a list or something, then redraw the <em>entire</em> zig-zag line each frame.</p>\n"}], "owner": {"reputation": 49, "user_id": 10600191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cO7js.png?s=128&g=1", "display_name": "Foti K&#235;rkeshi", "link": "https://stackoverflow.com/users/10600191/foti-k%c3%abrkeshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 56460681, "answer_count": 1, "score": 2, "last_activity_date": 1559741420, "creation_date": 1559737059, "last_edit_date": 1559741420, "question_id": 56460346, "link": "https://stackoverflow.com/questions/56460346/drawing-zig-zag-line-using-glutpostredisplay", "title": "Drawing zig-zag line using glutPostRedisplay()", "body": "<p>So I'm trying to draw a zigzag line inside the window, which gets its x and y coordinates from the mouse clicks. So after every click on the window, the last two vertices will be connected together and so on.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;GL/glut.h&gt;\n\nvoid init(){\n    glClearColor(1.0, 1.0, 1.0, 1.0);\n    glViewport(0, 0, 800, 400);\n    gluOrtho2D(0.0, 800.0, 0.0, 400.0);\n}\n\nint x1, y1, x2, y2, count = -1;\n\nvoid mouse(int key, int state, int x, int y){\n\n    if(key == GLUT_LEFT_BUTTON){\n      if(state == GLUT_DOWN){\n        count++;\n        if(count%2 == 0){\n            x1 = x;\n            y1 = 400.0-y;\n        }\n        else{\n            x2 = x;\n            y2 = 400.0-y;\n            glutPostRedisplay();\n        }\n      }\n    }\n}\n\nvoid Display(){\n\n    glClear(GL_COLOR_BUFFER_BIT);\n    glColor3i(1, 1, 1);\n\n    if(count != 0){\n\n        glBegin(GL_LINE_STRIP);\n\n            glVertex2i(x1, y1);\n            glVertex2i(x2, y2);\n\n        glEnd();\n    }\n    glFlush();\n}\n\nint main(int argc, char* argv[]) {\n\n    glutInit(&amp;argc, argv);\n    glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);\n    glutInitWindowSize(800, 400);\n    glutCreateWindow(\"Vije e thyer\");\n    init();\n    glutMouseFunc(mouse);\n    glutDisplayFunc(Display);\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n\n<p>I expect it to show every line drawn on the window, but the last line disappears as soon as a new one is created. I think that's a problem with glutPostRedisplay.</p>\n"}, {"tags": ["c++", "knapsack-problem"], "comments": [{"owner": {"reputation": 1453, "user_id": 2018010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fwCYF.gif?s=128&g=1", "display_name": "magras", "link": "https://stackoverflow.com/users/2018010/magras"}, "edited": false, "score": 1, "creation_date": 1559738299, "post_id": 56460293, "comment_id": 99512677, "body": "First implementation is quite straightforward. It has inverted order of loops compared to your solution: outer loop goes through <code>a,b,c</code> and inner loop sets all elements in an array. But I can not understand how impl 2 work."}], "answers": [{"tags": [], "owner": {"reputation": 1453, "user_id": 2018010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fwCYF.gif?s=128&g=1", "display_name": "magras", "link": "https://stackoverflow.com/users/2018010/magras"}, "is_accepted": true, "score": 1, "last_activity_date": 1559742203, "creation_date": 1559742203, "answer_id": 56461748, "question_id": 56460293, "link": "https://stackoverflow.com/questions/56460293/recurrence-relation-for-a-variant-of-knapsack-problem/56461748#56461748", "title": "Recurrence relation for a variant of knapsack problem?", "body": "<h3>Implementation 1</h3>\n\n<p>This is quite straightforward implementation of dynamic programming.</p>\n\n<p>Outer loop just goes through three values: <code>a</code>, <code>b</code>, and <code>c</code></p>\n\n<pre><code>  8         for(;cin&gt;&gt;a;)\n</code></pre>\n\n<p>Inner loop visits every element of an array and updates current best known number of cuts for given ribbon length.</p>\n\n<pre><code>  9                 for(i=a;i&lt;=n;i++)\n 10                         f[i]=max(f[i],f[i-a]+1);\n</code></pre>\n\n<hr>\n\n<h3>Implementation 2</h3>\n\n<p>I don't think that it can be called dynamic programming, but the trick is quite neat.</p>\n\n<p>It allocates array of bits with length equal to max <code>n</code>. Then sets one bit on the left. It means, that ribbon with length of 0 is a valid solution.\nOn each iteration algorithm shifts given array to the left by <code>a</code>, <code>b</code>, and <code>c</code>. Result of each such shift can be viewed as the new valid sizes of ribbon. By <code>or</code>ing result of all 3 shifts, we get all valid sizes after <code>i</code>'th cut. If <code>n</code>'th bit set we know ribbon of size <code>n</code> can be cut <code>i</code> times without remainder.</p>\n\n<pre><code>n = 10\na = 2\nb = 3\nc = 5\n\ni=1:\n0|0000000001 // mog\n0|0000000100 // mog&lt;&lt;a\n0|0000001000 // mog&lt;&lt;b\n0|0000100000 // mog&lt;&lt;c\n0|0000101100 // mog=(mog&lt;&lt;a)|(mog&lt;&lt;b)|(mog&lt;&lt;c)\n^ here is a bit checked in 'if' statement '(mog=(...))[n]'\n</code></pre>\n\n<pre><code>i=2:\n0|0000101100 // mog\n0|0010110000 // mog&lt;&lt;a\n0|0101100000 // mog&lt;&lt;b\n1|0110000000 // mog&lt;&lt;c // here we have solution with two pieces of size 5\n1|0111110000 // (mog&lt;&lt;a)|(mog&lt;&lt;b)|(mog&lt;&lt;c)\n^ now bit set, so we have a solution\n</code></pre>\n\n<p>We know that there is exactly <code>i</code> cuts at that point, so we set <code>ost=i</code>. But we found the worst solution, we have to keep going until we are sure that there is no more solutions.</p>\n\n<p>Eventually we will reach this state:</p>\n\n<pre><code>i=5:\n1|1100000000 // mog\n1|0000000000 // mog&lt;&lt;a // 5 pieces of size 2\n0|0000000000 // mog&lt;&lt;b\n0|0000000000 // mog&lt;&lt;c\n1|0000000000 // (mog&lt;&lt;a)|(mog&lt;&lt;b)|(mog&lt;&lt;c)\n</code></pre>\n\n<p>Here it is the last time when bit at position <code>n</code> will be set. So we will set <code>ost=5</code> and will do some more iterations.</p>\n\n<p>Algorithm uses <code>n</code> as upper bound of possible cuts, but it's obvious that this bound can be improved. For example <code>n / min({a,b,c})</code> should be sufficient.</p>\n"}], "owner": {"reputation": 75, "user_id": 3707996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/126720e4b5e4b501024d46149dbfa30f?s=128&d=identicon&r=PG&f=1", "display_name": "sarat", "link": "https://stackoverflow.com/users/3707996/sarat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 56461748, "answer_count": 1, "score": 2, "last_activity_date": 1559742203, "creation_date": 1559736882, "question_id": 56460293, "link": "https://stackoverflow.com/questions/56460293/recurrence-relation-for-a-variant-of-knapsack-problem", "title": "Recurrence relation for a variant of knapsack problem?", "body": "<p>I am finding it difficult to understand two specific implementations which solve this problem on codeforces <a href=\"https://codeforces.com/problemset/problem/189/A\" rel=\"nofollow noreferrer\">link</a>.</p>\n\n<p>I understand this is similar to the knapsack problem. However when i solved it myself, i was not aware of the algorithm. I solved it from my own understanding of dynamic programming. My idea is to regard the remaining length of the ribbon as the next state. Here's my code</p>\n\n<pre><code>#include&lt;iostream&gt;\n\nusing namespace std;\n\n\nint main(){\n     int n,res1=0,res2,x=0;\n     int a,b,c;\n     cin &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; c;\n     for(int i=0;i &lt;= n/a; i++){\n        res2 = -20000;\n        for(int j=0; j &lt;= (n-(a*i))/b; j++){\n             x = (n - (a*i) - (b*j));\n            res2=max(res2,(j + ((x % c) ? -10000 : x/c)));\n        }\n            res1=max(res1,i+res2);\n     }\n    cout &lt;&lt; res1 &lt;&lt; endl;\n    return 0;\n</code></pre>\n\n<p>Implementation 1:</p>\n\n<pre><code>  1 #include &lt;bits/stdc++.h&gt;\n  2 using namespace std;\n  3 int main()\n  4 {\n  5         int f[4005],n,a,i,j;\n  6         fill(f+1,f+4005,-1e9);\n  7         cin&gt;&gt;n;\n  8         for(;cin&gt;&gt;a;)\n  9                 for(i=a;i&lt;=n;i++)\n 10                         f[i]=max(f[i],f[i-a]+1);\n 11         cout&lt;&lt;f[n];\n 12 }\n</code></pre>\n\n<p>Implementation 2:</p>\n\n<pre><code>  1 #include &lt;bits/stdc++.h&gt;\n  2 int n, a, b, c, ost;\n  3 std::bitset&lt;4007&gt; mog;\n  4 main()\n  5 {\n  6         std::cin&gt;&gt;n&gt;&gt;a&gt;&gt;b&gt;&gt;c;\n  7         mog[0]=1;\n  8         for (int i=1; i&lt;=n; i++)\n  9                 if ((mog=((mog&lt;&lt;a)|(mog&lt;&lt;b)|(mog&lt;&lt;c)))[n])\n 10                         ost=i;\n 11         std::cout &lt;&lt; ost;\n 12 }\n</code></pre>\n\n<p>Though i understand the general idea of solving the knapsack problem. I do not have a clear understanding of how lines 8,9,10 in Implementation 1 achieve this. Specifically irrespective of the input values of a,b,c the inner for loop is a single pass over the array for the corresponding value a received.</p>\n\n<p>Similarly, I can see that lines 8,9,10 in implementation 2 does the same thing. But i have no clue at all how this piece of code works.</p>\n\n<p>Please help me understand this. I feel there is some hidden structure to these two solutions which i am not seeing. Thanks in advance.</p>\n"}, {"tags": ["c++", "ros"], "comments": [{"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1559737204, "post_id": 56460163, "comment_id": 99512083, "body": "It has been a long time since I used ROS, but I think you should also turn to <a href=\"https://answers.ros.org/questions/\" rel=\"nofollow noreferrer\">the ROS community</a> for the ROS related questions."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11237059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b5c53be02fa7ed55e6d09ea47a8957?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/11237059/ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1559810785, "creation_date": 1559810785, "answer_id": 56473957, "question_id": 56460163, "link": "https://stackoverflow.com/questions/56460163/surface-normal-estimation-with-ros-using-pcl/56473957#56473957", "title": "Surface Normal estimation with ROS using PCL", "body": "<p>I solved the problem; I should convert the message type to the correct format. <a href=\"http://answers.ros.org/question/136916/conversion-from-sensor_msgspointcloud2-to-pclpointcloudt/\" rel=\"nofollow noreferrer\">this answer</a>  helped me a lot.</p>\n"}], "owner": {"reputation": 21, "user_id": 11237059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b5c53be02fa7ed55e6d09ea47a8957?s=128&d=identicon&r=PG&f=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/11237059/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 810, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559810785, "creation_date": 1559736327, "question_id": 56460163, "link": "https://stackoverflow.com/questions/56460163/surface-normal-estimation-with-ros-using-pcl", "title": "Surface Normal estimation with ROS using PCL", "body": "<p>I am trying to use PCL with ROS to estimated the surface normal of published point cloud form gazebo simulator; this is my callback function however, I got the following errors.  Could you please help..</p>\n\n<p>I followed the PCL tutorial for normal estimation and it works fine to me.</p>\n\n<pre><code>void     cloud_cb (const sensor_msgs::PointCloud2ConstPtr&amp; cloud_msg)\n    { \n // Container for original &amp; filtered data\n pcl::PCLPointCloud2* cloud = new pcl::PCLPointCloud2; \n pcl::PCLPointCloud2ConstPtr cloudPtr(cloud);    \n//  pcl::PCLPointCloud2 cloud_filtered;\n\n\n // Convert to PCL data type\n pcl_conversions::toPCL(*cloud_msg, *cloud);\n\n\n\n // Create the normal estimation class, and pass the input dataset to \n pcl::NormalEstimation&lt;pcl::PointXYZ, pcl::Normal&gt; ne;\n ne.setInputCloud (cloud);\n\n\n// Create an empty kdtree representation, and pass it to the normal  estimation object.\n // Its content will be filled inside the object, based on the given input dataset (as no other search surface is given).\n pcl::search::KdTree&lt;pcl::PointXYZ&gt;::Ptr tree (new pcl::search::KdTree&lt;pcl::PointXYZ&gt; ());\n ne.setSearchMethod (tree);\n\n // Output datasets\n pcl::PointCloud&lt;pcl::Normal&gt;::Ptr cloud_normals (new pcl::PointCloud&lt;pcl::Normal&gt;);\n\n // Use all neighbors in a sphere of radius 3cm\n ne.setRadiusSearch (0.03);\n\n // Compute the features\n ne.compute (*cloud_normals);\n\n\n // cloud_normals-&gt;points.size () should have the same size as the input cloud-&gt;points.size ()*\n // visualize normals\n pcl::visualization::PCLVisualizer viewer(\"PCL Viewer\");\n viewer.setBackgroundColor (0.0, 0.0, 0.5);\n viewer.addPointCloudNormals&lt;pcl::PointXYZ,pcl::Normal&gt;(cloud, cloud_normals);\n\n while (!viewer.wasStopped ())  // THE ORGINAL !viewer.wasStopped () \n         {\n           viewer.spinOnce ();\n         }\n\n\n\n\n\n\n\n // Convert to ROS data type\n sensor_msgs::PointCloud2 output;\n pcl_conversions::moveFromPCL(cloud, output);\n\n\n\n\n\n // Publish the data.\n pub.publish (output);    }\n</code></pre>\n\n<p>error: no matching function for call to \u2018pcl::NormalEstimation::setInputCloud(pcl::PCLPointCloud2*&amp;)\u2019\n      ne.setInputCloud (cloud);</p>\n\n<p>error: no matching function for call to \u2018pcl::visualization::PCLVisualizer::addPointCloudNormals(pcl::PCLPointCloud2*&amp;, pcl::PointCloud::Ptr&amp;)\u2019\n      viewer.addPointCloudNormals(cloud, cloud_normals);</p>\n\n<p>error: wrong number of template arguments (2, should be 1)\n      viewer.addPointCloudNormals(cloud, cloud_normals);\n                                                                                 ^</p>\n\n<p>error: no matching function for call to \u2018moveFromPCL(pcl::PCLPointCloud2*&amp;, sensor_msgs::PointCloud2&amp;)\u2019\n      pcl_conversions::moveFromPCL(cloud, output);</p>\n"}, {"tags": ["c++", "boost", "graph"], "comments": [{"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1560224778, "post_id": 56460060, "comment_id": 99654816, "body": "FWIW, your question is a bit broad. Consider restricting your question to be more concrete."}, {"owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "reply_to_user": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1560265386, "post_id": 56460060, "comment_id": 99674968, "body": "I did not notice this. I updated my question."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1560476681, "post_id": 56460060, "comment_id": 99758315, "body": "I&#39;m confused by <i>&quot;If a certain subgraph is part of the solution at least one of its neighbors has to be part of the solution too.&quot;</i> This seems impossible, unless you mean &quot;proper subgraph&quot; and the solution consists of all vertices. <i>Why:</i> The solution consists of a set of vertices. These vertices form a subgraph, so at least one of this subgraph&#39;s neighbors (not in the subgraph, hence not in the solution) has to be part of the solution? The neighbor is simultaneously not in the solution and in the solution -- contradiction."}, {"owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "edited": false, "score": 0, "creation_date": 1560501377, "post_id": 56460060, "comment_id": 99765424, "body": "A solution has a fixed size n. This statement only holds for subgraphs that have &lt;n vertices. Therefore, for any of those subgraphs I need one neighbor vertex to be part of the solution, too. I\u2018m sorry for the misleading statement."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1561083537, "post_id": 56460060, "comment_id": 99957031, "body": "@michip96 Sorry, I had not noticed you replied since you did not tag me in your reply. I still don&#39;t understand what you are trying to do. You get a solution of size <code>n</code>, which you use to generate a new graph based on the original graph. To detect &quot;infeasible&quot; you use <code>boost::connected_components()</code> to make sure the new graph is connected (i.e. has a single connected component). The next step is to take a proper subgraph of your solution and make sure it has a neighbor that is part of the solution? But that is guaranteed by having only one connected component, so why do this test?"}, {"owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1561103597, "post_id": 56460060, "comment_id": 99962311, "body": "@JaMiT Sorry for not tagging you. Yes, I can detect an infeasible solution by just counting the connected components. I want to do this test because it gives me the opportunity to help the linear optimization software (i.e. by adding additional constraints to the linear program). When it knows which vertices it needs to add in order to keep a certain subgraph as a part of the solution, the solving process can be accelerated a lot. This is similar to adding proper &quot;subtour constraints&quot; in problems like TSP.  Even tho I have a specific problem the question can be seen much broader (see my edit)."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1561132551, "post_id": 56460060, "comment_id": 99976927, "body": "@michip96 Well, yes, if we assume your approach is a good one, then your specific question becomes that broader one with a quick and negative answer. However, I don&#39;t like that assumption. I think I understand your scenario well enough to clarify your question. If I miss the mark, feel free to revert my edit."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "edited": false, "score": 0, "creation_date": 1562055293, "post_id": 56712598, "comment_id": 100246814, "body": "Thank you for your answer. Sadly the linear optimization program needs a lot of memory (i.e. it rapidly exceeds 64GB of RAM). Moreover, I can not &quot;track&quot; a solution through the process. Therefore, I need a way to efficiently gather the neighbors of a subset of maximum size of a given component, if present. Anyway, this surely does work for other applications than mine."}], "tags": [], "owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "is_accepted": false, "score": 1, "last_activity_date": 1561177878, "creation_date": 1561177878, "answer_id": 56712598, "question_id": 56460060, "link": "https://stackoverflow.com/questions/56460060/boost-graph-find-neighbours-of-a-group-of-vertices/56712598#56712598", "title": "Boost Graph find neighbours of a group of vertices", "body": "<p>I would not iterate over multiple vertices. Instead, I would maintain two sets of vertices &ndash; one containing the vertices in the current partial solution, and one containing the vertices adjacent to (and not in) the partial solution. When the linear optimization package adds a vertex to the partial solution, that vertex should also be moved from the set of adjacencies to the set of vertices in the solution. Next the edges coming from the new vertex need to be iterated over, but only those from the new vertex. For each vertex adjacent to the new one, if it is not in the partial solution then add it to the set of adjacent vertices.</p>\n\n<p>I would also try something similar using just one set containing both the vertices in the partial solution and those adjacent to the partial solution. Less overhead. Depending on what the surrounding code expects, this set might work as well as the one with just the adjacent vertices.</p>\n\n<p>The advantage of this approach is that you eliminate repetitive work. If you already looked at all the neighbors of vertex A, why should you need to look at them <em>again</em> just because vertex B was added to your set?</p>\n\n<p>A disadvantage of this approach is that you might require significant memory overhead if you need to backtrack at times (think depth-first search and maintaining a stack of these sets). How bad this is depends on how big <code>n</code> is and, on average, how many edges connect to each vertex. Even in a bad case, some clever elimination of redundancy might salvage this approach, but I'll leave that for later.</p>\n"}], "owner": {"reputation": 351, "user_id": 2601107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769202f441824a755e63ce2ad8406ac1?s=128&d=identicon&r=PG", "display_name": "michip96", "link": "https://stackoverflow.com/users/2601107/michip96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1561177878, "creation_date": 1559735919, "last_edit_date": 1561132998, "question_id": 56460060, "link": "https://stackoverflow.com/questions/56460060/boost-graph-find-neighbours-of-a-group-of-vertices", "title": "Boost Graph find neighbours of a group of vertices", "body": "<p>I have an <code>undirected_unweighted_graph graph;</code> which is defined as follows:</p>\n\n<pre><code>typedef typename boost::adjacency_list&lt;boost::vecS,boost::vecS,boost::undirectedS,boost::no_property,boost::no_property&gt; undirected_unweighted_graph;\n</code></pre>\n\n<p>It has several vertices which are interconnected by undirected edges.\nDuring my algorithm, I'm searching for a connected subgraph of <code>graph</code> which only contains some of the vertices, which has certain properties. </p>\n\n<p>I'm using a linear optimization software package which provides me with possible optimal solutions for my problem. A solution consists of a set of vertices with a fixed size n and might be infeasible (i.e. the vertices are not connected in the corresponding subgraph of <code>graph</code>). I'm currently generating a new graph with the vertices of the solution and adding the edges which are also present in <code>graph</code>. I'm using <code>boost::connected_components()</code> to calculate the connected components for it.</p>\n\n<p>Now I come to my question:<br>\nThe next step for me is to improve the performance of generating a solution by imposing a constraint. Specifically, I will \"grow\" a solution, starting from a single node and ending with a subgraph of <code>n</code> nodes. At each stage, a partial solution will grow by adding one of its neighbors. <em>(The idea is that if a partial solution can grow to a full solution, then at least one of its neighbors will be in the full solution.)</em> How can I identify these neighbors?</p>\n\n<p>My approach is the following:</p>\n\n<p>I'm iterating over each component and then iterate over <code>boost::out_edges(v, g)</code>. I then have to check if the neighbor is part of my component or not. If it is not part of the component I add it to the component neighbor group. I wonder if there is any way in boost to iterate over <code>boost::out_edges(V, g)</code> for a list of vertices <code>V</code>.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>To be more concrete: Given a graph, I am able to iterate over the neighbors of a given vertex like this:</p>\n\n<pre><code>for (auto edge: boost::make_iterator_range(boost::out_edges(v, graph))) {\n    //do stuff\n}\n</code></pre>\n\n<p>What if I have a connected component, say a vector of vertices <code>std::vector&lt;size_t&gt; component</code>. What I want are the outgoing edges of the component meaning all outgoing edges of the vertices excluding those which are between two vertices of <code>component</code>. Is there an elegant way to get those edges efficiently?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 1, "creation_date": 1559736178, "post_id": 56460046, "comment_id": 99511578, "body": "What is <code>Data</code> ?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1559736644, "post_id": 56460046, "comment_id": 99511800, "body": "Such cast would be utterly pointless."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1559739126, "post_id": 56460046, "comment_id": 99513159, "body": "@n.m. For <code>Usint</code> and <code>Uint</code> they are required (let&#39;s say you have <code>0xAABBCCDD</code> in memory pointed at src, then value in the former will be either <code>0xAA</code> or <code>0xDD</code>, depending on endianess with the cast, and <code>0xAABBCCDD</code> without). The cast to <code>uint32b</code> is useless."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 1, "creation_date": 1559742599, "post_id": 56460046, "comment_id": 99515280, "body": "@xryl669 Nope. It doesn&#39;t matter what you have in memory. You have a chain of <i>pointer</i> casts and implicit conversions. Inserting another cast to a different pointer type <i>in the middle of the chain</i> won&#39;t change the end result."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559754077, "post_id": 56460046, "comment_id": 99521485, "body": "Read the code again. It&#39;s doing <code>*(uint8*)src</code>, notice the first star here. It&#39;s dereferencing the address here as a uint8, so only a single byte is read here. Without this cast, the meaning of the code changes. You&#39;re right that the cast to <code>uint32</code> is useless."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559851716, "post_id": 56460046, "comment_id": 99559033, "body": "@xryl669 <b>you</b> read the code again. The question is whether the cast in <code>encode(dest, MyType_Uint, (uint16b*)Data)</code> makes any difference. It is the <b>first</b> cast in the chain. You are pointing at the <b>last</b> cast in the chain."}], "answers": [{"comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559736362, "post_id": 56460148, "comment_id": 99511672, "body": "No, that&#39;s wrong. <code>u</code> should be a uint64, not less, since in the case <code>MyType_Ulint</code> it&#39;ll be accessed as a uint64."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 2, "creation_date": 1559736399, "post_id": 56460148, "comment_id": 99511686, "body": "@xryl669 The case <code>MyType_Ulint</code> won&#39;t be executed when the argument isn&#39;t <code>MyType_Ulint</code>."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559737540, "post_id": 56460148, "comment_id": 99512266, "body": "Since it&#39;s a runtime argument, this is undefined behavior."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559737666, "post_id": 56460148, "comment_id": 99512323, "body": "@xryl669 being a runtime argument makes no difference. The function has well defined behaviour when called like I&#39;ve shown (assuming the redacted part actually <code>return</code>s)."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559737999, "post_id": 56460148, "comment_id": 99512501, "body": "No it does not. The standard expects that dereferencing a pointer to an object should have an object at the specified address, else it&#39;s UB. In case <code>MyType_Ulint</code> there is no guaranty it does (and to be clear, it does not in the OP&#39;s given use case), so this code presents UB. It&#39;s not because your example only use a limited (and correct) case that the rest of the bad code will magically become correct."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559738135, "post_id": 56460148, "comment_id": 99512578, "body": "@xryl669 If you pass <code>MyType_Ulint</code> as the second argument, then you must of course pass pointer to an <code>uint64b</code> into the function. But that is irrelevant when <code>MyType_Ulint</code> is not passed as the second argument."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559738293, "post_id": 56460148, "comment_id": 99512673, "body": "If I follow your logic, then the 2nd argument is useless, just write as many encode function as what you need (one for char, one for short, ...) and use that type for the last argument. Yet, the code, <b>as written</b> present UB since you can pass any 2nd argument you want and an unrelated pointer type for the last argument and it&#39;ll compile but behave undefinedly (likely crash)"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559738393, "post_id": 56460148, "comment_id": 99512733, "body": "@xryl669 Indeed the function presents UB in the same sense that for example the subscript operator of a vector or <code>memcpy</code> presents UB. The function has pre-conditions that must be obeyed, or else there is UB."}, {"owner": {"reputation": 23, "user_id": 5555136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8588bfd66c214d589e6a4ac4a3312baf?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny_pce", "link": "https://stackoverflow.com/users/5555136/kenny-pce"}, "edited": false, "score": 0, "creation_date": 1559738595, "post_id": 56460148, "comment_id": 99512846, "body": "OK, I understand that I have to keep sane alignment and srcType. More general questions is: Does such cast actually do anything?"}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1559739252, "post_id": 56460148, "comment_id": 99513246, "body": "From a functional point of view, no they don&#39;t. From a correctness point of view, they tell the code&#39;s reader what was the intent. Yet, this function is prone to error, please check my answer for a solution that&#39;s deducing the type by itself, and avoid the alignment issue when you give it the correct type directly."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1559742733, "last_edit_date": 1559742733, "creation_date": 1559736245, "answer_id": 56460148, "question_id": 56460046, "link": "https://stackoverflow.com/questions/56460046/casting-a-pointer-when-passing-it-as-an-argument-for-void-parameter/56460148#56460148", "title": "Casting a pointer when passing it as an argument for void* parameter", "body": "<blockquote>\n<pre><code>encode(dest, MyType_Uint, (uint16b*)Data)\n</code></pre>\n  \n  <p>Would such cast fix alignment and/or endianess?</p>\n</blockquote>\n\n<p>Such cast does not fix alignment nor endiannes.</p>\n\n<p>The way to call that function without undefined behaviour is following:</p>\n\n<pre><code>uint16b u = some_value;\nencode(dest, MyType_Uint, &amp;u);\n\nuint64b ul = some_other_value;\nencode(dest, MyType_Ulint, &amp;ul);\n</code></pre>\n\n<blockquote>\n  <p>Does such cast actually do anything?</p>\n</blockquote>\n\n<p>Such cast changes the type of the expression. In this case, the C style explicit conversion does reinterpret cast.</p>\n\n<p>The converted pointer can be used only in limited ways. You can convert it back to the original type (<code>uint8b*</code> in your case). Indirection through the pointer is UB in most cases, with few exceptions, which include pointer-interconvertible objects, as well as using a pointer to a narrow character type as the result of the conversion. There is no exception that would apply to your example, so it would have UB.</p>\n\n<p>Note that for some pointers, the C style explicit conversion does static cast, rather than reinterpret cast. For example, when the pointers are to classes in the same inheritance hierarchy. This is why C style casts are to be avoided: Use the cast that you intend to use.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1559737483, "last_edit_date": 1559737483, "creation_date": 1559737143, "answer_id": 56460365, "question_id": 56460046, "link": "https://stackoverflow.com/questions/56460046/casting-a-pointer-when-passing-it-as-an-argument-for-void-parameter/56460365#56460365", "title": "Casting a pointer when passing it as an argument for void* parameter", "body": "<p>Casting a pointer never fix alignment nor endianness. It just re-interpret the address as pointing to a different type, and standard does not allow to de-reference it unless an object of the appropriate type lies at that address.</p>\n\n<p>The conformant way to use a possibly misaligned representation is to use <code>memcpy</code>:</p>\n\n<pre><code>int encode(uint8b *dest, MyType srcType, const void *src)\n{\n    uint32b value = 0;\n    uint64b value64 = 0;\n\n    switch (srcType)\n    {\n        // any object can be accessed through a char pointer\n        case MyType_Usint:  uint8b tmp8 = *(uint8b*)src; value = tmp8; break;\n        // use a temporary for 16 bits type (endianness question)\n        case MyType_Uint:   uint16b tmp16; memcpy(&amp;tmp16, src, sizeof(tmp16));\n                            value = tmp16; break;\n        // directly memcpy into the value when size is the same\n        case MyType_Udint:  memcpy(&amp;value, src, sizeof(value)); break;\n        case MyType_Ulint:  memcpy(&amp;value64, src, sizeof(value64)); break;\n    }\n    // now encode value to dest\n}\n</code></pre>\n\n<p>Intel type (80x86 to core) are known to be tolerant to misalignment, but other processors are not and raise an error if you attempt a misaligned access.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5555136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8588bfd66c214d589e6a4ac4a3312baf?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny_pce", "link": "https://stackoverflow.com/users/5555136/kenny-pce"}, "edited": false, "score": 0, "creation_date": 1559739275, "post_id": 56460458, "comment_id": 99513260, "body": "I can&#39;t / don&#39;t want to use compile-time types here."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "reply_to_user": {"reputation": 23, "user_id": 5555136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8588bfd66c214d589e6a4ac4a3312baf?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny_pce", "link": "https://stackoverflow.com/users/5555136/kenny-pce"}, "edited": false, "score": 0, "creation_date": 1559739458, "post_id": 56460458, "comment_id": 99513369, "body": "Then use the former code block. It&#39;ll not crash unless <code>src</code> points to some invalid address."}], "tags": [], "owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "is_accepted": false, "score": 1, "last_activity_date": 1559739930, "last_edit_date": 1559739930, "creation_date": 1559737491, "answer_id": 56460458, "question_id": 56460046, "link": "https://stackoverflow.com/questions/56460046/casting-a-pointer-when-passing-it-as-an-argument-for-void-parameter/56460458#56460458", "title": "Casting a pointer when passing it as an argument for void* parameter", "body": "<p>This code is unlikely to work on platform that can't do unaligned memory access (like ARM9/ARM64 etc...). \nThis is because when you do <code>value64 = *(uint64b*)src</code> you expect the CPU to access a 8 bytes word (and as such it must be aligned to 64bit address) and the signature of the function does not guaranty this. </p>\n\n<p>Typically, on such platform, calling:</p>\n\n<pre><code>  char s;\n  int a = encode(dest, MyType_Ulint, &amp;s); \n</code></pre>\n\n<p>will compile, and will crash at runtime (but will run ok on x86/amd64 system, yet with undefined behavior).</p>\n\n<p>If you want something portable, you should do something like this:</p>\n\n<pre><code>enum MyType\n{\n   MyType_Usint,\n   MyType_Uint,\n   MyType_Udint,\n   MyType_Ulint\n};\n\nint encode(uint8b *dest, MyType srcType, const void *src)\n{\n    uint32b value = 0;\n    uint64b value64 = 0; // This is guaranted to be aligned for 64bit access\n    size_t expected_operand_size[] = { 1, 2, 4, 8 };  \n    memcpy(&amp;value64, src, expected_operand_size[(int)srcType]); \n\n    switch (srcType)\n    {\n        case MyType_Usint:  value = *(uint8b*)&amp;value64; break;\n        case MyType_Uint:   value = *(uint16b*)&amp;value64; break;\n        case MyType_Udint:  value = *(uint32b*)&amp;value64; break;\n        case MyType_Ulint:  break;\n    }\n    // now encode value to dest\n}\n</code></pre>\n\n<p>By the way, you should use template code here for convenience and to avoid the (useless) copy and be easier to understand (no need to have an type enum) :</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct Encode\n{\n    static uint64b convert(const void * src) { T t; memcpy(&amp;t, src, sizeof(t)); return t; }\n    static uint64b convert(const T * src) { return *src; }\n};\n\n// Specialisation when we can avoid the copy\ntemplate &lt;&gt;\nstruct Encode&lt;uint8b&gt;\n{\n    static uint64b convert(const void * src) { return (uint8b)*src; }\n    static uint64b convert(const uint8b * src) { return *src; }\n};\n\ntemplate &lt;typename T&gt;\nint encode(uint8b * dest, const void* src) \n{ \n   uint64b value64 = Encode&lt;T&gt;::convert(src);\n   // your encoding code here\n}\n// Use like this:\nvoid * s = ...;\nuint16b * s2 = ...;\nuint32b * s3 = ...;\nencode&lt;uint8b&gt;(dest, s); // No copy, calls Encode&lt;uint32b&gt;::do(const void*)\nencode&lt;uint16b&gt;(dest, s2); // No copy, calls Encode&lt;uint16b&gt;::do(const uint16b*)\nencode&lt;uint32b&gt;(dest, s3); // No copy, calls Encode&lt;uint32b&gt;::do(const uint32b*)\n// or this is also safe\nencode&lt;uint16b&gt;(dest, s); // Copy here for fixing alignment\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5555136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8588bfd66c214d589e6a4ac4a3312baf?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny_pce", "link": "https://stackoverflow.com/users/5555136/kenny-pce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 56460148, "answer_count": 3, "score": 2, "last_activity_date": 1559742733, "creation_date": 1559735852, "question_id": 56460046, "link": "https://stackoverflow.com/questions/56460046/casting-a-pointer-when-passing-it-as-an-argument-for-void-parameter", "title": "Casting a pointer when passing it as an argument for void* parameter", "body": "<p>Lets have following function:</p>\n\n<pre><code>int encode(uint8b *dest, MyType srcType, const void *src)\n{\n    uint32b value = 0;\n    uint64b value64 = 0;\n\n    switch (srcType)\n    {\n        case MyType_Usint:  value = (uint32b)*(uint8b*)src; break;\n        case MyType_Uint:   value = (uint32b)*(uint16b*)src; break;\n        case MyType_Udint:  value = *(uint32b*)src; break;\n        case MyType_Ulint:  value64 = *(uint64b*)src; break;\n    }\n    // now encode value to dest\n}\n</code></pre>\n\n<p>I have passed wrongly aligned <code>uint8b Data[sizeof(uint64b)]</code>as <code>src</code>, I will fix the alignment.</p>\n\n<p>But I received a demand to cast <code>Data</code> when calling the function to proper type, i.e. <code>encode(dest, MyType_Uint, (uint16b*)Data)</code>, which I think would cause in some more annoying unnecessary switches.\nIt's working even with the wrong alignment on platforms accessible for me, but I'm not sure, how it affects the other.</p>\n\n<p>Would such cast fix alignment and/or endianess?</p>\n\n<p>And yes, I <strong>really</strong> need the <code>void*</code> parameter.</p>\n"}, {"tags": ["c++", "compilation", "linker"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 2, "creation_date": 1559736072, "post_id": 56460040, "comment_id": 99511521, "body": "So you are making one static library, that uses boost and std library things, for use on different platforms? Or a static lib, from the same code, for each platform?"}, {"owner": {"reputation": 289, "user_id": 11597995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ca49bffe400f9b64c224f554c79b27?s=128&d=identicon&r=PG&f=1", "display_name": "Richard K. Wade", "link": "https://stackoverflow.com/users/11597995/richard-k-wade"}, "edited": false, "score": 3, "creation_date": 1559736238, "post_id": 56460040, "comment_id": 99511608, "body": "It could always be that there is code with undefined behavior somewhere in the code base. This could lead to crashing or not crashing based on stuff that seems completely unrelated, like the type of linking."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559736259, "post_id": 56460040, "comment_id": 99511618, "body": "Indeed. I&#39;d check for Static Init Order issues first."}, {"owner": {"reputation": 65, "user_id": 8915616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d018faf8740aa839f9cc9f2c78e122f?s=128&d=identicon&r=PG&f=1", "display_name": "tompa", "link": "https://stackoverflow.com/users/8915616/tompa"}, "reply_to_user": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1559740083, "post_id": 56460040, "comment_id": 99513761, "body": "@doctorlove yes, I forgot to state that I first setup the development environment by sourcing platform specific devenv to ensure that correct platform is targeted, from the same code base i build a static lib for each platform."}, {"owner": {"reputation": 65, "user_id": 8915616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d018faf8740aa839f9cc9f2c78e122f?s=128&d=identicon&r=PG&f=1", "display_name": "tompa", "link": "https://stackoverflow.com/users/8915616/tompa"}, "edited": false, "score": 0, "creation_date": 1559740187, "post_id": 56460040, "comment_id": 99513827, "body": "Yes @richard-k-wade, of course, which doesn&#39;t make it easy to find this problem..."}, {"owner": {"reputation": 65, "user_id": 8915616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d018faf8740aa839f9cc9f2c78e122f?s=128&d=identicon&r=PG&f=1", "display_name": "tompa", "link": "https://stackoverflow.com/users/8915616/tompa"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559740353, "post_id": 56460040, "comment_id": 99513920, "body": "That is an idea I&#39;ll look into @lightness-races-in-orbit. I should not have such ordering issues myself but maybe one of the libraries I use have."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1559744662, "post_id": 56460040, "comment_id": 99516484, "body": "<a href=\"https://stackoverflow.com/help/mcve\">&#91;SO&#93;: How to create a Minimal, Complete, and Verifiable example (mcve)</a>."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 8915616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d018faf8740aa839f9cc9f2c78e122f?s=128&d=identicon&r=PG&f=1", "display_name": "tompa", "link": "https://stackoverflow.com/users/8915616/tompa"}, "is_accepted": false, "score": 0, "last_activity_date": 1560166102, "creation_date": 1560166102, "answer_id": 56525498, "question_id": 56460040, "link": "https://stackoverflow.com/questions/56460040/c-program-crashes-when-code-is-linked-to-exe-but-works-fine-when-code-is-compi/56525498#56525498", "title": "C++ program crashes when code is linked to exe but works fine when code is compiled into exe, how come?", "body": "<p>Actually, the fault was mine. Of course...\nI really tried to get all details correct when I refactored the code into a lib, but obviously I was not careful enough, and blind when searching for the problem.<br>\nThe problem, which I finally found, was that I still kept one variable as a local variable after refactoring, which then went out of scope causing deallocated memory to be referenced, which resulted in all sorts of undefined behavior.</p>\n"}], "owner": {"reputation": 65, "user_id": 8915616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d018faf8740aa839f9cc9f2c78e122f?s=128&d=identicon&r=PG&f=1", "display_name": "tompa", "link": "https://stackoverflow.com/users/8915616/tompa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1560166102, "creation_date": 1559735829, "last_edit_date": 1559740426, "question_id": 56460040, "link": "https://stackoverflow.com/questions/56460040/c-program-crashes-when-code-is-linked-to-exe-but-works-fine-when-code-is-compi", "title": "C++ program crashes when code is linked to exe but works fine when code is compiled into exe, how come?", "body": "<p>I have a program that have been running fine for long time on one platform. Because of its success it is to be ported to another platform. No problem, I thought since it is written in Standard C++...</p>\n\n<p>My approach (illustrated with pseudo CMake):</p>\n\n<ul>\n<li>setup the development environment by sourcing the platform specific toolchain to ensure that correct platform is targeted </li>\n<li><p>factor out all core business logic into an application object and build a library out of that (one library for each platform from the same source code): </p>\n\n<pre><code>add_library(appLib STATIC app.cpp)\ntarget_link_libraries(appLib utilLib networkLib dbLib ${boostLibs})</code></pre></li>\n<li><p>have one main_a.cpp and another main_b.cpp, which do the platform-specific initialization for platform a and b respectively, and let the main function in those instantiate the application object.</p>\n\n<pre><code>int main()\n{\n    auto result = initAndDoPlatformStuff();\n    App app(result);\n    app.run();\n}</code></pre></li>\n<li><p>instruct compiler and linker to assemble an executable:</p>\n\n<pre><code>if (Platform_A)\nadd_executable(appExe main_a.cpp)\nelse()\nadd_executable(appExe main_b.cpp)\nendif()\ntarget_link_libraries(appExe appLib)</code></pre></li>\n</ul>\n\n<p>In principle, this is a perfectly valid approach I guess. But in reality it does not work. Within a second program crashes, and the crashes are different almost every time; inspecting the core dumps indicate it sometime crashed in the standard library, sometime in boost library and also in my code, but this is nonsense I guess. Program seem to work 1 out 10 times, but eventually crashes.  </p>\n\n<p>However, if I use the same exact code, only extract it into its original main.cpp file and then build it together differently, like this:</p>\n\n<pre><code>int main()\n{\n    auto result = initAndDoStuff();\n    processForever(result); // Business logic\n}\nadd_executable(appExe main.cpp)\ntarget_link_libraries(appExe utilLib networkLib dbLib ${boostLibs})\n</code></pre>\n\n<p>then it works!</p>\n\n<p>I'm puzzled and confused. I'm suspecting it has to do something with code layout, I've therefore played around with different variants of PIC and PIE but have had no success with that. Are there any tools available that allows you to get a comprehensive overview of the binary code layout? I know about nm, od, objdump but they are low-level and I don't know what to look for... \nMaybe I'm on the wrong path anyway, maybe the problem is related to something completely different. Does anyone got any hunch of what can cause this behavior? How else can I approach this problem? </p>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1559735585, "post_id": 56459956, "comment_id": 99511278, "body": "Is SQLite3 installed? Is its development package installed? <i>Where</i> is it installed?"}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559735710, "post_id": 56459956, "comment_id": 99511351, "body": "Can you give me the link? I don&#39;t know, how to install."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559735823, "post_id": 56459956, "comment_id": 99511404, "body": "Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the section named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a>."}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1559736444, "post_id": 56459956, "comment_id": 99511715, "body": "I install the SQlite3 in program folder. But the problem did not dare."}, {"owner": {"reputation": 4340, "user_id": 9139384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CgV5s.png?s=128&g=1", "display_name": "Yennefer", "link": "https://stackoverflow.com/users/9139384/yennefer"}, "edited": false, "score": 0, "creation_date": 1559737059, "post_id": 56459956, "comment_id": 99512002, "body": "You are probably missing the headers (which are included in the SDK). If the repo is public, please post it, so we can understand."}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559737214, "post_id": 56459956, "comment_id": 99512088, "body": "I add to path the sqlite library. Nothing has changed"}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559737289, "post_id": 56459956, "comment_id": 99512118, "body": "<a href=\"https://github.com/echo-devim/kalendar\" rel=\"nofollow noreferrer\">github.com/echo-devim/kalendar</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559741521, "post_id": 56461171, "comment_id": 99514572, "body": "I see the massage: [Makefile] Error 3."}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559741718, "post_id": 56461171, "comment_id": 99514706, "body": "Which solution did you use ? Are you using Qt Creator? Please show me you <code>.pro</code> file."}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559742088, "post_id": 56461171, "comment_id": 99514972, "body": "<code>Assignment needs exactly one word on the left hand side.</code>"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 1, "creation_date": 1559742121, "post_id": 56461171, "comment_id": 99514985, "body": "It is very likely that you wrote your <code>.pro</code> incorrectly. For example by missing the line continuation character `\\` in list of files."}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559742407, "post_id": 56461171, "comment_id": 99515162, "body": "Please copy the content of your .pro file <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">here</a>, &quot;Create new paste&quot; then send me the link."}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559742485, "post_id": 56461171, "comment_id": 99515216, "body": "The <code>.pro</code> file is bellow"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559743190, "post_id": 56461171, "comment_id": 99515647, "body": "Where did you get the error <code>Assignment needs exactly one word on the left hand side.</code>? which line?"}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559743261, "post_id": 56461171, "comment_id": 99515689, "body": "<code>QT       + = sql</code> this one"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559743429, "post_id": 56461171, "comment_id": 99515769, "body": "remove the space between + and =. Or you can just write <code>QT       += core gui sql</code>"}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559746502, "post_id": 56461171, "comment_id": 99517558, "body": "<code>ERROR: &#39;sqlite3&#39; does not name a type      sqlite3 *db = NULL;</code> in pmanager.cpp, class Pmanager private"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559755200, "post_id": 56461171, "comment_id": 99521969, "body": "I updated the post. I think that you downloaded a wrong package of <code>SQLite3</code>. And, i have to notice you that the <code>GitHub</code>&#39;s project that you&#39;re using it is not intended for <code>Windows</code>. if you compile it in <code>Windows</code> you have to make a lot of changes."}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559794925, "post_id": 56461171, "comment_id": 99532648, "body": "Thank you very much. Your help is priceless =)"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559827917, "post_id": 56461171, "comment_id": 99547741, "body": "Please set the posr as answer for your question."}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1559827972, "post_id": 56461171, "comment_id": 99547777, "body": "For the schedule i will try to find something for you."}, {"owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1560367662, "post_id": 56461171, "comment_id": 99717341, "body": "Are you find? :)"}, {"owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "reply_to_user": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "edited": false, "score": 0, "creation_date": 1560619075, "post_id": 56461171, "comment_id": 99799850, "body": "I found some projects:  1) <a href=\"https://github.com/sd65/Project-Calendar\" rel=\"nofollow noreferrer\">This one</a> you can edit it little bit.  2) <a href=\"https://github.com/dmitrytoropchin/excalendarwidget\" rel=\"nofollow noreferrer\">This one</a> is just a Calendar (GUI), you can Implement the action your self. I will try to find better."}], "tags": [], "owner": {"reputation": 376, "user_id": 11505018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TEcdfp7lnAw/AAAAAAAAAAI/AAAAAAAAAWo/Xk3h0zexqk0/photo.jpg?sz=128", "display_name": "Tom Kim", "link": "https://stackoverflow.com/users/11505018/tom-kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1559754732, "last_edit_date": 1559754732, "creation_date": 1559740151, "answer_id": 56461171, "question_id": 56459956, "link": "https://stackoverflow.com/questions/56459956/no-such-file-or-directory/56461171#56461171", "title": "No such file or directory", "body": "<p><strong><em>Solution 1:</em></strong></p>\n\n<ul>\n<li><p>First: Download <a href=\"https://www.sqlite.org/2019/sqlite-amalgamation-3280000.zip\" rel=\"nofollow noreferrer\">SQLite3</a> and extract and rename it in such a way as to have <code>c:\\sqlite3\\sqlite3.h</code></p></li>\n<li><p>Then make sure that your <code>.pro</code> file contain:</p></li>\n</ul>\n\n<pre><code>INCLUDEPATH += C:\\\\sqlite3\\\\\nDEPENDPATH += C:\\\\sqlite3\\\\\n</code></pre>\n\n<p><strong><em>Solution 2:</em></strong> Use <code>QSqlDatabase</code> and for that you need to add to your <code>.pro</code> file this:</p>\n\n<pre><code>QT += sql\n</code></pre>\n\n<p>Hope it helps you.</p>\n"}], "owner": {"reputation": 1, "user_id": 11603800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b2516e9f75f0c782273f938ba1a8fe?s=128&d=identicon&r=PG&f=1", "display_name": "whiskeyhoney", "link": "https://stackoverflow.com/users/11603800/whiskeyhoney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560368153, "creation_date": 1559735504, "last_edit_date": 1559742430, "question_id": 56459956, "link": "https://stackoverflow.com/questions/56459956/no-such-file-or-directory", "title": "No such file or directory", "body": "<p>I create the schedule for school, from GitHub, but I don't khow, what is the problem.\nAfter compiling, I see this message.</p>\n\n<blockquote>\n  <p>No such or file directory - sqlite3.h</p>\n</blockquote>\n\n<pre><code>#ifndef PMANAGER_H\n#define PMANAGER_H\n#include &lt;sqlite3.h&gt; /* Version: 3.9.2 */\n#include &lt;stdio.h&gt;\n#include &lt;list&gt;\n#include &lt;vector&gt;\n#include &lt;ctime&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;pwd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fstream&gt;\n#include &lt;experimental/filesystem&gt;\n#include \"../model/event.h\"\n#include \"../model/category.h\"\n</code></pre>\n"}, {"tags": ["c++", "logging", "boost"], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 2246776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OV2MQ.jpg?s=128&g=1", "display_name": "Oren_C", "link": "https://stackoverflow.com/users/2246776/oren-c"}, "edited": false, "score": 0, "creation_date": 1559809763, "post_id": 56466277, "comment_id": 99537871, "body": "I&#39;m having a bit of trouble with this piece of code. I tried to integrate it into the project and I&#39;m getting an exception error converting and this piece of code: proto::make_expr&lt;Tag, phoenix_default_domain&gt;(a...). Should I have included other modules from boost? are there any other changes to make here? it seems as though there is still some incompatibility. I&#39;m trying to solve it myself and still, it would be very much appreciates if you can offer some insight into this. Thanks!"}, {"owner": {"reputation": 413, "user_id": 2246776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OV2MQ.jpg?s=128&g=1", "display_name": "Oren_C", "link": "https://stackoverflow.com/users/2246776/oren-c"}, "edited": false, "score": 0, "creation_date": 1559809802, "post_id": 56466277, "comment_id": 99537897, "body": "I&#39;ve included both of these so far:     #include &lt;boost/phoenix/core/expression.hpp&gt;     #include &lt;boost/phoenix/bind/bind_function.hpp&gt;"}, {"owner": {"reputation": 8115, "user_id": 4636534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GoTz67GRao8/AAAAAAAAAAI/AAAAAAAAADI/PyDv-i56924/photo.jpg?sz=128", "display_name": "Andrey Semashev", "link": "https://stackoverflow.com/users/4636534/andrey-semashev"}, "reply_to_user": {"reputation": 413, "user_id": 2246776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OV2MQ.jpg?s=128&g=1", "display_name": "Oren_C", "link": "https://stackoverflow.com/users/2246776/oren-c"}, "edited": false, "score": 1, "creation_date": 1559820856, "post_id": 56466277, "comment_id": 99543714, "body": "I have corrected the code sample. The important changes are: use <code>tag::smessage</code> in <code>format_message</code> signature to match the <code>smessage</code> keyword, and use <code>smessage.or_none()</code> construct in the formatter to work around Boost.Phoenix limitation. To use <code>boost::phoenix::bind</code> you should include <code>&lt;boost&#47;phoenix&#47;bind.hpp&gt;</code>."}], "tags": [], "owner": {"reputation": 8115, "user_id": 4636534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GoTz67GRao8/AAAAAAAAAAI/AAAAAAAAADI/PyDv-i56924/photo.jpg?sz=128", "display_name": "Andrey Semashev", "link": "https://stackoverflow.com/users/4636534/andrey-semashev"}, "is_accepted": true, "score": 3, "last_activity_date": 1559820702, "last_edit_date": 1559820702, "creation_date": 1559760054, "answer_id": 56466277, "question_id": 56459704, "link": "https://stackoverflow.com/questions/56459704/how-to-prevent-boost-logger-to-add-n-after-each-record/56466277#56466277", "title": "How to prevent boost logger to add \\n after each record?", "body": "<p>The newline is added automatically by the sink backend. The \"right\" way to fix it is to change your logging statements so that they don't end the message string with a newline. I consider it the right way because whether the trailing newline makes sense or not depends on the sink backend. The same log record can be processed by multiple sinks, and the newline may not be appropriate for all of them.</p>\n\n<p>However, as a faster workaround, you may write your own formatter that will skip the trailing newline from the formatted string. There are a number of answers showing how to write a formatter (for example, <a href=\"https://stackoverflow.com/questions/31163790/cast-a-boostlogexpressionsattr-stdstring-to-stdstring/31171443#31171443\">here</a>). Here's one way to do this:</p>\n\n<pre><code>std::string_view format_message(\n    boost::log::value_ref&lt; std::string, boost::log::expressions::tag::smessage &gt; const&amp; message)\n{\n    // Check to see if the attribute value has been found\n    if (message)\n    {\n        std::string_view msg = message.get();\n        if (!msg.empty() &amp;&amp; msg.back() == '\\n')\n            msg = std::string_view(msg.data(), msg.size() - 1);\n        return msg;\n    }\n\n    return std::string_view();\n}\n\nvoid init()\n{\n    boost::log::add_console_log\n    (\n        std::clog,\n        boost::log::keywords::format =\n        (\n            boost::log::expressions::stream\n                &lt;&lt; boost::log::expressions::format_date_time&lt; boost::posix_time::ptime &gt;(\"TimeStamp\", \"%Y-%m-%d %H:%M:%S\")\n                &lt;&lt; \" [\" &lt;&lt; boost::log::expressions::attr&lt; LogLevel_e &gt;(\"Severity\") &lt;&lt; \"]: \"\n                &lt;&lt; boost::phoenix::bind(&amp;format_message, boost::log::expressions::smessage.or_none())\n        )\n    );\n}\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 2246776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OV2MQ.jpg?s=128&g=1", "display_name": "Oren_C", "link": "https://stackoverflow.com/users/2246776/oren-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 56466277, "answer_count": 1, "score": 1, "last_activity_date": 1559820702, "creation_date": 1559734527, "question_id": 56459704, "link": "https://stackoverflow.com/questions/56459704/how-to-prevent-boost-logger-to-add-n-after-each-record", "title": "How to prevent boost logger to add \\n after each record?", "body": "<p>We've refactored our logger to use boost instead of our in-house logger which is not thread-safe. The problem is that all of our log calls around the project (thousands of lines of code) are ending with <code>std::endl</code>. Now, our logger is thread safe but there is an extra empty line between records on the output.\nThis is how I initialize the logger:</p>\n\n<pre><code>void init()\n{\n    boost::log::add_console_log\n    (\n        std::clog,\n        boost::log::keywords::format =\n        (\n                boost::log::expressions::stream &lt;&lt; boost::log::expressions::format_date_time&lt;     boost::posix_time::ptime &gt;(\"TimeStamp\", \"%Y-%m-%d %H:%M:%S\")\n                &lt;&lt; \" [\" &lt;&lt; boost::log::expressions::attr&lt;     LogLevel_e &gt;(\"Severity\") &lt;&lt; \"]: \"\n                &lt;&lt; boost::log::expressions::smessage\n        )\n    );\n}\n</code></pre>\n\n<p>It's a severity_logger_mt() object that is used to log our messages.\nI've read in their documentation that I might be able to prevent that empty line from happening if I create my own backend and frontend. It seems like too much of a hassle to create two modules just to prevent one extra empty line in the code.</p>\n\n<p>Am I missing anything? is there an easier way to do it? Should I add more information to this question?\nAlso, we're talking about boost 1.69.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "edited": false, "score": 0, "creation_date": 1559733264, "post_id": 56459345, "comment_id": 99510250, "body": "<code>Type f()</code> can be written as <code>auto f() -&gt; Type</code>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1559733266, "post_id": 56459345, "comment_id": 99510252, "body": "<code>auto f() -&gt; returnType</code> is trailing return type notation."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1559733566, "post_id": 56459345, "comment_id": 99510400, "body": "Guys. Guys. Guys. ANSWER SECTION OMG!"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1559734506, "post_id": 56459345, "comment_id": 99510806, "body": "&quot;How is it called?&quot; In the sense of  &quot;what is the name of that?&quot; or &quot;how to call the function?&quot; I first understood the latter, but it seems the question is about the first"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559740336, "post_id": 56459345, "comment_id": 99513906, "body": "@LightnessRacesinOrbit Duplicates. Duplicates. Duplicates. Not scattered answers."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1559733550, "creation_date": 1559733550, "answer_id": 56459447, "question_id": 56459345, "link": "https://stackoverflow.com/questions/56459345/how-is-this-kind-of-template-function-called/56459447#56459447", "title": "How is this kind of template function called?", "body": "<p>Consider this function:</p>\n\n<pre><code>void foo()\n{}\n</code></pre>\n\n<p>We can also write it like this:</p>\n\n<pre><code>auto foo() -&gt; void\n{}\n</code></pre>\n\n<p>It's a <em>trailing return type</em>, <a href=\"https://www.ibm.com/developerworks/community/blogs/5894415f-be62-4bc0-81c5-3956e82276f3/entry/introduction_to_the_c_11_feature_trailing_return_types?lang=en\" rel=\"nofollow noreferrer\">introduced in C++11</a>.</p>\n\n<p>In the above example it's completely pointless, but <a href=\"https://stackoverflow.com/q/52123331/560648\">in more complicated scenarios it's useful</a>. Imaging your return type were not <code>void</code>, but something relating to the arguments (<a href=\"https://arne-mertz.de/2016/11/trailing-return-types-everywhere/\" rel=\"nofollow noreferrer\">e.g. <code>decltype(someArgument)</code></a>). Some people just use this form all the time for \"<a href=\"https://stackoverflow.com/q/11215227/560648\">consistency</a>\" (even on <code>main</code>! Ew!)<sup>&dagger;</sup>.</p>\n\n<p>Now follow this logic all the way out to your more complex function template declaration, and that's all you're seeing.</p>\n\n<p><sub><sup>&dagger;</sup> Indeed, it appears to me that this is what the author of your code has done, since it doesn't seem \"necessary\" in your exampe.</sub></p>\n"}], "owner": {"reputation": 309, "user_id": 2160201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fs7x1.jpg?s=128&g=1", "display_name": "Der Appit", "link": "https://stackoverflow.com/users/2160201/der-appit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1559734810, "answer_count": 1, "score": 0, "last_activity_date": 1559733550, "creation_date": 1559733131, "last_edit_date": 1559733214, "question_id": 56459345, "link": "https://stackoverflow.com/questions/56459345/how-is-this-kind-of-template-function-called", "closed_reason": "Duplicate", "title": "How is this kind of template function called?", "body": "<p>Can anyone tell me what kind of template function <code>_Fn()</code> is? And what is the meaning of the <code>-&gt;</code> here?</p>\n\n<pre><code>template &lt;class _Ty0, class _Ty1&gt;\nstruct _Common_type\n{\n  template&lt;class _Uty0, class _Uty1&gt;\n  static auto _Fn(int) -&gt; decay&lt;decltype(false ? declval&lt;_Uty0&gt;() : declval&lt;_Uty1&gt;())&gt;;\n\n  template&lt;class, class&gt;\n  static auto _Fn(_Wrap_int) -&gt; _Nil;\n\n  typedef decltype(_Fn&lt;_Ty0, _Ty1&gt;(0)) type;\n};\n</code></pre>\n"}, {"tags": ["c++", "template-specialization"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 3, "creation_date": 1559732821, "post_id": 56459226, "comment_id": 99510039, "body": "Which C++ version are we talking about? If you can use <code>if constexpr</code> you should be able to write down most of your rules in <code>saturate_cast</code>/<code>type_which_fits</code> very directly."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1559734880, "post_id": 56459226, "comment_id": 99510969, "body": "would it be an option to check before the overflow happens? eg <code>a+b</code> overflows if <code>max - b &gt; a</code> (for positives), then you could avoid switching to the bigger type"}], "answers": [{"tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": true, "score": 7, "last_activity_date": 1590768694, "last_edit_date": 1590768694, "creation_date": 1559740160, "answer_id": 56461176, "question_id": 56459226, "link": "https://stackoverflow.com/questions/56459226/writing-a-saturate-casting-operator-without-listing-all-possible-combinations/56461176#56461176", "title": "Writing a saturate casting operator without listing all possible combinations", "body": "<p>Here's my approach by doing the steps:</p>\n\n<ol>\n<li><p>Find the superior type (the type that would yield if an operation was performed)</p></li>\n<li><p>promote the type to the next type according to your rules 1-4</p></li>\n<li><p>Perform the addition while casting both sides to the promoted type.</p></li>\n</ol>\n\n<hr>\n\n<p>The superior type can be found by following the general rules:</p>\n\n<ul>\n<li><p>floating point + anything -> floating point</p></li>\n<li><p>if left and right have the same bit size choose larger one (unsigned beats signed)</p></li>\n<li><p>else choose where <code>sizeof()</code> yields the largest</p></li>\n</ul>\n\n<p>the last 2 steps can be guaranteed (and simplified) by making a helper struct which returns the larger type (ab)using <code>std::numerical_limits&lt;T&gt;::digits</code> which neatly does exactly what we want (also regarding the signed / unsignedness) since:</p>\n\n<ul>\n<li><p><code>std::numerical_limits&lt;int&gt;::digits</code> -> 31</p></li>\n<li><p><code>std::numerical_limits&lt;unsigned&gt;::digits</code> -> 32</p></li>\n</ul>\n\n<p>This will work for all arithmetic types accordingly.</p>\n\n<pre><code>template&lt;typename T, typename U&gt;\nstruct larger_arithmetic_type {\n    static_assert(std::is_arithmetic_v&lt;T&gt;, \"T must be arithmetic\");\n    static_assert(std::is_arithmetic_v&lt;U&gt;, \"U must be arithmetic\");\n    using type = typename std::conditional_t&lt;(std::numeric_limits&lt;T&gt;::digits &lt; std::numeric_limits&lt;U&gt;::digits), U, T&gt;;\n};\n\ntemplate&lt;typename T, typename U&gt;\nusing larger_arithmetic_type_t = typename larger_arithmetic_type&lt;T, U&gt;::type;\n</code></pre>\n\n<p>With this we can enable a struct <code>arithmetic_superior_type</code> (following said general rules) to find the superior type from integers and/or floating point numbers:</p>\n\n<pre><code>template&lt;typename T, typename U&gt;\nstruct arithmetic_superior_type {\n    using type = typename \n        std::conditional_t&lt;std::is_floating_point_v&lt;T&gt; &amp;&amp; std::is_floating_point_v&lt;U&gt;, larger_arithmetic_type_t&lt;T, U&gt;,\n        std::conditional_t&lt;std::is_floating_point_v&lt;T&gt;, T, \n        std::conditional_t&lt;std::is_floating_point_v&lt;U&gt;, U, \n        larger_arithmetic_type_t&lt;T, U&gt;&gt;&gt;&gt;;\n\n};\n\ntemplate&lt;typename T, typename U&gt;\nusing arithmetic_superior_type_t = typename arithmetic_superior_type&lt;T, U&gt;::type;\n</code></pre>\n\n<p>Therefore <code>arithmetic_seperior_type_t&lt;T, U&gt;</code> returns the type that <code>+</code>, <code>-</code>, <code>*</code> and <code>/</code> between <code>T</code> and <code>U</code> would yield:</p>\n\n<pre><code>arithmetic_superior_type_t&lt;std::int32_t, float&gt; a;          //-&gt; float\narithmetic_superior_type_t&lt;std::uint32_t, std::int32_t&gt; b;  //-&gt; std::uint32_t\narithmetic_superior_type_t&lt;std::uint32_t, std::uint32_t&gt; c; //-&gt; std::uint32_t\narithmetic_superior_type_t&lt;std::uint64_t, std::uint32_t&gt; d; //-&gt; std::uint64_t\narithmetic_superior_type_t&lt;float, double&gt; e;                //-&gt; double\narithmetic_superior_type_t&lt;std::uint16_t, std::int64_t&gt; f;  //-&gt; std::int64_t\n</code></pre>\n\n<hr>\n\n<p>Now as you said, this type alone is not enough. Overflow is possible therefore <code>promote_superior_type</code> is step 2 to receive the promotion of the superior type from <code>T</code> and <code>U</code> - a type which will definetely hold any addition result:</p>\n\n<pre><code>template&lt;typename T, typename U&gt;\nstruct promote_superior_type {\n    using superior_type = arithmetic_superior_type_t&lt;T, U&gt;;\n\n    using type = typename\n        std::conditional_t&lt;(sizeof(T) == 8u || sizeof(U) == 8u), double, \n        std::conditional_t&lt;std::is_floating_point_v&lt;superior_type&gt;, superior_type, \n        std::conditional_t&lt;(std::numeric_limits&lt;superior_type&gt;::digits &lt; std::numeric_limits&lt;std::int16_t&gt;::digits), std::conditional_t&lt;std::is_signed_v&lt;superior_type&gt;, std::int16_t, std::uint16_t&gt;,\n        std::conditional_t&lt;(std::numeric_limits&lt;superior_type&gt;::digits &lt; std::numeric_limits&lt;std::int32_t&gt;::digits), std::conditional_t&lt;std::is_signed_v&lt;superior_type&gt;, std::int32_t, std::uint32_t&gt;,\n        std::conditional_t&lt;(std::numeric_limits&lt;superior_type&gt;::digits &lt; std::numeric_limits&lt;std::int64_t&gt;::digits), std::conditional_t&lt;std::is_signed_v&lt;superior_type&gt;, std::int64_t, std::uint64_t&gt;, double&gt;&gt;&gt;&gt;&gt;;\n};\n\ntemplate&lt;typename T, typename U&gt;\nusing promote_superior_type_t = typename promote_superior_type&lt;T, U&gt;::type;\n</code></pre>\n\n<hr>\n\n<p>Finally the <code>add&lt;T, U&gt;</code> function can be added, step 3:</p>\n\n<pre><code>template&lt;typename T, typename U, typename R = promote_superior_type_t&lt;T, U&gt;&gt;\nconstexpr R add(T a, U b) {\n    return static_cast&lt;R&gt;(a) + static_cast&lt;R&gt;(b);\n}\n</code></pre>\n\n<hr>\n\n<p>That's all that's needed. <code>static_asserting</code> for correct expected output considering every possible type matchup:</p>\n\n<pre><code>//8_t + U\n\nauto add_i8_i8 =  add(std::int8_t(10),  std::int8_t(10));   //i8 + i8 -&gt; i16\nauto add_i8_u8 =  add(std::int8_t(10),  std::uint8_t(10));  //i8 + u8 -&gt; u16\nauto add_u8_u8 =  add(std::uint8_t(10), std::uint8_t(10));  //u8 + u8 -&gt; u16\nauto add_i8_i16 = add(std::int8_t(10),  std::int16_t(10));  //i8 + i16 -&gt; i32\nauto add_i8_u16 = add(std::int8_t(10),  std::uint16_t(10)); //i8 + u16 -&gt; u32\nauto add_u8_u16 = add(std::uint8_t(10), std::uint16_t(10)); //u8 + u16 -&gt; u32\nauto add_i8_i32 = add(std::int8_t(10),  std::int32_t(10));  //i8 + i32 -&gt; i64\nauto add_i8_u32 = add(std::int8_t(10),  std::uint32_t(10)); //i8 + u32 -&gt; u64\nauto add_u8_u32 = add(std::uint8_t(10), std::uint32_t(10)); //u8 + u32 -&gt; u64\nauto add_i8_i64 = add(std::int8_t(10),  std::int64_t(10));  //i8 + i64 -&gt; d64\nauto add_i8_u64 = add(std::int8_t(10),  std::uint64_t(10)); //i8 + u64 -&gt; d64\nauto add_u8_u64 = add(std::uint8_t(10), std::uint64_t(10)); //u8 + u64 -&gt; d64\nauto add_i8_f32 = add(std::int8_t(10),  float(10));         //i8 + f32 -&gt; f32\nauto add_u8_f32 = add(std::uint8_t(10), float(10));         //u8 + f32 -&gt; f32\nauto add_i8_d64 = add(std::int8_t(10),  double(10));        //i8 + d64 -&gt; d64\nauto add_u8_d64 = add(std::uint8_t(10), double(10));        //u8 + d64 -&gt; d64\n\n//16_t + U\n\nauto add_i16_i16 = add(std::int16_t(10),  std::int16_t(10));  //i16 + i16 -&gt; i32\nauto add_i16_u16 = add(std::int16_t(10),  std::uint16_t(10)); //i16 + u16 -&gt; u32\nauto add_u16_u16 = add(std::uint16_t(10), std::uint16_t(10)); //u16 + u16 -&gt; u32\nauto add_i16_i32 = add(std::int16_t(10),  std::int32_t(10));  //i16 + i32 -&gt; i64\nauto add_i16_u32 = add(std::int16_t(10),  std::uint32_t(10)); //i16 + u32 -&gt; u64\nauto add_u16_u32 = add(std::uint16_t(10), std::uint32_t(10)); //u16 + u32 -&gt; u64\nauto add_i16_i64 = add(std::int16_t(10),  std::int64_t(10));  //i16 + i64 -&gt; d64\nauto add_i16_u64 = add(std::int16_t(10),  std::uint64_t(10)); //i16 + u64 -&gt; d64\nauto add_u16_u64 = add(std::uint16_t(10), std::uint64_t(10)); //u16 + u64 -&gt; d64\nauto add_i16_f32 = add(std::int16_t(10),  float(10));         //i16 + f32 -&gt; f32\nauto add_u16_f32 = add(std::uint16_t(10), float(10));         //u16 + f32 -&gt; f32\nauto add_i16_d64 = add(std::int16_t(10),  double(10));        //i16 + d64 -&gt; d64\nauto add_u16_d64 = add(std::uint16_t(10), double(10));        //u16 + d64 -&gt; d64\n\n//32_t + U\n\nauto add_i32_i32 = add(std::int32_t(10),  std::int32_t(10));  //i32 + i32 -&gt; i64\nauto add_i32_u32 = add(std::int32_t(10),  std::uint32_t(10)); //i32 + u32 -&gt; u64\nauto add_u32_u32 = add(std::uint32_t(10), std::uint32_t(10)); //u32 + u32 -&gt; u64\nauto add_i32_i64 = add(std::int32_t(10),  std::int64_t(10));  //i32 + i64 -&gt; d64\nauto add_i32_u64 = add(std::int32_t(10),  std::uint64_t(10)); //i32 + u64 -&gt; d64\nauto add_u32_u64 = add(std::uint32_t(10), std::uint64_t(10)); //u32 + u64 -&gt; d64 \nauto add_i32_f32 = add(std::int32_t(10),  float(10));         //i32 + f32 -&gt; f32\nauto add_u32_f32 = add(std::uint32_t(10), float(10));         //u32 + f32 -&gt; f32\nauto add_i32_d64 = add(std::int32_t(10),  double(10));        //i32 + d64 -&gt; d64\nauto add_u32_d64 = add(std::uint32_t(10), double(10));        //u32 + d64 -&gt; d64\n\n//64_t + U\n\nauto add_i64_i64 = add(std::int64_t(10),  std::int64_t(10));  //i64 + i64 -&gt; d64\nauto add_i64_u64 = add(std::int64_t(10),  std::uint64_t(10)); //i64 + u64 -&gt; d64\nauto add_u64_u64 = add(std::uint64_t(10), std::uint64_t(10)); //u64 + u64 -&gt; d64\nauto add_i64_f32 = add(std::int64_t(10),  float(10));         //i64 + f32 -&gt; d64\nauto add_u64_f32 = add(std::uint64_t(10), float(10));         //u64 + f32 -&gt; d64\nauto add_i64_d64 = add(std::int64_t(10),  double(10));        //i64 + d64 -&gt; d64\nauto add_u64_d64 = add(std::uint64_t(10), double(10));        //u64 + d64 -&gt; d64\n\n\nstatic_assert(std::is_same_v&lt;decltype(add_i8_i8), std::int16_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_u8), std::uint16_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u8_u8), std::uint16_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_i16), std::int32_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_u16), std::uint32_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u8_u16), std::uint32_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_i32), std::int64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_u32), std::uint64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u8_u32), std::uint64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_i64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u8_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u8_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i8_d64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u8_d64), double&gt;, \"\");\n\nstatic_assert(std::is_same_v&lt;decltype(add_i16_i16), std::int32_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_u16), std::uint32_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u16_u16), std::uint32_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_i32), std::int64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_u32), std::uint64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u16_u32), std::uint64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_i64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u16_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u16_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i16_d64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u16_d64), double&gt;, \"\");\n\nstatic_assert(std::is_same_v&lt;decltype(add_i32_i32), std::int64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i32_u32), std::uint64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u32_u32), std::uint64_t&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i32_i64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i32_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u32_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i32_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u32_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i32_d64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u32_d64), double&gt;, \"\");\n\nstatic_assert(std::is_same_v&lt;decltype(add_i64_i64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i64_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u64_u64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i64_f32), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u64_f32), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_i64_d64), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u64_d64), double&gt;, \"\");\n</code></pre>\n\n<hr>\n\n<p>There's one uncertainty: </p>\n\n<pre><code>i64 + f32 -&gt; d64\nu64 + f32 -&gt; d64\n//...\nstatic_assert(std::is_same_v&lt;decltype(add_i64_f32), double&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u64_f32), double&gt;, \"\");\n</code></pre>\n\n<p>according to your rules it could also be:</p>\n\n<pre><code>i64 + f32 -&gt; f32 \nu64 + f32 -&gt; f32 \n//...\nstatic_assert(std::is_same_v&lt;decltype(add_i64_f32), float&gt;, \"\");\nstatic_assert(std::is_same_v&lt;decltype(add_u64_f32), float&gt;, \"\");\n</code></pre>\n\n<hr>\n\n<p>full code:</p>\n\n<pre><code>#include &lt;type_traits&gt;\n#include &lt;limits&gt;\n#include &lt;cstdint&gt;\n\ntemplate&lt;typename T, typename U&gt;\nstruct larger_arithmetic_type {\n    static_assert(std::is_arithmetic_v&lt;T&gt;, \"T must be arithmetic\");\n    static_assert(std::is_arithmetic_v&lt;U&gt;, \"U must be arithmetic\");\n    using type = typename std::conditional_t&lt;(std::numeric_limits&lt;T&gt;::digits &lt; std::numeric_limits&lt;U&gt;::digits), U, T&gt;;\n};\n\ntemplate&lt;typename T, typename U&gt;\nusing larger_arithmetic_type_t = typename larger_arithmetic_type&lt;T, U&gt;::type;\n\ntemplate&lt;typename T, typename U&gt;\nstruct arithmetic_superior_type {\n    using type = typename \n        std::conditional_t&lt;std::is_floating_point_v&lt;T&gt; &amp;&amp; std::is_floating_point_v&lt;U&gt;, larger_arithmetic_type_t&lt;T, U&gt;,\n        std::conditional_t&lt;std::is_floating_point_v&lt;T&gt;, T, \n        std::conditional_t&lt;std::is_floating_point_v&lt;U&gt;, U, \n        larger_arithmetic_type_t&lt;T, U&gt;&gt;&gt;&gt;;\n\n};\n\ntemplate&lt;typename T, typename U&gt;\nusing arithmetic_superior_type_t = typename arithmetic_superior_type&lt;T, U&gt;::type;\n\n\ntemplate&lt;typename T, typename U&gt;\nstruct promote_superior_type {\n    using superior_type = arithmetic_superior_type_t&lt;T, U&gt;;\n\n    using type = typename\n        std::conditional_t&lt;(sizeof(T) == 8u || sizeof(U) == 8u), double, \n        std::conditional_t&lt;std::is_floating_point_v&lt;superior_type&gt;, superior_type, \n        std::conditional_t&lt;(std::numeric_limits&lt;superior_type&gt;::digits &lt; std::numeric_limits&lt;std::int16_t&gt;::digits), std::conditional_t&lt;std::is_signed_v&lt;superior_type&gt;, std::int16_t, std::uint16_t&gt;,\n        std::conditional_t&lt;(std::numeric_limits&lt;superior_type&gt;::digits &lt; std::numeric_limits&lt;std::int32_t&gt;::digits), std::conditional_t&lt;std::is_signed_v&lt;superior_type&gt;, std::int32_t, std::uint32_t&gt;,\n        std::conditional_t&lt;(std::numeric_limits&lt;superior_type&gt;::digits &lt; std::numeric_limits&lt;std::int64_t&gt;::digits), std::conditional_t&lt;std::is_signed_v&lt;superior_type&gt;, std::int64_t, std::uint64_t&gt;, double&gt;&gt;&gt;&gt;&gt;;\n};\n\ntemplate&lt;typename T, typename U&gt;\nusing promote_superior_type_t = typename promote_superior_type&lt;T, U&gt;::type;\n\ntemplate&lt;typename T, typename U, typename R = promote_superior_type_t&lt;T, U&gt;&gt;\nconstexpr R add(T a, U b) {\n    return static_cast&lt;R&gt;(a) + static_cast&lt;R&gt;(b);\n}\n\n\nint main() {\n    arithmetic_superior_type_t&lt;std::int32_t, float&gt; a;          //-&gt; float\n    arithmetic_superior_type_t&lt;std::uint32_t, std::int32_t&gt; b;  //-&gt; std::uint32_t\n    arithmetic_superior_type_t&lt;std::uint32_t, std::uint32_t&gt; c; //-&gt; std::uint32_t\n    arithmetic_superior_type_t&lt;std::uint64_t, std::uint32_t&gt; d; //-&gt; std::uint64_t\n    arithmetic_superior_type_t&lt;float, double&gt; e;                //-&gt; double\n    arithmetic_superior_type_t&lt;std::uint16_t, std::int64_t&gt; f;  //-&gt; std::int64_t\n\n\n    //8_t + U\n\n    auto add_i8_i8 =  add(std::int8_t(10),  std::int8_t(10));   //i8 + i8 -&gt; i16\n    auto add_i8_u8 =  add(std::int8_t(10),  std::uint8_t(10));  //i8 + u8 -&gt; u16\n    auto add_u8_u8 =  add(std::uint8_t(10), std::uint8_t(10));  //u8 + u8 -&gt; u16\n    auto add_i8_i16 = add(std::int8_t(10),  std::int16_t(10));  //i8 + i16 -&gt; i32\n    auto add_i8_u16 = add(std::int8_t(10),  std::uint16_t(10)); //i8 + u16 -&gt; u32\n    auto add_u8_u16 = add(std::uint8_t(10), std::uint16_t(10)); //u8 + u16 -&gt; u32\n    auto add_i8_i32 = add(std::int8_t(10),  std::int32_t(10));  //i8 + i32 -&gt; i64\n    auto add_i8_u32 = add(std::int8_t(10),  std::uint32_t(10)); //i8 + u32 -&gt; u64\n    auto add_u8_u32 = add(std::uint8_t(10), std::uint32_t(10)); //u8 + u32 -&gt; u64\n    auto add_i8_i64 = add(std::int8_t(10),  std::int64_t(10));  //i8 + i64 -&gt; d64\n    auto add_i8_u64 = add(std::int8_t(10),  std::uint64_t(10)); //i8 + u64 -&gt; d64\n    auto add_u8_u64 = add(std::uint8_t(10), std::uint64_t(10)); //u8 + u64 -&gt; d64\n    auto add_i8_f32 = add(std::int8_t(10),  float(10));         //i8 + f32 -&gt; f32\n    auto add_u8_f32 = add(std::uint8_t(10), float(10));         //u8 + f32 -&gt; f32\n    auto add_i8_d64 = add(std::int8_t(10),  double(10));        //i8 + d64 -&gt; d64\n    auto add_u8_d64 = add(std::uint8_t(10), double(10));        //u8 + d64 -&gt; d64\n\n    //16_t + U\n\n    auto add_i16_i16 = add(std::int16_t(10),  std::int16_t(10));  //i16 + i16 -&gt; i32\n    auto add_i16_u16 = add(std::int16_t(10),  std::uint16_t(10)); //i16 + u16 -&gt; u32\n    auto add_u16_u16 = add(std::uint16_t(10), std::uint16_t(10)); //u16 + u16 -&gt; u32\n    auto add_i16_i32 = add(std::int16_t(10),  std::int32_t(10));  //i16 + i32 -&gt; i64\n    auto add_i16_u32 = add(std::int16_t(10),  std::uint32_t(10)); //i16 + u32 -&gt; u64\n    auto add_u16_u32 = add(std::uint16_t(10), std::uint32_t(10)); //u16 + u32 -&gt; u64\n    auto add_i16_i64 = add(std::int16_t(10),  std::int64_t(10));  //i16 + i64 -&gt; d64\n    auto add_i16_u64 = add(std::int16_t(10),  std::uint64_t(10)); //i16 + u64 -&gt; d64\n    auto add_u16_u64 = add(std::uint16_t(10), std::uint64_t(10)); //u16 + u64 -&gt; d64\n    auto add_i16_f32 = add(std::int16_t(10),  float(10));         //i16 + f32 -&gt; f32\n    auto add_u16_f32 = add(std::uint16_t(10), float(10));         //u16 + f32 -&gt; f32\n    auto add_i16_d64 = add(std::int16_t(10),  double(10));        //i16 + d64 -&gt; d64\n    auto add_u16_d64 = add(std::uint16_t(10), double(10));        //u16 + d64 -&gt; d64\n\n    //32_t + U\n\n    auto add_i32_i32 = add(std::int32_t(10),  std::int32_t(10));  //i32 + i32 -&gt; i64\n    auto add_i32_u32 = add(std::int32_t(10),  std::uint32_t(10)); //i32 + u32 -&gt; u64\n    auto add_u32_u32 = add(std::uint32_t(10), std::uint32_t(10)); //u32 + u32 -&gt; u64\n    auto add_i32_i64 = add(std::int32_t(10),  std::int64_t(10));  //i32 + i64 -&gt; d64\n    auto add_i32_u64 = add(std::int32_t(10),  std::uint64_t(10)); //i32 + u64 -&gt; d64\n    auto add_u32_u64 = add(std::uint32_t(10), std::uint64_t(10)); //u32 + u64 -&gt; d64 \n    auto add_i32_f32 = add(std::int32_t(10),  float(10));         //i32 + f32 -&gt; f32\n    auto add_u32_f32 = add(std::uint32_t(10), float(10));         //u32 + f32 -&gt; f32\n    auto add_i32_d64 = add(std::int32_t(10),  double(10));        //i32 + d64 -&gt; d64\n    auto add_u32_d64 = add(std::uint32_t(10), double(10));        //u32 + d64 -&gt; d64\n\n    //64_t + U\n\n    auto add_i64_i64 = add(std::int64_t(10),  std::int64_t(10));  //i64 + i64 -&gt; d64\n    auto add_i64_u64 = add(std::int64_t(10),  std::uint64_t(10)); //i64 + u64 -&gt; d64\n    auto add_u64_u64 = add(std::uint64_t(10), std::uint64_t(10)); //u64 + u64 -&gt; d64\n    auto add_i64_f32 = add(std::int64_t(10),  float(10));         //i64 + f32 -&gt; d64\n    auto add_u64_f32 = add(std::uint64_t(10), float(10));         //u64 + f32 -&gt; d64\n    auto add_i64_d64 = add(std::int64_t(10),  double(10));        //i64 + d64 -&gt; d64\n    auto add_u64_d64 = add(std::uint64_t(10), double(10));        //u64 + d64 -&gt; d64\n\n\n    static_assert(std::is_same_v&lt;decltype(add_i8_i8), std::int16_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_u8), std::uint16_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u8_u8), std::uint16_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_i16), std::int32_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_u16), std::uint32_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u8_u16), std::uint32_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_i32), std::int64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_u32), std::uint64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u8_u32), std::uint64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_i64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u8_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_f32), float&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u8_f32), float&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i8_d64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u8_d64), double&gt;, \"\");\n\n    static_assert(std::is_same_v&lt;decltype(add_i16_i16), std::int32_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_u16), std::uint32_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u16_u16), std::uint32_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_i32), std::int64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_u32), std::uint64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u16_u32), std::uint64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_i64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u16_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_f32), float&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u16_f32), float&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i16_d64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u16_d64), double&gt;, \"\");\n\n    static_assert(std::is_same_v&lt;decltype(add_i32_i32), std::int64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i32_u32), std::uint64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u32_u32), std::uint64_t&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i32_i64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i32_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u32_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i32_f32), float&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u32_f32), float&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i32_d64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u32_d64), double&gt;, \"\");\n\n    static_assert(std::is_same_v&lt;decltype(add_i64_i64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i64_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u64_u64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i64_f32), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u64_f32), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_i64_d64), double&gt;, \"\");\n    static_assert(std::is_same_v&lt;decltype(add_u64_d64), double&gt;, \"\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 2, "accepted_answer_id": 56461176, "answer_count": 1, "score": 9, "last_activity_date": 1590768694, "creation_date": 1559732669, "question_id": 56459226, "link": "https://stackoverflow.com/questions/56459226/writing-a-saturate-casting-operator-without-listing-all-possible-combinations", "title": "Writing a saturate casting operator without listing all possible combinations", "body": "<p>I'd like to create templated operations between different types (suppose this is the list: int8_t, int16_t, int32_t, int64_t, uint8_t, uint16_t, uint32_t, uint64_t, float, double). </p>\n\n<p>Then I'd like to allow for a <code>saturate_cast&lt;&gt;()</code> function to take the input value, check if it's within the output type limits and saturate to those limits if needed. </p>\n\n<p>The problem is that if I'm summing two <code>int32_t</code>, the default C++ operation has undefined behavior in case of overflow, so I would like to promote the operation to <code>int64_t</code> and use that type to perform the operation.</p>\n\n<p>A tentative solution could be:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;cstdint&gt;\n#include &lt;limits&gt;\n\ntemplate&lt;typename T1, typename T2&gt; struct type_which_fits { using type = decltype(T1() + T2()); };\ntemplate&lt;&gt; struct type_which_fits&lt;int32_t, int32_t&gt; { using type = int64_t; };\n\ntemplate&lt;typename T1, typename T2&gt;\nauto TAdd(T1 lhs, T2 rhs) {\n    using type = typename type_which_fits&lt;T1, T2&gt;::type;\n    return static_cast&lt;type&gt;(lhs) + static_cast&lt;type&gt;(rhs);\n}\n\ntemplate&lt;typename ODT, typename IDT&gt;\nODT saturate_cast(const IDT&amp; v) {\n    if (v &gt; std::numeric_limits&lt;ODT&gt;::max()) {\n        return std::numeric_limits&lt;ODT&gt;::max();\n    }\n    if (v &lt; std::numeric_limits&lt;ODT&gt;::min()) {\n        return std::numeric_limits&lt;ODT&gt;::min();\n    }\n\n    return static_cast&lt;ODT&gt;(v);\n}\n\nint main()\n{\n    auto x = saturate_cast&lt;int8_t&gt;(TAdd(1, 1u));\n    return 0;\n}\n</code></pre>\n\n<p>Unfortunately, in this way I need to further specify all possible combinations of types, and I would just need these rules (to be verified in the given order):</p>\n\n<ul>\n<li>if one of the types is floating point use the default promotions</li>\n<li>if one of the types is 64 bits, promote to double</li>\n<li>if one of the types is 32 bit, promote to 64 bits</li>\n<li>otherwise use the default promotions</li>\n</ul>\n\n<p>Moreover in the <code>saturate_cast&lt;&gt;()</code> a bunch of signed/unsigned warnings pop up, when the two types have not the same \"signedness\".</p>\n\n<p>Again this can be solved by specializing on all possible combinations, but somehow it feels \"wrong\". </p>\n\n<p>Can you suggest a solution to make this more flexible, the moment I'll need more types?</p>\n"}, {"tags": ["c++", "queue", "binary-tree"], "comments": [{"owner": {"reputation": 1116, "user_id": 782874, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/14d35d839630fac64bd077791f575658?s=128&d=identicon&r=PG", "display_name": "StinkyCat", "link": "https://stackoverflow.com/users/782874/stinkycat"}, "edited": false, "score": 1, "creation_date": 1559733724, "post_id": 56459174, "comment_id": 99510477, "body": "Did you debug the code before making this question?"}, {"owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "reply_to_user": {"reputation": 1116, "user_id": 782874, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/14d35d839630fac64bd077791f575658?s=128&d=identicon&r=PG", "display_name": "StinkyCat", "link": "https://stackoverflow.com/users/782874/stinkycat"}, "edited": false, "score": 0, "creation_date": 1559734886, "post_id": 56459174, "comment_id": 99510975, "body": "yes I did.There is some bug in levelOrder function."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "edited": false, "score": 0, "creation_date": 1559737796, "post_id": 56460227, "comment_id": 99512394, "body": "Thanks @molbdnilo for finding the bug and also for improving the code."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 2, "last_activity_date": 1559736609, "creation_date": 1559736609, "answer_id": 56460227, "question_id": 56459174, "link": "https://stackoverflow.com/questions/56459174/i-cant-figure-out-the-reason-for-abnormal-termination-while-executing-levelorde/56460227#56460227", "title": "I can&#39;t figure out the reason for abnormal termination while executing levelOrder function?", "body": "<p>After you have popped the last element from the queue, you <code>q.peek()-&gt;data</code> on the next iteration, when <code>q.peek()</code> is not a valid pointer.</p>\n\n<p>Change your termination condition:</p>\n\n<pre><code>while (q.peek())\n{\n    cout&lt;&lt;q.peek()-&gt;data&lt;&lt;\" \"&lt;&lt; endl;;\n\n    if(q.peek()-&gt;left!=NULL)\n        q.add(q.peek()-&gt;left);\n\n    if(q.peek()-&gt;right!=NULL)\n        q.add(q.peek()-&gt;right);\n\n    q.pop();\n}\n</code></pre>\n\n<p>On a side note, this is one situation where a \"loop-local\" variable can improve readability - all those <code>peek</code>s add clutter:</p>\n\n<pre><code>while(Node *next = q.pop())\n{\n    cout&lt;&lt;next-&gt;data&lt;&lt;\" \"&lt;&lt; endl;;\n\n    if(next-&gt;left != nullptr)\n        q.add(next-&gt;left);\n\n    if(next-&gt;right != nullptr)\n        q.add(next-&gt;right);\n}\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 8234870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa94b5af8b4585d838685b291e550607?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Parzival", "link": "https://stackoverflow.com/users/8234870/dev-parzival"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56460227, "answer_count": 1, "score": -1, "last_activity_date": 1559736609, "creation_date": 1559732458, "question_id": 56459174, "link": "https://stackoverflow.com/questions/56459174/i-cant-figure-out-the-reason-for-abnormal-termination-while-executing-levelorde", "title": "I can&#39;t figure out the reason for abnormal termination while executing levelOrder function?", "body": "<p>This code is for Implementing binary tree.\nIt consist of insertNode(function which inserts node in the tree) and levelOrder(function which traverse the binary tree at level order).</p>\n\n<p>insertNode function works fine but while executing levelOrder it successfully displays the data but after that it stops working and displays program has stopped working.</p>\n\n<p>I can't find where i am going wrong?\nThanks in advance{ : )</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nstruct Node\n{\n    Node *left;\n    Node *right;\n    int data;\n}*root;\n\nstruct Queue\n{\n\n    Node *p[1000];\n    int index=-1;\n\n    Node *add(Node *ptr)\n    {\n        p[++index]=ptr;\n        return ptr;\n    }\n    Node *peek()\n    {\n        if(index==-1)\n            return NULL;\n\n        return p[0];    \n    }\n    Node *pop()\n    {\n        if(index==-1)\n            return NULL;\n\n        Node *temp=p[0];\n\n        for(int i=0;i&lt;index;i++)\n            p[i]=p[i+1];\n\n        index--;\n\n        return temp;\n\n    }\n};\n\nNode * createNode(int data)\n{\n    Node *p=new Node();\n    p-&gt;data=data;\n    p-&gt;left=p-&gt;right=NULL;\n\n    return p;\n}\n\n///////Insertion Of Node////////\n\nint insertNode(int val)\n{\n    if(root==NULL)\n    {\n        root=createNode(val);\n        return val;\n    }\n\n    bool found=false;\n    Node *p;\n\n    Queue q;\n    q.add(root);\n    while(found==false)\n    {\n        Node *l=(q.peek())-&gt;left;\n        Node *r=(q.peek())-&gt;right;\n\n        if(l==NULL)\n        {\n            (q.peek())-&gt;left=createNode(val);\n            found=true;\n            return val;\n        }\n        else\n            q.add(l);\n\n        if(r==NULL)\n        {\n            q.peek()-&gt;right=createNode(val);\n            found=true;\n            return val;\n        }\n        else\n            q.add(r);\n\n\n        q.pop();\n\n    }\n        return val;\n\n}\n/////////Traversal's///////////\nvoid levelOrder(Node *p)\n{\n    if(p==NULL)\n        return;\n\n    Queue q;\n    q.add(p);\n\n    while(true)\n    {\n        cout&lt;&lt;q.peek()-&gt;data&lt;&lt;\" \";\n\n        if(q.peek()-&gt;left!=NULL)\n            q.add(q.peek()-&gt;left);\n\n        if(q.peek()-&gt;right!=NULL)\n            q.add(q.peek()-&gt;right);\n\n        if(q.pop()==NULL)\n            return;\n    }\n\n}\n\n\nint main()\n{\n    root=NULL;\n\n    insertNode(1);\n    insertNode(2);\n    insertNode(3);\n    insertNode(4);\n\n    levelOrder(root);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "drag-and-drop", "qlabel"], "comments": [{"owner": {"reputation": 5378, "user_id": 2110683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33179a1918a5d90f47cde062fab10ff4?s=128&d=identicon&r=PG", "display_name": "Dimitry Ernot", "link": "https://stackoverflow.com/users/2110683/dimitry-ernot"}, "edited": false, "score": 0, "creation_date": 1559741066, "post_id": 56459049, "comment_id": 99514306, "body": "Could you provide a minimal and complete example?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9549783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6f3c370591315436c18ab3c49656c6?s=128&d=identicon&r=PG&f=1", "display_name": "ConnorDWP", "link": "https://stackoverflow.com/users/9549783/connordwp"}, "edited": false, "score": 0, "creation_date": 1560346400, "post_id": 56461576, "comment_id": 99706442, "body": "Thank you, this was exactly what i was looking for."}], "tags": [], "owner": {"reputation": 11, "user_id": 8998012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa56131650d6d4e2404485a6fccbecc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Z", "link": "https://stackoverflow.com/users/8998012/mike-z"}, "is_accepted": false, "score": 0, "last_activity_date": 1559743864, "last_edit_date": 1559743864, "creation_date": 1559741658, "answer_id": 56461576, "question_id": 56459049, "link": "https://stackoverflow.com/questions/56459049/qt-drag-and-drop-works-in-window-can-i-make-it-so-i-can-only-drop-into-a-qlabel/56461576#56461576", "title": "Qt Drag and Drop works in window. Can i make it so i can only drop into a Qlabel and not the entire window?", "body": "<p>The best way to do this is to override the <code>QLabel</code> class. In the <code>dragEnterEvent</code> be sure to call <code>acceptProposedAction</code> to process the move and leave events. If you don't do that, only the <code>dragEnter</code> event will fire.</p>\n\n<p>Sample code follows. To use this in your project, add the source to your project and then right click on the label on the form and promote the item to <code>QLabelDragDrop</code>.</p>\n\n<pre><code>#ifndef QLABELDRAGDROP_H\n#define QLABELDRAGDROP_H\n\n#include &lt;QLabel&gt;\n\nclass QLabelDragDrop : public QLabel\n{\n    Q_OBJECT\npublic:\n    explicit QLabelDragDrop(QWidget *parent = nullptr);\nprotected:\n    void dragEnterEvent(QDragEnterEvent *event);\n    void dragLeaveEvent(QDragLeaveEvent *event);\n    void dragMoveEvent(QDragMoveEvent *event);\n\nsignals:\n\npublic slots:\n};\n\n#endif // QLABELDRAGDROP_H\n</code></pre>\n\n<pre><code>#include \"qlabeldragdrop.h\"\n#include &lt;QDebug&gt;\n#include &lt;QDragEnterEvent&gt;\n#include &lt;QDropEvent&gt;\n\nQLabelDragDrop::QLabelDragDrop(QWidget *parent) : QLabel(parent)\n{\n    setAcceptDrops(true);\n    setMouseTracking(true);\n}\n\nvoid QLabelDragDrop::dragEnterEvent(QDragEnterEvent *event)\n{\n    qDebug() &lt;&lt; \"dragEnterEvent\";\n    event-&gt;acceptProposedAction();\n}\n\nvoid QLabelDragDrop::dragLeaveEvent(QDragLeaveEvent *event)\n{\n    qDebug() &lt;&lt; \"dragLeaveEvent\";\n    releaseMouse();\n}\n\nvoid QLabelDragDrop::dragMoveEvent(QDragMoveEvent *event)\n{\n    qDebug() &lt;&lt; \"dragMoveEvent\";\n}\n\nvoid QLabelDragDrop::dropEvent(QDropEvent *event)\n{\n    qDebug() &lt;&lt; \"dropEvent\";\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9549783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6f3c370591315436c18ab3c49656c6?s=128&d=identicon&r=PG&f=1", "display_name": "ConnorDWP", "link": "https://stackoverflow.com/users/9549783/connordwp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559743864, "creation_date": 1559731946, "last_edit_date": 1559741040, "question_id": 56459049, "link": "https://stackoverflow.com/questions/56459049/qt-drag-and-drop-works-in-window-can-i-make-it-so-i-can-only-drop-into-a-qlabel", "title": "Qt Drag and Drop works in window. Can i make it so i can only drop into a Qlabel and not the entire window?", "body": "<p>Using Qt to create an application that accepts a file drop. I have an area on my UI that I want to drop the file into, using a <code>Qlabel</code>. I have the function of dragging and dropping the file into the UI working, however I can drop it anywhere on the window, and not just into the <code>Qlabel</code> area.</p>\n\n<p>I thought using</p>\n\n<pre><code>ui-&gt;label_drag-&gt;setAcceptDrops(true);\n</code></pre>\n\n<p>would work, however this just removed the functionality all together. What is the best way of handling this? if possible at all.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "templates", "std-function", "stdlist"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1559731934, "post_id": 56459006, "comment_id": 99509648, "body": "Try simply <code>f();</code> to call the function."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1559732756, "post_id": 56459006, "comment_id": 99510007, "body": "What do you mean by &quot;I cannot&quot;? What is the problem, exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 1, "creation_date": 1559732464, "post_id": 56459060, "comment_id": 99509871, "body": "Nitpick: <code>movements</code> has one parameter, so would be called <code>movements(something)</code>"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1559732628, "last_edit_date": 1559732628, "creation_date": 1559731987, "answer_id": 56459060, "question_id": 56459006, "link": "https://stackoverflow.com/questions/56459006/how-can-i-access-stdfunction-in-stdlist-in-c/56459060#56459060", "title": "How can I access std::function in std::list in C++", "body": "<p>Two things (that I think are what you're asking about):</p>\n\n<ol>\n<li><p>The symbol <code>movements</code> is a <em>function</em> that you need to call. You do it by the usual <code>movements(pices)</code>.</p></li>\n<li><p>The function objects in the list that the function returns are not pointers that can be dereferenced. You use them as normal functions and call them as such, like <code>f(pieces)</code>.</p></li>\n</ol>\n\n<p>Also, in C++ there's no standard \"array-list\" like container. A list is a list and can't be indexed like an array or a vector.</p>\n"}], "owner": {"reputation": 79, "user_id": 11600212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYMN7.jpg?s=128&g=1", "display_name": "Julie Nielsen", "link": "https://stackoverflow.com/users/11600212/julie-nielsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 56459060, "answer_count": 1, "score": -1, "last_activity_date": 1559732628, "creation_date": 1559731806, "question_id": 56459006, "link": "https://stackoverflow.com/questions/56459006/how-can-i-access-stdfunction-in-stdlist-in-c", "title": "How can I access std::function in std::list in C++", "body": "<p>I am attempting to answer generate a Template function in C++ which takes in an std::list of std::function (I think). I am however not sure how to understand the datatype I am working with. </p>\n\n<p>According to GDB my datatype is:</p>\n\n<pre><code>type = std::__cxx11::list&lt;std::function&lt;void(std::array&lt;positions, 3&gt;&amp;)&gt;, std::allocator&lt;std::function&lt;void(std::array&lt;positions, 3&gt;&amp;)&gt; &gt; &gt; (*)(const std::array&lt;positions, 3&gt; &amp;)\n</code></pre>\n\n<p>I can not access the element as an array if I call the input <code>movenents</code> I can not access for example the first element as <code>movement[0]</code> I don't understand why that is since the type looks like a list.</p>\n\n<p>I have tried to access it as an array, and I have tried to read <a href=\"https://stackoverflow.com/questions/19734818/stdlist-containing-stdfunction\">std::list containing std::function</a> and access it with:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for (auto f: movements) {\n        (*f)();\n    }\n</code></pre>\n\n<p>The function generating the the list looks like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>auto movements(const pieces_positions &amp;pieces) {\n    auto result = std::list&lt;std::function&lt;void(pieces_positions&amp;)&gt;&gt;{};\n    for (auto i=0u; i&lt;pieces.size(); ++i)\n        switch(pieces[i]) {\n            case positions::pos1:\n                result.push_back([i](pieces_positions&amp; pieces){ pieces[i] = positions::pos2; });\n                break;\n            case positions::pos2:\n                result.push_back([i](pieces_positions&amp; pieces){ pieces[i] = positions::pos1; });\n                result.push_back([i](pieces_positions&amp; pieces){ pieces[i] = positions::pos3; });\n                break;\n            case positions::pos3:\n                result.push_back([i](pieces_positions&amp; pieces){ pieces[i] = positions::pos2; });\n                break;\n        }\n    return result;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "machine-learning", "lightgbm"], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 10743932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a54f6219a0f6e2cf20e7bf9852029d?s=128&d=identicon&r=PG&f=1", "display_name": "EuRBamarth", "link": "https://stackoverflow.com/users/10743932/eurbamarth"}, "edited": false, "score": 0, "creation_date": 1559899379, "post_id": 56479228, "comment_id": 99571952, "body": "Thanks! It took me a bit to get to grips with the CLI version, but I&#39;ve written out a complete example solution below"}], "tags": [], "owner": {"reputation": 870, "user_id": 6077035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962162a728a427c364484738150827b4?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Mutel", "link": "https://stackoverflow.com/users/6077035/florian-mutel"}, "is_accepted": true, "score": 2, "last_activity_date": 1559829711, "creation_date": 1559829711, "answer_id": 56479228, "question_id": 56458987, "link": "https://stackoverflow.com/questions/56458987/save-lgbm-model-in-cpp-format-from-python/56479228#56479228", "title": "Save LGBM model in `.cpp` format from Python", "body": "<p>In the doc they say:</p>\n\n<blockquote>\n  <p>Note: can be used only in CLI version</p>\n</blockquote>\n\n<p>under the <em>convert_model</em> and <em>convert_model_language</em> parameters.</p>\n\n<p>That means that you should probably use the CLI (Command Line Interfarce) of LGBM instead of the python wrapper to do this.</p>\n\n<p><a href=\"https://lightgbm.readthedocs.io/en/latest/Quick-Start.html\" rel=\"nofollow noreferrer\">Link</a> to Quick Start CLI version.</p>\n"}, {"comments": [{"owner": {"reputation": 227, "user_id": 2116957, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qT3OD.png?s=128&g=1", "display_name": "peace_within_reach", "link": "https://stackoverflow.com/users/2116957/peace-within-reach"}, "edited": false, "score": 0, "creation_date": 1613247766, "post_id": 56491533, "comment_id": 117019107, "body": "How do you actually use the result? I can&#39;t compile the resulting file. What includes does it need?"}], "tags": [], "owner": {"reputation": 554, "user_id": 10743932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a54f6219a0f6e2cf20e7bf9852029d?s=128&d=identicon&r=PG&f=1", "display_name": "EuRBamarth", "link": "https://stackoverflow.com/users/10743932/eurbamarth"}, "is_accepted": false, "score": 4, "last_activity_date": 1559899294, "creation_date": 1559899294, "answer_id": 56491533, "question_id": 56458987, "link": "https://stackoverflow.com/questions/56458987/save-lgbm-model-in-cpp-format-from-python/56491533#56491533", "title": "Save LGBM model in `.cpp` format from Python", "body": "<p>Here's a real 'for dummies' answer:</p>\n\n<ol>\n<li><p>Install the CLI version of lightgbm: <a href=\"https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html\" rel=\"nofollow noreferrer\">https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html</a></p></li>\n<li><p>Make note of your installation path, and find the executable. For example, for me, this was <code>~/LightGBM/lightgbm</code>.</p></li>\n<li><p>Run the following in a Jupyter notebook:</p></li>\n</ol>\n\n<pre><code>from sklearn.datasets import load_breast_cancer\nimport pandas as pd\n\nbreast_cancer = load_breast_cancer()\ndata = pd.DataFrame(breast_cancer.data)\ntarget = pd.DataFrame(breast_cancer.target)\n\npd.concat([target, data], axis=1).to_csv(\"regression.train\", header=False, index=False)\n\ntrain_conf = \"\"\"\ntask = train\nobjective = binary\nmetric = auc\ndata = regression.train\noutput_model = trained_model.txt\n\"\"\"\n\nwith open(\"train.conf\", \"w\") as f:\n    f.write(train_conf)\n\nconf_convert = \"\"\"\ntask = convert_model\ninput_model= trained_model.txt\n\"\"\"\n\nwith open(\"convert.conf\", \"w\") as f:\n    f.write(conf_convert)\n</code></pre>\n\n<pre><code>! ~/LightGBM/lightgbm config=train.conf\n</code></pre>\n\n<pre><code>! ~/LightGBM/lightgbm config=convert.conf\n</code></pre>\n\n<p>Your model with be saved in your current directory.</p>\n"}], "owner": {"reputation": 554, "user_id": 10743932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a54f6219a0f6e2cf20e7bf9852029d?s=128&d=identicon&r=PG&f=1", "display_name": "EuRBamarth", "link": "https://stackoverflow.com/users/10743932/eurbamarth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 1, "accepted_answer_id": 56479228, "answer_count": 2, "score": 0, "last_activity_date": 1559899294, "creation_date": 1559731717, "question_id": 56458987, "link": "https://stackoverflow.com/questions/56458987/save-lgbm-model-in-cpp-format-from-python", "title": "Save LGBM model in `.cpp` format from Python", "body": "<p>If I run</p>\n\n<pre><code>from sklearn.datasets import load_breast_cancer\nimport lightgbm as lgb\n\nbreast_cancer = load_breast_cancer()\ndata = breast_cancer.data\ntarget = breast_cancer.target\n\nparams = {\n    \"task\": \"convert_model\",\n    \"convert_model_language\": \"cpp\",\n    \"convert_model\": \"test.cpp\",\n}\n\ngbm = lgb.train(params, lgb.Dataset(data, target))\n</code></pre>\n\n<p>then I was expecting that a file called <code>test.cpp</code> would be created, with the model saved in c++ format.</p>\n\n<p>However, nothing appears in my current directory.</p>\n\n<p>I have read the documentation (<a href=\"https://lightgbm.readthedocs.io/en/latest/Parameters.html#io-parameters\" rel=\"nofollow noreferrer\">https://lightgbm.readthedocs.io/en/latest/Parameters.html#io-parameters</a>), but can't tell what I'm doing wrong.</p>\n"}, {"tags": ["c++", "clang"], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 0, "creation_date": 1559756257, "post_id": 56462017, "comment_id": 99522395, "body": "By the way, I believe you forgot to <code>return true</code> at the end of the <code>VisitVarDecl</code> function."}, {"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "reply_to_user": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 1, "creation_date": 1559763202, "post_id": 56462017, "comment_id": 99525210, "body": "@rkioji oh, yes. I forgot to copy it... <i>whoops</i> :) I&#39;m glad it helped"}, {"owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 0, "creation_date": 1559881184, "post_id": 56462017, "comment_id": 99565220, "body": "There is an specific case that fails casting to <code>TemplateSpecializationTypeLoc</code>. This happens when we explicit the namespace behind the type (e.g.: <code>std::vector</code>) rather than (<code>vector</code>) if we had previously stated <code>using namespace</code>. I updated my question with the troublesome test case. Do you have any starting point which I can look for?"}, {"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "reply_to_user": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 1, "creation_date": 1559900741, "post_id": 56462017, "comment_id": 99572641, "body": "I didn&#39;t check it in actual code, but I expect to find an <code>ElaboratedTypeLoc</code> wrapper around <code>TemplateSpecializationTypeLoc</code> in your code snippet."}, {"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "reply_to_user": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "edited": false, "score": 1, "creation_date": 1560032426, "post_id": 56462017, "comment_id": 99608047, "body": "I have updated the answer to work in the most generic case. I hope it helps!"}], "tags": [], "owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1560034219, "last_edit_date": 1560034219, "creation_date": 1559743086, "answer_id": 56462017, "question_id": 56458731, "link": "https://stackoverflow.com/questions/56458731/clangtool-how-to-get-location-of-template-parameters-in-variable-declaration/56462017#56462017", "title": "ClangTool how to get location of template parameters in variable declaration?", "body": "<p>The first attempt was the closest to what you need. The node you are looking for is <code>VarDecl</code> and it's type location. <code>VarTemplateSpecializationDecl</code> is a variable template (<a href=\"https://en.cppreference.com/w/cpp/language/variable_template\" rel=\"nofollow noreferrer\">C++14 feature</a>) specialization.</p>\n\n<blockquote>\n  <p>Represents a variable template specialization, which refers to\n  a variable template with a given set of template arguments.</p>\n  \n  <p>Variable template specializations represent both explicit\n  specializations of variable templates, as in the example below, and\n  implicit instantiations of variable templates.</p>\n</blockquote>\n\n<p>Clang makes a distinction between types and type locations. <strong>Type</strong> is more of an abstract entity, while <strong>TypeLoc</strong> represents an actual entrance of a type in the source code. When you write type <code>A</code> in your code many times, it's all different <strong>TypeLoc</strong>s, but the same <strong>Type</strong>.</p>\n\n<p>Here is an example of how to get <strong>TypeLoc</strong> for your declaration:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool VisitVarDecl(clang::VarDecl *Decl) {\n  auto DeclarationTypeLoc = Decl-&gt;getTypeSourceInfo()-&gt;getTypeLoc();\n\n  if (auto Specialization =\n          DeclarationTypeLoc.getAs&lt;clang::TemplateSpecializationTypeLoc&gt;()) {\n\n    for (auto i : llvm::seq&lt;unsigned&gt;(0, Specialization.getNumArgs())) {\n      auto ArgumentLoc = Specialization.getArgLoc(i);\n      auto &amp;SM = Context.getSourceManager();\n      llvm::errs() &lt;&lt; ArgumentLoc.getLocation().printToString(SM) &lt;&lt; \"\\n\";\n    }\n  }\n  return true;\n}\n</code></pre>\n\n<p>Running this code on the following snippet</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// main.cpp\n\ntemplate &lt;class T, class U&gt; class TemplateType {};\n\nclass ABC {};\nclass XYZ {};\n\nint main() {\n  TemplateType&lt;ABC, XYZ&gt; Decl;\n  return 0;\n}\n</code></pre>\n\n<p>produces this result:</p>\n\n<pre><code>.../main.cpp:9:16\n.../main.cpp:9:21\n</code></pre>\n\n<p><strong>NOTE 1</strong>: depending on the version of Clang you might use not <code>Decl-&gt;getTypeSourceInfo()-&gt;getTypeLoc()</code>, but <code>Decl-&gt;getTypeLoc()</code>.</p>\n\n<p><strong>NOTE 2</strong>: small tip - don't make visitor functions virtual. Clang's visitors are <a href=\"https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern\" rel=\"nofollow noreferrer\">CRTP</a>.</p>\n\n<hr>\n\n<h2>UPDATE 1</h2>\n\n<p>For the updated test snippet, <strong>TypeLoc</strong> of the declaration is not exactly <strong>TemplateSpecializationTypeLoc</strong>, but a wrapper around it. Getting to it manually can be troublesome and error-prone, so it's better to implement it in terms of Clang's traversers.</p>\n\n<p>Here is the updated code (please, note that <strong>SpecificationArgumentVisitor</strong> is a nested class <em>inside</em> of your main visitor):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class SpecificationArgumentVisitor\n    : public clang::RecursiveASTVisitor&lt;SpecificationArgumentVisitor&gt; {\npublic:\n  SpecificationArgumentVisitor(clang::ASTContext &amp;Context)\n      : SM(Context.getSourceManager()) {}\n\n  bool VisitTemplateSpecializationTypeLoc(\n      clang::TemplateSpecializationTypeLoc Specialization) {\n    for (auto i : llvm::seq&lt;unsigned&gt;(0, Specialization.getNumArgs())) {\n      auto ArgumentLoc = Specialization.getArgLoc(i);\n      llvm::errs() &lt;&lt; ArgumentLoc.getLocation().printToString(SM) &lt;&lt; \"\\n\";\n    }\n    return true;\n  }\n\nprivate:\n  SourceManager &amp;SM;\n};\n\nbool VisitVarDecl(clang::VarDecl *Decl) {\n  SpecificationArgumentVisitor ArgumentVisitor(Context);\n  ArgumentVisitor.TraverseDecl(Decl);\n  return true;\n}\n</code></pre>\n\n<p>For the new test snippet:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// main.cpp\n\nnamespace FOO {\nclass ABC {};\nclass XYZ {};\n\ntemplate &lt;class T, class U&gt; class TemplateType {};\n} // namespace FOO\n\nusing namespace FOO;\n\nint main() {\n  TemplateType&lt;ABC, XYZ&gt; Decl;\n  FOO::TemplateType&lt;ABC, XYZ&gt; Decl2;\n  return 0;\n}\n</code></pre>\n\n<p>it produces the following output:</p>\n\n<pre><code>.../main.cpp:13:16\n.../main.cpp:13:21\n.../main.cpp:14:21\n.../main.cpp:14:26\n</code></pre>\n\n<p><strong>NOTE 3</strong>: It is a nested <strong>RecursiveASTVisitor</strong> because in the original problem you wanted to traverse template specializations only for types in variable declarations. If you want it to work for every case, just use this visit function and only one visitor.</p>\n\n<p>I hope this information was useful. Happy hacking with Clang!</p>\n"}], "owner": {"reputation": 821, "user_id": 2912478, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/bbfd1023cf7ba3aef7d10bcde4ccb2a4?s=128&d=identicon&r=PG&f=1", "display_name": "rph", "link": "https://stackoverflow.com/users/2912478/rph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 56462017, "answer_count": 1, "score": 1, "last_activity_date": 1560034219, "creation_date": 1559730613, "last_edit_date": 1559881263, "question_id": 56458731, "link": "https://stackoverflow.com/questions/56458731/clangtool-how-to-get-location-of-template-parameters-in-variable-declaration", "title": "ClangTool how to get location of template parameters in variable declaration?", "body": "<p>I am using a <code>RecursiveASTVisitor</code> to capture variable declarations. For templates, such as the one below, how can I use clang tool to get the location in the source code for each of the parameters?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>TMyTemplate&lt;t1, t2&gt; foo;\n</code></pre>\n\n<p><strong>Attempt 1:</strong> create a <code>VisitVarDecl</code> visitor</p>\n\n<p>Using this approach I am able to identify whether the variable is a template and get the type as <code>clang::TemplateSpecializationType</code>. It allows me to iterate over the arguments using <code>getArg</code>, however the the returning type (<code>TemplateArgument</code>) does not implement <code>getLocation</code>.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>virtual bool VisitVarDecl(VarDecl *var) {\n        const TemplateSpecializationType *ts = var-&gt;getType()-&gt;getAs&lt;TemplateSpecializationType&gt;();\n        if( ts != nullptr ) {\n            for(uint32_t i=0; i&lt; ts-&gt;getNumArgs(); i++) {\n                TemplateArgument arg = ts-&gt;getArg(i);\n                // I want to get arg.getLocation() - but no getLocation in TemplateArgument.\n            }\n        }\n\n}\n</code></pre>\n\n<p>I tried converting the type <code>TemplateArgument</code> to <code>TemplateArgumentLoc</code> but any approach leads me a dummy location (i.e.: always return line 1 and column 1, or even seg faults).</p>\n\n<p><strong>Attempt 2:</strong> using <code>VisitVarTemplateSpecializationDecl</code> visitor</p>\n\n<p>In Clang the type <code>VarTemplateSpecializationDecl</code> allows me to get the template parameters as <code>clang::TemplateArgumentListInfo</code>. This type seems more convenient as it we can get  <code>TemplateArgumentLoc</code> with the function <code>getArgumentArray</code>.</p>\n\n<p>The issue is that the template declaration does not trigger this visitor. I don't quite understand the reason.</p>\n\n<p><strong>Attempt 3:</strong> get <code>VarDecl</code> as <code>TemplateSpecializationTypeLoc</code></p>\n\n<p>I also tried getting the <code>VarDecl</code> as <code>TemplateSpecializationTypeLoc</code> but it fails.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>TemplateSpecializationTypeLoc loc = var-&gt;getTypeSourceInfo()-&gt;getTypeLoc().getAs&lt;TemplateSpecializationTypeLoc&gt;();\n</code></pre>\n\n<p><strong>Quick references</strong></p>\n\n<ul>\n<li>I am using the reference code from this <a href=\"https://kevinaboos.wordpress.com/2013/07/23/clang-tutorial-part-ii-libtooling-example/\" rel=\"nofollow noreferrer\">blog</a>, here is the <a href=\"https://github.com/kevinaboos/LibToolingExample/blob/master/Example.cpp\" rel=\"nofollow noreferrer\">full code</a>.</li>\n<li><a href=\"https://clang.llvm.org/doxygen/classclang_1_1VarTemplateSpecializationDecl.html\" rel=\"nofollow noreferrer\">clang::VarTemplateSpecializationDecl</a></li>\n<li><a href=\"https://clang.llvm.org/doxygen/classclang_1_1TemplateArgumentListInfo.html\" rel=\"nofollow noreferrer\">clang::TemplateArgumentListInfo</a></li>\n<li><a href=\"https://clang.llvm.org/doxygen/classclang_1_1TemplateArgumentLoc.html\" rel=\"nofollow noreferrer\">clang::TemplateArgumentLoc</a></li>\n<li><a href=\"https://clang.llvm.org/doxygen/classclang_1_1TemplateArgument.html\" rel=\"nofollow noreferrer\">clang::TemplateArgument</a></li>\n<li><a href=\"https://clang.llvm.org/doxygen/classclang_1_1TemplateSpecializationType.html\" rel=\"nofollow noreferrer\">clang::TemplateSpecializationType</a></li>\n</ul>\n\n<p><strong>Troublesome test case</strong></p>\n\n<p>The solution provided by Valeriy works almost perfectly. His solution can capture the location for the variable declaration <code>TemplateType&lt;ABC, XYZ&gt; Decl;</code> but it fails if I explicit the namespace: <code>FOO::TemplateType&lt;ABC, XYZ&gt; Decl;</code>.</p>\n\n<p>Here is a simple test case. The variable <code>Decl</code> is found in his solution but <code>Decl2</code> is not. The cast <code>auto Specialization = DeclarationTypeLoc.getAs&lt;clang::TemplateSpecializationTypeLoc&gt;()</code> fails for some reason (returns nullptr).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>namespace FOO {\n\nclass ABC {};\nclass XYZ {};\n\ntemplate &lt;class T, class U&gt; class TemplateType {};\n\n}\n\nusing namespace FOO;\n\n\n\nint main() {\n    TemplateType&lt;ABC, XYZ&gt; Decl;\n    FOO::TemplateType&lt;ABC, XYZ&gt; Decl2;\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "csv"], "comments": [{"owner": {"reputation": 1009, "user_id": 9428564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5HgUA.jpg?s=128&g=1", "display_name": "Aimery", "link": "https://stackoverflow.com/users/9428564/aimery"}, "edited": false, "score": 0, "creation_date": 1559730463, "post_id": 56458593, "comment_id": 99509032, "body": "Not sure what the question is, but maybe <a href=\"http://www.cplusplus.com/reference/unordered_set/unordered_set/\" rel=\"nofollow noreferrer\">unordered_set</a> or <a href=\"http://www.cplusplus.com/reference/set/set/\" rel=\"nofollow noreferrer\">set</a> can help?"}, {"owner": {"reputation": 11, "user_id": 9801624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3lUwi.png?s=128&g=1", "display_name": "Haseeb Ahmed", "link": "https://stackoverflow.com/users/9801624/haseeb-ahmed"}, "reply_to_user": {"reputation": 1009, "user_id": 9428564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5HgUA.jpg?s=128&g=1", "display_name": "Aimery", "link": "https://stackoverflow.com/users/9428564/aimery"}, "edited": false, "score": 0, "creation_date": 1559730916, "post_id": 56458593, "comment_id": 99509228, "body": "Brother, this is the CSV file: <a href=\"https://i.stack.imgur.com/Wx56x.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/Wx56x.png</a> I&#39;m trying to make a code that can read all the Author fields from 1 to 10 and copy the entries into some linked list or array."}, {"owner": {"reputation": 884, "user_id": 9238288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbf252a32c63647e64ea7b1a534be4a?s=128&d=identicon&r=PG&f=1", "display_name": "jackw11111", "link": "https://stackoverflow.com/users/9238288/jackw11111"}, "edited": false, "score": 0, "creation_date": 1559734694, "post_id": 56458593, "comment_id": 99510880, "body": "You should look at <code>std::cin</code>. You might parse each line into it variables as easily as something like <code>cin &gt;&gt; title &gt;&gt; journal &gt;&gt; month &gt;&gt; year</code> etc... and group them with a <code>typedef</code> and then add them to a vector, or a set."}, {"owner": {"reputation": 1009, "user_id": 9428564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5HgUA.jpg?s=128&g=1", "display_name": "Aimery", "link": "https://stackoverflow.com/users/9428564/aimery"}, "edited": false, "score": 0, "creation_date": 1559748491, "post_id": 56458593, "comment_id": 99518690, "body": "If an author is listed 5 times, do you want its name 5 times or only once in your list/array?"}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 5165289, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PF51Jtn1524/AAAAAAAAAAI/AAAAAAAAABM/8D6JrCYReME/photo.jpg?sz=128", "display_name": "Stf Kolev", "link": "https://stackoverflow.com/users/5165289/stf-kolev"}, "is_accepted": false, "score": 1, "last_activity_date": 1559736516, "creation_date": 1559736516, "answer_id": 56460201, "question_id": 56458593, "link": "https://stackoverflow.com/questions/56458593/whats-the-best-way-to-extract-every-entry-fields-from-csv-file/56460201#56460201", "title": "Whats the best way to extract every entry Fields from CSV file", "body": "<p>The easiest way you can go for is to create a function for similar actions. For example, you repeat the stringstream a lot of times to split each element into its' own. Better do a function</p>\n\n<pre><code>auto explode(const string&amp; s, const char&amp; c) -&gt; vector&lt;string&gt;\n{\n    string buff{ \"\" };\n    vector&lt;string&gt; v;\n\n    for (auto n : s)\n    {\n        if (n != c) buff += n; else\n            if (n == c &amp;&amp; buff != \"\") { v.push_back(buff); buff = \"\"; }\n    }\n    if (buff != \"\") v.push_back(buff);\n\n    return v;\n}\n</code></pre>\n\n<p>Then you can reuse the function. Another thing to make your life easier, you know you have more than 1 row in this CSV and you need a vector or some sort of array to store all the information from the CSV, prepare a structure/class with some proper name that matches your CSV's purpose in singular, then add your own properties and create operator to input into the structure/class. </p>\n\n<p>The algorithm can be:</p>\n\n<ul>\n<li>Go once through the headers (eg. ID, Name, Author, etc.)</li>\n<li>Loop until the file has reached its' end</li>\n<li>Get each row of the CSV with the delimiter and use the above function to split each column into array/vector of strings.</li>\n<li>Use your own operator to input into the structure/class</li>\n</ul>\n\n<p>Benefits:</p>\n\n<ul>\n<li>The code will be easier to understand</li>\n<li>A bit shorter</li>\n<li>Simplier</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>Hard to understand for a beginner</li>\n</ul>\n\n<p>I will give now the other option, procedural-style code.</p>\n\n<pre><code>vector&lt;string&gt; lines;\n\n  fstream file;\n  file.open(\"book.csv\");\n\n  string line\n  while (getline( file, line,'\\n'))\n    {\n      istringstream templine(line); \n      string data;\n\n      while (getline(templine, data,','))\n        lines.push_back(data);  \n\n    }\n  file.close();\n</code></pre>\n\n<p>With the above code, you open the file, create temporary variable named <code>line</code> to store each row, then iterate once again every string before the delimiter <code>,</code> is met.</p>\n\n<p>And a third option, you can go for third-party CSV parsing libraries.</p>\n\n<p>Such are:</p>\n\n<ul>\n<li><a href=\"https://github.com/d99kris/rapidcsv\" rel=\"nofollow noreferrer\">https://github.com/d99kris/rapidcsv</a></li>\n<li><a href=\"https://github.com/taocpp/PEGTL\" rel=\"nofollow noreferrer\">https://github.com/taocpp/PEGTL</a></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 9801624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3lUwi.png?s=128&g=1", "display_name": "Haseeb Ahmed", "link": "https://stackoverflow.com/users/9801624/haseeb-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1559736516, "creation_date": 1559730016, "last_edit_date": 1559730474, "question_id": 56458593, "link": "https://stackoverflow.com/questions/56458593/whats-the-best-way-to-extract-every-entry-fields-from-csv-file", "title": "Whats the best way to extract every entry Fields from CSV file", "body": "<p>I have a CSV file that contains different rows i.e. Identifier, Title, publisher, and Authors1, Authors2... etc.</p>\n\n<p>Now, I'm trying to extract every field one by one and store it into their proper data sets. For example: I'm storing the title in String, year in int like that.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Wx56x.png\" rel=\"nofollow noreferrer\">This is the CSV file I'm learning on.</a>\nAs I'm trying to implement this in C++. The problem is that There is a total of 10 separate Author fields with a varying number of authors. How can I design a loop in which it firsts identify the total entries of Authors then start the copy in into some linked List or arrays etc.</p>\n\n<pre><code>int main(){\n\nifstream myFile(\"BibtexFileCSV.csv\");\n\nif(!myFile.is_open()){\n    cout&lt;&lt;\"File failed to open\"&lt;&lt;endl;\n    return 0;\n}\n\nstring identifier;\nstring title;\nstring journal;\nstring month;\nstring year;\nstring publisher;\nstring author;\n\nstring line;\n\nwhile(getline(myFile, line)){\n\n    string chars=\"{}\"\"\";\n    for (char c: chars){\n        line.erase(std::remove(line.begin(), line.end(), c), line.end());\n        line.erase(std::remove(line.begin(),line.end(),'\\\"'),line.end());\n    }\n\n    stringstream ss(line);\n    getline(ss, identifier, ',');\n    getline(ss, title, ',' );\n    getline(ss, journal, ',');\n    getline(ss, month, ',');\n    getline(ss, year, ',');\n    getline(ss, publisher, ',');\n\n    vector &lt;string&gt; authors;\n\n    string lastName;\n    string firstName;\n\n    int i=0;\n    while(i &lt;= 1 ){\n        getline(ss, author, ',');\n        authors.push_back(author);\n        i++;\n    }       \n\n    cout&lt;&lt;publisher +\" : \";\n    for (unsigned int j=0; j &lt; 2; j++){\n\n        string n = authors.at(j);\n\n        stringstream names(n);\n\n        getline(names, lastName, ' ');\n        getline(names, firstName);\n        cout&lt;&lt;firstName;\n    }\n\n    cout&lt;&lt;firstName;\n    cout&lt;&lt;\" \"+lastName;\n    cout&lt;&lt;endl;\n}\n\nmyFile.close();\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>I can implement this task without using any formal loops but it will become a mess and requires a ton of lines of code.</p>\n"}]