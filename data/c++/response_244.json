[{"tags": ["c++", "visual-studio-code", "cout"], "comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1568245907, "post_id": 57898048, "comment_id": 102216986, "body": "Probably isn&#39;t the problem but try flushing the buffer."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 2, "creation_date": 1568246014, "post_id": 57898048, "comment_id": 102217012, "body": "What happens if you run the program from a terminal window, rather than going through your IDE (VS Code)?"}, {"owner": {"reputation": 474, "user_id": 10796158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cee47c04aa6e1d99d827e0dc638ad4?s=128&d=identicon&r=PG&f=1", "display_name": "An Ignorant Wanderer", "link": "https://stackoverflow.com/users/10796158/an-ignorant-wanderer"}, "reply_to_user": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1568246168, "post_id": 57898048, "comment_id": 102217041, "body": "@JaMiT it worked! But is there a way to make it work so that the output is shown as I step through the code? Because in other programs like Visual studio that&#39;s what happens and it&#39;s a very convenient feature"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1568246332, "post_id": 57898048, "comment_id": 102217075, "body": "@user10796158 Sorry, I don&#39;t know Visual Studio Code well enough to answer that. However, you did confirm the appropriateness of adding a tag for the IDE. All I can say is that the &quot;externalConsole&quot; line looks suspicious to me."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568246424, "post_id": 57898048, "comment_id": 102217085, "body": "If you want the data to be visible now, you better flush it. <code>cout &lt;&lt; &quot;hello&quot;;</code> doesn&#39;t flush, so &quot;hello&quot; may hang around in the buffer until the program exits and the stream is forced to flush in the destructor before closing."}, {"owner": {"reputation": 474, "user_id": 10796158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cee47c04aa6e1d99d827e0dc638ad4?s=128&d=identicon&r=PG&f=1", "display_name": "An Ignorant Wanderer", "link": "https://stackoverflow.com/users/10796158/an-ignorant-wanderer"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568247583, "post_id": 57898048, "comment_id": 102217316, "body": "@user4581301 how do you do that?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568249338, "post_id": 57898048, "comment_id": 102217617, "body": "Documentation for <a href=\"https://en.cppreference.com/w/cpp/io/manip/flush\" rel=\"nofollow noreferrer\"><code>std::flush</code></a> Side note: flush can be expensive, so only do it when you need to do it. A flush is also implied in <code>std::endl</code>, so if all you need to do is add a line feed to a stream, prefer to send a newline character(<code>&#39;\\n&#39;</code>)."}, {"owner": {"reputation": 474, "user_id": 10796158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cee47c04aa6e1d99d827e0dc638ad4?s=128&d=identicon&r=PG&f=1", "display_name": "An Ignorant Wanderer", "link": "https://stackoverflow.com/users/10796158/an-ignorant-wanderer"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1568251400, "post_id": 57898048, "comment_id": 102218000, "body": "@user4581301 so I tried endl, it didn&#39;t help. But I tried something else that someone suggested: setting externalConsole in launch.json to true. I now basically get an external console with the output that I want"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568251479, "post_id": 57898048, "comment_id": 102218017, "body": "@user10796158 I&#39;ll log that in the win column."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568251605, "post_id": 57898594, "comment_id": 102218047, "body": "The external console  likely exits when the program does, so if you want to see the output at the end of the program you may have to add another option in the config file (Not a VSC user so my knowledge here is limited) or place a breakpoint at the end of the program tto force a halt for inspection."}], "tags": [], "owner": {"reputation": 474, "user_id": 10796158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cee47c04aa6e1d99d827e0dc638ad4?s=128&d=identicon&r=PG&f=1", "display_name": "An Ignorant Wanderer", "link": "https://stackoverflow.com/users/10796158/an-ignorant-wanderer"}, "is_accepted": false, "score": 0, "last_activity_date": 1568251471, "creation_date": 1568251471, "answer_id": 57898594, "question_id": 57898048, "link": "https://stackoverflow.com/questions/57898048/i-am-using-vs-code-and-cout-is-not-working/57898594#57898594", "title": "I am using VS code and cout is not working", "body": "<p>I just set <code>externalConsole</code> to true in my <code>launch.json</code> and I now get the output that I want in an external console (i.e new bash)</p>\n"}, {"tags": [], "owner": {"reputation": 647, "user_id": 11923286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6998eee0e8f86bdd85902f148333df9?s=128&d=identicon&r=PG&f=1", "display_name": "ignacio", "link": "https://stackoverflow.com/users/11923286/ignacio"}, "is_accepted": false, "score": -1, "last_activity_date": 1568256092, "creation_date": 1568256092, "answer_id": 57899022, "question_id": 57898048, "link": "https://stackoverflow.com/questions/57898048/i-am-using-vs-code-and-cout-is-not-working/57899022#57899022", "title": "I am using VS code and cout is not working", "body": "<p><code>#include &lt;iostream&gt;</code> and don't forget to use <code>std::cout</code> if you are outside this namespace</p>\n"}, {"tags": [], "owner": {"reputation": 404, "user_id": 802494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7458bf990c6cf2aafdc9a0a5037c76ea?s=128&d=identicon&r=PG", "display_name": "Spartan", "link": "https://stackoverflow.com/users/802494/spartan"}, "is_accepted": false, "score": 0, "last_activity_date": 1601077110, "last_edit_date": 1601077110, "creation_date": 1601075631, "answer_id": 64072369, "question_id": 57898048, "link": "https://stackoverflow.com/questions/57898048/i-am-using-vs-code-and-cout-is-not-working/64072369#64072369", "title": "I am using VS code and cout is not working", "body": "<p>The output is in the TERMINAL tab, select the &quot;number: cppdbg: filename&quot; tag from the drop-down menu</p>\n"}], "owner": {"reputation": 474, "user_id": 10796158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cee47c04aa6e1d99d827e0dc638ad4?s=128&d=identicon&r=PG&f=1", "display_name": "An Ignorant Wanderer", "link": "https://stackoverflow.com/users/10796158/an-ignorant-wanderer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1583, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1601077110, "creation_date": 1568245569, "last_edit_date": 1568246270, "question_id": 57898048, "link": "https://stackoverflow.com/questions/57898048/i-am-using-vs-code-and-cout-is-not-working", "title": "I am using VS code and cout is not working", "body": "<p>I am using VS code on Ubuntu 19.04 and I'm trying to run a very simple program:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    cout &lt;&lt; \"hello\";\n    //some other simple stuff\n</code></pre>\n\n<p>I am stepping through this code using gdb. My <code>launch.json</code> file is as follows:</p>\n\n<pre><code>{\n    // Use IntelliSense to learn about possible attributes.\n    // Hover to view descriptions of existing attributes.\n    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"(gdb) Launch\",\n            \"type\": \"cppdbg\",\n            \"request\": \"launch\",\n            \"program\": \"${workspaceFolder}/project1_debug\",\n            \"args\": [\"-c queue\", \"-f stack\"],\n            \"stopAtEntry\": false,\n            \"cwd\": \"${workspaceFolder}\",\n            \"environment\": [],\n            \"externalConsole\": false,\n            \"MIMode\": \"gdb\",\n            \"setupCommands\": [\n                {\n                    \"description\": \"Enable pretty-printing for gdb\",\n                    \"text\": \"-enable-pretty-printing\",\n                    \"ignoreFailures\": true\n                }\n            ]\n        }\n    ]\n</code></pre>\n\n<p>The other \"simple stuff\" below cout works fine, it's just that <code>cout</code> is not working. I checked the Output, Problems and Debug Console and none of them show any output. </p>\n\n<p>Here's what my debug console says:</p>\n\n<pre><code>Loaded '/lib64/ld-linux-x86-64.so.2'. Symbols loaded.\n\nBreakpoint 1, main (argc=3, argv=0x7fffffffdeb8) at project1.cpp:6\n6   int main(int argc, char *argv[]) {\nLoaded '/lib/x86_64-linux-gnu/libstdc++.so.6'. Symbols loaded.\nLoaded '/lib/x86_64-linux-gnu/libgcc_s.so.1'. Symbols loaded.\nLoaded '/lib/x86_64-linux-gnu/libc.so.6'. Symbols loaded.\nLoaded '/lib/x86_64-linux-gnu/libm.so.6'. Symbols loaded.\n\nBreakpoint 2, main (argc=3, argv=0x7fffffffdeb8) at project1.cpp:8\n8       cout &lt;&lt; \"hello\";\nExecute debugger commands using \"-exec &lt;command&gt;\", for example \"-exec info registers\" will list registers in use (when GDB is the debugger)\nKill the program being debugged? (y or n) [answered Y; input not from terminal]\n</code></pre>\n\n<p>I don't understand why cout isn't working.</p>\n"}, {"tags": ["c++", "multithreading", "x86-64"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1568280397, "post_id": 57897843, "comment_id": 102227336, "body": "<code>Done = true</code> - <i>atomic store in thread A</i> with <code>memory_order_release</code> (even stronger) <code>while(!Done)</code> - <i>atomic load in thread B from the same variable is tagged memory_order_acquire</i> - so <a href=\"https://en.cppreference.com/w/cpp/atomic/memory_order#Release-Acquire_ordering\" rel=\"nofollow noreferrer\"><i>all memory writes (non-atomic and relaxed atomic) that happened-before the atomic store from the point of view of thread A, become visible side-effects in thread B. That is, once the atomic load is completed, thread B is guaranteed to see everything thread A wrote to memory.</i></a>"}], "answers": [{"comments": [{"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1568244705, "post_id": 57897946, "comment_id": 102216781, "body": "Even though the <i>shared</i> variable is not atomic? (Just asking to make the answer crystal clear)"}, {"owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "reply_to_user": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1568244947, "post_id": 57897946, "comment_id": 102216826, "body": "Yes, that&#39;s correct. You can use acquire/release memory order semantics to guarantee that changes to memory are visible to other threads, much like you can use a mutex to do so. (Of course, doing so with atomics is much more subtle.)"}, {"owner": {"reputation": 1101, "user_id": 221801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb1e98402fc251dcd74dd7488f0615c1?s=128&d=identicon&r=PG", "display_name": "Lockyer", "link": "https://stackoverflow.com/users/221801/lockyer"}, "edited": false, "score": 0, "creation_date": 1568245766, "post_id": 57897946, "comment_id": 102216961, "body": "Maybe I&#39;m misunderstanding, but it sounds like you&#39;re referring to <code>Done</code> and not <code>Shared</code>. I&#39;m specifically asking if a variable without locking, or atomic can be updated in one thread and read correctly in another if the ordering is clear as it is here."}, {"owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "edited": false, "score": 1, "creation_date": 1568245973, "post_id": 57897946, "comment_id": 102217002, "body": "Your use of <code>std::atomic&lt;bool&gt;</code> for <code>Done</code> here is sufficient to make this correct.  If access to <code>Done</code> was not atomic, or was atomic with weaker memory order than <code>std::memory_order_acq_rel</code>, then this would be a data race. Any C++ program with a data race has undefined behavior, even on platforms with strong low-level memory order semantics. (In practice, for instance, the compiler may optimize based on incorrect assumptions.)"}, {"owner": {"reputation": 1101, "user_id": 221801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb1e98402fc251dcd74dd7488f0615c1?s=128&d=identicon&r=PG", "display_name": "Lockyer", "link": "https://stackoverflow.com/users/221801/lockyer"}, "edited": false, "score": 0, "creation_date": 1568246164, "post_id": 57897946, "comment_id": 102217040, "body": "Okay I think I get it now, but I feel like I may have just stumbled into writing an example that works. What if the ordering were guaranteed with something other than an atomic? Are there cases where guaranteeing the ordering is insufficient? Specifically I thought there were cases where a value could be updated in one core&#39;s cache and not propagated to another?"}, {"owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "edited": false, "score": 1, "creation_date": 1568246696, "post_id": 57897946, "comment_id": 102217138, "body": "You could also use a mutex guarding access to <code>Done</code>, which also has the correct semantics (makes all other changes to memory from the thread visible).  There are cases where you can get surprising behavior at the CPU level, but x86 (and x86-64) does happen to offer fairly strong guarantees (so the naive version of this in x86 assembly would behave correctly). Even still, if you&#39;re writing C++ code you have to abide by the C++ memory model -- the compiler may not translate code to assembly in the way you expect."}, {"owner": {"reputation": 1101, "user_id": 221801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb1e98402fc251dcd74dd7488f0615c1?s=128&d=identicon&r=PG", "display_name": "Lockyer", "link": "https://stackoverflow.com/users/221801/lockyer"}, "edited": false, "score": 0, "creation_date": 1568246958, "post_id": 57897946, "comment_id": 102217193, "body": "Makes sense, thanks for your patience explaining Jeremy!"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1568250371, "post_id": 57897946, "comment_id": 102217782, "body": "What about the optimizer?  There is no need to re-read <code>Shared</code> on the main thread before outputting it&#39;s value."}, {"owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "edited": false, "score": 2, "creation_date": 1568251617, "post_id": 57897946, "comment_id": 102218052, "body": "Sure there is: it happens-after the acquire-read to <code>Done</code> in the while loop condition, therefore failing to re-read <code>Shared</code> is an unsound optimization unless the compiler can prove that no thread could have written it before a release-store to <code>Done</code> (since such a release-store, as does exist here, would make memory writes, including those to <code>Shared</code>, visible side effects after the acquire-load)."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1568259400, "post_id": 57897946, "comment_id": 102219462, "body": "In RISC-V  the ordering semantics are on a per memory location ( ok, really per cache line basis ).  On such an arch, the ordering semantics of Shared and Done are independent, so Shared would become visible because Done did.   Because of widespread expectations, the mutex operations would likely enforce full barriers; but the atomics needn&#39;t."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1568260077, "post_id": 57897946, "comment_id": 102219615, "body": "That was supposed to read Shared would not become visible because Done did.   The standard is ambiguous on whether SC is applied globally ( all memory locations ) or locally ( just the ones affected by the operations ).   I suspect the latter, since they left no invention to utilize more granular memory protocols."}, {"owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "edited": false, "score": 0, "creation_date": 1568272579, "post_id": 57897946, "comment_id": 102223379, "body": "I&#39;m not familiar with RISC-V, but presumably a C++ compiler targeting such an architecture would need to introduce whatever memory barriers are required to enforce the C++ memory model, which does require writes to become visible after an appropriate acquire-load following a release-store."}, {"owner": {"reputation": 1101, "user_id": 221801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb1e98402fc251dcd74dd7488f0615c1?s=128&d=identicon&r=PG", "display_name": "Lockyer", "link": "https://stackoverflow.com/users/221801/lockyer"}, "edited": false, "score": 0, "creation_date": 1568291352, "post_id": 57897946, "comment_id": 102233378, "body": "I get the impression that the C++ default memory model is meant to make everything behave like <code>x86-64</code> (by inserting these barriers on platforms that would behave differently by default) unless specifically told to use weaker guarantees by specifying <code>memory_order</code> is that a fair impression?"}, {"owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "edited": false, "score": 1, "creation_date": 1568362805, "post_id": 57897946, "comment_id": 102257528, "body": "Certainly not as it applies to non-atomic memory accesses. A read with an x86-64 <code>mov</code> instruction will be atomic and sequentially consistent (as I understand it); a memory access at the C++ level may not even compile into any instructions at all if the compiler can reason that it has seen the most recent non-data-race write to the memory (and there&#39;s nothing else to synchronize)."}], "tags": [], "owner": {"reputation": 15544, "user_id": 864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ae69e09086fed821a36d36814022c2?s=128&d=identicon&r=PG", "display_name": "Jeremy Roman", "link": "https://stackoverflow.com/users/864393/jeremy-roman"}, "is_accepted": true, "score": 3, "last_activity_date": 1568244576, "creation_date": 1568244576, "answer_id": 57897946, "question_id": 57897843, "link": "https://stackoverflow.com/questions/57897843/are-values-written-by-one-thread-guaranteed-to-be-seen-by-another-thread-without/57897946#57897946", "title": "Are values written by one thread guaranteed to be seen by another thread without locking on that variable?", "body": "<p>It's complicated, but in your particular case, this is guaranteed to work across all C++ implementations.</p>\n\n<p>The reason is that the default memory order for operations on <code>std::atomic</code> is <code>std::memory_order_seq_cst</code>, which does guarantee release/acquire semantics.</p>\n\n<p>Specifically, that means that any writes that a thread makes to memory before it release-stores (including sequentially consistent stores, like yours) are visible to any thread that acquire-loads on the same atomic (including sequentially consistent loads, like yours) and observes the new value.</p>\n"}], "owner": {"reputation": 1101, "user_id": 221801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb1e98402fc251dcd74dd7488f0615c1?s=128&d=identicon&r=PG", "display_name": "Lockyer", "link": "https://stackoverflow.com/users/221801/lockyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 57897946, "answer_count": 1, "score": 3, "last_activity_date": 1568244576, "creation_date": 1568243422, "last_edit_date": 1568243936, "question_id": 57897843, "link": "https://stackoverflow.com/questions/57897843/are-values-written-by-one-thread-guaranteed-to-be-seen-by-another-thread-without", "title": "Are values written by one thread guaranteed to be seen by another thread without locking on that variable?", "body": "<p>I'm trying to understand the coherency guarantees in C++ on a x86-64 machine, and if that varies on other platforms. Specifically I'm wondering if I can guarantee that if one thread writes to a variable before the next thread reads from it, will I always see the correct value? I've read some conflicting information about this.</p>\n\n<p>Here's an example, where <code>Shared</code> is updated in another thread, and the result is read only when we're sure the value is finished being updated. Will this always print 1? It has every time I tested it, but I can't really prove it by example.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;atomic&gt;\n\nstd::atomic&lt;bool&gt; Done {false};\nint Shared = 0;\n\nint main(int argc, const char* argv[])\n{\n    auto Thread = std::thread([](){\n        Shared = 1;\n        Done = true;\n    });\n\n    while(!Done)\n    {\n    }\n\n    std::cout &lt;&lt; Shared &lt;&lt; std::endl;\n\n    Thread.join();\n    return 0;\n}\n\n</code></pre>\n\n<p>This blog seems to suggest that on x86-64 all writes are made visible to other threads: <a href=\"http://benbowen.blog/post/cmmics_iii/\" rel=\"nofollow noreferrer\">http://benbowen.blog/post/cmmics_iii/</a></p>\n\n<p>This document also sounds like it's saying something similar:</p>\n\n<blockquote>\n  <p>When a thread is writing to a shared memory location, the MESIF protocol requires that all\n  other copies of the memory location is invalidated. If this occurs, all cores in the processor\n  sends a RFO\u00adrequest (read\u00adfor\u00adownership request) to the LLC (in this case the L3\u00adcache) that\n  checks the snoop\u00adfilter and then sends out invalidations to all cache\u2019s that holds a copy of the\n  cache line.</p>\n</blockquote>\n\n<p><a href=\"https://www.eit.lth.se/fileadmin/eit/courses/edt621/Rapporter/2015/robin.skafte.pdf\" rel=\"nofollow noreferrer\">https://www.eit.lth.se/fileadmin/eit/courses/edt621/Rapporter/2015/robin.skafte.pdf</a></p>\n"}, {"tags": ["c++", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568242575, "post_id": 57897726, "comment_id": 102216324, "body": "Unrelated: You may want to ask your instructor why a <code>createS</code> function in the stack rather than the usual constructor. The answer might be very interesting and educational."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1568244304, "post_id": 57897726, "comment_id": 102216694, "body": "At least as I&#39;d normally expect to see things, the disks on each peg would be shown vertically, but the three pegs would be horizontal from each other."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1568245739, "post_id": 57897726, "comment_id": 102216959, "body": "One of the first steps of formatting output is visualizing what the output will look like. Could you (in a text editor) write out the expected output if you were able to print the display vertically? How do <i>you</i> want the output to appear for various possibilities of disks? <i>Hint: don&#39;t design for just a tower with disks 1, 2, and 3 as the design might be misleading. Also look at other possibilities, such as only disks 2 and 3.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1568247847, "creation_date": 1568247847, "answer_id": 57898251, "question_id": 57897726, "link": "https://stackoverflow.com/questions/57897726/how-can-i-change-my-hanoi-tower-output-display-vertically/57898251#57898251", "title": "How can I change my hanoi tower output display vertically?", "body": "<p>You need to retrieve some global information from your towers.\nthen you might do:</p>\n\n<pre><code>int maxHeight(const MyStack (&amp;towers)[TOWER_CNT])\n{\n    auto res = 0;\n    for (const auto&amp; tower : towers) {\n        // Alternatively, you might take the sum, for fixed size towers.\n        res = std::max(res, tower.tos + 1);\n    }\n    return res;\n}\n\nint baseWidth(const MyStack (&amp;towers)[TOWER_CNT])\n{\n    auto res = 0;\n    for (const auto&amp; tower : towers) {\n        auto base = ((tower.tos == -1) ? 1 : tower.s[0]);\n        res = std::max(res, base);\n    }\n    return res;\n}\n\n\nvoid printTowers(const MyStack (&amp;towers)[TOWER_CNT]) {\n    auto height = maxHeight(towers);\n    auto base = baseWidth(towers);\n\n    for ([[maybe_unused]]const auto&amp; _ : towers) {\n            std::cout &lt;&lt; std::string((base) / 2, ' ')\n                      &lt;&lt; std::string(1, '^')\n                      &lt;&lt; std::string((base - 1) / 2, ' ') &lt;&lt; \"   \";\n    }\n    std::cout &lt;&lt; std::endl;\n    for ([[maybe_unused]]const auto&amp; _ : towers) {\n            std::cout &lt;&lt; std::string((base) / 2, ' ')\n                      &lt;&lt; std::string(1, '|')\n                      &lt;&lt; std::string((base - 1) / 2, ' ') &lt;&lt; \"   \";\n    }\n    std::cout &lt;&lt; std::endl;\n\n    for (int j = 0; j != height; ++j) {\n        for (const auto&amp; tower : towers) {\n            auto plate_index = height - j - 1;\n            auto count = ((plate_index &lt; tower.tos + 1)\n                         ? tower.s[plate_index] // You might use (2 * tower.s[plate_index] + 1)\n                                                // For larger but better display.\n                         : 0);\n\n            // -1 there are to handle even count for display\n            std::cout &lt;&lt; std::string(base / 2 - count / 2, ' ')\n                      &lt;&lt; std::string(count / 2, '*')\n                      &lt;&lt; std::string(1, count == 1 ? '*' : '|')\n                      &lt;&lt; std::string((count - 1) / 2, '*')\n                      &lt;&lt; std::string((base - 1) / 2 - (count - 1) / 2, ' ') &lt;&lt; \"   \";\n        }\n        std::cout &lt;&lt; std::endl;\n    }\n    for ([[maybe_unused]]const auto&amp; _ : towers) {\n        std::cout &lt;&lt; std::string(base, '=') &lt;&lt; \"   \";\n    }\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>With output similar to:</p>\n\n<pre><code>      ^               ^               ^         \n      |               |               |         \n     *|*              |               |         \n   ***|***            *             **|**        \n  ****|****      *****|*****    ******|******   \n=============   =============   =============   \n</code></pre>\n\n<p><a href=\"https://ideone.com/TumEht\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p>That also handles even number, but display is not fine IMO.</p>\n\n<p>Fill free to adapt to your look&amp;feel.</p>\n"}], "owner": {"reputation": 1, "user_id": 12030939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b08a0761abbe125ac22358cb7c5d982?s=128&d=identicon&r=PG&f=1", "display_name": "Kayle", "link": "https://stackoverflow.com/users/12030939/kayle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568247847, "creation_date": 1568242224, "last_edit_date": 1568242707, "question_id": 57897726, "link": "https://stackoverflow.com/questions/57897726/how-can-i-change-my-hanoi-tower-output-display-vertically", "title": "How can I change my hanoi tower output display vertically?", "body": "<p>I'm making hanoi tower for my assignment. I asked my professor to check my code before submitting it. My professor said he would give me a high score if I printed my display vertically, but I don't know how to change it to vertical. How can I change it to vertical? and also the towers are out in reverse, how can I get it back?</p>\n\n<p><a href=\"https://i.stack.imgur.com/o8lXo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o8lXo.png\" alt=\"enter image description here\"></a></p>\n\n<p>MyStack is in the header that the professor make it for us</p>\n\n<pre><code>struct MyStack{\nint tos; //top of stack\nchar s[MAXSTACK]; //MAXSTACK is 100.\n}\nvoid createS(MyStack &amp;S) {\n    S.tos = -1;\n}\nvoid pushS(MyStack &amp;S, char item) {\n    S.s[++S.tos] = item;\n}\n\nchar popS(MyStack&amp; S) {\n    return(S.s[S.tos--]);\n}\nbool isEmptyS(MyStack&amp; S) {\n    if (S.tos == -1)\n        return (true);\n    return false;\n}\n</code></pre>\n\n<p>This is the main.</p>\n\n<pre><code>const static int TOWER_CNT=3;\n\nvoid printTower(MyStack tower[TOWER_CNT]) {\n    MyStack tempStack; // temporary stacks to temporarily store tower values\n    createS(tempStack); // reset temporary stack\n    char tempNum;\n    cout &lt;&lt; \"                                                                                        ===============================\" &lt;&lt; endl;\n    for (int i = 0; i &lt; TOWER_CNT; i++) { // display all tower.\n        cout &lt;&lt; \"                                                                                        Tower \" &lt;&lt; i + 1 &lt;&lt; \": \";\n\n        while (!isEmptyS(tower[i])) {\n            pushS(tempStack, popS(tower[i])); // Put it upside down in a temporary stack because it has to be printed from the beginning of the tower.\n        }\n        while (!isEmptyS(tempStack)) { // Print out the value of the temporary stack and put it back into the tower.\n            tempNum = popS(tempStack);\n            //cout &lt;&lt; (int)tempNum &lt;&lt; \" \"; // print by number.\n            //cout &lt;&lt; \"                                                                                                 \";\n            change(tempNum); // change number into *\n            cout &lt;&lt; \"\\n                                                                                                 \";\n            pushS(tower[i], tempNum);\n        }\n        cout &lt;&lt; endl;\n    }\n    cout &lt;&lt; \"                                                                                        ===============================\" &lt;&lt; endl;\n    system(\"pause\");\n\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1568242139, "post_id": 57897675, "comment_id": 102216231, "body": "Probably, this is about the place where you call <code>set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)</code>. But since you haven&#39;t provided the code, we could only guess. (Hint: Add the code into the question post)."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1568242317, "post_id": 57897675, "comment_id": 102216265, "body": "If you have the check for <code>MSVC</code> before any calls to <code>project()</code>, CMake has not yet determined the compiler, and the <code>MSVC</code> variable will not yet be set."}], "owner": {"reputation": 3, "user_id": 6938246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VVHLsMO8YYo/AAAAAAAAAAI/AAAAAAAADgs/hE16LMA84Ng/photo.jpg?sz=128", "display_name": "jacuzzi123", "link": "https://stackoverflow.com/users/6938246/jacuzzi123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568241814, "creation_date": 1568241814, "question_id": 57897675, "link": "https://stackoverflow.com/questions/57897675/why-is-a-flag-working-on-command-line-with-cmake-but-not-inside-a-ifmsvc-state", "title": "Why is a flag working on command line with cmake but not inside a if(MSVC) statement in the CMakeLists file?", "body": "<p>I have a CMakeLists.txt file and inside it, I am using an <code>if(MSVC)</code> clause to set a flag (specifically <code>set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)</code>). However, this does not work and the generated DLL is empty.</p>\n\n<p>When I set the flag in the command line, like so:</p>\n\n<pre><code>cmake -G \"Visual Studio 15 2017 Win64\" -DCMAKE_WINDOWS_EXPORT_ALL_SYMBOLS=True ..\n</code></pre>\n\n<p>it works perfectly fine and the DLL gets generated along with the LIB file. Can anyone think of a reason for this issue? Thanks!</p>\n"}, {"tags": ["c++", "qt", "visual-c++", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1568241871, "post_id": 57897644, "comment_id": 102216180, "body": "&quot;The only thing I noted is that I installed Qt 5.13.1 <b>msvc2017</b>&quot; - Eh? The link path <code>D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Widgetsd.a</code> suggests that you have QT built with <b>MinGW</b>, not with Visual Studio (aside <code>mingw</code> subdurectory there is a suffix <code>.a</code> of the library, but Visual Studio uses native Windows library&#39;s suffix, <code>.dll</code>). Actually, I find this funny (=strange) that CMake chooses <code>.a</code> library even if it works under Visual Studio. Probably, you have passed some additional options for CMake?"}, {"owner": {"reputation": 1, "user_id": 12055486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce10084b389a7d0086c4f0d4af2e0013?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteEagle", "link": "https://stackoverflow.com/users/12055486/whiteeagle"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1568242052, "post_id": 57897644, "comment_id": 102216214, "body": "I have both the mingw and msvc kits installed. I naively assumed that Visual Studio would pick the msvc one :/ Where would I specify which Qt install to use? (Edit: I&#39;m using right click &quot;generate cmake cache&quot; so I don&#39;t specify anything as far as I know)"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1568242273, "post_id": 57897644, "comment_id": 102216254, "body": "Hm, if you have <code>QT_DIR</code> variable in the CMake cache, which is set to <code>D:\\Program\\Qt\\5.13.1\\mingw73_64</code>, then change this variable accordingly."}, {"owner": {"reputation": 1, "user_id": 12055486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce10084b389a7d0086c4f0d4af2e0013?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteEagle", "link": "https://stackoverflow.com/users/12055486/whiteeagle"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1568242896, "post_id": 57897644, "comment_id": 102216394, "body": "The entry is now called Qt5_DIR, I also edited entries looking like Qt5Widgets_DIR and others for the other modules. It now runs. But having to edit the cache for every new module and having to do it again when the cache gets cleared doesn&#39;t seem right. I&#39;ll update the question."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1568243255, "post_id": 57897644, "comment_id": 102216471, "body": "Instead of <code>*_DIR</code> variables you may set <code>CMAKE_PREFIX_PATH</code> variable to proper path. But that should be done with <b>clean cache</b> (that is, before the first &quot;Configure&quot;). See more about that variable in <a href=\"https://stackoverflow.com/questions/34795816/hinting-findname-cmake-files-with-a-custom-directory/34797156#34797156\">my answer</a> to the other question."}, {"owner": {"reputation": 1, "user_id": 12055486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce10084b389a7d0086c4f0d4af2e0013?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteEagle", "link": "https://stackoverflow.com/users/12055486/whiteeagle"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1568243869, "post_id": 57897644, "comment_id": 102216615, "body": "Thank you, I managed to set this variable in Visual Studio."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12055486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce10084b389a7d0086c4f0d4af2e0013?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteEagle", "link": "https://stackoverflow.com/users/12055486/whiteeagle"}, "is_accepted": true, "score": 0, "last_activity_date": 1568555564, "last_edit_date": 1568555564, "creation_date": 1568244355, "answer_id": 57897932, "question_id": 57897644, "link": "https://stackoverflow.com/questions/57897644/linking-qt-app-with-cmake-and-visual-studio/57897932#57897932", "title": "Linking Qt app with CMake and Visual Studio", "body": "<p>Thanks to @Tsyvarev for pointing out the problem and fix.</p>\n\n<p>To sum up what happened:</p>\n\n<ul>\n<li>When Visual Studio runs CMake it doesn't hint that it should use MSVC</li>\n<li>CMake ended up finding the MinGW kit installed on the system</li>\n</ul>\n\n<p>To fix it in a (as far as I can tell) durable way:</p>\n\n<ul>\n<li>Right the CMakeList file and clear the CMake cache</li>\n<li>Right click the CMakeList file and select \"CMake Settings\"</li>\n<li>Then click on \"Edit JSON\" in the top right</li>\n<li>You can add CMake variables in the JSON </li>\n</ul>\n\n<pre><code>{\n  \"configurations\": [\n    {\n      \"name\": \"x64-Debug\",\n      \"generator\": \"Ninja\",\n      \"configurationType\": \"Debug\",\n      \"inheritEnvironments\": [ \"msvc_x64_x64\" ],\n      \"buildRoot\": \"${projectDir}\\\\out\\\\build\\\\${name}\",\n      \"installRoot\": \"${projectDir}\\\\out\\\\install\\\\${name}\",\n      \"cmakeCommandArgs\": \"\",\n      \"buildCommandArgs\": \"-v\",\n      \"ctestCommandArgs\": \"\",\n      \"variables\": [\n        {\n          \"name\": \"CMAKE_PREFIX_PATH\",\n          \"value\": \"D:\\\\Program\\\\Qt\\\\5.13.1\\\\msvc2017_64\",\n          \"type\": \"STRING\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>Note that this is the part that defines the variable:</p>\n\n<pre><code>    \"variables\": [\n        {\n          \"name\": \"CMAKE_PREFIX_PATH\",\n          \"value\": \"D:\\\\Program\\\\Qt\\\\5.13.1\\\\msvc2017_64\",\n          \"type\": \"STRING\"\n        }\n      ]\n</code></pre>\n\n<p>You should update the value accordingly. The rest of the file is generated by Visual Studio.</p>\n\n<ul>\n<li>Generating the CMake cache should now use the correct kit</li>\n</ul>\n\n<p>Thanks again to @Tsyvarev.</p>\n"}], "owner": {"reputation": 1, "user_id": 12055486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce10084b389a7d0086c4f0d4af2e0013?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteEagle", "link": "https://stackoverflow.com/users/12055486/whiteeagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 57897932, "answer_count": 1, "score": 0, "last_activity_date": 1568555564, "creation_date": 1568241506, "last_edit_date": 1568243072, "question_id": 57897644, "link": "https://stackoverflow.com/questions/57897644/linking-qt-app-with-cmake-and-visual-studio", "title": "Linking Qt app with CMake and Visual Studio", "body": "<p>I'm trying to build a simple test Qt app using CMake and Visual Studio 2019.</p>\n\n<p>I'm basing my tests on this example: <a href=\"https://github.com/jasondegraw/Qt-CMake-HelloWorld\" rel=\"nofollow noreferrer\">https://github.com/jasondegraw/Qt-CMake-HelloWorld</a></p>\n\n<p>I opened the CMakeLists.txt file with Visual Studio. During build i get:</p>\n\n<pre><code>[7/7] cmd.exe /C \"cd . &amp;&amp; \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin\\cmake.exe\" -E vs_link_exe --intdir=CMakeFiles\\helloworld.dir --rc=C:\\PROGRA~2\\WI3CF2~1\\10\\bin\\100183~1.0\\x86\\rc.exe --mt=C:\\PROGRA~2\\WI3CF2~1\\10\\bin\\100183~1.0\\x86\\mt.exe --manifests  -- C:\\PROGRA~2\\MICROS~2\\2019\\COMMUN~1\\VC\\Tools\\MSVC\\1422~1.279\\bin\\Hostx86\\x64\\link.exe /nologo CMakeFiles\\helloworld.dir\\helloworld_autogen\\mocs_compilation.cpp.obj CMakeFiles\\helloworld.dir\\main.cpp.obj CMakeFiles\\helloworld.dir\\mainwindow.cpp.obj CMakeFiles\\helloworld.dir\\helloworld_autogen\\EWIEGA46WW\\qrc_resources.cpp.obj  /out:helloworld.exe /implib:helloworld.lib /pdb:helloworld.pdb /version:0.0  /machine:x64 /debug /INCREMENTAL /subsystem:windows  D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Widgetsd.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Guid.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Cored.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libqtmaind.a kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib &amp;&amp; cd .\"\n  FAILED: helloworld.exe \n  cmd.exe /C \"cd . &amp;&amp; \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin\\cmake.exe\" -E vs_link_exe --intdir=CMakeFiles\\helloworld.dir --rc=C:\\PROGRA~2\\WI3CF2~1\\10\\bin\\100183~1.0\\x86\\rc.exe --mt=C:\\PROGRA~2\\WI3CF2~1\\10\\bin\\100183~1.0\\x86\\mt.exe --manifests  -- C:\\PROGRA~2\\MICROS~2\\2019\\COMMUN~1\\VC\\Tools\\MSVC\\1422~1.279\\bin\\Hostx86\\x64\\link.exe /nologo CMakeFiles\\helloworld.dir\\helloworld_autogen\\mocs_compilation.cpp.obj CMakeFiles\\helloworld.dir\\main.cpp.obj CMakeFiles\\helloworld.dir\\mainwindow.cpp.obj CMakeFiles\\helloworld.dir\\helloworld_autogen\\EWIEGA46WW\\qrc_resources.cpp.obj  /out:helloworld.exe /implib:helloworld.lib /pdb:helloworld.pdb /version:0.0  /machine:x64 /debug /INCREMENTAL /subsystem:windows  D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Widgetsd.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Guid.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Cored.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libqtmaind.a kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib &amp;&amp; cd .\"\n  LINK Pass 1: command \"C:\\PROGRA~2\\MICROS~2\\2019\\COMMUN~1\\VC\\Tools\\MSVC\\1422~1.279\\bin\\Hostx86\\x64\\link.exe /nologo CMakeFiles\\helloworld.dir\\helloworld_autogen\\mocs_compilation.cpp.obj CMakeFiles\\helloworld.dir\\main.cpp.obj CMakeFiles\\helloworld.dir\\mainwindow.cpp.obj CMakeFiles\\helloworld.dir\\helloworld_autogen\\EWIEGA46WW\\qrc_resources.cpp.obj /out:helloworld.exe /implib:helloworld.lib /pdb:helloworld.pdb /version:0.0 /machine:x64 /debug /INCREMENTAL /subsystem:windows D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Widgetsd.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Guid.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libQt5Cored.a D:\\Program\\Qt\\5.13.1\\mingw73_64\\lib\\libqtmaind.a kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:CMakeFiles\\helloworld.dir/intermediate.manifest CMakeFiles\\helloworld.dir/manifest.res\" failed (exit code 1120) with the following output:\nD:\\Download\\mocs_compilation.cpp.obj : error LNK2019: unresolved external symbol \"__declspec(dllimport) public: struct QMetaObject * __cdecl QObjectData::dynamicMetaObject(void)const \" (__imp_?dynamicMetaObject@QObjectData@@QEBAPEAUQMetaObject@@XZ) referenced in function \"public: virtual struct QMetaObject const * __cdecl MainWindow::metaObject(void)const \" (?metaObject@MainWindow@@UEBAPEBUQMetaObject@@XZ)\n</code></pre>\n\n<p>and a load more LNK2019 errors after. The only thing that is different is that I commented out the \"-Wall\" line in the CMakeLists.txt.</p>\n\n<p>As far as I can tell, this example has all the required elements to be working.</p>\n\n<p>The only thing I noted is that I installed Qt 5.13.1 msvc2017 and I'm running msvc2019 but a thread on the Qt forum pointed out that those two versions are binary compatible.</p>\n\n<p>Any thoughts on this problem?</p>\n\n<p>Update: as @Tsyvarev pointed out, when Visual Studio runs CMake, it uses the MinGW kit that is installed along the msvc one. Where can I tell Visual Studio which Qt kit is the correct one?</p>\n"}, {"tags": ["c++", "multithreading", "qt"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1568241965, "post_id": 57897624, "comment_id": 102216196, "body": "<code>cancelDataGeneration()</code> can also send the signal <code>UpdateFinished()</code>, no?"}, {"owner": {"reputation": 255, "user_id": 1311189, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2593d10296affae46d6126d1c73d1c9?s=128&d=identicon&r=PG", "display_name": "stzzz1", "link": "https://stackoverflow.com/users/1311189/stzzz1"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568242501, "post_id": 57897624, "comment_id": 102216307, "body": "There is nothing that prevents me to do that."}], "owner": {"reputation": 255, "user_id": 1311189, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a2593d10296affae46d6126d1c73d1c9?s=128&d=identicon&r=PG", "display_name": "stzzz1", "link": "https://stackoverflow.com/users/1311189/stzzz1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568241348, "creation_date": 1568241348, "question_id": 57897624, "link": "https://stackoverflow.com/questions/57897624/offloading-a-cancelable-job-to-a-different-thread-that-needs-to-update-ui", "title": "Offloading a cancelable job to a different thread that needs to update UI", "body": "<p>I want to offload a function to a different thread because it takes a long time to execute and blocks the main thread (and freezes the UI). Here is a simplified version of the code:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// This function is called when a button is pressed, and it can\n// be called as many times as the user wants. By convention, calling\n// this function while a job is already running will cancel that\n// job and start a new one.\nvoid Data::RefreshData() {\n    if (future.isRunning()) {\n        cancelDataGeneration();\n        future.waitForFinished();\n    }\n\n    future = QtConcurrent::run(this, &amp;Data::RegenerateData);\n}\n</code></pre>\n\n<p>The issue I have is that a part of the work of <em>Data::RegenerateData</em> needs to be ran in the main thread (UI updates and other things). I put the code that need to be executed in the main thread in a different function and the end of <em>Data::RegenerateData</em> emits a signal that triggers this function. However, I now have a different issue: the return of <em>future.waitForFinished()</em> no longer means that the complete job is finished.</p>\n\n<p>Instead of waiting for <em>future.waitForFinished()</em> to finish, I would like to also wait for the work done in the main thread. I initially tried to achieve this with a QEventLoop that waits for a signal.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void Data::RefreshData() {\n    if (future.isRunning()) {\n        cancelDataGeneration();\n        future.waitForFinished();\n    }\n\n    future = QtConcurrent::run(this, &amp;Data::RegenerateData);\n}\n\n// Runs in a worker thread\nvoid Data::RegenerateData() {\n    // Long-running task\n\n    // Waiting for the work on the main thread to finish... \n    QEventLoop loop;\n    connect(this, SIGNAL(UpdateFinished()), &amp;loop, SLOT(quit()));\n    emit Update(); // connected to the OnUpdate slot.\n    loop.exec();\n}\n\nvoid Data::OnUpdate() {\n    // Update stuff\n\n    emit UpdateFinished();\n}\n</code></pre>\n\n<p>The problem with this approach is that it will always result in a deadlock. What is wrong with my approach, and how can I achieve what I need?</p>\n"}, {"tags": ["c++", "printf", "cout"], "answers": [{"tags": [], "owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "is_accepted": true, "score": 3, "last_activity_date": 1589968357, "last_edit_date": 1589968357, "creation_date": 1568241087, "answer_id": 57897585, "question_id": 57897532, "link": "https://stackoverflow.com/questions/57897532/print-order-when-using-sync-with-stdio/57897585#57897585", "title": "Print order when using sync_with_stdio", "body": "<p>The <strike>default</strike> typical behaviour for the stdout stream is line buffering, so that output is perfectly reasonable. <code>printf</code> does not flush immediately, for that use <code>fflush(stdout)</code>. </p>\n\n<p>To your second question, one would expect that performance is improved when synchronisation is not required. However, it is always better to profile and check, obviously for this small snippet, it won't much matter.</p>\n\n<hr>\n\n<p>Edit: Answer corrected based on <a href=\"https://stackoverflow.com/questions/37991116/why-is-stdout-buffering/37991361\">this post</a>.</p>\n"}], "owner": {"reputation": 5009, "user_id": 1455108, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zaRtd.jpg?s=128&g=1", "display_name": "Jo&#227;o Paulo", "link": "https://stackoverflow.com/users/1455108/jo%c3%a3o-paulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57897585, "answer_count": 1, "score": 1, "last_activity_date": 1589968357, "creation_date": 1568240589, "question_id": 57897532, "link": "https://stackoverflow.com/questions/57897532/print-order-when-using-sync-with-stdio", "title": "Print order when using sync_with_stdio", "body": "<p>Look this example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    std::ios::sync_with_stdio(false);\n    std::cout &lt;&lt; \"a\";\n    printf(\"b\");\n    std::cout &lt;&lt; \"c\";\n}\n</code></pre>\n\n<p>On gcc 9.2 I'm getting <code>acb</code> as output. I was expecting <code>bac</code>, because, if I understood correctly, <code>std::cout</code> would be using its buffer. Why was it printed in this order?</p>\n\n<p>Additional question: setting <code>std::ios::sync_with_stdio(false)</code> would improve performance (in the above example, for instance)?</p>\n"}, {"tags": ["python", "c++", "arrays"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568240327, "post_id": 57897478, "comment_id": 102215816, "body": "Your assumption is only true the first time. This is presumably executed multiple times, and the next time <code>R[Period, 0]</code> will contain the result of this code, and each time will build on the previous one."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568240460, "post_id": 57897478, "comment_id": 102215842, "body": "This code doesn&#39;t look like C++. I don&#39;t think it allows declaring 2D arrays like that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1568240515, "post_id": 57897478, "comment_id": 102215859, "body": "See <a href=\"https://stackoverflow.com/questions/936687/how-do-i-declare-a-2d-array-in-c-using-new\" title=\"how do i declare a 2d array in c using new\">stackoverflow.com/questions/936687/&hellip;</a> for how you create a 2D array dynamically in C++."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1568245245, "post_id": 57897478, "comment_id": 102216878, "body": "You would need more code (more context) to see how the smoothing is performed. However, before asking for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, I would ask which question do you want answered? 1) How does the Python code work? <i>or</i> 2) How to implement this in C++?"}], "owner": {"reputation": 11, "user_id": 10731939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3835a2cc35fd1a24db621e157817b689?s=128&d=identicon&r=PG&f=1", "display_name": "User415", "link": "https://stackoverflow.com/users/10731939/user415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568240117, "creation_date": 1568240117, "question_id": 57897478, "link": "https://stackoverflow.com/questions/57897478/converting-fourier-transform-from-c-to-python-array-issue", "title": "Converting Fourier transform from C++ to Python, array issue", "body": "<p>I am attempting to convert the Fourier transform of a Pearson correlation from C++ to Python. However, I'm failing to understand the smoothing technique used.</p>\n\n<p>The 2D array R is initialised as shown below. The array is then assigned the smoothed values of the transformed correlation values, SqSum.</p>\n\n<pre><code>double[,] R = new double[70,2];\n\n\n\nfor(int Period = 8; Period &lt;= 48; Period++)\n\n{\n\nR[Period, 1] = R[Period, 0]; \n\nR[Period, 0] = 0.2 * SqSum[Period] * SqSum[Period] + 0.8 * R[Period,1];                 \n\n}               \n</code></pre>\n\n<p>How is this smoothing being performed? If on every iteration of the for loop, R[Period, 1] is being assigned the value of R[Period, 0], which I assume to be 0, should R[Period, 0]  just become 0.2 * SqSum[Period] * SqSum[Period]?  </p>\n\n<p>Sorry if this is a basic question but any help in my understanding is appreciated, cheers.</p>\n"}, {"tags": ["c++", "c++11", "lambda", "visual-studio-2015", "mfc"], "answers": [{"comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1568265237, "post_id": 57897540, "comment_id": 102220784, "body": "Thank you. I will try this out later this morning when I get back into the lab and follow up with how it turns out or if I have any questions. Its 1am here on the US East Coast and I need to get a few hours sleep."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1568302166, "post_id": 57897540, "comment_id": 102239817, "body": "The approach I am using at the moment is to keep what was there and provide a clone of the three callback setter functions that take <code>std::function&lt;&gt;</code> arguments with the necessary additional <code>std::function&lt;&gt;</code> variables and the addition of a check in the class methods that use the callbacks if they are set to something other than <code>nullptr</code>. My understanding is that using <code>std::function&lt;&gt;</code> wraps the lambda in such a fashion that different lambdas that capture different variables can all use the same callback variable so long as the lambda arguments are the same. Is that correct?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1568304968, "post_id": 57897540, "comment_id": 102241141, "body": "You can fully replace pointer function by <code>std::function</code>. <code>std::function</code> has constructor that take pointer function. <code>std::function</code> can store mostly any callable if parameters matches."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 2, "last_activity_date": 1568241038, "last_edit_date": 1568241038, "creation_date": 1568240652, "answer_id": 57897540, "question_id": 57897457, "link": "https://stackoverflow.com/questions/57897457/how-to-define-function-pointer-compatible-with-using-lambda-with-capture-as-call/57897540#57897540", "title": "how to define function pointer compatible with using lambda with capture as call back", "body": "<p>You might use <a href=\"https://en.cppreference.com/w/cpp/utility/functional/function\" rel=\"nofollow noreferrer\"><code>std::function</code></a> to allow capturing lambdas and other functors and regular function pointers:</p>\n\n<pre><code>void(*funcDX)(CDataExchange* pDX);\nvoid(*funcDXpDoc)(CDataExchange* pDX, CDocument *pDoc);\nvoid(*funcInit)(CWnd *dlgWnd);\nvoid(*funcOK)(CWnd *dlgWnd, CDocument *pDoc);\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>std::function&lt;void(CDataExchange*)&gt; funcDX;\nstd::function&lt;void(CDataExchange*, CDocument*)&gt; funcDXpDoc;\nstd::function&lt;void(CWnd*)&gt; funcInit;\nstd::function&lt;void(CWnd*, CDocument*)&gt; funcOK;\n</code></pre>\n\n<p>You setter/constructor should change pointer function to <code>std::function</code> too:</p>\n\n<pre><code>void SetInitCallBack(std::function&lt;void(CWnd*)&gt; f) { funcInit = f; }\n</code></pre>\n\n<p>Else your usage is identical:</p>\n\n<pre><code>if (funcDX) funcDX(pDX);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>funcInit = nullptr;\n</code></pre>\n"}], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 57897540, "answer_count": 1, "score": 1, "last_activity_date": 1568433575, "creation_date": 1568239999, "last_edit_date": 1568433575, "question_id": 57897457, "link": "https://stackoverflow.com/questions/57897457/how-to-define-function-pointer-compatible-with-using-lambda-with-capture-as-call", "title": "how to define function pointer compatible with using lambda with capture as call back", "body": "<p>Needing several variations of a simple modal dialog with an MFC project, I wrote a simple class, <code>CDialogDlg</code>, which extends the standard MFC <code>CDialog</code> class and contains hooks for implementation specific callbacks that are normally implemented as methods in the class extending <code>CDialog</code>. These callbacks, if provided, are used when processing some events such as dialog initialization, OK button processing, and the <code>DoDataExchange()</code> function which provides the method for interfacing the dialog class variables and the actual dialog controls.</p>\n\n<p>My first version of this class used standard functions for the callbacks. So the callback setting methods of the extended class set a function pointer with the address of the standard function.</p>\n\n<pre><code>void SetDataExchangeCallBack(void(*f)(CDataExchange* pDX)) { funcDX = f; };\nvoid SetInitCallBack(void(*f)(CWnd *dlgWnd)) { funcInit = f; }\nvoid SetOnOkCallBack(void(*f)(CWnd *dlgWnd, CDocument *pDoc)) { funcOK = f; }\n</code></pre>\n\n<p>Then I realized I should be able to use a lambda instead of a standard function. The first version of the lambdas, which used the same parameters as the standard functions, that did not capture any variables compiled fine and worked fine with the existing methods and function pointers in the extended class.</p>\n\n<p>However when I tried to capture a variable in the lambda specified in the callback setter method, I had compile errors.</p>\n\n<p>Reviewing <a href=\"https://stackoverflow.com/questions/28746744/passing-capturing-lambda-as-function-pointer\">Passing capturing lambda as function pointer</a> and <a href=\"https://stackoverflow.com/questions/7852101/c-lambda-with-captures-as-a-function-pointer\">C++ lambda with captures as a function pointer</a> I get that trying to do a lambda with capture will not compile with the definitions of function pointer and callback setting function that I am using.</p>\n\n<p>So I decided that I should add an additional lambda specific function pointer within the class along with an override of the existing methods with an additional method setting the callbacks with the lambda specific function pointer within the class.</p>\n\n<p><strong>Question:</strong> What should the function pointer definition and the parameter definition in the function that sets the callback for accepting a lambda with captured variables look like? I would like to capture the local variable <code>CPCSampleDoc *pDoc</code> in the method <code>CPCSampleView::OnDisplayReportList ()</code>. This variable contains a pointer to the <code>CDocument</code> derived object for the view that I would like to capture rather than using the method of storing it and doing the <code>static_cast</code> to get it back in the current version of the lambdas that do not capture.</p>\n\n<p><strong>Source Code</strong></p>\n\n<p>The <code>CDialogDlg</code> class which extends <code>CDialog</code> looks like the following:</p>\n\n<pre><code>class CDialogDlg : public CDialog\n{\n    // Construction\n    void(*funcDX)(CDataExchange* pDX);\n    void(*funcDXpDoc)(CDataExchange* pDX, CDocument *pDoc);\n    void(*funcInit)(CWnd *dlgWnd);\n    void(*funcOK)(CWnd *dlgWnd, CDocument *pDoc);\n    CDocument *m_pDoc;\n\npublic:\n    CDialogDlg(UINT nIDTemplate, CWnd* pParentWnd = NULL, void(*f)(CDataExchange* pDX) = NULL) : CDialog(nIDTemplate, pParentWnd) { funcDX = f; funcInit = NULL; }\n    CDialogDlg(UINT nIDTemplate, CDocument *pDoc, CWnd* pParentWnd = NULL, void(*f)(CDataExchange* pDX, CDocument *pDoc) = NULL) : CDialog(nIDTemplate, pParentWnd) {\n        funcDX = NULL; funcDXpDoc = f; funcInit = NULL; m_pDoc = pDoc;\n    }\n\n    void SetDataExchangeCallBack(void(*f)(CDataExchange* pDX)) { funcDX = f; };\n    void SetInitCallBack(void(*f)(CWnd *dlgWnd)) { funcInit = f; }\n    void SetOnOkCallBack(void(*f)(CWnd *dlgWnd, CDocument *pDoc)) { funcOK = f; }\n\n    // Dialog Data\n    //{{AFX_DATA(CCashierNoDlg)\n    //}}AFX_DATA\n\n    // Overrides\n    // ClassWizard generated virtual function overrides\n    //{{AFX_VIRTUAL(CCashierNoDlg)\nprotected:\n    virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support\n    //}}AFX_VIRTUAL\n\nprotected:\n    // Generated message map functions\n    //{{AFX_MSG(CCashierNoDlg)\n    virtual BOOL OnInitDialog();\n    virtual void OnOK();\n    //}}AFX_MSG\n    DECLARE_MESSAGE_MAP()\n};\n\nBEGIN_MESSAGE_MAP(CDialogDlg, CDialog)\n    //{{AFX_MSG_MAP(CCashierNoDlg)\n    //}}AFX_MSG_MAP\nEND_MESSAGE_MAP()\n\nvoid CDialogDlg::DoDataExchange(CDataExchange* pDX)\n{\n    CDialog::DoDataExchange(pDX);\n    if (funcDX) funcDX(pDX);\n    if (funcDXpDoc) funcDXpDoc(pDX, m_pDoc);\n    //{{AFX_DATA_MAP(CCashierNoDlg)\n    //}}AFX_DATA_MAP\n}\n\nBOOL CDialogDlg::OnInitDialog()\n{\n    CDialog::OnInitDialog();\n    if (funcInit) funcInit(this);\n    return TRUE;  // return TRUE unless you set the focus to a control\n                  // EXCEPTION: OCX Property Pages should return FALSE\n}\n\nvoid CDialogDlg::OnOK()\n{\n    if (funcOK) funcOK(this, m_pDoc);\n    CDialog::OnOK();\n}\n</code></pre>\n\n<p>The <code>CView</code> method which is triggered by a menu selection displays a dialog with a list of items to choose from. The dialog presented is a <code>CDialogDlg</code> object with a specific dialog template ID. For special processing, I am using two different callbacks which are currently using a lambda that does not capture. The result is the following:</p>\n\n<pre><code>void CPCSampleView::OnDisplayReportList ()\n{\n    CPCSampleDoc *pDoc = GetDocument();\n\n    CDialogDlg myDialog(IDD_DIALOG_REPORTLIST, pDoc, this, [](CDataExchange* pDX, CDocument *pDoc) {\n        if (pDX-&gt;m_bSaveAndValidate) {\n        }\n        else {\n            CPCSampleDoc *pDocDoc = static_cast&lt;CPCSampleDoc *&gt;(pDoc);\n            POSITION pos = NULL;\n\n            do {\n                CPCSampleDoc::ListReportList sectionHeader;\n                CListBox *x = static_cast&lt;CListBox *&gt;(pDX-&gt;m_pDlgWnd-&gt;GetDlgItem(IDC_LIST1));\n\n                pos = pDocDoc-&gt;GetReportSectionHeader(pos, sectionHeader);\n                x-&gt;AddString(sectionHeader.m_SectionTitle);\n            } while (pos);\n        }\n    });\n\n    myDialog.SetOnOkCallBack([](CWnd *dlgWnd, CDocument *pDoc) {\n        CPCSampleDoc *pDocDoc = static_cast&lt;CPCSampleDoc *&gt;(pDoc);\n        CListBox *x = static_cast&lt;CListBox *&gt;(dlgWnd-&gt;GetDlgItem(IDC_LIST1));\n        int iPtr = x-&gt;GetCurSel();\n        POSITION pos = NULL;\n\n        do {\n            CPCSampleDoc::ListReportList sectionHeader;\n\n            pos = pDocDoc-&gt;GetReportSectionHeader(pos, sectionHeader);\n            if (iPtr &lt; 1) {\n                pDocDoc-&gt;MoveToReportSectionHeader(sectionHeader.m_ListOffset);\n                break;\n            }\n            iPtr--;\n        } while (pos);\n    });\n\n    myDialog.DoModal();\n}\n</code></pre>\n"}, {"tags": ["c++", "std", "standards"], "comments": [{"owner": {"reputation": 724, "user_id": 9454255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cDrB2.png?s=128&g=1", "display_name": "Jack C.", "link": "https://stackoverflow.com/users/9454255/jack-c"}, "edited": false, "score": 0, "creation_date": 1568257810, "post_id": 57897426, "comment_id": 102219155, "body": "In <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0009r6.html\" rel=\"nofollow noreferrer\">P0009r6</a>, AccessorPolicy has a lot fewer requirements and no <code>decay()</code> method.  In fact, it appears that <code>decay()</code> was added in the r8 revision at the San Diego meeting, November 2018."}], "owner": {"reputation": 87, "user_id": 159573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e1020249ec6861ecf4c98a72ddb2577?s=128&d=identicon&r=PG", "display_name": "maddanio", "link": "https://stackoverflow.com/users/159573/maddanio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1568240013, "creation_date": 1568239771, "last_edit_date": 1568240013, "question_id": 57897426, "link": "https://stackoverflow.com/questions/57897426/why-does-the-mdspan-accessor-policy-concept-contain-a-decay-member", "title": "why does the mdspan accessor policy concept contain a decay member?", "body": "<p>I am looking forward to the proposed mdspan, and was thinking of a toy example. What I thought of was game of life, which works on a binary 2d array. Naturally I would like to use an mdspan over a <code>bitset</code> or <code>std::vector&lt;bool&gt;</code>, both of which address individual bits via funky iterators. Now I was thinking I could do that by providing a suitable AccessPolicy, but as it turns out (in 26.7 <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0009r9.html\" rel=\"nofollow noreferrer\">here</a>) AccessorPolicy has a decay member which returns a real pointer to an element type, which basically does not exist for <code>std::vector&lt;bool&gt;</code>. Furthermore I looked at the only Implementation I could find on <a href=\"https://github.com/kokkos/mdspan\" rel=\"nofollow noreferrer\">github</a> and while it defines this member for accessor_basic (the only required model) it actually never uses it in the mdspan implementation.</p>\n\n<p>now I am bonked as to why they did that, thereby forbidding any proxy iterators, while not even needing this for mdspan? Is it for allowing use of <code>memcpy</code> in certain cases? If so, why not allow \"opt-in\"?</p>\n"}, {"tags": ["c++", "segmentation-fault"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1568239774, "post_id": 57897404, "comment_id": 102215688, "body": "<code>*p1 = firstValue;</code> is causing segmentation fault"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1568239792, "post_id": 57897404, "comment_id": 102215695, "body": "For <code>*p1 = firstValue;</code> to work, <code>p1</code> has to point to some existing <code>int</code>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1568240105, "post_id": 57897404, "comment_id": 102215759, "body": "Adding that <code>double</code> may have exposed the error with a seg fault, but it didn&#39;t cause it. This is a good lesson in undefined behaviour.  Since the behaviour of <code>*p1 = firstValue;</code> is undefined (writing to invalid pointer), the program can do just about anything, and that includes looking like it works correctly. But often it only takes a small perturbation, adding an unused variable in this case, to make the program visibly fail."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1568240429, "post_id": 57897404, "comment_id": 102215836, "body": "<code>*p1 = firstValue;</code> segfaults because <code>p1</code> is not pointing at any allocated memory."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 3, "creation_date": 1568241018, "post_id": 57897404, "comment_id": 102215972, "body": "Turn on compiler warnings. <a href=\"https://gcc.godbolt.org/z/Q06Mf3\" rel=\"nofollow noreferrer\">gcc.godbolt.org/z/Q06Mf3</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1568247792, "post_id": 57897404, "comment_id": 102217352, "body": "<a href=\"https://stackoverflow.com/q/57842756/995714\">Why should I always enable compiler warnings?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11010561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kn6KyDJYn00/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO33eAvOADhm6dXK7ckDFqjDJteAg/mo/photo.jpg?sz=128", "display_name": "Anakita Smiles", "link": "https://stackoverflow.com/users/11010561/anakita-smiles"}, "edited": false, "score": 0, "creation_date": 1568249686, "post_id": 57897963, "comment_id": 102217682, "body": "I think i get it. When i look up the definition of a segmentation fault, it says that it&#39;s an &quot;error denoting that the software has attempted to access a restricted area of memory.&quot; So because the pointer variable was undefined, it did not possess a spot in memory, leading to the error. Did I get that right?"}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "reply_to_user": {"reputation": 3, "user_id": 11010561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kn6KyDJYn00/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO33eAvOADhm6dXK7ckDFqjDJteAg/mo/photo.jpg?sz=128", "display_name": "Anakita Smiles", "link": "https://stackoverflow.com/users/11010561/anakita-smiles"}, "edited": false, "score": 0, "creation_date": 1568406115, "post_id": 57897963, "comment_id": 102277330, "body": "@AnakitaSmiles That might be the right idea, but (at least) the terminology is wrong. A pointer does not possess memory; it points to memory. (A street sign that says &quot;Library&quot; and has an arrow pointing to the left does not own the library; it points to it.) Also, the problem is not &quot;undefined&quot; but &quot;uninitialized&quot;. The line <code>int *p1;</code> defines the pointer without initializing it. The pointer&#39;s value is either random or zero, and the chance of that being a valid and unrestricted address is slim."}], "tags": [], "owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "is_accepted": true, "score": 0, "last_activity_date": 1568244691, "creation_date": 1568244691, "answer_id": 57897963, "question_id": 57897404, "link": "https://stackoverflow.com/questions/57897404/why-is-this-double-variable-causing-a-segmentation-fault/57897963#57897963", "title": "Why is this double variable causing a segmentation fault?", "body": "<blockquote>\n  <p>I have no idea why this is happening since the variable is not interacting with anything else in the program.</p>\n</blockquote>\n\n<p>This is a sign of undefined behavior. The variable is not directly interacting with anything else, but it is present in the program. That can be enough to change how the compiler deals with undefined behavior, potentially changing a silent no-op into a crash.</p>\n\n<p><em>[In your case, there is undefined behavior when you use the value of a variable before assigning a value to that variable. Specifically, <code>int *p1;</code> declares a variable without assigning a value to it, and the \"<code>*p1</code>\" in the next line uses the value of <code>p1</code> (to get the address to where the value of <code>firstValue</code> is copied). Similarly, no value has been assigned to <code>firstValue</code> at that point, so you get another bit of undefined behavior in the same assignment. Realistically, though, it's the uninitialized pointer that causes the segmentation fault.]</em></p>\n\n<p>Relying on something like declaring a new variable to reveal undefined behavior is not a great plan. A better plan would be to turn on all of your compiler's warnings. The warnings may miss some instances of undefined behavior, but they will catch a significant portion of them. Serious projects often require all (or at least <code>-Wall</code>) warnings to be checked; code that does not compile warning-free is quickly rejected. So you might as well learn to code warning-free now.</p>\n"}], "owner": {"reputation": 3, "user_id": 11010561, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kn6KyDJYn00/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO33eAvOADhm6dXK7ckDFqjDJteAg/mo/photo.jpg?sz=128", "display_name": "Anakita Smiles", "link": "https://stackoverflow.com/users/11010561/anakita-smiles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 57897963, "answer_count": 1, "score": -3, "last_activity_date": 1568244691, "creation_date": 1568239652, "last_edit_date": 1568239754, "question_id": 57897404, "link": "https://stackoverflow.com/questions/57897404/why-is-this-double-variable-causing-a-segmentation-fault", "title": "Why is this double variable causing a segmentation fault?", "body": "<p>I'm playing around with some code to understand how pointers work. I made a non-pointer variable a double and it caused a segmentation fault. I have no idea why this is happening since the variable is not interacting with anything else in the program.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main() {\n\n    int firstValue;\n    double secondValue = 54.6;\n\n    int *p1;\n    *p1 = firstValue;\n    p1 = &amp;firstValue;\n    *p1 = 10;\n    std::cout &lt;&lt; \"&amp;firstvalue is \" &lt;&lt; &amp;firstValue &lt;&lt; '\\n';\n\n    std::cout &lt;&lt; \"firstvalue is \" &lt;&lt; firstValue &lt;&lt; '\\n';\n\n    std::cout &lt;&lt; \"p1 is \" &lt;&lt; p1 &lt;&lt; '\\n';\n\n    std::cout &lt;&lt; \"*p1 is \" &lt;&lt; *p1 &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>exited, segmentation fault;</p>\n"}, {"tags": ["c++", "compiler-errors", "mingw"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568239784, "post_id": 57897314, "comment_id": 102215692, "body": "You might get further problems, unistd.h and sys/types.h are POSIX headers as well... I wouldn&#39;t try to replace the entire headers, but instead try to spot which functions and data types are used from and resolve these accordingly. Prefer replacements from C++ standard libraries (if code was written for older standard), otherwise you might need OS specific build switches (<code>#ifdef WIN32 #else #endif</code>)."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1568243522, "post_id": 57897314, "comment_id": 102216535, "body": "The first thing I would do in your situation is comment out the problematic <code>#include</code> line to see just how dependent the project is on it. (How many identifiers become undefined when that file is not available?) Best case scenario: the <code>#include</code> is an unused legacy line that no one bothered to remove. Worst case scenario: every function, constant, etc. from <code>sys&#47;uio.h</code> is used somewhere. Find out where you are on this spectrum before designing a plan to overcome the situation."}, {"owner": {"reputation": 21, "user_id": 8172489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tb7NXafAdOo/AAAAAAAAAAI/AAAAAAAAApo/girUi0nAMkM/photo.jpg?sz=128", "display_name": "A.Karwowski", "link": "https://stackoverflow.com/users/8172489/a-karwowski"}, "edited": false, "score": 0, "creation_date": 1568256619, "post_id": 57897314, "comment_id": 102218979, "body": "so commenting the header out allowed the code to compile, but im supposed to pass it a file, but it no longer reads in the file (we are using the xml file of a linux kernel for testing purposes). So although it didnt break any identifiers or dependent functions, it does not work correctly which when shown in class this same file it worked.(But it worked on my machine joke).insert"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568266058, "post_id": 57897314, "comment_id": 102220995, "body": "Then find the place at which the file will be read in. File IO is a pretty old part of C++ libraries, originating back to times when they still were called <i>&#39;standard template libraries&#39;</i> (STL). Have a look at <a href=\"https://en.cppreference.com/w/cpp/header/fstream\" rel=\"nofollow noreferrer\"><code>&lt;fstream&gt;</code> header</a> for more information."}], "owner": {"reputation": 21, "user_id": 8172489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tb7NXafAdOo/AAAAAAAAAAI/AAAAAAAAApo/girUi0nAMkM/photo.jpg?sz=128", "display_name": "A.Karwowski", "link": "https://stackoverflow.com/users/8172489/a-karwowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 853, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568239011, "creation_date": 1568239011, "question_id": 57897314, "link": "https://stackoverflow.com/questions/57897314/fatal-error-when-compiling-include-sys-uio-h-on-project-windows", "title": "Fatal error when compiling #include &lt;sys/uio.h&gt; on project [windows]", "body": "<p>trying to compile a file for class, using the mingw compiler on windows 10. Compiling with g++ gives me an error stating</p>\n\n<pre><code>\\projectFile.o\nmingw32-g++.exe  -o D:\\GitHub\\GitRepo\\projectFile.exe D:\\GitHub\\GitRepo\\projectFile.o   \nD:\\GitRepo\\projectFile.cpp:16:20: fatal error: sys/uio.h: No such file or directory\ncompilation terminated.\n</code></pre>\n\n<p>From what ive read this header file</p>\n\n<pre><code>#include &lt;sys/uio.h&gt;\n</code></pre>\n\n<p>is a unix header and is generally included with most unix build environments. I am working on Windows 10 build and have been unsuccessful in trying to get this to work. Is there a work around for windows using different headers? Is there a while to install this file somehow?</p>\n\n<p>The project is a generalized XML parser that as a student my job is to extract functions from the main file so that they can be reused (OOP design space)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/io.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;ctype.h&gt;\n#include \"XMLParser.hpp\"\n</code></pre>\n\n<p>Built on Windows 10 (lastest build) with Mingw-64  (lastest version)\nThis will not compile for me</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1568241288, "post_id": 57897226, "comment_id": 102216047, "body": "You should take a <code>std::vector&lt;int&gt;</code> pill to make you headaches go away."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23, "user_id": 7935991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fade35e61f3df56a970320f4db3b9be?s=128&d=identicon&r=PG&f=1", "display_name": "k3y_1", "link": "https://stackoverflow.com/users/7935991/k3y-1"}, "edited": false, "score": 0, "creation_date": 1568240672, "post_id": 57897269, "comment_id": 102215896, "body": "@user7935991: I mentioned that in a parenthetical before the main code block. Just add the necessary declaration of <code>array</code> in the <code>private</code> section."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 3, "last_activity_date": 1568239494, "last_edit_date": 1568239494, "creation_date": 1568238825, "answer_id": 57897269, "question_id": 57897226, "link": "https://stackoverflow.com/questions/57897226/how-to-declare-new-private-variables-from-constructor/57897269#57897269", "title": "How to declare new private variables from constructor?", "body": "<p>Classes must have a compile time fixed size, so a true flexible array member isn't possible. The best you could do is either:</p>\n\n<ol>\n<li>Templating the class on the array dimensions (compile time chosen fixed size)</li>\n<li>Using a dynamically resizable type like <code>std::vector&lt;std::vector&lt;int&gt;&gt;</code> to get something functionally similar (runtime dynamically chosen size); the class itself remains fixed size, with the <code>vector</code> storing the dynamically allocated arrays on the free store (heap).</li>\n</ol>\n\n<p>One implementation approach would look something like this (adding a declaration of <code>std::vector&lt;std::vector&lt;int&gt;&gt; array;</code> in the <code>private</code> section of the class declaration):</p>\n\n<pre><code>// Use initializers to initialize directly instead of default initializing, then replacing\nnumcpp::numcpp(int *arr,int *Shape,int Dims) : shape(Shape), dims(Dims), array(shape[0], std::vector&lt;int&gt;(shape[1]))\n{\n    int i = shape[0];\n    int j = shape[1];\n    for (int c = 0; c &lt; i * j; ++c) {\n        array[c / j][c % j] = arr[c];\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7935991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fade35e61f3df56a970320f4db3b9be?s=128&d=identicon&r=PG&f=1", "display_name": "k3y_1", "link": "https://stackoverflow.com/users/7935991/k3y-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 57897269, "answer_count": 1, "score": -1, "last_activity_date": 1568275952, "creation_date": 1568238526, "last_edit_date": 1568275952, "question_id": 57897226, "link": "https://stackoverflow.com/questions/57897226/how-to-declare-new-private-variables-from-constructor", "title": "How to declare new private variables from constructor?", "body": "<p>I want to pass 2-dimensional arrays with different sizes to my class and store the arrays as private member variables.  </p>\n\n<p>When I try to declare the array in the constructor I get an error.  </p>\n\n<p>How should I declare a private variable from constructor? </p>\n\n<p>If it is not possible, what else can I do to make my class <strong>flexible</strong> for different array sizes?  </p>\n\n<p>Here is the <strong>header</strong> file:  </p>\n\n<pre><code>#ifndef NUMCPP_H\n#define NUMCPP_H\n\nclass numcpp\n{\npublic:\n    numcpp(int *Arr,int *Shape,int Dims);\nprivate:\n    int *shape;\n    int dims;\n};\n\n#endif\n</code></pre>\n\n<p>Here is the <strong>source</strong> file:  </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"numcpp.h\"\nusing namespace std;\n\nnumcpp::numcpp(int *Arr,int *Shape,int Dims) // *arr points to input array's first element\n{\n    shape = Shape;\n    dims = Dims;\n    int i = shape[0];\n    int j = shape[1];\n    int numcpp::array[i][j]; // error happens in this line\n    //assigning input array to our variable\n    for (int x = 0; x &lt; i; x++)\n    {\n        for (int y = 0; y &lt; j; y++)\n        {\n            array[x][y] = *(arr + (x * i) + y);\n        };\n    };\n};\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio", "windows-ce", "wmdc"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568237980, "post_id": 57897093, "comment_id": 102215270, "body": "Don&#39;t forget to add an additional blank line between paragraphs or it just jams together into a huge wall of words."}, {"owner": {"reputation": 2333, "user_id": 6783775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d399a7e1545b42ae65bca9b4568099a?s=128&d=identicon&r=PG", "display_name": "rveerd", "link": "https://stackoverflow.com/users/6783775/rveerd"}, "edited": false, "score": 0, "creation_date": 1570631163, "post_id": 57897093, "comment_id": 102974619, "body": "Is the correct debugger selected in Project &gt; Properties &gt; Configuration Properties &gt; Debugging &gt; Debugger to launch?"}, {"owner": {"reputation": 29, "user_id": 6140823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72be293d57676176ddc18bd170908c9?s=128&d=identicon&r=PG&f=1", "display_name": "atomic928", "link": "https://stackoverflow.com/users/6140823/atomic928"}, "edited": false, "score": 0, "creation_date": 1570724916, "post_id": 57897093, "comment_id": 103013006, "body": "Yes, under &#39;Debugger to launch:&#39; there is a drop down with only one option &quot;Smart Device Native Debugger&quot;."}], "owner": {"reputation": 29, "user_id": 6140823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f72be293d57676176ddc18bd170908c9?s=128&d=identicon&r=PG&f=1", "display_name": "atomic928", "link": "https://stackoverflow.com/users/6140823/atomic928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568237994, "creation_date": 1568237673, "last_edit_date": 1568237994, "question_id": 57897093, "link": "https://stackoverflow.com/questions/57897093/visual-studio-only-connects-to-remote-device-via-wmdc-one-time", "title": "Visual Studio only connects to remote device via WMDC one time", "body": "<p>I have both Visual Studio 2005 and 2008 installed on my main PC dev machine. I had a project that I could connect to a Wince5.0 device and debug via vs08 about 5 months ago. Now the same project will not debug the project, I am getting a \"Unable to start debugging\" window from VS after the connection is made and the exe deployed.</p>\n\n<p>I can connect to the device, via WMDC. I can see all the files and etc to the remote device. VS will download the application but will just not start debugging. I take the exact same project compile it and run it from VS 2005 and I can debug.</p>\n\n<p>Also what I have found is that if I create a new project from VS2008 it will deploy and debug as long as I do not close VS2008. Once I shut down VS08 and reopen the project the \"Unable to start debugging\" message will appear on ever deploy.</p>\n\n<p>I've tried everything I can think of and have read on, change security settings, look at registry on the device and etc. It just seems to be some VS2008 issue that just started.</p>\n"}, {"tags": ["c++", "arrays", "while-loop", "char", "conditional-statements"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1568237680, "post_id": 57897048, "comment_id": 102215196, "body": "This <code>name == EOFNAME</code> won&#39;t do what you are expecting."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568237748, "post_id": 57897048, "comment_id": 102215218, "body": "sadly you cannot compare arrays like that. The compiler thinks you are trying to compare their addresses, not their contents. May I recommend using <code>std:: string</code> instead of arrays? If <code>std::array</code> is not permitted, you will need to use <code>strcmp</code> or perform a character by character comparison with a loop of your own making."}], "answers": [{"tags": [], "owner": {"reputation": 4579, "user_id": 459565, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cc92778353971733be88d04c26603ec7?s=128&d=identicon&r=PG", "display_name": "Eugene", "link": "https://stackoverflow.com/users/459565/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1568237624, "creation_date": 1568237624, "answer_id": 57897081, "question_id": 57897048, "link": "https://stackoverflow.com/questions/57897048/why-is-my-char-array-condition-not-working/57897081#57897081", "title": "Why is my char array condition not working", "body": "<p>It is not working because to compare <code>char</code> arrays you need <code>strcmp</code> function, e.g. <code>strcmp(name, EOFNAME)!=0</code>. Your <code>name!=EOFNAME</code> just compares pointers to the beginning of the arrays, and the pointers are never equal. </p>\n\n<p>But in more idiomatic C++, you can declare your variables <code>std::string</code> instead of <code>char [10]</code>. Then you can use <code>name!=EOFNAME</code> condition.</p>\n"}], "owner": {"reputation": 1, "user_id": 12055322, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zpV7GLiKmFQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rew6nHJ63q_4we26K4R8sXwrfR_7g/photo.jpg?sz=128", "display_name": "Fox at Fun 3", "link": "https://stackoverflow.com/users/12055322/fox-at-fun-3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "closed_date": 1568237829, "answer_count": 1, "score": 0, "last_activity_date": 1568241688, "creation_date": 1568237391, "last_edit_date": 1568241688, "question_id": 57897048, "link": "https://stackoverflow.com/questions/57897048/why-is-my-char-array-condition-not-working", "closed_reason": "Duplicate", "title": "Why is my char array condition not working", "body": "<p>I'm doing an assignment for my intro to cis. one of the conditions was that if at anytime the name variable matched the EOFNAME variable that the program would quit. I made a char array so i could store a name and if instead of putting your name you put quit it would exit. I made the program and compiled it ran without issue except when you put in Quit it doesn't it just continues and uses that as the name variable </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>char name[10];\nchar EOFNAME[10] = \"Quit\";\n\nvoid housekeeping()\n{\n    do{ cout &lt;&lt; \"Enter first name or \" &lt;&lt; EOFNAME &lt;&lt; \" to quit this session\" &lt;&lt; endl;\n    cin &gt;&gt; name;\n    cin.get();\n    if ( name != EOFNAME)\n    {\n        mainloop();\n    }\n    else if(name == EOFNAME)\n    {\n       break;\n    }\n\n   }while(name != EOFNAME);\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "gdi"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1568241170, "post_id": 57896962, "comment_id": 102216012, "body": "<code>BITMAPINFO</code> is a variable-sized structure. You didn&#39;t reserve enough space for the color table."}, {"owner": {"reputation": 115, "user_id": 11843219, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0jF2_RtxE6Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwGe4nlBX3JyqqDYIx3CWLo65iAg/photo.jpg?sz=128", "display_name": "TippuR", "link": "https://stackoverflow.com/users/11843219/tippur"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1568244162, "post_id": 57896962, "comment_id": 102216671, "body": "Thank you! I fixed the bug by allocating enough memory. But now the newly created image is not getting printed on window."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1568250388, "post_id": 57896962, "comment_id": 102217788, "body": "Then this problem is solved, and you have a new problem. You should open a new question."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11843219, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0jF2_RtxE6Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwGe4nlBX3JyqqDYIx3CWLo65iAg/photo.jpg?sz=128", "display_name": "TippuR", "link": "https://stackoverflow.com/users/11843219/tippur"}, "edited": false, "score": 0, "creation_date": 1568305680, "post_id": 57898058, "comment_id": 102241481, "body": "I don&#39;t see loading image into the memory and creating image from it. The whole requirement is creating bitmap from buffer."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 115, "user_id": 11843219, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0jF2_RtxE6Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwGe4nlBX3JyqqDYIx3CWLo65iAg/photo.jpg?sz=128", "display_name": "TippuR", "link": "https://stackoverflow.com/users/11843219/tippur"}, "edited": false, "score": 0, "creation_date": 1568323760, "post_id": 57898058, "comment_id": 102248241, "body": "You don&#39;t need to do this.  You can simply draw the bitmap loaded from the file - that&#39;s the whole point of my answer, try it."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 1, "last_activity_date": 1568313630, "last_edit_date": 1568313630, "creation_date": 1568245667, "answer_id": 57898058, "question_id": 57896962, "link": "https://stackoverflow.com/questions/57896962/createbitmap-image-is-not-printing-on-window/57898058#57898058", "title": "CreateBitmap image is not printing on window", "body": "<p>Your code can be considerably simplified.  There is no need to call <code>GetDIBits</code> (which you are doing before you set up <code>hdcSource</code> anyway), and you should clean up properly and minimise the use of static variables.  Something like the following (error checking omitted for clarity):</p>\n\n<pre><code>LRESULT CALLBACK WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)\n{\n    static HBITMAP bmpSource;\n\n    if (Msg == WM_CREATE) {\n        bmpSource = (HBITMAP)LoadImage(NULL, L\"bmp00004.bmp\", IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE );\n        return 0;\n    }\n\n    if (Msg == WM_PAINT) {\n        PAINTSTRUCT ps;\n        HDC hdcDestination = BeginPaint(hWnd, &amp;ps); \n        BITMAP bm;\n        GetObject(bmpSource, sizeof(bm), &amp;bm);  \n        HDC hdcSource = CreateCompatibleDC(hdcDestination);\n        HGDIOBJ hOldBmp = SelectObject(hdcSource, bmpSource);\n\n        BitBlt(hdcDestination, 0, 0,bm.bmWidth , bm.bmHeight, hdcSource, 0, 0, SRCCOPY);\n\n        SelectObject(hdcSource, hOldBmp);\n        DeleteDC(hdcSource);\n        EndPaint(hWnd, &amp;ps);\n        return 0;\n    }\n\n     if (Msg == WM_DESTROY)\n          DeleteObject(bmpSource);\n\n     return DefWindowProc(hWnd, Msg, wParam, lParam); \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1568336232, "last_edit_date": 1568336232, "creation_date": 1568330085, "answer_id": 57915519, "question_id": 57896962, "link": "https://stackoverflow.com/questions/57896962/createbitmap-image-is-not-printing-on-window/57915519#57915519", "title": "CreateBitmap image is not printing on window", "body": "<p>It seems you are attempting to read a bitmap file and write to another <code>HBITMAP</code> handle, for whatever reason...</p>\n\n<p><code>LoadImage</code> returns a compatible bitmap (unless you specify <code>LR_CREATEDIBSECTION</code>), therefore you need <code>CreateCompatibleBitmap</code> followed by <code>SetDIBits</code> to duplicate that source bitmap.</p>\n\n<p>For some reason you have declared <code>BITMAPINFO bminfo[2]</code> But you only need one <code>bminfo</code> object. You need <code>new</code> or <code>malloc</code> to allocate enough memory for one object. Note that you cannot randomly swap arrays for pointers and vice-versa. If you used a debugger you would notice the functions failed and <code>bminfo</code> was not properly filled.</p>\n\n<p>It's easier if you setup <code>BITMAPINFOHEADER</code> yourself, rather than let <code>GetDIBits</code> fill that parameter:</p>\n\n<pre><code>LRESULT CALLBACK WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)\n{\n    static HDC hdc_memory;\n    static HBITMAP hbmp_src;\n    static HBITMAP hbmp_dst;\n    static BITMAP bm;\n\n    if(Msg == WM_CREATE) \n    {\n        hbmp_src = (HBITMAP)LoadImage(NULL, L\"file.bmp\", \n                    IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE);\n\n        HDC hdc = GetDC(0);\n        hdc_memory = CreateCompatibleDC(hdc);\n\n        GetObject(hbmp_src, sizeof(bm), &amp;bm);\n        int w = bm.bmWidth;\n        int h = bm.bmHeight;\n        if(h &lt; 0) h = -h;\n        int size = ((w * bm.bmBitsPixel + 31) / 32) * 4 * h;\n        BITMAPINFOHEADER bi = { sizeof(bi), w, h, bm.bmPlanes, bm.bmBitsPixel };\n        BYTE* bits = new BYTE[size];\n\n        GetDIBits(hdc, hbmp_src, 0, h, bits, (BITMAPINFO*)&amp;bi, DIB_RGB_COLORS);\n        //change the pixel data in bits if that's your goal ...\n        hbmp_dst = CreateCompatibleBitmap(hdc, w, h);\n        SetDIBits(hdc, hbmp_dst, 0, h, bits, (BITMAPINFO*)&amp;bi, DIB_RGB_COLORS);\n        SelectObject(hdc_memory, hbmp_dst);\n\n        delete[] bits;\n        ReleaseDC(0, hdc);\n        return 0;\n    }\n    else if(Msg == WM_PAINT) \n    {\n        PAINTSTRUCT ps;\n        HDC hdc = BeginPaint(hWnd, &amp;ps);\n        BitBlt(hdc, 0, 0, bm.bmWidth, bm.bmHeight, hdc_memory, 0, 0, SRCCOPY);\n        EndPaint(hWnd, &amp;ps);\n        return 0;\n    }\n    else if(Msg == WM_DESTROY) \n    {\n        DeleteDC(hdc_memory);\n        DeleteObject(hbmp_src);\n        DeleteObject(hbmp_dst);\n        PostQuitMessage(0);\n        return 0;\n    }\n    return DefWindowProc(hWnd, Msg, wParam, lParam);\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11843219, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0jF2_RtxE6Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwGe4nlBX3JyqqDYIx3CWLo65iAg/photo.jpg?sz=128", "display_name": "TippuR", "link": "https://stackoverflow.com/users/11843219/tippur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 57898058, "answer_count": 2, "score": -1, "last_activity_date": 1568336232, "creation_date": 1568236927, "last_edit_date": 1568305196, "question_id": 57896962, "link": "https://stackoverflow.com/questions/57896962/createbitmap-image-is-not-printing-on-window", "title": "CreateBitmap image is not printing on window", "body": "<p>I need to load a bmp image from file and load image data into buffer and then create new image from it. (I have a reason for doing this way).  I wrote a sample program to mimic my project scenario. </p>\n\n<pre><code>     LRESULT CALLBACK WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)\n{\n     static BITMAP  bm;\n     static HBITMAP bmpSource = NULL;\n     static HBITMAP hbmp=NULL;\n     static HDC hdcSource = NULL;\n     static HDC hdcDestination= NULL;\n     static PAINTSTRUCT ps;\n     BITMAPINFO bitmap_info[2] = {0};\n\n      if (Msg == WM_CREATE) {\n       bmpSource = (HBITMAP)LoadImage(NULL, L\"bmp00004.bmp\", IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE );\n\n       GetObject(bmpSource, sizeof(BITMAP), &amp;bm);  \n\n       bitmap_info-&gt;bmiHeader.biSize = sizeof(bitmap_info-&gt;bmiHeader);\n       int ret = GetDIBits(hdcSource, bmpSource, 0, bm.bmHeight, NULL, bitmap_info,DIB_RGB_COLORS);\n\n       LPVOID *lpvBits = (LPVOID*) malloc(3*(bm.bmWidth * bm.bmHeight * sizeof(DWORD)));\n       int gotData = GetDIBits(hdcSource, bmpSource, 0,bm.bmHeight,lpvBits, bitmap_info, DIB_RGB_COLORS);\n\n       hbmp = (HBITMAP) CreateBitmap(bm.bmWidth, bm.bmHeight, bm.bmPlanes, bm.bmBitsPixel ,lpvBits);\n        hdcSource = CreateCompatibleDC(GetDC(0));\n        SelectObject(hdcSource, hbmp);\n       return 0;\n\n     }else if (Msg == WM_PAINT) {\n       hdcDestination = BeginPaint(hWnd, &amp;ps); \n       BitBlt(hdcDestination, 0, 0,bm.bmWidth , bm.bmHeight, hdcSource, 0, 0, SRCCOPY);\n\n        EndPaint(hWnd, &amp;ps);\n       return 0;\n     }else if (Msg == WM_DESTROY) {\n        DeleteDC(hdcSource);\n        EndPaint(hWnd, &amp;ps);\n        DeleteObject(bmpSource);\n        DeleteObject(hbmp);\n     }\n     return DefWindowProc(hWnd, Msg, wParam, lParam); \n}\n\n</code></pre>\n\n<p>I am expecting program to print the image on the window.\nNow the newly created image is not displayed on window. All I can see is a gray box.</p>\n"}, {"tags": ["c++", "g++", "clang", "clang++"], "comments": [{"owner": {"reputation": 530, "user_id": 2793551, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a73981082fd79398252211805c9146e6?s=128&d=identicon&r=PG&f=1", "display_name": "WaltK", "link": "https://stackoverflow.com/users/2793551/waltk"}, "edited": false, "score": 0, "creation_date": 1569353668, "post_id": 57896535, "comment_id": 102567786, "body": "I tried a similar experiment within a large executable (Apache Trafficserver) built and run on Linux, and the vague linkage worked fine.  So it seems that there are unknown factors that contribute to this problem occurring."}], "owner": {"reputation": 530, "user_id": 2793551, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a73981082fd79398252211805c9146e6?s=128&d=identicon&r=PG&f=1", "display_name": "WaltK", "link": "https://stackoverflow.com/users/2793551/waltk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568312565, "creation_date": 1568234470, "last_edit_date": 1568312565, "question_id": 57896535, "link": "https://stackoverflow.com/questions/57896535/why-does-vague-linkage-seem-to-work-for-dynamically-linked-libraries-using-clang", "title": "Why does vague linkage seem to work for dynamically linked libraries using clang on MacOS but not using gcc on Linux?", "body": "<p>Here is some code I built and ran on Linux using gcc:</p>\n\n<pre><code>+ cat foo.h\n#pragma once\n\ninline int foo()\n{\n  static int static_local;\n  return ++static_local;\n}\n+ cat lib.cc\n#include \"foo.h\"\n\nextern \"C\" void lib();\n\nvoid lib()\n{\n  static_cast&lt;void&gt;(foo());\n}\n+ cat main.cc\n#include &lt;cstdlib&gt;\n\n#include &lt;iostream&gt;\n\n#include &lt;dlfcn.h&gt;\n\n#include \"foo.h\"\n\nint main()\n{\n  void *lib_handle = dlopen(\"./lib.a\", RTLD_NOW);\n\n  if (!lib_handle) {\n    std::cout &lt;&lt; \"dlopen() failed: \" &lt;&lt; dlerror() &lt;&lt; '\\n';\n\n    std::exit(1);\n  }\n\n  void *func = dlsym(lib_handle, \"lib\");\n\n  if (func) {\n    reinterpret_cast&lt;void (*)()&gt;(func)();\n\n  } else {\n    const char *err = dlerror();\n\n    if (!err) {\n      std::cout &lt;&lt; \"lib() not found\\n\";\n    } else {\n      std::cout &lt;&lt; \"dlsym() fail: \" &lt;&lt; err &lt;&lt; '\\n';\n    }\n  }\n\n  // Should output 2.\n  //\n  std::cout &lt;&lt; foo() &lt;&lt; '\\n';\n\n  dlclose(lib_handle);\n\n  return 0;\n}\n+ CMN_OPTS='-O2 -Wall -Wextra -pedantic -std=c++17'\n+ cc -O2 -Wall -Wextra -pedantic -std=c++17 -DLIB -fPIC -c lib.cc\n+ cc -O2 -Wall -Wextra -pedantic -std=c++17 -shared lib.o -o lib.a\n+ cc -O2 -Wall -Wextra -pedantic -std=c++17 -c main.cc\n+ cc -O2 -Wall -Wextra -pedantic -std=c++17 main.o -lstdc++ -ldl -o main\n+ ./main\n1\n</code></pre>\n\n<p>Both lib.o and main.o should have a vague linkage section containing the static_local variable that's local to the foo() function.  This output indicates that vague linkage is not happening.  However, if I do the same thing on MacOS using clang, the output of main is 2, which indicates that the vague linkage <strong>does</strong> occur.  (The version of gcc is 8.3.1 and the version of clang is Apple 11.0.0.  The code files are at <a href=\"https://github.com/ywkaras/MiscRepo/tree/master/VagueDynLink\" rel=\"nofollow noreferrer\">https://github.com/ywkaras/MiscRepo/tree/master/VagueDynLink</a> .)</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568234631, "post_id": 57896527, "comment_id": 102214222, "body": "Can&#39;t reproduce: <a href=\"https://gcc.godbolt.org/z/jtmgbB\" rel=\"nofollow noreferrer\">gcc.godbolt.org/z/jtmgbB</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1568234645, "post_id": 57896527, "comment_id": 102214232, "body": "You could save yourself all of the hassle and switch to using <code>ptrdiff_t</code> instead of <code>size_t</code> for the index.  Yes, you lose 1 bit a values, but 63 bits of index is still a lot."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568234726, "post_id": 57896527, "comment_id": 102214257, "body": "@NathanOliver that wouldn&#39;t be right, since <code>std::vector</code> wants <code>size_t</code> for indexing."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568234915, "post_id": 57896527, "comment_id": 102214315, "body": "@SergeyA: Actually std::vector wants std::vector::size_type for indexing. Let&#39;s be sensible, use ptrdiff_t for this, pretty please, with sugar on top."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1568235164, "post_id": 57896527, "comment_id": 102214401, "body": "@Bathsheba which is <code>size_t</code>. The point I am making that if the compiler is so uptight regarding signed to unsigned conversions (which I could not reproduce so far!) I&#39;d expect it to be equally uptight when you use signed value when unsigned is expected."}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 1, "creation_date": 1568235401, "post_id": 57896527, "comment_id": 102214507, "body": "Just don&#39;t compile with <code>-Wsign-conversion</code>, and add the signed number that gets converted, because <code>((size_t) 10) + ((size_t) -1) == (size_t) 9</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1568235433, "post_id": 57896527, "comment_id": 102214517, "body": "@SergeyA: Which <i>might</i> be <code>size_t</code>. Point I&#39;m trying to make is that using <code>ptrdiff_t</code> is no worse really than using <code>size_t</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1568238094, "post_id": 57896527, "comment_id": 102215299, "body": "Don&#39;t assume that <code>size_t</code> is <code>unsigned long long</code>. <code>size_t</code> is defined as some implementation-defined unsigned integer type. It&#39;s either <code>unsigned int</code> or <code>unsigned long</code> on the implementations I&#39;ve tried."}], "answers": [{"comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1568237222, "post_id": 57896871, "comment_id": 102215075, "body": "<i>&quot;explicit conversion ... more error prone ... don&#39;t enable the warning&quot;</i> Alternatively, something like <code>x += decltype(x)(y);</code>."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1568237289, "post_id": 57896871, "comment_id": 102215090, "body": "@HolyBlackCat I guess that would work. I wouldn&#39;t let it touch my code base though :)"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1568237526, "last_edit_date": 1568237526, "creation_date": 1568236407, "answer_id": 57896871, "question_id": 57896527, "link": "https://stackoverflow.com/questions/57896527/proper-way-to-add-an-int-to-a-size-t/57896871#57896871", "title": "Proper way to add an int to a size_t", "body": "<blockquote>\n  <p>this doesn't seem correct because the cast-to value is definitely not equal to -1 anymore.</p>\n</blockquote>\n\n<p>As far as the result of the addition is concerned, it doesn't matter that it is no longer -1. It is still congruent with -1 modulo M <sup>1</sup>, so the unsigned addition has the correct result.</p>\n\n<p><sup>1</sup> M is number of representable values.</p>\n\n<blockquote>\n  <p>So, is there a proper way to add a negative number to a size_t?</p>\n</blockquote>\n\n<p>You can do exactly what is done in the example. It is proper.</p>\n\n<p>If you wanted to keep the warning enabled, and wanted to silence it, then you could do the explicit conversion. But this is actually more error prone, since if you accidentally convert to a wrong unsigned type (which may happen due to refactoring), the assumption above no longer holds. For this reason, you should also avoid storing the converted unsigned value in an intermediary variable. I recommend that you don't enable the warning option in question.</p>\n\n<hr>\n\n<p>As discussed in the comments, since you're using <code>size_t</code>, you may want to consider using <code>ptrdiff_t</code> as the offset type so that you can have offset to any index.</p>\n\n<p>Even more appropriate since you're indexing <code>vector</code> would be to use <code>vector::size_type</code> and <code>vector::difference_type</code> although in practice they are likely to be the same as <code>size_t</code> and <code>ptrdiff_t</code>.</p>\n"}], "owner": {"reputation": 4010, "user_id": 1812187, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MRXi9.png?s=128&g=1", "display_name": "Carlton", "link": "https://stackoverflow.com/users/1812187/carlton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 57896871, "answer_count": 1, "score": 1, "last_activity_date": 1568237526, "creation_date": 1568234434, "question_id": 57896527, "link": "https://stackoverflow.com/questions/57896527/proper-way-to-add-an-int-to-a-size-t", "title": "Proper way to add an int to a size_t", "body": "<p>I get the Clang warning \"implicit conversion changes signedness\" about the following code:</p>\n\n<pre><code>size_t x = 10;\nint y = -1;\nx += y;\n</code></pre>\n\n<p><code>x</code> is an index to a std::vector, so it makes sense that it should be an unsigned long long (a.k.a. size_t), but <code>y</code> is an offset that may be positive or negative, and thus needs to be signed. I can cast <code>y</code> to a size_t which silences the warning and produces the correct result, however this doesn't seem correct because the cast-to value is definitely not equal to -1 anymore. So, is there a proper way to add a negative number to a size_t?</p>\n"}, {"tags": ["c++", "memory", "stdstring"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568234377, "post_id": 57896398, "comment_id": 102214109, "body": "Somewhere inside the <code>std::string</code> there should be a pointer to the actual data. However, the memory layout of <code>std::string</code> is not standardized so that pointer could be anywhere. And that location could change from process to process, depending on what <code>std::string</code> was used."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568234494, "post_id": 57896398, "comment_id": 102214159, "body": "This is pretty similar to the question <a href=\"https://stackoverflow.com/questions/57876214/explicit-conversion-from-stdstring-object-to-char-without-using-any-of-stds\">Explicit conversion from std::string object to char* without using any of std::string member functions</a> from yesterday."}, {"owner": {"reputation": 11, "user_id": 12055134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAqGdI4wrzgTzRjg96-K1hE7QpyVH8T_oBwpHmyRw=k-s128", "display_name": "Jowen", "link": "https://stackoverflow.com/users/12055134/jowen"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568234589, "post_id": 57896398, "comment_id": 102214208, "body": "&quot;Somewhere inside the std::string there should be a pointer to the actual data.&quot; How do i find that pointer? By manually searching for it or?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1568237055, "post_id": 57896398, "comment_id": 102215026, "body": "Do you need the pointer or what the pointer is pointing to?  See <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/data\" rel=\"nofollow noreferrer\">std::string::data()</a>, for a function that returns a pointer to the data."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568252580, "post_id": 57896398, "comment_id": 102218270, "body": "@Jowen Usually you don&#39;t use it. You use the class interface and use the appropriate member function (for example <code>std::string::data()</code>). But since you are accessing another process&#39; data, there isn&#39;t a easy built-in way of doing it."}], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": 0, "last_activity_date": 1587181896, "creation_date": 1587181896, "answer_id": 61284040, "question_id": 57896398, "link": "https://stackoverflow.com/questions/57896398/how-do-i-read-a-stdstring-from-memory-using-rpm/61284040#61284040", "title": "How do i read a std::string from memory using RPM", "body": "<p>std::string is a container, offset 0x14 is the size of the char array which it manages.  If the string is less than 15 characters, the second variable (offset 0x4 or 0x8 depending on x86/x64) is the char array itself.  If it's more than 15 characters, this variable turns into a pointer to the char array which is allocated dynamically</p>\n\n<p>We can use this information to read the string externally, it's a hack but it works</p>\n\n<p>Here some sample code which shows you how it's done:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nvoid ReadExternalString(HANDLE hProc, uintptr_t addr, char* dstArray)\n{\n\n    unsigned int arraySize;\n    //Get the size of the array, offset 0x14 is the size of the array\n    ReadProcessMemory(hProc, (BYTE*)(addr + 0x14), &amp;arraySize, sizeof(arraySize), 0);\n\n    if (arraySize &gt; 15)\n    {\n        uintptr_t addrOfCharArray;\n        //dereference the pointer in the second member variable to get the dynamic address of the array\n        ReadProcessMemory(hProc, (BYTE*)(addr + sizeof(void*)), &amp;addrOfCharArray, sizeof(void*), 0);\n\n        char buffer[500];\n        //Read the array into buffer, +1 to get the null terminator\n        ReadProcessMemory(hProc, (BYTE*)(addrOfCharArray), &amp;buffer, arraySize + 1, 0);\n\n        //copy the buffer into our ouput argument\n        memcpy(dstArray, &amp;buffer, strlen(buffer) + 1);\n    }\n    else\n    {\n        ReadProcessMemory(hProc, (BYTE*)(addr + sizeof(void*)), dstArray, arraySize, 0);\n    }\n}\n\nint main()\n{\n\n    int processNumber;\n    cout &lt;&lt; \"Enter the process number\" &lt;&lt; endl;\n    cin &gt;&gt; processNumber;\n    for (;;)\n    {\n        uintptr_t memoryAddress = 0x0;\n        cout &lt;&lt; \"Enter memoryAddress\" &lt;&lt; endl;\n        cin &gt;&gt; hex &gt;&gt; memoryAddress;\n        cout &lt;&lt; hex &lt;&lt; memoryAddress &lt;&lt; endl;\n\n        HANDLE hProcess = OpenProcess(PROCESS_VM_READ, FALSE, processNumber);\n        if (hProcess == NULL) { // Failed to get a handle\n            cout &lt;&lt; \"OpenProcess failed. GetLastError = \" &lt;&lt; dec &lt;&lt; GetLastError() &lt;&lt; endl;\n            system(\"pause\");\n            return EXIT_FAILURE;\n        }\n\n        char* cString = new char[500];\n\n        ReadExternalString(hProcess, memoryAddress, cString);\n\n        cout &lt;&lt; \"string char array = \" &lt;&lt; cString &lt;&lt; endl;\n        system(\"pause\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12055134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAqGdI4wrzgTzRjg96-K1hE7QpyVH8T_oBwpHmyRw=k-s128", "display_name": "Jowen", "link": "https://stackoverflow.com/users/12055134/jowen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1587181896, "creation_date": 1568233786, "question_id": 57896398, "link": "https://stackoverflow.com/questions/57896398/how-do-i-read-a-stdstring-from-memory-using-rpm", "title": "How do i read a std::string from memory using RPM", "body": "<p>Okay, so recently i've been working witth RPM(ReadProccesMemory). But while doing so i bumped into the issue of not being able to read a string the way i wanted it.</p>\n\n<p>This is what i heard/know:\nI know, when reading a std::string, i get the memory adress of the string OBJECT and not the adress that contains the actual text.I am also aware of \"Small String Optimization\", and what it does in theory.</p>\n\n<p>I'd like to be able to read the contents of varString(DefaultString) without changing the code of my dummy program(if possible).</p>\n\n<p>The dummy program im reading:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int main() {\n    // Variables &amp; Pointers\n    int varInt = 123456;\n    string varString = \"DefaultString\";\n    cout &lt;&lt; sizeof(varString);\n    char arrChar[128] = { \"Long char array right there -&gt;\" };\n    int* ptr2int = &amp;varInt;\n    int** ptr2ptr = &amp;ptr2int;\n    int*** ptr2ptr2 = &amp;ptr2ptr;\n\n    // Printing them out\n    while (true){\n    cout &lt;&lt; \"Process ID: \" &lt;&lt; GetCurrentProcessId() &lt;&lt; endl &lt;&lt; endl;\n    cout &lt;&lt; \"varInt (0x\" &lt;&lt; &amp;varInt &lt;&lt; \") = \" &lt;&lt; varInt &lt;&lt; endl;\n    cout &lt;&lt; \"varString (\" &lt;&lt; reinterpret_cast&lt;const void*&gt;(varString.data()) &lt;&lt; \") = \" &lt;&lt; varString &lt;&lt; endl;\n    cout &lt;&lt; \"arrChar (0x\" &lt;&lt; &amp;arrChar &lt;&lt; \") = \" &lt;&lt; arrChar &lt;&lt; endl &lt;&lt; endl;\n\n    cout &lt;&lt; \"ptr2int (0x\" &lt;&lt; &amp;ptr2int &lt;&lt; \") = \" &lt;&lt; &amp;varInt &lt;&lt; endl;\n    cout &lt;&lt; \"ptr2ptr (0x\" &lt;&lt; &amp;ptr2ptr &lt;&lt; \") = \" &lt;&lt; &amp;ptr2int &lt;&lt; endl;\n    cout &lt;&lt; \"ptr2ptr2 (0x\" &lt;&lt; &amp;ptr2ptr2 &lt;&lt; \") = \" &lt;&lt; &amp;ptr2ptr &lt;&lt; endl &lt;&lt; endl;\n    break;\n    }\n\n    cin.get();\n    return 0;\n}\n</code></pre>\n\n<p>What im currently doing(wont work as intended):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void reading_string(HANDLE handle_procces) {\n    uintptr_t memoryAdress_2 = 0x0;\n    cout &lt;&lt; \"Please write down the memory adress of \\\"varString\\\" &gt; \" &lt;&lt; flush;\n    cin &gt;&gt; hex &gt;&gt; memoryAdress_2;\n\n    string read_string_object;\n    ReadProcessMemory(handle_procces, (LPCVOID)memoryAdress_2, &amp;read_string_object, sizeof(string), NULL);\n    cout &lt;&lt; \"The value of this memory adress is: \" &lt;&lt; read_string_object &lt;&lt; endl;\n}\n\n</code></pre>\n"}, {"tags": ["c++", "design-patterns", "iterator"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568233480, "post_id": 57896263, "comment_id": 102213839, "body": "<i>So my question is, is this a poor way to construct an iterator in this situation, and is there a better way?</i> I&#39;m leaning towards yes and IDK without seeing how this collection is actually implemented."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568233750, "post_id": 57896263, "comment_id": 102213929, "body": "@NathanOliver Added a bit more information."}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1568233751, "creation_date": 1568233751, "answer_id": 57896387, "question_id": 57896263, "link": "https://stackoverflow.com/questions/57896263/good-design-pattern-for-multifaceted-iterator/57896387#57896387", "title": "good design pattern for multifaceted iterator?", "body": "<p>You might split your class to have iterator interface on one side, and specific interface on the other side:</p>\n\n<pre><code>class FunnyWrapper\n{\n    FunnyCollection* _ctx;\n    unsigned int _i;\npublic:\n    const TypeA&amp; thingA() const;\n    const TypeB&amp; thingB() const;\n    const TypeC&amp; thingC() const;\n\n    // ...\n\n    // trick to use operator -&gt; in iterator.\n    FunnyWrapper* operator -&gt;() { return this; }\n};\n\nclass FunnyCollectionIter\n{\n    FunnyCollection* _ctx;\n    unsigned int _i;\n\n  public:\n    FunnyCollectionIter();\n\n    FunnyCollectionIter&amp; operator=(const FunnyCollectionIter &amp;rhs);\n    FunnyCollectionIter&amp; operator++();\n    bool operator==(const FunnyCollectionIter &amp;rhs) const;\n    // ...\n\n    FunnyWrapper operator-&gt;() { return FunnyWrapper{_ctx, _i}; }\n    FunnyWrapper operator*() { return FunnyWrapper{_ctx, _i}; }\n};\n</code></pre>\n"}], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568233783, "creation_date": 1568233154, "last_edit_date": 1568233783, "question_id": 57896263, "link": "https://stackoverflow.com/questions/57896263/good-design-pattern-for-multifaceted-iterator", "title": "good design pattern for multifaceted iterator?", "body": "<p>[Apologies if this question seems opinionated or discussionworthy.]</p>\n\n<p>I have a class which, although not a collection class per se, does contain an arbitrary number of elements which are primarily constructed via an 'append' method:</p>\n\n<pre><code>append(TypeA thingA, TypeB thingB, TypeC thingC);\n</code></pre>\n\n<p>Significantly, there is <em>not</em> an auxiliary struct or class anywhere tying together a triple of (<code>thingA</code>, <code>thingB</code>, <code>thingC</code>), nor has one been needed so far -- the class works fine as-is.</p>\n\n<p>Today I decided I needed an iterator for this class, that could return all the things I'd added to it, almost as if it were a collection, after all.  The question is, what's the best way to return <code>thingA</code>, <code>thingB</code>, and <code>thingC</code>?</p>\n\n<p>I <em>could</em> belatedly define an auxiliary tuple struct, just so that the iterator could return instances of it.  But this seemed a little odd.</p>\n\n<p>What I implemented instead was something along the lines of</p>\n\n<pre><code>class FunnyCollectionIter {\n    FunnyCollection* _ctx;\n    unsigned int _i;\n\n  public:\n    FunnyCollectionIter();\n\n    const TypeA&amp; thingA() const;\n    const TypeB&amp; thingB() const;\n    const TypeC&amp; thingC() const;\n\n    FunnyCollectionIter&amp; operator=(const FunnyCollectionIter &amp;rhs);\n    FunnyCollectionIter&amp; operator++();\n    bool operator==(const FunnyCollectionIter &amp;rhs) const;\n    // ...\n    }\n};\n</code></pre>\n\n<p>And I'm using it with code like this:</p>\n\n<pre><code>FunnyCollectionIter it;\nfor(it = funnycollection.begin(); it != funnycollection.end(); ++it) {\n    // now do things with it.thingA(), it.thingB(), and it.thingC()        \n }\n</code></pre>\n\n<p>But this seems a little odd, too.  Normally (in the STL, at least) you access an iterator either using <code>*</code>, or <code>-&gt;first</code> and <code>-&gt;second</code>.  But in the scheme I've implemented, there's no <code>*</code>, no <code>-&gt;</code>, no <code>first</code> and <code>second</code> (let alone <code>third</code>?), and the interesting names <code>thingA</code>, <code>thingB</code>, and <code>thingC</code> are methods to invoke, not members to access.</p>\n\n<p>So my question is, is this a poor way to construct an iterator in this situation, and is there a better way?</p>\n\n<p>If it helps, the class is actually a scheduler.  The three \"things\" in question are a duration, a callback, and an optional name.  The caller constructs a schedule via one or more calls to <code>append()</code>, and then normally the schedule just runs, but now I have a need for the caller to be able to review the just-constructed schedule.  (This is the same class I was referring to in <a href=\"https://stackoverflow.com/questions/57879245/sigc-unbind-or-deconstruct-a-functor\">this other question</a>.)</p>\n"}, {"tags": ["python", "c++", "go", "cgo", "pybind11"], "comments": [{"owner": {"reputation": 1069, "user_id": 3283333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2363a3623beb1efba518c1896bc92e66?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3283333/christian"}, "edited": false, "score": 1, "creation_date": 1568636309, "post_id": 57896135, "comment_id": 102325207, "body": "I&#39;m guessing your problem comes from differences at compilation between C and C++ compilers. To correctly call C functions, make sure they are &quot;embedded&quot; within <code>extern &quot;C&quot;</code> <a href=\"https://stackoverflow.com/a/1041880/3283333\">see this answer</a>.  Could you post your code for &quot;hello.h&quot; please ?"}, {"owner": {"reputation": 2640, "user_id": 733545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vnzM9.jpg?s=128&g=1", "display_name": "Peteris", "link": "https://stackoverflow.com/users/733545/peteris"}, "reply_to_user": {"reputation": 1069, "user_id": 3283333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2363a3623beb1efba518c1896bc92e66?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3283333/christian"}, "edited": false, "score": 0, "creation_date": 1568639371, "post_id": 57896135, "comment_id": 102326969, "body": "Thanks for sharing that, looking into it. Unfortunately it does seem like the key function in question <code>Sum</code> is surrounded by an <code>extern &quot;C&quot;</code> tag in <code>hello.h</code>."}], "owner": {"reputation": 2640, "user_id": 733545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vnzM9.jpg?s=128&g=1", "display_name": "Peteris", "link": "https://stackoverflow.com/users/733545/peteris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568665142, "creation_date": 1568232527, "last_edit_date": 1568665142, "question_id": 57896135, "link": "https://stackoverflow.com/questions/57896135/symbol-not-found-linking-a-go-library-into-python-with-cgo-and-pybind11", "title": "SYMBOL NOT FOUND: Linking a `go` library into `python` with `cgo` and `pybind11`", "body": "<p>I'm trying to make a <code>go</code> function available in Python. I'm using the standard <code>cgo</code> approach combined with <code>pybind11</code> but not able to get it working. I'm leveraging this <a href=\"https://github.com/bast/pybind11-demo\" rel=\"nofollow noreferrer\">demo</a> which works on its own but not when trying to link the <code>go</code> code. Equally I'm able to call the <code>go</code> code from C but not from Python.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I've confirmed that the issue is definitely in the linking step by using a shared library not compiled from Go. The error is very likely in either the shared library definition or the CMake file setup.</p>\n\n<p>I've got the following file in <code>go</code>:</p>\n\n<pre><code>package main\n\nimport \"C\"\n\n//export Sum\nfunc Sum(a, b int) int {\n    return a + b\n}\n\n\nfunc main() {}\n</code></pre>\n\n<p>That I'm compiling into a C shared library <code>hello.so</code> via:</p>\n\n<p><code>go build -buildmode=c-shared -o hello.so hello.go</code></p>\n\n<p>Then adding a C++ file <code>example.cpp</code>:</p>\n\n<pre><code>#include &lt;pybind11/pybind11.h&gt;\n#include \"hello.h\"\n\n\nint add(int i, int j) {\n    long long other_sum = Sum(2, 3);\n    return i + j;\n}\n\nnamespace py = pybind11;\n\nPYBIND11_MODULE(example, m) {\n    // optional module docstring\n    m.doc() = \"pybind11 example plugin\";\n\n    // define add function\n    m.def(\"add\", &amp;add, \"A function which adds two numbers\");\n}\n</code></pre>\n\n<p>Then, with the full source code of <code>pybind11</code> into a folder called <code>pybind11</code>, I run the following:</p>\n\n<p><code>mkdir build &amp;&amp; cd build &amp;&amp; cmake .. &amp;&amp; make</code></p>\n\n<p>which successfully creates a Python library in folder <code>build</code>.</p>\n\n<p>However, when calling the Python CLI <code>cd build &amp;&amp; python3</code> and then importing <code>add</code> with <code>from example import add</code>, I run into the following issue:</p>\n\n<pre><code>ImportError: Symbol not found: _Sum\n</code></pre>\n\n<p>This seems like a library linking issue, but it doesn't go away with the following <code>CMakeLists.txt</code> configuration:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8.12)\nproject(example)\n\nfind_package(PythonLibs)\ninclude_directories(${PYTHON_INCLUDE_DIRS})\n\nadd_subdirectory(pybind11)\npybind11_add_module(example example.cpp)\n\n# first attempt to link\ninclude_directories(.)\nlink_directories($PWD)\n\n# second attempt to link\nadd_library(hello SHARED IMPORTED)\nset_property(TARGET hello PROPERTY IMPORTED_LOCATION \"./hello.so\")\n</code></pre>\n\n<p>Any thoughts on why the attempt to link is failing?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Code for <code>hello.h</code>:</p>\n\n<pre><code>/* Code generated by cmd/cgo; DO NOT EDIT. */\n\n/* package command-line-arguments */\n\n\n#line 1 \"cgo-builtin-export-prolog\"\n\n#include &lt;stddef.h&gt; /* for ptrdiff_t below */\n\n#ifndef GO_CGO_EXPORT_PROLOGUE_H\n#define GO_CGO_EXPORT_PROLOGUE_H\n\n#ifndef GO_CGO_GOSTRING_TYPEDEF\ntypedef struct { const char *p; ptrdiff_t n; } _GoString_;\n#endif\n\n#endif\n\n/* Start of preamble from import \"C\" comments.  */\n\n\n\n\n/* End of preamble from import \"C\" comments.  */\n\n\n/* Start of boilerplate cgo prologue.  */\n#line 1 \"cgo-gcc-export-header-prolog\"\n\n#ifndef GO_CGO_PROLOGUE_H\n#define GO_CGO_PROLOGUE_H\n\ntypedef signed char GoInt8;\ntypedef unsigned char GoUint8;\ntypedef short GoInt16;\ntypedef unsigned short GoUint16;\ntypedef int GoInt32;\ntypedef unsigned int GoUint32;\ntypedef long long GoInt64;\ntypedef unsigned long long GoUint64;\ntypedef GoInt64 GoInt;\ntypedef GoUint64 GoUint;\ntypedef __SIZE_TYPE__ GoUintptr;\ntypedef float GoFloat32;\ntypedef double GoFloat64;\ntypedef float _Complex GoComplex64;\ntypedef double _Complex GoComplex128;\n\n/*\n  static assertion to make sure the file is being used on architecture\n  at least with matching size of GoInt.\n*/\ntypedef char _check_for_64_bit_pointer_matching_GoInt[sizeof(void*)==64/8 ? 1:-1];\n\n#ifndef GO_CGO_GOSTRING_TYPEDEF\ntypedef _GoString_ GoString;\n#endif\ntypedef void *GoMap;\ntypedef void *GoChan;\ntypedef struct { void *t; void *v; } GoInterface;\ntypedef struct { void *data; GoInt len; GoInt cap; } GoSlice;\n\n#endif\n\n/* End of boilerplate cgo prologue.  */\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n\nextern GoInt Sum(GoInt p0, GoInt p1);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n"}, {"tags": ["c++", "mingw", "sdl"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1568235270, "post_id": 57896074, "comment_id": 102214449, "body": "Why isn&#39;t <code>init_SDLComponents()</code> taking its arguments by reference or double-pointer?  Right now you&#39;re not actually propagating the new values back outside the function."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 1, "creation_date": 1568235366, "post_id": 57896074, "comment_id": 102214490, "body": "Also, why are you trying to use <code>SDL_GetWindowSurface()</code> if you&#39;ve got a renderer going?  That&#39;s specifically forbidden by <a href=\"https://wiki.libsdl.org/SDL_GetWindowSurface#Remarks\" rel=\"nofollow noreferrer\">the documentation</a>."}, {"owner": {"reputation": 1, "user_id": 10633144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wW-xoG2uPnE/AAAAAAAAAAI/AAAAAAAAAC0/BrdKqI8Zq20/photo.jpg?sz=128", "display_name": "wheremyfoodat", "link": "https://stackoverflow.com/users/10633144/wheremyfoodat"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1568236003, "post_id": 57896074, "comment_id": 102214692, "body": "@genpfault I could not be more grateful to you, your answer saved me. Hadn&#39;t noticed that."}], "owner": {"reputation": 1, "user_id": 10633144, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wW-xoG2uPnE/AAAAAAAAAAI/AAAAAAAAAC0/BrdKqI8Zq20/photo.jpg?sz=128", "display_name": "wheremyfoodat", "link": "https://stackoverflow.com/users/10633144/wheremyfoodat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568237724, "creation_date": 1568232274, "last_edit_date": 1568237724, "question_id": 57896074, "link": "https://stackoverflow.com/questions/57896074/sdl-throws-invalid-window-error-cant-draw-anything-to-my-window", "title": "SDL throws &quot;invalid window&quot; error, can&#39;t draw anything to my window", "body": "<p>My SDL program's (C++, compiled with Mingw) window can't draw anything. When <code>SDL_GetError()</code> is called, I get the error \"invalid window\", except for the <code>GetError</code> in the <code>pushFramebufferToScreen</code> function, in which case I get <code>\"SDL_UpperBlit: passed a Null surface\"</code>. The program compiles just fine and the library also seems to be linked well. The purpose of this program is to test how to draw a framebuffer to a window for an emulator. </p>\n\n<ul>\n<li>Troubleshooting parts that might have caused problems</li>\n<li>Make sure SDL gets initialized properly</li>\n<li>See other SDL projects to see if I'm doing anything wrong</li>\n<li>Make sure I've linked SDL properly and all my SDL dlls are in my executable folder</li>\n</ul>\n\n<p>setup.h:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool init_SDLComponents(SDL_Window* window, SDL_Renderer* renderer, SDL_Joystick* joystick, SDL_Surface* surface)\n{\n\n    if (SDL_Init(SDL_INIT_EVERYTHING)&lt;0)\n    {\n        std::cout&lt;&lt;\"Error: \"&lt;&lt;SDL_GetError();\n    }\n\n    else\n    {\n        std::cout&lt;&lt;\"SDL initiated properly\\n\\n\";\n    }\n\n    window = SDL_CreateWindow(\"Name\",\n                               SDL_WINDOWPOS_CENTERED,\n                               SDL_WINDOWPOS_CENTERED,\n                               320, 288,\n                               0);\n\n    if (!window)\n    {  \n        std::cout &lt;&lt; \"Can't make window\\n\";\n        return false;\n    }\n\n\n    renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED);\n\n    if (!renderer)\n    {\n        std::cout &lt;&lt; \"Can't make renderer\" &lt;&lt; SDL_GetError();\n        return false;\n    }\n\n    surface = SDL_GetWindowSurface(window);\n\n    if (!surface)\n    {\n        std::cout &lt;&lt; \"Can't make surface\" &lt;&lt; SDL_GetError();\n        return false;\n    }\n\n    return true;\n}\n</code></pre>\n\n<p>ppu.h:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>SDL_Surface** windowSurface; //pointer to the surface of my window\nconst int HEIGHT = 160;\nconst int WIDTH = 144;\nconst int CHANNELS = 3;\nuint8_t framebuffer [HEIGHT * WIDTH * CHANNELS];\n</code></pre>\n\n<p>ppu.cpp:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>PPU::pushFramebufferToScreen()\n{\n    memset (framebuffer, 0x00, sizeof(framebuffer);\n    SDL_Surface* surface = SDL_CreateRGBSurfaceFrom ((void*) framebuffer,\n                                                             WIDTH,\n                                                             HEIGHT,\n                                                             CHANNELS * 8, //bits per channel\n                                                             WIDTH * CHANNELS, /pitch\n                                                             0x0000FF,\n                                                             0x00FF00,\n                                                             0xFF0000\n                                                    );\n\n    SDL_BlitSurface (surface, NULL, *windowSurface, NULL);\n    std::cout&lt;&lt;SDL_GetError();\n    SDL_FreeSurface(surface);\n\n}\n</code></pre>\n\n<p>finally, main.cpp:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>\nSDL_Window* window = NULL;\nSDL_Renderer* renderer = NULL;\nSDL_Joystick* joystick = NULL;\nSDL_Texture* texture = NULL;\nSDL_Surface* surface = NULL;\n\ninit_SDLComponents(window, renderer, joystick, surface);\n//std::cout&lt;&lt;SDL_GetError();\n\nPPU ppu;\nppu.windowSurface = &amp;surface;   \nppu.pushBufferToScreen();\nSDL_UpdateWindowSurface(window);\nSDL_Delay(2000);\nSDL_DestroyWindow(window);\nSDL_Quit();\n\nreturn 0;\n</code></pre>\n\n<p>I excepted that my window's colour would be set to blank instead of the default white. However, all I get is <code>invalidWindow</code> errors, and the <code>UpperBlit</code> error in the framebuffer function.</p>\n"}, {"tags": ["c++", "multidimensional-array", "stl", "containers"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568232497, "post_id": 57896061, "comment_id": 102213526, "body": "Note that when you do <code>_map[i][k] = 200;</code> you don&#39;t initialize <code>_map[i]</code> because it was previously initialized when you did <code>_map[i][j] = 100;</code>, it simply accesses it. <code>operator[]</code> returns the element if it exists, otherwise adds it to the map and then returns it."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568232439, "post_id": 57896100, "comment_id": 102213501, "body": "This is correct, but could benefit from additional clarification on why the original code doesn&#39;t work."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1568232479, "last_edit_date": 1568232479, "creation_date": 1568232363, "answer_id": 57896100, "question_id": 57896061, "link": "https://stackoverflow.com/questions/57896061/initializing-a-static-two-dimensional-mapint-int-in-c/57896100#57896100", "title": "Initializing a static two dimensional map&lt;int, int&gt; in C++", "body": "<p>it would be:</p>\n\n<pre><code>map&lt;int, map&lt;int, int&gt;&gt; _map = {\n    {1, {{2, 100}, {3, 200}}}\n  };\n</code></pre>\n\n<p>You could also have:</p>\n\n<pre><code>_map[1] = {{2, 100}, {3, 200}};\n</code></pre>\n\n<p>Your snippet</p>\n\n<pre><code>map &lt;int, map&lt;int, int&gt;&gt; _map = {\n    {1, {{2, 100}}},\n    {1, {{3, 200}}}\n  };\n</code></pre>\n\n<p>would be \"equivalent\" (initialization versus insertion) to:</p>\n\n<pre><code>_map.insert({1, {{2, 100}}});\n_map.insert({1, {{3, 200}}}); // Fails as key 1 already present.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "is_accepted": false, "score": 2, "last_activity_date": 1568232617, "creation_date": 1568232617, "answer_id": 57896151, "question_id": 57896061, "link": "https://stackoverflow.com/questions/57896061/initializing-a-static-two-dimensional-mapint-int-in-c/57896151#57896151", "title": "Initializing a static two dimensional map&lt;int, int&gt; in C++", "body": "<p>The two operations are not equivalent. This: </p>\n\n<pre><code>map &lt;int, map&lt;int, int&gt;&gt; _map;\n_map[i][j] = 100;\n_map[i][k] = 200;\n</code></pre>\n\n<p>First creates an entry in your map with key <code>i</code> and returns a reference to a value associated with your key - an <code>std::map&lt;int, int&gt;</code>, which then you apply <code>[j] = 100;</code> to. This means that <code>_map</code> has <em>one</em> element - a <em>key-value</em> pair of <code>{i, {j, 100}}</code>.</p>\n\n<p>Then you apply <code>_map[i][k] = 200;</code>, which retrieves a value under <code>i</code> key (the very same <code>std::map&lt;int, int&gt;</code>) and puts a key-value pair of <code>{k, 200}</code> there. Your <code>_map</code> consists now of: <code>{i, {{j, 100}, {k, 200}}}</code>.</p>\n\n<p>Now, why this doesnt work the same:</p>\n\n<pre><code>map &lt;int, map&lt;int, int&gt;&gt; _map = {\n    {1, {{2, 100}}},\n    {1, {{3, 200}}}\n};\n</code></pre>\n\n<p>that's because here you introduce <em>two</em> key-value pairs. Twice with a key equal <code>1</code> with a value equal to separate maps. This is not equivalent. You would need to change your sytax to the following: </p>\n\n<pre><code>map&lt;int, map&lt;int, int&gt;&gt; _map = {\n    {1, {{2, 100}, {3, 200}}}\n};\n</code></pre>\n\n<p>This, like the first example, creates one entry (a key-value pair) to your map with a key <code>1</code> and a value <code>std::map&lt;int, int&gt;</code> consisting of two entries - <code>{2, 100}</code> and <code>{3, 200}</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 9384533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5HvQC.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/9384533/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 57896100, "answer_count": 2, "score": 5, "last_activity_date": 1568232617, "creation_date": 1568232205, "question_id": 57896061, "link": "https://stackoverflow.com/questions/57896061/initializing-a-static-two-dimensional-mapint-int-in-c", "title": "Initializing a static two dimensional map&lt;int, int&gt; in C++", "body": "<p>I have two dimensional map</p>\n\n<pre><code>map &lt;int, map&lt;int, int&gt;&gt; _map;\n</code></pre>\n\n<p>The first type of initialization works well:</p>\n\n<pre><code>int i = 1,  j = 2,  k = 3;\nmap &lt;int, map&lt;int, int&gt;&gt; _map;\n_map[i][j] = 100;\n_map[i][k] = 200;\nstd::cout &lt;&lt; _map[i][j] &lt;&lt; \":\" &lt;&lt; _map[i][k] &lt;&lt; std::endl; \n</code></pre>\n\n<p>Thus it prints:</p>\n\n<pre><code>100:200\n</code></pre>\n\n<p>However, the second initialization fails:</p>\n\n<pre><code>map &lt;int, map&lt;int, int&gt;&gt; _map = {\n    {1, {{2, 100}}},\n    {1, {{3, 200}}}\n  };\n  std::cout &lt;&lt; _map[i][j] &lt;&lt; \":\" &lt;&lt; _map[i][k] &lt;&lt; std::endl;\n</code></pre>\n\n<p>The second prints:</p>\n\n<pre><code>100:0\n</code></pre>\n\n<p>I understand that map has \"unique keys\", on the other hand, we can init like \"_map[i][j]\".</p>\n\n<p>Could you please explain me how <strong>to initialize a static two dimensional map in a right way</strong>?</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "mutex"], "comments": [{"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "edited": false, "score": 0, "creation_date": 1568231821, "post_id": 57895895, "comment_id": 102213307, "body": "@freakish - is there a simple way  to prevent that?"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568232234, "post_id": 57895895, "comment_id": 102213441, "body": "@freakish - do you mean that I need to lock before the line <code>FinishedProcess = true;</code> ? what about <code>StartProcessFromMain = true;</code>?"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568232477, "post_id": 57895895, "comment_id": 102213517, "body": "@freakish - the way I see it, nothing prevents the two threads to work in parallel, instead of the <code>while(true)</code> in the main thread I could write <code>while(readFrame(FrameObj)</code> for example, so when this thread reads the frame the second thread process the <i>previous</i> thread"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568232635, "post_id": 57895895, "comment_id": 102213569, "body": "@freakish -Appreciate that, downvoting good questions became some kind of sport here, don&#39;t understand why."}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568233080, "post_id": 57895895, "comment_id": 102213709, "body": "@freakish - Now I understand that modifying the bools should be made under the same mutex. what about <code>CVMain2Process.notify_one();</code> and <code>CVProcess2Main.notify_one();</code>? are they also should be under that lock?"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568234121, "post_id": 57895895, "comment_id": 102214024, "body": "@freakish - In the main thread I  added <code>unique_lock&lt;mutex&gt; lk(Main2Process);</code> before <code>StartProcessFromMain = true;</code> and <code>lk.unlock()</code> right after,  (unlocking before  <code>CVMain2Process.notify_one();</code>) and in the second thread I added <code>unique_lock&lt;mutex&gt; lk2(Process2Main);</code> before <code>FinishedProcess = true;</code>  and <code>lk2.unlock()</code> right after. I am running it to see if it solved the problem.  Why do the <code>.wait()</code>  calls need to share the same mutex? every thread have its own wainting mutex. I didn&#39;t change that."}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568235960, "post_id": 57895895, "comment_id": 102214679, "body": "@freakish - OK!, I changed that also so now I have only <code>unique_lock&lt;mutex&gt; lk(Main2Process);</code> as input to both <code>wait()</code> , <code>unique_lock&lt;mutex&gt; lk2(Process2Main);</code> no longer exist"}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 2, "creation_date": 1568238199, "post_id": 57895895, "comment_id": 102215331, "body": "Uh, this is still wrong. I&#39;ll be honest: this is unncessarily complicated. I advice switching to queues. Your main thread reads a frame in a loop and each time it does it just enqueues the frame. The other thread simply dequeues next frame and processes it. Something like this: <a href=\"https://godbolt.org/z/3dDPum\" rel=\"nofollow noreferrer\">godbolt.org/z/3dDPum</a>"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568238590, "post_id": 57895895, "comment_id": 102215417, "body": "@freakish - But would it happen in parallel? my intention is that the second thread process the current frame while the main thread gets the next frame... Is it Complicated? Wow, and I thought it&#39;s the simplest way...."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1568238794, "post_id": 57895895, "comment_id": 102215462, "body": "@BennyK  In the 4th line of main, you signal a cond var.   Why?   Did it immediately hang if you didn&#39;t do that?   Condvars do not have memory; semaphores have memory.  If you signal a cond var that nobody is waiting upon, then you have done nothing and the wait will block forever.   Your program happens to work because the threads are operating in near lockstep.  When one falls out of lockstep (maybe a cron job) it hangs on you."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 1, "creation_date": 1568239246, "post_id": 57895895, "comment_id": 102215557, "body": "@BennyK Well, the last code I&#39;ve shown you will happen in parallel. I&#39;ve written an alternative version with &quot;switches&quot; instead of queues: <a href=\"https://godbolt.org/z/5WO8JV\" rel=\"nofollow noreferrer\">godbolt.org/z/5WO8JV</a> which is more similar to your original code. The point is that you actually need two mutexes, but both threads have to have access to both of them. So yeah, this is quite complicated, multithreaded programming is not easy at all. That&#39;s why I&#39;ve wraped it into a class. You can even mix queues with switches. Anyway I&#39;m going to bad now, I&#39;m too tired, sorry. Hope it is ok now."}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1568239597, "post_id": 57895895, "comment_id": 102215631, "body": "@mevets because If I won&#39;t do that and the second thread will get to <code>wait</code> before the bool is true than it will hang there forever, Am I wrong here?  The code usually hangs after more than 10000 iterations so I dont think that is the problem"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568239645, "post_id": 57895895, "comment_id": 102215642, "body": "@freakish so eventually I do need two different mutexes?"}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1568240632, "post_id": 57895895, "comment_id": 102215885, "body": "@BennyK yes, I think so. Sorry for the confusion."}], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1568254609, "creation_date": 1568254609, "answer_id": 57898894, "question_id": 57895895, "link": "https://stackoverflow.com/questions/57895895/c-multi-thread-application-hangs-forever/57898894#57898894", "title": "C++ multi thread application hangs forever", "body": "<p>I wasn't able to compile your program with any of the c++ versions I could find, so I translated (upgraded?) it to C, then made it work with pthreads.   It is at the bottom.</p>\n\n<p>The most important bit; it uses one mutex and one condvar to protects two flags - ProcessingData, DataAvailable.   These are the fundamental communication between the threads.\nThe first thread, main, first waits until ProcessingData is false.   This keeps it from interfering with the Process() thread while it is working on the shared data.   Once ProcessingData is false, main is free to go and get fresh data.  It then reacquires the single mutex (MainLock), sets DataAvailable to true, and signals the condvar MainCV.</p>\n\n<p>The second thread, Process, first waits until DataAvailable is true.  This keeps it from interfering with the main() thread while it is off getting new data.  Once DataAvailable is true, it sets ProcessingData to true, goes and processes the data, and once it is done, reacquires the single mutex MainLock, clears ProcessingData and signals the condvar MainCV.</p>\n\n<p>This is free of races; and the threads can continue independently after handshaking the data exchange.   This can be done with two condvars and one mutex, but there isn't really any advantage to it.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\nbool        ProcessingData = false;\nbool        DataAvailable = false;\npthread_mutex_t MainLock;\npthread_cond_t  MainCV;\npthread_cond_t  MainCV;\n\nvoid           *Process(void *);\n#define X(y)   do { if (y == -1) abort(); } while (0)\nint \nmain()\n{\n    X(pthread_mutex_init(&amp;MainLock, NULL));\n    X(pthread_cond_init(&amp;MainCV, NULL));\n    long        Iter = 0;\n    //start data process thread\n    pthread_t id;\n    X(pthread_create(&amp;id, NULL, Process, NULL));\n    X(pthread_cond_signal(&amp;MainCV));\n\n    while (true) {\n        printf(\"Iteration: %ld waiting for processing to finish\\n\", ++Iter);\n        X(pthread_mutex_lock(&amp;MainLock));\n        while (ProcessingData) {\n            X(pthread_cond_wait(&amp;MainCV, &amp;MainLock));\n        }\n        X(pthread_mutex_unlock(&amp;MainLock));\n        printf(\"Data processing ended, getting new data\\n\");\n        //getting new data\n\n        printf(\"Got new data, calling process thread\\n\");\n        X(pthread_mutex_lock(&amp;MainLock));\n        DataAvailable = true;\n        X(pthread_mutex_unlock(&amp;MainLock));\n        X(pthread_cond_signal(&amp;MainCV));\n\n    }\n    return 0;\n}\n\nvoid *Process(void *notused)\n{\n    //data processing thread\n\n    while (true) {\n        printf(\"waiting for new data\\n\");\n        X(pthread_mutex_lock(&amp;MainLock));\n        while (!DataAvailable) {\n            X(pthread_cond_wait(&amp;MainCV, &amp;MainLock));\n        }\n        ProcessingData = true;\n        X(pthread_mutex_unlock(&amp;MainLock));\n        //Processing new data here\n\n            // Finished processing new data - notify data acquiring thread\n            printf(\"Finished processing new data\\n\");\n        X(pthread_mutex_lock(&amp;MainLock));\n        ProcessingData = false;\n        X(pthread_mutex_unlock(&amp;MainLock));\n        X(pthread_cond_signal(&amp;MainCV));\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568254609, "creation_date": 1568231333, "question_id": 57895895, "link": "https://stackoverflow.com/questions/57895895/c-multi-thread-application-hangs-forever", "title": "C++ multi thread application hangs forever", "body": "<p>Consider the next C++ code fragment which represnets (pseudo) multi thread \napplication which has two threads, the main thread responsible for getting new \ndata (e.g., new frame from video stream) and the secondary thread which needs to \nprocess the data (e.g., filter the frame), this should happen in parallel so, for example, when the main thread acquires the first frame the second thread does not do anything, when the main thread acquires the second frame the second thread process the first frame and so on.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\nusing namespace std;\nbool StartProcessFromMain = false;\nbool FinishedProcess = false;\nmutex Main2Process;\nmutex Process2Main;\ncondition_variable CVMain2Process;\ncondition_variable CVProcess2Main;\nvoid Process();\nint main()\n{\n    long long int Iter = 0;\n    // start data process thread\n    thread ProcessThread(Process);\n    StartProcessFromMain = true;\n    CVMain2Process.notify_one();\n\n\n    // this is the main data acquiring thread\n    unique_lock&lt;mutex&gt; lk2(Process2Main);\n    lk2.unlock();\n\n    while (true)\n    {\n        cout &lt;&lt; \"Iteration: \" &lt;&lt; ++Iter &lt;&lt; endl;\n        cout &lt;&lt; \"Waiting for data processing to finish\" &lt;&lt; endl;\n        lk2.lock();\n        CVProcess2Main.wait(lk2, [&amp;] {return FinishedProcess; });\n        FinishedProcess = false;\n        lk2.unlock();\n        cout &lt;&lt; \"Data processing ended..... getting new data\" &lt;&lt; endl;\n        // getting new data\n\n        cout &lt;&lt; \"Got new data, calling process thread\" &lt;&lt; endl;\n        StartProcessFromMain = true;\n        CVMain2Process.notify_one();\n\n    }\n    return 0;\n}\n\nvoid Process()\n{\n    //data processing thread\n\n    unique_lock&lt;mutex&gt; lk(Main2Process);\n    lk.unlock();\n\n    while (true)\n    {\n        cout &lt;&lt; \"waiting for new data\" &lt;&lt; endl;\n        lk.lock();\n        CVMain2Process.wait(lk, [&amp;] {return StartProcessFromMain; });\n        StartProcessFromMain = false;\n        lk.unlock();\n        // Processing new data here\n\n        // Finished processing new data - notify data acquiring thread\n        cout &lt;&lt; \"Finished processing new data\" &lt;&lt; endl;\n        FinishedProcess = true;\n        CVProcess2Main.notify_one();\n\n    }\n}\n</code></pre>\n\n<p>In practice, compiled both with MSVC 2015 (x64) on Windows 10  and with gcc on Ubuntu 16.04, this code <strong>always hangs forever</strong>  (usually after thousands or tens of thousands iterations) when both threads wait one for the other :-(</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "unit-testing", "cmake", "linker", "unittest++"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568230917, "post_id": 57895790, "comment_id": 102212962, "body": "Why are you adding <code>.h</code> files as source files??? This can&#39;t be right."}, {"owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568230956, "post_id": 57895790, "comment_id": 102212977, "body": "@SergeyA those are the headers for the classes the test <code>.cpp</code> files need. It&#39;s probably more common to compile the project as library, and link that, but I&#39;ve done it this way here."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568230984, "post_id": 57895790, "comment_id": 102212985, "body": "You never ever list .h files as sources, no matter what your project is."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568231220, "post_id": 57895790, "comment_id": 102213054, "body": "Headers are intended to be included, not compiled."}, {"owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568231432, "post_id": 57895790, "comment_id": 102213141, "body": "@user4581301 I&#39;m generally aware of hwo the build process works. I think what I&#39;m having difficulty with is the cmake commands. As you can see, I&#39;ve resorted to the trial and error and approach."}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1568233430, "post_id": 57895790, "comment_id": 102213822, "body": "If I understand your terse error description correctly, &#39;recompile with -fPIC&#39; means to reverse the setting, i.e. &#39;set(CMAKE_POSITION_INDEPENDENT_CODE ON)`."}, {"owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "reply_to_user": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1568234559, "post_id": 57895790, "comment_id": 102214195, "body": "@vre that yields the same output"}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1568234852, "post_id": 57895790, "comment_id": 102214288, "body": "Looks like libUnitTest++ is not compiled with -fPIC. When building a position independent executable (PIE) all libs and objects must be compiled with -fPIC. So either you do not add GCC_COVERAGE_COMPILE_FLAGS to CMAKE_CXX_FLAGS or need to rebuild libUnitTest++.a with -fPIC."}, {"owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "reply_to_user": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1568290948, "post_id": 57895790, "comment_id": 102233155, "body": "@vre I&#39;ve tried the first one a few different ways, and still no luck. Not sure if I should try the second."}], "answers": [{"tags": [], "owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1568293230, "last_edit_date": 1568293230, "creation_date": 1568292585, "answer_id": 57907117, "question_id": 57895790, "link": "https://stackoverflow.com/questions/57895790/how-to-write-a-cmakelists-txt-file-for-unittest-project/57907117#57907117", "title": "How to write a CMakeLists.txt file for UnitTest++ project", "body": "<p><a href=\"https://stackoverflow.com/a/47201755/1267833\">This answer</a> suggests adding the <code>-no-pie</code> flag, and that \"fixed\" it. My current cmake file is as follows (it still doesn't work, but at least these specific linker errors aren't there anymore).</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(markets_tests)\n\nset(CMAKE_CXX_STANDARD 17)\nSET(CMAKE_CXX_COMPILER /usr/bin/g++-8)\nset(CMAKE_POSITION_INDEPENDENT_CODE OFF)\n\nfind_package (Eigen3 3.3 REQUIRED NO_MODULE)\nfind_package(UnitTest++ REQUIRED)\n\nSET(GCC_COVERAGE_COMPILE_FLAGS \"-no-pie\")\nSET(CMAKE_CXX_FLAGS  \"${CMAKE_CXX_FLAGS} ${GCC_COVERAGE_COMPILE_FLAGS}\")\n\ninclude_directories(\n        \"${PROJECT_SOURCE_DIR}\"\n        \"${PROJECT_SOURCE_DIR}/../include\"\n        ${UTPP_INCLUDE_DIRS}\n    )\n\n\nfile(GLOB all_SRCS\n        \"${PROJECT_SOURCE_DIR}/*.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/data_handlers.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/data_readers.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/data_execution_handler.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/fill.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/instrument.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/market_bar.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/market_snapshot.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/model_bank.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/order.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/pnl_calculator.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/portfolio.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../src/position_summary.cpp\"\n        )\n\nadd_executable(run_tests ${all_SRCS})\ntarget_link_libraries (run_tests Eigen3::Eigen stdc++fs UnitTest++)\n</code></pre>\n"}], "owner": {"reputation": 1393, "user_id": 1267833, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9fe1935d074ce793c65971b3ef42b09f?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1267833/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568293230, "creation_date": 1568230805, "last_edit_date": 1568290858, "question_id": 57895790, "link": "https://stackoverflow.com/questions/57895790/how-to-write-a-cmakelists-txt-file-for-unittest-project", "title": "How to write a CMakeLists.txt file for UnitTest++ project", "body": "<p>I've been asked to see if I can start using cmake instead of Makefiles for a <a href=\"https://github.com/tbrown122387/markets\" rel=\"nofollow noreferrer\">project</a> I'm working on. I've gotten it working to compile my main project, however, I'm having a hard time writing a <code>CMakeLists.txt</code> file for the <code>test/</code> directory, which uses UnitTest++. I've found these <a href=\"https://github.com/unittest-cpp/unittest-cpp/wiki/Adding-into-a-CMake-Project\" rel=\"nofollow noreferrer\">instructions</a>, but I'm having a hard time following them. I run</p>\n\n<p>mkdir build\ncd build/\ncmake ..\nmake</p>\n\n<p>but I get some linker errors. It mentions the phrase <code>can not be used when making a PIE object; recompile with -fPIC</code> a few times. Here's my <code>CMakeLists.txt</code> file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(markets_tests)\n\nset(CMAKE_CXX_STANDARD 17)\nSET(CMAKE_CXX_COMPILER /usr/bin/g++-8)\nset(CMAKE_POSITION_INDEPENDENT_CODE OFF)\n\nfind_package (Eigen3 3.3 REQUIRED NO_MODULE)\nfind_package(UnitTest++ REQUIRED)\n\nSET(GCC_COVERAGE_COMPILE_FLAGS \"-fPIC\")\nSET(CMAKE_CXX_FLAGS  \"${CMAKE_CXX_FLAGS} ${GCC_COVERAGE_COMPILE_FLAGS}\")\n\ninclude_directories(\n        \"${PROJECT_SOURCE_DIR}\"\n        \"${PROJECT_SOURCE_DIR}/../include\"\n        \"${PROJECT_SOURCE_DIR}/../src\"\n        ${UTPP_INCLUDE_DIRS}\n    )\n\n\nfile(GLOB all_SRCS\n        \"${PROJECT_SOURCE_DIR}/*.cpp\"\n        \"${PROJECT_SOURCE_DIR}/../include/data_handlers.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/data_readers.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/data_execution_handler.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/fill.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/instrument.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/market_bar.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/market_snapshot.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/model_bank.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/order.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/pnl_calculator.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/portfolio.h\"\n        \"${PROJECT_SOURCE_DIR}/../include/position_summary.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/data_handlers.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/data_readers.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/data_execution_handler.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/fill.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/instrument.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/market_bar.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/market_snapshot.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/model_bank.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/order.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/pnl_calculator.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/portfolio.h\"\n        \"${PROJECT_SOURCE_DIR}/../src/position_summary.h\"\n        )\n\nadd_executable(run_tests ${all_SRCS})\ntarget_link_libraries (run_tests Eigen3::Eigen stdc++fs UnitTest++)\n</code></pre>\n\n<p>As per the advice given [here], I've added <code>set(CMAKE_POSITION_INDEPENDENT_CODE OFF)</code>, but to no avail.</p>\n\n<p>Here's the entire output from running <code>make</code>:</p>\n\n<pre><code>t@t-XPS-13-9365:~/markets/test/build$ make\nScanning dependencies of target run_tests\n[  7%] Building CXX object CMakeFiles/run_tests.dir/run_tests.cpp.o\n[ 15%] Building CXX object CMakeFiles/run_tests.dir/test_data_handler.cpp.o\n[ 23%] Building CXX object CMakeFiles/run_tests.dir/test_data_reader.cpp.o\n[ 30%] Building CXX object CMakeFiles/run_tests.dir/test_exec_handler.cpp.o\n[ 38%] Building CXX object CMakeFiles/run_tests.dir/test_fill.cpp.o\n[ 46%] Building CXX object CMakeFiles/run_tests.dir/test_instrument.cpp.o\n[ 53%] Building CXX object CMakeFiles/run_tests.dir/test_market_bar.cpp.o\n[ 61%] Building CXX object CMakeFiles/run_tests.dir/test_market_snapshot.cpp.o\n[ 69%] Building CXX object CMakeFiles/run_tests.dir/test_order.cpp.o\n[ 76%] Building CXX object CMakeFiles/run_tests.dir/test_pnl_calculator.cpp.o\n[ 84%] Building CXX object CMakeFiles/run_tests.dir/test_portfolio.cpp.o\n[ 92%] Building CXX object CMakeFiles/run_tests.dir/test_position_summary.cpp.o\n[100%] Linking CXX executable run_tests\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(MemoryOutStream.cpp.o): relocation R_X86_64_32 against `.rodata.str1.8' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(RequiredCheckException.cpp.o): relocation R_X86_64_32S against symbol `_ZTVN8UnitTest22RequiredCheckExceptionE' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(Test.cpp.o): relocation R_X86_64_32 against `.bss' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(TestRunner.cpp.o): relocation R_X86_64_32S against symbol `_ZTVN8UnitTest18TestReporterStdoutE' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(CurrentTest.cpp.o): relocation R_X86_64_32 against `.bss' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(SignalTranslator.cpp.o): relocation R_X86_64_32S against `.text' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(AssertException.cpp.o): relocation R_X86_64_32S against symbol `_ZTVN8UnitTest15AssertExceptionE' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: /usr/local/lib/libUnitTest++.a(TestReporterStdout.cpp.o): relocation R_X86_64_32 against `.rodata.str1.8' can not be used when making a PIE object; recompile with -fPIC\n/usr/bin/ld: final link failed: Nonrepresentable section on output\ncollect2: error: ld returned 1 exit status\nCMakeFiles/run_tests.dir/build.make:381: recipe for target 'run_tests' failed\nmake[2]: *** [run_tests] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/run_tests.dir/all' failed\nmake[1]: *** [CMakeFiles/run_tests.dir/all] Error 2\nMakefile:83: recipe for target 'all' failed\nmake: *** [all] Error 2\n</code></pre>\n\n<p>Even though the error message isn't really suggesting this, could it be because it isn't recompiling all those <code>.cpp</code>s in the directory that precedes the <code>test/</code> directory? I don't see any output that g++ compiled those.</p>\n"}, {"tags": ["c++", "linux", "cmake"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7264032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c6d56a198e114a4cf0f01cbfc07ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon", "link": "https://stackoverflow.com/users/7264032/szymon"}, "edited": false, "score": 0, "creation_date": 1568228947, "post_id": 57895168, "comment_id": 102212168, "body": "I&#39;ve done it and got:  <code>&#47;Dev&#47;CppEnvTest&#47;src&gt; .&#47;build.sh  source_files:  CMake Error at CMakeLists.txt:12 (add_executable):   add_executable called with incorrect number of arguments   -- Configuring incomplete, errors occurred! </code>"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 1, "last_activity_date": 1568227742, "creation_date": 1568227742, "answer_id": 57895168, "question_id": 57895138, "link": "https://stackoverflow.com/questions/57895138/cmake-add-executable-called-with-incorrect-number-of-arguments/57895168#57895168", "title": "Cmake add_executable called with incorrect number of arguments", "body": "<p>Your <code>source_files</code> variable seems empty. Verify that by adding <code>message(\"source_files: ${source_files}\")</code> somewhere in <code>CMakeLists.txt</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7264032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c6d56a198e114a4cf0f01cbfc07ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon", "link": "https://stackoverflow.com/users/7264032/szymon"}, "edited": false, "score": 0, "creation_date": 1568230833, "post_id": 57895537, "comment_id": 102212936, "body": "I used the brute-force way and it worked Thanks"}], "tags": [], "owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "is_accepted": true, "score": 2, "last_activity_date": 1568229385, "creation_date": 1568229385, "answer_id": 57895537, "question_id": 57895138, "link": "https://stackoverflow.com/questions/57895138/cmake-add-executable-called-with-incorrect-number-of-arguments/57895537#57895537", "title": "Cmake add_executable called with incorrect number of arguments", "body": "<p>To expand on @arrowd's answer, which is correct, you have a couple options for listing your source files. Your approach, <code>file(GLOB ...)</code>, will <em>only</em> look for source files matching <code>.cpp</code> in the <strong>current</strong> directory. If your project is structured such that you have nested directories within <code>${source_dir}</code>, you need the <a href=\"https://cmake.org/cmake/help/latest/command/file.html#glob-recurse\" rel=\"nofollow noreferrer\">recursive</a> option instead: </p>\n\n<pre><code>file (GLOB_RECURSE source_files \"${source_dir}/*.cpp\")\n</code></pre>\n\n<p>This will search recursively finding all of the <code>.cpp</code> files in that directory <strong>and</strong> any nested directories. </p>\n\n<p>You can also do a brute-force method using <a href=\"https://cmake.org/cmake/help/latest/command/set.html\" rel=\"nofollow noreferrer\"><code>set</code></a>, which is the best option for CMake, by doing something like this:</p>\n\n<pre><code>set(source_files \n    ${source_dir}/mySrcs1/Class1.cpp\n    ${source_dir}/mySrcs1/Class2.cpp\n    ${source_dir}/mySrcs1/Class3.cpp\n    ...\n    ${source_dir}/mySrcs42/testClass1.cpp\n    ${source_dir}/mySrcs42/testClass2.cpp\n    ...\n)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7264032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c6d56a198e114a4cf0f01cbfc07ff6?s=128&d=identicon&r=PG&f=1", "display_name": "Szymon", "link": "https://stackoverflow.com/users/7264032/szymon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "closed_date": 1568231068, "accepted_answer_id": 57895537, "answer_count": 2, "score": 0, "last_activity_date": 1568229385, "creation_date": 1568227601, "question_id": 57895138, "link": "https://stackoverflow.com/questions/57895138/cmake-add-executable-called-with-incorrect-number-of-arguments", "closed_reason": "Duplicate", "title": "Cmake add_executable called with incorrect number of arguments", "body": "<p>I am trying to set up c++ development environment on Linux (openSuse) with this tutorial <a href=\"https://youtu.be/LKLuvoY6U0I?t=154\" rel=\"nofollow noreferrer\">https://youtu.be/LKLuvoY6U0I?t=154</a></p>\n\n<p>When I try to build CMake project I'm getting \n<code>add_executable called with incorrect number of arguments</code></p>\n\n<p>My CMakeLists.txt:</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.5)\n\nproject (CppEnvTest)\n\nset (CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -Wall -Werror -std=c++17\")\nset (source_dir \"${PROJECT_SOURCE_DIR}/src/\")\n\nfile (GLOB source_files \"${source_dir}/*.cpp\")\n\nadd_executable (CppEnvTest ${source_files})\n\n</code></pre>\n\n<p>My build.sh:</p>\n\n<pre><code>#!/bin/sh\n\ncmake -G \"CodeLite - Unix Makefiles\" -DCMAKE_BUILD_TYPE=Debug\n\n</code></pre>\n\n<p>My terminal output:</p>\n\n<pre><code>/Dev/CppEnvTest/src&gt; ./build.sh \nCMake Error at CMakeLists.txt:10 (add_executable):\n  add_executable called with incorrect number of arguments\n\n\n-- Configuring incomplete, errors occurred!\n</code></pre>\n"}, {"tags": ["c++", "for-loop", "vector", "range", "auto"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1568226187, "post_id": 57894758, "comment_id": 102210921, "body": "Add a language tag please"}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568227685, "post_id": 57894975, "comment_id": 102211552, "body": "There is no need for the vector to store the size, the size is a distance between <code>begin()</code> and <code>and()</code>. It stores the capacity."}, {"owner": {"reputation": 7363, "user_id": 1678770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9afe9e6d4e0264da3d228c79162377f8?s=128&d=identicon&r=PG", "display_name": "Human-Compiler", "link": "https://stackoverflow.com/users/1678770/human-compiler"}, "edited": false, "score": 0, "creation_date": 1568228505, "post_id": 57894975, "comment_id": 102211944, "body": "Not only does this not answer the question in any way, it incorrectly explains how <code>vector</code> is implemented."}, {"owner": {"reputation": 1549, "user_id": 3600304, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/582e17ff0889a21f8b0f39315e064e76?s=128&d=identicon&r=PG&f=1", "display_name": "PapaDiHatti", "link": "https://stackoverflow.com/users/3600304/papadihatti"}, "edited": false, "score": 0, "creation_date": 1568228597, "post_id": 57894975, "comment_id": 102211996, "body": "Which part of your answer explaining &#39;how exactly does the &quot; : &quot; range-based for loops work?&#39;"}], "tags": [], "owner": {"reputation": 362, "user_id": 11936229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11da23565b039811f58b2beecf7493b3?s=128&d=identicon&r=PG&f=1", "display_name": "BTables", "link": "https://stackoverflow.com/users/11936229/btables"}, "is_accepted": true, "score": -4, "last_activity_date": 1568226859, "creation_date": 1568226859, "answer_id": 57894975, "question_id": 57894758, "link": "https://stackoverflow.com/questions/57894758/trying-to-understand-how-range-based-for-loops-work-in-c/57894975#57894975", "title": "Trying to understand how range-based for loops work in C++", "body": "<p>std::vector actually holds 3 things <em>in addition to</em> the actual data stored. 1) a pointer to the start of the vector. 2) a pointer to the end of the vector. 3) The size of the vector. </p>\n\n<p>Because of this, your loops \"know\" how many times to loop. It is (almost) equivalent to saying</p>\n\n<pre><code>for(auto i  = vMain.begin(); i != vMain.end(); i++)\n</code></pre>\n\n<p>Or even</p>\n\n<pre><code>for(auto i = 0; i &lt; vMain.size(); i++)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11076262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d953374a03243285613b388d31afc58?s=128&d=identicon&r=PG&f=1", "display_name": "Hudie", "link": "https://stackoverflow.com/users/11076262/hudie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1568227039, "accepted_answer_id": 57894975, "answer_count": 1, "score": 0, "last_activity_date": 1568226859, "creation_date": 1568225949, "last_edit_date": 1568226324, "question_id": 57894758, "link": "https://stackoverflow.com/questions/57894758/trying-to-understand-how-range-based-for-loops-work-in-c", "closed_reason": "Duplicate", "title": "Trying to understand how range-based for loops work in C++", "body": "<p>I've a program that reads from an input file an unknown amount of integers from a matrix and places them into a 2D vector. Once I have those integers inside the 2D vector I will output to another file each integers matching ASCII character. My problem is i was able to find a working double for loop that prints out 2D vectors but i'm unsure as to how the range inside the for loops work.</p>\n\n<pre><code>while(getline(in, row)){  \n    int num;\n    stringstream ss(row);\n    vector&lt;int&gt; vR;\n    while(ss &gt;&gt; num){\n        vR.push_back(num);\n    }\n    vMain.push_back(vR);\n}    \n\nfor(auto vR : vMain ){                          //&lt;------Here\n        for(auto num : vR){                     //&lt;------Here\n            if(num &gt;= 0 &amp;&amp; num &lt;= 14){\n                cout &lt;&lt; \" \";\n                out &lt;&lt; \" \";\n            }\n            .\n            .\n            .\n}\n</code></pre>\n\n<p>I created the while loop to take in the values of the file using a stringstream, then pushing back each row vector \"vR\" inside the main vector \"vMain\".</p>\n\n<p>The for loops go through the vectors one value at a time then output the corresponding ASCII value, how exactly does the \" : \" range-based for loops work?</p>\n"}, {"tags": ["c++", "windows", "std-bitset"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1568225617, "post_id": 57894642, "comment_id": 102210679, "body": "Regarding 32 bit build. 32 bit addressing only allows 2 GiB RAM. This is a non-starter given the size of your data. If this is running, something really odd is afoot."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568225680, "post_id": 57894642, "comment_id": 102210703, "body": "Are you sure that&#39;s the size? Check with <code>sizeof</code> on smaller allocations."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1568225755, "post_id": 57894642, "comment_id": 102210734, "body": "<code>mas</code> and <code>a1</code> are not on the stack, so stack size is not the problem. I don&#39;t know what will happen if you reserve 25 GB of stack but it sounds like a terrible idea."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568225956, "post_id": 57894642, "comment_id": 102210808, "body": "The value <code>100000000000</code> won&#39;t fit a 32 bit unsigned integer. So the 32 bit build is probably overflowing, giving you a much smaller size of <code>1215752192</code>."}, {"owner": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568225993, "post_id": 57894642, "comment_id": 102210829, "body": "ok, but what about x64 ?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568226012, "post_id": 57894642, "comment_id": 102210836, "body": "How are you measuring memory usage? Note that you can request insane amounts of memory but the system might not actually allocate portions of it until they are used. If you make an array of 1 billion elements  and only use the first few hundred, you may find your program only consuming  a few hundred elements worth of RAM. If you only use the first hundred and the last hundred, you might find the system only providing actual storage for the first and last hundred."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568226040, "post_id": 57894642, "comment_id": 102210852, "body": "@kileatb The error is pretty clear, the largest allowed array is <code>0x7fffffff</code> bytes on that platform. Don&#39;t make arrays larger than that. Maybe make a larger quantity of arrays but with a smaller size. Currently, you are simply asking more than your OS can physically handle."}, {"owner": {"reputation": 579, "user_id": 5878876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5dfcdce69507476298e16ce6b0e3ec?s=128&d=identicon&r=PG&f=1", "display_name": "Unlikus", "link": "https://stackoverflow.com/users/5878876/unlikus"}, "edited": false, "score": 0, "creation_date": 1568226299, "post_id": 57894642, "comment_id": 102210963, "body": "By the way, the global variables are not stored at the stack, so modifying the stack size is not relevant"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568226624, "post_id": 57894642, "comment_id": 102211124, "body": "Can&#39;t speak for the GUI, but on the command line <code>&#47;STACK:Reserve</code> is in bytes. Bytes makes more sense because stack is a controlled resource and usually doled out in small bunches of a few K to a few MB."}, {"owner": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568226768, "post_id": 57894642, "comment_id": 102211189, "body": "@user4581301 Thank you, i&#39;ll adapt in bytes"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568226201, "post_id": 57894753, "comment_id": 102210926, "body": "@kileatb I think we&#39;ll need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ir order to say much more. I&#39;ll have to pass though as I&#39;ve only got 16 GB at my disposal. Left my Cray in my other pants."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568226417, "post_id": 57894753, "comment_id": 102211017, "body": "@kileatb: Your error message tells you the problem there; looks like your standard library implementer put a strict limit of <code>0x7fffffff</code> bytes on <code>std::bitset</code> or the storage implementation it uses, so you&#39;re stuck; you need a different implementation, either from a different compiler writer, or reimplementing it yourself."}, {"owner": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568226541, "post_id": 57894753, "comment_id": 102211080, "body": "@ShadowRanger Can I change the max size for my platform or i have to create a different implementation?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568226815, "post_id": 57894753, "comment_id": 102211214, "body": "@kileatb VC++ has a hard compiler limit for the size of arrays. This isn&#39;t an error produced by the standard library, it&#39;s the actual compiler complaining. I believe this is due to a Windows technical limitation to how processes are loaded. I doubt you&#39;ll get around this without changing platform entirely."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 1, "creation_date": 1568227038, "post_id": 57894753, "comment_id": 102211299, "body": "@kileatb Apparently, <a href=\"https://software.intel.com/en-us/articles/memory-limits-applications-windows\" rel=\"nofollow noreferrer\">static data is capped at 2GB for an image</a>. Even breaking up your <code>bitset</code>s into smaller ones won&#39;t help you. You could try dynamically allocating them (up to 8TB)."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568227320, "post_id": 57894753, "comment_id": 102211401, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/compiler-errors-1/compiler-error-c2148?view=vs-2019\" rel=\"nofollow noreferrer\">MSDN page for the error</a>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568227460, "post_id": 57894753, "comment_id": 102211464, "body": "@Fran&#231;oisAndrieux: I&#39;ve added that info to the answer; thanks for finding it."}, {"owner": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568227607, "post_id": 57894753, "comment_id": 102211532, "body": "How can I create std::bitset array in dynamic data?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "edited": false, "score": 0, "creation_date": 1568227685, "post_id": 57894753, "comment_id": 102211553, "body": "@kileatb: Just added that to the end of the answer; <code>std::unique_ptr</code> is probably the way to do this (low overhead, no risk of memory leak)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568227906, "post_id": 57894753, "comment_id": 102211641, "body": "@ShadowRanger Note that even with dynamic allocations, the size of any given individual array is still limited to <code>0x7fffffff</code> on Windows even in 64 bit but you can allocate many of them. The technical reasons are not clear to me."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568230902, "post_id": 57894753, "comment_id": 102212958, "body": "@Fran&#231;oisAndrieux: Ah. So the original error is because arrays are length limited, but even if that error didn&#39;t occur, it would have failed due to the static data cap. But it also means there is no way around the issue without cobbling together multiple <code>bitset</code>s. That&#39;s... so dumb. I assume the limit doesn&#39;t apply to stuff that isn&#39;t backed by a proper array, so maybe <code>std::vector&lt;bool&gt;(100000000000)</code> or maybe <code>boost::dynamic_bitset</code>? might do the trick by not declaring a statically sized array? The latter should have the same features (but requires boost), the former would be more limited."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568231597, "post_id": 57894753, "comment_id": 102213209, "body": "@ShadowRanger <code>std::vector&lt;bool&gt;</code> <i>might</i> work, depending on how it&#39;s implemented. But I imagine it may still be backed by a single array. You could write your own class to fake the contiguity. In reality I don&#39;t know why you actually would need hundreds of billions of contiguous individual bits. But I agree that in principal, it&#39;s an unfortunate limitation. This is likely a casualty of Microsoft&#39;s excellent backwards compatibility. I found some blog posts about C# and VB.NET about how they had to work around this problem for large arrays, so it&#39;s likely not fixable at the user level."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 4, "last_activity_date": 1568227628, "last_edit_date": 1568227628, "creation_date": 1568225916, "answer_id": 57894753, "question_id": 57894642, "link": "https://stackoverflow.com/questions/57894642/im-using-stdbitset-and-trying-to-create-two-arrays-stdbitset-with-size-100/57894753#57894753", "title": "I&#39;m using std::bitset and trying to create two arrays std::bitset with size 100,000,000,000", "body": "<p><code>std::bitset</code> must, at a minimum (and most implementations use the minimum), use one byte per eight bits to be stored. For 100 billion bits, that means you need ~12.5 GB of memory per bitset. Problem is, on a 32 bit system, your maximum virtual memory size for the whole program is at most 4 GB. Some of that is eaten by the kernel memory reservation for the process, so odds are you only have 2 GB of virtual address space to use; you're trying to use six times that much.</p>\n\n<p>Your program <em>cannot</em> run on a 32 bit system without shrinking the <code>bitset</code>. If it claims to run, it's likely a different error; it would be truncating <code>100_000_000_000</code> to fit in a 32 bit <code>size_t</code>, creating a <code>std::bitset&lt;1215752192&gt;</code> instead, which would only require ~150 MB of memory, causing no problems. That would explain your observed memory usage of 298 MB; the memory usage display uses \"mebibytes\" (base-2, not base-10, so KiB == 1024 and MiB == 1048576), which makes each array consume just under 145 MiB, 290 MiB total for two of them, leaving 8 MiB for the rest of your program (which seems reasonable).</p>\n\n<p>If it is in fact dying on x64 with that error, you're stuck; whoever implemented your <code>std::bitset</code> (or whatever data structure backs it, e.g. <code>std::array</code>) limited it to <code>0x7fffffff</code> bytes even on a 64 bit system, which would limit you to <code>std::bitset</code>s of around 17 billion bits or less. Your only option would be to find a different provider for your standard library, or reimplement it yourself.</p>\n\n<p><strong>Update:</strong> Apparently you're using Windows, and the limit on static data size is 2GB (0x7fffffff bytes), <a href=\"https://software.intel.com/en-us/articles/memory-limits-applications-windows\" rel=\"nofollow noreferrer\">even on 64 bit Windows</a>; the Windows Portable Executable file format (used by <code>.exe</code> and <code>.dll</code> files) uses 32 bit offsets and lengths for each section, even for 64 bit executables. By using global <code>std::bitset</code>s, you're trying to store 25 GB of static data in the image, which won't work. Moving them to the stack (declaring them non-<code>static</code> inside the body of <code>main</code>) <em>might</em> work if you increase the Stack Reserve Size like you did, but it's still a bad idea to rely on a stack that large. I'd suggest simply dynamically allocating the <code>bitset</code> (e.g. <code>auto mas = std::make_unique&lt;std::bitset&lt;100000000000&gt;&gt;()</code>), or finding a better way to do this with a smaller <code>bitset</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 12054428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd34fce68e8bebc3d901de441fdd1a1?s=128&d=identicon&r=PG&f=1", "display_name": "kileatb", "link": "https://stackoverflow.com/users/12054428/kileatb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 57894753, "answer_count": 1, "score": 2, "last_activity_date": 1568227832, "creation_date": 1568225413, "last_edit_date": 1568227832, "question_id": 57894642, "link": "https://stackoverflow.com/questions/57894642/im-using-stdbitset-and-trying-to-create-two-arrays-stdbitset-with-size-100", "title": "I&#39;m using std::bitset and trying to create two arrays std::bitset with size 100,000,000,000", "body": "<p>I am using std::bitset and I try to create two arrays std::bitset with size 100,000,000,000. \nAs a result, program fills only 298 MB of my RAM but must to fill ~24 GB. I have 32 GB RAM and now 26 GB are free. When I build my code for x86, it compiles and can start but for x64 it shows me the following: error C2148: total size of array must not exceed 0x7fffffff bytes.\nHow to fix it and do not reduce size of bitset arrays?</p>\n\n<p>I have tried to make 2 global arrays.\nAlso, I have set in Microsoft visual studio -> project -> name_project properties -> configuration properties -> linker -> system -> Stack Reserve Size to 25,000,000 (i think that there must be KB, so i think i have set to ~25 GB).</p>\n\n<pre><code>... // other libraries\n#include &lt;bitset&gt;\n\nstd::bitset &lt;100000000000&gt;mas;\nstd::bitset &lt;100000000000&gt;a1;\n\nint main() {.../* work with the arrays */...}\n</code></pre>\n\n<p>I want to run the code with the huge std::bitset arrays.</p>\n\n<p>UPD: for x86 ok, but what for x64? my code checks whole arrays and at one moment it stops.</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1568225785, "post_id": 57894615, "comment_id": 102210747, "body": "Any reasons for not using <code>std::vector</code>?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1568225854, "post_id": 57894615, "comment_id": 102210765, "body": "<code>int data[r];</code> is not valid C++ (only  valid C), though some compilers support it as <i>extension</i> (thus is not portable!)."}, {"owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568226233, "post_id": 57894615, "comment_id": 102210932, "body": "@Aconcagua in vector will it be easy"}, {"owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568226262, "post_id": 57894615, "comment_id": 102210944, "body": "@Aconcagua then how to solve this"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1568226340, "post_id": 57894615, "comment_id": 102210984, "body": "How can input be <code>0 1 2 3 4</code> if you only read two values (<code>n</code> and <code>m</code>)? If I understand your question correctly, you&#39;d have input 5 and 2 to get printed output, wouldn&#39;t you?"}, {"owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568226595, "post_id": 57894615, "comment_id": 102211105, "body": "n is the size of array where array always start from 0 and end upto n and m is size of subset to be generated"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568226631, "post_id": 57894615, "comment_id": 102211129, "body": "Why would you want to remove 0, 2 and 2, 3 exactly? What are the criteria for those to be removed?"}, {"owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568226768, "post_id": 57894615, "comment_id": 102211188, "body": "i want to know how to remove the subset after getting the distinct subset if i want to remove (0,2) from the distinct subset how to solve this"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568227122, "post_id": 57894615, "comment_id": 102211329, "body": "You won&#39;t remove, you just will skip printing, as you actually never generate all sets. But do you have any criteria for specific numbers? Which sets would you select, if input was 5, 3? Some general critera for selecting the sets to skip, something like &quot;I want to print all numbers, but exclude those that are not prime&quot;."}, {"owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568227212, "post_id": 57894615, "comment_id": 102211364, "body": "got it okay if input is n=5 m=3 and i have to remove m subset like (1,2),(3,4),(0,4) from generated subset"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568227936, "post_id": 57894615, "comment_id": 102211663, "body": "That doesn&#39;t make sense. With m = 3, your sets should contain three numbers, shouldn&#39;t they? Thus (1, 2, 3), ..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568227942, "post_id": 57894615, "comment_id": 102211669, "body": "Just a totally general answer: You print the array as soon as last position is filled in, that&#39;s fine, but before actually printing, you&#39;d need to check if the set stored in the array meets the desired criteria (whichever they are...), e. g. <code>if(index == r) { int sum = 0; for(int j = 0; j &lt; r; ++j) { sum += data[j]; } if(sum == 10 || sum == 12) { for(int j = 0; j &lt; r; ++j) { printf(&quot;%d &quot;, data[j]); } }</code> would print only those sets which sum up to either 10 or 12..."}, {"owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568228479, "post_id": 57894615, "comment_id": 102211929, "body": "see if n= 5 and m=3 then n size array will be {0,1,2,3,4} and we have to generate of subset of size 2  the generated subset 0 1  0 2  0 3  0 4  1 2  1 3  1 4  2 3  2 4  3 4 and m is the subset which we have to remove {0,1},{1,2},{2,3}"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568237606, "post_id": 57894615, "comment_id": 102215172, "body": "Citing yourself: <i>&#39;m is size of subset[s?] to be generated&#39;</i> \u2013 your own code generates appropriate subsets, i. e. for m = 3 it generates 012, 013, 014, 023, ... You are providing contradictory information!"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1568237963, "post_id": 57894615, "comment_id": 102215266, "body": "Just guessing: Could it be that you would remove for n=5 and m=3 subsets 012, 123, 234? That would be of each group of subsets with same smallest number the one with lowest sum. As your algorithm produces the subsets sorted, you&#39;d need to skip a new subset as soon as very first number in data array changes..."}], "owner": {"reputation": 19, "user_id": 8931352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa47f8e13ef1989905b1d44185dbae0d?s=128&d=identicon&r=PG&f=1", "display_name": "Niranjan Pradhan", "link": "https://stackoverflow.com/users/8931352/niranjan-pradhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1568226267, "creation_date": 1568225318, "last_edit_date": 1568226267, "question_id": 57894615, "link": "https://stackoverflow.com/questions/57894615/how-to-delete-the-subset-from-array", "title": "how to delete the subset from array?", "body": "<p>i had find all the subset of size k of given array with distinct elements.</p>\n\n<p>i want to delete the subset from a generated subset that i got from the array.</p>\n\n<p>how to remove the subset from all subset that is generated.</p>\n\n<p>just give the idea to solve this type of problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt; \nvoid combinationUtil(int arr[], int n, int r, int index, int data[], int i); \n\nvoid printCombination(int arr[], int n, int r) \n{ \n    int data[r]; \n\n    combinationUtil(arr, n, r, 0, data, 0); \n} \n\nvoid combinationUtil(int arr[], int n, int r, int index, \n                    int data[], int i) \n{ \n    if (index == r) { \n        for (int j = 0; j &lt; r; j++) \n            printf(\"%d \", data[j]); \n        printf(\"\\n\"); \n        return; \n    } \n    if (i &gt;= n) \n        return; \n    data[index] = arr[i]; \n    combinationUtil(arr, n, r, index + 1, data, i + 1); \n\n    combinationUtil(arr, n, r, index, data, i + 1); \n} \n\nint main() \n{\n    int n,m;\n    cin&gt;&gt;n&gt;&gt;m; \n    int arr[n];\n    for(int i=0;i&lt;n;i++){\n        arr[i]=i;\n    }\n    printCombination(arr, n, m);\n\n    return 0; \n} \n\nif input is 0 1 2 3 4\nand output is\n0 1 \n0 2 \n0 3 \n0 4 \n1 2 \n1 3 \n1 4 \n2 3 \n2 4 \n3 4 \n</code></pre>\n\n<p>if i want to remove subset 0 2 and 2 3 how to solve this</p>\n"}, {"tags": ["c++", "com", "ms-office", "activex"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568267021, "post_id": 57894575, "comment_id": 102221338, "body": "No, any COM component with a visual representation in the spreadsheet must be an in-process server.  Like Roman&#39;s."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1568319287, "post_id": 57894575, "comment_id": 102246811, "body": "@HansPassant That&#39;s not true. E.g. you can embed a Word document into Excel spreadsheet. What is true though is that ATL doesn&#39;t provide the complete OLE server implementation out of the box; it&#39;s geared towards in-proc ActiveX controls. There are lots of complicated details to make OLE work. One can use MFC (which does provide all or most of the necessary scaffolding), or implement significant chunks by hand."}, {"owner": {"reputation": 1, "user_id": 9163878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d97edb8a1d7677988fd85213114e0b?s=128&d=identicon&r=PG&f=1", "display_name": "roentgen", "link": "https://stackoverflow.com/users/9163878/roentgen"}, "edited": false, "score": 0, "creation_date": 1568393893, "post_id": 57894575, "comment_id": 102272859, "body": "I know ActiveX potentially works in out-of-process. But &quot;Microsoft Word Document&quot; could not embed as an ActiveX Control in generic way like other controls."}], "owner": {"reputation": 1, "user_id": 9163878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d97edb8a1d7677988fd85213114e0b?s=128&d=identicon&r=PG&f=1", "display_name": "roentgen", "link": "https://stackoverflow.com/users/9163878/roentgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568225155, "creation_date": 1568225155, "question_id": 57894575, "link": "https://stackoverflow.com/questions/57894575/how-can-i-embed-activex-exe-out-of-process-server-into-excel-spreadsheet", "title": "How can I embed ActiveX-EXE (out-of-process server) into Excel spreadsheet", "body": "<p>Here I have an ATL-based ActiveX (DLL) that can embed into excel-spreadsheet.\nI changed this to EXE(out-of-process server) by using ATL::CAtlExeModuleT and the entry point, WinMain().\nBut excel shows error msg - \"cannot insert object\" after servername.exe /RegServer.</p>\n\n<p>svchost.exe spawns a process 'servername /Embedding' then I've got only above error msg.</p>\n\n<p>I want figure some out:<br>\n 1. Can excel embed ActiveX EXE?<br>\n 2. And how can I do this?</p>\n\n<p>I tested the component (EXE) in:</p>\n\n<ul>\n<li>My OLE Client</li>\n<li>MS's TestCon</li>\n<li>WSH, var object = new ActiveXObject(\"ExcelControl.Sample\");</li>\n</ul>\n\n<p>These seem to good for me.</p>\n\n<p>in Excel:</p>\n\n<ul>\n<li>CreateObject works but this only for COM, this does not provide properties Left, Top, Width and Height</li>\n<li><p><code>=EMBED(\"ExcelControl.Sample.1\", \"\")</code> and <code>Worksheet(1).OLEObjects.Add \"ExcelControl.Sample.1\"</code> failed after following steps</p>\n\n<ol>\n<li>looks the component up  </li>\n<li>reads type lib from the exe and write it down to temp/Excel8.0  </li>\n<li>svchost.exe spawns the exe with /Embedding option  </li>\n</ol></li>\n</ul>\n\n<p>And I tried to write ActiveX(EXE) by Win32API.\nIn Excel, The EXE was spawned with /Embedding by svchost, but no one calls IClassFactory::QueryInterface despite CoRegisterClassObject's succeseeded.\nOther containers can create the ActiveX(EXE) by CreateObject and QueryInterface.</p>\n\n<p>the control (has no event) is:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class ATL_NO_VTABLE CSample :\n    public CComObjectRootEx&lt;CComSingleThreadModel&gt;,\n    public IDispatchImpl&lt;ISample, &amp;IID_ISample, &amp;LIBID_ExcelControlLib, /*wMajor =*/ 1, /*wMinor =*/ 0&gt;,\n    public IPersistStreamInitImpl&lt;CSample&gt;,\n    public IOleControlImpl&lt;CSample&gt;,\n    public IOleObjectImpl&lt;CSample&gt;,\n    public IOleInPlaceActiveObjectImpl&lt;CSample&gt;,\n    public IViewObjectExImpl&lt;CSample&gt;,\n    public IOleInPlaceObjectWindowlessImpl&lt;CSample&gt;,\n    public ISupportErrorInfo,\n    public IQuickActivateImpl&lt;CSample&gt;,\n    public IDataObjectImpl&lt;CSample&gt;,\n    public IProvideClassInfo2Impl&lt;&amp;CLSID_Sample, NULL, &amp;LIBID_ExcelControlLib&gt;,\n    public CComCoClass&lt;CSample, &amp;CLSID_Sample&gt;,\n    public CComControl&lt;CSample&gt;\n{\n</code></pre>\n\n<p>this code is based on <a href=\"http://alex.info\" rel=\"nofollow noreferrer\">http://alex.info</a> Roman Ryltsov</p>\n\n<p><a href=\"http://www.alax.info/svn/public/trunk/Utilities/Miscellaneous/ExcelControl/\" rel=\"nofollow noreferrer\">http://www.alax.info/svn/public/trunk/Utilities/Miscellaneous/ExcelControl/</a></p>\n"}, {"tags": ["c++", "c++11", "nested-lists", "initializer-list", "compile-time-constant"], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1568231410, "creation_date": 1568231410, "answer_id": 57895912, "question_id": 57894444, "link": "https://stackoverflow.com/questions/57894444/using-stdinitializer-list-as-const-list-of-lists-of-varying-length/57895912#57895912", "title": "Using std::initializer_list[] as const list of lists of varying length", "body": "<p>The standard says</p>\n\n<blockquote>\n  <p>An object of type initializer_list provides access to an array of objects of type const E. </p>\n</blockquote>\n\n<p>It does not suggests that such objects are to be used exclusively as temporaries for initialising other objects, though this is without a doubt the primary intended use. The standard actually provides an example of it being correctly used as a variable. </p>\n\n<p>So I cannot see anything wrong with what you have done.</p>\n"}, {"tags": [], "owner": {"reputation": 804, "user_id": 697080, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d173697fee6686cc8c0d988b17fec3a1?s=128&d=identicon&r=PG", "display_name": "jvstech", "link": "https://stackoverflow.com/users/697080/jvstech"}, "is_accepted": true, "score": 2, "last_activity_date": 1568231714, "creation_date": 1568231714, "answer_id": 57895975, "question_id": 57894444, "link": "https://stackoverflow.com/questions/57894444/using-stdinitializer-list-as-const-list-of-lists-of-varying-length/57895975#57895975", "title": "Using std::initializer_list[] as const list of lists of varying length", "body": "<p>Knowing your compiler output can help you with this decision. <code>std::initializer_list&lt;&gt;</code> is <a href=\"https://en.cppreference.com/w/cpp/utility/initializer_list\" rel=\"nofollow noreferrer\">just a thin wrapper around an array of objects</a>.</p>\n\n<p>If you really need static constant data, <code>std::initializer_list&lt;&gt;[]</code> is perfectly valid (as long as you don't mind using its accessing syntax instead of subscript operators like you would find on <code>std::array&lt;&gt;</code> or <code>std::vector&lt;&gt;</code>). Clang 8 lowers each <code>initializer_list</code> in the array to its own fixed-length array of <code>QPointF</code> structs. It then fills another array with references to the <code>QPointF</code> arrays it created:</p>\n\n<pre><code>// pseudo-C++ from Clang's generated output\n\nQPointF RT1[1] = { { 0.50f, 0.50f } };\nQPointF RT2[2] = { { 0.25f, 0.25f }, { 0.75f, 0.75f } };\nQPointF RT3[3] = { { 0.25f, 0.25f }, { 0.50f, 0.50f }, { 0.75f, 0.75f } };\nQPointF RT4[4] = { { 0.25f, 0.25f }, { 0.75f, 0.75f }, { 0.25f, 0.75f }, { 0.75f, 0.25f } };\nQPointF RT5[5] = { { 0.25f, 0.25f }, { 0.75f, 0.75f }, { 0.50f, 0.50f }, { 0.25f, 0.75f }, { 0.75f, 0.25f } };\nQPointF RT6[6] = { { 0.25f, 0.25f }, { 0.75f, 0.75f }, { 0.25f, 0.50f }, { 0.75f, 0.50f }, { 0.25f, 0.75f }, { 0.75f, 0.25f } };\n\n// Reference array:\nQPointF* points[6] = { RT1, RT2, RT3, RT4, RT5, RT6 };\n</code></pre>\n\n<p>Accessing individual values from the list</p>\n\n<pre><code>(points[5].begin() + 3)-&gt;y\n</code></pre>\n\n<p>is lowered to <em>essentially</em> the equivalent of</p>\n\n<pre><code>points[5][3].y\n// alternatively:\n(*(*(points + 5) + 3)).y\n// which is actually:\n(*(RT5 + 3)).y\n</code></pre>\n\n<p>(Implementations of <code>std::initializer_list&lt;&gt;::begin()</code> can differ.)</p>\n\n<p>So if you don't mind hidden dereferences or different syntax styles, this is fine. (Although you would have dereferenecs occuring with arrays or vectors, too.)</p>\n\n<p>Try it with different optimization levels and see the results: <a href=\"https://godbolt.org/z/Vwjbp2\" rel=\"nofollow noreferrer\">https://godbolt.org/z/Vwjbp2</a></p>\n"}], "owner": {"reputation": 396, "user_id": 7920139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb5cd6b5be96b065e3b428a7b68c4d84?s=128&d=identicon&r=PG&f=1", "display_name": "M. Winter", "link": "https://stackoverflow.com/users/7920139/m-winter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 57895975, "answer_count": 2, "score": 1, "last_activity_date": 1568231714, "creation_date": 1568224514, "last_edit_date": 1568226001, "question_id": 57894444, "link": "https://stackoverflow.com/questions/57894444/using-stdinitializer-list-as-const-list-of-lists-of-varying-length", "title": "Using std::initializer_list[] as const list of lists of varying length", "body": "<p>I need a static const <strong>list of lists of varying length</strong> (of <code>QPointF</code> from Qt) that I directly initialize in my code (see below), and which is only used read-only later on. </p>\n\n<p>I first used <code>const std::vector&lt;QPointF&gt;[]</code> for that, but then it ocured to me that I could just use <code>const std::initializer_list&lt;QPointF&gt;[]</code> instead (is the <code>const</code> even necessary?).</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>static const std::initializer_list&lt;QPointF&gt; points[6] = {\n        { { 0.50f, 0.50f } },\n        { { 0.25f, 0.25f }, { 0.75f, 0.75f } },\n        { { 0.25f, 0.25f }, { 0.50f, 0.50f }, { 0.75f, 0.75f } },\n        { { 0.25f, 0.25f }, { 0.75f, 0.75f }, { 0.25f, 0.75f }, { 0.75f, 0.25f } },\n        { { 0.25f, 0.25f }, { 0.75f, 0.75f }, { 0.50f, 0.50f }, { 0.25f, 0.75f }, { 0.75f, 0.25f } },\n        { { 0.25f, 0.25f }, { 0.75f, 0.75f }, { 0.25f, 0.50f }, { 0.75f, 0.50f }, { 0.25f, 0.75f }, { 0.75f, 0.25f } },\n    };\n</code></pre>\n\n<p>Is this a valid use of <code>std::initializer_list</code>? It looks like a hack to me, probably because the name of <code>std::iniatilizer_list</code> suggests a certain use. Answers to <a href=\"https://stackoverflow.com/q/27753420/7920139\">this</a> post also mention that initializer lists are intended to be used for, well, initialization of e.g. containers.</p>\n\n<p>I also considered <code>const std::array&lt;...&gt;[]</code>, but then all the inner lists have to be of the same length.</p>\n\n<p>If <code>std::initializer_list</code> is not the right choice here, then how to do this correctly. The alternative <code>std::vector</code> does not feel right because of the heap allocation.</p>\n"}, {"tags": ["c++", "std"], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 11936229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11da23565b039811f58b2beecf7493b3?s=128&d=identicon&r=PG&f=1", "display_name": "BTables", "link": "https://stackoverflow.com/users/11936229/btables"}, "is_accepted": false, "score": 2, "last_activity_date": 1568226135, "creation_date": 1568226135, "answer_id": 57894804, "question_id": 57894396, "link": "https://stackoverflow.com/questions/57894396/find-all-occurrences-of-a-byte-sequence-in-a-binary-file/57894804#57894804", "title": "Find all occurrences of a byte sequence in a binary file", "body": "<p>Since std::search() returns and iterator to the first occurrence, you can just use that first occurance as your (non-inclusive) starting point to search again.</p>\n\n<pre><code>while(currNAL != source.end()){\n    currNAL = std::search(++currNAL, end, NAL.begin(), NAL.end());\n    //Increment some counter here?\n}\n</code></pre>\n\n<p>I should note this is untested code and I'm not meaning this to be an exact solution for your exact problem, just demonstrating the idea.</p>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 1366027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8113fc570a09e03414126d8cda5f971c?s=128&d=identicon&r=PG", "display_name": "pcarter", "link": "https://stackoverflow.com/users/1366027/pcarter"}, "is_accepted": false, "score": 0, "last_activity_date": 1568227100, "last_edit_date": 1568227100, "creation_date": 1568226592, "answer_id": 57894917, "question_id": 57894396, "link": "https://stackoverflow.com/questions/57894396/find-all-occurrences-of-a-byte-sequence-in-a-binary-file/57894917#57894917", "title": "Find all occurrences of a byte sequence in a binary file", "body": "<p>Here's a complete example showing how search can be used to find all the instances using a <code>vector</code>. The ideas still apply to your case, you're just using <code>istream_iterator</code> instead of <code>vector</code> iterators.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n  std::vector&lt;unsigned char&gt; vec(500);\n\n  for(int i=0; i &lt; 500; i++)\n    vec[i] = static_cast&lt;unsigned char&gt;(i % 100);\n\n  std::vector&lt;unsigned char&gt; pattern { 'A', 'B' };\n\n  auto start = vec.begin();  // start searching a beginning\n  while ( (start = std::search(start, vec.end(), pattern.begin(), pattern.end())) != vec.end()) {\n    std::cout &lt;&lt; \"Found at index: \" &lt;&lt; std::distance(vec.begin(), start) &lt;&lt; std::endl;\n    start++;     // Search after this match on next iteration\n  }\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3182087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf7ef3b2a28970bdd097f1f8ae05003?s=128&d=identicon&r=PG&f=1", "display_name": "user3182087", "link": "https://stackoverflow.com/users/3182087/user3182087"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568245502, "creation_date": 1568224313, "last_edit_date": 1568245502, "question_id": 57894396, "link": "https://stackoverflow.com/questions/57894396/find-all-occurrences-of-a-byte-sequence-in-a-binary-file", "title": "Find all occurrences of a byte sequence in a binary file", "body": "<p>Please help me understand how to use <code>std::search</code> to get all occurrences of {0x00, 0x00, 0x00, 0x01} in a binary file.</p>\n\n<p>The Code below finds the first occurrence:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>std::string NAL = \"\\x00\\x00\\x00\\x01\";\nstd::ifstream source(\"somedata.dat\", std::ios::binary);\nstd::istream_iterator&lt;unsigned char&gt; begin(source), end, currNAL;\ncurrNAL = std::search(begin, end, NAL.begin(), NAL.end());\n</code></pre>\n\n<p>I do not understand how to use <code>std::search</code> in a while loop.</p>\n"}, {"tags": ["c++", "unique-ptr"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568223944, "post_id": 57894279, "comment_id": 102210034, "body": "It looks like you forgot to <code>return</code> in <code>CreateSecondClass</code>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568224166, "post_id": 57894279, "comment_id": 102210127, "body": "<code>std::unique_ptr&lt;Obj&gt; first_obj_</code> shadows <code>this-&gt;first_obj_</code>. Your <code>FirstClass</code> constructor doesn&#39;t actually do anything."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568224238, "post_id": 57894279, "comment_id": 102210152, "body": "It looks like your entire <code>class</code>s are <code>private</code>. From the series of mistakes I&#39;ve noticed, this doesn&#39;t appear to be real code you&#39;ve tried. Before asking about code here, it&#39;s important to test it yourself first. It helps us better answer your actual question."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568224532, "post_id": 57894303, "comment_id": 102210274, "body": "@Fran&#231;oisAndrieux - &quot;<i>if you have a <code>unique_ptr</code> with a do nothing deleter, you probably want a raw pointer anyway</i>&quot; - yes, that is why I said &quot;in which case, you shouldn&#39;t be using 2 <code>unique_ptr</code> objects to begin with&quot;."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1568224481, "last_edit_date": 1568224481, "creation_date": 1568223809, "answer_id": 57894303, "question_id": 57894279, "link": "https://stackoverflow.com/questions/57894279/creating-unique-ptrs-from-a-raw-ptr-of-another-unique-ptr/57894303#57894303", "title": "Creating unique ptrs from a raw ptr of another unique ptr", "body": "<blockquote>\n  <p>What happens when I create a unique pointer using the raw pointer of another unique pointer?</p>\n</blockquote>\n\n<p>BAD THINGS CAN HAPPEN!</p>\n\n<p>You end up with 2 <code>unique_ptr</code> objects that both think they are the exclusive owner of the raw pointer, and so both objects will try to manage and ultimately free the owned memory.  To avoid that, you have to pass ownership from one <code>unique_ptr</code> to the other, or else give at least one of the <code>unique_ptr</code>s a custom <code>deleter</code> that does not free the memory (in which case, you shouldn't be using 2 <code>unique_ptr</code> objects to begin with).</p>\n\n<blockquote>\n  <p>In the example below, what would happen when create second class is called?</p>\n</blockquote>\n\n<p>Both <code>first_obj_</code> and <code>second_obj_</code> end up holding pointers to the same <code>Object</code> in memory, and both of them will try to <code>delete</code> it.</p>\n\n<blockquote>\n  <p>I thought that <code>first_obj_</code> would give up ownership when <code>second_obj_</code> is created</p>\n</blockquote>\n\n<p>No, because <code>unique_ptr::get()</code> simply returns a copy of the raw pointer, it does not release ownership of the pointer.  If you want that, use <code>unique_ptr::release()</code> instead:</p>\n\n<pre><code>class SecondClass {\npublic:\n    SecondClass(Object* obj) : second_obj_(obj) {}\n    ...\nprivate:\n    std::unique_ptr&lt;Object&gt; second_obj_;\n};\n\nclass FirstClass {\npublic:\n    FirstClass() : first_obj_(std::make_unique&lt;Object&gt;()) {}\n\n    std::unique_ptr&lt;SecondClass&gt; CreateSecondClass() {\n        return std::make_unique&lt;SecondClass&gt;(first_obj_.release());\n    }\n    ...\nprivate:\n    std::unique_ptr&lt;Object&gt; first_obj_;\n};\n</code></pre>\n\n<p>Otherwise, you can simply <code>std::move</code> one <code>unique_ptr</code> into the other:</p>\n\n<pre><code>class SecondClass {\npublic:\n    SecondClass(std::unique_ptr&lt;Object&gt; obj) : second_obj_(std::move(obj)) {}\n    ...\nprivate:\n    std::unique_ptr&lt;Object&gt; second_obj_;\n};\n\nclass FirstClass {\npublic:\n    FirstClass() : first_obj_(std::make_unique&lt;Object&gt;()) {}\n\n    std::unique_ptr&lt;SecondClass&gt; CreateSecondClass() {\n        return std::make_unique&lt;SecondClass&gt;(std::move(first_obj_));\n    }\n    ...\nprivate:\n    std::unique_ptr&lt;Object&gt; first_obj_;\n};\n</code></pre>\n\n<p>If you truly want <code>FirstClass</code> and <code>SecondClass</code> to share the same pointer, then use <code>std::shared_ptr</code> instead of <code>std::unique_ptr</code>:</p>\n\n<pre><code>class SecondClass {\npublic:\n    SecondClass(std::shared_ptr&lt;Object&gt; obj) : second_obj_(obj) {}\n    ...\nprivate:\n    std::shared_ptr&lt;Object&gt; second_obj_;\n};\n\nclass FirstClass {\npublic:\n    FirstClass() : first_obj_(std::make_shared&lt;Object&gt;()) {}\n\n    std::unique_ptr&lt;SecondClass&gt; CreateSecondClass() {\n        return std::make_unique&lt;SecondClass&gt;(first_obj_);\n    }\n    ...\nprivate:\n    std::shared_ptr&lt;Object&gt; first_obj_;\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568223915, "post_id": 57894309, "comment_id": 102210020, "body": "If you <code>release</code> with the intention of passing the pointer to another <code>unique_ptr</code>, you should just use move semantics instead."}], "tags": [], "owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "is_accepted": true, "score": 1, "last_activity_date": 1568224558, "last_edit_date": 1568224558, "creation_date": 1568223842, "answer_id": 57894309, "question_id": 57894279, "link": "https://stackoverflow.com/questions/57894279/creating-unique-ptrs-from-a-raw-ptr-of-another-unique-ptr/57894309#57894309", "title": "Creating unique ptrs from a raw ptr of another unique ptr", "body": "<p>You should use <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr/release\" rel=\"nofollow noreferrer\"><code>release()</code></a> if you want to give up ownership. </p>\n\n<p><code>std::unique_ptr</code> cannot know what you will do with the pointer extracted with <code>get()</code> and in particular it cannot know that you decided to give it to another <code>std::unique_ptr</code>. </p>\n\n<p>If two <code>std::shared_ptr</code>s will store the same pointer, you will get double <code>delete</code> of the object, which is Undefined Behaviour.</p>\n\n<hr>\n\n<p>However, if you want to pass ownership from one <code>std::unique_ptr</code> to another, you should probably use move semantics instead:</p>\n\n<pre><code>class Obj {};\n\nstruct SecondClass {\n    SecondClass(std::unique_ptr&lt;Obj&gt;&amp;&amp; obj) : second_obj_(std::move(obj)) {}\nprivate:\n    std::unique_ptr&lt;Obj&gt; second_obj_;\n};\n\nstruct FirstClass {\n    FirstClass() {\n        first_obj_ = std::make_unique&lt;Obj&gt;();\n    }\n\n    std::unique_ptr&lt;SecondClass&gt; CreateSecondClass() {\n        return std::make_unique&lt;SecondClass&gt;(std::move(first_obj_));  \n        //note that first_obj_ points to nullptr now. Only SecondClass owns the Obj.\n    }\nprivate:\n    std::unique_ptr&lt;Obj&gt; first_obj_;\n};\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6664914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e047d8be3bd95d2bb9a5fcb41c589b2?s=128&d=identicon&r=PG&f=1", "display_name": "ned", "link": "https://stackoverflow.com/users/6664914/ned"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 57894309, "answer_count": 2, "score": 0, "last_activity_date": 1568224558, "creation_date": 1568223659, "question_id": 57894279, "link": "https://stackoverflow.com/questions/57894279/creating-unique-ptrs-from-a-raw-ptr-of-another-unique-ptr", "title": "Creating unique ptrs from a raw ptr of another unique ptr", "body": "<p>What happens when I create a unique pointer using the raw pointer of another unique pointer? In the example below, what would happen when create second class is called? I thought that first_obj_ would give up ownership when second_obj_ is created, but first_obj_ doesn't give up ownership when get is called. </p>\n\n<pre><code>class SecondClass {\n     SecondClass(Object* obj) : second_obj_(obj) {}\n     .....\n     private:\n          std::unique_ptr&lt;Obj&gt; second_obj_;\n}\n\nclass FirstClass {\n     FirstClass() {\n          std::unique_ptr&lt;Obj&gt; first_obj_ = std::make_unique&lt;Obj&gt;();\n      }\n      std::unique_ptr&lt;SecondClass&gt; CreateSecondClass() {\n           std::make_unique&lt;Obj&gt;(first_obj_.get());      \n       }\n     .....\n     private:\n          std::unique_ptr&lt;Obj&gt; first_obj_;\n          SecondClass second_class;\n}\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1568223283, "post_id": 57894151, "comment_id": 102209766, "body": "Please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1568223410, "post_id": 57894151, "comment_id": 102209824, "body": "You don&#39;t reset <code>found</code> to zero on each iteration of the <code>do { \u2026\u00a0} while (\u2026);</code> loop."}, {"owner": {"reputation": 1806, "user_id": 8754516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7be49dad417bd035463828d197cfb7c?s=128&d=identicon&r=PG&f=1", "display_name": "natn2323", "link": "https://stackoverflow.com/users/8754516/natn2323"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1568223560, "post_id": 57894151, "comment_id": 102209888, "body": "You can also see that your <code>for</code> loop is dependent on the value of <code>found</code>, which applies to what @JonathanLeffler said"}, {"owner": {"reputation": 583, "user_id": 2720343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvJ2G.jpg?s=128&g=1", "display_name": "Dortimer", "link": "https://stackoverflow.com/users/2720343/dortimer"}, "edited": false, "score": 0, "creation_date": 1568228169, "post_id": 57894151, "comment_id": 102211763, "body": "You can simplify your input loop to this as well: <code>while(!cin){ cin&gt;&gt;numCoco; }</code> and then add whatever else you need in that block."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 10134583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VmOgw.jpg?s=128&g=1", "display_name": "Amin Asadi", "link": "https://stackoverflow.com/users/10134583/amin-asadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1568227950, "creation_date": 1568227950, "answer_id": 57895220, "question_id": 57894151, "link": "https://stackoverflow.com/questions/57894151/how-to-fix-missing-output-in-loops/57895220#57895220", "title": "How to fix missing output in loops", "body": "<p>You must set \"found\" variable to 0 before the for loop.You expect \"found\" variable to be 0 when the input is 30 but actually the line:</p>\n\n<pre><code>found = splitCoco(numCoco, numPeople);\n</code></pre>\n\n<p>never executes in the second iteration.</p>\n\n<p>The problem here is that after the first iteration(when input is 25), found is set to true and in the second iteration(when input is 30), found is still true so both the condition of \"for loop\" and the condition of the \"if block\" are false so none of them executes; so nothing is printed and the loop starts over.</p>\n"}], "owner": {"reputation": 11, "user_id": 12054374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PYOcGoIiJmE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re24MyDisiSsqR4i5uRLEHZTIKhNQ/photo.jpg?sz=128", "display_name": "Kim Valentin", "link": "https://stackoverflow.com/users/12054374/kim-valentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1568238815, "answer_count": 1, "score": 0, "last_activity_date": 1568227950, "creation_date": 1568223035, "last_edit_date": 1568223268, "question_id": 57894151, "link": "https://stackoverflow.com/questions/57894151/how-to-fix-missing-output-in-loops", "closed_reason": "Not suitable for this site", "title": "How to fix missing output in loops", "body": "<p>I'm new to C++ and I want to be able to run the program again as long as the user desires. But the problem is, whenever I loop the program, it doesn't show the outputs anymore. How do I fix this problem?</p>\n\n<pre><code>long numCoco = 0, numPeople = 0;\nchar again = 'Y';\n    do\n    {\n        cout &lt;&lt; \"enter the number of coconuts gathered: \";\n        cin &gt;&gt; numCoco;\n        //validate user input\n        while (numCoco &lt; 1 || numCoco &gt; 5000)\n        {\n            if (cin.fail())\n            {\n                cin.clear();\n                cin.ignore();\n\n                cout &lt;&lt; \"You have entered the wrong input\\n\";\n                cin &gt;&gt; numCoco;\n            }\n            if (!cin.fail())\n                break;\n        }\n\n        for (numPeople = numCoco - 1; numPeople &gt; 1 &amp;&amp; !found; numPeople--)\n        {\n            found = splitCoco(numCoco, numPeople);\n            if (found)\n            {\n                cout &lt;&lt; numCoco &lt;&lt; \" Coconuts, \" &lt;&lt; numPeople &lt;&lt; \" Persons, \" &lt;&lt; \" and 1 monkey\\n\\n\";\n            }\n\n        }\n            if (!found)\n            {\n                cout &lt;&lt; numCoco &lt;&lt; \" no solution\\n\\n\";\n            }\n\n        cout &lt;&lt; \"Run again? (Y/N): \";\n        cin &gt;&gt; again;\n    } while (again == 'y' || again == 'Y');\n</code></pre>\n\n<h3>Desired Output</h3>\n\n<pre><code>Enter the number of coconuts gathered: 25\n25 coconuts, 3 persons, and 1 monkey\nRun again(Y/N): y\n\nEnter the number of coconuts gathered: 30\n30 coconuts, No solution\nRun again(Y/N): N\n</code></pre>\n\n<h3>Actual Output</h3>\n\n<pre><code>Enter the number of coconuts gathered: 25\n25 coconuts, 3 persons, and 1 monkey\nRun again(Y/N): y\n\nEnter the number of coconuts gathered: 30\nRun again(Y/N): N\n</code></pre>\n"}, {"tags": ["c++", "arm", "clang"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1568223423, "post_id": 57894121, "comment_id": 102209833, "body": "Try including <code>&lt;cstdio&gt;</code> instead and see what happens."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568223621, "post_id": 57894121, "comment_id": 102209921, "body": "Where are those STL files? Are you sure they are somewhere in standard path?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1568223928, "post_id": 57894121, "comment_id": 102210027, "body": "<a href=\"https://stackoverflow.com/q/48369566/10957435\">A useful question</a>, <a href=\"https://stackoverflow.com/q/39968458/10957435\">another useful question</a>, and a <a href=\"https://www.quora.com/Why-does-llvm-clang-does-not-have-stdio-h-in-its-headers-in-Windows-Why-does-it-import-stdio-h-from-mingw-include-Doesnt-llvm-clang-support-Windows\" rel=\"nofollow noreferrer\">related quora question</a>."}, {"owner": {"reputation": 166, "user_id": 2840392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3054ba908ae858d38f7010459224c1e1?s=128&d=identicon&r=PG&f=1", "display_name": "BLowe", "link": "https://stackoverflow.com/users/2840392/blowe"}, "edited": false, "score": 0, "creation_date": 1568297174, "post_id": 57894121, "comment_id": 102236860, "body": "No, I&#39;m not sure they are in a path. It looks like arm-non-eabi-gcc has an include directory that has a bunch of standard header files. The problem is that there are multiple copies of some files (with slight variations) in subdirectories. Directories are named in a way that make me think that the flags that get passed to GCC are what chooses the include directories (hard vs soft float being an example). I am trying to go through and include things that look right but it&#39;s not super intuitive. Does this sound like the right process for arm/clang development?"}], "owner": {"reputation": 166, "user_id": 2840392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3054ba908ae858d38f7010459224c1e1?s=128&d=identicon&r=PG&f=1", "display_name": "BLowe", "link": "https://stackoverflow.com/users/2840392/blowe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1568223688, "creation_date": 1568222916, "question_id": 57894121, "link": "https://stackoverflow.com/questions/57894121/where-do-i-get-standard-library-headers-when-compiling-for-arm-cortex-m4-using-c", "title": "Where do I get standard library headers when compiling for arm cortex m4 using clang?", "body": "<p>When using clang++ to build a simple hello world application, clang can't find standard library files. Should I point clang to arm-none-eabi for those files?</p>\n\n<p>I'm using the clang binary downloaded from the llvm website.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"Hello World\");\n    return 0;\n}\n</code></pre>\n\n<p>Build Command:\n<code>clang++ -c -target arm-none-eabi -mcpu=cortex-m4 main.cpp</code></p>\n\n<p>The above fails to locate stdio.h</p>\n\n<p>Ultimately I'm going to be doing all of this using cmake on both windows and linux but I figure baby steps...</p>\n"}, {"tags": ["c++", "regex"], "comments": [{"owner": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 2, "creation_date": 1568222876, "post_id": 57894033, "comment_id": 102209600, "body": "Use <code>std::sregex_iterator</code> instead <a href=\"https://www.regular-expressions.info/stdregex.html\" rel=\"nofollow noreferrer\">regular-expressions.info/stdregex.html</a>"}, {"owner": {"reputation": 2926, "user_id": 514025, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f1bbef1a5883ccabdd682ccec2e736c?s=128&d=identicon&r=PG", "display_name": "Bill Yan", "link": "https://stackoverflow.com/users/514025/bill-yan"}, "reply_to_user": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 0, "creation_date": 1568228678, "post_id": 57894033, "comment_id": 102212042, "body": "that doesn&#39;t work, edited question"}, {"owner": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 0, "creation_date": 1568233414, "post_id": 57894033, "comment_id": 102213819, "body": "Try <code>std::regex words_regex(&quot;(&#47;[a-zA-Z0-9-_]+)&quot;);</code>"}, {"owner": {"reputation": 2926, "user_id": 514025, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f1bbef1a5883ccabdd682ccec2e736c?s=128&d=identicon&r=PG", "display_name": "Bill Yan", "link": "https://stackoverflow.com/users/514025/bill-yan"}, "reply_to_user": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 0, "creation_date": 1568254391, "post_id": 57894033, "comment_id": 102218608, "body": "this won&#39;t work, because it matches /afwef#/awefg, which is illicit path by my definition."}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1568254481, "post_id": 57894033, "comment_id": 102218623, "body": "To use a regex iterator, you have to remove the repetition from the regex itself and then iterate outside the regex, so it should work with <code>std::regex words_regex(&quot;(&#47;[a-zA-Z0-9-_]+)&quot;);</code>"}, {"owner": {"reputation": 4082, "user_id": 3216427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0186cf05b82361bc8de3344f542eaf?s=128&d=identicon&r=PG&f=1", "display_name": "joanis", "link": "https://stackoverflow.com/users/3216427/joanis"}, "edited": false, "score": 0, "creation_date": 1568254565, "post_id": 57894033, "comment_id": 102218640, "body": "By the way, <code>&#47;asdf&#47;&#47;qwer&#47;</code> is a valid path too, that your original regex won&#39;t allow. It&#39;s equivalent to <code>&#47;asdf&#47;qwer</code>, but it&#39;s still valid."}, {"owner": {"reputation": 2926, "user_id": 514025, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f1bbef1a5883ccabdd682ccec2e736c?s=128&d=identicon&r=PG", "display_name": "Bill Yan", "link": "https://stackoverflow.com/users/514025/bill-yan"}, "edited": false, "score": 0, "creation_date": 1568296350, "post_id": 57894033, "comment_id": 102236332, "body": "by my definition, it&#39;s not a valid path. my definition of a path is formalized by &quot;(/[a-zA-Z0-9-<i>]+)+&quot; , the question is about how to to get all captures of &quot;(/[a-zA-Z0-9-</i>]+)+&quot;,"}, {"owner": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 0, "creation_date": 1568304722, "post_id": 57894033, "comment_id": 102241022, "body": "It&#39;s still not clear to me. Do you want some sort of overlapping matches?"}, {"owner": {"reputation": 2926, "user_id": 514025, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f1bbef1a5883ccabdd682ccec2e736c?s=128&d=identicon&r=PG", "display_name": "Bill Yan", "link": "https://stackoverflow.com/users/514025/bill-yan"}, "edited": false, "score": 0, "creation_date": 1568398634, "post_id": 57894033, "comment_id": 102274615, "body": "given the string &quot; /afwef#/awefg&quot;, your solution will accept it and return &quot;/afwef&quot; &quot;/awefg&quot;. a correct logic, however, should reject the string as a valid input."}, {"owner": {"reputation": 16007, "user_id": 8291949, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a7pBo.gif?s=128&g=1", "display_name": "wp78de", "link": "https://stackoverflow.com/users/8291949/wp78de"}, "edited": false, "score": 0, "creation_date": 1568658499, "post_id": 57894033, "comment_id": 102336328, "body": "I think you want two things at once. Validate the string path and get the parts of the path separately. I came up with <a href=\"https://regex101.com/r/Pps3lb/2\" rel=\"nofollow noreferrer\">this</a> regex but recommend against it. Validate first then split."}], "owner": {"reputation": 2926, "user_id": 514025, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f1bbef1a5883ccabdd682ccec2e736c?s=128&d=identicon&r=PG", "display_name": "Bill Yan", "link": "https://stackoverflow.com/users/514025/bill-yan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1568223892, "answer_count": 0, "score": 0, "last_activity_date": 1568228658, "creation_date": 1568222541, "last_edit_date": 1568228658, "question_id": 57894033, "link": "https://stackoverflow.com/questions/57894033/how-to-use-stdregex-to-get-all-captures", "closed_reason": "Duplicate", "title": "How to use std::regex to get all captures?", "body": "<p>I'm trying to break apart a path formed by a series of folder names:</p>\n\n<p>\"/foldera/folderb/folderc\"</p>\n\n<p>into</p>\n\n<p>\"/foldera\" \"/folderb\" \"/folderc\"</p>\n\n<p>But I can't find out how to do this using std::regex,</p>\n\n<pre><code>{\n    std::regex exp(\"^(/[a-zA-Z0-9-_]+)+\");\n    std::smatch res;\n    std::string str = \"/uuu/kkk\";\n\n    std::regex_search( str, res, exp ) ;\n    {\n        std::cout &lt;&lt; res[0] &lt;&lt;\";\" &lt;&lt; res[1] &lt;&lt; std::endl;  \n    }\n    std::cout &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>It will only match either the whole string or the last \"/kkk\",</p>\n\n<p>I will never find the match \"/uuu\"</p>\n\n<p>I know the problem is solvable with string split, but I'm interested in a std::regex solution here, because the above is doable with javascript and Qt's regex. But I don't know how to do it with std::regex. </p>\n\n<p>PS. the following also doesn't work:</p>\n\n<pre><code>{\n    const std::string s = \"/uuu/kkk\";\n\n    std::regex words_regex(\"(/[a-zA-Z0-9-_]+)+\");\n    auto words_begin = \n        std::sregex_iterator(s.begin(), s.end(), words_regex);\n    auto words_end = std::sregex_iterator();\n\n    std::cout &lt;&lt; \"Found \" \n          &lt;&lt; std::distance(words_begin, words_end) \n          &lt;&lt; \" words:\\n\";\n\n    for (std::sregex_iterator i = words_begin; i != words_end; ++i) {\n        std::smatch match = *i;                                                 \n        std::string match_str = match.str(); \n        std::cout &lt;&lt; match_str &lt;&lt; '\\n';\n    }  \n}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1568230299, "post_id": 57894032, "comment_id": 102212723, "body": "There is no point reporting a bug, this is as documented. Using the guarantee that you provided (there is no NaN), gcc is able to generate smaller, more efficient code (you could look at the code generated for a function that just returns arg0==arg1, it is interesting). Now if you lied to your compiler and there are NaNs..."}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 6063908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wXrSZ.jpg?s=128&g=1", "display_name": "Spacechild1", "link": "https://stackoverflow.com/users/6063908/spacechild1"}, "edited": false, "score": 0, "creation_date": 1568229123, "post_id": 57894156, "comment_id": 102212247, "body": "thanks for your answer. actually, I&#39;m not interested in finding out if a float is a NaN (I know that this is unspecified with -ffast-math), but only whether <code>f1 == f2</code>. how/why does this yield true if f1 is a normal float and f2 has the bit pattern of a quiet NaN? and this is acceptable behavior of GCC? (I&#39;ll edit my question to clarify)"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1568230144, "post_id": 57894156, "comment_id": 102212662, "body": "It isn&#39;t just comisd vs ucomisd, gcc also checks different flags after the comparison."}, {"owner": {"reputation": 76, "user_id": 6063908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wXrSZ.jpg?s=128&g=1", "display_name": "Spacechild1", "link": "https://stackoverflow.com/users/6063908/spacechild1"}, "edited": false, "score": 0, "creation_date": 1568231152, "post_id": 57894156, "comment_id": 102213028, "body": "@Maxim Egorushkin I&#39;ve found another relevant part in the documentation for COMISD:  <code>The EFLAGS register is not updated if an unmasked SIMD floating-point exception is generated.</code>   since COMISD signals exceptions for quite NaNs, EFLAGS is not updated and so the output of the following comparison instructions is garbage. this would explain, why I only get this behavior in certain situations. am I correct?"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 76, "user_id": 6063908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wXrSZ.jpg?s=128&g=1", "display_name": "Spacechild1", "link": "https://stackoverflow.com/users/6063908/spacechild1"}, "edited": false, "score": 0, "creation_date": 1568231483, "post_id": 57894156, "comment_id": 102213163, "body": "@Christof Added details how <code>true</code> is produced when comparing with <code>NaN</code> for you."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1568231544, "last_edit_date": 1592644375, "creation_date": 1568223049, "answer_id": 57894156, "question_id": 57894032, "link": "https://stackoverflow.com/questions/57894032/floating-point-comparison-with-quiet-nan-on-gcc-with-ffast-math-always-yields/57894156#57894156", "title": "Floating point comparison with quiet_NaN on GCC with &quot;-ffast-math&quot; always yields true(!)", "body": "<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">gcc documentation</a> says:</p>\n<blockquote>\n<p><code>-ffast-math</code></p>\n<p>Sets the options <code>-fno-math-errno</code>, <code>-funsafe-math-optimizations</code>, <code>-ffinite-math-only</code>, <code>-fno-rounding-math</code>, <code>-fno-signaling-nans</code>, <code>-fcx-limited-range</code> and <code>-fexcess-precision=fast</code>.</p>\n<p>This option causes the preprocessor macro <code>__FAST_MATH__</code> to be defined.</p>\n<p>This option is not turned on by any <code>-O</code> option besides <code>-Ofast</code> since it can result in <strong>incorrect output for programs that depend on an exact implementation of IEEE or ISO rules/specifications for math functions</strong>. It may, however, yield faster code for programs that do not require the guarantees of these specifications.</p>\n</blockquote>\n<p>In addition, <code>-ffinite-math-only</code> (included in <code>-ffast-math</code>) causes <code>std::isnan</code>, <code>std::isinf</code>, as well as <code>x != x</code>, to always return <code>false</code>, <code>std::isfinite</code> to always return <code>true</code>.</p>\n<hr />\n<p><a href=\"https://www.felixcloutier.com/x86/ucomisd\" rel=\"nofollow noreferrer\">https://www.felixcloutier.com/x86/ucomisd</a></p>\n<blockquote>\n<p>The <code>COMISD</code> instruction differs from the <code>UCOMISD</code> instruction in that it signals a SIMD floating-point invalid operation exception (#I) when a source operand is either a QNaN or SNaN. The <code>UCOMISD</code> instruction signals an invalid numeric exception only if a source operand is an SNaN.</p>\n</blockquote>\n<p><code>-ffinite-math-only</code> causes the compiler to emit <code>COMISD</code> instead of <code>UCOMISD</code> and omit checking the result of the comparison for <code>NaN</code></p>\n<p>The generated code is:</p>\n<pre><code>comiss  xmm2, DWORD PTR [rsp+28]\nsete    sil\n</code></pre>\n<p>Comparing with <code>NaN</code> sets <code>ZF</code>, <code>PF</code>, <code>CF</code> flags, causing <code>sete sil</code> to produce <code>true</code> value when comparing with <code>NaN</code>, but no <code>NaN</code> is expected with <code>-ffinite-math-only</code>, so this is how undefined behaviour manifests itself here.</p>\n<p>When <code>NaN</code> is expected the emitted assembly checks <code>PF</code> flag which is set when at least one operand is <code>NaN</code>:</p>\n<pre><code>ucomiss xmm1, DWORD PTR [rsp+28]\nmov     eax, 0\nsetnp   sil # &lt;---- condition on NaN\ncmovne  esi, eax\n</code></pre>\n<hr />\n<p>With <code>-ffast-math</code> you may like to use these: <a href=\"https://stackoverflow.com/questions/570669/checking-if-a-double-or-float-is-nan-in-c/57770634#57770634\">Checking if a double (or float) is NaN in C++</a></p>\n"}], "owner": {"reputation": 76, "user_id": 6063908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wXrSZ.jpg?s=128&g=1", "display_name": "Spacechild1", "link": "https://stackoverflow.com/users/6063908/spacechild1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 1, "accepted_answer_id": 57894156, "answer_count": 1, "score": 4, "last_activity_date": 1568231544, "creation_date": 1568222529, "last_edit_date": 1568229890, "question_id": 57894032, "link": "https://stackoverflow.com/questions/57894032/floating-point-comparison-with-quiet-nan-on-gcc-with-ffast-math-always-yields", "title": "Floating point comparison with quiet_NaN on GCC with &quot;-ffast-math&quot; always yields true(!)", "body": "<p>Under certain circumstances, comparing a normal floating point number with <code>std::numeric_limits&lt;float&gt;::quiet_NaN()</code> always yields <code>\"true\"</code> when compiled with GCC + <code>\"-ffast-math\"</code> (tested on Linux and MinGW). On other circumstances it always yields <code>\"false\"</code> (which would be the IEEE compliant behavior).</p>\n\n<p>If one of the values is known to be a <code>quiet_NaN</code> at compile time, then the behavior is IEEE compliant and branches get optimized away.</p>\n\n<p>I know that <code>\"-ffast-math\"</code> allows to break IEEE rules and that it implies <code>\"-ffinite-math-only\"</code> which assumes that there are no NaNs. But even with <code>\"-ffast-math\"</code> the result of <code>quiet_NaN()</code> has a specific bit pattern (e.g. 7FF80000), so how can a comparison with a normal float like <code>0.5f</code> possibly yield true?</p>\n\n<p>Here's a code sample showing the different cases. Please compile with <code>\"g++ -O3 -ffast-math\"</code>.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;limits&gt;\n\nint main() {\n#if 1\n    // make sure that the value of 'x' is not known at compile time\n    bool isnan;\n    std::cout &lt;&lt; \"use nan (0|1): \";\n    std::cin &gt;&gt; isnan;\n#else\n    // otherwise GCC correctly applies IEEE rules for NaN and the branch below is optimized away accordingly\n    bool isnan = true;\n#endif\n    float x = isnan ? std::numeric_limits&lt;float&gt;::quiet_NaN() : 0.5f;\n    std::cout &lt;&lt; \"x: \" &lt;&lt; x &lt;&lt; std::endl;\n    float a;\n    std::cout &lt;&lt; \"type a float: \";\n    std::cin &gt;&gt; a;\n#if 1\n    // *always* prints 1 (!)\n    std::cout &lt;&lt; a &lt;&lt; \" equal to \" &lt;&lt; x &lt;&lt; \": \" &lt;&lt; (x == a) &lt;&lt; std::endl;\n#else\n    // always prints false - the opposite from above!\n    std::cout &lt;&lt; a &lt;&lt; \" equal to \" &lt;&lt; x &lt;&lt; \": \" &lt;&lt; ((x == a) ? \"true\" : \"false\") &lt;&lt; std::endl;\n#endif\n    return 0;\n}\n</code></pre>\n\n<p>also, here's a godbolt <a href=\"https://godbolt.org/z/CKXSxB\" rel=\"nofollow noreferrer\">link</a>.\nI guess the relevant part is at line 66 (with <code>\"-ffast-math\"</code>) resp. 67 (without <code>\"-ffast-math\"</code>). Can someone explain to me the difference between those instructions?</p>\n\n<p>Is this behavior of GCC acceptable or should I file a bug report?</p>\n\n<p>EDIT: I want to make clear that I don't need to know whether a particular number is a NaN (I know that this is unspecified with \"-ffast-math\"), I'm only interested whether two numbers are (not) equal. In my actual code, I have a cache of floating point values and I perform update operations only if the input is different than the cached value. I've initialized the cache with quite NaNs, so they won't compare equal to any normal float and the first input is guaranteed to cause an update. This worked fine but as soon as I've added \"-ffast-math\", the check for <code>newval != oldval</code> always returned false, so there would never be an update. I've seen this quiet_NaN pattern in the SuperCollider source code and found it quite elegant.</p>\n"}, {"tags": ["c++", "c++11", "visual-c++", "c++14"], "comments": [{"owner": {"reputation": 1, "user_id": 12049385, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2zzM2MqMsOo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkgvAGksaYXXTSyHpi7l5yVr5wjA/photo.jpg?sz=128", "display_name": "Prerna Agarwal", "link": "https://stackoverflow.com/users/12049385/prerna-agarwal"}, "edited": false, "score": 0, "creation_date": 1568222636, "post_id": 57893981, "comment_id": 102209506, "body": "Have you seen &lt;<a href=\"https://stackoverflow.com/questions/9219712/c-array-expression-must-have-a-constant-value\" title=\"c array expression must have a constant value\">stackoverflow.com/questions/9219712/&hellip;</a>&gt;? This looks like a duplicate question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10957435"}, "edited": false, "score": 0, "creation_date": 1568223103, "post_id": 57893981, "comment_id": 102209696, "body": "Btw:, you don;t set the output of <code>new</code> to your pointer. That&#39;s a bug if that&#39;s in your real code.."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1568222856, "post_id": 57894002, "comment_id": 102209587, "body": "Note that the constant size requirement is only for the inner dimensions. The outer dimension of a dynamic array can be determined at runtime."}, {"owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1568276124, "post_id": 57894002, "comment_id": 102225127, "body": "@eerorika  It always  left-to-right for brackets,right-to left for asterisks and ampersands, outward for parenthesis, in this order of priority."}], "tags": [], "owner": {"reputation": 5009, "user_id": 1455108, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zaRtd.jpg?s=128&g=1", "display_name": "Jo&#227;o Paulo", "link": "https://stackoverflow.com/users/1455108/jo%c3%a3o-paulo"}, "is_accepted": false, "score": 0, "last_activity_date": 1568222772, "last_edit_date": 1568222772, "creation_date": 1568222397, "answer_id": 57894002, "question_id": 57893981, "link": "https://stackoverflow.com/questions/57893981/using-new-command-to-allocate-2d-array-inside-class-constructor-in-c/57894002#57894002", "title": "using &quot;new&quot; command to allocate 2d array inside class constructor in c++", "body": "<p><code>m_size</code> must be a constant expression. Not necessarily const qualified.</p>\n\n<p>You can try make it <code>constexpr</code> (but it implies to be static):</p>\n\n<pre><code>static constexpr int m_size = 2;\n</code></pre>\n\n<p>Or using templates:</p>\n\n<pre><code>template&lt;size_t m_size&gt;\nclass Matrix {\nprivate:\n    int *m_ptr;\npublic:\n    Matrix(){\n        new int[m_size][m_size];//testing this statement\n    }   \n    ~Matrix(){\n        delete[] m_ptr;\n    }\n};\n\nint main() {\n    Matrix&lt;2&gt; m;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 2742717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d1dec1aa6accf3589489ebd42634f7a0?s=128&d=identicon&r=PG", "display_name": "Swift - Friday Pie", "link": "https://stackoverflow.com/users/2742717/swift-friday-pie"}, "is_accepted": false, "score": 0, "last_activity_date": 1568275559, "creation_date": 1568275559, "answer_id": 57902338, "question_id": 57893981, "link": "https://stackoverflow.com/questions/57893981/using-new-command-to-allocate-2d-array-inside-class-constructor-in-c/57902338#57902338", "title": "using &quot;new&quot; command to allocate 2d array inside class constructor in c++", "body": "<p>New expressions, as well as declarations, are unfolding to the right, if brackets [] are found, and no parenthesis to change the order, and outward, if there are parenthesis.</p>\n\n<pre><code> new int[A][B];\n</code></pre>\n\n<p>This means to allocate <code>A</code> elements of type <code>int[B]</code>. <code>A</code> can be variable, <code>B</code> cannot, it's part of type definition. The problem of allocating 2D array by single new expression is generally unsolvable by syntax means.</p>\n\n<p>A multidimensional array isn't defined per se as a kind of type. We have objects and arrays of objects. 2D array is array of objects which are arrays. As you cannot allocate an array of objects of dynamical type, only static one, you cannot do what you intend. Instead you need a class-wrapper which would treat a simple array as a two-dimensional one  by redefined <code>operator[]</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12054333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7018b394296b46ca8bda37468ece2bf?s=128&d=identicon&r=PG&f=1", "display_name": "TBourne", "link": "https://stackoverflow.com/users/12054333/tbourne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568275559, "creation_date": 1568222285, "question_id": 57893981, "link": "https://stackoverflow.com/questions/57893981/using-new-command-to-allocate-2d-array-inside-class-constructor-in-c", "title": "using &quot;new&quot; command to allocate 2d array inside class constructor in c++", "body": "<p>I'm trying to write a matrix class of my own using c++. I want to allocate heap memory for this purpose using new operator. Following is class snippet and this throws error: </p>\n\n<pre><code>  class Matrix\n    {\n        private:\n            int *m_ptr;\n            const int m_size;\n        public:\n            Matrix():m_size(2)\n            {\n                new int[m_size][m_size];//testing this statement\n            }   \n\n            ~Matrix()\n            {\n                delete[] m_ptr;\n            }\n    };\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>main.cc: In constructor \u2018Matrix::Matrix()\u2019:\nmain.cc:11:26: error: array size in new-expression must be constant\n    new int[m_size][m_size];//testing this statement\n                          ^\nmain.cc:11:26: error: \u2018this\u2019 is not a constant expression\n</code></pre>\n"}, {"tags": ["c++", "arrays", "for-loop", "sizeof"], "comments": [{"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 3, "creation_date": 1568222019, "post_id": 57893906, "comment_id": 102209226, "body": "Do you know what <code>sizeof(stArr)</code> returns?  If not, check it out."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1568222065, "post_id": 57893906, "comment_id": 102209251, "body": "This is why when doing C++ you should use <code>std::vector</code> or <code>std::array</code> and a proper enumerator. C-style <code>for</code> loops are fraught with peril."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 12054345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9903cd40b40c10e6169a82ac503958a1?s=128&d=identicon&r=PG&f=1", "display_name": "splashrt", "link": "https://stackoverflow.com/users/12054345/splashrt"}, "edited": false, "score": 0, "creation_date": 1568222566, "post_id": 57893959, "comment_id": 102209482, "body": "Thanks, it worked! I don&#39;t fully understand though: does sizeof(string) take the individual size of every string, or how exactly does it work? Because I didn&#39;t have to specify which string to take in consideration."}, {"owner": {"reputation": 3429, "user_id": 5899161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7974a2c4fbb2bc7a521323ecfaa207a?s=128&d=identicon&r=PG&f=1", "display_name": "lukeg", "link": "https://stackoverflow.com/users/5899161/lukeg"}, "reply_to_user": {"reputation": 81, "user_id": 12054345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9903cd40b40c10e6169a82ac503958a1?s=128&d=identicon&r=PG&f=1", "display_name": "splashrt", "link": "https://stackoverflow.com/users/12054345/splashrt"}, "edited": false, "score": 1, "creation_date": 1568222955, "post_id": 57893959, "comment_id": 102209630, "body": "@splashrt Check what is the result of <code>sizeof(stArr[0])</code>, <code>sizeof(stArr[1])</code>, etc (that is - what <code>sizeof</code> returns for consecutive strings in your array) . Do those really differ? Compare it with the results of <code>stArr[0].length()</code>, <code>stArr[1].length()</code>, etc. In general you may think of <code>sizeof(string)</code> as a size (in bytes) of the thing that stores the information about the string, not the string itself."}], "tags": [], "owner": {"reputation": 3429, "user_id": 5899161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7974a2c4fbb2bc7a521323ecfaa207a?s=128&d=identicon&r=PG&f=1", "display_name": "lukeg", "link": "https://stackoverflow.com/users/5899161/lukeg"}, "is_accepted": false, "score": 0, "last_activity_date": 1568222189, "creation_date": 1568222189, "answer_id": 57893959, "question_id": 57893906, "link": "https://stackoverflow.com/questions/57893906/printing-string-array-with-for-loop-doesnt-function-properly-c/57893959#57893959", "title": "Printing string array with for-loop doesn&#39;t function properly (C++)", "body": "<p>Check, what is the value of <code>sizeof(strArray</code>). I bet you assumed it is 7 (i.e. the number of strings in the array).</p>\n\n<p>Spoiler: well, it is most ceratinly not. <code>sizeof(strArray)</code> returns the amount of memeory occupied by the whole  array, that is 7 strings. It is a number larger than 7, thus during the iteration you read the memory outside of array bounds.</p>\n\n<p>Divide it by the size of one element (e.g <code>sizeof(strArray)/sizeof(string)</code>) to get the size you are expceting.</p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1568222803, "last_edit_date": 1568222803, "creation_date": 1568222281, "answer_id": 57893980, "question_id": 57893906, "link": "https://stackoverflow.com/questions/57893906/printing-string-array-with-for-loop-doesnt-function-properly-c/57893980#57893980", "title": "Printing string array with for-loop doesn&#39;t function properly (C++)", "body": "<p>This condition in the for loop</p>\n\n<pre><code>i &lt; sizeof(stArr)\n</code></pre>\n\n<p>does not make sense. It does not provide the number of elements in the array.</p>\n\n<p>At least you have to write</p>\n\n<pre><code>i &lt; sizeof(stArr) / sizeof( *stArr )\n</code></pre>\n\n<p>For example if you have an array with <code>N</code> elements of type <code>T</code> then the size of the array is calculated using this formula</p>\n\n<pre><code>sizeof( array ) = N * sizeof( T )\n</code></pre>\n\n<p>So to get the number of elements in an array knowing its size and the size of its elements you can write</p>\n\n<pre><code>N = sizeof( array ) / sizeof( T )\n</code></pre>\n\n<p>But it is much simpler to use the range-based for loop.</p>\n\n<pre><code>for ( const auto &amp;s : stArr ) std::cout &lt;&lt; s;\n</code></pre>\n\n<p>If your compiler supports C++ 17 then you could use the standard generic function <code>std::size</code> declared in the header <code>&lt;iterator&gt;</code>. For example</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n\nusing namespace std;\n\nint main() {\n\n    string stArr[] = {\" 1 | \",\"_\",\" | \",\"_\",\" | \",\"_\",\" | \"};\n    for ( size_t i = 0; i &lt; size( stArr ); i++) {\n           cout &lt;&lt; stArr[i];\n    }\n}\n</code></pre>\n\n<p>Otherwise you can use the structure <code>std::extent</code> defined in the header <code>&lt;type_traits&gt;</code> the following way</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\nusing namespace std;\n\nint main() {\n\n    string stArr[] = {\" 1 | \",\"_\",\" | \",\"_\",\" | \",\"_\",\" | \"};\n    for ( size_t i = 0; i &lt; extent&lt;decltype( stArr )&gt;::value; i++) {\n           cout &lt;&lt; stArr[i];\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1568223486, "last_edit_date": 1568223486, "creation_date": 1568222490, "answer_id": 57894023, "question_id": 57893906, "link": "https://stackoverflow.com/questions/57893906/printing-string-array-with-for-loop-doesnt-function-properly-c/57894023#57894023", "title": "Printing string array with for-loop doesn&#39;t function properly (C++)", "body": "<p><code>sizeof(stArr)</code> gives you the <em>total byte size</em> of the whole array.  It does not give you the <em>element count</em>, which is what you are looking for.  As such, your loop is exceeding the bounds of the array, which is why you get garbage in your output.</p>\n\n<p>To get the array's element count, you need to divide the array's byte size by the size of a single element in the array, eg:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main() {\n\n    std::string stArr[] = {\" 1 | \",\"_\",\" | \",\"_\",\" | \",\"_\",\" | \"};\n    int count = sizeof(stArr) / sizeof(stArr[0]);\n\n    for(int i = 0; i &lt; count; ++i) {\n        std::cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>That being said, if you are using a C++17 or later compiler, you can use <a href=\"https://en.cppreference.com/w/cpp/iterator/size\" rel=\"nofollow noreferrer\"><code>std::size()</code></a> to get the element count of a static array:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n\nint main() {\n\n    std::string stArr[] = {\" 1 | \",\"_\",\" | \",\"_\",\" | \",\"_\",\" | \"};\n    size_t count = std::size(stArr);\n\n    for(int i = 0; i &lt; count; ++i) {\n        std::cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Or, if you are using a C++11 compiler, you can use <a href=\"https://en.cppreference.com/w/cpp/types/extent\" rel=\"nofollow noreferrer\"><code>std::extent</code></a> instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\nint main() {\n\n    std::string stArr[] = {\" 1 | \",\"_\",\" | \",\"_\",\" | \",\"_\",\" | \"};\n    size_t count = std::extent&lt;decltype(stArr)&gt;::value;\n\n    for(int i = 0; i &lt; count; ++i) {\n        std::cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>That said, if you are using a C++11 or later compiler, consider using <a href=\"https://en.cppreference.com/w/cpp/container/array\" rel=\"nofollow noreferrer\"><code>std::array</code></a> instead:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;array&gt;\n\nint main() {\n\n    std::array&lt;std::string, 7&gt; stArr = {\" 1 | \", \"_\", \" | \", \"_\", \" | \", \"_\", \" | \"};\n    // or: in C++17 and later:\n    // std::array stArr{\" 1 | \", \"_\", \" | \", \"_\", \" | \", \"_\", \" | \"};\n\n    std::size_t count = stArr.size();\n\n    for(size_t i = 0; i &lt; count; ++i) {\n        std::cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Or, you can alternatively use a <a href=\"https://en.cppreference.com/w/cpp/language/range-for\" rel=\"nofollow noreferrer\">ranged-based <code>for</code> loop</a>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nint main() {\n\n    std::string stArr[] = {\" 1 | \", \"_\", \" | \", \"_\", \" | \", \"_\", \" | \"};\n    // or std::array...\n\n    for(auto &amp;s : stArr) {\n        std::cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Otherwise, consider using <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a> if you are not using a C++11 or later compiler:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n\nint main() {\n\n    std::vector&lt;std::string&gt; stArr;\n    stArr.push_back(\" 1 | \");\n    stArr.push_back(\"_\");\n    stArr.push_back(\" | \");\n    stArr.push_back(\"_\");\n    stArr.push_back(\" | \");\n    stArr.push_back(\"_\");\n    stArr.push_back(\" | \");\n\n    std::size_t count = stArr.size();\n\n    for(size_t i = 0; i &lt; count; ++i) {\n        std::cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 12054345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9903cd40b40c10e6169a82ac503958a1?s=128&d=identicon&r=PG&f=1", "display_name": "splashrt", "link": "https://stackoverflow.com/users/12054345/splashrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 57893980, "answer_count": 3, "score": 1, "last_activity_date": 1568223486, "creation_date": 1568221920, "last_edit_date": 1568222871, "question_id": 57893906, "link": "https://stackoverflow.com/questions/57893906/printing-string-array-with-for-loop-doesnt-function-properly-c", "title": "Printing string array with for-loop doesn&#39;t function properly (C++)", "body": "<p>I'm a newcomer to C++ and was just trying to play around with several things, in this case specifically arrays. I wanted to print a string array to the console, but it either prints random things in binary, tells me I've got a segmentation fault or just does nothing.</p>\n\n<p>The initial program was a bit more complex, but I tried to minimize the additional things as much as possible so I could see what the problem is, but with no success.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nint main() {\n\n    string stArr[] = {\" 1 | \",\"_\",\" | \",\"_\",\" | \",\"_\",\" | \"};\n    for(int i = 0; i &lt; sizeof(stArr); i++) {\n           cout &lt;&lt; stArr[i];\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Now, the expected output was, obviously, the array. But what I usually get is something like: UH\ufffd\ufffdAWAVAUATSH\ufffd\ufffd(L\ufffd%\ufffd!I\ufffd\ufffd\ufffd#\ufffdE\ufffdK\ufffd\ufffdH\ufffd\ufffdv!H\ufffd\ufffdH\ufffd\ufffd%H\ufffd=\ufffd!\ufffd{\ufffd!I\ufffd\ufffdH\ufffd\ufffd\ufffdI\ufffd\ufffd\ufffd\ufffd\ufffdH\ufffd=_!\ufffdQ\ufffd!\ufffd\ufffd\ufffdt\ufffdH\ufffdD\ufffd\ufffdA\ufffd\ufffdD\ufffd\ufffd\ufffd\ufffd;u\ufffd\ufffdu\ufffdu\ufffd\ufffd\ufffdH\ufffde\ufffdE1\ufffdH\ufffd [etc.]</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c++", "loops", "for-loop"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1568221396, "post_id": 57893753, "comment_id": 102208973, "body": "Really and brutally hard to do in the general case. It&#39;s easier by far to not put the comma there in the first place. There&#39;s going to be a duplicate question for this."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568221473, "post_id": 57893753, "comment_id": 102209009, "body": "Semi-duplicate: <a href=\"https://stackoverflow.com/questions/3745861/how-to-remove-last-character-put-to-stdcout\" title=\"how to remove last character put to stdcout\">stackoverflow.com/questions/3745861/&hellip;</a> (semi because backspace doesn&#39;t always work)"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1568221704, "post_id": 57893753, "comment_id": 102209107, "body": "Whole raft of ways to prevent writing the last delimiter: <a href=\"https://stackoverflow.com/questions/3496982/printing-lists-with-commas-c\">Printing lists with commas C++</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1568221466, "creation_date": 1568221466, "answer_id": 57893811, "question_id": 57893753, "link": "https://stackoverflow.com/questions/57893753/remove-trailing-comma-in-c/57893811#57893811", "title": "Remove trailing comma in C++", "body": "<p>E.g. like this:</p>\n\n<pre><code>for (i = 0; i &lt; numEntries; i++) {\n    cout &lt;&lt; myArray[i];\n    if (i &lt; numEntries - 1) cout &lt;&lt; \",\";\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1568221515, "creation_date": 1568221515, "answer_id": 57893824, "question_id": 57893753, "link": "https://stackoverflow.com/questions/57893753/remove-trailing-comma-in-c/57893824#57893824", "title": "Remove trailing comma in C++", "body": "<p>For starters this loop</p>\n\n<pre><code>for ( k = numEntries - 1; k &gt;= i; k--)\n                          ^^^^^^\n    myArray[k] = myArray[k - 1];\n</code></pre>\n\n<p>is incorrect. It is evident (due to this statement <code>myArray[i] = newValue;</code>) that you mean</p>\n\n<pre><code>for ( k = numEntries - 1; k &gt; i; k--)\n                          ^^^^^\n    myArray[k] = myArray[k - 1];\n</code></pre>\n\n<p>As for your question then the second loop can look like</p>\n\n<pre><code>for (i = 0; i &lt; numEntries; i++) {\n    if ( i != 0 ) cout &lt;&lt; \",\";\n    cout &lt;&lt; myArray[i];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3284, "user_id": 1487069, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jsf93.png?s=128&g=1", "display_name": "Carlo Wood", "link": "https://stackoverflow.com/users/1487069/carlo-wood"}, "is_accepted": false, "score": 0, "last_activity_date": 1612955706, "creation_date": 1612955706, "answer_id": 66135799, "question_id": 57893753, "link": "https://stackoverflow.com/questions/57893753/remove-trailing-comma-in-c/66135799#66135799", "title": "Remove trailing comma in C++", "body": "<p>This is what I always use (invented as answer to a challenge question):</p>\n<pre><code>char const* prefix = &quot;&quot;;\nfor (auto&amp; element : myArray) {\n    std::cout &lt;&lt; prefix &lt;&lt; element;\n    prefix = &quot;, &quot;;\n}\n</code></pre>\n<p>which is maximal compact without introducing a branch / conditional in the loop.</p>\n"}], "owner": {"reputation": 11, "user_id": 12054300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d57a3766dd8ec69324429629080e43c?s=128&d=identicon&r=PG&f=1", "display_name": "Fandy Tam", "link": "https://stackoverflow.com/users/12054300/fandy-tam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1612955706, "creation_date": 1568221150, "last_edit_date": 1568221688, "question_id": 57893753, "link": "https://stackoverflow.com/questions/57893753/remove-trailing-comma-in-c", "title": "Remove trailing comma in C++", "body": "<p>How can I remove a trailing comma from the end of the line, output from an array?</p>\n\n<pre><code>for ( k = numEntries - 1; k &gt;= i; k--)\n    myArray[k] = myArray[k - 1];\nmyArray[i] = newValue;\n\nfor (i = 0; i &lt; numEntries; i++) {\n    cout &lt;&lt; myArray[i];\n    cout &lt;&lt; \",\";\n}\n</code></pre>\n"}, {"tags": ["c++", "ros2"], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 814836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc8b66545116a363b6311ea673643e7?s=128&d=identicon&r=PG", "display_name": "EmersonKnapp", "link": "https://stackoverflow.com/users/814836/emersonknapp"}, "is_accepted": true, "score": 1, "last_activity_date": 1570227729, "creation_date": 1570227729, "answer_id": 58243735, "question_id": 57893546, "link": "https://stackoverflow.com/questions/57893546/ros-communication-not-responding-after-including-callbackgroups/58243735#58243735", "title": "ROS communication not responding after including CallbackGroups", "body": "<p>You've got the correct idea for how to use CallbackGroups.</p>\n\n<p>The reason your posted example is not working: In your ControllerNode constructor you declare a local variable <code>rclcpp::callback_group::CallbackGroup::SharedPtr cbg</code></p>\n\n<p>When the constructor returns, the reference count for the pointer goes to 0 and the <code>CallbackGroup</code> is destroyed. You need to hold on to a reference to the CallbackGroup, and your example should work.</p>\n\n<p>e.g.</p>\n\n<pre><code>class ControllerNode : public rclcpp::Node {\npublic:\n  ControllerNode() : rclcpp::Node(\"controller_node\") {\n    cbg_ = create_callback_group(rclcpp::callback_group::CallbackGroupType::Reentrant);\n    update_timer_ = create_wall_timer(\n      100ms, std::bind(&amp;ControllerNode::update, this), cbg_);\n  }\n\nprivate:\n  rclcpp::TimerBase::SharedPtr update_timer_;\n  rclcpp::callback_group::CallbackGroup::SharedPtr cbg_;\n  void update() {\n    std::cout &lt;&lt; \"Timer: \" &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl;\n  }\n};\n</code></pre>\n"}], "owner": {"reputation": 1805, "user_id": 9227188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f3b072f5dc7b5e7640966b13f6e803?s=128&d=identicon&r=PG&f=1", "display_name": "LeoE", "link": "https://stackoverflow.com/users/9227188/leoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 58243735, "answer_count": 1, "score": 1, "last_activity_date": 1570227729, "creation_date": 1568220221, "question_id": 57893546, "link": "https://stackoverflow.com/questions/57893546/ros-communication-not-responding-after-including-callbackgroups", "title": "ROS communication not responding after including CallbackGroups", "body": "<p>I have a question regarding the CallbackGroups of rclcpp in ROS2. I'm trying to have an update cycle run by a rclcpp::TimerBase run on a specified update rate and at the same time the node should listen to an incoming message on a subscription. The way to do it, as I have understood it, is to use a MultiThreadExceutor with CallbackGroups. I therfore created a Reentrant Type CallbackGroup to which I added both the timer and the subscription. As soon as I add the timer to the CallbackGroup the timer stops working, however. Maybe I forgot something? Does the CallbackGroups or Node need to be in a specified Context maybe? Or did I misunderstand the concept of CallbackGroups altogether? Would be happy about any help from you!</p>\n\n<p>What I tried so far: SingleThreadExecutor shows the same problem, Removing the CallbackGroup shows the expected behavior, timer is running and update() is called. Tried to isolate the problem and found out, that it is during the run(...) method of the MTE, in the get_next_executable(:::) of the parent class (rclcpp::executor::Executor) in the wait_for_work(...) function of the Executor in line 447-448:</p>\n\n<pre><code>    rcl_ret_t status = rcl_wait(&amp;wait_set_, std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(timeout).count());\n</code></pre>\n\n<p>and if I give out</p>\n\n<pre><code>    memory_strategy_-&gt;number_of_ready_timers()\n</code></pre>\n\n<p>in the MultiThreadedExecutor it shows me 1, so the timer seems to be registered, right?</p>\n\n<p>Header file: controller_node_test/controller_node_test.h:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#ifndef CONTROLLER_NODE_H\n#define CONTROLLER_NODE_H\n\n#include \"rclcpp/rclcpp.hpp\"\n#include \"controller_node_test/multi_threaded_executor.hpp\"\n#include \"chrono\"\n#include &lt;ctime&gt;\n\nusing std::placeholders::_1;\n\nnamespace controller_node\n{\n    class ControllerNode : public rclcpp::Node {\n        public:\n        ControllerNode();\n        ~ControllerNode();\n\n        private:\n\n        rclcpp::TimerBase::SharedPtr update_timer_;\n\n        void update();\n\n    };\n} // namespace controller_node\n</code></pre>\n\n<p>Source file: controller_node_test.cpp</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"controller_node_test/controller_node_test.h\"\n\nnamespace controller_node\n{\n\n    ControllerNode::ControllerNode() : rclcpp::Node(\"controller_node\"){\n        rclcpp::callback_group::CallbackGroup::SharedPtr update_group = this-&gt;create_callback_group(rclcpp::callback_group::CallbackGroupType::Reentrant);\n        update_timer_ = this-&gt;create_wall_timer(\n                                                                    std::chrono::milliseconds(100),\n                                                                    std::bind(&amp;ControllerNode::update, this),\n                                                                    update_group);\n    }\n\n    ControllerNode::~ControllerNode(){\n\n    }\n\n    void ControllerNode::update(){\n        std::cout &lt;&lt; \"Timer: \" &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl;\n    }\n} // namespace controller_node\n\nint main(int argc, char * argv[])\n{\n    rclcpp::init(argc, argv);\n    rclcpp::executors::MultiThreadedExecutor exec;\n    auto controller_node = std::make_shared&lt;controller_node::ControllerNode&gt;();\n    exec.add_node(controller_node);\n    exec.spin();\n    rclcpp::shutdown();\n    return 0;\n}\n</code></pre>\n\n<p>The problem is, that</p>\n\n<pre><code>    std::cout &lt;&lt; \"Timer: \" &lt;&lt; std::this_thread::get_id() &lt;&lt; std::endl;\n</code></pre>\n\n<p>never gets called, so the timer is not working, at all.</p>\n\n<p>I deleted all not necessary parts of the Code to make it more clear for you, so if it doesn't compile let me know. Would really appreciate any help! I just don't understand what exactly is happening there and now I need your help... Thanks!</p>\n"}, {"tags": ["c++", "arrays", "class", "object", "pointers"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568219940, "post_id": 57893456, "comment_id": 102208328, "body": "This code      cin&gt;&gt;num;     int data[num]; is not a standard C++ code And the program has undefined behavior because there is used pointer with an invalid value."}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1568220157, "post_id": 57893456, "comment_id": 102208439, "body": "Using <code>data</code> outside of <code>get() </code> triggers undefined behavior"}, {"owner": {"reputation": 13, "user_id": 12054167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBpg1lwIJ9M0WtT65SUoX8dNiWSmI1NsuGfHH6Ixg=k-s128", "display_name": "Abhinav Dhamaniya", "link": "https://stackoverflow.com/users/12054167/abhinav-dhamaniya"}, "edited": false, "score": 0, "creation_date": 1568220227, "post_id": 57893456, "comment_id": 102208468, "body": "Then how should i proceed?"}, {"owner": {"reputation": 1404, "user_id": 5982406, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/C6TpX.jpg?s=128&g=1", "display_name": "Syed Ahmed Jamil", "link": "https://stackoverflow.com/users/5982406/syed-ahmed-jamil"}, "edited": false, "score": 0, "creation_date": 1568222056, "post_id": 57893456, "comment_id": 102209247, "body": "The problem is that you are creating your array <code>data[num]</code> inside <code>get()</code> as a local variable and it will get destroyed once the <code>get()</code> function ends. So at the end <code>ele</code>is pointing to a memory location that is not claimed by any variable anymore and might have been replaced with garbage values. Thus you have dangling pointer now. Use the <code>new</code> keyword while creating new memory allocations."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1568220380, "creation_date": 1568220380, "answer_id": 57893584, "question_id": 57893456, "link": "https://stackoverflow.com/questions/57893456/garbage-values-are-printed-when-i-try-to-print-the-elements-of-an-array-using-po/57893584#57893584", "title": "Garbage values are printed when I try to print the elements of an array using pointer", "body": "<p>The line</p>\n\n<pre><code>ele=data;\n</code></pre>\n\n<p>is the source of your problems.</p>\n\n<p><code>data</code> is a local array, a non-standard VLA, but it is still a local array. When the function returns <code>data</code> is destructed and <code>ele</code> points to an object that is no longer valid. Accessing <code>ele</code> after the function returns is cause for undefined behavior. The garbage values you are seeing is just one symptom of undefined behavior.</p>\n\n<p>You can change that function to use:</p>\n\n<pre><code>void mvector::get()\n{\n    cin&gt;&gt;num;\n    ele = new int[num];\n    for(int i=0; i&lt;num; i++)\n    {\n        cin&gt;&gt;ele[i];\n    }\n}\n</code></pre>\n\n<p>That will solve your immediate problem. However, there are other issues you have to contend with when managing memory yourself. See <a href=\"http://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">http://stackoverflow.com/questions/4172722/what-is-the-rule-of-three</a> for additional details.</p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1568221262, "last_edit_date": 1568221262, "creation_date": 1568220954, "answer_id": 57893717, "question_id": 57893456, "link": "https://stackoverflow.com/questions/57893456/garbage-values-are-printed-when-i-try-to-print-the-elements-of-an-array-using-po/57893717#57893717", "title": "Garbage values are printed when I try to print the elements of an array using pointer", "body": "<p>The program does not make a great sense.</p>\n\n<p>For example the variable length arrays is not standard C++ feature. So the declaration of the array</p>\n\n<pre><code>cin&gt;&gt;num;\nint data[num];\n</code></pre>\n\n<p>is not correct.</p>\n\n<p>Within the function <code>get</code> the  data member <code>ele</code> is assigned with the address of the first element of a local array that will not be alive after exiting the member function. So using this pointer in the member function <code>print</code> invokes undefined behavior.</p>\n\n<p>You have to define the array dynamically.</p>\n\n<p>Moreover within the function <code>print</code> the pointer <code>ele</code> is incremented and loses its initial value. It means that you could call the function the second time</p>\n\n<p>You should define a class with constructors and destructor.</p>\n\n<p>More or less working code can look the following way.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass mvector\n{\n    private:\n        size_t num = 0;\n        int *ele = nullptr;\n    public:\n        void get();\n        void print() const;\n};\n\nvoid mvector::get()\n{\n    size_t n;\n    std::cin &gt;&gt; n;\n\n    if ( n != num )\n    {\n        delete [] ele;\n        ele = nullptr;\n\n        if ( n != 0 )\n        {\n            ele = new int[n];\n        }\n\n        num = n;\n    }\n\n    if ( num != 0 )\n    {\n        for ( size_t i = 0; i &lt; num; i++)\n        {\n            std::cin &gt;&gt; ele[i];\n        }\n    }\n}\n\nvoid mvector::print() const\n{\n    int *p = ele;\n\n    for ( size_t i = 0; i &lt; num; i++ )\n    {\n        std::cout &lt;&lt; *p &lt;&lt; ' ';\n        ++p;\n    }\n\n    std::cout &lt;&lt; '\\n';\n}\n\nint main()\n{\n    mvector v1;\n\n    v1.get();\n    v1.print();\n\n    v1.get();\n}\n</code></pre>\n\n<p>For the input like this</p>\n\n<pre><code>5 \n1 2 3 4 5 \n0\n</code></pre>\n\n<p>The output will be</p>\n\n<pre><code>1 2 3 4 5 \n</code></pre>\n\n<p>and the allocated memory will be freed.</p>\n"}], "owner": {"reputation": 13, "user_id": 12054167, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBpg1lwIJ9M0WtT65SUoX8dNiWSmI1NsuGfHH6Ixg=k-s128", "display_name": "Abhinav Dhamaniya", "link": "https://stackoverflow.com/users/12054167/abhinav-dhamaniya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 57893584, "answer_count": 2, "score": 0, "last_activity_date": 1568221262, "creation_date": 1568219809, "question_id": 57893456, "link": "https://stackoverflow.com/questions/57893456/garbage-values-are-printed-when-i-try-to-print-the-elements-of-an-array-using-po", "title": "Garbage values are printed when I try to print the elements of an array using pointer", "body": "<p>I have a class named mvector which has two private variables, num (denotes number of elements in the array), and an integer pointer to store the array address. \nmvector has 2 public functions, get() and print() to get the elements of the array, and print them (respectively).\nHowever, when I try to print the values, some values are correct, while others are garbage values. </p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\nclass mvector\n{\n    private:\n        int num;\n        int *ele;\n    public:\n        void get();\n        void print();\n};\n\nvoid mvector::get()\n{\n    cin&gt;&gt;num;\n    int data[num];\n    for(int i=0; i&lt;num; i++)\n    {\n        cin&gt;&gt;data[i];\n    }\n\n    ele=data;\n}\n\nvoid mvector::print()\n{\n    for(int i=0; i&lt;num; i++)\n    {\n        cout&lt;&lt;*ele&lt;&lt;endl;\n        ele++;\n    }\n}\n\nint main()\n{\n    mvector v1;\n    v1.get();\n    v1.print();\n\n}\n\n\nInput: 5 1 2 3 4 5\nExpected Output: 1 2 3 4 5\nActual Output: 1 1 1877615960 4 5\n</code></pre>\n"}, {"tags": ["c++", "templates", "c++17", "template-meta-programming"], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 1627996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4RKS6.png?s=128&g=1", "display_name": "the_summer", "link": "https://stackoverflow.com/users/1627996/the-summer"}, "edited": false, "score": 0, "creation_date": 1568230094, "post_id": 57893489, "comment_id": 102212649, "body": "Thank you very much. I thought I went crazy. I checked with wandbox with the newest version before posting, but selected gcc again."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 405, "user_id": 1627996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4RKS6.png?s=128&g=1", "display_name": "the_summer", "link": "https://stackoverflow.com/users/1627996/the-summer"}, "edited": false, "score": 0, "creation_date": 1568230757, "post_id": 57893489, "comment_id": 102212903, "body": "@the_summer Yeah, do what we did before this feature - have a linear inheritance chain and bring each one in one-at-a-time."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 2, "last_activity_date": 1568219930, "creation_date": 1568219930, "answer_id": 57893489, "question_id": 57893383, "link": "https://stackoverflow.com/questions/57893383/problem-with-expanding-using-declaration-with-c17/57893489#57893489", "title": "Problem with expanding using-declaration with C++17", "body": "<p>This is <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=79094\" rel=\"nofollow noreferrer\">gcc bug 79094</a>. The program is well-formed, clang and icc accept it. </p>\n\n<p>msvc accepts the simple version in the gcc bug report, but rejects this slightly more complex one (which is more similar to your example):</p>\n\n<pre><code>template &lt;typename&gt;\nclass U { };\n\ntemplate &lt;class... Args&gt;\nstruct X : U&lt;Args&gt;... \n{\n    using U&lt;Args&gt;::U...;\n}; \n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 1627996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4RKS6.png?s=128&g=1", "display_name": "the_summer", "link": "https://stackoverflow.com/users/1627996/the-summer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57893489, "answer_count": 1, "score": 0, "last_activity_date": 1568219935, "creation_date": 1568219496, "last_edit_date": 1568219935, "question_id": 57893383, "link": "https://stackoverflow.com/questions/57893383/problem-with-expanding-using-declaration-with-c17", "title": "Problem with expanding using-declaration with C++17", "body": "<p>I tried to get my head some of the new possibilities with pack expansion in C++17 and ran into a problem which I don't understand.\nI created a Derived class which inherits from a set of Base class templates. </p>\n\n<p>Then I tried to import all base classes constructors into the and add a method which accesses a constant of a base class.\nHowever, I get the following error when I try to compile.</p>\n\n<blockquote>\n<pre><code>error: expected primary-expression before '...' token    23 |      \nreturn mValue == Base&lt;M, tuple_element_t&lt;Is, Tuple&gt;...&gt;::value\n</code></pre>\n</blockquote>\n\n<p>Compilation works find if I either comment the import of the base class constructors or comment the method.\nIs there something which prevents me to have both?</p>\n\n<p>Here is a minimal example:</p>\n\n<pre><code>#include &lt;tuple&gt;\n#include &lt;utility&gt;\nusing namespace std;\n\ntemplate &lt;size_t N, typename... Types&gt;\nstruct Base\n{\n    static constexpr size_t value = N;\n};\n\ntemplate &lt;typename Tuple, typename Indices&gt;\nstruct Derived;\n\ntemplate &lt;typename Tuple, size_t... Is&gt;\nstruct Derived&lt;Tuple, index_sequence&lt;Is...&gt;&gt; : public Base&lt;Is, std::tuple_element_t&lt;Is,Tuple&gt;... &gt;...\n{   \n    // Works if following line is commented\n    using Base&lt;Is, tuple_element_t&lt;Is, Tuple&gt;...&gt;::Base...;\n\n    template&lt;size_t M&gt; bool check() const\n    {\n      return mValue == Base&lt;M, tuple_element_t&lt;Is, Tuple&gt;...&gt;::value;\n    }\n\n    size_t mValue;\n};\n\ntemplate &lt;typename... Types&gt;\nstruct Test : public Derived&lt;tuple&lt;Types...&gt;, make_index_sequence&lt;sizeof...(Types)&gt;&gt;\n{};\n\nint main ()\n{\n    using MyType = Test&lt;int, float, float&gt;;\n    MyType test;\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "r", "rcpp"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12054122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43975f9f8eec711297deb435b83a0e2e?s=128&d=identicon&r=PG&f=1", "display_name": "malikjohnson", "link": "https://stackoverflow.com/users/12054122/malikjohnson"}, "edited": false, "score": 0, "creation_date": 1568224816, "post_id": 57893464, "comment_id": 102210374, "body": "what does no_init do here?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "reply_to_user": {"reputation": 13, "user_id": 12054122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43975f9f8eec711297deb435b83a0e2e?s=128&d=identicon&r=PG&f=1", "display_name": "malikjohnson", "link": "https://stackoverflow.com/users/12054122/malikjohnson"}, "edited": false, "score": 0, "creation_date": 1568226735, "post_id": 57893464, "comment_id": 102211169, "body": "@malikjohnson It inhibits initialization of the vector&#39;s elements to zero."}], "tags": [], "owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "is_accepted": true, "score": 1, "last_activity_date": 1568219835, "creation_date": 1568219835, "answer_id": 57893464, "question_id": 57893254, "link": "https://stackoverflow.com/questions/57893254/rcpp-one-function-works-on-numericvector-the-other-needs-to-treat-it-as-scalar/57893464#57893464", "title": "Rcpp: one function works on NumericVector, the other needs to treat it as scalar", "body": "<p>You could factor out the  scalar code into a separate (inline) function and call that from both <code>f</code> (with <code>std::transform</code>) and <code>g</code> (+ additional logic). Simplified example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;Rcpp.h&gt;\n\ninline double f_impl (double x) {\n    return x * 2;\n}\n\n\n// [[Rcpp::export]]\ndouble g (double x) {\n    return f_impl(x) + 2;\n}\n\n// [[Rcpp::export]]\nRcpp::NumericVector f (Rcpp::NumericVector x) {\n    Rcpp::NumericVector y(Rcpp::no_init(x.length()));\n    std::transform(x.begin(), x.end(), y.begin(), f_impl);\n    return y;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12054122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43975f9f8eec711297deb435b83a0e2e?s=128&d=identicon&r=PG&f=1", "display_name": "malikjohnson", "link": "https://stackoverflow.com/users/12054122/malikjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57893464, "answer_count": 1, "score": 1, "last_activity_date": 1568219835, "creation_date": 1568218976, "question_id": 57893254, "link": "https://stackoverflow.com/questions/57893254/rcpp-one-function-works-on-numericvector-the-other-needs-to-treat-it-as-scalar", "title": "Rcpp: one function works on NumericVector, the other needs to treat it as scalar", "body": "<p>I have two functions written with Rcpp.</p>\n\n<p>The first function <code>f</code> takes a NumericVector as input and returns a NumericVector as output. But often, <code>f</code> is meant to be treated as a scalar function. When I call it from R, it doesn't matter, since R will treat any scalar as a vector anyways, so I don't have to bother about it. I can both use <code>f</code> as a scalar or a vector function, e.g. <code>f(1)</code> and <code>f(c(1,2,3,4)</code> both work. </p>\n\n<ol>\n<li>Question 1: Is this a bad idea? Should I make TWO separate functions, one scalar, and one vectorized? For example, is there some unwanted overhead when I call <code>f</code> from R using scalar input rather than a vector? </li>\n</ol>\n\n<p>The second function <code>g</code> needs to use <code>f</code> purely as a scalar function. This causes a problem because I need to call <code>f</code> from Rcpp when I am defining <code>g</code>.... now I can't use it as a scalar function by calling <code>f(x</code>) for some double x. </p>\n\n<p>I tried doing something like this from inside the definition of <code>g</code>:</p>\n\n<pre><code>NumericVector x = NumericVector::create(value); //create vector of length 1\nf(x) //use f(x) as scalar \n</code></pre>\n\n<p>but timing the code took absurdly long (since the function <code>g</code> needs to perform the above operation many times).</p>\n\n<ol>\n<li>Question 2: Is there a way to more quickly treat <code>f</code> as a scalar function just like I would if I was in R? </li>\n</ol>\n\n<p>My current solution is to do what I asked in Queston 1: create another <code>f</code> function which is scalar, and then call THAT one from <code>g</code>, so that inside <code>g</code> we simply say </p>\n\n<pre><code>alternative_f(x) //use alternative f as scalar\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-code", "terminal"], "comments": [{"owner": {"reputation": 1799, "user_id": 1137713, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/iuRcY.jpg?s=128&g=1", "display_name": "iHowell", "link": "https://stackoverflow.com/users/1137713/ihowell"}, "edited": false, "score": 0, "creation_date": 1568219927, "post_id": 57893141, "comment_id": 102208320, "body": "If you know where the executable is created, then you should be able to actually create a terminal and run it there. Is that what you are asking?"}, {"owner": {"reputation": 943, "user_id": 5403217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sLkTl.jpg?s=128&g=1", "display_name": "myx", "link": "https://stackoverflow.com/users/5403217/myx"}, "edited": false, "score": 0, "creation_date": 1568226634, "post_id": 57893141, "comment_id": 102211131, "body": "You can bring up a terminal in vscode and compile/run your code from there. Do you mean you can&#39;t open a terminal right now?"}, {"owner": {"reputation": 11, "user_id": 12054075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b0fda488569a8216ffe0e4dccf2cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Prosis Stha", "link": "https://stackoverflow.com/users/12054075/prosis-stha"}, "edited": false, "score": 0, "creation_date": 1568347271, "post_id": 57893141, "comment_id": 102252526, "body": "I want to show up the output directly on terminal after i run it rather than going to the terminal and opening the file there."}], "answers": [{"tags": [], "owner": {"reputation": 893, "user_id": 6277384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6172ff7a5d08eb58a7bbcc7dd99a08c?s=128&d=identicon&r=PG", "display_name": "yumetodo", "link": "https://stackoverflow.com/users/6277384/yumetodo"}, "is_accepted": false, "score": 0, "last_activity_date": 1568218777, "creation_date": 1568218777, "answer_id": 57893217, "question_id": 57893141, "link": "https://stackoverflow.com/questions/57893141/how-to-run-c-code-inside-terminal-in-visual-studio-code/57893217#57893217", "title": "How to run C++ code inside terminal in Visual Studio Code?", "body": "<p>Have you ever tried using CodeLLDB?</p>\n\n<p><a href=\"https://github.com/vadimcn/vscode-lldb/blob/master/MANUAL.md##stdio\" rel=\"nofollow noreferrer\">https://github.com/vadimcn/vscode-lldb/blob/master/MANUAL.md##stdio</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12054075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b0fda488569a8216ffe0e4dccf2cc3?s=128&d=identicon&r=PG&f=1", "display_name": "Prosis Stha", "link": "https://stackoverflow.com/users/12054075/prosis-stha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568218777, "creation_date": 1568218476, "question_id": 57893141, "link": "https://stackoverflow.com/questions/57893141/how-to-run-c-code-inside-terminal-in-visual-studio-code", "title": "How to run C++ code inside terminal in Visual Studio Code?", "body": "<p>I am unable to input values in output tab and wanted to run code directly inside the terminal.In previous version I was able to do so with the changes in settings.json file which is mentioned below but in the latest version 1.38 I was unable, Help.</p>\n\n<pre><code>[\n {\n \"color-highlight.markerType\": \"dot-before\",\n \"editor.formatOnSave\": true\n \"explorer.confirmDelete\": false\n},\n{\n \"code-runner.runInTerminal\": true\n}\n]\n</code></pre>\n"}, {"tags": ["python", "c++", "numpy", "opencv", "ctypes"], "comments": [{"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568218773, "post_id": 57893014, "comment_id": 102207824, "body": "Please check your compilation command - I believe the <code>pkg-config</code> stuff should be inside modern backticks, i.e. <code>g++ ... $(pkg-config --cflags --libs opencv) ...</code>"}, {"owner": {"reputation": 29, "user_id": 12053908, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhbsVm_yTErN7f8ej6C0Bt2bj0H_wJ193jf6w=k-s128", "display_name": "\u0424\u0430\u043d\u0442\u0430\u0437\u0435\u0440 \u041f\u0435\u0442\u0440\u0443\u0445\u0438\u043d", "link": "https://stackoverflow.com/users/12053908/%d0%a4%d0%b0%d0%bd%d1%82%d0%b0%d0%b7%d0%b5%d1%80-%d0%9f%d0%b5%d1%82%d1%80%d1%83%d1%85%d0%b8%d0%bd"}, "reply_to_user": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568219382, "post_id": 57893014, "comment_id": 102208098, "body": "I tried. don&#39;t work :("}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568219769, "post_id": 57893014, "comment_id": 102208258, "body": "Please run the <code>pkg-config</code> command I suggested on its own. It should spit out a load of include and link info. If so, please correct your question as I suggested. If not, that is probably the problem."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568219874, "post_id": 57893014, "comment_id": 102208297, "body": "If this is a new project, why are you using Python 2.7 which is discontinued in 5 months when Python 3 has been out 10+ years?"}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568221360, "post_id": 57893014, "comment_id": 102208952, "body": "Please run this and add the output into your question <code>pkg-config opencv --cflags --libs</code> Start any line of code with 4 spaces to format it as code."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568221388, "post_id": 57893014, "comment_id": 102208968, "body": "Comments are not a good place for lots of code and output... ;-)"}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568227591, "post_id": 57893014, "comment_id": 102211520, "body": "I have nominated this question for re-opening. It seems quite clear to me that it is a legitimate question, with a pretty good attempt at code, that reasonably asks how to pass an image in a Numpy array from Python to C++ and then process and return the result."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568278673, "post_id": 57893014, "comment_id": 102226445, "body": "Did you try putting some <code>std::cout</code> statements in your C++ code to see if you get the correct height and width at keast without returning anything. Then try zeroing the pixel data as well. Then try returning some data. Just small steps so you can see where it fails."}, {"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1568299576, "post_id": 57893014, "comment_id": 102238300, "body": "I&#39;m not sure I am the right person to help you so I am deleting my answer so that others are more likely to help you. Sorry I couldn&#39;t solve it."}], "answers": [{"tags": [], "owner": {"reputation": 647, "user_id": 11923286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6998eee0e8f86bdd85902f148333df9?s=128&d=identicon&r=PG&f=1", "display_name": "ignacio", "link": "https://stackoverflow.com/users/11923286/ignacio"}, "is_accepted": false, "score": 0, "last_activity_date": 1568218487, "creation_date": 1568218487, "answer_id": 57893147, "question_id": 57893014, "link": "https://stackoverflow.com/questions/57893014/send-image-opencv-c-to-python/57893147#57893147", "title": "send image opencv c++ to python", "body": "<p>you have to compile this c++ code into a shared library, according to <a href=\"https://stackoverflow.com/questions/145270/calling-c-c-from-python\">this</a> and then write a wrapper</p>\n"}], "owner": {"reputation": 29, "user_id": 12053908, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBJhbsVm_yTErN7f8ej6C0Bt2bj0H_wJ193jf6w=k-s128", "display_name": "\u0424\u0430\u043d\u0442\u0430\u0437\u0435\u0440 \u041f\u0435\u0442\u0440\u0443\u0445\u0438\u043d", "link": "https://stackoverflow.com/users/12053908/%d0%a4%d0%b0%d0%bd%d1%82%d0%b0%d0%b7%d0%b5%d1%80-%d0%9f%d0%b5%d1%82%d1%80%d1%83%d1%85%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 958, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568299607, "creation_date": 1568217972, "last_edit_date": 1568294758, "question_id": 57893014, "link": "https://stackoverflow.com/questions/57893014/send-image-opencv-c-to-python", "title": "send image opencv c++ to python", "body": "<p>I open the picture with python, send it to the C ++ function for processing, and return the picture. How to correctly get a picture from a c ++ function?</p>\n\n<h3>Segmentation error</h3>\n\n<p>Code example:</p>\n\n<h1>C++</h1>\n\n<pre><code>// t_lib.cpp \n#include \"opencv2/opencv.hpp\"\n\nextern \"C\" unsigned char*  getfg(int rows,int cols, unsigned char* fdata)\n//extern \"C\" void getfg(int rows,int cols, unsigned char* fdata)\n{\n    cv::Mat frame = cv::Mat(rows, cols, CV_8UC3, (void *) fdata);\n    // Work \n    //cv::imshow(\"Display window C++\", frame);\n    //cv::waitKey(0);\n\n    // do something\n\n    return frame.data; //fdata;\n}\n</code></pre>\n\n<h1>Python 2.7</h1>\n\n<pre><code># test.py\nimport cv2\nimport numpy as np\nimport ctypes\nlib = ctypes.cdll.LoadLibrary('./lib.so')\n\ndef getfg(img):\n    ptr = lib.getfg(img.shape[0], img.shape[1], img.ctypes.data_as(ctypes.POINTER(ctypes.c_ubyte)))\n    buf = (ctypes.c_ubyte * img.shape[0] * img.shape[1]  * 3).from_address(ptr)\n    res = np.ndarray(buffer=buf, dtype=np.uint8, shape=(img.shape[0], img.shape[1], 3), order=\"C\")\n    return res\n\nf = cv2.imread(\"sample.jpg\")\n#gray_image = cv2.cvtColor(f, cv2.COLOR_BGR2GRAY)\nAS = getfg(f)\nprint AS.shape\n#np.array(AS)[0]\ncv2.imshow(\"Window Python\", AS)\ncv2.waitKey(0)\n</code></pre>\n\n<p>Compilation:</p>\n\n<pre><code>g++ -c -fPIC t_lib.cpp -o lib -lX11 $(pkg-config opencv --cflags --libs) -I/usr/include/python2.7 -I/usr/lib/python2.7;\n\ng++ -shared -Wl,-soname,lib.so -o lib.so lib -lopencv_core -lopencv_highgui -lopencv_imgproc\n</code></pre>\n\n<p>command for see opencv libs:</p>\n\n<pre>pkg-config opencv --cflags --libs</pre>\n\n<p>output:</p>\n\n<pre>-I/usr/include/opencv -lopencv_shape -lopencv_stitching \n-lopencv_superres -lopencv_videostab -lopencv_aruco \n-lopencv_bgsegm -lopencv_bioinspired -lopencv_ccalib\n-lopencv_datasets -lopencv_dpm -lopencv_face \n-lopencv_freetype -lopencv_fuzzy -lopencv_hdf \n-lopencv_line_descriptor -lopencv_optflow -lopencv_video \n-lopencv_plot -lopencv_reg -lopencv_saliency -lopencv_stereo \n-lopencv_structured_light -lopencv_phase_unwrapping -lopencv_rgbd \n-lopencv_viz -lopencv_surface_matching -lopencv_text \n-lopencv_ximgproc -lopencv_calib3d -lopencv_features2d \n-lopencv_flann -lopencv_xobjdetect -lopencv_objdetect \n-lopencv_ml -lopencv_xphoto -lopencv_highgui \n-lopencv_videoio -lopencv_imgcodecs -lopencv_photo \n-lopencv_imgproc -lopencv_core\n</pre>\n\n<p><strong>version c++ OpenCV 3.2.0</strong></p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568220298, "post_id": 57893002, "comment_id": 102208500, "body": "The names of the uniforms seems to be correct. You can introspect the program. Use <code>n = glGetProgramiv(program, GL_ACTIVE_UNIFORMS)</code> and <code>for(i=0; i&lt;n; ++i) glGetActiveUniform(program, i, ... )</code> to get all the active uniforms. See <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetActiveUniform.xhtml\" rel=\"nofollow noreferrer\"><code>glGetActiveUniform</code></a> respectively <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetProgram.xhtml\" rel=\"nofollow noreferrer\"><code>glGetProgramiv</code></a>."}, {"owner": {"reputation": 21, "user_id": 11878570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53afc5c1d420160ccce412e390e94d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Logiq", "link": "https://stackoverflow.com/users/11878570/logiq"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568227213, "post_id": 57893002, "comment_id": 102211365, "body": "Yes, sorry I forgot to mention, that&#39;s what my Shader Debug() function does (the first set of outputs in the console log)"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1568228002, "post_id": 57893002, "comment_id": 102211695, "body": "I suppose you call <code>glUseProgram</code> before <code>GetAndStoreUniformLocation</code> right?"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1568229383, "post_id": 57893002, "comment_id": 102212363, "body": "@Ripi2 Is not necessary that the program is the currently installed program, to query the resource index of an active program resource. (it woulfd be necessary if you want to change the value of a uniform by <code>glUnifrom*</code>)."}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568229622, "post_id": 57893002, "comment_id": 102212453, "body": "Are you very sure that you&#39;ve compiled that fragment shader? Do you mistakenly read another file with an earlier state?"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568229808, "post_id": 57893002, "comment_id": 102212531, "body": "@Rabbid76 Yeah. But see <a href=\"https://stackoverflow.com/a/36416867/3871028\">this answer</a>"}, {"owner": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1568229938, "post_id": 57893002, "comment_id": 102212588, "body": "@Ripi2 I see. But that&#39; probably a driver bug and not something what is specified int the standard. By the way I don&#39;t trust in this answer and I never heard about this behavior."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 138010, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1568230357, "post_id": 57893002, "comment_id": 102212752, "body": "@Rabbid76 Agreed. Probably a bug in the driver, whose workaround is to call <code>glUseProgram</code>"}, {"owner": {"reputation": 21, "user_id": 11878570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53afc5c1d420160ccce412e390e94d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Logiq", "link": "https://stackoverflow.com/users/11878570/logiq"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1568250551, "post_id": 57893002, "comment_id": 102217824, "body": "Sorry for the late response, I slept. Yes, @Ripi2 I am calling <code>glUseProgram</code> right after loading the shader and compiling &amp; linking it. And yes, both the fragment and vertex shaders are loaded (vertex first, not that I think that matters), then they&#39;re both compiled, linked to the program and then the individual shader objects are deleted since they&#39;re no longer needed. Currently this is the only shader I have, and there are no other shader source files for it to mistakenly read."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11878570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53afc5c1d420160ccce412e390e94d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Logiq", "link": "https://stackoverflow.com/users/11878570/logiq"}, "is_accepted": false, "score": 0, "last_activity_date": 1568353430, "creation_date": 1568353430, "answer_id": 57917888, "question_id": 57893002, "link": "https://stackoverflow.com/questions/57893002/shader-uniform-either-improperly-optimised-away-or-not-being-found/57917888#57917888", "title": "Shader uniform either improperly optimised away or not being found", "body": "<p>It turns out the problem was that the IDE had removed the batch file which copies the assets (shaders, textures etc) to the build directory, and there was no indication that this had happened, nor any real reason for it to. I've put the file back and now it works. <em>I probably should have actually checked the shader file in the build directory</em> to make sure it was up-to-date, but that didn't come to mind (it definitely should have, if I was smarter), but instead in my confusion and frustration I was looking for a mistake in the code.</p>\n\n<p>Definitely an unexpected result, but I'm glad that this means the code/drivers aren't faulty.</p>\n"}], "owner": {"reputation": 21, "user_id": 11878570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53afc5c1d420160ccce412e390e94d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Logiq", "link": "https://stackoverflow.com/users/11878570/logiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568353430, "creation_date": 1568217932, "last_edit_date": 1568227375, "question_id": 57893002, "link": "https://stackoverflow.com/questions/57893002/shader-uniform-either-improperly-optimised-away-or-not-being-found", "title": "Shader uniform either improperly optimised away or not being found", "body": "<p>I'm finally making the push to learn how to write shaders, and I have a fairly decent grasp of how they work. Problem is, I cannot retrieve the uniform location for a struct uniform. Now I know that you have to query the location of each individual inner member, which I'm doing, and I also know that if GL determines that a uniform doesn't affect the final output, it gets optimised away (which is honestly not a bad thing in the slightest). </p>\n\n<p>The problem is, it's not finding a uniform which IS being used to affect the output of the fragment shader.</p>\n\n<p>In my shader class, I have a function called 'GetAndStoreUniformLocation' (I like to be descriptive with the names - make sure it's clear what the function does)! This function just grabs the location of the given uniform name and shoves it into a map, so I don't have to keep querying OpenGL for the location every frame (I'm not sure how good of an optimisation this may or may not be... it's fairly experimental at this stage). This function works fine for all of the uniforms which are comprised of standard types.</p>\n\n<h3>The question (TL;DR):</h3>\n\n<p><strong>Why can't I retrieve the locations of the 'material' uniform's members from the shader? It shouldn't be being optimised away, and I'm passing \"material.*\"  (where * is the member name) to glGetUniformLocation().</strong></p>\n\n<p>I feel like I'm probably missing something blatantly obvious, but I have searched around on the OpenGL documentation and on other people's posts of similar questions on here and, so far nothing has provided anything useful, only the suggestion of optimisation removing the uniform, but, I doubt that's the case since it is being used in the output.</p>\n\n<p>I have tried directly calling glGetUniformLocation() after loading, compiling and linking the shader, for the matrix uniforms (success) and the material.* uniforms (failure).</p>\n\n<h3>Code</h3>\n\n<p>After loading the shader, I activate it so I can access the uniform locations, and call:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>v_primaryShader.GetAndStoreUniformLocation(\"material.ambient\");\nv_primaryShader.GetAndStoreUniformLocation(\"material.diffuse\");\nv_primaryShader.GetAndStoreUniformLocation(\"material.specular\");\n</code></pre>\n\n<p>Shader::GetAndStoreUniformLocation(const GLchar* uniformName)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void Shader::GetAndStoreUniformLocation(const GLchar* uniformName)\n{\n    GLint location = glGetUniformLocation(this-&gt;v_programID, uniformName);\n    if (location != -1)\n    {\n        v_uniformLocations.insert(std::pair&lt;const GLchar*, GLint&gt;(uniformName, location));\n        Debug::LogDebug(\"Uniform stored for shader '\" + v_name + \"': name: '\" + std::string(uniformName) + \"', location: '\" + std::to_string(location) + \"'\");\n        return;\n    }\n\n    ThrowException(\"Shader&gt;GetAndStoreUniformLocation: Could not find uniform '\" + std::string(uniformName) + \"' in shader '\" + this-&gt;v_name + \"'.\");\n}\n</code></pre>\n\n<p>Shader::Debug(void)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void Shader::Debug(void) const\n{\n    GLint i;\n    GLint count;\n    GLint size;\n    GLenum type;\n    const GLsizei bufSize = 25;\n    GLchar name[bufSize];\n    GLsizei length;\n\n    Debug::LogDebug(\"Debugging shader '\" + this-&gt;v_name + \"':\");\n    glGetProgramiv(this-&gt;v_programID, GL_ACTIVE_ATTRIBUTES, &amp;count);\n    Debug::LogDebug(\"  - Attributes (\" + std::to_string(count) + \" in total; numbers do not correspond to locations!): \");\n    for (i = 0; i &lt; count; i++)\n    {\n        glGetActiveAttrib(this-&gt;v_programID, (GLuint)i, bufSize, &amp;length, &amp;size, &amp;type, name);\n        int location = glGetAttribLocation(this-&gt;v_programID, name);\n        Debug::LogDebug(\"    - Attribute \" + std::to_string(i) + \" = name: '\" + name + \"', location: \" + std::to_string(location) + \", type: \" + TypeToString(type));\n    }\n    glGetProgramiv(this-&gt;v_programID, GL_ACTIVE_UNIFORMS, &amp;count);\n    Debug::LogDebug(\"  - Uniforms (\" + std::to_string(count) + \" in total; numbers do not correspond to locations!): \");\n    for (i = 0; i &lt; count; i++)\n    {\n        glGetActiveUniform(this-&gt;v_programID, (GLuint)i, bufSize, &amp;length, &amp;size, &amp;type, name);\n        int location = glGetUniformLocation(this-&gt;v_programID, name);\n        Debug::LogDebug(\"    - Uniform \" + std::to_string(i) + \" = name: '\" + name + \"', location: \" + std::to_string(location) + \", type: \" + TypeToString(type));\n    }\n}\n</code></pre>\n\n<p>Fragment shader (GLSL):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#version 440\n\nstruct Material\n{\n    vec3 ambient;\n    vec3 diffuse;\n    vec3 specular;\n//sampler2D diffuse_texture;\n//sampler2D specular_texture;\n};\n\nin vec3 pass_position;\nin vec3 pass_normal;\nin vec2 pass_uv;\n\nuniform Material material;\nuniform sampler2D texture0; // TODO: remove later\nuniform vec3 light_position;\nuniform vec3 camera_position;\n\nout vec4 result;\n\nvoid main(void)\n{\n    // Ambient light\n    vec3 _ambient_final = material.ambient;\n\n    // Diffuse light\n    vec3 _position_to_light_directional_vector = normalize(light_position - pass_position);\n    float _diffuse_dot_product = clamp(dot(_position_to_light_directional_vector, pass_normal), 0, 1);\n    vec3 _diffuse_final = material.diffuse * _diffuse_dot_product;\n\n    // Specular light\n    vec3 _light_to_position_directional_vector = normalize(light_position - pass_position);\n    vec3 _reflect_directional_vector = normalize(reflect(_light_to_position_directional_vector, normalize(pass_normal)));\n    vec3 _position_to_view_directional_vector = normalize(pass_position - camera_position);\n    float _specular_constant = pow(max(dot(_position_to_view_directional_vector, _reflect_directional_vector), 0), 70); // final number = smoothness\n    vec3 _specular_final = material.specular * _specular_constant;\n\n    // Attenuation (todo)\n\n    // Final light (todo)\n\n    result = texture(texture0, pass_uv) * (vec4(_ambient_final, 1.F) + vec4(_diffuse_final, 1.F) + vec4(_specular_final, 1.F));\n}\n</code></pre>\n\n<h3>Result (the error)</h3>\n\n<p>The Shader class also has a Debug() function which prints all the attributes and uniforms. The output I get is:</p>\n\n<pre><code>(call to v_primaryShader.Debug() )\n[    DEBUG ] Debugging shader 'primary':\n[    DEBUG ]   - Attributes (3 in total; numbers do not correspond to locations!):\n[    DEBUG ]     - Attribute 0 = name: 'vertex_normal', location: 1, type: vec3\n[    DEBUG ]     - Attribute 1 = name: 'vertex_position', location: 0, type: vec3\n[    DEBUG ]     - Attribute 2 = name: 'vertex_uv', location: 2, type: vec2\n[    DEBUG ]   - Uniforms (6 in total; numbers do not correspond to locations!):\n[    DEBUG ]     - Uniform 0 = name: 'camera_position', location: 0, type: vec3\n[    DEBUG ]     - Uniform 1 = name: 'light_position', location: 1, type: vec3\n[    DEBUG ]     - Uniform 2 = name: 'model_matrix', location: 2, type: mat4\n[    DEBUG ]     - Uniform 3 = name: 'projection_matrix', location: 3, type: mat4\n[    DEBUG ]     - Uniform 4 = name: 'texture0', location: 4, type: sampler2D\n[    DEBUG ]     - Uniform 5 = name: 'view_matrix', location: 5, type: mat4\n(calls to v_primaryShader.GetAndStoreUniformLocation() )\n[    DEBUG ] Uniform stored for shader 'primary': name: 'model_matrix', location: '2'\n[    DEBUG ] Uniform stored for shader 'primary': name: 'view_matrix', location: '5'\n[    DEBUG ] Uniform stored for shader 'primary': name: 'projection_matrix', location: '3'\n[    DEBUG ] Uniform stored for shader 'primary': name: 'light_position', location: '1'\n[    DEBUG ] Uniform stored for shader 'primary': name: 'camera_position', location: '0'\n[ CRITICAL ] Exception during phase 'LOAD'\n[ CRITICAL ] Shader&gt;GetAndStoreUniformLocation: Could not find uniform 'material.ambient' in shader 'primary'.\n</code></pre>\n\n<p>, so it's definitely getting all the other uniforms just fine. But 'material' is nowhere to be seen, yet, as you can see by the shader code, the inner members of the 'Material' struct are being used for lighting, which is used in the final output for the colour. And yes, I'm fully aware the code is probably not right, or optimised... but while I'm laying down boilerplate I just need to slap a bunch of stuff in there to get it working on a rudimentary level. Lighting has been working up until making the struct (before, I was just using hard-coded values)</p>\n"}, {"tags": ["c++", "rabbitmq", "amqp"], "comments": [{"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568216760, "post_id": 57892616, "comment_id": 102206791, "body": "What attempts have you made to interpret the error, resolve the issue? The linker was expecting to find the aforementioned symbol referenced in the object file, whilst trying to link a binary. Where is that symbol defined, is that lib/dll referenced on the link line?"}, {"owner": {"reputation": 12607, "user_id": 573082, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b497db0e7109deccad7e124f120024ad?s=128&d=identicon&r=PG", "display_name": "theateist", "link": "https://stackoverflow.com/users/573082/theateist"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568216914, "post_id": 57892616, "comment_id": 102206864, "body": "The nuget installes amqp-cpp.lib and I added the path to it to the project."}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568218088, "post_id": 57892616, "comment_id": 102207462, "body": "Sure, I understand that you used Nuget, however now that it has failed, you need to get into the package and understand what it was trying to find and where it looked and why it could not link it."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1568218109, "post_id": 57892616, "comment_id": 102207476, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 12607, "user_id": 573082, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b497db0e7109deccad7e124f120024ad?s=128&d=identicon&r=PG", "display_name": "theateist", "link": "https://stackoverflow.com/users/573082/theateist"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1568218483, "post_id": 57892616, "comment_id": 102207661, "body": "@&#214;&#246;Tiib, I&#39;m very well aware how linking works. The lib is a static lib. It seems that the lib doesn&#39;t have the required implementation. That&#39;s why I asked here to see if anyone has used this library!"}, {"owner": {"reputation": 12607, "user_id": 573082, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b497db0e7109deccad7e124f120024ad?s=128&d=identicon&r=PG", "display_name": "theateist", "link": "https://stackoverflow.com/users/573082/theateist"}, "reply_to_user": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568218704, "post_id": 57892616, "comment_id": 102207788, "body": "@Mansoor, I did look and did not find anything. That&#39;s why I asked the question here."}, {"owner": {"reputation": 12607, "user_id": 573082, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b497db0e7109deccad7e124f120024ad?s=128&d=identicon&r=PG", "display_name": "theateist", "link": "https://stackoverflow.com/users/573082/theateist"}, "edited": false, "score": 0, "creation_date": 1568270331, "post_id": 57892616, "comment_id": 102222473, "body": "Why it was voted for closing if my issue is not just a missing reference problem??"}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568305092, "post_id": 57892616, "comment_id": 102241196, "body": "@theateist I find that linker related issues on stack overflow are often ignored or poorly answered. I recommend you manually go through the command line, find where those symbols are defined and make sure that they appear on the link line. By default, they will not appear in the build log but you can turn up the build verbosity in the dev-studio settings and enable the verbose flag for the linker."}], "owner": {"reputation": 12607, "user_id": 573082, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b497db0e7109deccad7e124f120024ad?s=128&d=identicon&r=PG", "display_name": "theateist", "link": "https://stackoverflow.com/users/573082/theateist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1605112946, "creation_date": 1568216552, "last_edit_date": 1568276851, "question_id": 57892616, "link": "https://stackoverflow.com/questions/57892616/link-errors-while-using-amqp-cpp-lib", "title": "Link errors while using amqp-cpp.lib", "body": "<p>I do know how linking works. I added the path to the lib, but still have linking issues. My guess is that the lib doesn't have the relevant implementation. I would like to confirm that.</p>\n\n<p>Did anyone try C++ library for communicating with a RabbitMQ message broker from <a href=\"https://www.nuget.org/packages/AMQP-CPP/\" rel=\"nofollow noreferrer\">nuget</a>?</p>\n\n<p>I tried the x64 2.6.1.4 and even 2.6.1.3 versions on Windows 10 using Visual Studio 2015 but I get link errors:</p>\n\n<pre><code>1&gt;amqp-cpp.lib(tcpconnection.obj) : error LNK2001: unresolved external symbol \"int __cdecl AMQP::tcp::Errno(void)\" (?Errno@tcp@AMQP@@YAHXZ)\n1&gt;amqp-cpp.lib(tcpconnection.obj) : error LNK2001: unresolved external symbol \"char const * __cdecl AMQP::tcp::StrError(int)\" (?StrError@tcp@AMQP@@YAQEBDH@Z)\n1&gt;amqp-cpp.lib(tcpconnection.obj) : error LNK2001: unresolved external symbol \"int __cdecl AMQP::tcp::Close(unsigned __int64)\" (?Close@tcp@AMQP@@YAH_K@Z)\n</code></pre>\n\n<p>Did anyone encounter with this issue?</p>\n\n<p><strong>UPDATE1</strong></p>\n\n<p>I've uploaded the project with the package to <a href=\"https://drive.google.com/open?id=1F1PqPJCUFeISUjV6u6SQodHT0eKKbs6E\" rel=\"nofollow noreferrer\">here</a>. \nI've also uploaded the <a href=\"https://drive.google.com/open?id=1ImiqphKRRfBuSJ9tFgvw3gITcpdCAgRu\" rel=\"nofollow noreferrer\">dump</a> of the lib and I can see that indeed those symbols are missing (there is <code>UNDEF</code> near those symbols) from the lib</p>\n\n<pre><code>1B4 00000000 UNDEF  notype ()    External     | ?Errno@tcp@AMQP@@YAHXZ (int __cdecl AMQP::tcp::Errno(void))\n1B5 00000000 UNDEF  notype ()    External     | ?StrError@tcp@AMQP@@YAQEBDH@Z (char const * __cdecl AMQP::tcp::StrError(int))\n1B6 00000000 UNDEF  notype ()    External     | ?Close@tcp@AMQP@@YAH_K@Z (int __cdecl AMQP::tcp::Close(unsigned __int64))\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 2, "creation_date": 1568218106, "post_id": 57892613, "comment_id": 102207473, "body": "Are you using the IDE or command prompt?  For the command prompt to work you usually need to run the &quot;Developer Command Prompt&quot;s to get the environment variables set up for compilation and linking."}, {"owner": {"reputation": 1, "user_id": 12053971, "user_type": "registered", "profile_image": "https://graph.facebook.com/2528760720525798/picture?type=large", "display_name": "Fadster", "link": "https://stackoverflow.com/users/12053971/fadster"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1568314539, "post_id": 57892613, "comment_id": 102245079, "body": "I am using IDE. I launched it from a command prompt with administrator priveledges because it wasn&#39;t saving the initial configuration settings. Now, If I launch it from the developer command prompt for vs, I get a different error - cannot open program database vc140.pdb."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 6135671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1296ae506bb605031aed2ed4ab79a8?s=128&d=identicon&r=PG&f=1", "display_name": "Tercete", "link": "https://stackoverflow.com/users/6135671/tercete"}, "is_accepted": false, "score": 0, "last_activity_date": 1568223981, "creation_date": 1568223981, "answer_id": 57894337, "question_id": 57892613, "link": "https://stackoverflow.com/questions/57892613/visual-studio-not-finding-cl-exe/57894337#57894337", "title": "Visual Studio not finding cl.exe", "body": "<p>Did you run the VCVARSALL.BAT to configure the environment??\nI suggest you copy/set all this config variables in Control Panel | System | System | Advanced Config | Environment Variables\nOr create a .reg file with this configuration and double-click it...\nBye...</p>\n"}], "owner": {"reputation": 1, "user_id": 12053971, "user_type": "registered", "profile_image": "https://graph.facebook.com/2528760720525798/picture?type=large", "display_name": "Fadster", "link": "https://stackoverflow.com/users/12053971/fadster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568223981, "creation_date": 1568216522, "last_edit_date": 1568216841, "question_id": 57892613, "link": "https://stackoverflow.com/questions/57892613/visual-studio-not-finding-cl-exe", "title": "Visual Studio not finding cl.exe", "body": "<p>I just installed and configure VS for Windows 10 using the online instructions but when I try to run the sample program, I get an error that cl.exe cant be found. The executable exists in the defined compiler path. If I copy the full path and paste it in a command window, it runs.</p>\n\n<p>Any suggestions would be appreciated. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "performance", "constructor"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1568216019, "post_id": 57892454, "comment_id": 102206390, "body": "What is stopping you from timing them yourself?"}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 4, "creation_date": 1568216108, "post_id": 57892454, "comment_id": 102206431, "body": "There will be no meaningful difference in any realistic scenario. But there&#39; a bunch of better reasons than speed to prefer <code>:x(i),y(j)</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1568216182, "post_id": 57892454, "comment_id": 102206462, "body": "Just always us the member initializer list to initialize class members.  const members and reference members can only be initialized there so to be consistent you should do everything else there as well."}, {"owner": {"reputation": 23, "user_id": 12053885, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9fyQR-vCX33s5NCaGTO0JXEMgKgZsFXmW36TuLQ=k-s128", "display_name": "Asif Siddiqui", "link": "https://stackoverflow.com/users/12053885/asif-siddiqui"}, "reply_to_user": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1568216437, "post_id": 57892454, "comment_id": 102206622, "body": "@Jeffrey so we can say that line 1 will execute faster right ?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1568216458, "post_id": 57892454, "comment_id": 102206627, "body": "@NeilButterworth: <i>&quot;What is stopping you from timing them yourself?&quot;</i> Compiler, as it doesn&#39;t compile ;-)"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1568216979, "post_id": 57892454, "comment_id": 102206886, "body": "@AsifSiddiqui as Jeffrey said, speed is not the reason. There is a lot of reasons why the first is generally considered good practice. Speed is very low in the list of reasons. This kind of optimisation should be very low in your priorities."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1568216238, "post_id": 57892508, "comment_id": 102206496, "body": "I challenge you to find a C++ compiler from 1920."}, {"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568216302, "post_id": 57892508, "comment_id": 102206532, "body": "@SergeyA <a href=\"https://en.wikipedia.org/wiki/Borland_Kylix\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Borland_Kylix</a> this has a Greek theme I guess, it&#39;s something."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1568227774, "post_id": 57892508, "comment_id": 102211587, "body": "I think neither will execute faster, because neither will compile."}], "tags": [], "owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "is_accepted": true, "score": 1, "last_activity_date": 1568216145, "creation_date": 1568216145, "answer_id": 57892508, "question_id": 57892454, "link": "https://stackoverflow.com/questions/57892454/which-object-calls-constructor-faster/57892508#57892508", "title": "which object calls constructor faster?", "body": "<p>Stop worrying about micro optimisations. They will both run as fast unless your compiler is from 1920. Make your code readable and easy to understand is the most important.</p>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 0, "last_activity_date": 1568216858, "creation_date": 1568216858, "answer_id": 57892708, "question_id": 57892454, "link": "https://stackoverflow.com/questions/57892454/which-object-calls-constructor-faster/57892708#57892708", "title": "which object calls constructor faster?", "body": "<p>If there would be a difference, it would be negligible.</p>\n\n<p>However, it's considered a good practice to use initializers and directly initialize members with the right value.</p>\n\n<p>Another reason is that this approach would let less window for error, as one could use members before initializing them inside the constructor.</p>\n\n<p>There is many reasons why initializer list is considered good practice, and sometimes you don't have the choice but to use them in some situation. Speed is not the matter here.</p>\n"}], "owner": {"reputation": 23, "user_id": 12053885, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9fyQR-vCX33s5NCaGTO0JXEMgKgZsFXmW36TuLQ=k-s128", "display_name": "Asif Siddiqui", "link": "https://stackoverflow.com/users/12053885/asif-siddiqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 57892508, "answer_count": 2, "score": -3, "last_activity_date": 1568218366, "creation_date": 1568215915, "last_edit_date": 1568218366, "question_id": 57892454, "link": "https://stackoverflow.com/questions/57892454/which-object-calls-constructor-faster", "title": "which object calls constructor faster?", "body": "<p>I have two different classes in which different type of constructor call is shown. Which of these will execute faster ? </p>\n\n<pre><code>class A\n{ \n    string x, y;\npublic:\n    A(char *i,char *j): x(i), y(j) {}\n};\n\nclass B\n{\n    string x, y;\npublic:\n    B(char *i, char *j){ x = i; y = j; }\n};\n\nint main()\n{\n    A a(\"hello\", \"world\");//line 1\n    B b(\"hello\", \"world\");//line 2\n}\n</code></pre>\n\n<p>Which of these lines will execute faster ?</p>\n"}, {"tags": ["c++", "vector", "constructor", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1568215544, "post_id": 57892331, "comment_id": 102206100, "body": "Any reason you don&#39;t use a <code>std::list</code> instead of your own?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568215974, "post_id": 57892331, "comment_id": 102206362, "body": "@user6703592 The approach does not make sense. A node can not be initialized by a vector. It is a list that can be initialized by a vector."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1568215982, "post_id": 57892331, "comment_id": 102206369, "body": "It seems you fundamentally misunderstand <code>new</code> and <code>delete</code>. If you <code>delete tem;</code> then <code>tem</code> <b>and every other pointer to that same object</b> become invalidated. <code>delete</code> does not &quot;release&quot; a pointer to an object (pointers aren&#39;t any kind of reference counting handle) it deletes the actual object the pointer points to."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1568216089, "post_id": 57892331, "comment_id": 102206425, "body": "If you have a vector, why use a linked list at all?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568216149, "post_id": 57892331, "comment_id": 102206446, "body": "That code looks random to me. Can you explain to rubber duck what each line of it is supposed to do and why it is there?"}, {"owner": {"reputation": 600, "user_id": 6703592, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bdbeb38b8bd0369458b1d7b994bc9bbc?s=128&d=identicon&r=PG&f=1", "display_name": "user6703592", "link": "https://stackoverflow.com/users/6703592/user6703592"}, "edited": false, "score": 0, "creation_date": 1568217583, "post_id": 57892331, "comment_id": 102207192, "body": "sorry actually here <code>ListNode</code> is the <code>LinkedList</code>. And I have updated my code."}], "answers": [{"comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1568216369, "post_id": 57892429, "comment_id": 102206583, "body": "CD is indeed uninitialised heap memory: <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)#Magic_debug_values\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3803, "user_id": 459975, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bc7ef38c9fb207c34f2903fe2876744d?s=128&d=identicon&r=PG", "display_name": "Chuu", "link": "https://stackoverflow.com/users/459975/chuu"}, "is_accepted": false, "score": 1, "last_activity_date": 1568215830, "creation_date": 1568215830, "answer_id": 57892429, "question_id": 57892331, "link": "https://stackoverflow.com/questions/57892331/use-a-vector-to-initialize-the-linked-list-in-c/57892429#57892429", "title": "Use a vector to initialize the linked list in C++", "body": "<p>On the first iteration, \"next\" is going to be uninitialised, so ptr->next is not going to point to anything meaningful and likely will cause a seg fault.</p>\n\n<p>This is not the only bug in the method.</p>\n\n<p>Also, in debug mode, some compilers put a specific bit pattern in uninitialised memory to aid debugging. 0xCDCDCDCD looks suspiciously like one of those bit patterns.</p>\n"}, {"tags": [], "owner": {"reputation": 905, "user_id": 12050506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/babebb331d3cac03095ac5346e57f01b?s=128&d=identicon&r=PG&f=1", "display_name": "possum", "link": "https://stackoverflow.com/users/12050506/possum"}, "is_accepted": false, "score": 0, "last_activity_date": 1568218162, "last_edit_date": 1568218162, "creation_date": 1568216301, "answer_id": 57892547, "question_id": 57892331, "link": "https://stackoverflow.com/questions/57892331/use-a-vector-to-initialize-the-linked-list-in-c/57892547#57892547", "title": "Use a vector to initialize the linked list in C++", "body": "<p>Your first iteration is not initialized properly.</p>\n\n<p>Try</p>\n\n<pre><code>...\n    ListNode(vector&lt;int&gt; vec) {\n             ListNode* ptr = this;\n...\n</code></pre>\n\n<p>It's also not aligning the values from the list properly.  Set the value for <code>this</code> and then move on with the iterator</p>\n\n<pre><code>        vit it = vec.begin();\n        val = *it;\n\n        for ( ++it; it != vec.end(); it++)\n        {\n            ListNode* tem = new ListNode(*it);\n            ptr-&gt;next = tem;\n            ptr = ptr-&gt;next;\n        }\n</code></pre>\n\n<p>instead </p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1568217993, "last_edit_date": 1568217993, "creation_date": 1568216873, "answer_id": 57892712, "question_id": 57892331, "link": "https://stackoverflow.com/questions/57892331/use-a-vector-to-initialize-the-linked-list-in-c/57892712#57892712", "title": "Use a vector to initialize the linked list in C++", "body": "<p>For starters it is a bad design. It does not make sense to initialize a node with elements of a vector.</p>\n\n<p>It is a list that may be initialized by elements of a vector not a node.</p>\n\n<p>The definition of the constructor <code>ListNode</code> also does not make sense.</p>\n\n<p>For example its data member <code>next</code> is not initialized.</p>\n\n<pre><code>    ListNode* ptr = next;\n</code></pre>\n\n<p>So this statement</p>\n\n<pre><code>        ptr-&gt;next = tem;\n</code></pre>\n\n<p>invokes undefined behavior.</p>\n\n<p>A node was allocated and then deleted</p>\n\n<pre><code>        ListNode* tem = new ListNode(*it);\n        // ...\n        delete tem;\n</code></pre>\n\n<p>So what the list will contain?:)</p>\n\n<p>Also it is a bad idea to use a typedef like this</p>\n\n<pre><code>typedef vector&lt;int&gt;::iterator vit;\n</code></pre>\n\n<p>It only confuses readers of the code.</p>\n\n<p>The class can be defined the following way  as it is shown in the demonstrative program. Of course you yourself need to append the class definition with other constructors, assignment operators and the destructor.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nclass List \n{\nprotected:\n    struct Node\n    {\n        int val;\n        Node *next;\n    } *head = nullptr;      \n\npublic:\n\n    explicit List() = default;\n\n    List( const std::vector&lt;int&gt; &amp;v )\n    {\n        Node **current = &amp;head;\n\n        for ( const auto &amp;value : v )\n        {\n            *current = new Node { value, *current };\n            current = &amp;( *current )-&gt;next;\n        }\n    }\n\n    friend std::ostream &amp; operator &lt;&lt;( std::ostream &amp;, const List &amp; );\n};\n\nstd::ostream &amp; operator &lt;&lt;( std::ostream &amp;os, const List &amp;list )\n{\n    for ( List::Node *current = list.head; current != nullptr; current = current-&gt;next )\n    {\n        os &lt;&lt; current-&gt;val &lt;&lt; \" -&gt; \";\n    }\n\n    return os &lt;&lt; \"nullptr\";\n}\n\nint main()\n{\n    std::vector&lt;int&gt; v = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };\n    List list( v );\n\n    std::cout &lt;&lt; list &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>0 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; 6 -&gt; 7 -&gt; 8 -&gt; 9 -&gt; nullptr\n</code></pre>\n\n<p>As the constructor of the list that accepts a vector is not explicit then you may declare a list the following way</p>\n\n<pre><code>List list( { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 } );\n</code></pre>\n"}], "owner": {"reputation": 600, "user_id": 6703592, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bdbeb38b8bd0369458b1d7b994bc9bbc?s=128&d=identicon&r=PG&f=1", "display_name": "user6703592", "link": "https://stackoverflow.com/users/6703592/user6703592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "closed_date": 1568358555, "accepted_answer_id": 57892712, "answer_count": 3, "score": -2, "last_activity_date": 1568218827, "creation_date": 1568215449, "last_edit_date": 1568218827, "question_id": 57892331, "link": "https://stackoverflow.com/questions/57892331/use-a-vector-to-initialize-the-linked-list-in-c", "closed_reason": "Duplicate", "title": "Use a vector to initialize the linked list in C++", "body": "<p>Here is my code of struct of <code>linked list</code>. I want to use a vector to initialize the TreeNode. But in constructor,  <code>ptr-&gt;next = tem</code> has the error <code>Exception thrown: write access violation.\nptr was 0xCDCDCDCD.</code> Does someone know the reason and how to correct it?</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;vector&gt;\n\nusing namespace std;\n\nstruct ListNode {\n    int val = 0;\n    ListNode* next = NULL;\n\n    ListNode(int val) : val(val){};\n\n    ListNode(vector&lt;int&gt; vec) {\n        if (vec.empty())\n            return;\n        val = vec[0];\n        ListNode* ptr = this;\n        for (int i = 1; i &lt; vec.size();i++)\n        {\n            ptr-&gt;next = new ListNode(vec[i]);\n            ptr = ptr-&gt;next;\n        }\n    }\n};\n</code></pre>\n"}, {"tags": ["c++", "qt", "cgal", "point-clouds"], "comments": [{"owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1568265640, "post_id": 57892242, "comment_id": 102220883, "body": "Do you use cmake ?"}, {"owner": {"reputation": 1172, "user_id": 1562723, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/14I3k.jpg?s=128&g=1", "display_name": "misman", "link": "https://stackoverflow.com/users/1562723/misman"}, "reply_to_user": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1568266009, "post_id": 57892242, "comment_id": 102220981, "body": "Yes I use cmake @gdamiand"}, {"owner": {"reputation": 1172, "user_id": 1562723, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/14I3k.jpg?s=128&g=1", "display_name": "misman", "link": "https://stackoverflow.com/users/1562723/misman"}, "reply_to_user": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1568267100, "post_id": 57892242, "comment_id": 102221367, "body": "if there is a way easier, I want to hear? @gdamiand"}, {"owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "edited": false, "score": 0, "creation_date": 1568271063, "post_id": 57892242, "comment_id": 102222776, "body": "I think cmake is the simplest way. Have a look at the CMakeLists.txt in Triangulation_3 example <a href=\"https://github.com/CGAL/cgal/blob/master/Triangulation_3/examples/Triangulation_3/CMakeLists.txt\" rel=\"nofollow noreferrer\">github.com/CGAL/cgal/blob/master/Triangulation_3/examples/&hellip;</a>; you need (1) to use cgal with QT5; (2) to define CGAL_USE_BASIC_VIEWER using add_definitions; (3) to link your program with CGAL_Qt5 using target_link_libraries."}], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 1562723, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/14I3k.jpg?s=128&g=1", "display_name": "misman", "link": "https://stackoverflow.com/users/1562723/misman"}, "edited": false, "score": 0, "creation_date": 1568360195, "post_id": 57901263, "comment_id": 102256394, "body": "It works, my problem was that I was following the video. And in the video, the guy didn&#39;t build the source with cmake, he added libraries etc with manually. Thats why cmake solutions meant nothing for me. Thank you!"}], "tags": [], "owner": {"reputation": 591, "user_id": 1918900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd80d414eab91e202b05d5cdc29e44ba?s=128&d=identicon&r=PG", "display_name": "gdamiand", "link": "https://stackoverflow.com/users/1918900/gdamiand"}, "is_accepted": true, "score": 3, "last_activity_date": 1568271446, "creation_date": 1568271446, "answer_id": 57901263, "question_id": 57892242, "link": "https://stackoverflow.com/questions/57892242/cgal-draw-function-is-giving-cgal-use-basic-viewer-is-not-defined-error-in-vis/57901263#57901263", "title": "CGAL draw function is giving &#39;CGAL_USE_BASIC_VIEWER is not defined&#39; error in Visual Studio", "body": "<p>With cmake, you need to do the following to use CGAL basic viewers:</p>\n\n<p>1) use cgal with QT5</p>\n\n<p>find_package(CGAL COMPONENTS Qt5)</p>\n\n<p>2) define CGAL_USE_BASIC_VIEWER</p>\n\n<p>add_definitions(-DCGAL_USE_BASIC_VIEWER)</p>\n\n<p>3) link your program with CGAL_Qt5</p>\n\n<p>target_link_libraries(myexe PUBLIC CGAL::CGAL_Qt5)</p>\n\n<p>Have a look to the different examples in CGAL that uses basic viewer, for example  <a href=\"https://github.com/CGAL/cgal/blob/master/Triangulation_3/examples/Triangulation_3/draw_triangulation_3.cpp\" rel=\"nofollow noreferrer\">draw_triangulation_3.cpp</a> and its <a href=\"https://github.com/CGAL/cgal/blob/master/Triangulation_3/examples/Triangulation_3/CMakeLists.txt\" rel=\"nofollow noreferrer\">CMakeLists.txt</a>.</p>\n"}], "owner": {"reputation": 1172, "user_id": 1562723, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/14I3k.jpg?s=128&g=1", "display_name": "misman", "link": "https://stackoverflow.com/users/1562723/misman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 57901263, "answer_count": 1, "score": 1, "last_activity_date": 1568360590, "creation_date": 1568215125, "last_edit_date": 1568360590, "question_id": 57892242, "link": "https://stackoverflow.com/questions/57892242/cgal-draw-function-is-giving-cgal-use-basic-viewer-is-not-defined-error-in-vis", "title": "CGAL draw function is giving &#39;CGAL_USE_BASIC_VIEWER is not defined&#39; error in Visual Studio", "body": "<p>I am trying to generate mesh and 3D object from point cloud. I have searched lots of libraries and I decided to use CGAL. I followed <a href=\"https://www.youtube.com/watch?v=xWAuP6FN0d4\" rel=\"nofollow noreferrer\">this</a> youtube tutorial. Due to the fact that I want to see the objects, I need to use Qt5 library (as mentioned <a href=\"https://doc.cgal.org/4.13/Triangulation_2/index.html#Triangulation2Draw\" rel=\"nofollow noreferrer\">here</a>) and I downloaded it. And it worked as in tutorial.</p>\n\n<p>Libraries and applications I've used</p>\n\n<ul>\n<li>CMake 3.15.3</li>\n<li>CGAL-4.13.1</li>\n<li>Qt 5.13.0</li>\n<li>Boost 1_71_0</li>\n</ul>\n\n<p>The problem is that when I call the <code>CGAL::draw()</code> function it gives me this error</p>\n\n<blockquote>\n  <p>Impossible to draw because CGAL_USE_BASIC_VIEWER is not defined.</p>\n</blockquote>\n\n<p>When I have searched for it, I have generally found </p>\n\n<blockquote>\n  <p>QMAKE_CXXFLAGS +=-DCGAL_USE_BASIC_VIEWER<br>\n  LIBS+=-DCGAL_USE_BASIC_VIEWER</p>\n</blockquote>\n\n<p><code>.pro</code> file solution (I don't have .pro file) and <a href=\"http://cgal-discuss.949826.n4.nabble.com/How-to-draw-a-Triangulation-with-Qt-td4663779.html\" rel=\"nofollow noreferrer\">this</a>  </p>\n\n<p>I couldn't handle with them. \nIs there a windows visual studio solution?<br>\nHow do we define <code>CGAL_USE_BASIC_VIEWER</code>?<br>\nDo I need to import some Qt5 libs?</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>UPDATE</strong><br>\nMy problem was that I was following the video. And in the video, the guy didn't build the source with cmake, he added libraries etc with manually.  </p>\n\n<p>When I build the source code with cmake, it works.\nThere is a very simple tutorial <a href=\"https://www.youtube.com/watch?v=gYmgbqGfv-8\" rel=\"nofollow noreferrer\">Here</a>.</p>\n"}, {"tags": ["c++", "file-handling"], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 1, "last_activity_date": 1568215222, "creation_date": 1568215222, "answer_id": 57892274, "question_id": 57892183, "link": "https://stackoverflow.com/questions/57892183/why-does-the-errror-permission-denied-id-returned-1-exit-status-come-only-w/57892274#57892274", "title": "why does the errror &quot;permission denied&quot;, &quot;id returned 1 exit status&quot; come only when im using the header file fstream in c++", "body": "<p>The error message is generated by <code>ld</code>, your linker. It says it cannot open the output file (the executable you're trying to create).</p>\n\n<p><strong>This is probably because <em>you're already running your program</em> somewhere.</strong></p>\n\n<p>Close it, so that your compiler &amp; linker can replace it with the new version you're trying to build.</p>\n\n<hr>\n\n<p>Copy/pasting the contents of your toolchain's fstream header won't change anything; it's more likely to break things.</p>\n\n<p>In fact, this has nothing to do with <code>fstream</code>, or with header files, or anything like that. I suspect that you added some <code>fstream</code> functionality and then the next rebuild (intended to test the new code) triggered the problem.</p>\n\n<p>You can verify this by now <em>removing</em> your new <code>fstream</code> code and noting that the problem does not go away. Always try to narrow down your problems by a process of trial, error and verification.</p>\n"}], "owner": {"reputation": 13, "user_id": 10774816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfce63ff30dac314af863e75be8d3d82?s=128&d=identicon&r=PG&f=1", "display_name": "Vedha Sankar ", "link": "https://stackoverflow.com/users/10774816/vedha-sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1568245296, "accepted_answer_id": 57892274, "answer_count": 1, "score": -1, "last_activity_date": 1568226734, "creation_date": 1568214920, "last_edit_date": 1568226734, "question_id": 57892183, "link": "https://stackoverflow.com/questions/57892183/why-does-the-errror-permission-denied-id-returned-1-exit-status-come-only-w", "closed_reason": "Not suitable for this site", "title": "why does the errror &quot;permission denied&quot;, &quot;id returned 1 exit status&quot; come only when im using the header file fstream in c++", "body": "<p>I cant seem to use the header file <strong>fstream</strong> </p>\n\n<p>I've tried downloading the header file and linking it to the compiler but it still shows the same error.</p>\n\n<pre><code>ofstream file(\"file.txt\",ios::out);\n    file&lt;&lt;\"text file.\";\n</code></pre>\n\n<p>the text is supposed to be copied to the file, but when I run it, the file isn't created and the output screen terminates without displaying anything.\nThese are the errors: </p>\n\n<pre><code>cannot open output file, Permission denied\n[Error] ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c++", "r", "visual-studio-2015", "lnk2019"], "comments": [{"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1569324957, "post_id": 57892039, "comment_id": 102553193, "body": "Any particular reason why you are not using Rcpp?"}, {"owner": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1569437453, "post_id": 57892039, "comment_id": 102600627, "body": "Indeed. I should have said &quot;using Rcpp and Rtools (i.e. mingw)&quot;."}, {"owner": {"reputation": 3, "user_id": 12049434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6414b867449a5bd999969349f067279?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Voss", "link": "https://stackoverflow.com/users/12049434/stefan-voss"}, "reply_to_user": {"reputation": 24192, "user_id": 8416610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmim3CrZ9Wo/AAAAAAAAAAI/AAAAAAAAAjs/hnKTOHALc6M/photo.jpg?sz=128", "display_name": "Ralf Stubner", "link": "https://stackoverflow.com/users/8416610/ralf-stubner"}, "edited": false, "score": 0, "creation_date": 1569528920, "post_id": 57892039, "comment_id": 102636847, "body": "Thanks for the suggestion, I am going to look into it."}], "owner": {"reputation": 3, "user_id": 12049434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6414b867449a5bd999969349f067279?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Voss", "link": "https://stackoverflow.com/users/12049434/stefan-voss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1568214380, "creation_date": 1568214380, "question_id": 57892039, "link": "https://stackoverflow.com/questions/57892039/writing-c-code-for-r-in-visual-studio-2015-linker-errors", "title": "Writing C++ code for R in Visual Studio 2015, linker errors", "body": "<p>I am trying to get started with developing a DLL with C++ functions for use in R (Visual Studio 2015).</p>\n\n<p>I am using this as a reference and to begin with some test code:</p>\n\n<p><a href=\"http://adv-r.had.co.nz/C-interface.html\" rel=\"nofollow noreferrer\">http://adv-r.had.co.nz/C-interface.html</a></p>\n\n<p>stdafx.h:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;R.h&gt;\n#include &lt;Rinternals.h&gt;\n\nextern \"C\" SEXP add(SEXP a, SEXP b);\n</code></pre>\n\n<p>R_Code_Test.cpp:</p>\n\n<pre><code>#include \"stdafx.h\"\n\nSEXP add(SEXP a, SEXP b) \n{\n    SEXP result = PROTECT(allocVector(REALSXP, 1));\n    REAL(result)[0] = asReal(a) + asReal(b);\n    UNPROTECT(1);\n\n    return result;\n}\n</code></pre>\n\n<p>Compiling this results in linker errors:</p>\n\n<pre><code>LNK2019 unresolved external symbol REAL referenced in function add\nLNK2019 unresolved external symbol Rf_asReal referenced in function add\nLNK2019 unresolved external symbol Rf_allocVector referenced in function add\nLNK2019 unresolved external symbol Rf_protect referenced in function add\nLNK2019 unresolved external symbol Rf_unprotect referenced in function add\n</code></pre>\n\n<p>(I have the definition file as well but didn't copy/paste it here.)</p>\n\n<p>I read elsewhere that R.dll needed to be linked, so I've included that directory from the R install, but I think I must still be missing something obvious.</p>\n\n<p>Any help is much appreciated!</p>\n\n<p>Cheers</p>\n"}, {"tags": ["c++", "linker-errors", "abi"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1568213659, "post_id": 57891775, "comment_id": 102205022, "body": "Sorry, no. Different ABIs - no link."}], "answers": [{"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 0, "last_activity_date": 1568214244, "creation_date": 1568214244, "answer_id": 57891994, "question_id": 57891775, "link": "https://stackoverflow.com/questions/57891775/is-it-possible-to-build-an-application-with-external-libraries-of-different-abi/57891994#57891994", "title": "is it possible to build an application with external libraries of different ABI&#39;s", "body": "<p>You can't mix different values of <code>GLIBCXX_USE_CXX11_ABI</code> in a single file but you should be able to link files with different settings into a single library.</p>\n\n<p>So if you are using the c++11 library in class <code>A</code> and the c++03 library in class <code>B</code> and class <code>A</code> and class <code>B</code> are in separate files and don't have <code>std::string</code> or <code>std::list</code> in their headers then it should be possible to link class <code>A</code> and class <code>B</code> into a single library.</p>\n\n<p>Use of the pimpl pattern may be useful/required to achieve this.</p>\n\n<p>The simplest approach is probably to produce a static library which wraps your c++03 library and is compiled with <code>-D_GLIBCXX_USE_CXX11_ABI=0</code> then you can compile the rest of your code as normal as long as you only interface with your c++03 library through the static library.</p>\n"}, {"comments": [{"owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "edited": false, "score": 1, "creation_date": 1568221483, "post_id": 57892293, "comment_id": 102209013, "body": "Make sure to hide all public symbols which might propagate from libraryA and libraryB to the corresponding wrapper libraries (i.e. force all symbols except your new C-API local). Otherwise you may face duplicate incompatible definition of some symbol coming from libraryA and libraryB."}, {"owner": {"reputation": 3, "user_id": 11989114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/765706b48e4a19e65a9763e3f37c6e74?s=128&d=identicon&r=PG&f=1", "display_name": "nickp", "link": "https://stackoverflow.com/users/11989114/nickp"}, "edited": false, "score": 0, "creation_date": 1568387641, "post_id": 57892293, "comment_id": 102270008, "body": "so i need to put some efford in it to get it working. thanks for the idea."}], "tags": [], "owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1568215309, "creation_date": 1568215309, "answer_id": 57892293, "question_id": 57891775, "link": "https://stackoverflow.com/questions/57891775/is-it-possible-to-build-an-application-with-external-libraries-of-different-abi/57892293#57892293", "title": "is it possible to build an application with external libraries of different ABI&#39;s", "body": "<p>The only possible work-around I can think of is not very nice. Say you have libraries A and B with different ABI versions, vA and vB. Now, create a wrapper for library A which exposes an interface which is ABI-independent (plain <code>C</code>, i.e. all exposed functions should be declared with <code>extern \"C\"</code>). Then build this with ABI version vA (make sure to statically link needed vA libraries). Now you can build your application using ABI version vB linking with the wrapped library A (which should now be ABI-independent) and library B.</p>\n\n<p>Of course, depending on the interface of library A, it may take some creativity to create a plain <code>C</code> interface, but it should be possible.</p>\n\n<p><strong>Disclaimer</strong>: I have not tried this myself, I recommend starting with a minimal test.</p>\n"}], "owner": {"reputation": 3, "user_id": 11989114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/765706b48e4a19e65a9763e3f37c6e74?s=128&d=identicon&r=PG&f=1", "display_name": "nickp", "link": "https://stackoverflow.com/users/11989114/nickp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 57892293, "answer_count": 2, "score": 0, "last_activity_date": 1568215309, "creation_date": 1568213514, "question_id": 57891775, "link": "https://stackoverflow.com/questions/57891775/is-it-possible-to-build-an-application-with-external-libraries-of-different-abi", "title": "is it possible to build an application with external libraries of different ABI&#39;s", "body": "<p>I have currently the problem that i need to build a application where it seems that the libraries are build with different c++ versions. \nWhen i build i got the <code>undefined reference std::__cxx11::basic_string</code> errors at one library and when i build with the <code>-D_GLIBCXX_USE_CXX11_ABI=0</code> i get undefined reference errors at <code>std::string</code> of the other library. \nThey are both external libraries which i unfortunatly can't rebuild myself. Is there a workaround for this?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568213401, "post_id": 57891692, "comment_id": 102204869, "body": "Voting to close as a typo.  <code>delete foo-&gt;bar.data();</code> should be <code>delete foo;</code> as you need to delete the pointer you newed, not what the pointer points to."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568213535, "post_id": 57891692, "comment_id": 102204951, "body": "You actually don&#39;t need <code>new</code>, and so no need of <code>delete</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 6, "creation_date": 1568213545, "post_id": 57891692, "comment_id": 102204962, "body": "&quot;I would imagine that the data() would still return a pointer I can delete&quot; -- no, it doesn&#39;t do that, ever. A <code>vector</code> manages its own memory. What gave you the idea that messing around with it is something you should be doing?"}, {"owner": {"reputation": 1935, "user_id": 1479628, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28786d848d6d02f535c37eb41c9336c4?s=128&d=identicon&r=PG", "display_name": "Frank", "link": "https://stackoverflow.com/users/1479628/frank"}, "edited": false, "score": 0, "creation_date": 1568213576, "post_id": 57891692, "comment_id": 102204979, "body": "It&#39;s not a typo. I agree that the example is a bit derived, but why would this not work? I have this construction because of the interfacing with python (not specified here)"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1568213628, "post_id": 57891692, "comment_id": 102205006, "body": "What is your motivation for trying to <code>delete</code> memory you don&#39;t own (i.e. which someone else will <code>delete</code> later)? I just don&#39;t understand what the idea here is? What are you hoping to achieve?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1568213639, "post_id": 57891692, "comment_id": 102205014, "body": "@Frank You can only <code>delete</code> something that you <code>new</code>ed. You didn&#39;t <code>new</code> what <code>bar.data()</code> returns. You cannot <code>delete</code> it. If you want to release the memory, ask <code>bar</code> to do it for you with <code>clear()</code>. Its responsible for its own memory, you are not."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568213758, "post_id": 57891692, "comment_id": 102205082, "body": "Related : <a href=\"https://stackoverflow.com/questions/14862297/why-isnt-accessing-a-deleted-object-crashing-my-program\">Why isn&#39;t accessing a deleted object crashing my program?</a>. It&#39;s not because you observe that the values are still there that they actually are. You have undefined behavior, which means anything can happen. The behavior you observed may stop or change at any time for any reason and cannot be relied upon. You&#39;ve noticed that already where if the vector is large enough, the behavior suddenly changes for no reason."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1568214774, "post_id": 57891692, "comment_id": 102205675, "body": "&quot;why would this not work&quot; - there&#39;s so many reasons I don&#39;t even know where to start. 1. vector&#39;s internal storage might not have been allocated with <code>new</code> but with e.g. <code>malloc</code>. 2. You are using <code>delete</code>, but you don&#39;t know if <code>vector</code> used <code>new</code> or <code>new[]</code> (or see 1.)  3. <code>data()</code> might not point to it&#39;s internal storage. 4. Even if none of the above occurs, <code>vector</code> will delete any memory it allocated during destruction (although this doesn&#39;t happen in your code, because you are leaking <code>foo</code>). <b>This memory is not yours to manage and you are not allowed to manage it</b>."}], "answers": [{"tags": [], "owner": {"reputation": 3734, "user_id": 3537677, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e05436d74c08a9efa7db860df7bbf01f?s=128&d=identicon&r=PG", "display_name": "Superlokkus", "link": "https://stackoverflow.com/users/3537677/superlokkus"}, "is_accepted": true, "score": 1, "last_activity_date": 1568287902, "last_edit_date": 1568287902, "creation_date": 1568215911, "answer_id": 57892452, "question_id": 57891692, "link": "https://stackoverflow.com/questions/57891692/deleting-member-stdvectordata-in-visual-studio/57892452#57892452", "title": "deleting member std::vector::data() in visual studio", "body": "<blockquote>\n  <p>But I would imagine that the data() would still return a pointer I can delete</p>\n  \n  <p>It's not a typo. I agree that the example is a bit derived, but why would this not work? </p>\n</blockquote>\n\n<p><strong>No</strong> you simply are not allowed to, because\n\"8.5.2.5 Delete [expr.delete]\" in the C++ standard (draft N4713 used) clearly states:</p>\n\n<blockquote>\n  <p>In a single-object delete expression, the value of the operand of delete may be a null pointer\n  value, a pointer to a non-array object <strong>created by a previous new-expression</strong>, or a pointer to a subobject (6.6.2)\n  representing a base class of such an object (Clause 13). <strong>If not, the behavior is undefined.</strong> </p>\n</blockquote>\n\n<p>And undefined behaviour, or commonly short UB, is defined in \"3.27 [defns.undefined]\" as </p>\n\n<blockquote>\n  <p>Permissible undefined behavior\n  ranges from ignoring the situation completely with unpredictable results, to behaving during translation or\n  program execution in a documented manner characteristic of the environment (with or without the issuance\n  of a diagnostic message), to terminating a translation or execution (with the issuance of a diagnostic message).</p>\n</blockquote>\n\n<p>Meaning: You are not allowed to delete the pointer given by <code>std::vector::data()</code>. If you still do so and you do by <code>delete foo-&gt;bar.data()</code>, your program is non deterministic and therefore we are talking about use cases outside of rational, common sense, computer programming. <strong>Its allowed to work, but also allowed not to work, and any try to reason about it, is beyond the scope of whats commonly regarded as productive computer programming</strong>.</p>\n\n<p>Of course you are allowed to <code>delete foo;</code> since <code>foo</code> is indeed <em>a pointer to a non-array object created by a previous new-expression</em> but <code>foo-&gt;data()</code> is not. It might be internally be some <code>std::vector</code> implementations, but that is neither guaranteed nor usually the case nor allowed in the cases it is, since every <code>std::vector</code> implementation would have to <code>delete</code> their internal memory at least upon destruction, causing a double delete, which also invokes UB. But again, most <code>std::vector</code>s not even use <code>new</code>, in the sense for allocating and constructing something.</p>\n"}], "owner": {"reputation": 1935, "user_id": 1479628, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28786d848d6d02f535c37eb41c9336c4?s=128&d=identicon&r=PG", "display_name": "Frank", "link": "https://stackoverflow.com/users/1479628/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 57892452, "answer_count": 1, "score": -3, "last_activity_date": 1568287902, "creation_date": 1568213217, "last_edit_date": 1568218649, "question_id": 57891692, "link": "https://stackoverflow.com/questions/57891692/deleting-member-stdvectordata-in-visual-studio", "title": "deleting member std::vector::data() in visual studio", "body": "<p>I am trying to build a lib that interfaces with Python, however Im running into so problems with VS2019. I have found a simple example that shows my problem:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nclass Foo\n{\npublic:\n    std::vector&lt;double&gt; bar;\n\n    void fillBar(Foo&amp; foo)\n    {\n        int nrElements = 100;\n        for (int i = 0; i &lt; nrElements; ++i)\n        {\n            bar.emplace_back(0.0);\n        }\n    }\n};\n\nint main()\n{\n    Foo* foo = new Foo();\n\n    std::cout &lt;&lt; \"Filling bar\" &lt;&lt; std::endl;\n    foo-&gt;fillBar(*foo);\n\n    std::cout &lt;&lt; \"deleting bar\" &lt;&lt; std::endl;\n    delete foo-&gt;bar.data();\n\n    std::cout &lt;&lt; \"The End\" &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>This works fine, however if I try to increase <code>nrElements</code> to say 1.000.000 the line <code>delete foo-&gt;bar.data()</code> crashes the program. I guess it has something to do with the resizing of the <code>std::vector</code> when the current space is running out. But I would imagine that the <code>data()</code> would still return a pointer I can delete. Especially since when I dereference the pointer it gives the right value for all elements in the vector...</p>\n"}, {"tags": ["c++", "c++11", "templates", "template-meta-programming"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1568213307, "post_id": 57891624, "comment_id": 102204826, "body": "But basically, C++03? Please tag appropriately."}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1568213361, "post_id": 57891624, "comment_id": 102204850, "body": "Here is the <a href=\"http://www.keil.com/support/man/docs/armcc/armcc_chr1407404265784.htm\" rel=\"nofollow noreferrer\">full list</a>."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1568213629, "post_id": 57891624, "comment_id": 102205007, "body": "Is there a reason why you want to initialize a data member with a template parameter instead of using the constructor ?"}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1568213707, "post_id": 57891624, "comment_id": 102205052, "body": "I&#39;m trying to write some kind of static adapter/decorator for my modbus class. It should accept rs232 and rs485 and these both need uart but only rs485 needs to have pins."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1568213871, "post_id": 57891624, "comment_id": 102205144, "body": "And what&#39;s the problem by using a constructor ? I don&#39;t get it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568213934, "post_id": 57891624, "comment_id": 102205189, "body": "The code looks weird to me. If you have a template argument, why do you need a member? And if you do have a member, what&#39;s the point of having template argument?"}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1568214074, "post_id": 57891624, "comment_id": 102205284, "body": "I&#39;m trying to use compile time polymorphism to get away from a vtable and such. I&#39;m in an embedded environment so removing stuff on the free store is beneficial for me while also removing extra function calls."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568214368, "post_id": 57891624, "comment_id": 102205429, "body": "This doesn&#39;t answer my question at all."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1568214384, "post_id": 57891624, "comment_id": 102205439, "body": "@TarickWelling You can use CRTP to implement compile time polymorphism without needing a non type template parameter"}, {"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568214730, "post_id": 57891624, "comment_id": 102205647, "body": "@NathanOliver saw that term before, seems like I indeed am looking for such a solution as having non type parameters is just a big mess in my usage."}], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "edited": false, "score": 0, "creation_date": 1568213284, "post_id": 57891660, "comment_id": 102204819, "body": "I forgot mention but I can only use a limited subset of C++11. Seems like a great answer otherwise though."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1568213683, "post_id": 57891660, "comment_id": 102205038, "body": "<code>TEMPLATE_AUTO</code> should be <code>#define TEMPLATE_AUTO(...) decltype(__VA_ARGS__), __VA_ARGS__</code> because macros don&#39;t understand <code>&lt;&gt;</code> surrounding <code>,</code>.  With yours, try <code>template&lt;class T, std::size_t N&gt; std::array&lt;T, N&gt; zeros = {{0}};</code> and <code>TEMPLATE_AUTO( &amp;zeros&lt;int, 10&gt; )</code> -- your macro can explode (depending on how lax your preprocessor is), mine works."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1568214450, "post_id": 57891660, "comment_id": 102205485, "body": "@Yakk-AdamNevraumont: Thanks, improved."}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1568214307, "last_edit_date": 1568214307, "creation_date": 1568213094, "answer_id": 57891660, "question_id": 57891624, "link": "https://stackoverflow.com/questions/57891624/is-it-possible-to-pass-a-type-and-a-pointer-of-that-type-to-a-c-template-class/57891660#57891660", "title": "Is it possible to pass a type and a pointer of that type to a c++ template class using a single parameter of a template class?", "body": "<p>Since C++17, you might have</p>\n\n<pre><code>template &lt;auto* ptr&gt; class c\n{\npublic:\n    auto _ptr = ptr;\n};\n</code></pre>\n\n<p>Before that,</p>\n\n<pre><code>template &lt;typename T, T* ptr&gt; class c\n{\npublic:\n    T* _ptr = ptr;\n};\n</code></pre>\n\n<p>is the way to go.</p>\n\n<p>MACRO can help since C++11</p>\n\n<pre><code>#define TEMPLATE_AUTO(...) decltype(__VA_ARGS__), __VA_ARGS__\n\nc&lt;TEMPLATE_AUTO(my_ptr)&gt; v;\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 8548828, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4qkl.png?s=128&g=1", "display_name": "Tarick Welling", "link": "https://stackoverflow.com/users/8548828/tarick-welling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57891660, "answer_count": 1, "score": 0, "last_activity_date": 1568214307, "creation_date": 1568212955, "last_edit_date": 1568213871, "question_id": 57891624, "link": "https://stackoverflow.com/questions/57891624/is-it-possible-to-pass-a-type-and-a-pointer-of-that-type-to-a-c-template-class", "title": "Is it possible to pass a type and a pointer of that type to a c++ template class using a single parameter of a template class?", "body": "<p>Is it possible to pass a type and a pointer of that type to a c++ template class using a single parameter of a template class?</p>\n\n<hr>\n\n<p>I want to take a pointer to a embedded hardware address (an uart) which has the type <code>UART_HandleTypeDef</code> and deduce that type information instead of manually declaring it. Something akin to:</p>\n\n<pre><code>template&lt;typename T&gt; class serial{\npublic:\n    T::value_type* uart = T;\n};\n</code></pre>\n\n<p>I want to get away from the normal notation which would require me to state the type and then pass a pointer:</p>\n\n<pre><code>template&lt;typename T,T* ptr&gt; class c{\npublic:\n  T* _ptr = ptr;\n};\n</code></pre>\n\n<p>update:\nI forgot to mention: pre C++11 is supported by my compiler. It supports <a href=\"http://www.keil.com/support/man/docs/armcc/armcc_chr1407404265784.htm\" rel=\"nofollow noreferrer\"><em>some</em> C++11 features</a></p>\n"}, {"tags": ["c++", "visual-c++", "c++17", "stdvector"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1568212369, "post_id": 57891442, "comment_id": 102204274, "body": "Does marking your move constructor <code>noexcept</code> help?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1568212586, "post_id": 57891442, "comment_id": 102204410, "body": "Which version of the Visual C++ compiler are you using?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1568212622, "post_id": 57891442, "comment_id": 102204446, "body": "@Tom&#225;\u0161 Zato The move-assignment operator has no return expression."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568213459, "post_id": 57891442, "comment_id": 102204909, "body": "From what I understand, compiling without exceptions doesn&#39;t remove exception related code from the standard library. The preprocessor definition <code>_HAS_EXCEPTIONS</code> seems to be used to strip out that code. Without it, you have <code>throw&#47;try&#47;catch</code> in the standard library that doesn&#39;t work, which is what the warning is trying to say."}], "answers": [{"tags": [], "owner": {"reputation": 13563, "user_id": 992490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac727873c5724326c84ed245faa9fe6c?s=128&d=identicon&r=PG", "display_name": "Marshall Clow", "link": "https://stackoverflow.com/users/992490/marshall-clow"}, "is_accepted": false, "score": 3, "last_activity_date": 1568213028, "last_edit_date": 1568213028, "creation_date": 1568212651, "answer_id": 57891554, "question_id": 57891442, "link": "https://stackoverflow.com/questions/57891442/stdvector-without-exceptions-warning-c4530-c-exception-handler-used-but-u/57891554#57891554", "title": "std::vector without exceptions: warning C4530: C++ exception handler used, but unwind semantics are not enabled. Specify /EHsc", "body": "<blockquote>\n  <p>Why does <code>push_back</code> even require exceptions?</p>\n</blockquote>\n\n<p><code>vector::push_back</code> has to do two things:</p>\n\n<ul>\n<li>Make sure that there's space for the new element. That could involve allocating memory - which can fail. It reports this failure by throwing an exception.</li>\n<li>Construct a new element in the vector. That involves calling your class' copy or move constructor - which can fail. Constructors usually report failures by throwing an exception.</li>\n</ul>\n\n<p>You can indicate that your move constructor will never fail by marking it as <code>noexcept</code>.</p>\n"}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "closed_date": 1568213322, "answer_count": 1, "score": 2, "last_activity_date": 1568213385, "creation_date": 1568212266, "last_edit_date": 1568212541, "question_id": 57891442, "link": "https://stackoverflow.com/questions/57891442/stdvector-without-exceptions-warning-c4530-c-exception-handler-used-but-u", "closed_reason": "Duplicate", "title": "std::vector without exceptions: warning C4530: C++ exception handler used, but unwind semantics are not enabled. Specify /EHsc", "body": "<p>I am trying to insert a moveable, non-copyable object into <code>std::vector</code>. I reduced the original code to this example:</p>\n\n<pre><code>#include &lt;vector&gt;\nclass MovingClass\n{\npublic:\n  MovingClass(const int value) : _value(new int(value)) {}\n  //! No copy allowed\n  MovingClass(const MovingClass&amp; src) = delete;\n  MovingClass&amp; operator=(const MovingClass&amp; src) = delete;\n  // move is OK\n  MovingClass(MovingClass&amp;&amp; source) : _value(source._value) { source._value = nullptr; }\n  MovingClass&amp; operator=(MovingClass&amp;&amp; source) { _value = source._value; source._value = nullptr; }\n\n  ~MovingClass() { delete _value; }\n  // do not mind that this is all kinds of bad, it's just an example\n  int* _value;\n};\n\nint test_vector_main()\n{\n  std::vector&lt;MovingClass&gt; containers;\n  containers.push_back({ 42 });\n\n  return 0;\n}\n</code></pre>\n\n<p>The original purpose of the class is closing winapi handles, not deleting pointers.</p>\n\n<p>I can reproduce the warning in a blank project if I set \"Enable C++ Exceptions\" to \"No\" in <code>Configuration Properties-&gt;C/C++-&gt;All Options</code>.</p>\n\n<p>The project I work with treats warnings as errors and has exceptions disabled.</p>\n\n<p>I am not sure what to do except giving up on no-copy rules or enabling the exceptions. I'll enable the exceptions, but if I couldn't what else could I do?</p>\n\n<p>Why does <code>push_back</code> even require exceptions?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1568211831, "post_id": 57891274, "comment_id": 102203951, "body": "The object is deleted during exiting main.."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1568211866, "post_id": 57891274, "comment_id": 102203981, "body": "But you do delete <code>restaurant</code> here ---&gt; <code>return 0;</code>. All local variables are destroyed when function exists it&#39;s scope."}, {"owner": {"reputation": 1350, "user_id": 1698678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c3dcda949d1adcc6db14345586b2b9?s=128&d=identicon&r=PG", "display_name": "PlinyTheElder", "link": "https://stackoverflow.com/users/1698678/plinytheelder"}, "edited": false, "score": 2, "creation_date": 1568211934, "post_id": 57891274, "comment_id": 102204014, "body": "You seem to misunderstand how the object lifetimes work... Your &quot;restaurant&quot; object is still deleted when it goes out of scope, that is where your second &quot;~B&quot; comes from."}, {"owner": {"reputation": 19, "user_id": 12053467, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BPugbPe6-xQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoLinTRmekiXwJ21tBm-1sKNiegg/photo.jpg?sz=128", "display_name": "Videl Ichinose", "link": "https://stackoverflow.com/users/12053467/videl-ichinose"}, "edited": false, "score": 0, "creation_date": 1568212060, "post_id": 57891274, "comment_id": 102204095, "body": "I see, so there is no chance to not displaying it in console? Actually it is ok, when it is deleting, but I would like not to display it in console..."}, {"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1568212063, "post_id": 57891274, "comment_id": 102204097, "body": "and you are missing a virtual destructor in your base class. It will leak when you will try a <code>base* b = new restaurant,</code> even if you call <code>delete b;</code>"}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "reply_to_user": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1568213079, "post_id": 57891274, "comment_id": 102204703, "body": "@Moia &quot;It will leak&quot; - It will be undefined behavior. Leaking is just one possible effect."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1568213924, "post_id": 57891274, "comment_id": 102205180, "body": "@Yksisarvinen No, but undefined behavior might include leaking memory. Deleting through a base pointer without a virtual destructor is UB."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1568213997, "post_id": 57891274, "comment_id": 102205230, "body": "@SebastianRedl My bad, didn&#39;t read your comment carefully."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1568211991, "post_id": 57891343, "comment_id": 102204053, "body": "It&#39;s better to use words like <i>&quot;automatic storage&quot;</i> than <i>&quot;the stack&quot;</i> in this context."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568212054, "post_id": 57891343, "comment_id": 102204090, "body": "@SergeyA It certainly doesn&#39;t hurt to mention both terms, thanks."}, {"owner": {"reputation": 19, "user_id": 12053467, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BPugbPe6-xQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoLinTRmekiXwJ21tBm-1sKNiegg/photo.jpg?sz=128", "display_name": "Videl Ichinose", "link": "https://stackoverflow.com/users/12053467/videl-ichinose"}, "edited": false, "score": 0, "creation_date": 1568212813, "post_id": 57891343, "comment_id": 102204552, "body": "Ok, I did what you said and it is working, thank You."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 19, "user_id": 12053467, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BPugbPe6-xQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoLinTRmekiXwJ21tBm-1sKNiegg/photo.jpg?sz=128", "display_name": "Videl Ichinose", "link": "https://stackoverflow.com/users/12053467/videl-ichinose"}, "edited": false, "score": 1, "creation_date": 1568213166, "post_id": 57891343, "comment_id": 102204758, "body": "@VidelIchinose if you&#39;re not deleting, you have a memory leak. Try not doing that"}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1568213181, "post_id": 57891343, "comment_id": 102204764, "body": "I&#39;m downvoting this answer. It proposes leaking an object, which is generally a bad idea, and not even explaining that it is a bad idea and why."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1568214623, "post_id": 57891343, "comment_id": 102205593, "body": "@SebastianRedl I assumed that the question was just academic, but recent comments suggest otherwise... yikes."}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1568214477, "last_edit_date": 1568214477, "creation_date": 1568211938, "answer_id": 57891343, "question_id": 57891274, "link": "https://stackoverflow.com/questions/57891274/how-to-not-delete-a-copy-of-base-class-object/57891343#57891343", "title": "How to not delete a copy of base class object?", "body": "<p>You're not <code>delete</code>ing <code>restaurant</code>, but you didn't <code>new</code> it either; it's allocated in automatic storage (\"the stack\"), not dynamic storage (\"the heap\"). Objects in automatic storage have their destructor called when they go out of scope. This is why the <code>restaurant</code> destructor is still being called in this case.</p>\n\n<p>If you'd written:</p>\n\n<pre><code>restaurant *restaurant = new restaurant;\n</code></pre>\n\n<p>you'd see the behaviour you're expecting. Of course, by calling <code>new</code> without a matching <code>delete</code> you will be leaking the object, so this is not recommended.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11113280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb0c525c07a2df5d621f59510aff6da?s=128&d=identicon&r=PG&f=1", "display_name": "Darshan Rajgor", "link": "https://stackoverflow.com/users/11113280/darshan-rajgor"}, "is_accepted": false, "score": 0, "last_activity_date": 1568213191, "last_edit_date": 1568213191, "creation_date": 1568212773, "answer_id": 57891581, "question_id": 57891274, "link": "https://stackoverflow.com/questions/57891274/how-to-not-delete-a-copy-of-base-class-object/57891581#57891581", "title": "How to not delete a copy of base class object?", "body": "<p>The output is expected output.\nI have added comments in your main function code.</p>\n\n<pre><code>int main() {\n\n    //Create base class object and constructor will be called\n    //This object is allocated on heap\n    base* d1 = new base;\n\n    //Create derived class object\n    //first constructor of base and then derived (if defined) will be called \n    //This object is allocated on stack\n    restaurant restaurant;\n\n    //Free memory and Call destructor of base class object\n    delete d1;\n\n    return 0;\n\n    //After bracket, stack object will go out of scope and destructor will be called.\n    //First derived (if defined) class destructor and then base class destructor.\n}\n</code></pre>\n\n<p>To get expected output : <code>*B*B~B</code></p>\n\n<pre><code>restaurant *restaurant = new restaurant;\n</code></pre>\n\n<p>But if you don't delete it then it will create memory leak in your program.</p>\n"}, {"comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1568213820, "post_id": 57891654, "comment_id": 102205114, "body": "Kind of irrelevant to your answer, but why would anyone prefer <code>auto main() -&gt; int </code> over <code>int main()</code> ? This makes no sense to me."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1568214566, "post_id": 57891654, "comment_id": 102205556, "body": "@Yksisarvinen consistency. Sometime you don&#39;t have a choice to use trailing return types. I prefer to use it everywhere and have all my function names aligned as opposed as in some places. Same thing for <code>using</code> vs <code>typedef</code>, etc."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1568214600, "post_id": 57891654, "comment_id": 102205577, "body": "I would really like to have a <code>func</code> keyword to replace the <code>auto</code> at the begining."}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": false, "score": 2, "last_activity_date": 1568213533, "last_edit_date": 1568213533, "creation_date": 1568213061, "answer_id": 57891654, "question_id": 57891274, "link": "https://stackoverflow.com/questions/57891274/how-to-not-delete-a-copy-of-base-class-object/57891654#57891654", "title": "How to not delete a copy of base class object?", "body": "<p>Firstly, objects with automatic storage are automatically deleted a the end of a scope. So declaring <code>restaurant restaurant;</code> will construct a restaurant but will also delete it automatically at the end of the <code>main</code> function.</p>\n\n<p>Try this:</p>\n\n<pre><code>struct A {\n    A() { std::cout &lt;&lt; \"A()\"; }\n    ~A() { std::cout &lt;&lt; \"~A()\"; }\n};\n\nstruct B : A {\n    B() { std::cout &lt;&lt; \"B()\"; }\n    ~B() { std::cout &lt;&lt; \"~B()\"; }\n};\n\nauto main() -&gt; int {\n    B b;\n} // b destroyed here\n</code></pre>\n\n<p><a href=\"https://godbolt.org/z/0xmkpC\" rel=\"nofollow noreferrer\">The output is</a>:</p>\n\n<blockquote>\n<pre><code>A()B()~B()~A()\n</code></pre>\n</blockquote>\n\n<p>It behave like a stack. First, the base class is constructed, then the derived class. Then, it destroy the derived first and the base class at the end.</p>\n\n<p>This behaviour is extremely important for most C++ idiom.</p>\n\n<p>Consider this:</p>\n\n<pre><code>struct A {\n    A() : arr(new int[3]{1, 2, 3}) {}\n    ~A() { delete[] arr; }\n    int* arr = nullptr;\n};\n\nstruct B : A {\n    B() {}\n    ~B() {}\n    auto stuff() -&gt; int {\n        return std::accumulate(arr, arr + 3, 0);\n    }\n};\n\nauto main() -&gt; int {\n    B b;\n    return b.stuff(); // returns 1 + 2 + 3\n}\n</code></pre>\n\n<p>What would happen if the constructor <code>A()</code> was not executed first? The array would be null. That would be bad.</p>\n\n<p>Also... what would happen if the destructor <code>~A()</code> was not executed? That would be a <em>memory leak</em>. That would be super bad.</p>\n\n<p>Constructors and destructors have a guaranteed execution and a well defined order. This is why you don't have to call <code>super()</code> and <code>~super()</code> in all of you constructors and destructor. Because you could forget to call it. Destructor and constructor is not something you want to forget to call, or else there would be no advantages over just using free function like in C.</p>\n"}], "owner": {"reputation": 19, "user_id": 12053467, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BPugbPe6-xQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoLinTRmekiXwJ21tBm-1sKNiegg/photo.jpg?sz=128", "display_name": "Videl Ichinose", "link": "https://stackoverflow.com/users/12053467/videl-ichinose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 57891343, "answer_count": 3, "score": 1, "last_activity_date": 1568214477, "creation_date": 1568211705, "question_id": 57891274, "link": "https://stackoverflow.com/questions/57891274/how-to-not-delete-a-copy-of-base-class-object", "title": "How to not delete a copy of base class object?", "body": "<p>My problem is, that when I'm using inheritance class, my base class is deleting 2 times (the copy from inheritance too). Is there a chance to not make a copy of base class? Or not delete it? </p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\nclass base {\npublic:\n    base() { cout &lt;&lt; \"*B\"; }\n    ~base() { cout &lt;&lt; \"~B\"; }\n};\n\nclass restaurant : virtual public base {};\n\nint main() {\n    base* d1 = new base;\n    restaurant restaurant;\n    delete d1;\n    return 0;\n}\n</code></pre>\n\n<p>The output is <code>*B*B~B~B</code> but I would like to have <code>*B*B~B</code> because I'm not deleting restaurant, only base object.</p>\n"}, {"tags": ["c++", "googletest"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568211929, "post_id": 57891273, "comment_id": 102204009, "body": "There no variable <code>calc</code> visible in scope of the test. Of course you have this error. You do not neet <code>SetUp</code> at all. Simply create an object in <code>TEST</code> function."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568212488, "post_id": 57891273, "comment_id": 102204355, "body": "<code>(b != b) { &#47;&#47; nan check</code>. there exists <a href=\"https://en.cppreference.com/w/cpp/numeric/math/isnan\" rel=\"nofollow noreferrer\"><code>std::isnan</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 1, "last_activity_date": 1568212636, "creation_date": 1568212636, "answer_id": 57891546, "question_id": 57891273, "link": "https://stackoverflow.com/questions/57891273/even-after-macro-substitution-cant-resolve-the-variable/57891546#57891546", "title": "Even after macro substitution can&#39;t resolve the variable", "body": "<p>As you use fixture, you should use macro <code>TEST_F</code> instead of <code>TEST</code>.</p>\n\n<pre><code>class CalculatorTest : public ::testing::Test {\n    Calculator calc;\n};\n\nTEST_F(CalculatorTest, ShouldReturnSum)\n{\n    ASSERT_EQ(72, calc.add(36.0, 36.0));\n}\n\nTEST_F(CalculatorTest, ShouldReturnProduct)\n{\n    ASSERT_EQ(36, calc.multiply(6.0, 6.0));\n}\n</code></pre>\n\n<p>Without fixture, you might simply do:</p>\n\n<pre><code>TEST(CalculatorTest, ShouldReturnSum)\n{\n    Calculator calc;\n    ASSERT_EQ(72, calc.add(36.0, 36.0));\n}\n\nTEST(CalculatorTest, ShouldReturnProduct)\n{\n    Calculator calc;\n    ASSERT_EQ(36, calc.multiply(6.0, 6.0));\n}\n</code></pre>\n"}], "owner": {"reputation": 12459, "user_id": 316082, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a18baaf9417df189af31b53af03adb1c?s=128&d=identicon&r=PG", "display_name": "liv2hak", "link": "https://stackoverflow.com/users/316082/liv2hak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 57891546, "answer_count": 1, "score": 0, "last_activity_date": 1568212636, "creation_date": 1568211703, "question_id": 57891273, "link": "https://stackoverflow.com/questions/57891273/even-after-macro-substitution-cant-resolve-the-variable", "title": "Even after macro substitution can&#39;t resolve the variable", "body": "<p>I am trying to learn gtest. I have my class <code>Calculator</code> that I want to test.</p>\n\n<pre><code>#pragma  once\n\n// whattotest.cpp\n#include &lt;math.h&gt;\n\nclass Calculator{\npublic:\n    double squareRoot(const double a) {\n        double b = sqrt(a);\n        if(b != b) { // nan check\n            return -1.0;\n        }else{\n            return sqrt(a);\n        }\n    }\n\n    double add (const double a, const double b){\n        return (a + b);\n    }\n\n    double multiply(const double a, const double b){\n        return (a * b);\n    }\n};\n</code></pre>\n\n<p>I have the test class code below.</p>\n\n<pre><code>#include \"gtest_example.hpp\"\n#include &lt;gtest/gtest.h&gt;\n\nusing namespace std;\n\n\nclass CalculatorTest : public ::testing::Test {\n\nprotected:\n    virtual void SetUp() {\n        calc = new Calculator();\n    }\n    virtual void TearDown() {\n        delete calc;\n    }\n    Calculator *calc;\n};\n\nTEST(CalculatorTest, ShouldReturnSum) {\n\n    SetUp();\n    ASSERT_EQ(72, calc-&gt;add(36.0, 36.0));\n}\n\nTEST(CalculatorTest, ShouldReturnProduct) {\n    SetUp();\n    ASSERT_EQ(36, calc.multiply(6.0, 6.0));\n}\n\n\nint main(int argc, char **argv) {\n    testing::InitGoogleTest(&amp;argc, argv);\n    return RUN_ALL_TESTS();\n}\n</code></pre>\n\n<p>In both the <code>ASSERT_EQ</code> lines I get the following errors.</p>\n\n<p><code>Even after macro substitution can't resolve the variable calc.</code></p>\n\n<p>What am I doing wrong hee.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1568211739, "post_id": 57891262, "comment_id": 102203893, "body": "This seems highly impractical. What are you trying to accomplish?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568211741, "post_id": 57891262, "comment_id": 102203894, "body": "In order to multiple by floating number, you need to learn how to divide without using division operator. Start with that."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1568211783, "post_id": 57891262, "comment_id": 102203919, "body": "<a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic#Multiplication_and_division\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1568211785, "post_id": 57891262, "comment_id": 102203920, "body": "@Blaze apparently it is an exercise (self-inflicted or given). The question can be answered on it&#39;s face value without the need to ask <i>why</i>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1568211815, "post_id": 57891262, "comment_id": 102203944, "body": "@genpfault has nothing to do with OPs question."}, {"owner": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 1, "creation_date": 1568211903, "post_id": 57891262, "comment_id": 102203999, "body": "You might want to look into bit shifts."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568211937, "post_id": 57891262, "comment_id": 102204015, "body": "@absolutelydevastated Bit shift with floating point values is not as straightforward as bit shift with integer types."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568211939, "post_id": 57891262, "comment_id": 102204018, "body": "@SergeyA that&#39;s right, but sometimes there&#39;s an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a> so it can&#39;t hurt to know what the code is for."}, {"owner": {"reputation": 11, "user_id": 7181915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b921a6154289d2bf389b4baf90c399fb?s=128&d=identicon&r=PG&f=1", "display_name": "K. Cinches", "link": "https://stackoverflow.com/users/7181915/k-cinches"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1568211948, "post_id": 57891262, "comment_id": 102204025, "body": "@SergeyA the second for loop is for Division however it does not work if the Numerator is lesser than the Denominator :(("}, {"owner": {"reputation": 11, "user_id": 7181915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b921a6154289d2bf389b4baf90c399fb?s=128&d=identicon&r=PG&f=1", "display_name": "K. Cinches", "link": "https://stackoverflow.com/users/7181915/k-cinches"}, "reply_to_user": {"reputation": 1326, "user_id": 6092420, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/24e00c77fc8fc5f977da388a142bf9a6?s=128&d=identicon&r=PG&f=1", "display_name": "absolutelydevastated", "link": "https://stackoverflow.com/users/6092420/absolutelydevastated"}, "edited": false, "score": 0, "creation_date": 1568211971, "post_id": 57891262, "comment_id": 102204042, "body": "@absolutelydevastated Okiiiiiii"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568212108, "post_id": 57891262, "comment_id": 102204126, "body": "Division can&#39;t be implemented in a loop like that. It&#39;s not as simple as multiplication. To divide you can subtract the divisor until you get a remainder, but then you need to perform division on that remainder as well."}, {"owner": {"reputation": 11, "user_id": 7181915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b921a6154289d2bf389b4baf90c399fb?s=128&d=identicon&r=PG&f=1", "display_name": "K. Cinches", "link": "https://stackoverflow.com/users/7181915/k-cinches"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568212465, "post_id": 57891262, "comment_id": 102204339, "body": "@Fran&#231;oisAndrieux hmmmmm I think thats what I did without the remainder."}, {"owner": {"reputation": 161, "user_id": 12024888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135be4b74e4e79678ccae82923432a5d?s=128&d=identicon&r=PG&f=1", "display_name": "madnan", "link": "https://stackoverflow.com/users/12024888/madnan"}, "edited": false, "score": 0, "creation_date": 1568221053, "post_id": 57891262, "comment_id": 102208834, "body": "I can suggest a bit naive, if performance is not the key here, solution. You can figure out how much numbers are after decimal in both numbers.For example if you have A= 2.34 and B=0,113, x = 2, and y = 3 (number after decimal points) now just do A* 10^x , B*10^3 and treat them as Integers, after that set the decimal point on right position using x and y information."}], "answers": [{"tags": [], "owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "is_accepted": false, "score": 0, "last_activity_date": 1568220101, "creation_date": 1568220101, "answer_id": 57893525, "question_id": 57891262, "link": "https://stackoverflow.com/questions/57891262/multiplying-and-dividing-two-floating-point-numbers-without-using-and-operat/57893525#57893525", "title": "Multiplying and Dividing two floating point numbers without using * and / operators", "body": "<p>I actually did this back in high school. I wrote a program that could multiply or divide two arbitrarily-long floating point numbers. Basically, I did it the exact same way I would have done it through long multiplication/division.</p>\n\n<p>I kept both values in arrays of decimal digits.</p>\n\n<pre><code>char firstValue[1024];\nchar secondValue[1024];\n</code></pre>\n\n<p>I don't remember if I kept them as ASCII or converted them. It was 40 years ago, after all.</p>\n\n<p>Then I worked it out on paper. Multiply isn't hard, although admittedly I used the * operator to multiply two one-digit values. But you could implement an integerMultiply method.</p>\n\n<p>If you can do it in long hand on paper, you can write an algorithm for it. But it's way too long for an answer here.</p>\n"}, {"tags": [], "owner": {"reputation": 1127, "user_id": 11993121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d6d838d88ef60caa2eefd94e172026c?s=128&d=identicon&r=PG&f=1", "display_name": "nielsen", "link": "https://stackoverflow.com/users/11993121/nielsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1568221295, "last_edit_date": 1568221295, "creation_date": 1568220959, "answer_id": 57893719, "question_id": 57891262, "link": "https://stackoverflow.com/questions/57891262/multiplying-and-dividing-two-floating-point-numbers-without-using-and-operat/57893719#57893719", "title": "Multiplying and Dividing two floating point numbers without using * and / operators", "body": "<p>In the old days (before pocket calculators and the like), logarithm tables were used to turn multiplication and division into a matter of addition and subtraction:</p>\n\n<pre><code>#include &lt;cmath&gt;\n\ndouble Mult(double a, double b)\n{\n  return exp(log(a)+log(b));\n}\ndouble Div(double a, double b)\n{\n  return exp(log(a)-log(b));\n}\n</code></pre>\n\n<p>Note this only works for positive numbers, but it is relatively easy to work with absolute values and then give the result the correct sign.</p>\n"}], "owner": {"reputation": 11, "user_id": 7181915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b921a6154289d2bf389b4baf90c399fb?s=128&d=identicon&r=PG&f=1", "display_name": "K. Cinches", "link": "https://stackoverflow.com/users/7181915/k-cinches"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568221295, "creation_date": 1568211657, "question_id": 57891262, "link": "https://stackoverflow.com/questions/57891262/multiplying-and-dividing-two-floating-point-numbers-without-using-and-operat", "title": "Multiplying and Dividing two floating point numbers without using * and / operators", "body": "<p>I am trying to solve how to multiply and divide two numbers without using * and / operators</p>\n\n<p>I tried using for loops:</p>\n\n<pre><code>for(int a = 1; a&lt;=secondnum; a++)\n            {\n                total = firstnum + total;\n            }\n            cout &lt;&lt; \"Total: \" &lt;&lt; total;\n\n\nfor(b = firstnum; b&gt;=secondnum; b = b-secondnum)\n            {\n                total = total + 1;\n            }\n            cout &lt;&lt; \"Answer: \" &lt;&lt; total;\n</code></pre>\n\n<p>However this only works for integers...Is there a way for this to work on floating point values?</p>\n"}, {"tags": ["c++", "windows", "visual-studio", "qt"], "comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1568211726, "post_id": 57891204, "comment_id": 102203887, "body": "If you build a Windows program with VS2015 or later, you will have to install MSVCP140.dll (name will vary according to your build configurations) on any target system - unless you specifically use an earlier toolset."}, {"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1568211965, "post_id": 57891204, "comment_id": 102204033, "body": "@Adrian how do I install <code>MSVCP140.dll</code> on target systems? Is there a way to include it with the build or statically link it (without also statically linking Qt libraries)? I am using Visual Studio 2019"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1568213975, "post_id": 57891204, "comment_id": 102205216, "body": "You would have to recompile Qt to use a static runtime (which is different than having it link statically). I am not sure that this is possible. My advice is to package the vc_redist with an installer you create for your application. I use NSIS for all my appilcations at work. However this is done mostly for me via using CMake and a few CMake scripts I wrote a decade ago. NSIS does not require CMake so you can do this yourself. There also is WIX and a few other options like the Qt installer framework."}], "answers": [{"comments": [{"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1568212538, "post_id": 57891487, "comment_id": 102204379, "body": "So, the solution is to have an <code>.msi</code> installer install that on the target machine?"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 1, "creation_date": 1568212686, "post_id": 57891487, "comment_id": 102204472, "body": "There are many ways! Building an MSI is one, but it&#39;s not trivial: you have to include the relevant vc_redist.x64.exe (or whatever) in the target dir, then add code to the installer to run that file. Other packages, like <code>WiX</code>, may make it easier. Or you can just tell your end-users they should run the relevant redist from the link given."}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": true, "score": 3, "last_activity_date": 1568213827, "last_edit_date": 1568213827, "creation_date": 1568212438, "answer_id": 57891487, "question_id": 57891204, "link": "https://stackoverflow.com/questions/57891204/statically-link-msvc-libraries-dynamically-link-qt/57891487#57891487", "title": "Statically link MSVC libraries, dynamically link Qt", "body": "<p>In order for a target machine to run software built with Visual Studio, 2015 or later, you will need to install the latest MSVC run-time redistributable pack on it. Some systems (e.g. Windows 10) will already have a recent-enough version.</p>\n\n<p>You can get the latest packs from here: <a href=\"https://support.microsoft.com/en-gb/help/2977003/the-latest-supported-visual-c-downloads\" rel=\"nofollow noreferrer\">vc_redist.XXX.exe</a> depending on the target platform.</p>\n\n<p>Selecting the \"Link Statically\" option only applies to the MFC libraries.</p>\n\n<p>There is an old - but possibly quite helpful - Q &amp; A <a href=\"https://stackoverflow.com/questions/24745438/how-to-install-vs2013-redistributable-along-with-your-app\">here</a> on Stack Overflow.</p>\n"}, {"comments": [{"owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1568288715, "post_id": 57894676, "comment_id": 102231867, "body": "It&#39;d be very nice if you could explain what this script does."}, {"owner": {"reputation": 31, "user_id": 6135671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1296ae506bb605031aed2ed4ab79a8?s=128&d=identicon&r=PG&f=1", "display_name": "Tercete", "link": "https://stackoverflow.com/users/6135671/tercete"}, "reply_to_user": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "edited": false, "score": 0, "creation_date": 1568296712, "post_id": 57894676, "comment_id": 102236580, "body": "Well, this script package all necessary files to distribute with your application... It compact all Qt DLLs needed and Win Redist into a &quot;Setup&quot; .exe file. I config some environment variavles (MSVC_FOLDER, MSVC_RUNTIME, QT_MAJOR_VERSION, QT_MINOR_VERSION, QT_REVISION and  QT_COMPILER.) to made this script functional with all versions of environment/Qt we use here, in the company (5.5.1, 5.8.0 &amp; 5.11) and compilers (Visual Studio 2010, 2013 &amp; 2015)."}], "tags": [], "owner": {"reputation": 31, "user_id": 6135671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1296ae506bb605031aed2ed4ab79a8?s=128&d=identicon&r=PG&f=1", "display_name": "Tercete", "link": "https://stackoverflow.com/users/6135671/tercete"}, "is_accepted": false, "score": 2, "last_activity_date": 1568225559, "creation_date": 1568225559, "answer_id": 57894676, "question_id": 57891204, "link": "https://stackoverflow.com/questions/57891204/statically-link-msvc-libraries-dynamically-link-qt/57894676#57894676", "title": "Statically link MSVC libraries, dynamically link Qt", "body": "<p>As  drescherjm said, the most easy way is to use NSIS...\nA simple script can create a package with all necessary files...</p>\n\n<p>I create environment variables MSVC_FOLDER, QT_MAJOR_VERSION, etc to make this script work with 3 versions of Qt (5.5.1, 5.8 and 5.11) and 3 versions of Visual Studio (2010, 2013 and 2015)...</p>\n\n<p>You can simplify all this...</p>\n\n<p>A Sample script:</p>\n\n<pre><code>; Script generated by the HM NIS Edit Script Wizard.\n\n; HM NIS Edit Wizard helper defines\n!define PRODUCT_NAME \"Define name\"\n!define PRODUCT_VERSION \"0.0.0.0\"\n!define PRODUCT_PUBLISHER \"Define...\"\n!define PRODUCT_WEB_SITE \"http://www.define.com.br\"\n!define PRODUCT_DIR_REGKEY \"Software\\YourCompany\\${PRODUCT_NAME}\"\n!define PRODUCT_UNINST_KEY \"Software\\YourCompany\\Uninstall\\${PRODUCT_NAME}\"\n!define PRODUCT_UNINST_ROOT_KEY \"HKLM\"\n\n; MUI 1.67 compatible ------\n!include \"MUI.nsh\"\n\n; MUI Settings\n!define MUI_ABORTWARNING\n!define MUI_ICON \"${NSISDIR}\\Contrib\\Graphics\\Icons\\modern-install.ico\"\n!define MUI_UNICON \"${NSISDIR}\\Contrib\\Graphics\\Icons\\modern-uninstall.ico\"\n\n; Welcome page\n!insertmacro MUI_PAGE_WELCOME\n; Directory page\n!insertmacro MUI_PAGE_DIRECTORY\n; Instfiles page\n!insertmacro MUI_PAGE_INSTFILES\n; Finish page\n!define MUI_FINISHPAGE_RUN \"$INSTDIR\\YourSistem.exe\"\n!insertmacro MUI_PAGE_FINISH\n\n; Uninstaller pages\n!insertmacro MUI_UNPAGE_INSTFILES\n\n; Language files\n!insertmacro MUI_LANGUAGE \"PortugueseBR\"\n\n; MUI end ------\n\nName \"${PRODUCT_NAME} ${PRODUCT_VERSION}\"\nOutFile \"\\Desenvol\\Instaladores\\${PRODUCT_NAME}\\${PRODUCT_NAME}Setup.exe\"\nInstallDir \"C:\\${PRODUCT_NAME}\"\nInstallDirRegKey HKLM \"${PRODUCT_DIR_REGKEY}\" \"\"\nShowInstDetails show\nShowUnInstDetails show\n\nSection \"Se\u00e7\u00e3oPrincipal\" SEC01\n\n  !if /FileExists \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\${PRODUCT_NAME}.exe\"\n    !cd \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\\"\n    !system '\"C:\\Program Files (x86)\\$%MSVC_FOLDER%\\VC\\bin\\nmake.exe\" /f Makefile clean '\n\n    !cd \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\\"\n    !system '\"C:\\Qt\\Qt$%QT_MAJOR_VERSION%.$%QT_MINOR_VERSION%.$%QT_REVISION%\\$%QT_MAJOR_VERSION%.$%QT_MINOR_VERSION%\\$%QT_COMPILER%\\bin\\windeployqt.exe\" --qmldir ..\\..\\YourSistem\\ . -release --no-qmltooling '\n    !system 'rmdir /s /q private '\n    !system 'rmdir /s /q QtGraphicalEffects '\n    !system 'mkdir \\Desenvol\\Instaladores\\${PRODUCT_NAME} '\n  !endif\n\n  !cd \"${SCRIPT_FOLDER}\"\n\n  SetOutPath \"$SYSDIR\"\n  File /nonfatal \"C:\\Program Files (x86)\\$%MSVC_FOLDER%\\VC\\redist\\x86\\Microsoft.VC$%MSVC_RUNTIME%.CRT\\msvcp$%MSVC_RUNTIME%.dll\"\n  File /nonfatal \"C:\\Program Files (x86)\\$%MSVC_FOLDER%\\VC\\redist\\x86\\Microsoft.VC$%MSVC_RUNTIME%.CRT\\msvcr$%MSVC_RUNTIME%.dll\"\n  SetOutPath \"$INSTDIR\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\D3Dcompiler_43.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Core.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Gui.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Qml.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Quick.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Network.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5PrintSupport.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Sql.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Svg.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\Qt5Widgets.dll\"\n\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\libEGL.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\libGLESV2.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\opengl32sw.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\${PRODUCT_NAME}.exe\"\n  File /nonfatal \"\\Desenvol\\CPP\\${SCRIPT_FOLDER}\\*.ini\"\n  File /nonfatal \"\\Desenvol\\CPP\\${SCRIPT_FOLDER}\\*.rwf\"\n\n  SetOutPath \"$INSTDIR\\QtQml\\Models.2\"\n  File /nonfatal /r \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\QtQml\\Models.2\\*.*\"\n\n  SetOutPath \"$INSTDIR\\QtQuick\"\n  File /nonfatal /r \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\QtQuick\\*.*\"\n\n  SetOutPath \"$INSTDIR\\QtQuick.2\"\n  File /nonfatal /r \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\QtQuick.2\\*.*\"\n\n  SetOutPath \"$INSTDIR\\iconengines\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\iconengines\\qsvgicon.dll\"\n\n  SetOutPath \"$INSTDIR\\imageformats\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qdds.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qgif.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qicns.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qico.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qjp2.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qjpeg.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qmng.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qsvg.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qtga.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qtiff.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qwbmp.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\imageformats\\qwebp.dll\"\n\n  SetOutPath \"$INSTDIR\\platforms\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\platforms\\qwindows.dll\"\n\n  SetOutPath \"$INSTDIR\\printsupport\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\printsupport\\windowsprintersupport.dll\"\n\n  SetOutPath \"$INSTDIR\\Databases\"\n  File /nonfatal \"\\Desenvol\\CPP\\${PRODUCT_NAME}\\Databases\\${PRODUCT_NAME}.db\"\n\n  SetOutPath \"$INSTDIR\\sqldrivers\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\sqldrivers\\qsqlite.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\sqldrivers\\qsqlmysql.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\sqldrivers\\qsqlodbc.dll\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\sqldrivers\\qsqlpsql.dll\"\n\n  SetOutPath \"$INSTDIR\\translations\"\n  File /nonfatal \"\\Desenvol\\CPP\\${PRODUCT_NAME}\\*.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_ca.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_cs.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_de.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_en.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_fi.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_fr.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_he.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_hu.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_it.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_ja.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_ko.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_lv.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_ru.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_sk.qm\"\n  File /nonfatal \"\\Desenvol\\CPP\\build-${PRODUCT_NAME}-Desktop_Qt_$%QT_MAJOR_VERSION%_$%QT_MINOR_VERSION%_$%QT_REVISION%_$%QT_COMPILER%_32bit-Release\\release\\translations\\qt_uk.qm\"\n\ngone:\n\nSectionEnd\n\nSection -AdditionalIcons\n  SetOutPath $INSTDIR\n  WriteIniStr \"$INSTDIR\\${PRODUCT_NAME}.url\" \"InternetShortcut\" \"URL\" \"${PRODUCT_WEB_SITE}\"\n\n  SetOutPath \"$SMPROGRAMS\\${PRODUCT_NAME}\"\n  CreateShortCut \"$SMPROGRAMS\\${PRODUCT_NAME}\\Website.lnk\" \"$INSTDIR\\${PRODUCT_NAME}.url\"\n  CreateShortCut \"$SMPROGRAMS\\${PRODUCT_NAME}\\Uninstall.lnk\" \"$INSTDIR\\uninst.exe\"\n  CreateShortcut \"$SMPROGRAMS\\${PRODUCT_NAME}\\${PRODUCT_NAME}.lnk\" \"$INSTDIR\\${PRODUCT_NAME}.exe\"\n\n  CreateShortcut \"$DESKTOP\\${PRODUCT_NAME}.lnk\" \"$INSTDIR\\${PRODUCT_NAME}.exe\"\n\nSectionEnd\n\nSection -Post\n  WriteUninstaller \"$INSTDIR\\uninst.exe\"\n  WriteRegStr HKLM \"${PRODUCT_DIR_REGKEY}\" \"\" \"$INSTDIR\\${PRODUCT_NAME}.exe\"\n  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\" \"DisplayName\" \"$(^Name)\"\n  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\" \"UninstallString\" \"$INSTDIR\\uninst.exe\"\n  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\" \"DisplayIcon\" \"$INSTDIR\\AppMainExe.exe\"\n  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\" \"DisplayVersion\" \"${PRODUCT_VERSION}\"\n  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\" \"URLInfoAbout\" \"${PRODUCT_WEB_SITE}\"\n  WriteRegStr ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\" \"Publisher\" \"${PRODUCT_PUBLISHER}\"\nSectionEnd\n\n\nFunction un.onUninstSuccess\n  HideWindow\n  MessageBox MB_ICONINFORMATION|MB_OK \"$(^Name) foi removido com sucesso do seu computador.\"\nFunctionEnd\n\nFunction un.onInit\n  MessageBox MB_ICONQUESTION|MB_YESNO|MB_DEFBUTTON2 \"Tem certeza que quer remover completamente $(^Name) e todos os seus componentes?\" IDYES +2\n  Abort\nFunctionEnd\n\nFunction .onInit\n    System::Call 'kernel32::CreateMutex(p 0, i 0, t \"myMutex\") p .r1 ?e'\n     Pop $R0\n\n     StrCmp $R0 0 +3\n       MessageBox MB_OK|MB_ICONEXCLAMATION \"O instalador j\u00e1 est\u00e1 em execu\u00e7\u00e3o.\"\n       Abort\nFunctionEnd\n\nSection Uninstall\n  Delete \"$INSTDIR\\${PRODUCT_NAME}.url\"\n  Delete \"$INSTDIR\\uninst.exe\"\n  Delete \"$INSTDIR\\translations\\qt_uk.qm\"\n  Delete \"$INSTDIR\\translations\\qt_sk.qm\"\n  Delete \"$INSTDIR\\translations\\qt_ru.qm\"\n  Delete \"$INSTDIR\\translations\\qt_lv.qm\"\n  Delete \"$INSTDIR\\translations\\qt_ko.qm\"\n  Delete \"$INSTDIR\\translations\\qt_ja.qm\"\n  Delete \"$INSTDIR\\translations\\qt_it.qm\"\n  Delete \"$INSTDIR\\translations\\qt_hu.qm\"\n  Delete \"$INSTDIR\\translations\\qt_he.qm\"\n  Delete \"$INSTDIR\\translations\\qt_fr.qm\"\n  Delete \"$INSTDIR\\translations\\qt_fi.qm\"\n  Delete \"$INSTDIR\\translations\\qt_en.qm\"\n  Delete \"$INSTDIR\\translations\\qt_de.qm\"\n  Delete \"$INSTDIR\\translations\\qt_cs.qm\"\n  Delete \"$INSTDIR\\translations\\qt_ca.qm\"\n  Delete \"$INSTDIR\\sqldrivers\\qsqlpsql.dll\"\n  Delete \"$INSTDIR\\sqldrivers\\qsqlodbc.dll\"\n  Delete \"$INSTDIR\\sqldrivers\\qsqlmysql.dll\"\n  Delete \"$INSTDIR\\sqldrivers\\qsqlite.dll\"\n  Delete \"$INSTDIR\\Qt5Widgets.dll\"\n  Delete \"$INSTDIR\\Qt5Svg.dll\"\n  Delete \"$INSTDIR\\Qt5Sql.dll\"\n  Delete \"$INSTDIR\\Qt5PrintSupport.dll\"\n  Delete \"$INSTDIR\\Qt5Network.dll\"\n  Delete \"$INSTDIR\\Qt5Gui.dll\"\n  Delete \"$INSTDIR\\Qt5Core.dll\"\n  Delete \"$INSTDIR\\Qt5Qml.dll\"\n  Delete \"$INSTDIR\\Qt5Quick.dll\"\n  Delete \"$INSTDIR\\opengl32sw.dll\"\n  Delete \"$INSTDIR\\libGLESV2.dll\"\n  Delete \"$INSTDIR\\libEGL.dll\"\n  Delete \"$INSTDIR\\printsupport\\windowsprintersupport.dll\"\n  Delete \"$INSTDIR\\platforms\\qwindows.dll\"\n  Delete \"$INSTDIR\\imageformats\\qwebp.dll\"\n  Delete \"$INSTDIR\\imageformats\\qwbmp.dll\"\n  Delete \"$INSTDIR\\imageformats\\qtiff.dll\"\n  Delete \"$INSTDIR\\imageformats\\qtga.dll\"\n  Delete \"$INSTDIR\\imageformats\\qsvg.dll\"\n  Delete \"$INSTDIR\\imageformats\\qmng.dll\"\n  Delete \"$INSTDIR\\imageformats\\qjpeg.dll\"\n  Delete \"$INSTDIR\\imageformats\\qjp2.dll\"\n  Delete \"$INSTDIR\\imageformats\\qico.dll\"\n  Delete \"$INSTDIR\\imageformats\\qicns.dll\"\n  Delete \"$INSTDIR\\imageformats\\qgif.dll\"\n  Delete \"$INSTDIR\\imageformats\\qdds.dll\"\n  Delete \"$INSTDIR\\iconengines\\qsvgicon.dll\"\n  Delete \"$INSTDIR\\Databases\\SisMega.db\"\n  Delete \"$INSTDIR\\D3Dcompiler_43.dll\"\n  Delete \"$INSTDIR\\bearer\\qnativewifibearer.dll\"\n  Delete \"$INSTDIR\\bearer\\qgenericbearer.dll\"\n\n  Delete \"$INSTDIR\\*.ini\"\n  Delete \"$INSTDIR\\*.log\"\n  Delete \"$INSTDIR\\*.rwf\"\n  Delete \"$INSTDIR\\*.html*\"\n  Delete \"$INSTDIR\\*.map\"\n  Delete \"$INSTDIR\\*.tsk\"\n  Delete \"$INSTDIR\\${PRODUCT_NAME}.exe\"\n\n  Delete \"$SMPROGRAMS\\${PRODUCT_NAME}\\Uninstall.lnk\"\n  Delete \"$SMPROGRAMS\\${PRODUCT_NAME}\\Website.lnk\"\n  Delete \"$DESKTOP\\${PRODUCT_NAME}.lnk\"\n  Delete \"$SMPROGRAMS\\${PRODUCT_NAME}\\${PRODUCT_NAME}.lnk\"\n\n  RMDir \"$SMPROGRAMS\\${PRODUCT_NAME}\"\n  RMDir /r \"$INSTDIR\\translations\"\n  RMDir /r \"$INSTDIR\\sqldrivers\"\n  RMDir /r \"$INSTDIR\\printsupport\"\n  RMDir /r \"$INSTDIR\\platforms\"\n  RMDir /r \"$INSTDIR\\imageformats\"\n  RMDir /r \"$INSTDIR\\iconengines\"\n  RMDir /r \"$INSTDIR\\Databases\"\n  RMDir /r \"$INSTDIR\\bearer\"\n  RMDir /r \"$INSTDIR\\QtQml\"\n  RMDir /r \"$INSTDIR\\QtQuick\"\n  RMDir /r \"$INSTDIR\\QtQuick.2\"\n  RMDir \"$INSTDIR\"\n\n  DeleteRegKey ${PRODUCT_UNINST_ROOT_KEY} \"${PRODUCT_UNINST_KEY}\"\n  DeleteRegKey HKLM \"${PRODUCT_DIR_REGKEY}\"\n  SetAutoClose true\nSectionEnd\n</code></pre>\n"}], "owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 57891487, "answer_count": 2, "score": 1, "last_activity_date": 1568225559, "creation_date": 1568211491, "last_edit_date": 1568211772, "question_id": 57891204, "link": "https://stackoverflow.com/questions/57891204/statically-link-msvc-libraries-dynamically-link-qt", "title": "Statically link MSVC libraries, dynamically link Qt", "body": "<p>I was deploying something I built with Qt, and it was dynamically linked because of LGPL. I used <code>windeployqt.exe</code> to collect necessary dlls, and it was working fine on Windows 10 machines. When I tried on a Windows 7 machine, I got this error: </p>\n\n<blockquote>\n  <p>The program can't start because MSVCP140.dll is missing from your computer.</p>\n</blockquote>\n\n<p>After a little research, it turns out that <code>MSVCP140.dll</code> is a dll in <code>System 32</code> that Visual Studio installs. I should either have my clients install Visual Studio, which is not an option in my case, or statically link it. I tried using <code>/MT</code> but I got:</p>\n\n<blockquote>\n  <p>Overriding /MT with /MD</p>\n</blockquote>\n\n<p>Presumably because I can't statically link Qt libraries without compiling Qt itself statically. \nWhat I want to do is dynamically link Qt libraries, because of LGPL, and statically link MSVC libraries. Is there a way to do that? Preferably from the Qt creator.<br>\nI think including <code>MSVCP140.dll</code> with the program is not an option.  </p>\n\n<p>I am using Visual Studio 2019 and Qt 13.1</p>\n"}, {"tags": ["c++", "grpc"], "comments": [{"owner": {"reputation": 509, "user_id": 4712732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mRmpFlGCpAA/AAAAAAAAAAI/AAAAAAAAAAA/BJwf219F3gc/photo.jpg?sz=128", "display_name": "Simoyd", "link": "https://stackoverflow.com/users/4712732/simoyd"}, "edited": false, "score": 0, "creation_date": 1568309768, "post_id": 57891055, "comment_id": 102243166, "body": "you can also <code>export GRPC_VERBOSITY=DEBUG</code> and <code>export GRPC_TRACE=list_tracers</code> (replace export with set for windows) to see the infinite list (much like the logging in the question) without any grpc code changes.  I&#39;m using a 32-bit version on a 32-bit centos vm"}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 5523159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3945af9c4cc435e5be4eaf548a55cf?s=128&d=identicon&r=PG&f=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5523159/yang"}, "is_accepted": false, "score": 0, "last_activity_date": 1573768047, "creation_date": 1573768047, "answer_id": 58867029, "question_id": 57891055, "link": "https://stackoverflow.com/questions/57891055/method-traceflaglistaddtraceflag-flag-of-grpc-trace-cc-makes-its-chained-li/58867029#58867029", "title": "Method TraceFlagList::Add(TraceFlag* flag) of gRPC trace.cc makes its chained list loop to itself", "body": "<p>This looks like <a href=\"https://github.com/grpc/grpc/issues/20690\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc/issues/20690</a>\ngrpc core uses some globals and if you have multiple version of the grpc library linked in somehow, the globals get corrupted.</p>\n"}], "owner": {"reputation": 137, "user_id": 796054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c550e029aa38de55be6de78a30195e?s=128&d=identicon&r=PG", "display_name": "pamplemousse_mk2", "link": "https://stackoverflow.com/users/796054/pamplemousse-mk2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573768047, "creation_date": 1568211037, "question_id": 57891055, "link": "https://stackoverflow.com/questions/57891055/method-traceflaglistaddtraceflag-flag-of-grpc-trace-cc-makes-its-chained-li", "title": "Method TraceFlagList::Add(TraceFlag* flag) of gRPC trace.cc makes its chained list loop to itself", "body": "<p>I am integrating gRPC for a 32-bit Atom hardware. gRPC is cross-compiled on a 64-bit Ubuntu PC computer. The cross-compilation uses Yocto. The CMakeLists.txt file of gRPC is included into the main project with add_subdirectory() function, and linked in static. To test gRPC, I use the C++ speech sample code of Google. </p>\n\n<p>The complete project builds correctly and is deployed on the target hardware without problem. When I run the sample program, the execution is stucked in an infinite loop in the method TraceFlagList::Set(const char* name, bool enabled) of the file trace.cc. </p>\n\n<p>To check the problem, I put some printf() in this method, in every loop: </p>\n\n<pre><code>bool TraceFlagList::Set(const char* name, bool enabled) {\n  TraceFlag* t;\n  if (0 == strcmp(name, \"all\")) {\n    for (t = root_tracer_; t; t = t-&gt;next_tracer_) {\n      printf(\"%s 1 %s\\n\", __func__, t-&gt;name_);\n      t-&gt;set_enabled(enabled);\n    }\n  } else if (0 == strcmp(name, \"list_tracers\")) {\n    LogAllTracers();\n  } else if (0 == strcmp(name, \"refcount\")) {\n    for (t = root_tracer_; t; t = t-&gt;next_tracer_) {\n      printf(\"%s 2 %s\\n\", __func__, t-&gt;name_);\n      if (strstr(t-&gt;name_, \"refcount\") != nullptr) {\n        t-&gt;set_enabled(enabled);\n      }\n    }\n  } else {\n    bool found = false;\n    for (t = root_tracer_; t; t = t-&gt;next_tracer_) {\n      printf(\"%s 3 %s\\n\", __func__, t-&gt;name_);\n      if (0 == strcmp(name, t-&gt;name_)) {\n        t-&gt;set_enabled(enabled);\n        found = true;\n      }\n    }\n    // check for unknowns, but ignore \"\", to allow to GRPC_TRACE=\n    if (!found &amp;&amp; 0 != strcmp(name, \"\")) {\n      gpr_log(GPR_ERROR, \"Unknown trace var: '%s'\", name);\n      return false; /* early return */\n    }\n  }\n  return true;\n}\n</code></pre>\n\n<p>It appears that some TraceFlag pointers are added several times in the TraceFlagList object. Here is the add method:</p>\n\n<pre><code>void TraceFlagList::Add(TraceFlag* flag) {\n  flag-&gt;next_tracer_ = root_tracer_;\n  root_tracer_ = flag;\n}\n\n</code></pre>\n\n<p>The first element to add has its next_tracer_ member pointing to null. But after several adding, TraceFlagList::Add() is called again with the same TraceFlag pointers. The first one will have its next_tracer_ member pointing to the last element of list, making the list loop onto itself. </p>\n\n<p>Running the executable displays these lines in the command line: </p>\n\n<pre><code>...\nSet 3 api\nSet 3 timer_check\nSet 3 timer\nSet 3 resource_quota\nSet 3 executor\nSet 3 bdp_estimator\nSet 3 client_idle_filter\nSet 3 cares_resolver\nSet 3 cares_address_sorting\nSet 3 round_robin\nSet 3 pick_first\nSet 3 xds\nSet 3 glb\nSet 3 inproc\nSet 3 health_check_client\nSet 3 secure_endpoint\nSet 3 http2_stream_state\nSet 3 flowctl\nSet 3 http\nSet 3 connectivity_state\nSet 3 tcp\nSet 3 http1\nSet 3 handshaker\nSet 3 channel\nSet 3 subchannel_pool\nSet 3 subchannel\nSet 3 client_channel_routing\nSet 3 client_channel_call\nSet 3 tsi\nSet 3 plugin_credentials\nSet 3 server_channel\nSet 3 queue_pluck\nSet 3 op_failure\nSet 3 compression\nSet 3 call_error\nSet 3 api\nSet 3 timer_check\nSet 3 timer\nSet 3 resource_quota\nSet 3 executor\nSet 3 bdp_estimator\nSet 3 client_idle_filter\nSet 3 cares_resolver\nSet 3 cares_address_sorting\n^C\n</code></pre>\n\n<p>I have to break the executable with ctrl+c to stop it. I made a workaround by checking first the existence of the element to add in the list: </p>\n\n<pre><code>void TraceFlagList::Add(TraceFlag* flag) {\n  // Check TraceFlag existence in the list before adding it.\n  for (const TraceFlag* t = root_tracer_; t != nullptr; t = t-&gt;next_tracer_) {\n    if (t == flag) {\n      gpr_log(GPR_DEBUG, \"\\t%s\", t-&gt;name_);\n      printf(\"TraceFlag %s already in TraceFlagList. Ignore.\\n\", t-&gt;name_);\n      return;\n    }\n  }\n\n  flag-&gt;next_tracer_ = root_tracer_;\n  root_tracer_ = flag;\n}\n</code></pre>\n\n<p>But this is a workaround: when building and running the original code for the Ubuntu host, there is no problem of infinite loop. Each TraceFlag pointer is added only once. And I don't really know what TraceFlag are used for in gRPC. </p>\n\n<p>I am afraid that the workaround could hides the real problem, which could have unexpected side effects. Does anybody have any clue to the origin of this problem ? Or should I propose this workaround the gRPC project ? </p>\n\n<p>Regards.</p>\n"}, {"tags": ["c++", "parallel-processing", "thread-safety", "tbb"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 3, "creation_date": 1568210811, "post_id": 57890946, "comment_id": 102203394, "body": "<code>std::vector&lt;bool&gt;</code> is not thread-safe (yes, it&#39;s a regrettable design decision to have <code>std::vector&lt;bool&gt;</code> perform space optimization at the cost of breaking the normal <code>std::vector</code> interface/guarantees). Let me see if there&#39;s a good dupe."}, {"owner": {"reputation": 113, "user_id": 2187446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/77d61105129cabcbc57f9c4bebab755c?s=128&d=identicon&r=PG", "display_name": "steve", "link": "https://stackoverflow.com/users/2187446/steve"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1568212281, "post_id": 57890946, "comment_id": 102204227, "body": "Oh dear, thanks a lot for the quick answer! And I just keep looking for almost two days in the wrong direction. Never questioned <code>std::vector&lt;bool&gt;</code> to be the problem..."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1568213567, "post_id": 57890946, "comment_id": 102204976, "body": "Yeah, you&#39;re not the first and won&#39;t be the last to fall victim to this. It&#39;s long been recognized as a serious mistake but can&#39;t really be changed anymore, that ship has sailed. Sadly."}], "owner": {"reputation": 113, "user_id": 2187446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/77d61105129cabcbc57f9c4bebab755c?s=128&d=identicon&r=PG", "display_name": "steve", "link": "https://stackoverflow.com/users/2187446/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1568210958, "answer_count": 0, "score": 1, "last_activity_date": 1568210701, "creation_date": 1568210701, "question_id": 57890946, "link": "https://stackoverflow.com/questions/57890946/c-function-thread-safety-issue-using-parallelstl-tbb", "closed_reason": "Duplicate", "title": "c++ function thread safety issue using parallelstl + tbb", "body": "<p>my question is: why is this code not thread safe?</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"pstl/algorithm\"\n#include \"pstl/execution\"\n\n#include &lt;iostream&gt;\n#include &lt;random&gt;\n#include &lt;vector&gt;\n\nstruct SomeData {\n  double x;\n  double x_max;\n};\n\nstd::vector&lt;SomeData&gt; generateSample() {\n  std::vector&lt;SomeData&gt; data;\n  std::mt19937 rand(1234);\n  std::uniform_real_distribution&lt;double&gt; uniform(0.0, 1.0);\n  for (unsigned int i = 0; i &lt; 1000; ++i) {\n    data.push_back({uniform(rand), 0.5});\n  }\n  return data;\n}\n\nint main() {\n  auto sample = generateSample();\n  for (size_t i = 0; i &lt; 20; ++i) {\n    std::vector&lt;bool&gt; result(sample.size());\n    std::transform(pstl::execution::par, sample.begin(), sample.end(),\n                   result.begin(), [](const SomeData &amp;d) {\n                     if (d.x &gt; d.x_max) {\n                       return true;\n                     }\n                     return false;\n                   });\n    size_t above_max(0);\n    for (auto x : result) {\n      if (x)\n        ++above_max;\n    }\n    std::cout &lt;&lt; \"above max: \" &lt;&lt; above_max &lt;&lt; \"\\n\";\n  }\n}\n</code></pre>\n\n<p>If you run this with <code>pstl::execution::par</code>, it will give different results. If you run it with <code>::seq</code> or <code>::unseq</code>, the results are the same.</p>\n\n<p>I'm totally puzzled to why this is not thread safe, since the function just processes independent objects and gives back some value.</p>\n"}, {"tags": ["c++", "boost"], "answers": [{"comments": [{"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 0, "creation_date": 1568211561, "post_id": 57890891, "comment_id": 102203793, "body": "Note that such checks are inherently racy: If a different process creates the file after your check has ran, but before the copy operation completes, you still run into the error. So your code still needs to account for that situation, even though you checked it before."}, {"owner": {"reputation": 9, "user_id": 12053009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d7e9c2f46b6fef8b34b9def8a0be52?s=128&d=identicon&r=PG&f=1", "display_name": "nexi", "link": "https://stackoverflow.com/users/12053009/nexi"}, "reply_to_user": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 0, "creation_date": 1568215464, "post_id": 57890891, "comment_id": 102206045, "body": "Thanks for the reminder, I didn&#39;t even consider multithreading in this one."}], "tags": [], "owner": {"reputation": 9, "user_id": 12053009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33d7e9c2f46b6fef8b34b9def8a0be52?s=128&d=identicon&r=PG&f=1", "display_name": "nexi", "link": "https://stackoverflow.com/users/12053009/nexi"}, "is_accepted": false, "score": 0, "last_activity_date": 1568211234, "last_edit_date": 1568211234, "creation_date": 1568210524, "answer_id": 57890891, "question_id": 57890796, "link": "https://stackoverflow.com/questions/57890796/trouble-understanding-boost-copy-file-file-exists-error-message/57890891#57890891", "title": "Trouble understanding boost copy_file &quot;File exists&quot; error message", "body": "<p>The boost documentation <a href=\"https://www.boost.org/doc/libs/1_69_0/libs/filesystem/doc/reference.html\" rel=\"nofollow noreferrer\">Here</a> says the following:</p>\n\n<pre><code>void         copy_file(const path&amp; from, const path&amp; to);\nvoid         copy_file(const path&amp; from, const path&amp; to,\n                   system::error_code&amp; ec);\nvoid         copy_file(const path&amp; from, const path&amp; to,\n                   copy_option option);\nvoid         copy_file(const path&amp; from, const path&amp; to,\n                   copy_option option, system::error_code&amp; ec);\n</code></pre>\n\n<p>Also, you can check if a file exists using:</p>\n\n<pre><code>if ( !boost::filesystem::exists( \"myfile.txt\" ) )\n{\n  std::cout &lt;&lt; \"Can't find my file!\" &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 679, "user_id": 8857999, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bf4266c9703ec15deb11045cc0015ef2?s=128&d=identicon&r=PG", "display_name": "Eldy", "link": "https://stackoverflow.com/users/8857999/eldy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568211234, "creation_date": 1568210200, "question_id": 57890796, "link": "https://stackoverflow.com/questions/57890796/trouble-understanding-boost-copy-file-file-exists-error-message", "title": "Trouble understanding boost copy_file &quot;File exists&quot; error message", "body": "<p>I am investigating an issue in my program where the following error message appears:</p>\n\n<pre><code>boost::fs: boost::filesystem::copy_file: File exists: \"path/to/file1\", \"path/to/file2\" path1=\"path/to/file1\" path2=\"path/to/file2\"\n</code></pre>\n\n<p>I guess the issue is that some file already exists and that overwriting it is impossible, but I am not sure which file exactly.</p>\n\n<p>Is it <code>file1</code> that can't be copied to <code>path/to/file2</code> or the opposite? Or something else entirely?</p>\n"}, {"tags": ["c#", "c++", "exception", "swig"], "comments": [{"owner": {"reputation": 514, "user_id": 2360192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb5981cc0a6c0788da6a51139f5b59a7?s=128&d=identicon&r=PG", "display_name": "CarCar", "link": "https://stackoverflow.com/users/2360192/carcar"}, "edited": false, "score": 0, "creation_date": 1568212863, "post_id": 57890730, "comment_id": 102204580, "body": "Are you able to catch it with  &quot;catch (Exception exception)&quot; ?"}, {"owner": {"reputation": 57, "user_id": 6903474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrzuG.jpg?s=128&g=1", "display_name": "Whatever", "link": "https://stackoverflow.com/users/6903474/whatever"}, "reply_to_user": {"reputation": 514, "user_id": 2360192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb5981cc0a6c0788da6a51139f5b59a7?s=128&d=identicon&r=PG", "display_name": "CarCar", "link": "https://stackoverflow.com/users/2360192/carcar"}, "edited": false, "score": 0, "creation_date": 1568270691, "post_id": 57890730, "comment_id": 102222607, "body": "No, of course I tested that first."}, {"owner": {"reputation": 514, "user_id": 2360192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb5981cc0a6c0788da6a51139f5b59a7?s=128&d=identicon&r=PG", "display_name": "CarCar", "link": "https://stackoverflow.com/users/2360192/carcar"}, "edited": false, "score": 1, "creation_date": 1568321837, "post_id": 57890730, "comment_id": 102247640, "body": "(arg1)-&gt;frame(); &lt;------------- what is this frame function? What is the namespace of ViewerBase in the C++ code? do you have access to the code? My guess is its a built in function. What may be happening is that function launches whatever it does on a separate thread which is a different stack. You can&#39;t catch the exception in your catch block if that is the case."}, {"owner": {"reputation": 57, "user_id": 6903474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrzuG.jpg?s=128&g=1", "display_name": "Whatever", "link": "https://stackoverflow.com/users/6903474/whatever"}, "reply_to_user": {"reputation": 514, "user_id": 2360192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb5981cc0a6c0788da6a51139f5b59a7?s=128&d=identicon&r=PG", "display_name": "CarCar", "link": "https://stackoverflow.com/users/2360192/carcar"}, "edited": false, "score": 0, "creation_date": 1568361666, "post_id": 57890730, "comment_id": 102257016, "body": "Thanks for your effort @CarCar, but I think I have found a solution for my problem. It  is not actually fixing the problem I am describing here, but I have found the reason why the &quot;frame()&quot; function crashes and I am preventing the error. I could explain you what frame does, but there is no need to do so anymore. In short: It is part of some 3D rendering for a 3D viewer based on Open Scene Graph, the Problem was that frame() functions requires at least OpenGL version 4.2, so I am simply checking the version, before I run it."}], "owner": {"reputation": 57, "user_id": 6903474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrzuG.jpg?s=128&g=1", "display_name": "Whatever", "link": "https://stackoverflow.com/users/6903474/whatever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568210015, "creation_date": 1568210015, "question_id": 57890730, "link": "https://stackoverflow.com/questions/57890730/how-to-catch-an-accessviolationexception-in-c-from-a-c-dll-which-is-wrapped-i", "title": "How to catch an AccessViolationException in C# from a C++ dll which is wrapped in a C# dll using SWIG", "body": "<p>I am using a function from an auto generated C# dll in my C# code. The auto generated C# dll is a wrapper for a C++ dll, I think the code is mostly auto generated with SWIG, but I don't know more about it. I think it basically just wraps the C++ functions using PINVOKE (but I am not sure how the SWIG stuff works). \nThe problem is that I can not catch an exception, when it occurs in the C++ dll. In my Case the <code>frame()</code> method throws an <code>AccessViolationException</code>, but I can not catch it with a try catch block. Does SWIG provides some sort of exception handling for C#? I just want to prevent my application crash.</p>\n\n<p>The function from the wrapper dll (C#):</p>\n\n<pre><code>public virtual void frame() {\n    osgViewerPINVOKE.ViewerBase_frame(swigCPtr);\n  }\n</code></pre>\n\n<p>The C++ Code:</p>\n\n<pre><code> SWIGEXPORT void SWIGSTDCALL CSharp_ViewerBase_frame(void * jarg1) {\n osgViewer::ViewerBase *arg1 = (osgViewer::ViewerBase *) 0 ;\n\n      arg1 = (osgViewer::ViewerBase *)jarg1; \n      (arg1)-&gt;frame();\n    }\n</code></pre>\n\n<p>My C# code, where I want to catch exceptions:</p>\n\n<pre><code>try\n{\n    this.viewer.frame();\n}\ncatch (AccessViolationException exception)\n{\n    Console.WriteLine(exception);\n}\n</code></pre>\n\n<p>I have read this article from SWIG: <a href=\"http://www.swig.org/Doc1.3/CSharp.html#csharp_exceptions\" rel=\"nofollow noreferrer\">http://www.swig.org/Doc1.3/CSharp.html#csharp_exceptions</a>\nBut I do not understand much of it. Do I need to edit the C++ dll? Because this is no option for me. I could only modify the wrapper class, but I would prefer not to do so.</p>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1568212704, "post_id": 57890725, "comment_id": 102204480, "body": "Please note that with in the current form, I can only give a general answer to your question. If your issue persists and you need a specific answer, please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - ideally without QT."}, {"owner": {"reputation": 33, "user_id": 6099399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cdec707b93f10102d91592f790f1d9?s=128&d=identicon&r=PG&f=1", "display_name": "lopippo", "link": "https://stackoverflow.com/users/6099399/lopippo"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1568214046, "post_id": 57890725, "comment_id": 102205264, "body": "Thank you, Zulan, for your answer. I have edited the question because I discovered after some digging that there was a programming error in it. However, I still do not know if it is possible to modify the state of an object (used in the parallel section) from outside of that section."}, {"owner": {"reputation": 33, "user_id": 6099399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cdec707b93f10102d91592f790f1d9?s=128&d=identicon&r=PG&f=1", "display_name": "lopippo", "link": "https://stackoverflow.com/users/6099399/lopippo"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1568217003, "post_id": 57890725, "comment_id": 102206895, "body": "Ok, I have now solved this problem. I clearly had a problem with the Qt signal emitted as a response to the user wishing to cancel the computation: it did not get to the Visitor instance. I have added the solution to the initial post."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1568217146, "post_id": 57890725, "comment_id": 102206963, "body": "Even if it appears to be working as is, keep my answer in mind if you want it to be correct and portable."}, {"owner": {"reputation": 33, "user_id": 6099399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cdec707b93f10102d91592f790f1d9?s=128&d=identicon&r=PG&f=1", "display_name": "lopippo", "link": "https://stackoverflow.com/users/6099399/lopippo"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1568217411, "post_id": 57890725, "comment_id": 102207098, "body": "Yes, Zulan, you are right. I need to think about this, although in the current implementation the cancelling can come from only one origin and affect each visitor apart. Thank you for your help."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": false, "score": 1, "last_activity_date": 1568212649, "creation_date": 1568212649, "answer_id": 57891549, "question_id": 57890725, "link": "https://stackoverflow.com/questions/57890725/can-objects-in-an-openmp-thread-be-modified-from-outside/57891549#57891549", "title": "Can objects in an OpenMP thread be modified from outside?", "body": "<p>If you access a data location from multiple threads in OpenMP, and at least one of the accesses is a write access, you must protect <strong>all read and write</strong> accesses to this location with <code>atomic</code> directives (or other means to avoid race-conditions and ensure memory consistency).</p>\n\n<p>Simply speaking, <code>shouldStop</code> should be implemented along the lines of:</p>\n\n<pre><code>bool r;\n#pragma omp atomic read\nr = this-&gt;cancelFlag_;\nreturn r;\n</code></pre>\n\n<p>and <code>cancelOperation</code> like:</p>\n\n<pre><code>#pragma omp atomic write\nthis-&gt;cancelFlag_ = true;\n</code></pre>\n\n<p>This both ensures that there is no race condition in the unlikely case that a writing a <code>bool</code> needs two operations, and implies appropriate memory flushes to ensure that the result of the write is visible in other threads.</p>\n"}], "owner": {"reputation": 33, "user_id": 6099399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cdec707b93f10102d91592f790f1d9?s=128&d=identicon&r=PG&f=1", "display_name": "lopippo", "link": "https://stackoverflow.com/users/6099399/lopippo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568217292, "creation_date": 1568209979, "last_edit_date": 1568217292, "question_id": 57890725, "link": "https://stackoverflow.com/questions/57890725/can-objects-in-an-openmp-thread-be-modified-from-outside", "title": "Can objects in an OpenMP thread be modified from outside?", "body": "<p>I use OpenMP to parallelize calls like so:</p>\n\n<pre><code>#pragma omp parallel for\n  for(std::size_t iter = 0; iter &lt; visitors.size(); ++iter)\n    {\n      VisitorSPtr visitor_sp = visitors.at(iter);\n\n      dataSetPtr-&gt;accept(*(visitor_sp.get());\n    }\n  // End of\n  // #pragma omp parallel for\n</code></pre>\n\n<p>Each visitor is used in a different thread, thanks to the <code>#pragma omp parallel for</code> directive. Fine. </p>\n\n<p>The <code>dataSetPtr-&gt;accept()</code> function that is called within the loop checks if the visitor has been cancelled by the user like this:</p>\n\n<pre><code>    if(visitor.shouldStop())\n        break;\n</code></pre>\n\n<p>If that call returns true, the visit is not performed. That cancellation is trapped when a user clicks a button and a signal is emitted that is relayed to the visitor which sets a member boolean variable to state that cancellation has been requested. But the signal does not get to the visitor and the <code>if(visitor.shouldStop())</code> is of no use, that is, never evaluates to true even if the cancellation signal was properly emitted. </p>\n\n<p>The connection is performed like this (<code>this</code> is the <code>MassDataIntegrator</code> object instance from which the connection is made, that receives the cancelling signal and that should relay it to the Visitor instance):</p>\n\n<pre><code>      connect(this,\n            &amp;MassDataIntegrator::cancelOperationSignal,\n            visitor_sp.get(),\n            &amp;Visitor::cancelOperation,\n            Qt::QueuedConnection);\n</code></pre>\n\n<p>My question: how can I modify objects that are in a <code>#pragma omp parallel for</code> loop from code that runs in another thread? I thought that would be trivial by using pointers. Evidently, I am missing some concept here. Could anybody help me sort this mis-understanding ? Thank you for your attention.</p>\n\n<h1>SOLVED</h1>\n\n<p>The connect call above did not work for some reason (that I will investigate). So I tried using a lambda which, on the face, accesses directly the Visitor instance like this (I commented out the replaced code to show the difference):</p>\n\n<pre><code>  connect(this,\n        &amp;MassDataIntegrator::cancelOperationSignal,\n        [visitor_sp](){visitor_sp-&gt;cancelOperation();});\n          //visitor_sp.get(),\n          //&amp;TicChromTreeNodeCombinerVisitor::cancelOperation,\n          //Qt::QueuedConnection);\n</code></pre>\n\n<p>We can consider this issue solved. How do I do that ?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 2, "creation_date": 1568209354, "post_id": 57890537, "comment_id": 102202562, "body": "<code>std::pair&lt;bool, int&gt;</code>?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 4, "creation_date": 1568209432, "post_id": 57890537, "comment_id": 102202614, "body": "You have an exceptional condition, throw an exception? This isn&#39;t C, exceptions are a thing."}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568209448, "post_id": 57890537, "comment_id": 102202622, "body": "If you need the function signature to remain the same, then use <code>exceptions</code> instead."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1568209488, "post_id": 57890537, "comment_id": 102202644, "body": "If the entire range of values for your function is possible, than there is no value you can return to signal an error. You need an alternative solution. Maybe throw an exception. Maybe change the return type. Maybe return an <code>optional&lt;int&gt;</code> instead. It depends on how you want the function to be used and how &quot;exceptional&quot; you consider errors to be."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1568209508, "post_id": 57890537, "comment_id": 102202658, "body": "@ShadowRanger It isn&#39;t clear that these errors are exceptional conditions."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568209659, "post_id": 57890537, "comment_id": 102202746, "body": "@Fran&#231;oisAndrieux: If it&#39;s a legit error (bad file data of some form), that&#39;s almost always exceptional."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1568209686, "post_id": 57890537, "comment_id": 102202764, "body": "@ShadowRanger Maybe, but you&#39;re assuming the nature of the error."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568209732, "post_id": 57890537, "comment_id": 102202791, "body": "@Fran&#231;oisAndrieux: Umm... I&#39;m reading the comments in the example code. The problem is an unopenable file, or bad data (non-integer, when integer expected). No assumptions needed."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568209747, "post_id": 57890609, "comment_id": 102202798, "body": "OP specifically wants the full range of values for <code>int</code> to be usable. This solution may be applicable, but a larger type needs to be returned. But then the result likely has to be cast. This is similar to how many <code>iostream</code> and <code>char</code> related standard features deal in <code>int</code>s to handle special values like <code>EOF</code> instead of directly handling character types."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1568210098, "last_edit_date": 1568210098, "creation_date": 1568209562, "answer_id": 57890609, "question_id": 57890537, "link": "https://stackoverflow.com/questions/57890537/how-to-return-an-error-from-a-function-that-returns-signed-integers/57890609#57890609", "title": "How to return an error from a function that returns signed integers", "body": "<p>Other than throwing an exception, returning a <code>std::optional</code>, or a <code>std::pair</code>, there is a precedent here: <code>std::string::npos</code> is normally set to a particularly large <code>std::string::size_type</code> value, normally <code>-1</code> (wrapped around of course) and is used by some <code>std::string</code> functions to indicate a failure.</p>\n\n<p>If you're willing to give up one legitimate return value then you could do something similar in your case. In reality though, typical (perhaps all) strings will be significantly smaller than <code>npos</code>; if that's not the case for you then perhaps one of the alternatives already mentioned would be better.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9150170"}, "edited": false, "score": 0, "creation_date": 1568210802, "post_id": 57890611, "comment_id": 102203392, "body": "Thank you, I should have known to do this"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1568210905, "post_id": 57890611, "comment_id": 102203438, "body": "@Daniel: No problem. There is absolutely a tendency for those coming from non-C++ languages with (relatively) cheap exceptions (e.g. Python, where <code>try</code>/<code>except</code> is only slightly more expensive than an <code>if</code> statement) to <i>overuse</i> exceptions in non-exceptional cases, and doing so <i>can</i> hurt performance, so it&#39;s okay to be leery of throwing exceptions when it&#39;s not necessary (e.g. don&#39;t use exceptions for membership testing where both presence or absence of the element in question is considered a normalish outcome), but your specific use case is very much the ideal scenario for exceptions."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9150170"}, "edited": false, "score": 0, "creation_date": 1568211316, "post_id": 57890611, "comment_id": 102203679, "body": "Makes perfect sense! Sadly I&#39;ve been a c++ developer for 4 years now but after dealing with so much legacy code and trying to get products out the door, I seem to have forgotten how to code properly :("}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 5, "last_activity_date": 1568210813, "last_edit_date": 1568210813, "creation_date": 1568209563, "answer_id": 57890611, "question_id": 57890537, "link": "https://stackoverflow.com/questions/57890537/how-to-return-an-error-from-a-function-that-returns-signed-integers/57890611#57890611", "title": "How to return an error from a function that returns signed integers", "body": "<p>Throw an exception. One of the advantages of C++ over C is that, when you have an error, you don't have to smuggle error codes out of the function, you can just <code>throw</code> an exception. If it's a truly exceptional case, most of the time the caller won't have anything useful to do with it anyway, so forcing them to check for it manually, then pass the error up the call chain is pointless. If they <em>do</em> know what to do with it, they can <code>catch</code> it.</p>\n\n<p>This solution is also more composable. Imagine a scenario where <code>A</code> returns <code>int</code>, <code>B</code> calls <code>A</code> and returns a <code>std::string</code> based on it, and <code>C</code> calls <code>B</code> and returns class <code>Foo</code> based on that. If <code>A</code> has an exceptional condition that requires it to return an error, you can either:</p>\n\n<ol>\n<li>Come up with some way to smuggle the error out of <code>A</code> as an <code>int</code> (or <code>std::optional&lt;int&gt;</code> or <code>std::pair&lt;bool, int&gt;</code> or whatever), then check for and convert that smuggled error to a different smuggled error for <code>B</code>, then check for and convert that to yet another smuggled error for <code>C</code>, then the caller of <code>C</code> still needs to check for that smuggled error <em>and</em> all three layers have to pay the price of the checks <em>every</em> time, even when all three layers <em>succeeded</em>, or...</li>\n<li>You <code>throw</code> an exception in <code>A</code>, neither <code>B</code> nor <code>C</code> have anything useful to do with it (so they don't write any additional code at all), and the caller of <code>C</code> can choose to <code>catch</code> the exception and produce a friendlier error message if they so choose.</li>\n</ol>\n\n<p>On modern architectures, the cost in the success case for #2 should be pretty negligible; the failure case might be more costly than the \"check at every level case\", but for something like \"file doesn't exist\" or \"file contains corrupt data\", it hardly matters if performance suffers, since you're probably about to exit the program (so speed doesn't count) or pop a dialog the user needs to respond to (the user is slower than the computer by many orders of magnitude).</p>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568209636, "post_id": 57890613, "comment_id": 102202726, "body": "Old timers might not be as familiar with <code>std::optional</code> but that is their problem. <code>std::optional</code> clearly self-documents the intention, there is no need to interpret the meaning of the <code>bool</code> in the pair."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568209843, "post_id": 57890613, "comment_id": 102202855, "body": "@Fran&#231;oisAndrieux I&#39;ve been exposed to a wide variety of code styles in my professional life. And the best, most solid, most maintainable was something in plain old C (in am otherwise C++ project). At first I hated it, but in the long-run, using less bells and whistles makes for simple, easy-to-maintain, less buggy code. Your mileage will vary, but I want to show the option."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568210115, "post_id": 57890613, "comment_id": 102203005, "body": "It seems you think <code>std::optional</code> is more &quot;bells and whistles&quot; than <code>std::pair</code>. Could you please elaborate? Or did I misunderstand?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1568210380, "post_id": 57890613, "comment_id": 102203156, "body": "<code>std::pair&lt;bool, T&gt;</code> is used in the <code>std::map</code> interface for certain functions. That justifies its use in my book."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "edited": false, "score": 0, "creation_date": 1568210480, "post_id": 57890613, "comment_id": 102203220, "body": "From most bell-and-whistles to least, IMO:  &#39;optional&#39;, &#39;exception&#39;, &#39;pair&#39;, &#39;bool and ref&#39;. But hey, it&#39;s a style spectrum"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1568210900, "post_id": 57890613, "comment_id": 102203435, "body": "@Bathsheba That&#39;s an interesting point. But in that case, the <code>bool</code> doesn&#39;t indicate the validity of the associated <code>iterator</code>. So that use case is not compatible with <code>std::optional</code> so there is not a great comparison for the two. It actually goes to show one problem with using the wider interface of <code>std::pair</code> over <code>std::optional</code> when both work. The meaning for the elements of <code>std::pair</code> are more open to interpretation. It takes more effort to reason about it."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1568210958, "post_id": 57890613, "comment_id": 102203471, "body": "@Jeffrey What I was actually wondering is where that ordering comes from. What are the metrics or characteristics used to determine that? Is it just a gut feeling and personal preference?"}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 2, "last_activity_date": 1568209961, "last_edit_date": 1568209961, "creation_date": 1568209578, "answer_id": 57890613, "question_id": 57890537, "link": "https://stackoverflow.com/questions/57890537/how-to-return-an-error-from-a-function-that-returns-signed-integers/57890613#57890613", "title": "How to return an error from a function that returns signed integers", "body": "<p>One option is to throw an exception when an error occurs. It's highly dependent on the rest of your project. Are Exceptions used all around ? Personally, I prefer more conventional old-school approaches. Mostly because people will start throwing exception everywhere, where it's not really exceptional and then it makes debugging much harder as the debugger keeps stopping for non-exceptional situations.</p>\n\n<p>Another option is to return a pair <code>std::pair&lt;bool, int&gt;</code>. Some people love it, some people hate it.</p>\n\n<p>My preference would be <code>bool attemptGetValue(int&amp; outValue)</code>. You return false if there's an error, in which case you don't touch <code>outValue</code>. Your return true otherwise and modify <code>outValue</code></p>\n\n<p>You can also use <code>std::optional</code>, but old timers might not be familiar wiht it.</p>\n"}, {"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1568211453, "post_id": 57890949, "comment_id": 102203744, "body": "Not really C++ specific, but CPython (which is limited to C-style error handling) uses the &quot;reserved&quot; value approach without actually reserving it in most cases; many APIs that can return any <code>int</code> return <code>-1</code> for an error, but it&#39;s only <i>really</i> an error if <code>PyErr_Occurred()</code> returns a truthy value. A similar approach could be used in C++ if absolutely necessary, where, say, a return of <code>-1</code> is used for errors, but <code>errno</code> is only set to a non-<code>0</code> value if an error actually occurred, and callers check for an error by checking <code>if (retval == -1 &amp;&amp; errno != 0)</code> or the like. Not recommending it."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1568211558, "last_edit_date": 1568211558, "creation_date": 1568210709, "answer_id": 57890949, "question_id": 57890537, "link": "https://stackoverflow.com/questions/57890537/how-to-return-an-error-from-a-function-that-returns-signed-integers/57890949#57890949", "title": "How to return an error from a function that returns signed integers", "body": "<p>There are several error handling approaches in C++:</p>\n\n<p>The traditional way popular in C API's (also used by <code>std::string</code> algorithms) is to reserve at least one value as \"invalid\", which when returned would signal that there was an error, or that the value represents \"no result\". In case of error, the C API's would use the global <code>errno</code> to inform what error happened.</p>\n\n<p>One of the features C++ introduced over the C language is exceptions. You can simply throw when error occurs. This is most appropriate for unexpected errors or pre/post-condition violations, rather than \"no result exists\" type situations.</p>\n\n<p>Yet another way is to return both the value, and information about whether the result is valid. Old fashioned approach might be to return a pair of integer and boolean (or a named class that achieves the same). Alternatively, either value or error state can written into object passed through indirection. <code>std::optional</code> has been introduced into the standard library just for this kind of situation an is a great way of representing lack of result.</p>\n\n<p>Latter approach can be further extended to not only return a boolean, but actual information about the error in similar way to the way exceptions do. The error information can also be wrapped with the value in a \"variant\" type so that they can share the space, as only one of them can exist at any time. This approach is similar to <code>Maybe</code> type in Haskell. There is a <a href=\"http://www.open-std.org/jtc1/SC22/wg21/docs/papers/2018/p0323r7.html\" rel=\"nofollow noreferrer\">proposal</a> to introduce a template for this purpose into the standard library.</p>\n\n<p>Each of these approaches have their benefits and drawbacks. Choose one that is appropriate for your use case.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9150170"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 57890611, "answer_count": 4, "score": 1, "last_activity_date": 1568211558, "creation_date": 1568209296, "question_id": 57890537, "link": "https://stackoverflow.com/questions/57890537/how-to-return-an-error-from-a-function-that-returns-signed-integers", "title": "How to return an error from a function that returns signed integers", "body": "<p>I have some psuedocode for a function to display a value and get a value</p>\n\n<pre><code>int getValue(){\n    int value;\n    // open file\n    // read line into \"value\"\n    if(error occurs){ \n        // if file doesn't open or line was not an integer\n        /* Normally I would return something such as -1\n           but -1 in this case would be a valid value*/\n        value = ?\n    }\n    return value;\n}\n\nvoid displayValue(){\n    int value = getValue();\n    if(value is valid)\n         display(value);\n}\n</code></pre>\n\n<p>As described in the code above, I would like to return that there was an error and let <i>displayValue</i> know that there was an error. But i want to accept negative,positive, and 0 from getValue.</p>\n\n<p>Is there a better way to go about this? Does anyone have any advice?</p>\n"}, {"tags": ["c++", "opencv", "build"], "comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 1, "creation_date": 1568209331, "post_id": 57890351, "comment_id": 102202549, "body": "You need to provide more information if you want help. We need reproducible example code and the exact error message."}, {"owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568217224, "post_id": 57890351, "comment_id": 102207008, "body": "I was able to solve the earlier problem,but now I am running into a new issue.The source code is provided in the below link."}, {"owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568217292, "post_id": 57890351, "comment_id": 102207034, "body": "<a href=\"https://github.com/udacity/SFND_3D_Object_Tracking\" rel=\"nofollow noreferrer\">github.com/udacity/SFND_3D_Object_Tracking</a>"}, {"owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568217370, "post_id": 57890351, "comment_id": 102207075, "body": "The new error is as follows #1 : LOAD IMAGE INTO BUFFER done terminate called after throwing an instance of &#39;cv::Exception&#39; what(): OpenCV(4.1.0) /home/kieranych/SFND/opencv/opencv-4.1.0/modules/dnn/src/dar&zwnj;&#8203;knet/darknet_io.cpp:&zwnj;&#8203;694: error: (-213:The function/feature is not implemented) Transpose the weights (except for convolutional) is not implemented in function &#39;ReadDarknetFromWeightsStream&#39;  Aborted (core dumped)"}, {"owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568218072, "post_id": 57890351, "comment_id": 102207451, "body": "Apologies for the previous comments.A detailed and clearer explanation is as follows"}, {"owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568218112, "post_id": 57890351, "comment_id": 102207479, "body": "System Information: OpenCV&gt;=4.0 Operating System: Ubuntu 16.04 compiler:GCC 5.4.0 Description: While working on a course project that relies  on the yolo3 model to make detections I ran into the following error: #1 : LOAD IMAGE INTO BUFFER done terminate called after throwing an instance of &#39;cv::Exception&#39; what(): OpenCV(4.1.0) /home/kieranych/SFND/opencv/opencv-4.1.0/modules/dnn/src/dar&zwnj;&#8203;knet/darknet_io.cpp:&zwnj;&#8203;694: error: (-213:The function/feature is not implemented) Transpose the weights (except for convolutional) is not implemented in function &#39;ReadDarknetFromWeightsStream&#39;  Aborted"}, {"owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568218132, "post_id": 57890351, "comment_id": 102207488, "body": "Steps to reproduce: 1)Clone the following repository: <a href=\"https://github.com/udacity/SFND_3D_Object_Tracking\" rel=\"nofollow noreferrer\">github.com/udacity/SFND_3D_Object_Tracking</a> 2)mkdir build &amp; cd build 3)cmake .. &amp; make 4).3D_object_tracking Further Dependencies: cmake&gt;=2.8 Git LFS OpenCV&gt;=4.1 gcc/g++&gt;=5.4"}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568231128, "post_id": 57890351, "comment_id": 102213026, "body": "Please use the edit button of your post above and use code marks (3 backticks) to paste your error lines. In a comment, it&#39;s not readable."}], "owner": {"reputation": 11, "user_id": 2065458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7fe117d230b3dea2931025f2f56837?s=128&d=identicon&r=PG", "display_name": "Sparsh Garg", "link": "https://stackoverflow.com/users/2065458/sparsh-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568238162, "creation_date": 1568208578, "last_edit_date": 1568238162, "question_id": 57890351, "link": "https://stackoverflow.com/questions/57890351/build-error-while-trying-to-run-yolo3-example-in-opencv-c", "title": "Build error while trying to run Yolo3 example in OpenCV C++", "body": "<p>So, I am trying to run a project that involves the usage of the inbuilt Yolo model provided by OpenCV in C++. However, when I try to create the model it gives me the error \"dnn_backend_opencv wasn't declared in this scope.\"Now I have included the namespaces cv,dnn, and std, but it still gives me the error.\nFurthermore, I also get the error no known conversion from double to Mat when it reaches the line blobfromImage()\nAny help will be appreciated.</p>\n"}, {"tags": ["c++", "algorithm", "multidimensional-array", "copy", "move"], "comments": [{"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1568207803, "post_id": 57890041, "comment_id": 102201657, "body": "Think about the basic case, you want to delete an element from an array. Since your table is an array of arrays, you just repeat this basic task for each row. Can you also post the code you have already tried? It is hard to know what the problem you are having is if you don&#39;t post <i>that</i> code and the errors you had with it."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1568209407, "creation_date": 1568209407, "answer_id": 57890567, "question_id": 57890041, "link": "https://stackoverflow.com/questions/57890041/how-to-delete-a-column-in-2d-array-in-c/57890567#57890567", "title": "How to delete a column in 2d array in c++", "body": "<p>It is not possible to \"delete\" elements of an array. The size of an array is constant. It remains the same from the beginning of its lifetime until it is destroyed. C++ does offer a resizable dynamic array data structure by the name <code>std::vector</code>.</p>\n\n<p>What you may do is copy the contents of the successive elements onto their preceding sibling. There is actually a standard algorithm for this: <code>std::rotate</code>. Rotate does however preserve the value of all elements; the one that is written over is rotated to the end. This isn't necessarily what you need, so as a minor optimisation, you could write your own algorithm that doesn't do that.</p>\n\n<p>For a multi-dimensional array, you need to repeat this algorithm for each row.</p>\n"}, {"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1568211163, "last_edit_date": 1568211163, "creation_date": 1568209818, "answer_id": 57890683, "question_id": 57890041, "link": "https://stackoverflow.com/questions/57890041/how-to-delete-a-column-in-2d-array-in-c/57890683#57890683", "title": "How to delete a column in 2d array in c++", "body": "<p>You can not remove a column from an array. But you can move all elements of columns to the left filling the \"deleted\" column and keep the number of actual columns of the array.</p>\n\n<p>Here is a demonstrative program. In the program the variable <code>n</code> stores the number of actual columns of a two-dimensional array.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\ntemplate &lt;typename T&gt;\nbool remove_column( T &amp;a, size_t n, size_t pos )\n{\n    const size_t N = \n        std::extent&lt;typename std::remove_reference&lt;decltype( a )&gt;::type, 1&gt;::value;\n\n    bool success = n &lt;= N &amp;&amp; pos &lt; n;\n\n    if ( success )\n    {\n        for ( auto &amp;row : a )\n        {\n            std::copy( std::next( std::begin( row ), pos + 1 ), \n                       std::next( std::begin( row ), n ),\n                       std::next( std::begin( row ), pos ) );\n        }\n    }\n\n    return success;\n}\n\nint main() \n{\n    const size_t M = 4;\n    const size_t N = 5;\n    std::string a[M][N] =\n    {\n        { \"A0\", \"B0\", \"C0\", \"D0\", \"E0\" },\n        { \"A1\", \"B1\", \"C1\", \"D1\", \"E1\" },\n        { \"A2\", \"B2\", \"C2\", \"D2\", \"E2\" },\n        { \"A3\", \"B3\", \"C3\", \"D3\", \"E3\" },\n    };\n\n    size_t n = N;\n\n    for ( const auto &amp;row : a )\n    {\n        for ( size_t i = 0; i &lt; n; i++ )\n        {\n            std::cout &lt;&lt; row[i] &lt;&lt; ' ';\n        }\n        std::cout &lt;&lt; '\\n';\n    }\n\n    std::cout &lt;&lt; '\\n';\n\n    if ( remove_column( a, n, 0 ) ) --n;\n\n    for ( const auto &amp;row : a )\n    {\n        for ( size_t i = 0; i &lt; n; i++ )\n        {\n            std::cout &lt;&lt; row[i] &lt;&lt; ' ';\n        }\n        std::cout &lt;&lt; '\\n';\n    }\n\n    std::cout &lt;&lt; '\\n';\n\n    if ( remove_column( a, n, n - 1 ) ) --n;\n\n    for ( const auto &amp;row : a )\n    {\n        for ( size_t i = 0; i &lt; n; i++ )\n        {\n            std::cout &lt;&lt; row[i] &lt;&lt; ' ';\n        }\n        std::cout &lt;&lt; '\\n';\n    }\n\n    std::cout &lt;&lt; '\\n';\n\n    if ( remove_column( a, n, 1 ) ) --n;\n\n    for ( const auto &amp;row : a )\n    {\n        for ( size_t i = 0; i &lt; n; i++ )\n        {\n            std::cout &lt;&lt; row[i] &lt;&lt; ' ';\n        }\n        std::cout &lt;&lt; '\\n';\n    }\n\n    std::cout &lt;&lt; '\\n';\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>A0 B0 C0 D0 E0 \nA1 B1 C1 D1 E1 \nA2 B2 C2 D2 E2 \nA3 B3 C3 D3 E3 \n\n\nB0 C0 D0 E0 \nB1 C1 D1 E1 \nB2 C2 D2 E2 \nB3 C3 D3 E3 \n\n\nB0 C0 D0 \nB1 C1 D1 \nB2 C2 D2 \nB3 C3 D3 \n\n\nB0 D0 \nB1 D1 \nB2 D2 \nB3 D3 \n</code></pre>\n\n<p>Or the function can be defined the following more simpler way</p>\n\n<pre><code>template &lt;typename T, size_t M, size_t N&gt;\nbool remove_column( T ( &amp;a )[M][N], size_t n, size_t pos )\n{\n    bool success = n &lt;= N &amp;&amp; pos &lt; n;\n\n    if ( success )\n    {\n        for ( auto &amp;row : a )\n        {\n            std::copy( std::next( std::begin( row ), pos + 1 ), \n                       std::next( std::begin( row ), n ),\n                       std::next( std::begin( row ), pos ) );\n        }\n    }\n\n    return success;\n}\n</code></pre>\n\n<p>In this case the header <code>&lt;type_traits&gt;</code> is redundant.</p>\n\n<p>Also instead of the algorithm <code>std::copy</code> you could use the algorithm <code>std::move</code>.</p>\n"}], "owner": {"reputation": 987, "user_id": 10342778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5CX5x.jpg?s=128&g=1", "display_name": "Ahmad Anis", "link": "https://stackoverflow.com/users/10342778/ahmad-anis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 914, "favorite_count": 0, "accepted_answer_id": 57890683, "answer_count": 2, "score": 1, "last_activity_date": 1568211232, "creation_date": 1568207581, "last_edit_date": 1568211232, "question_id": 57890041, "link": "https://stackoverflow.com/questions/57890041/how-to-delete-a-column-in-2d-array-in-c", "title": "How to delete a column in 2d array in c++", "body": "<p>I have a basic 2d array in c++. I want to delete a specific column and place the next column in its place. my array is \nNAME[     ]                    TMARKS[     ]\nFNAME[     ]                   REG#[        ]<br>\nName and FNAME are in 1st 2d array(string) while Tmarks and reg # are in 2nd 2d array(int) </p>\n\n<p>I already tried a solution on StackOverflow but not working.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n#define ROW 2\n#define COL 70\nvoid input(string data[][COL], int moredata[][COL], int n)\n{\n    for (int i = 0; i &lt; ROW; i++)\n    {\n    for (int j = 0; j &lt; n; j++)\n    {\n        if (i == 0)\n        {\n            cout &lt;&lt; \" Name of Student #  : \" &lt;&lt; j + 1 &lt;&lt; endl;\n            cin &gt;&gt; data[i][j];\n            cout &lt;&lt; \"Total Marks out of 600 of student #  \" &lt;&lt; j + 1 &lt;&lt;\n            endl;            \n            cin &gt;&gt; moredata[i][j];\n        }\n        if (i == 1)\n        {\n            cout &lt;&lt; \" Father Name of Student # \" &lt;&lt; j + 1 &lt;&lt; endl;\n            cin &gt;&gt; data[i][j];\n            cout &lt;&lt; \"Reg # of student # \" &lt;&lt; j + 1 &lt;&lt; endl;\n            cin &gt;&gt; moredata[i][j];\n        }\n     }\n     }\n}\nint main()\n{\nint n;\nstring data[ROW][COL] = {};\nint moredata[ROW][COL] = {};\ncout &lt;&lt; \"NO of Students: \";\ndo\n{\n    cin &gt;&gt; n;\n} while (n &gt; 70 || n &lt; 0);\ninput(data, moredata, n); //input function already created.\n</code></pre>\n\n<p>Now I want to make a function which deletes a single column.</p>\n"}, {"tags": ["c++", "preprocessor"], "comments": [{"owner": {"reputation": 4531, "user_id": 4756309, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/XMiQX.png?s=128&g=1", "display_name": "Weak to Enuma Elish", "link": "https://stackoverflow.com/users/4756309/weak-to-enuma-elish"}, "edited": false, "score": 1, "creation_date": 1568207575, "post_id": 57890010, "comment_id": 102201524, "body": "You sure you don&#39;t want <code>if constexpr</code> instead?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 1, "creation_date": 1568207918, "post_id": 57890010, "comment_id": 102201729, "body": "Preprocessor macros do fairly simple text substitution.  The Preprocessor is a poor choice as a programming language."}], "answers": [{"comments": [{"owner": {"reputation": 1578, "user_id": 9516968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15afa6fdf1897c5ba92cea3946a5635?s=128&d=identicon&r=PG&f=1", "display_name": "Romen", "link": "https://stackoverflow.com/users/9516968/romen"}, "edited": false, "score": 0, "creation_date": 1568208979, "post_id": 57890168, "comment_id": 102202349, "body": "I would like to add to this answer by pointing out that the <a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"nofollow noreferrer\"><code>constexpr</code></a> specifier can be used to rewrite macros as functions that can be evaluated at compile-time. Ideally, modern C++ code shouldn&#39;t use the preprocessor that much anymore."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1568209130, "post_id": 57890168, "comment_id": 102202441, "body": "Note that implementing BIT_x for all x can be made to work if you call BIT(9) by using token pasting, it will fail for BIT(8+1)"}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1568209206, "post_id": 57890168, "comment_id": 102202489, "body": "@MartinBonner You are perfectly right. Preprocessor is just &quot;copy and paste&quot;, it&#39;s not a language."}], "tags": [], "owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "is_accepted": false, "score": 3, "last_activity_date": 1568209052, "last_edit_date": 1568209052, "creation_date": 1568207986, "answer_id": 57890168, "question_id": 57890010, "link": "https://stackoverflow.com/questions/57890010/c-preprocessor-macro-selection-by-argument/57890168#57890168", "title": "C++ Preprocessor macro selection by argument", "body": "<p>Unless you want very clumsy code, you can't do that. The preprocessor has no idea about the value of the argument passed in. It's just doing string replacement and that's all.</p>\n\n<p>That being said, they are crazy guys implementing BIT_x for all x in [0 to 63].\nThis is very ugly and would fail is used with an argument set at 64.</p>\n\n<p>A clean solution is to use a function instead:</p>\n\n<pre><code>const char * bit_msg(unsigned int b)\n{\n    if (b &gt; 8) return \"is greater than 8\";\n    const char * bits[] = {\n\"is 0 and lower than 8\",\n\"is 1 and lower than 8\",\n\"is 2 and lower than 8\",\n\"is 3 and lower than 8\",\n\"is 4 and lower than 8\",\n\"is 5 and lower than 8\",\n\"is 6 and lower than 8\",\n\"is 7 and lower than 8\",\n\"is 8\",\n}; \nreturn bits[b];\n}\n\n#define BIT(X) X, bit_msg(X)\n[...]\nprintf(\"%d %s\", BIT(9));\n</code></pre>\n\n<p>Because you've tagged the question with C++ and to follow @Romen you could achieve similar result using <code>constexpr</code> that, if possible, will be computed by the compiler at compile time, resulting in code that's as efficient as a macro.</p>\n\n<p>In the example above, you'll just need to replace the signature with <code>constexpr const char * bit_msg(unsigned int b)</code> and the compiler might even skip the function and write (the equivalent of) <code>printf(\"%d %s\", 9, \"is greater than 8\")</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 3083483, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce8264bee2a26a893958a5dbd219e2bc?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/3083483/omar"}, "is_accepted": false, "score": 0, "last_activity_date": 1568210711, "last_edit_date": 1568210711, "creation_date": 1568209643, "answer_id": 57890630, "question_id": 57890010, "link": "https://stackoverflow.com/questions/57890010/c-preprocessor-macro-selection-by-argument/57890630#57890630", "title": "C++ Preprocessor macro selection by argument", "body": "<p>you could do this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BIT_8(n) printf(\"%d is lower than or equal to 8 \\n\" , n)\n#define BIT_N(n) printf(\"%d is greater than 8 \\n\" , n)\n#define BIT(n) ((n &lt;= 8) ? (BIT_8(n)) : (BIT_N(n)))\n\nint main() {\n    BIT(7);\n    BIT(8);\n    BIT(9);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1826, "user_id": 2301053, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l0ISw.jpg?s=128&g=1", "display_name": "Charles Ofria", "link": "https://stackoverflow.com/users/2301053/charles-ofria"}, "is_accepted": false, "score": 1, "last_activity_date": 1568391046, "creation_date": 1568391046, "answer_id": 57927072, "question_id": 57890010, "link": "https://stackoverflow.com/questions/57890010/c-preprocessor-macro-selection-by-argument/57927072#57927072", "title": "C++ Preprocessor macro selection by argument", "body": "<p>The challenge is that the pre-processor doesn't know math.  You can solve this problem by implementing the math you need, but it gets UGLY.  For example, here's working pre-processor code for what you want to do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BIT_8(n) n, \"is lower or equal than 8\"\n#define BIT_N(n) n, \"is greater than 8\"\n\n// Identify values less than 8; make the second argument 8\n#define LT_8_0 ~,8\n#define LT_8_1 ~,8\n#define LT_8_2 ~,8\n#define LT_8_3 ~,8\n#define LT_8_4 ~,8\n#define LT_8_5 ~,8\n#define LT_8_6 ~,8\n#define LT_8_7 ~,8\n#define LT_8_8 ~,8\n\n// Helper macros.  Delays let arguments be processed before the macros is run.\n#define MERGE(A, B) A ## B\n#define MERGE_DELAY(A, B) MERGE(A,B)\n#define ARG2(A,B,...) B\n#define ARG2_DELAY(A,B,...) ARG2(A,B,__VA_ARGS__)\n\n// Return 8 or N depending if n &lt;= 8...\n#define LT_8(n) ARG2_DELAY( MERGE(LT_8_, n), N,~ )\n\n#define BIT(n) MERGE_DELAY(BIT_, LT_8(n))(n)\n\nint main() {\n  printf(\"%d %s\\n\", BIT(9));\n  return 0;\n}\n</code></pre>\n\n<p>Note that the LT_8 macro works by taking the second of a series of arguments.  We default that second argument to N, but if we recognize the input number to be 8 or less, we insert a new second argument of 8.</p>\n"}], "owner": {"reputation": 11, "user_id": 12053106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed1edb2bb31c77d57f45252a708aa0d?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/12053106/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1568391046, "creation_date": 1568207497, "last_edit_date": 1568207919, "question_id": 57890010, "link": "https://stackoverflow.com/questions/57890010/c-preprocessor-macro-selection-by-argument", "title": "C++ Preprocessor macro selection by argument", "body": "<p>I'm trying to define a preprocessor macro that in turn selects the right macro depending on the value of an argument.</p>\n\n<pre><code>#define BIT_8(n) n, \"is lower or equal than 8\"\n#define BIT_N(n) n, \"is greater than 8\"\n#define BIT(n) ?????\n\nint main() {\n    printf(\"%d %s\", BIT(9));\n    return 0;\n}\n</code></pre>\n\n<p><code>BIT(n)</code> should expand to:<br></p>\n\n<p><code>BIT_8(n)</code> if n&le;8<br>\n<code>BIT_N(n)</code> if n&gt;8<br></p>\n\n<p>Any way to achieve this?</p>\n"}, {"tags": ["c++", "utc", "chrono"], "comments": [{"owner": {"reputation": 1288, "user_id": 11680056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/352e207181e5b85c5ffeef7be921898c?s=128&d=identicon&r=PG&f=1", "display_name": "sklott", "link": "https://stackoverflow.com/users/11680056/sklott"}, "edited": false, "score": 0, "creation_date": 1568208479, "post_id": 57890001, "comment_id": 102202047, "body": "It looks like in C++ we don&#39;t have time zone. Until C++20 used time zone is implementation specific, after it looks like it should be UTC."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 1, "creation_date": 1568211852, "post_id": 57890001, "comment_id": 102203968, "body": "In C++ is the final product a UTC time point, or a local time point?"}, {"owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "reply_to_user": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1568212915, "post_id": 57890001, "comment_id": 102204612, "body": "@HowardHinnant many thanks for your replay, i have watched 3 of your videos on the c++ con  about the TZ library. Since you are the person that is involved in the TZ library can you advise what kind of primitives shell we use during the serialization  now in order to transfer time from java to c++, i mean for example the seconds in cpp is long long as you have said it yourself but in my example i am using 1 byte for a seconds and 4 bytes for nanoseconds, what would be the minimum size required to transfer UTC time point in c++ in c++20?"}, {"owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "reply_to_user": {"reputation": 1288, "user_id": 11680056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/352e207181e5b85c5ffeef7be921898c?s=128&d=identicon&r=PG&f=1", "display_name": "sklott", "link": "https://stackoverflow.com/users/11680056/sklott"}, "edited": false, "score": 0, "creation_date": 1568213006, "post_id": 57890001, "comment_id": 102204660, "body": "@sklott thanks for the feedback, that is a big problem when you want to compare a time in a different time zones. I am search for a code that will have to work in webassembly as well. I did not expected this."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 1, "creation_date": 1568214571, "post_id": 57890001, "comment_id": 102205559, "body": "One can express a UTC time point with nanoseconds precision in C++ using a total of 8 bytes, as long as the time point is approximately in the range of years 1678 to 2262.  If one needs time zones or UTC offsets, that is going to require more storage."}, {"owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "reply_to_user": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 0, "creation_date": 1568216704, "post_id": 57890001, "comment_id": 102206754, "body": "@HowardHinnant thanks for the feedback, is there any example somewhere with the minimum space required with TimeZones and UTC offfsets? I was going trough <a href=\"https://github.com/HowardHinnant/date/wiki/Examples-and-Recipes#elsetime\" rel=\"nofollow noreferrer\">github.com/HowardHinnant/date/wiki/&hellip;</a> but there you always supply the time zone such as auto zt = make_zoned(tz_name, tp);  i.e. i am trying to understand how many bytes are required for that in c++20, and how to initialize the chrono time instance from all separate parts. Do you know if there is any example for that?"}, {"owner": {"reputation": 213390, "user_id": 642706, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1", "display_name": "Basil Bourque", "link": "https://stackoverflow.com/users/642706/basil-bourque"}, "edited": false, "score": 0, "creation_date": 1568219725, "post_id": 57890001, "comment_id": 102208247, "body": "What is \u201cpercition\u201d?"}, {"owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "edited": false, "score": 0, "creation_date": 1568219847, "post_id": 57890001, "comment_id": 102208288, "body": "precision,, sorry English is not my mother language"}, {"owner": {"reputation": 213390, "user_id": 642706, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1", "display_name": "Basil Bourque", "link": "https://stackoverflow.com/users/642706/basil-bourque"}, "edited": false, "score": 0, "creation_date": 1568220119, "post_id": 57890001, "comment_id": 102208417, "body": "What <i>exactly</i> is your goal? Communicate a moment in UTC with a resolution of nanoseconds in a minimum of octets to be read in C++? Why nanoseconds, do you understand that conventional computer clock hardware is not accurate to nanoseconds? If you want UTC, why do you keep talking about offsets and zones? Is the minimum number of octets really critical? The recommended way to exchange date-time values is through text in standard <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601 format</a>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1568221908, "post_id": 57890001, "comment_id": 102209180, "body": "Why deal with the offset? Just create either OffsetDateTime or ZonedDateTime with UTC ZoneId."}, {"owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "reply_to_user": {"reputation": 213390, "user_id": 642706, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1", "display_name": "Basil Bourque", "link": "https://stackoverflow.com/users/642706/basil-bourque"}, "edited": false, "score": 0, "creation_date": 1568222202, "post_id": 57890001, "comment_id": 102209309, "body": "@BasilBourque ,  the reason i talk about Offsets and Zones is becuase  need to be able to compare time between clients and server, and since those can be in a different time zones, when comparing the time moments and logging those on the server you need to know the exact zone and offset from the client in order to be able to later compare the logs with the server, taking into accounts that there are multiple servers worldwide. And yes i do understand that the conventional computer clock is not accurate and does not support nanoseconds."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 3, "creation_date": 1568226654, "post_id": 57890001, "comment_id": 102211135, "body": "If all clients/servers always communicate with each other in UTC, then it becomes very easy to compare time stamps.  Unless of course for some reason one has to know things like whether a time stamp was during open/closed local times of a client/server."}], "answers": [{"comments": [{"owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "edited": false, "score": 0, "creation_date": 1568222867, "post_id": 57893623, "comment_id": 102209592, "body": "Howard,  many thanks for the reply  couple of additional thing, Do you know if there is a way to map the string of the zone &quot;America/New_York&quot;  to an integer? I am trying to avoid the string representation for serialization and use instead a fixed length integers for that reason.  Since i would like to have the same DTO for java and C++ as an structure to use in order to exchange information. One more question is do you know if &quot;date/tz.h&quot; has been tested with Webassembly before?"}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "reply_to_user": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "edited": false, "score": 0, "creation_date": 1568224356, "post_id": 57893623, "comment_id": 102210201, "body": "There is no official name&lt;-&gt;integer mapping.  However you could create your own.  There are currently 593 names associated with time zones.  Some of these names actually refer to the same zone, but most OS&#39;s treat them as distinct copies of zones."}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "reply_to_user": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "edited": false, "score": 0, "creation_date": 1568224388, "post_id": 57893623, "comment_id": 102210219, "body": "I am not aware of any use of tz.h with Webassembly."}], "tags": [], "owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 1, "last_activity_date": 1568220533, "creation_date": 1568220533, "answer_id": 57893623, "question_id": 57890001, "link": "https://stackoverflow.com/questions/57890001/java-to-c-utc-time-finding-the-utc-zone-time-offset-in-seconds/57893623#57893623", "title": "Java to C++ UTC time - finding the Utc Zone Time Offset in seconds", "body": "<p>Not a complete answer, but here is one way one might serialize a C++ local time point using <a href=\"https://github.com/HowardHinnant/date\" rel=\"nofollow noreferrer\">Howard Hinnant's free, open source time zone library</a>.</p>\n\n<pre><code>#include \"date/tz.h\"\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n\nstd::string\nto_string(date::zoned_time&lt;std::chrono::nanoseconds&gt; t)\n{\n    using namespace std;\n    using namespace date;\n    ostringstream out;\n    out &lt;&lt; t.get_sys_time().time_since_epoch().count()\n        &lt;&lt; ' ' &lt;&lt; t.get_time_zone()-&gt;name();\n    return out.str();\n}\n\ndate::zoned_time&lt;std::chrono::nanoseconds&gt;\nfrom_string(const std::string&amp; s)\n{\n    using namespace std;\n    using namespace std::chrono;\n    using namespace date;\n    istringstream in{s};\n    long long ns;\n    std::string tz_name;\n    in &gt;&gt; ns &gt;&gt; tz_name;\n    return {tz_name, sys_time&lt;nanoseconds&gt;{nanoseconds{ns}}};\n}\n\nint\nmain()\n{\n    using namespace std;\n    using namespace std::chrono;\n    using namespace date;\n    zoned_time&lt;nanoseconds&gt; zt{current_zone(), system_clock::now()};\n    cout &lt;&lt; zt &lt;&lt; '\\n';\n    auto s = to_string(zt);\n    cout &lt;&lt; s &lt;&lt; '\\n';\n    zt = from_string(s);\n    cout &lt;&lt; zt &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>I'm using a <code>std::string</code> to represent the serialization, which one might send across a network.</p>\n\n<p>This example begins in <code>main</code> with creating a nanosecond-precision local time point, stored in <code>date::zoned_time&lt;nanoseconds&gt;</code>, using the computer's current local time zone, and the current UTC time.  <code>main</code> first simply prints this time stamp out, which for me just output:</p>\n\n<pre><code>2019-09-11 12:37:04.846272000 EDT\n</code></pre>\n\n<p>which is my current local date/time and time zone abbreviation.</p>\n\n<p>Next the program converts this to a string with a small (but not necessarily minimal) number of ASCII characters to completely describe the local time point.  I've chosen the format:</p>\n\n<pre><code>&lt;Number of nanoseconds since epoch&gt; &lt;IANA time zone name&gt;\n</code></pre>\n\n<p>In this example, that string is:</p>\n\n<pre><code>1568219824846272000 America/New_York\n</code></pre>\n\n<p>This <code>string</code> is formed in <code>to_string</code>, which simply streams out the \"time since epoch\" of the system time, of the <code>zoned_time</code>.  Then adds a space, and streams out the name of the time zone.</p>\n\n<p><code>from_string</code> reverses this operation by reading in the number of nanoseconds, and then reading in the time zone name.  It then forms a <code>zoned_time&lt;nanoseconds&gt;</code> by pairing the time zone name, and forming a <code>sys_time&lt;nanoseconds&gt;</code> with the integer that was parsed.</p>\n\n<p><code>main</code> prints out the parsed <code>zoned_time</code> to ensure we have a loss-less round trip:</p>\n\n<pre><code>2019-09-11 12:37:04.846272000 EDT\n</code></pre>\n\n<p>In order to get a loss-less conversion that includes local time, one really needs to transmit the IANA time zone name, not just the current UTC offset.  With only the UTC offset, one can recover the exact UTC time point.  But one can not perform any local time arithmetic, or comparison with other local time points because one can not know the rules for when one changes the UTC offset.  Only with the full IANA time zone name can one pass the information along about those rules.</p>\n"}], "owner": {"reputation": 1802, "user_id": 1816260, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/PiN0u.jpg?s=128&g=1", "display_name": "Tito", "link": "https://stackoverflow.com/users/1816260/tito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568220533, "creation_date": 1568207466, "last_edit_date": 1568219909, "question_id": 57890001, "link": "https://stackoverflow.com/questions/57890001/java-to-c-utc-time-finding-the-utc-zone-time-offset-in-seconds", "title": "Java to C++ UTC time - finding the Utc Zone Time Offset in seconds", "body": "<p>I need to serialize a UTC date time instance from java to c++ using the minimal length of pure ByteBuffer of unsigned chars.\nI need the time point with to be able to support minimum nanoseconds precision.</p>\n\n<p>From the java side i have looked in the classes ZonedDateTime and OffsetDateTime and seen what kind of primitive they are using to store the time and all together this is equal to 17 bytes which is kind of a lot. </p>\n\n<p>Please note that i am here not transferring the zone itself since i have not found a way to map those  zone strings from IANA to integers. Thus i guess the zone offset will be enough. Since bought sides will have to convert their time point to a particular offset before sending it to the server lets say that will be UTC 0.   I am looking for a solution that is queering the local time i.e. no NTP servers involved!</p>\n\n<p>the java side looks like this:</p>\n\n<pre><code>        // 4 byte\n        Integer year = offsetDateTime.getYear();\n        // 1 byte           \n        Integer month = offsetDateTime.getMonthValue();\n        // 1 byte\n        Integer day = offsetDateTime.getDayOfMonth();\n        // 1 byte\n        Integer hour = offsetDateTime.getHour();\n        // 1 byte\n        Integer minutes = offsetDateTime.getMinute();\n        // 1 byte\n        Integer seconds = offsetDateTime.getSecond();\n        // 4 byte\n        Integer nanoSeconds = offsetDateTime.getNano();\n        // 4 byte\n        Integer utcZoneTimeTotalSecondsOffset = offsetDateTime.getOffset().getTotalSeconds(); \n</code></pre>\n\n<p>on the c++ side i need to do the same as well as to be able to construct a time point from all those integers above.\nI have found how to get the the above information except the utcOffset i.e. the last integer.</p>\n\n<p>i would like to use chrono to consume this buffer and instantiate a time point from it. however i am not able to find a way to to get the time offset in c++. How do i get the time offset with chrono and then construct a time point from the above information? </p>\n\n<pre><code>auto now = std::chrono::system_clock::now();\ntime_t itt = std::chrono::system_clock::to_time_t(now);\n\ntm utc_tm = *gmtime(&amp;itt);\n\nstd::cout &lt;&lt; utc_tm.tm_year + 1900 &lt;&lt; '-';\nstd::cout &lt;&lt; utc_tm.tm_mon + 1 &lt;&lt; '-';\nstd::cout &lt;&lt; utc_tm.tm_mday &lt;&lt; ' ';\nstd::cout &lt;&lt; utc_tm.tm_hour &lt;&lt; ':';\nstd::cout &lt;&lt; utc_tm.tm_min &lt;&lt; ':';\nstd::cout &lt;&lt; utc_tm.tm_sec &lt;&lt; '\\n';\n\n? wher is the time zoneOffset here ?\n</code></pre>\n\n<p>if i use</p>\n\n<pre><code> utc_tm.tm_gmtoff \n</code></pre>\n\n<p>this is giving me the wrong information . at least in my case. So i believe gmtoff is not the way to go , but if gmtoff is not the way then what is?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 3, "creation_date": 1568206512, "post_id": 57889615, "comment_id": 102200896, "body": "What are you trying to achieve ?"}], "answers": [{"tags": [], "owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "is_accepted": true, "score": 11, "last_activity_date": 1568206749, "creation_date": 1568206749, "answer_id": 57889775, "question_id": 57889615, "link": "https://stackoverflow.com/questions/57889615/why-the-user-defined-conversion-function-template-cannot-have-a-deduced-return-t/57889775#57889775", "title": "Why the user-defined conversion function template cannot have a deduced return type?", "body": "<p>Even if it was allowed, in the second line, there is nothing that depends on the template. \nIt can't be called (what is the purpose of <code>T</code> in that case ?)</p>\n\n<p>If you want to convert to a user defined type, then you'll do that:\nLet's say you have:</p>\n\n<pre><code>struct S\n{\n   template&lt;typename T&gt; operator T() { return T(42); }\n};\n</code></pre>\n\n<p>That's clear and there is no need to deduce anything.\nYou'd call this like this:</p>\n\n<pre><code>S s;\nint v = s;\nfloat f = s;\n</code></pre>\n\n<p>Please notice that, in that case, using <code>auto</code> instead of <code>float</code> in the code above would prevent the compiler to deduce the type (is it a <code>float</code> ? an <code>int</code> ? an <code>Orange</code> ?). The sentence above simply explains that.</p>\n"}], "owner": {"reputation": 51, "user_id": 837441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20521444dc0eb244821a8684a41a71c2?s=128&d=identicon&r=PG", "display_name": "cinemarter", "link": "https://stackoverflow.com/users/837441/cinemarter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 57889775, "answer_count": 1, "score": 4, "last_activity_date": 1568206749, "creation_date": 1568206261, "last_edit_date": 1568206532, "question_id": 57889615, "link": "https://stackoverflow.com/questions/57889615/why-the-user-defined-conversion-function-template-cannot-have-a-deduced-return-t", "title": "Why the user-defined conversion function template cannot have a deduced return type?", "body": "<p>What is the reason of the following rule, \"a user-defined conversion function template cannot have a deduced return type.\" </p>\n\n<pre><code>struct S {\n  operator auto() const { return 10; } // OK\n  template&lt;class T&gt; operator auto() const { return 42; } // error\n};\n</code></pre>\n"}, {"tags": ["c++", "windows", "networking"], "comments": [{"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 0, "creation_date": 1568206534, "post_id": 57889538, "comment_id": 102200909, "body": "What you are looking for is the network broadcast address, but there is also the Limited Broadcast address (all ones: <code>255.255.255.255</code>), and the (obsolete) all zeroes broadcast address (<code>0.0.0.0</code>). Broadcast itself is really obsolete because it wastes network and host resources, and multicast is what should be used for modern networking. That is why IPv6 has eliminated broadcast in favor of multicast. Many companies will not use applications that use broadcast because of wasted resources and the security implications."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 2405162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed1aae70da853f418c2283821ef80aa8?s=128&d=identicon&r=PG", "display_name": "DrJohnZoidberg", "link": "https://stackoverflow.com/users/2405162/drjohnzoidberg"}, "edited": false, "score": 0, "creation_date": 1568206941, "post_id": 57889777, "comment_id": 102201156, "body": "&gt; It&#39;s saying that if you are using GetIpAddrTable , the value of dwBCastAddr is wrong and useless. So don&#39;t use it.  Thanks! I was just making sure I wasn&#39;t going crazy as it just isn&#39;t super clear. The project I&#39;m using uses boost and I can use those methods to determine the broadcast address then but just was confused why it was getting set like this in the first place."}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 1, "last_activity_date": 1568206752, "creation_date": 1568206752, "answer_id": 57889777, "question_id": 57889538, "link": "https://stackoverflow.com/questions/57889538/i-need-help-understanding-getipaddrtable-and-the-interface-broadcast-address/57889777#57889777", "title": "I need help understanding GetIpAddrTable and the interface broadcast address", "body": "<blockquote>\n  <p>The proper value for this member is not returned by the GetIpAddrTable function.</p>\n</blockquote>\n\n<p>It's saying that if you are using <code>GetIpAddrTable</code> , the value of <code>dwBCastAddr</code> is wrong and useless. So don't use it.</p>\n\n<p>Instead you can calculate the broadcast address yourself from the IP address and subnet mask like so:</p>\n\n<pre><code> IPAddr.S_un.S_addr=  pIPAddrTable-&gt;table[i].dwAddr | ~pIPAddrTable-&gt;table[i].dwMask;\n printf(\"\\tBroadCast[%d]:    \\t%s\\n\", i, inet_ntoa(IPAddr));\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/29034878/how-can-i-determine-network-and-broadcast-address-from-the-ip-address-and-subnet\">How can I determine network and broadcast address from the IP address and subnet mask?</a> for more details.</p>\n"}], "owner": {"reputation": 81, "user_id": 2405162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed1aae70da853f418c2283821ef80aa8?s=128&d=identicon&r=PG", "display_name": "DrJohnZoidberg", "link": "https://stackoverflow.com/users/2405162/drjohnzoidberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 57889777, "answer_count": 1, "score": 0, "last_activity_date": 1568206752, "creation_date": 1568206040, "question_id": 57889538, "link": "https://stackoverflow.com/questions/57889538/i-need-help-understanding-getipaddrtable-and-the-interface-broadcast-address", "title": "I need help understanding GetIpAddrTable and the interface broadcast address", "body": "<p>I'm trying to use <code>GetIpAddrTable</code> (<a href=\"https://docs.microsoft.com/en-us/windows/win32/api/iphlpapi/nf-iphlpapi-getipaddrtable\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/api/iphlpapi/nf-iphlpapi-getipaddrtable</a>) to gather the interface addresses but I'm struggling to understand the response for <code>dwBCastAddr</code>.</p>\n\n<p>For my network the broadcast address for the interface should be <code>192.168.1.255</code> but all that <code>dwBCastAddr</code> returns is <code>1</code> and I have no idea what I'm supposed to do with that.</p>\n\n<p>The documentation for the data structure (<a href=\"https://docs.microsoft.com/en-us/windows/win32/api/ipmib/ns-ipmib-mib_ipaddrrow_w2k\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/api/ipmib/ns-ipmib-mib_ipaddrrow_w2k</a>) says the following:</p>\n\n<blockquote>\n  <p>dwBCastAddr</p>\n  \n  <p>Type: DWORD</p>\n  \n  <p>The broadcast address in network byte order. A broadcast address is typically >the IPv4 address with the host portion set to either all zeros or all ones.</p>\n  \n  <p>The proper value for this member is not returned by the GetIpAddrTable function.</p>\n</blockquote>\n\n<p>What are they trying to say here?</p>\n\n<p>This is the line used to get the broadcast address:</p>\n\n<pre><code>IPAddr.S_un.S_addr = (u_long)pIPAddrTable-&gt;table[i].dwBCastAddr;\n</code></pre>\n\n<p>I'm just trying to figure out how to get 192.168.1.255 out of this.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c++", "winapi", "loadlibrary", "dll-injection"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 1, "creation_date": 1568206223, "post_id": 57889378, "comment_id": 102200717, "body": "You should save the value of <code>GetLastError()</code> immediately after the function fails. Calling other OS functions (which <code>printf</code> does) can alter its value."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1568207335, "post_id": 57889378, "comment_id": 102201392, "body": "<code>QueueUserAPC</code> is wrong for IPC apc (because use current active activation context which is wrong for another process). you need use <code>ZwQueueApcThread</code> or <code>RtlQueueApcWow64Thread</code> if inject from 64 to 32 bit process. also you have big problem with logic - <code>if(hThread != INVALID_HANDLE_VALUE)</code> never executed - because always will be <code>(result != 0)</code> or <code>(result == 0)</code>. <code>hThread</code> who will be close ?"}, {"owner": {"reputation": 381, "user_id": 11737733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPKyG.jpg?s=128&g=1", "display_name": "Jeffreys", "link": "https://stackoverflow.com/users/11737733/jeffreys"}, "edited": false, "score": 0, "creation_date": 1568270399, "post_id": 57889378, "comment_id": 102222499, "body": "use <a href=\"https://github.com/Aekras1a/Updated-Carbanak-Source-with-Plugins/blob/d40434bfa3933b5980babfb1f5552659d73e7b9d/Carbanak%20-%20part%201/botep/core/include/core/ntdll.h\" rel=\"nofollow noreferrer\"><code>ZwQueueApcThread</code></a> or <code>RtlQueueApcWow64Thread</code> add the ntdll.h and ntdll.lib."}], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": -1, "last_activity_date": 1587160760, "creation_date": 1587160760, "answer_id": 61281414, "question_id": 57889378, "link": "https://stackoverflow.com/questions/57889378/queueuserapc-fails-with-invalid-handle-value/61281414#61281414", "title": "QueueUserAPC fails with INVALID_HANDLE_VALUE", "body": "<blockquote>\n  <p>But QueueUserApc returns zero(which means error) and when I do GetLastError, it returns </p>\n</blockquote>\n\n<p>\"If the function succeeds, the return value is nonzero.\"</p>\n\n<p>6 = ERROR_INVALID_HANDLE</p>\n\n<p>From <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-queueuserapc\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p>To ensure successful execution of functions used by the APC, APCs should be queued only to threads in the caller's process.</p>\n</blockquote>\n\n<p>For this reason you should use ZwQueueUserAPC or ZwQueueApcThreadEx which are undocumented functions exported by ntdll.dll</p>\n"}], "owner": {"reputation": 1, "user_id": 8442444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7146eca533da6ffa17650602da84b291?s=128&d=identicon&r=PG", "display_name": "user8442444", "link": "https://stackoverflow.com/users/8442444/user8442444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587160760, "creation_date": 1568205457, "question_id": 57889378, "link": "https://stackoverflow.com/questions/57889378/queueuserapc-fails-with-invalid-handle-value", "title": "QueueUserAPC fails with INVALID_HANDLE_VALUE", "body": "<p>I'm trying to inject dll into explorer.exe (simple 64bit dll that shows messagebox )</p>\n\n<p>But QueueUserApc returns zero(which means error) and when I do GetLastError, it returns 6</p>\n\n<p>I think something goes wrong at line 81 which calls QueueUserApc</p>\n\n<p>Please help me\nI'm trying to solve this problem for 2 days\n \u200d  \u200d  \u200d  \u200d  \u200d  \u200d </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;WinUser.h&gt;\n#include &lt;TlHelp32.h&gt;\n#include &lt;vector&gt;\n\nusing std::vector;\n\nBOOL EnableDebugPriv() {\n    HANDLE hToken;\n    LUID Value;\n    TOKEN_PRIVILEGES tp;\n    if (!OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken))\n        return(GetLastError());\n    if (!LookupPrivilegeValue(NULL, SE_DEBUG_NAME, &amp;Value))\n        return(GetLastError());\n    tp.PrivilegeCount = 1;\n    tp.Privileges[0].Luid = Value;\n    tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;\n    if (!AdjustTokenPrivileges(hToken, FALSE, &amp;tp, sizeof(tp), NULL, NULL)) {\n        return FALSE;\n    }\n    CloseHandle(hToken);\n    return TRUE;\n}\n\n\nDWORD getPidByName(LPCSTR name, vector&lt;DWORD&gt; &amp;tids) {\n    DWORD pid = NULL;\n    HANDLE hSnapshot = INVALID_HANDLE_VALUE;\n    PROCESSENTRY32 pe;\n    THREADENTRY32 te;\n\n    pe.dwSize = sizeof(pe);\n    te.dwSize = sizeof(te);\n    hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPALL, NULL);\n\n    Process32First(hSnapshot, &amp;pe);\n    do {\n        if (strcmp(name, pe.szExeFile) == 0) {\n            pid = pe.th32ProcessID;\n            if (Thread32First(hSnapshot, &amp;te)) {\n                do {\n                    if (te.th32OwnerProcessID == pid) {\n                        tids.push_back(te.th32ThreadID);\n                    } \n                } while (Thread32Next(hSnapshot, &amp;te));\n            }\n            break;\n        }\n\n    } while (Process32Next(hSnapshot, &amp;pe));\n    CloseHandle(hSnapshot);\n\n    return pid;\n\n}\n\nBOOL injectDll(LPCSTR path, DWORD pid, vector&lt;DWORD&gt; &amp;tids) {\n\n    HANDLE hProcess, hThread = INVALID_HANDLE_VALUE;\n    LPVOID pRemoteBuf;\n    DWORD dwBufSize = lstrlen(path) + 1;\n    LPTHREAD_START_ROUTINE pThreadProc;\n    if (!(hProcess = OpenProcess(PROCESS_VM_WRITE | PROCESS_VM_OPERATION, FALSE, pid))) {\n        return FALSE;\n    }\n    if (!(pRemoteBuf = VirtualAllocEx(hProcess, NULL, dwBufSize, MEM_COMMIT, PAGE_READWRITE))) {\n        return FALSE;\n    }\n    WriteProcessMemory(hProcess, pRemoteBuf, (LPVOID)path, dwBufSize, NULL);\n    pThreadProc = (LPTHREAD_START_ROUTINE)GetProcAddress(GetModuleHandleA(\"kernel32.dll\"), \"LoadLibraryA\");\n\n    if (pThreadProc == NULL) {\n        return FALSE;\n    }\n    printf(\"tids size: %d\\n\", tids.size());\n    for (int i = 0; i &lt; tids.size(); i++) {\n        hThread = OpenThread(THREAD_SET_CONTEXT, FALSE, tids[i]);\n        if (hThread != NULL) {\n            DWORD result = QueueUserAPC((PAPCFUNC)pThreadProc, hThread, (ULONG_PTR)pRemoteBuf);\n            if (result != 0) {\n                printf(\"[*] Injection Succeed!\");\n            }\n            else if (result == 0) {\n                printf(\"0 RESULT\\n\");\n                printf(\"result val: %d\\n\", result);\n                printf(\"GetLastError: %d\\n\", GetLastError());\n            }\n            else if(hThread != INVALID_HANDLE_VALUE) {\n                printf(\"INVALID_HANDLE_VALUE\");\n            }\n        }\n    }\n\n    CloseHandle(hProcess);\n    return TRUE;\n}\n\nint main() {\n\n    vector&lt;DWORD&gt; tids;\n    EnableDebugPriv();\n    printf(\"%d\", getPidByName(\"explorer.exe\", tids));\n    if (injectDll(\"C:\\\\Dll1.dll\", getPidByName(\"explorer.exe\", tids), tids)) {\n        printf(\"[*] Finally Succeed!\\n\");\n    }\n    else {\n        printf(\"ERROR\");\n    }\n}\n```c++\n</code></pre>\n"}, {"tags": ["c++", "numpy", "opencv", "image-processing", "mat"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1568205815, "post_id": 57889151, "comment_id": 102200482, "body": "You probably need to include some of the infrastructure of the OpenCV Python bindings. Did you look at that code to see how it works?"}, {"owner": {"reputation": 151, "user_id": 6911480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1daab39250cf2bfa7ccb9c7b68d53e?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/6911480/saeed"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1568206226, "post_id": 57889151, "comment_id": 102200720, "body": "@crisluengo look at which code?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1568206565, "post_id": 57889151, "comment_id": 102200927, "body": "<a href=\"https://github.com/opencv/opencv/tree/master/modules/python/src2\" rel=\"nofollow noreferrer\">github.com/opencv/opencv/tree/master/modules/python/src2</a>"}, {"owner": {"reputation": 606, "user_id": 10334333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T6E1x.jpg?s=128&g=1", "display_name": "Vencat", "link": "https://stackoverflow.com/users/10334333/vencat"}, "edited": false, "score": 0, "creation_date": 1568213883, "post_id": 57889151, "comment_id": 102205150, "body": "This may help you -&gt; <a href=\"https://medium.com/@keithwhitley/using-c-with-python-3-in-2018-480f3e46c8c\" rel=\"nofollow noreferrer\">1</a>, <a href=\"https://cffi.readthedocs.io/en/latest/using.html#function-calls\" rel=\"nofollow noreferrer\">2</a>. IMHO you won&#39;t see much performance difference for your function between C++ &amp; Python, bcuz OpenCV used to optimize their python functions in the backend using C."}, {"owner": {"reputation": 151, "user_id": 6911480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1daab39250cf2bfa7ccb9c7b68d53e?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/6911480/saeed"}, "reply_to_user": {"reputation": 606, "user_id": 10334333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T6E1x.jpg?s=128&g=1", "display_name": "Vencat", "link": "https://stackoverflow.com/users/10334333/vencat"}, "edited": false, "score": 0, "creation_date": 1568279332, "post_id": 57889151, "comment_id": 102226780, "body": "@vencat But I test the watermark c++ function vs python c++ function. they had a so much difference. c++ function takes 0.6 second but python code takes near 14 nanoseconds."}, {"owner": {"reputation": 606, "user_id": 10334333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T6E1x.jpg?s=128&g=1", "display_name": "Vencat", "link": "https://stackoverflow.com/users/10334333/vencat"}, "edited": false, "score": 0, "creation_date": 1568284511, "post_id": 57889151, "comment_id": 102229652, "body": "@Saeed You mean Python OpenCV function takes 0.6 seconds and C++ function takes 14 nanoseconds.?"}, {"owner": {"reputation": 151, "user_id": 6911480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1daab39250cf2bfa7ccb9c7b68d53e?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/6911480/saeed"}, "reply_to_user": {"reputation": 606, "user_id": 10334333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T6E1x.jpg?s=128&g=1", "display_name": "Vencat", "link": "https://stackoverflow.com/users/10334333/vencat"}, "edited": false, "score": 0, "creation_date": 1568287277, "post_id": 57889151, "comment_id": 102231113, "body": "@vencat yes. you are right. c++ function do so faster."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 10386457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4539276f6d8139d2df07c6271e3e81?s=128&d=identicon&r=PG&f=1", "display_name": "mbouchi", "link": "https://stackoverflow.com/users/10386457/mbouchi"}, "is_accepted": false, "score": 0, "last_activity_date": 1568206695, "creation_date": 1568206695, "answer_id": 57889753, "question_id": 57889151, "link": "https://stackoverflow.com/questions/57889151/how-to-pass-cvmat-objects-from-a-python-module-to-a-c-function-and-give-back/57889753#57889753", "title": "How to pass cv::mat objects from a python module to a c++ function and give back returned object which is type cv::mat?", "body": "<p>Maybe consider using the Boost-Python library for interfacing between Python and C++. </p>\n"}], "owner": {"reputation": 151, "user_id": 6911480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b1daab39250cf2bfa7ccb9c7b68d53e?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/6911480/saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568206695, "creation_date": 1568204826, "question_id": 57889151, "link": "https://stackoverflow.com/questions/57889151/how-to-pass-cvmat-objects-from-a-python-module-to-a-c-function-and-give-back", "title": "How to pass cv::mat objects from a python module to a c++ function and give back returned object which is type cv::mat?", "body": "<p>I try to start a project with Django which a part of that is about showing some images. \nAs probably you know, c++ is so faster than python. so I wrote a c++ function which receives two Mat type input and do some pre processing on them and finally return a cv::mat variable as it's output.</p>\n\n<p>I want to call this function inside my python module and send from my python code, two images as input argument and show the result of c++ function in my django project.</p>\n\n<p>I tried to call my c++ function with ctypes.CDLL, ctypes work with simple functions but for this c++ code gives a memory error.</p>\n\n<p>this is my c++ function:</p>\n\n<pre><code>extern \"C\" Mat watermark2(Mat source_img, Mat logo)\n{\n        // Simple watermark\n\n        double alpha = 0.5;\n\n        int width = logo.size().width;\n        int height = logo.size().height;\n        int x_pos = rand() % (source_img.size().width - width);\n        int y_pos = rand() % (source_img.size().height - height);\n\n        cv::Rect pos = cv::Rect(x_pos, y_pos, width, height);\n        addWeighted(source_img(pos), alpha, logo, 1 - alpha, 0.0, source_img(pos));\n\n        return source_img;\n}\n</code></pre>\n\n<p>as you see, this is a simple function and don't use a lot of memory. I test it for some very small pictures and I saw the same error.</p>\n\n<p>I search a lot in net and found some instructions about Wrapping C/C++ for Python. but I don't sure that it can help me.</p>\n\n<p>because I'm new in Django, can anybody help me how to negotiate from my python code which I have two images with my c++ function to some manipulate on images and save the returned output in my Django?</p>\n"}, {"tags": ["c++", "opencv", "cuda", "pixel", "gpu"], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 11549805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/485b34152b0a5062449aae2af4b8e868?s=128&d=identicon&r=PG&f=1", "display_name": "TheBarrometer", "link": "https://stackoverflow.com/users/11549805/thebarrometer"}, "is_accepted": false, "score": 2, "last_activity_date": 1568205751, "creation_date": 1568205751, "answer_id": 57889466, "question_id": 57889128, "link": "https://stackoverflow.com/questions/57889128/how-to-access-pixel-in-opencv-cuda-gpumat/57889466#57889466", "title": "how to access pixel in OpenCV Cuda (GpuMat)", "body": "<p>The <code>cv::cuda::GpuMat</code> class has it's data live on the GPU/device, and this cannot be directly accessed by CPU/host code. This is why there is no equivalent to <code>cv::Mat.at()</code>. Transferring data between the host and device is slow, and doing a per pixel operation on a <code>cv::cuda::GpuMat</code> would therefore be far slower than on a <code>cv::Mat</code>.</p>\n\n<p>It is however possible to write CUDA kernels which perform per-pixel operations. I'm afraid that while I can't give good advice on this, that this is apparently doable and there are answers to similar problems <a href=\"https://stackoverflow.com/questions/44174092/how-to-multiply-two-opencv-matrices-in-a-kernel-function-in-cuda\">such as this one</a> that might be able to help you.</p>\n\n<p>Outside of that depending on exactly what you need to do there might be a build in function that does something similar.</p>\n"}], "owner": {"reputation": 17, "user_id": 11931853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tDm2kTVp1ng/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQyJXSxZH6oKZTi3xhVQ0Aoi1R7g/photo.jpg?sz=128", "display_name": "HSD", "link": "https://stackoverflow.com/users/11931853/hsd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1568205751, "creation_date": 1568204718, "question_id": 57889128, "link": "https://stackoverflow.com/questions/57889128/how-to-access-pixel-in-opencv-cuda-gpumat", "title": "how to access pixel in OpenCV Cuda (GpuMat)", "body": "<pre><code>cv::Mat image = cv::Mat::zeros(1920,1080,CV_8UC4); //it's an example (I use image have 4 channel)\ncv::Vec4b&amp; pixel = image.at&lt;cv::Vec4b&gt;(i,j) // i and j is rows and cols\n</code></pre>\n\n<p>I want to use Cuda(GpuMat) and there is no \".at\"</p>\n\n<p>how can I change my code for accessing the pixels</p>\n"}, {"tags": ["c++", "gcc", "optimization", "while-loop", "evaluation"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 10, "creation_date": 1568204844, "post_id": 57889116, "comment_id": 102199920, "body": "It&#39;s not &quot;it can lead to undefined behaviour&quot;. <i>It is</i> Undefined behaviour. Compiler is allowed to do absolutely anything with that code, <b>in particular</b> when optimizing code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1568204848, "post_id": 57889116, "comment_id": 102199926, "body": "<i>I know that updateError is not returning anything, which can lead to undefined behavior</i> Not can but <b>will</b>.  Analyzing your code while it has UB in it is pointless.  Since the path of execution encounters UB your entire program becomes UB and anything can happen at any time."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1568205093, "post_id": 57889116, "comment_id": 102200072, "body": "You might want to check the generated assembly and compare the optimized build with the unoptimized. A good way to do that is through the <a href=\"https://godbolt.org/z/YCKAIG\" rel=\"nofollow noreferrer\">compiler explorer site</a>. As can be seen there can be quite a difference!"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1568205445, "post_id": 57889116, "comment_id": 102200296, "body": "On my system, the output is <code>runtime error: execution reached the end of a value-returning function without returning a value</code>"}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 4, "creation_date": 1568206465, "post_id": 57889116, "comment_id": 102200857, "body": "You explicitly write an undefined behaviour and you ask a question about why the program doesn&#39;t behave as you would expect. UB means that you cannot expect anything (or in other word, anything can happen). This question sounds like <i>&quot;I had a toy, I destroyed it with a hammer. Can you explain why is it broken now ?&quot;</i> :)"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1568207319, "post_id": 57889116, "comment_id": 102201382, "body": "There was cppcon about optimization flags, where it was explained why <code>-O3</code> can have weird results for floating point operations (and in general it is not recommended for crucial calculations). I will try to find link to this talk (<a href=\"https://youtu.be/w5Z4JlMJ1VQ\" rel=\"nofollow noreferrer\">maybe this is that</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 1, "creation_date": 1568207321, "post_id": 57889327, "comment_id": 102201385, "body": "As a side note, here&#39;s it&#39;s <b>obvious</b> UB. Sometimes, it&#39;s less obvious. In that case, I suggest to run the binary under Valgrind, it&#39;ll report <code>Conditional move depends on uninitialized value</code> errors that <b>must</b> be fixed."}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568207475, "post_id": 57889327, "comment_id": 102201470, "body": "Compiler are deterministic. So the next day, you&#39;ll get the same result with the same compiler. What you probably meant is that you might not get the same program output when run another time, since the program is currently picking whatever register state for return of <code>updateError</code> and because of random placement of the program in memory when loaded, it can be different."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568207559, "post_id": 57889327, "comment_id": 102201511, "body": "@xryl669 well it was a bit sloppy. Maybe you get the same result, but I highly doubt that a compiler will make any guarantees about it"}, {"owner": {"reputation": 74, "user_id": 7687213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cbd6173af37548b4ec595af711a48ed?s=128&d=identicon&r=PG&f=1", "display_name": "atsteich", "link": "https://stackoverflow.com/users/7687213/atsteich"}, "edited": false, "score": 0, "creation_date": 1568210866, "post_id": 57889327, "comment_id": 102203423, "body": "I see, so is there any reason it is allowed to not return a variable in a non void function?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 74, "user_id": 7687213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cbd6173af37548b4ec595af711a48ed?s=128&d=identicon&r=PG&f=1", "display_name": "atsteich", "link": "https://stackoverflow.com/users/7687213/atsteich"}, "edited": false, "score": 1, "creation_date": 1568621991, "post_id": 57889327, "comment_id": 102317877, "body": "@atsteich the point is: it is not allowed. Problem is just that in general the compiler cannot decide whether this is the case easily. In your simple example you should get a warning, but note that there are many things that are not allowed but the compiler is not required to issue an error"}], "tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 10, "last_activity_date": 1568207675, "last_edit_date": 1568207675, "creation_date": 1568205301, "answer_id": 57889327, "question_id": 57889116, "link": "https://stackoverflow.com/questions/57889116/different-evaluation-when-compiling-with-o3/57889327#57889327", "title": "Different evaluation when compiling with -O3", "body": "<blockquote>\n  <p>I know that updateError is not returning anything, which can lead to undefined behavior.</p>\n</blockquote>\n\n<p>There is no \"can\". Your code has undefined behaviour. Period.</p>\n\n<p>On debug builds the compiler does some stuff extra to enhance the usage of a debugger. This can be things like initializing variables when they actually dont have to be. Such overhead is not done in optimized builds. Anyhow, if you want to understand why you get the results you get you should take a look at the assembly. Just be aware that UB is UB, so you have no guarantee that on the next day you get the same results with the same compiler.</p>\n\n<blockquote>\n  <p>What i don't understand is, that error is set to zero inside the loop if compiled with -O3, and if(error > eps) is evaluated as false, while it is still evaluated as true in the while() statement. .</p>\n</blockquote>\n\n<p>Note that the code you write is not translated line by line to instructions of your CPU. Compilers are rather clever and apply all kinds of transformations under the as-if rule. As long as the observable behaviour is the same the compiler is allowed to turn your code into something that is  quite different from a naive line-by-line translation. If however your code has UB, then it is not valid c++ code and getting differnt output for one and the same variable is not a big surprise.</p>\n"}], "owner": {"reputation": 74, "user_id": 7687213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cbd6173af37548b4ec595af711a48ed?s=128&d=identicon&r=PG&f=1", "display_name": "atsteich", "link": "https://stackoverflow.com/users/7687213/atsteich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568207675, "creation_date": 1568204673, "last_edit_date": 1568205750, "question_id": 57889116, "link": "https://stackoverflow.com/questions/57889116/different-evaluation-when-compiling-with-o3", "title": "Different evaluation when compiling with -O3", "body": "<p>The following Code has different behavior, when it is compiled with <code>g++ -O3 ..</code> and without <code>-O3</code>. </p>\n\n<p>I know that <code>updateError</code> is not returning anything, which can lead to undefined behavior. What i don't understand is, that <code>error</code> is set to zero inside the loop if compiled with -O3, and <code>if(error &gt; eps)</code> is evaluated as false, while it is still evaluated as true in the <code>while()</code> statement. .</p>\n\n<p>I have also tried to change it to a do{}while() loop, in that case it worked also with -O3...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nusing namespace std;\n\n\ndouble updateError(){\n    printf(\"updating Error\\n\");\n}\n\nint main(int argc, char *argv[]){\n\n    double eps = 1.e-10;\n    double error = 2*eps;\n    int iter = 0;\n\n    while(error &gt; eps){\n        error = updateError();\n        iter++;\n        printf(\"Error on iteration %i: %.20e\\n\", iter, error);\n        if(error &gt; eps) printf(\"error bigger\\n\\n\");\n        else printf(\"error smaller\\n\\n\");\n        if(iter == 5){\n            printf(\"not converged in 5 iterations!!\\n\");\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Console output with -O3:</p>\n\n<pre><code>updating Error\nError on iteration 1: 0.00000000000000000000e+00\nerror smaller\n\nupdating Error\nError on iteration 2: 0.00000000000000000000e+00\nerror smaller\n\nupdating Error\nError on iteration 3: 0.00000000000000000000e+00\nerror smaller\n\nupdating Error\nError on iteration 4: 0.00000000000000000000e+00\nerror smaller\n\nupdating Error\nError on iteration 5: 0.00000000000000000000e+00\nerror smaller\n\nnot converged in 5 iterations!!\n</code></pre>\n\n<p>Console output without -O3:</p>\n\n<pre><code>updating Error\nError on iteration 1: 6.92743341769227318242e-310\nerror smaller\n</code></pre>\n"}, {"tags": ["c++", "template-meta-programming"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1568204733, "post_id": 57889111, "comment_id": 102199828, "body": "How about <code>Result&lt;void&gt;</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1568204741, "post_id": 57889111, "comment_id": 102199832, "body": "You cannot overload classes."}, {"owner": {"reputation": 1518, "user_id": 2717954, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f9aff1ddcc010a77fca4c1840c1d294d?s=128&d=identicon&r=PG&f=1", "display_name": "user2717954", "link": "https://stackoverflow.com/users/2717954/user2717954"}, "edited": false, "score": 0, "creation_date": 1568204770, "post_id": 57889111, "comment_id": 102199859, "body": "you can also have a Result&lt;&gt;"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1568206431, "post_id": 57889111, "comment_id": 102200832, "body": "Why not <code>void function1(...)</code>?"}, {"owner": {"reputation": 1292, "user_id": 1137023, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43894ad6f603e8c95d9a208b83d20ffb?s=128&d=identicon&r=PG", "display_name": "Dcow", "link": "https://stackoverflow.com/users/1137023/dcow"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1568211998, "post_id": 57889111, "comment_id": 102204058, "body": "@jxh because class Result is much more complex  than I showed in example."}], "answers": [{"tags": [], "owner": {"reputation": 1518, "user_id": 2717954, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f9aff1ddcc010a77fca4c1840c1d294d?s=128&d=identicon&r=PG&f=1", "display_name": "user2717954", "link": "https://stackoverflow.com/users/2717954/user2717954"}, "is_accepted": false, "score": 2, "last_activity_date": 1568205189, "last_edit_date": 1568205189, "creation_date": 1568204873, "answer_id": 57889170, "question_id": 57889111, "link": "https://stackoverflow.com/questions/57889111/template-class-with-no-template-class-twin/57889170#57889170", "title": "Template class with no template class twin", "body": "<p>you can do something like:</p>\n\n<pre><code>template &lt;class ResultValue=void&gt;\nclass Result {/*a certain implementation*/};\n\ntemplate &lt;&gt;\nstruct Result&lt;void&gt; {/*another implementation*/};\n\nResult&lt;&gt; myResult;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 1, "last_activity_date": 1568222548, "last_edit_date": 1568222548, "creation_date": 1568205218, "answer_id": 57889299, "question_id": 57889111, "link": "https://stackoverflow.com/questions/57889111/template-class-with-no-template-class-twin/57889299#57889299", "title": "Template class with no template class twin", "body": "<p>No. A template must be followed by template arguments, except in the case of a template template parameter or CTAD. Sadly, CTAD for return type deduction is not a thing yet.</p>\n\n<p>What you can do instead is to name them differently:</p>\n\n<pre><code>class result { /* ... */ };\n\ntemplate&lt;class ResultValue&gt;\nclass basic_result { /* ... */ };\n</code></pre>\n\n<p>This is analogous to the <code>std::string</code> class which is an alias to <code>std::basic_string&lt;char&gt;</code></p>\n"}], "owner": {"reputation": 1292, "user_id": 1137023, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/43894ad6f603e8c95d9a208b83d20ffb?s=128&d=identicon&r=PG", "display_name": "Dcow", "link": "https://stackoverflow.com/users/1137023/dcow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57889299, "answer_count": 2, "score": 1, "last_activity_date": 1568222548, "creation_date": 1568204651, "last_edit_date": 1568222517, "question_id": 57889111, "link": "https://stackoverflow.com/questions/57889111/template-class-with-no-template-class-twin", "title": "Template class with no template class twin", "body": "<p>Is it possible to write template class with this behavior:</p>\n\n<pre><code>class Result { /* ... */ };\n\ntemplate&lt;class ResultValue&gt;\nclass Result { /* ... */ };\n</code></pre>\n\n<p>And use it as return value of some API. Like:</p>\n\n<pre><code>Result function1(); // no 'Result' params\nResult&lt;WithParam&gt; function2();\n</code></pre>\n"}, {"tags": ["c++", "c", "button", "arduino"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1568204065, "post_id": 57888849, "comment_id": 102199446, "body": "Detect the <i>transition</i> of the button by remembering its previous state."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1568204243, "post_id": 57888849, "comment_id": 102199527, "body": "What have you tried to achieve the desired behavior?"}, {"owner": {"reputation": 35, "user_id": 11945570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5NwgtYhD6To/AAAAAAAAAAI/AAAAAAAAAX0/z4T_TsC6y5E/photo.jpg?sz=128", "display_name": "KD Technology", "link": "https://stackoverflow.com/users/11945570/kd-technology"}, "edited": false, "score": 0, "creation_date": 1568204456, "post_id": 57888849, "comment_id": 102199655, "body": "I used an interrupt that runs a function whenever the button is released. Inside that function I putted the <code>analogWrite(LAUNCHER_PIN, strength)</code>"}, {"owner": {"reputation": 195, "user_id": 9160296, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XcnIPX-keoM/AAAAAAAAAAI/AAAAAAAAABU/O40XwOBR62s/photo.jpg?sz=128", "display_name": "Avinash Kumar Ranjan", "link": "https://stackoverflow.com/users/9160296/avinash-kumar-ranjan"}, "edited": false, "score": 0, "creation_date": 1568204512, "post_id": 57888849, "comment_id": 102199693, "body": "Attach <i>interrupt</i> on push button and detect transition changes form unpressed state to pressed down state and vice versa."}, {"owner": {"reputation": 35, "user_id": 11945570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5NwgtYhD6To/AAAAAAAAAAI/AAAAAAAAAX0/z4T_TsC6y5E/photo.jpg?sz=128", "display_name": "KD Technology", "link": "https://stackoverflow.com/users/11945570/kd-technology"}, "edited": false, "score": 0, "creation_date": 1568204564, "post_id": 57888849, "comment_id": 102199735, "body": "I want that only when I release the button the motor will get the strength value once (the final value).  On my code it sends the value every 300ms so the motor&#39;s strength changes with my press."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568218616, "post_id": 57888990, "comment_id": 102207742, "body": "very simple solution! Alongside with a external interrupt, this would be very responsive"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1568204740, "last_edit_date": 1568204740, "creation_date": 1568204297, "answer_id": 57888990, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57888990#57888990", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>This is could easily be solved with a simple <em>state machine</em>.</p>\n\n<p>You could have two states: <code>NORMAL</code>, <code>BUTTON_DOWN</code>.</p>\n\n<p>Normally you should be in the <code>NORMAL</code> state, and the <code>loop</code> function checks if the button is pressed or not. If the button is pressed and you're in state <code>NORMAL</code>, then you set the state to <code>BUTTON_DOWN</code> and do whatever other processing you need to do when the button is pressed.</p>\n\n<p>If the button is not pressed, and the current state is <code>BUTTON_DOWN</code> you know that the button have been released and you go back to the <code>NORMAL</code> state and do the button-release processing that needs to be done.</p>\n\n<p>Since you only have two states, you could represent that as a single <code>bool</code> variables, where (for example) <code>false</code> means <code>NORMAL</code> and <code>true</code> means <code>BUTTON_DOWN</code>.</p>\n\n<p>In <strong><em>pseudo</strong> code</em> it could be something like</p>\n\n<pre><code>void loop()\n{\n    if (state == NORMAL)\n    {\n        // Do normal processing\n\n        if (is_button_pressed())\n        {\n            // Do buttown-down processing\n\n            state = BUTTON_DOWN;\n        }\n    }\n    else if (state == BUTTON_DOWN)\n    {\n        if (!is_button_pressed())\n        {\n            // Do button-release processing\n\n            state = NORMAL;\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>By adding a third state, <code>BUTTON_DEBOUNCE</code>, you could easily handle debounce of the button.</p>\n\n<p>When in state <code>NORMAL</code> and you detect the button being pressed, you enter the <code>BUTTON_DEBOUNCE</code> state. If you have been in the <code>BUTTON_DEBOUNCE</code> state for a certain amount of time (say a few milliseconds) and the button is still pressed then you enter the <code>BUTTON_PRESSED</code> state and to the button-pressed processing.</p>\n\n<p>If after the short time the button is not pressed, you go back to the <code>NORMAL</code> state.</p>\n\n<p>If you add a third state like this, then you can no longer have a simple <code>bool</code> variable representing the state. An enumeration and a variable of that enumeration type might be a better choice then.</p>\n"}, {"tags": [], "owner": {"reputation": 210, "user_id": 11877755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dfb50469543aeadf2a1a28117e5c1b0?s=128&d=identicon&r=PG&f=1", "display_name": "amaldec23", "link": "https://stackoverflow.com/users/11877755/amaldec23"}, "is_accepted": false, "score": 1, "last_activity_date": 1568204351, "creation_date": 1568204351, "answer_id": 57889006, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57889006#57889006", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>You can use flag to solve this issue,create a flag variable <strong>boolean</strong> and set it <strong>true</strong> and <strong>false</strong> when event occurs and only pass the value when flag is true</p>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568218534, "post_id": 57889212, "comment_id": 102207693, "body": "Although this does work, it&#39;s not advised as it locks your system in a loop, so if you need to keep track of other stuff or to have control of other outputs, this would make it harder for you to control... Possibly making so that you duplicate your remaining code to occur inside and outside of your infinite loop"}, {"owner": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "reply_to_user": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568272449, "post_id": 57889212, "comment_id": 102223322, "body": "@BrenoTeodoro True, if you need something to be running regularly in your main loop, then a solution like the one proposed by SomeProgrammerDude is the correct one. The only benefit of this one, is that it takes a fraction of the code and in many situations is &quot;good enough&quot;."}, {"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "edited": false, "score": 0, "creation_date": 1568289242, "post_id": 57889212, "comment_id": 102232158, "body": "Agreed, your code would suffice for most applications, and would only present the issue raised in a fraction of them. It also has the advantage of occupying very little space in memory. It&#39;s an effective way of resolving the issue, just thought I&#39;d point out this minor issue, should KD Technology face it in the future."}], "tags": [], "owner": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "is_accepted": false, "score": 0, "last_activity_date": 1568204993, "creation_date": 1568204993, "answer_id": 57889212, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57889212#57889212", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>If you don't need your main process to continue doing stuff while you press buttons, then you can do something like:</p>\n\n<pre><code>while (!digitalRead(MOTOR_BTN_PIN))\n{\n    if (digitalRead(MOTOR_BTN_PIN))\n        update();\n}\n</code></pre>\n\n<p>When you press the button you get trapped in the while, and when you finally let go <code>update()</code> gets called (once).</p>\n"}, {"comments": [{"owner": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "edited": false, "score": 0, "creation_date": 1568272155, "post_id": 57893099, "comment_id": 102223207, "body": "<code>btn_prev = digitalRead(btnPin);</code> should probably be <code>btn_prev = btn</code> instead, otherwise you risk that the button state changes between the top and bottom of the loop. Which would mean that <code>btn</code> reads <code>LOW</code> at the top, button is pressed during the <code>if</code>, <code>btn_prev</code> reads <code>HIGH</code> at the bottom, and then in the next loop <code>btn</code> is also read as <code>HIGH</code> - and now you just lost a button press. If you instead limit it to a single read per loop, and just remember the last logic value, then the race condition goes away."}, {"owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "reply_to_user": {"reputation": 1880, "user_id": 11829247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7ed099888314cc282b63908b890a76?s=128&d=identicon&r=PG&f=1", "display_name": "Frodyne", "link": "https://stackoverflow.com/users/11829247/frodyne"}, "edited": false, "score": 0, "creation_date": 1568288902, "post_id": 57893099, "comment_id": 102231968, "body": "The ATmega328P, present in the most common arduino Uno and Nano boards, can perform roughly 8 million instructions a second, so your code would have to be very heavy to have this situation occur. In the same scenario, with your suggestion applied, if I read the value while pressing, release and press again before the loop has finished, you&#39;ve just lost a button press. The way I proposed is intended to lessen the odds of this happening, as the last &amp; the fist actions are to read and compare the values. To eliminate the issue altogether, we should make use of External Interrupts."}], "tags": [], "owner": {"reputation": 302, "user_id": 11958215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9htzU.jpg?s=128&g=1", "display_name": "Breno Teodoro", "link": "https://stackoverflow.com/users/11958215/breno-teodoro"}, "is_accepted": false, "score": 0, "last_activity_date": 1568218347, "creation_date": 1568218347, "answer_id": 57893099, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released/57893099#57893099", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>You need to get the \"edge\" of the signal when it's going down. </p>\n\n<p>You can think of a buttons signal as a square. When the button is not pressed there is nothing, when you press it, the voltage flows, so it looks like this (this image illustrates a system where you connect your button in pulldown):</p>\n\n<p><a href=\"https://i.stack.imgur.com/fAE9W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fAE9W.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, in total, there are four states of a given digital signal:</p>\n\n<ol>\n<li>There is <em>nothing</em> (this can either be a <strong>LOW</strong> or a <strong>HIGH</strong>, depending on your connection; in the example I brought, the <em>nothing</em> relates to a <strong>HIGH</strong> signal, as I turned on the built-in PULLUP resistor of the arduino digital pin);</li>\n<li>There is a <em>signal</em> (which is always the inverse of point <strong>1</strong>;</li>\n<li>There is a ramp from <em>nothing</em> to <em>signal</em>;</li>\n<li>There is a ramp from <em>signal</em> to <em>nothing</em></li>\n</ol>\n\n<p>In your case, you'll make use of point <strong>4</strong>, as this is the state where the button is no longer pressed, and the microcontroller stops receiving signal.</p>\n\n<p>Try this:</p>\n\n<pre><code>#define btnPin 2\n\nuint8_t btn_prev;\n\nvoid setup() {\n  pinMode(btnPin, INPUT_PULLUP);\n\n  // here the previous button signal is set to HIGH, as we enabled the pullup\n  btn_prev = digitalRead(btnPin);\n}\n\nvoid loop() {\n //for each iteration we read the button singal\n uint8_t btn = digitalRead(btnPin);\n\n // we call your update function when the button was low and is now high: a.k.a. falling edge\n if (btn == LOW &amp;&amp; btn_prev == HIGH)\n  {\n    update();\n  }\n\n  // at last, we update the previous state of the button, so that we can check again for a change in the next iteration\n  btn_prev = digitalRead(btnPin);\n}\n</code></pre>\n\n<p>Hope this makes sense.</p>\n"}], "owner": {"reputation": 35, "user_id": 11945570, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5NwgtYhD6To/AAAAAAAAAAI/AAAAAAAAAX0/z4T_TsC6y5E/photo.jpg?sz=128", "display_name": "KD Technology", "link": "https://stackoverflow.com/users/11945570/kd-technology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1568218347, "creation_date": 1568203862, "question_id": 57888849, "link": "https://stackoverflow.com/questions/57888849/how-to-send-a-variables-value-only-once-when-a-push-button-is-released", "title": "How to send a variable&#39;s value only once when a push button is released?", "body": "<p>So I have a push button that changes a variable value, which controls a motor's strength, when pressed. It goes through a loop back and forth and stops when I release it.</p>\n\n<p>The problem is that whenever the value changes it's being sent to the motor. I want the value to change when I press the button (without sending it to the motor) and when I'll release the button the value will be sent once to the motor (instead of the motor will change its strength very fast all the time and shake).</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>increment = 1;\n        void update() {\n            if (millis() - last_update &gt; 300) {\n                last_update = millis();\n                strength += increment;\n                analogWrite(LAUNCHER_PIN, strength);\n                Serial.print(\"Canon strength: \");\n                Serial.print(strength);\n                if (strength &lt;= CANON_MIN || strength &gt;= CANON_MAX) increment = -increment;\n            }\n        }\nif (!digitalRead(MOTOR_BTN_PIN)) update();\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 2, "creation_date": 1568203136, "post_id": 57888620, "comment_id": 102198954, "body": "There\u2019s a huge difference between <code>template&lt;double x&gt;</code> and <code>x&lt;double&gt;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 5, "last_activity_date": 1568203643, "last_edit_date": 1568203643, "creation_date": 1568203178, "answer_id": 57888676, "question_id": 57888620, "link": "https://stackoverflow.com/questions/57888620/why-double-is-allowed-in-stl/57888676#57888676", "title": "why &lt;double&gt; is allowed in STL", "body": "<p>You are confusing template type parameters with template non-type parameters. In your example the parameter is a value of type <code>double</code>. In <code>std::vector&lt;double&gt;</code> the parameter is the type <code>double</code>.</p>\n\n<p><code>double</code> values arent really made to be compared for equality, while there is no such issue for the type <code>double</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1568203215, "creation_date": 1568203215, "answer_id": 57888687, "question_id": 57888620, "link": "https://stackoverflow.com/questions/57888620/why-double-is-allowed-in-stl/57888687#57888687", "title": "why &lt;double&gt; is allowed in STL", "body": "<blockquote>\n  <p>I wonder why in STL is it allowed do define container of double?</p>\n</blockquote>\n\n<p>Because a container of double doesn't need to have a template <strong>non-type</strong> argument of type double. The language allows any type, incluing double to be passed into template <strong>type</strong> arguments, which is what a generic container would use to specify the value type.</p>\n"}, {"tags": [], "owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "is_accepted": true, "score": 10, "last_activity_date": 1568203427, "creation_date": 1568203427, "answer_id": 57888743, "question_id": 57888620, "link": "https://stackoverflow.com/questions/57888620/why-double-is-allowed-in-stl/57888743#57888743", "title": "why &lt;double&gt; is allowed in STL", "body": "<p>You are mixing typename and type instance.\nWhen you do:</p>\n\n<pre><code>template &lt;int a&gt; struct A {};\n</code></pre>\n\n<p>You are declaring a template struct that'll be different by a tag and this tag is an integer.\nThus, <code>A&lt;1&gt;</code> and <code>A&lt;2&gt;</code> will be completely different types.</p>\n\n<p>When you do:</p>\n\n<pre><code>template &lt;typename T&gt; struct A { T a; A(T a) : a(a) {} };\n</code></pre>\n\n<p>You are declaring a template struct that'll be different by the type given. Thus, you can't write that: <code>A&lt;1&gt;</code> or <code>A&lt;2&gt;</code> since <code>1</code> or <code>2</code> is not a type but a value.</p>\n\n<p>You'll write <code>A&lt;int&gt;</code> and any int will use that <strong>same</strong> type, so <code>A&lt;int&gt; a(1)</code> is exactly the same type as <code>A&lt;int&gt; b(2)</code></p>\n"}, {"comments": [{"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568665924, "post_id": 57888814, "comment_id": 102339106, "body": "Within the same platform, there isn&#39;t any problem (the floating point format, while not specified in the standard, is the same for the same platform anywhere in the codebase). Since the ABI is not specified either in the standard, there is no cross platform specialization for type int. So this answer is incomplete, IMHO"}, {"owner": {"reputation": 2920, "user_id": 1469714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/R5rUf.png?s=128&g=1", "display_name": "xryl669", "link": "https://stackoverflow.com/users/1469714/xryl669"}, "edited": false, "score": 0, "creation_date": 1568666043, "post_id": 57888814, "comment_id": 102339142, "body": "I think, althrough (it&#39;s my interpretation, as it&#39;s hard to say why something is not in a standard), that since you can perform arithmetic operations on the template parameter for non-type, having float here would be a real pain to implement for compilers."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1568203729, "creation_date": 1568203729, "answer_id": 57888814, "question_id": 57888620, "link": "https://stackoverflow.com/questions/57888620/why-double-is-allowed-in-stl/57888814#57888814", "title": "why &lt;double&gt; is allowed in STL", "body": "<p>C++ does not allow floating point literals to to be used as template non-type parameters. Cf, integral types:</p>\n\n<pre><code>template &lt;int N&gt; class foo{};\n</code></pre>\n\n<p>is allowed but</p>\n\n<pre><code>template &lt;double N&gt; class bar{};\n</code></pre>\n\n<p>is not. The rationale behind this is that much of the implementation of floating point types is not specified by the standard. So it would be difficult to define which specialisation of <code>bar</code> would be applicable.</p>\n"}], "owner": {"reputation": 130, "user_id": 11447784, "user_type": "registered", "profile_image": "https://graph.facebook.com/2138301332872609/picture?type=large", "display_name": "Nissim Levy", "link": "https://stackoverflow.com/users/11447784/nissim-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 57888743, "answer_count": 4, "score": 3, "last_activity_date": 1568208415, "creation_date": 1568202992, "last_edit_date": 1568208415, "question_id": 57888620, "link": "https://stackoverflow.com/questions/57888620/why-double-is-allowed-in-stl", "title": "why &lt;double&gt; is allowed in STL", "body": "<p>I have seen that template cannot be defined with double, since it is not integral value. for example, the following code won't compile: </p>\n\n<pre><code>template &lt;double x&gt; double func()\n{\n    return x;\n}\n</code></pre>\n\n<p>however, I wonder why in STL is it allowed do define container of double? thanks!</p>\n"}, {"tags": ["c++", "boost", "modulo", "boost-multiprecision"], "comments": [{"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568203061, "post_id": 57888592, "comment_id": 102198914, "body": "You can&#39;t use the modulo operator on floating point numbers."}, {"owner": {"reputation": 47, "user_id": 8550857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/282021e74126fffef75ae85fdaecb307?s=128&d=identicon&r=PG", "display_name": "Zaxter5", "link": "https://stackoverflow.com/users/8550857/zaxter5"}, "reply_to_user": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568203212, "post_id": 57888592, "comment_id": 102198998, "body": "@user14717 I&#39;m aware, that&#39;s why I tried the fmod() operation."}, {"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568204113, "post_id": 57888592, "comment_id": 102199467, "body": "Do you know that your floating point value in an integer? If so cast it to <code>int1024_t</code>."}, {"owner": {"reputation": 47, "user_id": 8550857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/282021e74126fffef75ae85fdaecb307?s=128&d=identicon&r=PG", "display_name": "Zaxter5", "link": "https://stackoverflow.com/users/8550857/zaxter5"}, "reply_to_user": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568204225, "post_id": 57888592, "comment_id": 102199518, "body": "@user14717 how do you mean? My floating point value may be 0.2, for instance. I don&#39;t think I can cast that to int1024_t."}, {"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568204374, "post_id": 57888592, "comment_id": 102199606, "body": "If it&#39;s 0.2, then how do you define the modulo operation?"}, {"owner": {"reputation": 47, "user_id": 8550857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/282021e74126fffef75ae85fdaecb307?s=128&d=identicon&r=PG", "display_name": "Zaxter5", "link": "https://stackoverflow.com/users/8550857/zaxter5"}, "reply_to_user": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568204552, "post_id": 57888592, "comment_id": 102199721, "body": "@user14717 Well it would be fmod(0.2, 205757961451002850) for instance, but the second number is too big for primitive types."}, {"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568205249, "post_id": 57888592, "comment_id": 102200162, "body": "I&#39;m asking &quot;what do you think 0.2 % 205757961451002850 to means?&quot;"}, {"owner": {"reputation": 47, "user_id": 8550857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/282021e74126fffef75ae85fdaecb307?s=128&d=identicon&r=PG", "display_name": "Zaxter5", "link": "https://stackoverflow.com/users/8550857/zaxter5"}, "reply_to_user": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568206780, "post_id": 57888592, "comment_id": 102201052, "body": "Obviously what is the remainder after dividing those two numbers."}, {"owner": {"reputation": 2156, "user_id": 3476954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb810a12cd393949bca88e4b0cdba75?s=128&d=identicon&r=PG&f=1", "display_name": "Mansoor", "link": "https://stackoverflow.com/users/3476954/mansoor"}, "edited": false, "score": 0, "creation_date": 1568209148, "post_id": 57888592, "comment_id": 102202452, "body": "Why not define it as a free function yourself? It&#39;s just a division, truncate to an integer then a subtraction?"}, {"owner": {"reputation": 3792, "user_id": 904050, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7e5ae1599008ffc96ccd44ad601a43dc?s=128&d=identicon&r=PG", "display_name": "user14717", "link": "https://stackoverflow.com/users/904050/user14717"}, "edited": false, "score": 0, "creation_date": 1568211676, "post_id": 57888592, "comment_id": 102203855, "body": "&quot;Obviously what is the remainder after dividing those two numbers.&quot; There is no remainder."}], "owner": {"reputation": 47, "user_id": 8550857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/282021e74126fffef75ae85fdaecb307?s=128&d=identicon&r=PG", "display_name": "Zaxter5", "link": "https://stackoverflow.com/users/8550857/zaxter5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568202882, "creation_date": 1568202882, "question_id": 57888592, "link": "https://stackoverflow.com/questions/57888592/how-to-perform-modulo-of-boostcpp-dec-float-50-and-boostint1024-t-data-types", "title": "How to perform Modulo of boost::cpp_dec_float_50 and boost::int1024_t Data Types?", "body": "<p>I'm trying to perform a modulo operation on two numbers. One is a <code>cpp_dec_float_50</code> type (decimal) number, and the other is a <code>int1024_t</code> type number - both supplied by the Boost Multiprecision C++ library.</p>\n\n<p>I've tried using the <code>%</code> operator, and the Standard Library's <code>fmod()</code> function, but alas they aren't designed for such data types. I've scoured the Boost documentation however there is no trace of a modulous alternative that would work with its own floating point data types.</p>\n\n<p>Please note that the <code>int1024_t</code> value is <em>very</em> large.</p>\n\n<p>There must be SOME way to perform a modulo operation on such values, hopefully someone can shed some light on it for me.</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["c++", "macos", "tensorflow", "bazel"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10003721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0ZWIOHn8JVQ/AAAAAAAAAAI/AAAAAAAAABA/HJBXXUyIamY/photo.jpg?sz=128", "display_name": "HryMark", "link": "https://stackoverflow.com/users/10003721/hrymark"}, "is_accepted": false, "score": 2, "last_activity_date": 1568276721, "creation_date": 1568276721, "answer_id": 57902656, "question_id": 57888418, "link": "https://stackoverflow.com/questions/57888418/add-lc-version-min-macosx-to-libtensorflow-cc-so-and-libtensorflow-framework-so/57902656#57902656", "title": "Add LC_VERSION_MIN_MACOSX to libtensorflow_cc.so and libtensorflow_framework.so", "body": "<p>I managed to do it:\nadding <code>--action_env MACOSX_DEPLOYMENT_TARGET=10.12</code> resolved my problem</p>\n"}], "owner": {"reputation": 21, "user_id": 10003721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0ZWIOHn8JVQ/AAAAAAAAAAI/AAAAAAAAABA/HJBXXUyIamY/photo.jpg?sz=128", "display_name": "HryMark", "link": "https://stackoverflow.com/users/10003721/hrymark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568276721, "creation_date": 1568202265, "last_edit_date": 1568276556, "question_id": 57888418, "link": "https://stackoverflow.com/questions/57888418/add-lc-version-min-macosx-to-libtensorflow-cc-so-and-libtensorflow-framework-so", "title": "Add LC_VERSION_MIN_MACOSX to libtensorflow_cc.so and libtensorflow_framework.so", "body": "<p>I want to set <code>LC_VERSION_MIN_MACOSX</code> to libtensorflow dynamic libraries, which I build using bazel.</p>\n\n<p>I've already tried bazel flag: <code>--copt=-mmacosx-version-min=10.12</code><br>\nand set environment: <code>export MACOSX_DEPLOYMENT_TARGET=10.12</code>. <br>\nHowever libtensorflow_framework.so and libtensorflow_cc.so still without <code>LC_VERSION_MIN_MACOSX</code> flag.</p>\n"}, {"tags": ["java", "c++", "singleton"], "comments": [{"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 1, "creation_date": 1568202419, "post_id": 57888409, "comment_id": 102198582, "body": "Note that your <code>getInstance()</code> method should be static. And your <code>abcInstance</code> field shouldn&#39;t be public."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1568202636, "post_id": 57888409, "comment_id": 102198704, "body": "If you want a C++ answer please post some C++ code (or remove the C++ tag).  The singleton pattern modern in C++ is much simple and guaranteed by the standard when initialising a block scope static variable."}, {"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1568202662, "post_id": 57888409, "comment_id": 102198716, "body": "@RichardCritten the modern way to do it in Java <a href=\"https://en.wikipedia.org/wiki/Initialization-on-demand_holder_idiom\" rel=\"nofollow noreferrer\">is far simpler too</a>."}, {"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1568202762, "post_id": 57888409, "comment_id": 102198774, "body": "&quot;Is if(abcInstance == null) and abcInstance = new ABC(); are atomic&quot; Which <code>if (abcInstance == null)</code>? There are two."}, {"owner": {"reputation": 67717, "user_id": 2541560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7H9TF.png?s=128&g=1", "display_name": "Kayaman", "link": "https://stackoverflow.com/users/2541560/kayaman"}, "reply_to_user": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1568202967, "post_id": 57888409, "comment_id": 102198868, "body": "@AndyTurner <a href=\"https://stackoverflow.com/questions/26285520/implementing-singleton-with-an-enum-in-java\">even simpler</a> when you take the most modern way."}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1568203397, "post_id": 57888409, "comment_id": 102199087, "body": "Reentrant lazy creation of object should not be part of singleton at all."}, {"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "reply_to_user": {"reputation": 67717, "user_id": 2541560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7H9TF.png?s=128&g=1", "display_name": "Kayaman", "link": "https://stackoverflow.com/users/2541560/kayaman"}, "edited": false, "score": 0, "creation_date": 1568203435, "post_id": 57888409, "comment_id": 102199114, "body": "@Kayaman I am wary of trying to put too much into an enum. In particular, enums are meant for things that are constant. Sure, it&#39;s a choice though (as is not using a singleton at all!)."}, {"owner": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "reply_to_user": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1568212070, "post_id": 57888409, "comment_id": 102204099, "body": "@AndyTurner yes getInstance() is static pubic and abcInstance should not be public. I just want to understand f(abcInstance == null) outside the synchronisation block and abcInstance = new ABC(); inside the synchronisation block is atomic operation. Am talking about both statements separately."}, {"owner": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1568212175, "post_id": 57888409, "comment_id": 102204174, "body": "@RichardCritten Why to remove C++ tag, problem is kind of common for both languages. For C++ I know that simply static can be used and I am sure for Java same facility would be present but question is about this way of creating singleton which is given as example on various websites."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1568217199, "post_id": 57888409, "comment_id": 102206994, "body": "@TarunChawla You should also provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for C++ as the code is quite different from Java.  If you don&#39;t then the question becomes &quot;please write code for me.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1568212865, "post_id": 57888740, "comment_id": 102204582, "body": "1. So this way of initialization to work it is necessary to use volatile object instance. 2. volatile ensures that there is no partial write kind of situation happening. 3. All the websites using non-volatile way of implementing this kind of singleton is simply wrong.  is that correct?"}, {"owner": {"reputation": 628818, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "reply_to_user": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1568213214, "post_id": 57888740, "comment_id": 102204782, "body": "1) If you are going to use double-checked locking, then <code>volatile</code> must be used.  And, it is only guaranteed to work with the Java 5+ memory model. 2) I wouldn&#39;t put it that way.  See what I wrote above.  3) Yes.  And it is not just me saying so.  This is (in 2019) common knowledge."}, {"owner": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1568213494, "post_id": 57888740, "comment_id": 102204936, "body": "I just wanted to understand if this code has any issues on Java5+ JVM. Is there still any chance where thread 1 which has entered the synchronisation block is not completed but still other thread 2 finds out that instance is nonnull and returns incomplete instance?"}, {"owner": {"reputation": 628818, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "reply_to_user": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1568213691, "post_id": 57888740, "comment_id": 102205041, "body": "No chance.  But don&#39;t just trust me.  Read and understand the Java Memory Model section of the JLS for yourself.  Then analyze your code."}], "tags": [], "owner": {"reputation": 628818, "user_id": 139985, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=128&d=identicon&r=PG", "display_name": "Stephen C", "link": "https://stackoverflow.com/users/139985/stephen-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1568213569, "last_edit_date": 1568213569, "creation_date": 1568203423, "answer_id": 57888740, "question_id": 57888409, "link": "https://stackoverflow.com/questions/57888409/double-checking-way-of-creating-singleton-issue/57888740#57888740", "title": "Double checking way of creating singleton issue", "body": "<p>This answers the Java part of your question only.</p>\n\n<blockquote>\n  <p>Is <code>if(abcInstance == null)</code> and <code>abcInstance = new ABC();</code> are atomic, if not then this way of creating singleton is wrong.</p>\n</blockquote>\n\n<p>It is not atomicity that is the (potential) problem.  (Reference assignment is atomic from the perspective of both the thread doing the assignment, and the thread reading the assigned variable.)</p>\n\n<p>The problem is when the value written to <code>abcInstance</code> becomes visible to another thread.</p>\n\n<ul>\n<li><p>Prior to Java 5, the memory model did not provide sufficient guarantees about memory visibility for that implementation to work reliably.</p></li>\n<li><p>In the Java 5 (and later) memory model, there is a <em>happens before</em> relation between one thread's write to a <em>volatile</em> variable and another thread's subsequent read of the variable.  This means:</p>\n\n<ol>\n<li>The second thread is guaranteed to see the non-null value of <code>abcInstance</code> if the first thread has written it.</li>\n<li>The <em>happens before</em> relation also guarantees that the second thread will see the fully initialized state of the <code>ABC</code> instance create by the first thread.</li>\n<li>The <code>synchronized</code> block ensures that only one <code>ABC</code> instance may be created at a time.</li>\n</ol></li>\n</ul>\n\n<p>This is the <em>authoritative</em> article explaining why old double-checked locking implementations were broken:</p>\n\n<ul>\n<li><a href=\"https://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html\" rel=\"nofollow noreferrer\">The \"Double-Checked Locking is Broken\" Declaration</a> </li>\n</ul>\n\n<hr>\n\n<p>As Andrew Turner states, there is a simpler, cleaner way to implement singleton classes in Java: use an <code>enum</code>.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/26285520/implementing-singleton-with-an-enum-in-java\">Implementing Singleton with an Enum (in Java)</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1568203492, "post_id": 57888755, "comment_id": 102199136, "body": "That was quick :-) What&#39;s wrong with the answer? It was downvoted in &lt; 5 seconds so it should be easy to give me a hint."}, {"owner": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1568212817, "post_id": 57888755, "comment_id": 102204553, "body": "This approach I was aware, just that my question was specific to this way of creating singleton and map that problem to Java code. As most of Java people could not answer the atomicity part of it but it is easy to discuss the same with C++ people as I wanted to jump into this discussion too."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1568217369, "post_id": 57888755, "comment_id": 102207074, "body": "@TarunChawla I can&#39;t speak for how to do it in Java or if your approach is going to work well there I&#39;m afraid. You <i>could</i> do similar things in C++ (with manual synchronization), but for the creation part of static objects, it&#39;s safe to do it as I&#39;ve shown. Oh, and you&#39;ve gotten the order wrong when it comes to the C++ part though. Memory is allocated first, then the actual object."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "edited": false, "score": 0, "creation_date": 1579865110, "post_id": 57888755, "comment_id": 105918551, "body": "@TarunChawla That&#39;s nice! ... and to make it clear: I didn&#39;t think you did. :-)"}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1568204587, "last_edit_date": 1568204587, "creation_date": 1568203455, "answer_id": 57888755, "question_id": 57888409, "link": "https://stackoverflow.com/questions/57888409/double-checking-way-of-creating-singleton-issue/57888755#57888755", "title": "Double checking way of creating singleton issue", "body": "<p>Here are two typical singleton variants in C++.</p>\n\n<p>First one shared by all threads:</p>\n\n<pre><code>class singleton {\nprivate:\n    singleton() {}\n\npublic:\n    singleton(const singleton&amp;) = delete;\n\n    static singleton&amp; get_instance() {\n        static singleton ins;\n        return ins;\n    }\n};\n</code></pre>\n\n<p>And here's one that that will create one instance per thread that needs it:</p>\n\n<pre><code>class tl_singleton {\nprivate:\n    tl_singleton() {}\n\npublic:\n    tl_singleton(const tl_singleton&amp;) = delete;\n\n    static tl_singleton&amp; get_instance() {\n        static thread_local tl_singleton ins;\n        return ins;\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 1693464, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/acfeeb3bebcfc91ac552320dbb0e8a14?s=128&d=identicon&r=PG", "display_name": "Tarun Chawla", "link": "https://stackoverflow.com/users/1693464/tarun-chawla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 57888740, "answer_count": 2, "score": 0, "last_activity_date": 1568213569, "creation_date": 1568202235, "last_edit_date": 1568213028, "question_id": 57888409, "link": "https://stackoverflow.com/questions/57888409/double-checking-way-of-creating-singleton-issue", "title": "Double checking way of creating singleton issue", "body": "<p>How reading (outside critical resource block) and writing (inside critical resource block) does not have atomicity issues.</p>\n\n<p>I have read and discussed with various people but most people don't answer if both operations are atomic and how atomicity is actually achieved for above problem.</p>\n\n<pre><code>class ABC {\n    private static volatile ABC abcInstance;\n    static ABC getInstance(){\n        if(abcInstance == null){\n            synchronized(ABC.class){\n                if(abcInstance == null){\n                    abcInstance = new ABC();\n                    return abcInstance;\n                }\n            }\n        }\n        return abcInstance;\n    }\n\n}\n</code></pre>\n\n<p>Are <code>if(abcInstance == null) outside synchronisation block</code> and <code>abcInstance = new ABC();</code> atomic, if not then this way of creating singletons is wrong.</p>\n\n<p>In C++, <code>abcInstance = new ABC();</code> consists of three instructions broadly speaking:</p>\n\n<ol>\n<li>Create ABC object.</li>\n<li>Allocate memory for ABC.</li>\n<li>Assign it to abcInstance.</li>\n</ol>\n\n<p>And for optimisations compiler can reorder these three instructions in any way. Suppose it follows 2->3->1 and after instruction 3 interrupt happens and next thread calling getInstance() will read that abcInstance has some value then it will point to something which does not have ABC object.</p>\n\n<p>Please correct me if am wrong for both C++ and Java.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1568202246, "post_id": 57888356, "comment_id": 102198500, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a <a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a> to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1568205223, "post_id": 57888567, "comment_id": 102200152, "body": "You should <code>#include &lt;algorithm&gt;</code> to use <a href=\"https://en.cppreference.com/w/cpp/algorithm/min\" rel=\"nofollow noreferrer\"><code>std::min</code></a> / <a href=\"https://en.cppreference.com/w/cpp/algorithm/max\" rel=\"nofollow noreferrer\"><code>std::max</code></a>."}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 1, "last_activity_date": 1568205581, "last_edit_date": 1568205581, "creation_date": 1568202804, "answer_id": 57888567, "question_id": 57888356, "link": "https://stackoverflow.com/questions/57888356/print-l-part-of-a-matrix-using-single-loop/57888567#57888567", "title": "Print L part of a matrix using single loop", "body": "<p>I'm not sure why you'd want to do this but one way would be:</p>\n\n<pre><code>#include &lt;array&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    const int width = 3;\n    const int height = 4;\n    const std::array&lt;std::array&lt;int, width&gt;, height&gt; a = \n    {{\n        { 1, 2, 4 },\n        { 3, 4, 6 },\n        { 7, 8, 9 },\n        { 10, 11, 12 },\n    }};\n\n    for(int i=0;i&lt;width + height - 1;i++){\n        std::cout&lt;&lt;a[std::min(i, height - 1)][std::max(0, i - height + 1)]&lt;&lt;\" \";\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 465, "user_id": 11241587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea334bb29226f73a25b431b3e48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Theodor Badea", "link": "https://stackoverflow.com/users/11241587/theodor-badea"}, "is_accepted": false, "score": 1, "last_activity_date": 1568204603, "creation_date": 1568204603, "answer_id": 57889097, "question_id": 57888356, "link": "https://stackoverflow.com/questions/57888356/print-l-part-of-a-matrix-using-single-loop/57889097#57889097", "title": "Print L part of a matrix using single loop", "body": "<p>One way would be:</p>\n\n<pre><code>    for(int i = 0; i &lt; N+M-1; i++)\n    {\n        if(i &lt; N)\n        {\n            std::cout &lt;&lt; std::endl &lt;&lt; a[i][0];\n        }\n        else\n        {\n            std::cout &lt;&lt; \" \" &lt;&lt; a[N-1][i-N+1];\n        }\n    }\n</code></pre>\n\n<p>where N = number of lines and M = number of columns.</p>\n"}], "owner": {"reputation": 129, "user_id": 11405096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4390dc416938c3c81102f380a93187?s=128&d=identicon&r=PG&f=1", "display_name": "akacodes121", "link": "https://stackoverflow.com/users/11405096/akacodes121"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1568205581, "creation_date": 1568202018, "question_id": 57888356, "link": "https://stackoverflow.com/questions/57888356/print-l-part-of-a-matrix-using-single-loop", "title": "Print L part of a matrix using single loop", "body": "<p>Let the given matrix is </p>\n\n<blockquote>\n  <p>{1,2,4}</p>\n  \n  <p>{3,4,6}</p>\n  \n  <p>{7,8,9}</p>\n</blockquote>\n\n<p>It should print 1 3 7 8 9 using single loop.</p>\n\n<p>I have tried like this </p>\n\n<pre><code>for(int i=0;i&lt;n;i++){\n    if(i!=n-1)\n        cout&lt;&lt;a[i][0]&lt;&lt;\" \";\n    cout&lt;&lt;a[n-1][i]&lt;&lt;\" \";\n}\n</code></pre>\n\n<p>But it would print 1 7 3 8 9 </p>\n\n<p>moreover it would not work when matrix is rectangular                   </p>\n"}, {"tags": ["c++", "visual-c++", "c++17"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1568202025, "post_id": 57888321, "comment_id": 102198374, "body": "When you say that your main code is written in C++17, do you mean that it relies on features that were new in C++17?"}, {"owner": {"reputation": 1449, "user_id": 2580815, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a6791897d4e15d8df582ccdfba760e4d?s=128&d=identicon&r=PG", "display_name": "xylosper", "link": "https://stackoverflow.com/users/2580815/xylosper"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1568202101, "post_id": 57888321, "comment_id": 102198407, "body": "@JohnBollinger Yes. My code depends on C++17 features and libraries."}], "answers": [{"tags": [], "owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "is_accepted": true, "score": 3, "last_activity_date": 1568203035, "creation_date": 1568203035, "answer_id": 57888637, "question_id": 57888321, "link": "https://stackoverflow.com/questions/57888321/enable-removed-function-in-c17/57888637#57888637", "title": "Enable removed function in C++17", "body": "<p>You can define <code>_HAS_AUTO_PTR_ETC</code> to 1 before including any standard header.</p>\n\n<p>From <a href=\"https://devblogs.microsoft.com/cppblog/c17-feature-removals-and-deprecations/\" rel=\"nofollow noreferrer\">https://devblogs.microsoft.com/cppblog/c17-feature-removals-and-deprecations/</a>:</p>\n\n<blockquote>\n  <ul>\n  <li>N4190 \u201cRemoving auto_ptr, random_shuffle(), And Old &lt;functional> Stuff\u201d</li>\n  </ul>\n  \n  <p>Implemented in VS 2017 15.3 (and earlier). Restored by defining\n  _HAS_AUTO_PTR_ETC to 1</p>\n</blockquote>\n"}], "owner": {"reputation": 1449, "user_id": 2580815, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a6791897d4e15d8df582ccdfba760e4d?s=128&d=identicon&r=PG", "display_name": "xylosper", "link": "https://stackoverflow.com/users/2580815/xylosper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 57888637, "answer_count": 1, "score": 2, "last_activity_date": 1568204603, "creation_date": 1568201867, "last_edit_date": 1568204603, "question_id": 57888321, "link": "https://stackoverflow.com/questions/57888321/enable-removed-function-in-c17", "title": "Enable removed function in C++17", "body": "<p>My main code is written with C++17. Now I want to integrate a external library which is written against C++14.</p>\n\n<p>Since the library header using some functions such as <code>std::binary_function</code>, <code>std::random_shuffle</code> which are removed in C++17, I cannot use this library.</p>\n\n<p>Is it possible to re-enable removed functions in C++17?\nI am using MSVC 2017 and solution for MSVC only is totally acceptable.</p>\n"}, {"tags": ["c++", "hash"], "comments": [{"owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "edited": false, "score": 4, "creation_date": 1568202155, "post_id": 57888281, "comment_id": 102198437, "body": "From the page you linked: &quot;The actual hash functions are implementation-dependent and are not required to fulfill any other quality criteria except those specified above. Notably, some implementations use trivial (identity) hash functions which map an integer to itself. In other words, these hash functions are designed to work with unordered associative containers, but not as cryptographic hashes, for example. &quot;"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1568202657, "post_id": 57888281, "comment_id": 102198711, "body": "A very common usage pattern for hashes is as an index into an array.  The set of all possible array indices for an implementation can be represented using a <code>std::size_t</code>.   This means, even if the array has the maximum allowed size for the implementation, the value returned by the hash function can be used as an index (subject to checking the value is less than the array size)."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 1, "creation_date": 1568204193, "post_id": 57888281, "comment_id": 102199502, "body": "If you consider <code>std::size_t</code> not to be a &quot;fixed type,&quot; then <code>int</code> isn&#39;t a &quot;fixed type&quot; either because its properties is implementation defined.  And <code>std::uintN_t</code> is optional ..."}], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 9555853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LIU Qingyuan", "link": "https://stackoverflow.com/users/9555853/liu-qingyuan"}, "edited": false, "score": 0, "creation_date": 1568634597, "post_id": 57889185, "comment_id": 102324324, "body": "So can I say, for the sake of simplicity, standard committee chose this somehow misleading name?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1568204916, "creation_date": 1568204916, "answer_id": 57889185, "question_id": 57888281, "link": "https://stackoverflow.com/questions/57888281/why-c-hash-functions-return-type-is-stdsize-t-instead-of-a-platform-indepe/57889185#57889185", "title": "Why C++ hash functions&#39; return type is std::size_t, instead of a platform-independent type?", "body": "<p>The intended purpose of <code>std::hash</code> is for implementation of a hash table, and specifically the unordered associative containers of the standard library. A hash table is an array, and <code>std::size_t</code> is an appropriate choice, since it is the type that is guaranteed to be able to represent all indices of any array. While not actually specified by the standard, in practice those standard containers are likely to use <code>std::size_t</code> as the size type.</p>\n\n<p>If you need a hash function for inter-system communication, <code>std::hash</code> is not a good choice.</p>\n"}], "owner": {"reputation": 415, "user_id": 9555853, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "LIU Qingyuan", "link": "https://stackoverflow.com/users/9555853/liu-qingyuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1568204916, "creation_date": 1568201741, "last_edit_date": 1568201917, "question_id": 57888281, "link": "https://stackoverflow.com/questions/57888281/why-c-hash-functions-return-type-is-stdsize-t-instead-of-a-platform-indepe", "title": "Why C++ hash functions&#39; return type is std::size_t, instead of a platform-independent type?", "body": "<p>As shown <a href=\"https://en.cppreference.com/w/cpp/utility/hash\" rel=\"nofollow noreferrer\">here</a>, <code>std::hash</code> template provided in the standard library will return a value of type <code>std::size_t</code>. However, the exact type of <code>std::size_t</code> is platform-dependent and implementation-dependent, make it impossible to estimate the collision probability.<br>\nI cannot see any advantage of returning <code>std::size_t</code>, so my problem is, why does not the hash function return a value of fixed type instead?</p>\n"}, {"tags": ["c++", "language-lawyer", "c++17"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568201500, "post_id": 57888165, "comment_id": 102198082, "body": "<code>template &lt;typename... Args&gt; void Trace(const Args&amp;... args) {     throw &quot;what the frak&quot;; }</code>?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568201539, "post_id": 57888165, "comment_id": 102198109, "body": "@Jarod42 But I wanted the forwarding for that version :("}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1568202240, "post_id": 57888165, "comment_id": 102198494, "body": "&quot;a non-template would always take precedence over a template.&quot; <b>Only</b> all other things being equal. You may want to google <i>&quot;too perfect forwarding&quot;</i>."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568203439, "post_id": 57888165, "comment_id": 102199118, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/overload_resolution#Best_viable_function\" rel=\"nofollow noreferrer\">doc about overload resolution</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1568203643, "post_id": 57888165, "comment_id": 102199228, "body": "<i>&quot;&quot;a non-template would always take precedence over a template.&quot;&quot;</i> There is 3 other points before that tie breaker rule."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1568201921, "post_id": 57888303, "comment_id": 102198304, "body": "Meh ok guess the &quot;non-template comes first&quot; rule is much stricter than I thought"}, {"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1568201989, "post_id": 57888303, "comment_id": 102198348, "body": "@LightnessRacesinOrbit: my understanding is that rule applies if the instantiation of a template would have the same priority as non-template, but if the template is a better match, it will be taken"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1568205371, "post_id": 57888303, "comment_id": 102200242, "body": "Okay. In addition, I guess I wasn&#39;t considering that this was a better match, though now that you mention it I suppose it&#39;s kinda obvious otherwise loads of things wouldn&#39;t work (move constructors, for a start :D)"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1568206515, "post_id": 57888303, "comment_id": 102200899, "body": "<code>void Trace(int)</code> is another simple option -- as a substitute for <code>void Trace(int const&amp;)</code> (though the real example probably uses types you care about copying willy-nilly, so maybe not)"}], "tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 10, "last_activity_date": 1568201949, "last_edit_date": 1568201949, "creation_date": 1568201796, "answer_id": 57888303, "question_id": 57888165, "link": "https://stackoverflow.com/questions/57888165/forwarding-template-taking-precedence-over-overload/57888303#57888303", "title": "Forwarding template taking precedence over overload", "body": "<p><code>42</code> is an rvalue of type <code>int</code>, therefore it binds more closely to <code>int&amp;&amp;</code> rather than <code>const int&amp;</code>. This is why it is calling your template <code>Trace</code> function.</p>\n\n<p>If you were to call </p>\n\n<pre><code>const int i{};\nTrace(i);\n</code></pre>\n\n<p>then your <code>Trace(const int&amp;)</code> overload would be invoked.</p>\n\n<hr>\n\n<p>Possible workarounds:</p>\n\n<ul>\n<li><p>Add a <code>Trace(int&amp;&amp;)</code> overload that invokes <code>Trace(const int&amp;)</code>. You might also need a <code>Trace(int&amp;)</code>;</p></li>\n<li><p>Use SFINAE on the templated <code>Trace</code> to prevent instantiation when the first argument is an <code>int</code>;</p>\n\n<pre><code>template &lt;typename Arg, typename... Args&gt;\nauto Trace(Arg&amp;&amp; arg, Args&amp;&amp;... args)\n    -&gt; std::enable_if_t&lt;!std::is_same_v&lt;std::decay_t&lt;Arg&gt;, int&gt;&gt;\n{\n    throw \"what the frak\";\n}   \n</code></pre></li>\n<li><p>Change the templated <code>Trace</code> to take <code>const Args&amp;...</code> instead.</p></li>\n</ul>\n"}], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 57888303, "answer_count": 1, "score": 7, "last_activity_date": 1568201949, "creation_date": 1568201392, "last_edit_date": 1568201517, "question_id": 57888165, "link": "https://stackoverflow.com/questions/57888165/forwarding-template-taking-precedence-over-overload", "title": "Forwarding template taking precedence over overload", "body": "<p>I thought that a non-template would always take precedence over a template, if the arguments match up just as well.</p>\n\n<p>But:</p>\n\n<pre><code>template &lt;typename... Args&gt;\nvoid Trace(Args&amp;&amp;... args)\n{\n    throw \"what the frak\";\n}\n\nvoid Trace(const int&amp;)\n{}\n\nint main()\n{\n    Trace(42);\n}\n</code></pre>\n\n<p><a href=\"https://coliru.stacked-crooked.com/a/cf1cf2a0ebe089aa\" rel=\"noreferrer\">This throws</a> unless I make the non-template <code>Trace(int)</code> or <code>Trace(int&amp;&amp;)</code>, i.e. not taking a const ref.</p>\n\n<p>It's kind of annoying because I want to provide a different implementation for specific argument types where the real implementation of the template does not make sense (and, in fact, would not compile).</p>\n\n<p>I can fix it by making the second function a specialisation, but only if I match argument types by taking an rvalue reference:</p>\n\n<pre><code>template &lt;&gt;\nvoid Trace(int&amp;&amp;)\n{}\n</code></pre>\n\n<p>And, well, maybe I didn't want to do that! Maybe I want to call it with a <code>const</code> thing sometimes and would rather not specialise twice.</p>\n\n<p>Is it correct and standard-abiding that simply providing a non-template overload works this way, in this example? It's the first time I've noticed this behaviour (not that that necessarily means anything!).</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1568201380, "post_id": 57888085, "comment_id": 102198024, "body": "As for me then I have not understood what you are trying to do. Could you provide an example of the initial and result data in the vector?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1568201383, "post_id": 57888085, "comment_id": 102198028, "body": "Sounds like a <a href=\"https://en.wikipedia.org/wiki/Circular_buffer\" rel=\"nofollow noreferrer\">ring buffer</a>, you are looking for."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 1, "creation_date": 1568201419, "post_id": 57888085, "comment_id": 102198045, "body": "- or a queue..."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1568201599, "post_id": 57888085, "comment_id": 102198151, "body": "Although, I rarely need it, I once asked myself why <code>std</code> doesn&#39;t provide a ring buffer. With <a href=\"https://www.google.com/search?q=std+ring+buffer+c%2B%2B\" rel=\"nofollow noreferrer\">google &quot;std ring buffer c++&quot;</a>, I found <a href=\"https://www.boost.org/doc/libs/1_65_1/doc/html/circular_buffer.html\" rel=\"nofollow noreferrer\">Chapter 8. Boost.Circular Buffer</a>."}, {"owner": {"reputation": 1, "user_id": 11872231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff627f75fd400f36456c877e8484192?s=128&d=identicon&r=PG&f=1", "display_name": "Timothee", "link": "https://stackoverflow.com/users/11872231/timothee"}, "edited": false, "score": 0, "creation_date": 1568201606, "post_id": 57888085, "comment_id": 102198157, "body": "I want rewrite pushed element. If you could be able to move the &quot;recorder&quot; of push_back() to the beginning of the vector (without losing the all elements except the rewritable one) - this would solve my problem"}], "answers": [{"comments": [{"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1568201889, "post_id": 57888164, "comment_id": 102198291, "body": "<code>#define MAX_SIZE 5</code> you should only use macros if it is really required. And that is not a situation when to use it."}, {"owner": {"reputation": 711, "user_id": 4611211, "user_type": "registered", "profile_image": "https://graph.facebook.com/958083580869419/picture?type=large", "display_name": "Kevin Kouketsu", "link": "https://stackoverflow.com/users/4611211/kevin-kouketsu"}, "edited": false, "score": 0, "creation_date": 1568202018, "post_id": 57888164, "comment_id": 102198369, "body": "you defined a max size on vector and never do a push_back. Isn&#39;t better std::array?"}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1568202090, "post_id": 57888164, "comment_id": 102198404, "body": "Well, he asked for vector, that is why, I gave my answer with vector. I also do believe that, this task can be done with arrays."}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1568202661, "post_id": 57888164, "comment_id": 102198715, "body": "Making <code>v</code> freely accessible and  having <code>index = (index + 1) % max_len</code> and <code>v[index] = n</code> is error prone, and could result in out of bound access if the the vector length is modified."}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1568202888, "post_id": 57888164, "comment_id": 102198831, "body": "Well, I do not understand the logic changing size of vector on mid-code, however, I still changed my answer to be error-free. Instead of taking mod from <code>max_len</code>, I do it from <code>v.size()</code>"}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1568203563, "post_id": 57888164, "comment_id": 102199180, "body": "I didn&#39;t say it makes sense to change the size of the vector, I just said that it is a bad design to write the code that way. It is slightly better now, but <code>v[index] = n;</code> can still be out of bounds."}], "tags": [], "owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1568203760, "last_edit_date": 1568203760, "creation_date": 1568201382, "answer_id": 57888164, "question_id": 57888085, "link": "https://stackoverflow.com/questions/57888085/how-to-write-to-a-vector-cyclically/57888164#57888164", "title": "How to write to a vector cyclically?", "body": "<p>Well, you can write you own function for that. I would prefer to do it like this:</p>\n\n<pre><code>const int max_len = 5\n\nvector&lt;int&gt; v(max_len);  // just get slots in memory for 5 elements\n\nvoid insert_element(int n)\n{\n    static int index = 0;\n    index %= v.size(); // do not let overflow\n\n    v[index++] = n;\n}\n\nint main()\n{\n\n    for (int i = 0; i &lt; 10; ++i)\n        insert_element(i);\n\n    for (int i = 0; i &lt; max_len; ++i)\n        printf(\"%d \", v[i]); // output will be '5 6 7 8 9'\n}\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1568202283, "post_id": 57888194, "comment_id": 102198518, "body": "Well, it is going to be a little bit pain, if I want use other functions of vector"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 1, "creation_date": 1568202515, "post_id": 57888194, "comment_id": 102198625, "body": "@MiradilZeynalli If you could freely use other functions of vector, you could easily break assumption that the size doesn&#39;t change. The little pain is worth it for preventing that."}, {"owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "edited": false, "score": 0, "creation_date": 1568202567, "post_id": 57888194, "comment_id": 102198663, "body": "well, kinda makes sense)"}, {"owner": {"reputation": 829, "user_id": 5569396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5Prh.jpg?s=128&g=1", "display_name": "Gor Asatryan", "link": "https://stackoverflow.com/users/5569396/gor-asatryan"}, "edited": false, "score": 2, "creation_date": 1568203555, "post_id": 57888194, "comment_id": 102199172, "body": "Yes. I&#39;m sorry. Have to use <code>resize()</code> not <code>reserve()</code>."}], "tags": [], "owner": {"reputation": 829, "user_id": 5569396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5Prh.jpg?s=128&g=1", "display_name": "Gor Asatryan", "link": "https://stackoverflow.com/users/5569396/gor-asatryan"}, "is_accepted": false, "score": 1, "last_activity_date": 1568203486, "last_edit_date": 1568203486, "creation_date": 1568201461, "answer_id": 57888194, "question_id": 57888085, "link": "https://stackoverflow.com/questions/57888085/how-to-write-to-a-vector-cyclically/57888194#57888194", "title": "How to write to a vector cyclically?", "body": "<p>I think you can write some wrapper on vector. A class where you will keep <code>vector&lt;int&gt;</code> for values and a <code>counter</code> to keep index where you want to insert or override element.</p>\n\n<p>Also define some InsertValue public function to call it to insert or override elements in vector.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nclass CircularVector\n{\npublic:\n    CircularVector() : index(0)\n    {\n        m_vector.resize(5);\n    }\n    void InsertElement(int value)\n    {\n        m_vector[index%5] = value;\n\n        index++;\n    }\n    std::vector&lt;int&gt;&amp; getVector()\n    {\n        return m_vector;\n    }\nprivate:\n    int index;\n    std::vector&lt;int&gt; m_vector;\n};\nint main()\n{\n    CircularVector v;\n    v.InsertElement(1);\n    v.InsertElement(2);\n    v.InsertElement(3);\n    v.InsertElement(4);\n    v.InsertElement(5);\n    v.InsertElement(6);\n    for(int i = 0; i &lt; 5; ++i)\n    {\n        std::cout &lt;&lt; v.getVector()[i] &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>\n\n<p>output is <code>6 2 3 4 5</code></p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1568201471, "creation_date": 1568201471, "answer_id": 57888197, "question_id": 57888085, "link": "https://stackoverflow.com/questions/57888085/how-to-write-to-a-vector-cyclically/57888197#57888197", "title": "How to write to a vector cyclically?", "body": "<blockquote>\n  <p>need only 5 elements to be written to the vector, and then they will be overwritten</p>\n</blockquote>\n\n<p>Then you don't want a vector. What you're describing is a circular buffer (also called cyclic or ring buffer).</p>\n\n<p>The standard library does not have such container, but it can be implemented using either an array or a vector (depending on whether you want the size to be determined at compile or at runtime).</p>\n\n<blockquote>\n  <p>How to do this in the easiest way?</p>\n</blockquote>\n\n<p>The easiest way, as always, is to use an implementation written by somebody else.</p>\n"}, {"tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1568204217, "creation_date": 1568204217, "answer_id": 57888962, "question_id": 57888085, "link": "https://stackoverflow.com/questions/57888085/how-to-write-to-a-vector-cyclically/57888962#57888962", "title": "How to write to a vector cyclically?", "body": "<p>There is almost ready solution: <a href=\"https://en.cppreference.com/w/cpp/container/queue\" rel=\"nofollow noreferrer\">std::queue</a> which implements cyclic buffer.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;size_t limit, typename T&gt;\nbool push_with_limit(std::queue&lt;T&gt;&amp; q, T&amp;&amp;x)\n{\n    bool value_dropped = false;\n    while (q.size() &gt;= limit) {\n        q.pop_front();\n        value_dropped = true;\n    }\n    q.push_back(std::forward&lt;T&gt;(x));\n\n    return value_dropped;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11872231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff627f75fd400f36456c877e8484192?s=128&d=identicon&r=PG&f=1", "display_name": "Timothee", "link": "https://stackoverflow.com/users/11872231/timothee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1568204217, "creation_date": 1568201106, "question_id": 57888085, "link": "https://stackoverflow.com/questions/57888085/how-to-write-to-a-vector-cyclically", "title": "How to write to a vector cyclically?", "body": "<p>I have a vector WITHOUT SIZE (infinite).</p>\n\n<pre><code>vector&lt;int&gt; myVector\n</code></pre>\n\n<p>I do push_back, but it inserts elements into the back endlessly.\nI need only 5 elements to be written to the vector, and then they will be overwritten (starting from the old elements!).\nHow to do this in the easiest way?</p>\n\n<p>I tried to write to the beginning and tried to do the rotation of the vector, but it did not work.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1568201108, "post_id": 57888060, "comment_id": 102197868, "body": "You may factor out <code>Common code part 1</code> and <code>Common code part 2</code>, e.g. in plain functions or base class member functions. The opposite would be a common function (template) for <code>func()</code> where you provide the <code>specificFunc</code> as argument."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1568201405, "post_id": 57888060, "comment_id": 102198040, "body": "Did that mean the common pre/post code did not depend on the function parameter?"}, {"owner": {"reputation": 339, "user_id": 6289334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-zHSnA3020Ik/AAAAAAAAAAI/AAAAAAAAAIU/W07_YWYpwXs/photo.jpg?sz=128", "display_name": "Wayee", "link": "https://stackoverflow.com/users/6289334/wayee"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1568201522, "post_id": 57888060, "comment_id": 102198103, "body": "@Klaus Yes that&#39;s correct. But the calling of <code>specificFunc()</code> is somewhere in a rather complicated control logic."}], "answers": [{"tags": [], "owner": {"reputation": 465, "user_id": 11241587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea334bb29226f73a25b431b3e48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Theodor Badea", "link": "https://stackoverflow.com/users/11241587/theodor-badea"}, "is_accepted": false, "score": 0, "last_activity_date": 1568201492, "creation_date": 1568201492, "answer_id": 57888205, "question_id": 57888060, "link": "https://stackoverflow.com/questions/57888060/resolve-code-duplication-with-polymorphism/57888205#57888205", "title": "Resolve code duplication with polymorphism", "body": "<p>Try using the fact that both Derive1 and Derive2 inherit from Base. Maybe you can find a way to make \"Common part 1\" and \"Common part 2\" parts of Base.</p>\n"}], "owner": {"reputation": 339, "user_id": 6289334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-zHSnA3020Ik/AAAAAAAAAAI/AAAAAAAAAIU/W07_YWYpwXs/photo.jpg?sz=128", "display_name": "Wayee", "link": "https://stackoverflow.com/users/6289334/wayee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568201492, "creation_date": 1568201022, "last_edit_date": 1568201354, "question_id": 57888060, "link": "https://stackoverflow.com/questions/57888060/resolve-code-duplication-with-polymorphism", "title": "Resolve code duplication with polymorphism", "body": "<p>Suppose there is a base class, and two derived classes from it:</p>\n\n<pre><code>struct Derive1 : public Base\n{\n    func(TypeA arg)\n    {\n        // Common code part 1\n\n        specificFunc(arg);\n\n        // Common code part 2\n    }\n\n    specificFunc(TypeA arg)\n    {\n        // specific implementation\n    }\n};\n\nstruct Derive2 : public Base\n{\n    func(TypeB arg)\n    {\n        // Common code part 1\n\n        specificFunc(arg);\n\n        // Common code part 2\n    }\n\n    specificFunc(TypeB arg)\n    {\n        // specific implementation\n    }\n};\n</code></pre>\n\n<p>Both of the two derived classes have a method <code>func()</code> but with different type of arguments. The bodies of <code>func()</code> are almost the same, except that somewhere in the middle of the function, they call <code>specificFunc()</code> with different types as arguments. and <code>specificFunc()</code> of these two derived class have completely different implementations.</p>\n\n<p>What would be a good design to get rid of the duplication of <code>Common code part 1</code> and <code>Common code part 2</code>?</p>\n\n<p>Extracting <code>Common code part 1</code> and <code>Common code part 2</code> isn't an option as there are control logics inside <code>Func()</code>.</p>\n"}, {"tags": ["c++", "integer", "double"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1568201092, "post_id": 57887982, "comment_id": 102197855, "body": "You can&#39;t, because that&#39;s how floating point numbers work. <code>0.222</code> has no finite representation in binary, so it has to be rounded, and then you get something like <code>22200000000000004</code>. Do you really need to print all the digits, though? Wouldn&#39;t it be enough if you did, say, <code>printf(&quot;%.5f&quot;, myDouble);</code> to print 5 decimal places? If that&#39;s not good enough, you might want to look into getting a decimal arithmetic libarary."}, {"owner": {"reputation": 31823, "user_id": 1960455, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d22bdc5c04b48a9054586eb64174ea99?s=128&d=identicon&r=PG", "display_name": "t.niese", "link": "https://stackoverflow.com/users/1960455/t-niese"}, "edited": false, "score": 0, "creation_date": 1568201238, "post_id": 57887982, "comment_id": 102197932, "body": "You should say why this is a problem for your use-case. If you deal with currencies then you might want to check for a decimal library."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1568207587, "post_id": 57887982, "comment_id": 102201535, "body": "If this is homework, it&#39;s possible that the point of this exercise is that you observe exactly this and start thinking about how that happens."}], "owner": {"reputation": 158, "user_id": 10794403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01f73b4953fdd9ac21bd25892cd6a3b4?s=128&d=identicon&r=PG", "display_name": "igor_ball", "link": "https://stackoverflow.com/users/10794403/igor-ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1568201175, "answer_count": 0, "score": 0, "last_activity_date": 1568200737, "creation_date": 1568200737, "question_id": 57887982, "link": "https://stackoverflow.com/questions/57887982/how-to-avoid-inaccuracy-in-double-numbers-c", "closed_reason": "Duplicate", "title": "How to avoid inaccuracy in double numbers C++", "body": "<p>I need to print all digets of some double number. I have following code:</p>\n\n<pre><code>double number;\n    while (number != floor (number)) number = number * 10;\n</code></pre>\n\n<p>But when <code>number = 0.222</code>, I have following result <code>22200000000000004</code>. How can I avoid this inaccuracy.</p>\n\n<p>P.S. I can use only <code>double</code>, so I can't parse this like a <code>string</code>.</p>\n"}, {"tags": ["c++", "boost", "stdlist", "boost-multi-index"], "answers": [{"tags": [], "owner": {"reputation": 598, "user_id": 2756123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x71E3.jpg?s=128&g=1", "display_name": "Tom Trebicky", "link": "https://stackoverflow.com/users/2756123/tom-trebicky"}, "is_accepted": false, "score": 1, "last_activity_date": 1568204423, "creation_date": 1568204423, "answer_id": 57889024, "question_id": 57887462, "link": "https://stackoverflow.com/questions/57887462/how-to-insert-value-into-c-boostmultiindex-collection-at-specific-index-like/57889024#57889024", "title": "How to insert value into c++ boost::multiindex collection at specific index like in std::list", "body": "<p>What you can do is the following</p>\n\n<pre><code>//...\nauto it = animals.begin();\nanimals.emplace(++(++it), animal{\"elephant\", 4});\n//...\n</code></pre>\n\n<p>Note <code>++it</code> as <code>random_access&lt;&gt;</code> gives you additional <code>operator[]</code> and <code>at()</code> for positional access to the elements but does not provide the iterator with an <code>operator+=</code> as far as I can tell. That means you will have to traverse the container in order to find the spot where you need to insert an element.</p>\n\n<p>According to the documentation, random access indices have several disadvantages with respect to <code>std::vector</code>:</p>\n\n<blockquote>\n  <p>They do not provide memory contiguity, a property of std::vectors by which elements are stored adjacent to one another in a single block of memory.</p>\n</blockquote>\n"}], "owner": {"reputation": 89, "user_id": 2484165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8783p.jpg?s=128&g=1", "display_name": "Fataho", "link": "https://stackoverflow.com/users/2484165/fataho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572287987, "creation_date": 1568198890, "last_edit_date": 1572287987, "question_id": 57887462, "link": "https://stackoverflow.com/questions/57887462/how-to-insert-value-into-c-boostmultiindex-collection-at-specific-index-like", "title": "How to insert value into c++ boost::multiindex collection at specific index like in std::list", "body": "<p>In boost::multi_index I try to insert value at specific location, how ever I did not find any example how to accomplish this task in boost documentation <a href=\"https://www.boost.org/doc/libs/1_59_0/libs/multi_index/doc/tutorial/indices.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_59_0/libs/multi_index/doc/tutorial/indices.html</a> or elsewhere.</p>\n\n<p>This is a code which allows to insert at the beginning or the end of the collection.</p>\n\n<pre><code>struct animal {\n    std::string name;\n    int legs;\n};\n\ntypedef multi_index_container&lt;\n        animal,\n        indexed_by&lt;\n                sequenced&lt;&gt;,\n                ordered_non_unique&lt;member&lt;animal, std::string, &amp;animal::name&gt;&gt;,\n                ordered_non_unique&lt;member&lt;animal, int, &amp;animal::legs&gt;&gt;,\n                random_access&lt;&gt;\n        &gt;\n&gt; animal_multi;\n\nint main() {\n    animal_multi animals;\n\n    animals.push_back({\"shark\", 0});\n    animals.push_back({\"spider\", 8});\n    animals.push_front({\"dog\", 4});\n\n    auto it = animals.begin();\n    auto end = animals.end();\n    for (; it != end; ++it)\n        std::cout &lt;&lt; it-&gt;name + \" \";\n\n    return 0;\n}\n</code></pre>\n\n<p>Current output is:\ndog shark spider </p>\n\n<p>How can I adjust the code in order to pass something, for example, between shark and spider?</p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568200439, "post_id": 57887639, "comment_id": 102197566, "body": "Ok so both Flat should be a friend of Room and the other way round as well? Classes should be each other&#39;s friends? I&#39;ll try that.  Thanks for noticing the 3rd int and alignment issue, i&#39;ve fixed it in the sample code I think."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568200580, "post_id": 57887639, "comment_id": 102197635, "body": "@MarkUcka Not exactly, I meant for example a <code>class</code> <code>Pool</code> that contains a <code>private</code> <code>static</code> pool data member. And you declare <code>Chair</code> and <code>Room</code> and whatever that needs to access the pool data member as <code>friend</code>s of the <code>Pool</code> class."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "reply_to_user": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568201600, "post_id": 57887639, "comment_id": 102198152, "body": "@MarkUcka I added an example if it can help you."}], "tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": true, "score": 1, "last_activity_date": 1568201326, "last_edit_date": 1568201326, "creation_date": 1568199553, "answer_id": 57887639, "question_id": 57887269, "link": "https://stackoverflow.com/questions/57887269/is-there-a-better-way-to-encapsulate-a-shared-storage-pool-that-member-objects-c/57887639#57887639", "title": "Is there a better way to encapsulate a shared storage pool that member objects can access?", "body": "<p>I'm not sure this is what you asked for but... You want a <code>pool</code> object instantiated only once and only accessible by specific classes, right ?</p>\n\n<p>If I correctly understood your problem, I think you should declare the <code>pool</code> object as a <code>private</code> or <code>protected</code> <code>static</code> member of a class, and declare the classes that needs to access it as <code>friend</code>s.<br/>\nThis way you have the guarantee that it will be created only once and that only the allowed classes can access it.</p>\n\n<p>Let me know if I have misunderstood your problem.</p>\n\n<hr>\n\n<p>By the way: <code>Chair</code> contains 2 <code>int</code>s and is of size 8 (bytes). How can you pretend that <code>Room</code> that contains 3 <code>int</code>s and 2 <code>uint16_t</code> can have the same size ?<br/>\n<code>Room</code> is at least of size 16 bytes. Actually, with memory alignment, it will probably be of size 20 instead.<br/>\nIf you move the <code>chairs_start</code> declaration after <code>number_of_chairs</code>, you will get a size of 16 as expected.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> This is an example of what I meant.</p>\n\n<pre><code>#include &lt;array&gt;\nnamespace test\n{\n    class Thing\n    {\n        // Fill the definition as you wish\n    };\n    class OtherThing\n    {\n        // Fill the definition as you wish\n    };\n\n    union Element\n    {\n        Thing t;\n        OtherThing ot;\n    };\n\n    class Pool\n    {\n        friend class Thing;                               // Thing can access the private Pool::pool\n        friend class OtherThing;                          // OtherThing can access the private Pool::pool\n\n        public:\n            static const size_t STORE_SIZE = 512;\n\n        private:\n            static std::array &lt;Element, STORE_SIZE&gt; pool; // The static pool will be instantiated only once\n    };\n}\n</code></pre>\n\n<p>Don't forget to initialize <code>pool</code> somewhere in the <em>.cpp</em> file. This may look as follows (for example):</p>\n\n<pre><code>std::array&lt;test::Element, test::Pool::STORE_SIZE&gt; test::Pool::pool {}; // static data member initialization\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568201029, "post_id": 57887729, "comment_id": 102197819, "body": "And the room class would contain a member vector of chairs I suppose. Sounds very interesting but I&#39;m going to stick with the (for me) easier to understand array approach for now."}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "reply_to_user": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568201213, "post_id": 57887729, "comment_id": 102197918, "body": "@MarkUcka a vector is just that, a (dynamic) array"}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "reply_to_user": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568206154, "post_id": 57887729, "comment_id": 102200679, "body": "@MarkUcka please see my update, do you think you would be able to use that ?"}, {"owner": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568210043, "post_id": 57887729, "comment_id": 102202966, "body": "yeah I think it would be a good way to go in general but my code will be used in a project without exception handling so I don&#39;t think it&#39;s the way to go. <a href=\"https://stackoverflow.com/a/9612884/12021380\">stackoverflow.com/a/9612884/12021380</a> also suggests using EASTL though."}, {"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "reply_to_user": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568273025, "post_id": 57887729, "comment_id": 102223586, "body": "@MarkUcka for error handling you don&#39;t have to throw exceptions you can just terminate the program instead for example."}], "tags": [], "owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "is_accepted": false, "score": 1, "last_activity_date": 1568206083, "last_edit_date": 1568206083, "creation_date": 1568199862, "answer_id": 57887729, "question_id": 57887269, "link": "https://stackoverflow.com/questions/57887269/is-there-a-better-way-to-encapsulate-a-shared-storage-pool-that-member-objects-c/57887729#57887729", "title": "Is there a better way to encapsulate a shared storage pool that member objects can access?", "body": "<p>If you would, you could attack the problem from another angel.</p>\n\n<p>First, make a dynamic storage function. This could simply be implementing your own, perhaps primitive, allocator (which basicly means implementing your own and <code>allocate</code>/<code>deallocate</code> , see <a href=\"https://en.cppreference.com/w/cpp/memory/allocator\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/memory/allocator</a>). </p>\n\n<p>Then you may use your allocator for any type of collection, example with <code>std::vector</code>:</p>\n\n<pre><code>#include &lt;vector&gt;\n\ntemplate &lt;class T&gt;\nusing myvector = std::vector&lt;T, MyAllocator&lt;T&gt; &gt;;\nmyvector&lt;Room&gt; rooms;\n</code></pre>\n\n<p>Besides the obvious advantage of being more generic, this has the added benefit of not using extra space for when objects are smaller than the union size.</p>\n\n<hr>\n\n<p><strong>Update:</strong> Here is an example that uses an 'arena-style' allocator to get you startet. This is on par with what the OP provided, ie. no error-checking(no buffer overrun check) and no re-use of buffer.</p>\n\n<pre><code>#include &lt;vector&gt;\n\nchar mem[512*10];\nunsigned int current = 0;\n\ntemplate&lt;class T&gt;\nstruct my_allocator {\n  using value_type = T;\n  T* allocate( std::size_t n ){current += n; return mem + current - n;}\n  void deallocate( T* p, std::size_t n ){}\n\n};\n\nstd::vector&lt;int, my_allocator&lt;int&gt; &gt; rooms(my_allocator&lt;int&gt;{});\n</code></pre>\n\n<p>Link to <a href=\"https://godbolt.org/z/ejIK-Q\" rel=\"nofollow noreferrer\">godbolt</a> </p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568211875, "post_id": 57888425, "comment_id": 102203989, "body": "With this example, how do you get access to rooms? For example, how does a function get room(4)?"}, {"owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "reply_to_user": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "edited": false, "score": 0, "creation_date": 1568575560, "post_id": 57888425, "comment_id": 102308110, "body": "Yes. You would have O(n) access instead of random access"}], "tags": [], "owner": {"reputation": 3320, "user_id": 3480808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbca64f49de22131b4b51fddfa8a7df4?s=128&d=identicon&r=PG", "display_name": "Michael Doubez", "link": "https://stackoverflow.com/users/3480808/michael-doubez"}, "is_accepted": false, "score": 0, "last_activity_date": 1568202284, "creation_date": 1568202284, "answer_id": 57888425, "question_id": 57887269, "link": "https://stackoverflow.com/questions/57887269/is-there-a-better-way-to-encapsulate-a-shared-storage-pool-that-member-objects-c/57888425#57888425", "title": "Is there a better way to encapsulate a shared storage pool that member objects can access?", "body": "<p>Your requirement  <code>I don't want to store a pointer in the objects to the store because of the overhead.</code> already drives a lot the design. You have the following choices:</p>\n\n<ol>\n<li>use a global store (as you did).</li>\n<li>pass the store in parameter to add/del functions</li>\n<li>a mix of the above (using a singleton global store as default parameters)</li>\n</ol>\n\n<p>In all cases, you should encapsulate your store in a class and have a common allocation scheme. In the current design, you cannot have more than 2 elements (because you allocate them from extremities) and the add is implemented in the object's function.</p>\n\n<p>Since you are using the position in the pool to add elements, you can use a single increasing index in the pool and assume chairs are allocated just next to it.</p>\n\n<p>Example:</p>\n\n<pre><code>class Store\n{\npublic:\n    static Store&amp; globalStore(){static Store g; return g;}\npublic:\n    Room&amp; allocateRoom() {return store[next_available_elt++].room;}\n    Chair&amp; allocateChair() {return store[next_available_elt++].chair;}\n\n    Chair&amp; getChair(Room&amp; room, size_t i)\n    {\n        size_t index_room = std::distance(&amp;store[0],(Element*)&amp;room);\n        return store[index_room + i];\n    }\n\nprivate:\n    union Element{\n        Chair chair;\n        Room room;\n    };\n    Element store[STORE_SIZE] = // init with chaining of next;\n    size_t next_available_elt = 0;\n};\n</code></pre>\n\n<p>Note that this design is brittle. You'd better add the overhead of chaining in Chair/Room and it is cleaner design but at the cost of O(N) access to chairs.</p>\n"}], "owner": {"reputation": 56, "user_id": 12021380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71abf1c31afbf63ea7a732ff1b3f794?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Ucka", "link": "https://stackoverflow.com/users/12021380/mark-ucka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57887639, "answer_count": 3, "score": -1, "last_activity_date": 1568206083, "creation_date": 1568198164, "last_edit_date": 1568200237, "question_id": 57887269, "link": "https://stackoverflow.com/questions/57887269/is-there-a-better-way-to-encapsulate-a-shared-storage-pool-that-member-objects-c", "title": "Is there a better way to encapsulate a shared storage pool that member objects can access?", "body": "<h1>Overal Goal</h1>\n\n<p>I'm writing a storage library for an embedded system with no dynamic memory allocation which handles the storage of several different types of objects in a single array / pool of static memory. The objects should behave as if they are members of each other.</p>\n\n<p>The number of objects is unknown. The data comes from a structured source so it only needs to be added to the store once. Data gets added sequentially but needs to be read arbitrarily.</p>\n\n<h2>Specific Problem</h2>\n\n<p>Each object is a simple class but instances of these classes need to access the shared storage pool.</p>\n\n<h2>My solution</h2>\n\n<p>I set up an array of unions which contain the simple POD objects, all of which have similar size. These objects store their children's location within the pool as private members. The two different types grow from opposite sides so only the total number of objects is limited.</p>\n\n<p>Adding to the store can be done through the main class, which needs to access these private members so the main class is declared a friend in the object class. </p>\n\n<p>However, the objects can't access the main's storage pool so for now I've declared the storage pool outside the class. I don't want to store a pointer in the objects to the store because of the overhead. Only one store needs to exist at a time.</p>\n\n<h2>Code (for C++11)</h2>\n\n<p>The below is working code but it doesn't prevent the storage pool from being accessed. So is there a better way?</p>\n\n<pre><code>\n#include &lt;cstdio&gt;\n#include &lt;cstdint&gt;\n\nnamespace Store{\n\nconst int STORE_SIZE = 512; \n\n// 8 bytes\nclass Chair {\npublic:\n    int a;\n    int n_legs;\n};\n\n// 8 bytes\nclass Room {\n    friend class Flat; \n\nprivate:\n    uint16_t chairs_start;\n\npublic:\n    uint16_t number_of_chairs;\n    int a;\n    int b;\n\n    // member functions    \n    Chair getChair( int idx );\n};\n\n// 8 byte element of storage can be either one or the other\nunion Element{\n    Chair chair;\n    Room room;\n};\n\nunion Element;\nElement pool[STORE_SIZE];\n\nChair Room::getChair( int idx )\n{\n    return pool[chairs_start - idx].chair; // needs access to pool!\n}\n\nclass Flat{\npublic:\n\n    void addRoom() {\n        Room room;\n        room.chairs_start = pool_next_chair;\n        pool[pool_next_room++].room = room;\n    }\n\n    void addChair() {\n        Chair chair;\n        chair.a = pool_next_chair; // only for testing\n\n        pool[pool_next_chair--].chair = chair; // add chair to pool from other side\n\n        // incremente chair count for last added room\n        pool[pool_next_room - 1].room.number_of_chairs++; \n    }\n\n\n    Room getRoom( int idx ){\n        return pool[idx].room;\n    }\n\nprivate:\n\n    uint16_t pool_next_room = 0;    \n    const uint16_t pool_first_chair = STORE_SIZE - 1;   \n    uint16_t pool_next_chair = pool_first_chair;    \n};\n\n}\n\nint main() {\n\n    Store::Flat flat;\n\n    flat.addRoom();\n    flat.addChair();\n    flat.addChair();\n    flat.addRoom();\n    flat.addChair();\n\n    auto room2 =  flat.getRoom(1);\n\n    auto chair1 = room2.getChair(0);\n\n    printf(\"Got chairs %d and %d\\n\",chair1.a, flat.getRoom(0).getChair(1).a);\n    // Got chairs 509 and 510\n    return 0;\n}\n</code></pre>\n\n<p>The code works but leaves the pool accessible. In general, is there a better layout or structuring I could use which results in a similar manner of simple access like in the above main() function?</p>\n\n<p>Any other code quality comments are highly welcome! Thanks a lot!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1568197993, "post_id": 57887172, "comment_id": 102196301, "body": "So if the passed in vector has 9 elements <code>iVec</code> should contains 3 arrays of length 3?"}, {"owner": {"reputation": 1484, "user_id": 11102572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c83b6b17eb13d31ab7c5d1ac554ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Igor G", "link": "https://stackoverflow.com/users/11102572/igor-g"}, "edited": false, "score": 4, "creation_date": 1568198068, "post_id": 57887172, "comment_id": 102196337, "body": "<i>I don&#39;t want to change this method</i> - as long as this method takes an argument <b>by value</b> there&#39;s no way to avoid creating a copy."}, {"owner": {"reputation": 3379, "user_id": 5709159, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DL3rX.jpg?s=128&g=1", "display_name": "Aleksey Timoshchenko", "link": "https://stackoverflow.com/users/5709159/aleksey-timoshchenko"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1568198098, "post_id": 57887172, "comment_id": 102196349, "body": "@SombreroChicken yes"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1568198204, "post_id": 57887172, "comment_id": 102196412, "body": "Because <code>std::array</code> is an aggregate type like an actual C-style array, you could possibly overlay it with a <code>std::vector&lt;int&gt;</code> but only in very narrow amount of cases. And it&#39;s really going to break the strict aliasing rule. Another problem is that the function takes its argument by value, and then you need to pass the exact type. To summarize: Don&#39;t try such things, copy the data into the correct container type, and call the function without worries. You could overload the function to do the copying and call the correct function."}, {"owner": {"reputation": 331, "user_id": 8231265, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/cr6PJ.jpg?s=128&g=1", "display_name": "Hello Everyone", "link": "https://stackoverflow.com/users/8231265/hello-everyone"}, "edited": false, "score": 1, "creation_date": 1568198260, "post_id": 57887172, "comment_id": 102196439, "body": "That <code>one guy </code>  likely means to linearize your 2d vector (i.e transforming 2d into 1d)."}], "answers": [{"tags": [], "owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "is_accepted": false, "score": 2, "last_activity_date": 1568198395, "creation_date": 1568198395, "answer_id": 57887326, "question_id": 57887172, "link": "https://stackoverflow.com/questions/57887172/is-it-possible-without-copy-to-pass-stdvectorint-as-param-to-fun-that-get-st/57887326#57887326", "title": "Is it possible without copy to pass std::vector&lt;int&gt; as param to fun that get std::vector&lt;std::array&lt;int, 3&gt;&gt;?", "body": "<p>The C++ standard does not guarantee that <code>sizeof(std::array&lt;MyType, N&gt;)==sizeof(MyType)*N</code>. That is, even though the elements of an individual <code>std::array</code> are contiguous, a <code>vector</code> of <code>array</code>s may not have the elements of the arrays evenly spaced. So there is no standard-compliant way of doing this, because the two vectors would <em>not</em> necessarily be \"taking the same memory\".</p>\n\n<p>You could maybe get things to work with <code>reinterpret_cast</code> and such on your compiler. (<code>std::move</code> from a reinterpreted vector type will definitely <em>not</em> work, not in theory and not in practice.) This will not be portable or reliable or a good idea. You have three options: copy the data, change the source type, or change the destination type.</p>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 0, "last_activity_date": 1568200393, "creation_date": 1568200393, "answer_id": 57887892, "question_id": 57887172, "link": "https://stackoverflow.com/questions/57887172/is-it-possible-without-copy-to-pass-stdvectorint-as-param-to-fun-that-get-st/57887892#57887892", "title": "Is it possible without copy to pass std::vector&lt;int&gt; as param to fun that get std::vector&lt;std::array&lt;int, 3&gt;&gt;?", "body": "<blockquote>\n  <p>I don't want to change this method ...</p>\n</blockquote>\n\n<p>But you should. If you make it work with iterators rather than the container, you will get more flexibility:</p>\n\n<pre><code>template &lt;typename IT&gt;\nvoid foo(IT begin, IT end){\n    ....\n}\n</code></pre>\n\n<p>Now passing <code>begin</code> and <code>end</code> of whatever container is possible. However, if you want to go back to passing iterators to a <code>std::vector&lt;std::array&lt;int, 3&gt;&gt;</code> you would have to invest some extra effort to get an iterator type that lets you iterate from <code>[0][0]</code> till <code>[size_x][size_y]</code>, but as the arrays all have size 3, this shouldnt be too complicated. And anyhow you should consider to use flat vectors instead of a 2D structure. </p>\n"}], "owner": {"reputation": 3379, "user_id": 5709159, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/DL3rX.jpg?s=128&g=1", "display_name": "Aleksey Timoshchenko", "link": "https://stackoverflow.com/users/5709159/aleksey-timoshchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568200393, "creation_date": 1568197834, "question_id": 57887172, "link": "https://stackoverflow.com/questions/57887172/is-it-possible-without-copy-to-pass-stdvectorint-as-param-to-fun-that-get-st", "title": "Is it possible without copy to pass std::vector&lt;int&gt; as param to fun that get std::vector&lt;std::array&lt;int, 3&gt;&gt;?", "body": "<p>I have such a method </p>\n\n<pre><code>void foo(std::vector&lt;std::array&lt;int, 3&gt;&gt; iVec){\n....\n}\n</code></pre>\n\n<p>I don't want to change this method, but I need to pass as param this vector <code>std::vector&lt;int&gt;</code></p>\n\n<p>As far as I understand this two vectors are taking the same memory... So, theoretical I can use method <code>std::move</code> to move this vector as is. But this vectors has a different size.. so... I don't know...</p>\n\n<blockquote>\n  <p>One guy told me that it could be possible if change the function that it will get two int pointers, and so it could be possible. </p>\n</blockquote>\n\n<p>But I don't understand what does it mean without a example... If someone could provide an example I really appreciate.</p>\n\n<p>But anyway question still is: if is it possible to pass my vector as a function param that has another type. If yes, so how? </p>\n\n<p>Fell free to ask</p>\n"}, {"tags": ["c++", "boost", "boost-spirit"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1568198033, "post_id": 57886865, "comment_id": 102196318, "body": "PEG grammars do not handle left-recursion well. In general you have to split out helper rules to write without left-recursion. Many of my expression grammar answers show the typical way of dealing with this in Spirit (assuming you also want to capture the values into an AST)."}, {"owner": {"reputation": 23, "user_id": 12052149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SweINNHJsjg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrcndW9XCQFJbCzB_n5W64aENfWw/photo.jpg?sz=128", "display_name": "sentrix", "link": "https://stackoverflow.com/users/12052149/sentrix"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1568205802, "post_id": 57886865, "comment_id": 102200474, "body": "I&#39;ve tried searching around for left-recursion elimination now, and I&#39;ve found a few answers by you, but I&#39;m not sure how to apply them to my own case. Additionally, I found an example C grammar here: <a href=\"http://boost-spirit.com/distrib/spirit_1_7_0/libs/spirit/example/application/c/c_grammar.cpp\" rel=\"nofollow noreferrer\">boost-spirit.com/distrib/spirit_1_7_0/libs/spirit/example/&hellip;</a>.  I&#39;m very new to parsers (and the entire compiler theory area), so I do not quite understand the logics behind e.g. turning a left-recursive grammar into a right-recursive grammar (as seen with e.g. the &#39;postfix_expression&#39; rule from the above link)."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12052149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SweINNHJsjg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrcndW9XCQFJbCzB_n5W64aENfWw/photo.jpg?sz=128", "display_name": "sentrix", "link": "https://stackoverflow.com/users/12052149/sentrix"}, "edited": false, "score": 0, "creation_date": 1568299998, "post_id": 57897488, "comment_id": 102238580, "body": "Fantastic! Thank you very much - I finally figured it out!"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 0, "last_activity_date": 1568240777, "last_edit_date": 1568240777, "creation_date": 1568240264, "answer_id": 57897488, "question_id": 57886865, "link": "https://stackoverflow.com/questions/57886865/trouble-with-recursive-boost-spirit-parsing/57897488#57897488", "title": "Trouble with recursive Boost.Spirit parsing", "body": "<p>PEG grammars do not handle left-recursion well. In general you have to split out helper rules to write without left-recursion.</p>\n\n<p>In your particular case, the goal production</p>\n\n<pre><code>a ::= ... | A[a] | a1 op a2 | ...\n</code></pre>\n\n<p>Seems a little off. This would allows <code>foo[bar]</code> or <code>foo + bar</code> but not <code>foo + bar[qux]</code>.</p>\n\n<p>Usually, the choice between array element reference or plain identifier is at a lower level of precedence (often \"simple expression\").</p>\n\n<p>Here's a tiny elaboration:</p>\n\n<pre><code>literal           = number_literal | string_literal; // TODO exapnd?\n\nexpr_arr          = identifier &gt;&gt; '[' &gt;&gt; (expr_a % ',') &gt;&gt; ']';\nsimple_expression = literal | expr_arr | identifier;\nexpr_binary_arith = simple_expression &gt;&gt; op_binary_arith &gt;&gt; expr_a;\nexpr_a            = expr_binary_arith | simple_expression;\n</code></pre>\n\n<p>Now you can parse e.g.:</p>\n\n<pre><code>for (std::string const&amp; input : {\n        \"A[3*4]\",\n        \"A[F[3]]\",\n        \"A[8 + F[0x31]]\",\n        \"3 * \\\"foo\\\"\",\n    })\n{\n    std::cout &lt;&lt; std::quoted(input) &lt;&lt; \" -&gt; \";\n\n    It f=begin(input), l=end(input);\n    AST::Expr e;\n\n    if (parse(f,l,g,e)) {\n        std::cout &lt;&lt; \"Parsed: \" &lt;&lt; e &lt;&lt; \"\\n\";\n    } else {\n        std::cout &lt;&lt; \"Failed\\n\";\n    }\n\n    if (f!=l) {\n        std::cout &lt;&lt; \"Remaining: \" &lt;&lt; std::quoted(std::string(f,l)) &lt;&lt; \"\\b\";\n    }\n}\n</code></pre>\n\n<p>Which prints <strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/b5ec781f90ea1316\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>\"A[3*4]\" -&gt; Parsed: A[3*4]\n\"A[F[3]]\" -&gt; Parsed: A[F[3]]\n\"A[8 + F[0x31]]\" -&gt; Parsed: A[8+F[49]]\n\"3 * \\\"foo\\\"\" -&gt; Parsed: 3*\"foo\"\n</code></pre>\n\n<blockquote>\n  <p><strong>NOTE</strong> I deliberately left efficiency and operator precedence out of the picture for now.</p>\n  \n  <p>These are talked about in detail in other answers:</p>\n  \n  <ul>\n  <li><a href=\"https://stackoverflow.com/questions/8464969/boostspirit-expression-parser/8468822#8468822\">Boost::Spirit Expression Parser</a></li>\n  <li><a href=\"https://stackoverflow.com/questions/24219969/implementing-operator-precedence-with-boost-spirit/24220293#24220293\">Implementing operator precedence with boost spirit</a></li>\n  <li><a href=\"https://stackoverflow.com/questions/39820298/boostspirit-optimizing-an-expression-parser\">Boost::Spirit : Optimizing an expression parser</a></li>\n  </ul>\n  \n  <p>And many more</p>\n</blockquote>\n\n<h2>Full Demo Listing</h2>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/b5ec781f90ea1316\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>//#define BOOST_SPIRIT_DEBUG\n#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;iomanip&gt;\n#include &lt;experimental/iterator&gt;\nnamespace qi = boost::spirit::qi;\n\nnamespace AST {\n    using Var = std::string;\n\n    struct String : std::string {\n        using std::string::string;\n    };\n\n    using Literal = boost::variant&lt;String, intmax_t, double&gt;;\n\n    enum class ArithOp {\n        addition, subtraction, division, multplication\n    };\n\n    struct IndexExpr;\n    struct BinOpExpr;\n\n    using Expr = boost::variant&lt;\n        Literal,\n        Var,\n        boost::recursive_wrapper&lt;IndexExpr&gt;,\n        boost::recursive_wrapper&lt;BinOpExpr&gt;\n    &gt;;\n\n    struct IndexExpr {\n        Expr expr;\n        std::vector&lt;Expr&gt; indices;\n    };\n\n    struct BinOpExpr {\n        Expr lhs, rhs;\n        ArithOp op;\n    };\n\n    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, Literal const&amp; lit) {\n        struct {\n            std::ostream&amp; os;\n            void operator()(String const&amp; s) const { os &lt;&lt; std::quoted(s); }\n            void operator()(double d) const { os &lt;&lt; d; }\n            void operator()(intmax_t i) const { os &lt;&lt; i; }\n        } vis {os};\n        boost::apply_visitor(vis, lit);\n        return os;\n    }\n    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, ArithOp const&amp; op) {\n        switch(op) {\n            case ArithOp::addition: return os &lt;&lt; '+';\n            case ArithOp::subtraction: return os &lt;&lt; '-';\n            case ArithOp::division: return os &lt;&lt; '/';\n            case ArithOp::multplication: return os &lt;&lt; '*';\n        }\n        return os &lt;&lt; '?';\n    }\n    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, BinOpExpr const&amp; e) {\n        return os &lt;&lt; e.lhs &lt;&lt; e.op &lt;&lt; e.rhs;\n    }\n    std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, IndexExpr const&amp; e) {\n        std::copy(\n            begin(e.indices),\n            end(e.indices),\n            std::experimental::make_ostream_joiner(os &lt;&lt; e.expr &lt;&lt; '[', \",\"));\n\n        return os &lt;&lt; ']';\n    }\n}\n\nBOOST_FUSION_ADAPT_STRUCT(AST::IndexExpr, expr, indices)\nBOOST_FUSION_ADAPT_STRUCT(AST::BinOpExpr, lhs, op, rhs)\n\ntemplate &lt;typename Iterator, typename Skipper = qi::space_type&gt;\nstruct G : qi::grammar&lt;Iterator, AST::Expr()&gt; {\n    G() : G::base_type(start) {\n        using namespace qi;\n\n        identifier        = alpha &gt;&gt; *alnum;\n\n        number_literal    =\n            qi::real_parser&lt;double, qi::strict_real_policies&lt;double&gt; &gt;{}\n          | \"0x\" &gt;&gt; qi::uint_parser&lt;intmax_t, 16&gt; {}\n          |         qi::int_parser&lt;intmax_t, 10&gt; {}\n          ;\n\n        string_literal    = '\"' &gt;&gt; *('\\\\' &gt;&gt; char_escape | ~char_('\"')) &gt;&gt; '\"';\n\n        literal           = number_literal | string_literal; // TODO exapnd?\n\n        expr_arr          = identifier &gt;&gt; '[' &gt;&gt; (expr_a % ',') &gt;&gt; ']';\n        simple_expression = literal | expr_arr | identifier;\n        expr_binary_arith = simple_expression &gt;&gt; op_binary_arith &gt;&gt; expr_a;\n        expr_a            = expr_binary_arith | simple_expression;\n\n        start = skip(space) [expr_a];\n\n        BOOST_SPIRIT_DEBUG_NODES(\n                (start)\n                (expr_a)(expr_binary_arith)(simple_expression)(expr_a)\n                (literal)(number_literal)(string_literal)\n                (identifier))\n    }\n\n  private:\n    struct escape_sym : qi::symbols&lt;char, char&gt; {\n        escape_sym() {\n            this-&gt;add\n                (\"b\", '\\b')\n                (\"f\", '\\f')\n                (\"r\", '\\r')\n                (\"n\", '\\n')\n                (\"t\", '\\t')\n                (\"\\\\\", '\\\\')\n                ;\n        }\n    } char_escape;\n\n    struct op_binary_arith_sym : qi::symbols&lt;char, AST::ArithOp&gt; {\n        op_binary_arith_sym() {\n            this-&gt;add\n                (\"+\", AST::ArithOp::addition)\n                (\"-\", AST::ArithOp::subtraction)\n                (\"/\", AST::ArithOp::division)\n                (\"*\", AST::ArithOp::multplication)\n                ;\n        }\n    } op_binary_arith;\n\n    qi::rule&lt;Iterator, AST::Expr()&gt; start;\n    qi::rule&lt;Iterator, AST::IndexExpr(), Skipper&gt; expr_arr;\n    qi::rule&lt;Iterator, AST::BinOpExpr(), Skipper&gt; expr_binary_arith;\n    qi::rule&lt;Iterator, AST::Expr(), Skipper&gt; simple_expression, expr_a;\n    // implicit lexemes\n    qi::rule&lt;Iterator, AST::Literal()&gt; literal, string_literal, number_literal;\n    qi::rule&lt;Iterator, AST::Var()&gt; identifier;\n};\n\nint main() {\n    using It = std::string::const_iterator;\n    G&lt;It&gt; const g;\n    for (std::string const&amp; input : {\n            \"A[3*4]\",\n            \"A[F[3]]\",\n            \"A[8 + F[0x31]]\",\n            \"3 * \\\"foo\\\"\",\n        })\n    {\n        std::cout &lt;&lt; std::quoted(input) &lt;&lt; \" -&gt; \";\n\n        It f=begin(input), l=end(input);\n        AST::Expr e;\n\n        if (parse(f,l,g,e)) {\n            std::cout &lt;&lt; \"Parsed: \" &lt;&lt; e &lt;&lt; \"\\n\";\n        } else {\n            std::cout &lt;&lt; \"Failed\\n\";\n        }\n\n        if (f!=l) {\n            std::cout &lt;&lt; \"Remaining: \" &lt;&lt; std::quoted(std::string(f,l)) &lt;&lt; \"\\b\";\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12052149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SweINNHJsjg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrcndW9XCQFJbCzB_n5W64aENfWw/photo.jpg?sz=128", "display_name": "sentrix", "link": "https://stackoverflow.com/users/12052149/sentrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 57897488, "answer_count": 1, "score": 2, "last_activity_date": 1568240777, "creation_date": 1568196622, "question_id": 57886865, "link": "https://stackoverflow.com/questions/57886865/trouble-with-recursive-boost-spirit-parsing", "title": "Trouble with recursive Boost.Spirit parsing", "body": "<p>I am trying to model a parser for a subset of the C language, for a school project. However, I seem stuck in the process of generating recursive parsing rules for Boost.Spirit, as my rules either overflow the stack or simply do not pick up anything.</p>\n\n<p>For example, I want to model the following syntax:</p>\n\n<p>a ::= ... | A[a] | a1 op a2 | ...</p>\n\n<p>There are some other subsets of syntax for this expression rule, but those are working without problems. For example, if I were to parse A[3*4], it should be read as a recursive parsing where A[...] (A[a] in the syntax) is the array accessor and 3*4 (a1 op a2 in the syntax) is the index.</p>\n\n<p>I've tried defining the following rule objects in the grammar struct:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>qi::rule&lt;Iterator, Type(), Skipper&gt; expr_arr;\nqi::rule&lt;Iterator, Type(), Skipper&gt; expr_binary_arith;\nqi::rule&lt;Iterator, Type(), Skipper&gt; expr_a;\n</code></pre>\n\n<p>And giving them the following grammar:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>expr_arr %= qi::lexeme[identifier &gt;&gt; qi::omit['[']] &gt;&gt; expr_a &gt;&gt; qi::lexeme[qi::omit[']']];\nexpr_binary_arith %= expr_a &gt;&gt; op_binary_arith &gt;&gt; expr_a;\nexpr_a %= (expr_binary_arith | expr_arr);\n</code></pre>\n\n<p>where \"op_binary_arith\" is a qi::symbol&lt;> object with the allowed operator symbols.</p>\n\n<p>This compiles fine, but upon execution enters a supposedly endless loop, and the stack overflows. I've tried looking at the answer by Sehe in the following question: <a href=\"https://stackoverflow.com/questions/40325709/how-to-set-max-recursion-in-boost-spirit\">How to set max recursion in boost spirit</a>.</p>\n\n<p>However, I have been unsuccessful in setting a max recursion depth. Firstly, I failed to make it compile without errors for almost any of my attempts, but on the last attempt it built successfully, albeit with very unexpected results.</p>\n\n<p>Can someone guide me in the right direction, as to how I should go about implementing this grammar correctly?</p>\n"}, {"tags": ["c++", "linux", "openssl"], "comments": [{"owner": {"reputation": 1726, "user_id": 1776419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aef72f0ece44f4952764a30b5b10da9b?s=128&d=identicon&r=PG", "display_name": "Darren Smith", "link": "https://stackoverflow.com/users/1776419/darren-smith"}, "edited": false, "score": 1, "creation_date": 1568632917, "post_id": 57886817, "comment_id": 102323482, "body": "did you try setting the keep_alive option?"}, {"owner": {"reputation": 422, "user_id": 5975842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea7a9edae7429a03c76b073b1fd6a8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chemistree", "link": "https://stackoverflow.com/users/5975842/chemistree"}, "reply_to_user": {"reputation": 1726, "user_id": 1776419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aef72f0ece44f4952764a30b5b10da9b?s=128&d=identicon&r=PG", "display_name": "Darren Smith", "link": "https://stackoverflow.com/users/1776419/darren-smith"}, "edited": false, "score": 0, "creation_date": 1568645963, "post_id": 57886817, "comment_id": 102330886, "body": "Didn&#39;t realize that existed, I&#39;m going to try that now"}], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 5975842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea7a9edae7429a03c76b073b1fd6a8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chemistree", "link": "https://stackoverflow.com/users/5975842/chemistree"}, "edited": false, "score": 0, "creation_date": 1568724398, "post_id": 57960924, "comment_id": 102358753, "body": "Thank you, I&#39;m now using keepalives directly with openssl and the unix sockets api, which seems to work fine"}], "tags": [], "owner": {"reputation": 1726, "user_id": 1776419, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aef72f0ece44f4952764a30b5b10da9b?s=128&d=identicon&r=PG", "display_name": "Darren Smith", "link": "https://stackoverflow.com/users/1776419/darren-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1568651060, "creation_date": 1568651060, "answer_id": 57960924, "question_id": 57886817, "link": "https://stackoverflow.com/questions/57886817/openssl-client-stuck-in-endless-read/57960924#57960924", "title": "OpenSSL client stuck in endless read", "body": "<p>Just expanding on the keep_alive option I mentioned in the comment.</p>\n\n<p>In the scenario you described, it seems possible that the underlying TCP socket connection was terminated in an unclean fashion.  I.e., you say the IP address was reassigned. </p>\n\n<p>Ideally when there is a TCP socket termination, you want your code to exit out of any blocked read/poll operation.  That is what will happen for normal socket closures, e.g., say the remote process is killed, or the remote process just decides it is time to close.  But if the IP address of your host is changed .... I'm not sure there will necessarily be a low level TCP messages that says, to affect, this connection is now closed.    So the consequence for your program is that is can still hold a local socket (the local TCP endpoint), and not realise the connection has dropped.</p>\n\n<p>This is where something like keep_alive.  The idea is that the kernel will send keep alive packets to keep testing if the connection is established; if these ever fail, then it can close the local socket (and so your blocking read, or blocking select, will return with some sort of end-of-stream error).</p>\n\n<p>Separately to keep_alive, you can also consider application heart-beat messages (e.g., websocket has ping/pong).  In addition to ensuring the TCP connection remains established, it confirms whether the remote application is healthy.</p>\n"}], "owner": {"reputation": 422, "user_id": 5975842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea7a9edae7429a03c76b073b1fd6a8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chemistree", "link": "https://stackoverflow.com/users/5975842/chemistree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 57960924, "answer_count": 1, "score": -1, "last_activity_date": 1568651060, "creation_date": 1568196486, "question_id": 57886817, "link": "https://stackoverflow.com/questions/57886817/openssl-client-stuck-in-endless-read", "title": "OpenSSL client stuck in endless read", "body": "<p>I am using <a href=\"https://github.com/yhirose/cpp-httplib\" rel=\"nofollow noreferrer\">cpp-httplib</a> to retrieve some data from a server using long polling (that is, the client will issue a request to the server, and the server will just keep the connection open until the required data is available or a timeout is reached). </p>\n\n<p>The program is running on my raspberry pi, which sits behind a router that does <em>not</em> have an outgoing static ip address. Every time the ip is reassigned  (or, at least, close to that time point), my program breaks, in that the thread currently performing the poll will be forever stuck in <code>httplib::SSLClient::Get</code>, which is caused by a blocking <code>read()</code> syscall. Both server- and client timeouts are unable to do anything, while a connection close <em>should</em> make read immediately return 0, which is what i would have expected in this situation.</p>\n\n<p>Inspecting the program with gdb shows the following:</p>\n\n<pre><code>(gdb) thread 2\n(gdb) where\n__libc_read (nbytes=5, buf=0x75608edb, fd=3) at ../sysdeps/unix/sysv/linux/read.c:26                          \n__libc_read (fd=3, buf=0x75608edb, nbytes=5) at ../sysdeps/unix/sysv/linux/read.c:24                          \n0x76d1862c in ?? () from /usr/lib/arm-linux-gnueabihf/libcrypto.so.1.1                                        \nBacktrace stopped: previous frame identical to this frame (corrupt stack?)\n</code></pre>\n\n<p>I am not doing anything (as far as I know) that could accidentally overwrite return addresses.</p>\n\n<p>For comparison, a 'healthy' stack trace during a <code>SSLCLient::Get</code> can be found <a href=\"https://pastebin.com/iyk4c8YG\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The actual code is quite a lot, but here's a short version that shows the same behaviour:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#define CPPHTTPLIB_OPENSSL_SUPPORT 1\n#include \"httplib.h\"\n\nvoid poll(httplib::SSLClient* c, char* path) {\n  while (true) {\n    auto response = c-&gt;Get(path);\n    std::cout &lt;&lt; response.body &lt;&lt; std::endl;\n  }\n}\n\nint main(int argc, char* argv[]) {\n  if (argc &gt;= 3) {\n    httplib::SSLClient client(argv[1], 443, 20);\n    std::thread poll_thread(poll, &amp;client, argv[2]);\n    poll_thread.join();\n  } else {\n    std::cerr &lt;&lt; \"Usage: ./poll &lt;host&gt; &lt;path&gt;\" &lt;&lt; std::endl;\n    return 1;\n  }\n}\n</code></pre>\n\n<p>I can think of some workarounds that might or might not work, but I'd really like to know why and how this is happening in the first place.</p>\n"}, {"tags": ["c++", "dictionary", "insert"], "comments": [{"owner": {"reputation": 13, "user_id": 8278856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kS9a9.jpg?s=128&g=1", "display_name": "Basile Czajkowski", "link": "https://stackoverflow.com/users/8278856/basile-czajkowski"}, "edited": false, "score": 0, "creation_date": 1568196318, "post_id": 57886750, "comment_id": 102195479, "body": "Sorry for improperly formatting code in this question, StackOverflow would not allow me to post it yelling at me for &quot;indent 4 spaces or press ctrl+k&quot; which i tried to no avail. It&#39;s not my day i guess."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1568196711, "post_id": 57886750, "comment_id": 102195692, "body": "You copy the text of the code from your IDE, select it and press ctrl+k or use the {} button. If that still does not format correctly use the site: <a href=\"http://format.krzaq.cc/\" rel=\"nofollow noreferrer\">format.krzaq.cc</a> to reformat then paste and select it and press ctrl+k or use the {} button"}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "edited": false, "score": 0, "creation_date": 1568196726, "post_id": 57886750, "comment_id": 102195701, "body": "What was the error with the pair attempt? Have you checked <a href=\"https://en.cppreference.com/w/cpp/container/map/insert\" rel=\"nofollow noreferrer\">the reference</a> instead of guessing?"}, {"owner": {"reputation": 13, "user_id": 8278856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kS9a9.jpg?s=128&g=1", "display_name": "Basile Czajkowski", "link": "https://stackoverflow.com/users/8278856/basile-czajkowski"}, "edited": false, "score": 0, "creation_date": 1568196963, "post_id": 57886750, "comment_id": 102195815, "body": "The error was: &quot;no matching function for call to std::map&lt;MyObj*, Datastruct&gt;::insert(std::pair&lt;MyObj*, Datastruct&gt;&quot;"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1568197203, "post_id": 57886750, "comment_id": 102195919, "body": "tip: dont panic, but rtfm (read-the-fine-manual). Insert indeed has no overload for the parameters you pass, though it has others: <a href=\"https://en.cppreference.com/w/cpp/container/map/insert\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/container/map/insert</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1568197256, "post_id": 57886750, "comment_id": 102195946, "body": "tip2: dont get confused by the reference in the error message, thats always part of the error message, when the compiler cannot find a matching overload"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1568197309, "post_id": 57886750, "comment_id": 102195976, "body": "show your attempt of inserting a pair, that should work, but you need to show the code"}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1568198403, "last_edit_date": 1568198403, "creation_date": 1568197540, "answer_id": 57887082, "question_id": 57886750, "link": "https://stackoverflow.com/questions/57886750/why-cant-i-insert-objects-into-a-map-in-c/57887082#57887082", "title": "Why can&#39;t I insert objects into a map in c++", "body": "<p>The map's value type is not</p>\n\n<pre><code>std::pair&lt;MyObj*, Datastruct&gt;\n</code></pre>\n\n<p>but</p>\n\n<pre><code>std::pair&lt;MyObj* const, Datastruct&gt;\n</code></pre>\n\n<p>Presumably you hardcoded the pair type somewhere, but missed out the <code>const</code>.</p>\n\n<p>Or, if you wrote <code>saidMap.insert(std::make_pair(element.PointerToMyObj, str))</code> then that should have worked and something else is wrong in your code.</p>\n\n<hr>\n\n<p>But it's much easier to use <a href=\"https://en.cppreference.com/w/cpp/container/map/emplace\" rel=\"nofollow noreferrer\"><code>emplace</code></a>:</p>\n\n<pre><code>saidMap.emplace(element.PointerToMyObj, str);  \n</code></pre>\n\n<p>This C++11 version of <a href=\"https://en.cppreference.com/w/cpp/container/map/insert\" rel=\"nofollow noreferrer\"><code>insert</code></a> has all the magic machinery needed to make that work \"transparently\".</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 6205987, "user_type": "registered", "profile_image": "https://graph.facebook.com/1032782036816282/picture?type=large", "display_name": "Georgi Mirazchiyski", "link": "https://stackoverflow.com/users/6205987/georgi-mirazchiyski"}, "is_accepted": false, "score": 1, "last_activity_date": 1568199144, "last_edit_date": 1568199144, "creation_date": 1568198812, "answer_id": 57887442, "question_id": 57886750, "link": "https://stackoverflow.com/questions/57886750/why-cant-i-insert-objects-into-a-map-in-c/57887442#57887442", "title": "Why can&#39;t I insert objects into a map in c++", "body": "<p>Your code is <em>almost</em> alright. You're getting this compiler error because <code>map::insert</code> really doesn't have such overload. It's a tiny detail you've missed on reading up when looking at the <code>std::map</code> documentation. It is so that <code>map::insert</code> doesn't work as implicit constructor, which is how you are trying to use it in the pasted code.\nThis is something you can achieve by emplacing - <code>map::emplace</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for(auto element : myList){  \n  Datastruct str;  \n  str.property1 = element.property1;  \n  str.property2 = element.property2;  \n  saidMap.emplace(element.PointerToMyObj, str);\n}\n</code></pre>\n\n<p>Using <code>map::insert()</code>: The insert function is used to insert the <strong><em>key-value</em></strong> <strong>pair</strong> in the map and has 3 <em>general</em> overloads, in fact, they are more, but these are the main ideas behind how to insert in a map.</p>\n\n<ul>\n<li>insert(pair): simply inserts a new pair in the map, where pair.first is the <code>key</code> and pair.second is the <code>value</code>. Only happens when the key is not already in the map.</li>\n<li>insert(it, pair): insert using an iterator and a pair, where <code>it</code> is a pointer to the location where you want to insert your pair at.</li>\n<li>insert(begin, end): used for copying the elements from another map by accepting iterators to <code>begin</code> and <code>end</code> of the map.</li>\n</ul>\n\n<p>In your case, you've missed the to actually pass a <code>pair</code>. You can construct it inside of the insert argument list as follows:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>for(auto element : myList){  \n  Datastruct str;  \n  str.property1 = element.property1;  \n  str.property2 = element.property2;  \n  saidMap.insert( /*implicitly derive a pair as:*/ { element.PointerToMyObj, str } );\n}\n</code></pre>\n\n<p><strong>Note:</strong> This is a <em>post-C++11</em> functionality, so make sure you're setting compiler's C++ version to at least that.</p>\n\n<p>I've reproduced your code with the working version of the <code>map::insert</code> in <strong>Compiler Explorer (godbolt)</strong> for you have a look (in both <code>gcc</code> and <code>clang</code> compilers): <a href=\"https://godbolt.org/z/7Mqut0\" rel=\"nofollow noreferrer\">https://godbolt.org/z/7Mqut0</a>.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 13, "user_id": 8278856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kS9a9.jpg?s=128&g=1", "display_name": "Basile Czajkowski", "link": "https://stackoverflow.com/users/8278856/basile-czajkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "accepted_answer_id": 57887082, "answer_count": 2, "score": 1, "last_activity_date": 1568199144, "creation_date": 1568196243, "last_edit_date": 1568196295, "question_id": 57886750, "link": "https://stackoverflow.com/questions/57886750/why-cant-i-insert-objects-into-a-map-in-c", "title": "Why can&#39;t I insert objects into a map in c++", "body": "<p>So i have a function that  is supposed to return a following map:<br>\n <code>map&lt;MyObj*, Datastruct&gt;</code></p>\n\n<p>While trying to insert object from a list which contains said objects:  </p>\n\n<pre><code>for(auto element: myList){  \n    Datastruct str;  \n    str.property1 = element.property1;  \n    str.property2 = element.property2;  \n    saidMap.insert(element.PointerToMyObj, str);  \n}\n</code></pre>\n\n<p>Objects in <em>myList</em> contain a pointer to myObj and some properties i need to move from list to a map. Having executed this code in a function below:</p>\n\n<p><code>map&lt;MyObj*, Datastruct&gt; listToMap = convertList(myList);</code></p>\n\n<p>I get yelled at by the compiler that:  </p>\n\n<blockquote>\n  <p>\"no matching function to call to 'std::map::insert(MyObj*&amp;, Datastruct&amp;)\"</p>\n</blockquote>\n\n<p>Here i am helpless. I don't know why compiler would show that i am trying to pass a reference to the function if <em>element</em> in myList(see above) contains </p>\n\n<blockquote>\n  <p>MyObj *PointerToMyObj;</p>\n</blockquote>\n\n<p>which, the way i see it, is a correct type to pass to the insert function right?\nI also tried with </p>\n\n<blockquote>\n  <p>std::make_pair</p>\n</blockquote>\n\n<p>whereupon compiler yells at me for trying to insert a pair into a<br>\n<code>map&lt;MyObj*, Datastruct&gt;.</code></p>\n\n<p>I am utterly lost. Could someone explain to me what i am doing wrong?</p>\n"}, {"tags": ["c++", "c++20", "designated-initializer", "ctad"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1568199596, "post_id": 57886648, "comment_id": 102197146, "body": "The deduction guide does muddle the water a bit"}], "answers": [{"comments": [{"owner": {"reputation": 1368, "user_id": 7014926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9DByU.png?s=128&g=1", "display_name": "nnolte", "link": "https://stackoverflow.com/users/7014926/nnolte"}, "edited": false, "score": 0, "creation_date": 1568207935, "post_id": 57889316, "comment_id": 102201741, "body": "but i end up with <code>my_pair&lt;float, float&gt;</code>. according to your answer (and my logical thinking), i shouldn&#39;t.."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1568207965, "post_id": 57889316, "comment_id": 102201767, "body": "So, to address the question in the post. <code>first</code> being deduced as <code>float</code> is a compiler bug."}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 1368, "user_id": 7014926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9DByU.png?s=128&g=1", "display_name": "nnolte", "link": "https://stackoverflow.com/users/7014926/nnolte"}, "edited": false, "score": 0, "creation_date": 1568208516, "post_id": 57889316, "comment_id": 102202072, "body": "@kawillzocken Added an update to explain why you end up with <code>my_pair&lt;float, float&gt;</code>. It&#39;s not a compiler bug, it&#39;s a compiler-hasn&#39;t-yet-implemented-this-feature."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1575612524, "post_id": 57889316, "comment_id": 104632798, "body": "Well, GCC 9.1, Clang 9, and VS 2019 16.1 all implemented CTAD and designated initializer, and none implemented CTAD for aggregates. But only GCC deduces first as float. So at least one compiler is buggy. And GCC has a record of ignoring designators."}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 4, "last_activity_date": 1568208491, "last_edit_date": 1568208491, "creation_date": 1568205271, "answer_id": 57889316, "question_id": 57886648, "link": "https://stackoverflow.com/questions/57886648/ctad-and-designated-initializers-in-c20/57889316#57889316", "title": "CTAD and designated initializers in C++20", "body": "<p>See <a href=\"https://stackoverflow.com/q/57886451/2069064\">this answer</a> as a starting point. We have the same initial three candidates:</p>\n\n<pre><code>template &lt;class T=int, class U=float&gt;\nstruct my_pair {\n    T first;\n    U second;\n};\n\n// default constructor\ntemplate &lt;class T=int, class U=float&gt;\nauto __f() -&gt; my_pair&lt;T, U&gt;;\n\n// copy candidate\ntemplate &lt;class T=int, class U=float&gt;\nauto __f(my_pair&lt;T, U&gt;) -&gt; my_pair&lt;T, U&gt;;\n\n// deduction guide\ntemplate &lt;class... T&gt;\nauto __f(T...) -&gt; my_pair&lt;T...&gt;;\n</code></pre>\n\n<p>And the aggregate deduction candidate is based on the actual <em>initializer-list</em> or <em>designated-initializer-list</em> we provide, not the actual underlying members of the aggregate. Our <em>designated-initializer-list</em> is <code>{.second = 20.f}</code> so our aggregate deduction candidate becomes:</p>\n\n<pre><code>// aggregate deduction candidate\ntemplate &lt;class T=int, class U=float&gt;\nauto __f(U) -&gt; my_pair&lt;T, U&gt;;\n</code></pre>\n\n<p>The template parameters always come from the primary class template, so we bring in the default template arguments from there. The candidate arguments come from the <em>initializer-list</em>, and the type of <code>second</code> is <code>U</code>.</p>\n\n<p>The aggregate deduction candidate is the best candidate (only the aggregate deduction candidate and the deduction guide are viable, the aggregate deduction candidate is more specialized), so we end up with <code>my_pair&lt;int, float&gt;</code>.</p>\n\n<hr />\n\n<p>Having finished CTAD, we now start over and effectively do</p>\n\n<pre><code>my_pair&lt;int, float&gt; x{.second = 20.f};\n</code></pre>\n\n<p>Which works, and leads to <code>x.first</code> being initialized from <code>{}</code>.</p>\n\n<hr />\n\n<p>CTAD for aggregates was only adopted very recently (at the Cologne meeting in July 2019, two months ago). Before that feature, this would still have been well-formed:</p>\n\n<pre><code>my_pair{.second = 20.f};\n</code></pre>\n\n<p>Why? We don't yet have the aggregate deduction candidate, but we still do have the deduction guide... which <em>is</em> viable. It gives us <code>my_pair&lt;float&gt;</code>. Which is to say, <code>my_pair&lt;float, float&gt;</code> once you fill in the default template argument for <code>U</code>.</p>\n\n<p>That's why gcc is giving you the behavior you see - it simply does not yet implement CTAD for aggregates, and is giving you the old behavior. </p>\n"}], "owner": {"reputation": 1368, "user_id": 7014926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9DByU.png?s=128&g=1", "display_name": "nnolte", "link": "https://stackoverflow.com/users/7014926/nnolte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 2, "accepted_answer_id": 57889316, "answer_count": 1, "score": 9, "last_activity_date": 1568208491, "creation_date": 1568195922, "last_edit_date": 1568207963, "question_id": 57886648, "link": "https://stackoverflow.com/questions/57886648/ctad-and-designated-initializers-in-c20", "title": "CTAD and designated initializers in C++20", "body": "<p>I have already stated confusion about CTAD with designated initializers in this <a href=\"https://stackoverflow.com/questions/57886451/c20-designated-initializers-with-templated-types\">question</a>, but i have another confusion with a very similar code snippet</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename int_t=int, typename float_t=float&gt;\nstruct my_pair {\n    int_t   first;\n    float_t second;\n};\n\ntemplate&lt;typename ... ts&gt;\nmy_pair(ts...) -&gt; my_pair&lt;ts...&gt;;\n\nint main() {\n    my_pair x{.second = 20.f};\n    static_assert( std::is_same_v&lt;decltype(x.first), int&gt; ); //FAILS &lt;- its deduced to float\n    static_assert( std::is_same_v&lt;decltype(x.second), float&gt; );\n}\n</code></pre>\n\n<p>It seems like the deduction guide causes the type of <code>first</code> to be deduced to <code>float</code>, even though i do not give an explicit <code>.first</code> in the designated initializer. The deduction guide apparently only cares about the order in the initializer, no matter the keyword (<code>.second</code>). Should the deduction guide be smart about this or should there be a \"designated deduction guide\"?</p>\n\n<p>See the example on <a href=\"https://godbolt.org/z/cm6Yi7\" rel=\"nofollow noreferrer\">https://godbolt.org/z/cm6Yi7</a></p>\n"}, {"tags": ["html", "c++", "string", "esp8266", "arduino-ide"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568199759, "post_id": 57887033, "comment_id": 102197219, "body": "Currently I&#39;m working on converting htmlPage1 into a string, then replacing &lt;h1 class=&quot;display-4&quot;&gt;     score      &lt;/h1&gt; &quot;score&quot; with string.replace, converting it back to a char and printing it. something not as far away from what you suggest, but more crude maybe hahah.. when I&#39;m finished testing that Ill try to use your advise. thank you, I&#39;ll update you (:"}], "tags": [], "owner": {"reputation": 31, "user_id": 11095146, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q4SUG4SiEVY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMhG2gFUNNb9sWgpHI0yeJcQYAOEQ/mo/photo.jpg?sz=128", "display_name": "Jelle Huiberts", "link": "https://stackoverflow.com/users/11095146/jelle-huiberts"}, "is_accepted": false, "score": 2, "last_activity_date": 1568200739, "last_edit_date": 1568200739, "creation_date": 1568197306, "answer_id": 57887033, "question_id": 57886561, "link": "https://stackoverflow.com/questions/57886561/putting-c-string-in-html-code-to-show-value-on-webserver/57887033#57887033", "title": "Putting C++ string in HTML code to show value on webserver", "body": "<p>You could try building your string first, then converting it to a <code>const char</code>\nlike this: <code>const char * c = str.c_str();</code>\nif you can't use a pointer you could try this:</p>\n\n<pre><code>string s = \"yourHTML\" + score + \"moreHTML\"; \nint n = s.length(); \nchar char_array[n + 1]; \nstrcpy(char_array, s.c_str());\n</code></pre>\n\n<p>additionally you could try the <a href=\"http://www.cplusplus.com/reference/sstream/stringstream/\" rel=\"nofollow noreferrer\">stringstream standard library</a></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568199820, "post_id": 57887077, "comment_id": 102197249, "body": "I found the library yesterday, so I havent really gotten to know it, unfortunatly. and thats maybe why I&#39;m having such a hard time with this &quot;simple&quot; taks heheh.. unfortunatly your suggestion says me nothing as I really dont understand it, could you try to explain it in another way? (im talking about your example), anyhow thanks and Ill keep you too updated. (:"}, {"owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "reply_to_user": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568206288, "post_id": 57887077, "comment_id": 102200744, "body": "I&#39;ve edited my response a little; hopefully it&#39;s clearer now... By the way, one thing that might have confused you is the annotation of the example; the lines starting &#39;...&#39; should really be comments (they were like this in the page I copied them from)."}, {"owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "reply_to_user": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568206512, "post_id": 57887077, "comment_id": 102200897, "body": "Okay, I ditched the &#39;...&#39; lines and wrote some prose instead."}, {"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568206931, "post_id": 57887077, "comment_id": 102201149, "body": "Thank you for the thourough explanation. I&#39;ll check it out (:"}, {"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568207655, "post_id": 57887077, "comment_id": 102201575, "body": "yeah I know its very crude heheh.. but what do you mean with permanent? anyways, how should I proceed with the way you suggest? should I use PageBuilder with it?"}, {"owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "reply_to_user": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568208834, "post_id": 57887077, "comment_id": 102202260, "body": "I misread your example, so was implying that if you find and replace the marker text once, it&#39;s not there to find next time!  But I see now you&#39;re not doing it that way.  (I had tried to edit my comment, but was too late, so I just deleted it.)"}, {"owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "reply_to_user": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568279978, "post_id": 57887077, "comment_id": 102227104, "body": "&quot;how should I proceed with the way you suggest?&quot;  The answer is a general one that you&#39;ll find useful time and time again:  Start from something simple that works, and go from there.  In this case, start a new sketch, get the example from the PageBuilder github page and confirm you can run it.  Then change something and see the effect.  Get a feel for what does what.  Experiment!  Then, when you&#39;ve got a feel for it, try out some of the ideas in your original project.  If that doesn&#39;t work, go back to the example and experiment some more!"}, {"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568280220, "post_id": 57887077, "comment_id": 102227234, "body": "Yeah okay, I havent had time to test your suggestion yet, becuase I&#39;m so close to getting it to work the way I&#39;m doing it (the hard way: converting chars to strings and converting it back again).. but eventually I want to test the magic tokens.. After reading trhough it again, I saw something intresting..  can I do like this? PageElement CURRENT_GAME_ELEMENT(htmlPage1, { {&quot;&lt;html&gt;&lt;head&gt;&lt;body&gt;&lt;h1&gt;&quot; + score + &quot;&lt;/h1&gt;&lt;/body&gt;&lt;/head&gt;&lt;/html&gt;&quot;} });  or this?  PageElement CURRENT_GAME_ELEMENT(htmlPage1, { {&quot;&lt;html&gt;&lt;head&gt;&lt;body&gt;&lt;h1&gt;&quot;, score, &quot;&lt;/h1&gt;&lt;/body&gt;&lt;/head&gt;&lt;/html&gt;&quot;} });  or something similar?"}, {"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568280476, "post_id": 57887077, "comment_id": 102227388, "body": "I tried to do something similar becuase I thought it would work, but it didnt becuase the PageElement argument did only expect one string, not two.. then I did like this: PageElement FRAMEWORK_PAGE_ELEMENT(htmlPage0, score);"}, {"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568280874, "post_id": 57887077, "comment_id": 102227614, "body": "this is the error I get when I tried the following: PageElement CURRENT_GAME_ELEMENT(htmlPage1, {&quot;SCORE&quot;, score} );                      &quot;no matching function for call to &#39;PageElement::PageElement(char [28], &lt;brace-enclosed initializer list&gt;)&#39;&quot;    Do you want to move this to a chat by the way?"}, {"owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "reply_to_user": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568284213, "post_id": 57887077, "comment_id": 102229500, "body": "You need another layer of curly braces.  Please review the example.  I&#39;d rather not move to chat.  I think this question has run its course."}, {"owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "edited": false, "score": 0, "creation_date": 1568284853, "post_id": 57887077, "comment_id": 102229805, "body": "I figured it out, Thank you alot for the help. Ill add the solution in the original Question."}], "tags": [], "owner": {"reputation": 827, "user_id": 11603085, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8mXp.jpg?s=128&g=1", "display_name": "Edd Inglis", "link": "https://stackoverflow.com/users/11603085/edd-inglis"}, "is_accepted": true, "score": 0, "last_activity_date": 1568206491, "last_edit_date": 1568206491, "creation_date": 1568197509, "answer_id": 57887077, "question_id": 57886561, "link": "https://stackoverflow.com/questions/57886561/putting-c-string-in-html-code-to-show-value-on-webserver/57887077#57887077", "title": "Putting C++ string in HTML code to show value on webserver", "body": "<p>This sort of thing is often done using magic tags in your markup that are detected by the server code before it serves the HTML and filled in by executing some sort of callback or filling in a variable, or whatever. </p>\n\n<p>So with this in mind and hoping for the best, I nipped over to: <a href=\"https://github.com/Hieromon/PageBuilder\" rel=\"nofollow noreferrer\">PageBuilder on github</a> and looked to see if there was something similar here.  Good news!  In one of the examples:</p>\n\n<pre><code>const char html[] = \"hello &lt;b&gt;{{NAME}}&lt;/b&gt;, &lt;br&gt;Good {{DAYTIME}}.\";\n ...\nPageElement body_elem(html, { {\"NAME\", AsName}, {\"DAYTIME\", AsDayTime} });\n</code></pre>\n\n<p>Where <code>{{NAME}}</code> and <code>{{DAYTIME}}</code> are magic tokens.  <code>AsName</code> and <code>AsDayTime</code> are functions to be called when the respective tag is encountered while the page is being served.</p>\n\n<p>EDIT: in response to a request to explain differently, I'm not convinced I can do a better job of explaining the code than the example on the library's own github page, so I'll try a wordy description instead:</p>\n\n<p>When you want to serve a webpage to a client, the code needs to know what you want to serve.  In the simplest case, it's a static page: the same every time.  You can just write the HTML, stick it in a string an be done.</p>\n\n<pre><code>whole_page = \"&lt;html&gt;My fixed content&lt;/html&gt;\";\nwebserver.serve(whole_page);\n</code></pre>\n\n<p>But you want some dynamic element(s).  As noted, you can do it in a few ways, such as serving some static HTML, then the dynamic bit, then some more static HTML.  It seems you've not had much luck like this, and it's rather clunky anyway.  </p>\n\n<p>Or you can pre-build a new string out of the three bits and serve that in one chunk, but that's also pretty clunky.</p>\n\n<p>(Aside: taking big strings and adding them together is likely to be slow and memory intensive, two things you really don't want on a little CPU like the ESP8266).</p>\n\n<p>So instead, you allow 'magic' markers in the HTML, using a marker in place of the dynamic content, and serve that instead.</p>\n\n<pre><code>whole_page = \"&lt;html&gt;My dynamic content.  Value is {{my_value}}&lt;/html&gt;\";\nwebserver.serve(whole_page, ...);\n</code></pre>\n\n<p>The clever bit is that as the page is being served, the webserver is watching the text go by, and when it sees a magic tag, it stops and asks you to fill in the blank, then carries on as before.</p>\n\n<p>Obviously, there is some processing overhead with watching for tags, and some programming overhead with telling it what tags to watch for and how to ask you for the data it needs.  </p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1568205417, "creation_date": 1568205417, "answer_id": 57889364, "question_id": 57886561, "link": "https://stackoverflow.com/questions/57886561/putting-c-string-in-html-code-to-show-value-on-webserver/57889364#57889364", "title": "Putting C++ string in HTML code to show value on webserver", "body": "<p>I got advice from a friend who told me I should make a unique argument where I wanted the string(x) and then using some syntax to replace it. I also took inspiration from you Jelle..</p>\n\n<p>what I did was make a unique argument \"VAR_CURRENT_SCORE\" put that into the HTML where I want the score output, then convert htmlPage1 from a char to a string, use string.replace() and replace \"VAR_CURRENT_SCORE\" with the string(x) score. this workes as I can see in the serial monitor output.\nThis is what I did:</p>\n\n<pre><code>//root page\nString HTMLstring(htmlstringPage);\ndelay(100);\nHTMLstring.replace(\"VAR_CURRENT_SCORE\", score);\ndelay(50);\nSerial.println(\"string:\");\nSerial.println(HTMLstring);\n\n//tab 1 char htmlstringPage[] PROGMEM = R\"=====(\n        &lt;div class=\"jumbotron\"&gt;\n        &lt;div align=\"center\"&gt;\n        &lt;h1 class=\"display-4\"&gt;VAR_CURRENT_SCORE&lt;/h1&gt;\n        &lt;/div&gt;\n        &lt;/div&gt;\n        )=====\"; \n</code></pre>\n\n<p>However, I still have a small problem left which is converting the string back to char to post it to the website.</p>\n"}], "owner": {"reputation": 5, "user_id": 12052072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af9ba7d013373a84ad08835ffe3c277?s=128&d=identicon&r=PG&f=1", "display_name": "CPlusPlusandHTMLguy", "link": "https://stackoverflow.com/users/12052072/cplusplusandhtmlguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 0, "accepted_answer_id": 57887077, "answer_count": 3, "score": 0, "last_activity_date": 1568286339, "creation_date": 1568195635, "last_edit_date": 1568286339, "question_id": 57886561, "link": "https://stackoverflow.com/questions/57886561/putting-c-string-in-html-code-to-show-value-on-webserver", "title": "Putting C++ string in HTML code to show value on webserver", "body": "<p>I've set up a webserver running on ESP8266 thats currently hosting 7 sites. The sites is written in plain HTML in each diffrent tab in the arduino ide. I have installed the library Pagebuilder to help with making everything look nice and run. </p>\n\n<p>Except one thing. I have a button connected to my ESP8266 which by the time being imitates a sensor input. basicly when the button is pressed my integer \"x\" increments with 1. I also managed to make a string that replicates \"x\" and increments with the same value. </p>\n\n<p>I also have a problem with Printing the IPadresse of the server, but thats not as important as the other.</p>\n\n<p>My plan then was writing the string \"score\" (which contains x) into the HTML tab where it should be output. this obviously didnt work.</p>\n\n<p>Things I've tried:</p>\n\n<p>Splitting up the HTML code where I want the string to be printed and using client.println(\"\"); \nThis didnt work because the two libraries does not cooperate and WiFiClient does not find Pagebuilders server. (basicly, the client.println does nothing when I used it with Pagebuilder).</p>\n\n<p>Reconstructing the HTML page as a literal really long string, and adding in the String with x like this: \"html\"+score+\"html\" and adding it into where the HTML page const char were. (basicly replacing the variable with the text that were in the variable).\nThis did neighter work because the argument \"PageElement\" from Pagebuilder does only expect one string, and errors out because theres an additional string inside the HTML string.</p>\n\n<p>I've tried sending it as a post req. but this did not output the value either. </p>\n\n<p>I have run out of Ideas to try.</p>\n\n<pre><code>\n//root page\n\n#if defined(ARDUINO_ARCH_ESP8266)\n#include &lt;ESP8266WiFi.h&gt;\n#include &lt;ESP8266WebServer.h&gt;\n#include &lt;WiFiClient.h&gt;\n#elif defined(ARDUINO_ARCH_ESP32)\n#include &lt;WiFi.h&gt;\n#include &lt;WebServer.h&gt;\n#endif\n#include \"PageBuilder.h\"\n\n\n#include \"currentGame.h\" //tab 1\n\n#if defined(ARDUINO_ARCH_ESP8266)\nESP8266WebServer Server;\nESP8266WebServer  server;\n#endif\n\nint sensorPin = 2;    // button input\nint sensorValue = 0;  \nint x = 0;            // the int  x \nString score=\"\";      //the string x will be in\n\n\n\n\nPageElement CURRENT_GAME_ELEMENT(htmlPage1);\nPageBuilder CURRENT_GAME(\"/current-game\", {CURRENT_GAME_ELEMENT}); // this //only showes on href /current-game\n\nvoid button() {\n  sensorValue = analogRead(sensorPin); //read the voltage\n  score=\"Team 1: \"+String((int)x+1);   //\"make\" x a string\n  if (sensorValue &lt;= 10) {             // check if button is pressed\n    x++;                               // increment x\n    Serial.println(x);\n    Serial.println(score);\n    delay(100);\n  }\n}\n\nvoid setup() {\n  Serial.begin(115200);\n  pinMode(2, INPUT);\n  WiFi.softAP(\"SSID\", \"PASS\");\n  delay(100);         \n  CURRENT_GAME.insert(Server);     \n\n  Server.begin();\n}\n\nvoid loop() {\nServer.handleClient();\nbutton();\n}\n</code></pre>\n\n<pre><code>\n// tab 1 \n\nconst char htmlPage1[] PROGMEM = R\"=====(\n\n/*\nalot of HTML, basicly the whole website...\n\n..............................................\n\n*/\n\n&lt;div class=\"jumbotron\"&gt;\n            &lt;div align=\"center\"&gt;\n            &lt;h1 class=\"display-4\"&gt;     score      &lt;/h1&gt; //  &lt;--- this is where \n                                                        //I want to print the \n                                                        //string:\n            &lt;/div&gt;\n            &lt;/div&gt;\n\n            )=====\"; \n\n</code></pre>\n\n<p>what I want to do is getting the value of the string score displayed on the website. If I put \"score\" directly into the HTML, the word score will be displayed, not the value. I want the value displayed.</p>\n\n<p>Edit:</p>\n\n<p>I have figured out how to make the string(score) be printed in the HTML code, thus, I only have to convert the HTML code string back to a char. explanation is in comment below.</p>\n\n<p>Edit 2: (-------------------------solution-------------------------)</p>\n\n<p>Many thanks for the help I've gotten and sorry for being so ignorant, its just so hard being so close and that thing doesnt work. but anyways, What I did was following Pagebuilders example, and making another element to print in current game..</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>\nString test(PageArgument&amp; args) { \n  return score;\n}\n\nconst char html[] = \"&lt;div class=\\\"jumbotron\\\"&gt;&lt;div align=\\\"center\\\"&gt;&lt;h1 class=\\\"display-4\\\"&gt;{{NAME}}&lt;/h1&gt;&lt;/div&gt;&lt;/div&gt;\";\n\nPageElement FRAMEWORK_PAGE_ELEMENT(htmlPage0);\nPageBuilder FRAMEWORK_PAGE(\"/\", {FRAMEWORK_PAGE_ELEMENT});\n\nPageElement body_elem(html, { {\"NAME\", test} });\nPageElement CURRENT_GAME_ELEMENT(htmlPage1);\nPageBuilder CURRENT_GAME(\"/current-game\", { CURRENT_GAME_ELEMENT, body_elem});\n</code></pre>\n\n<p>suprisingly easy when I first understood it.. Thanks again.</p>\n"}, {"tags": ["c++", "iostream"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1568197324, "post_id": 57886518, "comment_id": 102195981, "body": "Might be able to build something out of <a href=\"https://stackoverflow.com/q/8243743/560648\">stackoverflow.com/q/8243743/560648</a>"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1568197594, "post_id": 57886518, "comment_id": 102196103, "body": "I think your ending thought is correct."}, {"owner": {"reputation": 33005, "user_id": 151641, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8dbfbbc4e48afe0caa43412a8c03ef07?s=128&d=identicon&r=PG", "display_name": "mloskot", "link": "https://stackoverflow.com/users/151641/mloskot"}, "edited": false, "score": 0, "creation_date": 1568197680, "post_id": 57886518, "comment_id": 102196148, "body": "Regarding your enging though, you may look at the Boost.Interprocess&#39; <code>bufferstream</code> which is fixed-size <code>stringstream</code> equivalent."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1568203506, "post_id": 57886518, "comment_id": 102199146, "body": "@LightnessRacesinOrbit Thank you for the comment, I clarified now that I am looking for a solution without external dependencies."}, {"owner": {"reputation": 16020, "user_id": 9716597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f97c613dca0b157b40551a0d756abeb?s=128&d=identicon&r=PG&f=1", "display_name": "L. F.", "link": "https://stackoverflow.com/users/9716597/l-f"}, "edited": false, "score": 0, "creation_date": 1568204258, "post_id": 57886518, "comment_id": 102199539, "body": "Do you want to stream just one value?"}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1568403571, "post_id": 57886518, "comment_id": 102276461, "body": "One value would be enough, yes."}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1568394754, "post_id": 57889589, "comment_id": 102273193, "body": "Thank you, this looks very good! Do I also have to override sputn(...) and sputc(...)?"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "reply_to_user": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1568398615, "post_id": 57889589, "comment_id": 102274611, "body": "I don&#39;t think you should have to do anything with <code>sputn</code> -- it&#39;s non-virtual and the default implementation should call the most derived <code>xsputn</code> implementation.  Likewise <code>sputc</code> is not virtual so you have to rely on the base implementation.  That should all be fine though as far as I recall."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571057661, "post_id": 57889589, "comment_id": 103103196, "body": "Related issue (but not a duplicate) <a href=\"https://stackoverflow.com/questions/41377045/is-there-a-simple-way-to-get-the-number-of-characters-printed-in-c\" title=\"is there a simple way to get the number of characters printed in c\">stackoverflow.com/questions/41377045/&hellip;</a>"}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571061188, "post_id": 57889589, "comment_id": 103105103, "body": "This code fails on Windows with msvc. It looks like xsputn is never called."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "reply_to_user": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571072109, "post_id": 57889589, "comment_id": 103110412, "body": "Does adding an <code>&lt;&lt; std::flush</code> to the end of the output sequence help?  I was fairly sure <code>xsputn</code> would be called at some point.  If flushing doesn&#39;t help I can have another look at some other code I have."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571122140, "post_id": 57889589, "comment_id": 103124253, "body": "I tried <code>&lt;&lt; std::flush</code>, but it does not work, if you have some other idea, I would really appreciate it. I am very surprised that this does not work. According to the docs of streambuf it should work."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "reply_to_user": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571146274, "post_id": 57889589, "comment_id": 103137350, "body": "@olq_plo Updated the post to provide an alternative implementation."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571154023, "post_id": 57889589, "comment_id": 103142036, "body": "Thank you for the edit, this looks good. I have a suspicion that the base implementation of basic_streambuf on Windows may set the error state and xsputn is never called."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571154342, "post_id": 57889589, "comment_id": 103142208, "body": "Looking closer at your new code, it should make no difference. Only the virtual methods are called by the ostream, and in your implementations you just call the methods of the base, which should happen anyway when you don&#39;t overload the methods. Still, for debugging the issue, as you say, it will be useful to implement all the virtual methods."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571263320, "post_id": 57889589, "comment_id": 103186702, "body": "Peter Dimov from Boost figured it out, see <a href=\"https://cpplang.slack.com/archives/C27KZLB0X/p1571154902263300\" rel=\"nofollow noreferrer\">cpplang.slack.com/archives/C27KZLB0X/p1571154902263300</a>. It is necessary to overload <code>overflow</code> as well. Do you want to update your answer or should I propose an edit?"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "reply_to_user": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571283131, "post_id": 57889589, "comment_id": 103190901, "body": "I&#39;m a bit confused.  The new implementation I proposed in the edit <i>does</i> override <code>overflow</code> (I can&#39;t check the link you provided as I don&#39;t have an account on that site)."}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571290531, "post_id": 57889589, "comment_id": 103192680, "body": "Yes, but you call the base version, which triggers an error state on the stream when called. Please read the discussion with Peter on cpplang why overflow has to be changed. Finally, it is not necessary to overload all the other methods."}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "reply_to_user": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571298752, "post_id": 57889589, "comment_id": 103196239, "body": "Sorry, but there seems to be some confusion.  My edit added <i>two</i> new implementations.  The first of those overrides <code>overflow</code> (but <i>doesn&#39;t</i> call the base version) and is intended as a fix for the problem under discussion.  The second implementation in the edit (the one to which I think you are referring) was intended purely for diagnostic purposes in the event that no other fix could be found.  Having said that, it sounds as if you have a working solution anyway -- so I&#39;ll leave it at that :-)"}, {"owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "edited": false, "score": 0, "creation_date": 1571299036, "post_id": 57889589, "comment_id": 103196386, "body": "I am going to propose an edit then, because the working solution is very concise."}], "tags": [], "owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1571307532, "last_edit_date": 1571307532, "creation_date": 1568206206, "answer_id": 57889589, "question_id": 57886518, "link": "https://stackoverflow.com/questions/57886518/iostream-equivalent-to-snprintfnull-0-format-string-args/57889589#57889589", "title": "iostream equivalent to snprintf(NULL, 0, format_string, args...)", "body": "<p>Rather than a custom <code>std::ostream</code> it might be easier -- and perhaps more flexible -- to implement a custom <code>std::streambuf</code> that can then be used with any <code>std::ostream</code>.</p>\n\n<pre><code>#include &lt;streambuf&gt;\n\ntemplate &lt;class CharT, class Traits = std::char_traits&lt;CharT&gt;&gt;\nstruct counting_streambuf: std::basic_streambuf&lt;CharT, Traits&gt; {\n  using base_t = std::basic_streambuf&lt;CharT, Traits&gt;;\n  using typename base_t::char_type;\n  using typename base_t::int_type;\n\n  std::streamsize count = 0;\n\n  std::streamsize xsputn(const char_type* /* unused */, std::streamsize n)\n    override\n    {\n      count += n;\n      return n;\n    }\n\n  int_type overflow(int_type ch)\n    override\n    {\n      ++count;\n      return ch;\n    }\n\n};\n</code></pre>\n\n<p>Then use as...</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint\nmain (int argc, char **argv)\n{\n  using char_type = decltype(std::cout)::char_type;\n\n  counting_streambuf&lt;char_type&gt; csb;\n\n  /*\n   * Associate the counting_streambuf with std::cout whilst\n   * retaining a pointer to the original std::streambuf.\n   */\n  auto *oldbuf = std::cout.rdbuf(&amp;csb);\n  std::cout &lt;&lt; \"Some text goes here...\\n\";\n\n  /*\n   * Restore the original std::streambuf.\n   */\n  std::cout.rdbuf(oldbuf);\n  std::cout &lt;&lt; \"output length is \" &lt;&lt; csb.count &lt;&lt; \" characters\\n\";\n}\n</code></pre>\n\n<p>Running the above results in...</p>\n\n<pre><code>output length is 23 characters\n</code></pre>\n\n<p>Edit: The original solution didn't overload <code>overflow</code>. This works on Linux but not on Windows. Thanks go to Peter Dimov from Boost, who found the solution.</p>\n"}], "owner": {"reputation": 615, "user_id": 6173694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FWVTscLbv7w/AAAAAAAAAAI/AAAAAAAAADY/skh9BkqfV0I/photo.jpg?sz=128", "display_name": "olq_plo", "link": "https://stackoverflow.com/users/6173694/olq-plo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 57889589, "answer_count": 1, "score": 2, "last_activity_date": 1571307532, "creation_date": 1568195474, "last_edit_date": 1568203460, "question_id": 57886518, "link": "https://stackoverflow.com/questions/57886518/iostream-equivalent-to-snprintfnull-0-format-string-args", "title": "iostream equivalent to snprintf(NULL, 0, format_string, args...)", "body": "<p>I want to find the number of characters that a stream formatting operation would produce without allocating memory from the heap. In C, it can be done with</p>\n\n<pre><code>int nchars = snprintf(NULL, 0, format_string, args...);\n</code></pre>\n\n<p>How can it be done within the ostream framework in C++?</p>\n\n<p>An implementation with <code>std::ostringstream</code> may allocate memory from the heap:</p>\n\n<pre><code>template &lt;class T&gt;\nint find_nchar(const T&amp; value) {\n  std::ostringstream os; // may allocate memory from the heap\n  os &lt;&lt; value;\n  return os.str().size(); // may allocate memory from the heap\n}\n</code></pre>\n\n<p>I think I need to make a custom ostream class to achieve this. The custom ostream should respect all the formatting flags one can set for the normal std::ostream.</p>\n\n<p>I am searching for a solution that only uses the C++ standard library, not boost::iostreams, for example.</p>\n"}]