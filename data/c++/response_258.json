[{"tags": ["c++", "visual-studio-2010", "visual-c++", "mfc", "visual-studio-2019"], "comments": [{"owner": {"reputation": 1233, "user_id": 11872808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d7b759b09573f7750c178d99015eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jeaninez - MSFT", "link": "https://stackoverflow.com/users/11872808/jeaninez-msft"}, "edited": false, "score": 0, "creation_date": 1576722885, "post_id": 59401569, "comment_id": 104993983, "body": "According to <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/j-default-char-type-is-unsigned?redirectedfrom=MSDN&amp;view=vs-2019\" rel=\"nofollow noreferrer\">this document</a>, if you use /J compiler option with ATL/MFC, an error might be generated. Although you could disable this error by defining _ATL_ALLOW_CHAR_UNSIGNED, this workaround is not supported and may not always work. So I suggest you could set this in Property Pages-&gt;C/C++-&gt;Command Line-&gt;Additional Options pane. Remove it and rebuild all. As far as I&#39;m concerned you couldn&#39;t need to change other variable types."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1576754061, "post_id": 59401569, "comment_id": 105004533, "body": "<i>&quot;the <code>char</code> type is zero-extended when it is widened to an <code>int</code> type.&quot;</i> - This is the behavior you are about to change, and you need to account for <b>all</b> cases, where this makes a difference. Just renaming types won&#39;t do; you&#39;d also have to change the type of <i>expressions</i>, including those that are not explicitly typed (e.g. <code>&#39;\\xFF&#39;</code>). I&#39;m not familiar with clang tools, but I&#39;d start by writing an analyzer that dumps all places in code, where a widening conversion from <code>char</code> is performed (this includes implicit type promotions in comparisons, for example)."}], "owner": {"reputation": 1345, "user_id": 1157147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dc55cf134872f2e92d248e83eaeda72f?s=128&d=identicon&r=PG", "display_name": "ByteNudger", "link": "https://stackoverflow.com/users/1157147/bytenudger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576793186, "creation_date": 1576713185, "last_edit_date": 1576793186, "question_id": 59401569, "link": "https://stackoverflow.com/questions/59401569/what-variable-types-to-change-after-removing-compiler-option-j", "title": "What variable types to change after removing compiler option /J", "body": "<p>I'm migrating a MFC C++ project from VS2010 to VS2019. The project compiles with <code>/J</code> (<a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/j-default-char-type-is-unsigned\" rel=\"nofollow noreferrer\">Default char Type Is unsigned</a>) and would love to get rid of the compiler option.</p>\n\n<p>I know that I have to change <code>char</code> to <code>unsigned char</code> and I already wrote <a href=\"https://clang.llvm.org/extra/clang-tidy/index.html\" rel=\"nofollow noreferrer\">clang-tidy</a> checker to do it.</p>\n\n<p>Are there any other variable types I should change? And if yes, to which type?</p>\n\n<p>Are there other things I maybe forgetting?</p>\n\n<p>Or is the best solution to defining <code>_ATL_ALLOW_UNSIGNED_CHAR</code> as mentioned in <a href=\"https://stackoverflow.com/q/27246149/1157147\">When will _ATL_ALLOW_UNSIGNED_CHAR work</a>? Just keep the compiler option.</p>\n"}, {"tags": ["c++", "windows", "file", "visual-studio-2019"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1576713400, "post_id": 59401556, "comment_id": 104992210, "body": "If you try to delete it before the call to <code>fopen</code>, does it work?"}, {"owner": {"reputation": 186, "user_id": 4526052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b3bff0d5ad93acb86336e2f785c71e?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Saad", "link": "https://stackoverflow.com/users/4526052/omar-saad"}, "edited": false, "score": 1, "creation_date": 1576713581, "post_id": 59401556, "comment_id": 104992258, "body": "Are you sure the debugger you use stops the program after executing the line you have set a breakpoint on? write a <code>printf</code> after and make a breakpoint on that instead."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1576714078, "post_id": 59401556, "comment_id": 104992372, "body": "Are you sure you are actually opening the file? You never check the file pointer"}], "answers": [{"tags": [], "owner": {"reputation": 8188, "user_id": 1390192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2011214205e164fbfd409cf42a0d23c9?s=128&d=identicon&r=PG", "display_name": "tmighty", "link": "https://stackoverflow.com/users/1390192/tmighty"}, "is_accepted": false, "score": 0, "last_activity_date": 1576714108, "creation_date": 1576714108, "answer_id": 59401669, "question_id": 59401556, "link": "https://stackoverflow.com/questions/59401556/fclose-does-not-close-audio-file/59401669#59401669", "title": "fclose does not close audio file", "body": "<p>I found the culprit: </p>\n\n<p>I run this in a parallel_for.</p>\n\n<p>That explains everything. :-)</p>\n"}], "owner": {"reputation": 8188, "user_id": 1390192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2011214205e164fbfd409cf42a0d23c9?s=128&d=identicon&r=PG", "display_name": "tmighty", "link": "https://stackoverflow.com/users/1390192/tmighty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576714108, "creation_date": 1576713094, "question_id": 59401556, "link": "https://stackoverflow.com/questions/59401556/fclose-does-not-close-audio-file", "title": "fclose does not close audio file", "body": "<p>I have the following C++ code to write shorts to a headerless audio file:</p>\n\n<pre><code>vector&lt;short&gt;nShrtDecoded;\nnShrtDecoded.resize(iCountDecodedShorts);//-1\n\n//Then I fill the vector of short with some audio. I didn't write that length code here. I think it doesn't matter anyway HOW exactley I fill this vector of shorts\n\nFILE* outfile = fopen(\"d:\\\\!wavs\\\\weg.raw\", \"wb\");\nfwrite(&amp;nShrtDecoded[0], sizeof(short), nShrtDecoded.size(), outfile);\nfclose(outfile);\n</code></pre>\n\n<p>I run this code in Debug mode, and I have set a breakpoint in the line following the \"fclose(outfile)\" line. </p>\n\n<p>As soon as this breakpoint is hit, I try to delete this file using the Windows Explorer. This should work as the file has already been closed using \"fclose\".</p>\n\n<p>When I try to delete the file \"d:\\!wavs\\weg.raw\", Windows tells me \"File in use: The action could not be completed as the file is in use by a different program\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/eboCT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eboCT.png\" alt=\"enter image description here\"></a></p>\n\n<p>As I didn't think that this is true, I fired up LockHunter. LockHunter told me the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WIaea.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WIaea.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anybody know what this strange behaviour could be caused by?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576712973, "post_id": 59401546, "comment_id": 104992115, "body": "EDIT: Forgot to add &lt;iostream&gt; to this code, but it&#39;s there."}, {"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 0, "creation_date": 1576713200, "post_id": 59401546, "comment_id": 104992161, "body": "You can <i>actually</i> edit Stack Exchange posts and that is <i>vastly</i> prefered to simply leaving a comment about an oversight. That said, in the case of a code snippet like this you ought to be pasting it in from your development environment so that you <i>know</i> it compiles/fails-to-compile as is and can show the output/error-messages."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1576713616, "last_edit_date": 1576713616, "creation_date": 1576713269, "answer_id": 59401575, "question_id": 59401546, "link": "https://stackoverflow.com/questions/59401546/c-while-loop-not-functioning-as-intended/59401575#59401575", "title": "C++ while loop not functioning as intended", "body": "<p>You have no test of <code>ch</code> after <code>cin &gt;&gt; ch</code>. So even if the input is an \"f\", the code will continue to enter the <code>while</code> loop. You need to check if the input succeeded and test if the input is an \"f\" and then, only then, go on to continue with the code.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576713885, "post_id": 59401617, "comment_id": 104992317, "body": "Like this?  cin &gt;&gt; ch;             if(ch==&quot;f&quot;)         {             break;         }"}, {"owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "reply_to_user": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576713932, "post_id": 59401617, "comment_id": 104992336, "body": "Yes, it could be a solution"}, {"owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "reply_to_user": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576714226, "post_id": 59401617, "comment_id": 104992406, "body": "What you insert as input?"}, {"owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "reply_to_user": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576714365, "post_id": 59401617, "comment_id": 104992439, "body": "No, i mean the input that you pass to the program"}, {"owner": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576714694, "post_id": 59401617, "comment_id": 104992502, "body": "Forgive my ignorance, but what do you mean?"}, {"owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "reply_to_user": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "edited": false, "score": 0, "creation_date": 1576714736, "post_id": 59401617, "comment_id": 104992510, "body": "The input that you pass to the program when run"}], "tags": [], "owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "is_accepted": false, "score": 0, "last_activity_date": 1576713623, "creation_date": 1576713623, "answer_id": 59401617, "question_id": 59401546, "link": "https://stackoverflow.com/questions/59401546/c-while-loop-not-functioning-as-intended/59401617#59401617", "title": "C++ while loop not functioning as intended", "body": "<p><em>You test ch variable as a condition of the while loop, but you read it in the cycle</em> and you do the operation on it without another if.</p>\n\n<p>To solve this you can add an <strong>if</strong> in the while loop after the cin operation and if enter in the if block you can call <strong>break or continue</strong></p>\n"}], "owner": {"reputation": 1, "user_id": 12561552, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TUCxzBAU5DE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWDIPM3_o5Dmzv24Oi9_opgitu3w/photo.jpg?sz=128", "display_name": "Locusflow", "link": "https://stackoverflow.com/users/12561552/locusflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1576713623, "creation_date": 1576712930, "question_id": 59401546, "link": "https://stackoverflow.com/questions/59401546/c-while-loop-not-functioning-as-intended", "title": "C++ while loop not functioning as intended", "body": "<p>I'm very new to coding, and have been frustrated in the last few days because of my assignment, where I'm supposed to create a supermarket-like program, the issue I'm having is that I've created a while loop that is supposed to stop when 'f' is entered, prompting it to move on to the next set of code, issue is, that it's not doing that. Can someone please help?? Thanks.</p>\n\n<pre><code>#include &lt;stdlib.h&gt; //used to terminate the program\n#include &lt;string&gt; //used for the string variable\n#include &lt;iomanip&gt; //used for setprecision function\nusing namespace std;\n\n string array;\n string Data[3][10]= {{\"Milk\", \"Bread\", \"Chocolatte\",\"Towel\",\"Toothpaste\",\"Soap\",\"Pen\",\"Biscuits\",\"Lampost\",\"Battery\"},\n {\"0120001\", \"0120002\", \"0120003\", \"0120004\", \"0120005\", \"0120006\", \"0120007\", \"0120008\", \"0120009\", \"0120010\"},\n {\"10.50\", \"5.50\", \"8.00\", \"12.10\", \"6.75\", \"5.20\", \"2.00\", \"4.45\", \"20.50\", \"10.00\"}}; //2D array to store and fetch the table information\n\n float sumMoney;\nint main ()\n{\n        string currentPrice;\n        char customer = 'y';\n        while (customer == 'y')\n        { //creates a while loop which resets the program if 'y' is inputted, and terminates otherwise\n\n        cout &lt;&lt; \"*****************************************************\" &lt;&lt; endl; //simple welcome greeting\n        cout &lt;&lt; \"*  WELCOME TO HERTS SUPERMARKET CHECKOUT SYSTEM     *\" &lt;&lt; endl;\n        cout &lt;&lt; \"* Scan the barcode or manually type the barcode ID  *\" &lt;&lt; endl;\n        cout &lt;&lt; \"*****************************************************\" &lt;&lt; endl;\n\n\n        bool found = false;\n        string ch = \"n\"; //char used to create the loop\n        cout &lt;&lt; \"Type a Barcode, or type 'f' to finish: \" &lt;&lt; endl;\n        cout &lt;&lt; \"\\n\";\n\n        // loops untill input is \"f\"\n        while(ch!=\"f\")\n                {\n        // takes input assigns it to ch variable which is being test for termination\n        cin &gt;&gt; ch;\n        // defines counter variable for loop\n        int i = 0;\n        //used to test if the barcode was found (changed to true when its found else its false)\n        //used as a break case for the loop\n        found = false;\n\n        //while the item isn't found and the counter isn't at the end of the array\n        /*\n        This loops through the array and compares it to the search term\n        has 2 break cases\n        1: found the search term in the array (found = true)\n        2: reach the end of the array (i reaches 9)\n        If found then price is assigned and outputted\n        If not found error is outputted\n        */\n        while((found==false) &amp;&amp; (i&lt;9))  {\n            // if the given barcode is equal to the current\n            if(ch==Data[1][i])\n                                        {\n                // the price corresponding to the current i value is assigned\n                currentPrice = Data[2][i];\n                // break case for found is triggered (case 1)\n                found = true;\n                // outputs price not needed but was a debug line\n                cout &lt;&lt; currentPrice &lt;&lt; endl;\n                                        }\n            // if the counter reaches the end of the array without finding something\n               else if(i&gt;=9){\n                cout &lt;&lt; \"Not found. Please input a Barcode: \" &lt;&lt; endl;\n                            }\n            // increment i\n            i++;\n                                        }\n                }\n                        float thechange();\n                        {\n                        float cashgiven,changegiven,sumprice;\n\n                        sumprice = sumMoney;\n                        cout &lt;&lt; setprecision(2) &lt;&lt; fixed &lt;&lt; showpoint;\n                        cout &lt;&lt; \"\\n\";\n\n                        cout &lt;&lt;\"The total price is: \" &lt;&lt; char(156) &lt;&lt; sumprice &lt;&lt; endl;\n\n                        while (sumprice &gt; 0)\n                                {\n                                    cout &lt;&lt; endl;\n                                    cout &lt;&lt; \"Cash received: \" &lt;&lt; char(156);\n                                    cin &gt;&gt; cashgiven;\n                                    sumprice = sumprice - cashgiven;\n\n                                    if (sumprice &gt; 0)\n                                            {\n                                                cout &lt;&lt; \"Insufficient Funds, cash needed: \" &lt;&lt; char(156) &lt;&lt; sumprice;\n                                            }\n\n                                }\n                                    if (sumprice &lt;= 0)\n                                    {\n                                        changegiven = sumprice * -1;\n                                        cout  &lt;&lt; \"The Change Given: \" &lt;&lt; char(156) &lt;&lt; changegiven;\n                                    }\n\n                        }\n\n\n\n\n                                    cout &lt;&lt; \"Next Customer (Y/N): \\n\";\n                                    cin &gt;&gt; customer;\n}\n\n                        return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio-2019", "c++20", "c++-coroutine"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1576725811, "post_id": 59401418, "comment_id": 104994523, "body": "It&#39;s not clear what <code>suspend_always</code> and <code>resumable</code> are meant to achieve."}, {"owner": {"reputation": 3192, "user_id": 582235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e223d8b9696861a2ed29be81b74680a3?s=128&d=identicon&r=PG", "display_name": "kynnysmatto", "link": "https://stackoverflow.com/users/582235/kynnysmatto"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1576759031, "post_id": 59401418, "comment_id": 105006867, "body": "@NicolBolas <code>suspend_always</code> is <code>std::experimental::suspend_always</code>. And <code>resumable</code> is from here: <a href=\"https://blog.panicsoftware.com/your-first-coroutine/\" rel=\"nofollow noreferrer\">blog.panicsoftware.com/your-first-coroutine</a>"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1576766262, "post_id": 59401418, "comment_id": 105010805, "body": "That doesn&#39;t explain what you&#39;re trying to <i>achieve</i> by using them. Why do these functions <code>co_await suspend_always()</code> at the end? Why do they return <code>resumable</code> and use the accompanying promise type? Why do you discard the <code>resumable</code> that the <code>part1</code> and <code>part2</code> functions return? You say that you want these functions to behave like one coroutine, but I don&#39;t see anything here that behaves like a coroutine."}, {"owner": {"reputation": 3192, "user_id": 582235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e223d8b9696861a2ed29be81b74680a3?s=128&d=identicon&r=PG", "display_name": "kynnysmatto", "link": "https://stackoverflow.com/users/582235/kynnysmatto"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1576768265, "post_id": 59401418, "comment_id": 105011928, "body": "I have a function that takes eg. a minute to complete (<code>main_coroutine()</code>). I don&#39;t want it to block the execution of the rest of the program. It consists of many smaller pieces that take, say, 1 second each (<code>part1_coroutine</code>). It&#39;s ok if those block the execution. I could make a thread. But I&#39;d rather use a coroutine because it would make communicating with the main program easier. I&#39;ve previously used coroutines with Unity and C# and this was something that I did on a regular basis. Maybe I simplified my example too much, but I didn&#39;t want it to look too complicated."}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1576770915, "post_id": 59401418, "comment_id": 105013432, "body": "It would really help if you just showed us what the &quot;long coroutine&quot; version of the code you&#39;re trying to write is. Like, take the above code, and write the long form version of it."}], "answers": [{"comments": [{"owner": {"reputation": 3192, "user_id": 582235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e223d8b9696861a2ed29be81b74680a3?s=128&d=identicon&r=PG", "display_name": "kynnysmatto", "link": "https://stackoverflow.com/users/582235/kynnysmatto"}, "edited": false, "score": 0, "creation_date": 1576759647, "post_id": 59405570, "comment_id": 105007204, "body": "I see. But I still don&#39;t understand it, because If I try to do <code>co_await part1_coroutine();</code> I get the error &quot;no callable &#39;await_resume&#39; function found for type &#39;resumable&#39;&quot;. Which is understandable because as far as I&#39;ve understood, after <code>co_await</code> there should be an Awaiter object, and not a coroutine call or whatever is the correct term for it. I don&#39;t think an Awaiter is the same thing, because the requirement for an Awaiter is that it has the functions <code>await_ready</code>, <code>await_suspend</code> and <code>await_resume</code>, and I don&#39;t quite understand what those have to do with the coroutine call itself."}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "reply_to_user": {"reputation": 3192, "user_id": 582235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e223d8b9696861a2ed29be81b74680a3?s=128&d=identicon&r=PG", "display_name": "kynnysmatto", "link": "https://stackoverflow.com/users/582235/kynnysmatto"}, "edited": false, "score": 1, "creation_date": 1576766257, "post_id": 59405570, "comment_id": 105010803, "body": "@kynnysmatto: That seems to be a limitation of the example you\u2019re following: it doesn\u2019t go far enough to support nested coroutines."}], "tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 3, "last_activity_date": 1576742905, "creation_date": 1576742905, "answer_id": 59405570, "question_id": 59401418, "link": "https://stackoverflow.com/questions/59401418/how-can-i-call-a-coroutine-from-another-coroutine-in-c/59405570#59405570", "title": "How can I call a coroutine from another coroutine in C++?", "body": "<p>This is what <code>co_await foo()</code> <em>does</em>\u2014give another coroutine <code>foo</code> a chance to make progress, suspending the <em>current</em> coroutine as necessary to wait on it to finish.  If you just call a coroutine but don\u2019t await it, you throw away the handle for that call to it, abandoning the call.</p>\n"}], "owner": {"reputation": 3192, "user_id": 582235, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e223d8b9696861a2ed29be81b74680a3?s=128&d=identicon&r=PG", "display_name": "kynnysmatto", "link": "https://stackoverflow.com/users/582235/kynnysmatto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576767045, "creation_date": 1576711911, "last_edit_date": 1576767045, "question_id": 59401418, "link": "https://stackoverflow.com/questions/59401418/how-can-i-call-a-coroutine-from-another-coroutine-in-c", "title": "How can I call a coroutine from another coroutine in C++?", "body": "<p>I have a long coroutine and I would like to divide it into smaller coroutines. Just like with regular functions, to make the code more clear. It should behave just like there was only one big coroutine with all the smaller ones happening consecutively.</p>\n\n<p>I'm using <code>#include &lt;experimental/coroutine&gt;</code>.</p>\n\n<p>I've been trying something like this:</p>\n\n<pre><code>resumable part1_coroutine()\n{\n    cout &lt;&lt; \"1\" &lt;&lt; endl;\n    co_await suspend_always();\n}\n\nresumable part2_coroutine()\n{\n    cout &lt;&lt; \"2\" &lt;&lt; endl;\n    co_await suspend_always();\n}\n\nresumable main_coroutine()\n{\n    cout &lt;&lt; \"main\" &lt;&lt; endl;\n    part1_coroutine();\n    part2_coroutine();\n    co_await suspend_always();\n}\n</code></pre>\n\n<p>But what seems to happen is that the <code>part1_coroutine()</code> and <code>part2_coroutine()</code> won't be executed at all.</p>\n"}, {"tags": ["c++", "c", "linker-errors", "extern"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1576712054, "post_id": 59401416, "comment_id": 104991878, "body": "<code>static MyClass stat_MyClass</code> is a declaration of a static variable. You also need a definition."}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 2, "creation_date": 1576712151, "post_id": 59401416, "comment_id": 104991903, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/5019856/initialize-static-variables-in-c-class\">Initialize static variables in C++ class?</a> Or <a href=\"https://stackoverflow.com/q/9282354/1270789\">this one</a>?"}, {"owner": {"reputation": 143, "user_id": 11584125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a4ba4ec506a871bdc7600de20f20304?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/11584125/scott"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1576712614, "post_id": 59401416, "comment_id": 104992015, "body": "@HolyBlackCat you&#39;re completely right, that was my stupid error. Adding &quot;MyClass MyClass::stat_MyClass&quot; to the top of my .cpp file fixed everything. The error didn&#39;t show up when I was just compiling the file so I didn&#39;t think to focus my efforts on stuff that was (or wasn&#39;t) there before I added in the extern code. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 11584125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a4ba4ec506a871bdc7600de20f20304?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/11584125/scott"}, "is_accepted": true, "score": 3, "last_activity_date": 1576713091, "last_edit_date": 1576713091, "creation_date": 1576712709, "answer_id": 59401516, "question_id": 59401416, "link": "https://stackoverflow.com/questions/59401416/trying-to-call-c-method-in-c-using-extern-c-get-a-linker-error-of-undefine/59401516#59401516", "title": "Trying to call C++ method in C using extern &quot;C&quot;, get a linker error of &quot;undefined reference to&quot; object", "body": "<p>@HolyBlackCat was right, my error was that I had forgotten to define stat_MyClass. Adding the following line to the top of myclass.cpp fixed everything.</p>\n\n<pre><code>MyClass MyClass::stat_MyClass;\n</code></pre>\n\n<p>The error didn't show up when I was just compiling the standalone file so I didn't think to focus my efforts on stuff that was (or wasn't) there before I added in the extern code. Thank you!</p>\n"}], "owner": {"reputation": 143, "user_id": 11584125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a4ba4ec506a871bdc7600de20f20304?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/11584125/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "closed_date": 1576719154, "accepted_answer_id": 59401516, "answer_count": 1, "score": 0, "last_activity_date": 1576713091, "creation_date": 1576711881, "question_id": 59401416, "link": "https://stackoverflow.com/questions/59401416/trying-to-call-c-method-in-c-using-extern-c-get-a-linker-error-of-undefine", "closed_reason": "Duplicate", "title": "Trying to call C++ method in C using extern &quot;C&quot;, get a linker error of &quot;undefined reference to&quot; object", "body": "<p>What I am <em>trying</em> to do is call a C++ method from within a C file, in a new-to-me-but-fairly-large codebase. I have cribbed an implementation from elsewhere in the codebase, but am getting linker errors when I try to build it.</p>\n\n<p>What I <em>think</em> I am doing is making a class in a .cpp/.h file pair. In a global header file, I declare a wrapper function, and in the .cpp file I define that wrapper function within <em>extern \"C\"</em> and have it call one of the class' methods. Then I call the wrapper function from my main .c file. </p>\n\n<p>What I am <em>actually</em> doing is something wrong. I've spent the last few hours reading around on similar stackoverflow errors and how <em>extern \"C\"</em> works, but I still don't understand what isn't going right. Is there an obvious mistake in what I'm doing here?</p>\n\n<p>I am not confident in my understanding of how the build system for this project is set up, but I generally trust that it's set up correctly, and that I've added myclass.cpp to the correct list of build targets. So I'm thinking the error is probably somewhere below.</p>\n\n<p><strong>Error message:</strong></p>\n\n<pre><code>Creating objlist.lnk...\nLinking into output.elf\n\nmodule.o: In function `MyClass::MyMethod()':\n~/myclass.cpp:5: undefined reference to `MyClass::stat_MyClass'\n~/myclass.cpp:5: undefined reference to `MyClass::stat_MyClass'\nmodule.o:~/myclass.cpp:5: more undefined references to `MyClass::stat_MyClass' follow\ncollect2: error: ld returned 1 exit status\nmake[1]: *** [output.elf] Error 1\nmake: *** [default] Error 2\n</code></pre>\n\n<p><strong>Paraphrased code:</strong></p>\n\n<p>global.h</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n  int my_c_wrapper_func(void);\n  // other function declarations\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>global.c</p>\n\n<pre><code>#include \"global.h\"\n// my_c_wrapper_func() not defined here\n// other function definitions\n</code></pre>\n\n<p>myclass.h</p>\n\n<pre><code>#include \"global.h\"\nclass MyClass {\npublic:\n  static MyClass* get() { return &amp;stat_MyClass; } // Get the singleton\n  int MyMethod();\n\nprivate:\n  static MyClass stat_MyClass; // The singleton\n}\n</code></pre>\n\n<p>myclass.cpp</p>\n\n<pre><code>#include \"myclass.h\"\n\nextern \"C\" int my_c_wrapper_func() {\n  return MyClass::get()-&gt;MyMethod();\n}\n\nint MyClass::MyMethod() {\n  return 1;\n}\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include \"global.h\"\nint main() {\n  return(my_c_wrapper_func());\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "string", "byte"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1576712351, "post_id": 59401370, "comment_id": 104991948, "body": "Just to be sure, are you aware that <code>&quot;\\x00\\x00\\x00&quot;</code> is a char array of 3 zeros followed by the terminating null?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1576712517, "post_id": 59401370, "comment_id": 104991996, "body": "So the question to you is this -- how did the original string get to be formatted in a way that is &quot;not good&quot;.  I think we&#39;re missing some details.  What program stuck bogus slash characters onto the original string?  If that is how the original string looks, then you need to fix the program giving you the string in that fashion.  Or are you misinterpreting how strings and escape characters work in C++ source code?"}, {"owner": {"reputation": 1087, "user_id": 2129218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bf5ffff85c1f5609fca08eb8e05279?s=128&d=identicon&r=PG", "display_name": "Build Succeeded", "link": "https://stackoverflow.com/users/2129218/build-succeeded"}, "edited": false, "score": 0, "creation_date": 1576744287, "post_id": 59401370, "comment_id": 104999630, "body": "What is the actual problem you are facing?"}], "answers": [{"tags": [], "owner": {"reputation": 7744, "user_id": 9666018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2959ed405ad18cbca6aa3efe01bc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Armin Montigny", "link": "https://stackoverflow.com/users/9666018/armin-montigny"}, "is_accepted": true, "score": 0, "last_activity_date": 1576762398, "creation_date": 1576762398, "answer_id": 59410843, "question_id": 59401370, "link": "https://stackoverflow.com/questions/59401370/how-to-convert-string-with-double-backslashes-to-single-backslahses/59410843#59410843", "title": "How to convert string with double backslashes to single backslahses", "body": "<p>Maybe there is a general misunderstanding with escape characters in string literals.</p>\n\n<p>The literal <code>\"\\\\xfc\\\\xe8\\\\x82\"</code> as a string uses \"\\\" as an escape character.  \"\\\" will be reduced to \"\\\". As you would expect. So, if you print your given <code>std::string</code>, then the result will be:\n<code>\\xfc\\xe8\\x82</code>.</p>\n\n<p>So, what you want to do now is: Create a char array containing those hex values, given in the original <code>std::string</code>.</p>\n\n<p>Please note: Your statement <code>char s[] = \"\\xfc\\xe8\\x82\";</code> will create a C-Style array of char, with the size 4 and containing:</p>\n\n<pre><code>s[0]=fc, s[1]=e8, s[2]=82, s[3]=0\n</code></pre>\n\n<p>In the example below I show 2 proposals for conversion. \n 1. Straight forward conversion\n 2. Using C++ standard algorithms</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;regex&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\n\n// Hex digit String\nstd::regex hexValue{R\"(\\\\[xX]([0-9a-fA-F][0-9a-fA-F]))\"};\n\n\nint main ()\n{   \n    // Source string\n    std::string s1 = \"\\\\xfc\\\\xe8\\\\x82\";\n    std::cout &lt;&lt; \"s 1: \" &lt;&lt; s1 &lt;&lt; \"\\n\";\n\n\n    // Proposal 1 ------------------------------------------------------\n\n    // Target array\n    unsigned char s2[3];\n\n    // Convert bytes from strings\n    for (int i=0; i&lt;s1.size()/4; ++i ) {\n\n        // Do conversion. Isolate substring, the convert\n        s2[i] = std::strtoul(s1.substr(i*4+2,2).c_str(), nullptr,16);\n        // Result is now in s2\n\n        // Output value as tring and decimal value\n        std::cout &lt;&lt; s1.substr(i*4+2,2) &lt;&lt; \" -&gt; \" &lt;&lt; std::hex &lt;&lt; static_cast &lt;unsigned short&gt;(s2[i]) \n                  &lt;&lt; \" -&gt; \" &lt;&lt; std::dec &lt;&lt; static_cast &lt;unsigned short&gt;(s2[i]) &lt;&lt; \"\\n\";\n    }\n\n    // Proposal 2 ------------------------------------------------------\n\n    // Get the tokens\n    std::vector&lt;std::string&gt; vstr(std::sregex_token_iterator(s1.begin(),s1.end(),hexValue, 1), {});\n\n    // Convert to unsigned int\n    std::vector&lt;unsigned int&gt; vals{};\n\n    std::transform(vstr.begin(), vstr.end(), std::back_inserter(vals), \n        [](std::string &amp;s){ return static_cast&lt;unsigned&gt;(std::strtoul(s.c_str(), nullptr,16)); } );\n\n    std::copy(vals.begin(), vals.end(), std::ostream_iterator&lt;unsigned&gt;(std::cout,\"\\n\"));\n\n    return 0;\n}\n</code></pre>\n\n<p>The second solution will eat any number of hex numbers given in a string</p>\n"}], "owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59410843, "answer_count": 1, "score": 0, "last_activity_date": 1576762398, "creation_date": 1576711594, "last_edit_date": 1576712467, "question_id": 59401370, "link": "https://stackoverflow.com/questions/59401370/how-to-convert-string-with-double-backslashes-to-single-backslahses", "title": "How to convert string with double backslashes to single backslahses", "body": "<p>How do I convert the following string:</p>\n\n<pre><code>std::string s = \"\\\\xfc\\\\xe8\\\\x82\"\n</code></pre>\n\n<p>to the char array equivalent:</p>\n\n<pre><code>char s[] = \"\\xfc\\xe8\\x82\"\n</code></pre>\n"}, {"tags": ["c++"], "answers": [{"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 1, "last_activity_date": 1576714869, "creation_date": 1576714869, "answer_id": 59401759, "question_id": 59401328, "link": "https://stackoverflow.com/questions/59401328/changing-the-last-type-in-a-variadic-template/59401759#59401759", "title": "Changing the last type in a variadic template", "body": "<p>Feeding <code>std::make_index_sequence&lt;N&gt;</code> or <code>std::index_sequence_for&lt;Ts...&gt;</code> to a helper struct or function is usually the easiest way to do non-trivial things to a pack.</p>\n\n<p>To make a helper struct with the type transformation you want, first declare it with the inputs necessary, plus one extra type parameter to take the <code>std::index_sequence</code>:</p>\n\n<pre><code>namespace foo_detail\n{\n    template &lt;template &lt;typename...&gt; class Container,\n              typename NewFirstT,\n              typename NewLastT,\n              typename IdxSeq,\n              typename ... Tail&gt;\n    struct OutContainerHelper;\n}\n</code></pre>\n\n<p>Then make a partial specialization that can take any <code>std::index_sequence&lt;I...&gt;</code>:</p>\n\n<pre><code>namespace foo_detail\n{\n    template &lt;template &lt;typename...&gt; class Container,\n              typename NewFirstT,\n              typename NewLastT,\n              std::size_t ... I,\n              typename ... Tail&gt;\n    struct OutContainerHelper&lt;\n        Container, NewFirstT, NewLastT, std::index_sequence&lt;I...&gt;, Tail...&gt;\n    {\n        using type = Container&lt;\n            NewFirstT,\n            std::conditional_t&lt;(I+1 == sizeof...(Tail)), NewLastT, Tail&gt;...\n        &gt;;\n    };\n}\n</code></pre>\n\n<p>Then just provide a <code>std::make_index_sequence</code> or <code>std::index_sequence_for</code> as the template argument to the helper:</p>\n\n<pre><code>template &lt;template &lt;typename...&gt; class Container,\n          typename OldFirstT,\n          typename T2,\n          typename... Ts,\n          typename NewVal&gt;\nauto foo(Container&lt;OldFirstT, T2, Ts...&gt; t, NewVal const&amp; v) {\n    using NewLastT = ???;\n    using OutContainer = typename foo_detail::OutContainerHelper&lt;\n        Container, NewVal, NewLastT,\n        std::index_sequence_for&lt;T2, Ts...&gt;, T2, Ts...\n    &gt;::type;\n    OutContainer o;\n    // fill this new container with v\n    return o;\n}\n</code></pre>\n\n<p>(The additional <code>T2</code> makes sure the <code>Container</code> specialization has at least two template arguments, since the transformation doesn't make sense otherwise. This might make the compile errors a bit less confusing if someone attempts using it with a template that only has one template parameter.)</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/55b4dd47cc1524ae\" rel=\"nofollow noreferrer\">Working example on coliru.</a></p>\n"}], "owner": {"reputation": 1156, "user_id": 3121568, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/ZzUrW.jpg?s=128&g=1", "display_name": "meguli", "link": "https://stackoverflow.com/users/3121568/meguli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59401759, "answer_count": 1, "score": 1, "last_activity_date": 1576714869, "creation_date": 1576711253, "question_id": 59401328, "link": "https://stackoverflow.com/questions/59401328/changing-the-last-type-in-a-variadic-template", "title": "Changing the last type in a variadic template", "body": "<p>I actually spotted similar questions but all were related to function argument packs and handling them through <code>std::tuple</code>and <code>std::index_sequence</code>. I need something different and I can't make the connection myself. Here it is:</p>\n\n<p>Suppose I have a function taking some variadic pack and I want to achieve:</p>\n\n<pre><code>template &lt;typename NewVal, template Container, typename T, typename... Ts&gt;\nauto foo(Container&lt;T, Ts...&gt; t, NewVal const&amp; v) {\n    using OutContainer= Container&lt;NewVal, Same as Ts up to last Type..., but LastElement should be different&gt;\n    OutContainer o;\n    // fill this new container with v\n    return o;\n}\n</code></pre>\n\n<p>I observed, in STL, <code>Allocator</code> template arguments in containers are always the last one and the type stored is always the first one (don't mind <code>std::map</code> now). So, If I want to make a <code>Container&lt;T&gt;</code> into a <code>Container&lt;U&gt;</code>, I need to handle the last allocator argument as well so that I am using an allocator for this new type. Any ideas?</p>\n\n<p>This is sort of a pseudocode of course, <code>Container</code> is a template-template parameter.</p>\n"}, {"tags": ["c++", "loops"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 2, "creation_date": 1576711064, "post_id": 59401276, "comment_id": 104991644, "body": "I recommend using a debugger. That way you can execute your program 1 line at a time and look at the variables at each step and understand the flow of the execution."}, {"owner": {"reputation": 22043, "user_id": 87973, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abc7768058e25c1382df18414db72a10?s=128&d=identicon&r=PG", "display_name": "Jonas Bystr&#246;m", "link": "https://stackoverflow.com/users/87973/jonas-bystr%c3%b6m"}, "edited": false, "score": 2, "creation_date": 1576711103, "post_id": 59401276, "comment_id": 104991650, "body": "<code>else if (a==12) ... return 1;</code> Is the cause. Also, it&#39;s spelled answer."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576711167, "post_id": 59401276, "comment_id": 104991665, "body": "<code>return 1;</code> in <code>main()</code> means end the program."}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "edited": false, "score": 1, "creation_date": 1576711277, "post_id": 59401276, "comment_id": 104991687, "body": "If <code>a==1</code> return;   this might be the case"}, {"owner": {"reputation": 3343, "user_id": 1983409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/T95Sg.jpg?s=128&g=1", "display_name": "zdf", "link": "https://stackoverflow.com/users/1983409/zdf"}, "edited": false, "score": 0, "creation_date": 1576711306, "post_id": 59401276, "comment_id": 104991692, "body": "What\u2019s the point of <code>a</code>? Also, you might want to use a <code>switch</code> instead of <code>if</code>s."}, {"owner": {"reputation": 1, "user_id": 7585210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JXBn8H1-NL8/AAAAAAAAAAI/AAAAAAAAAOs/bVhJTIamSYw/photo.jpg?sz=128", "display_name": "Tuke", "link": "https://stackoverflow.com/users/7585210/tuke"}, "edited": false, "score": 0, "creation_date": 1576711399, "post_id": 59401276, "comment_id": 104991716, "body": "Hello! again since i just started on this site 3 minutes ago probably i dont know how to awnser to you guys directly lol. BUT thanks alot for the awnsers i thought it would not matter if the &quot;return 1;&quot; was there since it was inside a else ifs brackets but the more you know! Again thanks alot"}, {"owner": {"reputation": 1, "user_id": 7585210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JXBn8H1-NL8/AAAAAAAAAAI/AAAAAAAAAOs/bVhJTIamSYw/photo.jpg?sz=128", "display_name": "Tuke", "link": "https://stackoverflow.com/users/7585210/tuke"}, "edited": false, "score": 0, "creation_date": 1576711458, "post_id": 59401276, "comment_id": 104991731, "body": "And to &quot;failure by desing&quot; the point of &quot;a&quot; is to keep the loop running and to modify it to 0 should you want to exit"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576711635, "post_id": 59401276, "comment_id": 104991772, "body": "@Tuke &quot;<i>since i just started on this site 3 minutes ago probably i dont know how to awnser to you guys directly</i>&quot; If you started on this site 3 minutes ago, you should&#39;ve taken the <a href=\"https://stackoverflow.com/tour\">tour</a>, and read through <a href=\"https://stackoverflow.com/help\">help center</a>, <b>before</b> trying to ask a question."}], "answers": [{"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": true, "score": 1, "last_activity_date": 1576711602, "creation_date": 1576711602, "answer_id": 59401376, "question_id": 59401276, "link": "https://stackoverflow.com/questions/59401276/me-not-understanding-do-while-loops/59401376#59401376", "title": "Me not understanding do while loops", "body": "<p>If the number input isn't one that you check (1 to 5) then you hit:</p>\n\n<pre><code>else if (a == 1) {\n    std::cout &lt;&lt; \"\\n\";\n    return 1;\n}\n</code></pre>\n\n<p>which will enter the <code>if</code> (because <code>a</code> is 1), print a new line and <code>return</code> from <code>main</code> ending your run.</p>\n"}], "owner": {"reputation": 1, "user_id": 7585210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JXBn8H1-NL8/AAAAAAAAAAI/AAAAAAAAAOs/bVhJTIamSYw/photo.jpg?sz=128", "display_name": "Tuke", "link": "https://stackoverflow.com/users/7585210/tuke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1576735999, "accepted_answer_id": 59401376, "answer_count": 1, "score": -5, "last_activity_date": 1576712460, "creation_date": 1576710920, "question_id": 59401276, "link": "https://stackoverflow.com/questions/59401276/me-not-understanding-do-while-loops", "closed_reason": "Not suitable for this site", "title": "Me not understanding do while loops", "body": "<p>So i tried to make my first console aplication but it came to a bit of a bummer since i dont understand how a do while loop works</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint balance = 100;\nint pay = 30;\nint awnser;\n\n// Variables for the awnsers\nint withdrawal;\nint a = 1;\n\n\nint main() {\n    do {\n        std::cout &lt;&lt; \"\\n Whats the action you wanna do? \\n 1 = Check balance \\n 2 = Withdraw money \\n 3 = Deposit money \\n 4 = Check transaction history \\n 5 = Exit \\n\";\n        std::cout &lt;&lt; \" \";\n        std::cin &gt;&gt; awnser;\n\n        if (awnser == 1) {\n            std::cout &lt;&lt; balance &lt;&lt; \" Euros\\n \\n\";\n        }\n\n        if (awnser == 2) {\n            std::cout &lt;&lt; \"How much do you wanna with draw?\\n\";\n            std::cin &gt;&gt; withdrawal;\n            if (withdrawal &gt; balance)\n                std::cout &lt;&lt; \"You dont have that much money.\\n \\n\";\n            else {\n\n                std::cout &lt;&lt; \"Your current balance is: \" &lt;&lt; balance - withdrawal;\n\n            }\n\n        }\n\n        if (awnser == 3) {\n            std::cout &lt;&lt; \"We know you dont have enymore daam money you beggar so dont even try that\\n \\n\";\n        }\n\n        if (awnser == 4) {\n\n\n        }\n\n        if (awnser == 5) {\n            std::cout &lt;&lt; \"Enter 0 to exit or 1 to go back\\n\";\n            std::cin &gt;&gt; a;\n        }\n        else if (a == 1) {\n            std::cout &lt;&lt; \"\\n\";\n            return 1;\n\n        }\n\n\n    } while (a == 1);\n\n}\n</code></pre>\n\n<p>I thought it would get back to the top since no other \"if\" requierements were met and just give me the \"Whats the action you wanna take again\" but it just exits out so what am i doing wrong?</p>\n"}, {"tags": ["c++", "qt", "asynchronous", "audio", "while-loop"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1576710030, "post_id": 59401092, "comment_id": 104991371, "body": "The <a href=\"https://doc.qt.io/qt-5/qsound.html\" rel=\"nofollow noreferrer\"><code>QSound</code> documentation</a> states that <code>QSound</code> is <b>asynchronous</b>, so it makes sense that the sounds do not play immediately when <code>QSound::play()</code> is called. Perhaps <code>QSound</code> depends on an internal message loop that is blocked by your <code>startGame()</code> method. Look at <a href=\"https://doc.qt.io/qt-5/qsoundeffect.html\" rel=\"nofollow noreferrer\"><code>QSoundEffect</code></a> or <a href=\"https://doc.qt.io/qt-5/qaudiooutput.html\" rel=\"nofollow noreferrer\"><code>QAudioOutput</code></a>, they may be more appropriate for your situation."}, {"owner": {"reputation": 3, "user_id": 8177537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-arjG5vgSVFc/AAAAAAAAAAI/AAAAAAAAAe4/C35WhPTRcUc/photo.jpg?sz=128", "display_name": "Choudhry Amjad", "link": "https://stackoverflow.com/users/8177537/choudhry-amjad"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1576712533, "post_id": 59401092, "comment_id": 104991999, "body": "Okay I&#39;ll look into the other 2 you mentioned I did try <code>QSoundEffect</code> which I think is similar to QSound, but I&#39;ll look into it properly and the other one. My logic was QSound is asynchronous so if I put a delay in the main thread the other one won&#39;t be blocked."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 8177537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-arjG5vgSVFc/AAAAAAAAAAI/AAAAAAAAAe4/C35WhPTRcUc/photo.jpg?sz=128", "display_name": "Choudhry Amjad", "link": "https://stackoverflow.com/users/8177537/choudhry-amjad"}, "is_accepted": true, "score": 0, "last_activity_date": 1576715672, "creation_date": 1576715672, "answer_id": 59401852, "question_id": 59401092, "link": "https://stackoverflow.com/questions/59401092/call-qsound-calls-with-a-delay-between-them-qt-c/59401852#59401852", "title": "Call QSound calls with a delay between them Qt C++", "body": "<p>Thanks to @RemyLebeau for pointing me in the right direction.</p>\n\n<p>While looking into <code>QSoundEffect</code> properly I found out about <code>QEventLoop</code> combining their forces I have sound and the with delay and everything work in terms of generating levels. These are the changes I made.</p>\n\n<pre><code>  // Add this stuff to my constructor\n  m_soundEffect = std::make_unique&lt;QSoundEffect&gt;();\n  m_soundEffect-&gt;setLoopCount(1); &lt;- must set loop count\n  m_eventLoop = std::make_unique&lt;QEventLoop&gt;(); &lt;- event loop needed to hear sound\n  connect(m_soundEffect.get(), SIGNAL(playingChanged()), m_eventLoop.get(),\n          SLOT(quit())); &lt;- needed to stop the event loop after sound is played or program locks up on m_eventLoop .exec()\n</code></pre>\n\n<pre><code>//Updated playSound method\nauto Simon::playSound(Simon::Color color) -&gt; void {\n  if (color == Simon::Color::green) {\n    m_soundEffect-&gt;setSource(QUrl::fromLocalFile(\":/sounds/green.wav\"));\n    m_soundEffect-&gt;play();\n    m_eventLoop-&gt;exec();\n  } else if (color == Simon::Color::red) {\n    m_soundEffect-&gt;setSource(QUrl::fromLocalFile(\":/sounds/red.wav\"));\n    m_soundEffect-&gt;play();\n    m_eventLoop-&gt;exec();\n  } else if (color == Simon::Color::blue) {\n    m_soundEffect-&gt;setSource(QUrl::fromLocalFile(\":/sounds/blue.wav\"));\n    m_soundEffect-&gt;play();\n    m_eventLoop-&gt;exec();\n  } else if (color == Simon::Color::yellow) {\n    m_soundEffect-&gt;setSource(QUrl::fromLocalFile(\":/sounds/yellow.wav\"));\n    m_soundEffect-&gt;play();\n    m_eventLoop-&gt;exec();\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8177537, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-arjG5vgSVFc/AAAAAAAAAAI/AAAAAAAAAe4/C35WhPTRcUc/photo.jpg?sz=128", "display_name": "Choudhry Amjad", "link": "https://stackoverflow.com/users/8177537/choudhry-amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 59401852, "answer_count": 1, "score": 0, "last_activity_date": 1576715672, "creation_date": 1576709685, "question_id": 59401092, "link": "https://stackoverflow.com/questions/59401092/call-qsound-calls-with-a-delay-between-them-qt-c", "title": "Call QSound calls with a delay between them Qt C++", "body": "<p>Hey I'm building a small game and I am creating the level by making a vector of numbers which correlate to 1-4 colours through a enum. The problem is the loop(in <code>Simon::loadChallenge</code>) where I add the color codes to the vector everything works apart from the calls to playSound(which calls <code>QSound::play</code>). No sound plays until <code>Simon::startGame()</code> finishes then you hear all of the sounds together.</p>\n\n<pre><code>auto Simon::playSound(Simon::Color color) -&gt; void {\n  if (color == Simon::Color::green) {\n    QSound::play(\":/sounds/green.wav\");\n  } else if (color == Simon::Color::red) {\n    QSound::play(\":/sounds/red.wav\");\n  } else if (color == Simon::Color::blue) {\n    QSound::play(\":/sounds/blue.wav\");\n  } else if (color == Simon::Color::yellow) {\n    QSound::play(\":/sounds/yellow.wav\");\n  }\n}\n</code></pre>\n\n<pre><code>auto Simon::loadChallenge() -&gt; void {\n  challengeVect.clear();    &lt;- Clears previous level \n  for (auto i = 0; i &lt; Simon::level; ++i) {\n    auto currentVal = static_cast&lt;int&gt;(std::rand() % 4);\n    qDebug() &lt;&lt; currentVal;\n    playSound(Simon::Color(currentVal)); &lt;- Calls method above and is meant to play the sound(doesn't)\n    challengeVect.push_back(currentVal);\n    std::this_thread::sleep_for(std::chrono::milliseconds(50)); &lt;- delay which works\n  }\n}\n</code></pre>\n\n<pre><code>auto Simon::startGame() -&gt; void {\n  auto i = 10;\n  while (i &gt;= 0) { &lt;- If you replace this with while(true) it will run infinitely without playing a sound\n    loadChallenge(); &lt;- Where loadChallenge is called from\n    --i;\n  }\n</code></pre>\n\n<p>I apologise if this isn't enough context the code is here(<a href=\"https://github.com/ItsChoudhry/SimonSaysQt\" rel=\"nofollow noreferrer\">https://github.com/ItsChoudhry/SimonSaysQt</a>) if you would like a broader look.</p>\n\n<p>Thank you for taking a look at my problem :D</p>\n"}, {"tags": ["c++", "qt", "focus", "floating", "qdockwidget"], "owner": {"reputation": 19, "user_id": 11440636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d726ef9cd9af63f694f0876322a1d8?s=128&d=identicon&r=PG&f=1", "display_name": "Tom 2019", "link": "https://stackoverflow.com/users/11440636/tom-2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576716523, "creation_date": 1576709531, "last_edit_date": 1576716523, "question_id": 59401073, "link": "https://stackoverflow.com/questions/59401073/qt-setting-focus-on-a-floating-qdockwidget", "title": "Qt - Setting Focus on a floating QDockWidget", "body": "<p>my basic process is that I create a floating dock widget and then try to give it focus. I've found that so long as it is docked in the main window then it works as expected however as soon as i call  it  will no longer be called correctly.</p>\n\n<p>Im using Qt 5.14 and C++.</p>\n\n<p>Heres the relevent code for my methods.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>DockPanel::DockPanel(QWidget *parent, QWidget * hold_widget, QString title, bool popup) :\n    QDockWidget(parent),\n    popup(popup)\n{\n    setObjectName(title);\n    setFeatures(QDockWidget::DockWidgetMovable);\n    DockPanelTitle * panel_title = new DockPanelTitle(this, title);\n\n    setTitleBarWidget(panel_title);\n    setWidget(hold_widget);\n\n    if (popup)\n    {\n        setFocusPolicy(Qt::StrongFocus);\n        setFloating(true);\n        setFocus();\n    }\n}\n</code></pre>\n\n<pre><code>void WindowToolBarButton::mousePressEvent(QMouseEvent * e)\n{\n    QMainWindow * cw = window()-&gt;findChild&lt;QMainWindow *&gt;(\"CentralWindow\");\n    HolderWidget * widget_a = new HolderWidget(this);\n    QPoint m = window()-&gt;mapToGlobal(cw-&gt;pos());    \n\n    DockPanel * panel_a = new DockPanel(cw, widget_a, btn_label-&gt;text(), true);\n    panel_a-&gt;setGeometry(m.x(), m.y(), 300, cw-&gt;height());\n\n    cw-&gt;addDockWidget(Qt::RightDockWidgetArea, panel_a);\n\n    cw-&gt;setFocus();\n    QWidget * w = qApp-&gt;focusWidget();\n    for (DockPanel * child : w-&gt;findChildren&lt;DockPanel *&gt;())\n    {   \n        child-&gt;setFocus();\n        QString s = child-&gt;objectName();\n        std::cout &lt;&lt; \"Widget: \" + s.toStdString() + \" has focus \" &lt;&lt; child-&gt;hasFocus() &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>Edit - Sorry Im missing the last two brackets from the mousepressevent, it doesnt seem to want to format.</p>\n\n<p>So to summarise im trying to figure out why a floating QDockWidget cant be given focus but a docked one can and if there is a possible solution.</p>\n\n<p><img src=\"https://i.stack.imgur.com/D2KKM.png\" alt=\"Result\"></p>\n"}, {"tags": ["c++", "base64", "jpeg", "tobase64string"], "comments": [{"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1576708963, "post_id": 59400880, "comment_id": 104991034, "body": "There is a way to use <a href=\"https://www.ijg.org/\" rel=\"nofollow noreferrer\"><code>libjpeg</code></a> without writing to disk, encoding to base64 would be a separate step."}, {"owner": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576709019, "post_id": 59400880, "comment_id": 104991056, "body": "@Benny K Basically you want to encode an unsigned char array to base64? I mean, the fact that it&#39;s a BGR array that happens to be decoded from a JPEG file is just bonus info?"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576730076, "post_id": 59400880, "comment_id": 104995269, "body": "@foolo , No, the raw byte array should first be converted to jpeg encoded byte array, this is the most problematic part for me, after that, converting this byte array to base64 string is what I am looking for."}, {"owner": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 1, "creation_date": 1576745515, "post_id": 59400880, "comment_id": 105000234, "body": "Ok, so it&#39;s really two questions: 1. How to encode BGR raw data to jpeg-format, and 2. How to convert the data from step 1 to base 64. Right?"}, {"owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "reply_to_user": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576753713, "post_id": 59400880, "comment_id": 105004351, "body": "@foolo Yes, the main problem is 1. The, second step is more simple looking at previous posts here."}], "answers": [{"tags": [], "owner": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "is_accepted": true, "score": 1, "last_activity_date": 1576764661, "creation_date": 1576764661, "answer_id": 59411446, "question_id": 59400880, "link": "https://stackoverflow.com/questions/59400880/convert-bgr-image-into-base64-string-as-jpeg/59411446#59411446", "title": "Convert BGR image into base64 string as jpeg", "body": "<p>For the image to jpeg part, you can use toojpeg which is much easier to use than libjpeg.\n<a href=\"https://create.stephan-brumme.com/toojpeg/\" rel=\"nofollow noreferrer\">https://create.stephan-brumme.com/toojpeg/</a></p>\n\n<p>But you'll have to reverse the BGR to RGB first, because toojpeg does not support BGR yet.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include \"toojpeg.h\"\n\nstd::vector&lt;unsigned char&gt; jpeg_data;\n\nvoid myOutput(unsigned char byte) {\n    jpeg_data.push_back(byte);\n}\n\nint main() {\n    const auto width = 800;\n    const auto height = 600;\n    const auto bytesPerPixel = 3;\n\n    unsigned char bgr_data[width * height * bytesPerPixel];\n\n    // put some sample data in bgr_data, just for the example\n    for (unsigned i = 0; i &lt; sizeof(bgr_data); i += 3) {\n        bgr_data[i]     = i / width;\n        bgr_data[i + 1] = i / width * 2;\n        bgr_data[i + 2] = i / width * 3;\n    }\n\n    // convert BGR to RGB\n    unsigned char rgb_data[sizeof(bgr_data)];\n    for (unsigned i = 0; i &lt; sizeof(bgr_data); i += 3) {\n        rgb_data[i]     = bgr_data[i + 2];\n        rgb_data[i + 1] = bgr_data[i + 1];\n        rgb_data[i + 2] = bgr_data[i];\n    }\n\n    // convert the RGB data to jpeg\n    bool isRGB = true;\n    const auto quality = 90;\n    const bool downsample = false;\n    const char* comment = \"example image\";\n    bool result_ok = TooJpeg::writeJpeg(myOutput, rgb_data, width, height, isRGB, quality, downsample, comment);\n    if (result_ok) {\n        // jpeg_data now contains jpeg-encoded image, which can be encoded as base 64\n    }\n    return 0;\n}\n\n</code></pre>\n"}], "owner": {"reputation": 1661, "user_id": 1877002, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8a1c3de36e3fb239c77f4439d1866894?s=128&d=identicon&r=PG", "display_name": "Benny K", "link": "https://stackoverflow.com/users/1877002/benny-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 59411446, "answer_count": 1, "score": 0, "last_activity_date": 1576764661, "creation_date": 1576708296, "question_id": 59400880, "link": "https://stackoverflow.com/questions/59400880/convert-bgr-image-into-base64-string-as-jpeg", "title": "Convert BGR image into base64 string as jpeg", "body": "<p>I have color image represented in OpenCV convention where each pixel is represented as <code>unsigned char</code> in BGR order row after row:</p>\n\n<pre><code>const int BGR = 3;\nconst int rows= 256;\nconst int cols = 512;\nunsigned char rawIm[BGR * rows *cols] = {'g', 't', 'y', // lots of chars.....}\n</code></pre>\n\n<p>I want to convert this stream into base64 string which represents the corresponding jpeg image without actually writing the image on the disk, just \"plain\" bytes transformation. how can I do that in C++? </p>\n"}, {"tags": ["c++", "build", "cmake", "uwebsockets"], "comments": [{"owner": {"reputation": 2045, "user_id": 6842395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d215da0d7fcc97ae7fbca3af451bf10d?s=128&d=identicon&r=PG&f=1", "display_name": "Former contributor", "link": "https://stackoverflow.com/users/6842395/former-contributor"}, "edited": false, "score": 0, "creation_date": 1576835547, "post_id": 59400805, "comment_id": 105032617, "body": "Did you see this wiki page: <a href=\"https://github.com/uNetworking/uWebSockets/wiki/Misc.-details\" rel=\"nofollow noreferrer\">github.com/uNetworking/uWebSockets/wiki/Misc.-details</a> ? looks like there may be a Visual Studio project (VC++.vcxproj) somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 803, "user_id": 1048739, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ca6dd67ca1c10b2f4a2b7cd98de302c?s=128&d=identicon&r=PG&f=1", "display_name": "hevele", "link": "https://stackoverflow.com/users/1048739/hevele"}, "is_accepted": true, "score": 0, "last_activity_date": 1577407474, "creation_date": 1577407474, "answer_id": 59494834, "question_id": 59400805, "link": "https://stackoverflow.com/questions/59400805/build-uwebsockets-on-windows-10-with-cmake/59494834#59494834", "title": "Build uWebSockets on Windows 10 with CMake", "body": "<p>Importing dependencies with <code>add_subdirectory</code> seems like a good way around this. When I ran cmake, I was receiving LNK2019 Error. I realized the following code snippet I found online was causing the problem, and the system works when I delete it. </p>\n\n<pre><code>if(MSVC)\n    set(CMAKE_EXE_LINKER_FLAGS_DEBUG \"${CMAKE_EXE_LINKER_FLAGS_DEBUG} /NODEFAULTLIB:libcmt.lib /NODEFAULTLIB:msvcrt.lib\")\n    set(CMAKE_EXE_LINKER_FLAGS \"${CMAKE_EXE_LINKER_FLAGS} /SUBSYSTEM:WINDOWS\")\nendif()\n</code></pre>\n"}], "owner": {"reputation": 803, "user_id": 1048739, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ca6dd67ca1c10b2f4a2b7cd98de302c?s=128&d=identicon&r=PG&f=1", "display_name": "hevele", "link": "https://stackoverflow.com/users/1048739/hevele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "accepted_answer_id": 59494834, "answer_count": 1, "score": 0, "last_activity_date": 1577407474, "creation_date": 1576707888, "last_edit_date": 1576793289, "question_id": 59400805, "link": "https://stackoverflow.com/questions/59400805/build-uwebsockets-on-windows-10-with-cmake", "title": "Build uWebSockets on Windows 10 with CMake", "body": "<p>I want to use <a href=\"https://github.com/uNetworking/uWebSockets\" rel=\"nofollow noreferrer\">uWebSockets</a>(UWS) in my C++ project to transfer images over the network. The setup will be running on multiple operating systems, so the best way of creating the build files seemed like using CMake. </p>\n\n<p>However, I am new to CMake and having a hard time building UWS. I don't understand how to start working with the official repository on Windows 10, so I found <a href=\"https://github.com/jchdng/uWebSockets\" rel=\"nofollow noreferrer\">another repository</a> that includes a <code>CMakeFiles.txt</code> file and some of the dependencies (<em>openssl, zlib, libuv</em>, but it doesn't include <em>uSockets</em> for some reason). The root <a href=\"https://github.com/jchdng/uWebSockets/blob/master/CMakeLists.txt\" rel=\"nofollow noreferrer\"><code>CMakeFiles.txt</code></a> includes:</p>\n\n<pre><code>[...] \n\nfind_package(OpenSSL REQUIRED)\nfind_package(ZLIB REQUIRED)\n\nfind_path(LIBUV_INCLUDE_DIR uv.h)\nfind_library(LIBUV_LIBRARY NAMES uv uv1)\n\n[...] \n</code></pre>\n\n<p>It looks straightforward, but when I try to run <code>mkdir build &amp;&amp; cd build; cmake ..</code>, it cannot find <code>OpenSSL</code>. Here is the error message it spits out:</p>\n\n<pre><code>[...]\n[cmake]   Could not find a package configuration file provided by \"OpenSSL\" with any\n[cmake]   of the following names:\n[cmake] \n[cmake]     OpenSSLConfig.cmake\n[cmake]     openssl-config.cmake\n[...]\n</code></pre>\n\n<p>The above error message suggests that I need to set up a config file for each of these libraries. Yet, if I understand the <a href=\"https://cmake.org/cmake/help/latest/command/find_package.html#search-procedure\" rel=\"nofollow noreferrer\"><code>find_package</code> docs</a> correctly, the command itself searches the library in various locations under the root folder. What kind of a folder structure does the <code>find_package</code> need in order to work? </p>\n\n<p>More generally, am I wasting my time with this alternative repo? Is there a better way of using UWS with Windows 10? The official repo has <a href=\"https://github.com/uNetworking/uWebSockets/issues/898\" rel=\"nofollow noreferrer\">a question</a> about how to use it on Windows but I don't understand how that's an answer to the question. It only points to <a href=\"https://github.com/uNetworking/uWebSockets/blob/master/misc/FAQ.md\" rel=\"nofollow noreferrer\">this page</a> where it says any specific build systems will not officially be supported. </p>\n\n<p>Any help would be appreciated. </p>\n"}, {"tags": ["javascript", "c++", "node.js", "buffer"], "comments": [{"owner": {"reputation": 625, "user_id": 2232715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyM4U.jpg?s=128&g=1", "display_name": "i9or", "link": "https://stackoverflow.com/users/2232715/i9or"}, "edited": false, "score": 0, "creation_date": 1576708112, "post_id": 59400765, "comment_id": 104990791, "body": "You&#39;ve mentioned that string should be in UTF-8. Have you tried <code>console.log(returnedValue.toString(&#39;utf8&#39;));</code>?"}, {"owner": {"reputation": 2296, "user_id": 4209136, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000376796894/picture?type=large", "display_name": "bigless", "link": "https://stackoverflow.com/users/4209136/bigless"}, "edited": false, "score": 0, "creation_date": 1576720099, "post_id": 59400765, "comment_id": 104993515, "body": "Did you tried to print that Buffer? I mean value, not a type.."}, {"owner": {"reputation": 759, "user_id": 7089884, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/FNjxV.jpg?s=128&g=1", "display_name": "DaveCat", "link": "https://stackoverflow.com/users/7089884/davecat"}, "reply_to_user": {"reputation": 625, "user_id": 2232715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyM4U.jpg?s=128&g=1", "display_name": "i9or", "link": "https://stackoverflow.com/users/2232715/i9or"}, "edited": false, "score": 0, "creation_date": 1576765573, "post_id": 59400765, "comment_id": 105010400, "body": "@igor.codes neither of these worked."}], "answers": [{"tags": [], "owner": {"reputation": 759, "user_id": 7089884, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/FNjxV.jpg?s=128&g=1", "display_name": "DaveCat", "link": "https://stackoverflow.com/users/7089884/davecat"}, "is_accepted": true, "score": 0, "last_activity_date": 1594085967, "creation_date": 1594085967, "answer_id": 62766863, "question_id": 59400765, "link": "https://stackoverflow.com/questions/59400765/converting-buffer-from-c-into-utf-8-string-in-node-js/62766863#62766863", "title": "converting buffer from C++ into utf-8 string in node.js", "body": "<p>So I know this is almost 7 months later, but I did eventually get back to finding a solution to this problem. I don't think it's ideal and am still open to better suggestions if I find one, but I found kind of a hacky way to do it. What I ended up doing was:</p>\n<ol>\n<li>Passing in an argument from the client side node.js into the server side C++</li>\n<li>Changing the value on the server side</li>\n<li>Returning that same argument.</li>\n</ol>\n<blockquote>\n<pre><code>router.post( '/returnMyStringFromCPlusPlus', ( request, response ) =&gt; { \nvar returnedValue;\ntry {\n    var returnBuf = new Buffer.alloc( 512, 0 ); // this will fill buffer with 0\n    var valueToChange = &quot;valueToChange&quot;;\n    returnedValue= serverSideCode.returnMyStringFromCPlusPlus(valueToChange);\n     ... \n     }\n</code></pre>\n</blockquote>\n<p>I would then manipulate this value on the C side and return it as a string. &lt;3</p>\n"}], "owner": {"reputation": 759, "user_id": 7089884, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/FNjxV.jpg?s=128&g=1", "display_name": "DaveCat", "link": "https://stackoverflow.com/users/7089884/davecat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 62766863, "answer_count": 1, "score": 1, "last_activity_date": 1594085967, "creation_date": 1576707648, "last_edit_date": 1576708021, "question_id": 59400765, "link": "https://stackoverflow.com/questions/59400765/converting-buffer-from-c-into-utf-8-string-in-node-js", "title": "converting buffer from C++ into utf-8 string in node.js", "body": "<p>I have server-side code written in C++ that returns a string. The client-side code is hosted in express. The client side code has calls endpoint as follows: </p>\n\n<pre><code>router.post( '/returnMyStringFromCPlusPlus', ( request, response ) =&gt; { \n    var returnedValue;\n    try {\n        var returnBuf = new Buffer.alloc( 512, 0 ); // this will fill buffer with 0\n        returnedValue= serverSideCode.returnMyStringFromCPlusPlus();\n         ... \n         }\n</code></pre>\n\n<p>When I get this returnedValue back, I see it is a buffer. I double-checked by testing:</p>\n\n<pre><code>     console.log(returnedValue instanceof buffer);\n</code></pre>\n\n<p>Which obviously returned true. The problem is I can't get that buffer into text! I've tried: </p>\n\n<p><strong>String Decoder:</strong>\n            const StringDecoder = require( \"string_decoder\" ).StringDecoder;</p>\n\n<pre><code>        const decoder = new StringDecoder( \"utf-8\" )\n\n        console.log( decoder.write( returnedValue) );\n</code></pre>\n\n<p><strong>toString():</strong></p>\n\n<pre><code>          console.log(returnedValue.toString('ascii'));\n</code></pre>\n\n<p><strong>String.fromCharCode</strong></p>\n\n<pre><code>           var printMe =  String.fromCharCode.apply(null, new Uint16Array(returnCode));\n           console.log(printMe)\n</code></pre>\n\n<p>Honestly I never really have had much luck <em>asking</em> questions on StackOverFlow and usually end up answering my own questions, but I'd be curious if any of you folks have seen this before. I have no clue how to solve this and have been doing it for over a day now. </p>\n\n<p><strong>Questions I anticipate</strong></p>\n\n<p>Using node version 11 (tried 12 and 13 as well)\nUsing x64 version of Visual Studio \nIt shouldn't matter, but the code returned from C++ is literally:</p>\n\n<pre><code>   #include &lt;string&gt;\n   string testThis()\n    {\n   string testIfThisWorks = \"TestIfThisWorks\";\n   return testIfThisWorks;\n   }\n</code></pre>\n\n<p>This is on Windows 10 </p>\n"}, {"tags": ["c++", "c++11", "minhash", "lsh"], "comments": [{"owner": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1576707876, "post_id": 59400689, "comment_id": 104990712, "body": "What type is <code>MinHashSketch</code>? If it&#39;s <code>vector&lt;uint64_t&gt;</code> the expression <code>MinHashSketch[i].at(x)</code> is illformed. This looks like a vector of vectors?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1576707944, "post_id": 59400689, "comment_id": 104990737, "body": "Do you really need to convert your numbers to strings? Can&#39;t you just hash raw bytes? As in <code>Hash_function(&amp;MinHashSketch[i][p], sizeof(uint64_t)*bsize, ...)</code> and drop the inner loop."}, {"owner": {"reputation": 459, "user_id": 4313501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881a231469bc0d8f398ecaa78f1e8b21?s=128&d=identicon&r=PG&f=1", "display_name": "SBDK8219", "link": "https://stackoverflow.com/users/4313501/sbdk8219"}, "reply_to_user": {"reputation": 7277, "user_id": 6205379, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/dPsLh.png?s=128&g=1", "display_name": "Timo", "link": "https://stackoverflow.com/users/6205379/timo"}, "edited": false, "score": 0, "creation_date": 1576709006, "post_id": 59400689, "comment_id": 104991052, "body": "@Timo Yes, it is a vector of vectors. For every element, it is a vector of 200 64-bit integers."}, {"owner": {"reputation": 459, "user_id": 4313501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881a231469bc0d8f398ecaa78f1e8b21?s=128&d=identicon&r=PG&f=1", "display_name": "SBDK8219", "link": "https://stackoverflow.com/users/4313501/sbdk8219"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1576709246, "post_id": 59400689, "comment_id": 104991120, "body": "@IgorTandetnik Thanks!! I will try that. I was doing it differently, bt had some syntax error."}, {"owner": {"reputation": 459, "user_id": 4313501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881a231469bc0d8f398ecaa78f1e8b21?s=128&d=identicon&r=PG&f=1", "display_name": "SBDK8219", "link": "https://stackoverflow.com/users/4313501/sbdk8219"}, "edited": false, "score": 0, "creation_date": 1576709636, "post_id": 59400689, "comment_id": 104991262, "body": "The second parameter of hash function is <code>long unsigned int</code>. This is the error <code>error: no matching function for call to \u2018MetroHash64::Hash(__gnu_cxx::__alloc_traits&lt;std::allocator&lt;&zwnj;&#8203;long unsigned int&gt; &gt;::value_type*, long unsigned int, uint8_t*, int)\u2019</code>"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1576710141, "post_id": 59400689, "comment_id": 104991405, "body": "Cast the first parameter to <code>uint8_t*</code>, same as you are doing now."}, {"owner": {"reputation": 459, "user_id": 4313501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881a231469bc0d8f398ecaa78f1e8b21?s=128&d=identicon&r=PG&f=1", "display_name": "SBDK8219", "link": "https://stackoverflow.com/users/4313501/sbdk8219"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1576711126, "post_id": 59400689, "comment_id": 104991660, "body": "Thanks @IgorTandetnik !! It worked fine now. It did improve a little bit. It seems I need to work on the other parts of the code."}], "owner": {"reputation": 459, "user_id": 4313501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881a231469bc0d8f398ecaa78f1e8b21?s=128&d=identicon&r=PG&f=1", "display_name": "SBDK8219", "link": "https://stackoverflow.com/users/4313501/sbdk8219"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576707268, "creation_date": 1576707268, "question_id": 59400689, "link": "https://stackoverflow.com/questions/59400689/making-lsh-implementation-faster-in-c11", "title": "making LSH implementation faster in C++11", "body": "<p>I am implementing minhash and LSH for similarity search for some string elements in C++11. The minhash sketch for my implementation is a vector of 200 64-bit integers i.e. <code>vector&lt;uint64_t&gt; MinHashSketch</code>. I have more than 2 million entries and the sketch generation portion does not take much time. But, the bucketing stage takes a long time. I am wondering if I can get some suggestions to make it a bit faster. Following is my bucketing stage using LSH.</p>\n\n<p>I am taking consecutive elements in the sketch to create a hash which becomes bucket id. If <code>bsize = 5</code>, then <code>1-5, 6-10, 11-15, ... 196-200</code> elements in <code>MinHashSketch[i]</code> (for ith element) forms the bucket ids. Following the piece of code that does that.</p>\n\n<pre><code>for (int p = 0; p &lt; 200; p += bsize) {  //bsize = 5\n  string s = \"\"; \n  for(int x = p; x &lt; (p+bsize); x++){\n    s = s + to_string(MinHashSketch[i].at(x)); // ith element \n  }       \n  uint64_t hash1 = 0;  // bucket id\n  Hash_function ((uint8_t*)s.c_str(), s.length(), (uint8_t *)&amp;hash1, 0);\n  ........\n  ........\n}\n</code></pre>\n"}, {"tags": ["c++", "clangd"], "comments": [{"owner": {"reputation": 1644, "user_id": 188326, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3200c29df2b74c6e343b66706bf9ef6a?s=128&d=identicon&r=PG", "display_name": "solotim", "link": "https://stackoverflow.com/users/188326/solotim"}, "edited": false, "score": 0, "creation_date": 1577862986, "post_id": 59400514, "comment_id": 105270127, "body": "Nothing. How can we close this question? I eventually found out that I feed some additional arguments to clang-check to help it understand the header path of specific g++ version, and the same thing was not done for clangd. After I move the compile options to <code>compile_database.json</code>, things are looking right."}], "owner": {"reputation": 1644, "user_id": 188326, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3200c29df2b74c6e343b66706bf9ef6a?s=128&d=identicon&r=PG", "display_name": "solotim", "link": "https://stackoverflow.com/users/188326/solotim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576706665, "creation_date": 1576706277, "last_edit_date": 1576706665, "question_id": 59400514, "link": "https://stackoverflow.com/questions/59400514/what-makes-the-error-message-of-clangd-and-clang-check-different", "title": "What makes the error message of clangd and clang-check different?", "body": "<p>I've been using <code>clang-check</code> in my vim for C++ syntax check for many years. Recently I want to switch to <code>clangd</code>, which is supposed to be faster. They all work well based on my <code>compile_database.json</code>, but <code>clangd</code> frequently gives bogus error messages such as can't \"understand\" friend keyword, or can't \"understand\" the overloaded methods. Does anyone know what could be the reason? </p>\n\n<p>Note that both of <code>clang-check</code> and <code>clangd</code> are from the same llvm8.0 build.</p>\n"}, {"tags": ["c++", "string", "byte", "shellcode"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1576704649, "post_id": 59400197, "comment_id": 104989567, "body": "Why are you using a string in the first place? vector of chars (or the plain array) would just work."}, {"owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1576704677, "post_id": 59400197, "comment_id": 104989573, "body": "Could you provide an example? I am new to c++."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1576704684, "post_id": 59400197, "comment_id": 104989579, "body": "Why do you want an array? The string already uses an array under the hood. If you want a pointer to the underlying array, use <code>.c_str()</code> (read-only) or <code>.data()</code> (read/write)."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1576704758, "post_id": 59400197, "comment_id": 104989609, "body": "@asrdelinx: your second example is perfectly valid C++. (Although <code>unit8_t</code> or <code>std::byte</code> would be &quot;better&quot; than unsigned char)"}, {"owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "edited": false, "score": 0, "creation_date": 1576705544, "post_id": 59400197, "comment_id": 104989862, "body": "I&#39;ll add what I&#39;ve attempted to give more context."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1576706195, "post_id": 59400197, "comment_id": 104990094, "body": "@asrdelinx -- HolyBlackCat has a valid point.  Why do you need to convert this to an unsigned char array?   The array you&#39;re looking for is already there -- why the unnecessary trip of creating an <code>unsigned char</code> array?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576706272, "post_id": 59400197, "comment_id": 104990115, "body": "How is <code>sc</code> initialized in your real application? The first line of code you shared won&#39;t work. It&#39;s hard to know where to start answering this question because it&#39;s unclear up to which point your code works."}, {"owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "edited": false, "score": 0, "creation_date": 1576706533, "post_id": 59400197, "comment_id": 104990205, "body": "Because I&#39;m sending the shellcode over the network and it&#39;s being stored in the string sc so I need to convert it to unsigned char array to allocate memory and execute it."}, {"owner": {"reputation": 656, "user_id": 4329824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/qJJob.png?s=128&g=1", "display_name": "DHerls", "link": "https://stackoverflow.com/users/4329824/dherls"}, "edited": false, "score": 0, "creation_date": 1576707017, "post_id": 59400197, "comment_id": 104990381, "body": "Your example 1 snippet is working.  When you use %s, printf will try to convery everything in the array to unicode, which is the symbols you are seeing."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1576707050, "post_id": 59400197, "comment_id": 104990391, "body": "@asrdelinx -- What do you mean by &quot;to allocate memory&quot;?  Your example shows no memory allocation.  It shows an unnecessary need to convert to an <code>unsigned char</code> array."}, {"owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "edited": false, "score": 0, "creation_date": 1576707524, "post_id": 59400197, "comment_id": 104990565, "body": "The purpose of the sc string is to convert into unsigned char array and use a shellcode injection technique (either function pointer or virtual alloc) to execute the converted sc shellcode payload."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1576709026, "post_id": 59400197, "comment_id": 104991058, "body": "<code>std::string sc = &quot;\\xfc\\xe8\\x82&quot;;</code> and <code>unsigned char buf[] = &quot;\\xfc\\xe8\\x82&quot;;</code> are literally the <i>exact same bytes</i> in memory, so a simple <code>memcpy()</code> or <code>strncpy()</code> or <code>std::copy()</code> will work, or you can type-cast the <code>(const) char*</code> pointer from <code>sc.c_str()</code>/<code>sc.data()</code> to <code>(const) unsigned char*</code>. But I suspect your <code>string</code> really contains <code>&quot;\\\\xfc\\\\xe8\\\\x82&quot;</code> (bytes <code>5C 78 66 63 5C 78 65 38 5C 78 38 32</code>) not <code>&quot;\\xfc\\xe8\\x82&quot;</code> (bytes <code>FC E8 82</code>). If so, then you need to <i>parse</i> the individual <code>\\xHH</code> sequences from the <code>string</code> data, such as with <code>sscanf()</code> or <code>std::istringstream</code>."}, {"owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "edited": false, "score": 0, "creation_date": 1576710700, "post_id": 59400197, "comment_id": 104991564, "body": "You&#39;re correct they are in \\\\x00\\\\x00 format I just discovered that."}], "answers": [{"tags": [], "owner": {"reputation": 7744, "user_id": 9666018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2959ed405ad18cbca6aa3efe01bc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Armin Montigny", "link": "https://stackoverflow.com/users/9666018/armin-montigny"}, "is_accepted": true, "score": 0, "last_activity_date": 1576766066, "last_edit_date": 1576766066, "creation_date": 1576765215, "answer_id": 59411585, "question_id": 59400197, "link": "https://stackoverflow.com/questions/59400197/convert-string-in-x00-x00-x00-format-to-unsigned-char-array/59411585#59411585", "title": "Convert string in &#39;\\\\x00\\\\x00\\\\x00&#39; format to unsigned char array", "body": "<p>The literal <code>\"\\\\xfc\\\\xe8\\\\x82\"</code> as a string uses \"\\\" as an escape character.  \"\\\\\" will be reduced to \"\\\". As you would expect. So, if you print your given <code>std::string</code>, then the result will be:\n<code>\\xfc\\xe8\\x82</code>.</p>\n\n<p>So, what you want to do now is: Create a char array containing those hex values, given in the original <code>std::string</code>.</p>\n\n<p>Please note: Your statement <code>char s[] = \"\\xfc\\xe8\\x82\";</code> will create a C-Style array of char, with the size 4 and containing:</p>\n\n<pre><code>s[0]=fc, s[1]=e8, s[2]=82, s[3]=0\n</code></pre>\n\n<p>In the example below I show 2 proposals for conversion. \n 1. Straight forward conversion\n 2. Using C++ standard algorithms</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;regex&gt;\n#include &lt;vector&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt;\n\n\n// Hex digit String\nstd::regex hexValue{R\"(\\\\[xX]([0-9a-fA-F][0-9a-fA-F]))\"};\n\n\nint main ()\n{   \n    // Source string\n    std::string s1 = \"\\\\xfc\\\\xe8\\\\x82\";\n    std::cout &lt;&lt; \"s 1: \" &lt;&lt; s1 &lt;&lt; \"\\n\";\n\n\n    // Proposal 1 ------------------------------------------------------\n\n    // Target array\n    unsigned char s2[3];\n\n    // Convert bytes from strings\n    for (int i=0; i&lt;s1.size()/4; ++i ) {\n\n        // Do conversion. Isolate substring, the convert\n        s2[i] = std::strtoul(s1.substr(i*4+2,2).c_str(), nullptr,16);\n        // Result is now in s2\n\n        // Output value as tring and decimal value\n        std::cout &lt;&lt; s1.substr(i*4+2,2) &lt;&lt; \" -&gt; \" &lt;&lt; std::hex &lt;&lt; static_cast &lt;unsigned short&gt;(s2[i]) \n                  &lt;&lt; \" -&gt; \" &lt;&lt; std::dec &lt;&lt; static_cast &lt;unsigned short&gt;(s2[i]) &lt;&lt; \"\\n\";\n    }\n\n    // Proposal 2 ------------------------------------------------------\n\n    // Get the tokens\n    std::vector&lt;std::string&gt; vstr(std::sregex_token_iterator(s1.begin(),s1.end(),hexValue, 1), {});\n\n    // Convert to unsigned int\n    std::vector&lt;unsigned int&gt; vals{};\n\n    std::transform(vstr.begin(), vstr.end(), std::back_inserter(vals), \n        [](std::string &amp;s){ return static_cast&lt;unsigned&gt;(std::strtoul(s.c_str(), nullptr,16)); } );\n\n    // Print output on std::cout\n    std::copy(vals.begin(), vals.end(), std::ostream_iterator&lt;unsigned&gt;(std::cout,\"\\n\"));\n\n    return 0;\n}\n</code></pre>\n\n<p>The second solution will eat any number of hex numbers given in a string</p>\n"}], "owner": {"reputation": 5, "user_id": 12561260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dfcd5b071e92f007711029f3d84907e?s=128&d=identicon&r=PG&f=1", "display_name": "asr delinx", "link": "https://stackoverflow.com/users/12561260/asr-delinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 59411585, "answer_count": 1, "score": 0, "last_activity_date": 1576766066, "creation_date": 1576704336, "last_edit_date": 1576710716, "question_id": 59400197, "link": "https://stackoverflow.com/questions/59400197/convert-string-in-x00-x00-x00-format-to-unsigned-char-array", "title": "Convert string in &#39;\\\\x00\\\\x00\\\\x00&#39; format to unsigned char array", "body": "<p>Say I have a string as so:</p>\n\n<pre><code>std::string sc = \"\\\\xfc\\\\xe8\\\\x82\";\n</code></pre>\n\n<p>how could I convert the sc string into the equivalent of</p>\n\n<pre><code> unsigned char buf[] = \"\\xfc\\xe8\\x82\";\n</code></pre>\n\n<p>I'm trying to convert a string containing shellcode into a unsigned char array.</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>char buf[5120];\nstrncpy(buf, sc.c_str(), sizeof(buf));\nbuf[sizeof(buf) - 1] = 0;\n</code></pre>\n\n<p>This seems to store strings into the char array I need the char array to store/represent bytes.</p>\n\n<p>When I print:</p>\n\n<pre><code>//example 1\nunsigned char buf[] = \"\\xfc\\xe8\\x82\";\nprintf(\"%s\", buf);\n</code></pre>\n\n<p>The console outputs:</p>\n\n<pre><code>\u207f\u03a6\u00e9\n</code></pre>\n\n<p>When I print:</p>\n\n<pre><code>//example 2\nchar buf[5120];\nstrncpy(buf, sc.c_str(), sizeof(buf));\nbuf[sizeof(buf) - 1] = 0;\n</code></pre>\n\n<p>The Console outputs:</p>\n\n<pre><code>\\xfc\\xe8\\x82\n</code></pre>\n\n<p>How do I convert the sc string into a unsigned char array so that when sc is printed sc will produce the same output of example 1.</p>\n"}, {"tags": ["c++", "c++11", "valgrind", "shared-ptr"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576705970, "post_id": 59400320, "comment_id": 104990016, "body": "Thx, I see what is happening. Redefining the operator= so the data_ assignment occurs before the next_ assignment work as a fix but is there any other way (maybe cleaner)?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576706183, "post_id": 59400320, "comment_id": 104990090, "body": "What are you trying to achieve? With this approach, if you have a linked list like <code>head-&gt;A-&gt;B-&gt;C-&gt;D</code> and you assign <code>*head = *C;</code>, you&#39;ll end up with the list <code>head-&gt;D</code>; nodes <code>A</code>, <code>B</code> and <code>C</code> will all be destroyed. Is this what you want?"}, {"owner": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576706462, "post_id": 59400320, "comment_id": 104990172, "body": "I am just trying to implement a singly linked list. I used head in my example but the idea was just to remove any node (head in this case). So it would be head-&gt;A-&gt;B and if I give A to delete I should have head-&gt;B"}, {"owner": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576706745, "post_id": 59400320, "comment_id": 104990289, "body": "sorry I didn&#39;t explain properly. I am trying to write a function that would take a shared_ptr to a node in order to delete it. So I have to make sure that the previous one is now pointing to the next one. so given this list head-&gt;A-&gt;B if I pass the shared_ptr to A to my function the list should be head-&gt;B in the end"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576706842, "post_id": 59400320, "comment_id": 104990330, "body": "Normally, you would delete a node by doing <code>previous_node-&gt;next_ = this_node-&gt;next_</code>. I&#39;m not sure why you are trying to assign whole nodes."}, {"owner": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576706997, "post_id": 59400320, "comment_id": 104990370, "body": "since it&#39;s a singly linked list I don&#39;t have access to my previous node, on to the on to delete (and the next one of course)"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "reply_to_user": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576707516, "post_id": 59400320, "comment_id": 104990561, "body": "Ah, I think I understand what you are trying to do. To &quot;delete&quot; a given node, you copy the data over from the next node, then delete that next node. That would work for everything except the very last node, of course."}, {"owner": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "edited": false, "score": 0, "creation_date": 1576707663, "post_id": 59400320, "comment_id": 104990623, "body": "Yes, that is what I am trying to do. And yes indeed it won&#39;t work for the last node."}], "tags": [], "owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "is_accepted": true, "score": 1, "last_activity_date": 1576705425, "last_edit_date": 1576705425, "creation_date": 1576705116, "answer_id": 59400320, "question_id": 59400180, "link": "https://stackoverflow.com/questions/59400180/valgrind-report-read-error-on-operator-with-nested-shared-ptrs/59400320#59400320", "title": "Valgrind report read error on =operator with nested shared_ptrs", "body": "<p>The implicitly defined assignment operator looks like this:</p>\n\n<pre><code>SLLNode&amp; SLLNode::operator=(const SLLNode&amp; other) {\n  next_ = other.next_;\n  data_ = other.data_;\n  return *this;\n}\n</code></pre>\n\n<p>In your example, <code>other</code> is <code>SLLNode(2)</code>, and it's only kept alive by a reference from <code>head-&gt;next_</code>. <code>other.next_</code> is <code>NULL</code>.</p>\n\n<p>The first assignment above sets <code>head-&gt;next_</code> to <code>NULL</code>, which causes <code>SLLNode(2)</code> to be destroyed, and leaves <code>other</code> a dangling reference. The next line exhibits undefined behavior by way of accessing an object after its lifetime has ended.</p>\n"}], "owner": {"reputation": 69, "user_id": 4584515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f7077183b247dfa7285066525e47831?s=128&d=identicon&r=PG&f=1", "display_name": "Snemed", "link": "https://stackoverflow.com/users/4584515/snemed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 59400320, "answer_count": 1, "score": 0, "last_activity_date": 1576705425, "creation_date": 1576704260, "last_edit_date": 1576704903, "question_id": 59400180, "link": "https://stackoverflow.com/questions/59400180/valgrind-report-read-error-on-operator-with-nested-shared-ptrs", "title": "Valgrind report read error on =operator with nested shared_ptrs", "body": "<p>I have this simple code</p>\n\n<pre><code>#include&lt;memory&gt;\n\nclass SLLNode{\n        public:\n                SLLNode(const int&amp; d){\n                        data_ = d;\n                }\n                std::shared_ptr&lt;SLLNode&gt; next_;\n                int data_;\n};\n\nint main(){\n\n        std::shared_ptr&lt;SLLNode&gt; head(new SLLNode(1));\n        head-&gt;next_.reset(new SLLNode(2));\n        *head = *(head-&gt;next_);\n        return 0;\n}\n</code></pre>\n\n<p>Valgrind is complaining about invalid read in my case.</p>\n\n<pre><code>==17312== Invalid read of size 4\n==17312==    at 0x108EF3: SLLNode::operator=(SLLNode const&amp;) (test_shared_ptr.cpp:3)\n==17312==    by 0x108DA3: main (test_shared_ptr.cpp:16)\n==17312==  Address 0x5b7dd50 is 16 bytes inside a block of size 24 free'd\n==17312==    at 0x4C3123B: operator delete(void*) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==17312==    by 0x109511: std::_Sp_counted_ptr&lt;SLLNode*, (__gnu_cxx::_Lock_policy)2&gt;::_M_dispose() (shared_ptr_base.h:376)\n==17312==    by 0x1090DF: std::_Sp_counted_base&lt;(__gnu_cxx::_Lock_policy)2&gt;::_M_release() (shared_ptr_base.h:154)\n==17312==    by 0x109061: std::__shared_count&lt;(__gnu_cxx::_Lock_policy)2&gt;::operator=(std::__shared_count&lt;(__gnu_cxx::_Lock_policy)2&gt; const&amp;) (shared_ptr_base.h:703)\n==17312==    by 0x108E9A: std::__shared_ptr&lt;SLLNode, (__gnu_cxx::_Lock_policy)2&gt;::operator=(std::__shared_ptr&lt;SLLNode, (__gnu_cxx::_Lock_policy)2&gt; const&amp;) (shared_ptr_base.h:1034)\n==17312==    by 0x108EC4: std::shared_ptr&lt;SLLNode&gt;::operator=(std::shared_ptr&lt;SLLNode&gt; const&amp;) (shared_ptr.h:93)\n==17312==    by 0x108EEE: SLLNode::operator=(SLLNode const&amp;) (test_shared_ptr.cpp:3)\n==17312==    by 0x108DA3: main (test_shared_ptr.cpp:16)\n==17312==  Block was alloc'd at\n==17312==    at 0x4C3017F: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==17312==    by 0x108D5C: main (test_shared_ptr.cpp:15)\n</code></pre>\n\n<p>The command I use is:</p>\n\n<pre><code>valgrind --tool=memcheck ./test_shared_ptr\n</code></pre>\n\n<p>The =operator seems to cause this issue only when I use nested shared_ptr.\nI was expecting the data from the ptr head to be released and replace by the one from the ptr head.next_, but it appears that something else is happening since I have this invalid read.\nI want to replace the data pointed by head (and not head itself) since this head ptr could be a copy of another shared_ptr of head.</p>\n"}, {"tags": ["c++", "encryption", "cryptography"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1576708611, "post_id": 59400062, "comment_id": 104990937, "body": "Anything change if you use binary file access?"}, {"owner": {"reputation": 1, "user_id": 12561197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b3d03b5cc548b8ab4c07c512acba19?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/12561197/alexey"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1576709888, "post_id": 59400062, "comment_id": 104991334, "body": "Tried it now, nothing has changed."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1576717742, "post_id": 59400062, "comment_id": 104993077, "body": "I presume you don&#39;t receive any errors? Because you seem to keep progressing through your code <i>even if</i> an error occurs."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1576718066, "post_id": 59400062, "comment_id": 104993154, "body": "Programming is the art of problem decomposition, where are your methods? What did you try to debug your problem?"}, {"owner": {"reputation": 1, "user_id": 12561197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b3d03b5cc548b8ab4c07c512acba19?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/12561197/alexey"}, "edited": false, "score": 0, "creation_date": 1576748275, "post_id": 59400062, "comment_id": 105001634, "body": "There were no obvious errors, you&#39;re right. I tried to debug the program with a debugger, but it did not give results, at the return of the BCryptEncrypt function, garbage is written to the array."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8085302, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209278444133697/picture?type=large", "display_name": "Shurik Kravchenko", "link": "https://stackoverflow.com/users/8085302/shurik-kravchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1578419830, "last_edit_date": 1578419830, "creation_date": 1578410390, "answer_id": 59631243, "question_id": 59400062, "link": "https://stackoverflow.com/questions/59400062/cng-aes-incorrectly-decryptedpossibly-encrypted-file/59631243#59631243", "title": "CNG. AES. Incorrectly decrypted(possibly encrypted) file", "body": "<p>I'm studying it too right now. I'm able to crypt a file, but then I can't decrypt it!</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;bcrypt.h&gt;\n#pragma comment(lib, \"bcrypt.lib\")\n\n#define NT_SUCCESS(Status)          (((NTSTATUS)(Status)) &gt;= 0)\n\n#define STATUS_UNSUCCESSFUL         ((NTSTATUS)0xC0000001L)\n\n#define DATA_TO_ENCRYPT  \"Test Data\"\n\nstatic const BYTE rgbAES128Key[] =\n{\n    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,\n    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F\n};\n\nint main() {\n\n    BCRYPT_ALG_HANDLE       hAesAlg = NULL;\n    BCRYPT_KEY_HANDLE       hKey = NULL;\n    NTSTATUS                status = STATUS_UNSUCCESSFUL;\n    DWORD                   cbCipherText = 0,\n                            cbPlainText = 0,\n                            cbData = 0,\n                            cbKeyObject = 0,\n                            cbBlockLen = 0,\n                            cbBlob = 0;\n    PBYTE                   pbCipherText = NULL,\n                            pbPlainText = NULL,\n                            pbKeyObject = NULL,\n                            pbIV = NULL,\n                            pbBlob = NULL;\n    BOOL                    bResult = FALSE;\n\n    wchar_t default_key[] = L\"3igcZhRdWq96m3GUmTAiv9\";\n    wchar_t* key_str = default_key;\n\n    // Open an algorithm handle.\n    if (!NT_SUCCESS(status = BCryptOpenAlgorithmProvider(&amp;hAesAlg, BCRYPT_AES_ALGORITHM, NULL, 0)))\n    {\n        wprintf(L\"**** Error 0x%x returned by BCryptOpenAlgorithmProvider\\n\", status);\n        return 0;\n    }\n\n    // Calculate the size of the buffer to hold the KeyObject.\n    if (!NT_SUCCESS(status = BCryptGetProperty(hAesAlg, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbKeyObject, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        wprintf(L\"**** Error 0x%x returned by BCryptGetProperty\\n\", status);\n        return 0;\n    }\n\n    // Allocate the key object on the heap.\n    pbKeyObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbKeyObject);\n    if (NULL == pbKeyObject)\n    {\n        wprintf(L\"**** memory allocation failed\\n\");\n        return 0;\n    }\n\n    // Generate the key from supplied input key bytes.\n    if (!NT_SUCCESS(status = BCryptGenerateSymmetricKey(hAesAlg, &amp;hKey, pbKeyObject, cbKeyObject, (PBYTE)rgbAES128Key, sizeof(rgbAES128Key), 0)))\n    {\n        wprintf(L\"**** Error 0x%x returned by BCryptGenerateSymmetricKey\\n\", status);\n        return 0;\n    }\n\n    // Save another copy of the key for later.\n    if (!NT_SUCCESS(status = BCryptExportKey(hKey, NULL, BCRYPT_OPAQUE_KEY_BLOB, NULL, 0, &amp;cbBlob, 0)))\n    {\n        wprintf(L\"**** Error 0x%x returned by BCryptExportKey\\n\", status);\n        return 0;\n    }\n\n    // Allocate the buffer to hold the BLOB.\n    pbBlob = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbBlob);\n    if (NULL == pbBlob)\n    {\n        wprintf(L\"**** memory allocation failed\\n\");\n        return 0;\n    }\n\n    if (!NT_SUCCESS(status = BCryptExportKey(\n        hKey,\n        NULL,\n        BCRYPT_OPAQUE_KEY_BLOB,\n        pbBlob,\n        cbBlob,\n        &amp;cbBlob,\n        0)))\n    {\n        wprintf(L\"**** Error 0x%x returned by BCryptExportKey\\n\", status);\n        return 0;\n    }\n\n\n\n\n    HANDLE hInpFile = CreateFileA(\"C:\\\\LOL\\\\file_1.encrypted\", GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_FLAG_SEQUENTIAL_SCAN, NULL);\n    if (hInpFile == INVALID_HANDLE_VALUE) {\n        printf(\"Cannot open input file!\\n\");\n        system(\"pause\");\n        return 0;\n    }\n    HANDLE hOutFile = CreateFileA(\"C:\\\\LOL\\\\file_1_decrypted.txt\", GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);\n    if (hOutFile == INVALID_HANDLE_VALUE) {\n        printf(\"Cannot open output file!\\n\");\n        system(\"pause\");\n        return 0;\n    }\n\n    const size_t chunk_size = 48;\n    BYTE chunk[chunk_size] = { 0 };\n    DWORD out_len = 0;\n\n    BOOL isFinal = FALSE;\n    DWORD readTotalSize = 0;\n\n    DWORD inputSize = GetFileSize(hInpFile, NULL);\n    while (bResult = ReadFile(hInpFile, chunk, chunk_size, &amp;out_len, NULL)) {\n        if (0 == out_len) {\n            break;\n        }\n        readTotalSize += out_len;\n        if (readTotalSize == inputSize) {\n            isFinal = TRUE;\n            printf(\"Final chunk set.\\n\");\n        }\n\n        //\n        // Get the output buffer size.\n        //\n        if (!NT_SUCCESS(status = BCryptDecrypt(hKey, chunk, chunk_size, NULL, NULL, NULL, NULL, 0, &amp;cbCipherText, BCRYPT_BLOCK_PADDING)))\n        {\n            wprintf(L\"**** 1 Error 0x%x returned by BCryptEncrypt\\n\", status);\n            return 0;\n        }\n\n        pbCipherText = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbCipherText);\n        if (NULL == pbCipherText)\n        {\n            wprintf(L\"**** memory allocation failed\\n\");\n            return 0;\n        }\n\n        // Use the key to encrypt the plaintext buffer.\n        // For block sized messages, block padding will add an extra block.\n        if (!NT_SUCCESS(status = BCryptDecrypt(hKey, chunk, chunk_size, NULL, NULL, NULL, pbCipherText, cbCipherText, &amp;cbCipherText, BCRYPT_BLOCK_PADDING)))\n        {\n            wprintf(L\"**** 2 Error 0x%x returned by BCryptEncrypt\\n\", status);\n            return 0;\n        }\n\n        if (!WriteFile(hOutFile, pbCipherText, cbCipherText, &amp;cbData, NULL)) {\n            printf(\"writing failed!\\n\");\n            break;\n        }\n    }\n\n}\n</code></pre>\n\n<p>The main change is the function name, from <code>BCryptEncrypt</code> to <code>BCryptDerypt</code>.\nAlso, the file names.</p>\n\n<p>When I change to Decrypt, Irecieve \"</p>\n\n<blockquote>\n  <p>**** 2 Error\" error...</p>\n</blockquote>\n\n<p>That's strange, because I use the same method, the same key...</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8085302, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209278444133697/picture?type=large", "display_name": "Shurik Kravchenko", "link": "https://stackoverflow.com/users/8085302/shurik-kravchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1578412063, "last_edit_date": 1578412063, "creation_date": 1578411743, "answer_id": 59631593, "question_id": 59400062, "link": "https://stackoverflow.com/questions/59400062/cng-aes-incorrectly-decryptedpossibly-encrypted-file/59631593#59631593", "title": "CNG. AES. Incorrectly decrypted(possibly encrypted) file", "body": "<p>I have solved your problem, on the last two lines (206,215) change <strong>BCryptEncrypt</strong> to <strong>BCryptDecrypt</strong></p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;windows.h&gt;\n#include &lt;wincrypt.h&gt;\n#include &lt;bcrypt.h&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;tchar.h&gt;\n#pragma comment(lib, \"bcrypt.lib\")\n\nusing namespace std;\n\nint main(int argc, char* argv[])\n{\n    const int blockSize = 64;\n    const int buffSize = 512;\n    DWORD cbHashObject = 0, cbData = 0, cbKeyObject = 0, cbKeyData = 0, cbBlockLen = 0, cbCipherData = 0, cbPlainData = 0, cbBlob = 0;\n    PBYTE pbHashObject = NULL;\n    PBYTE pbKeyObject = NULL;\n    BCRYPT_ALG_HANDLE hAlg;\n    BCRYPT_HASH_HANDLE hHashB;\n    BCRYPT_KEY_HANDLE hKey;\n    NTSTATUS status;\n    PBYTE pbHash, pbIV, pbBlob = NULL;\n    PBYTE pbPlainData = NULL, pbCipherData = NULL;\n\n    BYTE* password = (BYTE*)\"pass\";\n\n    char* buff = new char[buffSize + 1];\n\n\n    if (!BCRYPT_SUCCESS(status = BCryptOpenAlgorithmProvider(&amp;hAlg, BCRYPT_SHA512_ALGORITHM, NULL, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR1 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbHashObject, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR2 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbHashObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbHashObject);\n\n    if (!BCRYPT_SUCCESS(status = BCryptCreateHash(hAlg, &amp;hHashB, pbHashObject, cbHashObject, NULL, 0, 0)))\n    {\n\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR3 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    ZeroMemory(buff, buffSize + 1);\n    if (!BCRYPT_SUCCESS(status = BCryptHashData(hHashB, (PBYTE)password, strlen((char*)password) * sizeof(BYTE), 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR5 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    cbHashObject = 0, cbData = 0;\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_HASH_LENGTH, (PBYTE)&amp;cbHashObject, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR6 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbHash = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbHashObject);\n\n    if (!BCRYPT_SUCCESS(status = BCryptFinishHash(hHashB, pbHash, cbHashObject, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR7 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    char* str_hash = new char[cbHashObject * 2 + 1];\n\n    for (int i = 0; i &lt; cbHashObject; i++)\n        sprintf(str_hash + 2 * i, \"%02X\", pbHash[i]);\n\n    cout &lt;&lt; \"PASSWORD SHA512 = \" &lt;&lt; str_hash &lt;&lt; endl &lt;&lt; endl;\n\n    ZeroMemory(str_hash, cbHashObject);\n    if (!BCRYPT_SUCCESS(status = BCryptDestroyHash(hHashB)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR8 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptCloseAlgorithmProvider(hAlg, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR9 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptOpenAlgorithmProvider(&amp;hAlg, BCRYPT_AES_ALGORITHM, NULL, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR10 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbKeyObject, sizeof(DWORD), &amp;cbKeyData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR11 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptSetProperty(hAlg, BCRYPT_CHAINING_MODE, (PBYTE)BCRYPT_CHAIN_MODE_CBC, sizeof(BCRYPT_CHAIN_MODE_CBC), 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR12 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbKeyObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbKeyObject);\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_BLOCK_LENGTH, (PBYTE)&amp;cbBlockLen, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR13 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbIV = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbBlockLen + 1);\n    for (int i(0); i &lt; cbBlockLen; i++)\n    {\n        //pbIV[i]=rand();\n        pbIV[i] = 0xAA;\n    }\n\n    for (int i = 0; i &lt; cbBlockLen; i++)\n        sprintf(str_hash + 2 * i, \"%02X\", pbIV[i]);\n\n    std::cout &lt;&lt; \"\\n\\nIV = \" &lt;&lt; str_hash;\n\n    if (!BCRYPT_SUCCESS(status = BCryptGenerateSymmetricKey(hAlg, &amp;hKey, pbKeyObject, cbKeyObject, pbHash, cbHashObject, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR14 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptExportKey(hKey, NULL, BCRYPT_OPAQUE_KEY_BLOB, NULL, 0, &amp;cbBlob, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR15 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbBlob = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbBlob);\n\n    if (!BCRYPT_SUCCESS(status = BCryptExportKey(hKey, NULL, BCRYPT_OPAQUE_KEY_BLOB, pbBlob, cbBlob, &amp;cbBlob, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR16 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    ifstream f1(\"C:\\\\LOL\\\\1.txt\");\n    ofstream f2(\"C:\\\\LOL\\\\2.txt\", ios_base::trunc);\n\n    pbPlainData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, blockSize + 1);\n    ZeroMemory(pbPlainData, blockSize + 1);\n    f1.read((char*)pbPlainData, blockSize);\n\n    if (!BCRYPT_SUCCESS(status = BCryptEncrypt(hKey, (BYTE*)pbPlainData, blockSize, NULL, 0, NULL, NULL, 0, &amp;cbCipherData, BCRYPT_BLOCK_PADDING)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR15 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbCipherData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbCipherData + 1);\n    ZeroMemory(pbCipherData, cbCipherData + 1);\n\n    do {\n        if (!BCRYPT_SUCCESS(status = BCryptEncrypt(hKey, (BYTE*)pbPlainData, blockSize, NULL, 0, NULL, (BYTE*)pbCipherData, cbCipherData, &amp;cbData, BCRYPT_BLOCK_PADDING)))\n        {\n            DWORD dwErr = GetLastError();\n            std::cout &lt;&lt; \"ERROR17 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; dwErr;\n        }\n        f2.write((char*)pbCipherData, cbData);\n        f2.flush();\n        f1.read((char*)pbPlainData, blockSize);\n    } while (!f1.eof());\n    f1.close();\n    f2.close();\n\n    BCryptDestroyKey(hKey);\n\n    HeapFree(GetProcessHeap(), 0, pbPlainData);\n    HeapFree(GetProcessHeap(), 0, pbCipherData);\n    pbPlainData = NULL;\n    pbCipherData = NULL;\n\n    memset(pbIV, 0xAA, cbBlockLen);\n    memset(pbKeyObject, 0, cbKeyObject);\n\n\n    if (!BCRYPT_SUCCESS(status = BCryptImportKey(hAlg, NULL, BCRYPT_OPAQUE_KEY_BLOB, &amp;hKey, pbKeyObject, cbKeyObject, pbBlob, cbBlob, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR18 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    ifstream f3(\"C:\\\\LOL\\\\2.txt\");\n    ofstream f4(\"C:\\\\LOL\\\\3.txt\", ios_base::trunc);\n\n    pbCipherData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, blockSize + 1);\n    ZeroMemory(pbCipherData, blockSize + 1);\n    f3.read((char*)pbCipherData, blockSize);\n\n    if (!BCRYPT_SUCCESS(status = BCryptDecrypt(hKey, (BYTE*)pbCipherData, blockSize, NULL, NULL, 0, NULL, 0, &amp;cbPlainData, BCRYPT_BLOCK_PADDING)))\n    {\n        DWORD dwErr = GetLastError();\n        std::cout &lt;&lt; \"ERROR19 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n    pbPlainData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbPlainData);\n    ZeroMemory(pbPlainData, cbPlainData);\n\n    do {\n        if (!BCRYPT_SUCCESS(status = BCryptDecrypt(hKey, (BYTE*)pbCipherData, blockSize, NULL, NULL, 0, (BYTE*)pbPlainData, cbPlainData, &amp;cbData, BCRYPT_BLOCK_PADDING)))\n        {\n            DWORD dwErr = GetLastError();\n            std::cout &lt;&lt; \"ERROR20 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; dwErr;\n        }\n        f4.write((char*)pbPlainData, cbData);\n        f4.flush();\n        f3.read((char*)pbCipherData, blockSize);\n    } while (!f3.eof());\n    f3.close();\n    f4.close();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12561197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b3d03b5cc548b8ab4c07c512acba19?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/12561197/alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1578419830, "creation_date": 1576703644, "last_edit_date": 1576707284, "question_id": 59400062, "link": "https://stackoverflow.com/questions/59400062/cng-aes-incorrectly-decryptedpossibly-encrypted-file", "title": "CNG. AES. Incorrectly decrypted(possibly encrypted) file", "body": "<p>I study CNG API, I try to encrypt a file and then decrypt it. To get the key I use SHA512, for AES encryption, with the following code:</p>\n\n<pre><code>#include &lt;QCoreApplication&gt;\n#include &lt;windows.h&gt;\n#include &lt;wincrypt.h&gt;\n#include &lt;bcrypt.h&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;QDebug&gt;\n#include &lt;tchar.h&gt;\n\nusing namespace std;\n\nint main(int argc, char *argv[])\n{\n    srand(time(NULL));\n    const int blockSize = 64;\n    const int buffSize = 512;\n    DWORD cbHashObject = 0, cbData = 0, cbKeyObject = 0, cbKeyData = 0, cbBlockLen = 0, cbCipherData = 0, cbPlainData = 0, cbBlob = 0;\n    PBYTE pbHashObject = NULL;\n    PBYTE pbKeyObject = NULL;\n    BCRYPT_ALG_HANDLE hAlg;\n    BCRYPT_HASH_HANDLE hHashB;\n    BCRYPT_KEY_HANDLE hKey;\n    NTSTATUS status;\n    PBYTE pbHash, pbIV, pbBlob = NULL;\n    PBYTE pbPlainData = NULL, pbCipherData = NULL;\n\n    BYTE* password = (BYTE*)\"pass\";\n\n    QCoreApplication a(argc, argv);\n    char *buff = new char[buffSize + 1];\n\n\n    if (!BCRYPT_SUCCESS(status = BCryptOpenAlgorithmProvider(&amp;hAlg, BCRYPT_SHA512_ALGORITHM, NULL, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR1 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbHashObject, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR2 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbHashObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbHashObject);\n\n    if (!BCRYPT_SUCCESS(status = BCryptCreateHash(hAlg, &amp;hHashB, pbHashObject, cbHashObject, NULL, 0, 0)))\n    {\n\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR3 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    ZeroMemory(buff, buffSize + 1);\n    if (!BCRYPT_SUCCESS(status = BCryptHashData(hHashB, (PBYTE)password, strlen((char*)password)*sizeof(BYTE), 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR5 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    cbHashObject = 0, cbData = 0;\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_HASH_LENGTH, (PBYTE)&amp;cbHashObject, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR6 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbHash = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbHashObject);\n\n    if (!BCRYPT_SUCCESS(status = BCryptFinishHash(hHashB, pbHash, cbHashObject, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR7 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    char *str_hash = new char[cbHashObject*2+1];\n\n    for(int i = 0; i &lt; cbHashObject;i++)\n        sprintf(str_hash+2*i,\"%02X\",pbHash[i]);\n\n    cout &lt;&lt; \"PASSWORD SHA512 = \" &lt;&lt;str_hash&lt;&lt; endl &lt;&lt; endl;\n\n    ZeroMemory(str_hash, cbHashObject);\n    if (!BCRYPT_SUCCESS(status = BCryptDestroyHash(hHashB)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR8 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptCloseAlgorithmProvider(hAlg, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR9 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptOpenAlgorithmProvider(&amp;hAlg, BCRYPT_AES_ALGORITHM, NULL, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR10 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if (!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_OBJECT_LENGTH, (PBYTE)&amp;cbKeyObject, sizeof(DWORD), &amp;cbKeyData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR11 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if(!BCRYPT_SUCCESS(status = BCryptSetProperty(hAlg, BCRYPT_CHAINING_MODE, (PBYTE)BCRYPT_CHAIN_MODE_CBC, sizeof(BCRYPT_CHAIN_MODE_CBC), 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR12 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbKeyObject = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbKeyObject);\n\n    if(!BCRYPT_SUCCESS(status = BCryptGetProperty(hAlg, BCRYPT_BLOCK_LENGTH, (PBYTE)&amp;cbBlockLen, sizeof(DWORD), &amp;cbData, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR13 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbIV= (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbBlockLen+1);\n    for(int i(0); i &lt; cbBlockLen; i++)\n    {\n        //pbIV[i]=rand();\n        pbIV[i]=0xAA;\n    }\n\n    for(int i = 0; i &lt; cbBlockLen ;i++)\n        sprintf(str_hash+2*i,\"%02X\",pbIV[i]);\n\n    cout &lt;&lt; \"\\n\\nIV = \" &lt;&lt; str_hash;\n\n    if(!BCRYPT_SUCCESS(status = BCryptGenerateSymmetricKey(hAlg, &amp;hKey, pbKeyObject, cbKeyObject, pbHash, cbHashObject, 0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR14 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    if(!BCRYPT_SUCCESS(status = BCryptExportKey(hKey,NULL,BCRYPT_OPAQUE_KEY_BLOB,NULL,0,&amp;cbBlob,0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR15 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbBlob = (PBYTE)HeapAlloc(GetProcessHeap (), 0, cbBlob);\n\n    if(!BCRYPT_SUCCESS(status = BCryptExportKey(hKey,NULL,BCRYPT_OPAQUE_KEY_BLOB,pbBlob,cbBlob,&amp;cbBlob,0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR16 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    ifstream f1(\"..\\\\1.txt\");\n    ofstream f2(\"..\\\\2.txt\", ios_base::trunc);\n\n    pbPlainData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, blockSize + 1);\n    ZeroMemory(pbPlainData, blockSize + 1);\n    f1.read((char*)pbPlainData, blockSize);\n\n    if(!BCRYPT_SUCCESS(status = BCryptEncrypt(hKey, (BYTE*)pbPlainData, blockSize, NULL, 0, NULL, NULL, 0, &amp;cbCipherData, BCRYPT_BLOCK_PADDING)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR15 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    pbCipherData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbCipherData + 1);\n    ZeroMemory(pbCipherData, cbCipherData + 1);\n\n    do {\n        if (!BCRYPT_SUCCESS(status = BCryptEncrypt(hKey, (BYTE*)pbPlainData, blockSize, NULL, 0, NULL, (BYTE*)pbCipherData, cbCipherData, &amp;cbData, BCRYPT_BLOCK_PADDING)))\n        {\n            DWORD dwErr = GetLastError();\n            qDebug()&lt;&lt;\"ERROR17 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; dwErr;\n        }\n        f2.write((char*)pbCipherData, cbData);\n        f2.flush();\n        f1.read((char*)pbPlainData, blockSize);\n    } while(!f1.eof());\n    f1.close();\n    f2.close();\n\n    BCryptDestroyKey(hKey);\n\n    HeapFree(GetProcessHeap(), 0, pbPlainData);\n    HeapFree(GetProcessHeap(), 0, pbCipherData);\n    pbPlainData = NULL;\n    pbCipherData = NULL;\n\n    memset(pbIV, 0xAA, cbBlockLen);\n    memset(pbKeyObject, 0 , cbKeyObject);\n\n\n    if(!BCRYPT_SUCCESS(status = BCryptImportKey(hAlg,NULL,BCRYPT_OPAQUE_KEY_BLOB,&amp;hKey,pbKeyObject,cbKeyObject,pbBlob,cbBlob,0)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR18 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n\n    ifstream f3(\"..\\\\2.txt\");\n    ofstream f4(\"..\\\\3.txt\", ios_base::trunc);\n\n    pbCipherData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, blockSize + 1);\n    ZeroMemory(pbCipherData, blockSize + 1);\n    f3.read((char*)pbCipherData, blockSize);\n\n    if(!BCRYPT_SUCCESS(status = BCryptEncrypt(hKey, (BYTE*)pbCipherData, blockSize, NULL, NULL, 0, NULL, 0, &amp;cbPlainData, BCRYPT_BLOCK_PADDING)))\n    {\n        DWORD dwErr = GetLastError();\n        qDebug()&lt;&lt;\"ERROR19 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; hex &lt;&lt; dwErr;\n    }\n    pbPlainData = (PBYTE)HeapAlloc(GetProcessHeap(), 0, cbPlainData);\n    ZeroMemory(pbPlainData, cbPlainData);\n\n    do{\n        if (!BCRYPT_SUCCESS(status = BCryptEncrypt(hKey, (BYTE*)pbCipherData, blockSize, NULL, NULL, 0, (BYTE*)pbPlainData, cbPlainData, &amp;cbData, BCRYPT_BLOCK_PADDING)))\n        {\n            DWORD dwErr = GetLastError();\n            qDebug()&lt;&lt;\"ERROR20 \" &lt;&lt; hex &lt;&lt; status &lt;&lt; \" E: \" &lt;&lt; dwErr;\n        }\n        f4.write((char*)pbPlainData, cbData);\n        f4.flush();\n        f3.read((char*)pbCipherData, blockSize);\n    }while(!f3.eof());\n    f3.close();\n    f4.close();\n    return a.exec();\n}\n</code></pre>\n\n<p>At first thought that the problem was in IV, however I removed it and nothing has changed. Here are examples: </p>\n\n<p>Before encryption(1.txt):</p>\n\n<pre><code>1234567890\n</code></pre>\n\n<p>After encryption(2.txt): </p>\n\n<pre><code>O\u201c\u0441h4W;H;7\u0422\u2020G\u0436\nq\u0457\n\u2013Jmd\u0412\u0443\u2022\u043e\u0451:s\u00b1\u00b0|k\u0414'y|\u2030\u0437XgK4\u041f\u0431\u0416l\u00a9b\u042am\u0417\u0428\u043e\u040fMfU\u00b6ysr\u2030\u0407[\u0406\u0491\u045b\u00b7\u0423:R\u0459\u0421\n</code></pre>\n\n<p>After decryption(3.txt): </p>\n\n<pre><code>\u0457\n\u2013Jmd\u0412\u0443\u2022\u043e\u0451:s_T\u2013\u0457\u044f5rJ\u2122U,\u0401\u041c\u0408\u2018\u00b5\u041c\u00ad\u0491\u04120\u0443\u0411\u0409O\u00a0\u2030Cif\u0411ZD\u0427\u0408)\u0422\u045e\u00ab\u044d\"\u045c\u043a\u0433\u0418\u0443}\u0428\u0429\u0454\u044c\u044a\u00a9\u0444b\\a[\n</code></pre>\n"}, {"tags": ["c++", "cmake", "azerothcore", "eluna-lua-engine"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 12460906, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBHIAItIlxHFJT-rPMdYElh0N9MRHjptSIA9OJdE4M=k-s128", "display_name": "Paul", "link": "https://stackoverflow.com/users/12460906/paul"}, "is_accepted": false, "score": 1, "last_activity_date": 1576786834, "creation_date": 1576786834, "answer_id": 59416452, "question_id": 59399882, "link": "https://stackoverflow.com/questions/59399882/compile-error-with-eluna-queryresult-cpp/59416452#59416452", "title": "Compile Error with Eluna - QueryResult.cpp", "body": "<p>The resolution to this problem was to 1. Properly re-run cmake, building to another folder, and copying the build files into my Azerothcore environment. Once I had done that and deleted the docker/build/cache directory, I was able to successfully compile and run.</p>\n\n<p>Hope it helps another new-to-c-person out there!</p>\n"}], "owner": {"reputation": 21, "user_id": 12460906, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBHIAItIlxHFJT-rPMdYElh0N9MRHjptSIA9OJdE4M=k-s128", "display_name": "Paul", "link": "https://stackoverflow.com/users/12460906/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577104630, "creation_date": 1576702666, "last_edit_date": 1577104630, "question_id": 59399882, "link": "https://stackoverflow.com/questions/59399882/compile-error-with-eluna-queryresult-cpp", "title": "Compile Error with Eluna - QueryResult.cpp", "body": "<p>I am running the dockerized version of the latest build.</p>\n\n<p>My issue is that when I add the <a href=\"https://github.com/azerothcore/mod-eluna-lua-engine\" rel=\"nofollow noreferrer\">mod-eluna-lua-engine</a> module, I receive the following error:</p>\n\n<pre><code>[ 16%] Building CXX object src/common/CMakeFiles/common.dir/Database/Implementation/WorldDatabase.cpp.o\n/azerothcore/src/common/Database/QueryResult.cpp:189:18: fatal error: out-of-line definition of 'GetFieldName' does not match any declaration in 'ResultSet'\nchar* ResultSet::GetFieldName(uint32 index) const\n                 ^~~~~~~~~~~~\n1 error generated.\nmake[2]: *** [src/common/CMakeFiles/common.dir/Database/QueryResult.cpp.o] Error 1\n</code></pre>\n\n<p>I've searched and haven't found any similar reports, so it has to be me, right? What is it that I am missing?</p>\n\n<p>Edit:\nRunning cmake is resulting in the following:</p>\n\n<pre><code>CMake Error at src/cmake/platform/unix/settings.cmake:22 (configure_file):\n  configure_file attempted to configure a file:\n  /mnt/wowstuff/server/cmake_uninstall.cmake into a source directory.\nCall Stack (most recent call first):\n  src/cmake/macros/CheckPlatform.cmake:15 (include)\n  CMakeLists.txt:90 (include)\n</code></pre>\n\n<p>Final edit: after properly rerunning cmake, copying the build files as needed, then deleting the build cache and rerunning acore-docker-build, the compile worked just fine.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1576702829, "post_id": 59399841, "comment_id": 104988909, "body": "Your question implies that the posted code runs but doesn&#39;t provide the desired results. However, it doesn&#39;t compile. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1576702834, "post_id": 59399841, "comment_id": 104988910, "body": "This question does not leave me with a desire to rend human flesh, but to avoid making questions that do, take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">Writing the perfect Question</a>, and <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How To Debug Small Programs</a> (to help avoid asking questions in the first place)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12552789, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kQBhQ7HoPjs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXiNCB4sisWCYvLThCFyv2lLSlpA/photo.jpg?sz=128", "display_name": "Claver", "link": "https://stackoverflow.com/users/12552789/claver"}, "edited": false, "score": 0, "creation_date": 1576704179, "post_id": 59399974, "comment_id": 104989360, "body": "Hi David, Thank you. My problem is that the &quot;Myobject&quot; class code is not visible to me. They come in a pre-compiled header and I am creating instances of them to process. Thank you for your help! I will on the object side then."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 3, "user_id": 12552789, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kQBhQ7HoPjs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXiNCB4sisWCYvLThCFyv2lLSlpA/photo.jpg?sz=128", "display_name": "Claver", "link": "https://stackoverflow.com/users/12552789/claver"}, "edited": false, "score": 0, "creation_date": 1576708884, "post_id": 59399974, "comment_id": 104991009, "body": "@Claver As a workaround, you could make the lists hold <code>std::unique_ptr&lt;MyObject&gt;</code>. That way, the swap would definitely swap the two objects without changing either of them."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 3, "last_activity_date": 1576708505, "last_edit_date": 1576708505, "creation_date": 1576703154, "answer_id": 59399974, "question_id": 59399841, "link": "https://stackoverflow.com/questions/59399841/changing-the-value-of-a-list-in-a-loop-c/59399974#59399974", "title": "Changing the value of a list in a loop C++", "body": "<p>The issue must be in code you haven't shown. The code you've shown works fine. Here's a fully-working skeleton that shows that the shown code works.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;list&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    std::list&lt;int&gt; list1;\n    std::list&lt;int&gt; list2;\n\n    list1.push_back(10);\n    list1.push_back(20);\n    list1.push_back(30);\n\n    list2.push_back(1);\n    list2.push_back(200);\n    list2.push_back(3);\n\n    std::list&lt;int&gt;::iterator iter2 = list2.begin();\n    for (auto &amp;el : list1)\n    {\n        if (iter2 == list2.end()) {break;}\n        {\n            if (el &gt; *iter2)\n            {\n                auto temp = el;\n                el = *iter2;\n                *iter2 = temp;\n            }\n            ++iter2; // The iterator moves forward;\n        }\n    }\n\n    for (auto &amp;el : list1)\n        std::cout &lt;&lt; \"l1: \" &lt;&lt; el &lt;&lt; std::endl;\n    for (auto &amp;el : list2)\n        std::cout &lt;&lt; \"l2: \" &lt;&lt; el &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576782193, "post_id": 59414847, "comment_id": 105018429, "body": "In addition to this answer, you should mark the question as solved. Since David&#39;s answer explained the problem and lead you to this solution, you should chose David&#39;s answer as correct. This helps future programmers with a similar problem find these answers. Who wants to click on a question with no right answers?"}, {"owner": {"reputation": 3, "user_id": 12552789, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kQBhQ7HoPjs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXiNCB4sisWCYvLThCFyv2lLSlpA/photo.jpg?sz=128", "display_name": "Claver", "link": "https://stackoverflow.com/users/12552789/claver"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576786478, "post_id": 59414847, "comment_id": 105020039, "body": "I already upvoted @David&#39;s answer. My vote doesn&#39;t show because apparently I haven&#39;t earned enough stripes."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576796654, "post_id": 59414847, "comment_id": 105023254, "body": "Claver, it you take the <a href=\"https://stackoverflow.com/tour\">tour</a> you should see what I am talking about. As the question asker there is an additional option, a big grey checkmark, Click it green. See <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">How does accepting an answer work?</a>. This option might not have been there earlier to prevent askers from instantly accepting the first (and often not ready for prime-time) answer posted."}], "tags": [], "owner": {"reputation": 3, "user_id": 12552789, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kQBhQ7HoPjs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXiNCB4sisWCYvLThCFyv2lLSlpA/photo.jpg?sz=128", "display_name": "Claver", "link": "https://stackoverflow.com/users/12552789/claver"}, "is_accepted": false, "score": 0, "last_activity_date": 1576778827, "creation_date": 1576778827, "answer_id": 59414847, "question_id": 59399841, "link": "https://stackoverflow.com/questions/59399841/changing-the-value-of-a-list-in-a-loop-c/59414847#59414847", "title": "Changing the value of a list in a loop C++", "body": "<p>@David, Thank you again. I managed to fix the issues. The functional code is as shown below. Clearly, I messed up.</p>\n\n<pre><code>#include &lt;list&gt;\n#include &lt;memory&gt;\n#include &lt;iostream&gt;\n\nclass MyObject{\n    int value;\npublic:\n    MyObject(int m_value){\n        value = m_value;\n    }\n\n    int getValue() const {return value;}\n\n};\n\n\nint main(){\n    std::list&lt;std::shared_ptr&lt;MyObject&gt;&gt; list1;\n    std::list&lt;std::shared_ptr&lt;MyObject&gt;&gt; list2;\n\n    for (int i = 0; i &gt; -10; i--){\n        list1.emplace_back(std::make_shared&lt;MyObject&gt;(i));\n    }\n\n    for (int i = 0; i &lt; 10; i++){\n        list2.emplace_back(std::make_shared&lt;MyObject&gt;(i));\n    }\n\n    int minValue = 5;\n    std::list&lt;std::shared_ptr&lt;MyObject&gt;&gt;::iterator iter2 = list2.begin();\n    for (auto &amp;el : list1){\n        if (iter2 == list2.end()) {break;}\n            if (el-&gt;getValue() &lt;= 0){\n                if ((*iter2)-&gt;getValue() &gt;= minValue){\n                    auto temp = el;\n                    el = *iter2;\n                    *iter2 = temp;\n                }\n                ++iter2; // The iterator moves forward;\n            }\n    }\n\n    for (auto &amp;obj : list1){\n        std::cout &lt;&lt; obj-&gt;getValue() &lt;&lt;std::endl;\n    }\n\n};\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12552789, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kQBhQ7HoPjs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXiNCB4sisWCYvLThCFyv2lLSlpA/photo.jpg?sz=128", "display_name": "Claver", "link": "https://stackoverflow.com/users/12552789/claver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 59399974, "answer_count": 2, "score": 0, "last_activity_date": 1576778827, "creation_date": 1576702431, "question_id": 59399841, "link": "https://stackoverflow.com/questions/59399841/changing-the-value-of-a-list-in-a-loop-c", "title": "Changing the value of a list in a loop C++", "body": "<p>I need some help with C++ iterator and range-based list traversing and updating. I have the following code in C++ 11. The code below doesn't seem to modify the lists in place.</p>\n\n<pre><code>auto LIST1 = std::list&lt;Myobject&gt;;\nauto LIST2 = std::list&lt;Myobject&gt;;\n//Filled lists with Myobjects\n// Now I need to swap some values in LIST1 with values in LIST2 if some condition is satisfied\nstd::list&lt;MyObject&gt;::iterator iter2 = LIST2.begin();\nfor (auto &amp;el : LIST1){\n    if (iter2 == LIST2.end()) {break;}\n        if (el-&gt;getSomeProperty() &lt;= 0){\n            if (iter2-&gt;getSomeProperty() &gt;= minValue){\n                auto temp = el;\n                el = *iter2;\n                *iter2 = temp;\n            }\n            ++iter2; // The iterator moves forward;\n        }\n}\n</code></pre>\n\n<p>Can someone help me?\nThanks!\nP.S: I am a newbie at StackOverflow so be gentle is I wasn't clear.</p>\n"}, {"tags": ["c++", "linux", "linker", "shared-libraries"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1576707088, "post_id": 59399803, "comment_id": 104990407, "body": "Of course it\u2019s fine. Run any tool for the shared object inspection and you will find that the symbol will be marked as run time dependency. <code>ldd libtest_dll.so</code> should show the dependency."}, {"owner": {"reputation": 207, "user_id": 1365188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a08588bdf22d12c9202cf616e90e53e?s=128&d=identicon&r=PG", "display_name": "LedHead", "link": "https://stackoverflow.com/users/1365188/ledhead"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1576710830, "post_id": 59399803, "comment_id": 104991594, "body": "@0andriy The idea is that <code>OtherClass::bar()</code> <i>should</i> be in this source code, but I&#39;ve made a mistake by accidentally leaving it out. Instead of finding that out at runtime, I&#39;d like to find it out at compile time."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 1365188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a08588bdf22d12c9202cf616e90e53e?s=128&d=identicon&r=PG", "display_name": "LedHead", "link": "https://stackoverflow.com/users/1365188/ledhead"}, "edited": false, "score": 0, "creation_date": 1576730402, "post_id": 59401807, "comment_id": 104995329, "body": "Great! <code>-Wl,-z,defs</code> fixes the problem, although I don&#39;t think <code>-Wl,--no-allow-shlib-undefined</code> affects anything for either your example or my example. Also, it looks like <code>-Wl,--no-undefined</code> is the same as <code>-Wl,z,defs</code>. Knowing the proper keywords to search for pointed me to <a href=\"https://stackoverflow.com/questions/2356168/force-gcc-to-notify-about-undefined-references-in-shared-libraries\">this question</a> of which mine is probably a duplicate."}], "tags": [], "owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "is_accepted": true, "score": 2, "last_activity_date": 1576715173, "creation_date": 1576715173, "answer_id": 59401807, "question_id": 59399803, "link": "https://stackoverflow.com/questions/59399803/how-to-make-linker-fail-for-undefined-references-when-building-shared-library-in/59401807#59401807", "title": "How to make linker fail for undefined references when building shared library in Linux", "body": "<p>When I'm building and want to avoid this situation, I compile the library with the options: <code>-Wl,--no-allow-shlib-undefined -Wl,-z,defs</code></p>\n\n<p>The first option causes the link of the shared library to fail in the situation that a symbol is not defined in the code, when used in combination with the second option, which causes the linker to report the missing symbols.</p>\n\n<p>This works well to prevent missing symbols at run-time by detecting them at link time. I do, however, need to link the <code>.so</code> with all the libraries it uses, as otherwise it will fail to build.</p>\n\n<p>sample (src.c):</p>\n\n<pre><code>#include &lt;math.h&gt;\n\nextern\ndouble share_the_stuff(double val)\n{\n    return acos(val * val);\n}\n</code></pre>\n\n<p>Build with missing symbol:</p>\n\n<pre><code>gcc -shared -o src.so src.c -Wl,--no-allow-shlib-undefined -Wl,-z,defs\n/usr/bin/ld: /tmp/ccFmD5uY.o: in function `share_the_stuff':\nsrc.c:(.text+0x17): undefined reference to `acos'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>link in libm.so:</p>\n\n<pre><code>gcc -shared -o src.so src.c -Wl,--no-allow-shlib-undefined -Wl,-z,defs -lm\n</code></pre>\n\n<p>It behaves the same with missing internal symbols.</p>\n"}], "owner": {"reputation": 207, "user_id": 1365188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a08588bdf22d12c9202cf616e90e53e?s=128&d=identicon&r=PG", "display_name": "LedHead", "link": "https://stackoverflow.com/users/1365188/ledhead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 59401807, "answer_count": 1, "score": 1, "last_activity_date": 1576715173, "creation_date": 1576702226, "question_id": 59399803, "link": "https://stackoverflow.com/questions/59399803/how-to-make-linker-fail-for-undefined-references-when-building-shared-library-in", "title": "How to make linker fail for undefined references when building shared library in Linux", "body": "<p>I'm trying to build a shared library in C++ in Ubuntu (which I will load at runtime using <code>dlopen</code>), but I noticed that the shared library builds just fine even if there's some missing dependencies. If I were to build an executable I would get an <code>undefined reference</code> linker error, which is what I would like to see here. </p>\n\n<p>There might be a little too much detail in this example, but I wasn't entirely sure how to pare it down and also make it representative. </p>\n\n<p>Base.h</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class Base{\n public:\n virtual void foo()=0;\n};\n\nextern \"C\" {\nBase* CreateBase();\n}\nextern \"C\" {\nvoid DestroyBase(Base* b);\n}\n</code></pre>\n\n<p>Derived.h</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"Base.h\"\n\nclass Derived : public Base {\n public:\n void foo();\n};\n\nextern \"C\" {\nBase* CreateBase() {\n   return new Derived;\n}\n}\nextern \"C\" {\nvoid DestroyBase(Base* b) {\n   delete b;\n}\n}\n</code></pre>\n\n<p>Derived.cc</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"Derived.h\"\n#include \"OtherClass.h\"\n\n#include &lt;iostream&gt;\n\nvoid Derived::foo(){\n  std::cout &lt;&lt; \"Derived::foo()\" &lt;&lt; std::endl;\n  std::cout &lt;&lt; \"Calling OtherClass::bar()\" &lt;&lt; std::endl;\n  OtherClass other;\n  other.bar();\n}\n</code></pre>\n\n<p>OtherClass.h</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>class OtherClass{\n  public:\n  void bar();\n};\n</code></pre>\n\n<p>My command line to build the shared library is</p>\n\n<p><code>g++ -shared -fPIC -o libtest_dll.so Derived.cc</code></p>\n\n<p>The problem is that I have no definition of <code>OtherClass::bar()</code> which is called by <code>Derived::foo()</code>, but <code>libtest_dll.so</code> builds without error or warning. It's my understanding that in Visual Studio in Windows if I were to build a DLL out of this code, it would fail to link. How can I get that behavior using <code>g++</code> in Ubuntu/Linux?</p>\n\n<p>Running g++ 8.3.0-6 on Ubuntu 19.04</p>\n"}, {"tags": ["c++", "windows", "dll", "mfc"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1576702960, "post_id": 59399774, "comment_id": 104988948, "body": "The <code>OnBnClickedButton1</code> arrived because the <code>WM_COMMAND</code> message was delivered to the button <i>after</i> translation. Your code is not running during the PreTranslate phase. The DLL never actually received the <code>PreTranslateMessage</code>. If your DLL uses <code>PreTranslateMessage</code> to do something interesting (e.g,. custom dialog box navigation), then that interesting thing won&#39;t happen."}, {"owner": {"reputation": 2519, "user_id": 170361, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/72b0cfad0e96fce94648abe53632d2c9?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/170361/dennis"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1576703359, "post_id": 59399774, "comment_id": 104989083, "body": "Thanks!  I guess the real question is, if user code isn&#39;t doing something interesting, will not running it break anything in the MFC framework."}, {"owner": {"reputation": 2519, "user_id": 170361, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/72b0cfad0e96fce94648abe53632d2c9?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/170361/dennis"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1576703386, "post_id": 59399774, "comment_id": 104989097, "body": "Also, while I have your attention, how is it that the button handler doesn&#39;t require AFX_MANAGE_STATE in the DLL, whereas the PreTranslateMessage forwarding code does?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1576751298, "post_id": 59399774, "comment_id": 105003125, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/mfc/tn058-mfc-module-state-implementation\" rel=\"nofollow noreferrer\">TN058: MFC Module State Implementation</a>: <i>&quot;AFX_MODULE_STATE does not need to be put in every function in the DLL. For example, <code>InitInstance</code> can be called by the MFC code in the application without AFX_MODULE_STATE [...]. <b>The same is true for all message map handlers</b>. Regular MFC DLLs actually have a special master window procedure that automatically switches the module state before routing any message.&quot;</i>"}], "owner": {"reputation": 2519, "user_id": 170361, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/72b0cfad0e96fce94648abe53632d2c9?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/170361/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576702910, "creation_date": 1576702090, "last_edit_date": 1576702910, "question_id": 59399774, "link": "https://stackoverflow.com/questions/59399774/is-it-actually-necessary-to-forward-cwinapppretranslatemessage-to-an-mfc-dll", "title": "Is it actually necessary to forward CWinApp::PreTranslateMessage to an MFC DLL?", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/cpp/build/regular-dlls-dynamically-linked-to-mfc?view=vs-2019\" rel=\"nofollow noreferrer\">Microsoft documentation</a> says:</p>\n\n<blockquote>\n  <p>Note that the CWinApp::Run mechanism does not apply to a DLL, because\n  the application owns the main message pump. If your DLL brings up\n  modeless dialogs or has a main frame window of its own, your\n  application's main message pump must call a DLL-exported routine that\n  calls CWinApp::PreTranslateMessage.</p>\n</blockquote>\n\n<p>However when I run an experiment to verify this, the modeless dialog appears to work fine, regardless of whether I do or don't follow the quoted advice.</p>\n\n<p>I modified \"DLLScreenCap\" sample application (linked in that same article) to have a modeless dialog which is opened by DLL code.  Because the sample executable code forwards PreTranslateMessage to the DLL, hitting a breakpoint in a button handler in the modeless dialog shows a call stack like this:</p>\n\n<ul>\n<li>OnBnClickedButton1 handler in my DLL</li>\n<li>(external code)</li>\n<li>AfxWndProcDllStatic in \"dllmodul.cpp\" (an MFC file)</li>\n<li>(external code)</li>\n<li>FilterDllMsg (function exported by my DLL to forward PreTranslateMessage)</li>\n<li>PreTranslateMessage (message handler in my EXE calling into my DLL)</li>\n<li>(external code)</li>\n<li>WinMain in the executable</li>\n</ul>\n\n<p>However if I comment out the code in executable which was forwarding PreTranslate message to the DLL, I still get functionality in the modeless dialog.  Now the button handler call stack is shorter:</p>\n\n<ul>\n<li>OnBnClickedButton1 handler in my DLL</li>\n<li>(external code)</li>\n<li>AfxWndProcDllStatic in \"dllmodul.cpp\" (an MFC file)</li>\n<li>(external code)</li>\n<li>WinMain in the executable</li>\n</ul>\n\n<p>In other words, it appears to me that if I don't forward the messages manually in PreTranslateMessage, Windows and/or the MFC framework still ensures the message gets to the DLL.</p>\n\n<p>It seems the only difference is that the PreTranslateMessage virtual function in the CWinApp doesn't get called.  If the DLL doesn't use this handler, is there any other need or reason to forward PreTranslateMessage?  Is it bad not to?</p>\n\n<p>P.S.  The same question applies to forwarding the OnIdle event.</p>\n"}, {"tags": ["c++", "class", "oop", "inheritance"], "comments": [{"owner": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1576702505, "post_id": 59399773, "comment_id": 104988786, "body": "@Mat Sorry, that&#39;s a mistake in the code I wrote here, the <code>Board&amp; board</code> is not there in the code. I got blacked out and accidentally copied it. I fixed the question now."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1576703344, "post_id": 59399773, "comment_id": 104989079, "body": "Unrelated: I don&#39;t see a need for the assignment operator. Writing an assignment operator when you don&#39;t need to opens up the possibility for avoidable bugs. If you do need it for reasons left out of the above, then <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">the Rule of Three</a> suggests you have a Copy Constructor and a destructor to go with it."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1576800654, "post_id": 59399773, "comment_id": 105024121, "body": "@0xBlackMirror Did you make anything out of the answers you got?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "edited": false, "score": 0, "creation_date": 1576702416, "post_id": 59399822, "comment_id": 104988751, "body": "Sorry thats a mistake in the code I wrote here, the <code>Board&amp; board</code> is not there in the code. I got blacked out and accidentally copied it. I fixed the question now."}, {"owner": {"reputation": 1019, "user_id": 816855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21cdf26bdaf7452f2ace9cd1cb63b0e0?s=128&d=identicon&r=PG", "display_name": "Rosme", "link": "https://stackoverflow.com/users/816855/rosme"}, "reply_to_user": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "edited": false, "score": 0, "creation_date": 1576702561, "post_id": 59399822, "comment_id": 104988805, "body": "@0xBlackMirror That code would work if it&#39;s really like that."}, {"owner": {"reputation": 3958, "user_id": 535724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a7cd70ab9eda527473e023a3ecc3333?s=128&d=identicon&r=PG", "display_name": "umlcat", "link": "https://stackoverflow.com/users/535724/umlcat"}, "edited": false, "score": 0, "creation_date": 1576702634, "post_id": 59399822, "comment_id": 104988827, "body": "@Rosme, one reasons I dont overload functions, is when mixed with virtual / overriding"}, {"owner": {"reputation": 1019, "user_id": 816855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21cdf26bdaf7452f2ace9cd1cb63b0e0?s=128&d=identicon&r=PG", "display_name": "Rosme", "link": "https://stackoverflow.com/users/816855/rosme"}, "reply_to_user": {"reputation": 3958, "user_id": 535724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a7cd70ab9eda527473e023a3ecc3333?s=128&d=identicon&r=PG", "display_name": "umlcat", "link": "https://stackoverflow.com/users/535724/umlcat"}, "edited": false, "score": 0, "creation_date": 1576702702, "post_id": 59399822, "comment_id": 104988864, "body": "@umlcat This is just example code to show him. However this answer doesn&#39;t fit anymore considering that he changed the code of the original question."}, {"owner": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "edited": false, "score": 0, "creation_date": 1576702719, "post_id": 59399822, "comment_id": 104988870, "body": "@Rosme But when <code>src.move(dest.getX(), dest.getY())</code> is called, it still call the original function from <code>Piece</code> and not from the children."}, {"owner": {"reputation": 1019, "user_id": 816855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21cdf26bdaf7452f2ace9cd1cb63b0e0?s=128&d=identicon&r=PG", "display_name": "Rosme", "link": "https://stackoverflow.com/users/816855/rosme"}, "reply_to_user": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "edited": false, "score": 0, "creation_date": 1576702852, "post_id": 59399822, "comment_id": 104988916, "body": "@0xBlackMirror From the code you provided, that wouldn&#39;t be the case. Either you didn&#39;t compile that code, or the implementation inside your <code>Rook::move</code> is the same as your <code>Piece</code>. A good way to test out if it&#39;s really calling <code>Piece::move</code> is to make it pure virtual <code>= 0;</code>"}, {"owner": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "edited": false, "score": 0, "creation_date": 1576703067, "post_id": 59399822, "comment_id": 104988987, "body": "@Rosme There is no way is implementation is the same. In <code>Piece</code> I just put a <code>return 1;</code> line just for testing, but in <code>Rook::move()</code> I wrote a fully operational function. And the code I provided is pretty much the same."}], "tags": [], "owner": {"reputation": 1019, "user_id": 816855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21cdf26bdaf7452f2ace9cd1cb63b0e0?s=128&d=identicon&r=PG", "display_name": "Rosme", "link": "https://stackoverflow.com/users/816855/rosme"}, "is_accepted": false, "score": 0, "last_activity_date": 1576702331, "creation_date": 1576702331, "answer_id": 59399822, "question_id": 59399773, "link": "https://stackoverflow.com/questions/59399773/how-to-make-the-base-class-call-overriden-function-from-child-class/59399822#59399822", "title": "How to make the base class call overriden function from child class", "body": "<p>The signatures differs. They need to be the same. Your <code>Rook</code> needs to become this:</p>\n\n<pre><code>class Rook : public Piece\n{\npublic:\n    Rook(int x, int y, int pieceTypeIndex, int pieceColor);\n    virtual int move(int dest_x, int dest_y);\n};\n</code></pre>\n\n<p>A good trick to validate you are doing it correctly is to use the keyword <code>override</code>.</p>\n\n<pre><code>class Rook : public Piece\n{\npublic:\n    Rook(int x, int y, int pieceTypeIndex, int pieceColor);\n    virtual int move(int dest_x, int dest_y) override;\n    virtual int move(int dest_x, int dest_y, Board&amp; board) override; //Wouldn't compile\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3958, "user_id": 535724, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a7cd70ab9eda527473e023a3ecc3333?s=128&d=identicon&r=PG", "display_name": "umlcat", "link": "https://stackoverflow.com/users/535724/umlcat"}, "is_accepted": false, "score": -1, "last_activity_date": 1576703489, "creation_date": 1576703489, "answer_id": 59400034, "question_id": 59399773, "link": "https://stackoverflow.com/questions/59399773/how-to-make-the-base-class-call-overriden-function-from-child-class/59400034#59400034", "title": "How to make the base class call overriden function from child class", "body": "<p>You need to declare the same function / method in the <strong>base</strong> class, mark that function as <code>virtual</code>, and redeclare that same function in a child class, marked both with the <code>virtual</code> and <code>override</code> keywords.</p>\n\n<pre><code>**Pieces.hpp**\n\nclass Piece\n{\n  // ...\n\n  public:\n\n  virtual int move (int x, int y);\n\n  void start(int x, int y);\n\n  // ...\n\n  } // class\n\nclass Rook : public Piece\n{\n  // ...\n\n  public:\n\n  virtual int move (int x, int y) override;\n\n  // ...\n\n  } // class\n\n**Pieces.cpp**\n\nvoid piece::start(int x, int y)\n{\n  this::move(x, y);\n} //\n</code></pre>\n\n<p>But, this CANNOT be done in the constructor method in \"C++\".</p>\n\n<pre><code>int main (...)\n{\n  Piece MyPiece = new Rook( );\n  MyPiece-&gt;Start(1, 1);\n  free MyPiece ( );\n\n  return 0;\n}\n</code></pre>\n\n<p>You also use another function, with same ID, and additional parameters, it works, but developers get confused.</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1576707661, "creation_date": 1576707661, "answer_id": 59400768, "question_id": 59399773, "link": "https://stackoverflow.com/questions/59399773/how-to-make-the-base-class-call-overriden-function-from-child-class/59400768#59400768", "title": "How to make the base class call overriden function from child class", "body": "<blockquote>\n  <p>How to make the base class call overriden function from child class</p>\n</blockquote>\n\n<p>You simply call it - and if the base class has no idea of how to perform any part of the task, make the function pure virtual (which also makes your base class abstract - it can't be instantiated, which is a good thing). Also try to avoid magic numbers. Name the things you can to make it easier to read the code.</p>\n\n<p>You can also rely on the implicitly created copy constructors/assignment operators in this case. All the types used inside your base class are trivially copyable.</p>\n\n<p>Here's an example of how you can split up your <code>move()</code> function into one base class part and one part that only the derived classes can handle, the validation of the move, and have the base class <code>move()</code> call <code>validate_move()</code> in the derived class.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n// name stuff\nenum piece_t { rook, knight, king /* etc */ };\nenum color_t { c_black, c_white };\n\nclass Piece {\n    private:\n        // You probably can make these private:\n        piece_t _pieceTypeIndex;\n        color_t _pieceColor;\n        int _x;\n        int _y;\n\n    protected:\n        // No need to have this public - it's never going to be used by anything\n        // but derived classes.\n        Piece(int x, int y, color_t pieceColor, piece_t pieceTypeIndex) :\n            _pieceTypeIndex(pieceTypeIndex),\n            _pieceColor(pieceColor),\n            _x(x),\n            _y(y)\n        {}\n\n    public:\n        Piece() = default; // this is questionable\n\n        // Pure virtual - must be implemented by derived classes\n        virtual bool validate_move(int dest_x, int dest_y) = 0;\n\n        bool move(int dest_x, int dest_y) {\n            // Call the validate_move function in the derived class\n            if(validate_move(dest_x, dest_y)==false) return false;\n\n            // Do the rest of the stuff that happens when you move\n            // that the base class can actually handle\n            _x = dest_x;\n            _y = dest_y;\n            return true;\n        }\n\n        int getX() const { return _x; }\n        int getY() const { return _y; }\n\n        // the rest of the functions excluded for brevity\n};\n\nclass Rook : public Piece {\npublic:\n    using Piece::Piece; // use base class constructors (default ctor - perhaps not needed)\n\n    // The Rook constructor only needs position and color since it already knows\n    // that it's a rook and can supply that info to the base class constructor.\n    Rook(int x, int y, color_t c) : Piece(x, y, c, rook) {}\n\n    // Implementation of the function that's pure virtual in base.\n    // Use \"override\" to make sure that you actually override. Then compiler\n    // will complain if you try to override something that isn't virtual.\n    bool validate_move(int /*dest_x*/, int /*dest_y*/) override {\n        // validate if this move is ok or not\n        return true;\n    }\n};\n\nint main() {\n    Rook a(2, 1, c_black); // no need to specify pieceTypeIndex\n    Rook b;                // default, uninitialized - not even a proper Rook at this time\n    b = a;                 // copy assignment - now it's a Rook\n    Rook c(b);             // copy construction\n\n    std::cout &lt;&lt; c.getX() &lt;&lt; ' ' &lt;&lt; c.getY() &lt;&lt; '\\n';\n\n    if(c.move(3,4))        // silly move for a rook, but validate_move approves anything :)\n        std::cout &lt;&lt; \"successfully moved to \" &lt;&lt; c.getX() &lt;&lt; ' ' &lt;&lt; c.getY() &lt;&lt; '\\n';\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11368573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wAZyM.jpg?s=128&g=1", "display_name": "0xBm", "link": "https://stackoverflow.com/users/11368573/0xbm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1576707661, "creation_date": 1576702089, "last_edit_date": 1576702374, "question_id": 59399773, "link": "https://stackoverflow.com/questions/59399773/how-to-make-the-base-class-call-overriden-function-from-child-class", "title": "How to make the base class call overriden function from child class", "body": "<p>I have a class name <code>Piece</code> which has a number of children classes like <code>Rook</code>, <code>Knight</code>, <code>King</code> etc...\nThe class <code>Piece</code> has a virtual function named <code>Move(int x, int y)</code> and all the child classes inherit this function.\nNow I have another function, let's call it <code>foo(Piece&amp; src, Piece&amp; dest)</code>. <code>foo()</code> calls the the function <code>move()</code> this way:</p>\n\n<pre><code>int foo(Piece&amp; src, Piece&amp; dest)\n{\n    int moveCode = src.move(dest.getX(), dest.getY());\n    // Rest of the code ...\n}\n</code></pre>\n\n<p>The function <code>foo()</code> sometimes gets <code>knight</code> class as a parameter, or <code>King</code> class, or the rest of the child classes.\nMy problem is when I call <code>move()</code> I want it to call the overridden <code>move</code> function from the child class and instead it calls the <code>move</code> class from <code>Piece</code> the base class.\nIs there any way to make <code>src.move()</code> call the child function?</p>\n\n<p>Piece.h:</p>\n\n<pre><code>class Piece\n{\n    protected:\n        int _pieceTypeIndex;\n        int _pieceColor;\n        int _x;\n        int _y;\n    public:\n        Piece();\n        Piece(int x, int y);\n        Piece(int x, int y, int pieceTypeIndex, int pieceColor);\n        virtual int move(int dest_x, int dest_y);\n        int getPieceTypeIndex() const;\n        int getPieceColor() const;\n        void setPieceTypeIndex(int pieceTypeIndex);\n        void setPieceColor(int pieceColor);\n        int getX();\n        int getY();\n        void setX(int x);\n        void setY(int y);\n        Piece&amp; operator=(Piece&amp; other);\n};\n</code></pre>\n\n<p>Child class code (Rook.h):</p>\n\n<pre><code>class Rook : public Piece\n{\npublic:\n    Rook(int x, int y, int pieceTypeIndex, int pieceColor);\n    virtual int move(int dest_x, int dest_y);\n};\n</code></pre>\n"}, {"tags": ["c++", "winapi", "visual-studio-2017", "directx", "screen-resolution"], "comments": [{"owner": {"reputation": 14052, "user_id": 1513286, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/kUz60.png?s=128&g=1", "display_name": "snoopy", "link": "https://stackoverflow.com/users/1513286/snoopy"}, "edited": false, "score": 0, "creation_date": 1576707207, "post_id": 59399758, "comment_id": 104990452, "body": "Unrelated: Why would you be learning directx9 at this point? if you aim to work building games you shouldn&#39;t really care much about learning graphics APIs unless you&#39;re interested in the heavily optimization of the GPU, maybe learn Unity or Unreal Engine for building games. However it is a good idea to know and understand how things work behind the scenes, if so, I would recommend that you would go for Directx 11.2 as Directx9 is legacy."}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 11737733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPKyG.jpg?s=128&g=1", "display_name": "Jeffreys", "link": "https://stackoverflow.com/users/11737733/jeffreys"}, "is_accepted": false, "score": 0, "last_activity_date": 1576742234, "last_edit_date": 1576742234, "creation_date": 1576741933, "answer_id": 59405362, "question_id": 59399758, "link": "https://stackoverflow.com/questions/59399758/how-to-prevent-stretching-scaling-of-a-directx-c-program/59405362#59405362", "title": "How to prevent stretching/scaling of a DirectX C++ program", "body": "<p>Maybe Viewport (D3DEVIEWPORT9) could help you, you can set the position of your image on the window through this structure. Then there is an API to obtain the resolution of the monitor. the resolution of the monitor minus the resolution of the image, and finally divide by 2, the result is the position of the upper left corner of your image on the screen. The following code is for your reference.</p>\n\n<pre><code>int nScreenWidth, nScreenHeight;\nnScreenWidth = GetSystemMetrics(SM_CXSCREEN);\nnScreenHeight = GetSystemMetrics(SM_CYSCREEN);\nD3DEVIEWPORT9 vp = { (nScreenWidth - 1024) / 2,(nScreenHeight - 768) / 2,1024,768,0,1 };\npd3dDevice-&gt;SetViewport(&amp;vp);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6888877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d14feee224083a811927297870a8fe27?s=128&d=identicon&r=PG&f=1", "display_name": "LuKo", "link": "https://stackoverflow.com/users/6888877/luko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576742234, "creation_date": 1576702019, "last_edit_date": 1576741876, "question_id": 59399758, "link": "https://stackoverflow.com/questions/59399758/how-to-prevent-stretching-scaling-of-a-directx-c-program", "title": "How to prevent stretching/scaling of a DirectX C++ program", "body": "<p>I have built a very straightforward C++ program using DirectX9 that presents images and text on the screen. I have compiled it for 1024 x 768 and I want to make sure it is compatible on any screen resolution. When trying to run my executable on a 1920 x 1080 monitor, the program automatically stretches horizontally (as this monitor is a widescreen) and distorts the images and text. I have been told there is a flag I can change when initalizing DirectX, which will prevent any stretching and make sure the program opens with vertical black bars on either side to preserve all my desired formatting. Does anybody know how to do this? Here is an excerpt from my code that initalizes DirectX. PS: I am setting the refresh rate to 0, so that my program will run on any monitor's native refresh rate.\nThank you!</p>\n\n<pre><code>/*-----------------------------------------------------------------------------\nName: InitD3D()\nDesc: Creates the D3D object using Direct3D\n-------------------------------------------------------------------------------*/\nHRESULT InitD3D(HWND hWnd) {\n   if (NULL == (pD3D = Direct3DCreate9(D3D_SDK_VERSION)))\n      return E_FAIL;\n\n   D3DPRESENT_PARAMETERS d3dpp;\n   ZeroMemory(&amp;d3dpp, sizeof(d3dpp));\n   d3dpp.Windowed = FALSE;\n   d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;\n   d3dpp.BackBufferFormat = D3DFMT_A8R8G8B8;\n   d3dpp.BackBufferCount = 1;\n   d3dpp.BackBufferWidth = 1024;\n   d3dpp.BackBufferHeight = 768;\n   d3dpp.FullScreen_RefreshRateInHz = 0;\n\n   if (FAILED(pD3D-&gt;CreateDevice(D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWnd,\n      D3DCREATE_SOFTWARE_VERTEXPROCESSING,\n      &amp;d3dpp, &amp;pd3dDevice)))\n      return E_FAIL;\n\n   return S_OK;\n}\n</code></pre>\n"}, {"tags": ["php", "c++", "posix"], "answers": [{"tags": [], "owner": {"reputation": 668, "user_id": 7148416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af0b88b4441b06815e01ed145a2f14?s=128&d=identicon&r=PG&f=1", "display_name": "diametralpitch", "link": "https://stackoverflow.com/users/7148416/diametralpitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1576731280, "creation_date": 1576731280, "answer_id": 59403491, "question_id": 59399740, "link": "https://stackoverflow.com/questions/59399740/how-to-create-a-bidirectional-channel-between-processes/59403491#59403491", "title": "How to create a bidirectional channel between processes?", "body": "<p>Looks like your pipe and I/O redirection is sound. I think the issue you are dealing with is the misuse of the <code>execlp</code> call. The first argument should be the path to the file you want to execute. The rest of the arguments will effectively be the <code>argv</code> for the program you want to exec. So if you think about it, the second argument to <code>execlp</code> is going to be <code>argv[0]</code> (the program name) in that exec'd program. So you could do something like:</p>\n\n<pre><code>execlp(\n    \"/usr/bin/php\", // actual path to executable file\n    \"myphp\", // argv[0]\n    \"/home/anton/test1.php\", // argv[1]\n    NULL // sentinel\n);\n</code></pre>\n\n<p>I purposely wrote an exaggerated program name for the second argument so you get the idea. Also, I don't work with php so I'm assuming the php executable is at <code>/usr/bin/php</code>. You might be able to verify that by running: <code>command -v php</code>. Hope this helps.</p>\n"}], "owner": {"reputation": 121, "user_id": 12541277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QUCFe.png?s=128&g=1", "display_name": "BERTOLDO", "link": "https://stackoverflow.com/users/12541277/bertoldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576731280, "creation_date": 1576701914, "last_edit_date": 1576714217, "question_id": 59399740, "link": "https://stackoverflow.com/questions/59399740/how-to-create-a-bidirectional-channel-between-processes", "title": "How to create a bidirectional channel between processes?", "body": "<p>In my project, I needed to run a php script from c ++, pass standard input to it, and select standard output. To do this, I create a child process using fork (), open pipes using pipe (), reassign I / O flows through dup2, and run the script using execlp (). I wrote a small program for tests, but it does not work, freezes, waits until the child process writes something to the channel, but this does not happen, what am I doing wrong?</p>\n\n<p>cpp code</p>\n\n<pre><code>int main()\n{\n    pid_t pid;\n    int pipe_in[2];\n    int pipe_out[2];\n    pipe(pipe_in);\n    pipe(pipe_out);\n    if ((pid = fork()) &gt; 0)\n    {\n        close(pipe_in[0]);\n        close(pipe_out[1]); \u0438\n\n        std::string msg = \"hello world\\n\";\n        char buf[256];\n        write(pipe_in[1], msg.c_str(), msg.length());\n        read(pipe_out[0], buf, 255);\n        std::string temp = buf;\n        std::cout \u00ab temp;\n    }\n    else\n    {\n        close(pipe_in[1]);\n        close(pipe_out[0]);\n        dup2(pipe_in[0], 0);\n        dup2(pipe_out[1], 1);\n        if(execlp(\"php\", \"/home/anton/test1.php\", NULL) &lt; 0)\n        std::cout \u00ab\"(((\"; \n\n    }\n}\n</code></pre>\n\n<p>php code</p>\n\n<pre><code>&lt;?php\n$line = trim(fgets(STDIN));\necho $line;\necho \"11111\";\n?&gt;\n</code></pre>\n"}, {"tags": ["c++", "linux", "physics"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1576702145, "post_id": 59399685, "comment_id": 104988636, "body": "You should probably run a test data set to help you isolate the problem. In crypto they are called test vectors. Does your project offer them?"}, {"owner": {"reputation": 61, "user_id": 11993857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8515dda3d47574aa4743edd43ca27b?s=128&d=identicon&r=PG&f=1", "display_name": "saltkun", "link": "https://stackoverflow.com/users/11993857/saltkun"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1576702500, "post_id": 59399685, "comment_id": 104988784, "body": "emm,I have tried.I have a single histogram version as you see in single-histogram(),until this I&#39;m sure there is no bug.But in iteration and normalize,I can&#39;t find bug, and I input same asample dot as single histogram it&#39;s T=1.2,1.4...3.2.And as you see ,there are still bugs.@jww"}, {"owner": {"reputation": 61, "user_id": 11993857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8515dda3d47574aa4743edd43ca27b?s=128&d=identicon&r=PG&f=1", "display_name": "saltkun", "link": "https://stackoverflow.com/users/11993857/saltkun"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1576703074, "post_id": 59399685, "comment_id": 104988991, "body": "Actually,I don&#39;t fully understand what your meaning of &quot;test data set&quot;.I think it&#39;s T and Tadd push_back in main function.But it doesn&#39;t work...@jww"}, {"owner": {"reputation": 61, "user_id": 11993857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8515dda3d47574aa4743edd43ca27b?s=128&d=identicon&r=PG&f=1", "display_name": "saltkun", "link": "https://stackoverflow.com/users/11993857/saltkun"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1576703418, "post_id": 59399685, "comment_id": 104989108, "body": "@lr1985@rudy@Hannu I&#39;m sorry for my interruption. But I fall in this probelm.."}, {"owner": {"reputation": 2093, "user_id": 3817456, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/yaB2T.png?s=128&g=1", "display_name": "jeremy_rutman", "link": "https://stackoverflow.com/users/3817456/jeremy-rutman"}, "edited": false, "score": 0, "creation_date": 1576720857, "post_id": 59399685, "comment_id": 104993632, "body": "You might want to post at <a href=\"https://physics.stackexchange.com/\">physics.stackexchange.com</a>"}, {"owner": {"reputation": 2093, "user_id": 3817456, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/yaB2T.png?s=128&g=1", "display_name": "jeremy_rutman", "link": "https://stackoverflow.com/users/3817456/jeremy-rutman"}, "edited": false, "score": 0, "creation_date": 1576722236, "post_id": 59399685, "comment_id": 104993862, "body": "In your single-histogram version the magnetization looks ok (single histogram is simliar to average), only the internal energy looks different - and the single-histogram result has been labelled &#39;spin&#39; and not energy, those are somewhat different so make sure you have plotted the right one.  Also I note that DeltaPartEnergy has an extra calculation, it appears that e2=-e1 so no need to calculate all the terms again."}, {"owner": {"reputation": 61, "user_id": 11993857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8515dda3d47574aa4743edd43ca27b?s=128&d=identicon&r=PG&f=1", "display_name": "saltkun", "link": "https://stackoverflow.com/users/11993857/saltkun"}, "edited": false, "score": 0, "creation_date": 1576733408, "post_id": 59399685, "comment_id": 104996001, "body": "I&#39;m sorry.I&#39;m a Chinese student.It Y axis is energy per spin .I have found where errors are.Could you help me again?Thank you for help,my English is poor and I have studied C++ for a short time.I&#39;m sorry for my interruption again.@jeremy_rutman"}, {"owner": {"reputation": 61, "user_id": 11993857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8515dda3d47574aa4743edd43ca27b?s=128&d=identicon&r=PG&f=1", "display_name": "saltkun", "link": "https://stackoverflow.com/users/11993857/saltkun"}, "edited": false, "score": 0, "creation_date": 1576733878, "post_id": 59399685, "comment_id": 104996137, "body": "And I draw the picture again,the blue line is simulation one by one,the orange line is single-histogram.@jeremy_rutman"}], "owner": {"reputation": 61, "user_id": 11993857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8515dda3d47574aa4743edd43ca27b?s=128&d=identicon&r=PG&f=1", "display_name": "saltkun", "link": "https://stackoverflow.com/users/11993857/saltkun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576735154, "creation_date": 1576701623, "last_edit_date": 1576735154, "question_id": 59399685, "link": "https://stackoverflow.com/questions/59399685/ising-model-simulation-offset-critical-temperature-and-interal-ernergy", "title": "Ising model simulation offset critical temperature and interal ernergy", "body": "<p>I'm writing a code about Ising model using WHAM(the weighted histogram analysis method)\uff0cBut it seems to be wrong with critical temperature and interal ernergy.\n<strong>(newest rewritten code is below)</strong></p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;cmath&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;map&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\nofstream out(\"data.dat\");\nconst long  L = 8;       //\u6a21\u62df\u5c3a\u5bf8\nconst long  MCS = 1.1e6; //\u603b\u7684\u6a21\u62df\u6b65\u6570\nconst long  MS = 1e5;     //\u9664\u53bb\u9884\u70ed\u7edf\u8ba1\u7684\u6b65\u6570\nconst long double J = -1;    // J=1AFM,J=-1FM\n\n//\u968f\u673a\u521d\u59cb\u5316\u81ea\u65cb\u5206\u5e03\nlong double InitialSpin(long  s[][L]) {\n  for (long  i = 0; i &lt; L; i++) {\n    for (long  j = 0; j &lt; L; j++) {\n      // s[i][j] = 1;\n      s[i][j] = 2 * (rand() % 2) - 1;\n    }\n  }\n  return 0;\n}\n\n// \u8ba1\u7b97\u4f53\u7cfb\u7684\u603b\u80fd\u91cf\nlong double SumEnergy(long  Spin[][L]) {\n  long double e = 0;\n  for (long  i = 0; i &lt; L; i++) {\n    for (long  j = 0; j &lt; L; j++) {\n      e += J * Spin[i][j] *\n           (Spin[(i + 1) % L][j] + Spin[(i - 1 + L) % L][j] +\n            Spin[i][(j + 1) % L] + Spin[i][(j - 1 + L) % L]) /\n           2; //+L\u4e3a\u4e86\u9632\u6b62i-1\u8d1f\u6570\n    }\n  }\n  return e;\n}\n//\u8ba1\u7b97\u683c\u70b9\u7684\u5c40\u57df\u80fd\u91cf\nlong  DeltaPartEnergy(long  Spin[][L], long  i, long  j) {\n  long  e1 = 0, e2 = 0, deltae;\n\n  e1 = J * Spin[i][j] *\n       (Spin[(i + 1) % L][j] + Spin[(i - 1 + L) % L][j] + Spin[i][(j + 1) % L] +\n        Spin[i][(j - 1 + L) % L]); //+L\u4e3a\u4e86\u9632\u6b62i-1\u8d1f\u6570\n  e2 = -J * Spin[i][j] *\n       (Spin[(i + 1) % L][j] + Spin[(i - 1 + L) % L][j] + Spin[i][(j + 1) % L] +\n        Spin[i][(j - 1 + L) % L]);\n  deltae = e2 - e1;\n\n  return deltae;\n}\n//\u8f93\u51fa\u4f53\u7cfb\u7684\u603b\u78c1\u77e9\nlong  Magnetization(long  s[][L]) {\n  long  m = 0;\n  for (long  i = 0; i &lt; L; i++) {\n    for (long  j = 0; j &lt; L; j++) {\n      m += s[i][j];\n    }\n  }\n  return m;\n}\n\n//\u751f\u6210\u9009\u4e2d\u7684\u683c\u70b9\u5750\u6807(\u7ecf\u8fc7\u786e\u8ba4\uff0cubu\u4e0a\u53ef\u4ee52^32\uff0cvscode\u5751\u7239\u7684\u53ea\u670916\u4f4d,\u8fdc\u8fdc\u5927\u4e8e\u6240\u9700\u4f4d\u6570)\nlong  Myrand(long  L) {\n  long  x;\n  x = rand() % L;\n  return x;\n}\n// monte\u4ea4\u6362\nvoid Montechange(long  Spin[][L], long double T, long  *result) {\n  long  x, y, DeltaE, trans = 0;\n  long double p, r;\n  x = Myrand(L);\n  y = Myrand(L);\n  DeltaE = DeltaPartEnergy(Spin, x, y);\n  if (DeltaE &lt; 0)\n    trans = 1;\n  else {\n    p = 1.0 * rand() / (long double)RAND_MAX;\n    r = exp(1.0 * (-DeltaE) / T);\n    if (p &lt; r)\n      trans = 1;\n  }\n  if (trans == 1) {\n    result[0] = x;\n    result[1] = y;\n    result[2] = trans;\n  }\n}\n\nvoid MonteCarlo(long  Spin[][L], long double T, map&lt;long , long &gt; &amp;ener,\n                map&lt;long , long &gt; &amp;mag, map&lt;vector&lt;long &gt;, long &gt; &amp;mage) {\n\n  long  m, trans[3] = {0};\n  long double SE;\n  std::vector&lt;long &gt; mage1;\n  for (long  mcs = 0; mcs &lt; MCS; mcs++) {\n\n    Montechange(Spin, T, trans);\n    if (trans[2] == 1) {\n      Spin[trans[0]][trans[1]] = -Spin[trans[0]][trans[1]];\n    }\n\n    if (mcs == MS - 1) {\n      SE = SumEnergy(Spin);\n      m = Magnetization(Spin);\n    }\n    if (mcs &gt;= MS) {\n      if (trans[2] == 1) {\n        SE = SE - DeltaPartEnergy(Spin, trans[0], trans[1]);\n        m = m + 2 * Spin[trans[0]][trans[1]]; //\u8f93\u51fa\u603b\u78c1\u77e9\n      }\n      mage1.clear();\n      mage1.push_back(SE);\n      mage1.push_back(abs(m));\n      if (mag.find(abs(m)) == mag.end())\n        mag[abs(m)] = 1;\n      else\n        mag[abs(m)]++;\n      // SE=SumEnergy(Spin);\n      if (ener.find(SE) == ener.end())\n        ener[SE] = 1;\n      else\n        ener[SE]++;\n\n      if (mage.find(mage1) == mage.end())\n        mage[mage1] = 1;\n      else\n        mage[mage1]++;\n    }\n\n    // out &lt;&lt; mcs &lt;&lt; '\\t' &lt;&lt; m &lt;&lt;'\\t' &lt;&lt; SE &lt;&lt; endl;\n  }\n  // for(map&lt;long , long &gt;::iterator it = ener.begin(); it != ener.end(); it++) {\n  // out &lt;&lt; it-&gt;first &lt;&lt; '\\t' &lt;&lt; it-&gt;second &lt;&lt; endl;\n  //}\n}\n/*\nvoid single_histogram(map&lt;long , long &gt; ener, map&lt;vector&lt;long &gt;, long &gt; mage,\n                      vector&lt;long double&gt; T, vector&lt;long double&gt; Tadd, vector&lt;long double&gt; &amp;U,\n                      vector&lt;long double&gt; &amp;magT) {\n  long double up, down, a;\n\n  for (long  i = 0; i &lt; Tadd.size(); i++) {\n    up = 0;\n    down = 0;\n    for (map&lt;long , long &gt;::iterator it = ener.begin(); it != ener.end(); it++) {\n      a = 1.0 * it-&gt;second *\n          exp(-1.0 * ((1.0 / Tadd[i]) - (1.0 / T[0])) * it-&gt;first);\n      down += a;\n      up += a * it-&gt;first;\n    }\n    U.push_back(up / down);\n    up = 0;\n    down = 0;\n    for (map&lt;vector&lt;long &gt;, long &gt;::iterator it = mage.begin(); it != mage.end();\n         it++) {\n      a=1.0 * exp(-1.0 * ((1.0 / Tadd[i]) - (1.0 / T[0])) * it-&gt;first[0]);\n      down+=a*it-&gt;second;\n      up+=a*it-&gt;first[1]*it-&gt;second;\n    }\n    magT.push_back(up/down);\n  }\n}*/\nvoid normalize(vector&lt;long double&gt; &amp;Z) {\n  auto maxPosition = max_element(Z.begin(), Z.end());\n  auto minPosition = min_element(Z.begin(), Z.end());\n  long i;\n  long double max, min, A;\n  max = *maxPosition;\n  min = *minPosition;\n  A = 1.0 / sqrt(max * min);\n  for (i = 0; i &lt; Z.size(); i++) {\n    Z[i] = Z[i] * A;\n  }\n}\nvoid iterZ(vector&lt;long double&gt; T, vector&lt;long double&gt; &amp;Z, map&lt;long , long&gt; ener) {\n  long  i, j;\n  long double delta, epsilon = 1e-10;\n\n    for (i = 0; i &lt; T.size(); i++) {\n      Z.push_back(1.0);\n    }\n    std::vector&lt;long double&gt; Y(Z.size());\n    do {\n        delta=0.0;\n    for (j = 0; j &lt; T.size(); j++) {\n      long double up = 0, down = 0,sum=0;\n      for (map&lt;long , long &gt;::iterator it = ener.begin(); it != ener.end(); it++) {\n        up = 1.0 * it-&gt;second;\n        for (i = 0; i &lt; T.size(); i++) {\n          down +=\n              1.0 * (MCS - MS) / Z[i] * exp((1.0 / T[j] - 1.0 / T[i]) * it-&gt;first);\n        }\n        sum+=up/down;\n      }\n      Y[j] = sum;\n    }\n    normalize(Y);\n    for (j = 0; j &lt; T.size(); j++) {\n      delta += ((Y[j] - Z[j]) / Y[j]) * ((Y[j] - Z[j]) / Y[j]);\n      Z[j] = Y[j];\n    }\n    cout&lt;&lt;Z[0]&lt;&lt;endl;\n    cout&lt;&lt;Z[1]&lt;&lt;endl;\n    cout&lt;&lt;delta&lt;&lt;endl;\n  } while (delta &gt; epsilon * epsilon);\n}\nvoid multi(vector&lt;long double&gt; T, vector&lt;long double&gt; Tadd, vector&lt;long double&gt; Z,\n           vector&lt;long double&gt; &amp;Y, map&lt;long , long &gt; ener) {\n  long  i, j;\n  for (i = 0; i &lt; Tadd.size(); i++) {\n    long double up = 0.0, down = 0.0,sum=0.0;\n    for (map&lt;long , long &gt;::iterator it = ener.begin(); it != ener.end(); it++) {\n      up = 1.0 * it-&gt;second;\n      for (j = 0; j &lt; T.size(); j++) {\n        down +=\n            1.0 * (MCS - MS) / Z[j] * exp((1.0 / Tadd[i] - 1.0 / T[j]) * it-&gt;first);\n      }\n      sum+=up/down;\n    }\n    Y.push_back(sum);\n  }\n}\nint  main() {\n  srand((unsigned)time(NULL)); //\u521d\u59cb\u5316\u65f6\u95f4\n  long  s[L][L] = {{0}}, i, j, k;\n  //long double enerp, magp;\n  std::map&lt;long , long &gt; ener;\n  std::map&lt;long , long &gt; mag;\n  std::vector&lt;long double&gt; T;\n  std::vector&lt;long double&gt; Tadd;\n  //std::vector&lt;long double&gt; Tm;\n  //std::vector&lt;long double&gt; Te;\n  std::map&lt;vector&lt;long &gt;, long &gt; mage;\n  std::vector&lt;long double&gt; U;\n  std::vector&lt;long double&gt; Z;\n  std::vector&lt;long double&gt; Y;\n  std::vector&lt;long double&gt; magT;\n  for (i = 0; i &lt; 2; i++) {\n    Tadd.push_back(2.1+0.1*i);\n  }\n  for(i=0;i&lt;2;i++){\n  T.push_back(2.1+0.1*i);\n  }\n  for (k = 0; k &lt; T.size(); k++) {\n    for (i = 0; i &lt; L; i++) {\n      for (j = 0; j &lt; L; j++) {\n        // s[i][j] = 1;\n        s[i][j] = 2 * (rand() % 2) - 1;\n      }\n    }\n    MonteCarlo(s, T[k], ener, mag, mage);\n    //magp = 0.0;\n    /*for (map&lt;long , long &gt;::iterator it = mag.begin(); it != mag.end(); it++) {\n      magp += (it-&gt;first) * (it-&gt;second);\n    }\n    Tm.push_back(magp / (MCS - MS) / L / L);\n    enerp = 0.0;\n    for (map&lt;long , long &gt;::iterator it = ener.begin(); it != ener.end(); it++) {\n      enerp += (it-&gt;first) * (it-&gt;second);\n    }\n    Te.push_back(enerp / (MCS - MS) / L / L);*/\n  }\n  iterZ(T, Z, ener);\n  multi(T,Tadd,Z,Y,ener);\n\n  // single_histogram(ener,mage,T,Tadd,U,magT);\n\n  ofstream out3(\"magA.dat\");\n  for (i = 0; i &lt; T.size(); i++) {\n    out3 &lt;&lt; T[i] &lt;&lt; '\\t' &lt;&lt; Z[i]  &lt;&lt; endl;\n  }\n  for (i = 0; i &lt; Tadd.size(); i++) {\n    out3 &lt;&lt; Tadd[i] &lt;&lt; '\\t' &lt;&lt; Y[i]&lt;&lt; endl;\n  }\n  out3.close();\n  /*\n  ofstream out1(\"mag.dat\");\n  for (map&lt;long , long &gt;::iterator it = mag.begin(); it != mag.end(); it++) {\n    out1 &lt;&lt; it-&gt;first &lt;&lt; '\\t' &lt;&lt; it-&gt;second &lt;&lt; endl;\n  }\n  out1.close();\n\n  ofstream out2(\"ener.dat\");\n  for (map&lt;long , long &gt;::iterator it = ener.begin(); it != ener.end(); it++) {\n    out2 &lt;&lt; it-&gt;first &lt;&lt; '\\t' &lt;&lt; it-&gt;second &lt;&lt; endl;\n  }\n  out2.close();\n  */\n  return 0;\n}\n\n</code></pre>\n\n<p>It'S my result of its code.</p>\n\n<p>magnetization-kT\n<a href=\"https://i.stack.imgur.com/lBGaw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lBGaw.jpg\" alt=\"magnetization-kT\"></a>\ninteral ernergy-kT\n<a href=\"https://i.stack.imgur.com/T5kjS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T5kjS.jpg\" alt=\"interal ernergy-kT\"></a>\nAnd it's my single-histogram result.</p>\n\n<p><strong>The blue line is simulation one by one,the orange line is single-histogram.</strong></p>\n\n<p>magnetization-kT\n<a href=\"https://i.stack.imgur.com/turlL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/turlL.jpg\" alt=\"enter image description here\"></a>\ninteral ernergy-kT\n<a href=\"https://i.stack.imgur.com/Ud5m6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ud5m6.jpg\" alt=\"![interal ernergy-kT\"></a></p>\n\n<p>As you see,there are different.I don't know why.I have tried to debug for 10 hours.So I ask someone for help. </p>\n\n<p>Because my single-histogram code is same to this code until MonteCarlo(){},so I think there is error in normalize() and iteration() or main()</p>\n\n<p>And the formula is:\n<a href=\"https://i.stack.imgur.com/BtXMY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BtXMY.png\" alt=\"enter image description here\"></a></p>\n\n<p>magnetization is below:(Q=magnetizatiom)</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Xehc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Xehc.png\" alt=\"enter image description here\"></a></p>\n\n<p>ok,I test this code again.Its error is that after multi-histogram tempolating ,partition function of 1.2 is not simulation partition simulation of 1.2.How should I do?\nAfter I tried again and again,I find error is iterZ() and multi()\nAccording to Newman's <em>Monte Carlo Methods in Statistical Physics</em>,it should converge naturely:\n<a href=\"https://i.stack.imgur.com/jzFhB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jzFhB.png\" alt=\"enter image description here\"></a>\nBut it show me :\n<a href=\"https://i.stack.imgur.com/aa9M8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aa9M8.png\" alt=\"enter image description here\"></a>\nthe first formula is different from the second.It's awful.I don't know why.</p>\n"}, {"tags": ["c++", "boost"], "comments": [{"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "edited": false, "score": 1, "creation_date": 1576702226, "post_id": 59399606, "comment_id": 104988668, "body": "This is not possible."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576706768, "post_id": 59399606, "comment_id": 104990297, "body": "Not sure if you are looking for a feature not supported in boost program options that cli11 calls subcommands: <a href=\"https://github.com/CLIUtils/CLI11#subcommands\" rel=\"nofollow noreferrer\">https://github.com/CLIUtils/CLI11#subcommands</a>"}, {"owner": {"reputation": 2352, "user_id": 4823151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pwh6B.jpg?s=128&g=1", "display_name": "user23573", "link": "https://stackoverflow.com/users/4823151/user23573"}, "edited": false, "score": 0, "creation_date": 1576759979, "post_id": 59399606, "comment_id": 105007398, "body": "What exactly do you mean with &quot;freshly receive new input&quot;. From where? From standard input? Or do you want to process the command line again?"}, {"owner": {"reputation": 701, "user_id": 2007843, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/eb1e32c61d2047d1b4e8c3cdac6d9cb4?s=128&d=identicon&r=PG", "display_name": "user2007843", "link": "https://stackoverflow.com/users/2007843/user2007843"}, "reply_to_user": {"reputation": 2352, "user_id": 4823151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pwh6B.jpg?s=128&g=1", "display_name": "user23573", "link": "https://stackoverflow.com/users/4823151/user23573"}, "edited": false, "score": 0, "creation_date": 1576764478, "post_id": 59399606, "comment_id": 105009771, "body": "@user23573 Standard input is fine"}, {"owner": {"reputation": 2352, "user_id": 4823151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pwh6B.jpg?s=128&g=1", "display_name": "user23573", "link": "https://stackoverflow.com/users/4823151/user23573"}, "edited": false, "score": 0, "creation_date": 1576822891, "post_id": 59399606, "comment_id": 105028069, "body": "@user2007843, then I guess you are expecting the wrong thing from <code>boost::program_options</code> which is for &quot;commandline arguments processing&quot;. If you want to receive from standard input afterwards, you need to <b>start reading</b> from standard input afterwards."}], "owner": {"reputation": 701, "user_id": 2007843, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/eb1e32c61d2047d1b4e8c3cdac6d9cb4?s=128&d=identicon&r=PG", "display_name": "user2007843", "link": "https://stackoverflow.com/users/2007843/user2007843"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576701181, "creation_date": 1576701181, "question_id": 59399606, "link": "https://stackoverflow.com/questions/59399606/boost-program-options-take-input-after-program-has-started", "title": "Boost program options take input after program has started", "body": "<p>I am using boost program options to take command line input. That works great. But I want to be able to continue to receive input once I have run the initial command. </p>\n\n<pre><code>int main (int argc, char** argv) {\n\n    boost::program_options::options_description desc(\"Allowed options\");\n    desc.add_options()\n        (\"help\", \"produce help message\")\n    ;\n    boost::program_options::variables_map vm;\n    boost::program_options::notify(vm);\n\n    while (1) {\n\n    try {\n        boost::program_options::store(boost::program_options::parse_command_line(argc, argv, desc), vm);\n\n        if (vm.count(\"help\")) {\n            cout &lt;&lt; desc &lt;&lt; endl;\n\n            vm.clear();\n        }\n\n    catch (const boost::program_options::error &amp;ex) {\n            cerr &lt;&lt; ex.what() &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>Currently this just keeps looping over once I run the program with the --help option. I want it to take the input once and then clear the map and be able to freshly receive new input. vm.clear() does not do the job and I don't know how else to clear it. Do I need to clear argc and argv?</p>\n"}, {"tags": ["c++", "malloc", "calloc"], "comments": [{"owner": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 1, "creation_date": 1576701105, "post_id": 59399534, "comment_id": 104988293, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/15118990/typecasting-malloc-c\">Typecasting malloc C++</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1576701158, "post_id": 59399534, "comment_id": 104988312, "body": "I edited the tags because you are asking about C++ but in C there is: <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a> In C the received wisdom isn&#39;t just that it is unnecessary but <i>undesirable</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12531529"}, "edited": false, "score": 0, "creation_date": 1576701192, "post_id": 59399534, "comment_id": 104988320, "body": "Also see <a href=\"https://www.quora.com/Do-I-need-to-typecast-a-malloc-returns-type\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 4, "creation_date": 1576701206, "post_id": 59399534, "comment_id": 104988328, "body": "Short answer, because <code>void *</code> in cpp doesn&#39;t convert implicitly, whereas in C it does. It&#39;s how language is designed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 0, "creation_date": 1576701313, "post_id": 59399534, "comment_id": 104988366, "body": "@gst That really is about it.  OP then may ask &quot;why was C++ designed that way?&quot;  Then that&#39;s another question leading down some <a href=\"https://www.merriam-webster.com/dictionary/rabbit%20hole\" rel=\"nofollow noreferrer\">rabbit hole</a>."}, {"owner": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576701383, "post_id": 59399534, "comment_id": 104988387, "body": "@chux-ReinstateMonica That&#39;s something I&#39;d love to hear about as well!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1576701454, "post_id": 59399534, "comment_id": 104988413, "body": "Those are the rules of C++.   Those functions return a <code>void *</code>.  If it were possible, then you should be able to do something simple like this: <code>void *ptr = nullptr; char* a = ptr;</code>, but you get the same error without the cast."}, {"owner": {"reputation": 471, "user_id": 11923373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889288c6e7b927734fc7997eb8e7ffc0?s=128&d=identicon&r=PG&f=1", "display_name": "user11923373", "link": "https://stackoverflow.com/users/11923373/user11923373"}, "reply_to_user": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 1, "creation_date": 1576704208, "post_id": 59399534, "comment_id": 104989367, "body": "@gst: <a href=\"https://softwareengineering.stackexchange.com/questions/275712/why-arent-void-s-implicitly-cast-in-c/275714\">This question</a> and answers sort of address that"}], "answers": [{"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 2, "last_activity_date": 1576701385, "creation_date": 1576701385, "answer_id": 59399651, "question_id": 59399534, "link": "https://stackoverflow.com/questions/59399534/why-is-it-mandatory-to-explicitly-typecast-malloc-and-calloc-in-c/59399651#59399651", "title": "Why is it mandatory to explicitly typecast malloc and calloc in C++?", "body": "<p>In C, it's given <code>T *tp; U *up; void *vp;</code>, one can say <code>vp = tp; up = vp;</code> and end up with a <code>U*</code> which holds the address of a <code>T</code>, without using any casting operators.  The designers of C++, however, wanted to ensure that such a thing couldn't happen without using at least one explicit casting operator somewhere along the way.  In most cases, requiring the casting operator to be used between the time the pointer is represented as a <code>void*</code> and the time it's actually used is less of a nuisance than requiring a casting operator when a pointer is converted to <code>void*</code>, that's what C++ does.  Neither C or C++ allows any syntactic distinction between a <code>void*</code> which was produced by converting the address of an object with a real type, however, versus one that is used to hold the address of a blob of storage with no type, and thus has no way of allowing the latter to be implicitly converted to any type (which would be useful) without doing likewise with the former (which the designers of C++ didn't want).</p>\n"}, {"comments": [{"owner": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 0, "creation_date": 1576705929, "post_id": 59399814, "comment_id": 104989997, "body": "Love the answer! But could you edit it to use &quot;she/he&quot; or even &quot;they&quot; instead of just &quot;he&quot;? Even better, maybe rewrite it using &quot;you&quot;?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 1811, "user_id": 12062404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7672893c82da1651cc0a83bb1c54b623?s=128&d=identicon&r=PG&f=1", "display_name": "gst", "link": "https://stackoverflow.com/users/12062404/gst"}, "edited": false, "score": 1, "creation_date": 1576719423, "post_id": 59399814, "comment_id": 104993402, "body": "@gst sure, here you go"}], "tags": [], "owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "is_accepted": false, "score": 4, "last_activity_date": 1576719412, "last_edit_date": 1576719412, "creation_date": 1576702286, "answer_id": 59399814, "question_id": 59399534, "link": "https://stackoverflow.com/questions/59399534/why-is-it-mandatory-to-explicitly-typecast-malloc-and-calloc-in-c/59399814#59399814", "title": "Why is it mandatory to explicitly typecast malloc and calloc in C++?", "body": "<p>Because in C it is very often you need to use <code>void *</code> for various cases. Some of them is a cookie for a callback - when you provide pointer to user data and you do not have a way to know that data type. Or generic functions like <code>qsort()</code> they have to work with various data without knowing their type in advance. In C++ though you do not need to use <code>void *</code> as often, and in good safe code you do not need to use them at all because you have templates so you write generic code using unknown types without unsafe conversions. So creators of C++ wanted to stimulate proper usage of data types and make sure when developer doing unsafe operations he/she/it/they understands what he/she/it/they is doing.</p>\n\n<p>As <code>malloc()</code> and <code>calloc()</code> return <code>void *</code> you have to convert them explicitly in C++. Note that you are not suppose to use them in C++, but use <code>operator new</code> instead - which returns proper pointer type already and you do not need cast. And even further in modern C++ it is not recommended to even call <code>new</code> directly.</p>\n"}], "owner": {"reputation": 11, "user_id": 11791240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-W2hfSQXmn-Y/AAAAAAAAAAI/AAAAAAAAIFY/LKZi8u8SPMI/photo.jpg?sz=128", "display_name": "Paula", "link": "https://stackoverflow.com/users/11791240/paula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576719412, "creation_date": 1576700811, "last_edit_date": 1576701045, "question_id": 59399534, "link": "https://stackoverflow.com/questions/59399534/why-is-it-mandatory-to-explicitly-typecast-malloc-and-calloc-in-c", "title": "Why is it mandatory to explicitly typecast malloc and calloc in C++?", "body": "<p>I recently read an article which said it's not necessary in C to explicitly typecast malloc and calloc but in C++ it is mandatory. Why is it so? Can anyone explain?</p>\n"}, {"tags": ["c++", "data-structures", "expression-trees"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1576700480, "post_id": 59399412, "comment_id": 104988060, "body": "Please give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Whatever, if you had search on Internet you would have find <a href=\"https://softwareengineering.stackexchange.com/questions/290529/algorithm-to-go-from-infix-notation-to-a-tree\" title=\"algorithm to go from infix notation to a tree\">softwareengineering.stackexchange.com/questions/290529/&hellip;</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576700480, "post_id": 59399412, "comment_id": 104988061, "body": "You will have a better Stack Overflow experience if you attempt to solve the problem and ask questions, if necessary, about the attempt."}, {"owner": {"reputation": 3008, "user_id": 1863938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ec4e16681460302ea67bfc201b76f3?s=128&d=identicon&r=PG", "display_name": "parktomatomi", "link": "https://stackoverflow.com/users/1863938/parktomatomi"}, "edited": false, "score": 0, "creation_date": 1576700564, "post_id": 59399412, "comment_id": 104988080, "body": "Writing an expression parser is a non-trivial amount of work, and there are a lot of ways to go about doing it. But you&#39;re not the first person to ask. do any of these answers help? <a href=\"https://stackoverflow.com/questions/11703082/parsing-math-expression-in-c\" title=\"parsing math expression in c\">stackoverflow.com/questions/11703082/&hellip;</a>"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1576706092, "post_id": 59399412, "comment_id": 104990053, "body": "Out of curiosity, what happens when your program encounters a two-character operator like <code>==</code>?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1576706380, "post_id": 59399412, "comment_id": 104990156, "body": "Last I remember, you build a tree from the expression.  The traversing algorithm determined whether you got Postfix, Infix, or Prefix notation."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1576706505, "post_id": 59399412, "comment_id": 104990193, "body": "Please edit your post with the results of your debugging session.  For example, which statement causes the issue?  What are the values of the variables in that statement?  What are expected values?"}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 1, "creation_date": 1576707240, "post_id": 59399412, "comment_id": 104990459, "body": "I have a python implementation in this answer, along with the secret of how to do this yourself without a whole lot of code: <a href=\"https://stackoverflow.com/questions/42610626/is-it-necessary-to-convert-infix-notation-to-postfix-when-creating-an-expression/42612892#42612892\" title=\"is it necessary to convert infix notation to postfix when creating an expression\">stackoverflow.com/questions/42610626/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 592, "user_id": 752345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80df1901edc02f0d1a18627d9e458688?s=128&d=identicon&r=PG&f=1", "display_name": "BizarreCake", "link": "https://stackoverflow.com/users/752345/bizarrecake"}, "is_accepted": false, "score": 0, "last_activity_date": 1576704527, "creation_date": 1576704527, "answer_id": 59400231, "question_id": 59399412, "link": "https://stackoverflow.com/questions/59399412/expression-tree-from-infix-expression-in-c-structural-programming/59400231#59400231", "title": "Expression Tree from Infix Expression in C++ Structural Programming", "body": "<p>You are trying to write a parser.</p>\n\n<p>There are so many ways to do this, with some ways being especially optimized for infix expressions, and others being more general.</p>\n\n<p>I personally suggest reading about <a href=\"https://en.wikipedia.org/wiki/Recursive_descent_parser\" rel=\"nofollow noreferrer\">Recursive Descent</a> parsers, as they are a  good starting point to learn about parsers since they are relatively simple and intuitive.</p>\n\n<p>A simple recursive descent parser that handles expression with addition, subtraction, multiplication, division and parentheses would look something like this (<strong><em>This is pseudocode!</em></strong>):</p>\n\n<pre><code>node* readExpr() {\n    return readAddOrSub();\n}\n\nnode* readAddOrSub() {\n    leftTree = readMulOrDiv();\n    token = peekNextToken();  // look at the next token without consuming it \n    if (token == '+' || token == '-') {\n         readNextToken();  // skip operator\n         rightTree = readAddOrSub();\n         return an addition or subtraction node with leftTree and rightTree as its left and right sub-trees respectively;\n    } else {\n         return leftTree;\n    }\n}\n\nnode* readMulOrDiv() {\n    leftTree = readAtom();\n    token = peekNextToken();\n    if (token == '*' || token == '/') {\n         readNextToken();  // skip operator\n         rightTree = readMulOrDiv();\n         return a multiplication node with leftTree and rightTree as its left and right sub-trees respectively;\n    } else {\n         return leftTree;\n    }\n}\n\nnode* readAtom() {\n    token = readNextToken()\n    if (token == '(') {\n         result = readExpr();\n         read another token and make sure it's ')';\n         return result;\n    } else if (token is a number)\n         return node holding a number;\n    else if (token is a variable)\n         return node holding a variable;\n    else\n         error();\n}\n</code></pre>\n\n<p>This assumes you have something that breaks up your string apart into tokens (e.g. \"5*(a+12)\" should be broken into 7 tokens: the number 5, '*', '(', the variable 'a', '+', the number 12, ')').</p>\n\n<p>Operator precedence is captured by the way that functions that parse an opeator of a certain precedence level call the functions that handle the next level of precedence in a hierarchical fashion. More specifically, a function that tries to parse an addition/subtraction node (readAddOrSub) calls the function that parses the next level of precedence (readMulOrDiv) to get its left and right sub-trees.</p>\n\n<p>Note that readAddOrSub (and readMulOrDiv) calls itself to read the right-subtee so that multiple additions can be chained together (\"1+2+3\"), but beware that this makes the parser inherently <strong>right-associative</strong> (\"1+2+3\" will be parsed as \"1+(2+3)\").</p>\n\n<p>Of course, it's not very hard to make it left-associative, but I'll leave that to you as an exercise!</p>\n\n<p>Some resources that might help:</p>\n\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Recursive_descent_parser\" rel=\"nofollow noreferrer\">Wikipedia article about recursive descent</a></li>\n<li><a href=\"https://github.com/steshaw/blue/blob/master/Parser.cs\" rel=\"nofollow noreferrer\">A recursive descent parser that parses C# (written in C#)</a></li>\n<li><a href=\"https://github.com/jamesgregson/expression_parser/blob/master/code/expression_parser.c\" rel=\"nofollow noreferrer\">A recursive descent expression parser written in C</a></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 11147436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BnO8NSZ-i3E/AAAAAAAAAAI/AAAAAAAAADs/L3olWMhMh2M/photo.jpg?sz=128", "display_name": "Sohaib Ahmad Khan", "link": "https://stackoverflow.com/users/11147436/sohaib-ahmad-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576704527, "creation_date": 1576700116, "question_id": 59399412, "link": "https://stackoverflow.com/questions/59399412/expression-tree-from-infix-expression-in-c-structural-programming", "title": "Expression Tree from Infix Expression in C++ Structural Programming", "body": "<pre><code>struct node\n{\n char data;\n node *left, *right;\n};\n\nconstructTree(string expression)\n{\n for(i = 0; i &lt; expression.length(); i++)\n {\n  if(!(isOperator(expression[i]))\n  {\n   temp = createNode(expression[i]);\n   push(temp);\n  }\n  else\n  {\n   temp = createNode(expression[i]);\n   node *temp1, *temp2;\n   temp1 = pop();\n   temp2 = pop();\n   temp-&gt;left = temp1;\n   temp-&gt;right = temp2;\n  }\n }\n}\n\nint main()\n{\n string expression = \"(a+b)-c*(d/e)\";\n constructTree(expression);\n}\n</code></pre>\n\n<p>I want to construct expression tree from infix expression which I will take as a string from the user. I tried so much now I am feeling tired of it. Some body please help me in making this expression tree from infix expression!</p>\n"}, {"tags": ["python", "c++", "opencv"], "comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 3, "creation_date": 1576701241, "post_id": 59399212, "comment_id": 104988342, "body": "Unrelated to problem: Don&#39;t use <code>final</code> as identifier in C++. It is a keyword since C++11. While it isn&#39;t a reserved identifier outside of the specific syntax where the <code>final</code> keyword applies, using it in other context will be confusing. See for example the syntax highlighting in your question."}, {"owner": {"reputation": 17643, "user_id": 5087436, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZyXHE.jpg?s=128&g=1", "display_name": "alkasm", "link": "https://stackoverflow.com/users/5087436/alkasm"}, "edited": false, "score": 2, "creation_date": 1576706100, "post_id": 59399212, "comment_id": 104990059, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/15049811/opencv-error-multiplying-2-mats\">opencv error multiplying 2 Mat&#39;s</a>"}], "owner": {"reputation": 103, "user_id": 9136737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd435cdeae5d93ebe9fc37dffedc6a0?s=128&d=identicon&r=PG&f=1", "display_name": "already puzzled", "link": "https://stackoverflow.com/users/9136737/already-puzzled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1576701623, "creation_date": 1576699152, "last_edit_date": 1576701623, "question_id": 59399212, "link": "https://stackoverflow.com/questions/59399212/opencv-matrix-math-behavior-change-going-from-python-to-c", "title": "openCV matrix math behavior change going from python to c++", "body": "<p>The big picture is that I am attempting to do a alpha-blend using a gradation contained in a mask. I have a handful of canvas Mat objects and associated alpha_mask Mat objects.\nI alpha-blend the canvas on to the final using the associated alpha_mask, which is the displayed output.</p>\n\n<p>canvas[i] is datatype 16  8-bit unsigned 3 layer\nfinal is datatype 16  8-bit unsigned 3 layer\nalpha_mask[i] is datatype 5  floating point 1 layer</p>\n\n<p>My python code is working:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>final = cv.convertScaleAbs(canvas[i] * alpha_mask[i] + final * (1-alpha_mask[i]))\n</code></pre>\n\n<p>When I try the same with C++ I get a run-time matrix multiplication error (I think):</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>convertScaleAbs(canvas[i] * alpha_mask[i] + final * (1.0-alpha_mask[i]), final, 1,0);\n</code></pre>\n\n<p>Here is the error message:</p>\n\n<p>terminate called after throwing an instance of 'cv::Exception'\n  what():  OpenCV(4.1.2) /usr/local/src/opencv/modules/core/src/matmul.dispatch.cpp:337: error: (-215:Assertion failed) type == B.type() in function 'gemm'</p>\n\n<p>What should I do?</p>\n"}, {"tags": ["c++", "sorting", "comparator", "projection"], "comments": [{"owner": {"reputation": 5009, "user_id": 1455108, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zaRtd.jpg?s=128&g=1", "display_name": "Jo&#227;o Paulo", "link": "https://stackoverflow.com/users/1455108/jo%c3%a3o-paulo"}, "edited": false, "score": 5, "creation_date": 1576698954, "post_id": 59399164, "comment_id": 104987473, "body": "No. Algorithms is range based using iterators. But you can always do by yourself a version with one arg..."}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "edited": false, "score": 0, "creation_date": 1576699503, "post_id": 59399164, "comment_id": 104987673, "body": "You may want the c++ 20 ranges. Before that it was all iterator pairs."}], "answers": [{"tags": [], "owner": {"reputation": 3035, "user_id": 1413244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BaB5H.png?s=128&g=1", "display_name": "jwezorek", "link": "https://stackoverflow.com/users/1413244/jwezorek"}, "is_accepted": false, "score": 0, "last_activity_date": 1576700935, "last_edit_date": 1576700935, "creation_date": 1576700534, "answer_id": 59399483, "question_id": 59399164, "link": "https://stackoverflow.com/questions/59399164/using-a-projection-from-the-elements-instead-of-a-comparator-for-sorting/59399483#59399483", "title": "Using a projection from the elements instead of a comparator for sorting", "body": "<p>If I'm understanding the question correctly, you are asking if there is a sort function in the standard library that sorts by a given key rather than with a comparator.</p>\n\n<p>There is nothing like this in the standard library. In Python, since objects are table-based -- since the fundamental notion of a struct or a record is ultimately implemented in the language as a mapping between string keys and values that may be functions -- it is possible to succinctly refer to a field as a string. In C++ this is not the case. If you have a something like</p>\n\n<pre><code>struct Foo {\n    std::string name;\n    int id;\n};\n</code></pre>\n\n<p>the names of the fields,\"name\" and \"id\", are not known to the running program; they exist only as artifacts of the source code. So to do something like the Python key-based sort you would need to provide a function (or a callable object anyway) to extract the key value you want to use from each item. </p>\n\n<p>Something like the following would work:</p>\n\n<pre><code>template&lt;typename Iter, typename Func&gt;\nvoid sort_by_key(Iter from, Iter to, Func get_key) {\n    std::sort(from, to, \n        [get_key](auto lhs, auto rhs) {\n            return get_key(lhs) &lt; get_key(rhs);\n        }\n    );\n}\n\nstruct Foo {\n    std::string name;\n    int id;\n};\n\n...\n\nstd::vector&lt;Foo&gt; foobar{ {\"quux\", 10000}, {\"mumble\", 12}, {\"frobnicate\", 42} };\nsort_by_key(foobar.begin(), foobar.end(), [](const Foo&amp; foo) {return foo.name; });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 3, "last_activity_date": 1608241319, "last_edit_date": 1608241319, "creation_date": 1576702138, "answer_id": 59399784, "question_id": 59399164, "link": "https://stackoverflow.com/questions/59399164/using-a-projection-from-the-elements-instead-of-a-comparator-for-sorting/59399784#59399784", "title": "Using a projection from the elements instead of a comparator for sorting", "body": "<p>Using ranges instead of iterator-pairs when you want will come with C++20.</p>\n<p>Aside from that, a projection (in combination with a flag for reversing the order) is more concise where the job is straight-forward, like all sub-keys in the same order, and all sorted according to their &quot;natural&quot; ordering.<br />\nA comparator is not relentlessly optimised for that scenario, trading that ease for all-around optimal performance and easy implementation of more demanding and even outright weird orders.</p>\n<p>Python's <a href=\"https://docs.python.org/3/library/functions.html#sorted\" rel=\"nofollow noreferrer\"><code>sorted()</code></a> only allows for a projection and optional reverse-flag.</p>\n<p><a href=\"https://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\"><code>std::sort()</code></a> sorts elements, optionally according to a custom comparator. In principle, it could be extended to try using the passed function-object (if any) as a projection if it doesn't work as a comparator, feel free to propose it for standardisation.</p>\n<p>Until and unless that happens, you can easily synthesise a comparison from a projection and an order-relation though:</p>\n<pre><code>template &lt;class Projection, class Comparator = std::less&lt;&gt;&gt;\nstruct use_projection {\n    [[no_unique_address]] Projection p = Projection();\n    [[no_unique_address]] Comparator c = Comparator();\n    template &lt;class... T&gt;\n    auto operator()(T&amp;&amp;... t) const\n    noexcept(noexcept(c(p(std::forward&lt;T&gt;(t))...)))\n    -&gt; decltype(c(p(std::forward&lt;T&gt;(t))...))\n    { return c(p(std::forward&lt;T&gt;(t))...); }\n};\n\nauto my_projection = [](auto&amp;&amp; x)-&gt;auto&amp;&amp; { return x.y; };\nstd::sort(v.begin(), v.end(), use_projection{my_projection});\nstd::sort(v.begin(), v.end(), use_projection{my_projection, std::greater()});\n</code></pre>\n<p>Adapting that idea for pre-C++17 is left as an exercise for the reader.</p>\n"}], "owner": {"reputation": 41, "user_id": 4393021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/759e7a77b32ef96a766fe6c14fffa2ba?s=128&d=identicon&r=PG&f=1", "display_name": "MrNewman", "link": "https://stackoverflow.com/users/4393021/mrnewman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1608241319, "creation_date": 1576698842, "last_edit_date": 1576702254, "question_id": 59399164, "link": "https://stackoverflow.com/questions/59399164/using-a-projection-from-the-elements-instead-of-a-comparator-for-sorting", "title": "Using a projection from the elements instead of a comparator for sorting", "body": "<p>I searched for c++ analog for this (python):</p>\n\n<pre><code>sorted(vector, key=lambda x : my_function(x))\n</code></pre>\n\n<p>There is of course the construction:</p>\n\n<pre><code>std::sort(vector.begin(), vector.end(), [](const auto&amp; lhs, const auto&amp; rhs) {\n    return my_function(lhs) &lt; my_function(rhs);\n});\n</code></pre>\n\n<p>I just wondering if one-argument construction exists.</p>\n"}, {"tags": ["c++", "algorithm", "search", "compare"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1576698468, "post_id": 59399013, "comment_id": 104987272, "body": "&quot;<i>Below is the code that is not working</i>&quot; Not working.. How?"}, {"owner": {"reputation": 3839, "user_id": 9171697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/475b59ee1312dc014fbe1eebcd91d307?s=128&d=identicon&r=PG&f=1", "display_name": "Meowmere", "link": "https://stackoverflow.com/users/9171697/meowmere"}, "edited": false, "score": 0, "creation_date": 1576698975, "post_id": 59399013, "comment_id": 104987483, "body": "<code>test1</code> is not captured in your lambda. You can capture it by <code>[&amp;]</code>. For more information, refer to <a href=\"https://en.cppreference.com/w/cpp/language/lambda#Lambda_capture\" rel=\"nofollow noreferrer\">cppreference</a>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1576699257, "post_id": 59399013, "comment_id": 104987578, "body": "There also <code>set_intersection</code> in the <a href=\"https://en.cppreference.com/w/cpp/header/algorithm\" rel=\"nofollow noreferrer\"><code>&lt;algorithm&gt;</code> library</a>  may be of use to you."}], "answers": [{"comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576699241, "post_id": 59399211, "comment_id": 104987568, "body": "Note: consider recommending capturing such classes, as <code>std::vector</code>, by reference, to avoid doing copies, of (potentially) large amounts of data."}, {"owner": {"reputation": 85, "user_id": 2273635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5wdY.jpg?s=128&g=1", "display_name": "liskawc", "link": "https://stackoverflow.com/users/2273635/liskawc"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576704701, "post_id": 59399211, "comment_id": 104989587, "body": "the point here is to demonstrate to the user the bit that was wrong, not write optimal code. if that is needed then @user4581301&#39;s comment is more to the point."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1576707737, "post_id": 59399211, "comment_id": 104990656, "body": "I know that. It&#39;s that it&#39;s easier to learn good habits from a get go, than to unlearn bad habits. And in more than 90% of use cases, you would want to pass/capture containers by reference, due to the ease of doing so, and performance benefits, that it brings."}], "tags": [], "owner": {"reputation": 85, "user_id": 2273635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5wdY.jpg?s=128&g=1", "display_name": "liskawc", "link": "https://stackoverflow.com/users/2273635/liskawc"}, "is_accepted": false, "score": 0, "last_activity_date": 1576699142, "creation_date": 1576699142, "answer_id": 59399211, "question_id": 59399013, "link": "https://stackoverflow.com/questions/59399013/c-comparing-vectors-using-any-of-not-working/59399211#59399211", "title": "C++ comparing vectors using any_of not working", "body": "<p>in lambda's you have to capture the stuff you want to be inside from the outside. that is put it in the square brackets. for example like this:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt; \n\nusing namespace std;\n\nint main(){\n\n  vector&lt;int&gt; test1({1,2,3,4});\n  vector&lt;int&gt; test2({1,2,5,6});\n  for(int i=0; i&lt;test1.size(); i++){\n    if(any_of(test2.begin(),test2.end(),[test1,i](int integer){return integer==test1[i];})){\n      cout &lt;&lt; \"you have an element in test1 that is also in test2\" &lt;&lt; endl;\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<p>i got that to compile and pump out the outputs. not sure if it does what you want tho...</p>\n"}, {"comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1576699257, "post_id": 59399219, "comment_id": 104987579, "body": "Note: consider recommending capturing such classes, as std::vector, by reference, to avoid doing copies, of (potentially) large amounts of data."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576699397, "post_id": 59399219, "comment_id": 104987636, "body": "Instead of capturing <code>i</code> and <code>test1</code>, see if you can rework your example to capture <code>test[i]</code>."}], "tags": [], "owner": {"reputation": 93, "user_id": 11387298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8cd1cdfd06564e65c2e06be683140f4?s=128&d=identicon&r=PG&f=1", "display_name": "Hussam", "link": "https://stackoverflow.com/users/11387298/hussam"}, "is_accepted": false, "score": 0, "last_activity_date": 1576699358, "last_edit_date": 1576699358, "creation_date": 1576699187, "answer_id": 59399219, "question_id": 59399013, "link": "https://stackoverflow.com/questions/59399013/c-comparing-vectors-using-any-of-not-working/59399219#59399219", "title": "C++ comparing vectors using any_of not working", "body": "<p>you need to pass i and test1 to the lambda expression as so:</p>\n\n<p>vector test1 = { 1,2,3,4 };\n    vector test2 = { 1,2,5,6 };</p>\n\n<pre><code>for (int i = 0; i &lt; test1.size(); i++)\n{\n    if (any_of(test2.begin(), test2.end(), [&amp;i,&amp;test1](int integer) {return integer == test1[i]; }))\n    {\n        cout &lt;&lt; \"you have an element in test1 that is also in test2\" &lt;&lt; endl;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12560830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689dadf94e589719489f24739119f4b8?s=128&d=identicon&r=PG&f=1", "display_name": "rolaluv", "link": "https://stackoverflow.com/users/12560830/rolaluv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576710400, "creation_date": 1576697931, "question_id": 59399013, "link": "https://stackoverflow.com/questions/59399013/c-comparing-vectors-using-any-of-not-working", "title": "C++ comparing vectors using any_of not working", "body": "<p>I have two vectors each containing a set of integers that I would like to compare to see if they have the same elements. I'm using 'any_of' in the algorithms library and would like to iterate through the elements in one vector and see if the element appears in another vector. Below is the code that is not working:</p>\n\n<pre><code>vector&lt;int&gt; test1 = {1,2,3,4};\nvector&lt;int&gt; test2 = {1,2,5,6};\nfor(int i=0;i&lt;test1.size();i++)\n{\n    if(any_of(test2.begin(),test2.end(),[](int integer){return integer==test1[i];}))\n    {\n      cout &lt;&lt; \"you have an element in test1 that is also in test2\" &lt;&lt; endl;\n    }\n}\n</code></pre>\n\n<p>The problem is the if statement, and if I compare 'integer' with a number written out (i.e. 1,2, etc) the loop executes fine. Any help would be appreciated!</p>\n"}, {"tags": ["c++", "lambda", "clang++", "dangling-pointer"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 4, "creation_date": 1576697978, "post_id": 59398973, "comment_id": 104987053, "body": "Using dangling reference is undefined behavior. Meaning: standard doesn&#39;t define the behavior, of such program, so, it is allowed to do, literally anything, including, but not limited to: crashing, printing wrong values, or working as expected."}, {"owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576698044, "post_id": 59398973, "comment_id": 104987089, "body": "Yes, I agree that it is valid - the question is more one of how it&#39;s managing to pull off this trick."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576698237, "post_id": 59398973, "comment_id": 104987169, "body": "@Mark 1) Discussing about specific undefined behavior is pointless, because one cannot rely on such behavior, since the behavior can change with (but not limited to): different compiler, different version of the same compiler, different flags passed to the compiler, unrelated minor changes to the code, such as unused variable declarations, or just different time of day. 2) If you want to see what, exactly, your code compiles to, compile to assembly, and look through that, to get understanding, what it does, in your, particular, instance."}, {"owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "edited": false, "score": 0, "creation_date": 1576698563, "post_id": 59398973, "comment_id": 104987319, "body": "Oh that&#39;s interesting..."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1576698634, "post_id": 59398973, "comment_id": 104987349, "body": "@Mark Enable optimizations in Wandbox and it doesn&#39;t work there either. The behavior you are seeing happens only when using libc++ (instead of libstdc++) and when optimizations are disabled: <a href=\"https://godbolt.org/z/WPHyhJ\" rel=\"nofollow noreferrer\">godbolt.org/z/WPHyhJ</a> There is nothing intentional about it."}, {"owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576698702, "post_id": 59398973, "comment_id": 104987373, "body": "@AlgirdasPreid\u017eius, i agree with you about discussing the undefined behavior. Remember, what started this quest was a hope that we could capture the error at compile time. Right now I don&#39;t have a compiler that detects this, and the one static analysis tool I&#39;m using doesn&#39;t detect it either. I think this specific error with lambda capture references is one that is easy to make, especially for programmers not entirely comfortable with the concepts yet. So automated detection would be a boon."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576698906, "post_id": 59398973, "comment_id": 104987448, "body": "@Mark &quot;<i>Right now I don&#39;t have a compiler that detects this</i>&quot; There is no requirement, by the standard, for compilers, to catch every possible instance of undefined behavior. In general, such a task is impossible. One can, possibly, detect simple (toy) examples, of undefined behavior, but fail to do so in more complex, and more real-world-like examples."}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1576699035, "post_id": 59398973, "comment_id": 104987511, "body": "@Mark What about ASAN. Does it not detect this particular problem?"}, {"owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1576699923, "post_id": 59398973, "comment_id": 104987840, "body": "@walnut I don&#39;t know the answer to that - I need to try it out. In my particular use case, address sanitizer is not an option, so it wasn&#39;t on my radar."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1576701743, "post_id": 59398973, "comment_id": 104988501, "body": "Gosh, what could be varying from 0 to 3 in <code>main</code>? Could it be the variable <code>j</code>?"}, {"owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1576765001, "post_id": 59398973, "comment_id": 105010059, "body": "@RaymondChen - you nailed it, and I appreciate the comment. Sometimes it&#39;s right there in front of you... I changed to the iteration over the array of lambdas to for ( auto fn : fns) and boom, it&#39;s back to broken."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1576765844, "creation_date": 1576765844, "answer_id": 59411775, "question_id": 59398973, "link": "https://stackoverflow.com/questions/59398973/how-does-clang-9-0-magically-cure-dangling-reference-use-in-a-lambda/59411775#59411775", "title": "How does clang++ 9.0 magically cure dangling reference use in a lambda?", "body": "<p>Based on the comment train, and in particular a comment from @RaymondChen, it became clear that clang did <em>not</em> fix this problem. The generated code made it <em>look</em> like they fixed it, but it was just some very fortuitous undefined behavior. </p>\n\n<p>With almost 100% certainty, we can say this:</p>\n\n<ul>\n<li>The lambda functions created a dangling reference to variable <code>i</code>, an auto which disappeared from the stack before the lambdas were used.</li>\n<li>Calling the lambda then pointed to random data on or around the stack, the value of which could be anything.</li>\n<li>In most of the implementations, the value pointed to was clearly not what was desired.</li>\n<li>In clang 9, luckily enough, the dangling reference pointer was pointing to loop variable <code>j</code>, which was in scope, and was iterating from 0 to 3, making it <em>appear</em> as if we somehow had a good copy of the dangling reference.</li>\n</ul>\n\n<p>Changing the loop in <code>main()</code> to iterate of the lambda references like this:</p>\n\n<pre><code>   for (auto fn: fns ) {\n</code></pre>\n\n<p>eliminates loop variable j, so now the output is:</p>\n\n<pre><code>0x7ffc0f21a100 0x7ffc0f21a100 0x7ffc0f21a100 0x7ffc0f21a100 \n0x7ffc0f21a100: 4212390, 0x7ffc0f21a100: 4212390, 0x7ffc0f21a100: 4212390, 0x7ffc0f21a100: 4212390\n</code></pre>\n\n<p>Still looking for good ways to detect this kind of programming error that gives us an adjunct to eternal human vigilance. Herb Sutter's <a href=\"https://herbsutter.com/2018/09/20/lifetime-profile-v1-0-posted/\" rel=\"nofollow noreferrer\">Lifetime profile</a> would be a really good way of doing this, if it ever comes to pass.</p>\n"}], "owner": {"reputation": 81, "user_id": 463176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wyUUj.jpg?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/463176/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1576765844, "creation_date": 1576697720, "question_id": 59398973, "link": "https://stackoverflow.com/questions/59398973/how-does-clang-9-0-magically-cure-dangling-reference-use-in-a-lambda", "title": "How does clang++ 9.0 magically cure dangling reference use in a lambda?", "body": "<p>I was experimenting on wandbox in hopes of finding compiler warnings that would help with inadvertent dangling references in lambdas. I had <a href=\"https://wandbox.org/permlink/BKO3bNwhdTzjaUDH\" rel=\"nofollow noreferrer\">this example</a> which misbehaves in multiple ways:</p>\n\n<pre><code>std::array&lt;std::function&lt;const int *(void)&gt;,N&gt; createFunctions()\n{\n    std::array&lt;std::function&lt;const int *(void)&gt;,N&gt; fns;\n    for ( int i = 0 ; i &lt; N ; i++ ) {\n        std::cout &lt;&lt; &amp;i &lt;&lt; \" \";\n        fns[i] = [&amp;]() {\n            return &amp;i;\n        };\n    }\n    std::cout &lt;&lt; \"\\n\";\n    return fns;\n}\n</code></pre>\n\n<p>This stuffs a set of lambdas into an array of functions. Each lambda returns a pointer to a reference to a captured variable, <code>i</code>. Should be trouble all around.</p>\n\n<p>My driver routine prints out the pointer, and dereferences it as well.</p>\n\n<pre><code>int main()\n{\n  auto fns = createFunctions();\n  for (int j = 0 ; j &lt; N ; j++ ) {\n    if (j != 0)\n      std::cout &lt;&lt; \", \";\n    std::cout &lt;&lt; fns[j]() &lt;&lt; \": \" &lt;&lt; *fns[j]();\n  }\n  std::cout &lt;&lt; \"\\n\";\n  return 0;\n}\n</code></pre>\n\n<p>If this lambda was modified to pass <code>i</code> by copy, you'd get output like this - four pointers, and four pointers with unique values:</p>\n\n<pre><code>0x7ffc80e65358 0x7ffc80e65358 0x7ffc80e65358 0x7ffc80e65358 \n0x7ffc80e65380: 0, 0x7ffc80e653a0: 1, 0x7ffc80e653c0: 2, 0x7ffc80e653e0: 3\n</code></pre>\n\n<p>When it is written in error, taking a reference that passes silently out of scope, it miraculously runs without faulting, but clearly shows the error of its ways</p>\n\n<pre><code>0x7ffeebdfe9f4 0x7ffeebdfe9f4 0x7ffeebdfe9f4 0x7ffeebdfe9f4 \n0x7ffeebdfe9f4: 32766, 0x7ffeebdfe9f4: 32766, 0x7ffeebdfe9f4: 32766, 0x7ffeebdfe9f4: 32766\n</code></pre>\n\n<p>All four pointers are identical, and the value they are pointing to is bogus.</p>\n\n<p>This is the case for all versions of g++, and all versions of clang++ up to 8.x. But clang 9.0 miraculously deals with it in a magical way:</p>\n\n<pre><code>0x7ffd193bfa30 0x7ffd193bfa30 0x7ffd193bfa30 0x7ffd193bfa30 \n0x7ffd193bfa30: 0, 0x7ffd193bfa30: 1, 0x7ffd193bfa30: 2, 0x7ffd193bfa30: 3\n</code></pre>\n\n<p>The part that is really interesting is that the pointer to the reference has the same value in all four lambdas - but dereferencing them returns four different values. I have tried to come up with a good explanation for how this can be, but I'm stumped.</p>\n\n<p>I'm guessing that it is an intentional optimization in which the compiler has deduced what I <em>want</em> to do, and makes it happen. Since using a dangling reference falls into that \"undefined behavior\" category, the compiler is free to do what it likes. But is this the case?</p>\n\n<p>If the compiler is smart enough to figure that out, it seems like it would be smart enough to issue a warning, but I don't get that.</p>\n"}, {"tags": ["c++", "multithreading", "locking", "lock-free", "spinlock"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1576696018, "post_id": 59398554, "comment_id": 104986275, "body": "I believe that this is going to be platform-specific and that you have exited the zone of what can be done portably."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1576696288, "post_id": 59398554, "comment_id": 104986371, "body": "That&#39;s ok.  I&#39;ll add a note about it. @DavidSchwartz"}, {"owner": {"reputation": 799, "user_id": 8366816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29020983ccbb8941f6a319ed39d90b9d?s=128&d=identicon&r=PG&f=1", "display_name": "A.K.", "link": "https://stackoverflow.com/users/8366816/a-k"}, "edited": false, "score": 0, "creation_date": 1576696412, "post_id": 59398554, "comment_id": 104986407, "body": "You might have to read years of comp.programming.threads to answer this."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 799, "user_id": 8366816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29020983ccbb8941f6a319ed39d90b9d?s=128&d=identicon&r=PG&f=1", "display_name": "A.K.", "link": "https://stackoverflow.com/users/8366816/a-k"}, "edited": false, "score": 0, "creation_date": 1576696469, "post_id": 59398554, "comment_id": 104986429, "body": "@A.K. well that&#39;s why I&#39;m asking for help, because maybe somebody has done that already and has some wisdom to share."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1576696559, "post_id": 59398554, "comment_id": 104986466, "body": "Punching &quot;CPU relax&quot; into your favorite search engine may be helpful. By the way, your bigger problem is not about not burning the CPU, it&#39;s about the fact that you care deeply about performance but are going to take the mother of all branch mispredictions the moment this thread has real work to do. Also, the busy core will draw of the CPU&#39;s power and heat budgets, potentially slowing other cores down, (All deeply platform specific.)"}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 2, "creation_date": 1576696799, "post_id": 59398554, "comment_id": 104986563, "body": "On Intel platforms, this seems to be what the PAUSE instruction (<code>_mm_pause()</code> intrinsic) is for."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576697010, "post_id": 59398554, "comment_id": 104986656, "body": "<i>&quot;efficiently&quot; in the sense that we probably don&#39;t need to be burning at 100% of the processor&#39;s capacity</i> This is a contradiction unless you&#39;re talking about hyperthreading (SMT), in which case you want <code>_mm_pause()</code>.  Or do you mean you hope there&#39;s a system call that will low-power sleep the core without letting another task pollute cache on it?"}, {"owner": {"reputation": 799, "user_id": 8366816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29020983ccbb8941f6a319ed39d90b9d?s=128&d=identicon&r=PG&f=1", "display_name": "A.K.", "link": "https://stackoverflow.com/users/8366816/a-k"}, "edited": false, "score": 4, "creation_date": 1576697037, "post_id": 59398554, "comment_id": 104986672, "body": "You should avoid inventing synchronization primitives unless you are really sure the OS-provided ones do not work. Context switches are damaging when they are very frequent, e.g.hundreds of thousands per second. You might want to first quantify how much this actually is a problem"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 799, "user_id": 8366816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29020983ccbb8941f6a319ed39d90b9d?s=128&d=identicon&r=PG&f=1", "display_name": "A.K.", "link": "https://stackoverflow.com/users/8366816/a-k"}, "edited": false, "score": 0, "creation_date": 1576697614, "post_id": 59398554, "comment_id": 104986892, "body": "@A.K., inserting an OS yield in the <code>else</code> causes latency spikes of 250% in my simple test case.  I am following the wisdom in a <a href=\"https://www.youtube.com/watch?v=Q0vrQFyAdWI\" rel=\"nofollow noreferrer\">talk</a> by the implementors of Ableton to avoid locks and context switches within the rendering cycle."}], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576716478, "creation_date": 1576695737, "last_edit_date": 1576716478, "question_id": 59398554, "link": "https://stackoverflow.com/questions/59398554/high-performance-spinlock-best-practice", "title": "High-performance spinlock best practice", "body": "<p>I'm writing a realtime audio multithreaded application, and during the render cycle sometimes there will be no jobs on the work queue.  I would like the thread to wait for jobs without triggering an OS context switch (which could be too damaging to performance), yet also \"efficiently\" in the sense that we probably don't need to be burning at 100% of the processor's capacity.  I'm not quite sure what that means, but apparently Windows has a <code>WaitForProcessor()</code> function which indicates we are spinlocking and it can use a bit of the processor for hyperthreads, so it made me think that there could be a best practice here.  It is a cross-platform application.</p>\n\n<p>If there is no portable solution, I'm interested in platform-specific information for Windows, MacOS, Android, and iOS.</p>\n\n<p>Currently it looks essentially like this:</p>\n\n<pre><code>// Variables shared between threads:\nstd::atomic&lt;bool&gt; done;\nLockFreeFIFO&lt;Job&gt; workQueue;\n\n// Thread process loop:\nwhile (!done.load()) {\n    Job job;\n    if (workQueue.remove(&amp;job)) {\n        job.run();\n    }\n    else {\n        // \"semi-yield\"?   What goes here?\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "audio", "juce"], "owner": {"reputation": 11, "user_id": 12560613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242483054afca5d1fff813846265a73c?s=128&d=identicon&r=PG&f=1", "display_name": "encoded", "link": "https://stackoverflow.com/users/12560613/encoded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576694802, "creation_date": 1576694802, "question_id": 59398358, "link": "https://stackoverflow.com/questions/59398358/how-to-integrate-into-qt-an-external-audio-library-for-android-juce-superpower", "title": "How to integrate into Qt an external audio library for Android? JUCE? Superpowered?", "body": "<p>Has anyone managed to successfully integrate Qt with another audio library or SDK?</p>\n\n<p>I am developing a Android (armeabi-v7a) application using Qt 5.13.2 on my macOs 10.13.6.</p>\n\n<p>Being the limitation of Qt as regards DSP, I was considering using the functionalities of external library. However this has been a real pain, probably because I am a beginner when it comes to low-level software engineering.</p>\n\n<p>The example in this rep(<a href=\"https://github.com/nikeocom/qt_with_juce_example\" rel=\"nofollow noreferrer\">https://github.com/nikeocom/qt_with_juce_example</a>) does build and deploy for my android but it then crashes giving the errors reported below. \nSame thing happens when I try to integrate Superpowered SDK: it does compile, but than it crashes giving errors about an invalid pointer.</p>\n\n<p>ERRORS:</p>\n\n<pre><code>E/AEE/AED (21028): timed out waiting for tid=20709 to stop\nW/libbacktrace(21028): virtual bool BacktracePtrace::ReadWord(uintptr_t, word_t*): invalid pointer 0xbec2b000 reading from tid 20709, ptrace() strerror(errno)=No such process\nW/libbacktrace(21028): virtual bool BacktracePtrace::ReadWord(uintptr_t, word_t*): invalid pointer 0xbec2b040 reading from tid 20709, ptrace() strerror(errno)=No such process\nW/libbacktrace(21028): virtual bool BacktracePtrace::ReadWord(uintptr_t, word_t*): invalid pointer 0xbec2b050 reading from tid 20709, ptrace() strerror(errno)=No such process\nW/libbacktrace(21028): virtual bool BacktracePtrace::ReadWord(uintptr_t, word_t*): invalid pointer 0xbec2b070 reading from tid 20709, ptrace() strerror(errno)=No such process\netc...\n</code></pre>\n\n<p>I would really appreciate any help and suggestions on which audio external libraries work on Qt.</p>\n"}, {"tags": ["c++", "arrays", "list", "structure"], "comments": [{"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 1, "creation_date": 1576695947, "post_id": 59398278, "comment_id": 104986247, "body": "Why on earth are you using <code>strcpy</code> for this? Why <code>char[]</code> instead of <code>std::string</code>? Why are all of your variable names Capitalized?"}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1576696102, "post_id": 59398278, "comment_id": 104986300, "body": "What exactly is the issue you are facing? Are you stuck on reading the file? <code>std::list::push_back()</code> is handling your dynamic allocation already."}, {"owner": {"reputation": 2246, "user_id": 948359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f6P38.jpg?s=128&g=1", "display_name": "schlebe", "link": "https://stackoverflow.com/users/948359/schlebe"}, "edited": false, "score": 1, "creation_date": 1576696202, "post_id": 59398278, "comment_id": 104986336, "body": "Which error have you when you compile your code ? I agree with 3Dave comment for Capitalized names. For std::string, continue to use char[] and when your issue is solved replaced char[] by std::string."}, {"owner": {"reputation": 3008, "user_id": 1863938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ec4e16681460302ea67bfc201b76f3?s=128&d=identicon&r=PG", "display_name": "parktomatomi", "link": "https://stackoverflow.com/users/1863938/parktomatomi"}, "edited": false, "score": 0, "creation_date": 1576699977, "post_id": 59398278, "comment_id": 104987873, "body": "If you need a dynamic array, use <code>std::vector</code> by default. It has the same interface as <code>std::list</code>, but for most operations, it has better performance because of how it&#39;s implemented. <code>std::list</code> is really only needed for a few special situations, like when you need stable iterators."}], "answers": [{"tags": [], "owner": {"reputation": 867, "user_id": 12546095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e35ac516cf186c6982049d7355b90cad?s=128&d=identicon&r=PG&f=1", "display_name": "Amiram", "link": "https://stackoverflow.com/users/12546095/amiram"}, "is_accepted": false, "score": 0, "last_activity_date": 1576705345, "creation_date": 1576705345, "answer_id": 59400364, "question_id": 59398278, "link": "https://stackoverflow.com/questions/59398278/using-list-for-dynamic-structure-allocation/59400364#59400364", "title": "Using list for dynamic structure allocation", "body": "<p>Instead of list try to use vector, the <em>vector</em> has the ability to allocate more memory if needed.</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">std::vector</a></p>\n\n<blockquote>\n  <p>The storage of the vector is handled automatically, being expanded and\n  contracted as needed. Vectors usually occupy more space than static\n  arrays, because more memory is allocated to handle future growth. This\n  way a vector does not need to reallocate each time an element is\n  inserted, but only when the additional memory is exhausted. The total\n  amount of allocated memory can be queried using capacity() function.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    // Create a vector containing integers\n    std::vector&lt;int&gt; v = {7, 5, 16, 8};\n\n    // Add two more integers to vector\n    v.push_back(25);\n    v.push_back(13);\n\n    // Iterate and print values of vector\n    for(int n : v) {\n        std::cout &lt;&lt; n &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p>P.S</p>\n\n<p>If you also don't know the lengths of the Tag,String1,String2 values try to replace the <em>MyStruct</em> variables to string type (instead of the char).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12560517, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AJvFeR2Jm8g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcCTB-XeGyWowMxZ_SF8nnG_LNzZg/photo.jpg?sz=128", "display_name": "Jaroslav Otradovec", "link": "https://stackoverflow.com/users/12560517/jaroslav-otradovec"}, "is_accepted": false, "score": 0, "last_activity_date": 1576709121, "creation_date": 1576709121, "answer_id": 59401007, "question_id": 59398278, "link": "https://stackoverflow.com/questions/59398278/using-list-for-dynamic-structure-allocation/59401007#59401007", "title": "Using list for dynamic structure allocation", "body": "<h2>Instead of std:list use std::list</h2>\n\n<p>Like this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>     #include &lt;iostream&gt;\n    #include &lt;list&gt;\n    #include &lt;cstring&gt;\n\n    struct MyStruct\n    {\n        char Tag[30];\n        char String1[30];\n        char String2[30];\n    };\n    void something(){\n\n        int Counter;\n\n        std::list&lt;MyStruct&gt; MyList;\n\n        MyStruct Data;\n\n        std::list&lt;MyStruct&gt;::iterator it;\n\n\n        for( Counter = 0; Counter &lt; 5; Counter++)\n        {\n            strcpy( Data.Tag, \"Tag\" );\n            strcpy( Data.String1, \"String1\" );\n            strcpy( Data.String2, \"String2\" );\n\n            MyList.push_back(Data);\n        }\n\n        it = MyList.begin();\n        while (it != MyList.end())\n        {\n            std::cout &lt;&lt; \"Tag: \" &lt;&lt; it-&gt;Tag &lt;&lt; \"First: \" &lt;&lt; it-&gt;String1 &lt;&lt; \"Second: \" &lt;&lt; it-&gt;String2 &lt;&lt; std::endl;\n            it++;\n        }  \n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12560582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6HDca3Gaq8U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6ERHmq64Pi3PyIOUfiYWCdBKuaw/photo.jpg?sz=128", "display_name": "Benoit S.", "link": "https://stackoverflow.com/users/12560582/benoit-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576709121, "creation_date": 1576694450, "last_edit_date": 1576695875, "question_id": 59398278, "link": "https://stackoverflow.com/questions/59398278/using-list-for-dynamic-structure-allocation", "title": "Using list for dynamic structure allocation", "body": "<p>This is my first time here!</p>\n\n<p>I want to do something simple but for the life of me I can't seem to figure it out...</p>\n\n<p>I am reading a file containing data. Within that data, I have specific tags that are meaningful to me. I call them 'tags' but in the file, it's a string of text representing something. I need to extract these tags along with two other strings following that each tags found. The tag and data will be stored in a structure that is to be created dynamically because I don't know how many tags I will extract. So I cannot create a structure with, like, 100 elements, because I may only need 50 just like I can require 150.</p>\n\n<p>Basically, the file is read continuously in a loop until EOF is encountered. As the file is parsed, when a tag is found, the tag name and associated following two strings are read properly. Then I need to store them in the structure. Once extracted, the loop restarts and repeats the tag and data extraction all the way to the end. Once the entire file is read and all tags have been extracted in a dynamic structure, all this data will be dumped to a file and the memory allocated dynamically can then be flushed.</p>\n\n<p>I was told to use a list but I can't seem to figure-out how to make it work. Ideally, a functional piece of code would be of great help. I am doing this in C++ (C is fine).</p>\n\n<p>Example of something I tried and it's not compiling:</p>\n\n<pre><code>struct MyStruct\n{\n    char Tag[30];\n    char String1[30];\n    char String2[30];\n};\n\nint Counter;\n\nstd:list&lt;MyStruct&gt; MyList;\n\nMyStruct Data;\n\nstd:list&lt;MyStruct&gt;::iterator it;\n\n\nfor( Counter = 0; Counter &lt; 5; Counter++)\n{\n    strcpy( Data.Tag, \"Tag\" );\n    strcpy( Data.String1, \"String1\" );\n    strcpy( Data.String2, \"String2\" );\n\n    MyList.push_back(Data);\n}\n\nit = MyList.begin();\nwhile (it != MyList.end())\n{\n    cout &lt;&lt; \"Tag: \" &lt;&lt; it-&gt;Tag &lt;&lt; \"First: \" &lt;&lt; it-&gt;String1 &lt;&lt; \"Second: \" &lt;&lt; it-&gt;String2 &lt;&lt; endl;\n    it++;\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "matrix", "eigen"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 7307161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ2d5.png?s=128&g=1", "display_name": "Kabu", "link": "https://stackoverflow.com/users/7307161/kabu"}, "edited": false, "score": 0, "creation_date": 1576701615, "post_id": 59399390, "comment_id": 104988463, "body": "invalid matrix product in: MatrixXd m = aff_rot * points.transpose().colwise().homogeneous()"}, {"owner": {"reputation": 502, "user_id": 11457061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9PS5.jpg?s=128&g=1", "display_name": "mephisto", "link": "https://stackoverflow.com/users/11457061/mephisto"}, "reply_to_user": {"reputation": 349, "user_id": 7307161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ2d5.png?s=128&g=1", "display_name": "Kabu", "link": "https://stackoverflow.com/users/7307161/kabu"}, "edited": false, "score": 0, "creation_date": 1576703566, "post_id": 59399390, "comment_id": 104989152, "body": "Hmm...strange. However I am able to reproduce an &quot;invalid matrix product&quot; error, if I switch the line &quot;MatrixXd points = MatrixXd::Random(8,3);&quot; with &quot;MatrixXd points = MatrixXd::Random(3,8);&quot;. Are your parameters in the same order as mine?"}, {"owner": {"reputation": 349, "user_id": 7307161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ2d5.png?s=128&g=1", "display_name": "Kabu", "link": "https://stackoverflow.com/users/7307161/kabu"}, "edited": false, "score": 0, "creation_date": 1576751643, "post_id": 59399390, "comment_id": 105003289, "body": "Sorry, my mistake. I applied a transformation to the data matrix which removed one column. Hence the error. Your answer rules, because you used affine transformation and that&#39;s what I asked exactly."}], "tags": [], "owner": {"reputation": 502, "user_id": 11457061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9PS5.jpg?s=128&g=1", "display_name": "mephisto", "link": "https://stackoverflow.com/users/11457061/mephisto"}, "is_accepted": true, "score": 1, "last_activity_date": 1576699989, "creation_date": 1576699989, "answer_id": 59399390, "question_id": 59398083, "link": "https://stackoverflow.com/questions/59398083/how-to-rotate-a-point-matrixxd-by-a-matrix3d-rotation-matrix-in-eigen-using-tran/59399390#59399390", "title": "How to rotate a point MatrixXd by a Matrix3d rotation matrix in Eigen using transformations", "body": "<blockquote>\n  <p>Of course this doesn't work, as Eigen reports no viable conversion from 'Eigen::Matrix3d' to 'Eigen::Affine3d'.</p>\n</blockquote>\n\n<p>Affine3d is from the <code>Transform</code> class and not the <code>Matrix</code> class. Try this: <br></p>\n\n<pre><code>Affine3d tf = Affine3d(RM);\n</code></pre>\n\n<p>Now regarding the rotation, I came up with this small demo:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;eigen3/Eigen/Dense&gt;\nusing Eigen::Matrix3d;\nusing Eigen::MatrixXd;\nusing Eigen::Affine3d;\n\nint main(){\n\n//obviously not a rotation matrix, but needed some numbers only\nMatrix3d rot = Matrix3d::Random();\nstd::cout &lt;&lt; \"We have the rotation matrix:\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; rot &lt;&lt; std::endl;\n\nAffine3d aff_rot = Affine3d(rot);\nstd::cout &lt;&lt; \"Affine version:\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; aff_rot.matrix() &lt;&lt; std::endl;\n\nMatrixXd points = MatrixXd::Random(8,3);\nstd::cout &lt;&lt; \"Some random points:\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; points &lt;&lt; std::endl;\n\nstd::cout &lt;&lt; std::endl &lt;&lt; std::endl;\nMatrixXd m = aff_rot * points.transpose().colwise().homogeneous();\nMatrixXd result = m.transpose();\n\nstd::cout &lt;&lt; \"Result:\" &lt;&lt; std::endl;\nstd::cout &lt;&lt; result &lt;&lt; std::endl;\n\nreturn 0;\n}\n</code></pre>\n\n<p>Here the rotation is applied on left side, but you can adapt the code to apply it on the right side.</p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 7307161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ2d5.png?s=128&g=1", "display_name": "Kabu", "link": "https://stackoverflow.com/users/7307161/kabu"}, "edited": false, "score": 0, "creation_date": 1576751733, "post_id": 59400653, "comment_id": 105003327, "body": "That&#39;s what I thought of doing since the beginning, but I mismanaged the data matrix removing a column... and that&#39;s the reason why the multiplication didn&#39;t work!"}], "tags": [], "owner": {"reputation": 1809, "user_id": 3715819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUGc0.jpg?s=128&g=1", "display_name": "Rockcat", "link": "https://stackoverflow.com/users/3715819/rockcat"}, "is_accepted": false, "score": 2, "last_activity_date": 1576708502, "last_edit_date": 1576708502, "creation_date": 1576707115, "answer_id": 59400653, "question_id": 59398083, "link": "https://stackoverflow.com/questions/59398083/how-to-rotate-a-point-matrixxd-by-a-matrix3d-rotation-matrix-in-eigen-using-tran/59400653#59400653", "title": "How to rotate a point MatrixXd by a Matrix3d rotation matrix in Eigen using transformations", "body": "<p>Why don't just multiply the coordinates matrix by the rotation matrix?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Eigen/Core&gt;\n#include &lt;Eigen/Geometry&gt;\n\nint main(){\n\nEigen::MatrixXd AV(8,3);\nAV &lt;&lt; \n  2.367639937564554,  3.100420929531666,   0, \n  2.367639937564554,  3.100420929531666,   0, \n  2.367639937564554, -3.097445263635904,   0, \n  2.367639937564554, -3.097445263635904,   0, \n -2.362324650030633,  3.100420929531666,   0, \n -2.362324650030633,  3.100420929531666,   0, \n -2.362324650030633, -3.097445263635904,   0, \n -2.362324650030633, -3.097445263635904,   0; \n\nEigen::Matrix3d RM(3,3);\nRM &lt;&lt;  0.997496638487424,  -0.07071390391068358,  0,\n       0.07071390391068358, 0.997496638487424,    0,\n       0,                   0,                    1;\n\n\nEigen::AngleAxisd aa(RM);\nstd::cout &lt;&lt; \"Axis: \" &lt;&lt; aa.axis().transpose() &lt;&lt; \" angle:\" &lt;&lt; aa.angle() &lt;&lt; std::endl;\n\nEigen::MatrixXd result = AV * RM;\nstd::cout &lt;&lt; \"Result:\" &lt;&lt; std::endl  &lt;&lt; result &lt;&lt; std::endl;\n\nreturn 0;\n}\n</code></pre>\n\n<p>Which produces:</p>\n\n<pre><code>Axis: 0 0 1 angle:0.070773\nResult:\n 2.58096  2.92523        0\n 2.58096  2.92523        0\n 2.14268 -3.25712        0\n 2.14268 -3.25712        0\n-2.13717  3.25971        0\n-2.13717  3.25971        0\n-2.57544 -2.92264        0\n-2.57544 -2.92264        0\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 7307161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZ2d5.png?s=128&g=1", "display_name": "Kabu", "link": "https://stackoverflow.com/users/7307161/kabu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 59399390, "answer_count": 2, "score": 0, "last_activity_date": 1576708502, "creation_date": 1576693491, "question_id": 59398083, "link": "https://stackoverflow.com/questions/59398083/how-to-rotate-a-point-matrixxd-by-a-matrix3d-rotation-matrix-in-eigen-using-tran", "title": "How to rotate a point MatrixXd by a Matrix3d rotation matrix in Eigen using transformations", "body": "<p>I have the following MatrixXd V, representing points of a 2d shape:</p>\n\n<pre><code>==========================================\nBounding box vertices (AV) (Rows: 8 Cols: 3)\n==========================================\n[[ 2.367639937564554,  3.100420929531666,                  0]\n [ 2.367639937564554,  3.100420929531666,                  0]\n [ 2.367639937564554, -3.097445263635904,                  0]\n [ 2.367639937564554, -3.097445263635904,                  0]\n [-2.362324650030633,  3.100420929531666,                  0]\n [-2.362324650030633,  3.100420929531666,                  0]\n [-2.362324650030633, -3.097445263635904,                  0]\n [-2.362324650030633, -3.097445263635904,                  0]]\n</code></pre>\n\n<p>and I want to rotate the shape by this Matrix3d rotation matrix:</p>\n\n<pre><code>==========================================\nRM: (RM)  (Rows: 3 Cols: 3)\n==========================================\n[[   0.997496638487424, -0.07071390391068358,                    0]\n [ 0.07071390391068358,    0.997496638487424,                    0]\n [                   0,                    0,                    1]]\n==========================================\n</code></pre>\n\n<p>I'm not able to figure the correct way to do this... I've checked with transformations:</p>\n\n<pre><code>Affine3d tf = RM;\ntf.rotate(V);\n</code></pre>\n\n<p>Of course this doesn't work, as Eigen reports no viable conversion from 'Eigen::Matrix3d' to 'Eigen::Affine3d'. </p>\n\n<p>In short, how do I tell Eigen to use this rotation matrix (RM) as a transformation and apply it to the target matrix (V)?</p>\n\n<p>As I already have the rotation matrix, I have no reason to use quaternions...</p>\n\n<p>Thank you</p>\n"}, {"tags": ["android", "c++", "opengl-es", "opengl-es-2.0"], "comments": [{"owner": {"reputation": 10261, "user_id": 295004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=128&d=identicon&r=PG", "display_name": "Morrison Chang", "link": "https://stackoverflow.com/users/295004/morrison-chang"}, "edited": false, "score": 1, "creation_date": 1576694404, "post_id": 59397961, "comment_id": 104985621, "body": "Have you tried: <a href=\"https://github.com/google/gapid\" rel=\"nofollow noreferrer\">github.com/google/gapid</a> to see what is going on?"}, {"owner": {"reputation": 11, "user_id": 12560468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc78f0c3190773db081166bf88d8649?s=128&d=identicon&r=PG&f=1", "display_name": "carloselfietro", "link": "https://stackoverflow.com/users/12560468/carloselfietro"}, "reply_to_user": {"reputation": 10261, "user_id": 295004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=128&d=identicon&r=PG", "display_name": "Morrison Chang", "link": "https://stackoverflow.com/users/295004/morrison-chang"}, "edited": false, "score": 0, "creation_date": 1576747193, "post_id": 59397961, "comment_id": 105001131, "body": "No I haven&#39;t. Looks complicated, but I will give it a try. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 6020, "user_id": 4052193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6062c93ce987aa90ac59d06e758f03b6?s=128&d=identicon&r=PG&f=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/4052193/columbo"}, "edited": false, "score": 0, "creation_date": 1577036710, "post_id": 59431859, "comment_id": 105076011, "body": "Is it possible that <code>length(fwidth(vTexcoord))</code> is zero? (docs for <code>smoothstep</code> say that <code>Results are undefined if edge0 \u2265 edge1</code>)"}, {"owner": {"reputation": 11, "user_id": 12560468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc78f0c3190773db081166bf88d8649?s=128&d=identicon&r=PG&f=1", "display_name": "carloselfietro", "link": "https://stackoverflow.com/users/12560468/carloselfietro"}, "reply_to_user": {"reputation": 6020, "user_id": 4052193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6062c93ce987aa90ac59d06e758f03b6?s=128&d=identicon&r=PG&f=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/4052193/columbo"}, "edited": false, "score": 0, "creation_date": 1577078148, "post_id": 59431859, "comment_id": 105083181, "body": "yes, indeed there is something different with the rounding on Nvidia Shield. If I use 0.9999 - length(vTexcoord) for the third parameter, it works. So it was not the smoothstep function but the rounding. I also have &quot;precision mediump float;&quot;"}], "tags": [], "owner": {"reputation": 11, "user_id": 12560468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc78f0c3190773db081166bf88d8649?s=128&d=identicon&r=PG&f=1", "display_name": "carloselfietro", "link": "https://stackoverflow.com/users/12560468/carloselfietro"}, "is_accepted": false, "score": -1, "last_activity_date": 1577078249, "last_edit_date": 1577078249, "creation_date": 1576879842, "answer_id": 59431859, "question_id": 59397961, "link": "https://stackoverflow.com/questions/59397961/c-opengl-es-2-0-app-renders-only-wireframe-on-nvidia-shield-tablet-but-render/59431859#59431859", "title": "c++ opengl ES 2.0 App renders only wireframe on Nvidia shield tablet, but renders correctly on other devices", "body": "<p>Found it: \nIt was the pixelshader. The rounding is apparently not well implemented on the nvidia shield:</p>\n\n<pre><code>    gl_FragColor = vColor*smoothstep(0.0, length(fwidth(vTexcoord)), 1.0 - length(vTexcoord)); //doesn't work\n\ngl_FragColor = vColor*smoothstep(0.0, length(fwidth(vTexcoord)), 0.9999 - length(vTexcoord)); //works\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12560468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc78f0c3190773db081166bf88d8649?s=128&d=identicon&r=PG&f=1", "display_name": "carloselfietro", "link": "https://stackoverflow.com/users/12560468/carloselfietro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1577078249, "creation_date": 1576692987, "last_edit_date": 1576697725, "question_id": 59397961, "link": "https://stackoverflow.com/questions/59397961/c-opengl-es-2-0-app-renders-only-wireframe-on-nvidia-shield-tablet-but-render", "title": "c++ opengl ES 2.0 App renders only wireframe on Nvidia shield tablet, but renders correctly on other devices", "body": "<p>During tests of the app on my Nvidia Shield tablet it shows only wireframes instead of filling the polygons.\nSame app renders correctly (filled polygons) on my LG G6 phone, and in windows as an UWP app.\nI am using Visual Studio 2019 community to code in c++, with opengl ES 2.0.\nLooking into the debug settings on the tablet, I could not find anything like \"force wireframe\" or similar.\nI have no idea which part of my code I should include in this post.\nI am using android 7.0, which is the latest available for this tablet.\nAnyone had the same issues, maybe on other devices as well?</p>\n"}, {"tags": ["c++", "arrays", "data-structures", "queue", "c++03"], "comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 1, "creation_date": 1576693025, "post_id": 59397917, "comment_id": 104984997, "body": "<a href=\"https://www.boost.org/doc/libs/1_72_0/doc/html/circular_buffer.html\" rel=\"nofollow noreferrer\">boost::circular_buffer</a>? There is nothing like that in the standard library."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576693033, "post_id": 59397917, "comment_id": 104985006, "body": "A circular buffer? It&#39;s not in the standard library though."}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 0, "creation_date": 1576693082, "post_id": 59397917, "comment_id": 104985024, "body": "You want a circular queue, I believe. Afaik, this is not part of the STL, but is relatively simple to implement."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 1, "last_activity_date": 1576694580, "last_edit_date": 1576694580, "creation_date": 1576693535, "answer_id": 59398098, "question_id": 59397917, "link": "https://stackoverflow.com/questions/59397917/what-data-type-would-have-a-structure-with-a-maximum-size-and-elements-are-fifo/59398098#59398098", "title": "What data type would have a structure with a maximum size and elements are FIFO?", "body": "<blockquote>\n  <p>Is there a built in data structure in C++03</p>\n</blockquote>\n\n<p>A data structure that would be appropriate for what you describe is circular buffer.</p>\n\n<p>There is no such container in the standard library.</p>\n\n<blockquote>\n  <p>or am I required to make my own?</p>\n</blockquote>\n\n<p>You can make your own. A circular buffer can be implemented on top of a sequence container. Or - as always - you can use a pre-existing library.</p>\n"}, {"comments": [{"owner": {"reputation": 166, "user_id": 8570956, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/12827abf1189a402068f4f2c11687f4c?s=128&d=identicon&r=PG&f=1", "display_name": "B. Hoeper", "link": "https://stackoverflow.com/users/8570956/b-hoeper"}, "edited": false, "score": 1, "creation_date": 1576697968, "post_id": 59398111, "comment_id": 104987047, "body": "This. I would highly recommend creating his own queue class if it were to be used many times."}], "tags": [], "owner": {"reputation": 328, "user_id": 4262448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZdVN.jpg?s=128&g=1", "display_name": "lukehod", "link": "https://stackoverflow.com/users/4262448/lukehod"}, "is_accepted": false, "score": 2, "last_activity_date": 1576693610, "creation_date": 1576693610, "answer_id": 59398111, "question_id": 59397917, "link": "https://stackoverflow.com/questions/59397917/what-data-type-would-have-a-structure-with-a-maximum-size-and-elements-are-fifo/59398111#59398111", "title": "What data type would have a structure with a maximum size and elements are FIFO?", "body": "<p>As far as built-in structures for C++, you could use <a href=\"http://www.cplusplus.com/reference/queue/queue/\" rel=\"nofollow noreferrer\"><code>std::queue</code></a>, though you will need to include a check for size yourself as there isn't a built in way to limit it to 3. </p>\n\n<p>This would be pretty simple though if you simply check the size of the queue as you are pushing an item into the FIFO queue. If the queue is already at <code>size==3</code> you call the <code>pop</code> function to remove the element at the top of the list and then <code>push</code> the new element into the queue.</p>\n"}], "owner": {"reputation": 3215, "user_id": 1763652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TlG9j.jpg?s=128&g=1", "display_name": "gator", "link": "https://stackoverflow.com/users/1763652/gator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 59398098, "answer_count": 2, "score": 0, "last_activity_date": 1576694580, "creation_date": 1576692752, "last_edit_date": 1576693824, "question_id": 59397917, "link": "https://stackoverflow.com/questions/59397917/what-data-type-would-have-a-structure-with-a-maximum-size-and-elements-are-fifo", "title": "What data type would have a structure with a maximum size and elements are FIFO?", "body": "<p>I want to store some values, but only store three at a time. If a fourth were to be stored, the oldest value in the structure would be removed to make room.</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const unsigned int BUFFER = 3; // maximum size\nSomeType s(BUFFER);\ns.add(1); // s is now 1 --&gt; NULL --&gt; NULL\ns.add(3); // s is now 3 --&gt; 1 --&gt; NULL\ns.add(6); // s is now 6 --&gt; 3 --&gt; 1\ns.add(4); // s is now 4 --&gt; 6 --&gt; 3 (1 was removed)\n</code></pre>\n\n<p>Is there a built-in data structure in C++03 or am I required to make my own?</p>\n"}, {"tags": ["c++", "templates", "c++17", "std"], "comments": [{"owner": {"reputation": 1087, "user_id": 2129218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bf5ffff85c1f5609fca08eb8e05279?s=128&d=identicon&r=PG", "display_name": "Build Succeeded", "link": "https://stackoverflow.com/users/2129218/build-succeeded"}, "edited": false, "score": 0, "creation_date": 1576692570, "post_id": 59397808, "comment_id": 104984796, "body": "<a href=\"https://www.geeksforgeeks.org/stdany-class-in-c/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/stdany-class-in-c</a> some example mentioned here"}, {"owner": {"reputation": 472, "user_id": 4990485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5853eb83d309719afafb211b70725962?s=128&d=identicon&r=PG&f=1", "display_name": "sv90", "link": "https://stackoverflow.com/users/4990485/sv90"}, "edited": false, "score": 0, "creation_date": 1576844153, "post_id": 59397808, "comment_id": 105036277, "body": "<a href=\"https://www.boost.org/doc/libs/1_72_0/doc/html/program_options.html\" rel=\"nofollow noreferrer\">Boost.Program_options</a> uses something like a <code>std::map&lt;std::string, std::any&gt;</code> to store the programs input."}], "owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1576692476, "answer_count": 0, "score": 0, "last_activity_date": 1576692250, "creation_date": 1576692250, "question_id": 59397808, "link": "https://stackoverflow.com/questions/59397808/when-is-useful-to-use-stdany", "closed_reason": "Duplicate", "title": "When is useful to use std::any?", "body": "<p>I'm studing std::any costruct of the standard library of c++17 standard. But really i don't understand which are the the usecases in which is useful to use std::any instead of std::variant or any other costruct like template or a simple void* variable.</p>\n\n<p>Someone can help me figure out these usecases?</p>\n"}, {"tags": ["c++", "boost", "boost-graph"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1576693099, "post_id": 59397776, "comment_id": 104985036, "body": "&quot;maximum depth&quot; in graph terms would probably be the length of the shortest path. In a tree this is easy, but boost graph is not constrained in this way. You&#39;ll need to enforce the graph is a tree. Anyway, you should be able to follow <code>boost::out_edges</code> until there are none in order to get your depth."}], "answers": [{"comments": [{"owner": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576770984, "post_id": 59402160, "comment_id": 105013478, "body": "awesome! Thanks. Do you know if there is a function that can return the root vertexes or do I have to filter it out from <code>boost::vertices</code>?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576773997, "post_id": 59402160, "comment_id": 105015042, "body": "You should be able to get a topological sort or use <code>in_degree</code> - you would have to change the graph model to support <code>in_degree</code> <a href=\"https://www.boost.org/doc/libs/1_72_0/libs/graph/doc/BidirectionalGraph.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_72_0/libs/graph/doc/&hellip;</a>. But really, you could basically use all roots and see which would have 0 depth."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576774851, "post_id": 59402160, "comment_id": 105015462, "body": "Here&#39;s that last idea implemented: <a href=\"http://coliru.stacked-crooked.com/a/b36d8530a9fc100a\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/b36d8530a9fc100a</a> (it&#39;s likely not the best you can do in terms of efficiency)."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 1, "creation_date": 1576774860, "post_id": 59402160, "comment_id": 105015468, "body": "Maybe it&#39;s worth repeating for all nodes anyways and not bothering about locating roots - all nodes with depth 0 are implicitly roots: <a href=\"http://coliru.stacked-crooked.com/a/2aa15cbe42af20c1\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/2aa15cbe42af20c1</a>. <b>Updated answer</b>  I think I like it because it simplifies the Recorder as well. Added output by increasing depth, and with  ordered Vertices as well."}, {"owner": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576840948, "post_id": 59402160, "comment_id": 105034943, "body": "Rephrase: why is the <code>boost::breadth_first_search</code> outside the loop necessary?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576841254, "post_id": 59402160, "comment_id": 105035066, "body": "@Olumide It isn&#39;t :embarrassed-smiley: I had removed it but apparently forgot to copy that to Coliru. Fixed: <a href=\"http://coliru.stacked-crooked.com/a/2cb069e253e8023e\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/2cb069e253e8023e</a>"}, {"owner": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576844668, "post_id": 59402160, "comment_id": 105036460, "body": "Thanks! You probably need to modify the snippet in your post as well. (I am not worthy to edit your answers :humbly-bows-emoji:)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "edited": false, "score": 0, "creation_date": 1576846357, "post_id": 59402160, "comment_id": 105037145, "body": "Oh you are :) Thanks for the hint"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1576846341, "last_edit_date": 1576846341, "creation_date": 1576718521, "answer_id": 59402160, "question_id": 59397776, "link": "https://stackoverflow.com/questions/59397776/iterating-over-boost-graph-vertexes-based-on-maximal-depth/59402160#59402160", "title": "Iterating over boost graph vertexes based on maximal depth", "body": "<p>What Andy said: you can traverse the out-edges manually. </p>\n\n<p>Alternatively you can use <a href=\"https://www.boost.org/doc/libs/1_72_0/libs/graph/doc/breadth_first_search.html\" rel=\"nofollow noreferrer\">BFS</a> with a custom visitor. You already had a similar idea.</p>\n\n<p>Here's a realization of it:</p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/breadth_first_search.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;map&gt;\n</code></pre>\n\n<p>Now, let's define our types:</p>\n\n<pre><code>using Name   = char;\nusing Graph  = boost::adjacency_list&lt;boost::vecS, boost::vecS, boost::directedS, Name&gt;;\nusing Edge   = Graph::edge_descriptor;\nusing Vertex = Graph::vertex_descriptor;\n</code></pre>\n\n<p>Let's create our own maximum distance recorder. This is roughly based on the <a href=\"https://www.boost.org/doc/libs/1_72_0/libs/graph/doc/distance_recorder.html\" rel=\"nofollow noreferrer\"><code>distance_recorder&lt;&gt;</code></a> class from Boost, which is an <a href=\"https://www.boost.org/doc/libs/1_72_0/libs/graph/doc/EventVisitor.html\" rel=\"nofollow noreferrer\">EventVisitor</a>. </p>\n\n<p>In our case, we'll have it filter for the <code>on_tree_edge</code> event only (because we don't care about non-tree graphs here).</p>\n\n<pre><code>using Depths = std::map&lt;Vertex, size_t&gt;;\n\nstruct Recorder : public boost::base_visitor&lt;Recorder&gt; {\n    using event_filter = boost::on_tree_edge;\n\n    Depths&amp; _ref;\n    Recorder(Depths&amp; r):_ref(r){}\n\n    void operator()(Edge e, const Graph&amp; g) const {\n        auto s = source(e, g), t = target(e, g);\n        std::cout &lt;&lt; \"TREE EDGE \" &lt;&lt; g[s] &lt;&lt; \" -&gt; \" &lt;&lt; g[t] &lt;&lt; \"\\n\";\n\n        auto srcit = _ref.find(s);\n        auto depth = srcit!=_ref.end()? srcit-&gt;second+1: 1;\n\n        if (auto [it, isnew] = _ref.emplace(t, depth); !isnew) {\n            it-&gt;second = std::max(it-&gt;second, depth);\n        }\n    }\n};\n</code></pre>\n\n<p>You can see it basically just updates a <code>std::map</code> but with the following special treatments:</p>\n\n<ul>\n<li>when updating an existing value, it updates with the <em><strong>maximum</strong> of the current distance and the previously recorded distance</em>.</li>\n<li>it does <em>not</em> insert depths for vertices not traveled to by a tree edge (basically, it doesn't use <code>operator[source_vertex]</code> which would insert entries with depth 0)</li>\n</ul>\n\n<p>With that out of the way, all we need is to invoke the algorithm:</p>\n\n<pre><code>std::vector roots { A, B, C, D };\n\nDepths depths;\nRecorder r{depths};\n\nfor (auto root : roots)\n    boost::breadth_first_search(\n        g, root,\n        queue, boost::make_bfs_visitor(r), color_map);\n\nfor (auto [v,d] : depths)\n    std::cout &lt;&lt; g[v] &lt;&lt; \" at \" &lt;&lt; d &lt;&lt; \"\\n\";\n</code></pre>\n\n<blockquote>\n  <p>Important Notes:</p>\n  \n  <ul>\n  <li>use <code>breadth_first_search</code> as opposed to <code>breadth_first_visit</code> because otherwise the <code>color_map</code> would not be re-initialized on each root node. This would make already-discovered nodes always be skipped, which means we would not <em>correctly get the <strong>maximum</strong> distance</em></li>\n  <li><p>this is also the reason we couldn't use the <em>multi-source</em> overload like so:</p>\n\n<pre><code>// WARNING BROKEN!\nboost::breadth_first_search(\n        g, begin(roots), end(roots),\n        queue, boost::make_bfs_visitor(r), color_map);\n</code></pre>\n  \n  <p>the effect would be the same because there's no re-initialization of the color-map for each root node.</p></li>\n  </ul>\n</blockquote>\n\n<h2>LIVE DEMO</h2>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/0268d2ec2d384934\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/breadth_first_search.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;map&gt;\n\nusing Name   = char;\nusing Graph  = boost::adjacency_list&lt;boost::vecS, boost::vecS, boost::directedS, Name&gt;;\nusing Edge   = Graph::edge_descriptor;\nusing Vertex = Graph::vertex_descriptor;\n\nusing Depths = std::map&lt;Vertex, size_t&gt;;\n\nstruct Recorder : public boost::base_visitor&lt;Recorder&gt; {\n    using event_filter = boost::on_tree_edge;\n\n    Depths&amp; _ref;\n    Recorder(Depths&amp; r):_ref(r){}\n\n    void operator()(Edge e, const Graph&amp; g) const {\n        auto s = source(e, g), t = target(e, g);\n        std::cout &lt;&lt; \"TREE EDGE \" &lt;&lt; g[s] &lt;&lt; \" -&gt; \" &lt;&lt; g[t] &lt;&lt; \"\\n\";\n\n        auto srcit = _ref.find(s);\n        auto depth = srcit!=_ref.end()? srcit-&gt;second+1: 1;\n\n        if (auto [it, isnew] = _ref.emplace(t, depth); !isnew) {\n            it-&gt;second = std::max(it-&gt;second, depth);\n        }\n    }\n};\n\nint main() {\n    enum : Vertex { A, B, C, D, E, F, G, H, I, COUNT };\n    Graph g(COUNT);\n\n    // give names\n    for (auto v : boost::make_iterator_range(vertices(g)))\n        g[v] = 'A' + v;\n\n    // add edges\n    for (auto [s,t] : {\n            std::pair(D,G), {D, G}, {C, G}, {C, F}, {B, F}, {B, E}, {A, E},\n            {G, H}, {F, I}, {E, H},\n            {H, I} })\n    {\n        add_edge(s, t, g);\n    }\n\n    std::vector roots { A, B, C, D };\n    boost::queue&lt;Vertex&gt; queue;\n    std::vector&lt;boost::default_color_type&gt; colors(num_vertices(g));\n    auto color_map = boost::make_iterator_property_map(begin(colors), get(boost::vertex_index, g));\n\n    Depths depths;\n    Recorder r{depths};\n\n    for (auto root : roots)\n        boost::breadth_first_search(\n            g, root,\n            queue, boost::make_bfs_visitor(r), color_map);\n\n    for (auto [v,d] : depths)\n        std::cout &lt;&lt; g[v] &lt;&lt; \" at \" &lt;&lt; d &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Which prints</p>\n\n<pre><code>TREE EDGE A -&gt; E\nTREE EDGE E -&gt; H\nTREE EDGE H -&gt; I\nTREE EDGE B -&gt; F\nTREE EDGE B -&gt; E\nTREE EDGE F -&gt; I\nTREE EDGE E -&gt; H\nTREE EDGE C -&gt; G\nTREE EDGE C -&gt; F\nTREE EDGE G -&gt; H\nTREE EDGE F -&gt; I\nTREE EDGE D -&gt; G\nTREE EDGE G -&gt; H\nTREE EDGE H -&gt; I\nE at 1\nF at 1\nG at 1\nH at 2\nI at 3\n</code></pre>\n\n\n\n<h2>UPDATE</h2>\n\n<p>Slightly altered to detect roots \"by brute force\":</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/2aa15cbe42af20c1\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/breadth_first_search.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;map&gt;\n\nusing boost::make_iterator_range;\nusing Name   = char;\nusing Graph  = boost::adjacency_list&lt;boost::vecS, boost::vecS, boost::directedS, Name&gt;;\nusing Edge   = Graph::edge_descriptor;\nusing Vertex = Graph::vertex_descriptor;\n\nusing Depths = std::map&lt;Vertex, size_t&gt;;\n\nstruct Recorder : public boost::base_visitor&lt;Recorder&gt; {\n    using event_filter = boost::on_tree_edge;\n\n    Depths&amp; _ref;\n    Recorder(Depths&amp; r):_ref(r){}\n\n    void operator()(Edge e, const Graph&amp; g) const {\n        auto depth = 1 + _ref[source(e, g)];\n\n        if (auto [it, isnew] = _ref.emplace(target(e, g), depth); !isnew) {\n            it-&gt;second = std::max(it-&gt;second, depth);\n        }\n    }\n};\n\nint main() {\n    enum : Vertex { A, B, C, D, E, F, G, H, I, COUNT };\n    Graph g(COUNT);\n\n    // give names\n    for (auto v : make_iterator_range(vertices(g)))\n        g[v] = 'A' + v;\n\n    // add edges\n    for (auto [s,t] : {\n            std::pair(D,G), {D, G}, {C, G}, {C, F}, {B, F}, {B, E}, {A, E},\n            {G, H}, {F, I}, {E, H},\n            {H, I} })\n    {\n        add_edge(s, t, g);\n    }\n\n    boost::queue&lt;Vertex&gt; queue;\n    std::vector&lt;boost::default_color_type&gt; colors(num_vertices(g));\n    auto color_map = boost::make_iterator_property_map(begin(colors), get(boost::vertex_index, g));\n\n    Depths depths;\n    Recorder r{depths};\n\n    for (auto v : make_iterator_range(vertices(g))) {\n        boost::breadth_first_search(g, v, queue, boost::make_bfs_visitor(r), color_map);\n    }\n\n    std::map&lt;size_t, std::set&lt;Vertex&gt; &gt; by_depth;\n    for (auto [v,d] : depths)\n        by_depth[d].insert(v);\n\n    for (auto&amp; [d,vs] : by_depth) {\n        std::cout &lt;&lt; \"depth:\" &lt;&lt; d;\n        for (auto v : vs) std::cout &lt;&lt; \" \" &lt;&lt; g[v];\n        std::cout &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>depth:0 A B C D\ndepth:1 E F G\ndepth:2 H\ndepth:3 I\n</code></pre>\n"}], "owner": {"reputation": 4915, "user_id": 181783, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1fb6e1466afe620716fcdd839fe54bba?s=128&d=identicon&r=PG", "display_name": "Olumide", "link": "https://stackoverflow.com/users/181783/olumide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 59402160, "answer_count": 1, "score": 2, "last_activity_date": 1576846341, "creation_date": 1576692147, "question_id": 59397776, "link": "https://stackoverflow.com/questions/59397776/iterating-over-boost-graph-vertexes-based-on-maximal-depth", "title": "Iterating over boost graph vertexes based on maximal depth", "body": "<p>I would like to iterate over the vertexes of a graph based on the maximum depth of the vertex from any of the root vertexes. </p>\n\n<p>Fore example the maximal depth of the vertex <code>I</code> is 3 (and is this annotated with this value in the graph below). Therefore any of the orderings would be acceptable: <code>{A , B , C , D} , {E , F , G} , {H}, {I}</code>, where any of the vertexes in curly braces <code>{}</code> can be ordered arbitrarily.</p>\n\n<p>I have come across a somewhat <a href=\"https://stackoverflow.com/questions/20199850/how-to-get-the-max-leveldepth-of-a-vertex-in-a-boost-graph\">similar question</a> but it is geared towards getting the maximum depth of a single vertex and appears to assume a single root node.</p>\n\n<p><a href=\"https://i.stack.imgur.com/02hKu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/02hKu.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am quite new to boost graph but here is my feeble attempt at what a solution might resemble</p>\n\n<pre><code>#include &lt;boost/graph/adjacency_list.hpp&gt;\n#include &lt;boost/graph/depth_first_search.hpp&gt;\n\nusing namespace boost;\n\nclass depth_visitor : public default_dfs_visitor\n{\npublic:\n    template &lt;typename Vertex , typename Graph &gt;\n    void discover_vertex(Vertex v , const Graph &amp; g) const\n    {\n        // update 'depth' of vertex \n    }\n};\n\n\nint main()\n{\n  enum { A , B, C, D, E, F, G , H , I , COUNT };\n  const char* name[] = { \"A\" , \"B\" , \"C\" , \"D\" , \"E\" , \"F\" , \"G\" , \"H\" , \"I\" };\n\n  typedef std::pair &lt;int, int &gt;Edge;\n  Edge edge_array[] = { Edge(D, G), Edge(C, G), Edge(C, F), Edge(B, F), Edge(B, E), Edge(A, E),\n                        Edge(G, H), Edge(F, I), Edge(E, H), Edge(H, I) };\n\n    typedef adjacency_list &lt; vecS, vecS, directedS &gt; graph_t;\n    graph_t g( edge_array , edge_array + sizeof(edge_array) / sizeof(E), COUNT );\n\n    depth_visitor vis;\n    depth_first_search( g , visitor( vis ) );\n}\n</code></pre>\n"}, {"tags": ["c++", "templates", "gcc", "clang", "c++17"], "answers": [{"comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1576693776, "post_id": 59397959, "comment_id": 104985327, "body": "Except this changes <code>foo(1)</code> from legal to illegal. I&#39;d suggest a forwarding reference instead: <code>template &lt;typename T&gt; void foo(T&amp;&amp; i)</code>"}, {"owner": {"reputation": 33, "user_id": 2592361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd8fdd44dda2f66bbd5fcf5ee57dcbf?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/2592361/jason"}, "edited": false, "score": 0, "creation_date": 1576694428, "post_id": 59397959, "comment_id": 104985632, "body": "Yes indeed with the initial approach I have a copy. Shouldn&#39;t the compiler be able to see that I do not change the i,j inside the foo function and decide the const accordingly? I mean that it is valid to have a <code>void foo(const int i)</code> function."}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1576694751, "post_id": 59397959, "comment_id": 104985758, "body": "No. The const inside the main is orthogonal to the const inside the <code>foo</code> function. You could for example never change the value inside the main but mutate your copy inside <code>foo</code> as you please. It should not depend on the constness of object inside other scope."}, {"owner": {"reputation": 33, "user_id": 2592361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd8fdd44dda2f66bbd5fcf5ee57dcbf?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/2592361/jason"}, "edited": false, "score": 0, "creation_date": 1576695546, "post_id": 59397959, "comment_id": 104986086, "body": "OK I see! And how can I get always a const T inside the foo and forbid the mutation of i in every case? Defining <code>void foo(const T i) const</code> or <code>void foo(const T&amp; i) const</code> also returns false."}, {"owner": {"reputation": 33, "user_id": 2592361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd8fdd44dda2f66bbd5fcf5ee57dcbf?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/2592361/jason"}, "edited": false, "score": 0, "creation_date": 1576695663, "post_id": 59397959, "comment_id": 104986145, "body": "Hoo well it is becasue I pass <code>is_const&lt;T&gt;</code> T to is_const nevermind! Thank you very much!"}], "tags": [], "owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "is_accepted": true, "score": 3, "last_activity_date": 1576694184, "last_edit_date": 1576694184, "creation_date": 1576692980, "answer_id": 59397959, "question_id": 59397717, "link": "https://stackoverflow.com/questions/59397717/const-correctness-in-automatic-template-deduction/59397959#59397959", "title": "Const correctness in automatic template deduction", "body": "<p>Deduction over the type <code>T</code> will always be decayed. The decayed type for <code>int const</code> is simply <code>int</code>. The decayed type of a <code>int[3]</code> is <code>int*</code>.</p>\n\n<p>The thing is, this code <em>is</em> const correct.</p>\n\n<p>Yes, inside <code>foo</code> you can't ever change the value of <code>j</code>. Inside <code>foo</code> you have a copy and it's up to <code>foo</code> to decide if it want its own parameters to be constant inside the function body or not.</p>\n\n<p>However, there is other form of deductions that has to maintain the <code>const</code> to be callable with the arguments. This is not a solution for your code but simply an example:</p>\n\n<pre><code>template&lt;typename T&gt;\nvoid frob(T&amp; i)\n{\n    std::cout &lt;&lt; \"Will it be const? \" &lt;&lt; std::is_const&lt;T&gt;::value &lt;&lt; \"\\n\";\n}\n\nauto main() -&gt; int {\n    int const myInt = 9;\n    frob(myInt);\n}\n</code></pre>\n\n<p>To be called at all, the parameter must be <code>int const&amp;</code> so it's what is going to be deduced.</p>\n"}], "owner": {"reputation": 33, "user_id": 2592361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd8fdd44dda2f66bbd5fcf5ee57dcbf?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/2592361/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 59397959, "answer_count": 1, "score": 2, "last_activity_date": 1576694184, "creation_date": 1576691895, "last_edit_date": 1576693194, "question_id": 59397717, "link": "https://stackoverflow.com/questions/59397717/const-correctness-in-automatic-template-deduction", "title": "Const correctness in automatic template deduction", "body": "<p>In the following example I would expect the line <code>a.foo(j);</code> to pass the const qualifier to the templated method.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\nstruct A\n{\n    template&lt;typename T&gt;\n    void foo(T i) const\n    {\n        std::cout &lt;&lt; \"Is const type: \" &lt;&lt; std::is_const&lt;T&gt;::value &lt;&lt; \"\\n\";\n    }\n};\n\nint main() {\n\n    A a;\n\n    int i = 0;\n    const int j = 0;\n\n    a.foo(i);\n    a.foo(j);\n\n    a.foo&lt;decltype(i)&gt;(i);\n    a.foo&lt;decltype(j)&gt;(j);\n\n    a.foo&lt;int&gt;(i);\n    a.foo&lt;const int&gt;(j);\n\n    return 0;\n}\n</code></pre>\n\n<p>However the output I get both from gcc and clang (c++17) is the following.</p>\n\n<pre><code>Is const type: 0\nIs const type: 0\nIs const type: 0\nIs const type: 1\nIs const type: 0\nIs const type: 1\n</code></pre>\n\n<p>The second row is false instead of true. So why automatic template deduction drops cv qualifiers? Is any specific reason why this happened?</p>\n\n<p>PS. The example above can be found <a href=\"https://godbolt.org/z/RG8HTW\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["c++", "boost", "iterator", "circular-buffer"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1576691813, "post_id": 59397623, "comment_id": 104984466, "body": "Does it work if you add <code>typename </code> before <code>boost</code>?"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1576693264, "post_id": 59397623, "comment_id": 104985114, "body": "See <a href=\"https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords\">Where and why do I have to put the \u201ctemplate\u201d and \u201ctypename\u201d keywords?</a>"}, {"owner": {"reputation": 19, "user_id": 4620274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0039e5b84e262627d8402b38aa71fbae?s=128&d=identicon&r=PG&f=1", "display_name": "Taki Eddine", "link": "https://stackoverflow.com/users/4620274/taki-eddine"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576755171, "post_id": 59397623, "comment_id": 105005007, "body": "@user253751 I did what you suggested, and I still get the same error."}], "owner": {"reputation": 19, "user_id": 4620274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0039e5b84e262627d8402b38aa71fbae?s=128&d=identicon&r=PG&f=1", "display_name": "Taki Eddine", "link": "https://stackoverflow.com/users/4620274/taki-eddine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1576691549, "creation_date": 1576691549, "question_id": 59397623, "link": "https://stackoverflow.com/questions/59397623/how-to-resolve-error-boostcircular-buffert-stdallocator-tp1-iterato", "title": "How to resolve error: &#39;boost::circular_buffer&lt;T, std::allocator&lt;_Tp1&gt; &gt;::iterator&#39; is not a type?", "body": "<p>I am trying to pass boost::circular_buffer::iterator as a function argument to iterate over the circular buffer. \nThis is the prototype definition of a function in a header file inside the project that I am working on</p>\n\n<pre><code>#include&lt;boost/circular_buffer.hpp&gt;\n#include &lt;boost/assert.hpp&gt;\n#include &lt;boost/iterator.hpp&gt;\n\n#ifndef STEREOMATCH_H_\n#define STEREOMATCH_H_\ntemplate &lt;class T, class U&gt;\nclass StereoMatch {\n\npublic:\n\nvoid fillPixels(boost::circular_buffer&lt;T&gt;::iterator it, T* imgPtr,const int BUFF_SIZE);\n};\n\n\n#endif /* STEREOMATCH_H_ */\n</code></pre>\n\n<p>When I build the project, I get the following error </p>\n\n<pre><code>In file included from ../depth/StereoMatch.cpp:7:0:\n../depth/StereoMatch.h:33:45: error: 'boost::circular_buffer&lt;T, std::allocator&lt;_Tp1&gt; &gt;::iterator' is not a type\n</code></pre>\n\n<p>What sould I do to resolve this error ?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576691494, "post_id": 59397586, "comment_id": 104984336, "body": "<i>&quot;An array is a bit special insofar as it&#39;s an aggregate, granted, but the same is true for many struct or class variables, and you are good to go with these.&quot;</i> Really? Can you give an example of an instantiation of some object of class type, where the class type is deduced from constructor arguments?"}, {"owner": {"reputation": 579, "user_id": 3175478, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d226ad76c20a10964496dc2be49dd5a6?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/3175478/john"}, "edited": false, "score": 0, "creation_date": 1576691517, "post_id": 59397586, "comment_id": 104984348, "body": "Try <code>auto x  = {1,2,3};</code>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576691532, "post_id": 59397586, "comment_id": 104984357, "body": "<i>&quot;The elements of an array must all have the same type, so there shouldn&#39;t be an issue deducing the element type correctly&quot;</i> All the arguments must convert to the same type; not the same thing. What if they convert to multiple things?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 579, "user_id": 3175478, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d226ad76c20a10964496dc2be49dd5a6?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/3175478/john"}, "edited": false, "score": 0, "creation_date": 1576691546, "post_id": 59397586, "comment_id": 104984362, "body": "@John That is not an array."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576691601, "post_id": 59397586, "comment_id": 104984386, "body": "Related: <a href=\"https://stackoverflow.com/q/16949016/560648\">stackoverflow.com/q/16949016/560648</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1576691625, "post_id": 59397586, "comment_id": 104984395, "body": "This is just one more reason to stop using raw arrays and start using <code>std::array</code>.  Now that C++17 has CTAD and C++20 will allow it to work through type aliases it&#39;s basically a drop in replacement."}, {"owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576691679, "post_id": 59397586, "comment_id": 104984420, "body": "@LightnessRaceswithMonica: Well, a lambda <i>is</i> a class of sorts, is it not? Not in a user-visible way, but under the hood, anyway. And you are surely allowed to use <code>auto</code> on it (what else could you do, not knowing its type)."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576691807, "post_id": 59397586, "comment_id": 104984461, "body": "That&#39;s not really the same thing. A lambda expression gives you an object already made. The <code>auto</code> in <code>auto f = [](){}</code> doesn&#39;t have any work to do; that&#39;s just a copy-initialisation. There is nothing to deduce. Similarly you can write <code>auto obj = GimmeObj()</code> but that&#39;s not a fair comparison to your array case either!"}, {"owner": {"reputation": 269338, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1576693508, "post_id": 59397586, "comment_id": 104985216, "body": "I&#39;m not sure I agree with closing this as a duplicate.  Knowing how to work around a problem is not the same as knowing how the problem came to be in the first place."}], "owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1576691559, "answer_count": 0, "score": 0, "last_activity_date": 1576691364, "creation_date": 1576691364, "question_id": 59397586, "link": "https://stackoverflow.com/questions/59397586/auto-array-declaration-not-allowable", "closed_reason": "Duplicate", "title": "auto array declaration not allowable?", "body": "<p><strong>tl;dr:</strong> What is the hindrance to declaring an <code>auto</code> array?</p>\n\n<p>I'm a <em>very</em> sparse <code>auto</code> user (basically with the exception of iterators where it's <em>really</em> helpful only using it when left absolutely no other choice, such as with lambdas), so I never realized this before. Almost Always use Auto? Pffft.</p>\n\n<p>Today I was initializing an array of SSE constants (which is annoying enough thanks to Intel intrinsics). Doing so, it occurred to me that  actually <code>auto</code> reads much nicer than <code>__m128i</code> and is much easier to type, too. And seeing how it's absolutely certain what the <code>_mm_set...</code> functions return, it should be trivially deducable, too. No risk of getting some undesirable promotion stuff either, looks like the perfect thing to do. Just works (TM).</p>\n\n<p>Thus I went to write:</p>\n\n<pre><code>const auto foo[] = { _mm_set_blahblah(...),  _mm_set_blahblah(...),  _mm_set_blahblah(...) };\n</code></pre>\n\n<p>... only to learn that the compiler doesn't accept that!</p>\n\n<p>After wondering whether it <em>could</em> be the <code>const</code> for a second (the error message being about <em>\"array of const auto\"</em>), I concluded it must be the Intel intrinsics, which are usually the source of all troubles, so why not this time. Also, you are perfectly allowed to write <code>auto&amp;</code> and I'm sure that I've written <code>auto const&amp;</code> at some point in the past. That really can't be it.</p>\n\n<p>Surely, with <em>everything else</em>, it will work! But surprise, turns out it doesn't work with simple integers, either:</p>\n\n<pre><code>int  x[]  = {1,2,3}; // certainly works, what else!\nauto y[]  = {1,2,3}; // no good\nauto z[3] = {1,2,3}; // no good\n</code></pre>\n\n<p>Looking over at cppreference (easier than digging through the standard), it says: <em>\"may appear in the type specifier of a variable: auto x = expr;. The type is deduced from the initializer.\"</em></p>\n\n<p>OK, alright, there's admittedly no square brackets in that statement, and it admittedly <em>doesn't</em> explicitly say \"array\" anywhere, but... an array is a variable (and it doesn't say <em>\"except arrays\"</em>), and there sure is an initializer.<br>\nAn array is a bit special insofar as it's an <em>aggregate</em>, granted, but the same is true for many <code>struct</code> or <code>class</code> variables, and you are good to go with these.</p>\n\n<p>The elements of an array must all have the same type, so there shouldn't be an issue deducing the element type correctly (other than maybe the fact that <code>std::initializer_list</code> uses the same syntax as aggregate initialization, but this isn't a problem elsewhere?). The size of the array is known from the initializer list as well, so that too couldn't really be much of a hindrance (also, the standard even <em>requires</em> this to work, plus, it doesn't compile with an explict size, either).</p>\n\n<p>So, what is the reason why declaring an <code>auto</code> array isn't allowable?</p>\n"}, {"tags": ["c++", "class", "constructor", "initialization", "size-t"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576690219, "post_id": 59397303, "comment_id": 104983736, "body": "Are you debugging a release build?  If you are the code will not behave like you wrote it and this type of behavior is normal."}, {"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 6, "creation_date": 1576690253, "post_id": 59397303, "comment_id": 104983749, "body": "The constructor initializes the elements in the order they were declared. Step through it a bit more and you&#39;ll see that <code>m_size</code> eventually gets initialized."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1576690258, "post_id": 59397303, "comment_id": 104983754, "body": "Please show us, in the form of <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, that it isn&#39;t initialized."}, {"owner": {"reputation": 1, "user_id": 12277534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1160e5ef4eb8e972f28660a6d7f7e5f?s=128&d=identicon&r=PG&f=1", "display_name": "pixus nixus", "link": "https://stackoverflow.com/users/12277534/pixus-nixus"}, "reply_to_user": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1576690640, "post_id": 59397303, "comment_id": 104983933, "body": "@0x499602D2 declaring m_size before m_value fixed the &quot;problem&quot;, I thought that elements are initialized in the order they are written in the constructor."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1576690731, "post_id": 59397303, "comment_id": 104983975, "body": "@pixusnixus some compilers have a warning for cases like this (<a href=\"http://coliru.stacked-crooked.com/a/9b4669d05cf2d411\" rel=\"nofollow noreferrer\">for example</a>)"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576690974, "post_id": 59397303, "comment_id": 104984092, "body": "@pixusnixus &quot;<i>I thought that elements are initialized in the order they are written in the constructor.</i>&quot; Why did you think so? What source told you this?"}, {"owner": {"reputation": 1, "user_id": 12277534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1160e5ef4eb8e972f28660a6d7f7e5f?s=128&d=identicon&r=PG&f=1", "display_name": "pixus nixus", "link": "https://stackoverflow.com/users/12277534/pixus-nixus"}, "edited": false, "score": 0, "creation_date": 1576692397, "post_id": 59397303, "comment_id": 104984721, "body": "I guess I overlooked that, because I didn&#39;t learn that from a specific place. Thanks for your help!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1576693798, "post_id": 59397303, "comment_id": 104985336, "body": "Class members are initialized in the order that they are declared in the class, regardless of the order of values specified in the constructor&#39;s initialization list.  As such, in the code shown, <code>m_value</code> is initialized before <code>m_size</code>.  Does your <code>Generated()</code> method depend on <code>m_size</code> being set first?"}, {"owner": {"reputation": 1, "user_id": 12277534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1160e5ef4eb8e972f28660a6d7f7e5f?s=128&d=identicon&r=PG&f=1", "display_name": "pixus nixus", "link": "https://stackoverflow.com/users/12277534/pixus-nixus"}, "edited": false, "score": 0, "creation_date": 1576705405, "post_id": 59397303, "comment_id": 104989817, "body": "Yes, it depends, that was the problem!"}], "owner": {"reputation": 1, "user_id": 12277534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1160e5ef4eb8e972f28660a6d7f7e5f?s=128&d=identicon&r=PG&f=1", "display_name": "pixus nixus", "link": "https://stackoverflow.com/users/12277534/pixus-nixus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576692258, "creation_date": 1576690158, "last_edit_date": 1576692258, "question_id": 59397303, "link": "https://stackoverflow.com/questions/59397303/constructor-does-not-initialize-class-element", "title": "Constructor does not initialize class element", "body": "<p>I'm working on a class that generates a string made of random characters, of a given size. I'm passing the <code>m_size</code> value to the constructor, as you can see in the following code:</p>\n\n<pre><code>class Random_Generator\n{\n    using clock = std::chrono::high_resolution_clock;\n    std::mt19937 m_dev;\n    clock::time_point m_beginning;\n    std::string m_value;\n    size_t m_size;\n\n    long long TimeSeed();\n    std::string Generated();\n\npublic:\n    Random_Generator(size_t sz)\n        : m_dev(TimeSeed())\n        , m_beginning(clock::now())\n        , m_size(sz)\n        , m_value(Generated())\n    {}\n    // other methods\n};\n\nint main()\n{\n    Random_Generator rstr(10);\n    // more code\n}\n</code></pre>\n\n<p>The thing is, <code>m_size</code> does not initialize with the value of <code>sz</code>: when debugging (I'm using Visual Studio community 2019, if that's useful), it seems that when the constructor executes, it simply jumps over the initialization of <code>m_size</code>, thus <code>m_size</code> having a garbage value.</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1576690027, "post_id": 59397207, "comment_id": 104983642, "body": "Which part of your code did you expect to convert <code>12</code> to <code>00</code>?"}, {"owner": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1576690136, "post_id": 59397207, "comment_id": 104983699, "body": "@mkrieger1 s.replace( ...., to_string( here ) )"}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1576690145, "post_id": 59397207, "comment_id": 104983705, "body": "What is <code>to_string</code>?"}, {"owner": {"reputation": 1087, "user_id": 2129218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bf5ffff85c1f5609fca08eb8e05279?s=128&d=identicon&r=PG", "display_name": "Build Succeeded", "link": "https://stackoverflow.com/users/2129218/build-succeeded"}, "edited": false, "score": 0, "creation_date": 1576690264, "post_id": 59397207, "comment_id": 104983757, "body": "std::setfill() and  std::setw() for string formatting."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576690467, "post_id": 59397207, "comment_id": 104983854, "body": "<b><i>What is to_string?</i></b> <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/to_string\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/string/basic_string/to_str&zwnj;&#8203;ing</a>"}, {"owner": {"reputation": 65820, "user_id": 1741542, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QdVqh.jpg?s=128&g=1", "display_name": "Olaf Dietsche", "link": "https://stackoverflow.com/users/1741542/olaf-dietsche"}, "edited": false, "score": 0, "creation_date": 1576690768, "post_id": 59397207, "comment_id": 104983986, "body": "<code>to_string</code> doesn&#39;t do any formatting. I&#39;d rather look into <code>strptime</code> and <code>strftime</code>."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1576691067, "post_id": 59397207, "comment_id": 104984146, "body": "<code>12:00:00AM</code>? I&#39;m from a country where we use the 24h clock so I&#39;m not sure, but that time does not exist, does it? If I understand it correctly, you have <code>00:00</code> (AM) and <code>12:00</code> (PM)."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576699016, "post_id": 59397207, "comment_id": 104987500, "body": "In the USA we use 12:00 AM (midnight). I have never heard anyone say 00:00 AM."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576701831, "post_id": 59397207, "comment_id": 104988526, "body": "@drescherjm I understand that it may be different in spoken language. Do you also write 12:00 AM? I though 00:00 always meant AM and 12:00 always meant PM, when writing."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576701979, "post_id": 59397207, "comment_id": 104988587, "body": "<b><i>Do you also write 12:00 AM?</i></b> Yes, never 00:00 AM."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576702668, "post_id": 59397207, "comment_id": 104988843, "body": "@drescherjm I see. I was told to just write 00:00 and 12:00 and that adding AM/PM to those is redundant since 00:00 is AM and 12:00 is PM ... but ... I never really got it fully as you probably can tell :-)"}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "edited": false, "score": 0, "creation_date": 1576690065, "post_id": 59397280, "comment_id": 104983664, "body": "I do it for the practice."}, {"owner": {"reputation": 4428, "user_id": 2058333, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Ux6ck.jpg?s=128&g=1", "display_name": "El Dude", "link": "https://stackoverflow.com/users/2058333/el-dude"}, "reply_to_user": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "edited": false, "score": 0, "creation_date": 1576690401, "post_id": 59397280, "comment_id": 104983820, "body": "Writing your own date API?"}, {"owner": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "edited": false, "score": 0, "creation_date": 1576690946, "post_id": 59397280, "comment_id": 104984079, "body": "I&#39;m still newbie, maybe in the future :) still student."}, {"owner": {"reputation": 4428, "user_id": 2058333, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Ux6ck.jpg?s=128&g=1", "display_name": "El Dude", "link": "https://stackoverflow.com/users/2058333/el-dude"}, "reply_to_user": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "edited": false, "score": 1, "creation_date": 1576691154, "post_id": 59397280, "comment_id": 104984189, "body": "Pro tip : learn to use libraries that solve your problem over reinventing the wheel. 1. Your solution will be buggy while existing solutions usually would pass 2. You can focus on new, more important problems than something that has been solved before."}, {"owner": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "edited": false, "score": 0, "creation_date": 1576691226, "post_id": 59397280, "comment_id": 104984218, "body": "I&#39;ll remember the tip :)"}], "tags": [], "owner": {"reputation": 4428, "user_id": 2058333, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Ux6ck.jpg?s=128&g=1", "display_name": "El Dude", "link": "https://stackoverflow.com/users/2058333/el-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1576690016, "creation_date": 1576690016, "answer_id": 59397280, "question_id": 59397207, "link": "https://stackoverflow.com/questions/59397207/time-conversion-from-12-hour-format-to-24-hour-format/59397280#59397280", "title": "Time conversion from 12-hour-format to 24-hour-format", "body": "<p>I suggest looking into libraries like </p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/chrono\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/chrono</a></p>\n\n<p>or</p>\n\n<p><a href=\"https://www.boost.org/doc/libs/1_62_0/doc/html/date_time.html\" rel=\"nofollow noreferrer\">https://www.boost.org/doc/libs/1_62_0/doc/html/date_time.html</a></p>\n\n<p>Both should have a conversion tool from your format into some other.</p>\n\n<p>From my experience it's best to not write any date time code at all, even the simplest but use a library. One entertaining explanation for this can be found here </p>\n\n<p><a href=\"https://www.youtube.com/watch?v=-5wpm-gesOY\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=-5wpm-gesOY</a></p>\n"}, {"comments": [{"owner": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "edited": false, "score": 0, "creation_date": 1576691028, "post_id": 59397347, "comment_id": 104984118, "body": "I understand the problem! Thank you."}, {"owner": {"reputation": 1087, "user_id": 2129218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bf5ffff85c1f5609fca08eb8e05279?s=128&d=identicon&r=PG", "display_name": "Build Succeeded", "link": "https://stackoverflow.com/users/2129218/build-succeeded"}, "edited": false, "score": 0, "creation_date": 1576691293, "post_id": 59397347, "comment_id": 104984251, "body": "Language provide the functions for formatting here std::setfill and std::setw"}], "tags": [], "owner": {"reputation": 3262, "user_id": 1964707, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/at9Qr.jpg?s=128&g=1", "display_name": "Mindaugas Bernatavi\u010dius", "link": "https://stackoverflow.com/users/1964707/mindaugas-bernatavi%c4%8dius"}, "is_accepted": true, "score": 1, "last_activity_date": 1576690342, "creation_date": 1576690342, "answer_id": 59397347, "question_id": 59397207, "link": "https://stackoverflow.com/questions/59397207/time-conversion-from-12-hour-format-to-24-hour-format/59397347#59397347", "title": "Time conversion from 12-hour-format to 24-hour-format", "body": "<p>If you were to print: <code>cout &lt;&lt; to_string((stoi(time)+12)%24) &lt;&lt; endl;</code> you would see that you are only replacing the single 0:</p>\n\n<pre><code>if((s.find(\"PM\") != string::npos) || ((s.find(\"AM\") != string::npos) &amp;&amp; (time.compare(twelveAM)==0))){\n    cout &lt;&lt; to_string((stoi(time)+12)%24) &lt;&lt; endl;\n    s.replace(s.begin(), s.begin()+2, to_string((stoi(time)+12)%24));\n}\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>0\n0:00:00\n</code></pre>\n\n<p>You should just add a second zero at the beginning, like: <code>s.replace(s.begin(), s.begin()+2, \"00\");</code></p>\n"}, {"tags": [], "owner": {"reputation": 1087, "user_id": 2129218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bf5ffff85c1f5609fca08eb8e05279?s=128&d=identicon&r=PG", "display_name": "Build Succeeded", "link": "https://stackoverflow.com/users/2129218/build-succeeded"}, "is_accepted": false, "score": 1, "last_activity_date": 1576690621, "creation_date": 1576690621, "answer_id": 59397415, "question_id": 59397207, "link": "https://stackoverflow.com/questions/59397207/time-conversion-from-12-hour-format-to-24-hour-format/59397415#59397415", "title": "Time conversion from 12-hour-format to 24-hour-format", "body": "<p>Below is code changes required if not interested in library functions:    </p>\n\n<pre><code>std::stringstream string;\nstring &lt;&lt; std::setfill('0') &lt;&lt; std::setw(2) &lt;&lt; (stoi(time) + 12) % 24);\ns.replace(s.begin(), s.begin() + 2, string.str());\n</code></pre>\n"}], "owner": {"reputation": 338, "user_id": 8992710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fs5A.png?s=128&g=1", "display_name": "benjamin", "link": "https://stackoverflow.com/users/8992710/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 59397347, "answer_count": 3, "score": -1, "last_activity_date": 1576690621, "creation_date": 1576689718, "last_edit_date": 1576689857, "question_id": 59397207, "link": "https://stackoverflow.com/questions/59397207/time-conversion-from-12-hour-format-to-24-hour-format", "title": "Time conversion from 12-hour-format to 24-hour-format", "body": "<p>I have written this code:</p>\n\n<pre><code>string timeConversion(string s) {\n    string time{s[0]}, twelveAM{\"12\"};\n    time+=s[1];\n\n    if((s.find(\"PM\") != string::npos) || ((s.find(\"AM\") != string::npos) &amp;&amp; (time.compare(twelveAM)==0)))\n        s.replace(s.begin(), s.begin()+2, to_string((stoi(time)+12)%24));\n\n    s.replace(s.end()-2, s.end(), \"\");\n    return s;\n}\n</code></pre>\n\n<p>Here when <code>s</code> is <code>12:00:00AM</code> my output is <code>0:00:00</code> but it should be <code>00:00:00</code>.</p>\n\n<p>Everything else is working fine, I'll appreciate any help given to solve this case.</p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 5848, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "edited": false, "score": 1, "creation_date": 1576689725, "post_id": 59397159, "comment_id": 104983483, "body": "There is an asynchronous IO in Windows as well, <a href=\"https://en.wikipedia.org/wiki/Overlapped_I/O\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Overlapped_I/O</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1576691368, "post_id": 59397159, "comment_id": 104984291, "body": "There are numerous documents and examples on MSDN for how to work with socket programming."}], "answers": [{"tags": [], "owner": {"reputation": 2105, "user_id": 5821408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6ca899d084f02ac63e71e9e8711046?s=128&d=identicon&r=PG&f=1", "display_name": "shmsr", "link": "https://stackoverflow.com/users/5821408/shmsr"}, "is_accepted": false, "score": 2, "last_activity_date": 1579193769, "last_edit_date": 1579193769, "creation_date": 1576690826, "answer_id": 59397469, "question_id": 59397159, "link": "https://stackoverflow.com/questions/59397159/do-a-server-block-execution-when-listening-for-client-connection/59397469#59397469", "title": "Do a server block execution when listening for client connection?", "body": "<p>From the diagram as you can see doesn't block on <code>listen()</code>\nAlso, this <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-listen\" rel=\"nofollow noreferrer\">link</a> might help you.</p>\n\n<p>From the block you can which are blocking calls\n<a href=\"https://i.stack.imgur.com/3Hakx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Hakx.png\" alt=\"From the block you can which are blocking calls\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1576691926, "creation_date": 1576691926, "answer_id": 59397725, "question_id": 59397159, "link": "https://stackoverflow.com/questions/59397159/do-a-server-block-execution-when-listening-for-client-connection/59397725#59397725", "title": "Do a server block execution when listening for client connection?", "body": "<blockquote>\n  <p>when you call listen() on the server side, does the listen() block executes until a client tries to make a connection?</p>\n</blockquote>\n\n<p>No.  <code>listen()</code> simply opens the listening port and establishes the backlog to hold pending connections, and then it exits.  It is <code>accept()</code> instead that blocks waiting for a connection (if you use it in blocking mode, that is, which is the default).</p>\n\n<blockquote>\n  <p>after accepting and serving the current client, how does it get back to listening mode for other connections?</p>\n</blockquote>\n\n<p>It is up to you to decide when that happens.  The server will not go back to listening for a connection until you call <code>accept()</code> again.  So you need to call <code>accept()</code> in a loop for the lifetime of your server.  But, your server design will dictate WHEN you call <code>accept()</code>.</p>\n\n<p>If you want to service only 1 client at a time, then you simply have 1 loop that calls <code>accept()</code>, services the client in full, closes the accepted socket, and goes back to <code>accept()</code>.</p>\n\n<p>But, if you want to service multiple clients in parallel, then you need to accept clients as often as possible, either by calling <code>accept()</code> in a dedicated thread or <code>select()</code> loop, or by using <code>AcceptEx()</code> in the background by Overlapped I/O or an I/O Completion Port.  Once a client has been accepted, you need to then decide whether you want to service the client directly in your <code>select()</code> loop, or in its own dedicated thread, or with Overlapped I/O or IOCP.</p>\n\n<blockquote>\n  <p>from the code I saw on the sites I visited there is no loop which calls listen() again after serving a client, it goes straight to close().</p>\n</blockquote>\n\n<p>No, there is never a <code>listen()</code> loop.  <code>listen()</code> is only to be called once, when opening the server port.  But you do need an <code>accept()</code> loop instead to accept clients.</p>\n\n<blockquote>\n  <p>Please forgive me for not adding any code because I want to get basic knowledge before I can attempt it my self.</p>\n</blockquote>\n\n<p>Literally, there are TONS of socket tutorals available online, and detailed WinSock documentation and examples on MSDN.  All of them cover this topic.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4995599"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1579193769, "creation_date": 1576689527, "last_edit_date": 1576690507, "question_id": 59397159, "link": "https://stackoverflow.com/questions/59397159/do-a-server-block-execution-when-listening-for-client-connection", "title": "Do a server block execution when listening for client connection?", "body": "<p>I'm new to socket programming and I want to create a client/server type of application using winapi. I want my application to be listening for a request from a client, and after serving the client it should continue listening for further requests. But before making an attempt I what to get an overview for understanding of the whole process. My question is when you call listen() on the server side, does the listen() block executes until a client tries to make a connection? \nand after accepting and serving the current client, how does it get back to listening mode for other connections? because from the code I saw on the sites I visited there is no loop which calls listen() again after serving a client, it goes straight to close().</p>\n\n<p>Please forgive me for not adding any code because I want to get basic knowledge before I can attempt it my self. </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576689118, "post_id": 59397039, "comment_id": 104983201, "body": "You can&#39;t change the order of an ordered container.  Doing so would break its invariant (being ordered)."}, {"owner": {"reputation": 444, "user_id": 3565621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xq6s4.jpg?s=128&g=1", "display_name": "mystic_coder", "link": "https://stackoverflow.com/users/3565621/mystic-coder"}, "edited": false, "score": 0, "creation_date": 1576690227, "post_id": 59397039, "comment_id": 104983740, "body": "you can use : Boost.Bimap <a href=\"https://www.boost.org/doc/libs/1_62_0/libs/multi_index/doc/examples.html#example4\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_62_0/libs/multi_index/doc/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1576690936, "last_edit_date": 1576690936, "creation_date": 1576689491, "answer_id": 59397148, "question_id": 59397039, "link": "https://stackoverflow.com/questions/59397039/swap-element-from-a-map-with-iter-swap/59397148#59397148", "title": "swap element from a map with iter_swap", "body": "<blockquote>\n  <p>Is it possible</p>\n</blockquote>\n\n<p>It is not possible. Elements of a map are in the ordering established by the comparison function. The elements cannot be swapped.</p>\n\n<p>If you want a structure where you can choose the order of pairs, you can use <code>std::vector&lt;std::pair&lt;std::string, int&gt;&gt;</code> instead. If you want both fast lookup, and arbitrary order, then you want a multi-index data structure. Standard library has no such container. Boost does however.</p>\n"}], "owner": {"reputation": 566, "user_id": 5708002, "user_type": "registered", "profile_image": "https://graph.facebook.com/1060487453972892/picture?type=large", "display_name": "Kafka", "link": "https://stackoverflow.com/users/5708002/kafka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 59397148, "answer_count": 1, "score": 0, "last_activity_date": 1576690936, "creation_date": 1576689050, "question_id": 59397039, "link": "https://stackoverflow.com/questions/59397039/swap-element-from-a-map-with-iter-swap", "title": "swap element from a map with iter_swap", "body": "<p>I have a \"simple\" problem :\nI'm trying to swap the pairs inside a map to change order.\nThis code doesn't compile.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;map&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n  std::map&lt;std::string, int&gt; map;\n  map.insert({\"one\", 1});  \n  map.insert({\"two\", 2});  \n  map.insert({\"three\", 3});\n\n  for(const auto&amp; e :map)\n  {\n    std::cout &lt;&lt; e.first &lt;&lt; \" \" &lt;&lt; e.second &lt;&lt; std::endl;   \n  }\n\n  std::iter_swap(map.begin(), map.rbegin());\n\n  for(const auto&amp; e :map)\n  {\n    std::cout &lt;&lt; e.first &lt;&lt; \" \" &lt;&lt; e.second &lt;&lt; std::endl;   \n  }\n}\n</code></pre>\n\n<p>Is it possible and how can I do ?</p>\n"}, {"tags": ["c++", "polymorphism"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 2, "creation_date": 1576688647, "post_id": 59396844, "comment_id": 104982962, "body": "FYI: <a href=\"https://gpfault.net/posts/mapping-types-to-values.txt.html\" rel=\"nofollow noreferrer\">Mapping Types to Values (in C++)</a>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1576688775, "post_id": 59396844, "comment_id": 104983018, "body": "FYI: <a href=\"https://stackoverflow.com/q/9859390/7478597\">SO: Use data type (class type) as key in a map</a>"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "edited": false, "score": 3, "creation_date": 1576688799, "post_id": 59396844, "comment_id": 104983030, "body": "Needing to know the type of a <code>Base*</code> would normally be considered a code smell. It would be easier to give a good answer if you could provide some more details on <b>why</b> you need this and <b>how</b> it will be used."}, {"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1576689231, "post_id": 59396844, "comment_id": 104983263, "body": "this may be useful: <a href=\"https://stackoverflow.com/questions/59365859/should-how-can-i-avoid-downcasting-in-this-case\" title=\"should how can i avoid downcasting in this case\">stackoverflow.com/questions/59365859/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1576689362, "last_edit_date": 1576689362, "creation_date": 1576689030, "answer_id": 59397033, "question_id": 59396844, "link": "https://stackoverflow.com/questions/59396844/what-is-a-good-design-pattern-for-getting-object-of-specific-derived-class-from/59397033#59397033", "title": "What is a good design pattern for getting object of specific derived class from a list of base class pointers?", "body": "<p>Instead of a vector, use an associative map of <code>std::type_index</code> to base pointer. Ensure that only matching type index is used, and then you don't need dynamic_cast, because we know that the type will match the mapped pointer. That said, use of <code>std::type_index</code> still relies on RTTI. No linear searching is needed.</p>\n"}], "owner": {"reputation": 408, "user_id": 4108711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fae9624eae1a541e5c83baf8c173674?s=128&d=identicon&r=PG&f=1", "display_name": "rezaebrh", "link": "https://stackoverflow.com/users/4108711/rezaebrh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576689362, "creation_date": 1576688317, "question_id": 59396844, "link": "https://stackoverflow.com/questions/59396844/what-is-a-good-design-pattern-for-getting-object-of-specific-derived-class-from", "title": "What is a good design pattern for getting object of specific derived class from a list of base class pointers?", "body": "<p>Imagine I have a class called <code>Test</code> and inside this class I have a list of pointers which their types are all from class <code>Base</code>. Although any pointer which is stored in list is pointer to an object from classes which are derived from class <code>Base</code>. I want to provide a <code>getter()</code> function for a specific derived type which returns the object of specific class. Note that we don't know the index of required pointer inside class.</p>\n\n<pre><code>class Base\n{\n    /// Base class do have a pure virtual function\n};\n\nclass Derived1\n{\n};\n\nclass Derived2\n{\n};\n\n\nClass Test\n{\n    std::vector&lt;Base*&gt; pointers; /// any STL collection... vector may be more frequent\n\n     get_derived1_object(); /// \n};\n</code></pre>\n\n<p>I think of some possible implementations of <code>get_derived1_object()</code> like this (And in my opinion both have some problems):</p>\n\n<p>1- storing a copy pointer of <code>Derived1</code>'s object's pointer inside class. In case I want to try using <code>unique_pre</code> it is not a good solution.</p>\n\n<p>2- iterate over <code>pointers</code> in order to find which item is from <code>Derived1</code> class using runtime type checking. (for example trying to use <code>dynamic_cast</code> or sth similar). In my usecase, using runtime type checking is better not to be used.</p>\n\n<p>P.S: having multiple items of each class is not important here because I'm sure I don't have 2 different pointers from same class inside my list and consider it taken care of.</p>\n\n<p>I was wondering if I could find the best solution for providing a function like <code>get_derived1_object</code> (whether from my own given solutions or sth else).</p>\n"}, {"tags": ["c++", "arrays", "pointers", "char", "stack"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1576689531, "post_id": 59396813, "comment_id": 104983385, "body": "You forgot about <code>std::array</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1576689890, "post_id": 59396813, "comment_id": 104983571, "body": "Note that <code>char *word = &quot;message&quot;;</code> is <i>illegal</i> in C++11 and later and should not even compile (if it does, then your compiler has a non-standard extension to allow that). A string literal is read-only data, so you MUST (and should) use a pointer to <code>const</code> data, eg: <code>const char *word = &quot;message&quot;;</code> instead."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1576690546, "post_id": 59396813, "comment_id": 104983894, "body": "<code>const auto word = ...;</code> is what you likely want."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 12298306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7159eea670b286be3f00f73e2962497e?s=128&d=identicon&r=PG&f=1", "display_name": "CSstudZ", "link": "https://stackoverflow.com/users/12298306/csstudz"}, "edited": false, "score": 0, "creation_date": 1576688499, "post_id": 59396859, "comment_id": 104982897, "body": "I know that case 1 doesn&#39;t work that&#39;s why I wrote &quot;not permissible&quot; next to it. Thanks for the feedback!"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 85, "user_id": 12298306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7159eea670b286be3f00f73e2962497e?s=128&d=identicon&r=PG&f=1", "display_name": "CSstudZ", "link": "https://stackoverflow.com/users/12298306/csstudz"}, "edited": false, "score": 0, "creation_date": 1576688525, "post_id": 59396859, "comment_id": 104982910, "body": "@CSstudZ what&#39;s your question then?"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "edited": false, "score": 0, "creation_date": 1576688909, "post_id": 59396859, "comment_id": 104983092, "body": "I updated the answer, hopefully this answers the question."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": false, "score": 2, "last_activity_date": 1576688847, "last_edit_date": 1576688847, "creation_date": 1576688357, "answer_id": 59396859, "question_id": 59396813, "link": "https://stackoverflow.com/questions/59396813/what-are-the-modifiable-char-array-types-in-c/59396859#59396859", "title": "What are the modifiable char array types in c++?", "body": "<p>If you declare the array with const type, you aren't allowed to modify it. If you declare it with non-const type, you are allowed to modify it. That's the main rule that you need to remember.</p>\n\n<p>The rules of the language prevent you from accidentally breaking this rule using a pointer variable, as well. If you have a <code>char*</code>, you're allowed to use it to modify the array it points to. If you have a <code>const char*</code>, you're not. In the case of a non-modifiable array such as a string literal, the compiler should not allow you to assign its address to a <code>char*</code>. If the compiler allows Case 1 to compile, you should configure it with appropriate flags so that it does not.</p>\n\n<p>In short, the modifiable array types are the non-<code>const</code> ones, and you can obtain a non-<code>const</code> pointer only to such an array, therefore such pointers can also be used for modification. (That is, unless you do something unsafe, like using <code>const_cast</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 1073, "user_id": 10794806, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKvpJsipy5o/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hXsT0KoMOXyLso6Ie2mfwllaD7zQ/mo/photo.jpg?sz=128", "display_name": "Gaurav Dhiman", "link": "https://stackoverflow.com/users/10794806/gaurav-dhiman"}, "is_accepted": false, "score": 0, "last_activity_date": 1576689982, "creation_date": 1576689982, "answer_id": 59397267, "question_id": 59396813, "link": "https://stackoverflow.com/questions/59396813/what-are-the-modifiable-char-array-types-in-c/59397267#59397267", "title": "What are the modifiable char array types in c++?", "body": "<blockquote>\n  <p>Are there any others ways to create a char array in c++? If so what modifications are permissible?</p>\n</blockquote>\n\n<p>Syntactically yes there are</p>\n\n<p>Non Modifiable:</p>\n\n<pre><code>auto word1 = \"abc\";\nconst auto word2 = \"abc\";\nconstexpr auto word3 = \"abc\";\nconstexpr char word4 = \"abc\";\nauto word5{\"abc\"};\nconst auto word6{\"abc\"};\n</code></pre>\n\n<p>Modifiable</p>\n\n<pre><code>char word7[]{\"abc\"};\n\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 12298306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7159eea670b286be3f00f73e2962497e?s=128&d=identicon&r=PG&f=1", "display_name": "CSstudZ", "link": "https://stackoverflow.com/users/12298306/csstudz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576689982, "creation_date": 1576688178, "question_id": 59396813, "link": "https://stackoverflow.com/questions/59396813/what-are-the-modifiable-char-array-types-in-c", "title": "What are the modifiable char array types in c++?", "body": "<p>I am trying to synthesize my knowledge in char arrays but I feel I am missing something. I can only think of these three scenarios (when it comes to stack, I am not talking about doing <code>const int SIZE = 6; char *word = new char[SIZE];</code> )</p>\n\n<p><strong>case 1 :</strong> not permissible</p>\n\n<pre><code>char *word = \"message\"; \nword[0] = 'M';\n</code></pre>\n\n<p><strong>case 2 :</strong> permissible</p>\n\n<pre><code>const int SIZE = 8;\nchar word[SIZE] = \"message\"; \nword[0] = 'M';\n</code></pre>\n\n<p><strong>case 3 :</strong> permissible</p>\n\n<pre><code>char word[] = \"message\"; \nword[0] = 'M';\n</code></pre>\n\n<p>Are there any others ways to create a char array in c++? If so what modifications are permissible?</p>\n"}, {"tags": ["c++", "video-streaming", "webrtc", "intel", "encoder"], "owner": {"reputation": 441, "user_id": 10101256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUiTR.png?s=128&g=1", "display_name": "PStarczewski", "link": "https://stackoverflow.com/users/10101256/pstarczewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1577258927, "creation_date": 1576688112, "question_id": 59396794, "link": "https://stackoverflow.com/questions/59396794/base-quicksync-parameters-for-realtime-streaming", "title": "Base quicksync parameters for realtime streaming", "body": "<p>I've wrote quicksync encoder hardware implementation for realtime streaming. Everything works fine, however now I got stuck on encoder parametrization. Docs from Intel are very poor and non-specific. I've read:</p>\n\n<ul>\n<li>SDK API Reference Manual</li>\n<li>Intel Media Developer's Guide(rev. 2017)</li>\n</ul>\n\n<p>I've also tried to follow the NVENC guidelines(I did same for Nvidia a while ago and everything works fine) but no luck here either.</p>\n\n<p>So far with:</p>\n\n<pre><code>\n    m_mfxEncParams.IOPattern = MFX_IOPATTERN_IN_VIDEO_MEMORY;\n\n    m_mfxEncParams.AsyncDepth = 4;\n\n    m_mfxEncParams.mfx.TargetKbps = my_target_bps_ / 1000;\n    m_mfxEncParams.mfx.MaxKbps = 0;\n    //m_mfxEncParams.mfx.InitialDelayInKB = 0;\n    m_mfxEncParams.mfx.BufferSizeInKB = my_width_ * my_height_ * 1.5;\n\n    //FRAME INFO PARAMS\n    ConvertFrameRate(30, &amp;m_mfxEncParams.mfx.FrameInfo.FrameRateExtN, &amp;m_mfxEncParams.mfx.FrameInfo.FrameRateExtD);\n\n    m_mfxEncParams.mfx.FrameInfo.FourCC = MFX_FOURCC_NV12;\n    m_mfxEncParams.mfx.FrameInfo.ChromaFormat = MFX_CHROMAFORMAT_YUV420;\n\n    m_mfxEncParams.mfx.FrameInfo.PicStruct = MFX_PICSTRUCT_PROGRESSIVE;\n    m_mfxEncParams.mfx.FrameInfo.Shift = 0;\n    m_mfxEncParams.mfx.FrameInfo.CropX = 0;\n    m_mfxEncParams.mfx.FrameInfo.CropY = 0;\n    m_mfxEncParams.mfx.FrameInfo.CropW = my_width_;\n    m_mfxEncParams.mfx.FrameInfo.CropH = my_height_;\n\n    m_mfxEncParams.mfx.FrameInfo.Width = MSDK_ALIGN16(width_);\n    m_mfxEncParams.mfx.FrameInfo.Height =\n        (MFX_PICSTRUCT_PROGRESSIVE == m_mfxEncParams.mfx.FrameInfo.PicStruct)\n        ? MSDK_ALIGN16(height_)\n        : MSDK_ALIGN32(height_);\n\n    m_mfxEncParams.mfx.CodecId = MFX_CODEC_AVC;\n    m_mfxEncParams.mfx.CodecProfile = MFX_PROFILE_AVC_BASELINE;\n    m_mfxEncParams.mfx.CodecLevel = 0;\n    m_mfxEncParams.mfx.GopPicSize = 0;\n    m_mfxEncParams.mfx.GopRefDist = 1;\n    m_mfxEncParams.mfx.GopOptFlag = MFX_GOP_STRICT;\n    m_mfxEncParams.mfx.IdrInterval = 0;\n\n    //TRADEOF BETWEEN QUALITY AND SPEED\n    m_mfxEncParams.mfx.TargetUsage = MFX_TARGETUSAGE_BALANCED;\n    m_mfxEncParams.mfx.RateControlMethod = MFX_RATECONTROL_CBR;\n\n\n    m_mfxEncParams.mfx.NumSlice = 0;\n    m_mfxEncParams.mfx.NumRefFrame = 0;\n    m_mfxEncParams.mfx.EncodedOrder = 0; // binary flag, 0 signals encoder to take frames in display order\n    //CODING OPTION 2\n    auto codingOption2 = m_mfxEncParams.AddExtBuffer&lt;mfxExtCodingOption2&gt;();\n\n    codingOption2-&gt;LookAheadDepth = 0;\n    codingOption2-&gt;MaxSliceSize = 0;\n    codingOption2-&gt;MaxFrameSize = 0;\n    codingOption2-&gt;BRefType = MFX_B_REF_OFF;\n\n    codingOption2-&gt;ExtBRC = 0;\n\n    codingOption2-&gt;IntRefType = 0;\n    codingOption2-&gt;IntRefCycleSize = 0;\n    codingOption2-&gt;IntRefQPDelta = 0;\n    codingOption2-&gt;AdaptiveI = 0;\n    codingOption2-&gt;AdaptiveB = 0;\n\n</code></pre>\n\n<p>Right now for FullHD I've got 20 FPS of really low quality with bitrate around 2mb/s(peak, static is around 800kb/s), while for FullHD on Nvidia I've got 40 FPS of really quality image with bitrate around 1.3mb/s(peak, static is around 300kb/s)</p>\n\n<p>I need some kind of starting point settings for real-time streaming with QuickSync or at least some extra literature on that subject.</p>\n\n<p>EDIT: I should specify. That hardware's implementation sole purpose is to encode image to send to browser via webrtc. That is why I use Baseline profile. I know in theory chromium can decode Main and High profiles, however for now I just want to stay within borders of officially supported Baseline profile(same profile which I use with NVENC).</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1576687856, "post_id": 59396641, "comment_id": 104982568, "body": "The <a href=\"https://linux.die.net/man/3/isunordered\" rel=\"nofollow noreferrer\">docs</a> are pretty clear about it,"}, {"owner": {"reputation": 1073, "user_id": 3763139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gkUYr.jpg?s=128&g=1", "display_name": "Sopel", "link": "https://stackoverflow.com/users/3763139/sopel"}, "edited": false, "score": 0, "creation_date": 1576687902, "post_id": 59396641, "comment_id": 104982595, "body": "also <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3.6/gcc/Other-Builtins.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-3.3.6/gcc/Other-Builtins.html</a> &quot;GCC provides built-in versions of the ISO C99 floating point comparison macros that avoid raising exceptions for unordered operands. They have the same names as the standard macros ( isgreater, isgreaterequal, isless, islessequal, islessgreater, and isunordered) , with <i>_builtin</i> prefixed. We intend for a library implementor to be able to simply #define each standard macro to its built-in equivalent.&quot; That&#39;s not exactly about this, but the behaviour is equivalent."}], "owner": {"reputation": 1129, "user_id": 6319901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fb677ce3a7ce11c93597c803c82fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Sorrow", "link": "https://stackoverflow.com/users/6319901/dark-sorrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "closed_date": 1576687832, "answer_count": 0, "score": 1, "last_activity_date": 1576687535, "creation_date": 1576687535, "question_id": 59396641, "link": "https://stackoverflow.com/questions/59396641/isless-vs-or-isgreater-vs", "closed_reason": "Duplicate", "title": "isless vs &lt; or isgreater vs &gt;", "body": "<p>Can  someone advice what is the difference between <code>isgreater(x,y)</code> and <code>&gt;</code> or <code>isless(x,y)</code> and <code>&lt;</code>.\nMy understanding is isless and similar function raise exception (C++).\nWhich is recommended to use?</p>\n\n<pre><code>#define isgreater(x,y) \\\n          (__extension__ ({__typeof__(x) __x = (x); __typeof__(y) __y = (y); \\\n                           !isunordered(__x,__y) &amp;&amp; (__x &gt; __y);}))\n#define isless(x,y) \\\n          (__extension__ ({__typeof__(x) __x = (x); __typeof__(y) __y = (y); \\\n                           !isunordered(__x,__y) &amp;&amp; (__x &lt; __y);}))\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "recursion", "data-structures", "quicksort"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1576687238, "post_id": 59396480, "comment_id": 104982232, "body": "This seems like a good time to learn how to use a debugger to step through you code statement by statement, while monitoring variables and their values. That way you can easily seem when and where something unexpected is happening, like for example out-of-bounds indexing or similar."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1576687471, "post_id": 59396480, "comment_id": 104982353, "body": "<a href=\"https://stackoverflow.com/q/25385173/5910058\">What is a debugger and how can it help me diagnose problems?</a>"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1576688629, "post_id": 59396480, "comment_id": 104982959, "body": "Here&#39;s a unit test: Try sorting this: <code>[0, 0, 0, 0]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "is_accepted": true, "score": 0, "last_activity_date": 1576688147, "creation_date": 1576688147, "answer_id": 59396807, "question_id": 59396480, "link": "https://stackoverflow.com/questions/59396480/why-is-this-quick-sort-implementation-giving-a-weird-output/59396807#59396807", "title": "Why is this Quick Sort implementation giving a weird output", "body": "<p>in this part when you try to sort the array from the location start to pivot you have</p>\n\n<pre><code>quickSort(input, loc - 1);    \nquickSort(input + loc + 1, ub - loc);\n</code></pre>\n\n<p>which means input[loc] is never treated since you go from 0 to loc -1 and loc +1 to end </p>\n\n<p>which is corrected here</p>\n\n<pre><code>if (lb &lt; ub)\n{\n    loc = partition(input, lb, ub);\n    quickSort(input, loc );\n    quickSort(input + loc + 1, ub - loc);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11555625"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 59396807, "answer_count": 1, "score": 0, "last_activity_date": 1576688147, "creation_date": 1576687040, "last_edit_date": 1576687132, "question_id": 59396480, "link": "https://stackoverflow.com/questions/59396480/why-is-this-quick-sort-implementation-giving-a-weird-output", "title": "Why is this Quick Sort implementation giving a weird output", "body": "<p>My Quick Sort is giving a weird output.Some sections of the output are sorted while some some sections are just random.I am using <code>pivot</code> element to <code>partition</code> the array recursively using <code>partition function</code> into <code>2 halves</code> with the <code>left half</code> elements less than the pivot element and <code>right half</code> elements greater than the pivot element. </p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint partition(int *arr, int start, int end)\n{\n    int pivot = start;\n    int temp;\n    int temp2;\n\n    while (start &lt; end)\n    {\n        while (arr[start] &lt;= arr[pivot])\n            start++;\n        while (arr[end] &gt; arr[pivot])\n            end--;\n\n        if (start &lt; end)\n        {\n            temp = arr[start];\n            arr[start] = arr[end];\n            arr[end] = temp;\n        }\n    }\n    temp2 = arr[pivot];\n    arr[pivot] = arr[end];\n    arr[end] = temp2;\n    return end;\n}\n\nvoid quickSort(int input[], int size)\n{\n    int lb = 0;\n    int ub = size - 1;\n    int loc;\n    if (lb &lt; ub)\n    {\n        loc = partition(input, lb, ub);\n        quickSort(input, loc - 1);\n        quickSort(input + loc + 1, ub - loc);\n    }\n    else\n        return;\n}\n\nint main()\n{\n    int n;\n    cin &gt;&gt; n;\n\n    int *input = new int[n];\n\n    for (int i = 0; i &lt; n; i++)\n    {\n        cin &gt;&gt; input[i];\n    }\n\n    quickSort(input, n);\n    for (int i = 0; i &lt; n; i++)\n    {\n        cout &lt;&lt; input[i] &lt;&lt; \" \";\n    }\n\n    delete[] input;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "language-lawyer", "standards", "language-features"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 4, "creation_date": 1576686492, "post_id": 59396256, "comment_id": 104981804, "body": "C&#39;s <code>_Bool</code> type was inspired by C++&#39;s <code>bool</code> I believe."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1576686740, "post_id": 59396256, "comment_id": 104981955, "body": "Being able to declare variables in other locations than at the very top of a function was also a C++ first, later adopted by C I think."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1576686852, "post_id": 59396256, "comment_id": 104982019, "body": "@JesperJuhl Sure? This has been a feature of C much longer than most people think, and predates the first C++ standard."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1576686866, "post_id": 59396256, "comment_id": 104982026, "body": "I think function prototypes came from C++, IIRC."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1576686909, "post_id": 59396256, "comment_id": 104982052, "body": "Not allowing &quot;implicit int&quot; as a function return type (except for <code>main()</code>) is (I think) also something that C++ pioneered and C subsequently adopted."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1576686981, "post_id": 59396256, "comment_id": 104982090, "body": "@Konrad Am I sure? No. I explicitly said &quot;I think&quot;. Which implies that I&#39;m <i>not</i> certain. I&#39;m going by my <i>memory</i> of reading the standards over the years, but I have not double checked my memory."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 5, "creation_date": 1576687079, "post_id": 59396256, "comment_id": 104982145, "body": "This doesn&#39;t seem like a question with one clear answer, and there&#39;s no obvious problem here."}, {"owner": {"reputation": 151, "user_id": 5895811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bed50a2eb82fc748c4b0062e517eec5?s=128&d=identicon&r=PG&f=1", "display_name": "TZof", "link": "https://stackoverflow.com/users/5895811/tzof"}, "edited": false, "score": 0, "creation_date": 1576687165, "post_id": 59396256, "comment_id": 104982193, "body": "You can see the C99 directives"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1576687536, "post_id": 59396256, "comment_id": 104982391, "body": "@JesperJuhl I think declaring variables inside an inner block of a function might predate C++, but mixing declarations and statements within a block probably came from C++ since it has only been a standard feature since C99."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576688750, "post_id": 59396256, "comment_id": 104983009, "body": "<a href=\"https://chat.stackoverflow.com/\">chat.stackoverflow.com</a>"}, {"owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "edited": false, "score": 1, "creation_date": 1576690132, "post_id": 59396256, "comment_id": 104983695, "body": "<a href=\"http://www.stroustrup.com/sibling_rivalry.pdf\" rel=\"nofollow noreferrer\">Here</a> B. Stroustrup relates the early history of C and C++."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1576690674, "post_id": 59396256, "comment_id": 104983949, "body": "Advancements to C were purposely put on hold during C++ nascent years.  Features that appeared first in C++ then C are then not necessarily due to &quot;C++ has it so let&#39;s put it in C&quot; as much as the C update was postponed and the feature came up in both.  I&#39;m thinking of <code>&#47;&#47;</code>, inline, and maybe others."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1576687804, "post_id": 59396498, "comment_id": 104982530, "body": "@KonradRudolph Anonymous: <code>union named { struct { int i;}; };</code> Unnamed: <code>union named { struct { int i;} unnamed; };</code>. The unnamed struct is has no name, but has a named variable. Anonymous struct is unnamed and has no named variable."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1576687865, "post_id": 59396498, "comment_id": 104982570, "body": "@Konrad <a href=\"https://stackoverflow.com/a/14248127/560648\">stackoverflow.com/a/14248127/560648</a>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1576689576, "post_id": 59396498, "comment_id": 104983409, "body": "Inline functions existed in GCC and other compilers before C++."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1576689539, "last_edit_date": 1576689539, "creation_date": 1576687100, "answer_id": 59396498, "question_id": 59396256, "link": "https://stackoverflow.com/questions/59396256/which-c-features-are-influenced-by-derived-from-c-features/59396498#59396498", "title": "Which C Features are influenced by/derived from C++ Features?", "body": "<p>I cannot confirm that they were definitely influenced by C++ directly<sup>1</sup>, but here is a list of features in standard C++ that were added in C99:</p>\n\n<ul>\n<li>single line comments (as mentioned)</li>\n<li>inline functions</li>\n<li>variables allowed after beginning of block</li>\n<li>boolean datatype</li>\n<li>complex math library</li>\n</ul>\n\n<p>C11:</p>\n\n<ul>\n<li>Anonymous unions (C11 allows anonymous structs too). Anonymous unions were already in standard C++. (Anonymous structs are still not allowed in standard C++).</li>\n</ul>\n\n<p><sup>1</sup> For example BCPL, predecessor of B which in turn is the predecessor of C already had same syntax for single line comments. Some of these may have been supported as language extensions in some C implementation prior to their incorporation to standard C++. In these cases both standard C and standard C++ may have been influenced by the same source, rather than influencing one another.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576690865, "post_id": 59396526, "comment_id": 104984037, "body": "Interesting, yet  &quot;will be added&quot; is not guaranteed."}], "tags": [], "owner": {"reputation": 605, "user_id": 7128840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdNYI.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/7128840/adam"}, "is_accepted": false, "score": 2, "last_activity_date": 1576687555, "last_edit_date": 1576687555, "creation_date": 1576687164, "answer_id": 59396526, "question_id": 59396256, "link": "https://stackoverflow.com/questions/59396256/which-c-features-are-influenced-by-derived-from-c-features/59396526#59396526", "title": "Which C Features are influenced by/derived from C++ Features?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/C%2B%2B11#Attributes\" rel=\"nofollow noreferrer\">Attributes</a> were added in C++11 and will be added in the next C standard revision <a href=\"https://en.wikipedia.org/wiki/C2x\" rel=\"nofollow noreferrer\">C2x</a>. The <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2165.pdf\" rel=\"nofollow noreferrer\">proposal</a> (and <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2175.pdf\" rel=\"nofollow noreferrer\">here</a>) for this feature specifically references C++.</p>\n\n<blockquote>\n  <p>Attributes can be useful for providing information that, for example, helps the compiler to issue better diagnostics or optimize the generated code. <a href=\"https://en.wikipedia.org/wiki/C%2B%2B11#Attributes\" rel=\"nofollow noreferrer\">Source</a></p>\n</blockquote>\n\n<p>Example: </p>\n\n<pre><code>int [[attr1]] i [[attr2, attr3]];\n\n[[attr4(arg1, arg2)]] if (cond)\n\n{\n    [[vendor::attr5]] return i;\n}\n</code></pre>\n\n<p>In this example, \"<em>attribute attr1 applies to the type of variable i, attr2 and attr3 apply to the variable itself, attr4 applies to the if statement and vendor::attr5 applies to the return statement.</em>\" <a href=\"https://en.wikipedia.org/wiki/C%2B%2B11#Attributes\" rel=\"nofollow noreferrer\">Source</a> </p>\n"}], "owner": {"reputation": 12724, "user_id": 12139179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50aa08ca41bf24e8478a9b4dbc067c3?s=128&d=identicon&r=PG&f=1", "display_name": "RobertS supports Monica Cellio", "link": "https://stackoverflow.com/users/12139179/roberts-supports-monica-cellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "closed_date": 1576709052, "accepted_answer_id": 59396498, "answer_count": 2, "score": 8, "last_activity_date": 1576689539, "creation_date": 1576686336, "last_edit_date": 1576686999, "question_id": 59396256, "link": "https://stackoverflow.com/questions/59396256/which-c-features-are-influenced-by-derived-from-c-features", "closed_reason": "Opinion-based", "title": "Which C Features are influenced by/derived from C++ Features?", "body": "<p>What are features from the actual C Standard, which originally weren\u00b4t part of C, but were invented in/for C++ and because of its benefits, were later adopted to C?</p>\n\n<p>One prominent example is the single-line comment <code>//</code>, which originally came from C++ and later was adopted by C.</p>\n\n<p>Do you know more features of the actual C Standard, which explicitly or implicitly came from the development of C++?</p>\n\n<p>Info:\nOf course, I know that C++ is derived from C but i was just thinking about which features was adopted from the development of its derivative, C++.</p>\n"}, {"tags": ["c++", "reverse-engineering", "disassembly"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 6, "creation_date": 1576686350, "post_id": 59396214, "comment_id": 104981717, "body": "<code>ecx</code> and <code>rcx</code> share the same lower 32 bits, so the first instruction sets up an argument for the third."}, {"owner": {"reputation": 353, "user_id": 1593940, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0e5b94532c4d9008117a87e94792a2b?s=128&d=identicon&r=PG", "display_name": "Elastic Lamb", "link": "https://stackoverflow.com/users/1593940/elastic-lamb"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1576686454, "post_id": 59396214, "comment_id": 104981776, "body": "Not seeing this cost me hours - thank you very much!"}, {"owner": {"reputation": 262, "user_id": 793392, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/610014f51d5007450153ec25a790ab0b?s=128&d=identicon&r=PG", "display_name": "beroal", "link": "https://stackoverflow.com/users/793392/beroal"}, "edited": false, "score": 0, "creation_date": 1581446094, "post_id": 59396214, "comment_id": 106433867, "body": "Just to make it clear, counter-intuitively, moving to <code>ecx</code> sets <b>all</b> bits of <code>rcx</code>, so the state of upper 32 bits of <code>rcx</code> before executing the code does not matter."}], "owner": {"reputation": 353, "user_id": 1593940, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0e5b94532c4d9008117a87e94792a2b?s=128&d=identicon&r=PG", "display_name": "Elastic Lamb", "link": "https://stackoverflow.com/users/1593940/elastic-lamb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576748759, "creation_date": 1576686180, "last_edit_date": 1576748759, "question_id": 59396214, "link": "https://stackoverflow.com/questions/59396214/instruction-overwrites-previous-result", "title": "Instruction overwrites previous Result", "body": "<p>I am currently analyzing a binary and came across the following three instructions:</p>\n\n<pre><code>movzx   ecx, byte [rax+r9]\nmovzx   edx, byte [rbx+r9]\nlea     ecx, [rcx+rdx]\n</code></pre>\n\n<p>The meaning of each of these instructions is clear to me, but the first and third in combination do not make any sense. The first movzx copies the value at [rax+r9] into ecx and afterwards ecx is overwritten again by the lea instruction? Why do we need the first movzx here?</p>\n\n<p>I guess I am just missing something and this is a nasty compiler trick, so I appreciate any help.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1576686456, "post_id": 59396201, "comment_id": 104981780, "body": "Which version of C++ is your question about? C++11 or C++14 or C++17?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1576686462, "post_id": 59396201, "comment_id": 104981785, "body": "Do you know the different between <code>const int *</code> and <code>int * const</code>?"}, {"owner": {"reputation": 646, "user_id": 7251286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e021813332cd736c36621f3a549487f?s=128&d=identicon&r=PG&f=1", "display_name": "florgeng", "link": "https://stackoverflow.com/users/7251286/florgeng"}, "edited": false, "score": 0, "creation_date": 1576686694, "post_id": 59396201, "comment_id": 104981936, "body": "see here: <a href=\"https://stackoverflow.com/a/1143272/7251286\">stackoverflow.com/a/1143272/7251286</a>"}, {"owner": {"reputation": 800, "user_id": 12078969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466261c5018ba62c55f65c1746441dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Ivanovic", "link": "https://stackoverflow.com/users/12078969/ivanovic"}, "edited": false, "score": 0, "creation_date": 1576686699, "post_id": 59396201, "comment_id": 104981939, "body": "If this is c++ your &quot;void&quot; should be written before foo --&gt; void foo (const... because that is the standard."}], "answers": [{"tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": false, "score": 0, "last_activity_date": 1576686695, "creation_date": 1576686695, "answer_id": 59396368, "question_id": 59396201, "link": "https://stackoverflow.com/questions/59396201/static-cast-for-const-casts-away-qualifiers/59396368#59396368", "title": "Static_cast for const casts away qualifiers", "body": "<p>This</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>T const* p\n</code></pre>\n\n<p>is a pointer to a <code>const</code> <code>T</code>. This</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>T* const p\n</code></pre>\n\n<p>is a <code>const</code> pointer to a <code>T</code>. Notice the difference? In the first example, the thing the pointer points to is the thing that is <code>const</code>. In the second example, the pointer itself is the thing that is <code>const</code>. Attempting to cast a <code>void const*</code> to a <code>mycustomStruct* const</code> means casting a pointer that points to something that is <code>const</code> to a pointer that points to something that is not <code>const</code> (just the pointer itself happens to be <code>const</code>). Thus, this cast would drop a <code>const</code> qualifier, which is not something that <code>static_cast</code> can do\u2026</p>\n\n<p>You probably wanted to write</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>const mycustomStruct* pFlmcCtrl = static_cast&lt;const mycustomStruct*&gt;(pMdbCluster);\n</code></pre>\n"}], "owner": {"reputation": 114, "user_id": 6636244, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/172e1707f4ab3bb71e7c6328842447cd?s=128&d=identicon&r=PG&f=1", "display_name": "T T", "link": "https://stackoverflow.com/users/6636244/t-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "closed_date": 1576690547, "answer_count": 1, "score": 0, "last_activity_date": 1576686695, "creation_date": 1576686118, "last_edit_date": 1576686471, "question_id": 59396201, "link": "https://stackoverflow.com/questions/59396201/static-cast-for-const-casts-away-qualifiers", "closed_reason": "Duplicate", "title": "Static_cast for const casts away qualifiers", "body": "<p>I'm writing a code with following function and new to C++</p>\n\n<pre><code>foo(void const *pCluster, const uint32_t fieldNum, __attribute__((unused)) const uint32_t subFieldNum, const int64_t value)\n{\n    bool status = false;\n\n    mycustomStruct* const pFlmcCtrl = static_cast&lt;mycustomStruct* const&gt;(pMdbCluster);\n\n   // Some Processing\n}\n</code></pre>\n\n<p>This gives error error: <code>static_cast from 'const void *' to 'mycustomStruct* const'  casts away qualifiers</code>.</p>\n\n<p>Please help me understand the error here. I could not understand</p>\n"}, {"tags": ["c#", "c++", "performance", "hashset", "unordered-set"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576685978, "post_id": 59396081, "comment_id": 104981509, "body": "[Tangent] Why are you using <code>malloc</code> and <code>free</code> in your C++ implementation?  Technically you have UB because of <code>unsigned char *unibytes = (unsigned char*)malloc(unibytes_count);</code> doesn&#39;t actually create an array for <code>char</code>&#39;s."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576686131, "post_id": 59396081, "comment_id": 104981585, "body": "Also, <code>std::unordered_set</code> is about the worst hashed container you can get.  It is required to be implemented in buckets of linked lists and linked lists are performance-agnostic.  Finding a better hash-set for your C++ code should improve the speed."}, {"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576686201, "post_id": 59396081, "comment_id": 104981639, "body": "@NathanOliver-ReinstateMonica I like <code>malloc</code> since I can do <code>realloc</code> if needed. Do you know any better hash-sets for C++?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576686225, "post_id": 59396081, "comment_id": 104981651, "body": "Recommendation: use less, looks like you can get away with almost zero, manual dynamic allocation in the C++ code. Let the containers handle the storage. Take advantage of <code>vector</code>s contiguous storage to provide cache friendliness."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1576686258, "post_id": 59396081, "comment_id": 104981662, "body": "If you need reallocation, use a <code>std::vector</code>.  Then you have value semantics and well defined behavior."}, {"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576686478, "post_id": 59396081, "comment_id": 104981796, "body": "@NathanOliver-ReinstateMonica - Will it help me to get C#&#39;s speed?"}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 1, "creation_date": 1576686480, "post_id": 59396081, "comment_id": 104981797, "body": "I ran your C++ code \u2026 and it took 0.8 seconds. Are you <b>sure</b> you ran it in release? In debug it took 4.5 seconds \u2026"}, {"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "reply_to_user": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 0, "creation_date": 1576686526, "post_id": 59396081, "comment_id": 104981827, "body": "@ChrisMM - Yes, I am sure it&#39;s release. I use VC++ 2010 Express. What you use?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576686581, "post_id": 59396081, "comment_id": 104981868, "body": "Can&#39;t say.  What I can say is UB is not good, even if it &quot;does the right thing&quot;.  As far as what set you can use in <code>unordered_set</code>&#39;s place, I would suggest looking at google/FB/boost.  They probably have a faster implementation."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 1, "creation_date": 1576686586, "post_id": 59396081, "comment_id": 104981871, "body": "@ChrisMM Asker could be using a 286 or a <a href=\"https://www.youtube.com/watch?v=qpMvS1Q1sos\" rel=\"nofollow noreferrer\">Dorito</a>."}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 0, "creation_date": 1576686592, "post_id": 59396081, "comment_id": 104981875, "body": "@Kosmos VS 2019 Community \u2026 Also, don&#39;t use <code>time</code> for measuring time. Upgrade to at least c++11, and use <code>high_resolution_clock</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1576686863, "post_id": 59396081, "comment_id": 104982023, "body": "Kind of impressed that VS2010 supported <code>unordered_set</code>. It wasn&#39;t formally added to C++ for another year. Since this would have been the first kick at the can, it&#39;s possible the implementation&#39;s a bit weak."}, {"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576687129, "post_id": 59396081, "comment_id": 104982173, "body": "@MaxLanghof - Yes, but C# has same collisions count. What would you use in C++ to get hash from unsigned char array?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576687193, "post_id": 59396081, "comment_id": 104982204, "body": "@Kosmos I misread the algorithm. The prime is still bad though :D"}], "answers": [{"comments": [{"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "edited": false, "score": 0, "creation_date": 1576824338, "post_id": 59402749, "comment_id": 105028437, "body": "Thank you. Sadly, 1 and 3 will not help me. That was just minimal example to demonstrate difference between set lookups between C++ and C#. Real program fills it in another way and another count of elements. I thinks the slow part was <code>find()</code>. And I can&#39;t  spare single bit, because real structure has dynamic size for <code>DiscountUsagesCount</code>. I set it to 5 in example, but it could be more or less. I will make changes in hash function. I already switched to VC++2019 and my program now run like 10 times faster. I can&#39;t believe it. I always though than older soft, than faster and less memory it use"}], "tags": [], "owner": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "is_accepted": false, "score": 1, "last_activity_date": 1576724332, "creation_date": 1576724332, "answer_id": 59402749, "question_id": 59396081, "link": "https://stackoverflow.com/questions/59396081/c-hashset-vs-c-stdunordered-set-with-custom-class-keys-c-slower-it-ca/59402749#59402749", "title": "C# HashSet VS C++ std::unordered_set with custom class keys. C++ slower... it can&#39;t be. How to achieve C#&#39;s speed?", "body": "<p>I am using Visual Studio 2019, and my <code>RELEASE</code> build of your code ran in ~700ms.</p>\n\n<p>You most certainly can beat this time with a couple of improvements.</p>\n\n<ol>\n<li><p>While you insert 1,500,000 elements into your hash set, it is being re-hashed about 10 times. You can avoid that by specifying number of buckets when you construct that set. Setting it to 800,000 saves about 20%.</p></li>\n<li><p>In your hash function, you create and destroy an array of 9 bytes. 1,500,000 times! You could have a static array and simply fill it with the required data. However, you could simply do the math on your fields directly, which will save you about 50%:</p>\n\n<pre><code>struct XVectorHasher\n{\nsize_t operator()(const XVector* k) const\n{\n    size_t result = 0;\n    const size_t prime = 31;\n\n    result = k-&gt;XVFs.IsPromo;\n    result = k-&gt;XVFs.JointPromosCountSinceBeginning + (result * prime);\n    result = k-&gt;XVFs.PromoWeeksCountSinceCurrPromoBeginning + (result * prime);\n    result = k-&gt;XVFs.NoPromoWeeksCountSinceLastJointPromo + (result * prime);\n    for (size_t i = 0; i &lt; 5; i++)\n        result = k-&gt;DiscountUsagesCounts[i] + (result * prime);\n    return result;\n}\n};\n</code></pre></li>\n<li><p>Is the data structure in your example real or simplified? What are the valid ranges for those <code>unsigned char</code> fields? The reason I am asking is that you only have 8 bytes + 1 bool. If you can spare a single bit in any of those 8 bytes, you can simply compose a <code>long long</code> key and won\u2019t have to provide your own custom hash and compare. That will save you another 50%</p></li>\n</ol>\n"}], "owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576724332, "creation_date": 1576685693, "last_edit_date": 1576699135, "question_id": 59396081, "link": "https://stackoverflow.com/questions/59396081/c-hashset-vs-c-stdunordered-set-with-custom-class-keys-c-slower-it-ca", "title": "C# HashSet VS C++ std::unordered_set with custom class keys. C++ slower... it can&#39;t be. How to achieve C#&#39;s speed?", "body": "<p>I porting my program to C++ to achieve better speed, but met something terrible! I can't find a <code>fast</code> way to get unique by value custom class instances from array.</p>\n\n<p>I made two minimal example projects for comparison.</p>\n\n<p>C++ program RELEASE result (VC++ 2010 express):\n<code>Unique vectors count is 666791. Took 5 seconds.</code></p>\n\n<p>C# program DEBUG!!! result:\n<code>Unique vectors count is 666533. Took 0,9060004 seconds.</code></p>\n\n<p>I need a way to get only unique elements from array.</p>\n\n<p>C++ code:</p>\n\n<pre><code>#include &lt;conio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;vector&gt;\n#include &lt;unordered_set&gt;\n\nstruct XVFields\n{\n    unsigned char JointPromosCountSinceBeginning;\n    unsigned char PromoWeeksCountSinceCurrPromoBeginning;\n    unsigned char NoPromoWeeksCountSinceLastJointPromo;\n    unsigned char IsPromo;\n};\n\nclass XVector\n{\npublic:\n        XVFields XVFs;\n        unsigned char *DiscountUsagesCounts;\n\n    XVector()\n    {\n        this-&gt;DiscountUsagesCounts = (unsigned char*)malloc(5);\n    }\n};\n\nstruct XVectorHasher\n{\n    size_t operator()(const XVector *k) const\n    {\n        size_t result = 0;\n        const size_t prime = 31;\n\n        int unibytes_count = sizeof(XVFields) + 5;\n        unsigned char *unibytes = (unsigned char*)malloc(unibytes_count);\n        memcpy(unibytes, &amp;k-&gt;XVFs, sizeof(XVFields));\n        memcpy(&amp;unibytes[sizeof(XVFields)], k-&gt;DiscountUsagesCounts, 5);\n\n        for (size_t i = 0; i &lt; unibytes_count; i++)\n            result = unibytes[i] + (result * prime);\n\n        free(unibytes);\n\n        return result;\n    }\n};\n\nstruct XVectorComparator\n{\n    bool operator()(const XVector *xv1, const XVector *xv2) const\n    {\n        if (memcmp(&amp;xv1-&gt;XVFs, &amp;xv2-&gt;XVFs, sizeof(XVFields)) != 0)\n            return false;\n\n        if (memcmp(xv1-&gt;DiscountUsagesCounts, xv2-&gt;DiscountUsagesCounts, 5) != 0)\n            return false;\n\n        return true;\n    }\n};\n\nvoid main()\n{\n    srand(time(NULL));\n    std::vector&lt;XVector*&gt; xvectors;\n\n    for (int i = 0; i &lt; 1500000; i++)\n    {\n        XVector *temp_xv = new XVector();\n        temp_xv-&gt;XVFs.IsPromo = rand() % 2 &gt; 0;\n        temp_xv-&gt;XVFs.JointPromosCountSinceBeginning = rand() % 5;\n        temp_xv-&gt;XVFs.NoPromoWeeksCountSinceLastJointPromo = rand() % 5;\n        temp_xv-&gt;XVFs.PromoWeeksCountSinceCurrPromoBeginning = rand() % 5;\n\n        for (int j = 0; j &lt; 5; j++)\n            temp_xv-&gt;DiscountUsagesCounts[j] = rand() % 5;\n\n        xvectors.push_back(temp_xv);\n    }\n\n    time_t start_dt = time(NULL);\n    std::unordered_set&lt;XVector*, XVectorHasher, XVectorComparator&gt; *unique_xvs = new std::unordered_set&lt;XVector*, XVectorHasher, XVectorComparator&gt;();\n\n    for (int i = 0; i &lt; xvectors.size(); i++)\n        if (unique_xvs-&gt;find(xvectors[i]) == unique_xvs-&gt;end())\n            unique_xvs-&gt;insert(xvectors[i]);\n\n    printf(\"Unique vectors count is %i. Took %i seconds.\", unique_xvs-&gt;size(), time(NULL) - start_dt);\n    getch();\n}\n</code></pre>\n\n<p>C# code:</p>\n\n<pre><code>using System;\nusing System.Text;\nusing System.Linq;\nusing System.Collections.Generic;\n\nnamespace DictSpeedTest\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Random rnd = new Random((int)(DateTime.Now - new DateTime(1970, 1, 1)).TotalSeconds);\n            List&lt;XVector&gt; xvectors = new List&lt;XVector&gt;();\n\n            for (int i = 0; i &lt; 1500000; i++)\n            {\n                XVector temp_xv = new XVector();\n                temp_xv.XVFs.IsPromo = rnd.Next(2) &gt; 0;\n                temp_xv.XVFs.JointPromosCountSinceBeginning = (byte)rnd.Next(0, 5);\n                temp_xv.XVFs.NoPromoWeeksCountSinceLastJointPromo = (byte)rnd.Next(0, 5);\n                temp_xv.XVFs.PromoWeeksCountSinceCurrPromoBeginning = (byte)rnd.Next(0, 5);\n\n                for (int j = 0; j &lt; temp_xv.DiscountUsagesCounts.Length; j++)\n                    temp_xv.DiscountUsagesCounts[j] = (byte)rnd.Next(0, 5);\n\n                xvectors.Add(temp_xv);\n            }\n\n            DateTime start_dt = DateTime.Now;\n            HashSet&lt;XVector&gt; unique_xvs = new HashSet&lt;XVector&gt;(new XVectorEqualityComparer());\n\n            for (int i = 0; i &lt; xvectors.Count; i++)\n                if (!unique_xvs.Contains(xvectors[i]))\n                    unique_xvs.Add(xvectors[i]);\n\n            Console.WriteLine(\"Unique vectors count is \" + unique_xvs.Count + \". Took \" + (DateTime.Now - start_dt).TotalSeconds + \" seconds.\");\n            Console.ReadKey();\n        }\n    }\n\n    struct XVFields\n    {\n        public byte JointPromosCountSinceBeginning;\n        public byte PromoWeeksCountSinceCurrPromoBeginning;\n        public byte NoPromoWeeksCountSinceLastJointPromo;\n        public bool IsPromo;\n    }\n\n    class XVector\n    {\n        public XVFields XVFs;\n        public byte[] DiscountUsagesCounts;\n\n        public XVector()\n        {\n            this.DiscountUsagesCounts = new byte[5];\n        }\n\n        public override bool Equals(object obj)\n        {\n            byte[] my_low_lvl_dump = new byte[4 + 5];\n\n            my_low_lvl_dump[0] = this.XVFs.IsPromo ? (byte)1 : (byte)0;\n            my_low_lvl_dump[1] = this.XVFs.JointPromosCountSinceBeginning;\n            my_low_lvl_dump[2] = this.XVFs.PromoWeeksCountSinceCurrPromoBeginning;\n            my_low_lvl_dump[3] = this.XVFs.NoPromoWeeksCountSinceLastJointPromo;\n            my_low_lvl_dump[4] = this.DiscountUsagesCounts[0];\n            my_low_lvl_dump[5] = this.DiscountUsagesCounts[1];\n            my_low_lvl_dump[6] = this.DiscountUsagesCounts[2];\n            my_low_lvl_dump[7] = this.DiscountUsagesCounts[3];\n            my_low_lvl_dump[8] = this.DiscountUsagesCounts[4];\n\n            XVector xv = (XVector)obj;\n            byte[] obj_low_lvl_dump = new byte[4 + 5];\n\n            obj_low_lvl_dump[0] = xv.XVFs.IsPromo ? (byte)1 : (byte)0;\n            obj_low_lvl_dump[1] = xv.XVFs.JointPromosCountSinceBeginning;\n            obj_low_lvl_dump[2] = xv.XVFs.PromoWeeksCountSinceCurrPromoBeginning;\n            obj_low_lvl_dump[3] = xv.XVFs.NoPromoWeeksCountSinceLastJointPromo;\n            obj_low_lvl_dump[4] = xv.DiscountUsagesCounts[0];\n            obj_low_lvl_dump[5] = xv.DiscountUsagesCounts[1];\n            obj_low_lvl_dump[6] = xv.DiscountUsagesCounts[2];\n            obj_low_lvl_dump[7] = xv.DiscountUsagesCounts[3];\n            obj_low_lvl_dump[8] = xv.DiscountUsagesCounts[4];\n\n            return my_low_lvl_dump.SequenceEqual&lt;byte&gt;(obj_low_lvl_dump);\n        }\n\n        public override int GetHashCode()\n        {\n            byte[] low_lvl_dump = new byte[4 + 5];\n\n            low_lvl_dump[0] = this.XVFs.IsPromo ? (byte)1 : (byte)0;\n            low_lvl_dump[1] = this.XVFs.JointPromosCountSinceBeginning;\n            low_lvl_dump[2] = this.XVFs.PromoWeeksCountSinceCurrPromoBeginning;\n            low_lvl_dump[3] = this.XVFs.NoPromoWeeksCountSinceLastJointPromo;\n            low_lvl_dump[4] = this.DiscountUsagesCounts[0];\n            low_lvl_dump[5] = this.DiscountUsagesCounts[1];\n            low_lvl_dump[6] = this.DiscountUsagesCounts[2];\n            low_lvl_dump[7] = this.DiscountUsagesCounts[3];\n            low_lvl_dump[8] = this.DiscountUsagesCounts[4];\n\n            int result = 0;\n            int prime = 31;\n\n            for (int i = 0; i &lt; low_lvl_dump.Length; i++)\n                result = low_lvl_dump[i] + (result * prime);\n\n            return result;\n        }\n    }\n\n    class XVectorEqualityComparer : IEqualityComparer&lt;XVector&gt;\n    {\n        public bool Equals(XVector xv1, XVector xv2)\n        {\n            return xv1.Equals(xv2);\n        }\n\n        public int GetHashCode(XVector xv)\n        {\n            return xv.GetHashCode();\n        }\n    }\n}\n</code></pre>\n\n<p>C# does way expensive operations for producing arrays for hash functions and yet final result is faster.</p>\n"}, {"tags": ["c++", "odbc", "driver", "dsn"], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 11272100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea5b3bb1f79e2f48166c594523816d5?s=128&d=identicon&r=PG&f=1", "display_name": "oleque", "link": "https://stackoverflow.com/users/11272100/oleque"}, "is_accepted": true, "score": 1, "last_activity_date": 1576763918, "creation_date": 1576763918, "answer_id": 59411247, "question_id": 59395666, "link": "https://stackoverflow.com/questions/59395666/how-to-connect-to-odbc-dsn-through-c/59411247#59411247", "title": "How to connect to ODBC DSN through c++", "body": "<p>In fact ODBC Driver Manager makes these calls to ODBC driver when performing your SQLConnect call: on this stage it \"knows\" which driver you want to use. Look at the SQLConnect function description, \"Comments\" section:</p>\n\n<p>\"The Driver Manager does not connect to a driver until the application calls a function (SQLConnect, SQLDriverConnect, or SQLBrowseConnect) to connect to the driver. Until that point, the Driver Manager works with its own handles and manages connection information. When the application calls a connection function, the Driver Manager checks whether a driver is currently connected to for the specified ConnectionHandle:</p>\n\n<ul>\n<li><p>If a driver is not connected to, the Driver Manager connects to the driver and calls SQLAllocHandle with a HandleType of SQL_HANDLE_ENV, SQLAllocHandle with a HandleType of SQL_HANDLE_DBC, SQLSetConnectAttr (if the application specified any connection attributes), and the connection function in the driver. The Driver Manager returns SQLSTATE IM006 (Driver's SQLSetConnectOption failed) and SQL_SUCCESS_WITH_INFO for the connection function if the driver returned an error for SQLSetConnectAttr. For more information, see Connecting to a Data Source or Driver.</p></li>\n<li><p>If the specified driver is already connected to on the ConnectionHandle, the Driver Manager calls only the connection function in the driver. In this case, the driver must make sure that all connection attributes for the ConnectionHandle maintain their current settings.</p></li>\n<li><p>If a different driver is connected to, the Driver Manager calls SQLFreeHandle with a HandleType of SQL_HANDLE_DBC, and then, if no other driver is connected to in that environment, it calls SQLFreeHandle with a HandleType of SQL_HANDLE_ENV in the connected driver and then disconnects that driver. It then performs the same operations as when a driver is not connected to.</p></li>\n</ul>\n\n<p>The driver then allocates handles and initializes itself.\"</p>\n\n<p>Full text here: <a href=\"https://docs.microsoft.com/en-us/sql/odbc/reference/syntax/sqlconnect-function?view=aps-pdw-2016#comments\" rel=\"nofollow noreferrer\">SQLConnect function comments</a></p>\n"}], "owner": {"reputation": 55, "user_id": 8635040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20749a51734b2e7c5105ca8f93be6cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Filip Cacic", "link": "https://stackoverflow.com/users/8635040/filip-cacic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 59411247, "answer_count": 1, "score": 0, "last_activity_date": 1576763918, "creation_date": 1576684247, "question_id": 59395666, "link": "https://stackoverflow.com/questions/59395666/how-to-connect-to-odbc-dsn-through-c", "title": "How to connect to ODBC DSN through c++", "body": "<p>I made a PostgreSQL30 data source name. I tested it and I managed to connect to that dsn through ODBC data source window manager. There was a button Test and It showed message dialog, telling me that connection was success.</p>\n\n<p>Now I wonder how would I connect to that DSN through c++ code and get some data. </p>\n\n<p>This is my code, i saw few examplex online and come up with this code</p>\n\n<pre><code>enter code here\n\nHENV hEnv = NULL; // for allocating memory usingSQLAllocEnv\nHDBC hDBC = NULL; // connection handler\nHSTMT hStmt = NULL; // statement handler\nconst char* szDSN = \"PostgreSQL30\"; // DataSourceName (config in windows \ncontrol panel)\nconst char* szUID = \"postgres\"; //username of the database\nconst char* szPasswd = \"postgres\"; //password of the database\n\nRETCODE retcode;\nint rcod = 1;\nint i, j, no = 2;\n\n\n\nint main()\n{ \n  retcode = SQLAllocHandle(SQL_HANDLE_ENV, SQL_NULL_HANDLE, &amp;hEnv);\n\n  std::cout &lt;&lt; retcode &lt;&lt; std::endl;\n\n  SQLSetEnvAttr(hEnv, SQL_ATTR_ODBC_VERSION, (void*)SQL_OV_ODBC3, 0);\n\n  retcode = SQLAllocHandle(SQL_HANDLE_DBC, hEnv, &amp;hDBC);\n\n  std::cout &lt;&lt; retcode &lt;&lt; std::endl;\n\n   retcode = SQLConnectA(hDBC,(SQLCHAR*)szDSN, SQL_NTS, (SQLCHAR*)szUID, SQL_NTS, \n  (SQLCHAR*)szPasswd, \n  SQL_NTS);\n\n\nstd::cout &lt;&lt; (SQLCHAR*)szUID &lt;&lt; std::endl;\n\n\nif (retcode == SQL_SUCCESS || retcode == SQL_SUCCESS_WITH_INFO)\n{\n    // connected!!\n    std::cout &lt;&lt; \"Hello World!\\n SUCCESSS COME ON PLEASE\";\n}\nelse {\n    std::cout &lt;&lt; retcode &lt;&lt; std::endl;\n}\n\n\nSQLFreeHandle(SQL_HANDLE_ENV, &amp;hEnv);\nSQLFreeHandle(SQL_HANDLE_DBC, &amp;hDBC);\n</code></pre>\n\n<p>}</p>\n\n<p>But I cant comprehend why would this work, I mean how is this code knows to call SQLAllocHandle implemented by Postgres driver ?</p>\n\n<p>My question is how would I connect to DSN thorugh C++ code and get some data</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1576685419, "post_id": 59395565, "comment_id": 104981187, "body": "You should move the declarations of <code>std::random_device</code> and <code>std::default_random_engine</code> outside of the function, in <code>main</code>, because initializing those more than once in a program is a waste. Also, what do you need those coordinates for? Are you going to use that &quot;2D array&quot; in any other way or is it just for bookkeeping (limited to the random generation) purposes?"}, {"owner": {"reputation": 3, "user_id": 12197970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513ce60c8acaa3fb9cae5f13eba22966?s=128&d=identicon&r=PG&f=1", "display_name": "Shui", "link": "https://stackoverflow.com/users/12197970/shui"}, "reply_to_user": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1576687477, "post_id": 59395565, "comment_id": 104982357, "body": "I will be placing various object types randomly on a grid and need to be sure I&#39;m not placing anything on top of anything else. I figured when they&#39;re generated they would check occupiedSpace to see if their space is valid or not before using that space. After they&#39;re finished occupiedSpace won&#39;t be used again (as far as I know right now)."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12197970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513ce60c8acaa3fb9cae5f13eba22966?s=128&d=identicon&r=PG&f=1", "display_name": "Shui", "link": "https://stackoverflow.com/users/12197970/shui"}, "edited": false, "score": 0, "creation_date": 1576684557, "post_id": 59395689, "comment_id": 104980646, "body": "Thank you, I figured I was using calloc incorrectly so that was all my focus was on."}], "tags": [], "owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "is_accepted": true, "score": 4, "last_activity_date": 1576684331, "creation_date": 1576684331, "answer_id": 59395689, "question_id": 59395565, "link": "https://stackoverflow.com/questions/59395565/seg-fault-when-changing-values-on-a-2d-matrix/59395689#59395689", "title": "Seg fault when changing values on a 2D Matrix", "body": "<p>You're generating your <code>x</code> and <code>y</code> coordinate the wrong way round. The outer index is the row, the inner index is the column, so you should do:</p>\n\n<pre><code>x = randomNoGenerator(numRows); // instead of numCols\ny = randomNoGenerator(numCols); // instead of numRows\n</code></pre>\n\n<p>Then, you set up your random generator with wrong numbers. It should be <code>uniform_dist(0, limit - 1)</code> instead of <code>uniform_dist(1, limit)</code> since row and column indexing starts at 0.</p>\n"}, {"comments": [{"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "edited": false, "score": 1, "creation_date": 1576685991, "post_id": 59395925, "comment_id": 104981516, "body": "You switched row and column length. And: If we&#39;re talking nicer ways to implement this, I&#39;d say <code>int occupiedSpace[5][7]{};</code> is hard to beat."}], "tags": [], "owner": {"reputation": 71, "user_id": 12473489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OPqLX.jpg?s=128&g=1", "display_name": "jbrouwer", "link": "https://stackoverflow.com/users/12473489/jbrouwer"}, "is_accepted": false, "score": 0, "last_activity_date": 1576685105, "creation_date": 1576685105, "answer_id": 59395925, "question_id": 59395565, "link": "https://stackoverflow.com/questions/59395565/seg-fault-when-changing-values-on-a-2d-matrix/59395925#59395925", "title": "Seg fault when changing values on a 2D Matrix", "body": "<p>You can also use std:array instead calloc :</p>\n\n<pre><code>   std::array&lt;std::array&lt;int,5&gt;,7&gt; occupiedSpace;\n\n    for ( int i = 0; i &lt; numCols; i++)\n        { for (int j = 0; j &lt; numRows; j++) occupiedSpace[i][j] = 0 ; \n        }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12197970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513ce60c8acaa3fb9cae5f13eba22966?s=128&d=identicon&r=PG&f=1", "display_name": "Shui", "link": "https://stackoverflow.com/users/12197970/shui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59395689, "answer_count": 2, "score": 0, "last_activity_date": 1576685105, "creation_date": 1576683949, "question_id": 59395565, "link": "https://stackoverflow.com/questions/59395565/seg-fault-when-changing-values-on-a-2d-matrix", "title": "Seg fault when changing values on a 2D Matrix", "body": "<p>I'm trying to create random coordinates but to make sure they aren't used I decided to create a 2D array initialized at 0 to show each space is empty. </p>\n\n<p>I'm using this function for the randomness:</p>\n\n<pre><code>int randomNoGenerator(int limit)\n{\n   std::random_device r;\n\n   std::default_random_engine e1(r());\n   std::uniform_int_distribution&lt;int&gt; uniform_dist(1, limit);\n   int rand = uniform_dist(e1);\n   return rand;\n} \n</code></pre>\n\n<p>And my main:</p>\n\n<pre><code>int main(void)\n{\n    int numRows = 5;\n    int numCols = 7;\n    int **occupiedSpace;\n\n    occupiedSpace = (int **)calloc(numRows, sizeof(int *));\n    for (int i = 0; i &lt; numRows; i++)\n        occupiedSpace[i] = (int *)calloc(numCols, sizeof(int));\n\n    for (int i = 0; i &lt; 5; i++)\n    {\n        int x;\n        int y;\n        int match = 1;\n        x = randomNoGenerator(numCols);\n        y = randomNoGenerator(numRows);\n\n        //This is where the crash is happening?\n        occupiedSpace[x][y] = 1;\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>My ultimate goal was to have something like where if it's empty it just replaces it with a 1. Otherwise it keeps generating X, Y if it's already occupied.</p>\n\n<pre><code>while (match)\n        {\n            x = randomNoGenerator(numCols);\n            y = randomNoGenerator(numRows);\n            if(occupiedSpace[x][y] = 0)\n                {\n                occupiedSpace[x][y] = 1;\n                match = 0;\n                }\n        }\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "std", "cpu-cache"], "comments": [{"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 3, "creation_date": 1576684999, "post_id": 59395547, "comment_id": 104980914, "body": "&quot;<i>Both should be the same as the cacheline-size.</i>&quot; Should they? Can you explain why they should be the same? In a way that <i>doesn&#39;t</i> use specific implementation details?"}, {"owner": {"reputation": 847, "user_id": 6469690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kvGyE.png?s=128&g=1", "display_name": "Bonita Montero", "link": "https://stackoverflow.com/users/6469690/bonita-montero"}, "reply_to_user": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1576685337, "post_id": 59395547, "comment_id": 104981137, "body": "The size that says what&#39;s the maximum size of a data-structue that shares only a single cacheline should be the same as the minimum difference between two data-structure to prevent false sharing."}, {"owner": {"reputation": 847, "user_id": 6469690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kvGyE.png?s=128&g=1", "display_name": "Bonita Montero", "link": "https://stackoverflow.com/users/6469690/bonita-montero"}, "edited": false, "score": 0, "creation_date": 1576689176, "post_id": 59395547, "comment_id": 104983230, "body": "That&#39;s the article I mentioned. But it doesn&#39;t tell why these sizes are different."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1576689595, "post_id": 59395547, "comment_id": 104983420, "body": "As I&#39;ve understood it the sizes <i>doesn&#39;t need</i> to be different. The separate definitions just cover the case that they <i>could</i> be different i.e. to cover exotic H/W as well. (I must admit I don&#39;t try too hard to think about H/W. I&#39;m too busy to get my S/W running and hopefully free of U.B. and, maybe, even with performance) ;-)"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1576690499, "post_id": 59395547, "comment_id": 104983873, "body": "It depends on the maximum achievable alignment.  If it is less than the L1 cache line size then the compiler can&#39;t ensure that a variable is stored at the start of a cache line."}], "answers": [{"comments": [{"owner": {"reputation": 847, "user_id": 6469690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kvGyE.png?s=128&g=1", "display_name": "Bonita Montero", "link": "https://stackoverflow.com/users/6469690/bonita-montero"}, "edited": false, "score": 0, "creation_date": 1576956636, "post_id": 59429993, "comment_id": 105062259, "body": "That&#39;s wrong. With sectored caches the unit of coherence between the cores is a sector. The maximum size for true sharing should be a sector and the minimum distance between objects to avoid false sharing should be a sector also. So both should be equally sized as well."}, {"owner": {"reputation": 4135, "user_id": 2467198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68656858083f23c2808393402d0152e?s=128&d=identicon&r=PG", "display_name": "Paul A. Clayton", "link": "https://stackoverflow.com/users/2467198/paul-a-clayton"}, "reply_to_user": {"reputation": 847, "user_id": 6469690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kvGyE.png?s=128&g=1", "display_name": "Bonita Montero", "link": "https://stackoverflow.com/users/6469690/bonita-montero"}, "edited": false, "score": 0, "creation_date": 1576956879, "post_id": 59429993, "comment_id": 105062307, "body": "@BonitaMontero True sharing is the fetch width, which is the cache block (IBM)/cache sector (Intel) when the entire block/sector is fetched (which is typically the case for such caches, at least from main memory \u2014 reads satisfied from another cache might leave other sectors/lines invalid). Coherence (invalidation) is at the granularity of sector/line, so false sharing is at that granularity. std::hardware_constructive_interference_size is more concerned with how much memory will be brought in on an access, particularly from main memory."}, {"owner": {"reputation": 847, "user_id": 6469690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kvGyE.png?s=128&g=1", "display_name": "Bonita Montero", "link": "https://stackoverflow.com/users/6469690/bonita-montero"}, "edited": false, "score": 0, "creation_date": 1576962044, "post_id": 59429993, "comment_id": 105063287, "body": "No, true sharing means that there aren&#39;t any avoidable collisions with other caching-units on other cores. It is not necessarily bound to the fetch-width. With sectored caches different cores can share different sectors of the same cacheline. So this isn&#39;t related to the cacheline as a whole."}], "tags": [], "owner": {"reputation": 4135, "user_id": 2467198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68656858083f23c2808393402d0152e?s=128&d=identicon&r=PG", "display_name": "Paul A. Clayton", "link": "https://stackoverflow.com/users/2467198/paul-a-clayton"}, "is_accepted": false, "score": 0, "last_activity_date": 1576867382, "creation_date": 1576867382, "answer_id": 59429993, "question_id": 59395547, "link": "https://stackoverflow.com/questions/59395547/why-are-stdhardware-con-destructive-interference-size-different/59429993#59429993", "title": "Why are std::hardware_con/destructive_interference_size different?", "body": "<p>At least two types of cache designs can have different minimum alignment for avoiding false sharing and maximum alignment for true sharing: sectored cache blocks and variably aligned cache blocks.</p>\n\n<p>A sector cache block that fetches the entire block (IBM-speak; sector in Intel-speak; unit of tag coverage) on a miss would have the block (sector) size for std::hardware_constructive_interference_size. Since smaller sectors (IBM-speak; line in Intel-speak; unit of validity) would be invalidated by remote (or different level cache) writes, std::hardware_destructive_interference_size would be the size of this smaller chunk. This is an design that has been implemented.</p>\n\n<p>(It is not clear if a system that typically prefetches the adjacent block would have std::hardware_constructive_interference_size as twice the cache block/line size while having the cache block/line size for std::hardware_destructive_interference_size.)</p>\n\n<p>Variably aligned cache blocks* (a design targeting larger cache blocks with slightly less cache block internal fragmentation wasted capacity) align storage at a smaller value than cache block size. E.g., a 64B cache block could be aligned at an even or odd 32B alignment; std::hardware_constructive_interference_size would be 32B (since an odd-32B aligned cache block would not fetch the complementary half of a 64B aligned chunk) but std::hardware_destructive_interference_size would be 128B (since an odd-32B aligned cache block would interfere with two 64B-aligned addresses). Variably aligned cache blocks also breaks the concept of alignment being sufficient for managing this aspect of cache performance.</p>\n\n<p>Another possibility that would break these definitions would be a strided cache (a limited form of data trace cache). A cache that supported blocks with 2-word stride (i.e., one block storing words 0, 2, 4, etc. but not words 1, 3, 5, etc.) would significantly mess with the assumption behind std::hardware_constructive_interference_size and std::hardware_destructive_interference_size. While such cache blocks would typically be allocated for strided vector caching, the design violates the expectation of orthogonality and could cause performance problems when non-strided accesses are introduced later.</p>\n\n<hr>\n\n<ul>\n<li>The proposal for variable alignment mapped an alignment to a way and used overlaid skewed associativity to avoid capacity waste when any alignment was more common than another.</li>\n</ul>\n"}], "owner": {"reputation": 847, "user_id": 6469690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kvGyE.png?s=128&g=1", "display_name": "Bonita Montero", "link": "https://stackoverflow.com/users/6469690/bonita-montero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1576867382, "creation_date": 1576683878, "last_edit_date": 1576689735, "question_id": 59395547, "link": "https://stackoverflow.com/questions/59395547/why-are-stdhardware-con-destructive-interference-size-different", "title": "Why are std::hardware_con/destructive_interference_size different?", "body": "<p>First, I've had only found <a href=\"https://stackoverflow.com/a/39887282/7478597\">one question about <code>std::hardware_destructive_interference_size</code> and <code>std::hardware_constructive_interference_size</code></a> here and this doesn't answer the following question: why are there two distinct values for this. Both should be the same as the cacheline-size. So what cache-architecture could mandate that there are two distinct values?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1576684579, "post_id": 59395546, "comment_id": 104980662, "body": "The opposite of &quot;get&quot; is very often named &quot;put&quot;."}, {"owner": {"reputation": 1, "user_id": 12255811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af680f21e055ddacb5f70b9eeb2061?s=128&d=identicon&r=PG&f=1", "display_name": "frenli", "link": "https://stackoverflow.com/users/12255811/frenli"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576684700, "post_id": 59395546, "comment_id": 104980722, "body": "@molbdnilo I tried to use put, but this does not work."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576685059, "post_id": 59395546, "comment_id": 104980949, "body": "&quot;Does not work&quot; is not a useful problem description. If you post your attempt, someone can probably tell you what you did wrong. (Read about the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.)"}, {"owner": {"reputation": 1, "user_id": 12255811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af680f21e055ddacb5f70b9eeb2061?s=128&d=identicon&r=PG&f=1", "display_name": "frenli", "link": "https://stackoverflow.com/users/12255811/frenli"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576685253, "post_id": 59395546, "comment_id": 104981086, "body": "@molbdnilo added code as I did."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576685351, "post_id": 59395546, "comment_id": 104981147, "body": "What do you think the value of <code>i</code> is?"}, {"owner": {"reputation": 1, "user_id": 12255811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af680f21e055ddacb5f70b9eeb2061?s=128&d=identicon&r=PG&f=1", "display_name": "frenli", "link": "https://stackoverflow.com/users/12255811/frenli"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576685466, "post_id": 59395546, "comment_id": 104981211, "body": "@molbdnilo I just add 1 character there."}, {"owner": {"reputation": 4633, "user_id": 11383441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6fe326a8e47283a622c4dc9bf700992?s=128&d=identicon&r=PG&f=1", "display_name": "Kalana", "link": "https://stackoverflow.com/users/11383441/kalana"}, "edited": false, "score": 0, "creation_date": 1576686862, "post_id": 59395546, "comment_id": 104982022, "body": "Read this thread hope it will help you -&gt; <a href=\"https://forums.anandtech.com/threads/is-it-possible-to-read-and-write-to-same-file-at-same-time.2068136/\" rel=\"nofollow noreferrer\">forums.anandtech.com/threads/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12255811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af680f21e055ddacb5f70b9eeb2061?s=128&d=identicon&r=PG&f=1", "display_name": "frenli", "link": "https://stackoverflow.com/users/12255811/frenli"}, "reply_to_user": {"reputation": 4633, "user_id": 11383441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6fe326a8e47283a622c4dc9bf700992?s=128&d=identicon&r=PG&f=1", "display_name": "Kalana", "link": "https://stackoverflow.com/users/11383441/kalana"}, "edited": false, "score": 0, "creation_date": 1576688304, "post_id": 59395546, "comment_id": 104982793, "body": "@Kalana I do not understand why <code>put</code> does not work because of <code>fstream::in |</code>"}, {"owner": {"reputation": 4633, "user_id": 11383441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6fe326a8e47283a622c4dc9bf700992?s=128&d=identicon&r=PG&f=1", "display_name": "Kalana", "link": "https://stackoverflow.com/users/11383441/kalana"}, "edited": false, "score": 0, "creation_date": 1576688841, "post_id": 59395546, "comment_id": 104983048, "body": "I exactly have no idea because I am not expert at that side of c++. There for I have shared that link with you. sorry about that"}, {"owner": {"reputation": 1087, "user_id": 2129218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bf5ffff85c1f5609fca08eb8e05279?s=128&d=identicon&r=PG", "display_name": "Build Succeeded", "link": "https://stackoverflow.com/users/2129218/build-succeeded"}, "edited": false, "score": 0, "creation_date": 1576692103, "post_id": 59395546, "comment_id": 104984581, "body": "What kind of data is present in the file? Can you give the example?"}, {"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 0, "creation_date": 1578905539, "post_id": 59395546, "comment_id": 105577466, "body": "What exactly does not work? The loop in <code>write</code> will never stop and is only writing a single character until you kill the program. Except from that logic error it works fine for me. Keep in mind, that streams are buffered, which means, that changes you write to the file may not be immediately visible in the actual file."}], "owner": {"reputation": 1, "user_id": 12255811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af680f21e055ddacb5f70b9eeb2061?s=128&d=identicon&r=PG&f=1", "display_name": "frenli", "link": "https://stackoverflow.com/users/12255811/frenli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576685422, "creation_date": 1576683873, "last_edit_date": 1576685422, "question_id": 59395546, "link": "https://stackoverflow.com/questions/59395546/how-to-read-and-save-data-on-one-char-fstream", "title": "How to read and save data on one char? (fstream)", "body": "<p>I need to save and read one char at a time.</p>\n\n<p>I can only use fstream\ni can't use ifstream and ofstream</p>\n\n<p><strong>read</strong></p>\n\n<pre><code>// I hope I'm doing it right\nfstream fs(\"txt.txt\", fstream::in | fstream::out | ios::binary);\nfor (char i; fs.get(i);)\n{\n    cout &lt;&lt; i;\n}     \n</code></pre>\n\n<p><strong>write</strong></p>\n\n<pre><code>fstream fs(\"txt.txt\", fstream::in | fstream::out | ios::binary);\n//does not work\nfor (char i = 't'; fs.put(i);)\n{\n    cout &lt;&lt; i;\n}\n</code></pre>\n"}, {"tags": ["c++", "compiler-optimization", "ram", "latency", "throughput"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 6, "creation_date": 1576683418, "post_id": 59395354, "comment_id": 104980012, "body": "Random access is the bane of fast throughput.  You need something nice and predictable so the prefetcher has a chance of getting the memory you need into the cache.  Any way you can change your workflow to do sequential access?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 3, "creation_date": 1576683624, "post_id": 59395354, "comment_id": 104980120, "body": "The compiler does not use &quot;some L2 cache tricks&quot;. 16 MB is well within the cache size of modern processors."}, {"owner": {"reputation": 283, "user_id": 1437549, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef2fcab398417c26d5e417f179f158d4?s=128&d=identicon&r=PG", "display_name": "bobuhito", "link": "https://stackoverflow.com/users/1437549/bobuhito"}, "edited": false, "score": 0, "creation_date": 1576683756, "post_id": 59395354, "comment_id": 104980192, "body": "No, I can&#39;t make it sequential without fully loading the file and re-saving it...and that takes even more time.  Also, my PC has L2 cache of only 2MB (no L3 cache)."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576683989, "post_id": 59395354, "comment_id": 104980324, "body": "@bobuhito There are other aspects of memory accesses that can become faster for smaller working sets, e.g. the <a href=\"https://en.wikipedia.org/wiki/Translation_lookaside_buffer\" rel=\"nofollow noreferrer\">TLB</a>, which is itself a cache of sorts. You&#39;re likely to get tons of TLB misses for random 4 GB accesses."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1576683995, "post_id": 59395354, "comment_id": 104980326, "body": "There is not much you can do then.  You need a way to get the data into the cache and the only way to do that is to create a pattern the CPU can identify and leverage to work ahead of you.  When you have random access, you basically stop that process and suffer a cache miss on every access forcing you to slow down to main memory speeds.  Essentially you&#39;ve turned your vector into a linked list (which is practically the worst data structure for performance)."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576684134, "post_id": 59395354, "comment_id": 104980398, "body": "If you can compute the locations that you will eventually access beforehand (well, ~100 ns worth of iterations before needing them), you might be able to utilize prefetching. But even then your throughput will be many times lower than sequential reads. And manual prefetching in such an unpredictable environment is playing with fire."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1580744619, "post_id": 59395354, "comment_id": 106188804, "body": "Consider using an AVX scatter operation.  On modern micro architectures, they <a href=\"https://stackoverflow.com/a/54137942/417501\">considerably improve the throughput</a> over individual loads."}], "owner": {"reputation": 283, "user_id": 1437549, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ef2fcab398417c26d5e417f179f158d4?s=128&d=identicon&r=PG", "display_name": "bobuhito", "link": "https://stackoverflow.com/users/1437549/bobuhito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 3, "answer_count": 0, "score": 0, "last_activity_date": 1576683237, "creation_date": 1576683237, "question_id": 59395354, "link": "https://stackoverflow.com/questions/59395354/faster-ram-throughput", "title": "Faster RAM Throughput", "body": "<p>I understand that RAM latency can be 100ns, but I'd like to speed up a program which needs to basically just read from random locations within a huge 4GB array.  It seems reading could be pipelined or, alternatively (because my full program does a little writing to RAM also), I'd be happy to get \"old bits\" from RAM and do my own check that I have not recently changed these bits.</p>\n\n<p>Are there any solutions to get faster throughput?  I am willing to program in assembly, or even change my hardware, but my first hope is that I could do this on standard Intel/AMD hardware through Visual Studio C++.  Please see and test my simple program below - I want to get the read time down from my current 80ns to 2ns!</p>\n\n<p>(By the way, if I reduce the RAM usage from 4GB to 16MB, times fall to 10ns.  Some speed up is expected, but 8x is surprising.  Maybe the compiler is using some L2 cache tricks...anyway, 10ns is still far short of physical limits.)\n<br><br></p>\n\n<p><b>C++ Code:</b></p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;chrono&gt;     // just for execution time measurement\n\n#define RANDOM_COUNT  ((unsigned long long) 1 &lt;&lt; 24)\n#define RAM_SIZE      ((unsigned long long) 1 &lt;&lt; 29)\n//#define FAST_MOD      % RAM_SIZE\n#define FAST_MOD      &amp; (RAM_SIZE-1)\n\nint main()\n{\n    std::chrono::steady_clock::time_point t1, t2;\n    unsigned long long *ram = new unsigned long long[RAM_SIZE]; memset(ram, 0, RAM_SIZE * sizeof(unsigned long long));\n    for (unsigned long long i = 0; i &lt; 10; i++) {\n        unsigned long long      random = (  rand()*rand()*rand()  )  FAST_MOD;\n        unsigned long long  odd_random = (2*rand()*rand()*rand()+1);\n        unsigned long long         sum =  0;\n        t1 = std::chrono::high_resolution_clock::now();\n        for (unsigned long long j = 0; j &lt; RANDOM_COUNT; j++) {\n            sum += ram[random];\n            random = (random + odd_random)  FAST_MOD;\n        }\n        t2 = std::chrono::high_resolution_clock::now();\n        std::cout &lt;&lt; \"\\nns per read :  \" &lt;&lt; (std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(t2 - t1).count() / ((float)RANDOM_COUNT)) &lt;&lt; \"   0==\" &lt;&lt; sum;\n    }\n    delete[] ram;\n}\n</code></pre>\n\n<p><br><br>\n<b>Output:</b></p>\n\n<pre><code>ns per read :  83.8036   0==0\nns per read :  85.3504   0==0\nns per read :  85.3037   0==0\nns per read :  84.6396   0==0\nns per read :  78.5159   0==0\nns per read :  83.3926   0==0\nns per read :  85.8171   0==0\nns per read :  84.8495   0==0\nns per read :  85.7676   0==0\nns per read :  85.4356   0==0\n</code></pre>\n"}, {"tags": ["c++", "point-cloud-library", "image-registration"], "comments": [{"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1576935233, "post_id": 59395218, "comment_id": 105057536, "body": "I guess you already tried to simply calculate variances of both clouds and equalize them"}, {"owner": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 0, "creation_date": 1577109761, "post_id": 59395218, "comment_id": 105094365, "body": "I guess the eigenvalue method will work if the clouds are properly aligned and somewhat similar in shape. How about calculating the extrema of both clouds, then add 8 corner points as in (min,min,min) (max,min, min).. etc to each of them?"}, {"owner": {"reputation": 2436, "user_id": 1944458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c148127606d9c8d88cc74991ef1f796?s=128&d=identicon&r=PG", "display_name": "dspeyer", "link": "https://stackoverflow.com/users/1944458/dspeyer"}, "edited": false, "score": 0, "creation_date": 1577264388, "post_id": 59395218, "comment_id": 105131021, "body": "Do you have a precise definition of &quot;size&quot;?  Something like &quot;same bounding box after PCAing down to 2d&quot; or &quot;68% of points within same radius ball&quot;?"}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1577265888, "post_id": 59395218, "comment_id": 105131332, "body": "<i>The result is really not that perfect</i>. A figure will help up understanding in what sense it is not perfect"}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "reply_to_user": {"reputation": 2436, "user_id": 1944458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c148127606d9c8d88cc74991ef1f796?s=128&d=identicon&r=PG", "display_name": "dspeyer", "link": "https://stackoverflow.com/users/1944458/dspeyer"}, "edited": false, "score": 0, "creation_date": 1577300803, "post_id": 59395218, "comment_id": 105138993, "body": "@dspeyer your first definition should fit my problem."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1577300875, "post_id": 59395218, "comment_id": 105139003, "body": "@Damien I will update my question tomorrow evening with a figure showing it."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "reply_to_user": {"reputation": 1628, "user_id": 1230621, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a752347505880eb6aca2316744e7f474?s=128&d=identicon&r=PG", "display_name": "StarShine", "link": "https://stackoverflow.com/users/1230621/starshine"}, "edited": false, "score": 0, "creation_date": 1577311527, "post_id": 59395218, "comment_id": 105140730, "body": "@StarShine I will try doing this. Thanks for this input."}], "answers": [{"comments": [{"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1577365962, "post_id": 59486457, "comment_id": 105152300, "body": "What exactly do you mean with &#39;dataset pair&#39;? Would it be possilbe to provide a simple example for the whole algorithm so I can better understand the process? I really appreciate your help."}, {"owner": {"reputation": 2436, "user_id": 1944458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c148127606d9c8d88cc74991ef1f796?s=128&d=identicon&r=PG", "display_name": "dspeyer", "link": "https://stackoverflow.com/users/1944458/dspeyer"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1577472628, "post_id": 59486457, "comment_id": 105182189, "body": "There are two datasets (&quot;model&quot; and &quot;segmented&quot;) and from each of them you take the first two eigenvectors.  This gives four sets of projections (modelE1, modelE2, segmentedE1, segmentedE2).  For each of these, compute max-min."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1577474312, "post_id": 59486457, "comment_id": 105182659, "body": "Thanks. And &quot;take the max of the two ranges&quot;? When I subtract max-min for every set, I would get four scalars. What do you mean with &#39;two ranges&#39;?"}, {"owner": {"reputation": 2436, "user_id": 1944458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c148127606d9c8d88cc74991ef1f796?s=128&d=identicon&r=PG", "display_name": "dspeyer", "link": "https://stackoverflow.com/users/1944458/dspeyer"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1577489864, "post_id": 59486457, "comment_id": 105186699, "body": "for each cloud, compute max(range[that cloud][eigenvector1], range[that cloud][eigenvector2])"}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1577561462, "post_id": 59486457, "comment_id": 105200117, "body": "When doing this, I get somehow almost the same values for both clouds, resulting in a scaling factor very near to 1.  See my edit in my question for my code."}, {"owner": {"reputation": 2436, "user_id": 1944458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c148127606d9c8d88cc74991ef1f796?s=128&d=identicon&r=PG", "display_name": "dspeyer", "link": "https://stackoverflow.com/users/1944458/dspeyer"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1577656656, "post_id": 59486457, "comment_id": 105218296, "body": "Are you sure you&#39;re projecting the clouds into the eigenvectors?  I don&#39;t know this library, but I didn&#39;t see that in your code.  (Take the norm after projecting, if that wasn&#39;t obvious)"}], "tags": [], "owner": {"reputation": 2436, "user_id": 1944458, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2c148127606d9c8d88cc74991ef1f796?s=128&d=identicon&r=PG", "display_name": "dspeyer", "link": "https://stackoverflow.com/users/1944458/dspeyer"}, "is_accepted": false, "score": 2, "last_activity_date": 1577352925, "creation_date": 1577352925, "answer_id": 59486457, "question_id": 59395218, "link": "https://stackoverflow.com/questions/59395218/pcl-scale-two-point-clouds-to-the-same-size/59486457#59486457", "title": "PCL: Scale two Point-Clouds to the same size", "body": "<p>Seems like you should be able to:</p>\n\n<ul>\n<li>Project everything onto the first two eigenvectors</li>\n<li>Take the min and max for each</li>\n<li>Subtract max-min for each eigenvector/dataset pair</li>\n<li>Take the max of the two ranges (usually, but not always the first eigenvector -- when it isn't you'll want to rotate the final display)</li>\n<li>Use the ratio of those maxes as the scaling constant</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1579002479, "post_id": 59698653, "comment_id": 105615129, "body": "Wow awesome. Thank you so much for your effort. You helped me big time. Also for improving my understanding in this whole topic."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1579003258, "post_id": 59698653, "comment_id": 105615514, "body": "I got one more question on this: you take <code>xScale</code> to scale the cloud in the end. Why is this so? Shouldn&#39;t I take the maximum form xScale, yScale, zScale and scale it with that? (for axis-aligned)"}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1579016554, "post_id": 59698653, "comment_id": 105623019, "body": "My concern is with objects or targets that have 2 or more similar axes of variation.  In this case, if the axes get misaligned due to warping, the individuated axis warping may exacerbate the issue (by mistakenly scaling the wrong two axes against one another).  By only considering the primary axis of variation, may still associate wrong target axes (if highly symetric object), but will never distort the object."}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1579016746, "post_id": 59698653, "comment_id": 105623149, "body": "So if you had an old house phone as your target.  One axis (long axis) is clearly primary and will almost certainly get matched.  The other two axes may be pretty close in terms of variation (but lets say x is slightly greater than y).  Now in your capture method the cloud is slightly warped such that on your unscaled target y is slightly greater than x in variation.  Now the scaling function could line x with y and y with x and then scale them as such, which would be wrong and would exacerbate the warping."}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1579016807, "post_id": 59698653, "comment_id": 105623182, "body": "If you just used x in this phone example, there is basically no chance that another axis would overcome the z as primary axis of variation, so up to an extreme alteration of your target cloud, it would still be scaled <i>pretty well</i> to your golden"}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582040950, "post_id": 59698653, "comment_id": 106635490, "body": "Thank you! I understand the problem! I got one more question about the procedure. I don&#39;t fully understand how the transformation-Matrix is composed. You put the eigenvectors in the first 3x3 part of the matrix and in the last line you put the mean of the cloudpoints. Then invert it. Why is that so? Don&#39;t I just need to use the Eigenvector with the biggest eigenvalue (which then should be the main pricipal or primary direction, right?) and divide this one to the same thing at the other cloud to calculate the scale?"}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582041071, "post_id": 59698653, "comment_id": 106635588, "body": "And in the end it scales the <code>orientedSample</code> but isn&#39;t this cloud transformed by <code>sampleTransform</code>? Why can I do this. Why don&#39;t I have to use sampleCloud and scale it?"}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582042849, "post_id": 59698653, "comment_id": 106636697, "body": "The transformation matrix is composed of a rotation matrix in the upper left (a 3x3 which in this case is built from eigenvectors which are always going to be mutually orthogonal), and the right collumn is the translation (in this case set to the midpoint of the cloud).  I invert it so that I can transform the cloud into its eigen space (ie midpoint at origin and primary axes of variation aligned with cartesian axes).  This allows simple min max binning of x y and z which generates an oriented bounding box"}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582043027, "post_id": 59698653, "comment_id": 106636799, "body": "U could scale sample cloud directly if you wanted to apply off axis scaling (ie scale along the eigenvectors).  But I find it more intuitive to scale in eigen space and then move it back into its original cartesian space.  Again the reason for scaling while at origin is so that you can just scale along the cartesian axes (similar to the reason for doing a bounding box while in eigen orientation)."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582044108, "post_id": 59698653, "comment_id": 106637429, "body": "Thank you! I understand the composed matrix now. Oh I totally get why I should scale it when having the cloud still in the eigenspace. But to have the sampleCloud back in it&#39;s original position (but scaled) I would need to undo the transformation done into eigenspace earlier correct?  Another Question: Why is <code>x</code> the primary axis? I just want to scale the object on primary axis. And it works fine by using <code>xScale</code>. I just don&#39;t understand why x is always the primary axis."}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582057136, "post_id": 59698653, "comment_id": 106643459, "body": "its because the first column in a rotation matrix is the x axis of the frame.  So by putting the eigenvector with the largest eigenvalue into that first column, scaling on x in eigenspace will scale along the primary axis of variation."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582072091, "post_id": 59698653, "comment_id": 106648416, "body": "Why is the first column in the rotation matrix the eigenvector with the largest eigenvalue? Are they sorted when calling <code>getEigenVectors()</code>?"}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 1, "creation_date": 1582122578, "post_id": 59698653, "comment_id": 106668686, "body": "Thanks, that makes sense then."}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1582383582, "post_id": 59698653, "comment_id": 106762604, "body": "<code>getEigenVectors()</code> gives me the eigen vectors of the covariance matrix of the cloud right? So the PCA computes the co-variance matrix right?"}, {"owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1583701675, "post_id": 59698653, "comment_id": 107196617, "body": "One other question: Why is .getMean() returning a Vector4f and not a Vector4f?"}, {"owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "reply_to_user": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "edited": false, "score": 0, "creation_date": 1583710265, "post_id": 59698653, "comment_id": 107198587, "body": "when performing vector math with 3 d entities on a 4x4 matrix, an extra slot (which is always 1 or 0 depending on the application) is added to allow the matrix math of a 3d entity with a 4d matrix."}], "tags": [], "owner": {"reputation": 1232, "user_id": 7298298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lyoA.jpg?s=128&g=1", "display_name": "Sneaky Polar Bear", "link": "https://stackoverflow.com/users/7298298/sneaky-polar-bear"}, "is_accepted": true, "score": 2, "last_activity_date": 1578943882, "last_edit_date": 1578943882, "creation_date": 1578777049, "answer_id": 59698653, "question_id": 59395218, "link": "https://stackoverflow.com/questions/59395218/pcl-scale-two-point-clouds-to-the-same-size/59698653#59698653", "title": "PCL: Scale two Point-Clouds to the same size", "body": "<p>I would suggest using eigenvectors of each cloud to identify each ones primary axis of variation and then scaling them based on each clouds variation in that axis.  In my example I used an oriented bounding box (max min in eigenspace), but mean value or standard deviation in the primary axis (x axis in eigenspace) could be better metrics depending on the application.</p>\n\n<p>I left some debug flags in the function in case they are helpful to you, but gave them the defaults that I expect you will use.  I tested for variable axis stretching and variable rotations of sample and golden clouds.  This function should be able to handle that all just fine.  </p>\n\n<p>One caveat of this method is that if warping is axially variable <em>AND</em> warping causes one axis to overcome another axis as primary axis of variation, this function could improperly scale the clouds.  I am not sure if this edge case is relevant to you.  As long as you have uniform scaling between your clouds, this case should never occur.</p>\n\n<p>debugFlags: debugOverlay will leave both input clouds scaled and in their respective eigen orientations (allows more easy comparison). primaryAxisOnly will use only the primary axis of variation to perform scaling  if true, if false, it will scale all 3 axes of variation independently.</p>\n\n<p>Function:</p>\n\n<pre><code>void rescaleClouds(pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr&amp; goldenCloud, pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr&amp; sampleCloud, bool debugOverlay = false, bool primaryAxisOnly = true)\n{\n    //analyze golden cloud\n    pcl::PCA&lt;pcl::PointXYZ&gt; pcaGolden;\n    pcaGolden.setInputCloud(goldenCloud);\n    Eigen::Matrix3f goldenEVs_Dir = pcaGolden.getEigenVectors();\n    Eigen::Vector4f goldenMidPt = pcaGolden.getMean();\n    Eigen::Matrix4f goldenTransform = Eigen::Matrix4f::Identity();\n    goldenTransform.block&lt;3, 3&gt;(0, 0) = goldenEVs_Dir;\n    goldenTransform.block&lt;4, 1&gt;(0, 3) = goldenMidPt;\n    pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr orientedGolden(new pcl::PointCloud&lt;pcl::PointXYZ&gt;);\n    pcl::transformPointCloud(*goldenCloud, *orientedGolden, goldenTransform.inverse());\n    pcl::PointXYZ goldenMin, goldenMax;\n    pcl::getMinMax3D(*orientedGolden, goldenMin, goldenMax);\n\n    //analyze sample cloud\n    pcl::PCA&lt;pcl::PointXYZ&gt; pcaSample;\n    pcaSample.setInputCloud(sampleCloud);\n    Eigen::Matrix3f sampleEVs_Dir = pcaSample.getEigenVectors();\n    Eigen::Vector4f sampleMidPt = pcaSample.getMean();\n    Eigen::Matrix4f sampleTransform = Eigen::Matrix4f::Identity();\n    sampleTransform.block&lt;3, 3&gt;(0, 0) = sampleEVs_Dir;\n    sampleTransform.block&lt;4, 1&gt;(0, 3) = sampleMidPt;\n    pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr orientedSample(new pcl::PointCloud&lt;pcl::PointXYZ&gt;);\n    pcl::transformPointCloud(*sampleCloud, *orientedSample, sampleTransform.inverse());\n    pcl::PointXYZ sampleMin, sampleMax;\n    pcl::getMinMax3D(*orientedSample, sampleMin, sampleMax);\n\n    //apply scaling to oriented sample cloud \n    double xScale = (sampleMax.x - sampleMin.x) / (goldenMax.x - goldenMin.x);\n    double yScale = (sampleMax.y - sampleMin.y) / (goldenMax.y - goldenMin.y);\n    double zScale = (sampleMax.z - sampleMin.z) / (goldenMax.z - goldenMin.z);\n\n    if (primaryAxisOnly) { std::cout &lt;&lt; \"scale: \" &lt;&lt; xScale &lt;&lt; std::endl; }\n    else { std::cout &lt;&lt; \"xScale: \" &lt;&lt; xScale &lt;&lt; \"yScale: \" &lt;&lt; yScale &lt;&lt; \"zScale: \" &lt;&lt; zScale &lt;&lt; std::endl; }\n\n\n    for (int i = 0; i &lt; orientedSample-&gt;points.size(); i++)\n    {\n        if (primaryAxisOnly)\n        {\n            orientedSample-&gt;points[i].x = orientedSample-&gt;points[i].x / xScale;\n            orientedSample-&gt;points[i].y = orientedSample-&gt;points[i].y / xScale;\n            orientedSample-&gt;points[i].z = orientedSample-&gt;points[i].z / xScale;\n        }\n        else\n        {\n            orientedSample-&gt;points[i].x = orientedSample-&gt;points[i].x / xScale;\n            orientedSample-&gt;points[i].y = orientedSample-&gt;points[i].y / yScale;\n            orientedSample-&gt;points[i].z = orientedSample-&gt;points[i].z / zScale;\n        }\n    }\n    //depending on your next step, it may be reasonable to leave this cloud at its eigen orientation, but this transformation will allow this function to scale in place.\n\n    if (debugOverlay)\n    {\n        goldenCloud = orientedGolden;\n        sampleCloud = orientedSample;\n    }\n    else\n    {\n        pcl::transformPointCloud(*orientedSample, *sampleCloud, sampleTransform);\n    }\n}\n</code></pre>\n\n<p>Test Code (you will need your own clouds <em>and visualizers</em>): </p>\n\n<pre><code>pcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr golden(new pcl::PointCloud&lt;pcl::PointXYZ&gt;);\nfileIO::loadFromPCD(golden, \"CT_Scan_Nov_7_fullSpine.pcd\");\nCloudVis::simpleVis(golden);\n\ndouble xStretch = 1.75;\ndouble yStretch = 1.65;\ndouble zStretch = 1.5;\npcl::PointCloud&lt;pcl::PointXYZ&gt;::Ptr stretched(new pcl::PointCloud&lt;pcl::PointXYZ&gt;);\nfor (int i = 0; i &lt; golden-&gt;points.size(); i++)\n{\n    pcl::PointXYZ pt = golden-&gt;points[i];\n    stretched-&gt;points.push_back(pcl::PointXYZ(pt.x * xStretch, pt.y * yStretch, pt.z * zStretch));\n}\nEigen::Affine3f arbRotation = Eigen::Affine3f::Identity();\narbRotation.rotate(Eigen::AngleAxisf(M_PI / 4.0, Eigen::Vector3f::UnitY()));\npcl::transformPointCloud(*stretched, *stretched, arbRotation);\n\nCloudVis::rgbClusterVis(golden, stretched);\n\nrescaleClouds(golden, stretched,true,false);\nCloudVis::rgbClusterVis(golden, stretched);\n</code></pre>\n"}], "owner": {"reputation": 2617, "user_id": 2813152, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/474abb47c37cbac100efcae7b478ed66?s=128&d=identicon&r=PG&f=1", "display_name": "progNewbie", "link": "https://stackoverflow.com/users/2813152/prognewbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1113, "favorite_count": 2, "accepted_answer_id": 59698653, "answer_count": 2, "score": 2, "last_activity_date": 1578943882, "creation_date": 1576682819, "last_edit_date": 1577561602, "question_id": 59395218, "link": "https://stackoverflow.com/questions/59395218/pcl-scale-two-point-clouds-to-the-same-size", "title": "PCL: Scale two Point-Clouds to the same size", "body": "<p>I got two point clouds and try to scale them to the same size. My first approach was to just divide the square roots from the eigenvalues:</p>\n\n<pre><code>pcl::PCA&lt;pcl::PointNormal&gt; pca;\npca.setInputCloud(model_cloud_ptr);\nEigen::Vector3f ev_M = pca.getEigenValues();\n\npca.setInputCloud(segmented_cloud_ptr);\nEigen::Vector3f ev_S = pca.getEigenValues();\n\ndouble s = sqrt(ev_M[0])/sqrt(ev_S[0]);\n</code></pre>\n\n<p>This helps me to scale my model cloud to have approximately the same size as my segmented cloud. But the result is really not that perfect. It is a simple estimation. I tried doing it with <a href=\"http://docs.pointclouds.org/1.7.0/classpcl_1_1registration_1_1_transformation_estimation_s_v_d_scale.html\" rel=\"nofollow noreferrer\">TransformationEstimationSVDScale</a> and also with <code>SampleConsensusModelRegistration</code> like in <a href=\"https://www.morethantechnical.com/2012/08/12/registering-point-clouds-rigidly-with-scale-using-pcl-wcode/\" rel=\"nofollow noreferrer\">this tutorial</a>. But when doing this I get the message, that the number of source points/indices differs from the number of target points/indices. </p>\n\n<p>What would be the best approach for me to scale the clouds to the same size, when having different numbers of points in them?</p>\n\n<p><strong>Edit</strong> I tried doing what @dspeyer proposed but this gives me a scaling factor of almost 1.0</p>\n\n<pre><code>pcl::PCA&lt;pcl::PointNormal&gt; pca;\npca.setInputCloud(model_cloud_ptr);\nEigen::Matrix3f ev_M = pca.getEigenVectors();\nEigen::Vector3f ev_M1 = ev_M.col(0);\nEigen::Vector3f ev_M2 = ev_M.col(1);\n\nauto dist_M1 = ev_M1.maxCoeff()-ev_M1.minCoeff();\nauto dist_M2 = ev_M2.maxCoeff()-ev_M2.minCoeff();  \nauto distM_max = std::max(dist_M1, dist_M2);\n\npca.setInputCloud(segmented_cloud_ptr);\nEigen::Matrix3f ev_S = pca.getEigenVectors();\nEigen::Vector3f ev_S1 = ev_S.col(0);\nEigen::Vector3f ev_S2 = ev_S.col(1);\n\nauto dist_S1 = ev_S1.maxCoeff()-ev_S1.minCoeff();\nauto dist_S2 = ev_S2.maxCoeff()-ev_S2.minCoeff();\nauto distS_max = std::max(dist_S1, dist_S2);\n\ndouble s = distS_max / distM_max;\n</code></pre>\n"}, {"tags": ["c++", "c++11", "x86", "memory-barriers", "stdatomic"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1576682364, "post_id": 59395042, "comment_id": 104979349, "body": "Remember, you are programming against the abstract machine, not the actual hardware.  If you need a fence on the abstract machine, you should have on in your code.  The compiler can then decide that it doesn&#39;t actually need to do it since it know which platform it is compiling the code for."}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576683097, "post_id": 59395042, "comment_id": 104979809, "body": "@NathanOliver-ReinstateMonica I agree.  Just trying to understand the effect/use case of <code>std::memory_order_acquire</code> on x86 in particular and in my particular example above.  Thanks for your reminder tho :)"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1576815498, "post_id": 59395042, "comment_id": 105026549, "body": "Can you rewrite your code so it&#39;s clear that <code>read</code> isn&#39;t <code>::read</code>?"}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1576901702, "post_id": 59395042, "comment_id": 105052369, "body": "@curiousguy updated.  thanks!"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1579216233, "post_id": 59395042, "comment_id": 105702362, "body": "Do you use C++11 as a shorthand for a specific, old C++ version, or for any C++ std not older than C++11?"}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1579315466, "post_id": 59395042, "comment_id": 105735879, "body": "@curiousguy C++11 or newer."}], "answers": [{"comments": [{"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 0, "creation_date": 1576687554, "post_id": 59395824, "comment_id": 104982397, "body": "Thanks for the detailed answer.  So you are saying <code>std::atomic_thread_fence(std::memory_order_acquire)</code> doesn&#39;t force a reload?  Regarding using <code>volatile</code> keyword for shared memory, Ian is <a href=\"https://gcc.gnu.org/ml/gcc-help/2012-03/msg00242.html\" rel=\"nofollow noreferrer\">against it</a>.  And as the original poster pointed out that using volatile caused <a href=\"https://gcc.gnu.org/ml/gcc-help/2012-03/msg00239.html\" rel=\"nofollow noreferrer\">other issues</a>.  Shouldn&#39;t <code>asm(&quot;&quot; ::: &quot;memory&quot;)</code> w/o <code>volatile</code> be enough as it forces a reload?"}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 0, "creation_date": 1576687644, "post_id": 59395824, "comment_id": 104982439, "body": "The main issue is that C++ standard doesn&#39;t really mention how C++ memory model works with shared memory.  Hence, the solution for shared memory is likely relying on some implementation specific stuffs..."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 1, "creation_date": 1576687962, "post_id": 59395824, "comment_id": 104982635, "body": "@HCSF: Extended <code>asm</code> with not outputs is implicitly <code>volatile</code>.  The C++ standard says that lock-free atomics <i>should</i> work on shared memory. Casting to <code>atomic&lt;uint32_t&gt;*</code> would work because it&#39;s always-lock-free on x86.  Make sure it&#39;s aligned. (The standard says that they should be address-free so they work even if two processes map the same memory to different virtual addresses.  This is trivially true for normal CPUs where hardware handles coherence based on physical address.)  Of course you shouldn&#39;t use <code>volatile</code>; my answer even says so.  But it would work in practice."}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 0, "creation_date": 1576688953, "post_id": 59395824, "comment_id": 104983121, "body": "I am sure you are right.  Do you have section # in the standard I can read more about &quot;C++ standard says that lock-free atomics should work on shared memory&quot; and &quot;Casting to atomic&lt;uint32_t&gt;* would work&quot;?  As I just searched for &quot;shared memory&quot; in n4713 draft and I only found 2 occurrences 6.8.2.1/22 and 6.8.2.1/23."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 0, "creation_date": 1576689459, "post_id": 59395824, "comment_id": 104983356, "body": "@HCSF: <a href=\"//stackoverflow.com/q/51463312\">Are lock-free atomics address-free in practice?</a> quotes the relevant part of the standard.  It doesn&#39;t use the phrase &quot;shared memory&quot;.  Also <a href=\"//stackoverflow.com/q/18321244\">Is C++11 atomic usable with mmap?</a>  Oh lol, you quoted the relevant part yourself in <a href=\"//stackoverflow.com/q/51229208\">Two Different Processes With 2 std::atomic Variables on Same Address?</a>"}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 0, "creation_date": 1576690280, "post_id": 59395824, "comment_id": 104983763, "body": "Lol. Yes I did long time ago.  Reading my post again refreshed memory that it seems I <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4013.html\" rel=\"nofollow noreferrer\">can&#39;t just cast</a>.  Thought?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "edited": false, "score": 0, "creation_date": 1576690551, "post_id": 59395824, "comment_id": 104983896, "body": "@HCSF: that&#39;s about doing some atomic operations on data that&#39;s <i>also</i> accessed as a non-atomic object by the same program.  You can just cast if you <i>always</i> access it as an <code>atomic&lt;int&gt;</code>."}, {"owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "reply_to_user": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1576723651, "post_id": 59395824, "comment_id": 104994124, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/204516/discussion-between-hcsf-and-peter-cordes\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 5, "last_activity_date": 1576686456, "last_edit_date": 1576686456, "creation_date": 1576684775, "answer_id": 59395824, "question_id": 59395042, "link": "https://stackoverflow.com/questions/59395042/stdmemory-order-acquire-fence-necessary-on-x86/59395824#59395824", "title": "std::memory_order_acquire fence necessary on x86?", "body": "<blockquote>\n  <p><code>return *(uint32_t*)(m_head_memory_location + offset);</code></p>\n</blockquote>\n\n<p>You cast to non-<code>atomic</code> non-<code>volatile</code> <code>uint32_t*</code> and dereference!!!</p>\n\n<p><strong>The compiler is allowed to assume that this <code>uint32_t</code> object isn't written by anything else (i.e. assume no data-race UB), so it can and will hoist the load out of the loop</strong>, effectively transforming it into something like <code>if((val=load) == 0) infinite_loop();</code>.</p>\n\n<ul>\n<li><a href=\"https://electronics.stackexchange.com/questions/387181/mcu-programming-c-o2-optimization-breaks-while-loop/387478#387478\">https://electronics.stackexchange.com/questions/387181/mcu-programming-c-o2-optimization-breaks-while-loop/387478#387478</a></li>\n<li><a href=\"https://stackoverflow.com/questions/58516052/multithreading-program-stuck-in-optimized-mode-but-runs-normally-in-o0\">Multithreading program stuck in optimized mode but runs normally in -O0</a></li>\n<li><a href=\"https://stackoverflow.com/questions/4557979/when-to-use-volatile-with-multi-threading/58535118#58535118\">When to use volatile with multi threading?</a> (never, use atomic with mo_relaxed)</li>\n</ul>\n\n<p>A GCC memory barrier will force a reload, but this is an implementation detail for <code>std::atomic_thread_fence(std::memory_order_acquire)</code>.  For x86, that barrier only needs to block <em>compile-time</em> reordering, so a typical implementation for GCC might be <code>asm(\"\" ::: \"memory\")</code>.</p>\n\n<p>It's not the acquire ordering that's doing anything, it's the memory clobber that stops GCC from assuming another read will read the same thing.  That's not something ISO C++ <code>std::atomic_thread_fence(std::memory_order_acquire)</code> implies for non-atomic variables.  (And it's always implied for atomic and volatile).  So like I said, this would work in GCC but only as an implementation detail.</p>\n\n<hr>\n\n<p>It's also strict-aliasing UB if this memory is ever accessed with other types than this an <code>char*</code>, or if the underlying memory was declared as a <code>char[]</code> array.  If you got a <code>char*</code> from <code>mmap</code> or something then you're fine.</p>\n\n<p>It's also possible misalignment UB unless <code>offset</code> is known to be a multiple of 4.  (Although <a href=\"https://stackoverflow.com/questions/47510783/why-does-unaligned-access-to-mmaped-memory-sometimes-segfault-on-amd64\">unless GCC chooses to auto-vectorize</a>, this won't bite you in practice on x86.)</p>\n\n<p>You can solve these two for GNU C with <code>typedef uint32_t unaligned_u32 __attribute((may_alias, aligned(1)));</code> but you still need <code>volatile</code> or <code>atomic&lt;T&gt;</code> for reading in a loop to work.</p>\n\n<hr>\n\n<h3>In general</h3>\n\n<p><strong>Use <code>std::atomic_thread_fence(std::memory_order_acquire);</code> as required by the C++ memory model; that's what governs reordering at compile time.</strong></p>\n\n<p>When compiling for x86, it won't turn into any asm instructions; in asm it's a no-op.  But if you don't tell the compiler it can't reorder something, your code might break depending on compiler optimization level.</p>\n\n<p>You might get lucky and have the compiler do a non-atomic load after an atomic <code>mo_relaxed</code> load, or it might do the non-atomic load earlier if you don't tell it not to.</p>\n"}], "owner": {"reputation": 1592, "user_id": 9784373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HCSF", "link": "https://stackoverflow.com/users/9784373/hcsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577186796, "creation_date": 1576682215, "last_edit_date": 1577186796, "question_id": 59395042, "link": "https://stackoverflow.com/questions/59395042/stdmemory-order-acquire-fence-necessary-on-x86", "title": "std::memory_order_acquire fence necessary on x86?", "body": "<p>Given x86 has a strong memory model, is <code>std::memory_order_acquire</code> fence (<a href=\"https://preshing.com/20131125/acquire-and-release-fences-dont-work-the-way-youd-expect/\" rel=\"nofollow noreferrer\">not operation</a>) necessary?</p>\n\n<p>For example, if I have this code:</p>\n\n<pre><code>uint32_t read_shm(const uint64_t offset) {\n   // m_head_memory_location is char* pointing to the beginning of a mmap-ed named shared memory segment\n   // a different process on different core will write to it.\n   return *(uint32_t*)(m_head_memory_location + offset);\n}\n....\nint main() {\n     uint32_t val = 0;\n     while (0 != (val = shm.read(some location)));\n     .... // use val\n}\n</code></pre>\n\n<p>Do I really need <code>std::atomic_thread_fence(std::memory_order_acquire)</code> before the return statement?</p>\n\n<p>I feel it is not necessary because the goal of the code above is trying to read the first 4 bytes from <code>m_head_memory_location + offset</code>, and so any memory operations after fences being reordered doesn't affect the outcome.</p>\n\n<p>Or there is some side effect making the acquire fence necessary?</p>\n\n<p>Is there any case that an acquire fence (not operation) is necessary on x86?</p>\n\n<p>Any input is welcome.</p>\n"}, {"tags": ["python", "c++", "c", "python-c-api"], "comments": [{"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 1, "creation_date": 1576773974, "post_id": 59395037, "comment_id": 105015024, "body": "It doesn&#39;t look like you have the right version of MSVC installed: <a href=\"https://wiki.python.org/moin/WindowsCompilers\" rel=\"nofollow noreferrer\">wiki.python.org/moin/WindowsCompilers</a>. I don&#39;t know exactly what error to expect from this but it seems a plausible cause."}, {"owner": {"reputation": 380, "user_id": 1774707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1f919c8e23436bc8a2177afef92c44?s=128&d=identicon&r=PG", "display_name": "user42723", "link": "https://stackoverflow.com/users/1774707/user42723"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1576883701, "post_id": 59395037, "comment_id": 105050270, "body": "@DavidW Good point, but that didn&#39;t seem to be the problem."}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1576926297, "post_id": 59395037, "comment_id": 105055834, "body": "Glad you got it sorted. I&#39;m a little surprised that linking to the debug dll would cause it to crash, but if it works then go with it."}, {"owner": {"reputation": 380, "user_id": 1774707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1f919c8e23436bc8a2177afef92c44?s=128&d=identicon&r=PG", "display_name": "user42723", "link": "https://stackoverflow.com/users/1774707/user42723"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 1, "creation_date": 1576927779, "post_id": 59395037, "comment_id": 105056071, "body": "@DavidW It seems the structs have different members in the debug build. <a href=\"https://github.com/python/cpython/blob/f522a6ddb67a238bab5673608111f74ec4e22205/Include/object.h#L68\" rel=\"nofollow noreferrer\">For example here</a>. This also explains the &quot;Type does not define the tp_name field&quot; error."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 1774707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1f919c8e23436bc8a2177afef92c44?s=128&d=identicon&r=PG", "display_name": "user42723", "link": "https://stackoverflow.com/users/1774707/user42723"}, "is_accepted": true, "score": 1, "last_activity_date": 1576883364, "creation_date": 1576883364, "answer_id": 59432233, "question_id": 59395037, "link": "https://stackoverflow.com/questions/59395037/python-c-api-access-violation-when-trying-example-module-with-msvc/59432233#59432233", "title": "Python C API: Access Violation when trying example module with MSVC", "body": "<p>I found the solution: I need to build in release mode instead of debug mode and link to python37.lib instead of python37_d.lib.</p>\n"}], "owner": {"reputation": 380, "user_id": 1774707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1f919c8e23436bc8a2177afef92c44?s=128&d=identicon&r=PG", "display_name": "user42723", "link": "https://stackoverflow.com/users/1774707/user42723"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 59432233, "answer_count": 1, "score": 0, "last_activity_date": 1576883364, "creation_date": 1576682200, "question_id": 59395037, "link": "https://stackoverflow.com/questions/59395037/python-c-api-access-violation-when-trying-example-module-with-msvc", "title": "Python C API: Access Violation when trying example module with MSVC", "body": "<p>I'm making a Python module in C++. Until now I used MingW to compile the module, which worked fine. But I want to switch to MSVC because an other library that I use is easier to use with MSVC.</p>\n\n<p>But, I cannot get it to work. Compiling and linking works, but problems arise when I try to use the newly created module from Python. I get the error <code>SystemError: Type does not define the tp_name field.</code> when I call <code>PyType_Ready</code>. In the source code of Python I see that this error is reported when <code>tp_name</code> is null, but I checked that it is not null.</p>\n\n<p>My module is too big to debug, so I tried the <a href=\"https://docs.python.org/3.7/extending/newtypes_tutorial.html\" rel=\"nofollow noreferrer\">example module</a> of the Python documentation instead, which gives a different problem. Here my files and the output of <code>run.bat</code>.</p>\n\n<h1>custom.c</h1>\n\n<pre><code>#define PY_SSIZE_T_CLEAN\n#include &lt;Python.h&gt;\n\ntypedef struct {\n    PyObject_HEAD\n    /* Type-specific fields go here. */\n} CustomObject;\n\nstatic PyTypeObject CustomType = {\n    PyVarObject_HEAD_INIT(NULL, 0)\n    .tp_name = \"custom.Custom\",\n    .tp_doc = \"Custom objects\",\n    .tp_basicsize = sizeof(CustomObject),\n    .tp_itemsize = 0,\n    .tp_flags = Py_TPFLAGS_DEFAULT,\n    .tp_new = PyType_GenericNew,\n};\n\nstatic PyModuleDef custommodule = {\n    PyModuleDef_HEAD_INIT,\n    .m_name = \"custom\",\n    .m_doc = \"Example module that creates an extension type.\",\n    .m_size = -1,\n};\n\nPyMODINIT_FUNC\nPyInit_custom(void)\n{\n    PyObject *m;\n    if (PyType_Ready(&amp;CustomType) &lt; 0)\n        return NULL;\n\n    m = PyModule_Create(&amp;custommodule);\n    if (m == NULL)\n        return NULL;\n\n    Py_INCREF(&amp;CustomType);\n    if (PyModule_AddObject(m, \"Custom\", (PyObject *) &amp;CustomType) &lt; 0) {\n        Py_DECREF(&amp;CustomType);\n        Py_DECREF(m);\n        return NULL;\n    }\n\n    return m;\n}\n</code></pre>\n\n<h1>CMakeLists.txt</h1>\n\n<pre><code>cmake_minimum_required(VERSION 3.15)\n\nproject(module)\n\nadd_library(module SHARED custom.c)\n\ntarget_include_directories(module PRIVATE \"C:/Program Files/Python37/include\")\ntarget_link_libraries(module \"C:/Program Files/Python37/libs/python37_d.lib\")\n\n# Output name\nset_target_properties(module PROPERTIES PREFIX \"\")\nset_target_properties(module PROPERTIES OUTPUT_NAME \"custom\")\nset_target_properties(module PROPERTIES SUFFIX \".pyd\")\n</code></pre>\n\n<h1>run.bat</h1>\n\n<pre><code>@echo off\necho ----- Compiling -----\ncmake .\ncmake --build .\necho.\necho ----- Running -----\npython -c \"import sys; sys.path.append('Debug'); import custom; print('ok')\"\necho Error code: %errorlevel%\n</code></pre>\n\n<h1>Output</h1>\n\n<pre><code>Microsoft Windows [Version 10.0.17763.914]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\x\\pythontest&gt;run\n----- Compiling -----\n-- Building for: Visual Studio 16 2019\n-- Selecting Windows SDK version 10.0.18362.0 to target Windows 10.0.17763.\n-- The C compiler identification is MSVC 19.24.28314.0\n-- The CXX compiler identification is MSVC 19.24.28314.0\n-- Check for working C compiler: H:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.24.28314/bin/Hostx64/x64/cl.exe\n-- Check for working C compiler: H:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.24.28314/bin/Hostx64/x64/cl.exe -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: H:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.24.28314/bin/Hostx64/x64/cl.exe\n-- Check for working CXX compiler: H:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.24.28314/bin/Hostx64/x64/cl.exe -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: C:/x/pythontest\nMicrosoft (R) Build Engine version 16.4.0+e901037fe for .NET Framework\nCopyright (C) Microsoft Corporation. All rights reserved.\n\n  Checking Build System\n  Building Custom Rule C:/x/pythontest/CMakeLists.txt\n  custom.c\n     Creating library C:/x/pythontest/Debug/custom.lib and object C:/x/pythontest/Debug/custom.exp\n  module.vcxproj -&gt; C:\\x\\pythontest\\Debug\\custom.pyd\n  Building Custom Rule C:/x/pythontest/CMakeLists.txt\n\n----- Running -----\nError code: -1073741819\n</code></pre>\n\n<p>Error code -1073741819 is 0xC0000005, which is Access Violation. So the example code crashes. This is a different error as with my own module, but it probably has the same cause. What am I doing wrong?</p>\n"}, {"tags": ["c++", "windows-installer"], "comments": [{"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1576726725, "post_id": 59394891, "comment_id": 104994703, "body": "What are you trying to determine? <a href=\"https://stackoverflow.com/a/50455886/129130\">This might be somewhat related, though not what you asked</a>, maybe have a look (it is about using the MSI log file to determine the <code>msiexec.exe</code> command line). <a href=\"https://stackoverflow.com/a/54769767/129130\">Sample from log file</a> (a bit down the page). And <a href=\"https://stackoverflow.com/a/54458890/129130\">MSI logging summary</a>."}, {"owner": {"reputation": 41, "user_id": 3227617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1292fe165948b6d2b29dc9bcb4d4a198?s=128&d=identicon&r=PG&f=1", "display_name": "user3227617", "link": "https://stackoverflow.com/users/3227617/user3227617"}, "reply_to_user": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1576739635, "post_id": 59394891, "comment_id": 104997865, "body": "We would like to determine how (with which command line) our installer was run? If a use ran &quot;msiexec /i demo.msi /quiet user=test dep=sec&quot;, we would like to detect the whole line at &quot;install&quot; entry point in our installer source code..."}, {"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1576868344, "post_id": 59394891, "comment_id": 105046091, "body": "Yes, I thought as much, but we need to know what the purpose is? There are MSI conditional logic that you can used to determine what installation context you are in, but it all depends on the purpose - what you are trying to do."}, {"owner": {"reputation": 41, "user_id": 3227617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1292fe165948b6d2b29dc9bcb4d4a198?s=128&d=identicon&r=PG&f=1", "display_name": "user3227617", "link": "https://stackoverflow.com/users/3227617/user3227617"}, "reply_to_user": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1577108130, "post_id": 59394891, "comment_id": 105093604, "body": "Stein, as already said, we just want to obtain the msiexec cmd parameters, that was launched for (un)installing the product... We are already using the &quot;CustomActionData&quot; property to support some custom parameters, but we want to obtain whole msiexec command line... Is there some similar MsiPropertyGet() function which could print whole msiexec command line (at install/uninstall entry point)?"}], "owner": {"reputation": 41, "user_id": 3227617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1292fe165948b6d2b29dc9bcb4d4a198?s=128&d=identicon&r=PG&f=1", "display_name": "user3227617", "link": "https://stackoverflow.com/users/3227617/user3227617"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1576681748, "creation_date": 1576681748, "question_id": 59394891, "link": "https://stackoverflow.com/questions/59394891/obtain-msiexec-command-line-at-install-custom-action-vs-setup-project", "title": "Obtain msiexec command line at install custom action (vs setup project)", "body": "<p>I'm wondering if there is an option to obtain msiexec command line at \"install\" custom action (we use vs2008 \"setup project\" for the installer).</p>\n\n<p>We know that we can access \"CustomActionData\" parameters but if we run the following command:</p>\n\n<pre><code>msiexec /i demo.msi /quiet user=test log=true\n</code></pre>\n\n<p>we know how to access \"CustomActionData\" parameters (<strong>user=test log=true</strong>), but we don't know how to access whole msiexec command line parameters (including \"/i /quiet\")...</p>\n\n<p>Is it even possible because in Process Monitor we can see that at install action, this msiexec process (running as SYSTEM) is run with command the following command: </p>\n\n<pre><code>C:\\Windows\\system32\\MsiExec.exe -Embedding 3E439F7DA7DE174205150FEBCEB7B14F E Global\\MSI0000\n</code></pre>\n\n<p>So, is it possible to obtain \"msiexec\" command line parameters inside the installer (c++) code?</p>\n"}, {"tags": ["c++", "enums"], "comments": [{"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 1, "creation_date": 1576683594, "post_id": 59394747, "comment_id": 104980104, "body": "By forcing them to be fixed and constant, you&#39;re forcing yourself into the &quot;headache&quot; situation no matter what. You&#39;re forcing yourself to maintain a constant list of valid enums that <i>may change</i> at some point, at which point you will have to update your list of enums and <b>recompile</b> your code. A malleable solution here would be to allow them to be strings, and read in a .txt file at startup or something, and have that be your list of acceptable values that you can check against if you need to verify."}, {"owner": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "reply_to_user": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 1, "creation_date": 1576683824, "post_id": 59394747, "comment_id": 104980223, "body": "@alteredinstance Another very valid point! I think this should work. The program should have code, not a database. That belongs in a separate dedicated file. Do add to the answer! +1"}, {"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 1, "creation_date": 1576684315, "post_id": 59394747, "comment_id": 104980508, "body": "Glad I was able to be helpful! Let me know how this works for you, hopefully it&#39;s not too much of a detour to implement. I think &quot;The program should have code, not a database&quot; is a great way of understanding the solution."}], "answers": [{"comments": [{"owner": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "edited": false, "score": 0, "creation_date": 1576681850, "post_id": 59394886, "comment_id": 104979089, "body": "Okayyy. This seems neat. So, basically make all n-1 levels a <code>struct</code> and the last level, a real <code>enum class</code>. Will still have to be careful to manage it properly."}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "reply_to_user": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "edited": false, "score": 0, "creation_date": 1576681890, "post_id": 59394886, "comment_id": 104979100, "body": "If you can&#39;t use namespaces for the upper levels, then yes."}, {"owner": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "edited": false, "score": 0, "creation_date": 1576682244, "post_id": 59394886, "comment_id": 104979283, "body": "Okay, quick question. What if I have to store a category, that could be <code>PROGRAMMING</code> related, or <code>COOKING</code> related?"}, {"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "reply_to_user": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "edited": false, "score": 0, "creation_date": 1576682437, "post_id": 59394886, "comment_id": 104979395, "body": "Then you&#39;d have a problem ;) You can put the same name in each <code>enum</code>, but they would be completely separate..."}], "tags": [], "owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "is_accepted": false, "score": 2, "last_activity_date": 1576681739, "creation_date": 1576681739, "answer_id": 59394886, "question_id": 59394747, "link": "https://stackoverflow.com/questions/59394747/creating-a-struct-as-enum-class-member/59394886#59394886", "title": "Creating a struct as enum class member", "body": "<p>You cannot nest the <code>enum</code>s, however, you can do something like this:</p>\n\n<pre><code>struct Book {\n    struct Category {\n        enum class PROGRAMMING {\n            // ...\n        };\n        enum class COOKING {\n            // ...\n        }; \n    };\n};\n</code></pre>\n\n<p>Similar to using a namespace like in the linked question, but since it is inside a class and you can't do that, you can just use another struct.</p>\n"}, {"comments": [{"owner": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "edited": false, "score": 1, "creation_date": 1576775723, "post_id": 59395082, "comment_id": 105015884, "body": "See my implementation. :-) Thanks again! Any suggestions are welcome!"}], "tags": [], "owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "is_accepted": true, "score": 1, "last_activity_date": 1576684226, "last_edit_date": 1576684226, "creation_date": 1576682365, "answer_id": 59395082, "question_id": 59394747, "link": "https://stackoverflow.com/questions/59394747/creating-a-struct-as-enum-class-member/59395082#59395082", "title": "Creating a struct as enum class member", "body": "<p>You can do this, but it would be a <strong>bad design</strong>.</p>\n\n<p>One common code smell is using an <code>enum</code> for what should clearly be a class - the case here being that you want a <code>C_PLUS_PLUS</code> genre to be a derivation of the <code>PROGRAMMING</code> category. </p>\n\n<p>However, <code>enum</code>s are best used to describe possible <em>states</em>, and are incapable of inheritance by <em>design</em>, as you noted in one of your references. In my opinion, your best course of action would be to make two separate member variables in <code>Category</code> that <strong>can hold values</strong> such as <code>PROGRAMMING</code> and <code>C_PLUS_PLUS</code>, and do away with their status as <code>enum</code>s. </p>\n\n<p>Think: what would best encapsulate an open-ended field such as a book genre/subgenre? Are you planning to program <strong><em>every single possibility</em></strong> with an <code>enum</code>? Or would just using two <code>string</code>s, (such as <code>genre</code> and <code>subgenre</code>) better suit an open-ended field such as that?</p>\n\n<p>Or, perhaps, if you are specifically working with <code>PROGRAMMING</code> books as a major piece of your design, turn <code>PROGRAMMING</code> into a class, and make <code>C_PLUS_PLUS</code> part of an <code>enum</code> within <em>that</em> class. But don't have them both be <code>enums</code> - that's just asking for issues down the road, and doesn't solve your issues with maintenance that you already described.</p>\n\n<p>EDIT: Adding from a comment I made - </p>\n\n<p>By forcing them to be fixed and constant, you're forcing yourself into the \"headache\" situation no matter what. You're forcing yourself to maintain a constant list of valid enums that may change at some point, at which point you will have to update your list of enums and recompile your code. A malleable solution here would be to allow them to be strings, and read in a .txt file at startup or something, and have that be your list of acceptable values that you can check against if you need to verify.</p>\n"}, {"comments": [{"owner": {"reputation": 559, "user_id": 12214916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f96f92d6d7d820a020ca270b198f0a?s=128&d=identicon&r=PG&f=1", "display_name": "alteredinstance", "link": "https://stackoverflow.com/users/12214916/alteredinstance"}, "edited": false, "score": 1, "creation_date": 1576780509, "post_id": 59414180, "comment_id": 105017828, "body": "Looks great! Intuitive and easily extensible on the fly - nice solution :)"}], "tags": [], "owner": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "is_accepted": false, "score": 1, "last_activity_date": 1576775585, "creation_date": 1576775585, "answer_id": 59414180, "question_id": 59394747, "link": "https://stackoverflow.com/questions/59394747/creating-a-struct-as-enum-class-member/59414180#59414180", "title": "Creating a struct as enum class member", "body": "<p>On the request of an answerer, I am posting my implementation for future reference.<br>\nThis is the <code>Book</code>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>struct Book\n{\n    // A Map of categories and its list of sub-categories\n    static std::map&lt; std::string, std::vector&lt; std::string &gt; &gt; Categories;\n\n    // default parameter for unit testing, \n    // thanks to https://stackoverflow.com/questions/40297782/c-unit-testing-check-output-is-correct/59374648#59374648\n    static void initBookCategories(std::string file_name = \"categories.txt\")\n    {\n        // Open the file in read mode\n        std::ifstream allowed_categories(file_name);\n\n        // Check if file open is unsuccessful\n        if(!allowed_categories)\n        {\n            // Signal error and exit\n            std::cerr &lt;&lt; \"\\n\\nFile Not Found!\\nError Initialising DB! Exiting...\";\n            return;\n        }\n\n        // Read the category_name\n        std::string category_name;\n        // Until there are categories left\n        while(std::getline(allowed_categories, category_name))\n        {\n            // Read the whole sub-category list\n            std::string subcategory_names;\n            // Untill end of line\n            std::getline(allowed_categories, subcategory_names);\n            // Convert to std::stringstream for parsing\n            std::istringstream parse_subcategories(subcategory_names);\n            // Skip the empty line\n            allowed_categories.ignore();\n\n            // Now read the sub-categories\n            // Need a std::vector to store the list of subcategory names\n            std::vector&lt; std::string &gt; subcategory_list;\n            // Reusing subcategory_names for each subcategory_name\n            while(parse_subcategories &gt;&gt; subcategory_names)\n            {\n                // Add to the list of sub-categories\n                subcategory_list.push_back(subcategory_names);\n            }\n\n            // Add this newly read category with its list of subcategories our map\n            Categories.insert(std::pair&lt; std::string, std::vector&lt; std::string &gt; &gt;(category_name, subcategory_list));\n        }\n    }\n    static void getCategoryList()\n    {\n        // For each category\n        for(std::pair&lt; const std::string, std::vector&lt; std::string &gt; &gt;&amp; category : Categories)\n        {\n            // List the sub-categories\n            int index = 0;\n            // Print the category name\n            std::cout &lt;&lt; \" \" &lt;&lt; category.first &lt;&lt; \":\\n\";\n            // Loop over the sub-categories\n            for(std::string&amp; subcategory_name : category.second)\n            {\n                // Printing each sub-category in a line\n                std::cout &lt;&lt; \"   \" &lt;&lt; ++index &lt;&lt; \") \" &lt;&lt; subcategory_name &lt;&lt; \"\\n\";\n            }\n        }\n    }\n};\nstd::map&lt; std::string, std::vector&lt; std::string &gt; &gt; Book::Categories;\n</code></pre>\n\n<p>And our main function using this:</p>\n\n<pre><code>int main()\n{\n    Book::initBookCategories();\n    Book::getCategoryList();\n    return 0;\n}\n</code></pre>\n\n<p>Last, but not least, the format of <code>categories.txt</code>:</p>\n\n<pre><code>PROGRAMMING\nC_PLUS_PLUS C PYTHON JAVA SQL\n\nMATHEMATICS\nCALCULUS ALGEBRA DISCRETE\n\nBIOLOGY\nZOOLOGY BOTANY MICROBIOLOGY BIOTECHNOLOGY\n\nCHEMISTRY\nORGANIC INORGANIC PHYSICAL\n\nSOCIAL_STUDIES\nPOLITICAL_SCIENCE GEOGRAPHY HISTORY CIVIL_SCIENCE\n\nBUSINESS_ADMINISTRATION\nACCOUNTS MANAGEMENT STATISTICS ECONOMICS\n\nSCIENCE_FICTION\nSPACE ALIENS FUTURE WAR ADVENTURE\n\nLITERATURE\nENGLISH HINDI COMEDY NOVEL\n\nPHYSICS\nMECHANICS FLUIDS NUCLEAR THERMODYNAMICS\n\nARTS_AND_HUMANITIES\nPHILOSOPHY SOCIOLOGY PSYCHOLOGY ANTHROPOLOGY\n</code></pre>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 609, "user_id": 9414470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYyc9.png?s=128&g=1", "display_name": "Jaideep Shekhar", "link": "https://stackoverflow.com/users/9414470/jaideep-shekhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 59395082, "answer_count": 3, "score": 4, "last_activity_date": 1576775585, "creation_date": 1576681312, "last_edit_date": 1576683222, "question_id": 59394747, "link": "https://stackoverflow.com/questions/59394747/creating-a-struct-as-enum-class-member", "title": "Creating a struct as enum class member", "body": "<p>I was working on creating a multilevel enum for a Library.</p>\n\n<ul>\n<li><em>I would like something (not necessarily exactly) like this</em>:</li>\n</ul>\n\n<pre><code>Book::Category::PROGRAMMING::C_PLUS_PLUS\n</code></pre>\n\n<p>where <code>Book</code> is a <code>struct</code> and <code>Category</code> is (currently) an <code>enum class</code>.<br>\n<em>Basically, I would like to nest enums</em>.</p>\n\n<p>I know that I can just do:</p>\n\n<pre><code>Book::Category::PROGRAMMING_C_PLUS_PLUS\n</code></pre>\n\n<p>But not only will this create a <em>long</em> list of values in <code>Category</code>, but will make maintaining it a nightmare (I tried to do this with 30, and it was already a headache).</p>\n\n<p>I want to divide and conquer this problem.</p>\n\n<p><strong>Edit 1</strong>: The reason I didn't want it to be a <code>std::string</code> is that it's value can be <em>anything and everything</em>. I wanted to constrain the domain of <code>Category</code>.  </p>\n\n<p>And no, <code>PROGRAMMING</code> is not a major part of my Library. Let me try with classes and inheritance.  </p>\n\n<p>Basically, the reason I wanted <code>enum</code>s was to have a fixed set of valid constants.</p>\n\n<hr>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/15057140/can-enum-class-be-nested\">Can enum class be nested?\n</a> -> I need to create objects of <code>Book</code>, and hence it cannot be a namespace. I couldn't understand the answer that used templates.  </li>\n<li><a href=\"https://stackoverflow.com/questions/18335861/why-is-enum-class-preferred-over-plain-enum\">Why is enum class preferred over plain enum?</a> -> Has no answer to my question.</li>\n</ul>\n"}, {"tags": ["c++", "recursion", "linked-list", "reverse", "singly-linked-list"], "comments": [{"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1576680950, "post_id": 59394553, "comment_id": 104978540, "body": "Post all relevant code, and what does not work?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576681219, "post_id": 59394553, "comment_id": 104978725, "body": "&quot;my code does not work&quot; This is not a useful description of the problem that allows us to help you."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1576681325, "post_id": 59394553, "comment_id": 104978788, "body": "1) Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. 2) Did you try stepping through your code, <b>line-by-line</b>, with a debugger, while investigating the values of every variable, at each execution step, taking note, of where the execution doesn&#39;t match your expectations?"}, {"owner": {"reputation": 147, "user_id": 3389943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ff56d96ec942ec3cce5b5c23af725?s=128&d=identicon&r=PG&f=1", "display_name": "user3389943", "link": "https://stackoverflow.com/users/3389943/user3389943"}, "edited": false, "score": 0, "creation_date": 1576682093, "post_id": 59394553, "comment_id": 104979213, "body": "Work with an example say A-&gt;B-&gt;C-&gt;null by hand. You can easily see why it does not work . And please post what you found ."}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1576683031, "post_id": 59394553, "comment_id": 104979761, "body": "@Borna Jelic I do not know who down-voted your question but it is evident that the task is not simple for a beginner."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7605519, "user_type": "registered", "profile_image": "https://graph.facebook.com/794608640692386/picture?type=large", "display_name": "Borna Jelic", "link": "https://stackoverflow.com/users/7605519/borna-jelic"}, "edited": false, "score": 0, "creation_date": 1576738210, "post_id": 59394812, "comment_id": 104997408, "body": "Thank you Vlad, but here you said &quot;Also the original head passed through pointer to the function is not changed.&quot;. Isnt it(head) changed in the exit condition for my recursion where *head = current is written?"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 11, "user_id": 7605519, "user_type": "registered", "profile_image": "https://graph.facebook.com/794608640692386/picture?type=large", "display_name": "Borna Jelic", "link": "https://stackoverflow.com/users/7605519/borna-jelic"}, "edited": false, "score": 0, "creation_date": 1576749744, "post_id": 59394812, "comment_id": 105002376, "body": "@BornaJelic No, it Is not the original head that are changed."}], "tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1576682889, "last_edit_date": 1576682889, "creation_date": 1576681509, "answer_id": 59394812, "question_id": 59394553, "link": "https://stackoverflow.com/questions/59394553/reversing-linked-list-using-double-pointers-and-recursion/59394812#59394812", "title": "Reversing linked list using double pointers and recursion", "body": "<p>For starters the function does not check whether <code>*head</code> is equal to <code>nullptr</code>. So the function has undefined behavior.</p>\n\n<p>Also the original head passed through pointer to the function is not changed.</p>\n\n<p>The function can look the following way</p>\n\n<pre><code> void reverse_LList_R_fail( Node **head ) \n { \n     if ( *head &amp;&amp; ( *head )-&gt;next ) \n     { \n         Node *current = *head; \n         *head = ( *head )-&gt;next; \n         reverse_LList_R_fail( head ); \n         current-&gt;next-&gt;next = current; \n         current-&gt;next = nullptr; \n     }         \n } \n</code></pre>\n\n<p>And the function is called like</p>\n\n<pre><code>reverse_LList_R_fail( &amp;head );\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7605519, "user_type": "registered", "profile_image": "https://graph.facebook.com/794608640692386/picture?type=large", "display_name": "Borna Jelic", "link": "https://stackoverflow.com/users/7605519/borna-jelic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "closed_date": 1576687083, "answer_count": 1, "score": -1, "last_activity_date": 1576682889, "creation_date": 1576680652, "last_edit_date": 1576681605, "question_id": 59394553, "link": "https://stackoverflow.com/questions/59394553/reversing-linked-list-using-double-pointers-and-recursion", "closed_reason": "Not suitable for this site", "title": "Reversing linked list using double pointers and recursion", "body": "<p>I know there are a lot of answers, but I just CANT understand why my code does not work.\nCan you please help?</p>\n\n<pre><code>void reverse_LList_R_fail(Node** head) {\n\n    Node* current = *head;\n    if(current-&gt;next == nullptr) {\n        *head = current;\n        return;\n    }\n\n    reverse_LList_R_fail(&amp;(current)-&gt;next);\n    current-&gt;next-&gt;next = current;\n    current-&gt;next = nullptr;\n\n}\n</code></pre>\n\n<p>PS: in my LList implementation, I defined Node* head = nullptr; as a global variable, and in my assigment, I have to use a double pointer.</p>\n"}, {"tags": ["java", "c++", "if-statement"], "comments": [{"owner": {"reputation": 356910, "user_id": 1221571, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GLKUy.jpg?s=128&g=1", "display_name": "Eran", "link": "https://stackoverflow.com/users/1221571/eran"}, "edited": false, "score": 16, "creation_date": 1576680609, "post_id": 59394523, "comment_id": 104978319, "body": "Different languages. Difference rules."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1576680642, "post_id": 59394523, "comment_id": 104978345, "body": "Java and C++ are completly different languages. Do not expect what works in one will work in the other.  They have different styles of coding and you should forget you even know C++ and just learn Java like you would if it is your first language.  That will help you to get into the Java frame of mind."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 4, "creation_date": 1576680939, "post_id": 59394523, "comment_id": 104978535, "body": "I disagree with the close reason being &quot;<i>This question is opinion-based.</i>&quot; How is this question opinion-based? This question is about different rules, of different languages. Those rules are defined, and not a subject to an opinion."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1576681227, "post_id": 59394523, "comment_id": 104978730, "body": "@NathanOliver-ReinstateMonica Yes, I would agree, that closing it as a dupe, with the target, you linked to, would be much more accurate, than this question being &quot;opinion-based&quot;."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1576681371, "post_id": 59394523, "comment_id": 104978811, "body": "@AlgirdasPreid\u017eius Alright, now it is a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 4, "creation_date": 1576680896, "post_id": 59394572, "comment_id": 104978507, "body": "To clarify: In C++, other integer types implicitly convert to <code>bool</code>."}], "tags": [], "owner": {"reputation": 552, "user_id": 3899765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15814352906e74b0770875e8adee59f?s=128&d=identicon&r=PG", "display_name": "Yonatan Karp-Rudin", "link": "https://stackoverflow.com/users/3899765/yonatan-karp-rudin"}, "is_accepted": true, "score": 3, "last_activity_date": 1576680709, "creation_date": 1576680709, "answer_id": 59394572, "question_id": 59394523, "link": "https://stackoverflow.com/questions/59394523/why-does-the-if-statement-if1-give-error-in-java-but-it-holds-true-in-c/59394572#59394572", "title": "Why does the if statement &quot;if(1)&quot; give error in Java but it holds true in C++?", "body": "<p>The reason for that is simple - in java every condition must be resolved as a boolean value (true of false) while in c / c++ false is 0 while true is anything else...</p>\n"}], "owner": {"reputation": 21, "user_id": 11558875, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OulFJR-PPa8/AAAAAAAAAAI/AAAAAAAAAIE/Hz7uJRhHvmI/photo.jpg?sz=128", "display_name": "Ayush Kumar Singh", "link": "https://stackoverflow.com/users/11558875/ayush-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 59394572, "answer_count": 1, "score": -6, "last_activity_date": 1576694172, "creation_date": 1576680548, "last_edit_date": 1576680789, "question_id": 59394523, "link": "https://stackoverflow.com/questions/59394523/why-does-the-if-statement-if1-give-error-in-java-but-it-holds-true-in-c", "title": "Why does the if statement &quot;if(1)&quot; give error in Java but it holds true in C++?", "body": "<p>It might be trivial, but I am a beginner in Java so any help will be much appreciated!\nThe error I get if I run the program</p>\n\n<pre><code>public class Main {\n    public static void main(String args[]) {\n        if(1)\n           System.out.println(\"Hello World!\");\n    }\n}\n</code></pre>\n\n<p>is </p>\n\n<blockquote>\n  <p>Main.java:3: error: incompatible types: int cannot be converted to boolean\n          if(1)\n             ^</p>\n</blockquote>\n\n<p>but the following code in C++ works</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main() {\n    if(1)\n        cout&lt;&lt;\"Hello World!\";\n}\n</code></pre>\n\n<p>Does Java not consider 0 as false and any number other than 0 true, like in C++?</p>\n"}, {"tags": ["c++", "linux", "cron", "embedded", "spawn"], "comments": [{"owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "edited": false, "score": 0, "creation_date": 1576680970, "post_id": 59394427, "comment_id": 104978558, "body": "probably this is relevant - check for setsid() - <a href=\"https://stackoverflow.com/a/46621604/12396017\">stackoverflow.com/a/46621604/12396017</a> - if you find the answer to your issue then please write down detailed answer to your own question"}, {"owner": {"reputation": 3281, "user_id": 8411406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03feb45788181f61b08fdb8b5d26968e?s=128&d=identicon&r=PG", "display_name": "Turtlefight", "link": "https://stackoverflow.com/users/8411406/turtlefight"}, "edited": false, "score": 0, "creation_date": 1576685955, "post_id": 59394427, "comment_id": 104981492, "body": "If you don&#39;t mind using the parent process as watcher you could just use <code>fork()</code> &amp; <code>waitpid()</code> to monitor the child doing the work, <a href=\"https://onlinegdb.com/rkFrbCDRr\" rel=\"nofollow noreferrer\">heres a small example</a>"}, {"owner": {"reputation": 11, "user_id": 2528125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7427a04b864daaba235da952f8144931?s=128&d=identicon&r=PG", "display_name": "Gernot", "link": "https://stackoverflow.com/users/2528125/gernot"}, "edited": false, "score": 0, "creation_date": 1576771956, "post_id": 59394427, "comment_id": 105013966, "body": "First of all, thanks for your comments. I already use setsid(), and, letting the parent process watch did not work since a crashing child became defunct. However, I made some progress in analysing the root cause: Seems that when starting from cron job the environment variables get corrupted.First process A has good ones and it can start B, B itself has corrupted ones and crashes while starting the next process C. I tried with hard-coded variables and that worked fine. Since I dont think this can be a final solution - any ideas how to prevent this corruption?"}], "owner": {"reputation": 11, "user_id": 2528125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7427a04b864daaba235da952f8144931?s=128&d=identicon&r=PG", "display_name": "Gernot", "link": "https://stackoverflow.com/users/2528125/gernot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576680251, "creation_date": 1576680251, "question_id": 59394427, "link": "https://stackoverflow.com/questions/59394427/start-process-a-with-child-process-b-from-a-cron-job-on-embedded-linux-crash-o", "title": "Start process A with child process B from a cron job on embedded Linux - crash of A kills B too", "body": "<p>I am trying to implement some sort of self-watching with C++14 in a process on embedded linux. If process A is started, it starts an additional process B from same image, with posix_spawn and setsid, if he is the only one running so far. After that, process A starts to work.\nThis additional process B detects that there are two processes A+B running from the respective image and waits until A crashes. In case of a crash, the additional process B leaves the wait, starts a new process C for monitoring himself, and takes over the work of the crashed A and so on.\nThat works pretty good if I start process A directly in a shell, or from a shell script.\nDoing the initial start-up from a cron job works at first, but the crash of process A kills the waiting child B as well. Is there any way to prevent this? So far, I tried various versions of adding &amp; or nohup to the cron job script, but nothing helped. I need B to survive the crash of A, if B has been started by A, and A has been started by a cron job (doing this w/o cron is not an option, also, doing this with two separately started processes won't work in our scenario).</p>\n"}, {"tags": ["c++", "default-arguments"], "comments": [{"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 1, "creation_date": 1576681384, "post_id": 59394352, "comment_id": 104978822, "body": "What is the purpose of attributes registering themselves with a base class of the class they are a member of?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1576681882, "post_id": 59394352, "comment_id": 104979097, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/59308688/is-there-a-modern-c-way-for-a-constructor-to-know-its-container-class\">Is there a Modern C++ way for a constructor to know its &#39;container&#39; class?</a>"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1576682204, "post_id": 59394352, "comment_id": 104979260, "body": "Add a protected method to ABase: <code>Attr MakeAttr(const char* name, int val) { return Attr(name, val, this); }</code>. In <code>D</code>, you write <code>Attr a{ MakeAttr(&quot;a&quot;, 1) };</code>"}, {"owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "reply_to_user": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1576682765, "post_id": 59394352, "comment_id": 104979614, "body": "@MichaelKenzel It&#39;s not clear by the question, but I suspect the idea here is to make it possible to access the members using string representations of the name. If that&#39;s actually a good idea is another question."}], "answers": [{"tags": [], "owner": {"reputation": 9427, "user_id": 7703024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e363e0e11695395e04f814233b6274?s=128&d=identicon&r=PG", "display_name": "super", "link": "https://stackoverflow.com/users/7703024/super"}, "is_accepted": false, "score": 5, "last_activity_date": 1576682308, "creation_date": 1576682308, "answer_id": 59395068, "question_id": 59394352, "link": "https://stackoverflow.com/questions/59394352/make-function-argument-default-to-surrounding-scope/59395068#59395068", "title": "make function argument default to surrounding scope", "body": "<p>You could add a member-function to <code>ABase</code> that create the <code>Attr</code> for you.</p>\n\n<pre><code>class ABase{\npublic:\n    void reg(const char* name, AttrBase* att) {\n        std::cout &lt;&lt; name &lt;&lt; \": \" &lt;&lt; att-&gt;g()&lt;&lt; std::endl;\n    }\n\nprotected:\n    template &lt;typename AttrType, typename... Args&gt;\n    AttrType make(Args&amp;&amp;... args) {\n        return AttrType{std::forward&lt;Args&gt;(args)..., this};\n    }\n};\n</code></pre>\n\n<p>Then we can use it as</p>\n\n<pre><code>class D:public ABase {\n    Attr a = make&lt;Attr&gt;(\"a\", 1);\n    auto b = make&lt;Attr&gt;(\"b\", 2); // works with auto to avoid specifying the type twice\n};\n</code></pre>\n"}], "owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1576683509, "creation_date": 1576679947, "last_edit_date": 1576683509, "question_id": 59394352, "link": "https://stackoverflow.com/questions/59394352/make-function-argument-default-to-surrounding-scope", "title": "make function argument default to surrounding scope", "body": "<p>Considering the following code/scheme provided below, is it somehow possible to omit the necessity to specify the <code>this</code>?</p>\n\n<p>Is there a way to change the code so that a function/constructor automatically get the surrounding scope, maybe even as a template argument?</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass AttrBase{\npublic:\n  virtual int g()const = 0;\n};\n\nclass ABase{\npublic:\n void reg(const char* name, AttrBase* att){\n  std::cout &lt;&lt; name &lt;&lt; \": \" &lt;&lt; att-&gt;g()&lt;&lt; std::endl;\n }\n};\n\n\nclass Attr : public AttrBase{\npublic: \n  Attr(const char* name, int val, ABase* parent /* = this */) // something like this\n   :v(val)\n  { \n    parent-&gt;reg(name, this);\n  };\n  int g()const override{return  v;};\n  int v;\n};\n\n\nclass D:public ABase{\n  Attr a{\"a\", 1, this};\n  Attr b{\"b\", 2, this};\n  Attr c{\"c\", 3};    //&lt; is this somehow possible\n};\n\nint main(){\n D d;\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-c++", "msvcrt"], "comments": [{"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576680716, "post_id": 59394312, "comment_id": 104978392, "body": "I can&#39;t even parse that <code>__countof_helper</code> declaration..."}, {"owner": {"reputation": 2924, "user_id": 747768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyu91.jpg?s=128&g=1", "display_name": "Kirill Dmitrenko", "link": "https://stackoverflow.com/users/747768/kirill-dmitrenko"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1576680881, "post_id": 59394312, "comment_id": 104978499, "body": "@MaxLanghof Took me some time to parse it too:) It declares a function template that returns a pointer to a fixed-size array of the same number of <code>char</code>s as in the argument array. Thus <code>sizeof</code> of that <code>char</code> array should be the same as number of elements in the argument array."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576681798, "post_id": 59394312, "comment_id": 104979061, "body": "@KirillDmitrenko Why does it do all this? <i>That</i> seems more interesting than <code>+0</code>. Couldn&#39;t <code>__countof_helper</code> just return <code>_SizeOfArray</code>?"}, {"owner": {"reputation": 2924, "user_id": 747768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyu91.jpg?s=128&g=1", "display_name": "Kirill Dmitrenko", "link": "https://stackoverflow.com/users/747768/kirill-dmitrenko"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1576682347, "post_id": 59394312, "comment_id": 104979339, "body": "@Fran&#231;oisAndrieux It&#39;s safer than traditional <code>sizeof(a) &#47; sizeof(a[0])</code>. If you accidentally pass a pointer instead of a static array to that construct, you&#39;ll get bad result. Linked implementation won&#39;t compile for a pointer. <a href=\"https://cs.chromium.org/chromium/src/v8/src/base/macros.h?type=cs&amp;q=ArraySizeHelper&amp;sq=package:chromium&amp;g=0&amp;l=27-30\" rel=\"nofollow noreferrer\">Here&#39;s</a> similar impl in Chromium and <a href=\"https://www.viva64.com/en/a/0074/\" rel=\"nofollow noreferrer\">here&#39;s</a> an article which contains full explanation why something like this is preferable and less error-prone (dare I even say, error free)."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576684024, "post_id": 59394312, "comment_id": 104980344, "body": "I guess this code predates <code>constexpr</code>. And the code I linked compiles but it wouldn&#39;t actually run. I see now why it does it this way. It communicates the size through type information which keeps it a compile time constant."}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576683257, "post_id": 59395087, "comment_id": 104979910, "body": "Can you share an example of a context where this happens?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576684358, "post_id": 59395087, "comment_id": 104980528, "body": "Extra parenthesis  around <code>size_t(num)</code> also fixes it, which the macro has. So it looks to me like the macro already defends against that without <code>+0</code>."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576684619, "post_id": 59395087, "comment_id": 104980688, "body": "@Fran&#231;oisAndrieux But the M/S coder who implemented that particular header may not have been sure, so added the <code>+0</code> just to be on the safe side?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1576684757, "post_id": 59395087, "comment_id": 104980767, "body": "Definitely a possibility. The <i>intention</i> may have been to prevent mvp. In any case it does no harm and it makes sense that nobody wants to take on the responsibility of removing it and risking breaking someone&#39;s code by accident if it turns out it <i>does</i> do something unexpected."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1576685689, "post_id": 59395087, "comment_id": 104981328, "body": "@Fran&#231;oisAndrieux One could <i>maybe</i> &#39;break&#39; the added parentheses by trying to define a cast/converter operation with: <code>#define BESILLY(arg) int _countof(arg)</code>"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 3, "creation_date": 1576696731, "post_id": 59395087, "comment_id": 104986536, "body": "<code>sizeof</code> is not <code>size_t</code>. It&#39;s not a type. I don&#39;t see how it could ever trigger the MVP."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1576711039, "post_id": 59395087, "comment_id": 104991636, "body": "@T.C. Exactly the point. My efforts to devise an example have so far failed! I can make it happen with <code>size_t</code> but <i>not</i> with <code>sizeof</code>! Here, I can only suggest there may have been a time (still could be, somewhen?) when <code>sizeof</code> was implemented function-style. And let&#39;s not forget that it&#39;s best not to &quot;fix&quot; other folks&#39; code if you don&#39;t know why you&#39;re &#39;fixing&#39; it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576713224, "post_id": 59395087, "comment_id": 104992167, "body": "Can you cite any source that this is the reason for it? The guy who actually wrote the code says differently."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1576718444, "post_id": 59395087, "comment_id": 104993235, "body": "@M.M I can only refer the caller to my comment, above, or maybe to this alternative: <a href=\"https://stackoverflow.com/a/9679201/10871073\">stackoverflow.com/a/9679201/10871073</a>"}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": true, "score": 6, "last_activity_date": 1576711287, "last_edit_date": 1576711287, "creation_date": 1576682378, "answer_id": 59395087, "question_id": 59394312, "link": "https://stackoverflow.com/questions/59394312/why-does-the-msvc-count-of-implementation-add-0-to-the-result-of-sizeof/59395087#59395087", "title": "Why does the MSVC _count_of implementation add 0 to the result of sizeof?", "body": "<p>The <code>+ 0</code> is added to prevent a <em>potential</em> occurrence of the <a href=\"https://stackoverflow.com/questions/17060725/most-vexing-parse-confusion\">Most Vexing Parse</a>! Without it, an expression like <code>sizeof(*__countof_helper(_Array))</code> <em>could</em> be taken as a function declaration in some circumstances.</p>\n\n<p><em>EDIT: I'm currently trying to work up an example context (as per request in the comment). In the meantime, this much-simplified 'equivalent' (something I have actually encountered) may be helpful:</em></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint main() {\n    int num = 2;\n//  std::vector&lt;char&gt; vec(size_t(num));     // Won't compile - Most Vexing Parse\n    std::vector&lt;char&gt; vec(size_t(num) + 0); // Compiles - no longer a func decl!\n    vec[0] = 'a';\n    vec[1] = 'b';\n    std::cout &lt;&lt; vec[0] &lt;&lt; ' ' &lt;&lt; vec[1] &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 2924, "user_id": 747768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nyu91.jpg?s=128&g=1", "display_name": "Kirill Dmitrenko", "link": "https://stackoverflow.com/users/747768/kirill-dmitrenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 2, "closed_date": 1576712057, "accepted_answer_id": 59395087, "answer_count": 1, "score": 6, "last_activity_date": 1576711287, "creation_date": 1576679782, "last_edit_date": 1576697471, "question_id": 59394312, "link": "https://stackoverflow.com/questions/59394312/why-does-the-msvc-count-of-implementation-add-0-to-the-result-of-sizeof", "closed_reason": "Duplicate", "title": "Why does the MSVC _count_of implementation add 0 to the result of sizeof?", "body": "<p>I've been reading the implementation of the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/countof-macro?view=vs-2019\" rel=\"nofollow noreferrer\"><code>_countof</code></a> macro in MSVC and found a detail I can't explain. It's implemented via a <code>__crt_countof</code> macro which on C++ is expanded to <code>(sizeof(*__countof_helper(_Array)) + 0)</code> (<a href=\"https://gist.github.com/dmikis/bddf84afd5a00a8b837374e9ced58696\" rel=\"nofollow noreferrer\">here's</a> the relevant code from the header). Why is <code>+ 0</code> there? What would go amiss without it?</p>\n"}, {"tags": ["c++", "eclipse", "date", "poco", "poco-libraries"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1576679208, "post_id": 59394089, "comment_id": 104977499, "body": "What have you tried? Can you show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your attempt? How does your attempt work or not work? What&#39;s happening when you build or run it? What&#39;s supposed to happen? Perhaps it&#39;s time to refresh <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1339, "user_id": 2894590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0BwRA.jpg?s=128&g=1", "display_name": "Cookie Butter", "link": "https://stackoverflow.com/users/2894590/cookie-butter"}, "is_accepted": false, "score": 0, "last_activity_date": 1584115599, "creation_date": 1584115599, "answer_id": 60673733, "question_id": 59394089, "link": "https://stackoverflow.com/questions/59394089/how-to-create-a-variable-of-type-pocodatedate-and-add-a-particular-date/60673733#60673733", "title": "How to create a variable of type poco::Date::Date and add a particular date?", "body": "<p>There is a constructor that takes year, month, day.  </p>\n\n<pre><code>Poco::Data::Date birthDate(2019, 7, 18); // I am less than one year old\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9039315, "user_type": "registered", "profile_image": "https://graph.facebook.com/934333703289426/picture?type=large", "display_name": "Mohanish Nehete", "link": "https://stackoverflow.com/users/9039315/mohanish-nehete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584115599, "creation_date": 1576679011, "last_edit_date": 1576679447, "question_id": 59394089, "link": "https://stackoverflow.com/questions/59394089/how-to-create-a-variable-of-type-pocodatedate-and-add-a-particular-date", "title": "How to create a variable of type poco::Date::Date and add a particular date?", "body": "<p>How can I create a variable of type \"poco::Data::Date\" using poco library and add a particular date like 18/7/2019 in it?</p>\n"}, {"tags": ["c++", "c++20", "if-constexpr"], "comments": [{"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 1, "creation_date": 1576679380, "post_id": 59393908, "comment_id": 104977604, "body": "<a href=\"https://godbolt.org/z/8M6Dtz\" rel=\"nofollow noreferrer\">Smaller example</a>"}, {"owner": {"reputation": 1555, "user_id": 7508046, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59f0e6ee17bb67e5884e12aa6b192c11?s=128&d=identicon&r=PG&f=1", "display_name": "Yamahari", "link": "https://stackoverflow.com/users/7508046/yamahari"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1576686604, "post_id": 59393908, "comment_id": 104981881, "body": "@AndyG that doesn&#39;t fix it though, does it? x)"}], "answers": [{"comments": [{"owner": {"reputation": 1555, "user_id": 7508046, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59f0e6ee17bb67e5884e12aa6b192c11?s=128&d=identicon&r=PG&f=1", "display_name": "Yamahari", "link": "https://stackoverflow.com/users/7508046/yamahari"}, "edited": false, "score": 0, "creation_date": 1576682319, "post_id": 59394147, "comment_id": 104979324, "body": "do you know the reasoning for this? it looks like this would be a good fit for if constexpr. Also so the solution would be e.g. wrapping it in a template somehow?"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 1555, "user_id": 7508046, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59f0e6ee17bb67e5884e12aa6b192c11?s=128&d=identicon&r=PG&f=1", "display_name": "Yamahari", "link": "https://stackoverflow.com/users/7508046/yamahari"}, "edited": false, "score": 0, "creation_date": 1576682789, "post_id": 59394147, "comment_id": 104979627, "body": "@Yamahari Because C++ templates are both more and less structured than you want them to be. And yes, wrap it in a template (or write like <code>i.value_or(0)</code>)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 1555, "user_id": 7508046, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59f0e6ee17bb67e5884e12aa6b192c11?s=128&d=identicon&r=PG&f=1", "display_name": "Yamahari", "link": "https://stackoverflow.com/users/7508046/yamahari"}, "edited": false, "score": 2, "creation_date": 1576682806, "post_id": 59394147, "comment_id": 104979636, "body": "@Yamahari Yes, the solution would be to put the code in a function template.  As far as reasoning goes, I do not know why.  That would probably be a good question to ask."}, {"owner": {"reputation": 1555, "user_id": 7508046, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59f0e6ee17bb67e5884e12aa6b192c11?s=128&d=identicon&r=PG&f=1", "display_name": "Yamahari", "link": "https://stackoverflow.com/users/7508046/yamahari"}, "reply_to_user": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "edited": false, "score": 0, "creation_date": 1576687357, "post_id": 59394147, "comment_id": 104982289, "body": "@Barry value_or(0) works fine but for case when the tuple is size 0"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": true, "score": 11, "last_activity_date": 1576679991, "last_edit_date": 1576679991, "creation_date": 1576679210, "answer_id": 59394147, "question_id": 59393908, "link": "https://stackoverflow.com/questions/59393908/if-constexpr-why-is-discarded-statement-fully-checked/59394147#59394147", "title": "if constexpr - why is discarded statement fully checked?", "body": "<p>This is just how <a href=\"https://en.cppreference.com/w/cpp/language/if#Constexpr_If\" rel=\"noreferrer\">constexpr if</a> works.  If we check <a href=\"https://timsong-cpp.github.io/cppwp/stmt.select#stmt.if-2\" rel=\"noreferrer\">[stmt.if]/2</a></p>\n\n<blockquote>\n  <p>If the if statement is of the form if constexpr, the value of the condition shall be a contextually converted constant expression of type bool; this form is called a constexpr if statement. If the value of the converted condition is false, the first substatement is a discarded statement, otherwise the second substatement, if present, is a discarded statement. <strong>During the instantiation of an enclosing templated entity ([temp.pre]), if the condition is not value-dependent after its instantiation, the discarded substatement (if any) is not instantiated.</strong>[...]</p>\n</blockquote>\n\n<p><sup>emphasis mine</sup></p>\n\n<p>So we can see that we only do not evaluate the discarded expression if we are in a template and if the condition is value-dependent.  <code>main</code> is not a function template so the body of the if statement is still checked by the compiler for correctness.</p>\n\n<p>Cppreference also says this in their section about constexpr if with:</p>\n\n<blockquote>\n  <p>If a constexpr if statement appears inside a templated entity, and if condition is not value-dependent after instantiation, the discarded statement is not instantiated when the enclosing template is instantiated .</p>\n\n<pre><code>template&lt;typename T, typename ... Rest&gt;\nvoid g(T&amp;&amp; p, Rest&amp;&amp; ...rs) {\n    // ... handle p\n    if constexpr (sizeof...(rs) &gt; 0)\n        g(rs...); // never instantiated with an empty argument list.\n}\n</code></pre>\n  \n  <p>Outside a template, a discarded statement is fully checked. if constexpr is not a substitute for the #if preprocessing directive:</p>\n\n<pre><code>void f() {\n    if constexpr(false) {\n        int i = 0;\n        int *p = i; // Error even though in discarded statement\n    }\n}\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1555, "user_id": 7508046, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59f0e6ee17bb67e5884e12aa6b192c11?s=128&d=identicon&r=PG&f=1", "display_name": "Yamahari", "link": "https://stackoverflow.com/users/7508046/yamahari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 3, "accepted_answer_id": 59394147, "answer_count": 1, "score": 13, "last_activity_date": 1576679991, "creation_date": 1576678403, "last_edit_date": 1576678828, "question_id": 59393908, "link": "https://stackoverflow.com/questions/59393908/if-constexpr-why-is-discarded-statement-fully-checked", "title": "if constexpr - why is discarded statement fully checked?", "body": "<p>I was messing around with c++20 consteval in GCC 10 and wrote this code</p>\n\n<pre><code>#include &lt;optional&gt;\n#include &lt;tuple&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;std::size_t N, typename Predicate, typename Tuple&gt;\nconsteval std::optional&lt;std::size_t&gt; find_if_impl(Predicate&amp;&amp; pred,\n                                                  Tuple&amp;&amp; t) noexcept {\n  constexpr std::size_t I = std::tuple_size_v&lt;std::decay_t&lt;decltype(t)&gt;&gt; - N;\n\n  if constexpr (N == 0u) {\n    return std::nullopt;\n  } else {\n    return pred(std::get&lt;I&gt;(t))\n               ? std::make_optional(I)\n               : find_if_impl&lt;N - 1u&gt;(std::forward&lt;decltype(pred)&gt;(pred),\n                                      std::forward&lt;decltype(t)&gt;(t));\n  }\n}\n\ntemplate &lt;typename Predicate, typename Tuple&gt;\nconsteval std::optional&lt;std::size_t&gt; find_if(Predicate&amp;&amp; pred,\n                                             Tuple&amp;&amp; t) noexcept {\n  return find_if_impl&lt;std::tuple_size_v&lt;std::decay_t&lt;decltype(t)&gt;&gt;&gt;(\n      std::forward&lt;decltype(pred)&gt;(pred), std::forward&lt;decltype(t)&gt;(t));\n}\n\nconstexpr auto is_integral = [](auto&amp;&amp; x) noexcept {\n    return std::is_integral_v&lt;std::decay_t&lt;decltype(x)&gt;&gt;;\n};\n\n\nint main() {\n    auto t0 = std::make_tuple(9, 1.f, 2.f);\n    constexpr auto i = find_if(is_integral, t0);\n    if constexpr(i.has_value()) {\n        std::cout &lt;&lt; std::get&lt;i.value()&gt;(t0) &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>Which is supposed to work like the STL find algorithm but on tuples and instead of returning an iterator, it returns an optional index based on a compile time predicate. Now this code compiles just fine and it prints out </p>\n\n<blockquote>\n  <p>9</p>\n</blockquote>\n\n<p>But if the tuple does not contain an element that's an integral type, the program doesn't compile, because the i.value() is still called on an empty optional. Now why is that?</p>\n"}, {"tags": ["c++", "linux", "cmake"], "comments": [{"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 2, "creation_date": 1576678554, "post_id": 59393782, "comment_id": 104977146, "body": "How many such files are there? Can you just check for existence of the lower-case version, then add the upper-case version instead if the lower-case does not exist?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1576678602, "post_id": 59393782, "comment_id": 104977164, "body": "Are you sure that it is cmake that gives the error? And not for example the compiler, or the underlying buildsystem (make, ninja)?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 2, "creation_date": 1576678643, "post_id": 59393782, "comment_id": 104977184, "body": "It sounds like someone added case-insensitive filenames to <code>CMakeLists.txt</code> based on Windows development. It also sounds like you need to go through <code>CMakeLists.txt</code> and fix them manually now that you are supporting Unix and Linux."}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1576678804, "post_id": 59393782, "comment_id": 104977274, "body": "@eerorika It may not be a cmake issue, seems to me that c++ in linux is case sensitive when it comes to include files, unlike windows."}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "reply_to_user": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 1, "creation_date": 1576678808, "post_id": 59393782, "comment_id": 104977276, "body": "@squareskittles, there are about 100 ish .cpp files and maybe 50 or so .h files."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 1, "creation_date": 1576678824, "post_id": 59393782, "comment_id": 104977279, "body": "What do you expect to happen if CMake looks for <code>abc.h</code> but there are <code>Abc.h</code> and <code>aBc.h</code> in one folder. Which file should be choosen? If this situation is not possible use a script to change the case for all files in your project to lower case."}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "reply_to_user": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 1, "creation_date": 1576679049, "post_id": 59393782, "comment_id": 104977403, "body": "@Thomas Sablik The project was built in windows, and for some reason the creators of the project didnt stick to a naming convention. There arent any ocurrences of the <code>Abc.h</code> vs <code>aBc.h</code>, as there will only be one."}, {"owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "edited": false, "score": 4, "creation_date": 1576679102, "post_id": 59393782, "comment_id": 104977433, "body": "Then there will be no conflicts if you use a script to change all filenames to lower case"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1576679148, "post_id": 59393782, "comment_id": 104977458, "body": "<code>grep -E &#39;\\.h|\\.c|\\.cpp&#39; CMakeLists.txt</code> will help you locate the filenames in <code>CMakeLists.txt</code>. But things will get <a href=\"https://pastebin.com/FEst4MFR\" rel=\"nofollow noreferrer\">messy</a> on a non-trivial project. It may be easier to let the compiler tell you of the problems with the failed compile."}, {"owner": {"reputation": 11727, "user_id": 3987854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OV64v.jpg?s=128&g=1", "display_name": "squareskittles", "link": "https://stackoverflow.com/users/3987854/squareskittles"}, "edited": false, "score": 0, "creation_date": 1576679500, "post_id": 59393782, "comment_id": 104977670, "body": "My opinion, you should modify the CMake files to match the case of the files <i>exactly</i>. With that number of files to check, you can simply navigate to the directories containing the files, run <code>ls -1</code> to obtain a list, then copy/paste that list into CMake; hopefully, that would not be too time-consuming!"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1576679705, "post_id": 59393782, "comment_id": 104977796, "body": "&quot;I had gotten an error saying fatal error: stdafx.h: No such file or directory&quot; - At <b>which stage</b> you have got such error? At <code>cmake</code> running, when CMake processes <code>CMakeLists.txt</code>? Or when the compiler (which one?) compiles the project&#39;s files. This aspect is extremely <b>important</b> for understand your issue. Please, show <b>exact error message</b>. See that <a href=\"https://meta.stackoverflow.com/questions/359146/why-should-i-post-complete-errors-why-isnt-the-message-itself-enough\">meta question</a> about why not-complete error messages are not so useful."}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1576679916, "post_id": 59393782, "comment_id": 104977929, "body": "@Tsyvarev the error occurs when the cxx compiler tries to build StdAfx.cpp."}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1576683150, "post_id": 59393782, "comment_id": 104979843, "body": "@Tsyvarev error message added."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1576684301, "post_id": 59393782, "comment_id": 104980501, "body": "Related: <a href=\"https://stackoverflow.com/questions/1951951/when-including-header-files-is-the-path-case-sensitive\" title=\"when including header files is the path case sensitive\">stackoverflow.com/questions/1951951/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 2, "creation_date": 1576678843, "post_id": 59394017, "comment_id": 104977287, "body": "You should probably use <code>CONFIGURE_DEPENDS</code> with globbed sources."}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "edited": false, "score": 2, "creation_date": 1576678849, "post_id": 59394017, "comment_id": 104977288, "body": "I&#39;ve seen people recommend against globbing files, as I&#39;m not sure how the files will change. Some modules of the project only require 10-15 .cpp files. How would I use glob to only grab those instead of every single .cpp file."}, {"owner": {"reputation": 130, "user_id": 11577537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5ae83ee3ac053c7fcc1b94cb2404d3?s=128&d=identicon&r=PG&f=1", "display_name": "Yevhenii Mamontov", "link": "https://stackoverflow.com/users/11577537/yevhenii-mamontov"}, "edited": false, "score": 2, "creation_date": 1576678858, "post_id": 59394017, "comment_id": 104977293, "body": "or in your example     <code>file(GLOB Sources &quot;*.cpp&quot;)     file(GLOB Headers &quot;*.h&quot;)      add_executable(${PROJECT_NAME} ${HDRS} ${SRCS})</code>"}, {"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "edited": false, "score": 1, "creation_date": 1576679769, "post_id": 59394017, "comment_id": 104977832, "body": "@YevheniiMamontov Glob would only add case mismatched .h and .cpp files, what about a <code>#include stdafx.h</code>, where a file called <code>StdAfx.h</code> would be added because of the glob, yet the include is still looking for the lowercase version. I would still be unable to find the lowercase <code>stdafx.h</code> file regardless of glob or no glob."}, {"owner": {"reputation": 130, "user_id": 11577537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5ae83ee3ac053c7fcc1b94cb2404d3?s=128&d=identicon&r=PG&f=1", "display_name": "Yevhenii Mamontov", "link": "https://stackoverflow.com/users/11577537/yevhenii-mamontov"}, "reply_to_user": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "edited": false, "score": 1, "creation_date": 1576680066, "post_id": 59394017, "comment_id": 104978015, "body": "@Bendrix, you are completely right. By so, you only can collect files no matter what their names are. It&#39;s better to use some script that change letters to lower/upper case."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "edited": false, "score": 0, "creation_date": 1576686141, "post_id": 59394017, "comment_id": 104981593, "body": "@Bendrix <code>Some modules of the project only require 10-15 .cpp files. How would I use glob to only grab those</code> modules should be separated into subdirectories with separate CMakeLists.txt for each, added with <code>add_subdirectory</code> in the top level CMakeLists.txt. In this structure, there should be no need for anything more complicated than glob that matches all."}], "tags": [], "owner": {"reputation": 130, "user_id": 11577537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5ae83ee3ac053c7fcc1b94cb2404d3?s=128&d=identicon&r=PG&f=1", "display_name": "Yevhenii Mamontov", "link": "https://stackoverflow.com/users/11577537/yevhenii-mamontov"}, "is_accepted": false, "score": 1, "last_activity_date": 1576680156, "last_edit_date": 1576680156, "creation_date": 1576678754, "answer_id": 59394017, "question_id": 59393782, "link": "https://stackoverflow.com/questions/59393782/cmake-adding-case-insensitive-source-files/59394017#59394017", "title": "CMake adding case insensitive source files", "body": "<p>You could try to use <code>file</code> method for collecting all the files you need to build, for example:</p>\n\n<pre><code>file(GLOB SRCS \"*.cpp\")\nfile(GLOB HDRS \"*.h\")\n\nadd_executable(${PROJECT_NAME} ${HDRS} ${SRCS})\n</code></pre>\n\n<p><strong>UPD:</strong>\nBy so you can only collect any files no matter what their names are. You'd better to change filenames through some script.</p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "edited": false, "score": 2, "creation_date": 1576678900, "post_id": 59394036, "comment_id": 104977320, "body": "I&#39;m sitting in linux just using gedit to edit files. All the source files are on my linux machine. Ill take a look though, thank you."}], "tags": [], "owner": {"reputation": 138, "user_id": 12357077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c950d7df91be91188252ecba362b9acd?s=128&d=identicon&r=PG&f=1", "display_name": "KimHajun", "link": "https://stackoverflow.com/users/12357077/kimhajun"}, "is_accepted": false, "score": 0, "last_activity_date": 1576678830, "creation_date": 1576678830, "answer_id": 59394036, "question_id": 59393782, "link": "https://stackoverflow.com/questions/59393782/cmake-adding-case-insensitive-source-files/59394036#59394036", "title": "CMake adding case insensitive source files", "body": "<p>Changing capitalization manually for the entire project might not be hard if you're using an editor that allows you to find and replace for the entire project.</p>\n\n<p>There are examples like <a href=\"https://docs.microsoft.com/en-us/visualstudio/ide/finding-and-replacing-text?view=vs-2019#find-in-files-and-replace-in-files\" rel=\"nofollow noreferrer\">Visual Studio 2017</a> and <a href=\"https://flight-manual.atom.io/using-atom/sections/find-and-replace/\" rel=\"nofollow noreferrer\">Atom</a>. </p>\n\n<p>Just try to press ctrl + shift + H. </p>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "edited": false, "score": 1, "creation_date": 1576679993, "post_id": 59394294, "comment_id": 104977970, "body": "Im gonna mark this as the answer, as it looks like for my specific case, using a script is the only way to change all the filenames to the correct format."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1576685592, "post_id": 59394294, "comment_id": 104981273, "body": "You have to change the case in the <code>#include</code>, too."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 3, "last_activity_date": 1576680558, "last_edit_date": 1576680558, "creation_date": 1576679717, "answer_id": 59394294, "question_id": 59393782, "link": "https://stackoverflow.com/questions/59393782/cmake-adding-case-insensitive-source-files/59394294#59394294", "title": "CMake adding case insensitive source files", "body": "<p>The issue is not with cmake, but with the filesystem. The filesystems in linux are generally case sensitive. stdafx.h is not the same file as Stdafx.h. If your CMakeLists.txt and source files use wrong case that doesn't match the name of the file, then the project is not compatible with linux and its filesystems. So, your options are:</p>\n\n<ol>\n<li>Use a case-insensitive filesystem, since that is what the project supports\n\n<ol>\n<li>You could try a case-insensitive filesystem on linux, but that is a hacky solution.</li>\n<li>Use windows.</li>\n</ol></li>\n<li>Fix the project to support case sensitive filesystems by correcting the filenames and their references in CMakeLists.txt and inclusions. Note that there may be further problems when executing the program if it has been written with expectation of case-insensitive filesystem.</li>\n</ol>\n\n<blockquote>\n  <p>I'm never gonna finish anything</p>\n</blockquote>\n\n<p>Simple solution: Change all filenames to lower case, change all references in CMakeLists.txt and inclusions in source to lower case: No need to perform a comparison or try to figure out include roots. Both can be performed with a short shell script. Although technically not correct because the source files have non-regular grammar, regular expression is probably enough to match include directives.</p>\n"}], "owner": {"reputation": 56, "user_id": 5665324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf43bdf23801234123db31cd9ba12637?s=128&d=identicon&r=PG&f=1", "display_name": "Bendrix", "link": "https://stackoverflow.com/users/5665324/bendrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 59394294, "answer_count": 3, "score": 1, "last_activity_date": 1576683129, "creation_date": 1576678009, "last_edit_date": 1576683129, "question_id": 59393782, "link": "https://stackoverflow.com/questions/59393782/cmake-adding-case-insensitive-source-files", "title": "CMake adding case insensitive source files", "body": "<p>I'm trying to build binaries natively in linux for an existing project with CMakeLists.txt's already built. I keep running into issues where the CMakeLists.txt is trying to add a header or source file but cannot. The source file exists in the directory its looking in but the cases dont match. For example, here is one of the header searches:</p>\n\n<pre><code>set(Headers\n    resource.h\n    stdafx.h\n    ...\n)\n</code></pre>\n\n<p>I had gotten an error saying <code>fatal error: stdafx.h: No such file or directory</code>, yet the file that was in the directory was <code>StdAfx.h</code> instead of <code>stdafx.h</code>. Apparently CMake cannot make the connection that these are the same files.</p>\n\n<p>My issue is, this project file is 6 gb worth of code, and if I have to go in and change the includes for every single mis-capitalized file, I'm never gonna finish anything. Is there a way for me to tell CMake that the file names might have different capitalization? Or am I stuck doing everything by hand until it works.</p>\n\n<p>EDIT:\nIt looks as though its the Linux file system that is case sensitive, so I'm removing the cmake tag, as it is not an issue with cmake. Im looking for a solution that would allow me to change all the <code>#include &lt;....&gt;</code> lines within the .cpp files to match the existing header filenames instead of changing the .h file names.</p>\n\n<p>EDIT: Just for anyone coming to this later, the full error is this:</p>\n\n<pre><code>[ 1%] Building CXX object Source/UeiSimuDriver/CMakeFiles/UeiSimuDriver_vc15.dir/StdAfx.cpp.o\nIn file included from /var/tmp/&lt;workspaceHash&gt;/Framework/Source/UeiSimuDriver/StdAfx.cpp:2 \nfatal error: stdafx.h: No such file or directory\n#include \"stdafx.h\"\ncompilation terminated\n</code></pre>\n"}, {"tags": ["c++", "algorithm", "sorting", "debugging", "mergesort"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 4, "creation_date": 1576679335, "post_id": 59393723, "comment_id": 104977578, "body": "In the <code>else</code> branch of the first <code>while</code> loop in <code>merge</code>, you have used <code>i</code> instead of <code>j</code>. (But please consider reorganizing your code. You have many redundant variables which are often just inclusive upper bounds that complement other data. Make them exclusive, as is customary in C++, and you&#39;ll see that you need only <code>mid</code> and <code>size</code>.)"}, {"owner": {"reputation": 697, "user_id": 2096928, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/du211.png?s=128&g=1", "display_name": "Joel Trauger", "link": "https://stackoverflow.com/users/2096928/joel-trauger"}, "edited": false, "score": 1, "creation_date": 1576683585, "post_id": 59393723, "comment_id": 104980097, "body": "the second half of your <code>mergeSort</code> function isn&#39;t working properly. I copied your code and added some debugging output and when it goes to sort the second half of the array, it fails to actually do anything."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1576684723, "post_id": 59393723, "comment_id": 104980738, "body": "You also forgot to <code>delete[]</code> all the <code>new</code>ed <code>arr</code>s."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11555625"}, "edited": false, "score": 0, "creation_date": 1576685916, "post_id": 59393723, "comment_id": 104981471, "body": "thanks everyone.changing i++ to j++ in the <code>first else</code> solved it. Passed all test cases."}], "answers": [{"tags": [], "owner": {"reputation": 2858, "user_id": 12491175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPSJY.png?s=128&g=1", "display_name": "Zig Razor", "link": "https://stackoverflow.com/users/12491175/zig-razor"}, "is_accepted": true, "score": 2, "last_activity_date": 1576684849, "creation_date": 1576684849, "answer_id": 59395847, "question_id": 59393723, "link": "https://stackoverflow.com/questions/59393723/my-c-merge-sort-code-isnt-working-what-am-i-missing-here/59395847#59395847", "title": "My C++ Merge Sort code isn&#39;t working. What am i missing here?", "body": "<p>You have used i istead of j in the first while loop in merge function. The correct code is the following</p>\n\n<pre><code>while (i &lt;= mid &amp;&amp; j &lt;= ub) { \n        if (input[i] &lt;= input[j]) \n           arr[k++] = input[i++]; \n       else \n           arr[k++] = input[j++];     \n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11555625"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 59395847, "answer_count": 1, "score": 2, "last_activity_date": 1576684849, "creation_date": 1576677818, "last_edit_date": 1576680948, "question_id": 59393723, "link": "https://stackoverflow.com/questions/59393723/my-c-merge-sort-code-isnt-working-what-am-i-missing-here", "title": "My C++ Merge Sort code isn&#39;t working. What am i missing here?", "body": "<p><em>In my code , <code>lb</code> refers to lower bound and <code>ub</code> refers to upper bound.I'm using the <code>mergeSort function</code> to recursively split the array into smaller pieces and the <code>merge function</code> to merge in their sorted order.</em></p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nvoid merge(int input[], int lb, int ub, int size)\n{\n    int i = lb;\n    int k = 0;\n    int mid = (lb + ub) / 2;\n    int j = mid + 1;\n\n    int *arr = new int[size];\n\n    while (i &lt;= mid &amp;&amp; j &lt;= ub)\n    {\n        if (input[i] &lt;= input[j])\n            arr[k++] = input[i++];\n        else\n            arr[k++] = input[i++];\n    }\n    while (i &lt;= mid)\n        arr[k++] = input[i++];\n    while (j &lt;= ub)\n        arr[k++] = input[j++];\n\n    for (k = 0; k &lt; size; k++)\n        input[k] = arr[k];\n}\nvoid mergeSort(int input[], int size)\n{\n    int lb = 0;\n    int ub = size - 1;\n    int mid;\n    if (size == 0)\n    {\n        return;\n    }\n    else if (lb &lt; ub)\n    {\n        mid = (lb + ub) / 2;\n        mergeSort(input, mid - lb + 1);\n        mergeSort(input + mid + 1, ub - mid);\n        merge(input, lb, ub, size);\n    }\n    else\n    {\n        return;\n    }\n}\n\nint main()\n{\n    int input[1000], length;\n    cin &gt;&gt; length;\n    for (int i = 0; i &lt; length; i++)\n        cin &gt;&gt; input[i];\n    mergeSort(input, length);\n    for (int i = 0; i &lt; length; i++)\n    {\n        cout &lt;&lt; input[i] &lt;&lt; \" \";\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "class", "object", "vector"], "comments": [{"owner": {"reputation": 929, "user_id": 4253931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b751517b9a663cda1d8ab07027bb59a?s=128&d=identicon&r=PG&f=1", "display_name": "eike", "link": "https://stackoverflow.com/users/4253931/eike"}, "edited": false, "score": 2, "creation_date": 1576677580, "post_id": 59393566, "comment_id": 104976607, "body": "If you don&#39;t want to store a copy of this object, but the object itself in the vector, this is impossible. For a copy use <code>particles.push_back(*this);</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1576678281, "post_id": 59393566, "comment_id": 104977002, "body": "@eerorika Actually you can, you just can&#39;t use it until the type is complete, which it is inside the constructor: <a href=\"https://timsong-cpp.github.io/cppwp/vector#overview-4\" rel=\"nofollow noreferrer\">timsong-cpp.github.io/cppwp/vector#overview-4</a>"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1576678353, "post_id": 59393566, "comment_id": 104977040, "body": "@NathanOliver-ReinstateMonica Fair enough. But you still cannot define the variable before <i>declaring</i> <code>Particle</code>."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1576678403, "post_id": 59393566, "comment_id": 104977065, "body": "@eerorika Yes, a declaration is at least needed."}], "answers": [{"comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 2, "creation_date": 1576677841, "post_id": 59393717, "comment_id": 104976759, "body": "Note that this will crash and burn spectacularly if you ever stack-allocate a <code>Particle</code> object."}, {"owner": {"reputation": 14052, "user_id": 1513286, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/kUz60.png?s=128&g=1", "display_name": "snoopy", "link": "https://stackoverflow.com/users/1513286/snoopy"}, "edited": false, "score": 0, "creation_date": 1576680416, "post_id": 59393717, "comment_id": 104978213, "body": "<i>crash and burn spectacularly</i>... That is very catchy and should be used everywhere whenever possible :P"}], "tags": [], "owner": {"reputation": 352, "user_id": 3855751, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003005404749/picture?type=large", "display_name": "Matthew Loveday", "link": "https://stackoverflow.com/users/3855751/matthew-loveday"}, "is_accepted": false, "score": 0, "last_activity_date": 1576677791, "creation_date": 1576677791, "answer_id": 59393717, "question_id": 59393566, "link": "https://stackoverflow.com/questions/59393566/how-would-a-object-add-itself-to-a-vector-inside-the-objects-class/59393717#59393717", "title": "How would a object add itself to a vector inside the object&#39;s class?", "body": "<p>If all you need is to push a copy of the particle to the vector, then you can de-reference the <code>this</code> pointer and push that into the vector like so:</p>\n\n<pre><code>particles.push_back(*this)\n</code></pre>\n\n<p>This creates a copy though, and does not refer to the original object it's called from but an entirely new one. If you want to push the original particle to the vector then you would need to make the vector store a <code>Particle*</code>. You could then push the current particle to the vector like so:</p>\n\n<pre><code>std::vector&lt;Particle*&gt; particles;\n\nclass Particle\n{\npublic:\n    Particle(/* Your constructor args */)\n    {\n        particles.push_back(this)\n    }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1576677853, "post_id": 59393728, "comment_id": 104976771, "body": "Note that this will crash and burn spectacularly if you ever stack-allocate a <code>Particle</code> object."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1576678207, "post_id": 59393728, "comment_id": 104976956, "body": "@Botje Plenty of other ways to make a mistake with a stack object, or really any object in C++. Id definitely advise either the <code>emplace_back</code> or <code>make_unique</code> solution."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576679203, "post_id": 59393728, "comment_id": 104977493, "body": "I would advise the &quot;don&#39;t do it in the constructor at all&quot; solution."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1576679315, "post_id": 59393728, "comment_id": 104977561, "body": "@user253751 What, I meant, either <code>particles.emplace_back(position);</code> or <code>particles.push_back(std::make_unique&lt;Particle&gt;(position));</code>. Maybe will see about making it clearer."}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": true, "score": 0, "last_activity_date": 1576678134, "last_edit_date": 1576678134, "creation_date": 1576677824, "answer_id": 59393728, "question_id": 59393566, "link": "https://stackoverflow.com/questions/59393566/how-would-a-object-add-itself-to-a-vector-inside-the-objects-class/59393728#59393728", "title": "How would a object add itself to a vector inside the object&#39;s class?", "body": "<p><code>std::vector&lt;Particle&gt;</code> is storing the particles <em>by value</em>, so it can't add \"itself\" to that vector, it could add a <em>copy</em>, but that is maybe not what you want.</p>\n\n<p><code>emplace_back</code> might be used to construct the Particle into the vector itself:</p>\n\n<pre><code>particles.emplace_back(position); // Will call Particle(position)\n</code></pre>\n\n<p>If you do want a copy, just deference the <code>this</code> pointer, but that could be confusing. Do not do this in the copy/move constructor or copy/move assignment operator, as those can be called by vector itself during an insert/remove/etc.</p>\n\n<pre><code>Particle(sf::Vector2f position)\n{\n    particles.push_back(*this);\n}\n</code></pre>\n\n<p>Otherwise you could store pointers in a vector. That brings extra questions like who is responsible to free them, and for things like a particle system can have a major performance impact.</p>\n\n<pre><code>std::vector&lt;Particle*&gt; particles;\n\nclass Particle\n{\n    public:\n        Particle(sf::Vector2f position)\n        {\n            particles.push_back(this); // Dangerous\n            // If an exception happens after push_back this object will be destroyed,\n            // but particles will still contain that now invalid pointer.\n        }\n};\n\n\n...\n\nauto particle = new Particle(position); // Who deletes this?\n</code></pre>\n\n<p>If particles is responsible for deleting, you might use <code>std::unique_ptr</code>, but doing so in the constructor is potentially unsafe.</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;Particle&gt;&gt; particles;\n\nclass Particle\n{\n    public:\n        Particle(sf::Vector2f position)\n        {\n            particles.push_back(std::unique_ptr&lt;Particle&gt;(this)); // Dangerous\n            // If an exception happens in push_back or after this in the constructor\n            // the exception will cause this Particle to be destroyed, but this unique_ptr\n            // will be left with an invalid pointer, and try and delete it as well.\n        }\n};\n\n\n...\n\nnew Particle(position);\n</code></pre>\n\n<p>Better to do it outside, in some other function.</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;Particle&gt;&gt; particles;\n\nclass Particle\n{\n    public:\n        Particle(sf::Vector2f position)\n        {}\n};\n...\nparticles.push_back(std::make_unique&lt;Particle&gt;(position));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1576678750, "creation_date": 1576678750, "answer_id": 59394012, "question_id": 59393566, "link": "https://stackoverflow.com/questions/59393566/how-would-a-object-add-itself-to-a-vector-inside-the-objects-class/59394012#59394012", "title": "How would a object add itself to a vector inside the object&#39;s class?", "body": "<p>I would suggest that you bail on all the answers so far; and create a new wrapping class; as I think fundamentally your design is weak.</p>\n\n<pre><code>class Particle {};\n\nstruct ParticleGroup {\n    Particle&amp; createParticle() {\n        particles.push_back(Particle());\n        return particles.back();\n    }\n\n    std::vector&lt;Particle&gt; particles;\n};\n</code></pre>\n\n<p>The joy of doing this is that you can now create a particle that doesn't get rammed into your vector by force (which may be useful for testing/serialisation/other uses); but you've made it so that if you go to your particle group; you don't have to worry about how the particle is stored.  (for example when you realise that you actually want a list because of the random removes; you don't want to have to re-write everything!)</p>\n"}], "owner": {"reputation": 13, "user_id": 12559037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0b9ec5debfa7c60d39b8460a004448?s=128&d=identicon&r=PG&f=1", "display_name": "nomodeset", "link": "https://stackoverflow.com/users/12559037/nomodeset"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59393728, "answer_count": 3, "score": 1, "last_activity_date": 1576678750, "creation_date": 1576677353, "question_id": 59393566, "link": "https://stackoverflow.com/questions/59393566/how-would-a-object-add-itself-to-a-vector-inside-the-objects-class", "title": "How would a object add itself to a vector inside the object&#39;s class?", "body": "<p>I'm pretty new with classes.</p>\n\n<p>How would the Particle add itself into a std::vector inside the class? </p>\n\n<p>My code:</p>\n\n<pre><code>std::vector&lt;Particle&gt; particles;\n\nclass Particle\n{\n    public:\n        Particle(sf::Vector2f position)\n        {\n            particles.push_back(/*add this Particle into vector particles*/);\n        }\n};\n</code></pre>\n"}, {"tags": ["c++", "optimization", "customization", "hashcode", "unordered-set"], "comments": [{"owner": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576679622, "post_id": 59393531, "comment_id": 104977752, "body": "What do you mean by &quot;Anyway it falls to calling GET_CurrX() which returns XVector.&quot; ?"}, {"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "reply_to_user": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576679868, "post_id": 59393531, "comment_id": 104977896, "body": "@foolo - Umm, I mean anyway instances comparison made by comparing <code>XVectors</code>. In first case I call <code>GET_CurrX()</code> by myself and use <code>XVectors</code> as keys, in second case I use <code>TaskCases</code> as key, but the comparison still made by calling <code>GET_CurrX()</code>."}, {"owner": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576682204, "post_id": 59393531, "comment_id": 104979258, "body": "OK. Only reason I can think of is that the hash function causes more hash collisions in the second case, otherwise they look identical. (or it could be the GET_CurrX calls, but that seems unlikely, if GET_CurrX is only a get function). But it&#39;s hard to answer without having an example. You could probably try to simplify the code and then try to produce a minimal example that still has the difference."}, {"owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "reply_to_user": {"reputation": 827, "user_id": 961254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7868d9f231713ae3d68107a2f284bf73?s=128&d=identicon&r=PG", "display_name": "foolo", "link": "https://stackoverflow.com/users/961254/foolo"}, "edited": false, "score": 0, "creation_date": 1576683432, "post_id": 59393531, "comment_id": 104980019, "body": "@foolo - Thank you for trying to help. I will see what I can do."}], "owner": {"reputation": 3573, "user_id": 1154283, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1d79d329fe43d6492dcc90d2cc46e460?s=128&d=identicon&r=PG", "display_name": "Kosmo\u96f6", "link": "https://stackoverflow.com/users/1154283/kosmo%e9%9b%b6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576677753, "creation_date": 1576677229, "last_edit_date": 1576677753, "question_id": 59393531, "link": "https://stackoverflow.com/questions/59393531/the-reason-behind-huge-performance-difference-between-two-custom-key-implementat", "title": "The reason behind huge performance difference between two custom key implementations for std::unordered_set and how to fix it?", "body": "<p>I have some simple class with several fields like this:</p>\n\n<pre><code>#ifndef XVector_h\n#define XVector_h\n\nstruct XVFields\n{\n    unsigned char JointPromosCountSinceBeginning;\n    unsigned char PromoWeeksCountSinceCurrPromoBeginning;\n    unsigned char NoPromoWeeksCountSinceLastJointPromo;\n    bool IsPromo;\n};\n\nclass XVector\n{\npublic:\n    XVFields XVFs;\n    unsigned char *DiscountUsagesCounts;\n\n    XVector();\n    ~XVector();    \n};\n\n#endif XVector_h\n</code></pre>\n\n<p>It's realization:</p>\n\n<pre><code>#include &lt;sstream&gt;\n#include \"XVector.h\"\n#include \"DynProgTask.h\"\n\nXVector::XVector()\n{\n    memset(&amp;this-&gt;XVFs, 0, sizeof(XVFields));\n    this-&gt;DiscountUsagesCounts = (unsigned char*)malloc(DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/);\n    memset(this-&gt;DiscountUsagesCounts, 0, DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/);\n    this-&gt;UniqueValForHuman_private = NULL;\n}\n\nXVector::~XVector()\n{\n    free(this-&gt;DiscountUsagesCounts);\n}\n</code></pre>\n\n<p>I Have another class named <code>TaskCase</code> that has <code>XVector</code> as one of it's field. Single <code>TaskCase</code> - single <code>XVector</code>.</p>\n\n<p>I have custom hashers and comparators for both of classes:</p>\n\n<pre><code>#ifndef XVectorHasher_h\n#define XVectorHasher_h\n\n#include &lt;Windows.h&gt;\n#include \"XVector.h\"\n\nstruct XVectorHasher\n{\n    size_t operator()(const XVector *k) const;\n};\n\nstruct XVectorComparator\n{\n    bool operator()(const XVector *xv1, const XVector *xv2) const;\n};\n\n#endif XVectorHasher_h\n</code></pre>\n\n<p>cpp:</p>\n\n<pre><code>#include \"XVectorHasher.h\"\n#include \"DynProgTask.h\"\n\nsize_t XVectorHasher::operator()(const XVector *k) const\n{\n    size_t result = 0;\n    const size_t prime = 31;\n\n    int unibytes_count = sizeof(XVFields) + (DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/);\n    unsigned char *unibytes = (unsigned char*)malloc(unibytes_count);\n    memcpy(unibytes, &amp;k-&gt;XVFs, sizeof(XVFields));\n    memcpy(&amp;unibytes[sizeof(XVFields)], k-&gt;DiscountUsagesCounts, DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/);\n\n    for (size_t i = 0; i &lt; unibytes_count; i++)\n        result = unibytes[i] + (result * prime);\n\n    free(unibytes);\n\n    return result;\n}\n\nbool XVectorComparator::operator()(const XVector *xv1, const XVector *xv2) const\n{   \n    //this operator compares instances bytes to determine their equality\n    if (memcmp(&amp;xv1-&gt;XVFs, &amp;xv2-&gt;XVFs, sizeof(XVFields)) != 0)\n        return false;\n\n    if (memcmp(xv1-&gt;DiscountUsagesCounts, xv2-&gt;DiscountUsagesCounts, DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/) != 0)\n        return false;\n\n    return true;\n}\n</code></pre>\n\n<p>Another h:</p>\n\n<pre><code>#ifndef TaskCaseHasher_h\n#define TaskCaseHasher_h\n\n#include &lt;Windows.h&gt;\n#include \"TaskCase.h\"\n\nstruct TaskCaseHasher\n{\n    size_t operator()(const TaskCase *k) const;\n};\n\nstruct TaskCaseComparator\n{\n    bool operator()(const TaskCase *xv1, const TaskCase *xv2) const;\n};\n\n\n#endif TaskCaseHasher_h\n</code></pre>\n\n<p>Another cpp:</p>\n\n<pre><code>#include \"XVector.h\"\n#include \"TaskCaseHasher.h\"\n#include \"DynProgTask.h\"\n\nsize_t TaskCaseHasher::operator()(const TaskCase *tc) const\n{\n    size_t result = 0;\n    const size_t prime = 31;\n    XVector *k = const_cast&lt;TaskCase*&gt;(tc)-&gt;GET_CurrX();\n\n    int unibytes_count = sizeof(XVFields) + (DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/);\n    unsigned char *unibytes = (unsigned char*)malloc(unibytes_count);\n    memcpy(unibytes, &amp;k-&gt;XVFs, sizeof(XVFields));\n    memcpy(&amp;unibytes[sizeof(XVFields)], k-&gt;DiscountUsagesCounts, DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/);\n\n    for (size_t i = 0; i &lt; unibytes_count; i++)\n        result = unibytes[i] + (result * prime);\n\n    free(unibytes);\n\n    return result;\n}\n\nbool TaskCaseComparator::operator()(const TaskCase *tc1, const TaskCase *tc2) const\n{\n    //this operator compares instances bytes to determine their equality\n    XVector *xv1 = const_cast&lt;TaskCase*&gt;(tc1)-&gt;GET_CurrX();\n    XVector *xv2 = const_cast&lt;TaskCase*&gt;(tc2)-&gt;GET_CurrX();\n\n    if (memcmp(&amp;xv1-&gt;XVFs, &amp;xv2-&gt;XVFs, sizeof(XVFields)) != 0)\n        return false;\n\n    if (memcmp(xv1-&gt;DiscountUsagesCounts, xv2-&gt;DiscountUsagesCounts, DynProgTask::PresetUsCount/* * sizeof(unsigned char)*/) != 0)\n        return false;\n\n    return true;\n}\n</code></pre>\n\n<p>I have self made single directional list of <code>TaskCase</code> pointers. I iterate over them to find unique <code>TaskCases</code> (the ones which has different XVectors).</p>\n\n<p>I have two different functions for that:</p>\n\n<pre><code>SmartArray&lt;TaskCase*&gt; *TaskStep::GET_UniqueCasesByCurrX() //This one doing it's job in 191 second\n{\n    SmartArray&lt;TaskCase*&gt; *unitcs = new SmartArray&lt;TaskCase*&gt;(this-&gt;Cases-&gt;Length);\n    std::unordered_set&lt;XVector*, XVectorHasher, XVectorComparator&gt; unique_xs;\n    int curr_unique_case_i = 0;\n\n    for (TaskCase *itr = this-&gt;Cases-&gt;Head; itr; itr = itr-&gt;NEXT_CASE_PTR)\n        if (unique_xs.find(itr-&gt;GET_CurrX()) == unique_xs.end())\n        {\n            unique_xs.insert(itr-&gt;GET_CurrX());\n            unitcs-&gt;Data[curr_unique_case_i] = itr;\n            curr_unique_case_i++;\n        }   \n\n    unitcs-&gt;Resize(curr_unique_case_i);\n\n    return unitcs;\n}\n\nstd::unordered_set&lt;TaskCase*, TaskCaseHasher, TaskCaseComparator&gt; *TaskStep::GET_UniqueCasesSetByCurrX() //This one doing it's job in 363 seconds\n{\n    std::unordered_set&lt;TaskCase*, TaskCaseHasher, TaskCaseComparator&gt; *unique_tcs = new std::unordered_set&lt;TaskCase*, TaskCaseHasher, TaskCaseComparator&gt;();\n\n    for (TaskCase *itr = this-&gt;Cases-&gt;Head; itr; itr = itr-&gt;NEXT_CASE_PTR)\n        if (unique_tcs-&gt;find(itr) == unique_tcs-&gt;end())\n            unique_tcs-&gt;insert(itr);    \n\n    return unique_tcs;\n}\n</code></pre>\n\n<p><code>std::unordered_set</code> based on XVectors (191 sec) is way faster than <code>std::unordered_set</code> based on TaskCases (363 sec).\nBut I don't understand why. Anyway it falls to calling <code>GET_CurrX()</code> which returns <code>XVector</code>. In first case I can it by myself and in second case it called automatically inside set. What is possible to do to speedup <code>TaskCase</code> set?</p>\n"}, {"tags": ["c++", "amazon-web-services", "http", "aws-lambda"], "answers": [{"comments": [{"owner": {"reputation": 1327, "user_id": 14267427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHH2F.png?s=128&g=1", "display_name": "Tyler2P", "link": "https://stackoverflow.com/users/14267427/tyler2p"}, "edited": false, "score": 0, "creation_date": 1607074529, "post_id": 65140702, "comment_id": 115163463, "body": "Note: answers that are very brief and/or are questions back to the poster should probably be comments. You only need 50 rep points to comment under a question - could you move this there?"}], "tags": [], "owner": {"reputation": 11, "user_id": 11410920, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EiZ9dwNVc-8/AAAAAAAAAAI/AAAAAAAAA_w/-zjgfB2apws/photo.jpg?sz=128", "display_name": "Venkatesh Hiremath", "link": "https://stackoverflow.com/users/11410920/venkatesh-hiremath"}, "is_accepted": false, "score": 0, "last_activity_date": 1607072862, "creation_date": 1607072862, "answer_id": 65140702, "question_id": 59393530, "link": "https://stackoverflow.com/questions/59393530/invoke-c-lambda-runtime-by-https/65140702#65140702", "title": "Invoke c++ Lambda Runtime by https", "body": "<p>please follow this link <a href=\"https://aws.amazon.com/blogs/compute/introducing-the-c-lambda-runtime/\" rel=\"nofollow noreferrer\">c++ runtime for aws lambda</a></p>\n<p>for invocation using postman or curl  https://&lt;api_url&gt;/default/&lt;function_name&gt;</p>\n"}], "owner": {"reputation": 4401, "user_id": 1281264, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/10501b5548f74ef7aa4100091d8e7fc6?s=128&d=identicon&r=PG", "display_name": "StereoMatching", "link": "https://stackoverflow.com/users/1281264/stereomatching"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1607072862, "creation_date": 1576677228, "question_id": 59393530, "link": "https://stackoverflow.com/questions/59393530/invoke-c-lambda-runtime-by-https", "title": "Invoke c++ Lambda Runtime by https", "body": "<p>I follow the example of <a href=\"https://aws.amazon.com/blogs/compute/introducing-the-c-lambda-runtime/\" rel=\"nofollow noreferrer\">this page</a> to create a hello world example.</p>\n\n<pre><code>#include &lt;aws/lambda-runtime/runtime.h&gt;\n\nusing namespace aws::lambda_runtime;\n\ninvocation_response my_handler(invocation_request const&amp; request)\n{\n   return invocation_response::success(\"Hello, World!\", \"application/json\");\n}\n\nint main()\n{\n   run_handler(my_handler);\n   return 0;\n}\n</code></pre>\n\n<p>I can invoke the function by awscli, so good so far. But when I try to invoke it with https api, the server always give me error message \"Internal server error\" and I cannot find any useful message from the cloud watch.</p>\n\n<p>I create the api gateway with following steps</p>\n\n<p>\"Add trigger->API gateway->creating new api->open(security)\". </p>\n\n<p><a href=\"https://i.stack.imgur.com/Vo8W2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vo8W2.png\" alt=\"enter image description here\"></a></p>\n\n<p>After that I copy the api, and start a post request by python.</p>\n\n<pre><code>requests.post(\"https://blahblah\", json={})\n</code></pre>\n\n<p>The other lambda functions written by python work with the api gateway, but it don't work with the lambda function written by c++ api, what do I miss?Thanks</p>\n"}, {"tags": ["c++", "constructor", "initialization", "overloading", "auto"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 2, "creation_date": 1576676808, "post_id": 59393369, "comment_id": 104976201, "body": "I believe you cannot use <code>auto</code> for class members at all? Relevant but outdated question: <a href=\"https://stackoverflow.com/questions/18199728/is-it-possible-to-have-an-auto-member-variable\">Is it possible to have an \u201cauto\u201d member variable?</a>"}, {"owner": {"reputation": 1274, "user_id": 5483193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c2bb28b62bf9fc8c2cf9422691e066d?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy R.T.", "link": "https://stackoverflow.com/users/5483193/jimmy-r-t"}, "edited": false, "score": 0, "creation_date": 1576758544, "post_id": 59393369, "comment_id": 105006636, "body": "Any reason not to use templates?"}, {"owner": {"reputation": 812, "user_id": 5330834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Up5x.png?s=128&g=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5330834/jake"}, "edited": false, "score": 0, "creation_date": 1576759275, "post_id": 59393369, "comment_id": 105007004, "body": "With python, types are determined on each operation at runtime - that requires overhead, but allows variable types to change from one statement to the next. In C++ the types need to be known in advance, so that code can compile - float and int have different binary layouts and require different assembly instructions to work with. If you want flexibility at runtime, you need to use a union type such as variant that chooses one of many branches containing valid code for each type, adding performance overhead. If you want to keep the int and float versions separate, templates are your friend."}], "answers": [{"comments": [{"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1576758179, "post_id": 59393408, "comment_id": 105006448, "body": "<code>union</code> is an error-prone low-level mechanism. <code>variant</code> probably uses it internally and makes its usage safer."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2695, "user_id": 3096657, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/100001008411462/picture?type=large", "display_name": "wondra", "link": "https://stackoverflow.com/users/3096657/wondra"}, "edited": false, "score": 0, "creation_date": 1576758280, "post_id": 59393408, "comment_id": 105006500, "body": "@wondra union by itself wouldn&#39;t be very useful since it cannot be inspected for which member is currently active. It is also very painful to use with non trivial classes (which have custom destructor)  such as std::string. What one would want is a <i>tagged</i> union. Which is the datastructure that std::variant implements."}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 1, "creation_date": 1576758527, "post_id": 59393408, "comment_id": 105006628, "body": "libstdc++&#39;s <code>variant</code> <a href=\"https://github.com/gcc-mirror/gcc/blob/892d6439d39997cccf41302187fc56bdbbca1e6f/libstdc%2B%2B-v3/include/std/variant#L333\" rel=\"nofollow noreferrer\">does</a> use <code>union</code>. The alternative, using raw memory and placement new, can&#39;t be used in a <code>constexpr</code> constructor."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1576758783, "post_id": 59393408, "comment_id": 105006741, "body": "@Erlkoenig fair enough, I take back what I said. I had only looked at boosts implementation, which didn&#39;t use union, and assumed that everyone did the same."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 17, "last_activity_date": 1576686380, "last_edit_date": 1576686380, "creation_date": 1576676844, "answer_id": 59393408, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c/59393408#59393408", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<blockquote>\n  <p>Initialising a variable of unknown type via overloaded constructors in C++</p>\n</blockquote>\n\n<p>There is no such thing as \"variable of unknown type\" in C++.</p>\n\n<blockquote>\n  <p>What is the right way of using the auto keyword in this scenario?</p>\n</blockquote>\n\n<p>auto-deduced variables have a type that is deduced from the initialiser. If there is no initialiser, then you cannot use auto. auto cannot be used for a non-static member variable. One instance of a class cannot have differently typed members than another instance.</p>\n\n<p>There is no way of using auto keyword in this scenario.</p>\n\n<blockquote>\n  <p>Should I use a different approach altogether?</p>\n</blockquote>\n\n<p>Probably. It looks like you're trying to implement a <code>std::variant</code>. If you need a variable to store one of X number of types, that is what you should use.</p>\n\n<p>However, you may be trying to emulate dynamic typing in C++. While it may be familiar to you due to experience with Python, in many cases that is not the ideal approach. For instance, in this particular example program, all that you do with the member variable is print it. So it would be simpler to store a string in each case. Other approaches are <a href=\"https://stackoverflow.com/a/59393647/2079303\">static polymorphism</a> as shown by Rhathin or OOP style <a href=\"https://stackoverflow.com/a/59393538/2079303\">dynamic polymorphism</a> as shown by Fire Lancer.</p>\n"}, {"tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": false, "score": 1, "last_activity_date": 1576677247, "creation_date": 1576677247, "answer_id": 59393538, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c/59393538#59393538", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<p><code>auto</code> must be deducible to a specific type, it doesn't provide runtime dynamic typing.</p>\n\n<p>If at the time of declaring <code>Token</code> you know all the possible types you can use <code>std::variant&lt;Type1, Type2, Type3&gt;</code> etc. This is similar to having a \"type enum\" and a \"union\". It makes sure proper constructors and destructors get called.</p>\n\n<pre><code>std::variant&lt;int, std::string&gt; v;\nv = \"example\";\nv.index(); // 1, a int would be 0\nstd::holds_alternative&lt;std::string&gt;(v); // true\nstd::holds_alternative&lt;int&gt;(v); // false\nstd::get&lt;std::string&gt;(v); // \"example\"\nstd::get&lt;int&gt;(v); // throws std::bad_variant_access\n</code></pre>\n\n<p>An alternative could be to create a different <code>Token</code> subtype for each case (possibly using templates) with suitable virtual methods.</p>\n\n<pre><code>class Token {\npublic:\n    virtual void printValue()=0;\n};\n\nclass IntToken : public Token {\npublic:\n    int value;\n    IntToken(int ivalue) {\n        value = ivalue;\n    }\n    virtual void printValue()override\n    {\n        std::cout &lt;&lt; \"The token value is: \" &lt;&lt; value &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1140, "user_id": 9252020, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PDrj2.jpg?s=128&g=1", "display_name": "Rhathin", "link": "https://stackoverflow.com/users/9252020/rhathin"}, "is_accepted": false, "score": 6, "last_activity_date": 1576677882, "last_edit_date": 1576677882, "creation_date": 1576677552, "answer_id": 59393647, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c/59393647#59393647", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<p>Different approach, than what others have proposed, is to use templates. Here is an example:</p>\n\n<pre><code>template&lt;class T&gt;\nclass Token {\npublic:\n\n    T value;\n\n    Token(T value) :\n        value(std::move(value))\n    {}\n\n    void printValue() {\n        std::cout &lt;&lt; \"The token value is: \" &lt;&lt; value &lt;&lt; std::endl;\n    }\n};\n</code></pre>\n\n<p>Then you can use your class like this:</p>\n\n<pre><code>Token&lt;int&gt; x(5);\nx.printValue();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1576686449, "post_id": 59393702, "comment_id": 104981772, "body": "Probably better to use <code>std::visit</code> instead of <code>switch</code>."}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": false, "score": 3, "last_activity_date": 1576677733, "creation_date": 1576677733, "answer_id": 59393702, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c/59393702#59393702", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<p>You can use the <code>std::variant</code> type. The code below shows one way (but it's a bit clumsy, I have to admit):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;variant&gt;\n\nclass Token {\npublic:\n\n    std::variant&lt;int, float, std::string&gt; value;\n\n    Token(int ivalue) {\n        value = ivalue;\n    }\n    Token(float fvalue) {\n        value = fvalue;\n    }\n    Token(std::string svalue) {\n        value = svalue;\n    }\n\n    void printValue() {\n        switch (value.index()) {\n            case 0:\n                std::cout &lt;&lt; \"The token value is: \" &lt;&lt; std::get&lt;0&gt;(value) &lt;&lt; std::endl;\n                break;\n            case 1:\n                std::cout &lt;&lt; \"The token value is: \" &lt;&lt; std::get&lt;1&gt;(value) &lt;&lt; std::endl;\n                break;\n            case 2:\n                std::cout &lt;&lt; \"The token value is: \" &lt;&lt; std::get&lt;2&gt;(value) &lt;&lt; std::endl;\n                break;\n        }\n    }\n};\n\nint main() {\n    Token it(1);\n    Token ft(2.2f);\n    Token st(\"three\");\n    it.printValue();\n    ft.printValue();\n    st.printValue();\n    return 0;\n}\n</code></pre>\n\n<p>It would be much nicer if the <code>std::get&lt;0&gt;(value)</code> could be written as <code>std::get&lt;value.index()&gt;(value)</code> but, alas, the \"x\" in <code>&lt;x&gt;</code> has to be a compile-time constant expression.</p>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 12357077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c950d7df91be91188252ecba362b9acd?s=128&d=identicon&r=PG&f=1", "display_name": "KimHajun", "link": "https://stackoverflow.com/users/12357077/kimhajun"}, "is_accepted": false, "score": 11, "last_activity_date": 1576677979, "creation_date": 1576677979, "answer_id": 59393774, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c/59393774#59393774", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<p>C++ is a <a href=\"https://android.jlelse.eu/magic-lies-here-statically-typed-vs-dynamically-typed-languages-d151c7f95e2b\" rel=\"noreferrer\">statically typed language</a>, meaning that all variable types are determined before runtime. Therefore, <code>auto</code> keyword is not something like <code>var</code> keyword in javascript, which is a dynamically typed language. <code>auto</code> keyword is commonly used to specify types that are unnecessarily complex.</p>\n\n<p>What you are looking for might be done by using C++ template class instead, which allows creating multiple versions of the class that takes different types. </p>\n\n<p>This code might be the answer you're looking for. </p>\n\n<pre><code>template &lt;typename T&gt;\nclass Token {\nprivate:\n    T value;\n\npublic:\n    Token(const T&amp; ivalue) {\n        value = ivalue;\n    }\n\n    void printValue() {\n        std::cout &lt;&lt; \"The token value is: \" &lt;&lt; value &lt;&lt; std::endl;\n    }\n};\n</code></pre>\n\n<p>This code would compile if some conditions are met, like the function<code>operator&lt;&lt;</code> should be defined for std::ostream&amp; and type T. </p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 0, "last_activity_date": 1576745715, "creation_date": 1576745715, "answer_id": 59406182, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c/59406182#59406182", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<p>The solution below is similar in spirit to the one in Fire Lancer's answer. It's key difference is that it follows the comment <em>possibly using templates</em>, and thus removes the need to explicitly created derived instances of the interface. <code>Token</code> is not itself the interface class. Instead, it defines the interface as an inner class, and an inner template class to automate the definition of the derived classes.</p>\n\n<p>It's definition appears overly complex. However, <code>Token::Base</code> defines the interface, and <code>Token::Impl&lt;&gt;</code> derives from the interface. These inner classes are entirely hidden to the user of <code>Token</code>. The usage would look like:</p>\n\n<pre><code>Token s = std::string(\"hello\");\nToken i = 7;\n\nstd::cout &lt;&lt; \"The token value is: \" &lt;&lt; s &lt;&lt; '\\n';\nstd::cout &lt;&lt; \"The token value is: \" &lt;&lt; i &lt;&lt; '\\n';\n</code></pre>\n\n<p>Also, the solution below illustrates how one might implement a conversion operator to assign a <code>Token</code> instance to a regular variable. It relies on <code>dynamic_cast</code>, and will throw an exception if the cast in invalid.</p>\n\n<pre><code>int j = i; // Allowed\nint k = s; // Throws std::bad_cast\n</code></pre>\n\n<p>The definition of <code>Token</code> is below.</p>\n\n<pre><code>class Token {\n\n    struct Base {\n        virtual ~Base () = default;\n        virtual std::ostream &amp; output (std::ostream &amp;os) = 0;\n    };\n\n    template &lt;typename T&gt;\n    struct Impl : Base {\n        T val_;\n        Impl (T v) : val_(v) {}\n        operator T () { return val_; }\n        std::ostream &amp; output (std::ostream &amp;os) { return os &lt;&lt; val_; }\n    };\n\n    mutable std::unique_ptr&lt;Base&gt; impl_;\n\npublic:\n\n    template &lt;typename T&gt;\n    Token (T v) : impl_(std::make_unique&lt;Impl&lt;T&gt;&gt;(v)) {}\n\n    template &lt;typename T&gt;\n    operator T () const { return dynamic_cast&lt;Impl&lt;T&gt;&amp;&gt;(*impl_); }\n\n    friend auto &amp; operator &lt;&lt; (std::ostream &amp;os, const Token &amp;t) {\n        return t.impl_-&gt;output(os);\n    }\n};\n</code></pre>\n\n<p><a href=\"https://tio.run/##lVLBjpswEL3zFSMqZUnVrXqrBJRDb71zXClyzOzGDdjUHq8URemvp2MbAuketuWEZt68ee@N5Tg@vkh5/aC07H2HUCvjyKIYmmypDTgYe1pXGKP0S3OVvXAOWnNEDecsA/645SXBd@GQSzB9r8qSFz38jvViC9@gw2fhe6reYBx1ZTnJgA0YT6MnKO7LxgWOL2n6UqXdhMPYC2KBdBpRiwGhbdaqfnAfyr/FtfAq@t0iJKIKrm4ZG1oF/50vt74Z0QoylgfZyRkskrc6kcAC@2cfNwbjoK7veGZngyex7zFxeq1@edyNZOvgpAHFgll/Nvp9r2T5XhjpXrPBOJxUDeKIu8RehxDqtmnYezT/Dud9JtJoR4uv7sRQJXdSOJqJN03xMa7eBq@R49kq1B0ITybkNTNyJG9C@zStSFY2tF2dc1pKnyP9Y5OCLzjp6bVkl@qqNMEglI4XXKXi@FXFZemJF/kB@97k02jCKMZ8rebnzljJK4LMvD0gUMTwET2CciXkoRMP@/CkH6r/mVLLVBwLon/ycpVYyJ5WtkPzGNRPLkEKkgcoUlBx41508QawwXVg92oc7wdtCIQOnE86v8V2/QM\" rel=\"nofollow noreferrer\" title=\"C++ (gcc) \u2013 Try It Online\">Try it online!</a></p>\n"}], "owner": {"reputation": 835, "user_id": 4126814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d55cec5e2e233e35133b3099c2cc55?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4126814/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1480, "favorite_count": 1, "accepted_answer_id": 59393408, "answer_count": 6, "score": 22, "last_activity_date": 1576745715, "creation_date": 1576676694, "question_id": 59393369, "link": "https://stackoverflow.com/questions/59393369/initialising-a-variable-of-unknown-type-via-overloaded-constructors-in-c", "title": "Initialising a variable of unknown type via overloaded constructors in C++", "body": "<p>coming from a primarily python background I have somewhat struggled with working with types in C++.</p>\n\n<p>I am attempting to initialise a class variable via one of several overloaded constructors that take different types as parameters. I have read that using the <code>auto</code> keyword can be used for auto declaration of a variable, however in my case it will not be initialised till a constructor is chosen. However the compiler is not happy about not initialising <code>value</code>.</p>\n\n<pre><code>class Token {\npublic:\n\n    auto value;\n\n    Token(int ivalue) {\n        value = ivalue;\n    }\n    Token(float fvalue) {\n        value = fvalue;\n    }\n    Token(std::string svalue) {\n        value = svalue;\n    }\n\n    void printValue() {\n        std::cout &lt;&lt; \"The token value is: \" &lt;&lt; value &lt;&lt; std::endl;\n    }\n};\n</code></pre>\n\n<p>In python this might look like:</p>\n\n<pre><code>class Token():\n        def __init__(self, value):\n             self.value = value\n\n        def printValue(self):\n             print(\"The token value is: %s\" % self.value)\n</code></pre>\n\n<p>What is the right way of using the <code>auto</code> keyword in this scenario? Should I use a different approach altogether?</p>\n"}, {"tags": ["c++", "linker", "gnu"], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1576676639, "creation_date": 1576676639, "answer_id": 59393354, "question_id": 59393235, "link": "https://stackoverflow.com/questions/59393235/if-both-shared-and-dynamic-libraries-are-present-linker-will-prefer-which-libra/59393354#59393354", "title": "if both shared and dynamic libraries are present, linker will prefer which library?", "body": "<p>If the linker is a variant of ld then it will prefer shared objects over archives. From the <a href=\"https://sourceware.org/binutils/docs/ld/Options.html\" rel=\"nofollow noreferrer\">documentation</a> of the <code>-l</code> flag, emphasis mine:</p>\n\n<blockquote>\n  <p>-l <em>namespec</em><br>\n  --library=<em>namespec</em></p>\n  \n  <p>Add the archive or object file specified by namespec to the list of\n  files to link. This option may be used any number of times. If\n  namespec is of the form :<em>filename</em>, ld will search the library path\n  for a file called <em>filename</em>, otherwise it will search the library\n  path for a file called lib<em>namespec</em>.a.</p>\n  \n  <p>On systems which support shared libraries, ld may also search for\n  files other than lib<em>namespec</em>.a. Specifically, on ELF and SunOS\n  systems, <strong>ld will search a directory for a library called\n  lib<em>namespec</em>.so before searching for one called lib<em>namespec</em>.a</strong>.\n  (By convention, a .so extension indicates a shared library.) Note that\n  this behavior does not apply to :<em>filename</em>, which always specifies a\n  file called <em>filename</em>.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 6880692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJdoQ.jpg?s=128&g=1", "display_name": "rvk", "link": "https://stackoverflow.com/users/6880692/rvk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576676639, "creation_date": 1576676244, "question_id": 59393235, "link": "https://stackoverflow.com/questions/59393235/if-both-shared-and-dynamic-libraries-are-present-linker-will-prefer-which-libra", "title": "if both shared and dynamic libraries are present, linker will prefer which library?", "body": "<p>same options can be used for both statically linking and dynamically linking a library.\n$(CC) $(CFLAGS) -L$(PATH_TO_LIB) -l$(library name) -o output-file-name</p>\n\n<p>If my PATH_TO_LIB contains both the .a and .so file, which one will linker prefer to?</p>\n"}, {"tags": ["c++", "constexpr"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 1, "creation_date": 1576676036, "post_id": 59393126, "comment_id": 104975776, "body": "You can&#39;t use the <code>std::string</code> constructor for <code>constexpr</code> expressions."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1576676039, "post_id": 59393126, "comment_id": 104975781, "body": "<code>std::string</code> is <b>not</b> <code>constexpr</code>."}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576676259, "post_id": 59393126, "comment_id": 104975895, "body": "(<code>std::string_view</code> is <code>constexpr</code>, but not sure how much that helps here.)"}, {"owner": {"reputation": 598, "user_id": 1734357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gaD24.jpg?s=128&g=1", "display_name": "WurmD", "link": "https://stackoverflow.com/users/1734357/wurmd"}, "reply_to_user": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576676331, "post_id": 59393126, "comment_id": 104975939, "body": "@MaxLanghof, it may help, but can&#39;t test it as at present I don&#39;t have C++17"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 0, "creation_date": 1576677598, "post_id": 59393126, "comment_id": 104976619, "body": "@WurmD What C++ version do you have then? 11? 14? 03? Please add the corresponding tag to make sure that any answers actually help you."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1576678020, "post_id": 59393126, "comment_id": 104976855, "body": "BTW, why only those 1024 and not all the 16M ones? Memory space?"}, {"owner": {"reputation": 22348, "user_id": 9528746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ukFe1.png?s=128&g=1", "display_name": "Max Langhof", "link": "https://stackoverflow.com/users/9528746/max-langhof"}, "edited": false, "score": 1, "creation_date": 1576679479, "post_id": 59393126, "comment_id": 104977660, "body": "Here is a great explanation + library to do this (minus the conversion from int) in C++11: <a href=\"https://akrzemi1.wordpress.com/2017/06/28/compile-time-string-concatenation/\" rel=\"nofollow noreferrer\">akrzemi1.wordpress.com/2017/06/28/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 3685378, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/97c9ff805f34ddca918c048eddea993f?s=128&d=identicon&r=PG&f=1", "display_name": "Schnappi", "link": "https://stackoverflow.com/users/3685378/schnappi"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1576676922, "post_id": 59393382, "comment_id": 104976265, "body": "True but he doesn&#39;t have to use operator+ because &quot;255;&quot; &quot;NUMBER&quot; &quot;;0&quot; is a valid C++ expression"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1576676988, "post_id": 59393382, "comment_id": 104976301, "body": "Literal concatenation and <code>std::string</code>? How does this go together?"}, {"owner": {"reputation": 115, "user_id": 3685378, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/97c9ff805f34ddca918c048eddea993f?s=128&d=identicon&r=PG&f=1", "display_name": "Schnappi", "link": "https://stackoverflow.com/users/3685378/schnappi"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1576677124, "post_id": 59393382, "comment_id": 104976364, "body": "Yea I meant not using std::string for colors member variable. He can still use the StringBuilder from the link I posted. He will have access to length and easily construct std::string from const char * if he wants to"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1576677170, "post_id": 59393382, "comment_id": 104976389, "body": "Though, the template machinery you linked might be sufficient. Scaring... ;-)"}], "tags": [], "owner": {"reputation": 115, "user_id": 3685378, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/97c9ff805f34ddca918c048eddea993f?s=128&d=identicon&r=PG&f=1", "display_name": "Schnappi", "link": "https://stackoverflow.com/users/3685378/schnappi"}, "is_accepted": false, "score": 2, "last_activity_date": 1576764604, "last_edit_date": 1576764604, "creation_date": 1576676734, "answer_id": 59393382, "question_id": 59393126, "link": "https://stackoverflow.com/questions/59393126/generate-constexpr-string-table-cannot-result-in-a-constant-expression/59393382#59393382", "title": "Generate constexpr string table, cannot result in a constant expression", "body": "<p>The problem is that to_string returns std::string, and std::string is not constexpr constructable.</p>\n\n<p>This issue can be solved by using <a href=\"https://github.com/bolero-MURAKAMI/Sprout\" rel=\"nofollow noreferrer\">Sprout constexpr library</a>. Although you might be disappointed by the compilation time.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;sprout/string.hpp&gt;\n#include &lt;sprout/array.hpp&gt;\n#include &lt;sprout/algorithm/transform.hpp&gt;\n#include &lt;sprout/numeric/iota.hpp&gt;\n\nstruct colorConv {\n  typedef sprout::string&lt;20&gt; result_type;\n\n  constexpr result_type\n  operator()(int n) const {\n      return n / 256 == 0 ? \"0;\" + sprout::to_string(255 - n) + \";255\"\n      : n / 256 == 1 ? \"0;255;\" + sprout::to_string(2 * 255 + 1 - n)\n      : n / 256 == 2 ? sprout::to_string(3 * 255 + 2 - n ) + \";255;0;\"\n      : \"255;\" + sprout::to_string(4 * 255 + 3 - n) + \";0\";\n  }\n};\n\nstruct Colors {\nprivate:\n  typedef colorConv::result_type string;\n  constexpr static auto source = sprout::iota&lt;sprout::array&lt;int, 256*4&gt; &gt;(0);\n\npublic:\n  constexpr static auto colors = sprout::transform&lt;sprout::array&lt;string, 256*4&gt; &gt;(\n      sprout::begin(source),\n      sprout::end(source),\n      colorConv()\n  );\n};\n\nint main() {\n  auto&amp; a = Colors::colors;\n\n  for (auto&amp;&amp; str : Colors::colors) {\n    std::cout &lt;&lt; str &lt;&lt; std::endl;\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1576683905, "post_id": 59393582, "comment_id": 104980276, "body": "I once called this generative programming vs. generic programming. ;-) AWK is yet another tool which is useful for preprocessing allowing source code which consists of tab-separated text files (prepared in Excel)."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1576677395, "creation_date": 1576677395, "answer_id": 59393582, "question_id": 59393126, "link": "https://stackoverflow.com/questions/59393126/generate-constexpr-string-table-cannot-result-in-a-constant-expression/59393582#59393582", "title": "Generate constexpr string table, cannot result in a constant expression", "body": "<p>Quite honestly, I'd do this in a Python script, generating a C++ source file (consisting of an array definition) as a pre-build step.</p>\n\n<p>That way, you get the information baked into your application at compile time, <em>and</em> the source for the information is still code so easy to modify.</p>\n\n<p><code>constexpr</code> is fine but sometimes you just want to auto-generate some code.</p>\n"}], "owner": {"reputation": 598, "user_id": 1734357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gaD24.jpg?s=128&g=1", "display_name": "WurmD", "link": "https://stackoverflow.com/users/1734357/wurmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576764604, "creation_date": 1576675848, "last_edit_date": 1576676272, "question_id": 59393126, "link": "https://stackoverflow.com/questions/59393126/generate-constexpr-string-table-cannot-result-in-a-constant-expression", "title": "Generate constexpr string table, cannot result in a constant expression", "body": "<p>Inspired in <a href=\"https://stackoverflow.com/a/37413361/1734357\">https://stackoverflow.com/a/37413361/1734357</a> I wish to make a string color lookup table of a fixed and known size, so I shouldn't need to template it, but string isn't constexpr </p>\n\n<p>How to go about it?</p>\n\n<pre><code>struct Colors\n{\n    constexpr Colors() : colors()\n    {\n        for (size_t i = 0; i &lt; 256; i++)\n            colors[i] = \"0;\" + to_string(i) + \";255\";\n        for (size_t i = 0; i &lt; 256; i++)\n            colors[256 + i] = \"0;255;\" + to_string(255 - i);\n        for (size_t i = 0; i &lt; 256; i++)\n            colors[2 * 256 + i] = to_string(i) + \";255;0\";\n        for (size_t i = 0; i &lt; 256; i++)\n            colors[3 * 256 + i] = \"255;\" + to_string(255 - i) + \";0\";\n    }\n    string colors[4*256];\n};\n</code></pre>\n"}, {"tags": ["c++", "eclipse", "debugging", "gdb", "macos-catalina"], "comments": [{"owner": {"reputation": 3198, "user_id": 6119582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d37ce6d78ed9281f47a2712aaed48?s=128&d=identicon&r=PG&f=1", "display_name": "sweenish", "link": "https://stackoverflow.com/users/6119582/sweenish"}, "edited": false, "score": 0, "creation_date": 1576675906, "post_id": 59393100, "comment_id": 104975689, "body": "If I remember correctly, gdb hasn&#39;t worked for a couple years now. Use lldb or try to get gdb 7."}, {"owner": {"reputation": 75, "user_id": 2279043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkIex.jpg?s=128&g=1", "display_name": "Yasir Saleem", "link": "https://stackoverflow.com/users/2279043/yasir-saleem"}, "reply_to_user": {"reputation": 3198, "user_id": 6119582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274d37ce6d78ed9281f47a2712aaed48?s=128&d=identicon&r=PG&f=1", "display_name": "sweenish", "link": "https://stackoverflow.com/users/6119582/sweenish"}, "edited": false, "score": 0, "creation_date": 1577444111, "post_id": 59393100, "comment_id": 105171920, "body": "I also tried gdb 7 but it also have the same problem. Also, I am unable to use lldb unfortunately. I will try again with lldb. Many thanks."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2279043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkIex.jpg?s=128&g=1", "display_name": "Yasir Saleem", "link": "https://stackoverflow.com/users/2279043/yasir-saleem"}, "edited": false, "score": 0, "creation_date": 1593598916, "post_id": 59534868, "comment_id": 110835313, "body": "Thank you very much. It solved my problem.  I change the path to your mentioned one, provided absolute path of .gdbinit, and also passed entitlement file as argument.  For passing the entitlement file, I followed the procedure mentiioned by @JuanPabloLeon, and added the content in .gdbinit as mentioned by him.   Now I am able to debug in my Eclipse. Thank you very much."}, {"owner": {"reputation": 37, "user_id": 8944633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38bb04076c53d7e2b3f5881eb433649?s=128&d=identicon&r=PG&f=1", "display_name": "VoB", "link": "https://stackoverflow.com/users/8944633/vob"}, "edited": false, "score": 0, "creation_date": 1618838780, "post_id": 59534868, "comment_id": 118716497, "body": "@ThomasVitale I followed all of your instructions, but unfortunately when I press Debug it doesn&#39;t start. The only difference I have from your tutorial is that gdb version is <code>10.1</code>. May this be the issue? How can I install your 8.3 version?"}], "tags": [], "owner": {"reputation": 768, "user_id": 8848246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xWOpt.jpg?s=128&g=1", "display_name": "Thomas Vitale", "link": "https://stackoverflow.com/users/8848246/thomas-vitale"}, "is_accepted": true, "score": 1, "last_activity_date": 1577728347, "creation_date": 1577728347, "answer_id": 59534868, "question_id": 59393100, "link": "https://stackoverflow.com/questions/59393100/macos-10-15-catalina-gdb-problem-for-c-debugging-in-eclipse/59534868#59534868", "title": "macOS 10.15 Catalina gdb problem for C++ Debugging in Eclipse", "body": "<p>Which versions of gdb and Eclipse are you using?</p>\n\n<p>I'll try to mention some aspects with which I had problems in the past. </p>\n\n<ol>\n<li><p>In case you installed gdb with Homebrew, try setting the \"GDB debugger\" field to the actual path, something like <code>/usr/local/Cellar/gdb/8.3/bin/gdb</code> instead of the link <code>/usr/local/bin/gdb</code>.</p></li>\n<li><p>Where is your .<code>gdbinit</code> file located? In the tutorial, it is located in the user home folder, so in the Eclipse debug configuration the GDB command file is set to <code>~/.gdbinit</code>. The value in your screenshot doesn't specify an absolute path, it might be looking for it in the wrong place.</p></li>\n<li><p>Is your gdb certificate part of the System Keychain (rather than the login Keychain)? During the signing have you passed the entitlements file as argument?</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 2279043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkIex.jpg?s=128&g=1", "display_name": "Yasir Saleem", "link": "https://stackoverflow.com/users/2279043/yasir-saleem"}, "edited": false, "score": 0, "creation_date": 1593598961, "post_id": 62457042, "comment_id": 110835340, "body": "Thank you very much. By following yours and @ThomasVitale guidelines, I am finally able to debug in Eclipse."}], "tags": [], "owner": {"reputation": 11, "user_id": 13770989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa346be2581be6d6e32a47bcefcf6a4?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Pablo Leon", "link": "https://stackoverflow.com/users/13770989/juan-pablo-leon"}, "is_accepted": false, "score": 1, "last_activity_date": 1592506926, "last_edit_date": 1592506926, "creation_date": 1592505077, "answer_id": 62457042, "question_id": 59393100, "link": "https://stackoverflow.com/questions/59393100/macos-10-15-catalina-gdb-problem-for-c-debugging-in-eclipse/62457042#62457042", "title": "macOS 10.15 Catalina gdb problem for C++ Debugging in Eclipse", "body": "<p>I faced a similar problem, and I had to do two steps to fix it. I'm not sure if they are both needed or not:</p>\n\n<ol>\n<li><strong>Make sure your debug configuration has an absolute path to .gdbinit</strong>. You need to have a .gdbinit file in your user folder with the following content:</li>\n</ol>\n\n<pre><code>set startup-with-shell off\n</code></pre>\n\n<p>My debug configuration in eclipse pointed to this file, but it wasn't reading it until I changed the path to be absolute. </p>\n\n<ol start=\"2\">\n<li>Set up the permissions with extra entitlements like the ones from this guide: <a href=\"https://www.thomasvitale.com/how-to-setup-gdb-and-eclipse-to-debug-c-files-on-macos-sierra/\" rel=\"nofollow noreferrer\">https://www.thomasvitale.com/how-to-setup-gdb-and-eclipse-to-debug-c-files-on-macos-sierra/</a></li>\n</ol>\n\n<p>Create a gdb-entitlement.xml file with the following content:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n    \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n    &lt;plist version=\"1.0\"&gt;\n    &lt;dict&gt;\n        &lt;key&gt;com.apple.security.cs.allow-jit&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;com.apple.security.cs.allow-unsigned-executable-memory&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;com.apple.security.cs.allow-dyld-environment-variables&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;com.apple.security.cs.disable-library-validation&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;com.apple.security.cs.disable-executable-page-protection&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;com.apple.security.cs.debugger&lt;/key&gt;\n        &lt;true/&gt;\n        &lt;key&gt;com.apple.security.get-task-allow&lt;/key&gt;\n        &lt;true/&gt;\n    &lt;/dict&gt;\n    &lt;/plist&gt;\n</code></pre>\n\n<p>Then, open your Terminal prompt, go to the directory where you saved the xml file and run:</p>\n\n<pre><code>codesign --entitlements gdb-entitlement.xml -fs gdb-cert $(which gdb)\n</code></pre>\n\n<p>Where \"gdb-cert\" is the certificated you created before for code signing.\nAfter those steps and setting the GDB path correctly on Eclipse, debugging worked again.</p>\n"}], "owner": {"reputation": 75, "user_id": 2279043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkIex.jpg?s=128&g=1", "display_name": "Yasir Saleem", "link": "https://stackoverflow.com/users/2279043/yasir-saleem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1698, "favorite_count": 0, "accepted_answer_id": 59534868, "answer_count": 2, "score": 3, "last_activity_date": 1592506926, "creation_date": 1576675762, "question_id": 59393100, "link": "https://stackoverflow.com/questions/59393100/macos-10-15-catalina-gdb-problem-for-c-debugging-in-eclipse", "title": "macOS 10.15 Catalina gdb problem for C++ Debugging in Eclipse", "body": "<p>I am using macOS 10.15.2 Catalina and am trying to debug a Hello World C++ program in Eclipse. \nI have set up gdb debugger by installing it from Homebrew and signing the certificate by following the procedure in the below link.</p>\n\n<p><a href=\"https://www.thomasvitale.com/how-to-setup-gdb-and-eclipse-to-debug-c-files-on-macos-sierra/\" rel=\"nofollow noreferrer\">https://www.thomasvitale.com/how-to-setup-gdb-and-eclipse-to-debug-c-files-on-macos-sierra/</a></p>\n\n<p>The debugger does not get starts. </p>\n\n<p>I have set gdb settings in the Eclipse as mentioned in the below screenshot.\n<a href=\"https://i.stack.imgur.com/1epuW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1epuW.png\" alt=\"GDB setting in Eclipse\"></a> </p>\n\n<p>When I debug the project, I am getting error: <code>Configuring GDB Aborting configuring GDB</code> (its screenshot is also provided below).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vshii.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vshii.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c", "objective-c"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1576675448, "post_id": 59393006, "comment_id": 104975471, "body": "What language are you actually using?  This is tagged with three different ones."}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1576675666, "post_id": 59393006, "comment_id": 104975584, "body": "Look up Stringification in the C preprocessor.   You might be surprised at what can be done"}, {"owner": {"reputation": 33, "user_id": 12540706, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EKuRy9Fz_CY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTPBasCwTQ5_-TTaaUlMw621nXMg/photo.jpg?sz=128", "display_name": "Wayne Xiong", "link": "https://stackoverflow.com/users/12540706/wayne-xiong"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1576676474, "post_id": 59393006, "comment_id": 104976030, "body": "@NathanOliver-ReinstateMonica Actually, I am using Objective-C. But to macro definition and processing, Objective-C is same as C."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576677437, "post_id": 59393099, "comment_id": 104976522, "body": "Not contain, only start-with. <code>n__n</code> is a valid variable name for application use."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576677622, "post_id": 59393099, "comment_id": 104976633, "body": "@R.. Yes contain. <code>n__n</code> is reserved. You may be confused with the rule that identifiers starting with underscore followed capital letter are also reserved. Also all identifiers starting with underscore followed by any character in global namespace."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576679187, "post_id": 59393099, "comment_id": 104977486, "body": "This question is tagged for 3 separate languages, so perhaps you have a different one in mind than I do (C). <code>n__n</code> is not reserved in C."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1576679229, "post_id": 59393099, "comment_id": 104977514, "body": "@R.. Oh, I didn&#39;t notice the language tags. My answer applies to C++. You may be correct regarding C."}, {"owner": {"reputation": 33, "user_id": 12540706, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EKuRy9Fz_CY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTPBasCwTQ5_-TTaaUlMw621nXMg/photo.jpg?sz=128", "display_name": "Wayne Xiong", "link": "https://stackoverflow.com/users/12540706/wayne-xiong"}, "edited": false, "score": 0, "creation_date": 1576848566, "post_id": 59393099, "comment_id": 105038120, "body": "Since it&#39;s not the right way to solve my problem, I have changed my mind to solve it in another way: <a href=\"https://stackoverflow.com/questions/59394700/is-it-possible-to-use-line-in-the-auto-generated-variable-name-in-c\" title=\"is it possible to use line in the auto generated variable name in c\">stackoverflow.com/questions/59394700/&hellip;</a>."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 0, "last_activity_date": 1576679248, "last_edit_date": 1576679248, "creation_date": 1576675746, "answer_id": 59393099, "question_id": 59393006, "link": "https://stackoverflow.com/questions/59393006/is-it-possible-to-replace-or-in-a-string-with-in-a-macro/59393099#59393099", "title": "Is it possible to replace / or . in a string with __ in a macro?", "body": "<blockquote>\n  <p>But with macro, is it possible?</p>\n</blockquote>\n\n<p>No. It is not possible to replace characters of an argument using the standard preprocessor.</p>\n\n<blockquote>\n  <p>acceptable by variable naming, such as __</p>\n</blockquote>\n\n<p><code>__</code> is not an acceptable variable name because it is reserved to the implementation. As are all identifiers that contain consecutive underscores in C++.</p>\n"}], "owner": {"reputation": 33, "user_id": 12540706, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EKuRy9Fz_CY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTPBasCwTQ5_-TTaaUlMw621nXMg/photo.jpg?sz=128", "display_name": "Wayne Xiong", "link": "https://stackoverflow.com/users/12540706/wayne-xiong"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1576675909, "accepted_answer_id": 59393099, "answer_count": 1, "score": 0, "last_activity_date": 1576679248, "creation_date": 1576675328, "question_id": 59393006, "link": "https://stackoverflow.com/questions/59393006/is-it-possible-to-replace-or-in-a-string-with-in-a-macro", "closed_reason": "Duplicate", "title": "Is it possible to replace / or . in a string with __ in a macro?", "body": "<p>I want to convert a string with / or . into an auto-generated variable name. So I need convert / or . into something acceptable by variable naming, such as __.</p>\n\n<p>It's easy to do it with a function. But with macro, is it possible?</p>\n\n<pre><code>#define ROUTE(path, impl) \\\nchar * k##path##_route = \"{\"#path\":\\\"\"#impl\"\\\"}\"; // compilation failure for path like /usr/abc or ./abc\n</code></pre>\n\n<p>I can use impl to name the variable, but since multiple paths may map to the same impl, the compiler will complain about duplication for different paths with the same impl.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12531529"}, "edited": false, "score": 3, "creation_date": 1576675635, "post_id": 59392982, "comment_id": 104975561, "body": "Welcome to stackoverflow! Please, provide source code of <code>boxStacking</code> function. The computation of height is located there, so if it&#39;s incorrect possible the problem is also in implementation of that function."}, {"owner": {"reputation": 1, "user_id": 12558841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-75MnB8OLWAo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9mP2b7X7Bxje7SFpsMZx-2jbLVA/photo.jpg?sz=128", "display_name": "Shivam Malhotra", "link": "https://stackoverflow.com/users/12558841/shivam-malhotra"}, "edited": false, "score": 0, "creation_date": 1576675854, "post_id": 59392982, "comment_id": 104975665, "body": "I&#39;ve updated with  it!"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1576676275, "post_id": 59392982, "comment_id": 104975902, "body": "You don\u2019t need <code>typedef struct\u00a0\u2026</code> in C++. In fact, it makes no sense."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1576676918, "post_id": 59392982, "comment_id": 104976261, "body": "The last term of your if <code>(... &amp;&amp; H[j] + boxes[i].height)</code> condition checks that <code>H[j] + boxes[i].height != 0</code>. Is that intentional?"}, {"owner": {"reputation": 1, "user_id": 12558841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-75MnB8OLWAo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9mP2b7X7Bxje7SFpsMZx-2jbLVA/photo.jpg?sz=128", "display_name": "Shivam Malhotra", "link": "https://stackoverflow.com/users/12558841/shivam-malhotra"}, "edited": false, "score": 0, "creation_date": 1576679120, "post_id": 59392982, "comment_id": 104977439, "body": "Yes! It wrote it intentionally!"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1576682334, "post_id": 59392982, "comment_id": 104979334, "body": "Please note that <code>l</code>, <code>b</code> and <code>h</code> are declared in <code>main</code> as variable length arrays (<code>N</code> is not a compile time constant), which are not standard C++. You may either declare <code>N</code> as <code>constexpr</code> or use <code>std::vector</code> if you need a dynamically sized array (like <code>H</code> or <code>orientation</code> should be)."}], "owner": {"reputation": 1, "user_id": 12558841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-75MnB8OLWAo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc9mP2b7X7Bxje7SFpsMZx-2jbLVA/photo.jpg?sz=128", "display_name": "Shivam Malhotra", "link": "https://stackoverflow.com/users/12558841/shivam-malhotra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576677104, "creation_date": 1576675232, "last_edit_date": 1576677104, "question_id": 59392982, "link": "https://stackoverflow.com/questions/59392982/input-an-list-into-a-class", "title": "Input an list into a class", "body": "<p>I have written the following code for the box stacking problem however it fails to provide the correct answer and it is mp because of fault in the driver program though I couldn't find it. If I manually write something like </p>\n\n<pre><code>Box boxes[] = { {4, 6, 7}, {1, 2, 3}, {4, 5, 6}, {10, 12, 32} };\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>int N = 4;\n    int l[N],b[N],h[N];\n    Box boxes[N];\n    for(int i = 0;i&lt;N;i++)\n    {\n       cin&gt;&gt;l[i]&gt;&gt;b[i]&gt;&gt;h[i];\n       boxes[i]={l[i],b[i],h[i]};\n    }\n</code></pre>\n\n<p>I get the correct result. However I want to take the input from the user so I wrote the following code:\nBox is a structure having length breadth and height. Forgive me for my language for I am new to all this!</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\ntypedef struct box {\n    int width;\n    int depth;\n    int height;\n} Box;\n\nbool boxComparator(Box b1, Box b2) {\n    return ( b1.depth * b1.width &gt; b2.depth * b2.width );\n}\n\nint findMaxHeightBoxStack(Box boxes[], int n)\n{\n    int H[n];\n    for(int i=0; i&lt;n; i++){\n        H[i] = boxes[i].height;\n    }\n    for(int i=1; i&lt;n; i++){\n        for( int j=i-1; j&gt;=0; j--){\n            if(boxes[j].width &gt; boxes[i].width \n               &amp;&amp; boxes[j].depth &gt; boxes[i].depth \n               &amp;&amp; H[j] + boxes[i].height){\n                H[i] = H[j] + boxes[i].height;\n            }\n        }\n    }\n\n    int maxHeight = 0 ;\n    for(int i=0; i&lt;n; i++){\n        if(maxHeight &lt; H[i]){\n            maxHeight = H[i];\n        }\n    }\n    return maxHeight;\n}\n\nint boxStacking(Box boxes[], int n)\n{\n\n    Box orientations[3*n]; //for rotations\n    int index = 0;\n    for(int i=0; i&lt;n; i++){\n        orientations[index] = boxes[i]; // first one as such\n        index++;\n\n        orientations[index].height = boxes[i].width;\n        orientations[index].width = max( boxes[i].height, boxes[i].depth) ;\n        orientations[index].depth = min( boxes[i].height, boxes[i].depth);\n\n        index++;\n        orientations[index].height = boxes[i].depth;\n        orientations[index].width = max( boxes[i].height, boxes[i].width) ;\n        orientations[index].depth = min( boxes[i].height, boxes[i].width) ;\n        index++;\n    }\n    n = 3*n;\n\n    sort(orientations, orientations+n, boxComparator);\n    return findMaxHeightBoxStack( orientations, n);\n}\n\n// Driver program\nint main()\n{\n    int N = 4;\n    int l[N],b[N],h[N];\n    Box boxes[N];\n    for(int i = 0;i&lt;N;i++)\n    {\n       cin&gt;&gt;l[i]&gt;&gt;b[i]&gt;&gt;h[i];\n       boxes[i]={l[i],b[i],h[i]};\n    }\n    int n = 4;\n    cout &lt;&lt; \"Maximum height is \" &lt;&lt; boxStacking(boxes, N);\n    return 0;\n}  \n\n\n</code></pre>\n"}, {"tags": ["c++", "copy-constructor", "move-semantics", "assignment-operator"], "comments": [{"owner": {"reputation": 174, "user_id": 5135393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/byVaK.jpg?s=128&g=1", "display_name": "Luis Alves", "link": "https://stackoverflow.com/users/5135393/luis-alves"}, "edited": false, "score": 1, "creation_date": 1576674801, "post_id": 59392794, "comment_id": 104975166, "body": "I think the proper channel for this request is: <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 61707, "user_id": 5597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014ef33a9f0e7e3ac5a12e7446d2d619?s=128&d=identicon&r=PG", "display_name": "Anthony Williams", "link": "https://stackoverflow.com/users/5597/anthony-williams"}, "edited": false, "score": 0, "creation_date": 1576674871, "post_id": 59392794, "comment_id": 104975205, "body": "Please could you reword your question? It is not clear what you are asking: you shouldn&#39;t be asking for a general &quot;code review&quot; or &quot;hints and tips&quot;. Is there something specific you would like to ask about? If so, please reword to ask that."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576675451, "post_id": 59392794, "comment_id": 104975472, "body": "Moving should not deep-copy and delete, it should just &quot;steal&quot; the contents. (Also, you&#39;re leaking the entire original tree.)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1576675653, "post_id": 59392794, "comment_id": 104975574, "body": "The comment <code>&#47;&#47;Check if objects are of the same type.</code> is wrong. You&#39;re checking if they are the same object, which is a completely different thing."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1576675336, "creation_date": 1576675336, "answer_id": 59393010, "question_id": 59392794, "link": "https://stackoverflow.com/questions/59392794/move-semantics-c-singly-linked-list/59393010#59393010", "title": "Move semantics c++ singly linked list", "body": "<p>A move constructor shouldn't usually perform a \"deep copy\". It should make a shallow copy, and then restore the original object into a state that enforces any class invariants. If there are no invariants, then a shallow copy alone is sufficient (in which case the implicitly generated move constructor does what you want).</p>\n\n<p>Furthermore, you're passing nullptr to <code>deepDelete</code>, which makes no sense to me. </p>\n\n<p>Intuitively, a sensible move constructor would be like this:</p>\n\n<pre><code>this-&gt;root = original.root; // shallow copy\noriginal.root = nullptr;    // enforce class invariant of unique ownership\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12422046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac83833a729aaa74e81b2911fa234473?s=128&d=identicon&r=PG&f=1", "display_name": "efe", "link": "https://stackoverflow.com/users/12422046/efe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1576708474, "answer_count": 1, "score": 0, "last_activity_date": 1576675336, "creation_date": 1576674512, "question_id": 59392794, "link": "https://stackoverflow.com/questions/59392794/move-semantics-c-singly-linked-list", "closed_reason": "Needs more focus", "title": "Move semantics c++ singly linked list", "body": "<p>I have been learning about move semantics in c++ and i think i have got my head around it.\nJust to be sure i was wondering if anyone could give me some tips or even give me suggestions to improve my code. Thanks :)</p>\n\n<p>I am implementing a dictionary as a linked list for an assignment if you are wondering why i wouldnt use a binary tree or anything else for that matter.</p>\n\n<pre><code>template&lt;class Key, class Item&gt;\nDictionary&lt;Key, Item&gt;::Dictionary(const Dictionary&amp; original)\n{\n    std::cout &lt;&lt; \"Copy Constructor Invoked\" &lt;&lt; std::endl;\n    this-&gt;root = deepCopy(original.root);\n\n}\n\ntemplate&lt;class Key, class Item&gt;\nDictionary&lt;Key, Item&gt;&amp; Dictionary&lt;Key, Item&gt;::operator=(const Dictionary&amp; original)\n{\n    //Check if objects are of the same type.\n    if (this == &amp;original)\n    {\n        return *this;\n    }\n    root = deepCopy(original.root);\n    return *this;\n}\n\ntemplate&lt;class Key, class Item&gt;\nDictionary&lt;Key, Item&gt;::Dictionary(Dictionary&amp;&amp; original)\n{\n    std::cout &lt;&lt; \"Move Constructor\" &lt;&lt; std::endl;\n    this-&gt;root = deepCopy(original.root);\n    original.root = nullptr;\n    deepDelete(original.root);\n\n}\n\ntemplate&lt;class Key, class Item&gt;\nDictionary&lt;Key, Item&gt;&amp; Dictionary&lt;Key, Item&gt;::operator=(Dictionary&amp;&amp; original)\n{\n    //Check if objects are of the same type.\n    if (this == &amp;original)\n    {\n        return *this;\n    }\n\n    std::cout &lt;&lt; \"Move Operator\" &lt;&lt; std::endl;\n\n    root = original.root;\n    original.root = nullptr;\n    deepDelete(original.root);\n    return *this;\n}\n\ntemplate&lt;class Key, class Item&gt;\ninline Dictionary&lt;Key, Item&gt;::~Dictionary()\n{\n    deepDelete(root);\n}\n</code></pre>\n"}, {"tags": ["c++", "qt5", "qprocess"], "comments": [{"owner": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "edited": false, "score": 1, "creation_date": 1576674743, "post_id": 59392642, "comment_id": 104975145, "body": "What does <a href=\"https://doc.qt.io/qt-5/qiodevice.html#errorString\" rel=\"nofollow noreferrer\"><code>QProcess::errorString()</code></a> say?"}, {"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 2, "creation_date": 1576674833, "post_id": 59392642, "comment_id": 104975180, "body": "There are several issues could happen. First of all, try to get the output of the process with <code>readAllStandardError</code> and <code>readAllStandardOutput</code> to see if the command (i2cdetect) is returning some errors. Also, get the <code>state</code> of the process to see if it finished, if not you maybe have to <code>terminate</code> or <code>kill</code> the process. And, you probably need to <code>delete _currProcess;</code> after ending it."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 1, "creation_date": 1576675747, "post_id": 59392642, "comment_id": 104975621, "body": "I think the failure is because your <code>update()</code> function is called several times but work on the same <code>QProcess</code>. If you call <code>update()</code>, you start the process, fine. But if you call <code>update()</code> again without ensuring the previous <code>update()</code> has finished (still waiting for the end of the process), you will try to start an already started process (because you uses the same <code>QProcess</code> object) and therefore the start will fail."}, {"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "reply_to_user": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "edited": false, "score": 1, "creation_date": 1576682383, "post_id": 59392642, "comment_id": 104979358, "body": "@acraig5075 Good Point! : &quot;Resource error (fork failure): Too many open files&quot;"}, {"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576683143, "post_id": 59392642, "comment_id": 104979838, "body": "@user1810087 readAllStandardError/Output gives nothing!"}, {"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576684117, "post_id": 59392642, "comment_id": 104980390, "body": "@user1810087 But I don&#39;t. I think the problem is that I&#39;m opening too much &#39;sh&#39; with update method."}, {"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576684156, "post_id": 59392642, "comment_id": 104980412, "body": "@user1810087 Maybe I should change codes so that &quot;_currProcess-&gt;start(&quot;sh&quot;);&quot; runs only once"}, {"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576684946, "post_id": 59392642, "comment_id": 104980886, "body": "Can you check how many threads the process is using."}, {"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576685014, "post_id": 59392642, "comment_id": 104980922, "body": "@user1810087 How can I check that? I&#39;m running on a rasp"}, {"owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576685230, "post_id": 59392642, "comment_id": 104981072, "body": "rasp = raspberry? os raspbian? <a href=\"https://stackoverflow.com/questions/268680/how-can-i-monitor-the-thread-count-of-a-process-on-linux\" title=\"how can i monitor the thread count of a process on linux\">stackoverflow.com/questions/268680/&hellip;</a>"}, {"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "reply_to_user": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "edited": false, "score": 0, "creation_date": 1576685557, "post_id": 59392642, "comment_id": 104981260, "body": "@user1810087 yes raspberry. the total threads for my app is fixed and is 10. It&#39;s not increasing with time"}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "edited": false, "score": 0, "creation_date": 1576681496, "post_id": 59393305, "comment_id": 104978894, "body": "Thanks for sharing your thoughts. I&#39;ve already tested this solution but not helped :( But please don&#39;t remove it. Maybe I&#39;ll come with a similar solution and will update you."}], "tags": [], "owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "is_accepted": false, "score": 2, "last_activity_date": 1576676901, "last_edit_date": 1576676901, "creation_date": 1576676468, "answer_id": 59393305, "question_id": 59392642, "link": "https://stackoverflow.com/questions/59392642/qprocess-give-failedtostart-after-starting-multiple-times/59393305#59393305", "title": "QProcess give FailedToStart after starting multiple times", "body": "<p>My guess is that you get the failure because all your <code>update()</code> calls share the same <code>QProcess</code> object.</p>\n\n<p>What happens here is that when you call <code>update()</code>, you start the process. And 100ms later, you call it again without ensuring that the previous <code>update()</code> has finished to wait the end of the process.<br/>\nThe consequence is that you try to start an already started process and thus it fails.</p>\n\n<p>For me, the easiest solution is to create one <code>QProcess</code> object for each <code>update()</code> call.<br/>\nSomething like:</p>\n\n<pre><code>void TempsReader::update()\n{\n    QProcess * current_process = new QProcess;\n\n    connect(current_process, &amp;QProcess::errorOccured, this, &amp;TempReader::onProcessError);\n    connect(current_process, QOverload&lt;int, QProcess::ExitStatus&gt;::of(&amp;QProcess::finished), this, &amp;TempReader::onProcessFinished());\n\n    current_process-&gt;start(\"sh\"); // Your command\n    current_process-&gt;waitForStarted();\n    current_process-&gt;write(\"i2cdetect -y 1\");\n    current_process-&gt;waitForFinished();\n\n    current_process-&gt;deleteLater();\n}\n</code></pre>\n\n<p>Or without pointers:</p>\n\n<pre><code>void TempsReader::update()\n{\n    QProcess current_process;\n\n    connect(&amp;current_process, &amp;QProcess::errorOccured, this, &amp;TempReader::onProcessError);\n    connect(&amp;current_process, QOverload&lt;int, QProcess::ExitStatus&gt;::of(&amp;QProcess::finished), this, &amp;TempReader::onProcessFinished());\n\n    current_process.start(\"sh\"); // Your command\n    current_process.waitForStarted();\n    current_process.write(\"i2cdetect -y 1\");\n    current_process.waitForFinished();\n}\n</code></pre>\n\n<hr>\n\n<p><em><sub>As you did not show the calling part of the code (the thread creation, the 100ms loop, ...), this may not be the solution you need.<br/>\nIn this case, please let me know if it does not solve your issue so that I'll remove this answer.</sub></em></p>\n"}, {"tags": [], "owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "is_accepted": true, "score": 0, "last_activity_date": 1576689847, "creation_date": 1576689847, "answer_id": 59397236, "question_id": 59392642, "link": "https://stackoverflow.com/questions/59392642/qprocess-give-failedtostart-after-starting-multiple-times/59397236#59397236", "title": "QProcess give FailedToStart after starting multiple times", "body": "<p>Finally I've found the issue and it was not related to QProcess itself. It was relating to I2C connection. I was using this command in update: wiringPiI2CSetup(addr); and it opens a new device each time.</p>\n"}], "owner": {"reputation": 987, "user_id": 2029960, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/de66cac08607f4a8f77e2ae6bbc5e21b?s=128&d=identicon&r=PG&f=1", "display_name": "Mosi", "link": "https://stackoverflow.com/users/2029960/mosi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 59397236, "answer_count": 2, "score": 1, "last_activity_date": 1576689847, "creation_date": 1576673953, "last_edit_date": 1576688844, "question_id": 59392642, "link": "https://stackoverflow.com/questions/59392642/qprocess-give-failedtostart-after-starting-multiple-times", "title": "QProcess give FailedToStart after starting multiple times", "body": "<p>I'm trying to use QProcess inside a thread to do some operations (read I2C connections).The update method is calling every 100 msec:</p>\n\n<pre><code>void TempsReader::update()\n{\n    if (_currProcess == nullptr) {\n        _currProcess = new QProcess();\n        connect(_currProcess, &amp;QProcess::errorOccurred, this, &amp;TempsReader::onProcessError);\n        connect(_currProcess, SIGNAL(finished(int,QProcess::ExitStatus)),\n                this, SLOT(onProcessFinished()));\n    }\n\n    _currProcess-&gt;start(\"sh\");\n    if (_currProcess-&gt;waitForStarted()) {\n        _currProcess-&gt;write(\"i2cdetect -y 1\");\n        _currProcess-&gt;closeWriteChannel();\n        _currProcess-&gt;waitForFinished();\n    }\n}\n</code></pre>\n\n<p>After some time, the process gives \"FailedToStart\" error and never starts again.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2h95f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2h95f.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>void TempsReader::onProcessError(QProcess::ProcessError error)\n{\n    qDebug() &lt;&lt; error;\n    _currProcess-&gt;close();\n}\n\nvoid TempsReader::onProcessFinished()\n{\n    QString devs = _currProcess-&gt;readAll();\n    _currProcess-&gt;waitForFinished();\n    // doing some stuff with devs\n    _currProcess-&gt;close();\n}\n</code></pre>\n\n<p>How can I fix this issue? Am I using QProcess in a wrong way? and how can I start the process again when it drops in error slot. Thanks in advance.</p>\n\n<p><strong>Update: QProcess::errorString() gives this: \"Resource error (fork failure): Too many open files\"</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/FnA3B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FnA3B.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>UPDATE: Finally I've found the issue and it was not related to QProcess itself. It was relating to I2C connection.</strong></p>\n"}, {"tags": ["android", "c++", "android-ndk", "backtrace"], "owner": {"reputation": 2192, "user_id": 1966790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c63f6c93d67e8cbe0bc2498c225d2d88?s=128&d=identicon&r=PG", "display_name": "MateuszL", "link": "https://stackoverflow.com/users/1966790/mateuszl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576673261, "creation_date": 1576673261, "question_id": 59392417, "link": "https://stackoverflow.com/questions/59392417/android-ndk-how-to-find-load-relocation-for-a-pie-binary-how-to-get-r-debug", "title": "Android NDK: How to find load relocation for a PIE binary / how to get _r_debug.r_map-&gt;l_addr", "body": "<p>This is sister-question of <a href=\"https://stackoverflow.com/questions/55066749/how-to-find-load-relocation-for-a-pie-binary\">How to find load relocation for a PIE binary?</a> which was solved by using <code>_r_debug.r_map-&gt;l_addr</code>. Now I need to do this on Android NDK 19.</p>\n\n<p>I need to print backtrace without symbols. I can do this with following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;unwind.h&gt;\n#include &lt;dlfcn.h&gt;\n#include &lt;sstream&gt;\n#include &lt;android/log.h&gt;\n\n\nnamespace {\n\nstruct BacktraceState\n{\n    void** current;\n    void** end;\n};\n\nstatic _Unwind_Reason_Code unwindCallback(struct _Unwind_Context* context, void* arg)\n{\n    BacktraceState* state = static_cast&lt;BacktraceState*&gt;(arg);\n    uintptr_t pc = _Unwind_GetIP(context);\n    if (pc) {\n        if (state-&gt;current == state-&gt;end) {\n            return _URC_END_OF_STACK;\n        } else {\n            *state-&gt;current++ = reinterpret_cast&lt;void*&gt;(pc);\n        }\n    }\n    return _URC_NO_REASON;\n}\n\n}\n\nsize_t captureBacktrace(void** buffer, size_t max)\n{\n    BacktraceState state = {buffer, buffer + max};\n    _Unwind_Backtrace(unwindCallback, &amp;state);\n\n    return state.current - buffer;\n}\n\nnamespace clog {\n\nstd::string bt(int from, int max_stack) {\n\n    const size_t MAX_STACK = 30;\n\n    if (from &gt;= max_stack)\n        from = 0;\n    if (max_stack &gt; MAX_STACK)\n        max_stack = MAX_STACK;\n\n    void* array[MAX_STACK];\n    std::ostringstream msg;\n\n    size_t size = captureBacktrace(array, MAX_STACK);\n    if (size &gt;= 2) {\n        msg &lt;&lt; \"[bt]\" &lt;&lt; std::hex;\n        for (int i = from; i &lt; size; ++i) {\n            msg &lt;&lt; \"0x\" &lt;&lt; reinterpret_cast&lt;uintptr_t&gt;(array[i]) &lt;&lt; \" \";\n        }\n        msg &lt;&lt; \"[/bt]\" &lt;&lt; std::dec;\n    }\n    return msg.str();\n}\n}\n\n</code></pre>\n\n<p>It prints addresses that include offset from ASLR. On Linux I fixed this by changing</p>\n\n<pre><code>msg &lt;&lt; \"0x\" &lt;&lt; reinterpret_cast&lt;uintptr_t&gt;(array[i]) &lt;&lt; \" \";\n</code></pre>\n\n<p>to </p>\n\n<pre><code>#include &lt;execinfo.h&gt;\n#include &lt;link.h&gt;\n...\nstatic const uintptr_t relocation = _r_debug.r_map-&gt;l_addr;\nmsg &lt;&lt; \"0x\" &lt;&lt; reinterpret_cast&lt;uintptr_t&gt;(array[i]) - reinterpret_cast&lt;uintptr_t&gt;(relocation) &lt;&lt; \" \";\n</code></pre>\n\n<p><code>_r_debug.r_map-&gt;l_addr</code> is not available on Android as far as I can see. Is there some equivalent?</p>\n"}, {"tags": ["c++", "class", "constructor", "initializer-list"], "comments": [{"owner": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 0, "creation_date": 1576673263, "post_id": 59392384, "comment_id": 104974380, "body": "Are you asking to write a shorter constructor?"}, {"owner": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "reply_to_user": {"reputation": 1082, "user_id": 9091276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/05cFn.png?s=128&g=1", "display_name": "Frontear", "link": "https://stackoverflow.com/users/9091276/frontear"}, "edited": false, "score": 3, "creation_date": 1576673429, "post_id": 59392384, "comment_id": 104974466, "body": "@Frontear it seems like the question is, if it&#39;s possible to make <code>A obj{ 1, 2 };</code> work without writing out the full <code>A(int a, int b)</code> constructor when a default constructor is explicitly present."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 1, "creation_date": 1576675703, "post_id": 59392384, "comment_id": 104975606, "body": "Why do you need default constructor? Perhaps you could use in-class member initialization instead (like this: <code>class A { public:     int a = 1;     int b = 2; };</code>) and have all benefits of compiler-generated constructors?"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1576673923, "last_edit_date": 1592644375, "creation_date": 1576673923, "answer_id": 59392633, "question_id": 59392384, "link": "https://stackoverflow.com/questions/59392384/short-c-class-constructor-from-brace-enclosed-initializer-list/59392633#59392633", "title": "Short c++ class constructor from brace-enclosed initializer list", "body": "<blockquote>\n<pre><code>A(int a, int b):a(a), b(b) {}.\n</code></pre>\n<p>Is there a shorter form</p>\n</blockquote>\n<p>No. Other than a few white spaces, this constructor is as short as it can be.</p>\n"}, {"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 1, "last_activity_date": 1576674717, "creation_date": 1576674717, "answer_id": 59392841, "question_id": 59392384, "link": "https://stackoverflow.com/questions/59392384/short-c-class-constructor-from-brace-enclosed-initializer-list/59392841#59392841", "title": "Short c++ class constructor from brace-enclosed initializer list", "body": "<p>Unfortunately not.</p>\n\n<p>When you created a default constructor, you prevented yourself from initialising the class using aggregate-initialisation.</p>\n\n<p>To be able to get back the ability to use that declaration syntax, you have to create another constructor that takes all the necessary arguments&hellip; and there is no shorter way to do that than what you have written.</p>\n"}], "owner": {"reputation": 74, "user_id": 10871391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52ed436b9d4cbe74fb52908b0ffab61?s=128&d=identicon&r=PG", "display_name": "Wojtek Skaba", "link": "https://stackoverflow.com/users/10871391/wojtek-skaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576674717, "creation_date": 1576673149, "question_id": 59392384, "link": "https://stackoverflow.com/questions/59392384/short-c-class-constructor-from-brace-enclosed-initializer-list", "title": "Short c++ class constructor from brace-enclosed initializer list", "body": "<p>The following piece of core works fine:</p>\n\n<pre><code>class A {\npublic:\n    int a;\n    int b;\n};\n\nA obj{ 1, 2 };\n</code></pre>\n\n<p>If, however, one adds default constructor explicitly: A(){}, one has to add another one for brace-enclosed initializer list, like:</p>\n\n<pre><code>A(int a, int b):a(a), b(b) {}.\n</code></pre>\n\n<p>Is there a shorter form like, e.g.:</p>\n\n<pre><code>A(const A&amp; ab) { *this = ab } ???\n</code></pre>\n\n<p>The one above doesn't work.</p>\n"}, {"tags": ["c++", "graphics", "winbgi"], "comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576673487, "post_id": 59392375, "comment_id": 104974495, "body": "@drescherjm, Probabaly not. Probably just a weird way of doing <code>const char *driver = &quot;&quot;;</code>"}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "edited": false, "score": 1, "creation_date": 1576673496, "post_id": 59392375, "comment_id": 104974497, "body": "Possible duplicate of: <a href=\"https://stackoverflow.com/questions/7860569/how-i-can-get-and-use-the-header-file-graphics-h-in-my-c-program\" title=\"how i can get and use the header file graphics h in my c program\">stackoverflow.com/questions/7860569/&hellip;</a>"}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "edited": false, "score": 1, "creation_date": 1576673525, "post_id": 59392375, "comment_id": 104974513, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/7860569/how-i-can-get-and-use-the-header-file-graphics-h-in-my-c-program\">How I can get and use the header file &lt;graphics.h&gt; in my C++ program?</a>"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576673772, "post_id": 59392375, "comment_id": 104974660, "body": "The error is confusing, it is about <code>std::string</code> which I don&#39;t think the <code>winbgi</code> port uses. Could be that your compiler is too new. Remember that the binaries for <code>winbgi</code> are now 14 years old. You likely need an old compiler to match. Something from 2005 to 2007 not 2019."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1576674124, "post_id": 59392375, "comment_id": 104974830, "body": "Please make your title describe the question"}], "owner": {"reputation": 11, "user_id": 12334580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCf097C9M0bbSNguUCbxuxEXfYAo36jQuR-dPk6=k-s128", "display_name": "dip chit", "link": "https://stackoverflow.com/users/12334580/dip-chit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576674504, "creation_date": 1576673124, "last_edit_date": 1576674504, "question_id": 59392375, "link": "https://stackoverflow.com/questions/59392375/application-using-the-winbgi-library-crashes-when-used-with-codeblocks", "title": "Application using the winbgi library crashes when used with Code::Blocks", "body": "<p>I am having trouble when trying to run a graphics program through codeblocks. It just opens console and crashes when I click the build&amp;run button. I have tried many other graphics program the result is still the same. And also I tried to debug it and it says segmentation error. See the picture for more details.</p>\n\n<p><a href=\"https://i.stack.imgur.com/A2HxX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A2HxX.png\" alt=\"picture of the problem\"></a></p>\n\n<pre><code>#include &lt;graphics.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nint main(void) {\n    int gdriver = DETECT, gmode;\n    int x1 = 200, y1 = 200;\n    int x2 = 300, y2 = 300;\n    char driver[] = \"\";\n\n    initgraph(&amp;gdriver, &amp;gmode, driver);\n    line(x1, y1, x2, y2);\n    getch();\n    closegraph();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 1, "creation_date": 1576833078, "post_id": 59392327, "comment_id": 105031532, "body": "You don&#39;t have the code here so it is hard to tell, but you need to be careful about how you generate random numbers inside &quot;random_data_point&quot;, there is a lot of complexity in parallel random number generation, and simply calling the serial generator is extremely unlikely to be the optimal solution!"}, {"owner": {"reputation": 429, "user_id": 1496036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766c75feb4298f25ac1133912b7e394e?s=128&d=identicon&r=PG", "display_name": "Yauhen Yakimenka", "link": "https://stackoverflow.com/users/1496036/yauhen-yakimenka"}, "reply_to_user": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1576847344, "post_id": 59392327, "comment_id": 105037563, "body": "Oh, I didn&#39;t think about that"}, {"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1576858581, "post_id": 59392327, "comment_id": 105042628, "body": "For some background you could look at this paper from the Supercomputing Conference a while back <a href=\"http://www.thesalmons.org/john/random123/papers/random123sc11.pdf\" rel=\"nofollow noreferrer\">thesalmons.org/john/random123/papers/random123sc11.pdf</a> Note that this is implemented in Intel MKL (which is available gratis to everyone), other libraries may also have it, or something similar. (As ever, &quot;The best code is the code I don&#39;t have to write&quot; :-))"}, {"owner": {"reputation": 429, "user_id": 1496036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766c75feb4298f25ac1133912b7e394e?s=128&d=identicon&r=PG", "display_name": "Yauhen Yakimenka", "link": "https://stackoverflow.com/users/1496036/yauhen-yakimenka"}, "reply_to_user": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1576863566, "post_id": 59392327, "comment_id": 105044572, "body": "Hmmm actually this might be an issue indeed. My programme runs fine on machine with Intel CPU. But it is muuuuuuch slower on the one with AMD. I think I need to educate myself on parallel random number generation with OpenMP..."}, {"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1577094367, "post_id": 59392327, "comment_id": 105087994, "body": "The issue is parallel random number generation in general. OpenMP is merely the way that you are generating parallelism. As before, find a math library and use it. Good random number generation is a complicated field so exploit someone else&#39;s brains!"}, {"owner": {"reputation": 429, "user_id": 1496036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766c75feb4298f25ac1133912b7e394e?s=128&d=identicon&r=PG", "display_name": "Yauhen Yakimenka", "link": "https://stackoverflow.com/users/1496036/yauhen-yakimenka"}, "reply_to_user": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 0, "creation_date": 1577109079, "post_id": 59392327, "comment_id": 105094024, "body": "It feels strange that I cannot generate random numbers (no need for crypto-secure or anything) in multithread application with just standard tools of C++..."}], "answers": [{"tags": [], "owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "is_accepted": true, "score": 2, "last_activity_date": 1576747348, "creation_date": 1576747348, "answer_id": 59406611, "question_id": 59392327, "link": "https://stackoverflow.com/questions/59392327/openmp-arbitrary-reduction-merge/59406611#59406611", "title": "OpenMP arbitrary reduction (merge)", "body": "<p>Modern OpenMP allows you to define your own reduction functions, so you should be able to achieve this that way should you want to, though, realistically, for something this simple it might be easier just to write code along these lines  (untested, typed into this answer, not compiled :-))</p>\n\n<pre><code>#pragma omp parallel\n{\n    set&lt;Data_Point&gt; thread_good_points;\n#pragma omp for nowait\n    for (int iter = 0; iter &lt; num_iterations; iter++) {\n        DataPoint r = random_data_point();\n        if (test(DataPoint))\n            thread_good_points.insert(r);\n    }\n#pragma omp critical\n    good_points.merge(thread_good_points);\n}\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 1496036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766c75feb4298f25ac1133912b7e394e?s=128&d=identicon&r=PG", "display_name": "Yauhen Yakimenka", "link": "https://stackoverflow.com/users/1496036/yauhen-yakimenka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 59406611, "answer_count": 1, "score": 0, "last_activity_date": 1576747348, "creation_date": 1576672986, "question_id": 59392327, "link": "https://stackoverflow.com/questions/59392327/openmp-arbitrary-reduction-merge", "title": "OpenMP arbitrary reduction (merge)", "body": "<p>I want to use OpenMP to collect some data. For that, I check many candidates and collect only those that satisfy some conditions. The simplified example would be the following.</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n#include \"omp.h\"\n\nusing namespace std;\n\nclass DataPoint {};\n\nDataPoint random_data_point() {\n    // generate random data point\n}\n\nbool test(DataPoint r) {\n    // do something\n}\n\nint main() {\n    constexpr int num_iterations = 10000;\n\n    set&lt;DataPoint&gt; good_points;\n\n#pragma omp parallel for reduction(???)\n    for (int iter = 0; iter &lt; num_iterations; iter++) {\n        DataPoint r = random_data_point();\n        if (test(DataPoint))\n            good_points.insert(r);\n    }\n\n//  ...\n\n    return 0;\n}\n</code></pre>\n\n<p>The question is how to use OpenMP efficiently. My idea is that each thread collects its own data (in the example above - its own set) and then, after all of the thread finished, their sets are merged.</p>\n\n<p>Note 1: my iterations are very independent (as in the example above), so OpenMP should be helpful.\nNote 2: in the real programme, I use more complicated data structure than set. (In fact, it is a convex hull of the data points.)</p>\n"}, {"tags": ["java", "c++", "wbf"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1576674000, "post_id": 59392317, "comment_id": 104974763, "body": "Trying to push the community for &quot;urgent&quot; help will have the exact opposite of the indented effect."}, {"owner": {"reputation": 21, "user_id": 11830175, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YrdyZiNNdNg/AAAAAAAAAAI/AAAAAAAAAgI/Getq2A27Uak/photo.jpg?sz=128", "display_name": "Awais Waheed", "link": "https://stackoverflow.com/users/11830175/awais-waheed"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1576674390, "post_id": 59392317, "comment_id": 104974972, "body": "Ehh sorry about that."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1576675091, "post_id": 59392317, "comment_id": 104975306, "body": "From what I can see - you&#39;ve been asking the microsoft support group for help - they seem to be the group that would know the most"}, {"owner": {"reputation": 21, "user_id": 11830175, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YrdyZiNNdNg/AAAAAAAAAAI/AAAAAAAAAgI/Getq2A27Uak/photo.jpg?sz=128", "display_name": "Awais Waheed", "link": "https://stackoverflow.com/users/11830175/awais-waheed"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1576675820, "post_id": 59392317, "comment_id": 104975647, "body": "Ill ask there too."}], "owner": {"reputation": 21, "user_id": 11830175, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YrdyZiNNdNg/AAAAAAAAAAI/AAAAAAAAAgI/Getq2A27Uak/photo.jpg?sz=128", "display_name": "Awais Waheed", "link": "https://stackoverflow.com/users/11830175/awais-waheed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576674364, "creation_date": 1576672949, "last_edit_date": 1576674364, "question_id": 59392317, "link": "https://stackoverflow.com/questions/59392317/unable-to-capture-image-data-using-windows-biometric-framework", "title": "Unable to capture image data using Windows Biometric Framework", "body": "<p>I am developing a Biometric module using WBF. I am using the code given at <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winbio/nf-winbio-winbiocapturesample\" rel=\"nofollow noreferrer\">Winbio CaptureSampleImage</a> to get image data which is converted to a .bmp file and saved. I created a DLL file containing all the code related to my work with WBF. I am using this DLL in a Java Spring Boot Application using <a href=\"https://www3.ntu.edu.sg/home/ehchua/programming/java/JavaNativeInterface.html\" rel=\"nofollow noreferrer\">JNI</a>. The jar created by this is run via a .vbs file as given below.</p>\n\n<pre><code>Set shellObj = CreateObject(\"Shell.Application\")\nshellObj.ShellExecute \"C:\\Program Files\\Java\\jre1.8.0_192\\bin\\java.exe\", \"-jar MyApp.jar\", \"\", \"runas\", 0\n</code></pre>\n\n<p>\"runas\" is used to run jar as Administrator rights. \"0\" is used to set it invisible.</p>\n\n<p>I have previously used the DLL in a Jar running as a service using <a href=\"https://github.com/kohsuke/winsw\" rel=\"nofollow noreferrer\">WINSW</a>. For this I included <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winbio/nf-winbio-winbioacquirefocus\" rel=\"nofollow noreferrer\">WinBio AcquireFocus</a> after creating a session as mentioned in <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winbio/nf-winbio-winbioacquirefocus\" rel=\"nofollow noreferrer\">WinBio AcquireFocus</a> and <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winbio/nf-winbio-winbiocapturesample\" rel=\"nofollow noreferrer\">Winbio CaptureSampleImage</a> and it works perfectly fine.</p>\n\n<p>Now I have two scenerios.</p>\n\n<p><strong>1)</strong> I use the code provided in <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winbio/nf-winbio-winbiocapturesample\" rel=\"nofollow noreferrer\">Winbio CaptureSampleImage</a>. This approach gets stuck when following is called.</p>\n\n<pre><code>hr = WinBioCaptureSample(\n            sessionHandle,\n            WINBIO_NO_PURPOSE_AVAILABLE,\n            WINBIO_DATA_FLAG_RAW,\n            &amp;unitId,\n            &amp;sample,\n            &amp;sampleSize,\n            &amp;rejectDetail\n            );\n</code></pre>\n\n<p>that is no output is returned.</p>\n\n<p><strong>2)</strong> I use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winbio/nf-winbio-winbioacquirefocus\" rel=\"nofollow noreferrer\">WinBio AcquireFocus</a> like I did with my service. </p>\n\n<p>This prompts error:</p>\n\n<blockquote>\n  <p>Code : 0x80070005 (Access Denied).  </p>\n</blockquote>\n\n<p>Common HRESULT values are given <a href=\"https://docs.microsoft.com/en-us/windows/win32/seccrypto/common-hresult-values\" rel=\"nofollow noreferrer\">HERE</a>. This is probably because AcquireFocus can not be used in Application such as mine.</p>\n"}, {"tags": ["c++", "class", "oop", "instantiation", "copy-constructor"], "comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1576672177, "post_id": 59392050, "comment_id": 104973810, "body": "You need to implement a copy constructor. And if you also want just <code>deck = Deck()</code> (i.e., not upon declaration), then also an assignment operator."}, {"owner": {"reputation": 5476, "user_id": 3059024, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fecb9e1f75d3d01f4b4341c587fbe2c5?s=128&d=identicon&r=PG&f=1", "display_name": "CiaranWelsh", "link": "https://stackoverflow.com/users/3059024/ciaranwelsh"}, "reply_to_user": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1576672226, "post_id": 59392050, "comment_id": 104973842, "body": "Ah, I thought that it would be derived from <code>CardCollection</code>?"}, {"owner": {"reputation": 50917, "user_id": 947836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9addee65c2a92be93004ad689a7a415?s=128&d=identicon&r=PG&f=1", "display_name": "jrok", "link": "https://stackoverflow.com/users/947836/jrok"}, "edited": false, "score": 0, "creation_date": 1576672228, "post_id": 59392050, "comment_id": 104973845, "body": "And <code>Deck deck();</code> is a function declaration."}, {"owner": {"reputation": 1092, "user_id": 12041020, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc8u71hJet0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd2wJWzgeZZFzyYIPjeyVVaHUdwFA/photo.jpg?sz=128", "display_name": "m88", "link": "https://stackoverflow.com/users/12041020/m88"}, "edited": false, "score": 0, "creation_date": 1576672318, "post_id": 59392050, "comment_id": 104973885, "body": "Also your copy constructor should be  <code>CardCollection(const CardCollection&amp; other);</code>"}, {"owner": {"reputation": 12501, "user_id": 2038768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a5649dd767843ed7a69851ea5cbaf6?s=128&d=identicon&r=PG", "display_name": "Mikhail Vladimirov", "link": "https://stackoverflow.com/users/2038768/mikhail-vladimirov"}, "edited": false, "score": 1, "creation_date": 1576672400, "post_id": 59392050, "comment_id": 104973928, "body": "Constructors are not inherited, so you need to explicitly define copy constructor in subclass even if superclass already has copy constructor."}, {"owner": {"reputation": 5476, "user_id": 3059024, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fecb9e1f75d3d01f4b4341c587fbe2c5?s=128&d=identicon&r=PG&f=1", "display_name": "CiaranWelsh", "link": "https://stackoverflow.com/users/3059024/ciaranwelsh"}, "edited": false, "score": 0, "creation_date": 1576675104, "post_id": 59392050, "comment_id": 104975312, "body": "Thanks for all the advice - your input is valuable."}], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1576672629, "creation_date": 1576672629, "answer_id": 59392222, "question_id": 59392050, "link": "https://stackoverflow.com/questions/59392050/candidate-constructor-the-implicit-copy-constructor-not-viable-expects-an-l-v/59392222#59392222", "title": "Candidate constructor (the implicit copy constructor) not viable: expects an l-value for 1st argument", "body": "<p>For starters this</p>\n\n<pre><code>Deck deck();\n</code></pre>\n\n<p>is a function declaration that has no parameters and has the return type <code>Deck</code>.</p>\n\n<p>Secondly the copy constructor of the class CardCollection</p>\n\n<pre><code>CardCollection(CardCollection &amp;other);\n</code></pre>\n\n<p>can not bind the non-constant reference to a temporary object.</p>\n\n<p>Declare it like</p>\n\n<pre><code>CardCollection( const CardCollection &amp;other);\n</code></pre>\n"}], "owner": {"reputation": 5476, "user_id": 3059024, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fecb9e1f75d3d01f4b4341c587fbe2c5?s=128&d=identicon&r=PG&f=1", "display_name": "CiaranWelsh", "link": "https://stackoverflow.com/users/3059024/ciaranwelsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2004, "favorite_count": 0, "accepted_answer_id": 59392222, "answer_count": 1, "score": 3, "last_activity_date": 1576675122, "creation_date": 1576672082, "last_edit_date": 1592644375, "question_id": 59392050, "link": "https://stackoverflow.com/questions/59392050/candidate-constructor-the-implicit-copy-constructor-not-viable-expects-an-l-v", "title": "Candidate constructor (the implicit copy constructor) not viable: expects an l-value for 1st argument", "body": "<h1>The problem</h1>\n<p>I have a <code>Deck</code> class which is a container for 52 <code>Card</code> objects. <code>Deck</code> is derived from another class called <code>CardCollection</code> (since I want similar groups of Cards elsewhere that are not a full deck of cards). My Problem is that I can create a <code>Deck</code> object using</p>\n<pre><code>Deck deck();\n</code></pre>\n<p>But when I use</p>\n<pre><code>Deck deck = Deck();\n</code></pre>\n<p>Clang-tidy (in CLion) complains that <code>Candidate constructor (the implicit copy constructor) not viable: expects an l-value for 1st argument</code>. My understanding (based on <a href=\"https://stackoverflow.com/questions/49802012/different-ways-of-initializing-an-object-in-c/49802943\">this</a> question was that these two ways of instantiating were basically the same, but since one causes warnings</p>\n<h1>The Code</h1>\n<p>I'll only paste the constructors of these class declarations to prevent this beign a &quot;wall-o-text&quot; question.</p>\n<pre><code>//Card.h\n\n    class Card {\n    public:\n        int rank; \n        basic_string&lt;char&gt; suit;\n\n        Card(int r, std::string s); // rank and suit\n\n        ~Card();\n\n    //...\n}\n\n</code></pre>\n<pre><code>// CardCollection.h\n#include &lt;vector&gt;\n#include &quot;Card.h&quot;\n\n\nclass CardCollection {\n\nprotected:\n    vector&lt;Game::Card&gt; _cards;\npublic:\n    CardCollection();\n     ~CardCollection();\n     CardCollection(CardCollection &amp;other);\n     explicit CardCollection(int n);\n     explicit CardCollection(vector&lt;Game::Card&gt; &amp;cards);\n    //...\n</code></pre>\n<p>and</p>\n<pre><code>// Deck.h\n\n#include &quot;Card.h&quot;\n#include &lt;vector&gt;\n#include &quot;CardCollection.h&quot;\n\nclass Deck : public CardCollection {\npublic:\n    Deck();\n    ~Deck();\n    explicit Deck(vector&lt;Game::Card&gt; &amp;cards);\n    Deck * shuffle();\n    //...\n};\n\n\n</code></pre>\n"}, {"tags": ["c++", "abstract-class"], "comments": [{"owner": {"reputation": 4915, "user_id": 10686048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bffd06d00a80b9b69e83f561ee5a392?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisMM", "link": "https://stackoverflow.com/users/10686048/chrismm"}, "edited": false, "score": 2, "creation_date": 1576672192, "post_id": 59392032, "comment_id": 104973824, "body": "You can want <code>Control *ctrl = new \u2026</code>"}, {"owner": {"reputation": 1541, "user_id": 3111536, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9555afb668ee02d47b4737a74e93d4fa?s=128&d=identicon&r=PG&f=1", "display_name": "rashmatash", "link": "https://stackoverflow.com/users/3111536/rashmatash"}, "edited": false, "score": 0, "creation_date": 1576672708, "post_id": 59392032, "comment_id": 104974109, "body": "You also need to implement <code>calculateAction()</code> in your spline class."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1576673327, "post_id": 59392032, "comment_id": 104974410, "body": "<code>Control ctrl = new Spline(slowDownCoeff, timeRampFn, distanceRampFn);</code> - that makes no sense at all. <code>ctrl</code> is a concrete object (or about to be); not a pointer, and has no conversion constructor (which would be silly and an obvious design smell anyway). The followup code <code>ctrl.calculateAction</code> suggests you <i>think</i> this is a proper method for accessing polymorphic behavior; it isn&#39;t. Instead, <code>std::unique_ptr&lt;Control&gt; ctrl = std::make_unique&lt;Spline&gt;(...args...);</code>, then <code>ctrl-&gt;calculateAction(...);</code> seems like what you <i>probably</i> want."}, {"owner": {"reputation": 57, "user_id": 10607799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629a2899f5dfe3e15d03c0c20a7825e7?s=128&d=identicon&r=PG&f=1", "display_name": "M. Mustermann", "link": "https://stackoverflow.com/users/10607799/m-mustermann"}, "edited": false, "score": 0, "creation_date": 1576746180, "post_id": 59392032, "comment_id": 105000570, "body": "Thanks WhozCraig for your suggestion. Sadly it didnt work perfectly. I have changed it to <code>std::unique_ptr&lt;Control&gt; ctrl(new Spline(...));</code>. That works fine."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1576674926, "creation_date": 1576674926, "answer_id": 59392891, "question_id": 59392032, "link": "https://stackoverflow.com/questions/59392032/abstract-classes-and-constructor/59392891#59392891", "title": "Abstract classes and constructor", "body": "<blockquote>\n<pre><code>Control ctrl = ...\n</code></pre>\n</blockquote>\n\n<p>You have created a variable of type <code>Control</code>. This is not allowed because <code>Control</code> is an abstract type. This is why you get the error <code>cannot allocate an object of abstract type 'Control'</code>.</p>\n\n<p>Another problem would be that <code>Control</code> doesn't have a constructor that would take an argument of type <code>Spline*</code>.</p>\n\n<hr>\n\n<p>What you may have been trying to do is to create a base pointer to the derived object: <code>Control* ctrl = ...</code>. However, this would make deleting the dynamic allocation problematic, since you aren't allowed to delete through the base pointer because the destructor of the base is non-virtual. A solution is to declare the destructor virtual.</p>\n\n<p>But simply making deletion allowed is not sufficient. You should actually perform the deletion or else the memory may leak.</p>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 12357077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c950d7df91be91188252ecba362b9acd?s=128&d=identicon&r=PG&f=1", "display_name": "KimHajun", "link": "https://stackoverflow.com/users/12357077/kimhajun"}, "is_accepted": false, "score": 2, "last_activity_date": 1576676696, "creation_date": 1576676696, "answer_id": 59393370, "question_id": 59392032, "link": "https://stackoverflow.com/questions/59392032/abstract-classes-and-constructor/59393370#59393370", "title": "Abstract classes and constructor", "body": "<p>This should be the modified code you would want. </p>\n\n<p>main.cpp</p>\n\n<pre><code>RampFunction timeRampFn{0, 100, 2000, 1000};\nRampFunction distanceRampFn{0, 0, 0.5f, 1000};\n\nControl *ctrl = new Spline(slowDownCoeff, timeRampFn, distanceRampFn);\n\nctrl-&gt;calculateAction(&amp;newRobotState, p_0, p_t, targetTrack, timeFromStart, \ndistanceToTarget);\n</code></pre>\n\n<p>Control.hpp</p>\n\n<pre><code>#ifndef CONTROL_HPP\n#define CONTROL_HPP\n\n#include &lt;vector&gt;\n#include &lt;Data/Track.h&gt;\n#include &lt;Data/TrackPoint.h&gt;\n#include &lt;Data/RobotState.h&gt;\n#include &lt;boost/multiprecision/eigen.hpp&gt;\n\nusing Eigen::Vector2f;\nusing namespace std;\n\nclass Control\n{\nprivate:\nconst float FUTURE_INTERVAL = 0.1f;\n\nprotected:\nconst int FUTURE_SIZE = 10;\n\npublic:\nvirtual ~Control() {}\nvirtual void calculateAction(RobotState *state, Vector2f curPos, Vector2f refPos, Track targetTrack, float timeFromStart, float distanceToTarget) = 0;\n};\n\n#endif\n</code></pre>\n\n<p>Spline.hpp</p>\n\n<pre><code>#ifndef SPLINE_HPP\n#define SPLINE_HPP\n\n#include &lt;Control/Control.hpp&gt;\n\nusing Eigen::Vector2f;\nusing namespace std;\n\nclass Spline : Control\n{\nprivate:\nstruct RampFunction\n{\n    float x_0, val_0;\n    float x_e, val_e;\n};\nfloat slowDownCoeff;\nRampFunction timeRampFn;\nRampFunction distanceRampFn;\n\npublic:\nSpline(float slowDownCoeff, RampFunction timeRampFn, RampFunction distanceRampFn)\n: slowDownCoeff(slowDownCoeff), timeRampFn(timeRampFn), distanceRampFn(distanceRampFn) {}\n\nvirtual void calculateAction(RobotState *state, Vector2f curPos, Vector2f refPos, Track targetTrack, float timeFromStart, float distanceToTarget);\n};\n\n#endif\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10607799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629a2899f5dfe3e15d03c0c20a7825e7?s=128&d=identicon&r=PG&f=1", "display_name": "M. Mustermann", "link": "https://stackoverflow.com/users/10607799/m-mustermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 59392891, "answer_count": 2, "score": 1, "last_activity_date": 1576677128, "creation_date": 1576672012, "last_edit_date": 1576677128, "question_id": 59392032, "link": "https://stackoverflow.com/questions/59392032/abstract-classes-and-constructor", "title": "Abstract classes and constructor", "body": "<p>we are trying to implmenent a solution with abstract superclass in C++:\nControl is the super class of Spline and others.\nNow when we try to instantiate an object of type Spline the instantiation fails with two errors:</p>\n\n<blockquote>\n  <ol>\n  <li>cannot find method with matching parameters for the constructor of class Spline</li>\n  <li>cannot allocate an object of abstract type 'Control'</li>\n  </ol>\n</blockquote>\n\n<p>How can we fix those issues?</p>\n\n<p>Instantiate Spline of type Control and use it in main:</p>\n\n<pre><code>RampFunction timeRampFn{0, 100, 2000, 1000};\nRampFunction distanceRampFn{0, 0, 0.5f, 1000};\n\nControl ctrl = new Spline(slowDownCoeff, timeRampFn, distanceRampFn);\n\nctrl.calculateAction(&amp;newRobotState, p_0, p_t, targetTrack, timeFromStart, distanceToTarget);\n</code></pre>\n\n<p>Control.hpp (abstract super class):</p>\n\n<pre><code>#ifndef CONTROL_HPP\n#define CONTROL_HPP\n\n#include &lt;vector&gt;\n#include &lt;Data/Track.h&gt;\n#include &lt;Data/TrackPoint.h&gt;\n#include &lt;Data/RobotState.h&gt;\n#include &lt;boost/multiprecision/eigen.hpp&gt;\n\nusing Eigen::Vector2f;\nusing namespace std;\n\nclass Control\n{\nprivate:\nconst float FUTURE_INTERVAL = 0.1f;\n\nprotected:\nconst int FUTURE_SIZE = 10;\n\npublic:\nvirtual void calculateAction(RobotState *state, Vector2f curPos, Vector2f refPos, Track targetTrack, float timeFromStart, float distanceToTarget) = 0;\n};\n\n#endif\n</code></pre>\n\n<p>Spline.hpp:</p>\n\n<pre><code>#ifndef SPLINE_HPP\n#define SPLINE_HPP\n\n#include &lt;Control/Control.hpp&gt;\n\nusing Eigen::Vector2f;\nusing namespace std;\n\nclass Spline : Control\n{\nprivate:\nstruct RampFunction\n{\n    float x_0, val_0;\n    float x_e, val_e;\n};\nfloat slowDownCoeff;\nRampFunction timeRampFn;\nRampFunction distanceRampFn;\n\npublic:\nSpline(float slowDownCoeff, RampFunction timeRampFn, RampFunction distanceRampFn)\n{\n    this-&gt;slowDownCoeff = slowDownCoeff;\n    this-&gt;timeRampFn = timeRampFn;\n    this-&gt;distanceRampFn = distanceRampFn;\n}\nvirtual void calculateAction(RobotState *state, Vector2f curPos, Vector2f refPos, Track targetTrack, float timeFromStart, float distanceToTarget);\n};\n\n#endif\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "edited": false, "score": 4, "creation_date": 1576672425, "post_id": 59392026, "comment_id": 104973943, "body": "I&#39;d recommend you asking you teacher first. From your perspective it&#39;s a very valid case for <code>int</code> and definetely not for <code>enum</code>, but you might have misunderstood the problem."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 3, "creation_date": 1576672602, "post_id": 59392026, "comment_id": 104974040, "body": "There could be enums used for other types in this class. Perhaps transaction type however I don&#39;t see a use case for a transaction ID being an enum."}, {"owner": {"reputation": 12724, "user_id": 12139179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a50aa08ca41bf24e8478a9b4dbc067c3?s=128&d=identicon&r=PG&f=1", "display_name": "RobertS supports Monica Cellio", "link": "https://stackoverflow.com/users/12139179/roberts-supports-monica-cellio"}, "edited": false, "score": 0, "creation_date": 1576673575, "post_id": 59392026, "comment_id": 104974544, "body": "Even if you have explained it quite sufficient. Can you provide your code to your question?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1576674415, "post_id": 59392026, "comment_id": 104974985, "body": "In C++17 (relying on <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/enumerations-cpp?view=vs-2019\" rel=\"nofollow noreferrer\">Microsoft docs</a>)  one could use an enum with an explicit underlying type but without enumerators, essentially creating a new integral type without implicit conversion to the underlying type. This would be more <b>type-safe</b> and prevent errors when used as arguments to functions which expect zip codes, money amounts or other numbers. You&#39;ll have to cast every time you <i>do</i> want to use it as a number though, e.g. for incrementing."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 12558540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd240074d130edf405087acd316c6da?s=128&d=identicon&r=PG&f=1", "display_name": "JamesD", "link": "https://stackoverflow.com/users/12558540/jamesd"}, "edited": false, "score": 2, "creation_date": 1576672320, "post_id": 59392073, "comment_id": 104973888, "body": "Thanks for your answer. Unfortunately the progressive number can be increased unlimitedly because it is not possible to know how many transactions will be added. It is an application for banking transactions and each time the user makes a transaction, it is added to the carrier and the progressive number is consequently increased"}, {"owner": {"reputation": 39, "user_id": 12558540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd240074d130edf405087acd316c6da?s=128&d=identicon&r=PG&f=1", "display_name": "JamesD", "link": "https://stackoverflow.com/users/12558540/jamesd"}, "edited": false, "score": 0, "creation_date": 1576672523, "post_id": 59392073, "comment_id": 104974004, "body": "unfortunately I also think so. Do you know other ways to do it? Thanks anyway for your availability"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1576672706, "post_id": 59392073, "comment_id": 104974107, "body": "I would make this a static class member unsigned int or int."}, {"owner": {"reputation": 329, "user_id": 5859234, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3a0a4e07f31c0a9e12ce19463a7b13b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Beyit", "link": "https://stackoverflow.com/users/5859234/ali-beyit"}, "edited": false, "score": 0, "creation_date": 1576678874, "post_id": 59392073, "comment_id": 104977299, "body": "If that&#39;s the case it is not possible or not feasible to use enum type for this."}], "tags": [], "owner": {"reputation": 329, "user_id": 5859234, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3a0a4e07f31c0a9e12ce19463a7b13b3?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Beyit", "link": "https://stackoverflow.com/users/5859234/ali-beyit"}, "is_accepted": false, "score": 0, "last_activity_date": 1576672175, "creation_date": 1576672175, "answer_id": 59392073, "question_id": 59392026, "link": "https://stackoverflow.com/questions/59392026/progressive-number-in-a-class/59392073#59392073", "title": "Progressive number in a class", "body": "<p>If progressiveNumber values are known then it is possible and valid way to do. Think about seasons, you have \"Spring, Summer, Autumn, Winter\". Would you rather create an array/list of string to keep them or you simply create an enum called \"Sesons\" and you store your stuff in there ready to use easily.</p>\n"}, {"tags": [], "owner": {"reputation": 537, "user_id": 10084026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gbEQP.jpg?s=128&g=1", "display_name": "Jiri Otoupal \u30a4\u308a \u30aa\u30c8\u30a6\u30d1\u30fc", "link": "https://stackoverflow.com/users/10084026/jiri-otoupal-%e3%82%a4%e3%82%8a-%e3%82%aa%e3%83%88%e3%82%a6%e3%83%91%e3%83%bc"}, "is_accepted": false, "score": 0, "last_activity_date": 1576673369, "creation_date": 1576673369, "answer_id": 59392451, "question_id": 59392026, "link": "https://stackoverflow.com/questions/59392026/progressive-number-in-a-class/59392451#59392451", "title": "Progressive number in a class", "body": "<p>Both ways are possible but i would prefer using unsigned int for your case.</p>\n\n<p>Try do some format with index of transaction in vector and bank account\nBest way is to do some formating in bytes. In that way you can make ID of transaction in way that is actualy usable.\nSomething like 12 Bytes of BankAccountID and 12B that is Transaction_Index in vector of bank account. It will be faster and transaction can be tracked globaly so you dont have to browse bank accounts for every transaction. This way finding the transaction will be O(1).</p>\n\n<p>Use the Byte encoding and then just convert it to uint256 or from uint256.</p>\n\n<p>I hoped this helped you.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 12558540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd240074d130edf405087acd316c6da?s=128&d=identicon&r=PG&f=1", "display_name": "JamesD", "link": "https://stackoverflow.com/users/12558540/jamesd"}, "is_accepted": false, "score": 0, "last_activity_date": 1576677947, "creation_date": 1576677947, "answer_id": 59393767, "question_id": 59392026, "link": "https://stackoverflow.com/questions/59392026/progressive-number-in-a-class/59393767#59393767", "title": "Progressive number in a class", "body": "<p>thank you all for your answers and availability, I regret not having attached the code to the question but I have only today registered for this platform and I still have to get used to it.</p>\n\n<p>however I think I put the progressiveNumber attribute as static int and declare a get method and an assignID () method</p>\n"}], "owner": {"reputation": 39, "user_id": 12558540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd240074d130edf405087acd316c6da?s=128&d=identicon&r=PG&f=1", "display_name": "JamesD", "link": "https://stackoverflow.com/users/12558540/jamesd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1576677947, "creation_date": 1576671994, "last_edit_date": 1576672788, "question_id": 59392026, "link": "https://stackoverflow.com/questions/59392026/progressive-number-in-a-class", "title": "Progressive number in a class", "body": "<p>I'll explain my problem to you.\nI have a class called BankAccount which has a vector of objects of type Transaction.\nThe BankAccount class has a method called assignID () that assigns a unique ID to each newly added transaction to the vector.\nI thought of declaring an integer within the BankAccount class called progressiveNumber that is assigned to each new transaction added to the carrier, and then increase, and so on.\nMy teacher after viewing it said that progressiveNumber should be \"enum\" instead of \"int\".\nIt's possible? if not possible, how can I do this without using \"int\"?</p>\n"}, {"tags": ["c++", "ifstream", "ofstream"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1576672103, "post_id": 59391990, "comment_id": 104973775, "body": "My guess is that the programs <i>working directory</i> when running isn&#39;t what you expect it to be, making all relative paths (which are relative from the working directory) invalid. How do you build your program? And more importantly, how do you <i>run</i> your program?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1576672457, "post_id": 59391990, "comment_id": 104973963, "body": "You can check the working directory from inside the program with the <code>getcwd</code> system call. It will be different from &quot;/Users/*username*/Documents/blabla&quot;."}, {"owner": {"reputation": 1, "user_id": 9001982, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a9AUfpco1A0/AAAAAAAAAAI/AAAAAAAABuQ/idHrOBl0TaQ/photo.jpg?sz=128", "display_name": "ufear", "link": "https://stackoverflow.com/users/9001982/ufear"}, "edited": false, "score": 0, "creation_date": 1576672474, "post_id": 59391990, "comment_id": 104973971, "body": "Thank you, why I didn&#39;t think about it... I compiled it in atom with gcc compiler, it seems, that it makes a.out in the another direction. I tryed it in terminal with short path and it worked."}, {"owner": {"reputation": 3693, "user_id": 11455384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e87a1e837a79a0248716b61a930f67fa?s=128&d=identicon&r=PG&f=1", "display_name": "Fareanor", "link": "https://stackoverflow.com/users/11455384/fareanor"}, "edited": false, "score": 0, "creation_date": 1576672891, "post_id": 59391990, "comment_id": 104974211, "body": "You may be interested by <a href=\"https://stackoverflow.com/questions/57626409/how-can-i-access-resources-in-c-without-setting-the-full-path/57627566#57627566\">this SO thread</a> that shows a way to safely use relative paths from the executable location."}], "owner": {"reputation": 1, "user_id": 9001982, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a9AUfpco1A0/AAAAAAAAAAI/AAAAAAAABuQ/idHrOBl0TaQ/photo.jpg?sz=128", "display_name": "ufear", "link": "https://stackoverflow.com/users/9001982/ufear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576672504, "creation_date": 1576671871, "last_edit_date": 1576672504, "question_id": 59391990, "link": "https://stackoverflow.com/questions/59391990/ifstream-short-path-doesnt-work-in-c-macos", "title": "ifstream short path doesn&#39;t work in c++, macos", "body": "<p>There are 3 lines from my draft. It runs perfectly, although it may have some weaknesses.</p>\n\n<p>My problem is that when I'm compiling it in my Mac OS machine, <code>std::ifstream</code> doesn't work with short paths, only with full paths.<br/>\nFile \"names.txt\" is in the same folder with the program and the file \"usednames.txt\".<br/>\nShort paths work in Linux and Windows, but it is not in Mac OS.<br/>\nThe same problem with <code>fopen()</code> in C. It doesn't work with \"names.txt\", \"./names.txt\", and also I can output an error, if I'll try this. </p>\n\n<p>Is it a way to solve it, or it is in understanding Mac OS, or I'm doing something wrong?</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>std::ifstream names(\"/Users/*username*/Documents/blabla/names.txt\");\nstd::ifstream usednamesRead(\"/Users/*username*/Documents/blabla/usednames.txt\");\nusednames.open(\"/Users/*username*/Documents/blabla/usednames.txt\", std::ios::app);\n</code></pre>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1576671709, "post_id": 59391867, "comment_id": 104973603, "body": "<i>&quot;The union is only as big as necessary to hold its largest data member. The other data members are allocated in the same bytes as part of that largest member. The details of that allocation are <b>implementation-defined</b>... &quot;</i> source: <a href=\"https://en.cppreference.com/w/cpp/language/union\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/union</a>"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1576671723, "post_id": 59391867, "comment_id": 104973613, "body": "What do you mean by &quot;memory is created&quot;? Do you mean &quot;how is this struct laid out in memory?&quot; Please try use standard terminology."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1576671730, "post_id": 59391867, "comment_id": 104973622, "body": "Wrong intuition: memory is not created, just allocated. And you need to read a good C++ programming book, like <a href=\"http://stroustrup.com/Programming/\" rel=\"nofollow noreferrer\">this one</a>. Later read some C++ standard, like <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf\" rel=\"nofollow noreferrer\">n3337</a>. We cannot teach you C++ in a few paragraphs."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1576672696, "post_id": 59391867, "comment_id": 104974097, "body": "<a href=\"https://en.cppreference.com/w/cpp/language/union\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/union</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1576680299, "post_id": 59391867, "comment_id": 104978141, "body": "<a href=\"https://stackoverflow.com/a/2902171/17034\">stackoverflow.com/a/2902171/17034</a>"}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 8410314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154b1439add01d03d847fcf5c1b2608a?s=128&d=identicon&r=PG&f=1", "display_name": "Lior", "link": "https://stackoverflow.com/users/8410314/lior"}, "is_accepted": false, "score": 1, "last_activity_date": 1576671971, "creation_date": 1576671971, "answer_id": 59392019, "question_id": 59391867, "link": "https://stackoverflow.com/questions/59391867/how-is-memory-allocated-for-nested-struct-and-union-inside-a-struct/59392019#59392019", "title": "How is memory allocated for nested struct and union inside a struct?", "body": "<p>When declaring a union. all the union's variables coincide in memory (occupy the same space).</p>\n\n<p>In your example, the array and the struct exist on the same exact memory space. so setting array[0] will overwrite a1. array[1] will overwrite a2 and so on...</p>\n"}, {"tags": [], "owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "is_accepted": false, "score": 1, "last_activity_date": 1576678788, "creation_date": 1576678788, "answer_id": 59394021, "question_id": 59391867, "link": "https://stackoverflow.com/questions/59391867/how-is-memory-allocated-for-nested-struct-and-union-inside-a-struct/59394021#59394021", "title": "How is memory allocated for nested struct and union inside a struct?", "body": "<p>While a struct places its members next to each other, a union essentially overlays its members on top of each other. Of the members of a struct, all can be alive at the same time. Of the members of a union, at most one can be alive at any point in time. The value of a struct can be any combination of values of its members. The value of a union, on the other hand, can only be the value of one of its members. A <code>union</code> is useful in cases where you need to keep only one of a set of different kinds of values at a time.</p>\n\n<p>In your particular example, the union inside <code>struct A</code> essentially overlays the member <code>array</code>, which is an array of ten <code>int</code>, with an anonymous struct that has ten members of type <code>int</code> (note, anonymous structs are non-standard but supported by most compilers). It does so, presumably, to be able to access the members of the struct either by their name or, through the array, by their \"index\". The memory layout of an array of ten <code>int</code> and of a struct with ten members of type <code>int</code> will usually be such that consecutive members of the struct will end up coinciding in memory with consecutive elements of the array. Thus, this will usually \"work\" in practice most of the time.</p>\n\n<p>While this will usually \"work\" in practice most of the time, it is not correct C++ (hence the \"\"). By assigning to an element of the array, you begin the lifetime of that union member <a href=\"https://timsong-cpp.github.io/cppwp/n4659/class.union#5\" rel=\"nofollow noreferrer\">[class.union]/5</a>. Beginning the lifetime of that union member ends the lifetime of any other union member that may have been alive before <a href=\"https://timsong-cpp.github.io/cppwp/n4659/basic.life#1\" rel=\"nofollow noreferrer\">[basic.life]/1</a>. This means that the moment you assign something to an element of the array, the struct is no longer alive. And the moment you assign something to a member of the struct, the array is no longer alive. Attempting to access a member of the struct while the array is alive, or attempting to access an element of the array while the struct is alive results in undefiend behavior (because you're attempting to access the value of an object that does not exist in a way not subject to any exception that would explicitly allow you to do so <a href=\"https://timsong-cpp.github.io/cppwp/n4659/class#mem-23\" rel=\"nofollow noreferrer\">[class.mem]/23</a>). Don't do this, it's simply wrong.</p>\n\n<p>The memory for an <code>A</code> is \"created\" like that for any other struct. You create an object of the particular type. Doing so will either allocate storage for the object automatically or require that you did so manually before you would even be able to create an object in the first place. The non-static data members of your struct <code>A</code> are subobjects of the struct. They are part of the struct object. When the complete <code>A</code> object gets destroyed and the memory allocated for it is released, the non-static data members are also destroyed and the memory is released since it was part of the memory allocated for the complete object\u2026</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3138495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1576678788, "creation_date": 1576671459, "last_edit_date": 1576672209, "question_id": 59391867, "link": "https://stackoverflow.com/questions/59391867/how-is-memory-allocated-for-nested-struct-and-union-inside-a-struct", "title": "How is memory allocated for nested struct and union inside a struct?", "body": "<pre><code>struct A\n{\n     union \n    {\n       int array[10];\n\n    struct \n        {\n        int a1;\n        int a2;\n        ...\n        ...\n        int a10;\n        };\n\n};\n\nA a; //1 - structure defination\na.array[0] = 10 //2 - then a.a1 is also assigned with value 10. so how does memory is created.\n\nA *a = new A;\ndelete a;// does compiler takes care of deleting union and struct members inside struct ? \n</code></pre>\n\n<p>Came across this snippet of code online, can anyone explains how memory is created for the above struct because when a value is assigned to union of array then it gets assigned to inner struct variables.</p>\n\n<p>I think initially innermost will Struct gets created with memory separately for each member, how does memory is cerated for union.union creates a single block with the 10*double size but hows does mapping is created between inner union and struct.</p>\n"}, {"tags": ["c++", "oop", "debugging", "data-structures"], "comments": [{"owner": {"reputation": 111, "user_id": 6081267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7b3f939dec3b4124813316b764d7636?s=128&d=identicon&r=PG&f=1", "display_name": "nromashchenko", "link": "https://stackoverflow.com/users/6081267/nromashchenko"}, "edited": false, "score": 1, "creation_date": 1576671186, "post_id": 59391717, "comment_id": 104973339, "body": "<code>void printMaxQuantity() {         int maxValue=0;         for (int i = 0; i &lt; 1000000; ++i) {             if(table[i]-&gt;quantity &gt; maxValue)</code> -- did not you forget to check if <code>table[i]</code> is not null?"}, {"owner": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "reply_to_user": {"reputation": 111, "user_id": 6081267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7b3f939dec3b4124813316b764d7636?s=128&d=identicon&r=PG&f=1", "display_name": "nromashchenko", "link": "https://stackoverflow.com/users/6081267/nromashchenko"}, "edited": false, "score": 0, "creation_date": 1576671383, "post_id": 59391717, "comment_id": 104973437, "body": "You are right, I will update the code, now the second output is correct."}, {"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "edited": false, "score": 0, "creation_date": 1576672049, "post_id": 59391717, "comment_id": 104973756, "body": "Very good question and honestly asked"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 0, "creation_date": 1576673156, "post_id": 59392186, "comment_id": 104974339, "body": "In First step, I need to copy the first 10 elements into my array without any sorting right ? just copy the first 10, did i understand correctly ?"}, {"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "reply_to_user": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 1, "creation_date": 1576673350, "post_id": 59392186, "comment_id": 104974417, "body": "@BerkayEmreYoran you need to copy the values indeed. In the next step you will take care of the sorting."}, {"owner": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 0, "creation_date": 1576675624, "post_id": 59392186, "comment_id": 104975554, "body": "I think this way make my code slow because I need the show this output <a href=\"https://pasteboard.co/ILP9Hss.png\" rel=\"nofollow noreferrer\">pasteboard.co/ILP9Hss.png</a>, which mean that we need to take StockCode, Description, Quantity from csv file.To be clear, If I sort my Quantities in array, I have to search which StockCode depend on max Quantity in my array.So I&#39;m still about the pick maxQuantity from hashtable and delete it&#39;s index and again pick max one so the second MaxQuantity should be less than the first one we picked"}, {"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "reply_to_user": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 1, "creation_date": 1576676389, "post_id": 59392186, "comment_id": 104975978, "body": "@BerkayEmreYoran I think you have misunderstood my point. I&#39;m only advocating to sort by quality in the 10-element array, not in the large data structure. Doing a sort for the first 10 elements should be quick. And when an item is to be inserted into this array, nothing stops you from storing the associated values of that item into another array having a structure of 10 elements. You will only need to loop your records once."}, {"owner": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 0, "creation_date": 1576684178, "post_id": 59392186, "comment_id": 104980432, "body": "You have a point about creating an array, sorry for misunderstood, thank you so much"}, {"owner": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 0, "creation_date": 1576689109, "post_id": 59392186, "comment_id": 104983192, "body": "<a href=\"https://pasteboard.co/ILQEIIM.png\" rel=\"nofollow noreferrer\">pasteboard.co/ILQEIIM.png</a> Here what I got, I would be greatful if you share your ideas about my code performance"}, {"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "reply_to_user": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "edited": false, "score": 1, "creation_date": 1576690026, "post_id": 59392186, "comment_id": 104983640, "body": "@BerkayEmreYoran 13 seconds sounds reasonable given the fact that you operate with file operations and 500 000 records, but this opinion is subjective on my part. I would advise you to temporarily remove (comment out) the parts which are dealing with parsing the records that you read and measure the read itself. If would be very helpful to see how much time it takes only to read the CSV file records. Subtracting this second time from 13 seconds would be an extremely useful result, indicating the actual performance."}], "tags": [], "owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "is_accepted": false, "score": 2, "last_activity_date": 1576672520, "creation_date": 1576672520, "answer_id": 59392186, "question_id": 59391717, "link": "https://stackoverflow.com/questions/59391717/how-to-pick-the-max-top-10-quantity-from-hashtable-c/59392186#59392186", "title": "How to pick the max top 10 quantity from HashTable C++?", "body": "<p>Since this is homework, I will avoid writing actual code. Since you do not have any prior information about the actual data set, you will need to loop through it, which is a linear complexity. In order to find the top 10 items I advise you to create an array of 10 items to store the best items you get so far.</p>\n\n<p>The first step is to copy the first 10 elements into your array.</p>\n\n<p>The second step is sort your array of 10 items descendingly, so you will always use the last item for comparison.</p>\n\n<p>Now you can loop the big structure and on each step, compare the current item with the last one of the array of ten elements. If it's lower, then do nothing. If it's higher, then find the highest ranked item in your array of 10 items which is smaller than the item you intend to insert due to higher quality. When you find that item, loop from the end until this item until your array of ten elements and on each step override the curret element with the current one. Finally override the now duplicate element.</p>\n\n<p>Example: Assuming that your 7th element has lower quality than the one you intend to insert, but the 6th has higher quality override 9th element with the 8th, then the 8th with the 7th and then the 7th with the item you just found. Remember that array indexes start from 0.</p>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 12512976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58799337bad9dcb5e0e03cbaf82269b6?s=128&d=identicon&r=PG&f=1", "display_name": "mryunus", "link": "https://stackoverflow.com/users/12512976/mryunus"}, "is_accepted": false, "score": 1, "last_activity_date": 1576725605, "last_edit_date": 1576725605, "creation_date": 1576711501, "answer_id": 59401360, "question_id": 59391717, "link": "https://stackoverflow.com/questions/59391717/how-to-pick-the-max-top-10-quantity-from-hashtable-c/59401360#59401360", "title": "How to pick the max top 10 quantity from HashTable C++?", "body": "<p><strong>This question already has an answer.</strong> But I want to show you how to perform selection sort so you can compare it with your code. </p>\n\n<blockquote>\n  <p>**Performance trick: ** Quick Sort algorithm can be used instead of Selection Sort</p>\n</blockquote>\n\n<p><strong>hashMap=hashTable, hashEntry=Node, so this what I did:</strong></p>\n\n<pre><code>void hashTable::selectionSort() {\nint firstCounter, secondCounter;\nNode *emptyOne = new Node(\"empty\", \"thisEmpty\", 0);\nNode *temp;\nfor (firstCounter = 1; firstCounter &lt; TABLE_SIZE; firstCounter++) {\n    if (table[firstCounter] == nullptr) {\n        table[firstCounter] = emptyOne;\n    }\n    temp = table[firstCounter];\n    secondCounter = firstCounter - 1;\n    if (table[secondCounter] == nullptr) {\n        table[secondCounter] = emptyOne;\n    }\n    while (secondCounter &gt;= 0 &amp;&amp; table[secondCounter]-&gt;quantity &gt; temp-&gt;quantity) {\n        table[secondCounter + 1] = table[secondCounter];\n        secondCounter = secondCounter - 1;\n        if (table[secondCounter] == nullptr) {\n            table[secondCounter] = emptyOne;\n        }\n    }\n    table[secondCounter + 1] = temp;\n} \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 12512976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58799337bad9dcb5e0e03cbaf82269b6?s=128&d=identicon&r=PG&f=1", "display_name": "mryunus", "link": "https://stackoverflow.com/users/12512976/mryunus"}, "is_accepted": true, "score": 2, "last_activity_date": 1576883264, "creation_date": 1576883264, "answer_id": 59432221, "question_id": 59391717, "link": "https://stackoverflow.com/questions/59391717/how-to-pick-the-max-top-10-quantity-from-hashtable-c/59432221#59432221", "title": "How to pick the max top 10 quantity from HashTable C++?", "body": "<p>This is what you want clearly.This code pick the top 10 from your hash table</p>\n\n<pre><code>void hashTable::printTopTen() {\nint maxValue = 0;\nint indexHolder = 0;\ncout &lt;&lt; \"#\" &lt;&lt; \" \" &lt;&lt; \"Stock Code\" &lt;&lt; \"\\t\" &lt;&lt; \"Description\" &lt;&lt; \"\\t\\t\\t\" &lt;&lt; \"Quantity\" &lt;&lt; endl;\nfor (int i = 0; i &lt; 10; ++i) {  //-&gt; This loop for top 10\n    for (int index = 0; index &lt; TABLE_SIZE; ++index) { //-&gt; base loop to find max quantity in hash table\n        if (table[index] != nullptr) {  // to check if index is NULL or not\n            if (table[index]-&gt;quantity &gt; maxValue) {\n                maxValue = table[index]-&gt;quantity; //update the maxValue with biggest quantity\n                indexHolder = index; // -&gt; to store index number of max quantity in hash table\n            }\n        }\n    }\n    for (int indeX = 0; indeX &lt; TABLE_SIZE; ++indeX) { //find the max quantity's stockCode,description\n        if (table[indeX] != nullptr) { // to check if index is NULL or not\n            if (table[indeX]-&gt;quantity == maxValue) { //if we have reached the maxValue then it's quantity is top 1\n                cout &lt;&lt; i + 1 &lt;&lt; \".\" &lt;&lt; \" \" &lt;&lt; table[indeX]-&gt;stockCode &lt;&lt; \"\\t\" &lt;&lt; table[indeX]-&gt;description\n                     &lt;&lt; \"\\t\" &lt;&lt; table[indeX]-&gt;quantity &lt;&lt; endl;\n                table[indexHolder]-&gt;quantity = 0; //after cout the max one, delete the index so it can't be top 1 again\n            }\n        }\n    }\n    maxValue = 0; // update max value 0 again for second base loop\n}\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 33, "user_id": 12558338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/772f6d6e00505ac476c57794e1747c9d?s=128&d=identicon&r=PG&f=1", "display_name": "BerkayEmreYoran", "link": "https://stackoverflow.com/users/12558338/berkayemreyoran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 59432221, "answer_count": 3, "score": 3, "last_activity_date": 1576883402, "creation_date": 1576670903, "last_edit_date": 1576883402, "question_id": 59391717, "link": "https://stackoverflow.com/questions/59391717/how-to-pick-the-max-top-10-quantity-from-hashtable-c", "title": "How to pick the max top 10 quantity from HashTable C++?", "body": "<p><strong>I already wrote a working project but my problem is, the last part.I have already Read 500.000 row from csv file into vector, then put into the hashtable.I can print whole hashtable but I need to pick top 10 Quantity from my hashtable.Just be clear, I am not about to sort the whole hashtable, just pick top 10.</strong></p>\n\n<p>The topic of my project is,program must be able to store individual products (given with StockCode) from csv file and insert it into a suitable data structure. If that product is already inserted into the structure, its counter must be increased by the quantity of the order.After reading and processing is over, your program must list the \u201ctop 10\u201d products ordered by individuals.</p>\n\n<p>There is rule about the libraries, This will be a proper C++ class. You must be able to create many instances of this class. (Please use no third party libraries and C++ STL, Boost etc.) However, you can use, iostream, ctime, fstream, string like IO and string classes.</p>\n\n<p><strong>Important note: Only thing I should focus is speed, storage or size is not a problem.</strong></p>\n\n<blockquote>\n  <p>What I've done so far is,</p>\n  \n  <ul>\n  <li>Read Csv file row by row into vector</li>\n  <li>Stockcodes in row[1], Quantity in row[3]</li>\n  <li>Put them into Hashtable and increase their quantity by the quantity of the order.</li>\n  <li>Print the whole hash table.</li>\n  </ul>\n  \n  <p>What I need to do is,</p>\n  \n  <ul>\n  <li>Print the Top 10 Quantity</li>\n  </ul>\n</blockquote>\n\n<p>Now let's share Example csv file, Driver program codes, Output of the print function.</p>\n\n<p>Csv File look like this:</p>\n\n<pre><code>InvoiceNo;StockCode;Description;Quantity;\n536365;85123A;WHITE HANGING HEART T-LIGHT HOLDER;6\n536365;71053;WHITE METAL LANTERN;6;\n536365;84029G;KNITTED UNION FLAG HOT WATER BOTTLE;6;\n536365;84029E;RED WOOLLY HOTTIE WHITE HEART.;6;\n536365;22752;SET 7 BABUSHKA NESTING BOXES;2;\n536365;21730;GLASS STAR FROSTED T-LIGHT HOLDER;6;\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>    void printMaxQuantity() {\n        int maxValue=0;\n        for (int i = 0; i &lt; 1000000; ++i) {\n            if(table[i] != nullptr) {\n                if (table[i]-&gt;quantity &gt; maxValue)\n                    maxValue = table[i]-&gt;quantity;\n                if (table[i]-&gt;quantity == maxValue) {\n                    cout &lt;&lt; \"Index: \" &lt;&lt; i &lt;&lt; endl;\n                    cout &lt;&lt; \"StockCode: \" &lt;&lt; table[i]-&gt;stockCode &lt;&lt; endl;\n                    cout &lt;&lt; \"Quantity: \" &lt;&lt; table[i]-&gt;quantity &lt;&lt; endl;\n                    cout &lt;&lt; endl &lt;&lt; endl;\n                }\n            }\n        }\n    }\n};\n</code></pre>\n\n<p>Here the output:(After edit the code StockCode: 85123A is correct output, but still struggling about the top 10)</p>\n\n<pre><code>Index: 41240\nStockCode: 10002\nQuantity: 48\n\n\nIndex: 309193\nStockCode: 85123A\nQuantity: 72\n\n\n\nProcess finished with exit code 0\n</code></pre>\n\n<p>Also one last note, I am doing this for a school project so I shouldn't use any third party software or include any different libraries because it is not allowed (I will implement my own vector class later)</p>\n"}, {"tags": ["c++", "random"], "comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1576669662, "post_id": 59391215, "comment_id": 104972602, "body": "How often are you creating random number engines that this matters?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 3, "creation_date": 1576669823, "post_id": 59391215, "comment_id": 104972667, "body": "Nothing prevents the constructors from accessing singletons behind the scenes. In any event, without evidence of a problem in a particular use case (e.g. performance measurement and profiling shows the creation of <code>random_device</code> and application of the distribution is a performance hotspot, that causes a particular program to not meet its requirements) then that sort of thing qualifies as premature optimisation. As a rough rule, if they haven&#39;t done thorough testing/profiling, programmers tend to over-estimate the impacts of such things, and over-estimate their ability to optimise their code."}, {"owner": {"reputation": 1628, "user_id": 4000694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6dFJ5.jpg?s=128&g=1", "display_name": "HappyCactus", "link": "https://stackoverflow.com/users/4000694/happycactus"}, "edited": false, "score": 0, "creation_date": 1576669864, "post_id": 59391215, "comment_id": 104972683, "body": "Not very often, specifically. But if widespread in different context and different parts of the code, it seems to me that&#39;s may be an issue. I suspect it would be a good idea to instantiate a monostate object with <code>random_device</code> and <code>random_engine</code> and use it instead."}, {"owner": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1576673425, "post_id": 59391215, "comment_id": 104974463, "body": "I&#39;ve only seen suggestion to seed a pseudo-random bit generator (e.g. <code>mt19937</code>) once with <code>random_device</code> and use that generator all over the program. I wonder where it&#39;s suggested to directly use <code>random_device</code> for random number generation."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1576673439, "post_id": 59391215, "comment_id": 104974473, "body": "@HappyCactus that would cause all kinds of havoc in combination with <code>fork</code>"}, {"owner": {"reputation": 1628, "user_id": 4000694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6dFJ5.jpg?s=128&g=1", "display_name": "HappyCactus", "link": "https://stackoverflow.com/users/4000694/happycactus"}, "reply_to_user": {"reputation": 10203, "user_id": 4672588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcbc85fb3b43202dab37afb2bd5281e?s=128&d=identicon&r=PG&f=1", "display_name": "cpplearner", "link": "https://stackoverflow.com/users/4672588/cpplearner"}, "edited": false, "score": 0, "creation_date": 1576686017, "post_id": 59391215, "comment_id": 104981529, "body": "@cpplearner, no: but all the snippets I&#39;ve found sofar instantiate a generator (<code>mt19937</code>) with a seed taken from a new instance of <code>random_device</code>. Nowhere I&#39;ve seen they remark the possible overhead of this instantiation. From this comes my question."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1576716862, "post_id": 59391215, "comment_id": 104992916, "body": "<code>random_device</code> is slow but you only need to instantiate it once (per thread) and use it once (per thread) to initialize your <code>thread_local</code> generator. The only time it would matter is if you created many generators, but you usually shouldn&#39;t. Use one generator and multiple distributions. Distributions are cheap to create."}], "owner": {"reputation": 1628, "user_id": 4000694, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6dFJ5.jpg?s=128&g=1", "display_name": "HappyCactus", "link": "https://stackoverflow.com/users/4000694/happycactus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1576669072, "creation_date": 1576669072, "question_id": 59391215, "link": "https://stackoverflow.com/questions/59391215/stdrandom-device-constructor-overhead", "title": "std::random_device constructor overhead", "body": "<p>From many sources in the net, it is suggested the use of <code>random_device</code> to produce random numbers. All of the code instantiate <code>random_device</code>, applies the proper <code>random_engine</code> or distribution, and makes use of it.\nI'm wondering, what is the overhead of such pattern?\nInstantiating the <code>random_device</code> will require the opening of <code>/dev/urandom</code> on linux, so the overhead may be heavier than it seems to appear from that sources.\nShouldn't be recommended of a monostate/singleton pattern for this instead?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "qt", "qwebengineview", "qwebpage"], "owner": {"reputation": 11, "user_id": 12231588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e72ae6e05f4f19818d83da91121bf3ea?s=128&d=identicon&r=PG&f=1", "display_name": "jetownfeve21", "link": "https://stackoverflow.com/users/12231588/jetownfeve21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576668667, "creation_date": 1576668667, "question_id": 59391120, "link": "https://stackoverflow.com/questions/59391120/hide-reload-action-in-qt-context-menu", "title": "Hide Reload action in Qt context menu", "body": "<p>I want to hide the <code>Reload</code> option from the default context menu of Qt webenginepage. I have already removed other options such as <code>Save page</code> and <code>View source</code> doing this : </p>\n\n<pre><code>WebPage::WebPage(QObject *parent) :\n    QWebEnginePage(parent)\n{\n    action(QWebEnginePage::SavePage)-&gt;setVisible(false);\n    action(QWebEnginePage::ViewSource)-&gt;setVisible(false);\n    connect(QWebEngineProfile::defaultProfile(), &amp;QWebEngineProfile::downloadRequested, this, &amp;WebPage::startDownload);\n}\n</code></pre>\n\n<p>So I try to do the same for the <code>Reload</code> option like this : </p>\n\n<pre><code>action(QWebEnginePage::Reload)-&gt;setVisible(false);\n</code></pre>\n\n<p>But it doesn't work this time, any idea ?</p>\n"}]