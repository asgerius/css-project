[{"tags": ["c++"], "comments": [{"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1510185605, "post_id": 47191747, "comment_id": 81332841, "body": "Is the assignment about writing your own pseudo-random number generator?"}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1510185777, "post_id": 47191747, "comment_id": 81332898, "body": "Take a look here: <a href=\"https://en.wikipedia.org/wiki/Linear-feedback_shift_register\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Linear-feedback_shift_register</a>"}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1510186004, "post_id": 47191747, "comment_id": 81332953, "body": "See <a href=\"https://stackoverflow.com/questions/3062746/special-simple-random-number-generator\" title=\"special simple random number generator\">stackoverflow.com/questions/3062746/&hellip;</a>"}, {"owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1510186025, "post_id": 47191747, "comment_id": 81332962, "body": "@Nikos C - No, the assignment is about simulating the spread and impact of a disease. Random numbers are needed to decide how each individual reacts."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1510186271, "post_id": 47191747, "comment_id": 81333039, "body": "They why are you trying to implement your own random number generator?"}, {"owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1510186396, "post_id": 47191747, "comment_id": 81333065, "body": "With <code>STL</code> your professor probably (wrongly) referred to the subset of containers on the standard library that are derived from the original Standard Template Library and not to the standard library as a whole. <code>rand()</code> should be clear. Otherwise use of <code>std::abs()</code> should also be banned."}, {"owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "reply_to_user": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1510188132, "post_id": 47191747, "comment_id": 81333532, "body": "@xvan - That would certainly speed things up if you are correct. If it helps at all, for the class&#39;s first assignment part of the problem involved finding the greatest common divisor between two numbers. Half of the class got points docked for using a pre-built gcd() function. Now that I go back and look for it again, I can&#39;t find any mention of gcd() belonging to the STL. Verbatim, the instructions just say &quot;Must not use STL, with the exception of Strings&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 1, "creation_date": 1510190075, "post_id": 47191839, "comment_id": 81333999, "body": "That is an upsettingly simple omission. Thanks."}], "tags": [], "owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "is_accepted": false, "score": 2, "last_activity_date": 1510185996, "creation_date": 1510185996, "answer_id": 47191839, "question_id": 47191747, "link": "https://stackoverflow.com/questions/47191747/generating-random-numbers-without-using-cstdlib/47191839#47191839", "title": "Generating random numbers without using cstdlib?", "body": "<p>You never initialize your seed, try</p>\n\n<pre><code>//notcstdlib.cpp\n&lt;ctime&gt;\nint rand(int mod)\n{\n    static time_t seed = time(NULL);\n    return std::abs(seed * mod);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 0, "creation_date": 1510190046, "post_id": 47192190, "comment_id": 81333992, "body": "I will attempt to get a more detailed answer from the professor. In the meantime, I suppose I&#39;ll occupy myself with the bulk of the assignment. As for quality, the distribution of the numbers doesn&#39;t matter too much for this implementation. I&#39;ll play around with this and see what I can do with it. Thanks."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 0, "creation_date": 1510190335, "post_id": 47192190, "comment_id": 81334058, "body": "@anthony I&#39;m sure you heard the phrase &quot;garbage in, garbage out&quot; before :-) Meaning, if the random numbers are really bad, you can draw bad conclusions from the results of the simulation. Of course, if the only point of this is learning how to do a simulation rather than drawing conclusions from the results, then it&#39;s fine."}, {"owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 0, "creation_date": 1510291618, "post_id": 47192190, "comment_id": 81381728, "body": "I like this solution. It&#39;s pretty simple and it allows me to preset a seed and rerun previous sets of numbers. If I could bother you for one more explanation though, I tried putting in different LCG numbers and I got odd results. I tried ((my_rand_state * 134775813 + 1) % 4294967296) and even though my_rand_state is an unsigned long, it sometimes spat out negative numbers. I even changed my_rand() to explicitly return unsigned long, but nothing changed."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 0, "creation_date": 1510299307, "post_id": 47192190, "comment_id": 81384913, "body": "@anthony Don&#39;t do that. The arithmetic is unsigned, to avoid signed integer overflow (undefined behavior.) 4294967296 is not a value an <code>unsigned</code> can ever hold (4294967295 is the highest), so <code>% 4294967296</code> has no effect. The <code>% 2147483648</code> is there to limit the range of the result from 0 to the highest number a <code>signed long</code> can hold, which is 2147483647. So don&#39;t change that. Also don&#39;t change the constants. <code>1103515245 + 12345</code> is chosen because of <a href=\"https://stackoverflow.com/questions/8569113/why-1103515245-is-used-in-rand\" title=\"why 1103515245 is used in rand\">stackoverflow.com/questions/8569113/&hellip;</a> so if you change it, your numbers are going to be much worse."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 0, "creation_date": 1510301128, "post_id": 47192190, "comment_id": 81385736, "body": "@anthony Also see this (fun) talk by Stephan T. Lavavej: <a href=\"https://channel9.msdn.com/Events/GoingNative/2013/rand-Considered-Harmful\" rel=\"nofollow noreferrer\">channel9.msdn.com/Events/GoingNative/2013/&hellip;</a>"}, {"owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "edited": false, "score": 0, "creation_date": 1510307029, "post_id": 47192190, "comment_id": 81388973, "body": "Okay, I understand. I was just picking numbers off of Wikipedia&#39;s &quot;Linear Congruential Generator&quot; page. It didn&#39;t even occur to me that I might exceed what the variables are capable of. Thanks for your help."}], "tags": [], "owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1510301838, "last_edit_date": 1510301838, "creation_date": 1510188744, "answer_id": 47192190, "question_id": 47191747, "link": "https://stackoverflow.com/questions/47191747/generating-random-numbers-without-using-cstdlib/47192190#47192190", "title": "Generating random numbers without using cstdlib?", "body": "<p>You should probably ask your teacher whether <code>std::rand()</code> is also excluded and whether you really need to implement your own pseudo-random number generator. Or better, ask if you're allowed to use <code>&lt;random&gt;</code> so that you can use the Mercene Twister engine of C++, which is a very good pseudo-random number generator.</p>\n\n<p>If you really need to roll your own, the simplest replacement for <code>std::rand()</code> is an LCG (Linear Congruential Generator):</p>\n\n<pre><code>#define MY_RAND_MAX = 2147483647\nstatic unsigned long my_rand_state = 1;\n\nvoid my_srand(unsigned long seed)\n{\n    my_rand_state = seed;\n}\n\nlong my_rand()\n{\n    my_rand_state = (my_rand_state * 1103515245 + 12345) % 2147483648;\n    return my_rand_state;\n}\n</code></pre>\n\n<p>You can then use <code>my_srand()</code>, <code>my_rand()</code> and <code>MY_RAND_MAX</code> like you would <code>std::srand()</code>, <code>std::rand()</code> and <code>RAND_MAX</code> respectively:</p>\n\n<pre><code>// Seed it with the current time.\nmy_srand(std::time(nullptr));\n\n// Print 1000 random numbers between 0 and MY_RAND_MAX.\nfor (int i = 0; i &lt; 1000; ++i) {\n    std::cout &lt;&lt; my_rand() &lt;&lt; ' ';\n}\nstd::cout &lt;&lt; '\\n';\n</code></pre>\n\n<p>This generates low quality random numbers (they have bad distribution.) Note that <code>std::rand()</code> also has bad distribution. If you would like high quality random numbers (meaning good distribution), you should be using the C++ <code>&lt;random&gt;</code> algorithms, using the <code>std::mt19937</code> engine (which is the Mercene Twister algorithm, which has very good distribution and a huge period.)</p>\n\n<p>In general, just avoid <code>rand()</code>. See <a href=\"https://channel9.msdn.com/Events/GoingNative/2013/rand-Considered-Harmful\" rel=\"nofollow noreferrer\">Stephan T. Lavavej's 30min talk \"rand() Considered Harmful\"</a>, a must-watch for anyone who still uses <code>rand()</code> in their code.</p>\n"}], "owner": {"reputation": 223, "user_id": 1367249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Wq8nt.png?s=128&g=1", "display_name": "anthony", "link": "https://stackoverflow.com/users/1367249/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 0, "accepted_answer_id": 47192190, "answer_count": 2, "score": 1, "last_activity_date": 1510301838, "creation_date": 1510185369, "question_id": 47191747, "link": "https://stackoverflow.com/questions/47191747/generating-random-numbers-without-using-cstdlib", "title": "Generating random numbers without using cstdlib?", "body": "<p>This is a homework question, but it's a small part of a much bigger project. One of the constraints is that we are not allowed to use STL for any reason.</p>\n\n<p>I've attempted to roll up my own rand() function using ctime and an incrementing modifier. I figured that even though this doesn't have a consistent seed, the function should output semi-random numbers so long as it's not fed the same modifier more than once per second.</p>\n\n<pre><code>//notcstdlib.cpp\n//&lt;ctime&gt; &lt;cmath&gt;\nint rand(int mod)\n{\n    time_t seed;\n    return std::abs(seed * mod);\n}\n</code></pre>\n\n<p>but this sample code</p>\n\n<pre><code>//main.cpp\n#include \"notcstdlib.h\"\n#include &lt;iostream&gt;\n\nint main(int argc, char** argv)\n{\n    int f;\n    for(int i = 1; i &lt;= 10; i++)\n    {\n        f = rand(i);\n        std::cout &lt;&lt; \"random num= \" &lt;&lt; f &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"rand % 10 = \" &lt;&lt; f%10 &lt;&lt; \"\\n\";\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Always returns 7 as the first value and only even numbers between 0 and 8 for every other number.</p>\n\n<pre><code>//Output 1              //Output 2              //Output 3\nrandom num= 134514987 | random num= 134514987 | random num= 134514987\nrand % 10 = 7         | rand % 10 = 7         | rand % 10 = 7\nrandom num= 13261304  | random num= 24238584  | random num= 27941368\nrand % 10 = 4         | rand % 10 = 4         | rand % 10 = 8\nrandom num= 19891956  | random num= 36357876  | random num= 41912052\nrand % 10 = 6         | rand % 10 = 6         | rand % 10 = 2\nrandom num= 26522608  | random num= 48477168  | random num= 55882736\nrand % 10 = 8         | rand % 10 = 8         | rand % 10 = 6\nrandom num= 33153260  | random num= 60596460  | random num= 69853420\nrand % 10 = 0         | rand % 10 = 0         | rand % 10 = 0\nrandom num= 39783912  | random num= 72715752  | random num= 83824104\nrand % 10 = 2         | rand % 10 = 2         | rand % 10 = 4\nrandom num= 46414564  | random num= 84835044  | random num= 97794788\nrand % 10 = 4         | rand % 10 = 4         | rand % 10 = 8\nrandom num= 53045216  | random num= 96954336  | random num= 111765472\nrand % 10 = 6         | rand % 10 = 6         | rand % 10 = 2\nrandom num= 59675868  | random num= 109073628 | random num= 125736156\nrand % 10 = 8         | rand % 10 = 8         | rand % 10 = 6\nrandom num= 66306520  | random num= 121192920 | random num= 139706840\nrand % 10 = 0         | rand % 10 = 0         | rand % 10 = 0\n</code></pre>\n\n<p>Obviously I'm missing some important aspect of rand() and I'm not implementing it. Is there a better way to tackle this issue?</p>\n"}, {"tags": ["c++", "solaris", "autotools", "libtool", "map-files"], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510254850, "post_id": 47209041, "comment_id": 81368736, "body": "Thanks John. It tried <code>AM_LDFLAGS=-Wl,-M,cryptopp.mapfile</code>, but it was stripped it, too. (I don&#39;t mess with user <code>CXXFLAGS</code> or <code>LDFLAGS</code>. Everything goes in either <code>AM_CXXFLAGS</code> or <code>AM_LDFLAGS</code>)."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510255063, "post_id": 47209041, "comment_id": 81368838, "body": "Thanks again John. <i>&quot;unless you care to raise an issue against it, that&#39;s pretty much moot&quot;</i> - yeah, that was done yesterday. See <a href=\"https://lists.gnu.org/archive/html/bug-libtool/2017-11/msg00000.html\" rel=\"nofollow noreferrer\">Issue #29224: Solaris, lost mapfiles and silent failures</a>. The thing is, I&#39;m not sure its a <code>libtool</code> bug. Another component, like Autoconf or Automake, may be stripping it. My guess is, nothing will be done now, just like nothing was done in the past. History has a penchant for repeating itself."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510255308, "post_id": 47209041, "comment_id": 81368971, "body": "I don&#39;t know what to tell you, @jww.  I tested with libtool 2.4.2, and when the libtool command line contained the <code>-Wl,</code> options, they were passed on to the link command, as advertised.  Neither <code>autoconf</code> nor <code>automake</code> could be stripping the flags, as the flags are never presented to them in the first place, and I am fairly confident that <code>configure</code> is not doing so.  Do be aware, however, that <code>AM_LDFLAGS</code> is ignored for targets that have their own target-specific linker flags (<code>libfoo_la_LDFLAGS</code>) defined."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510260897, "post_id": 47209041, "comment_id": 81372117, "body": "Ack, thanks John. Here is the soup-to-nuts transcript: <a href=\"https://pastebin.com/uSVqfn0d\" rel=\"nofollow noreferrer\">Crypto++ and Autotools</a>. It was produced by <code>autoreconf --force --install --warnings=all</code>, <code>CXX=&#47;opt&#47;solarisstudio12.4&#47;bin&#47;CC .&#47;configure</code> and then <code>gmake -j 5</code>. I can&#39;t find any diagnostic stating requested options are being dropped. It occurs silently, even with <code>--warnings=all</code>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510261080, "post_id": 47209041, "comment_id": 81372221, "body": "Regarding <code>libfoo_la_LDFLAGS</code>, yeah I suspected that early. The actual uniform name (for us) is <code>libcryptopp_la</code>. Our <a href=\"https://github.com/noloader/cryptopp-autotools/blob/master/Makefile.am\" rel=\"nofollow noreferrer\"><code>Makefile.am</code></a> has both <code>libcryptopp_la_SOURCES</code> and <code>libcryptopp_la_LDFLAGS</code>. I also tried adding a <code>lib_LTLDFLAGS</code> for our <code>lib_LTLIBRARIES</code> (is this even legal?), but it produced the same results."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510264568, "post_id": 47209041, "comment_id": 81373927, "body": "@jww, your soup-to-nuts example appears to show <code>libtool</code> passing the <code>-M cryptopp.mapfile</code> options through to the linker driver (line 985).  That shows the actual command that <code>libtool</code> executes.  If libtool were stripping the options then they would still appear on line 984, but not on line 985.  Thus, if they are not being honored then it appears that that can only be a function of the linker driver, <code>&#47;opt&#47;solarisstudio12.4&#47;bin&#47;CC</code>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510265004, "post_id": 47209041, "comment_id": 81374152, "body": "Thanks John. The rule that is failing is the one on line 974, which begins with <code>libtool: link: &#47;opt&#47;solarisstudio12.4&#47;bin&#47;CC -G -hlibcryptopp.so.6 -o .libs&#47;libcryptopp.so.6.0.0...</code>. There is no <code>-M cryptopp.mapfile</code> supplied for the recipe."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510265470, "post_id": 47209041, "comment_id": 81374344, "body": "@jww at lines 973 and 974 we see that the <code>-M cryptopp.mapfile</code> are being presented as arguments to <code>libtool</code> but not passed on to the linker driver.  That is, <code>libtool</code> is indeed stripping them.  The recommended solution would be to instead present <code>-Wl,-M,cryptopp.mapfile</code> as an argument to <code>libtool</code>.  If there is a <code>libcryptopp_la_LDFLAGS</code> Automake variable then that&#39;s where that flag should be  recorded."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510265781, "post_id": 47209041, "comment_id": 81374507, "body": "If that does not work -- which perhaps it won&#39;t -- then the hack you already described may be the best available solution.  If it happens, however, that the compiler permits concatenating those arguments into one then you could try instead passing the <code>-XCClinker -Mcryptopp.mapfile</code> option."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510267238, "post_id": 47209041, "comment_id": 81375154, "body": "Thanks again @John. <code>-XCClinker</code> fixed the issue. Here are the former lines 973 and 974: <a href=\"https://pastebin.com/eD7M603Z\" rel=\"nofollow noreferrer\">Crypto++ and Autotools (XCClinker)</a>. Now, the question for me... Why did <code>libtool</code> not get its options via <code>-XCClibtool</code> so all the <code>-M</code> options could pass unmolested? And why is dropping <code>-M &lt;mapfile&gt;</code> not producing a diagnostic? The dumb engineering decisions make me want to scream. Especially the ones that stay broke for two or three decades rather than being fixed."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510268435, "post_id": 47209041, "comment_id": 81375657, "body": "@jww, I cannot answer &quot;why&quot; questions about <code>libtool</code>&#39;s design, except by referring you to the manual.  I do agree that it seems a poor choice for <code>libtool</code> to silently drop options -- it ought to at least emit a warning about such drops, and ideally the diagnostic would include describing a mechanism for passing the options through."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1510269385, "post_id": 47209041, "comment_id": 81375969, "body": "The fix was committed at <a href=\"https://github.com/noloader/cryptopp-autotools/commit/91700386556c\" rel=\"nofollow noreferrer\">91700386556c</a>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1510251920, "last_edit_date": 1592644375, "creation_date": 1510251920, "answer_id": 47209041, "question_id": 47191637, "link": "https://stackoverflow.com/questions/47191637/does-libtool-strip-all-options-with-m/47209041#47209041", "title": "Does libtool strip all options with -M?", "body": "<p>Libtool does drop some link options when creating a library.  <a href=\"https://www.gnu.org/software/libtool/manual/html_node/Stripped-link-flags.html\" rel=\"nofollow noreferrer\">The manual explains</a>:</p>\n<blockquote>\n<p>When creating a shared library, but not when compiling or creating a\nprogram, libtool drops some flags from the command line provided by\nthe user. This is done because flags unknown to libtool may interfere\nwith library creation or require additional support from libtool, and\nbecause omitting flags is usually the conservative choice for a\nsuccessful build.</p>\n</blockquote>\n<p>Personally, I find the justification for this behavior to be a bit cavalier, and I furthermore think it warrants a warning from <code>libtool</code> when it occurs, but unless you care to raise an issue against it, that's pretty much moot.</p>\n<p>Experimentation shows that <code>-M</code> is indeed among the options that <code>libtool</code> strips.  In particular, if I specify <code>LDFLAGS</code> containing an <code>-M</code> option on the <code>make</code> command line then I can observe it echoed in the <code>make</code> output when it runs the <code>libtool</code> link, but not in <code>libtool</code>'s <em>own</em> echo of the link command that is actually executed:</p>\n<blockquote>\n<p>$ make LDFLAGS=&quot;-M mapfile&quot;</p>\n<p>/bin/sh ./libtool  --tag=CC   --mode=link gcc  -g -O2  <strong>-M mapfile</strong> -o libmylib.la -rpath /usr/local/lib x.lo y.lo</p>\n<p>libtool: link: gcc -shared  -fPIC -DPIC  .libs/x.o .libs/y.o    -O2   -Wl,-soname -Wl,libmylib.so.0 -o .libs/libmylib.so.0.0.0</p>\n</blockquote>\n<p>The <code>libtool</code> docs suggest two workarounds to pass link options that otherwise would be stripped:</p>\n<ul>\n<li><p>For <em>bona fide</em> linker options, you can use one or more <code>-Wl,</code> or <code>-Xlinker</code> options to pass your options through <code>libtool</code> and the linker driver to the linker itself.  For example,</p>\n<pre><code> LDFLAGS=-Wl,-M,cryptopp.mapfile\n</code></pre>\n</li>\n<li><p>For options directed specifically to the linker <em>driver</em>, the docs suggest  adding the flags to the compiler driver command (CC=&quot;gcc -M mapfile&quot;), but  <em><strong>this is ineffective</strong></em> because the <code>$(CC)</code> variable is expanded by <code>make</code> to form the <code>libtool</code> command line, leaving any options expressed in it exposed to <code>libtool</code> for stripping.</p>\n</li>\n</ul>\n<p>Additionally, however, there is</p>\n<ul>\n<li>The <code>-XCClinker</code> option by which options can be passed through to the linker driver (as opposed to the linker itself), but its behavior seems a bit quirky: it seems to ignore options that don't start with a hyphen (such as the name of your map file).</li>\n</ul>\n"}], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 47209041, "answer_count": 1, "score": 0, "last_activity_date": 1510270402, "creation_date": 1510184694, "last_edit_date": 1510270402, "question_id": 47191637, "link": "https://stackoverflow.com/questions/47191637/does-libtool-strip-all-options-with-m", "title": "Does libtool strip all options with -M?", "body": "<p>I'm trying to track down a failure to link with a mapfile on Solaris. The missing mapfile causes the following error when I try to run our self tests:</p>\n\n<pre><code>$ ./cryptestcwd v\nld.so.1: cryptestcwd: fatal:\n/export/home/cryptopp/.libs/libcryptopp.so.6: hardware capability\n(CA_SUNW_HW_1) unsupported: 0x4800000  [ AES SSE4.1 ]\nKilled\n</code></pre>\n\n<p>I've gotten as far as this Automake rule. <code>libcryptopp_la_LINK</code>, which I believe is the shared object, is missing <code>AM_LDFLAGS</code>. <code>AM_LDFLAGS</code> holds the <code>-M cryptopp.mapfile</code> option.</p>\n\n<pre><code>libcryptopp_la_LINK = $(LIBTOOL) --tag=CXX $(AM_LIBTOOLFLAGS) \\\n    $(LIBTOOLFLAGS) --mode=link $(CXXLD) $(AM_CXXFLAGS) \\\n    $(CXXFLAGS) $(libcryptopp_la_LDFLAGS) $(LDFLAGS) -o $@\n</code></pre>\n\n<p>I tried to patch it with <code>sed</code> after <code>configure</code> runs:</p>\n\n<pre><code>libcryptopp_la_LINK = $(LIBTOOL) --tag=CXX $(AM_LIBTOOLFLAGS) \\\n    $(LIBTOOLFLAGS) --mode=link $(CXXLD) $(AM_CXXFLAGS) \\\n    $(CXXFLAGS) $(libcryptopp_la_LDFLAGS) -M cryptopp.mapfile $(LDFLAGS) -o $@\n</code></pre>\n\n<p>I confirmed the <code>sed</code> is successful, but the same test fails again. When the commands are invoked <code>-M &lt;mapfile&gt;</code> is missing.</p>\n\n<p>The <a href=\"https://www.gnu.org/software/libtool/manual/libtool.html\" rel=\"nofollow noreferrer\">libtool manual</a> talks about <code>-M</code> arguments on Cygwin, but not Solaris (and the discussion only applies to GCC, and not other compilers like IBM XL C/C++, Sun C/C++ and LLVM Clang):</p>\n\n<blockquote>\n  <p>Note that you also need to ensure that the standard Unix directories (like /bin, /lib, /usr, /etc) appear in the root of a drive. This means that you must install Cygwin itself into the C:/ root directory (or D:/, or E:/, etc)\u2014instead of the recommended installation into C:/cygwin/. In addition, all file names used in the build system must be relative, symlinks should not be used within the source or build directory trees, and all -M* options to gcc except -MMD must be avoided.  </p>\n</blockquote>\n\n<p>There is no other mention of <code>-M</code>.</p>\n\n<p>And there is no diagnostic, like <em>\"Removing <code>-M &lt;mapfile&gt;</code> options to Sun linker\"</em> or <em>\"Warning: <code>libtool</code> does not understand option <code>-M &lt;mapfile&gt;</code>\"</em>.</p>\n\n<p>My question is, does <code>libtool</code> discard <code>-M</code> and its arguments for some reason?</p>\n"}, {"tags": ["c++", "matrix", "shader", "mesh", "directx-10"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1510184784, "post_id": 47191619, "comment_id": 81332634, "body": "You&#39;ve posted too much code for anyone to quickly review, nor is it formatted for readability - with too many line-breaks and no indentation."}, {"owner": {"reputation": 1320, "user_id": 3754223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xZ3VX.png?s=128&g=1", "display_name": "MABVT", "link": "https://stackoverflow.com/users/3754223/mabvt"}, "edited": false, "score": 0, "creation_date": 1510208849, "post_id": 47191619, "comment_id": 81339347, "body": "Read up on &quot;Character Animation with DirectX 10 (or 11)&quot;"}, {"owner": {"reputation": 13, "user_id": 5688285, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10201087329981162/picture?type=large", "display_name": "Ryan Dodd", "link": "https://stackoverflow.com/users/5688285/ryan-dodd"}, "edited": false, "score": 0, "creation_date": 1510621132, "post_id": 47191619, "comment_id": 81503146, "body": "I have removed some of my code and formatted it. Tried reading up on character animation but I still can&#39;t figure out how to do it."}], "owner": {"reputation": 13, "user_id": 5688285, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10201087329981162/picture?type=large", "display_name": "Ryan Dodd", "link": "https://stackoverflow.com/users/5688285/ryan-dodd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510621066, "creation_date": 1510184555, "last_edit_date": 1510621066, "question_id": 47191619, "link": "https://stackoverflow.com/questions/47191619/how-to-make-a-mesh-move-in-directx-10", "title": "How to make a mesh move in DirectX 10", "body": "<p>I am trying to create a flying tiger in DirectX 10. I have loaded in the tiger and the wing meshes but I want to make the wings flap. At this point I am just trying to make the wings move, not the tiger itself. I am new to DirectX and I am learning it as a hobby so I'm not sure where to go from here. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>void CALLBACK OnD3D10FrameRender(ID3D10Device* pd3dDevice, double fTime, \nfloat fElapsedTime, void* pUserContext)\n {\n  //\n  // Clear the back buffer\n  //\n  float ClearColor[4] = { 0.0f, 0.125f, 0.3f, 1.0f }; // red, green, blue, \n  alpha\n  ID3D10RenderTargetView* pRTV = DXUTGetD3D10RenderTargetView();\n  pd3dDevice-&gt;ClearRenderTargetView(pRTV, ClearColor);\n\n  //\n  // Clear the depth stencil\n  //\n  ID3D10DepthStencilView* pDSV = DXUTGetD3D10DepthStencilView();\n  pd3dDevice-&gt;ClearDepthStencilView(pDSV, D3D10_CLEAR_DEPTH, 1.0, 0);\n\n  //\n  // Update variables that change once per frame\n  //\n  g_pWorldVariable-&gt;SetMatrix((float*)&amp;g_World);\n\n  //\n  // Set the Vertex Layout\n  //\n  pd3dDevice-&gt;IASetInputLayout(g_pVertexLayout);\n\n  //\n  // Render the mesh\n  //\n  UINT Strides[1];\n  UINT Offsets[1];\n  ID3D10Buffer* pVB[1];\n  pVB[0] = g_Mesh.GetVB10(0, 0);\n  Strides[0] = (UINT)g_Mesh.GetVertexStride(0, 0);\n  Offsets[0] = 0;\n  pd3dDevice-&gt;IASetVertexBuffers(0, 1, pVB, Strides, Offsets);\n  pd3dDevice-&gt;IASetIndexBuffer(g_Mesh.GetIB10(0), g_Mesh.GetIBFormat10(0), \n  0);\n\n  D3D10_TECHNIQUE_DESC techDesc;\n  g_pTechnique-&gt;GetDesc(&amp;techDesc);\n  SDKMESH_SUBSET* pSubset = NULL;\n  ID3D10ShaderResourceView* pDiffuseRV = NULL;\n  D3D10_PRIMITIVE_TOPOLOGY PrimType;\n\n  for (UINT p = 0; p &lt; techDesc.Passes; ++p)\n  {\n    for (UINT subset = 0; subset &lt; g_Mesh.GetNumSubsets(0); ++subset)\n    {\n        pSubset = g_Mesh.GetSubset(0, subset);\n\n        PrimType = \n        g_Mesh.GetPrimitiveType10((SDKMESH_PRIMITIVE_TYPE)pSubset-\n        &gt;PrimitiveType);\n        pd3dDevice-&gt;IASetPrimitiveTopology(PrimType);\n\n        pDiffuseRV = g_Mesh.GetMaterial(pSubset-&gt;MaterialID)-&gt;pDiffuseRV10;\n        g_ptxDiffuseVariable-&gt;SetResource(pDiffuseRV);\n\n        g_pTechnique-&gt;GetPassByIndex(p)-&gt;Apply(0);\n        pd3dDevice-&gt;DrawIndexed((UINT)pSubset-&gt;IndexCount, 0, (UINT)pSubset-\n        &gt;VertexStart);\n        }\n    }\n\n  // Render mesh2\n\n  pVB[0] = g_Mesh2.GetVB10(0, 0);\n  Strides[0] = (UINT)g_Mesh2.GetVertexStride(0, 0);\n  Offsets[0] = 0;\n  pd3dDevice-&gt;IASetVertexBuffers(0, 1, pVB, Strides, Offsets);\n  pd3dDevice-&gt;IASetIndexBuffer(g_Mesh2.GetIB10(0), g_Mesh2.GetIBFormat10(0), \n  0);\n\n  g_pTechnique-&gt;GetDesc(&amp;techDesc);\n\n  for (UINT p = 0; p &lt; techDesc.Passes; ++p)\n  {\n    for (UINT subset = 0; subset &lt; g_Mesh2.GetNumSubsets(0); ++subset)\n    {\n        pSubset = g_Mesh2.GetSubset(0, subset);\n\n        PrimType = \n        g_Mesh2.GetPrimitiveType10((SDKMESH_PRIMITIVE_TYPE)pSubset-\n        &gt;PrimitiveType);\n        pd3dDevice-&gt;IASetPrimitiveTopology(PrimType);\n\n        pDiffuseRV = g_Mesh2.GetMaterial(pSubset-&gt;MaterialID)-&gt;pDiffuseRV10;\n        g_ptxDiffuseVariable-&gt;SetResource(pDiffuseRV);\n\n        g_pTechnique-&gt;GetPassByIndex(p)-&gt;Apply(0);\n        pd3dDevice-&gt;DrawIndexed((UINT)pSubset-&gt;IndexCount, 0, (UINT)pSubset-\n        &gt;VertexStart);\n    }\n  }\n\n  // Render Mesh3\n\n  pVB[0] = g_Mesh3.GetVB10(0, 0);\n  Strides[0] = (UINT)g_Mesh3.GetVertexStride(0, 0);\n  Offsets[0] = 0;\n  pd3dDevice-&gt;IASetVertexBuffers(0, 1, pVB, Strides, Offsets);\n  pd3dDevice-&gt;IASetIndexBuffer(g_Mesh3.GetIB10(0), g_Mesh3.GetIBFormat10(0), \n  0);\n\n  g_pTechnique-&gt;GetDesc(&amp;techDesc);\n\n  for (UINT p = 0; p &lt; techDesc.Passes; ++p)\n  {\n    for (UINT subset = 0; subset &lt; g_Mesh3.GetNumSubsets(0); ++subset)\n    {\n        pSubset = g_Mesh3.GetSubset(0, subset);\n\n        PrimType = \n        g_Mesh3.GetPrimitiveType10((SDKMESH_PRIMITIVE_TYPE)pSubset-\n        &gt;PrimitiveType);\n        pd3dDevice-&gt;IASetPrimitiveTopology(PrimType);\n\n        pDiffuseRV = g_Mesh3.GetMaterial(pSubset-&gt;MaterialID)-&gt;pDiffuseRV10;\n        g_ptxDiffuseVariable-&gt;SetResource(pDiffuseRV);\n\n        g_pTechnique-&gt;GetPassByIndex(p)-&gt;Apply(0);\n        pd3dDevice-&gt;DrawIndexed((UINT)pSubset-&gt;IndexCount, 0, (UINT)pSubset-\n        &gt;VertexStart);\n    }\n  }\n\n  //the mesh class also had a render method that allows rendering the mesh \n  with the most common options\n  //g_Mesh.Render( pd3dDevice, g_pTechnique, g_ptxDiffuseVariable );\n  }\n\n  void CALLBACK OnD3D10ReleasingSwapChain(void* pUserContext)\n  {\n  }\n\n  void CALLBACK OnD3D10DestroyDevice(void* pUserContext)\n  {\n   DXUTGetGlobalResourceCache().OnDestroyDevice();\n   SAFE_RELEASE(g_pVertexLayout);\n   SAFE_RELEASE(g_pEffect);\n   g_Mesh.Destroy();\n   g_Mesh2.Destroy();\n   g_Mesh3.Destroy();\n  }\n\n\n  bool CALLBACK ModifyDeviceSettings(DXUTDeviceSettings* pDeviceSettings, \n  void* pUserContext)\n  {\n    return true;\n  }\n\n\n  void CALLBACK OnFrameMove(double fTime, float fElapsedTime, void* \n  pUserContext)\n  {\n   // Rotate cube around the origin\n   D3DXMatrixRotationY(&amp;g_World, 60.0f * DEG2RAD((float)fTime));\n  }\n\n\n  LRESULT CALLBACK MsgProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM \n  lParam, \n  bool* pbNoFurtherProcessing,\n  void* pUserContext)\n  {\n    return 0;\n  }\n\n  void CALLBACK OnKeyboard(UINT nChar, bool bKeyDown, bool bAltDown, void* \n  pUserContext)\n  {\n    if (bKeyDown)\n  {\n    switch (nChar)\n    {\n      case VK_F1: // Change as needed                \n        break;\n    }\n  }\n  }\n</code></pre>\n"}, {"tags": ["c++", "boost", "boost-spirit", "boost-spirit-qi", "boost-spirit-lex"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1510187223, "post_id": 47191531, "comment_id": 81333297, "body": "Can you share a minimal self-contained example? Also, what is &quot;semantic value&quot;? There&#39;s exposed, synthesized, inherited or local attributes, or semantic actions. (Really, try not to explain, just show the code). Inserting the <code>qi::eps</code> is for <a href=\"https://stackoverflow.com/q/19823413/85371\">single-element adapted sequences</a>. <code>intrusive_ptr&lt;T&gt;</code> is not that: in fact it has no attribute propagation rules at all, unless you <a href=\"http://www.boost.org/doc/libs/1_65_1/libs/spirit/doc/html/spirit/advanced/customize/transform.html\" rel=\"nofollow noreferrer\">provide the transformation traits</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8434768"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1510337436, "post_id": 47191531, "comment_id": 81407940, "body": "@sehe -- self contained code contained now"}], "answers": [{"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1510352793, "post_id": 47229150, "comment_id": 81414947, "body": "Yeah. No. I spotted <a href=\"https://sourceforge.net/p/spirit/mailman/message/36111213/\" rel=\"nofollow noreferrer\">your question on the mailing list</a> too. I&#39;ve just <a href=\"https://stackoverflow.com/a/47232006/85371\">written up an approach that I think Spirit favours</a>. I stopped clear of transforming to your AST (I don&#39;t think I have the full data types required, or maybe I just don&#39;t understand where you&#39;re going with your representation. It looks very generic, and very generic things usually require the best documentation to explain it. This, incidentally explains the pain with much of the documentation in Boost :))."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8434768"}, "is_accepted": false, "score": 0, "last_activity_date": 1510339009, "creation_date": 1510339009, "answer_id": 47229150, "question_id": 47191531, "link": "https://stackoverflow.com/questions/47191531/cannot-get-boostspirit-parserlexer-working-for-token-types-other-than-stdst/47229150#47229150", "title": "cannot get boost::spirit parser&amp;lexer working for token types other than std::string or int or double", "body": "<p>One solution would be to use a std::string everywhere and define a boost::variant with everything needed but not use it anywhere in the parser or lexer directly but only serialize &amp; deserialize it into/from the string.</p>\n\n<p>Is this what the originators of boost::spirit intended?</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8434768"}, "edited": false, "score": 0, "creation_date": 1510586934, "post_id": 47232006, "comment_id": 81486348, "body": "So you want me to avoid using a lexer at all? I wanted to use a lexer mostly to implement include-files and macros (similar to C++). Should I implement this rather using a first-stage parser which in turn feeds the main parser?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1510589368, "post_id": 47232006, "comment_id": 81488019, "body": "You could include from this parser model in much the same way (and with [the same caveats](link)) as in the lexer. I don&#39;t &quot;want you to&quot; do anything, I&#39;m showing conventions and what I regard as &quot;best practice&quot; or &quot;the sweet spot&quot; from years of using Spirit. Instead of giving you any kind of limited advice, I link to the back stories that can help you inform your design. It&#39;s pretty clear you <i>can</i> do everything with the Lexer (<b>and</b> it will have some benefits as well). It&#39;s the balancing art of excavating the optimum simplicity that the tools afford, in my opinion."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1510589491, "post_id": 47232006, "comment_id": 81488107, "body": "The link didn&#39;t fit: <a href=\"https://stackoverflow.com/questions/47146548/how-to-make-boostspirit-parser-and-lexer-being-able-to-deal-with-include-files#comment81333480_47147429\" title=\"how to make boostspirit parser and lexer being able to deal with include files%23comment81333480_47147429\">stackoverflow.com/questions/47146548/&hellip;</a>"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1510356411, "last_edit_date": 1510356411, "creation_date": 1510352356, "answer_id": 47232006, "question_id": 47191531, "link": "https://stackoverflow.com/questions/47191531/cannot-get-boostspirit-parserlexer-working-for-token-types-other-than-stdst/47232006#47232006", "title": "cannot get boost::spirit parser&amp;lexer working for token types other than std::string or int or double", "body": "<blockquote>\n  <p>Has anybody gotten this working for a lexer returning something else than double or int or string?</p>\n</blockquote>\n\n<p>Sure. Simple examples might be found <a href=\"https://stackoverflow.com/search?q=lex%3A%3Aactor_lexer\">on this site</a></p>\n\n<blockquote>\n  <p>And for the parser also returning non-trivial objects?</p>\n</blockquote>\n\n<p>Here's your real problem. Spirit is nice for a subset of parsers that are expressed easily in a eDSL, and has the huge benefit of \"magically\" mapping to a selection of attributes.</p>\n\n<p>Some of the realities are:</p>\n\n<ul>\n<li><p>attributes are expected to have value-semantic; using polymorphic attributes is hard (<a href=\"https://stackoverflow.com/questions/23299722/how-can-i-use-polymorphic-attributes-with-boostspiritqi-parsers/23301519#23301519\">How can I use polymorphic attributes with boost::spirit::qi parsers?</a>, e.g.)</p></li>\n<li><p>using Lex makes most of the sweet-spot disappear since all \"highlevel\" parsers (like <code>real_parser</code>, <code>[u]int_parser</code>) are out the window. The Spirit devs are on record they prefer not to use Lex. Moreover, Spirit X3 doesn't have Lex support anymore.</p></li>\n</ul>\n\n<hr>\n\n<h2>Background Information:</h2>\n\n<p>I'd very much consider parsing the source as-is, into direct value-typed AST nodes. I know, this is probably what you consider \"trivial objects\", but don't be deceived by apparent simplicity: recursive variant trees have some expressive power.</p>\n\n<p>Examples</p>\n\n<ul>\n<li>Here's a trivial AST to represent JSON in &lt;20 LoC: <a href=\"https://stackoverflow.com/questions/46838958/boost-karma-generator-for-composition-of-classes/46841145#46841145\">Boost Karma generator for composition of classes</a>\u00b9</li>\n<li>Here we represent the Graphviz source format with full fidelity: <a href=\"https://stackoverflow.com/questions/46334463/how-to-use-boost-spirit-list-operator-with-mandatory-minimum-amount-of-elements/46365596#46365596\">How to use boost spirit list operator with mandatory minimum amount of elements?</a>  </li>\n</ul>\n\n<p>I've since created the code to transform that AST into a domain representation with fully correct ownership, cascading lexically scoped node/edge attributes and cross references. I have just recovered that work and <a href=\"https://github.com/sehe/spirit-graphviz/\" rel=\"nofollow noreferrer\">put it up on github</a> if you're interested, mainly because the task is pretty similar in many respects, like the overriding/inheriting of properties and resolving identifiers within scopes: <a href=\"https://github.com/sehe/spirit-graphviz/blob/master/spirit-graphviz.cpp#L660\" rel=\"nofollow noreferrer\">https://github.com/sehe/spirit-graphviz/blob/master/spirit-graphviz.cpp#L660</a></p>\n\n<h2>Suggestions, Ideas</h2>\n\n<p>In your case I'd take similar approach to retain simplicity. The code shown doesn't (yet) cover the trickiest ingredients (like nature attribute overrides within a discipline). </p>\n\n<p>Once you start implementing use-cases like resolving compatible disciplines and the absolute tolerances at a given node, you want a domain model with full fidelity. Preferrably, there would be no loss of source information, and immutable AST information\u00b2.</p>\n\n<p>As a middle ground, you could probably avoid building an entire source-AST in memory only to transform it in one big go, at the top-level you could have:</p>\n\n<pre><code>file = qi::skip(skipper) [\n        *(m_sDiscipline | m_sNature | m_sModule) [process_ast(_1)]\n    ];\n</code></pre>\n\n<p>Where <code>process_ast</code> would apply the \"trivial\" AST representation into the domain types, one at a time. That way you keep only small bits of temporary AST representation around.</p>\n\n<p>The domain representation can be arbitrarily sophisticated to support all your logic and use-cases.</p>\n\n<h2>Let's \"Show, Don't Tell\"</h2>\n\n<p>Baking the simplest AST that comes to mind matching the grammar\u00b3:</p>\n\n<pre><code>namespace frank { namespace ast {\n    struct nature {\n        struct empty{};\n\n        std::string name;\n        std::string inherits;\n\n        enum class Attribute { units, access, idt, ddt, abstol };\n        using Value = boost::variant&lt;int, double, std::string&gt;;\n        std::map&lt;Attribute, Value&gt; attributes;\n    };\n\n    struct discipline {\n        enum enumDomain { eUnspecified, eDiscrete, eContinuous };\n        struct properties_t {\n            enumDomain domain = eUnspecified;\n            boost::optional&lt;std::string&gt; flow, potential;\n        };\n\n        std::string name;\n        properties_t properties;\n    };\n\n    // TODO\n    using module = qi::unused_type;\n    using file   = std::vector&lt;boost::variant&lt;nature, discipline, module&gt; &gt;;\n\n    enum class type { real, integer, string };\n} }\n</code></pre>\n\n<p>This is trivial and maps 1:1 onto the grammar productions, which means we have very little impedance.</p>\n\n<h2>Tokens? We Don't Need Lex For That</h2>\n\n<p>You can have common token parsers without requiring the complexities of Lex</p>\n\n<blockquote>\n  <p>Yes, Lex (especially <a href=\"https://stackoverflow.com/questions/19286687/in-boostspiritlex-it-takes-longest-time-to-do-first-parsing-following-pars/19291019#19291019\">statically generated</a>) can potentially improve performance, but </p>\n  \n  <ul>\n  <li>if you need that, I wager Spirit Qi is not  your best option anyways</li>\n  <li>premature optimization...</li>\n  </ul>\n</blockquote>\n\n<p>What I did:</p>\n\n<pre><code>struct tokens {\n    // implicit lexemes\n    qi::rule&lt;It, std::string()&gt; string, identifier;\n    qi::rule&lt;It, double()&gt; real;\n    qi::rule&lt;It, int()&gt; integer;\n    qi::rule&lt;It, ast::nature::Value()&gt; value;\n    qi::rule&lt;It, ast::nature::Attribute()&gt; attribute;\n    qi::rule&lt;It, ast::discipline::enumDomain()&gt; domain;\n\n    struct attribute_sym_t : qi::symbols&lt;char, ast::nature::Attribute&gt; {\n        attribute_sym_t() {\n            this-&gt;add\n               (\"units\", ast::nature::Attribute::units)\n               (\"access\", ast::nature::Attribute::access)\n               (\"idt_nature\", ast::nature::Attribute::idt)\n               (\"ddt_nature\", ast::nature::Attribute::ddt)\n               (\"abstol\", ast::nature::Attribute::abstol);\n        }\n    } attribute_sym;\n\n    struct domain_sym_t : qi::symbols&lt;char, ast::discipline::enumDomain&gt; {\n        domain_sym_t() {\n            this-&gt;add\n               (\"discrete\", ast::discipline::eDiscrete)\n               (\"continuous\", ast::discipline::eContinuous);\n        }\n    } domain_sym;\n\n    tokens() {\n        using namespace qi;\n        auto kw = qr::distinct(copy(char_(\"a-zA-Z0-9_\")));\n\n        string     = '\"' &gt;&gt; *(\"\\\\\" &gt;&gt; char_ | ~char_('\"')) &gt;&gt; '\"';\n        identifier = char_(\"a-zA-Z_\") &gt;&gt; *char_(\"a-zA-Z0-9_\");\n        real       = double_;\n        integer    = int_;\n        attribute  = kw[attribute_sym];\n        domain     = kw[domain_sym];\n\n        value = string | identifier | real | integer;\n\n        BOOST_SPIRIT_DEBUG_NODES((string)(identifier)(real)(integer)(value)(domain)(attribute))\n    }\n};\n</code></pre>\n\n<p>Liberating, isn't it? Note how</p>\n\n<ul>\n<li>all attributes are automatically propagated</li>\n<li>strings handle escapes (this bit was commented out in your Lex approach). We don't even need semantic actions to (badly) pry out the unquoted/unescaped value</li>\n<li><p>we used <code>distinct</code> to ensure keyword parsing matches only full identifiers. (See <a href=\"https://stackoverflow.com/questions/20131162/how-to-parse-reserved-words-correctly-in-boost-spirit/20133011#20133011\">How to parse reserved words correctly in boost spirit</a>).  </p>\n\n<p>This is actually where you notice the lack of separate lexer.  </p>\n\n<p>On the flipside, this makes context-sensitive keywords a breeze (lex can easily prioritizes keywords over identifiers that occur in places where keywords cannot occur.\u2074)</p></li>\n</ul>\n\n<h2>What About Skipping Space/Comments?</h2>\n\n<p>We could have added a token, but for reasons of convention I made it a parser:</p>\n\n<pre><code>struct skipParser : qi::grammar&lt;It&gt; {\n    skipParser() : skipParser::base_type(spaceOrComment) {\n        using namespace qi;\n        spaceOrComment = space\n            | (\"//\" &gt;&gt; *(char_ - eol) &gt;&gt; (eoi|eol))\n            | (\"/*\" &gt;&gt; *(char_ - \"*/\") &gt;&gt; \"*/\");\n\n        BOOST_SPIRIT_DEBUG_NODES((spaceOrComment))\n    }\n  private:\n    qi::rule&lt;It&gt; spaceOrComment;\n};\n</code></pre>\n\n<h2><code>natureParser</code></h2>\n\n<p>We inherit our AST parsers from <code>tokens</code>:</p>\n\n<pre><code>struct natureParser : tokens, qi::grammar&lt;It, ast::nature(), skipParser&gt; {\n</code></pre>\n\n<p>And from there it is plain sailing:</p>\n\n<pre><code>property = attribute &gt;&gt; '=' &gt;&gt; value &gt;&gt; ';';\n\nnature\n    = kw[\"nature\"] &gt;&gt; identifier &gt;&gt; -(':' &gt;&gt; identifier) &gt;&gt; ';'\n    &gt;&gt; *property\n    &gt;&gt; kw[\"endnature\"];\n</code></pre>\n\n<h2><code>disciplineParser</code></h2>\n\n<pre><code>discipline = kw[\"discipline\"] &gt;&gt; identifier &gt;&gt; ';' \n    &gt;&gt; properties \n    &gt;&gt; kw[\"enddiscipline\"]\n    ;\n\nproperties\n    = kw[\"domain\"] &gt;&gt; domain &gt;&gt; ';'\n    ^ kw[\"flow\"] &gt;&gt; identifier &gt;&gt; ';'\n    ^ kw[\"potential\"] &gt;&gt; identifier &gt;&gt; ';'\n    ;\n</code></pre>\n\n<p>This shows a competing approach that uses the permutation operator (<code>^</code>) to parse optional alternatives in any order into a fixed <code>frank::ast::discipline</code> properties struct. Of course, you might elect to have a more generic representation here, like we had with <code>ast::nature</code>.</p>\n\n<blockquote>\n  <p>Module AST is left as an exercise for the reader, though the parser rules are implemented below.</p>\n</blockquote>\n\n<h2>Top Level, Encapsulating The Skipper</h2>\n\n<p>I hate having to specify the skipper from the calling code (it's more complex than required, and changing the skipper changes the grammar). So, I encapsulate it in the top-level parser:</p>\n\n<pre><code>struct fileParser : qi::grammar&lt;It, ast::file()&gt; {\n    fileParser() : fileParser::base_type(file) {\n        file = qi::skip(qi::copy(m_sSkip)) [\n                *(m_sDiscipline | m_sNature | m_sModule)\n            ];\n\n        BOOST_SPIRIT_DEBUG_NODES((file))\n    }\n  private:\n    disciplineParser m_sDiscipline;\n    natureParser     m_sNature;\n    moduleParser     m_sModule;\n    skipParser       m_sSkip;\n\n    qi::rule&lt;It, ast::file()&gt; file;\n};\n</code></pre>\n\n<h2>Demo Time</h2>\n\n<p>This demo adds <code>operator&lt;&lt;</code> for the enums, and a variant visitor to print some AST details for debug/demonstrational purposes (<code>print_em</code>).</p>\n\n<p>Then we have a test driver:</p>\n\n<pre><code>int main() {\n    using iterator_type = std::string::const_iterator;\n\n    iterator_type iter = sInput.begin(), last = sInput.end();\n\n    frank::Parsers&lt;iterator_type&gt;::fileParser parser;\n    print_em print;\n\n    frank::ast::file file;\n    bool ok = qi::parse(iter, last, parser, file);\n\n    if (ok) {\n        for (auto&amp; symbol : file)\n            print(symbol);\n    }\n    else {\n        std::cout &lt;&lt; \"Parse failed\\n\";\n    }\n\n    if (iter != last) {\n        std::cout &lt;&lt; \"Remaining unparsed: '\" &lt;&lt; std::string(iter,last) &lt;&lt; \"'\\n\";\n    }\n}\n</code></pre>\n\n<p>With the sample input from your question we get the following output:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/456c6cfc7bfbbcb8\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>-- Nature\nname: Current\ninherits: \nattribute: units = A\nattribute: access = I\nattribute: idt = Charge\nattribute: abstol = 1e-12\n-- Nature\nname: Charge\ninherits: \nattribute: units = coul\nattribute: access = Q\nattribute: ddt = Current\nattribute: abstol = 1e-14\n-- Nature\nname: Voltage\ninherits: \nattribute: units = V\nattribute: access = V\nattribute: idt = Flux\nattribute: abstol = 1e-06\n-- Discipline\nname: electrical\ndomain: (unspecified)\nflow:  Current\npotential:  Voltage\nRemaining unparsed: '\n'\n</code></pre>\n\n<p>With <code>BOOST_SPIRIT_DEBUG</code> defined, you get rich debug information: <strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/8eeb529cf36273c9\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<h2>Full Listing</h2>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/456c6cfc7bfbbcb8\" rel=\"nofollow noreferrer\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>//#define BOOST_SPIRIT_DEBUG\n#include &lt;map&gt;\n#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/fusion/include/adapted.hpp&gt;\n#include &lt;boost/spirit/repository/include/qi_distinct.hpp&gt;\n\nnamespace qi = boost::spirit::qi;\n\nnamespace frank { namespace ast {\n    struct nature {\n        struct empty{};\n\n        std::string name;\n        std::string inherits;\n\n        enum class Attribute { units, access, idt, ddt, abstol };\n        using Value = boost::variant&lt;int, double, std::string&gt;;\n        std::map&lt;Attribute, Value&gt; attributes;\n    };\n\n    struct discipline {\n        enum enumDomain { eUnspecified, eDiscrete, eContinuous };\n        struct properties_t {\n            enumDomain domain = eUnspecified;\n            boost::optional&lt;std::string&gt; flow, potential;\n        };\n\n        std::string name;\n        properties_t properties;\n    };\n\n    // TODO\n    using module = qi::unused_type;\n    using file   = std::vector&lt;boost::variant&lt;nature, discipline, module&gt; &gt;;\n\n    enum class type { real, integer, string };\n} }\n\nBOOST_FUSION_ADAPT_STRUCT(frank::ast::nature, name, inherits, attributes)\nBOOST_FUSION_ADAPT_STRUCT(frank::ast::discipline, name, properties)\nBOOST_FUSION_ADAPT_STRUCT(frank::ast::discipline::properties_t, domain, flow, potential)\n\nnamespace frank {\n    namespace qr = boost::spirit::repository::qi;\n\n    template &lt;typename It&gt; struct Parsers {\n\n        struct tokens {\n            // implicit lexemes\n            qi::rule&lt;It, std::string()&gt; string, identifier;\n            qi::rule&lt;It, double()&gt; real;\n            qi::rule&lt;It, int()&gt; integer;\n            qi::rule&lt;It, ast::nature::Value()&gt; value;\n            qi::rule&lt;It, ast::nature::Attribute()&gt; attribute;\n            qi::rule&lt;It, ast::discipline::enumDomain()&gt; domain;\n\n            struct attribute_sym_t : qi::symbols&lt;char, ast::nature::Attribute&gt; {\n                attribute_sym_t() {\n                    this-&gt;add\n                       (\"units\", ast::nature::Attribute::units)\n                       (\"access\", ast::nature::Attribute::access)\n                       (\"idt_nature\", ast::nature::Attribute::idt)\n                       (\"ddt_nature\", ast::nature::Attribute::ddt)\n                       (\"abstol\", ast::nature::Attribute::abstol);\n                }\n            } attribute_sym;\n\n            struct domain_sym_t : qi::symbols&lt;char, ast::discipline::enumDomain&gt; {\n                domain_sym_t() {\n                    this-&gt;add\n                       (\"discrete\", ast::discipline::eDiscrete)\n                       (\"continuous\", ast::discipline::eContinuous);\n                }\n            } domain_sym;\n\n            tokens() {\n                using namespace qi;\n                auto kw = qr::distinct(copy(char_(\"a-zA-Z0-9_\")));\n\n                string     = '\"' &gt;&gt; *(\"\\\\\" &gt;&gt; char_ | ~char_('\"')) &gt;&gt; '\"';\n                identifier = char_(\"a-zA-Z_\") &gt;&gt; *char_(\"a-zA-Z0-9_\");\n                real       = double_;\n                integer    = int_;\n                attribute  = kw[attribute_sym];\n                domain     = kw[domain_sym];\n\n                value = string | identifier | real | integer;\n\n                BOOST_SPIRIT_DEBUG_NODES((string)(identifier)(real)(integer)(value)(domain)(attribute))\n            }\n        };\n\n        struct skipParser : qi::grammar&lt;It&gt; {\n            skipParser() : skipParser::base_type(spaceOrComment) {\n                using namespace qi;\n                spaceOrComment = space\n                    | (\"//\" &gt;&gt; *(char_ - eol) &gt;&gt; (eoi|eol))\n                    | (\"/*\" &gt;&gt; *(char_ - \"*/\") &gt;&gt; \"*/\");\n\n                BOOST_SPIRIT_DEBUG_NODES((spaceOrComment))\n            }\n          private:\n            qi::rule&lt;It&gt; spaceOrComment;\n        };\n\n        struct natureParser : tokens, qi::grammar&lt;It, ast::nature(), skipParser&gt; {\n            natureParser() : natureParser::base_type(nature) {\n                using namespace qi;\n                auto kw = qr::distinct(copy(char_(\"a-zA-Z0-9_\")));\n\n                property = attribute &gt;&gt; '=' &gt;&gt; value &gt;&gt; ';';\n\n                nature\n                    = kw[\"nature\"] &gt;&gt; identifier &gt;&gt; -(':' &gt;&gt; identifier) &gt;&gt; ';'\n                    &gt;&gt; *property\n                    &gt;&gt; kw[\"endnature\"];\n\n                BOOST_SPIRIT_DEBUG_NODES((nature)(property))\n            }\n          private:\n            using Attribute = std::pair&lt;ast::nature::Attribute, ast::nature::Value&gt;;\n\n            qi::rule&lt;It, ast::nature(), skipParser&gt; nature;\n            qi::rule&lt;It, Attribute(), skipParser&gt; property;\n\n            using tokens::attribute;\n            using tokens::value;\n            using tokens::identifier;\n        };\n\n        struct disciplineParser : tokens, qi::grammar&lt;It, ast::discipline(), skipParser&gt; {\n            disciplineParser() : disciplineParser::base_type(discipline) {\n\n                auto kw = qr::distinct(qi::copy(qi::char_(\"a-zA-Z0-9_\")));\n\n                discipline = kw[\"discipline\"] &gt;&gt; identifier &gt;&gt; ';' \n                    &gt;&gt; properties \n                    &gt;&gt; kw[\"enddiscipline\"]\n                    ;\n\n                properties\n                    = kw[\"domain\"] &gt;&gt; domain &gt;&gt; ';'\n                    ^ kw[\"flow\"] &gt;&gt; identifier &gt;&gt; ';'\n                    ^ kw[\"potential\"] &gt;&gt; identifier &gt;&gt; ';'\n                    ;\n\n                BOOST_SPIRIT_DEBUG_NODES((discipline)(properties))\n            }\n          private:\n            qi::rule&lt;It, ast::discipline(), skipParser&gt; discipline;\n            qi::rule&lt;It, ast::discipline::properties_t(), skipParser&gt; properties;\n\n            using tokens::domain;\n            using tokens::identifier;\n        };\n\n        struct moduleParser : tokens, qi::grammar&lt;It, ast::module(), skipParser&gt; {\n            moduleParser() : moduleParser::base_type(module) {\n                auto kw = qr::distinct(qi::copy(qi::char_(\"a-zA-Z0-9_\")));\n\n                m_sPort           = identifier;\n                m_sPortList       = m_sPort % ',';\n                m_sModulePortList = '(' &gt;&gt; m_sPortList &gt;&gt; ')';\n                m_sModule         = kw[\"module\"];\n                m_sType           = kw[\"real\"] | kw[\"integer\"] | kw[\"string\"];\n                m_sParameter      = kw[\"parameter\"] &gt;&gt; m_sType &gt;&gt; identifier;\n                m_sModuleItem     = m_sParameter;\n                m_sModuleItemList = *m_sModuleItem;\n                module =\n                    (m_sModule &gt;&gt; identifier &gt;&gt; m_sModulePortList &gt;&gt; m_sModuleItemList &gt;&gt; kw[\"endmodule\"]);\n            }\n          private:\n            qi::rule&lt;It, ast::module(), skipParser&gt; module;\n            qi::rule&lt;It, skipParser&gt; m_sModulePortList;\n            qi::rule&lt;It, skipParser&gt; m_sPortList;\n            qi::rule&lt;It, skipParser&gt; m_sPort;\n            qi::rule&lt;It, skipParser&gt; m_sModule;\n\n            qi::rule&lt;It, skipParser&gt; m_sModuleItemList;\n            qi::rule&lt;It, skipParser&gt; m_sParameter;\n            qi::rule&lt;It, skipParser&gt; m_sModuleItem;\n            qi::rule&lt;It, skipParser&gt; m_sType;\n\n            using tokens::identifier;\n        };\n\n        struct fileParser : qi::grammar&lt;It, ast::file()&gt; {\n            fileParser() : fileParser::base_type(file) {\n                file = qi::skip(qi::copy(m_sSkip)) [\n                        *(m_sDiscipline | m_sNature | m_sModule)\n                    ];\n\n                BOOST_SPIRIT_DEBUG_NODES((file))\n            }\n          private:\n            disciplineParser m_sDiscipline;\n            natureParser     m_sNature;\n            moduleParser     m_sModule;\n            skipParser       m_sSkip;\n\n            qi::rule&lt;It, ast::file()&gt; file;\n        };\n    };\n\n}\n\nextern std::string const sInput;\n\n// just for demo\n#include &lt;boost/optional/optional_io.hpp&gt;\n\nnamespace frank { namespace ast {\n    //static inline std::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, const nature::empty &amp;) { return os; }\n    static inline std::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, nature::Attribute a) {\n        switch(a) {\n            case nature::Attribute::units:  return os &lt;&lt; \"units\";\n            case nature::Attribute::access: return os &lt;&lt; \"access\";\n            case nature::Attribute::idt:    return os &lt;&lt; \"idt\";\n            case nature::Attribute::ddt:    return os &lt;&lt; \"ddt\";\n            case nature::Attribute::abstol: return os &lt;&lt; \"abstol\";\n        };\n        return os &lt;&lt; \"?\";\n    }\n    static inline std::ostream &amp;operator&lt;&lt;(std::ostream &amp;os, discipline::enumDomain d) {\n        switch(d) {\n            case discipline::eDiscrete:    return os &lt;&lt; \"discrete\";\n            case discipline::eContinuous:  return os &lt;&lt; \"continuous\";\n            case discipline::eUnspecified: return os &lt;&lt; \"(unspecified)\";\n        };\n        return os &lt;&lt; \"?\";\n    }\n} }\n\nstruct print_em {\n    using result_type = void;\n    template &lt;typename V&gt;\n    void operator()(V const&amp; variant) const {\n        boost::apply_visitor(*this, variant);\n    }\n    void operator()(frank::ast::nature const&amp; nature) const {\n        std::cout &lt;&lt; \"-- Nature\\n\";\n        std::cout &lt;&lt; \"name: \" &lt;&lt; nature.name &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"inherits: \" &lt;&lt; nature.inherits &lt;&lt; \"\\n\";\n        for (auto&amp; a : nature.attributes) {\n            std::cout &lt;&lt; \"attribute: \" &lt;&lt; a.first &lt;&lt; \" = \" &lt;&lt; a.second &lt;&lt; \"\\n\";\n        }\n    }\n    void operator()(frank::ast::discipline const&amp; discipline) const {\n        std::cout &lt;&lt; \"-- Discipline\\n\";\n        std::cout &lt;&lt; \"name: \" &lt;&lt; discipline.name &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"domain: \" &lt;&lt; discipline.properties.domain &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"flow: \" &lt;&lt; discipline.properties.flow &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; \"potential: \" &lt;&lt; discipline.properties.potential &lt;&lt; \"\\n\";\n    }\n    void operator()(frank::ast::module const&amp;) const {\n        std::cout &lt;&lt; \"-- Module (TODO)\\n\";\n    }\n};\n\nint main() {\n    using iterator_type = std::string::const_iterator;\n\n    iterator_type iter = sInput.begin(), last = sInput.end();\n\n    frank::Parsers&lt;iterator_type&gt;::fileParser parser;\n    print_em print;\n\n    frank::ast::file file;\n    bool ok = parse(iter, last, parser, file);\n\n    if (ok) {\n        for (auto&amp; symbol : file)\n            print(symbol);\n    }\n    else {\n        std::cout &lt;&lt; \"Parse failed\\n\";\n    }\n\n    if (iter != last) {\n        std::cout &lt;&lt; \"Remaining unparsed: '\" &lt;&lt; std::string(iter,last) &lt;&lt; \"'\\n\";\n    }\n}\n\nstd::string const sInput = R\"(\nnature Current;\n  units        = \"A\";\n  access       = I;\n  idt_nature   = Charge;\n  abstol       = 1e-12;\nendnature\n\n// Charge in coulombs\nnature Charge;\n  units      = \"coul\";\n  access     = Q;\n  ddt_nature = Current;\n  abstol     = 1e-14;\nendnature\n\n// Potential in volts\nnature Voltage;\n  units      = \"V\";\n  access     = V;\n  idt_nature = Flux;\n  abstol     = 1e-6;\nendnature\n\ndiscipline electrical;\n  potential    Voltage;\n  flow         Current;\nenddiscipline\n)\";\n</code></pre>\n\n<hr>\n\n<p>\u00b9 incidentally, the <a href=\"https://stackoverflow.com/questions/46838958/boost-karma-generator-for-composition-of-classes/46854802#46854802\">other answer</a> there demonstrates the \"impedance mismatch\" with polymorphic attributes and Spirit - this time on the Karma side of it</p>\n\n<p>\u00b2 (to prevent subtle bugs that depend on evaluation order or things like that, e.g.)</p>\n\n<p>\u00b3  (gleaning some from <a href=\"https://verilogams.com/refman/basics/disciplines.html\" rel=\"nofollow noreferrer\">here</a> but not importing too much complexity that wasn't reflected in your Lex approach)</p>\n\n<p>\u2074 (In fact, this is where you'd need state-switching inside the grammar, an area notoriously underdeveloped and practically unusable in Spirit Lex: e.g. when it works <a href=\"https://stackoverflow.com/questions/19630931/how-to-avoid-defining-token-which-matchs-everything-in-boostspiritlex/19632419#19632419\">how to avoid defining token which matchs everything in boost::spirit::lex</a> or when it goes badly: <a href=\"https://stackoverflow.com/questions/18100628/boost-spirit-sql-grammar-lexer-failure/18106293#18106293\">Boost.Spirit SQL grammar/lexer failure</a>)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8434768"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1510356411, "creation_date": 1510184004, "last_edit_date": 1510352375, "question_id": 47191531, "link": "https://stackoverflow.com/questions/47191531/cannot-get-boostspirit-parserlexer-working-for-token-types-other-than-stdst", "title": "cannot get boost::spirit parser&amp;lexer working for token types other than std::string or int or double", "body": "<p>This does not compile (code below).</p>\n\n<p>There was another question here with the same error. But I don't understand the answer. I already tried inserting qi::eps in places -- but without success.</p>\n\n<p>I also tried already adding meta functions (boost::spirit::raits::is_container) for the types used -- but this also does not help.</p>\n\n<p>I also tried using the same variant containing all types I need to use everywhere. Same problem.</p>\n\n<p>Has anybody gotten this working for a lexer returning something else than double or int or string? And for the parser also returning non-trivial objects?</p>\n\n<p>I've tried implementing semantic functions everywhere returning default objects. But this also does not help.</p>\n\n<p>Here comes the code:</p>\n\n<pre><code>// spirit_error.cpp : Defines the entry point for the console application.\n//\n\n#include &lt;boost/config/warning_disable.hpp&gt;\n#include &lt;boost/spirit/include/qi.hpp&gt;\n#include &lt;boost/spirit/include/phoenix_core.hpp&gt;\n#include &lt;boost/spirit/include/phoenix_operator.hpp&gt;\n#include &lt;boost/phoenix/object.hpp&gt;\n#include &lt;boost/spirit/include/qi_char_class.hpp&gt;\n#include &lt;boost/spirit/include/phoenix_bind.hpp&gt;\n#include &lt;boost/mpl/index_of.hpp&gt;\n#include &lt;boost/spirit/include/lex_lexertl.hpp&gt;\n#include &lt;boost/intrusive_ptr.hpp&gt;\n#include &lt;boost/smart_ptr/intrusive_ref_counter.hpp&gt;\n\nnamespace lex = boost::spirit::lex;\nnamespace qi = boost::spirit::qi;\nnamespace ascii = boost::spirit::ascii;\n\n\nnamespace frank\n{\nclass ref_counter:public boost::intrusive_ref_counter&lt;ref_counter&gt;\n{   public:\n    virtual ~ref_counter(void)\n    {\n    }\n};\nclass symbol:public ref_counter\n{   public:\n    typedef boost::intrusive_ptr&lt;const symbol&gt; symbolPtr;\n    typedef std::vector&lt;symbolPtr&gt; symbolVector;\n    struct push_scope\n    {   push_scope()\n        {\n        }\n        ~push_scope(void)\n        {\n        }\n    };\n};\nclass nature:public symbol\n{   public:\n    enum enumAttribute\n    {   eAbstol,\n        eAccess,\n        eDDT,\n        eIDT,\n        eUnits\n    };\n    struct empty\n    {   bool operator&lt;(const empty&amp;) const\n        {   return false;\n        }\n        friend std::ostream &amp;operator&lt;&lt;(std::ostream &amp;_r, const empty&amp;)\n        {   return _r;\n        }\n    };\n    typedef boost::variant&lt;empty, std::string&gt; attributeValue;\n};\nclass discipline:public symbol\n{   public:\n    enum enumDomain\n    {   eDiscrete,\n        eContinuous\n    };\n};\n\nclass type:public ref_counter\n{   public:\n    typedef boost::intrusive_ptr&lt;type&gt; typePtr;\n};\nstruct myIterator:std::iterator&lt;std::random_access_iterator_tag, char, std::ptrdiff_t, const char*, const char&amp;&gt;\n{   std::string *m_p;\n    std::size_t m_iPos;\n    myIterator(void)\n        :m_p(nullptr),\n        m_iPos(~std::size_t(0))\n    {\n    }\n    myIterator(std::string &amp;_r, const bool _bEnd = false)\n        :m_p(&amp;_r),\n        m_iPos(_bEnd ? ~std::size_t(0) : 0)\n    {\n    }\n    myIterator(const myIterator &amp;_r)\n        :m_p(_r.m_p),\n        m_iPos(_r.m_iPos)\n    {\n    }\n    myIterator &amp;operator=(const myIterator &amp;_r)\n    {   if (this != &amp;_r)\n        {   m_p = _r.m_p;\n            m_iPos = _r.m_iPos;\n        }\n        return *this;\n    }\n    const char &amp;operator*(void) const\n    {   return m_p-&gt;at(m_iPos);\n    }\n    bool operator==(const myIterator &amp;_r) const\n    {   return m_p == _r.m_p &amp;&amp; m_iPos == _r.m_iPos;\n    }\n    bool operator!=(const myIterator &amp;_r) const\n    {   return m_p != _r.m_p || m_iPos != _r.m_iPos;\n    }\n    myIterator &amp;operator++(void)\n    {   ++m_iPos;\n        if (m_iPos == m_p-&gt;size())\n            m_iPos = ~std::size_t(0);\n        return *this;\n    }\n    myIterator operator++(int)\n    {   const myIterator s(*this);\n        operator++();\n        return s;\n    }\n    myIterator &amp;operator--(void)\n    {   --m_iPos;\n        return *this;\n    }\n    myIterator operator--(int)\n    {   const myIterator s(*this);\n        operator--();\n        return s;\n    }\n    bool operator&lt;(const myIterator &amp;_r) const\n    {   if (m_p == _r.m_p)\n            return m_iPos &lt; _r.m_iPos;\n        else\n            return m_p &lt; _r.m_p;\n    }\n    std::ptrdiff_t operator-(const myIterator &amp;_r) const\n    {   return m_iPos - _r.m_iPos;\n    }\n};\nstruct onInclude\n{   auto operator()(myIterator &amp;_rStart, myIterator &amp;_rEnd) const\n    {       // erase what has been matched (the include statement)\n        _rStart.m_p-&gt;erase(_rStart.m_iPos, _rEnd.m_iPos - _rStart.m_iPos);\n        // and insert the contents of the file\n        _rStart.m_p-&gt;insert(_rStart.m_iPos, \"abcd\");\n        _rEnd = _rStart;\n        return lex::pass_flags::pass_ignore;\n    }\n};\ntemplate&lt;typename LEXER&gt;\nclass lexer:public lex::lexer&lt;LEXER&gt;\n{   public:\n    lex::token_def&lt;type::typePtr&gt; m_sKW_real, m_sKW_integer, m_sKW_string;\n    lex::token_def&lt;lex::omit&gt; m_sLineComment, m_sCComment;\n    lex::token_def&lt;lex::omit&gt; m_sWS;\n    lex::token_def&lt;lex::omit&gt; m_sSemicolon, m_sEqual, m_sColon, m_sInclude, m_sCharOP, m_sCharCP,\n        m_sComma;\n    lex::token_def&lt;std::string&gt; m_sIdentifier, m_sString;\n    lex::token_def&lt;double&gt; m_sReal;\n    lex::token_def&lt;int&gt; m_sInteger;\n    lex::token_def&lt;lex::omit&gt; m_sKW_units, m_sKW_access, m_sKW_idt_nature, m_sKW_ddt_nature, m_sKW_abstol,\n        m_sKW_nature, m_sKW_endnature, m_sKW_continuous, m_sKW_discrete,\n        m_sKW_potential, m_sKW_flow, m_sKW_domain, m_sKW_discipline, m_sKW_enddiscipline, m_sKW_module,\n        m_sKW_endmodule, m_sKW_parameter;\n    //typedef const type *typePtr;\n    template&lt;typename T&gt;\n    struct extractValue\n    {   T operator()(const myIterator &amp;_rStart, const myIterator &amp;_rEnd) const\n        {   return boost::lexical_cast&lt;T&gt;(std::string(_rStart, _rEnd));\n        }\n    };\n    struct extractString\n    {   std::string operator()(const myIterator &amp;_rStart, const myIterator &amp;_rEnd) const\n        {   const auto s = std::string(_rStart, _rEnd);\n            return s.substr(1, s.size() - 2);\n        }\n    };\n    lexer(void)\n        :m_sWS(\"[ \\\\t\\\\n\\\\r]+\"),\n        m_sKW_parameter(\"\\\"parameter\\\"\"),\n        m_sKW_real(\"\\\"real\\\"\"),\n        m_sKW_integer(\"\\\"integer\\\"\"),\n        m_sKW_string(\"\\\"string\\\"\"),\n        m_sLineComment(\"\\\\/\\\\/[^\\\\n]*\"),\n        m_sCComment(\"\\\\/\\\\*\"\n            \"(\"\n                \"[^*]\"\n                    \"|\" \"[\\\\n]\"\n                    \"|\" \"([*][^/])\"\n            \")*\"\n            \"\\\\*\\\\/\"),\n        m_sSemicolon(\"\\\";\\\"\"),\n        m_sEqual(\"\\\"=\\\"\"),\n        m_sColon(\"\\\":\\\"\"),\n        m_sCharOP(\"\\\"(\\\"\"), \n        m_sCharCP(\"\\\")\\\"\"),\n        m_sComma(\"\\\",\\\"\"),\n        m_sIdentifier(\"[a-zA-Z_]+[a-zA-Z0-9_]*\"),\n        m_sString(\"[\\\\\\\"]\"\n            //\"(\"\n            //  \"(\\\\[\\\"])\"\n            //  \"|\"\n                //\"[^\\\"]\"\n            //\")*\"\n            \"[^\\\\\\\"]*\"\n            \"[\\\\\\\"]\"),\n        m_sKW_units(\"\\\"units\\\"\"),\n        m_sKW_access(\"\\\"access\\\"\"),\n        m_sKW_idt_nature(\"\\\"idt_nature\\\"\"),\n        m_sKW_ddt_nature(\"\\\"ddt_nature\\\"\"),\n        m_sKW_abstol(\"\\\"abstol\\\"\"),\n        m_sKW_nature(\"\\\"nature\\\"\"),\n        m_sKW_endnature(\"\\\"endnature\\\"\"),\n        m_sKW_continuous(\"\\\"continuous\\\"\"),\n        m_sKW_discrete(\"\\\"discrete\\\"\"),\n        m_sKW_domain(\"\\\"domain\\\"\"),\n        m_sKW_discipline(\"\\\"discipline\\\"\"),\n        m_sKW_enddiscipline(\"\\\"enddiscipline\\\"\"),\n        m_sKW_potential(\"\\\"potential\\\"\"),\n        m_sKW_flow(\"\\\"flow\\\"\"),\n//realnumber      ({uint}{exponent})|((({uint}\\.{uint})|(\\.{uint})){exponent}?)\n//exponent        [Ee][+-]?{uint}\n//uint            [0-9][_0-9]*\n\n        m_sReal(\"({uint}{exponent})\"\n            \"|\"\n                \"(\"\n                    \"(({uint}[\\\\.]{uint})|([\\\\.]{uint})){exponent}?\"\n                \")\"\n        ),\n        m_sInteger(\"{uint}\"),\n        m_sInclude(\"\\\"`include\\\"\"),\n        m_sKW_module(\"\\\"module\\\"\"),\n        m_sKW_endmodule(\"\\\"endmodule\\\"\")\n    {   this-&gt;self.add_pattern\n            (\"uint\", \"[0-9]+\")\n            (\"exponent\", \"[eE][\\\\+\\\\-]?{uint}\");\n        this-&gt;self = m_sSemicolon\n            | m_sEqual\n            | m_sColon\n            | m_sCharOP\n            | m_sCharCP\n            | m_sComma\n            | m_sString[lex::_val = boost::phoenix::bind(extractString(), lex::_start, lex::_end)]\n            | m_sKW_real//[lex::_val = boost::phoenix::bind(&amp;type::getReal)]\n            | m_sKW_integer//[lex::_val = boost::phoenix::bind(&amp;type::getInteger)]\n            | m_sKW_string//[lex::_val = boost::phoenix::bind(&amp;type::getString)]\n            | m_sKW_parameter\n            | m_sKW_units\n            | m_sKW_access\n            | m_sKW_idt_nature\n            | m_sKW_ddt_nature\n            | m_sKW_abstol\n            | m_sKW_nature\n            | m_sKW_endnature\n            | m_sKW_continuous\n            | m_sKW_discrete\n            | m_sKW_domain\n            | m_sKW_discipline\n            | m_sKW_enddiscipline\n            | m_sReal[lex::_val = boost::phoenix::bind(extractValue&lt;double&gt;(), lex::_start, lex::_end)]\n            | m_sInteger[lex::_val = boost::phoenix::bind(extractValue&lt;int&gt;(), lex::_start, lex::_end)]\n            | m_sKW_potential\n            | m_sKW_flow\n            | m_sKW_module\n            | m_sKW_endmodule\n            | m_sIdentifier\n            | m_sInclude [ lex::_state = \"INCLUDE\" ]\n            ;\n        this-&gt;self(\"INCLUDE\") += m_sString [\n            lex::_state = \"INITIAL\", lex::_pass = boost::phoenix::bind(onInclude(), lex::_start, lex::_end)\n        ];\n        this-&gt;self(\"WS\") = m_sWS\n            | m_sLineComment\n            | m_sCComment\n            ;\n    }\n};\ntemplate&lt;typename Iterator, typename Lexer&gt;\nclass natureParser:public qi::grammar&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt;\n{   qi::rule&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sStart;\n    qi::rule&lt;Iterator, std::pair&lt;nature::enumAttribute, nature::attributeValue&gt;(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sProperty;\n    qi::rule&lt;Iterator, std::string(), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sName;\n    public:\n    template&lt;typename Tokens&gt;\n    natureParser(const Tokens &amp;_rTokens)\n        :natureParser::base_type(m_sStart)\n    {   m_sProperty = (_rTokens.m_sKW_units\n                &gt;&gt; _rTokens.m_sEqual\n                &gt;&gt; _rTokens.m_sString\n                &gt;&gt; _rTokens.m_sSemicolon\n                )\n            | (_rTokens.m_sKW_access\n                &gt;&gt; _rTokens.m_sEqual\n                &gt;&gt; _rTokens.m_sIdentifier\n                &gt;&gt; _rTokens.m_sSemicolon\n                )\n            | (_rTokens.m_sKW_idt_nature\n                &gt;&gt; _rTokens.m_sEqual\n                &gt;&gt; _rTokens.m_sIdentifier\n                &gt;&gt; _rTokens.m_sSemicolon\n                )\n            | (_rTokens.m_sKW_ddt_nature\n                &gt;&gt; _rTokens.m_sEqual\n                &gt;&gt; _rTokens.m_sIdentifier\n                &gt;&gt; _rTokens.m_sSemicolon\n                )\n            | (_rTokens.m_sKW_abstol\n                &gt;&gt; _rTokens.m_sEqual\n                &gt;&gt; _rTokens.m_sReal\n                &gt;&gt; _rTokens.m_sSemicolon\n                )\n            ;\n        m_sName = (_rTokens.m_sColon &gt;&gt; _rTokens.m_sIdentifier);\n        m_sStart = (_rTokens.m_sKW_nature\n            &gt;&gt; _rTokens.m_sIdentifier\n            &gt;&gt; -m_sName\n            &gt;&gt; _rTokens.m_sSemicolon\n            &gt;&gt; *(m_sProperty)\n            &gt;&gt; _rTokens.m_sKW_endnature\n            );\n        m_sStart.name(\"start\");\n        m_sProperty.name(\"property\");\n    }\n};\n/*\n// Conservative discipline\ndiscipline electrical; \n  potential    Voltage;\n  flow         Current;\nenddiscipline\n*/\n// a parser for a discipline declaration\ntemplate&lt;typename Iterator, typename Lexer&gt;\nclass disciplineParser:public qi::grammar&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt;\n{   qi::rule&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sStart;\n    typedef std::pair&lt;bool, boost::intrusive_ptr&lt;const nature&gt; &gt; CPotentialAndNature;\n    struct empty\n    {   bool operator&lt;(const empty&amp;) const\n        {   return false;\n        }\n        friend std::ostream &amp;operator&lt;&lt;(std::ostream &amp;_r, const empty&amp;)\n        {   return _r;\n        }\n    };\n    typedef boost::variant&lt;empty, CPotentialAndNature, discipline::enumDomain&gt; property;\n    qi::rule&lt;Iterator, discipline::enumDomain(), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sDomain;\n    qi::rule&lt;Iterator, property(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sProperty;\n    public:\n    template&lt;typename Tokens&gt;\n    disciplineParser(const Tokens &amp;_rTokens)\n        :disciplineParser::base_type(m_sStart)\n    {   m_sDomain = _rTokens.m_sKW_continuous\n            | _rTokens.m_sKW_discrete\n            ;\n        m_sProperty = (_rTokens.m_sKW_potential &gt;&gt; _rTokens.m_sIdentifier &gt;&gt; _rTokens.m_sSemicolon)\n            | (_rTokens.m_sKW_flow &gt;&gt; _rTokens.m_sIdentifier &gt;&gt; _rTokens.m_sSemicolon)\n            | (_rTokens.m_sKW_domain &gt;&gt; m_sDomain &gt;&gt; _rTokens.m_sSemicolon)\n            ;\n        m_sStart = (_rTokens.m_sKW_discipline\n            &gt;&gt; _rTokens.m_sIdentifier\n            &gt;&gt; _rTokens.m_sSemicolon\n            &gt;&gt; *m_sProperty\n            &gt;&gt; _rTokens.m_sKW_enddiscipline\n        );\n    }\n};\ntemplate&lt;typename Iterator, typename Lexer&gt;\nclass moduleParser:public qi::grammar&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt;\n{   public:\n    qi::rule&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sStart;\n    qi::rule&lt;Iterator, symbol::symbolVector(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sModulePortList;\n    qi::rule&lt;Iterator, symbol::symbolVector(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sPortList;\n    qi::rule&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sPort;\n    qi::rule&lt;Iterator, std::shared_ptr&lt;symbol::push_scope&gt;(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sModule;\n\n    typedef boost::intrusive_ptr&lt;const ref_counter&gt; intrusivePtr;\n    typedef std::vector&lt;intrusivePtr&gt; vectorOfPtr;\n    qi::rule&lt;Iterator, vectorOfPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sModuleItemList;\n    qi::rule&lt;Iterator, intrusivePtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sParameter;\n    qi::rule&lt;Iterator, intrusivePtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sModuleItem;\n    qi::rule&lt;Iterator, type::typePtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sType;\n\n    template&lt;typename Tokens&gt;\n    moduleParser(const Tokens &amp;_rTokens)\n        :moduleParser::base_type(m_sStart)\n    {   m_sPort = _rTokens.m_sIdentifier;\n        m_sPortList %= m_sPort % _rTokens.m_sComma;\n        m_sModulePortList %= _rTokens.m_sCharOP &gt;&gt; m_sPortList &gt;&gt; _rTokens.m_sCharCP;\n        m_sModule = _rTokens.m_sKW_module;\n        m_sType = _rTokens.m_sKW_real | _rTokens.m_sKW_integer | _rTokens.m_sKW_string;\n        m_sParameter = _rTokens.m_sKW_parameter\n            &gt;&gt; m_sType\n            &gt;&gt; _rTokens.m_sIdentifier\n        ;\n        m_sModuleItem = m_sParameter;\n        m_sModuleItemList %= *m_sModuleItem;\n        m_sStart = (m_sModule\n                &gt;&gt; _rTokens.m_sIdentifier\n                &gt;&gt; m_sModulePortList\n                &gt;&gt; m_sModuleItemList\n                &gt;&gt; _rTokens.m_sKW_endmodule);\n    }\n};\ntemplate&lt;typename Iterator, typename Lexer&gt;\nclass fileParser:public qi::grammar&lt;Iterator, symbol::symbolVector(void), qi::in_state_skipper&lt;Lexer&gt; &gt;\n{   public:\n    disciplineParser&lt;Iterator, Lexer&gt; m_sDiscipline;\n    natureParser&lt;Iterator, Lexer&gt; m_sNature;\n    moduleParser&lt;Iterator, Lexer&gt; m_sModule;\n    qi::rule&lt;Iterator, symbol::symbolVector(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sStart;\n    qi::rule&lt;Iterator, symbol::symbolPtr(void), qi::in_state_skipper&lt;Lexer&gt; &gt; m_sItem;\n    //public:\n    template&lt;typename Tokens&gt;\n    fileParser(const Tokens &amp;_rTokens)\n        :fileParser::base_type(m_sStart),\n        m_sNature(_rTokens),\n        m_sDiscipline(_rTokens),\n        m_sModule(_rTokens)\n    {   m_sItem = m_sDiscipline | m_sNature | m_sModule;\n        m_sStart = *m_sItem;\n    }\n};\n}\nint main()\n{   std::string sInput = \"\\\nnature Current;\\n\\\n  units        = \\\"A\\\";\\n\\\n  access       = I;\\n\\\n  idt_nature   = Charge;\\n\\\n  abstol       = 1e-12;\\n\\\nendnature\\n\\\n\\n\\\n// Charge in coulombs\\n\\\nnature Charge;\\n\\\n  units      = \\\"coul\\\";\\n\\\n  access     = Q;\\n\\\n  ddt_nature = Current;\\n\\\n  abstol     = 1e-14;\\n\\\nendnature\\n\\\n\\n\\\n// Potential in volts\\n\\\nnature Voltage;\\n\\\n  units      = \\\"V\\\";\\n\\\n  access     = V;\\n\\\n  idt_nature = Flux;\\n\\\n  abstol     = 1e-6;\\n\\\nendnature\\n\\\n\\n\\\ndiscipline electrical;\\n\\\n  potential    Voltage;\\n\\\n  flow         Current;\\n\\\nenddiscipline\\n\\\n\";\n    typedef lex::lexertl::token&lt;frank::myIterator, boost::mpl::vector&lt;frank::type::typePtr, std::string, double, int&gt; &gt; token_type;\n    typedef lex::lexertl::actor_lexer&lt;token_type&gt; lexer_type;\n    typedef frank::lexer&lt;lexer_type&gt;::iterator_type iterator_type;\n    typedef frank::fileParser&lt;iterator_type, frank::lexer&lt;lexer_type&gt;::lexer_def&gt; grammar_type;\n\n    frank::lexer&lt;lexer_type&gt; sLexer;\n    grammar_type sParser(sLexer);\n    frank::symbol::push_scope sPush;\n    auto pStringBegin = frank::myIterator(sInput);\n    auto pBegin(sLexer.begin(pStringBegin, frank::myIterator(sInput, true)));\n    const auto b = qi::phrase_parse(pBegin, sLexer.end(), sParser, qi::in_state(\"WS\")[sLexer.self]); \n}\n</code></pre>\n"}, {"tags": ["c++", "amazon-web-services"], "comments": [{"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1510183726, "post_id": 47191466, "comment_id": 81332344, "body": "Maybe instead of down voting, make an attempt to explain what you don&#39;t like? Did not ask the question correctly? Did I not google enough before asking?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1510183832, "post_id": 47191466, "comment_id": 81332372, "body": "Undefined reference means linker cannot find this function, which usually means you did not specify necessary libs for linking. Check docs which libs are required."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1510184654, "post_id": 47191466, "comment_id": 81332603, "body": "@Sam. I am sorry that someone downvoted your question. I just upvoted it. I have a lot of experience with the AWS C++ SDK. It will take some time to learn the &quot;Amazon Coding Style&quot; for the SDK. Post new questions with your source code and I will try to jump in with help when I am available."}, {"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "reply_to_user": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1510184714, "post_id": 47191466, "comment_id": 81332615, "body": "@JohnHanley Many thanks for your help! This community can be tough sometimes.  At times it is warranted, but at not always."}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "edited": false, "score": 0, "creation_date": 1510184903, "post_id": 47191466, "comment_id": 81332662, "body": "Your reputation is high enough that this should not happen. I do know how that feels. I even get downvoted when my answer was selected as the best answer."}], "answers": [{"comments": [{"owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "edited": false, "score": 0, "creation_date": 1510184497, "post_id": 47191589, "comment_id": 81332556, "body": "Thanks! I am using the Linux <code>g++ --std=c++11</code> from the command line, but this is still very helpful!"}], "tags": [], "owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "is_accepted": true, "score": 1, "last_activity_date": 1510184366, "creation_date": 1510184366, "answer_id": 47191589, "question_id": 47191466, "link": "https://stackoverflow.com/questions/47191466/c-awscredentials-undefined-reference-to-awsfreevoid/47191589#47191589", "title": "C++ AWSCredentials : undefined reference to `Aws::Free(void*)&#39;", "body": "<p>Here are the headers that I include for simple programs to test credentials using the Amazon C++ SDK:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;aws/core/Aws.h&gt;\n#include &lt;aws/core/utils/memory/stl/AWSString.h&gt;\n#include &lt;aws/core/utils/logging/DefaultLogSystem.h&gt;\n#include &lt;aws/core/utils/logging/AWSLogging.h&gt;\n#include &lt;aws/core/auth/AWSCredentialsProvider.h&gt;\n#include &lt;aws/core/auth/AWSCredentialsProviderChain.h&gt;\n</code></pre>\n\n<p>In your linker include the aws-cpp-sdk-core.lib library.</p>\n\n<p>Note: I am using Visual Studio to build my projects.</p>\n"}], "owner": {"reputation": 10095, "user_id": 1158977, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/B6Za7.png?s=128&g=1", "display_name": "Sam Hammamy", "link": "https://stackoverflow.com/users/1158977/sam-hammamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 47191589, "answer_count": 1, "score": 0, "last_activity_date": 1510184366, "creation_date": 1510183671, "question_id": 47191466, "link": "https://stackoverflow.com/questions/47191466/c-awscredentials-undefined-reference-to-awsfreevoid", "title": "C++ AWSCredentials : undefined reference to `Aws::Free(void*)&#39;", "body": "<p>I am learning <code>C++</code> by reading Stroustrup's book and I am practicing on some work related code.</p>\n\n<p>I need to write some small code for calling the <code>Amazon Simple Systems Manager</code> (which if I were to do it python would take about 5 min, but this is for learning).</p>\n\n<p>The first thing I need to do is create a <a href=\"https://sdk.amazonaws.com/cpp/api/0.12.9/d4/d27/class_aws_1_1_auth_1_1_a_w_s_credentials.html#a8aca53af9eec8a118c448790e28a4f2d\" rel=\"nofollow noreferrer\">credentials</a> object with the Access and Secret keys.  This is proving harder than I thought!</p>\n\n<pre><code>#include &lt;aws/core/Aws.h&gt;\n#include &lt;aws/core/auth/AWSCredentialsProvider.h&gt;\n...\nchar const* AWS_ACCESS_KEY_ID = \"aaaaaaa\";\nchar const* AWS_SECRET_ACCESS_KEY = \"bbbbb\";\n\nAws::Auth::AWSCredentials creds(AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY);\n</code></pre>\n\n<p>But I am getting the following error:</p>\n\n<pre><code>In function `Aws::Allocator&lt;char&gt;::deallocate(char*, unsigned long)':\nmain.cpp: undefined reference to `Aws::Free(void*)'\n</code></pre>\n\n<p>Best I can figure is this is a problem with how the <a href=\"https://sdk.amazonaws.com/cpp/api/0.12.9/de/dca/namespace_aws.html#ac45eb95643c91062d4d82a28d453aae7\" rel=\"nofollow noreferrer\">Aws::String</a> is supposed to work?</p>\n\n<p>According to the docs it's <code>typedef std::basic_string&lt; char, std::char_traits&lt; char &gt;, Aws::Allocator&lt; char &gt; &gt;</code></p>\n\n<p>I looked at <code>basic_string</code> and that's just the standard library string, beyond that I am lost.</p>\n"}, {"tags": ["c++", "malloc", "overriding", "operator-keyword", "free"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1510183211, "post_id": 47191347, "comment_id": 81332171, "body": "It looks like your <code>operator delete</code> isn&#39;t being called."}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1510183305, "post_id": 47191347, "comment_id": 81332214, "body": "I cant reproduce it: <a href=\"http://coliru.stacked-crooked.com/a/69ceb5d26a07b48f\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/69ceb5d26a07b48f</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1510183953, "post_id": 47191347, "comment_id": 81332405, "body": "<code>A* a = (B*)(new B);</code> why do you cast here?"}, {"owner": {"reputation": 25, "user_id": 8700041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8f571ec20ae4bae1a0b223aceaa5dd?s=128&d=identicon&r=PG", "display_name": "rmalizia44", "link": "https://stackoverflow.com/users/8700041/rmalizia44"}, "edited": false, "score": 0, "creation_date": 1510184291, "post_id": 47191347, "comment_id": 81332499, "body": "to test virtual deletion"}, {"owner": {"reputation": 628, "user_id": 4612387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q9ucn.png?s=128&g=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4612387/mark"}, "edited": false, "score": 0, "creation_date": 1510184635, "post_id": 47191347, "comment_id": 81332599, "body": "Looks good? <a href=\"http://cpp.sh/5uavy\" rel=\"nofollow noreferrer\">cpp.sh/5uavy</a>"}, {"owner": {"reputation": 25, "user_id": 8700041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8f571ec20ae4bae1a0b223aceaa5dd?s=128&d=identicon&r=PG", "display_name": "rmalizia44", "link": "https://stackoverflow.com/users/8700041/rmalizia44"}, "edited": false, "score": 0, "creation_date": 1510185120, "post_id": 47191347, "comment_id": 81332723, "body": "I think it is a MinGW bug"}, {"owner": {"reputation": 84, "user_id": 6529775, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XFCydMsiVt0/AAAAAAAAAAI/AAAAAAAAABs/kbB4mWpYI9M/photo.jpg?sz=128", "display_name": "alaniane", "link": "https://stackoverflow.com/users/6529775/alaniane"}, "edited": false, "score": 0, "creation_date": 1510186569, "post_id": 47191347, "comment_id": 81333119, "body": "try stepping through the program in a debugger to see if the delete is being called.  I think rmalizia44 maybe right and this is MinGW bug with those two flags.  I was unable to google any such bug, so if you find that it is a MinGW bug I would file it with them."}, {"owner": {"reputation": 84, "user_id": 6529775, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XFCydMsiVt0/AAAAAAAAAAI/AAAAAAAAABs/kbB4mWpYI9M/photo.jpg?sz=128", "display_name": "alaniane", "link": "https://stackoverflow.com/users/6529775/alaniane"}, "edited": false, "score": 0, "creation_date": 1510187326, "post_id": 47191347, "comment_id": 81333329, "body": "I tested your code in CodeBlocks which uses the MinGW compiler and the delete is not being called.  It appears that the code is still using the original delete and not the overridden one."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8700041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8f571ec20ae4bae1a0b223aceaa5dd?s=128&d=identicon&r=PG", "display_name": "rmalizia44", "link": "https://stackoverflow.com/users/8700041/rmalizia44"}, "edited": false, "score": 0, "creation_date": 1510192613, "post_id": 47192367, "comment_id": 81334589, "body": "It worked, should I define new[] and delete[] too? It&#39;s only on debug build"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 25, "user_id": 8700041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8f571ec20ae4bae1a0b223aceaa5dd?s=128&d=identicon&r=PG", "display_name": "rmalizia44", "link": "https://stackoverflow.com/users/8700041/rmalizia44"}, "edited": false, "score": 0, "creation_date": 1510203293, "post_id": 47192367, "comment_id": 81337328, "body": "@rmalizia44 You should define those if you&#39;re using them.  Otherwise they&#39;ll use the global ones included in your library."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 0, "last_activity_date": 1510190190, "creation_date": 1510190190, "answer_id": 47192367, "question_id": 47191347, "link": "https://stackoverflow.com/questions/47191347/c-dont-free-data-when-overriding-new-and-delete-operators/47192367#47192367", "title": "C++ don&#39;t free data when overriding new and delete operators", "body": "<p>It is calling a different <code>delete</code> function.  You should provide a definition for</p>\n\n<pre><code>void operator delete(void* ptr, std::size_t size);\n</code></pre>\n\n<p>When using C++17, both <code>delete</code> function should also be <code>noexcept</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 8700041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8f571ec20ae4bae1a0b223aceaa5dd?s=128&d=identicon&r=PG", "display_name": "rmalizia44", "link": "https://stackoverflow.com/users/8700041/rmalizia44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 47192367, "answer_count": 1, "score": 0, "last_activity_date": 1510190190, "creation_date": 1510182984, "last_edit_date": 1510184748, "question_id": 47191347, "link": "https://stackoverflow.com/questions/47191347/c-dont-free-data-when-overriding-new-and-delete-operators", "title": "C++ don&#39;t free data when overriding new and delete operators", "body": "<p>I replaced new and delete operators globally for debugging and I'm getting strange behavior, it looks like C++ don't free the data when I call delete.</p>\n\n<p>Minimal Code with Error:</p>\n\n<pre><code>#include \"stdlib.h\"\n#include \"stdio.h\"\n\n// Classes\nclass A\n{\n    int i;\npublic:\n    A() { printf(\"Created A\\n\"); }\n    virtual ~A() { printf(\"Destroyed A\\n\"); }\n};\nclass B : public A\n{\n    int j;\npublic:\n    B() { printf(\"Created B\\n\"); }\n    ~B() { printf(\"Destroyed B\\n\"); }\n};\n\nunsigned int num_allocs = 0;\n// Custom new/delete\nvoid* operator new(size_t size)\n{\n    void* p = malloc(size);\n    printf(\"[+] %p (%u)\\n\", p, size);\n    num_allocs += 1;\n    return p;\n}\nvoid operator delete(void* p)\n{\n    printf(\"[-] %p\\n\", p);\n    num_allocs -= 1;\n    free(p);\n}\n\nstruct Z\n{\n    int k;\n};\n\nint main()\n{\n    printf(\"Started\\n\");\n    A* a = (B*)(new B);\n    Z* z = new Z;\n    printf(\"Will delete\\n\");\n    delete a;\n    delete z;\n    printf(\"Finished\\n\");\n    printf(\"Allocs: %u\\n\", num_allocs);\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Output (Compiling with MSYS2 + MinGW32 on Windows):</p>\n</blockquote>\n\n<p>Started</p>\n\n<p>[+] 003e1a50 (12)</p>\n\n<p>Created A</p>\n\n<p>Created B</p>\n\n<p>[+] 003e8630 (4)</p>\n\n<p>Will delete</p>\n\n<p>Destroyed B</p>\n\n<p>Destroyed A</p>\n\n<p>Finished</p>\n\n<p>Allocs: 2</p>\n\n<blockquote>\n  <p>2 allocations remaining! WHY???</p>\n</blockquote>\n\n<p>Edit1: When I use -std=c++98 or -std=c++11 flag, the error disappears, the flags -std=c++14 and -std=c++1z reproduce the error.</p>\n"}, {"tags": ["c++", "lambda", "replace"], "comments": [{"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510182922, "post_id": 47191284, "comment_id": 81332061, "body": "@user0042 yes I am struggling to understand lambada functions."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1510183023, "post_id": 47191284, "comment_id": 81332098, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/lambda</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1510183097, "post_id": 47191284, "comment_id": 81332125, "body": "You don&#39;t have enough code here to tell, but I don&#39;t think you need a lambda here, just an old-value."}, {"owner": {"reputation": 14052, "user_id": 183397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e44d2e9eaaa792ed3990b4a4a4d33c38?s=128&d=identicon&r=PG", "display_name": "clstrfsck", "link": "https://stackoverflow.com/users/183397/clstrfsck"}, "edited": false, "score": 0, "creation_date": 1510183301, "post_id": 47191284, "comment_id": 81332212, "body": "What is the declaration for <code>m_songs</code>?   Is it <code>set&lt;Song&gt;</code>  or <code>vector&lt;Song&gt;</code>, or something else?"}, {"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "reply_to_user": {"reputation": 14052, "user_id": 183397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e44d2e9eaaa792ed3990b4a4a4d33c38?s=128&d=identicon&r=PG", "display_name": "clstrfsck", "link": "https://stackoverflow.com/users/183397/clstrfsck"}, "edited": false, "score": 0, "creation_date": 1510183470, "post_id": 47191284, "comment_id": 81332272, "body": "@msandiford it is a set"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 2, "creation_date": 1510183877, "post_id": 47191284, "comment_id": 81332383, "body": "@MichaelGrinnell I\u2019m pretty sure this sort of modification isn\u2019t legal on sets, because they\u2019re stored in order so anything that could change the order can break things."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 3, "creation_date": 1510184279, "post_id": 47191284, "comment_id": 81332496, "body": "With a set you must use the set member functions <code>erase</code> and <code>insert</code> to replace an element. You cannot just rewrite it."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1510248180, "post_id": 47191284, "comment_id": 81364992, "body": "@ZanLynx And I think that doesn\u2019t work while iterating, either. You can erase the current element while iterating if you do it carefully, but inserting while iterating just won\u2019t work well, I think. Although it might be possible to get it to work depending on the comparison function you use."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510248386, "post_id": 47191284, "comment_id": 81365134, "body": "@DanielH: Insertion into a set doesn&#39;t invalidate iterators. You do need to be prepared for the possibility that your iteration will run over your inserted element, if it got inserted after your iterator position."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1510253275, "post_id": 47191284, "comment_id": 81367839, "body": "@ZanLynx Right, which is harder to handle than with <code>erase</code>, where you can just set your loop iterator to the returned result and be sure of not missing anything."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510258000, "post_id": 47191284, "comment_id": 81370543, "body": "@DanielH: Sets are not vectors. In this case they&#39;re more like linked lists."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1510259494, "post_id": 47191284, "comment_id": 81371354, "body": "@ZanLynx I am aware. If sets were like vectors, there would be complications with inserting <i>before</i> the point as well. But it\u2019s still easier to handle the complications involved with erasing mid-loop than with inserting mid-loop, and there are still complications because you need to make sure you don\u2019t invalidate the current loop iterator."}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1510183807, "post_id": 47191394, "comment_id": 81332366, "body": "Wouldn\u2019t it be better to directly capture <code>newSong.getID()</code>? Probably not much of an issue unless <code>getID</code> is more expensive than it looks, I suppose."}, {"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "edited": false, "score": 0, "creation_date": 1510183818, "post_id": 47191394, "comment_id": 81332370, "body": "Ok I get that, i think it should be (Song const &amp; song) tho."}], "tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 2, "last_activity_date": 1510185512, "last_edit_date": 1510185512, "creation_date": 1510183270, "answer_id": 47191394, "question_id": 47191284, "link": "https://stackoverflow.com/questions/47191284/how-to-use-a-lambda-function-with-stdreplace-if/47191394#47191394", "title": "How to use a lambda function with std::replace_if()?", "body": "<pre><code>Song newSong = ...;\nstd::replace_if(std::begin(m_songs), std::end(m_songs), [&amp;newSong](const &amp;Song song) {\n    return newSong.getID() == song.getID();\n}, newSong);\n</code></pre>\n\n<p>You can also just capture the ID using this syntax (assuming id is a string):</p>\n\n<pre><code>[std::string id = std::move(newSong.getID()](const &amp;Song song) { return id == song.getID(); }\n</code></pre>\n\n<p>The lambda function captures <code>newSong</code> by reference and is able to use it within the lambda, now all you need to do is check the id against each song that the lambda is called with.</p>\n\n<p>The <code>replace_if</code> method calls the lambda function with each song in the collection of songs, so you don't need to iterate over all the songs in the method again</p>\n"}, {"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 2, "last_activity_date": 1510184078, "creation_date": 1510184078, "answer_id": 47191547, "question_id": 47191284, "link": "https://stackoverflow.com/questions/47191284/how-to-use-a-lambda-function-with-stdreplace-if/47191547#47191547", "title": "How to use a lambda function with std::replace_if()?", "body": "<p>Here is a C++17 replace_if with lambda example for you.</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main() {\n    vector&lt;int&gt; v{1,2,3,4,8,100};\n    int match = 4;\n    replace_if(v.begin(), v.end(), [&amp;](auto x){return x == match;}, 9999);\n    for(auto x: v) {\n        cout &lt;&lt; x &lt;&lt; ' ';\n    }\n    cout &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>I compiled it with</p>\n\n<pre><code>g++ -Wall -W -pedantic -g -std=c++17    replace-if-test.cpp   -o replace-if-test\n</code></pre>\n"}], "owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2392, "favorite_count": 2, "accepted_answer_id": 47191394, "answer_count": 2, "score": 1, "last_activity_date": 1516125569, "creation_date": 1510182635, "last_edit_date": 1516125569, "question_id": 47191284, "link": "https://stackoverflow.com/questions/47191284/how-to-use-a-lambda-function-with-stdreplace-if", "title": "How to use a lambda function with std::replace_if()?", "body": "<p>I am trying to write a function that will replace a Song in a set if there IDs match.</p>\n\n<p>I am still a bit confused by lambda expressions.</p>\n\n<p>I am trying to use replace_if but I am not sure how to reference the original song in the expression.</p>\n\n<p>m_songs is a set of song objects</p>\n\n<p>I want to replace with whichever song in m_song shares the ID with newSong.</p>\n\n<p>So basically how do I get the ids from m_songs in the replace if statement?</p>\n\n<pre><code>std::replace_if(m_songs.begin(), m_songs.end(),\n     newSong.getID() == (One of the m_songs?)getID() , newSong) ;\n</code></pre>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 671, "user_id": 8022336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VsZUw.png?s=128&g=1", "display_name": "pointerless", "link": "https://stackoverflow.com/users/8022336/pointerless"}, "edited": false, "score": 1, "creation_date": 1510181769, "post_id": 47191094, "comment_id": 81331661, "body": "<a href=\"https://stackoverflow.com/questions/849168/are-stdvector-elements-guaranteed-to-be-contiguous\" title=\"are stdvector elements guaranteed to be contiguous\">stackoverflow.com/questions/849168/&hellip;</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510182789, "post_id": 47191094, "comment_id": 81332020, "body": "We can assume <code>myClassType</code> <a href=\"http://en.cppreference.com/w/cpp/concept/PODType\" rel=\"nofollow noreferrer\">is POD</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 8190068, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1198b5f96aabc0588c3772f7e9382158?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Hoatson", "link": "https://stackoverflow.com/users/8190068/todd-hoatson"}, "edited": false, "score": 0, "creation_date": 1510246272, "post_id": 47191215, "comment_id": 81363688, "body": "I wanted to use #1, but VS 2003 is (apparently) not  C++11.  (They don&#39;t specify which version of the standard they support, so I just tried it.)  I tried #4 instead, and that compiles cleanly.  Thanks!"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 109, "user_id": 8190068, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1198b5f96aabc0588c3772f7e9382158?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Hoatson", "link": "https://stackoverflow.com/users/8190068/todd-hoatson"}, "edited": false, "score": 0, "creation_date": 1510253934, "post_id": 47191215, "comment_id": 81368218, "body": "C++11 was officially released in 2011 (hence its name), so of course VS2003 doesn&#39;t implement it (predates it by almost a decade). <a href=\"https://msdn.microsoft.com/en-us/library/hh567368.aspx\" rel=\"nofollow noreferrer\">C++11 support started being added to VS in VS2010 onwards</a>.  #2, #3, and #4 will work in all C++ versions that support <code>std::vector</code>.  I would use #2 myself, as it is the cleanest and least overhead. #3 and #4 are functionally the same (as <code>front()</code> is implemented as <code>*begin()</code>), and #4 is clearly the ugliest of them all."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1510184823, "last_edit_date": 1510184823, "creation_date": 1510182265, "answer_id": 47191215, "question_id": 47191094, "link": "https://stackoverflow.com/questions/47191094/writing-contents-of-vector-to-file-as-binary-data/47191215#47191215", "title": "Writing contents of vector to file as binary data", "body": "<p><code>std::vector</code> is guaranteed to store its elements in contiguous memory, so what you are attempting to do is OK, provided that <code>myClassType</code> is a <a href=\"http://en.cppreference.com/w/cpp/concept/PODType\" rel=\"nofollow noreferrer\">POD type</a>.  Otherwise, you will have to loop through the <code>std::vector</code> serializing each element one at a time to a flat format as needed.</p>\n\n<p>However, the <code>std::vector::begin()</code> method returns an <strong>iterator</strong> to the first element, not a <strong>pointer</strong> to the element data.  An iterator is <em>like</em> a pointer, but is <em>not</em> a pointer.  Container implementations are allowed to use actual pointers as iterators, but more times than not they use wrapper classes instead.  Do not rely on this behavior!  Use the iterator API the way it is intended to be used, and do not assume an iterator is an actual pointer.</p>\n\n<p>To get a valid pointer to the data of the first element of your vector, you need to either:</p>\n\n<ol>\n<li><p>use <code>std::vector::data()</code> (C++11 and later only):</p>\n\n<pre><code>myVect.data()\n</code></pre>\n\n<p>This is safe to use even if the vector is empty. <code>data()</code> may or may not return <code>nullptr</code> when <code>size()</code> is 0, but that is OK since <code>write()</code> will not try to access any memory when <code>size()</code> is 0.</p>\n\n<pre><code>bool OK = File.write((char*) myVect.data(), myVect.size() * sizeof(myClassType));\n</code></pre></li>\n<li><p>use <code>std::vector::operator[]</code> to get a reference to the first element, then use <code>operator&amp;</code> to get the element's address:</p>\n\n<pre><code>&amp;myVect[0]\n</code></pre>\n\n<p>Note that <code>operator[]</code> does not perform bounds checking, and thus will return an undefined pointer if the specified index is >= <code>size()</code>, so make sure to check if the vector is empty before writing it:</p>\n\n<pre><code>bool OK = myVect.empty() || File.write((char*) &amp;myVect[0], myVect.size() * sizeof(myClassType));\n</code></pre></li>\n<li><p>same as #2, but using <code>std::vector::front()</code> instead:</p>\n\n<pre><code>&amp;myVect.front()\n</code></pre>\n\n<p>Note that calling <code>front()</code> on an empty vector is undefined behavior, so make sure to check if the vector is empty:</p>\n\n<pre><code>bool OK = myVect.empty() || File.write((char*) &amp;myVect.front(), myVect.size() * sizeof(myClassType));\n</code></pre></li>\n<li><p>use <code>begin()</code> to get an iterator to the first element, then use <code>operator*</code> to dereference the iterator to get a reference to the element it points to, then you can get the element's address:</p>\n\n<pre><code>&amp;(*(myVect.begin()))\n</code></pre>\n\n<p>Note that <code>begin()</code> returns the <code>end()</code> iterator when the vector is empty, and dereferencing the <code>end()</code> iterator is undefined behavior, so make sure to check if the vector is empty:</p>\n\n<pre><code>bool OK = myVect.empty() || File.write((char*) &amp;(*(myVect.begin())), myVect.size() * sizeof(myClassType));\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 8190068, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1198b5f96aabc0588c3772f7e9382158?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Hoatson", "link": "https://stackoverflow.com/users/8190068/todd-hoatson"}, "edited": false, "score": 0, "creation_date": 1510246355, "post_id": 47191496, "comment_id": 81363753, "body": "Great tip - I wanted to use this, but VS 2003 is (apparently) not C++11. (They don&#39;t specify which version of the standard they support, so I just tried it &amp; &lt;type_traits&gt; could not be found.)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1510254021, "post_id": 47191496, "comment_id": 81368264, "body": "<code>static_assert</code> is only in C++11 and later, and it was <a href=\"https://msdn.microsoft.com/en-us/library/hh567368.aspx\" rel=\"nofollow noreferrer\">added to VS in VS2010</a>."}], "tags": [], "owner": {"reputation": 23279, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "is_accepted": false, "score": 4, "last_activity_date": 1510184465, "last_edit_date": 1510184465, "creation_date": 1510183826, "answer_id": 47191496, "question_id": 47191094, "link": "https://stackoverflow.com/questions/47191094/writing-contents-of-vector-to-file-as-binary-data/47191496#47191496", "title": "Writing contents of vector to file as binary data", "body": "<p>Remy Lebeau's answer is correct.  To add to it, if you want to add more safety to your code you should also use <a href=\"http://en.cppreference.com/w/cpp/language/static_assert\" rel=\"nofollow noreferrer\"><code>static_assert</code></a> to make sure <code>myClassType</code> is safe to write like you want:</p>\n\n<pre><code>#include &lt;type_traits&gt;\nstatic_assert(std::is_pod_v&lt;myClassType&gt;, \"myClassType is potentialy unsafe to write as-is\");\n</code></pre>\n\n<p>If somebody modifies <code>myClassType</code> in the future in a way that makes it unsafe to use in your <code>File.write()</code> code, this compile time check will catch it.</p>\n"}], "owner": {"reputation": 109, "user_id": 8190068, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1198b5f96aabc0588c3772f7e9382158?s=128&d=identicon&r=PG&f=1", "display_name": "Todd Hoatson", "link": "https://stackoverflow.com/users/8190068/todd-hoatson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1254, "favorite_count": 0, "accepted_answer_id": 47191215, "answer_count": 2, "score": 0, "last_activity_date": 1510184823, "creation_date": 1510181619, "question_id": 47191094, "link": "https://stackoverflow.com/questions/47191094/writing-contents-of-vector-to-file-as-binary-data", "title": "Writing contents of vector to file as binary data", "body": "<p>I have some 15-year-old C++ code that I am trying to bring up to more modern times. At this stage, I'm trying to get code that compiled with Visual C++ 6.0 to now compile with VS 2003 (Microsoft Visual C++ .NET 69462-335-0000007-18915).</p>\n\n<pre><code>std::vector&lt;myClassType&gt; myVect;\n...\n\n// Assuming vector.begin() simply points to start of a contiguous array\nbool OK = File.write((char*) myVect.begin(),\n                     myVect.size() * sizeof(myClassType));\n</code></pre>\n\n<p>When I read the comment, I get concerned...  Can we really assume that a vector is in contiguous memory?  If not, what is a better way to do this?  Do I need to loop through the vector contents &amp; write each set of data from myClassType?</p>\n\n<p>As it is, the compiler complains about casting the result of begin() to char* anyway.</p>\n"}, {"tags": ["c++", "multithreading", "openmp"], "answers": [{"comments": [{"owner": {"reputation": 1113, "user_id": 969295, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/dea809ef5ac9770fb400f1eb65544443?s=128&d=identicon&r=PG", "display_name": "Sassa", "link": "https://stackoverflow.com/users/969295/sassa"}, "edited": false, "score": 0, "creation_date": 1510186122, "post_id": 47191594, "comment_id": 81332996, "body": "My problem is with mixed threading technologies as you said, but I don&#39;t think I manually changing <code>currentNumThreads</code> and <code>maxNumThreads</code> will work since it&#39;s not guaranteed that I will enter <code>run()</code> at the same time. What I mean is that I can have a thread doing another thing that doesn&#39;t have nothing to do with <code>run()</code> and it will still count in th <code>num_threads()</code> calculation."}], "tags": [], "owner": {"reputation": 1457, "user_id": 2638548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mkJxQ.jpg?s=128&g=1", "display_name": "dlasalle", "link": "https://stackoverflow.com/users/2638548/dlasalle"}, "is_accepted": false, "score": 0, "last_activity_date": 1510184394, "creation_date": 1510184394, "answer_id": 47191594, "question_id": 47191091, "link": "https://stackoverflow.com/questions/47191091/openmp-manage-multiple-calls-to-block-with-parallel-for/47191594#47191594", "title": "OpenMP - Manage multiple calls to block with parallel for", "body": "<p>If you use only OpenMP for parallelism, and you have <a href=\"http://%60omp_set_nested()%60\" rel=\"nofollow noreferrer\">nested parallelism</a> enabled you could use the <code>num_threads</code> argument to the <code>pragma omp parallel</code> to specify to use half of the threads:</p>\n\n<pre><code>int const currentNumThreads = omp_get_num_threads();\nint const maxNumThreads = omp_get_max_num_threads();\n#pragma omp parallel for num_threads(maxNumThreads/currentNumThreads)\nfor ( ... ) {\n   ...\n}\n</code></pre>\n\n<p>Even if you are using mixed threading technologies (which seems to be your case), you could still accomplish the same by using different methods to set <code>currentNumThreads</code> and <code>maxNumThreads</code>.</p>\n\n<p>A word of caution though. Using nested parallelism is generally inadvisable for OpenMP, as it makes code quite <a href=\"https://en.wikipedia.org/wiki/Software_brittleness\" rel=\"nofollow noreferrer\">fragile and rigid</a>. Any change to your <code>run()</code> function needs to be aware of where it is called from, and any future calls to <code>run()</code> need to be aware of whats inside of it. Both in terms of performance and maintenance, trying to follow a <a href=\"https://en.wikipedia.org/wiki/Data_parallelism\" rel=\"nofollow noreferrer\">data parallel</a> approach for OpenMP usage is best. That is, perform a similar set of operations in each thread, but on a different chunk of data.</p>\n\n<p>The exception to this, is if you are using OpenMP tasks, which you can spawn, and let the scheduler take care of it. Using task parallelism in a parallel for loop will tend to lead to poor performance due to a lack of <a href=\"https://en.wikipedia.org/wiki/Locality_of_reference\" rel=\"nofollow noreferrer\">data locality</a> and high overhead if the tasks are small.</p>\n"}], "owner": {"reputation": 1113, "user_id": 969295, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/dea809ef5ac9770fb400f1eb65544443?s=128&d=identicon&r=PG", "display_name": "Sassa", "link": "https://stackoverflow.com/users/969295/sassa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510184394, "creation_date": 1510181599, "question_id": 47191091, "link": "https://stackoverflow.com/questions/47191091/openmp-manage-multiple-calls-to-block-with-parallel-for", "title": "OpenMP - Manage multiple calls to block with parallel for", "body": "<p>Let's say I have a program with a function called <code>run()</code>, this function will do a <code>for loop</code> and do some work inside it.</p>\n\n<p>Since I want to take advantage of all my CPU cores, I use <code>OpenMP</code> with <code>#pragma omp parallel for</code> to parallelize it.</p>\n\n<p>Now, the problem is that this <code>run()</code> function is called from several threads, and when there is a high number of threads calling <code>run()</code> at the same time, I have a huge performance penalty since there will be a lot of <code>OpenMP threads</code> from each <code>parallel for</code> pragma call.</p>\n\n<p>Just to ilustrate, I have thread <code>A</code> and thread <code>B</code> and my CPU have 4 cores, thread <code>A</code> calls function <code>run()</code> which will create 4 <code>OpenMP</code> threads to run the <code>for loop</code>.</p>\n\n<p>Now, at the same time, thread <code>B</code> also calls <code>run()</code>, this will generate more 4 <code>OpenMP</code> threads, resulting in a total of 8 <code>OpenMP</code> threads.</p>\n\n<p>My question is if there is some way to balance this with <code>OpenMP</code>, in the example above, <code>OpenMP</code> could use half threads for <code>A</code> and half for <code>B</code>.\nAnother strategy would be to <code>OpenMP</code> create a thread queue, so it never uses more than 4 <code>OpenMP</code> threads.</p>\n\n<p>Is something like that possible?</p>\n\n<p>PS. Note that the 2 threads in my example is just to illustrate it, in my program it is not clear how much threads will be calling <code>run()</code> since the number of threads are created in run-time as needed.</p>\n\n<p>PS 2. Note that whenever I'm talking about <code>OpenMP</code> created threads, I called it <code>OpenMP</code> thread, and when I'm talking about a thread created by other means (<code>std::thread</code> for example) I called it simply thread.</p>\n"}, {"tags": ["c++", "templates", "inheritance", "linker", "rcpp"], "comments": [{"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1510182649, "post_id": 47191084, "comment_id": 81331966, "body": "Can you make it an actual &#39;minimally reproducible example&#39;?"}, {"owner": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "reply_to_user": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1510244122, "post_id": 47191084, "comment_id": 81362136, "body": "@DirkEddelbuettel I can now that Fabian showed me how to - is it better to strip out the (large) irrelevant R/Rcpp sections, or add a reprex at the end as an addition?"}, {"owner": {"reputation": 329671, "user_id": 143305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e96ca7ae02c37e7d940d17997d780e5?s=128&d=identicon&r=PG", "display_name": "Dirk Eddelbuettel", "link": "https://stackoverflow.com/users/143305/dirk-eddelbuettel"}, "edited": false, "score": 0, "creation_date": 1510244934, "post_id": 47191084, "comment_id": 81362716, "body": "BTW the <code>U</code> in your <code>nm ... | c++filt</code> output was already a smoking gun as it mean <i>undefined</i> -- see <code>man nm</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "edited": false, "score": 0, "creation_date": 1510190381, "post_id": 47192141, "comment_id": 81334069, "body": "Thanks!  I\u2019ll give this a try. My intention is to declare this as a virtual method that must be overridden, would <code>= 0;</code> be another sensible alternative?"}, {"owner": {"reputation": 56, "user_id": 8382867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bd908d5891ccb4be57c6060935748?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/8382867/fabian"}, "reply_to_user": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "edited": false, "score": 1, "creation_date": 1510192620, "post_id": 47192141, "comment_id": 81334591, "body": "I also thought of <code>= 0;</code>, but this causes an <code>invalid abstract parameter type &#39;Slider&lt;double&gt;&#39;</code> compiler error, as <code>slide</code> has an argument of type <code>Slider&lt;T&gt;</code> and this is not allowed when <code>Slider&lt;T&gt;</code> has a pure (<code>= 0</code>) virtual member function. But when you pass the argument by reference, i.e. <code>template &lt;class T&gt; void slide(std::vector&lt;T&gt; x, Slider&lt;T&gt;&amp; s) {}</code>, you may use <code>= 0;</code>."}, {"owner": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "edited": false, "score": 1, "creation_date": 1510243671, "post_id": 47192141, "comment_id": 81361775, "body": "After trying this out, here&#39;s an important note: passing the <code>Slider</code> by reference is essential for the method dispatch to work correctly.  If I don&#39;t add the <code>&amp;</code>, then the base <code>Slider</code> method gets called rather than the desired method in the derived <code>SlidingVar</code> class."}, {"owner": {"reputation": 56, "user_id": 8382867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bd908d5891ccb4be57c6060935748?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/8382867/fabian"}, "reply_to_user": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "edited": false, "score": 1, "creation_date": 1510247605, "post_id": 47192141, "comment_id": 81364624, "body": "Yes, I should have mentioned (but probably was distracted by the linking problem): Dynamic dispatch of <code>virtual</code> methods requires that the object be accessed by reference (<code>&amp;</code>) or by pointer (<code>*</code>), with the first option usually being more convenient and preferable. When declared as a (class) type without reference or pointer in a function, the argument is (if necessary) converted to the declared type and that means all members are those of the declared type (when accessed from within the function)."}], "tags": [], "owner": {"reputation": 56, "user_id": 8382867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d1bd908d5891ccb4be57c6060935748?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/8382867/fabian"}, "is_accepted": true, "score": 1, "last_activity_date": 1510189801, "last_edit_date": 1510189801, "creation_date": 1510188377, "answer_id": 47192141, "question_id": 47191084, "link": "https://stackoverflow.com/questions/47191084/template-inheritance-symbol-not-found/47192141#47192141", "title": "Template inheritance: Symbol not found", "body": "<p>I could reproduce the linker error after adding an <code>int main() { }</code> and compiling with <code>g++</code> without additional options:</p>\n\n<pre><code>sliding_sd.cpp:(.rdata$_ZTV6SliderIdE[__ZTV6SliderIdE]+0x8): undefined reference to `Slider&lt;double&gt;::save_result()'\n</code></pre>\n\n<p>This means there is a reference to the virtual method <code>Slider&lt;double&gt;::save_result()</code> in the vtable (virtual method table) of <code>Slider&lt;double&gt;</code> which could not be resolved during linking. The cause is that you declared <code>save_result()</code> in <code>template &lt;class T&gt; class Slider</code> but did not define it (at least in the code you have posted). Albeit <code>Slider&lt;double&gt;::save_result()</code> is never used in your example, it must be defined (at least when using ordinary C++, I do not know about R), as it is <code>virtual</code>. Otherwise the vtable for <code>Slider&lt;double&gt;</code> cannot be created during linking.</p>\n\n<p>When changed to</p>\n\n<pre><code>template &lt;class T&gt;\nclass Slider {\n  /* ... */\n  virtual void save_result() { }\n};\n</code></pre>\n\n<p>the linking error disappears (at least in my reproduction).</p>\n"}], "owner": {"reputation": 19714, "user_id": 169947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/94c9072a6b1ac6e02e735b3df640e277?s=128&d=identicon&r=PG", "display_name": "Ken Williams", "link": "https://stackoverflow.com/users/169947/ken-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 47192141, "answer_count": 1, "score": 2, "last_activity_date": 1510189801, "creation_date": 1510181573, "question_id": 47191084, "link": "https://stackoverflow.com/questions/47191084/template-inheritance-symbol-not-found", "title": "Template inheritance: Symbol not found", "body": "<p>I'm having problems with templates &amp; inheritance.  I've whittled down some problematic code to something I can post here.  My code is as follows:</p>\n\n<pre><code>///////////////////////////// My header.h file\n#include &lt;vector&gt;\n\ntemplate &lt;class T&gt;\nclass Slider {\nprotected:\n  std::vector&lt;T&gt; out;\npublic:\n  Slider() : out() {}\n  virtual void save_result();\n};\n\ntemplate &lt;class T&gt;\nclass SlidingVar : public Slider&lt;T&gt; {\npublic:\n  SlidingVar() {}\n  void save_result() {}\n};\n\ntemplate &lt;class T&gt;\nvoid slide(std::vector&lt;T&gt; x, Slider&lt;T&gt; s) {}\n\n///////////////////////////// My sliding_sd.cpp file\n#include &lt;vector&gt;\n#include \"headers.h\"\n\nvoid sliding_var_window(std::vector&lt;double&gt; x) {\n  SlidingVar&lt;double&gt; s;\n  slide(x, s);\n}\n</code></pre>\n\n<p>Although the above is all \"pure C++\" code, I'm doing this in the context of an <code>R</code> package for which my <code>sliding_var_window</code> function will be exported to be callable from R.</p>\n\n<p>The above compiles okay, but when R loads it using <code>dlopen</code>, I get <code>Symbol not found</code> errors about the <code>save_result()</code> function.  Oddly, before I whittled this down, other similar functions were working just fine, but not this one.  Here's the build sequence:</p>\n\n<pre><code>==&gt; R CMD INSTALL --preclean --no-multiarch --with-keep.source tsevents\n\n* installing to library \u2018/Users/kwilliams/R/library/3.4\u2019\n* installing *source* package \u2018TSEvents\u2019 ...\n** libs\nclang++ -std=gnu++11 -I/usr/local/Cellar/r/3.4.2/lib/R/include -DNDEBUG  -I\"/Users/kwilliams/R/library/3.4/Rcpp/include\" -I/usr/local/opt/gettext/include -I/usr/local/opt/readline/include -I/usr/local/include   -fPIC  -g -O2 -c sliding_sd.cpp -o sliding_sd.o\nclang++ -std=gnu++11 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/lib -L/usr/local/Cellar/r/3.4.2/lib/R/lib -L/usr/local/opt/gettext/lib -L/usr/local/opt/readline/lib -L/usr/local/lib -o TSEvents.so sliding_sd.o -L/usr/local/Cellar/r/3.4.2/lib/R/lib -lR -lintl -Wl,-framework -Wl,CoreFoundation\ninstalling to /Users/kwilliams/R/library/3.4/TSEvents/libs\n** R\n** preparing package for lazy loading\n** help\n*** installing help indices\n** building package indices\n** testing if installed package can be loaded\nError: package or namespace load failed for \u2018TSEvents\u2019 in dyn.load(file, DLLpath = DLLpath, ...):\n unable to load shared object '/Users/kwilliams/R/library/3.4/TSEvents/libs/TSEvents.so':\n  dlopen(/Users/kwilliams/R/library/3.4/TSEvents/libs/TSEvents.so, 6): Symbol not found: __ZN6SliderIdE11save_resultEv\n  Referenced from: /Users/kwilliams/R/library/3.4/TSEvents/libs/TSEvents.so\n  Expected in: flat namespace\n in /Users/kwilliams/R/library/3.4/TSEvents/libs/TSEvents.so\nError: loading failed\n</code></pre>\n\n<p>I suspect this really has nothing to do with <code>R</code> or <code>Rcpp</code>, but that's providing my build environment, so if someone could suggest a way to demonstrate this problem in a pure C++ toolchain, that would be most welcome.</p>\n\n<p>Another tidbit I don't understand - when I look at the symbols defined in the object file, the <code>save_result()</code> function appears to have an <code>unsigned short</code> return type, when I declared it to be <code>void</code>:</p>\n\n<pre><code>% nm src/TSEvents.so | c++filt | grep result\n0000000000002df0 unsigned short SlidingVar&lt;double&gt;::save_result()\n                 U Slider&lt;double&gt;::save_result()\n</code></pre>\n\n<p>Is that normal?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1510181270, "post_id": 47190994, "comment_id": 81331449, "body": "This code invokes <b>undefined behaviour</b>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1510185093, "post_id": 47190994, "comment_id": 81332713, "body": "@OliverCharlesworth No it doesn&#39;t.  <code>tablica[0]</code> is incremented until it exceeds 100 and then the program finishes"}], "answers": [{"comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1510182449, "post_id": 47191127, "comment_id": 81331904, "body": "<code>tablica[1]</code> is not initialised, so technically evaluating this expression invokes UB.  As pointed out in another answer, this will typically be optimised to a no-op by the compiler, but there&#39;s no guarantee of that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1510185600, "post_id": 47191127, "comment_id": 81332840, "body": "This was correct until the very end... it does not even get value from <code>tablica[1]</code>. That expression just does nothing. (And does not cause UB)."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1510216294, "post_id": 47191127, "comment_id": 81342949, "body": "@M.M - An optimising compiler may choose not to get the value, but there&#39;s nothing in the standard that mandates that.  Indeed Annex J of C99 states that it&#39;s UB to use the value of an indeterminate object, so I guess it depends on whether &quot;use&quot; includes &quot;evaluation&quot; :)  But the specific badness I&#39;m imagining is this loading a trap representation into a register, thus causing an error."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1510218392, "post_id": 47191127, "comment_id": 81344143, "body": "@OliverCharlesworth C99 annex J is irrelevant to C++. There is something in the C++ standard that mandates to not get the value."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1510219194, "post_id": 47191127, "comment_id": 81344587, "body": "@M.M. the fact that this question is C++ is (a) something I didn&#39;t spot and (b) a good argument for why that annex is irrelevant ;)"}, {"owner": {"reputation": 34, "user_id": 4083120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gH7AJXByUzc/AAAAAAAAAAI/AAAAAAAADlI/GNBO_31hnRc/photo.jpg?sz=128", "display_name": "armo", "link": "https://stackoverflow.com/users/4083120/armo"}, "reply_to_user": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1510219884, "post_id": 47191127, "comment_id": 81345015, "body": "@OliverCharlesworth You are right, there is UB for not initialised array. I suppose it will return current memory value. I have &quot;fixed&quot; my replay."}], "tags": [], "owner": {"reputation": 34, "user_id": 4083120, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gH7AJXByUzc/AAAAAAAAAAI/AAAAAAAADlI/GNBO_31hnRc/photo.jpg?sz=128", "display_name": "armo", "link": "https://stackoverflow.com/users/4083120/armo"}, "is_accepted": false, "score": -2, "last_activity_date": 1510219837, "last_edit_date": 1510219837, "creation_date": 1510181813, "answer_id": 47191127, "question_id": 47190994, "link": "https://stackoverflow.com/questions/47190994/i-dont-know-how-it-work-table1/47191127#47191127", "title": "I don&#39;t know how it work table[+1]?", "body": "<p>It simply cout <code>tablica[0]</code> but 100 times (starting from 1 2 3 .. 100), each time incrementing <code>tablica[0]</code>. Variable <code>a</code> is never changed. \nAt <code>for</code> where is <code>tablica[+1]</code> is equal to <code>tablica[1]</code>, but it simply get value from it and don't do any thing with it.</p>\n"}, {"tags": [], "owner": {"reputation": 566, "user_id": 7664731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjiDx.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7664731/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1510181831, "creation_date": 1510181831, "answer_id": 47191133, "question_id": 47190994, "link": "https://stackoverflow.com/questions/47190994/i-dont-know-how-it-work-table1/47191133#47191133", "title": "I don&#39;t know how it work table[+1]?", "body": "<p><code>a</code> is always 0, so <code>tablica[0]</code> and <code>tablica[a]</code> are always the same thing.</p>\n\n<p><code>for (tablica[0]=1;</code>, now we have initialised <code>tablica[0]</code> to 1.</p>\n\n<p><code>tablica[a]&lt;=100;</code>, this will break when <code>tablica[0]</code> is greater than 100.</p>\n\n<p><code>tablica[a]+=1;</code>, it is actually being incremented in the loop. </p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1510185141, "post_id": 47191219, "comment_id": 81332730, "body": "Note, there is no attempt to access the stored value of <code>tablica[1]</code>  . In C++ discarded-value expressions do not undergo lvalue-to-rvalue conversion"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1510182279, "creation_date": 1510182279, "answer_id": 47191219, "question_id": 47190994, "link": "https://stackoverflow.com/questions/47190994/i-dont-know-how-it-work-table1/47191219#47191219", "title": "I don&#39;t know how it work table[+1]?", "body": "<p>A <code>for</code> loop like:</p>\n\n<pre><code>for (init; test; repeat) {\n    body;\n}\n</code></pre>\n\n<p>is mostly equivalent to:</p>\n\n<pre><code>init;\nwhile (test) {\n    body;\n    repeat;\n}\n</code></pre>\n\n<p>So the loop you're given is like:</p>\n\n<pre><code>tablica[0]=1;\nwhile (tablica[a] &lt;= 100) {\n    cout &lt;&lt; tablica[a] &lt;&lt; endl;\n    tablica[a] += 1;\n    tablica[+1];\n}\n</code></pre>\n\n<p>Since <code>a</code> was initialized to <code>0</code>, and is never changed, <code>tablica[a]</code> is the same as <code>tablica[0]</code>.</p>\n\n<p><code>tablica[+1]</code> is executed, but it never uses the value of that array element. The array element is not initialized, so its value is indeterminate, but since the value isn't used for anything it's not a problem. You can just ignore that part of it (and the compiler will most likely optimize it away).</p>\n\n<p>So this isn't really much different from a typical loop like:</p>\n\n<pre><code>for (i = 1; i &lt;= 100; i++) {\n    cout &lt;&lt; i &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Your friend was just trying to confuse you (and succeeding) by using an array element instead of a simple variable for the iteration, and throwing in the extraneous expression <code>tablica[+1]</code> that looks kind of like iteration, but doesn't actually do anything.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8910017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1510219837, "creation_date": 1510181103, "question_id": 47190994, "link": "https://stackoverflow.com/questions/47190994/i-dont-know-how-it-work-table1", "title": "I don&#39;t know how it work table[+1]?", "body": "<p>My beginer friend do this code and i don't know how its can work for example this table[+1]</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    int a=0;\n    int tablica[100];\n    for (tablica[0]=1;tablica[a]&lt;=100;tablica[+1]){\n        cout &lt;&lt; tablica[a] &lt;&lt; endl;\n        tablica[a]+=1;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "methods", "initialization", "function-pointers", "member-function-pointers"], "comments": [{"owner": {"reputation": 449, "user_id": 6104707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7815bb23dfc1479513c706c05a09940?s=128&d=identicon&r=PG&f=1", "display_name": "siehe-falz", "link": "https://stackoverflow.com/users/6104707/siehe-falz"}, "edited": false, "score": 1, "creation_date": 1510181614, "post_id": 47190887, "comment_id": 81331601, "body": "I think this question <a href=\"https://stackoverflow.com/questions/2898316/using-a-member-function-pointer-within-a-class\" title=\"using a member function pointer within a class\">stackoverflow.com/questions/2898316/&hellip;</a> is about a similar idea. Maybe the answers will point you in the right direction."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 4979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31d1f783198d039f29c3f240e2706218?s=128&d=identicon&r=PG&f=1", "display_name": "Arc", "link": "https://stackoverflow.com/users/4979549/arc"}, "edited": false, "score": 1, "creation_date": 1510181907, "post_id": 47191104, "comment_id": 81331712, "body": "Thank you, this is exactly the behaviour I was looking for."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1510181680, "creation_date": 1510181680, "answer_id": 47191104, "question_id": 47190887, "link": "https://stackoverflow.com/questions/47190887/runtime-class-method-replacement-during-initialisation/47191104#47191104", "title": "Runtime class method replacement during initialisation", "body": "<blockquote>\n  <p>It seems like this kind of behaviour would be beneficial, and therefor I assume there's some way of achieving it.</p>\n</blockquote>\n\n<p>Yes, it is possible using a member function pointer.</p>\n\n<ol>\n<li><p>Declare a member variable that is a member function pointer.</p>\n\n<pre><code>  void (MyClass::*speaker)() const;\n</code></pre></li>\n<li><p>Initialize it appropriately in the constructor.</p>\n\n<pre><code>MyClass (const bool select)\n{\n   if (select)\n   {\n      speaker = &amp;MyClass::foo;\n   }\n   else\n   {\n      speaker = &amp;MyClass::bar;\n   }\n}\n</code></pre></li>\n<li><p>Use it in <code>speak</code>.</p>\n\n<pre><code>void speak() const\n{\n   (this-&gt;*speaker)();\n}\n</code></pre></li>\n</ol>\n\n<p>Read more about member function pointers at <a href=\"http://en.cppreference.com/w/cpp/language/pointer\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/pointer</a>.</p>\n\n<p>Here's <a href=\"https://ideone.com/MMtDEQ\" rel=\"nofollow noreferrer\">a working example</a>:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass MyClass\n{\n   public:\n\n      MyClass (const bool select)\n      {\n         if (select)\n         {\n            speaker = &amp;MyClass::foo;\n         }\n         else\n         {\n            speaker = &amp;MyClass::bar;\n         }\n      }\n\n      void speak() const\n      {\n         (this-&gt;*speaker)();\n      }\n\n      void (MyClass::*speaker)() const;\n\n   private:\n      void foo() const { std::cout &lt;&lt; \"Foo\\n\"; }\n      void bar() const { std::cout &lt;&lt; \"Bar\\n\"; }\n};\n\nint main()\n{\n   MyClass m1(true);\n   MyClass m2(false);\n\n   m1.speak();\n   m2.speak();\n}\n</code></pre>\n\n<p>and its output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Foo\nBar\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 4979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31d1f783198d039f29c3f240e2706218?s=128&d=identicon&r=PG&f=1", "display_name": "Arc", "link": "https://stackoverflow.com/users/4979549/arc"}, "edited": false, "score": 0, "creation_date": 1510187306, "post_id": 47191161, "comment_id": 81333320, "body": "The example was just an abstraction of the actual problem. The <code>foo()</code> and <code>bar()</code> classes do something much more complicated in reality. Whilst your suggestion would definitely work, it&#39;s probably not the most efficient method , as it requires checking the value of <code>mselect</code> at each call to <code>speak()</code>, and then potentially a resultant call to another method. The aim was to effectively replace the <code>speak()</code> method with the desired method."}], "tags": [], "owner": {"reputation": 106, "user_id": 1139455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d7ed41fda91883984016201e9cf956?s=128&d=identicon&r=PG", "display_name": "user1139455", "link": "https://stackoverflow.com/users/1139455/user1139455"}, "is_accepted": false, "score": 0, "last_activity_date": 1510181953, "creation_date": 1510181953, "answer_id": 47191161, "question_id": 47190887, "link": "https://stackoverflow.com/questions/47190887/runtime-class-method-replacement-during-initialisation/47191161#47191161", "title": "Runtime class method replacement during initialisation", "body": "<p>Is it not just a matter to storing the value passed to the constructor and using it in a conditional in speak()?</p>\n\n<pre><code>class MyClass\n{\n  private:\n    bool mselect;\n  public:\n    MyClass (const bool select)\n    {\n       mselect = select;\n    }\n\n    void speak()\n    {\n        if(mselect)\n            std::cout &lt;&lt; \"Foo\\n\";\n        else\n            std::cout &lt;&lt; \"Bar\\n\";\n    }\n</code></pre>\n\n<p>};</p>\n\n<p>Or am I missing some part of this problem?  Sorry, would post as comment but don't have reputation yet.</p>\n"}], "owner": {"reputation": 129, "user_id": 4979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31d1f783198d039f29c3f240e2706218?s=128&d=identicon&r=PG&f=1", "display_name": "Arc", "link": "https://stackoverflow.com/users/4979549/arc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 47191104, "answer_count": 2, "score": 2, "last_activity_date": 1510181953, "creation_date": 1510180568, "question_id": 47190887, "link": "https://stackoverflow.com/questions/47190887/runtime-class-method-replacement-during-initialisation", "title": "Runtime class method replacement during initialisation", "body": "<p>Say I have a class which contains a method <code>speak()</code> which will print something to the terminal. What exactly it will print out is determined by an initialisation boolean, if true, it will print \"Foo\", if false, it will print \"Bar\". The value of the boolean value is determined at runtime.</p>\n\n<p>One way to implement this would be to add an <code>if</code> statement in the <code>speak()</code> function which would then call either the <code>foo()</code> or <code>bar()</code> method. However, if this class method was called frequently, then the <code>if</code> switch and the additional function call could be avoided by instead replacing the <code>speak()</code> function by either the <code>foo()</code> or <code>bar()</code> function at class initialisation. Is there a way to achieve this functionality using, perhaps using function points? </p>\n\n<pre><code>class MyClass\n{\n  public:\n    MyClass (const bool select)\n    {\n        if (select)\n        {\n            // Make speak() use foo();\n        }\n        else\n        {\n            // Make speak() use bar();\n        }\n    }\n\n    speak() const;\n\n  private:\n    foo() const { std::cout &lt;&lt; \"Foo\\n\"; }\n    bar() const { std::cout &lt;&lt; \"Bar\\n\"; }\n}\n</code></pre>\n\n<p>It seems like this kind of behaviour would be beneficial, and therefor I assume there's some way of achieving it. However, I haven't had any luck in finding how to do this, mainly because I'm not sure exactly what to google.</p>\n\n<p>Thanks for your help and advice.</p>\n"}, {"tags": ["c++", "vector", "push-back"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1510180743, "post_id": 47190883, "comment_id": 81331243, "body": "Do note that you are pushing pointers to your stack that immediately become dangling pointers. So you are storing pointers that are meaningless"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 2, "creation_date": 1510180779, "post_id": 47190883, "comment_id": 81331257, "body": "You are pushing the address of a local variable that is destroyed after that. That\u2019s a useless address, dereferencing it is undefined behavior."}, {"owner": {"reputation": 43, "user_id": 7164287, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gVV2T-MDkpU/AAAAAAAAAAI/AAAAAAAAADU/iSAcgzFaEOQ/photo.jpg?sz=128", "display_name": "Caleb lee", "link": "https://stackoverflow.com/users/7164287/caleb-lee"}, "edited": false, "score": 0, "creation_date": 1510180890, "post_id": 47190883, "comment_id": 81331296, "body": "Well I need them to be pointers since I need my vector to be able to handle both types, since MorseCodeMessage is a child of the Message class and I&#39;m using both in the vector"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1510181091, "post_id": 47190883, "comment_id": 81331376, "body": "Than you need to allocate them on the free store. Read a good C++ book, you can\u2019t learn C++ by trial and error."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510181113, "post_id": 47190883, "comment_id": 81331387, "body": "@Caleblee Then you need them to be stored <i>somewhere</i> non-local. I recommend having your vector actually be a vector of <code>unique_ptr</code>, because there\u2019s very little reason to do memory management manually in modern C++."}, {"owner": {"reputation": 43, "user_id": 7164287, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gVV2T-MDkpU/AAAAAAAAAAI/AAAAAAAAADU/iSAcgzFaEOQ/photo.jpg?sz=128", "display_name": "Caleb lee", "link": "https://stackoverflow.com/users/7164287/caleb-lee"}, "edited": false, "score": 0, "creation_date": 1510181252, "post_id": 47190883, "comment_id": 81331443, "body": "Okay thanks, just a college student learning C++ so I&#39;m still new to everything in C++"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1510180880, "creation_date": 1510180880, "answer_id": 47190949, "question_id": 47190883, "link": "https://stackoverflow.com/questions/47190883/c-vector-elements-being-replaced-by-last-call-to-push-back/47190949#47190949", "title": "C++ Vector elements being replaced by last call to push_back", "body": "<p>You are pushing pointers to local variables, which very likely yields undefined behaviour; if the local object has not gone out of scope, you have a chance to repeatedly push the address of the same object (local variable). Note that the content of the local variable will change, and all previously pushed addresses still point to the same object. </p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1510181566, "last_edit_date": 1510181566, "creation_date": 1510181470, "answer_id": 47191063, "question_id": 47190883, "link": "https://stackoverflow.com/questions/47190883/c-vector-elements-being-replaced-by-last-call-to-push-back/47191063#47191063", "title": "C++ Vector elements being replaced by last call to push_back", "body": "<p>You are pushing pointers to local variables that go out of scope after each push.  Stack space gets reused over time, so you likely end up with multiple pointers that are pointing at the same stack memory, but the pointers in the vector are technically dangling and using them is undefined behavior.</p>\n\n<p>Since you clearly have polymorphic classes that derive from <code>Message</code>, you need to allocate them dynamically with <code>new</code> so they stay alive while stored in the vector:</p>\n\n<pre><code>if(mesType == 1) {\n    cin.ignore();\n    Message *mes1 = new Message;\n    stack1.push(mes1);\n} else if(mesType == 2) {\n    cin.ignore();\n    MorseCodeMessage *mes2 = new MorseCodeMessage;\n    stack1.push(mes2);\n}\n</code></pre>\n\n<p>Don't forget to define <code>Message</code> with a virtual destructor, and then call <code>delete</code> on each pointer when you are done using the vector, or when removing items from the vector.  Otherwise you will have memory leaks.</p>\n\n<p>In C++11 and later, a safer solution is to use <code>std::unique_ptr</code> instead of raw pointers:</p>\n\n<pre><code>std::vector&lt;std::unique_ptr&lt;Message&gt;&gt; messages;\n\nvoid MessageStack::push(std::unique_ptr&lt;Message&gt; ms1) {\n    messages.push_back(std::move(ms1));\n}\n\n...\n\nif(mesType == 1) {\n    cin.ignore();\n    stack1.push(std::unique_ptr&lt;Message&gt;(new Message));\n    // or, in C++14 and later:\n    //stack1.push(std::make_unique&lt;Message&gt;());\n} else if(mesType == 2) {\n    cin.ignore();\n    stack1.push(std::unique_ptr&lt;Message&gt;(new MorseCodeMessage));\n    // or, in C++14 and later:\n    //stack1.push(std::make_unique&lt;MorseCodeMessage&gt;());\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7164287, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gVV2T-MDkpU/AAAAAAAAAAI/AAAAAAAAADU/iSAcgzFaEOQ/photo.jpg?sz=128", "display_name": "Caleb lee", "link": "https://stackoverflow.com/users/7164287/caleb-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1510181566, "creation_date": 1510180551, "last_edit_date": 1510180768, "question_id": 47190883, "link": "https://stackoverflow.com/questions/47190883/c-vector-elements-being-replaced-by-last-call-to-push-back", "title": "C++ Vector elements being replaced by last call to push_back", "body": "<p>So I have this code in my main function</p>\n\n<pre><code>if(mesType == 1) {\n        cin.ignore();\n        Message mes1;\n        stack1.push(&amp;mes1);\n} else if(mesType == 2) {\n        cin.ignore();\n        MorseCodeMessage mes2;\n        stack1.push(&amp;mes2);\n}\n</code></pre>\n\n<p>and here is the function</p>\n\n<pre><code>void MessageStack::push(Message *ms1) {\n    messages.push_back(ms1);    \n}\n</code></pre>\n\n<p>where messages is </p>\n\n<pre><code>vector &lt;Message*&gt; messages;\n</code></pre>\n\n<p>Can you explain why all the elements in my messages vector are being replaced by whatever I push last?</p>\n"}, {"tags": ["c++", "qt", "opengl", "vtk"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1510182275, "post_id": 47190880, "comment_id": 81331848, "body": "Easy solution is to use a separate queue, and deliver your updates with it. Or if you only need the latest value, then have the GUI thread fetch the latest value when it is ready to do drawing."}, {"owner": {"reputation": 939, "user_id": 5983462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89ca467fe66ef6fddc2a34aa9b3283?s=128&d=identicon&r=PG&f=1", "display_name": "tomj", "link": "https://stackoverflow.com/users/5983462/tomj"}, "edited": false, "score": 0, "creation_date": 1510219338, "post_id": 47190880, "comment_id": 81344671, "body": "It&#39;s not clear what exactly is this buffer you are talking about. What kind of data are we talking about (point cloud --&gt; the buffer is a vertex buffer?)? Can you post at least the part of code that does the VTK processing of the data?"}, {"owner": {"reputation": 939, "user_id": 5983462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89ca467fe66ef6fddc2a34aa9b3283?s=128&d=identicon&r=PG&f=1", "display_name": "tomj", "link": "https://stackoverflow.com/users/5983462/tomj"}, "edited": false, "score": 0, "creation_date": 1510326407, "post_id": 47190880, "comment_id": 81401473, "body": "If the number and structure (the same hexahedron is made always of the same 8 points) of points does not change, just keep a reference to lPoints outside of OnDataReceived and update the positions only. If their numbers change between frames, but the shape of the hexahedron is the same, you can use glyph rendering (<a href=\"https://www.vtk.org/Wiki/VTK/Examples/Cxx/Filtering/Glyph3D\" rel=\"nofollow noreferrer\">vtk.org/Wiki/VTK/Examples/Cxx/Filtering/Glyph3D</a>). If you have different shapes and different numbers of points, I am afraid you will be force to rebuild the scene to some extent in each frame."}, {"owner": {"reputation": 185, "user_id": 4760384, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eaacb75a4e2226ab05a571ac0820e6f1?s=128&d=identicon&r=PG&f=1", "display_name": "PatrickB", "link": "https://stackoverflow.com/users/4760384/patrickb"}, "edited": false, "score": 0, "creation_date": 1510329762, "post_id": 47190880, "comment_id": 81403628, "body": "The points are always the same but their xyz coordinates are different. The hexahedrons can be bigger but the points will be the same. If I update the xyz points, the scene will update?"}, {"owner": {"reputation": 939, "user_id": 5983462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd89ca467fe66ef6fddc2a34aa9b3283?s=128&d=identicon&r=PG&f=1", "display_name": "tomj", "link": "https://stackoverflow.com/users/5983462/tomj"}, "edited": false, "score": 1, "creation_date": 1510331516, "post_id": 47190880, "comment_id": 81404745, "body": "Yes, it will update, just update the points&#39; position and afterwards call luGrid-&gt;Modified(); to let the mapper know that the input data changed (and to be sure you can call lMapper-&gt;Update() explicitly, although that should happen automatically somewhere down the line). This way you will have to do all the construction only once (the InsertNextPoint/Cell etc.)."}, {"owner": {"reputation": 185, "user_id": 4760384, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eaacb75a4e2226ab05a571ac0820e6f1?s=128&d=identicon&r=PG&f=1", "display_name": "PatrickB", "link": "https://stackoverflow.com/users/4760384/patrickb"}, "edited": false, "score": 0, "creation_date": 1510339296, "post_id": 47190880, "comment_id": 81408867, "body": "I test it and it&#39;s almost working. Is it normal that is slow for over 10000 moving objets? Is it normal that with OpenGL display  is about 10 times faster?"}], "owner": {"reputation": 185, "user_id": 4760384, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eaacb75a4e2226ab05a571ac0820e6f1?s=128&d=identicon&r=PG&f=1", "display_name": "PatrickB", "link": "https://stackoverflow.com/users/4760384/patrickb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510345691, "creation_date": 1510180542, "last_edit_date": 1510321330, "question_id": 47190880, "link": "https://stackoverflow.com/questions/47190880/qvtkwidget-vs-qopenglwidget", "title": "QVTKWidget vs QOpenGLWidget", "body": "<p>My VTK display is too slow and it's probably because I don't understand the way to use it effectively.</p>\n\n<p>I did also a display using OpenGL and is much faster but it's ugly.</p>\n\n<ul>\n<li><p>VTK display (using QVTKWidget):</p>\n\n<p>In the the communication thread, we connect to our sensor and everytime I get new data, I update a buffer and I call a function that draw the 3D result. One big problem, I receive data much faster than the rendering.</p></li>\n<li><p>OpenGL display (QOpenGLWidget):</p>\n\n<p>In the communication thread, we connect to the sensor and everytime I get new data, I update a buffer.\nIn the QT interface thread, the function paintGL() draw the scene with the current buffer values.</p></li>\n</ul>\n\n<p>In VTK using QVTKWidget, is it possible to do the same logic as my OpenGL display? Do have a function that will draw the scene using a buffer? Like the <code>paintGL()</code> function?</p>\n\n<p>Or does anyone can tell me the VTK logic to render a new scene 20 times every second for example?</p>\n\n<p>Example of my program:</p>\n\n<pre><code>OnDataReceived()\n{\n    vtkSmartPointer&lt;vtkRendererCollection&gt; lRC = mVTKWidget-&gt;GetRenderWindow()-&gt;GetRenderers();\n    lRC-&gt;InitTraversal();\n    vtkSmartPointer&lt;vtkRenderer&gt; lPointsRenderer = lRC-&gt;GetNextItem();\n\n    vtkSmartPointer&lt;vtkHexahedron&gt; lHex = vtkSmartPointer&lt;vtkHexahedron&gt;::New();\n    // Create a cell array to store the hex in\n    vtkSmartPointer&lt;vtkCellArray&gt; lHexs = vtkSmartPointer&lt;vtkCellArray&gt;::New();\n    for ( i = 0; i &lt; number_of_objects; ++i)\n    {\n        // Insert 8 points\n        lPoints-&gt;InsertNextPoint( ... );\n        lHex-&gt;GetPointIds()-&gt;SetId( ... );\n        lHexs-&gt;InsertNextCell( lHex );\n    }\n\n    vtkSmartPointer&lt;vtkUnstructuredGrid&gt; luGrid = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();\n    luGrid-&gt;SetPoints( lPoints );\n    luGrid-&gt;SetCells( VTK_HEXAHEDRON, lHexs );\n    luGrid-&gt;GetCellData()-&gt;SetScalars( lColors );\n\n    // Setup actor and mapper\n    vtkSmartPointer&lt;vtkDataSetMapper&gt; lMapper = vtkSmartPointer&lt;vtkDataSetMapper&gt;::New();\n    lMapper-&gt;SetInputData( luGrid );\n    lActor-&gt;SetMapper( lMapper );\n\n    lPointsRenderer-&gt;AddActor( lActor );\n    mVTKWidget-&gt;update();\n}\n</code></pre>\n\n<p>Is it possible to update the 8 points of each hexahedron instead of rebuilding the scene every time? I have more than 10 000 hexahedron to display updated 20 times per second..</p>\n"}, {"tags": ["c++", "cmake", "googletest", "gmock"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1510181602, "post_id": 47190818, "comment_id": 81331599, "body": "You are locating GTest library with <code>find_package</code> ... but are using <code>gmock</code> library. Also, having <code>cmake_minimum_required(VERSION 3.2)</code> means that only CMake 3.2+ can execute your <code>CMakeLists.txt</code>, so checking whether version is less than 2.8.12 is useless."}, {"owner": {"reputation": 129, "user_id": 7883081, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a87c5e904438330593243d6e23709a34?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan", "link": "https://stackoverflow.com/users/7883081/razvan"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1510182746, "post_id": 47190818, "comment_id": 81332005, "body": "I thought about including the if-else statement because that&#39;s how it is shown on the google mock tutorial in their git repository, so I just copied it over.  What do you mean by locating the GTest library with find_package but I&#39;m using mock? Dp you know what I should do?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 2, "creation_date": 1510213243, "post_id": 47190818, "comment_id": 81341393, "body": "If you follow <a href=\"https://github.com/google/googletest/tree/master/googlemock#building-google-mock\" rel=\"nofollow noreferrer\">that tutorial</a>, it talks about <a href=\"https://github.com/google/googletest/blob/master/googletest/README.md#incorporating-into-an-existing-cmake-project\" rel=\"nofollow noreferrer\">Incorporating Into An Existing CMake Project</a>, when you include GTest and GMock infrustructure with <code>add_subdirectory()</code>, not with <code>find_package()</code>. In that case &quot;if-else statement&quot; should come <b>after</b> corresponded <code>add_subdirectory</code> call, so <code>gmock_main</code> target will be defined at the point."}, {"owner": {"reputation": 129, "user_id": 7883081, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a87c5e904438330593243d6e23709a34?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan", "link": "https://stackoverflow.com/users/7883081/razvan"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1510228357, "post_id": 47190818, "comment_id": 81350661, "body": "I don&#39;t understand where should I use [add_subdirectory] instead of [find_package]. If I change the [find_package] line what should I change it to?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1510230086, "post_id": 47190818, "comment_id": 81351737, "body": "If you have googletest sources under directory <code>gtest</code> in your sources, use <code>add_subdirectory(gtest EXCLUDE_FROM_ALL)</code>. Otherwise take the code described in googletest manual <a href=\"https://github.com/google/googletest/blob/master/googletest/README.md#incorporating-into-an-existing-cmake-project\" rel=\"nofollow noreferrer\">Incorporating Into An Existing CMake Project</a>."}, {"owner": {"reputation": 129, "user_id": 7883081, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a87c5e904438330593243d6e23709a34?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan", "link": "https://stackoverflow.com/users/7883081/razvan"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1510789171, "post_id": 47190818, "comment_id": 81589501, "body": "Thanks for your help, however I am not sure if this is what I am looking for. I am trying to include gmock into the cmake build not gtest. Are you sure that this link is supposed to make it work?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1510817661, "post_id": 47190818, "comment_id": 81598553, "body": "GMock is part of GTest. <code>Are you sure that this link is supposed to make it work?</code> - It is documentation from the GTest/GMock developers. What about just trying?"}], "owner": {"reputation": 129, "user_id": 7883081, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a87c5e904438330593243d6e23709a34?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan", "link": "https://stackoverflow.com/users/7883081/razvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1679, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1607978447, "creation_date": 1510180261, "question_id": 47190818, "link": "https://stackoverflow.com/questions/47190818/setting-up-gmock-with-google-test", "title": "Setting up gmock with google test", "body": "<p>Could someone please help me compile the google test framework using google mock? Currently, I have this cmake file:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.2)\n\nif (CMAKE_VERSION VERSION_LESS 2.8.11)\n  include_directories(BEFORE SYSTEM\n    \"${gtest_SOURCE_DIR}/include\" \"${gmock_SOURCE_DIR}/include\")\nelse()\n  target_include_directories(gmock_main SYSTEM BEFORE INTERFACE\n    \"${gtest_SOURCE_DIR}/include\" \"${gmock_SOURCE_DIR}/include\")\nendif()\n\n\nset(CMAKE_CXX_STANDARD 11)\n\n# Locate GTest\nfind_package(GTest REQUIRED)\n\ninclude_directories(${GTEST_INCLUDE_DIRS})\n\n# Link runTests with what we want to test and the GTest and pthread library\nadd_executable(runTests tests.cpp)\ntarget_link_libraries(runTests gmock_main)\ntarget_link_libraries(runTests ${GTEST_LIBRARIES} pthread)\n</code></pre>\n\n<p>Currently I get this error: Cannot specify include directories for target \"gmock_main\" which is not  built by this project. </p>\n\n<p>I know this is because of line 7 above, but if I remove the whole if-else statement I get this error: fatal error: gmock/gmock.h: No such file or directory\ncompilation terminated.</p>\n\n<p>I would really appreciate if anyone could help me with this.</p>\n"}, {"tags": ["c++", "visual-studio-2010", "mfc", "visual-c++-6"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1510180290, "post_id": 47190790, "comment_id": 81331076, "body": "<i>&quot;...but does this load DLL2.dll and all its variables twice?&quot;</i> No"}, {"owner": {"reputation": 2250, "user_id": 1055869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01f751c696d7be333a6fccb0165c5d39?s=128&d=identicon&r=PG", "display_name": "Shabbir Hussain", "link": "https://stackoverflow.com/users/1055869/shabbir-hussain"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1510180711, "post_id": 47190790, "comment_id": 81331229, "body": "Is this the right way to do it?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1510249090, "post_id": 47190790, "comment_id": 81365550, "body": "The linker cannot possibly link against a DLL without an import library. It doesn&#39;t matter whether you are using a tool that&#39;s 2 decades old, or a recent one."}], "answers": [{"comments": [{"owner": {"reputation": 2250, "user_id": 1055869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01f751c696d7be333a6fccb0165c5d39?s=128&d=identicon&r=PG", "display_name": "Shabbir Hussain", "link": "https://stackoverflow.com/users/1055869/shabbir-hussain"}, "edited": false, "score": 0, "creation_date": 1510238539, "post_id": 47191309, "comment_id": 81357888, "body": "I was calling DLL2.dll from my app.exe in the vc6 project. I think the there is an implicit setting that links the DLL at compile-time. I&#39;m new to VC6."}, {"owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "reply_to_user": {"reputation": 2250, "user_id": 1055869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01f751c696d7be333a6fccb0165c5d39?s=128&d=identicon&r=PG", "display_name": "Shabbir Hussain", "link": "https://stackoverflow.com/users/1055869/shabbir-hussain"}, "edited": false, "score": 0, "creation_date": 1510249260, "post_id": 47191309, "comment_id": 81365650, "body": "Yes, the <b>import library</b> (not the DLL, this is loaded/linked dynamically at run-time), must have been somehow included into the project (maybe through that <code>#pragma</code> in an include file?), otherwise you would be getting link errors, this is what I meant."}], "tags": [], "owner": {"reputation": 1499, "user_id": 1372577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4819b4e5fd753e26319b41b632182e0?s=128&d=identicon&r=PG", "display_name": "Constantine Georgiou", "link": "https://stackoverflow.com/users/1372577/constantine-georgiou"}, "is_accepted": true, "score": 2, "last_activity_date": 1510182724, "creation_date": 1510182724, "answer_id": 47191309, "question_id": 47190790, "link": "https://stackoverflow.com/questions/47190790/how-to-link-to-a-function-from-a-dll-loaded-by-a-dll/47191309#47191309", "title": "How to Link to a function from a DLL loaded by a DLL?", "body": "<p>A DLL is only loaded once in an application's address-space. This is by Windows design. An import-library for a dll loads the dll (<code>LoadLibrary()</code>) and assigns local function names to the dll functions. You could do the same yourself by calling <code>LoadLibrary()</code> and <code>GetProcAddress()</code>.</p>\n\n<p>According to the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684175(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><strong>Documentation</strong></a><strong>:</strong> </p>\n\n<p><em>The system maintains a per-process reference count on all loaded modules. Calling LoadLibrary increments the reference count. Calling the FreeLibrary or FreeLibraryAndExitThread function decrements the reference count. The system unloads a module when its reference count reaches zero or when the process terminates (regardless of the reference count).</em></p>\n\n<p>So no, a DLL is only loaded once, only its \"UseCount\" is set to 2.</p>\n\n<blockquote>\n  <p>I've set this up properly in my vc6 workspace without having to specify the lib file for DLL2.dll</p>\n</blockquote>\n\n<p>I guess you weren't calling <code>DLL2::setvariable( value )</code> from <code>app.exe</code> then, otherwise how did you do it?</p>\n\n<blockquote>\n  <p>Is this the right way to do it?</p>\n</blockquote>\n\n<p>This is one way to do it (though you could simply include the <code>lib</code> into the project - as most developers do - instead of using the <code>#pragma</code>, but the rseult is the same). The other alternative is call <code>LoadLibrary()</code>/<code>GetProcAddress()</code> yourself (useful if you want to conditionally load the dll). There's no other way i'm aware of.</p>\n"}], "owner": {"reputation": 2250, "user_id": 1055869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01f751c696d7be333a6fccb0165c5d39?s=128&d=identicon&r=PG", "display_name": "Shabbir Hussain", "link": "https://stackoverflow.com/users/1055869/shabbir-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 47191309, "answer_count": 1, "score": 0, "last_activity_date": 1510182724, "creation_date": 1510180135, "question_id": 47190790, "link": "https://stackoverflow.com/questions/47190790/how-to-link-to-a-function-from-a-dll-loaded-by-a-dll", "title": "How to Link to a function from a DLL loaded by a DLL?", "body": "<p>I'm using VS2010 and I have a layered application that looks like this:</p>\n\n<pre><code>app.exe\nDLL1.dll\nDLL2.dll\n</code></pre>\n\n<p>where app.exe loads DLL1 and it then loads DLL2. I want my app to call a function in DLL2 like so <code>DLL2::setvariable( value )</code>. </p>\n\n<p>I've set this up properly in my vc6 workspace without having to specify the lib file for <code>DLL2.dll</code>. How can I set this up in my VS2010 environment? I keep getting an unresolved symbol linker error for all the calls to <code>DLL2.dll</code>.</p>\n\n<p>I've tried to include \n<code>#pragma comment(lib ,\"DLL2.lib\")</code> \nin both <code>app.exe</code> and <code>DLL1.dll</code> and it links but does this load <code>DLL2.dll</code> and all its variables twice?</p>\n"}, {"tags": ["c++", "performance", "multidimensional-array"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1510180818, "post_id": 47190767, "comment_id": 81331275, "body": "You may be able to sum up the columns straight from the source into a 1D array of column sums, compute the means from the column sums, make a local array, assign into the local array directly from the source-column mean."}, {"owner": {"reputation": 2121, "user_id": 6676101, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/GdQJN.jpg?s=128&g=1", "display_name": "Toothpick Anemone", "link": "https://stackoverflow.com/users/6676101/toothpick-anemone"}, "edited": false, "score": 0, "creation_date": 1510182652, "post_id": 47190767, "comment_id": 81331969, "body": "It would help readability if you broke your function into smaller subfunctions. For example, the code which finds the mean of each column should really be its own function."}, {"owner": {"reputation": 1196, "user_id": 5468596, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oYsoZ.png?s=128&g=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/5468596/stephen"}, "edited": false, "score": 0, "creation_date": 1510183081, "post_id": 47190767, "comment_id": 81332120, "body": "You could create a 1D array of size <code>i * j</code> and mask it to function as a 2D array with a class implementation."}, {"owner": {"reputation": 2121, "user_id": 6676101, "user_type": "registered", "accept_rate": 11, "profile_image": "https://i.stack.imgur.com/GdQJN.jpg?s=128&g=1", "display_name": "Toothpick Anemone", "link": "https://stackoverflow.com/users/6676101/toothpick-anemone"}, "edited": false, "score": 0, "creation_date": 1510183092, "post_id": 47190767, "comment_id": 81332123, "body": "For the code which finds the mean of each column, instead of having a lot of inline code, you could just make a single function call <code>findColumnMeans(colMeans, numUsedVariables, input, NUMINDIVS)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 424, "user_id": 5293624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bacf8cd0c5c7a2277363ea6f84c82a8?s=128&d=identicon&r=PG&f=1", "display_name": "kjpus", "link": "https://stackoverflow.com/users/5293624/kjpus"}, "is_accepted": false, "score": 1, "last_activity_date": 1510205412, "creation_date": 1510205412, "answer_id": 47194516, "question_id": 47190767, "link": "https://stackoverflow.com/questions/47190767/c-copy-parts-of-2d-array-to-another-2d-array-performance/47194516#47194516", "title": "C++ copy parts of 2D array to another 2D array, performance", "body": "<p>Your code slows because the 2D arrays are accessed in a column-first order. Every time the CPU gets a number from main memory, a whole bunch of numbers are fetched into the cache. Remember, C/C++ stores array row-first, if the next number you need is on the next row, all the cached data is useless. CPU has to go back to main memory to fetch the next number. Going to main memory is a very slow process compared to access data already in the cache. <br>\nTo make your code run faster, you need to think how to re-organize your data so that they are accessed in the most cache friendly way. This code <br>\n<code>for(i=0; i&lt;numUsedVariables; i++)\n    for(j=0; j&lt;NUMINDIVS; j++)\n        centeredInput[j][i] = input[j][i]   - colMeans[i];\n</code>\nwill run much slower than<br>\n<code>for(j=0; j&lt;NUMINDIVS; j++)\n    for(i=0; i&lt;numUsedVariables; i++)\n        centeredInput[j][i] = input[j][i]   - colMeans[i];\n</code></p>\n"}], "owner": {"reputation": 33, "user_id": 5364565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae17f5310756dad38a0fb5dd5b0c4a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe O&#39;Neill", "link": "https://stackoverflow.com/users/5364565/joe-oneill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510205412, "creation_date": 1510179995, "question_id": 47190767, "link": "https://stackoverflow.com/questions/47190767/c-copy-parts-of-2d-array-to-another-2d-array-performance", "title": "C++ copy parts of 2D array to another 2D array, performance", "body": "<p>In my program, I have a function that is called thousands of times.  The function has one argument, an array of bool values with length=30000. Based on this array of bools, I copy some of the rows from a global, 2d array variable to build a local 2d array.  I then find the mean of each column in the local 2d array.  I then take every value in the local 2d array and subtract it's column mean, in order to build a second local 2D array.  </p>\n\n<p>The program is executing as intended, but it is taking much too long since I added the function in question.  Is there a faster way to take a subset of data from a 2d array and make a new 2d array?  Is there a faster way to subtract the column mean from every value in a 2d array?  Perhaps I should look into vectors or declaring things outside the function...</p>\n\n<p>Thank you.</p>\n\n<pre><code>double FitValue(bool *X){\n    int i,j,k; //loop index\n    int counter;\n    int numUsedVariables = 0; //\n    double sum;\n    //find number of selected variables\n    for(i=0; i&lt;NUMVARIABLES; i++){ //NUMVARIABLES is a globally defined variable\n        if(X[i] == true){\n            numUsedVariables += 1;\n        }\n    }   \n    //declare matrix for variable subset    \n    alglib::real_2d_array input;\n    input.setlength(NUMINDIVS,numUsedVariables); \n    //populate matrix for variable subset\n    counter = -1;\n    for(i=0; i&lt;NUMVARIABLES; i++){ //NUMVARIABLES is a globally defined variable\n        if(X[i] == true){       \n            counter++;\n            for(j=0; j&lt;NUMINDIVS; j++){ //NUMINDIVS is a globally defined variable      \n                input[j][counter] = genotype[i][j]; //genotype is global variable\n            }   \n        }\n    }\n    //find the mean of each column\n    alglib::real_1d_array colMeans;\n    colMeans.setlength(numUsedVariables);\n    for(i=0; i&lt;numUsedVariables; i++){\n        sum = 0;\n        for(j=0; j&lt;NUMINDIVS; j++){\n            sum += input[j][i];     \n        }   \n        colMeans[i] = sum/NUMINDIVS;\n    }   \n    //declare centered selected markers matrix\n    alglib::real_2d_array centeredInput;\n    centeredInput.setlength(NUMINDIVS,numUsedVariables);    \n    for(i=0; i&lt;numUsedVariables; i++){   \n        for(j=0; j&lt;NUMINDIVS; j++){\n            centeredInput[j][i] = input[j][i]   - colMeans[i];\n        }\n    }\n    //perform further analysis ...\n    //...\n\n}   \n</code></pre>\n"}, {"tags": ["c++", "mpi"], "answers": [{"tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": false, "score": 0, "last_activity_date": 1510191652, "creation_date": 1510191652, "answer_id": 47192535, "question_id": 47190698, "link": "https://stackoverflow.com/questions/47190698/trouble-with-mpi-allgatherv-function/47192535#47192535", "title": "Trouble with MPI Allgatherv function", "body": "<p>You are not using <code>MPI_Allgatherv()</code> correctly.</p>\n\n<blockquote>\n  <p>I had an idea to use Allgatherv which should distribute my original\n  buffer to all other processes.</p>\n</blockquote>\n\n<p>The description suggests you need <code>MPI_Scatter[v]()</code> in order to slice your array from a given rank, and distributes the chunks to all the MPI tasks.\nIf all tasks should receive the full array, then <code>MPI_Bcast()</code> is what you need.</p>\n\n<p>Anyway, let's assume you need an all gather.</p>\n\n<p>First, you must ensure all tasks have the same <code>particles</code> value.</p>\n\n<p>Second, since you gather the same amout of data from every MPI tasks, and store them in a contiguous location, you can simplify your code with <code>MPI_Allgather()</code>. If only the last task might have a bit less data, then you can use <code>MPI_Allgatherv()</code> (but this is not what your code is currently doing) or transmit some ghost data so you can use the simple (and probably more optimized) <code>MPI_Allgather()</code>.</p>\n\n<p>Last but not least, you should send <code>elements_per_process</code> elements (and not <code>particle_amount</code>). That should be enough to get rid of the crash (e.g. <code>MPI_ERR_TRUNCATE</code>). But that being said, i am not sure that will achieve the result you need or expect.</p>\n"}], "owner": {"reputation": 117, "user_id": 7053817, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c336b6672599208657cbfd5fb9f3a6a3?s=128&d=identicon&r=PG&f=1", "display_name": "elec", "link": "https://stackoverflow.com/users/7053817/elec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1510191652, "creation_date": 1510179636, "last_edit_date": 1510181042, "question_id": 47190698, "link": "https://stackoverflow.com/questions/47190698/trouble-with-mpi-allgatherv-function", "title": "Trouble with MPI Allgatherv function", "body": "<p>I have been struggling to try to parallel this function which calculates interactions between particles. I had an idea to use Allgatherv which should distribute my original buffer to all other processes. Then using \"rank\" make a loop in which each process will calculate its part.In this program, MPI is overwritten to show stats that's why I am calling it mpi->function. Unfortunately, when I run it I receive following error. Can somebody advice what is wrong?</p>\n\n<p><img src=\"https://i.stack.imgur.com/Ku3wZ.png\" alt=\"Error\"></p>\n\n<pre><code>void calcInteraction() {\n    totalInteraction = 0.0;\n    int procs_number;\n    int rank;\n    int particle_amount = particles;\n\n    mpi-&gt;MPI_Comm_size(MPI_COMM_WORLD,&amp;procs_number);\n    mpi-&gt;MPI_Comm_rank(MPI_COMM_WORLD,&amp;rank);\n    //long sendBuffer[particle_amount];\n    //int *displs[procs_number];\n    //long send_counts[procs_number+mod];\n    int mod = (particle_amount%procs_number);\n    int elements_per_process = particle_amount/procs_number;\n    int *send_buffer = new int[particle_amount]; //data to send\n    int *displs = new int[procs_number]; //displacement\n    int *send_counts = new int[procs_number];\n\n    if(rank == 0)\n    {\n        for(int i = 0; i &lt; particle_amount; i++)\n        {\n            send_buffer[i] = i; // filling buffer with particles\n        }\n    }\n    for (int i = 0; i &lt; procs_number;i++)\n    {\n        send_counts[i] = elements_per_process; // filling buffer since it can't be empty\n    }\n\n    // calculating displacement\n    displs[ 0 ] = 0;\n    for ( int i = 1; i &lt; procs_number; i++ )\n        displs[ i ] = displs[ i - 1 ] + send_counts[ i - 1 ];\n    int allData = displs[ procs_number - 1 ] + send_counts[ procs_number - 1 ];\n\n    int * endBuffer = new int[allData];\n\n    int start,end; // initializing indices\n\n    cout&lt;&lt;\"entering allgather\"&lt;&lt;endl;\n    mpi-&gt;MPI_Allgatherv(send_buffer,particle_amount,MPI_INT,endBuffer,send_counts,displs,MPI_INT,MPI_COMM_WORLD);\n    //                   ^from      ^how many        ^send   ^receive  ^how many  ^displ ^send    ^communicator\n    //                               to  send         type    buffer    receive           type\n    start = rank*elements_per_process;\n    cout&lt;&lt;\"start = \"&lt;&lt; start &lt;&lt;endl;\n    if(rank == procs_number) //in case that particle_amount is not even\n    {\n        end = (rank+1)*elements_per_process + mod;\n    }\n    else\n    {\n        end = (rank+1)*elements_per_process;\n    }\n\n    cout&lt;&lt;\"end = \"&lt;&lt; end &lt;&lt;endl;\n    cout &lt;&lt; \"calcInteraction\" &lt;&lt; endl;\n\n        for (long idx = start; idx &lt; end; idx++) {\n            for (long idxB = start; idxB &lt; end; idxB++) {\n                if (idx != idxB) {\n                    totalInteraction += physics-&gt;interaction(x[idx], y[idx], z[idx], age[idx], x[idxB], y[idxB],\n                                                             z[idxB], age[idxB]);\n                }\n            }\n        }\n\n\n\n    cout &lt;&lt; \"calcInteraction - done\" &lt;&lt; endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "move-semantics"], "comments": [{"owner": {"reputation": 314, "user_id": 8576366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PTEwi.jpg?s=128&g=1", "display_name": "Pablo Oliva", "link": "https://stackoverflow.com/users/8576366/pablo-oliva"}, "edited": false, "score": 1, "creation_date": 1510180079, "post_id": 47190645, "comment_id": 81330965, "body": "Usually, when you have code that won&#39;t compile, it&#39;s a good practice to add the compilation error to the post. Bonus points if you try with different compilers (say, gcc and clang) and post both errors."}], "answers": [{"tags": [], "owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "is_accepted": true, "score": 1, "last_activity_date": 1510180126, "creation_date": 1510180126, "answer_id": 47190787, "question_id": 47190645, "link": "https://stackoverflow.com/questions/47190645/move-initialize-a-priority-queue-from-a-vector/47190787#47190787", "title": "Move-initialize a priority_queue from a vector?", "body": "<p>Did you mean</p>\n\n<pre><code>priority_queue&lt;ListNode*, vector&lt;ListNode*&gt;, cmp&gt; pq{ cmp{}, std::move(lists) };\n</code></pre>\n\n<p>?</p>\n\n<p>Your code fails because by default the comparer is <code>std::less&lt;typename Container::value_type&gt;</code> (so you have to explicitely write <code>cmp</code> in template args) and because the argument has to be an instance of <code>cmp</code> (not the class, actually classes are not first-class citizens in C++, you can't pass them as arguments).</p>\n"}], "owner": {"reputation": 267, "user_id": 2105525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2AGIx.png?s=128&g=1", "display_name": "Akababa", "link": "https://stackoverflow.com/users/2105525/akababa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 47190787, "answer_count": 1, "score": 0, "last_activity_date": 1510180317, "creation_date": 1510179382, "last_edit_date": 1510180182, "question_id": 47190645, "link": "https://stackoverflow.com/questions/47190645/move-initialize-a-priority-queue-from-a-vector", "title": "Move-initialize a priority_queue from a vector?", "body": "<p>I saw this <a href=\"https://leetcode.com/problems/merge-k-sorted-lists/description/\" rel=\"nofollow noreferrer\">leetcode question</a> and wanted to solve it with a priority queue instead of a vector (thus O(nlogk) instead of O(nk)). How do I move-initialize the priority_queue with the given vector as the underlying container? This is what I tried but I clearly misunderstood the <a href=\"http://en.cppreference.com/w/cpp/container/priority_queue/priority_queue\" rel=\"nofollow noreferrer\">docs</a> because it won't compile.</p>\n\n<pre><code>struct ListNode {\n    int val;\n    ListNode *next;\n    ListNode(int x) : val(x), next(NULL) {}\n};\n\nclass cmp{\n    public:\n    bool operator()(const ListNode *a,const ListNode *b) const {\n        if(b==nullptr) return false;\n        return a==nullptr || a-&gt;val&gt;b-&gt;val;\n    }\n};\nclass Solution {\n    ListNode* helper(auto&amp; lists) {\n        ListNode *ans=lists.top();lists.pop();\n        if(ans==nullptr) return nullptr;\n        lists.push(ans-&gt;next);\n        ans-&gt;next=helper(lists);\n        return ans;\n    }\npublic:\n    ListNode* mergeKLists(vector&lt;ListNode*&gt;&amp; lists) {\n        if(lists.empty()) return nullptr;\n        priority_queue&lt;ListNode*,vector&lt;ListNode*&gt;&gt; pq(cmp,std::move(lists)); //compiler says error: 'std::move' is not a type\n        return helper(pq);\n    }\n};\n</code></pre>\n"}, {"tags": ["javascript", "c++", "pac"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9031345, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/cc0c7faae549a8f36124fa16ddb55c22?s=128&d=identicon&r=PG", "display_name": "pochi", "link": "https://stackoverflow.com/users/9031345/pochi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512022006, "creation_date": 1512022006, "answer_id": 47566874, "question_id": 47190609, "link": "https://stackoverflow.com/questions/47190609/c-tiny-js-execute-javascript-function-from-external-file/47566874#47566874", "title": "c++ tiny-js execute javascript function from external file", "body": "<p>I made application server using TinyJS.\nsee this.\n<a href=\"https://github.com/pochi0701/wizdlive\" rel=\"nofollow noreferrer\">https://github.com/pochi0701/wizdlive</a></p>\n"}], "owner": {"reputation": 703, "user_id": 7114793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2b17f579d15da5cedb9b57581fe9651?s=128&d=identicon&r=PG&f=1", "display_name": "TVA van Hesteren", "link": "https://stackoverflow.com/users/7114793/tva-van-hesteren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512022006, "creation_date": 1510179243, "question_id": 47190609, "link": "https://stackoverflow.com/questions/47190609/c-tiny-js-execute-javascript-function-from-external-file", "title": "c++ tiny-js execute javascript function from external file", "body": "<p>I have a C++ application which has to execute a Javascript-function from a dynamic file. (I need to read a proxy.pac file).</p>\n\n<p>E.g. I have a C++ application running which reads the following file: proxy.pac (which contains the javascript function <code>FindProxyForURL(url, host)</code>, which I have to call with the two parameters.</p>\n\n<p>However, I have no idea how to start off and I can't find anything on the internet so far.</p>\n\n<p><strong><em>So basically my question is: how doe I load dynamic Javascript from a file and execute a function within that code(/file)</em></strong></p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 8, "creation_date": 1510179198, "post_id": 47190588, "comment_id": 81330584, "body": "<code>strlen</code> has no side effects.  If you&#39;re seeing it cause this kind of issue, it implies you&#39;re invoking <b>undefined behaviour</b> elsewhere in your code.  Can you construct a <a href=\"https://stackoverflow.com/help/mcve\">minimal test-case</a>?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1510179326, "post_id": 47190588, "comment_id": 81330638, "body": "is it possible one of those strings isn&#39;t null-terminated?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1510179388, "post_id": 47190588, "comment_id": 81330665, "body": "even if it was, it would crash right away, and wouldn&#39;t have a &quot;delayed effect&quot; like with undefined writes. your program bug is not because of strlen."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510179714, "post_id": 47190588, "comment_id": 81330803, "body": "&quot;strlen is actually printing correct results&quot;  --&gt; yet the post lacks even that output of <code>printf()</code>.  Hmmm."}, {"owner": {"reputation": 47, "user_id": 8909928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622995087760985/picture?type=large", "display_name": "Martin Re\u0161ovsk&#253;", "link": "https://stackoverflow.com/users/8909928/martin-re%c5%a1ovsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1510180181, "post_id": 47190588, "comment_id": 81331029, "body": "Basically, in very minimal way, this is something Im doing:   char message_out[1024];  bzero(message_out, 1024); char objectNameValue[1024]; strcpy(objectNameValue,&quot;cn=&quot;); char PA_type_value[5] = {&#39;u&#39;, &#39;i&#39;, &#39;d&#39;}; strcat(Message_out, objectNameValue); strcat(Message_out, PA_type_value); But sometimes Im not putting the fixed characters into string, but another string f.e. and I need to find out how big that string is, because I need to count total lengths of the message_out. I always watch out for strings, to be big enough, to be inicialized with zeroes."}, {"owner": {"reputation": 47, "user_id": 8909928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622995087760985/picture?type=large", "display_name": "Martin Re\u0161ovsk&#253;", "link": "https://stackoverflow.com/users/8909928/martin-re%c5%a1ovsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1510180334, "post_id": 47190588, "comment_id": 81331091, "body": "It lacks output, because I thougth that you can believe me in this :D It really prints correct results."}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1510180389, "post_id": 47190588, "comment_id": 81331111, "body": "Please edit your question adding the relevant code instead of writing it in the comments section. Add the output too."}, {"owner": {"reputation": 47, "user_id": 8909928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622995087760985/picture?type=large", "display_name": "Martin Re\u0161ovsk&#253;", "link": "https://stackoverflow.com/users/8909928/martin-re%c5%a1ovsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1510180477, "post_id": 47190588, "comment_id": 81331144, "body": "When Im unvoking undefined behaviour elsewhere, why it is always okay and it pops up only when strlen is used?"}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1510180637, "post_id": 47190588, "comment_id": 81331202, "body": "<a href=\"https://en.wikipedia.org/wiki/Heisenbug\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Heisenbug</a>"}, {"owner": {"reputation": 47, "user_id": 8909928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622995087760985/picture?type=large", "display_name": "Martin Re\u0161ovsk&#253;", "link": "https://stackoverflow.com/users/8909928/martin-re%c5%a1ovsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1510181193, "post_id": 47190588, "comment_id": 81331419, "body": "Never knew, this is actually a thing. But can I ask you, whats the best way to solve such a problem? How to locate it?"}, {"owner": {"reputation": 47, "user_id": 8909928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622995087760985/picture?type=large", "display_name": "Martin Re\u0161ovsk&#253;", "link": "https://stackoverflow.com/users/8909928/martin-re%c5%a1ovsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1510181524, "post_id": 47190588, "comment_id": 81331569, "body": "as long as I know, char PA_type_value[5] = {&#39;u&#39;, &#39;i&#39;, &#39;d&#39;} will fill fourth and fifth byte with /0."}, {"owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 1, "creation_date": 1510183244, "post_id": 47190588, "comment_id": 81332184, "body": "@martin, that&#39;s not correct. <code>PA_type_value[5] = {&#39;u&#39;, &#39;i&#39;, &#39;d&#39;}</code> leaves the fourth and fifth byte strictly alone.  Change your code to <code>PA_type_value[5] = {&#39;u&#39;, &#39;i&#39;, &#39;d&#39;,&#39;\\0&#39;}</code> and I bet it works."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1510183273, "post_id": 47190588, "comment_id": 81332201, "body": "Adding and removing <code>strlen</code> changes the machine code which compiler produces.. If code has undefined behavior elsewhere, then the behavior can be, and often is, different for these different compiler outputs. For example, use of stack will be different, and contents of stack often affect what undefined behavior does."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "edited": false, "score": 3, "creation_date": 1510183332, "post_id": 47190588, "comment_id": 81332225, "body": "@Charlie Martin: That&#39;s false. <code>char PA_type_value[5] = {&#39;u&#39;, &#39;i&#39;, &#39;d&#39;}</code> is absolutely guaranteed to set the remaining array elements to zero. This is one of the cornerstones of C and C++ aggregate initialization philosophy: all-or-nothing."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510183719, "post_id": 47190588, "comment_id": 81332343, "body": "There just isn\u2019t enough data here to answer. If you can create a minimal <i>complete</i> program which still fails, then we can help; otherwise, we can only offer general tips like \u201cuse a debugger\u201d and \u201crun it through Valgrind\u201d."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1510189226, "post_id": 47190588, "comment_id": 81333832, "body": "<code>strcpy(objectNameValue,&quot;cn=&quot;);</code> ... <code>Length of objectNameValue: 12</code> ??? I&#39;m uncertain how a string of length 3 is &quot;correct&quot; when the length printed is 12. Please match the output you provide to the sample input/code you provide. As Daniel H. said, a minimal program demonstrating the issue would be helpful. See this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1510218775, "post_id": 47190588, "comment_id": 81344341, "body": "Do you have multiple threads in this app? If not - the reason is missing 0 at the end of string."}], "answers": [{"comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1510180460, "post_id": 47190628, "comment_id": 81331136, "body": "While the C standard does claim that calling a string function on an unterminated string can cause critical undefined behavior, I&#39;m having trouble imagining a <code>strlen()</code> implementation that would perform a write\u2026"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1510230956, "post_id": 47190628, "comment_id": 81352343, "body": "@duskwuff - <code>strlen()</code> is unlikely to specifically do a write.   However, if there is no terminating zero, it is possible that it attempts to access the value at a non-existent location in memory (in which case, the memory management unit - implemented as circuitry in quite a few modern CPUs - may generate illegal access errors)."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1510249611, "post_id": 47190628, "comment_id": 81365876, "body": "@Peter Right -- but that&#39;d simply cause a crash, not the unexpected behavior described by the OP."}], "tags": [], "owner": {"reputation": 879, "user_id": 372128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rAwcJ.jpg?s=128&g=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/372128/valentin"}, "is_accepted": false, "score": 1, "last_activity_date": 1510179306, "creation_date": 1510179306, "answer_id": 47190628, "question_id": 47190588, "link": "https://stackoverflow.com/questions/47190588/does-strlen-have-any-side-effect/47190628#47190628", "title": "Does strlen have any side effect?", "body": "<p>The problem could be with how <code>strlen</code> finds the length. <code>strlen</code> iterates through all characters of an array of characters until it finds a terminal \\0 character. If the array does not have this terminal character, the implementation could proceed out of the memory bounds of the array of characters you gave it and cause undefined behavior.</p>\n"}], "owner": {"reputation": 47, "user_id": 8909928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1622995087760985/picture?type=large", "display_name": "Martin Re\u0161ovsk&#253;", "link": "https://stackoverflow.com/users/8909928/martin-re%c5%a1ovsk%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510218553, "creation_date": 1510179146, "last_edit_date": 1510182935, "question_id": 47190588, "link": "https://stackoverflow.com/questions/47190588/does-strlen-have-any-side-effect", "title": "Does strlen have any side effect?", "body": "<p>I know, or better I suppose, that strlen() is fairly simple function, but for some reason, when I want to use it in one my function, it will corrupt the program. I have no idea why it's happening, because the results from strlen are correct, but the program as a whole doesn't work if strlen is included. To be specific, this part of code is causing trouble:</p>\n\n<pre><code>int random1 = strlen(objectNameValue);\nint random2 = strlen(PA_type_value);\nint random3 = strlen(attributeValue);\nprintf(\"length of objectNameValue: %d, PA_type_value: %d, attributeValue: %d\", random1, random2, random3);\n</code></pre>\n\n<p>My program is actually a simple LDAP server and I'm trying to send some data - those variables (attributeValue), for example, when I put this part of code to comments, it works perfectly. But if I leave it there, sent data are not correct, and I have really no idea how strlen can affect them. Funny is that strlen is actually printing correct results.</p>\n\n<p>To specify a bit more, those three variables in strlen are all of type char[] and all have /0 at the end. Can anyone help?</p>\n\n<p>So, after request in comments, here is a closer look:\nBasically, in very minimal way, this is something I'm doing:</p>\n\n<pre><code>char message_out[1024];\nbzero(message_out, 1024);\nchar objectNameValue[1024];\nstrcpy(objectNameValue,\"cn=\");\nchar PA_type_value[5] = {'u', 'i', 'd'};\nstrcat(Message_out, objectNameValue);\nstrcat(Message_out, PA_type_value);\n</code></pre>\n\n<p>But sometimes I'm not putting the fixed characters into string, but another string for example., and I need to find out how big that string is, because I need to count total lengths of the message_out. I always watch out for strings, to be big enough, to be initialized with zeroes.</p>\n\n<p>Output is this:</p>\n\n<p>Length of objectNameValue: 12, PA_type_value: 3, attributeValue: 8</p>\n"}, {"tags": ["c++", "syntax", "expression", "language-lawyer", "variable-declaration"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1510179105, "post_id": 47190568, "comment_id": 81330530, "body": "Well, I guess it shouldn&#39;t."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510179123, "post_id": 47190568, "comment_id": 81330541, "body": "You always have interesting questions."}, {"owner": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 1, "creation_date": 1510179157, "post_id": 47190568, "comment_id": 81330564, "body": "Looks correct. But what is the point?"}, {"owner": {"reputation": 1196, "user_id": 5468596, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oYsoZ.png?s=128&g=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/5468596/stephen"}, "edited": false, "score": 0, "creation_date": 1510179214, "post_id": 47190568, "comment_id": 81330593, "body": "Wouldn&#39;t this error because it has no entry point defined?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1510179236, "post_id": 47190568, "comment_id": 81330606, "body": "I see no reason why this shouldn&#39;t compile. What error does gcc produce? Edit : It appears to complain that local <code>x</code> shadows the argument <code>x</code>. As far as I know, while this is a bad idea, it&#39;s allowed."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1510179348, "post_id": 47190568, "comment_id": 81330648, "body": "@Fran&#231;oisAndrieux This looks a lot like a declaration of <code>int x, &lt;other declarations&gt;</code>. And you are allowed extraneous parentheses in declarations"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 1196, "user_id": 5468596, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oYsoZ.png?s=128&g=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/5468596/stephen"}, "edited": false, "score": 2, "creation_date": 1510179446, "post_id": 47190568, "comment_id": 81330688, "body": "@Stephen Having a <code>void f() { ... }</code> has no problem compiling. If there&#39;s no main function anywhere, that will be a <i>linker</i> error. But compiling code that doesn&#39;t contain a main function is actually the common case"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1510179456, "post_id": 47190568, "comment_id": 81330693, "body": "Similar to <a href=\"https://stackoverflow.com/q/28283215/1708801\">g++ rejects, clang++ accepts: foo(x)(\u201cbar\u201d)(\u201cbaz\u201d);</a> ... this looks like it should be addressed by <code>Ambiguity resolution </code> section"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1510179545, "post_id": 47190568, "comment_id": 81330722, "body": "@Fran&#231;oisAndrieux: that&#39;s the point. Is that line a declaration, or an expression? Because I think clang compiles this, because it handles it as an expression."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1510179607, "post_id": 47190568, "comment_id": 81330753, "body": "Yeah it can also be seen as an expression: <code>int(x), 1</code> which is effectively <code>((int) x), 1</code>"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510179773, "post_id": 47190568, "comment_id": 81330831, "body": "@Fran&#231;oisAndrieux: You cannot redeclare a name within the same scope, only a nested scope."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 4311, "user_id": 1669370, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E2t7h.jpg?s=128&g=1", "display_name": "Regis Portalez", "link": "https://stackoverflow.com/users/1669370/regis-portalez"}, "edited": false, "score": 2, "creation_date": 1510179929, "post_id": 47190568, "comment_id": 81330899, "body": "@RegisPortalez: this is a stripped down example, so it may seem pointless, but it is not."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1510180809, "post_id": 47190568, "comment_id": 81331272, "body": "@ShafikYaghmour: thanks, now I know where to look for answers: <code>stmt.ambig</code>. I&#39;ve read this section three times, but still undecided. Maybe I need to re-read several times"}], "answers": [{"comments": [{"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 2, "creation_date": 1510188716, "post_id": 47191759, "comment_id": 81333691, "body": "Thanks for the answer! Now it&#39;s clear that clang is right. But, in my opinion, current wording should be improved. Because, it states at the end of 1: &quot;In those cases the statement is a declaration.&quot; Then, the note tells, that this statement is not really always true, but only in the case when the statement can be syntactically a declaration. This can be a little bit confusing. End of 1 should read something like &quot;In those cases, when the whole statement can be a syntactically correct declaration, then it is a declaration&quot;"}], "tags": [], "owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "is_accepted": true, "score": 18, "last_activity_date": 1510241579, "last_edit_date": 1510241579, "creation_date": 1510185457, "answer_id": 47191759, "question_id": 47190568, "link": "https://stackoverflow.com/questions/47190568/is-int-x-1-an-ambiguous-statement/47191759#47191759", "title": "Is &quot;int (x), 1;&quot; an ambiguous statement?", "body": "<p>IMO, the wording in <a href=\"http://eel.is/c++draft/stmt.ambig\" rel=\"noreferrer\">[stmt.ambig]</a> is clear enough on this:</p>\n\n<blockquote>\n  <p><strong>An <em>expression-statement</em></strong> with a function-style explicit type conversion as its leftmost subexpression <strong>can be indistinguishable from a declaration where the first declarator starts with a <code>(</code></strong>. <strong>In those cases</strong> the statement is a declaration.</p>\n  \n  <p>[<em>Note</em>: <strong>If the statement cannot syntactically be a declaration, there is no ambiguity, so this rule does not apply. The whole statement might need to be examined to determine whether this is the case.</strong> </p>\n</blockquote>\n\n<p>The wording speaks of an entire (expression-)statement.\nYour statement cannot be parsed as a declaration, because the lexeme <code>1</code> is grammatically not a <em>declarator</em>. There is no ambiguity: it might look  ambiguous if we looked solely at <code>int(x)</code>, but the standard quite explicitly denies that if some prefix of the statement parses as a declaration, the entire statement is considered a potential declaration.</p>\n\n<p>In fact, core experts had a highly similar discussion back in 2002 over <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_closed.html#340\" rel=\"noreferrer\">core issue 340</a>---I highlighted the important bits. Here, again, we have a supposed declaration that contains an incompatible sub-construct. </p>\n\n<blockquote>\n  <p>Consider the following program:</p>\n\n<pre><code>struct Point   {\n  Point(int){}   \n};\nstruct Lattice    {\n  Lattice(Point, Point, int){}   \n};\nint main(void)   {\n  int a, b;\n  Lattice latt(Point(a), Point(b), 3);   /* Line X */   \n} \n</code></pre>\n  \n  <p>The problem concerns the line marked <code>/* Line X */</code>, which is an ambiguous\n  declarations for either an object or a function. The clause that\n  governs this ambiguity is 8.2 [dcl.ambig.res] paragraph 1, and reads:</p>\n  \n  <blockquote>\n    <p>The ambiguity arising from the similarity between a function-style\n    cast and a declaration mentioned in 6.8 [stmt.ambig] [..]</p>\n  </blockquote>\n  \n  <p>Based on this clause there are two\n  possible interpretations of the declaration in line <code>X</code>:</p>\n  \n  <ul>\n  <li><strong>The declaration of <code>latt</code> declares a function with a return value of the\n  type <code>Lattice</code> and taking three arguments. The type of the first two\n  arguments is <code>Point</code> and each of these arguments is followed by a\n  parameter name in redundant parentheses. The type of the third\n  argument can not be determined, because it is a literal.</strong> This will\n  result in a syntax error. </li>\n  <li>The declaration of latt declares an object,\n  because the other option (a function declaration) would result in a\n  syntax error. Note that the last sentence before the \"[Note:\" is not\n  much help, because both options are declarations.</li>\n  </ul>\n  \n  <p><strong>Steve Adamczyk: a number of people replied to this posting on\n  comp.std.c++ saying that they did not see a problem.</strong> </p>\n  \n  <p>The original\n  poster replied:</p>\n  \n  <p>I can't do anything but agree with your argumentation. So there is\n  only one correct interpretation of clause 8.2 [dcl.ambig.res]\n  paragraph 1, but I have to say that with some rewording, the clause\n  can be made a lot clearer, like stating explicitly that the entire\n  declaration must be taken into account and that function declarations\n  are preferred over object declarations.</p>\n  \n  <p>I would like to suggest the following as replacement for the current\n  clause 8.2 [dcl.ambig.res] paragraph 1:</p>\n  \n  <blockquote>\n    <p>The ambiguity arising from the similarity between a functionstyle cast\n    and a declaration mentioned in 6.8 [stmt.ambig] [\u2026]</p>\n  </blockquote>\n  \n  <p><strong>The working group felt that the current wording is clear enough.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 5, "accepted_answer_id": 47191759, "answer_count": 1, "score": 15, "last_activity_date": 1528948592, "creation_date": 1510179051, "last_edit_date": 1528948592, "question_id": 47190568, "link": "https://stackoverflow.com/questions/47190568/is-int-x-1-an-ambiguous-statement", "title": "Is &quot;int (x), 1;&quot; an ambiguous statement?", "body": "<pre><code>void f(int x) {\n    int (x), 1;\n}\n</code></pre>\n\n<p>Clang compiles it, GCC doesn't. Which compiler is correct?</p>\n"}, {"tags": ["c++", "templates", "recursion", "design-patterns"], "comments": [{"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1510179068, "post_id": 47190539, "comment_id": 81330514, "body": "Why should it be done with templates?"}, {"owner": {"reputation": 1196, "user_id": 5468596, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oYsoZ.png?s=128&g=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/5468596/stephen"}, "edited": false, "score": 0, "creation_date": 1510179099, "post_id": 47190539, "comment_id": 81330528, "body": "To try to answer your question would require a huge list of proofs..."}, {"owner": {"reputation": 420, "user_id": 5108790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/R8idI.jpg?s=128&g=1", "display_name": "mathreadler", "link": "https://stackoverflow.com/users/5108790/mathreadler"}, "reply_to_user": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 0, "creation_date": 1510179157, "post_id": 47190539, "comment_id": 81330563, "body": "@rex: because i am curious if it would be possible to do with templates."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 3, "creation_date": 1510179196, "post_id": 47190539, "comment_id": 81330582, "body": "If you can write your code in a form that is <a href=\"https://en.wikipedia.org/wiki/Tail_call\" rel=\"nofollow noreferrer\">tail-recursive</a>, then the compiler will not use recursion. Search for &quot;tail recursion&quot; to find out more about it."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1510179268, "post_id": 47190539, "comment_id": 81330620, "body": "It&#39;s very difficult to respond to your question. The answer greatly depend (I suppose) from the exact problem, the reasons because you want to avoid the recursion and what has to do the function. Can you show as a recursive example to see if it&#39;s possible to derecursivize it?"}, {"owner": {"reputation": 9737, "user_id": 1460794, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/7lOXx.png?s=128&g=1", "display_name": "wally", "link": "https://stackoverflow.com/users/1460794/wally"}, "edited": false, "score": 1, "creation_date": 1510179377, "post_id": 47190539, "comment_id": 81330658, "body": "Just as a good answer would provide some examples, a good question should do the same. You could throw a template in anywhere you like, but to avoid recursion one first has to select some way to avoid the recursion (depends on the situation) and then decide if a template can help."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1510179378, "post_id": 47190539, "comment_id": 81330659, "body": "... and obviously you intend C++11 or newer (so variadic templates), not old C++98, isn&#39;t it?"}, {"owner": {"reputation": 420, "user_id": 5108790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/R8idI.jpg?s=128&g=1", "display_name": "mathreadler", "link": "https://stackoverflow.com/users/5108790/mathreadler"}, "reply_to_user": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1510180049, "post_id": 47190539, "comment_id": 81330954, "body": "@max66 I would be OK with either of them. Feel free to use your favourite. I edited the question to hopefully make it easier to answer."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 0, "creation_date": 1510180180, "post_id": 47190539, "comment_id": 81331028, "body": "about your <code>start()</code>/<code>end()</code> example... what interrupt the recursion?"}, {"owner": {"reputation": 420, "user_id": 5108790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/R8idI.jpg?s=128&g=1", "display_name": "mathreadler", "link": "https://stackoverflow.com/users/5108790/mathreadler"}, "edited": false, "score": 0, "creation_date": 1510180337, "post_id": 47190539, "comment_id": 81331094, "body": "ow, of course! how sloppy of me, will fix."}], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 5108790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/R8idI.jpg?s=128&g=1", "display_name": "mathreadler", "link": "https://stackoverflow.com/users/5108790/mathreadler"}, "edited": false, "score": 0, "creation_date": 1510182466, "post_id": 47191000, "comment_id": 81331908, "body": "yes something like that seems to me like it could work, but recursion has two template arguments."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 420, "user_id": 5108790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/R8idI.jpg?s=128&g=1", "display_name": "mathreadler", "link": "https://stackoverflow.com/users/5108790/mathreadler"}, "edited": false, "score": 0, "creation_date": 1510189986, "post_id": 47191000, "comment_id": 81333980, "body": "@mathreadler - the second one (<code>T1</code>) should be deduced from the input argument (<code>a1</code>, or <code>l1</code> from the internal point of view); it&#39;s the reason because I&#39;ve written <code>template &lt;typename T2, typename T1&gt;</code> instead of <code>template &lt;typename T1, typename T2&gt;</code>: writing first the deducible type (<code>T1</code>) you are forced to explicit both arguments (calling <code>T2 l2 = recursion&lt;T1, T2&gt;(l1);</code>); leaving last <code>T1</code> you can deduce it through <code>l1</code> and you&#39;re forced to explicit only <code>T2</code>."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1510182105, "last_edit_date": 1510182105, "creation_date": 1510181140, "answer_id": 47191000, "question_id": 47190539, "link": "https://stackoverflow.com/questions/47190539/c-template-techniques-for-straightening-out-recursion/47191000#47191000", "title": "C++ template techniques for straightening out recursion?", "body": "<p>Given your example (a little corrected)</p>\n\n<pre><code>template &lt;typename T2, typename T1&gt;\nT2 recursion(T1 a1){\n  T1 l1 = start(a1);\n  if( recurse_condition(a1,l1) )\n     T2 l2 = recursion&lt;T2&gt;(l1);\n  else return final(a1,l1);\n  return end(l2);\n}\n</code></pre>\n\n<p>I suppose you can avoid the recursion with something like (also C++98)</p>\n\n<pre><code>template &lt;typename T2, typename T1&gt;\nT2 noRecursion (T1 a1)\n {\n   std::size_t cnt ( 0U ); // counter: how many time is\n                           // executed `start()`\n\n   T1 l1 ( a1 );\n\n   do\n    {\n      a1 = l1;\n      l1 = start(a1);\n\n      ++cnt;\n    }\n   while ( recurse_condition(a1, l1) );\n\n   T2 l2 ( final(a1, l1) );\n\n   // exec end() one time less than start()\n   while ( --cnt ) // shorter than for (auto ui = 1U ; ui &lt; cnt ; ++ui)\n      l2 = end(l2);\n\n   return l2;\n }\n</code></pre>\n\n<p>In this case, the template aspect (<code>T1</code> and <code>T2</code>) are independent from the recursion/not recursion aspect: is useful in the not recursive function is if useful in the recursive version.</p>\n"}], "owner": {"reputation": 420, "user_id": 5108790, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/R8idI.jpg?s=128&g=1", "display_name": "mathreadler", "link": "https://stackoverflow.com/users/5108790/mathreadler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510182105, "creation_date": 1510178905, "last_edit_date": 1510181848, "question_id": 47190539, "link": "https://stackoverflow.com/questions/47190539/c-template-techniques-for-straightening-out-recursion", "title": "C++ template techniques for straightening out recursion?", "body": "<p>Assume I have a function that has a naturally occurring recursion, but I want to avoid to do recursion for any number of reasons. Do there exist any good ways to apply templates in C++ to systematically reshape the code execution to avoid the possible hazards of recursion?</p>\n\n<hr>\n\n<p>An example, we can assume <code>T1</code>, <code>T2</code> are some types and <code>start()</code>, <code>end()</code> some arbitrary functions taking arguments and returning things of the respective types:</p>\n\n<pre><code>T2 recursion(T1 a1){\n  T1 l1 = start(a1);\n  if( recurse_condition(a1,l1) )\n     T2 l2 = recursion(l1);\n  else return final(a1,l1);\n  return end(l2);\n}\n</code></pre>\n\n<p>So if I understand tail-recursion right it would be possible to do only if the <code>end()</code> function did nothing, but we assume here that it might do something.</p>\n\n<hr>\n\n<p>(I am not extremely frequently on this site so feel free to redirect me if question is more suitable somewhere else.)</p>\n"}, {"tags": ["c++", "boost", "c++-cli", "wrapper", "point-cloud-library"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5441845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-BSeow01nHzM/AAAAAAAAAAI/AAAAAAAABbY/4ASFuRrb4xI/photo.jpg?sz=128", "display_name": "Ahmad Mhaish", "link": "https://stackoverflow.com/users/5441845/ahmad-mhaish"}, "edited": false, "score": 0, "creation_date": 1510230589, "post_id": 47191171, "comment_id": 81352060, "body": "Actually I am not including any native dependencies in my wrapper project. In wrapper I am just creating an object from a class I have created in native dll and calling two functions from that class. So why from the first place these errors appears to me. Do you have any clue?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 111, "user_id": 5441845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-BSeow01nHzM/AAAAAAAAAAI/AAAAAAAABbY/4ASFuRrb4xI/photo.jpg?sz=128", "display_name": "Ahmad Mhaish", "link": "https://stackoverflow.com/users/5441845/ahmad-mhaish"}, "edited": false, "score": 0, "creation_date": 1510230678, "post_id": 47191171, "comment_id": 81352134, "body": "The error messages speak clearly: you depend on libz2, PCL visualization and grabber. These are clearly native dependencies and missing. You can always per-use <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">this FAQ entry</a> to hunt for the source"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 1, "last_activity_date": 1510181995, "creation_date": 1510181995, "answer_id": 47191171, "question_id": 47190427, "link": "https://stackoverflow.com/questions/47190427/unresolved-externals-when-building-c-wrapper-for-a-pre-developed-library-that/47191171#47191171", "title": "Unresolved externals when building c++ wrapper for a pre-developed library that uses boost", "body": "<p>C++-CLI is a different language; it compiles to an entirely different target (some .NET runtime version/architecture), which is both why it builds again and why you need to configure the link dependencies for those target configurations. </p>\n\n<p>I'd personally keep all native dependencies inside a native DLL and have a narrow interface implemented in a mixed-mode assembly. That way you can summarize the dependencies of the mixed-mode assembly as being the one native DLL that bundles any other native dependencies.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 5441845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-BSeow01nHzM/AAAAAAAAAAI/AAAAAAAABbY/4ASFuRrb4xI/photo.jpg?sz=128", "display_name": "Ahmad Mhaish", "link": "https://stackoverflow.com/users/5441845/ahmad-mhaish"}, "is_accepted": true, "score": 0, "last_activity_date": 1510244352, "last_edit_date": 1510244352, "creation_date": 1510231047, "answer_id": 47202070, "question_id": 47190427, "link": "https://stackoverflow.com/questions/47190427/unresolved-externals-when-building-c-wrapper-for-a-pre-developed-library-that/47202070#47202070", "title": "Unresolved externals when building c++ wrapper for a pre-developed library that uses boost", "body": "<p>Actually I have just used BOOST_IOSTREAMS_NO_LIB, and that fixed most of the problems.\nSo it appeared to me that there is a problem in bzip2 filters in windows cause it should be disabled by default, and that disable them mostly.\nFor other problem related to visualizer I found out the answer <a href=\"https://stackoverflow.com/questions/41194069/pcl-visualizer-h-fatal-error-lnk1120-1-unresolved-externals\">here</a></p>\n"}], "owner": {"reputation": 111, "user_id": 5441845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-BSeow01nHzM/AAAAAAAAAAI/AAAAAAAABbY/4ASFuRrb4xI/photo.jpg?sz=128", "display_name": "Ahmad Mhaish", "link": "https://stackoverflow.com/users/5441845/ahmad-mhaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 47202070, "answer_count": 2, "score": 0, "last_activity_date": 1510244352, "creation_date": 1510178398, "last_edit_date": 1510182038, "question_id": 47190427, "link": "https://stackoverflow.com/questions/47190427/unresolved-externals-when-building-c-wrapper-for-a-pre-developed-library-that", "title": "Unresolved externals when building c++ wrapper for a pre-developed library that uses boost", "body": "<p>I wrote a library that uses PCL and boost in C++. It is building perfectly. When I tried to make a wrapper for it using C++/CLR I got a lot of unresolved errors.\nFirstly, why Visual Studio is re-building my library again when building the wrapper?\nSecondly, why I got the following unresolved errors?:</p>\n\n<pre>\nError   LNK2005 \"protected: virtual void __cdecl pcl::Grabber::signalsChanged(void)\" (?signalsChanged@Grabber@pcl@@MEAAXXZ) already defined in pcl_io_debug.lib(pcl_io_debug.dll)\nError   LNK2005 \"protected: virtual void __cdecl pcl::Grabber::signalsChanged(void)\" (?signalsChanged@Grabber@pcl@@MEAAXXZ) already defined in pcl_io_debug.lib(pcl_io_debug.dll)\nError   LNK2001 unresolved external symbol \"public: virtual void __cdecl pcl::visualization::PCLVisualizer::FPSCallback::Execute(class vtkObject *,unsigned long,void *)\" (?Execute@FPSCallback@PCLVisualizer@visualization@pcl@@UEAAXPEAVvtkObject@@KPEAX@Z)\nError   LNK2019 unresolved external symbol deflate referenced in function \"protected: int __cdecl boost::iostreams::detail::zlib_base::xdeflate(int)\" (?xdeflate@zlib_base@detail@iostreams@boost@@IEAAHH@Z)\nError   LNK2019 unresolved external symbol deflateEnd referenced in function \"protected: void __cdecl boost::iostreams::detail::zlib_base::reset(bool,bool)\" (?reset@zlib_base@detail@iostreams@boost@@IEAAX_N0@Z)\nError   LNK2019 unresolved external symbol inflate referenced in function \"protected: int __cdecl boost::iostreams::detail::zlib_base::xinflate(int)\" (?xinflate@zlib_base@detail@iostreams@boost@@IEAAHH@Z)\nError   LNK2019 unresolved external symbol inflateEnd referenced in function \"protected: void __cdecl boost::iostreams::detail::zlib_base::reset(bool,bool)\" (?reset@zlib_base@detail@iostreams@boost@@IEAAX_N0@Z)\nError   LNK2019 unresolved external symbol deflateReset referenced in function \"protected: void __cdecl boost::iostreams::detail::zlib_base::reset(bool,bool)\" (?reset@zlib_base@detail@iostreams@boost@@IEAAX_N0@Z)\nError   LNK2019 unresolved external symbol inflateReset referenced in function \"protected: void __cdecl boost::iostreams::detail::zlib_base::reset(bool,bool)\" (?reset@zlib_base@detail@iostreams@boost@@IEAAX_N0@Z)\nError   LNK2019 unresolved external symbol crc32 referenced in function \"protected: void __cdecl boost::iostreams::detail::zlib_base::after(char const * &,char * &,bool)\" (?after@zlib_base@detail@iostreams@boost@@IEAAXAEAPEBDAEAPEAD_N@Z)\nError   LNK2019 unresolved external symbol deflateInit2_ referenced in function \"private: void __cdecl boost::iostreams::detail::zlib_base::do_init(struct boost::iostreams::zlib_params const &,bool,void * (__cdecl*)(void *,unsigned int,unsigned int),void (__cdecl*)(void *,void *),void *)\" (?do_init@zlib_base@detail@iostreams@boost@@AEAAXAEBUzlib_params@34@_NP6APEAXPEAXII@ZP6AX22@Z2@Z)\nError   LNK2019 unresolved external symbol inflateInit2_ referenced in function \"private: void __cdecl boost::iostreams::detail::zlib_base::do_init(struct boost::iostreams::zlib_params const &,bool,void * (__cdecl*)(void *,unsigned int,unsigned int),void (__cdecl*)(void *,void *),void *)\" (?do_init@zlib_base@detail@iostreams@boost@@AEAAXAEBUzlib_params@34@_NP6APEAXPEAXII@ZP6AX22@Z2@Z)\n</pre>\n"}, {"tags": ["c++", "function", "return"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 7, "creation_date": 1510178196, "post_id": 47190343, "comment_id": 81330118, "body": "My crystal ball says that in the rest of your code you are writing <code>cout &lt;&lt; gradeCalculation(x,y)</code>"}, {"owner": {"reputation": 1103, "user_id": 4200424, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1bb83ff2ad5dcb60ee8e408792526e49?s=128&d=identicon&r=PG&f=1", "display_name": "bennji_of_the_overflow", "link": "https://stackoverflow.com/users/4200424/bennji-of-the-overflow"}, "edited": false, "score": 0, "creation_date": 1510178201, "post_id": 47190343, "comment_id": 81330120, "body": "When you used a void function were you still returning a value? You can&#39;t do this."}, {"owner": {"reputation": 4299, "user_id": 798346, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d7e5d155178f095778086f1cf84142ce?s=128&d=identicon&r=PG", "display_name": "Jim Rhodes", "link": "https://stackoverflow.com/users/798346/jim-rhodes"}, "edited": false, "score": 2, "creation_date": 1510178219, "post_id": 47190343, "comment_id": 81330126, "body": "You need to show the code that is calling <code>gradeCalculation</code>."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1510182047, "post_id": 47190343, "comment_id": 81331764, "body": "Why you don&#39;t like &quot;D&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 1555, "user_id": 3410584, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/hVfv4.jpg?s=128&g=1", "display_name": "ValLeNain", "link": "https://stackoverflow.com/users/3410584/vallenain"}, "is_accepted": true, "score": 4, "last_activity_date": 1510222204, "last_edit_date": 1510222204, "creation_date": 1510178215, "answer_id": 47190387, "question_id": 47190343, "link": "https://stackoverflow.com/questions/47190343/trying-to-get-rid-of-the-0-after-each-output-utilizing-a-function-but-unsure/47190387#47190387", "title": "Trying to get rid of the &#39;0&#39; after each output utilizing a function, but unsure of what I could return", "body": "<p>Return the char corresponding to the grade instead of calling  <code>cout &lt;&lt; .. endl</code> (because this only displays things, it does not return values). So when you make calls to <code>gradeCalculation</code> you get the char and you're able to display it.</p>\n\n<pre><code>char gradeCalculation(int grade, int topGrade)\n{\n    if (grade &gt;= topGrade - 10)\n        return 'A';\n    else if (grade &gt;= topGrade - 20)\n        return 'B';\n    else if (grade &gt;= topGrade - 30)\n        return 'C';\n    else if (grade &gt;= topGrade - 30)\n        return 'D';\n    else\n        return 'F';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8909924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RzbV8.jpg?s=128&g=1", "display_name": "MorsStella", "link": "https://stackoverflow.com/users/8909924/morsstella"}, "is_accepted": false, "score": 0, "last_activity_date": 1510178827, "creation_date": 1510178827, "answer_id": 47190517, "question_id": 47190343, "link": "https://stackoverflow.com/questions/47190343/trying-to-get-rid-of-the-0-after-each-output-utilizing-a-function-but-unsure/47190517#47190517", "title": "Trying to get rid of the &#39;0&#39; after each output utilizing a function, but unsure of what I could return", "body": "<p>Calling <code>std::cout &lt;&lt; \"Student \" &lt;&lt; i &lt;&lt; \" score is \" &lt;&lt; scoreArray[i] &lt;&lt; \" and their grade is \" &lt;&lt; gradeCalculation(scoreArray[i], highestGrade) &lt;&lt; std::endl;</code> implies that gradeCalculation has a return value. If you want to make gradeCalculation a void function it must be called separately from the <code>std::cout</code> statement.</p>\n"}, {"comments": [{"owner": {"reputation": 2912, "user_id": 3081206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YaKOY.jpg?s=128&g=1", "display_name": "takendarkk", "link": "https://stackoverflow.com/users/3081206/takendarkk"}, "edited": false, "score": 0, "creation_date": 1510179716, "post_id": 47190665, "comment_id": 81330804, "body": "You should edit your original answer rather than posting 2 answers. You also should not duplicate answers."}], "tags": [], "owner": {"reputation": 1, "user_id": 7735947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad777709dda9beb02cd43ebe193d106?s=128&d=identicon&r=PG&f=1", "display_name": "Murat", "link": "https://stackoverflow.com/users/7735947/murat"}, "is_accepted": false, "score": -2, "last_activity_date": 1510179449, "creation_date": 1510179449, "answer_id": 47190665, "question_id": 47190343, "link": "https://stackoverflow.com/questions/47190343/trying-to-get-rid-of-the-0-after-each-output-utilizing-a-function-but-unsure/47190665#47190665", "title": "Trying to get rid of the &#39;0&#39; after each output utilizing a function, but unsure of what I could return", "body": "<p>I think you use the function in a statement like \ncout &lt;&lt; gradeCaculation(int a, int b);\nInstead use just \ngradeCalculation(int a, int b);</p>\n"}], "owner": {"reputation": 3, "user_id": 8909878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469e5d157625a954beb6a2ab060f6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian James", "link": "https://stackoverflow.com/users/8909878/sebastian-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 47190387, "answer_count": 3, "score": -2, "last_activity_date": 1510222204, "creation_date": 1510178032, "question_id": 47190343, "link": "https://stackoverflow.com/questions/47190343/trying-to-get-rid-of-the-0-after-each-output-utilizing-a-function-but-unsure", "title": "Trying to get rid of the &#39;0&#39; after each output utilizing a function, but unsure of what I could return", "body": "<p><a href=\"https://pastebin.com/hBu7Mq28\" rel=\"nofollow noreferrer\">Pastebin Code</a></p>\n\n<pre><code>int gradeCalculation(int grade, int topGrade)\n{\n    if (grade &gt;= topGrade - 10)\n        std::cout &lt;&lt; \"A\" &lt;&lt; std::endl;\n    else if (grade &gt;= topGrade - 20)\n        std::cout &lt;&lt; \"B\" &lt;&lt; std::endl;\n    else if (grade &gt;= topGrade - 30)\n        std::cout &lt;&lt; \"C\" &lt;&lt; std::endl;\n    else if (grade &gt;= topGrade - 30)\n        std::cout &lt;&lt; \"D\" &lt;&lt; std::endl;\n    else\n        std::cout &lt;&lt; \"F\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://imgur.com/a/7ge6g\" rel=\"nofollow noreferrer\">Programming Problem I'm Solving</a></p>\n\n<p>After each output is a '0' from the return. I've tried to use a void function, but my compiler threw an <a href=\"https://imgur.com/a/Bvgal\" rel=\"nofollow noreferrer\">error.</a> Any ideas on what could be wrong with my code. Everything works fine as it is, but it's that tiny detail.</p>\n"}, {"tags": ["c++", "arrays", "arduino"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 1, "creation_date": 1510176450, "post_id": 47189881, "comment_id": 81329282, "body": "You &#39;re searching for peaks, not max. A set of data may contain more than one peaks. That means you can&#39;t just remove duplicates from a set of data. However, there is no need to print duplicate values. So, every time you find a peak, store it. Then if you ever encounter the same peak just ignore it (don&#39;t print it)."}, {"owner": {"reputation": 77, "user_id": 7608392, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48453cddf08a31231d02f4554f5247a1?s=128&d=identicon&r=PG&f=1", "display_name": "k5man001", "link": "https://stackoverflow.com/users/7608392/k5man001"}, "reply_to_user": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1510176936, "post_id": 47189881, "comment_id": 81329521, "body": "How may I go about storing it?"}, {"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1510177331, "post_id": 47189881, "comment_id": 81329715, "body": "Data range is [0 255] (256 values). So, make another array of size 256, init all elements to 0 and then everytime you a peak increase the array at the appropriate position. That way, every time you get a peak you just check the array if it&#39;s 0 at this position. If yes, print the peak if not, ignore it."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1510178142, "post_id": 47189881, "comment_id": 81330091, "body": "Are you describing the problem correctly? Doesn&#39;t your posted code print &quot;max 154 at 4&quot;, &quot;max 157 at 5&quot;, &quot;max 156 at 6&quot;? IOW doesn&#39;t it just print the values around local maximum regardless if those are equal with maximum or not?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1538817117, "post_id": 47189881, "comment_id": 92283870, "body": "How is it relevant to your algorithm where the data came from, like an Arduino? Please extract a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and also be specific with the problem you have. In particular don&#39;t just dump your intepretation but provide the actual observations instead. That said, format your code consistently if you want anyone to read it."}], "answers": [{"comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 77, "user_id": 7608392, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48453cddf08a31231d02f4554f5247a1?s=128&d=identicon&r=PG&f=1", "display_name": "k5man001", "link": "https://stackoverflow.com/users/7608392/k5man001"}, "edited": false, "score": 0, "creation_date": 1510180162, "post_id": 47190696, "comment_id": 81331019, "body": "hopefully. Maybe you have to adapt the syntax, but the approach itself should work in any procedural language."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 3, "last_activity_date": 1510179633, "creation_date": 1510179633, "answer_id": 47190696, "question_id": 47189881, "link": "https://stackoverflow.com/questions/47189881/how-to-find-local-maximums-in-data-set-using-c/47190696#47190696", "title": "How to find local maximums in data set using C++?", "body": "<p>You can detect \"local maxima\" or peaks in a single loop without the need of  copying something into another array. You just have to ignore repeating values, and you just have to keep track if the values considered are currently increasing or decreasing. Each value after which this status switches from increasing to decreasing is then a peak:</p>\n\n<pre><code>int main() {\n\n    int Array1[] = {1,2,3,4,4,4,3,2,7,8,9,10};\n\n    int prevVal = INT_MIN;\n    enum {\n        Ascending,\n        Descending\n    } direction = Ascending;\n\n    for (int i=0; i&lt;sizeof(Array1)/sizeof(*Array1); i++) {\n        int curVal = Array1[i];\n        if (prevVal &lt; curVal) {  // (still) ascending?\n            direction = Ascending;\n        }\n        else if (prevVal &gt; curVal) { // (still) descending?\n            if (direction != Descending) { // starts descending?\n                cout &lt;&lt; \"peak at index \" &lt;&lt; i-1 &lt;&lt; \": \" &lt;&lt; prevVal &lt;&lt; endl;\n                direction = Descending;\n            }\n        }\n        // prevVal == curVal is simply ignored...\n\n        prevVal = curVal;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7608392, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48453cddf08a31231d02f4554f5247a1?s=128&d=identicon&r=PG&f=1", "display_name": "k5man001", "link": "https://stackoverflow.com/users/7608392/k5man001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2996, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538816038, "creation_date": 1510176025, "last_edit_date": 1538816038, "question_id": 47189881, "link": "https://stackoverflow.com/questions/47189881/how-to-find-local-maximums-in-data-set-using-c", "title": "How to find local maximums in data set using C++?", "body": "<p>I am using an arduino to read a sensor which stores 256 values into an array. I am trying to find local max's but some values being stored have repeating values to the left and right of itself causing the value to print multiple times. Is there a way to take all true values meaning they are a max value and store them in another array to process and reduce the repeated values to just 1 value...</p>\n\n<p>OR is there a way to send the max values to another array where the repeated values get reduced to just 1? OR \nIE:</p>\n\n<pre><code>Array1[] = {1,2,3,4,4,4,3,2,7,8,9,10}\n\nmax = 4 at index 3\nmax = 4 at index 4\nmax = 4 at index 5\n</code></pre>\n\n<p>since 4 is a peak point but repeats how can I reduce it so that the array looks like </p>\n\n<pre><code>Array2[] = {1,2,3,4,3,2,7,8,9,10}\n\nmax = 4 at index 3\n</code></pre>\n\n<p>I need the most basic breakdown if possible nothing on an expert level, thanks.</p>\n\n<p>Code from Arduino:</p>\n\n<pre><code>int inp[20] = {24,100,13,155,154,157,156,140,14,175,158,102,169,160,190,100,200,164,143,20};\nvoid setup()\n{\n  Serial.begin(9600);  // for debugging  \n}\n\nvoid loop()\n{\n    int i;\n    int count = 0;\n    for (i = 0; i &lt; 20; i++)\n    {\n       Serial.println((String)inp[i]+\" index at - \"+i);\n       delay(100);\n    };   \n\n int N = 5;   // loc max neighborhood size\n for (int i = N-1; i &lt; 19-N; i++) \n  {\n      bool loc = false;\n      for (int j = 1; j &lt; N; j++) // look N-1 back and N-1 ahead\n      { \n        if (inp[i] &gt; inp[i-j] &amp;&amp; inp[i] &gt; inp[i+j]) loc = true;\n      }\n        if (loc == true)\n        {         \n          Serial.println((String)\"max = \"inp[i]+\" at index \"+i);\n        }\n     }\n  Serial.println(\"----------------------------------\");\n}\n</code></pre>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 362, "user_id": 8206202, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f98a1dfbe765113c5c21d88d6faaa958?s=128&d=identicon&r=PG&f=1", "display_name": "db7638", "link": "https://stackoverflow.com/users/8206202/db7638"}, "edited": false, "score": 1, "creation_date": 1510176071, "post_id": 47189842, "comment_id": 81329123, "body": "For anyone downvoting, I&#39;d appreciate greatly if you leave a quick comment why you did so, so that I can improve the question."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 4, "creation_date": 1510176204, "post_id": 47189842, "comment_id": 81329189, "body": "You&#39;ve inserted the same number twice. How can you tell which position the second one is being inserted at?"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 1, "creation_date": 1510176213, "post_id": 47189842, "comment_id": 81329193, "body": "How do you know that the insertion is happening in the wrong position? @BenjaminLindley: you were faster!"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1510176302, "post_id": 47189842, "comment_id": 81329221, "body": "Method 2 and 1 dont do the same thing. Method two just sets .front() to 0 twice."}, {"owner": {"reputation": 362, "user_id": 8206202, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f98a1dfbe765113c5c21d88d6faaa958?s=128&d=identicon&r=PG&f=1", "display_name": "db7638", "link": "https://stackoverflow.com/users/8206202/db7638"}, "reply_to_user": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1510176308, "post_id": 47189842, "comment_id": 81329223, "body": "@BenjaminLindley That is intentional. The size of the vector increases after the second insert. I see my question is wrong about the positions, I&#39;ll edit it now"}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 0, "creation_date": 1510176364, "post_id": 47189842, "comment_id": 81329244, "body": "@db7638: Yes, as it should. Because <code>insert</code> inserted another 0 into the vector, at the zeroth position. And the one that was formerly at the zeroth position is moved to the first position."}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1510176374, "post_id": 47189842, "comment_id": 81329248, "body": "Your question is not clear. Do you want to insert new values at a specific location or substitute it at that location? Because insertion will increase the amount of values stored"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1510176544, "post_id": 47189842, "comment_id": 81329325, "body": "Method 1 actually does do what you claim it doesn&#39;t.  If you are still having trouble with it, post a program that produces some output where the output is different to what you expected. <a href=\"https://stackoverflow.com/help/mcve\">How to create a MCVE</a>"}, {"owner": {"reputation": 362, "user_id": 8206202, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f98a1dfbe765113c5c21d88d6faaa958?s=128&d=identicon&r=PG&f=1", "display_name": "db7638", "link": "https://stackoverflow.com/users/8206202/db7638"}, "edited": false, "score": 0, "creation_date": 1510176566, "post_id": 47189842, "comment_id": 81329339, "body": "I made some wrong conclusions earlier in my question but I&#39;ve edited it and it&#39;s fixed now."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1510176645, "post_id": 47189842, "comment_id": 81329390, "body": "This is even more confusing since the edit. You can&#39;t say that you want to &quot;insert, in other words, substitute&quot;. Insert and substitute are completely different operations. Inserting always increases the size of the vector."}, {"owner": {"reputation": 362, "user_id": 8206202, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f98a1dfbe765113c5c21d88d6faaa958?s=128&d=identicon&r=PG&f=1", "display_name": "db7638", "link": "https://stackoverflow.com/users/8206202/db7638"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1510176922, "post_id": 47189842, "comment_id": 81329514, "body": "@M.M Yes, it would be less confusing if there was a function called substitute for vectors. As far as I know, that doesn&#39;t exist. Feel free to edit the question"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1510176983, "post_id": 47189842, "comment_id": 81329540, "body": "You&#39;ve used <code>reserve</code> instead of <code>resize</code>. Your vector is ready to contain two elements, but still empty, hence the exception."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1510177009, "post_id": 47189842, "comment_id": 81329552, "body": "@db7638 nobody can tell what you are trying to ask -- it&#39;s up to you to be more clear.  The assignment operator performs the operation of &quot;substitute&quot;.  The <code>insert</code> function performs the operation of &quot;insert&quot;. If you want to insert and then substitute, you should call the <code>insert</code> function once and then use the assignment operator once.  Not call the insert function twice."}], "answers": [{"comments": [{"owner": {"reputation": 362, "user_id": 8206202, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f98a1dfbe765113c5c21d88d6faaa958?s=128&d=identicon&r=PG&f=1", "display_name": "db7638", "link": "https://stackoverflow.com/users/8206202/db7638"}, "edited": false, "score": 0, "creation_date": 1510177656, "post_id": 47190167, "comment_id": 81329854, "body": "Yes, that is what I was looking for. Thanks for pointing out the initial inaccuracies in my question."}], "tags": [], "owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "is_accepted": true, "score": 5, "last_activity_date": 1510177731, "last_edit_date": 1510177731, "creation_date": 1510177259, "answer_id": 47190167, "question_id": 47189842, "link": "https://stackoverflow.com/questions/47189842/is-there-a-way-to-repeatedly-insert-an-element-at-a-specific-position-to-a-std/47190167#47190167", "title": "Is there a way to repeatedly insert an element at a specific position to a std::vector?", "body": "<p>You're confusing two separate operations. Insertion of an element, and assignment to an element. Insertion creates a new element in the vector, increasing its size. Assignment changes the value of an element that's already there. Both of your calls to <code>insert</code> are in fact doing the same thing. They are inserting an element to the front position of your vector, and shifting all existing elements down by 1.</p>\n\n<p>What you seem to be asking for is an operation that assigns to an element at a given index, but first inserts that element if it doesn't already exist. <code>std::vector</code> has no such operation, but you can write a function which allows you to do that.</p>\n\n<pre><code>template&lt;typename T, typename A&gt;\nT&amp; getElement(std::vector&lt;T, A&gt;&amp; v, size_t N) {\n    if (N &gt;= v.size())\n        v.resize(N + 1);\n    return v[N];\n}\n\n// usage\ngetElement(vec, 4) = 7;\n</code></pre>\n\n<p>This has the side effect of inserting default constructed elements in any positions preceding that index which don't yet exist in the vector, which doesn't seem very desirable to me. Maybe you should consider using a <code>std::map</code> or <code>std::unordered_map</code> instead. They have the exact behavior you are describing, but without inserting extra elements.</p>\n\n<pre><code>std::map&lt;int, int&gt; m;\nm[0] = 0;\nm[0] = 0;\n</code></pre>\n"}], "owner": {"reputation": 362, "user_id": 8206202, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f98a1dfbe765113c5c21d88d6faaa958?s=128&d=identicon&r=PG&f=1", "display_name": "db7638", "link": "https://stackoverflow.com/users/8206202/db7638"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 47190167, "answer_count": 1, "score": -2, "last_activity_date": 1510177793, "creation_date": 1510175807, "last_edit_date": 1510177530, "question_id": 47189842, "link": "https://stackoverflow.com/questions/47189842/is-there-a-way-to-repeatedly-insert-an-element-at-a-specific-position-to-a-std", "title": "Is there a way to repeatedly insert an element at a specific position to a std::vector?", "body": "<p>I know my question seems very similar to <a href=\"https://stackoverflow.com/questions/6726805/insert-an-element-into-a-specific-position-of-a-vector\">this one</a>, but the solutions provided there don't work in this case.</p>\n\n<p>What I'm trying to do is very simple, put an element to a specific position in a vector.</p>\n\n<pre><code>#include &lt;vector&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; vec;\n    vec.reserve(2);\n\n    vec.insert(vec.begin() + 0, 0);\n    vec.insert(vec.begin() + 0, 1);\n\n    for (size_t i = 0; i &lt; vec.size(); i++)\n    {\n    std::cout &lt;&lt; vec.at(i) &lt;&lt; \"\\n\";\n    }\n}\n</code></pre>\n\n<p>The output is </p>\n\n<pre><code>1\n0\n</code></pre>\n\n<p>But I want the output to be just <code>1</code>.</p>\n\n<p>The second time I <code>insert</code>, the element is inserted at the <code>0th</code> position and the element previously at <code>0th</code> moves to <code>1st</code> position. I want the second call to <code>insert</code> have the same exact effect as the first call i.e. insert element to 0th position. In other words, I want the second call of <code>insert</code> to substitute the value at <code>0th</code> position. How do I do this?</p>\n\n<p>CLARIFICATION:</p>\n\n<p>My code included in this question is a short example of what I want. I'm calling <code>insert</code> twice but the first argument to <code>insert</code> is the same in both calls, so I don't understand why the second call to <code>insert</code> changes the size.</p>\n\n<p>In my actual code, the insert call is protected by mutex and is called by a <code>std::thread</code>, the <code>thread</code> might call the <code>insert</code> function multiple times for the same position (first argument to <code>insert</code>), so I want to find a way to not increase the vector size and simply replace the value at the specified position. </p>\n"}, {"tags": ["c++", "assembly", "x86"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1510175259, "post_id": 47189701, "comment_id": 81328744, "body": "Is it possibly part of a loop that repeats from the <code>cmp</code> and so <code>al</code> is no longer zero in subsequent iterations?"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1510175318, "post_id": 47189701, "comment_id": 81328783, "body": "@Jester: no, IDA does not show a loop."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1510175410, "post_id": 47189701, "comment_id": 81328822, "body": "IDA may be wrong with disassembly (very very unlikely, but possible). It may be also just missed optimization from compiler, probably confused by too complex C++ source or some unhelpful data type, which doesn&#39;t get compiled well. <code>xor eax,eax</code> would be superior in this case, avoiding <code>movzx</code> completely. Also it may be some kind of hand tuned &quot;nop&quot; padding, but I doubt that, using ordinary multibyte <code>nop</code> variant is better."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1510175756, "post_id": 47189701, "comment_id": 81328974, "body": "@Ped7g: I will get the source code later. It&#39;s a short demo program (C++ console, maybe 20 lines of code only). Stud_PE signature scan didn&#39;t find anything, but likely it&#39;s Visual Studio 2013 or 2015 compiler."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1510178983, "post_id": 47189701, "comment_id": 81330482, "body": "BTW, if it&#39;s not in loop, and it is not some kind of high frequency trading bot, or something else with real-time requirements and hard limits, then it doesn&#39;t matter, the total executable time went up by 2-3 cycles at most... but it saved probably few thousands of CPU cycles at optimizing stage of compiler ;)"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1510180212, "post_id": 47189701, "comment_id": 81331044, "body": "@Ped7g Thanks for the insight. Hopefully the compiler cannot take that information into consideration. Maybe in 15 years the compiler asks my Facebook profile first and then determines whether or not I will execute that program at all :-)"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1510182100, "post_id": 47189701, "comment_id": 81331782, "body": "That&#39;s negative, it will be too hard to predict whether you will be able to sell it somewhere in the future, for example by doing some proper pitch toward some dumb high frequency trading bot... That would cost probably few billions of cycles to decide, too costly. But for example <a href=\"https://en.wikipedia.org/wiki/Profile-guided_optimization\" rel=\"nofollow noreferrer\">Profile-guided_optimization</a> is a real thing, i.e. after collecting somewhat meaningful runtime data, the compiler may focus optimizer on hot-spots of the code, and skip those single-time-executed to spend cycles in more meaningful way."}], "answers": [{"comments": [{"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1510176421, "post_id": 47189913, "comment_id": 81329268, "body": "Would that incicate there&#39;s a line of C++ code like <code>byte x=something;</code> instead of e.g. <code>int x=something;</code>? (potentially, of course, not sure)"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1510176628, "post_id": 47189913, "comment_id": 81329380, "body": "@ThomasWeller: I wouldn&#39;t even try to guess from the tiny fragment you showed.  That&#39;s plausible.  I was thinking that maybe a boolean condition was getting promoted to <code>int</code>, and the compiler only proved that it was always false too late to go and fix the rest of the code?  IDK, MSVC doesn&#39;t make the most efficient code.  I only rarely look at its output, so IDK what kind of source could trick it into being dumb like this."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1510176803, "post_id": 47189913, "comment_id": 81329466, "body": "Hehe, ok. At least my understanding of the ASM code seems to be fine and no obvious human brain issue late at night :-). Thanks."}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1510176984, "post_id": 47189913, "comment_id": 81329541, "body": "@ThomasWeller: related: <a href=\"https://stackoverflow.com/questions/40354978/why-is-this-c-code-faster-than-my-hand-written-assembly-for-testing-the-collat\">tweaking C source to hand-hold compilers into making better asm</a>.  Sometimes when compilers are missing an optimization you can see in the asm, you can change the source.  IDK about a case like this where it&#39;s not even algorithmic, just plain stupid, though."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1510177105, "post_id": 47189913, "comment_id": 81329606, "body": "Thanks - maybe that&#39;s too much for me at the moment. I&#39;ll post the C++ MCVE when I get it."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1510176202, "creation_date": 1510176202, "answer_id": 47189913, "question_id": 47189701, "link": "https://stackoverflow.com/questions/47189701/any-advantage-of-xor-al-al-movzx-eax-al-over-xor-eax-eax/47189913#47189913", "title": "Any advantage of XOR AL,AL + MOVZX EAX, AL over XOR EAX,EAX?", "body": "<p><code>xor al,al</code> is already slower than <code>xor eax,eax</code> on most CPUs.  e.g. <a href=\"https://stackoverflow.com/questions/45660139/how-exactly-do-partial-registers-on-haswell-skylake-perform-writing-al-seems-to\">on Haswell/Skylake it needs an ALU uop and doesn't break the dependency on the old value of <code>eax</code>/<code>rax</code></a>.  It's equally bad on AMD CPUs, or Atom/Silvermont.  (Well, maybe not equally because AMD doesn't eliminate <code>xor eax,eax</code> at issue/rename, but it still has a false dependency which could serialize the new dependency chain with whatever used <code>eax</code> last).</p>\n\n<p>On CPUs that do rename <code>al</code> separately from the rest of the register (Intel pre-IvyBridge), the <code>xor al,al</code> may still be recognized <a href=\"https://stackoverflow.com/questions/33666617/what-is-the-best-way-to-set-a-register-to-zero-in-x86-assembly-xor-mov-or-and\">as a zeroing idiom</a>, but unless you actively want to preserve the upper bytes of the register, the best way to zero <code>al</code> is <code>xor eax,eax</code>.</p>\n\n<p>Doing <code>movzx</code> on top of that just makes it even worse.</p>\n\n<hr>\n\n<p>I'm guessing your compiler somehow got confused and decided it needed a 1-byte zero, but then realized it needed to promote it to 32 bits.  <code>xor</code> sets flags, so it couldn't <code>xor</code>-zero <em>after</em> the <code>cmp</code>, and it failed to notice that it could have just xor-zeroed <code>eax</code> before the <code>cmp</code>.</p>\n\n<p>Either that or it's <a href=\"https://stackoverflow.com/questions/47189701/any-advantage-of-xor-al-al-movzx-eax-al-over-xor-eax-eax/47189913#comment81328744_47189701\">something like Jester's suggestion</a>, where the <code>movzx</code> is a branch target.  Even if that's the case, <code>xor eax,eax</code> would still have been better because zero-extending into eax follows unconditionally on this code path.</p>\n\n<p>I'm curious what compiler produced this from what source.</p>\n"}], "owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 47189913, "answer_count": 1, "score": 6, "last_activity_date": 1510176202, "creation_date": 1510175181, "last_edit_date": 1510175911, "question_id": 47189701, "link": "https://stackoverflow.com/questions/47189701/any-advantage-of-xor-al-al-movzx-eax-al-over-xor-eax-eax", "title": "Any advantage of XOR AL,AL + MOVZX EAX, AL over XOR EAX,EAX?", "body": "<p>I have some unknown C++ code that was compiled in Release build, so it's optimized. The point I'm struggling with is:</p>\n\n<pre><code>xor     al, al\nadd     esp, 8\ncmp     byte ptr [ebp+userinput], 31h\nmovzx   eax, al\n</code></pre>\n\n<p>This is my understanding:</p>\n\n<pre><code>xor     al, al    ; set eax to 0x??????00 (clear last byte)\nadd     esp, 8    ; for some unclear reason, set the stack pointer higher\ncmp     byte ptr [ebp+userinput], 31h ; set zero flag if user input was \"1\"\nmovzx   eax, al   ; set eax to AL and extend with zeros, so eax = 0x000000??\n</code></pre>\n\n<p>I don't care about line 2 and 3. They might be there in this order for pipelining reasons and IMHO have nothing to do with EAX.</p>\n\n<p>However, I don't understand why I would clear AL first, just to clear the rest of EAX later. The result will IMHO always be <code>EAX = 0</code>, so this could also be</p>\n\n<pre><code>xor eax, eax\n</code></pre>\n\n<p>instead. What is the advantage or \"optimization\" of that piece of code?</p>\n\n<p>Some background info:</p>\n\n<p>I will get the source code later. It's a short C++ console demo program, maybe 20 lines of code only, so nothing that I would call \"complex\" code. IDA shows a single loop in that program, but not around this piece. The Stud_PE signature scan didn't find anything, but likely it's Visual Studio 2013 or 2015 compiler.</p>\n"}, {"tags": ["c++", "data-structures", "tree"], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 2523394, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d40798a5768de79d43dae9251fb06642?s=128&d=identicon&r=PG", "display_name": "lorniper", "link": "https://stackoverflow.com/users/2523394/lorniper"}, "edited": false, "score": 0, "creation_date": 1510176403, "post_id": 47189854, "comment_id": 81329261, "body": "Grazie! I understand the transitive issue, but if I use the default less operator, I hope it works fine at least for the example in your answer, i.e. { 1.0, 1.1, 1.3} = { 1.0, 1.1, 1.3}, is it true?"}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 586, "user_id": 2523394, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d40798a5768de79d43dae9251fb06642?s=128&d=identicon&r=PG", "display_name": "lorniper", "link": "https://stackoverflow.com/users/2523394/lorniper"}, "edited": false, "score": 0, "creation_date": 1510176622, "post_id": 47189854, "comment_id": 81329374, "body": "@lorniper True. It works perfectly for exact same doubles. As soon as those double are obtained by some computation, they will likely not be exactly the same."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 586, "user_id": 2523394, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d40798a5768de79d43dae9251fb06642?s=128&d=identicon&r=PG", "display_name": "lorniper", "link": "https://stackoverflow.com/users/2523394/lorniper"}, "edited": false, "score": 0, "creation_date": 1510221549, "post_id": 47189854, "comment_id": 81346125, "body": "@lorniper Remember to accept the answer if it is correct, so that other people will know that its ok."}], "tags": [], "owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "is_accepted": true, "score": 2, "last_activity_date": 1510175874, "creation_date": 1510175874, "answer_id": 47189854, "question_id": 47189554, "link": "https://stackoverflow.com/questions/47189554/collecting-unique-sorted-vectors/47189854#47189854", "title": "Collecting unique sorted vectors", "body": "<p>Yes, there is. It is called <a href=\"http://en.cppreference.com/w/cpp/container/set\" rel=\"nofollow noreferrer\"><code>std::set</code></a>:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;set&gt;\n\nint main()\n{\n    std::set&lt;std::vector&lt;double&gt;&gt; s{\n        { 1.0, 1.1, 1.3, 1.5, 1.7 },\n        { 1.0, 1.2, 1.4, 1.6, 1.8 },\n        { 1.0, 1.1, 1.3, 1.5, 1.7 },\n        { 1.0, 1.3, 1.4, 1.5, 1.6 },\n        { 1.0, 1.2, 1.4, 1.6, 1.8 },\n        { 1.0, 1.1, 1.3, 1.5, 1.7 },\n        { 1.0, 1.2, 1.4, 1.6, 1.8 },\n        { 1.0, 1.3, 1.4, 1.5, 1.6 },\n        { 1.0, 1.3, 1.4, 1.5, 1.6 },\n    };    \n}\n</code></pre>\n\n<p>It's likely that you will want to deeply analyze the <code>Compare</code> parameter of the template, in order to have a definition of <code>less</code> that fits your requirements.</p>\n"}], "owner": {"reputation": 586, "user_id": 2523394, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d40798a5768de79d43dae9251fb06642?s=128&d=identicon&r=PG", "display_name": "lorniper", "link": "https://stackoverflow.com/users/2523394/lorniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 47189854, "answer_count": 1, "score": 1, "last_activity_date": 1510175874, "creation_date": 1510174610, "question_id": 47189554, "link": "https://stackoverflow.com/questions/47189554/collecting-unique-sorted-vectors", "title": "Collecting unique sorted vectors", "body": "<p>I have hundred millions of sorted vectors containing floating numbers, the size of each array are the same and reasonably small(less than ten), I need to collect the unique vectors out of such vectors,</p>\n\n<pre><code>    vec1 = {1.0, 1.2, 1.4, 1.6, 1.8}\n    vec2 = {1.0, 1.1, 1.3, 1.5, 1.7}\n    vec2 = {1.0, 1.3, 1.4, 1.5, 1.6}\n\n...\n\n    SomeTree ={vec1, vec2, vec3 ...}\n</code></pre>\n\n<p>an array is considered the \"same\" as another only if every elements are numerically the same(up to some precision), Is there any special tree or other data structure suitable for such purpose ?</p>\n"}, {"tags": ["c++", "c++11", "operator-overloading"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1510173884, "post_id": 47189281, "comment_id": 81327955, "body": "Related: <a href=\"https://stackoverflow.com/q/4421706/1896169\">stackoverflow.com/q/4421706/1896169</a>"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 1, "creation_date": 1510173924, "post_id": 47189281, "comment_id": 81327986, "body": "Related: <a href=\"https://stackoverflow.com/questions/476272/how-to-properly-overload-the-operator-for-an-ostream\" title=\"how to properly overload the operator for an ostream\">stackoverflow.com/questions/476272/&hellip;</a>"}, {"owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1510174048, "post_id": 47189281, "comment_id": 81328062, "body": "@jamarcus_13  This operator  bool operator&lt;&lt;(const Choco&amp; c) {                          return this-&gt;full;                  }  does not make sense at least because the parameter c is not used.:)"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1510177401, "post_id": 47189281, "comment_id": 81329744, "body": "This doesn&#39;t address the question, but the logic of this class is inside-out. If a person eats the chocolate, it&#39;s the <b>person</b> who becomes full, not the <b>chocolate</b>."}], "answers": [{"tags": [], "owner": {"reputation": 219644, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1510174478, "last_edit_date": 1510174478, "creation_date": 1510174186, "answer_id": 47189436, "question_id": 47189281, "link": "https://stackoverflow.com/questions/47189281/print-operator-overload-fail/47189436#47189436", "title": "Print Operator overload fail?", "body": "<p>The operator is defined the following way outside the class because it is not a class member.</p>\n\n<pre><code>std::ostream &amp; operator &lt;&lt;( std::ostream &amp;os, const Choco &amp;c ) \n{\n    return os &lt;&lt; c.full;\n}\n</code></pre>\n\n<p>Take into account that the function</p>\n\n<pre><code>bool eat() {\n    full = true;\n}\n</code></pre>\n\n<p>shall have a return statement with an expression of the type <code>bool</code> or it should be declared with the return type <code>void</code> in the base and derived classes.</p>\n"}], "owner": {"reputation": 55, "user_id": 4760798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-lklAYAsEOCU/AAAAAAAAAAI/AAAAAAAABwI/u5BQ8wNBt4o/photo.jpg?sz=128", "display_name": "jamarcus_13", "link": "https://stackoverflow.com/users/4760798/jamarcus-13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510175241, "creation_date": 1510173677, "last_edit_date": 1510175241, "question_id": 47189281, "link": "https://stackoverflow.com/questions/47189281/print-operator-overload-fail", "title": "Print Operator overload fail?", "body": "<p>Am practicing C++ basic inheritance concepts, came across the need to print out a custom class object and wrote an overload, followed guide exactly yet still does not register use of the new operator for printing (&lt;&lt;).</p>\n\n<p>Am wondering if typed incorrectly or had some declaration/initiation errors somewhere else?</p>\n\n<blockquote>\n  <p>no match for \u2018operator&lt;&lt;\u2019 (operand types are\n  \u2018std::basic_ostream\u2019 and \u2018Choco\u2019)  std::cout&lt;&lt; \"Choco value: \"\n  &lt;&lt; child &lt;&lt; endl;</p>\n</blockquote>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Sweets {\n        public:\n                // pure virtual, child MUST implement or become abstract\n                // Enclosing class becomes automatically abstract - CANNOT instantiate\n                virtual bool eat() = 0;\n};\n\n// public inheritance : public -&gt; public, protected -&gt; protected, private only accessible thru pub/pro members\nclass Choco : public Sweets {\n        public:\n\n                bool full;\n\n                Choco() {\n                        full = false;\n                }\n\n                // Must implement ALL inherited pure virtual\n                bool eat() {\n                        full = true;\n                }\n\n                // Overload print operator\n                bool operator&lt;&lt;(const Choco&amp; c) {\n                        return this-&gt;full;\n                }\n};\n\nint main() {\n\n// Base class object\n//sweets parent;\nChoco child;\n\n// Base class Ptr\n// Ptr value = address of another variable\nSweets* ptr; // pointer to sweets\nptr = &amp;child;\n\nstd::cout&lt;&lt; \"Sweets* value:  \" &lt;&lt; ptr &lt;&lt; endl;\nstd::cout&lt;&lt; \"Choco address: \" &lt;&lt; &amp;child &lt;&lt; endl;\nstd::cout&lt;&lt; \"Choco value: \" &lt;&lt; child &lt;&lt; endl; // Printing causes error!\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "lambda", "perfect-forwarding"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510178227, "post_id": 47189218, "comment_id": 81330134, "body": "Are you trying to write this because you want to learn from writing it, or are you trying to write it because you want to have it? If it\u2019s the second one, you should probably use <a href=\"http://en.cppreference.com/w/cpp/utility/functional/invoke\" rel=\"nofollow noreferrer\"><code>std::invoke</code></a> instead."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510178309, "post_id": 47189218, "comment_id": 81330171, "body": "@DanielH - <code>std::invoke</code> is a good choice but is C++17; this question is tagged C++11"}, {"owner": {"reputation": 55, "user_id": 1786089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d5af4f836b78360d56c9441bd4df6c3?s=128&d=identicon&r=PG", "display_name": "user1786089", "link": "https://stackoverflow.com/users/1786089/user1786089"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510203735, "post_id": 47189218, "comment_id": 81337475, "body": "@DanielH the first one"}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1510178366, "post_id": 47190326, "comment_id": 81330202, "body": "If you use trailing return type and <code>decltype</code>, then you don\u2019t need to specify the type of the first parameter and can just make it a template parameter <code>F</code>, and don\u2019t need to do anything special with lambdas (and can work with things which can\u2019t be converted to function pointers, like objects with <code>operator()</code> or lambdas with captures)."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510178701, "post_id": 47190326, "comment_id": 81330367, "body": "@DanielH - works; good solution (better than mine) but really different. You should propose it as an alternative answer."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 0, "last_activity_date": 1510177966, "creation_date": 1510177966, "answer_id": 47190326, "question_id": 47189218, "link": "https://stackoverflow.com/questions/47189218/template-function-for-applying-args-to-function/47190326#47190326", "title": "Template function for applying args to function", "body": "<p>If you accept to pass the <code>fun</code> lambda as <code>+fun</code> (transforming it in a function pointer), I suppose you can simply write <code>apply_args()</code> as</p>\n\n<pre><code>template &lt;typename R, typename ... Fts, typename ... As&gt;\nR apply_args (R(*fn)(Fts...), As &amp;&amp; ... as)\n { return fn(std::forward&lt;As&gt;(as)...); }\n</code></pre>\n\n<p>The full example</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\ntemplate &lt;typename R, typename ... Fts, typename ... As&gt;\nR apply_args (R(*fn)(Fts...), As &amp;&amp; ... as)\n { return fn(std::forward&lt;As&gt;(as)...); }\n\nint main ()\n {\n   auto fun = [](std::string a, std::string const&amp; b) { return a += b; };\n\n   std::string s(\"world!\");\n\n   s = apply_args(+fun, std::string(\"Hello, \"), s);\n\n   std::cout &lt;&lt; s &lt;&lt; std::endl;\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "edited": false, "score": 1, "creation_date": 1510230632, "post_id": 47194598, "comment_id": 81352101, "body": "good for C++14; but the question is tagged C++11; so <code>auto apply_args (Func &amp;&amp; f, Args &amp;&amp; ... args) -&gt; decltype( f(std::forward&lt;Args&gt;(args)...) )</code>"}], "tags": [], "owner": {"reputation": 2204, "user_id": 2027606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b0d51131d464f104ef33e4126e729027?s=128&d=identicon&r=PG", "display_name": "Andrei R.", "link": "https://stackoverflow.com/users/2027606/andrei-r"}, "is_accepted": true, "score": 3, "last_activity_date": 1510205840, "creation_date": 1510205840, "answer_id": 47194598, "question_id": 47189218, "link": "https://stackoverflow.com/questions/47189218/template-function-for-applying-args-to-function/47194598#47194598", "title": "Template function for applying args to function", "body": "<pre><code>template &lt;typename Func, typename ...Args&gt;\ndecltype(auto) apply_args(Func &amp;&amp;f, Args &amp;&amp;...args) {\n    return f(std::forward&lt;Args&gt;(args)...);\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 1786089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d5af4f836b78360d56c9441bd4df6c3?s=128&d=identicon&r=PG", "display_name": "user1786089", "link": "https://stackoverflow.com/users/1786089/user1786089"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47194598, "answer_count": 2, "score": 3, "last_activity_date": 1510205840, "creation_date": 1510173515, "last_edit_date": 1510178135, "question_id": 47189218, "link": "https://stackoverflow.com/questions/47189218/template-function-for-applying-args-to-function", "title": "Template function for applying args to function", "body": "<p>I trying to write a function (call it <code>apply_args()</code>) that takes a specific function or function object and arguments for calling this object, and calls it using the perfect forwarding.</p>\n\n<p>Example:</p>\n\n<pre><code>auto fun = [](std::string a, std::string const&amp; b) { return a += b; };\n\nstd::string s(\"world!\");\n\n// s is passing by lvalue ref,\n// temporary object by rvalue ref \ns = apply_args(fun, std::string(\"Hello, \"), s);\n</code></pre>\n\n<p>How can I implement that function?</p>\n"}, {"tags": ["c++", "proxy", "libcurl", "http-proxy"], "comments": [{"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1510173429, "post_id": 47189043, "comment_id": 81327702, "body": "Your clients should input their settings into your application.. Postman does it this way as well.."}, {"owner": {"reputation": 703, "user_id": 7114793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2b17f579d15da5cedb9b57581fe9651?s=128&d=identicon&r=PG&f=1", "display_name": "TVA van Hesteren", "link": "https://stackoverflow.com/users/7114793/tva-van-hesteren"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1510174183, "post_id": 47189043, "comment_id": 81328141, "body": "@Brandon, thats how I have got it to work for now. However, this is not what I want at all, since it can be achieved by automated programming?"}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1510174685, "post_id": 47189043, "comment_id": 81328421, "body": "Firefox does: <a href=\"https://stackoverflow.com/a/6195711/1462718\">stackoverflow.com/a/6195711/1462718</a> . or try: <code>WinHttpQueryOption</code> and pass it the flags in the remarks of: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa832669(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a> . No guarantee that this will work because some apps may not store credentials using WinHTTP."}, {"owner": {"reputation": 703, "user_id": 7114793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2b17f579d15da5cedb9b57581fe9651?s=128&d=identicon&r=PG&f=1", "display_name": "TVA van Hesteren", "link": "https://stackoverflow.com/users/7114793/tva-van-hesteren"}, "reply_to_user": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 0, "creation_date": 1510239910, "post_id": 47189043, "comment_id": 81358902, "body": "@Brandon, reading the registry works, however sometimes it returns me a link to the PAC file for the proxy settings. I have tried the tiny-js and pacparser libraries, however I can&#39;t get it to work in order to retrieve the proxy from the PAC file?"}], "answers": [{"comments": [{"owner": {"reputation": 703, "user_id": 7114793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2b17f579d15da5cedb9b57581fe9651?s=128&d=identicon&r=PG&f=1", "display_name": "TVA van Hesteren", "link": "https://stackoverflow.com/users/7114793/tva-van-hesteren"}, "edited": false, "score": 0, "creation_date": 1510176041, "post_id": 47189516, "comment_id": 81329107, "body": "Right, I tried that function however it was not capable of returning me the settings. Could you show me a working example code?"}, {"owner": {"reputation": 14859, "user_id": 109919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a962134d39b25609dac6b12fc745b3da?s=128&d=identicon&r=PG", "display_name": "Sheng Jiang \u848b\u665f", "link": "https://stackoverflow.com/users/109919/sheng-jiang-%e8%92%8b%e6%99%9f"}, "edited": false, "score": 1, "creation_date": 1510180098, "post_id": 47189516, "comment_id": 81330981, "body": "WinHttpGetIEProxyConfigForCurrentUser returns the settings for winhttp not wininet, which is used by IE."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 2, "last_activity_date": 1510174489, "creation_date": 1510174489, "answer_id": 47189516, "question_id": 47189043, "link": "https://stackoverflow.com/questions/47189043/c-windows-automatically-detect-proxy-settings/47189516#47189516", "title": "c++ Windows automatically detect proxy settings", "body": "<p>You can not read proxy setting in a generic way, since every application is free to store it in any way it wants. You should be able to read Internet Explorer proxy by using <em>WinHttpGetIEProxyConfigForCurrentUser</em> function, and it would also work for users browsers which use this setting, like Google Chrome.</p>\n"}], "owner": {"reputation": 703, "user_id": 7114793, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2b17f579d15da5cedb9b57581fe9651?s=128&d=identicon&r=PG&f=1", "display_name": "TVA van Hesteren", "link": "https://stackoverflow.com/users/7114793/tva-van-hesteren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1382, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582211353, "creation_date": 1510172938, "question_id": 47189043, "link": "https://stackoverflow.com/questions/47189043/c-windows-automatically-detect-proxy-settings", "title": "c++ Windows automatically detect proxy settings", "body": "<p>I have a C++ program which I want to use on my clients machines. However, some of my clients are behind proxies. Therefore, I want my program to automatically detect these proxies.</p>\n\n<p>I have tried many solutions, such as reading the registry for the proxy settings, trying the Windows API's, etc.</p>\n\n<p>However none of them have worked out well. E.g. the registry sometimes holds the url for the PAC-file and sometimes the actual proxy-address itself. Besides that, I haven't been able to find any username and password related to the proxy if it is set on the client machine (which some users say they have).</p>\n\n<p>So, basically my question is:\nHow can I automatically determine the proxy settings of my clients in C++ so I can use the proxy-settings in my LibCurl requests later on regarding:</p>\n\n<ul>\n<li>Proxy-address</li>\n<li>Proxy-port</li>\n<li>Proxy-User</li>\n<li>Proxy-Password</li>\n</ul>\n\n<p>I can't get it to work and I have been trying it for two weeks now without any improvement...</p>\n"}, {"tags": ["c++", "qt", "mingw", "qt5"], "comments": [{"owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 0, "creation_date": 1510184767, "post_id": 47188991, "comment_id": 81332629, "body": "Certain versions of resource compiler won&#39;t translate <code>VALUE &quot;ProductVersion&quot;, &quot;1.0.0.1&quot;</code> correctly without forcing end of string zero like  <code>VALUE &quot;ProductVersion&quot;, &quot;1.0.0.1\\0&quot;</code>. Unsure whether or not that is the case."}, {"owner": {"reputation": 7956, "user_id": 1518921, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BOzy5.png?s=128&g=1", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/1518921/guilherme-nascimento"}, "reply_to_user": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "edited": false, "score": 0, "creation_date": 1510190482, "post_id": 47188991, "comment_id": 81334079, "body": "@AlexanderVX thanks, but not work. From what I tested the <code>QCoreApplication::applicationVersion</code> takes the value from <code>PRODUCTVERSION</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7956, "user_id": 1518921, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BOzy5.png?s=128&g=1", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/1518921/guilherme-nascimento"}, "edited": false, "score": 0, "creation_date": 1510239271, "post_id": 47192637, "comment_id": 81358449, "body": "Great answer, but I still don&#39;t understand why not the difference of <i>MSVC</i> and <i>Mingw</i>. But I&#39;m already using your suggestion +1"}, {"owner": {"reputation": 334, "user_id": 6671474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2Xkdm.jpg?s=128&g=1", "display_name": "Crawl.W", "link": "https://stackoverflow.com/users/6671474/crawl-w"}, "edited": false, "score": 0, "creation_date": 1615383383, "post_id": 47192637, "comment_id": 117673135, "body": "What causes I got &quot;error: RC1020: unexpected &#39;#endif&#39;&quot; when I include <code>version.h</code>\uff1fI am using qtcreator and put the .rc file in the .pro file."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "reply_to_user": {"reputation": 334, "user_id": 6671474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2Xkdm.jpg?s=128&g=1", "display_name": "Crawl.W", "link": "https://stackoverflow.com/users/6671474/crawl-w"}, "edited": false, "score": 0, "creation_date": 1615420039, "post_id": 47192637, "comment_id": 117688521, "body": "@Crawl.W You cannot put the contents of an <code>.rc</code> file in the <code>.pro</code> file."}, {"owner": {"reputation": 334, "user_id": 6671474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2Xkdm.jpg?s=128&g=1", "display_name": "Crawl.W", "link": "https://stackoverflow.com/users/6671474/crawl-w"}, "edited": false, "score": 0, "creation_date": 1615427745, "post_id": 47192637, "comment_id": 117690217, "body": "Maybe I&#39;m not being precise enough,the way I use it is the same as in the topic.Would I send you my details?"}, {"owner": {"reputation": 334, "user_id": 6671474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/2Xkdm.jpg?s=128&g=1", "display_name": "Crawl.W", "link": "https://stackoverflow.com/users/6671474/crawl-w"}, "edited": false, "score": 0, "creation_date": 1615432921, "post_id": 47192637, "comment_id": 117691242, "body": "using <code>#pragma once</code> rather than header guard can avoid this issue,don&#39;t know why."}], "tags": [], "owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1510192326, "creation_date": 1510192326, "answer_id": 47192637, "question_id": 47188991, "link": "https://stackoverflow.com/questions/47188991/rc-file-dont-work-with-qcoreapplicationapplicationversion-when-using-mingw/47192637#47192637", "title": "RC_FILE don&#39;t work with QCoreApplication::applicationVersion when using MingW", "body": "<p>You should probably define your version numbers somewhere else and use those definitions in the .rc file. I use a header file for this, <code>src/appversion.h</code>, and it contains:</p>\n\n<pre><code>#define MY_APP_VERSION \"1.1.0\"\n/* MS Windows executable resource versions. */\n#define W32_RC_FILEVERSION 1,1,0,00\n#define W32_RC_PRODUCTVERSION 1,1,0,00\n</code></pre>\n\n<p>I then use these definitions in my .rc file:</p>\n\n<pre><code>#include \"src/appversion.h\"\n\n/* ... */\n\nFILEVERSION W32_RC_FILEVERSION\nPRODUCTVERSION W32_RC_PRODUCTVERSION\nFILEFLAGSMASK 0x3fL\n\n/* ... */\nVALUE \"FileVersion\", MY_APP_VERSION\n/* ... */\n</code></pre>\n\n<p>Then, after I instantiate a QApplication, I set the values like this:</p>\n\n<pre><code>a.setApplicationName(QString::fromLatin1(\"My App\"));\na.setApplicationVersion(QString::fromLatin1(MY_APP_VERSION));\n</code></pre>\n"}], "owner": {"reputation": 7956, "user_id": 1518921, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BOzy5.png?s=128&g=1", "display_name": "Guilherme Nascimento", "link": "https://stackoverflow.com/users/1518921/guilherme-nascimento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 47192637, "answer_count": 1, "score": 1, "last_activity_date": 1510192326, "creation_date": 1510172718, "question_id": 47188991, "link": "https://stackoverflow.com/questions/47188991/rc-file-dont-work-with-qcoreapplicationapplicationversion-when-using-mingw", "title": "RC_FILE don&#39;t work with QCoreApplication::applicationVersion when using MingW", "body": "<p>I create a simple rc file and put in <code>.pro</code>:</p>\n\n<ul>\n<li><p><code>rcexample.rc</code></p>\n\n<pre><code>#include \"winver.h\"\n\nVS_VERSION_INFO VERSIONINFO\n    FILEVERSION 1,0,0,1\n    PRODUCTVERSION 1,0,0,1\n    FILEFLAGS 0x0L\n    FILEFLAGSMASK 0x3fL\n    FILEOS 0x00040004L\n    FILETYPE 0x1L\n    FILESUBTYPE 0x0L\nBEGIN\n    BLOCK \"StringFileInfo\"\n    BEGIN\n        BLOCK \"000004b0\"\n        BEGIN\n            VALUE \"CompanyName\", \"Foo Bar CompanyName\"\n            VALUE \"FileDescription\", \"Foo bar FileDescription\"\n            VALUE \"FileVersion\", \"1.0.0.1\"\n            VALUE \"LegalCopyright\", \"Foo bar LegalCopyright\"\n            VALUE \"InternalName\", \"foobar\"\n            VALUE \"OriginalFilename\", \"foobar.exe\"\n            VALUE \"ProductName\", \"foobar product name\"\n            VALUE \"ProductVersion\", \"1.0.0.1\"\n        END\n    END\n    BLOCK \"VarFileInfo\"\n    BEGIN\n        VALUE \"Translation\", 0x0, 1200\n    END\nEND\n</code></pre></li>\n<li><p><code>winvertest.pro</code></p>\n\n<pre><code>QT += core gui\n\ngreaterThan(QT_MAJOR_VERSION, 4): QT += widgets\n\nTARGET = winvertest\nTEMPLATE = app\n\nwin32:RC_FILE = rcexample.rc # my rc file\n\nDEFINES += QT_DEPRECATED_WARNINGS\n\nSOURCES += main.cpp\n</code></pre></li>\n<li><p><code>main.cpp</code></p>\n\n<pre><code>#include &lt;QDebug&gt;\n#include &lt;QApplication&gt;\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n\n    qDebug() &lt;&lt; \"applicationVersion:\" &lt;&lt; a.applicationVersion();\n\n    return a.exec();\n}\n</code></pre></li>\n</ul>\n\n<p>Using <em>MSVC2015 32bit</em>, <code>applicationVersion</code> returns:</p>\n\n<blockquote>\n  <p>applicationVersion: \"1.0.0.1\"</p>\n</blockquote>\n\n<p>But using <em>Mingw 5.3.0</em> returns empty:</p>\n\n<blockquote>\n  <p>applicationVersion: \"\"</p>\n</blockquote>\n\n<p>Is this a Mingw issue or Qt issue or did I forget to add something to the \"pro\"?</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "race-condition"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 6, "creation_date": 1510172328, "post_id": 47188883, "comment_id": 81327115, "body": "<code>ready</code> is synchronized by <code>m</code> in every case. A <code>conditional_variable</code> always reacquires the lock before evaluating it&#39;s condition."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1510172336, "post_id": 47188883, "comment_id": 81327121, "body": "Because <code>std::mutex</code> is involved"}, {"owner": {"reputation": 1084, "user_id": 4443423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwXBe.jpg?s=128&g=1", "display_name": "Maikel", "link": "https://stackoverflow.com/users/4443423/maikel"}, "edited": false, "score": 0, "creation_date": 1510172471, "post_id": 47188883, "comment_id": 81327207, "body": "Couldn&#39;t spurious wakeup occur and a read and write of <code>ready</code> could  overlap?"}, {"owner": {"reputation": 1084, "user_id": 4443423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwXBe.jpg?s=128&g=1", "display_name": "Maikel", "link": "https://stackoverflow.com/users/4443423/maikel"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510172661, "post_id": 47188883, "comment_id": 81327312, "body": "@Fran&#231;oisAndrieux Ah. I understood after reading the docs again. Thank you. You are right."}], "answers": [{"tags": [], "owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "is_accepted": true, "score": 5, "last_activity_date": 1510172954, "creation_date": 1510172954, "answer_id": 47189046, "question_id": 47188883, "link": "https://stackoverflow.com/questions/47188883/wrong-stdcondition-variable-example-on-cppreference/47189046#47189046", "title": "Wrong std::condition_variable example on cppreference?", "body": "<p>No, there is no race condition.<br/>\nEven if the condition variable spuriously wakes up, it must re-acquire the lock. hence, two things happen:</p>\n\n<ol>\n<li>no thread can touch <code>ready</code> while the lock is held, as a lock protects it.</li>\n<li>by re-acquiring the lock, the boolean must be synchronized, because the lock enforce memory order acquire, which causes <code>ready</code> to have the latest value.</li>\n</ol>\n\n<p>So there is no way for race condition to happen.</p>\n"}], "owner": {"reputation": 1084, "user_id": 4443423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwXBe.jpg?s=128&g=1", "display_name": "Maikel", "link": "https://stackoverflow.com/users/4443423/maikel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 47189046, "answer_count": 1, "score": 3, "last_activity_date": 1510236159, "creation_date": 1510172263, "last_edit_date": 1510236159, "question_id": 47188883, "link": "https://stackoverflow.com/questions/47188883/wrong-stdcondition-variable-example-on-cppreference", "title": "Wrong std::condition_variable example on cppreference?", "body": "<p>In their <a href=\"http://en.cppreference.com/w/cpp/thread/condition_variable\" rel=\"nofollow noreferrer\">example</a> usage of <code>std::condition_variable</code> they have essentially</p>\n\n<pre><code>std::mutex m;\nstd::condition_variable cv;\nbool ready = false;\n\nvoid worker_thread()\n{\n    // Wait until main() sends data\n    std::unique_lock&lt;std::mutex&gt; lk(m);\n    cv.wait(lk, []{return ready;});\n    // more ...\n}\n\nint main()\n{\n    std::thread worker(worker_thread);\n\n    data = \"Example data\";\n    // send data to the worker thread\n    {\n        std::lock_guard&lt;std::mutex&gt; lk(m);\n        ready = true;\n    }\n    cv.notify_one();\n    // more...\n}\n</code></pre>\n\n<p>My problem now is the variable <code>ready</code> which is not declared <code>std::atomic*</code>. </p>\n\n<p><strong>Why doesn't this introduce a race condition if spurious wakeup occurs?</strong></p>\n"}, {"tags": ["c++", "2d", "collision", "allegro"], "comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1510177358, "post_id": 47188816, "comment_id": 81329729, "body": "It&#39;s not clear what works in your code and what doesn&#39;t. I&#39;d consider, for the time being, removing the jumping and just control your characters y position via arrow keys. Doing so will make it far easier to debug where the issue in your code is. You can move your character up to be underneath the platform, then see if they can move through. Halfway through see if they can move down or not. Then move them all the way through, and then down again. You&#39;ll be able to see in your debugger where the issue lies."}, {"owner": {"reputation": 35, "user_id": 7792290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f724186c78de4685aac718a1b8de9ae?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Wro\u0144ski", "link": "https://stackoverflow.com/users/7792290/maciej-wro%c5%84ski"}, "reply_to_user": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1510177603, "post_id": 47188816, "comment_id": 81329829, "body": "Thanks for reply, the issue is that, so when I jump, my character gets stucked in block, because the collision condition is always true. It&#39;s like i can jump few times &quot;inside the block&quot;, before I leave it. I&#39;d need condition like, which would check only from the top-side of the block, if player is on it."}], "owner": {"reputation": 35, "user_id": 7792290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f724186c78de4685aac718a1b8de9ae?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Wro\u0144ski", "link": "https://stackoverflow.com/users/7792290/maciej-wro%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510172895, "creation_date": 1510171997, "last_edit_date": 1510172895, "question_id": 47188816, "link": "https://stackoverflow.com/questions/47188816/implementing-a-collision-in-2d-platform-game-icy-tower", "title": "Implementing a collision in 2D platform game ( Icy Tower )", "body": "<p>I'm fighting with this for like few days, and I have no idea, how to do that, so I'd like to ask you for help. I've got no idea how collision should look like right here, so player could jump through 'down zone' of the block, and stay right on the block.</p>\n\n<p><strong>block.cpp</strong></p>\n\n<pre><code>bool block::CollidingWithPlayer(character&amp; player) { \n    for (int i = 1; i &lt; MAX_BLOCKS; i++) {\n        if (player.x + player.width &gt;= coordinateX[i] &amp;&amp; player.x &lt;= coordinateX[i] + width[i] &amp;&amp; player.y + player.height &gt;= coordinateY[i] &amp;&amp; player.y &lt;= coordinateY[i] + block_height) {\n            player.onGround = true;\n            return true;\n        }\n    }\n}\n</code></pre>\n\n<p><strong>character.cpp</strong></p>\n\n<pre><code>void character::startJump(map&amp; Map, character&amp; player) {\n    if (onGround)\n    {\n        vel[1] = -11.0;\n        onGround = false;\n    }\n}\nvoid character::updateJump(block&amp; Block, character&amp; player) {\n    if (!onGround) {\n        Block.CollidingWithPlayer(player);\n        vel[1] += 0.5;\n        y += vel[1];\n        x += vel[0];\n    }\n    if (y &gt; 460){\n        y = 460;\n        vel[1] = 0.0;\n        onGround = true;\n        vel[0] = 0.0;\n    }\n\n    if ((x + width &gt;= START_OF_RIGHT_WALL &amp;&amp; x &lt;= WALL_WIDTH + START_OF_RIGHT_WALL) || (x + width &gt;= START_OF_LEFT_WALL &amp;&amp;x &lt;= START_OF_LEFT_WALL + WALL_WIDTH)){\n    vel[0] *= -1;\n    bound = true;\n    if (direction == 1)\n        direction = 2;\n    else if (direction == 2)\n        direction = 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "linux", "redhat", "dynamic-linking"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1510170512, "post_id": 47188306, "comment_id": 81326148, "body": "The dynamic linker can provide some information. See LD_DEBUG : <a href=\"http://man7.org/linux/man-pages/man8/ld.so.8.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man8/ld.so.8.html</a>"}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1510172267, "post_id": 47188306, "comment_id": 81327077, "body": "do you wnt to know that for explicit dlopen() or loads done by the loader when you start your program?"}], "answers": [{"tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": true, "score": 2, "last_activity_date": 1510309310, "creation_date": 1510309310, "answer_id": 47220526, "question_id": 47188306, "link": "https://stackoverflow.com/questions/47188306/timing-shared-library-load-times-on-linux/47220526#47220526", "title": "Timing shared library load times on linux", "body": "<p>You should run under <code>LD_DEBUG=statistics</code>:</p>\n\n<pre><code>$ LD_DEBUG=statistics ls &gt; /dev/null\n      9897:\n      9897:     runtime linker statistics:\n      9897:       total startup time in dynamic loader: 1557664 clock cycles\n      9897:                 time needed for relocation: 322049 clock cycles (20.6%)\n      9897:                      number of relocations: 156\n      9897:           number of relocations from cache: 8\n      9897:             number of relative relocations: 1257\n      9897:                time needed to load objects: 1037549 clock cycles (66.6%)\n</code></pre>\n"}], "owner": {"reputation": 2640, "user_id": 802302, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/053d7640a7c3364e34c4b9a1a7a84406?s=128&d=identicon&r=PG", "display_name": "csteifel", "link": "https://stackoverflow.com/users/802302/csteifel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 47220526, "answer_count": 1, "score": 1, "last_activity_date": 1510309310, "creation_date": 1510170023, "question_id": 47188306, "link": "https://stackoverflow.com/questions/47188306/timing-shared-library-load-times-on-linux", "title": "Timing shared library load times on linux", "body": "<p>I'm trying to figure out how much time I'm taking in loading shared libraries on a linux system (RHEL 6 to be specific) and I'm wondering what sort of tools are out there to time how long shared library loading takes. I haven't really found any good information out there as to how to do this and I'm hoping some sort of tool exists.</p>\n"}, {"tags": ["c++", "unit-testing", "cmake"], "comments": [{"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1510170018, "post_id": 47188231, "comment_id": 81325878, "body": "<i>&quot;To run the program I use ...&quot;</i> Wait, doesn&#39;t CMake already do that for you??"}, {"owner": {"reputation": 109, "user_id": 7023916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274b16cce4c03ad160ad83824dd3f1b?s=128&d=identicon&r=PG", "display_name": "fdhd", "link": "https://stackoverflow.com/users/7023916/fdhd"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510170120, "post_id": 47188231, "comment_id": 81325937, "body": "To tell the truth I&#39;m not sure, if yes how do I &quot;run&quot; the program afterwards?"}, {"owner": {"reputation": 109, "user_id": 7023916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274b16cce4c03ad160ad83824dd3f1b?s=128&d=identicon&r=PG", "display_name": "fdhd", "link": "https://stackoverflow.com/users/7023916/fdhd"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510170143, "post_id": 47188231, "comment_id": 81325953, "body": "That may be considered silly, but I&#39;m kind of lost"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510170379, "post_id": 47188231, "comment_id": 81326075, "body": "The command line you posted, doesn&#39;t <i>run the program</i>, but calls the compiler to compile <code>file-name.cpp</code> and link it as an executable target. To call the executable just type <code>.&#47;file-name</code> in the directory it was created."}, {"owner": {"reputation": 109, "user_id": 7023916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274b16cce4c03ad160ad83824dd3f1b?s=128&d=identicon&r=PG", "display_name": "fdhd", "link": "https://stackoverflow.com/users/7023916/fdhd"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510170457, "post_id": 47188231, "comment_id": 81326125, "body": "Yes, I know this, but I think there is really no CMake here, is it?"}, {"owner": {"reputation": 109, "user_id": 7023916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274b16cce4c03ad160ad83824dd3f1b?s=128&d=identicon&r=PG", "display_name": "fdhd", "link": "https://stackoverflow.com/users/7023916/fdhd"}, "reply_to_user": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510170499, "post_id": 47188231, "comment_id": 81326145, "body": "I thought that instead of using g++ there is some nice method to use CMake to compile and run the program"}, {"owner": {"reputation": 7681, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1510170630, "post_id": 47188231, "comment_id": 81326200, "body": "Maybe you are looking for this: <a href=\"https://cmake.org/cmake/help/v3.0/command/add_test.html\" rel=\"nofollow noreferrer\">cmake.org/cmake/help/v3.0/command/add_test.html</a>"}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "edited": false, "score": 2, "creation_date": 1510173195, "post_id": 47188231, "comment_id": 81327579, "body": "You&#39;re not using cmake correctly - cmake generates (amongst others) makefiles, which means you type <code>make</code>, not <code>g++ ...</code> to build the program"}, {"owner": {"reputation": 22670, "user_id": 955273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79903a88026b021e89735578bb71fd22?s=128&d=identicon&r=PG", "display_name": "Steve Lorimer", "link": "https://stackoverflow.com/users/955273/steve-lorimer"}, "edited": false, "score": 0, "creation_date": 1510173247, "post_id": 47188231, "comment_id": 81327600, "body": "You <code>CMakeLists</code> file should be named <code>CMakeLists.txt</code> not <code>CMakeLists.txt.cmake</code>"}, {"owner": {"reputation": 109, "user_id": 7023916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274b16cce4c03ad160ad83824dd3f1b?s=128&d=identicon&r=PG", "display_name": "fdhd", "link": "https://stackoverflow.com/users/7023916/fdhd"}, "edited": false, "score": 0, "creation_date": 1510173393, "post_id": 47188231, "comment_id": 81327682, "body": "Yes, sorry, there is a type, its names <code>CMakeLists.txt</code>. But apart from that it return no errors, when I run <code>make</code> in <code>build</code> directory it says that it is done, but there is no file which i can run with <code>.&#47;file-name</code>"}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1510217158, "post_id": 47188231, "comment_id": 81343447, "body": "You configured CMake to build an executable named hello not file-name."}], "answers": [{"tags": [], "owner": {"reputation": 1560, "user_id": 2030219, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6314bf166040bf1eb9deb3a6c03d6864?s=128&d=identicon&r=PG", "display_name": "Joel", "link": "https://stackoverflow.com/users/2030219/joel"}, "is_accepted": false, "score": 0, "last_activity_date": 1510174040, "creation_date": 1510174040, "answer_id": 47189391, "question_id": 47188231, "link": "https://stackoverflow.com/questions/47188231/linking-libraries-cmake/47189391#47189391", "title": "Linking libraries CMake", "body": "<blockquote>\n  <p>To run the program I use</p>\n</blockquote>\n\n<p>Nop, that's not the cmake idiomatic way to run/test your program. Since you have <strong>enable_testing()</strong>, cmake already has a custom target for you to run your binary. According to the CTest <a href=\"https://cmake.org/Wiki/CMake/Testing_With_CTest\" rel=\"nofollow noreferrer\">wiki</a>, all you need is to type make test after adding <strong>add_test</strong> function in you CMakeLists.txt. More or less like this:</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.0)\nproject (hello)\nfind_package (Eigen3 3.3 REQUIRED NO_MODULE)\nadd_executable (hello hello.cpp)\ntarget_link_libraries (hello Eigen3::Eigen)\n\nenable_testing()\n\nadd_test(test hello)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 7023916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2274b16cce4c03ad160ad83824dd3f1b?s=128&d=identicon&r=PG", "display_name": "fdhd", "link": "https://stackoverflow.com/users/7023916/fdhd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510174040, "creation_date": 1510169780, "last_edit_date": 1510173413, "question_id": 47188231, "link": "https://stackoverflow.com/questions/47188231/linking-libraries-cmake", "title": "Linking libraries CMake", "body": "<p>I'm not sure whether the title is correct, but anyway:</p>\n\n<p>I'm writing the project with <code>boost</code> and <code>eigen3</code> libraries, further I would like to test CMake. So far I've written everything in one .cpp file, the header is like:</p>\n\n<pre><code>#include &lt;boost/numeric/ublas/matrix.hpp&gt;\n#include &lt;boost/numeric/ublas/io.hpp&gt;\n#include &lt;iostream&gt;\n#include \"eigen/Eigen/Dense\"\n\n#define BOOST_TEST_DYN_LINK\n#define BOOST_TEST_MODULE Hello\n#include &lt;boost/test/unit_test.hpp&gt;\n\n#include &lt;cmath&gt;\n#include &lt;boost/timer/timer.hpp&gt;\n#include &lt;fstream&gt;\n</code></pre>\n\n<p>Further I added some boost unit tests in my \"main\" function in the following way</p>\n\n<pre><code>BOOST_AUTO_TEST_CASE(universeInOrder)\n{\n  Eigen::Matrix3d m;\n  m &lt;&lt; 0, 1, 2,  \n       3, 4, 5,\n       6, 7, 8;\n  BOOST_CHECK(Min(m) == 1);\n}\n</code></pre>\n\n<p>where <code>Min</code> is a separate function returning the lowest coeff. of matrix.\nIn my directory I have both <code>FindEigen3.CMake</code> and <code>FindBoost.CMake</code> files. I also have <code>CMakeLists.txt</code> file with the code:</p>\n\n<pre><code>cmake_minimum_required (VERSION 3.0)\nproject (hello)\nfind_package (Eigen3 3.3 REQUIRED NO_MODULE)\nadd_executable (hello hello.cpp)\ntarget_link_libraries (hello Eigen3::Eigen)\n\nenable_testing()\n</code></pre>\n\n<p>I'm running </p>\n\n<pre><code>mkdir build\ncd build\ncmake ..\n</code></pre>\n\n<p>and there are no errors, everything is ok.</p>\n\n<p>To run the program I use</p>\n\n<pre><code>g++ -I /home/fdhd/Documents/boost/ file-name.cpp -lboost_unit_test_framework -lboost_timer -o file-name\n</code></pre>\n\n<p>And here is my question - can I avoid linking <code>boost</code> in that command above and plug in into <code>CMakeLists.txt</code> file and run just \n<code>g++ file-name.cpp</code> , \nso that it will work because everything is in <code>CMakeLists</code> file?</p>\n\n<p>Any ideas? I think that the solution must be just behind the corner, but I can't really see it.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "qt"], "answers": [{"comments": [{"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1510178393, "post_id": 47190371, "comment_id": 81330218, "body": "Nice! It&#39;s a shame we have to write all this code. Specially if you also want this to work with seconds....and even more if you want this to work smartly with <code>QDateTimeEdit</code> (where you may want to increment days automatically after midnight)..."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1510178474, "post_id": 47190371, "comment_id": 81330260, "body": "@jpo38, I totally agree with you. This should be a built-in functionality."}, {"owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 1, "creation_date": 1510179774, "post_id": 47190371, "comment_id": 81330832, "body": "Added seconds incrementation/decrementation support to your answer ;-)"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1510180390, "post_id": 47190371, "comment_id": 81331113, "body": "@jpo38 Great addition. Thank you!"}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1510180798, "post_id": 47190371, "comment_id": 81331266, "body": "@jpo38, I&#39;ve voted up the issue in JIRA. Let&#39;s hope they imrpove it in the next release."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "reply_to_user": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "edited": false, "score": 0, "creation_date": 1516883022, "post_id": 47190371, "comment_id": 83876797, "body": "@jpo38, since the last time we&#39;ve talked about this I&#39;ve decided to create a <a href=\"https://github.com/scopchanov/flat-gui\" rel=\"nofollow noreferrer\">free and open-source library of custom widgets</a> and now I would like to share it. You might find it useful, as it contains a date and time pickers too."}], "tags": [], "owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "is_accepted": true, "score": 2, "last_activity_date": 1510179759, "last_edit_date": 1510179759, "creation_date": 1510178142, "answer_id": 47190371, "question_id": 47188200, "link": "https://stackoverflow.com/questions/47188200/qtimeedit-how-to-increment-to-next-hour-when-minutes-are-incremented/47190371#47190371", "title": "QTimeEdit How to increment to next hour when minutes are incremented?", "body": "<p>Set <a href=\"http://doc.qt.io/qt-5/qabstractspinbox.html#wrapping-prop\" rel=\"nofollow noreferrer\">wrapping</a> to <code>true</code>.</p>\n\n<p>As for the automatic change of the hours section, reimplement <code>stepBy</code> in a subclass of <em>QTimeEdit</em> like this:</p>\n\n<p><strong>MyTimeEdit.h</strong></p>\n\n<pre><code>#ifndef MYTIMEEDIT_H\n#define MYTIMEEDIT_H\n\n#include &lt;QTimeEdit&gt;\n\nclass MyTimeEdit : public QTimeEdit\n{\n    Q_OBJECT\npublic:\n    explicit MyTimeEdit(QWidget *parent = nullptr);\n\n    void stepBy(int steps) override;\n};\n\n#endif // MYTIMEEDIT_H\n</code></pre>\n\n<p><strong>MyTimeEdit.cpp</strong></p>\n\n<pre><code>#include \"MyTimeEdit.h\"\n\nMyTimeEdit::MyTimeEdit(QWidget *parent) : QTimeEdit(parent)\n{\n    setWrapping(true);\n}\n\nvoid MyTimeEdit::stepBy(int steps)\n{\n    QTime cur = time();\n\n    QTimeEdit::stepBy(steps);\n\n    if (currentSection() == QDateTimeEdit::MinuteSection) {\n        int m = cur.minute();\n        if ((m == 0) &amp;&amp; (steps &lt; 0))\n            setTime(time().addSecs(-3600));\n        else if ((m == 59) &amp;&amp; (steps &gt; 0))\n            setTime(time().addSecs(3600));\n    }\n    else if (currentSection() == QDateTimeEdit::SecondSection) {\n        int s = cur.second();\n        if ((s == 0) &amp;&amp; (steps &lt; 0))\n            setTime(time().addSecs(-60));\n        else if ((s == 59) &amp;&amp; (steps &gt; 0))\n            setTime(time().addSecs(60));\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10309544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ca53b8aed8e927a808f6649266a738?s=128&d=identicon&r=PG&f=1", "display_name": "Rolli", "link": "https://stackoverflow.com/users/10309544/rolli"}, "is_accepted": false, "score": 1, "last_activity_date": 1536654429, "creation_date": 1536654429, "answer_id": 52271758, "question_id": 47188200, "link": "https://stackoverflow.com/questions/47188200/qtimeedit-how-to-increment-to-next-hour-when-minutes-are-incremented/52271758#52271758", "title": "QTimeEdit How to increment to next hour when minutes are incremented?", "body": "<p>I noticed that the above answer does not work when using the mouse wheel or Page Up/Page Down instead of the arrow keys, because then the step is larger than 1 (10 in my case).</p>\n\n<p>Here is a version of MyTimeEdit.cpp that also works with the mouse wheel and Page Up/Down keys:</p>\n\n<p><strong>MyTimeEdit.cpp</strong></p>\n\n<pre><code>#include \"MyTimeEdit.h\"\n\nMyTimeEdit::MyTimeEdit(QWidget *parent) : QTimeEdit(parent)\n{\n    setWrapping(true);\n}\n\nvoid MyTimeEdit::stepBy(int steps)\n{\n    if (currentSection() == QDateTimeEdit::MinuteSection) {\n        setTime(time().addSecs(steps*60));\n    }\n    else if (currentSection() == QDateTimeEdit::SecondSection) {\n        setTime(time().addSecs(steps));\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 18867, "user_id": 3336423, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MfMjU.png?s=128&g=1", "display_name": "jpo38", "link": "https://stackoverflow.com/users/3336423/jpo38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "accepted_answer_id": 47190371, "answer_count": 2, "score": 2, "last_activity_date": 1540716453, "creation_date": 1510169691, "last_edit_date": 1540716453, "question_id": 47188200, "link": "https://stackoverflow.com/questions/47188200/qtimeedit-how-to-increment-to-next-hour-when-minutes-are-incremented", "title": "QTimeEdit How to increment to next hour when minutes are incremented?", "body": "<p>I'm having a <code>QTimeEdit</code> displaying <code>hh:mm</code>.</p>\n\n<p>This widget behavior is very annoying: When the value is <code>09:59</code>, there is no easy way to move to <code>10:00</code>. The spinbox controls on the right only applies to minutes or hours. When you put your cursor on minutes, incrementing is not allowed if value is <code>59</code>.</p>\n\n<p>To move from <code>09:59</code> to <code>10:00</code> you need to decrement <code>59</code> to <code>00</code> and then increment <code>09</code> to <code>10</code>...that's really annoying.</p>\n\n<p>Is there no option to make it possible to let user increment minutes by one using the spinbox control and then get value be changed from <code>09:59</code> to <code>10:00</code> with a single click??</p>\n"}, {"tags": ["c++", "arrays", "pointers", "pass-by-reference", "typedef"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1510169011, "post_id": 47187983, "comment_id": 81325247, "body": "Use std::string"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1510169321, "post_id": 47187983, "comment_id": 81325451, "body": "&quot;Everything works&quot;? This does not seem to make sense, since in that case <code>*ipStr[end+1] = &#39;\\0&#39;;</code> inside <code>extractIPfromURL</code> is wrong. You would need <code>(*ipStr)[end+1] = &#39;\\0&#39;;</code> in that case. The parentheses are absolutely required. Otherwise, the code does not do what you think it does."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 1, "creation_date": 1510169347, "post_id": 47187983, "comment_id": 81325463, "body": "Does it really make sense to pass arrays by reference? Why not use <code>void extractIPfromURL(const char* url, IPString ipStr);</code> directly? (The array decays to a pointer to its first element anyway.)"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510169366, "post_id": 47187983, "comment_id": 81325473, "body": "Perhaps there&#39;s some undefined behaviour in the <code>...</code> part."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 2, "creation_date": 1510169401, "post_id": 47187983, "comment_id": 81325500, "body": "@Cameron: It actually makes perfect sense if you want to enforce a specific array type (the size specifically). In fact, the is the <i>proper</i> way to do it. Passing <code>IPString ipStr</code> as parameter should be reserved for situations when array size is variable (and in that case the size should normally be passed as an extra parameter)."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1510169886, "post_id": 47187983, "comment_id": 81325802, "body": "@Sergei G: There&#39;s something inaccurate in your description. You first version is actually broken and will typically &quot;overwrite the stack&quot; because of <code>*ipStr[end+1] = &#39;\\0&#39;;</code> error. Meanwhile, your second version (with a reference) looks fine at least at the first sight (assuming you don&#39;t overrun the array for some other reason). The &quot;reversed&quot; behavior you observe is unexplainable from the information you provided so far."}, {"owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "edited": false, "score": 0, "creation_date": 1510170088, "post_id": 47187983, "comment_id": 81325918, "body": "I have many of the same questions.  I hoped someone can explain :)"}, {"owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "edited": false, "score": 0, "creation_date": 1510172106, "post_id": 47187983, "comment_id": 81326997, "body": "I will attempt to write a simple test case in the effort to reproduce the problem cleaner.  It will have to wait a bit."}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1510178066, "creation_date": 1510178066, "answer_id": 47190354, "question_id": 47187983, "link": "https://stackoverflow.com/questions/47187983/passing-typedef-char-ipstring17-as-argument-to-a-function/47190354#47190354", "title": "Passing &quot;typedef char IPString[17]&quot; as argument to a function", "body": "<p>Your question is rather unclear. Part-way down the question you say you say \"If [I do this] everything works\". So the obvious solution is: do that.</p>\n\n<p>I am assuming that you are asking why the code you posted bits of at the start of the question doesn't work.</p>\n\n<p>Assuming that code is:</p>\n\n<pre><code>typedef char IPString[17];\nvoid extractIPfromURL(const char* url, IPString *ipStr);\n\nvoid some_function(void)\n{\n    IPString ipStr;\n    extractIPfromURL(\"https://192.168.0.1:80\", ipStr);\n}\n</code></pre>\n\n<p>You should get a compilation error.  If you don't see an error message then it is time to adjust the flags you pass to the compiler.  The code is a constraint violation because the argument type <code>char *</code> does not match the parameter type <code>char (*)[17]</code>.  </p>\n\n<p>The argument should match the parameter type. You have (at least) three different options for the argument: <code>IPstring</code>, <code>IPstring *</code>, <code>IPstring &amp;</code>. They will all work , so long as you pass the matching argument form, and you use the parameter correctly inside the function (and your code doesn't contain any other bugs of course).</p>\n\n<p>If you are still having trouble then try to post a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. At the moment it is anybody's guess what is causing the problem you see on ARM since you only posted bits and pieces.</p>\n\n<p>You could also consider not using the typedef at all.</p>\n\n<hr>\n\n<p>This code is suspicious:</p>\n\n<pre><code>strncpy(&amp;ipStr[0], &amp;ep[start], end-start+1);\nipStr[end+1] = '\\0';\n</code></pre>\n\n<p>If <code>start</code> is not zero then you are placing the <code>\\0</code> some distance past the end of where you actually finished copying characters. I would recommend avoiding <code>strncpy</code> entirely as it is relatively difficult both to use correctly, and to verify correct use of when you are reviewing code later. </p>\n"}], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510178066, "creation_date": 1510168871, "last_edit_date": 1510171847, "question_id": 47187983, "link": "https://stackoverflow.com/questions/47187983/passing-typedef-char-ipstring17-as-argument-to-a-function", "title": "Passing &quot;typedef char IPString[17]&quot; as argument to a function", "body": "<p>I have run into issues (runs on Intel, odd run results on ARM) when using this typedef:</p>\n\n<pre><code>typedef char IPString[17];\n...\nIPString ipStr;\nextractIPfromURL(\"https://192.168.0.1:80\", ipStr);\n</code></pre>\n\n<p>NOTE: I CANNOT use std::string, because code needs to compile on GCC and IAR.  While IAR does support std::string the rule is not to use it.</p>\n\n<p>If extractIPfromURL signature is:</p>\n\n<pre><code>void extractIPfromURL(const char* url, IPString *ipStr);\n</code></pre>\n\n<p>and implementation uses:</p>\n\n<pre><code>const char* ep;\n...\nstrncpy(ipStr[0], &amp;ep[start], end-start+1);\n*ipStr[end+1] = '\\0';\n</code></pre>\n\n<p>caller for pointer:</p>\n\n<pre><code>IPString ipStr;\nextractIPfromURL(\"https://192.168.0.1:80\", &amp;ipStr);\n</code></pre>\n\n<p>everything works.</p>\n\n<p>But if I was to use signature:</p>\n\n<pre><code>void extractIPfromURL(const char* url, IPString &amp;ipStr);\n</code></pre>\n\n<p>and implementation:</p>\n\n<pre><code>const char* ep;\n...\nstrncpy(&amp;ipStr[0], &amp;ep[start], end-start+1);\nipStr[end+1] = '\\0';\n</code></pre>\n\n<p>caller for reference:</p>\n\n<pre><code>IPString ipStr;\nextractIPfromURL(\"https://192.168.0.1:80\", ipStr);\n</code></pre>\n\n<p>The code on ARM appears to behave as I rewrote some of the stack and my loop that is supposed to iterate over 2 items iterates over 2 items forever like: 0, 1, 0, 1, 0, 1, etc.</p>\n\n<p>I tried an explicit reference declaration:</p>\n\n<pre><code>typedef char (&amp;IPStringRef)[17];\n</code></pre>\n\n<p>but got the same loop on ARM (Raspberry PI).</p>\n\n<p>I am sure I am not using typedef correctly in here, but I don't understand what exactly is it that I am doing wrong.</p>\n"}, {"tags": ["c++", "math", "3d", "glm-math"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 1262239, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bf74992f10ba5d301682294f06b552f5?s=128&d=identicon&r=PG", "display_name": "overwriter", "link": "https://stackoverflow.com/users/1262239/overwriter"}, "edited": false, "score": 0, "creation_date": 1510210109, "post_id": 47188758, "comment_id": 81339866, "body": "Thank you very much for your deployed answer! But what I&#39;m looking for is A way to get right Up vector for any situation, How can I determine right Up-direction for camera automatically? Maybe there is a way to get it taking cross product with glm::vec3(1, 0, 0) (right direction)? Or should I use quaternions maybe? If normally my camera is at (0, 0, 0) looking forward (0, 0, 1) and I place my camera somewhere at <i>cameraPosition</i> and trying to get it look to <i>targetPosition</i> how can I get rotation that doesn&#39;t rotate about camera&#39;s Z axis to turn to target?"}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "reply_to_user": {"reputation": 199, "user_id": 1262239, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bf74992f10ba5d301682294f06b552f5?s=128&d=identicon&r=PG", "display_name": "overwriter", "link": "https://stackoverflow.com/users/1262239/overwriter"}, "edited": false, "score": 1, "creation_date": 1510211577, "post_id": 47188758, "comment_id": 81340528, "body": "@overwriter Sure, you can calculate <i>up</i> from <i>right</i>. But this raises the question how to get <i>right</i>. In general, there is no automatic way because there are infinitely many solutions. And there is nothing that makes one solution better than another. So, in the end the programmer or scene designer has to decide."}, {"owner": {"reputation": 805, "user_id": 3502688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd304cde5aca9418a7c4d022a6c3a542?s=128&d=identicon&r=PG&f=1", "display_name": "Bradford Medeiros", "link": "https://stackoverflow.com/users/3502688/bradford-medeiros"}, "edited": false, "score": 0, "creation_date": 1604207802, "post_id": 47188758, "comment_id": 114273655, "body": "This is confusing me as well.  I ended up just checking the special case of it being straight down and just made it conditional.  Feels really inelegant and like a hack, but it works for how my functions are used in practice."}], "tags": [], "owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "is_accepted": true, "score": 3, "last_activity_date": 1510229420, "last_edit_date": 1510229420, "creation_date": 1510171704, "answer_id": 47188758, "question_id": 47187970, "link": "https://stackoverflow.com/questions/47187970/how-to-get-right-up-vector-for-lookat-transformation/47188758#47188758", "title": "How to get right Up vector for LookAt transformation?", "body": "<p>The reason for the NaN's you get is <em>division by zero</em>.</p>\n\n<hr>\n\n<p>Quoting <a href=\"https://stackoverflow.com/questions/21830340/understanding-glmlookat\">this post</a>:</p>\n\n<blockquote>\n  <p>The up vector is basically a vector defining your world's \"upwards\"\n  direction. In almost all normal cases, this will be the vector (0, 1,\n  0) i.e. towards positive Y. eye is the position of the camera's\n  viewpoint, and center is where you are looking at (a position).</p>\n</blockquote>\n\n<p>How does the setup work? The below diagram illustrates:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yoj4p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yoj4p.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li><code>u</code> is the up vector (third argument)</li>\n<li><code>p</code> is the target position (second argument)</li>\n<li><code>c</code> is the camera position (first argument)</li>\n<li><code>d</code> is the direction vector (= <code>p - c</code>)</li>\n<li><code>r</code> is the right vector</li>\n</ul>\n\n<p><code>lookAt</code> returns the <em>view matrix</em>, which has the following format:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lyhY7.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lyhY7.gif\" alt=\"enter image description here\"></a></p>\n\n<p>(Where the \"hats\" mean <em>normalized</em> - having length 1)</p>\n\n<p>Since you only supply the up vector and (effectively, because <code>d = p - c</code>) the direction vector, we must compute the right vector using the <em>cross-product</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qmIdG.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qmIdG.gif\" alt=\"enter image description here\"></a></p>\n\n<p>(Note the above was before normalization)</p>\n\n<hr>\n\n<p>Now for why your example does not work as expected. The arguments as such:</p>\n\n<ul>\n<li><code>u = (0, 1, 0)</code></li>\n<li><code>p = (0, 0, 0)</code></li>\n<li><code>c = (0, 1, 0)</code></li>\n<li>And thus <code>d = (0, -1, 0)</code></li>\n</ul>\n\n<p>The above gives <code>r = d * u = (0, 0, 0)</code>! This is because the direction and up vectors are anti-parallel, whereas there should be an angle between them for the routine to work (ideally 90 degrees). When <code>r</code> is normalized there is a division by zero, and hence the entire first row of your matrix should be occupied by NaN's.</p>\n\n<p>(As a possible fix, try <code>up = (0, 0, 1)</code> instead.)</p>\n"}], "owner": {"reputation": 199, "user_id": 1262239, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/bf74992f10ba5d301682294f06b552f5?s=128&d=identicon&r=PG", "display_name": "overwriter", "link": "https://stackoverflow.com/users/1262239/overwriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2546, "favorite_count": 1, "accepted_answer_id": 47188758, "answer_count": 1, "score": 0, "last_activity_date": 1516581631, "creation_date": 1510168830, "last_edit_date": 1516581631, "question_id": 47187970, "link": "https://stackoverflow.com/questions/47187970/how-to-get-right-up-vector-for-lookat-transformation", "title": "How to get right Up vector for LookAt transformation?", "body": "<p>I do understand how glm::LookAt works and what parameters it requires.\nI can't understand how to provide right Up vector.</p>\n\n<p>For example, this:</p>\n\n<pre><code>glm::mat4x4 transformation = glm::lookAt(cameraPosition, targetPosition, glm::vec3(0.f, 1.f, 0.f));\n</code></pre>\n\n<p>If I want to make camera watch straight down:</p>\n\n<pre><code> mat4x4 transformation = glm::lookAt(vec3(0.f, 1.f, 0.f), vec3(0.f, 0.f, 0.f), vec3(0.f, 1.f, 0.f));\n</code></pre>\n\n<p>It won't work. Matrix will contain <em>NaNs</em> (Not a Number) values!\nSo how to get right value for Up vector?</p>\n"}, {"tags": ["c++", "file", "c++11", "integer", "delimiter"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1510169069, "post_id": 47187884, "comment_id": 81325275, "body": "From your question, it is not clear which array you are attempting to not initialize.  That said, Most of your arrays are not needed at all.  If all you want to do is count the number of 0,1,2,3,4,5,6,7,8,9 in the file, it can be done with a little math instead. As to reading the values without being space delimited, it might be easier to read them in 1 character at a time instead of as an int, then convert the char to an integer.  I know how to do this in C, but there is probably a C++ way to do this instead with streams."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1510169537, "post_id": 47187884, "comment_id": 81325588, "body": "And as for file size, you really are only reading in things 1 number at a time.  Therefore, the only thing you need is a single integer buffer, than an array to keep track of your digit count.  <code>mycompare</code>, and array for <code>myint</code> are both a waste.  Having more than 10 entries into your <code>mycount</code> is also a waste."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1510170721, "post_id": 47188161, "comment_id": 81326254, "body": "Giving you a +1 back because &quot;gimme the codez&quot; markdown is incredibly rude and not fair."}, {"owner": {"reputation": 21, "user_id": 8851654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc67f84a10adc706ba6d686efda1d20?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/8851654/hamed"}, "edited": false, "score": 0, "creation_date": 1510221603, "post_id": 47188161, "comment_id": 81346171, "body": "As I understand, you have  a file that contain only digits and you want to write a code to count each digit (0 to 9). Correct if I am wrong. I need to know what you want to do (exactly), and I will write code for you."}], "tags": [], "owner": {"reputation": 21, "user_id": 8851654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc67f84a10adc706ba6d686efda1d20?s=128&d=identicon&r=PG&f=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/8851654/hamed"}, "is_accepted": false, "score": 1, "last_activity_date": 1510169560, "creation_date": 1510169560, "answer_id": 47188161, "question_id": 47187884, "link": "https://stackoverflow.com/questions/47187884/read-number-occurrence-from-file-with-no-delimiter-c/47188161#47188161", "title": "read number occurrence from file with no delimiter c++", "body": "<p>Why dont you use char type to read from the file? With char you can read character by character and count them. It maybe better to use switch-case structure instead of \"for\" to count.\nLast paragraph is not clear for me.</p>\n"}, {"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1510170961, "post_id": 47188423, "comment_id": 81326372, "body": "Also beware that this will fail horribly if it can&#39;t find the input file, if the file is not ASCII, etc."}, {"owner": {"reputation": 17, "user_id": 8908857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5f7764ddf2820a8e22ba6803e1c48e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark P", "link": "https://stackoverflow.com/users/8908857/mark-p"}, "edited": false, "score": 0, "creation_date": 1510170983, "post_id": 47188423, "comment_id": 81326382, "body": "Hello Michael, thanks for the code. I fixed a few things, however now it&#39;s not reading at all. The output is 0 occurs 0 times, 1 occurs 0 times, etc."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 17, "user_id": 8908857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5f7764ddf2820a8e22ba6803e1c48e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark P", "link": "https://stackoverflow.com/users/8908857/mark-p"}, "edited": false, "score": 0, "creation_date": 1510171141, "post_id": 47188423, "comment_id": 81326448, "body": "Again, untested code is untested.  At this point, it would be excellent to actually step through the above code in a debugger and see why it is failing.  If I had a guess, it is how I am handling the eof() or on the isdigit check.  Putting a break point and stepping through will show for sure where the issue exists."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "reply_to_user": {"reputation": 17, "user_id": 8908857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5f7764ddf2820a8e22ba6803e1c48e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark P", "link": "https://stackoverflow.com/users/8908857/mark-p"}, "edited": false, "score": 0, "creation_date": 1510171301, "post_id": 47188423, "comment_id": 81326552, "body": "You could also try putting the <code>theFile&gt;&gt;c</code> line directly in the while loop check, replacing the eof, as I suggest."}], "tags": [], "owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "is_accepted": false, "score": 1, "last_activity_date": 1510171347, "last_edit_date": 1510171347, "creation_date": 1510170438, "answer_id": 47188423, "question_id": 47187884, "link": "https://stackoverflow.com/questions/47187884/read-number-occurrence-from-file-with-no-delimiter-c/47188423#47188423", "title": "read number occurrence from file with no delimiter c++", "body": "<p>Disclaimer- below code is not compiled or tested.  You turn this in as-is and you get what you get.</p>\n\n<p>Notice how I have changed the file read (<code>cin</code>) to use a char instead of an integer.  This allows me to read the file 1 char at a time.  Also notice that I've changed to range to 10, because there are 10 possible digits (remember 0), and have set my count array to this size.  Also notice that this will work with any file size, though it may fail if there are are more than 2 Billion integers of 1 value in the file (integer overflow) on a 32-bit system.</p>\n\n<pre><code>#include &lt;iostream&gt;     \n#include &lt;fstream&gt;\nusing namespace std;\n\nint main()\n{\n  ifstream theFile (\"inputData.txt\");\n  const int MaxRange= 10;\n  char c;\n  int mycount[MaxRange] = {0};\n\n  // Check for eof each loop.  This may not be the best way to do this, \n  // but it demonstrates the concept.\n\n  // A much better way is to put the cin assign right in the while loop parenthesis- \n  // this replaces and catches the eof automatically.\n  while(!cin.eof())\n  {\n    theFile&gt;&gt;c;\n\n    // If the char isn't a digit, we ignore it.\n    if(!isdigit(c))\n      continue;\n\n    // Convert char to integer.\n    int value = c + '0';\n\n    // Update count array.\n    mycount[value]++;\n  }\n\n  // Print the final array for each value.  You could skip counts\n  // of zero if you would like with a little extra logic.\n  for(int j=0; j&lt;MaxRange; j++)\n  {\n    cout&lt;&lt; j&lt;&lt; \" occurs: \"&lt;&lt;mycount[j]&lt;&lt;endl;  \n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8908857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5f7764ddf2820a8e22ba6803e1c48e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark P", "link": "https://stackoverflow.com/users/8908857/mark-p"}, "edited": false, "score": 0, "creation_date": 1510172923, "post_id": 47188910, "comment_id": 81327436, "body": "This is definitely very helpful. I am so close and it working, the problem I am having is it&#39;s outputting - numbers as well. I will spend some times fixing up the code. I will upvote this comment if I may no more questions."}, {"owner": {"reputation": 17, "user_id": 8908857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5f7764ddf2820a8e22ba6803e1c48e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark P", "link": "https://stackoverflow.com/users/8908857/mark-p"}, "edited": false, "score": 0, "creation_date": 1510176588, "post_id": 47188910, "comment_id": 81329352, "body": "perfect, works nice. Thanks, everyone for your help. For this one it was giving out negative results so I added if(isdigit(c)) between the while to fix it"}], "tags": [], "owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "is_accepted": true, "score": 2, "last_activity_date": 1510172374, "creation_date": 1510172374, "answer_id": 47188910, "question_id": 47187884, "link": "https://stackoverflow.com/questions/47187884/read-number-occurrence-from-file-with-no-delimiter-c/47188910#47188910", "title": "read number occurrence from file with no delimiter c++", "body": "<p>Simple example to start with (change <code>cin</code> with file)</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\nusing namespace std;\n\nint main() {\n    map&lt;int, int&gt; m;\n    char c;\n    while (cin &gt;&gt; c)\n        m[c - '0']++;\n    for (auto i : m)\n        cout &lt;&lt; i.first &lt;&lt; \" occurs \" &lt;&lt; i.second &lt;&lt; \" times\" &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n\n<p>Input</p>\n\n<pre><code>34625\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>2 occurs 1 times\n3 occurs 1 times\n4 occurs 1 times\n5 occurs 1 times\n6 occurs 1 times\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8908857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5f7764ddf2820a8e22ba6803e1c48e?s=128&d=identicon&r=PG&f=1", "display_name": "Mark P", "link": "https://stackoverflow.com/users/8908857/mark-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 47188910, "answer_count": 3, "score": -2, "last_activity_date": 1510172374, "creation_date": 1510168585, "last_edit_date": 1510168808, "question_id": 47187884, "link": "https://stackoverflow.com/questions/47187884/read-number-occurrence-from-file-with-no-delimiter-c", "title": "read number occurrence from file with no delimiter c++", "body": "<p>I have a working prototype with the code being read from the file. My problem is figuring out how to read it from the file without any spaces. For my code below to work properly, the file's contents needs to look like this:\n3 4 6 2 5</p>\n\n<p>What I'm looking to put in the file is this:\n34625</p>\n\n<p>and for my output I am hoping for this:</p>\n\n<p>3 occurs 4 times<br>\n4 occurs 5 times<br>\n5 occurs 6 times<br>\n6 occurs 7 times</p>\n\n<p>I am also wondering if there is a way to print the numbers without initializing the array. In my code I have 12 as the numbers in the file. But is there a way to have \"unknown\" just in case later the user wants to add more integers to read from the file?</p>\n\n<pre><code>#include &lt;iostream&gt;     \n#include &lt;fstream&gt;\nusing namespace std;\n\n//NEEDS to read numbers WITHOUT SPACES!!\nint main()\n{\n  ifstream theFile (\"inputData.txt\");\n  int MaxRange= 9;\n  char c;\n  int myint[12]={0};\n  int mycompare[12]={0};\n  int mycount[12] = {0};\n  int i = 0, j = 0, k = 0;\n  for(j=0;j &lt;= MaxRange;j++){\n    mycompare[j] = j;\n  }\n\n  do\n  {\n    theFile&gt;&gt;myint[i];\n    for(j=0;j&lt;=MaxRange;j++)\n    {\n      if(myint[i] == mycompare[j])\n        mycount[j] = mycount[j]+1;\n    }\n    i++;\n  }\n  while((myint[i] &gt;=0) &amp;&amp; (myint[i] &lt;= MaxRange));\n\n  for(j=0; j &lt;=MaxRange; j++)\n  {\n    if(isdigit(j)) \n      ++j;\n    cout&lt;&lt; j&lt;&lt; \" occurs: \"&lt;&lt;mycount[j]&lt;&lt;endl;  \n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 3213, "user_id": 6084430, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/B0TaE.jpg?s=128&g=1", "display_name": "DimChtz", "link": "https://stackoverflow.com/users/6084430/dimchtz"}, "edited": false, "score": 0, "creation_date": 1510168309, "post_id": 47187771, "comment_id": 81324821, "body": "What did you try?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1510168371, "post_id": 47187771, "comment_id": 81324858, "body": "How could it get deleted?"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510169527, "post_id": 47187771, "comment_id": 81325584, "body": "Copy the element first."}], "answers": [{"tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 3, "last_activity_date": 1510168379, "creation_date": 1510168379, "answer_id": 47187818, "question_id": 47187771, "link": "https://stackoverflow.com/questions/47187771/remove-element-from-vector-while-storing-the-removed-element/47187818#47187818", "title": "Remove element from vector, while storing the removed element", "body": "<p>Fundamentally, the value that you want to return needs to live somewhere, so if you remove the value from the <code>vector</code> you'll need to put it somewhere. Here's one option:</p>\n\n<pre><code> /* Move the object out of the vector so that we can return it. */\n ObjectType result = std::move(myVector[myIndex]);\n\n /* Delete the value from the vector. */\n myVector.erase(myVector.begin() + myIndex); // Or equivalent\n\n return result;\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 2179936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/90cb4d256b6877529628ab69508d3525?s=128&d=identicon&r=PG", "display_name": "user2179936", "link": "https://stackoverflow.com/users/2179936/user2179936"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1510168379, "creation_date": 1510168230, "question_id": 47187771, "link": "https://stackoverflow.com/questions/47187771/remove-element-from-vector-while-storing-the-removed-element", "title": "Remove element from vector, while storing the removed element", "body": "<p>Trying to remove an element by index from a vector, while storing it to return it. How do I store the element's value in a way that is not deleted when I delete the element by index from the vector?</p>\n"}, {"tags": ["c++", "opengl", "graphics", "3d", "geometry"], "comments": [{"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 1, "creation_date": 1510171981, "post_id": 47187600, "comment_id": 81326931, "body": "I&#39;m not sure if it is possible to calculate a consistent tangent space for a general quad. In the <a href=\"http://www.letworyinteractive.com/blendercode/df/d68/mikktspace_8h_source.html\" rel=\"nofollow noreferrer\">blender source code</a> and the <a href=\"https://wiki.blender.org/index.php/Dev:Shading/Tangent_Space_Normal_Maps\" rel=\"nofollow noreferrer\">documentation</a> there is a little bit of explanation, but they are splitting quads into triangles for the calculation. The problem is, that a consistent tangent frame would have to be interpolated over the whole quad which means that it has to be continuous. But from what I understand, that&#39;s not the case."}, {"owner": {"reputation": 18062, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1510172113, "post_id": 47187600, "comment_id": 81327000, "body": "Just for completeness: Modern OpenGL does not support quads anymore. If you are not absolutely bound to an ancient version, use triangle meshes."}, {"owner": {"reputation": 1002, "user_id": 5655391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-P-RL6avfQ8Y/AAAAAAAAAAI/AAAAAAAAABI/-NvgDi6KMls/photo.jpg?sz=128", "display_name": "Paltoquet", "link": "https://stackoverflow.com/users/5655391/paltoquet"}, "edited": false, "score": 0, "creation_date": 1510176772, "post_id": 47187600, "comment_id": 81329447, "body": "i think it&#39;s the same the tbn is computed by resolving an equation using the deltaUV and deltaPos between 2 points. In the case of your quad you have 3 points availables. I would suggest to avoid picking the point in the opposite corner for non planar quads like blender seems to do."}, {"owner": {"reputation": 8580, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 0, "creation_date": 1510189132, "post_id": 47187600, "comment_id": 81333805, "body": "In openGL, quads must be coplanar: <i>The four vertices are expected to be coplanar; failure to do so can lead to undefined results.  A quad is typically rasterized as a pair of triangles. This is not defined by the GL spec, but it is allowed by it. This can lead to some artifacts due to how vertex/geometry shader outputs are interpolated over the 2 generated triangles.</i> (<a href=\"https://www.khronos.org/opengl/wiki/Primitive\" rel=\"nofollow noreferrer\">khronos.org/opengl/wiki/Primitive</a>)"}, {"owner": {"reputation": 129, "user_id": 8647757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd8bd7e051c26adc67e55756dd10ae4?s=128&d=identicon&r=PG&f=1", "display_name": "Macelaru Tiberiu", "link": "https://stackoverflow.com/users/8647757/macelaru-tiberiu"}, "edited": false, "score": 0, "creation_date": 1510247399, "post_id": 47187600, "comment_id": 81364478, "body": "I will use another 3&#39;rd mesh that is the triangulated version of the subdivision mesh, to compute good normals rather that doing imprecise calculations."}], "answers": [{"tags": [], "owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "is_accepted": true, "score": 4, "last_activity_date": 1510214140, "creation_date": 1510214140, "answer_id": 47196652, "question_id": 47187600, "link": "https://stackoverflow.com/questions/47187600/differences-in-calculating-tbn-matrix-for-triangles-versus-quads/47196652#47196652", "title": "Differences in calculating TBN matrix for triangles versus quads?", "body": "<p>Before answering your question, let me start by explaining what the tangents and bitangents that you need actually are.</p>\n\n<p>Let's forget about triangles, quads, or polygons for a minute. We just have a surface (given in whatever representation) and a parameterization in form of texture coordinates that are defined at every point on the surface. We could then define the surface as: <code>xyz = s(uv)</code>. <code>uv</code> are some 2D texture coordinates and the function <code>s</code> turns these texture coordinates into 3D world positions <code>xyz</code>. Now, the tangent is the direction in which the u-coordinate increases. I.e., it is the derivative of the 3D position with respect to the u-coordinate: <code>T = d s(uv) / du</code>. Similarly, the bitangent is the derivative with respect to the v-coordinate. The normal is a vector that is perpendicular to both of them and usually points outwards. Remember that the three vectors are usually different at every point on the surface.</p>\n\n<p>Now let's go over to discrete computer graphics where we approximate our continuous surface <code>s</code> with a polygon mesh. The problem is that there is no way to get the exact tangents and bitangents anymore. We just lost to much information in our discrete approximation. So, there are three common ways how we can approximate the tangents anyway:</p>\n\n<ol>\n<li>Store the vectors with the model (this is usually not done).</li>\n<li>Estimate the vectors at the vertices and interpolate them in the faces.</li>\n<li>Calculate the vectors for each face separately. This will give you a discontinuous tangent space, which produces artifacts when the dihedral angle between two neighboring faces is too big. Still, this is apparently what most people are doing. And it is apparently also what you want to do.</li>\n</ol>\n\n<p>Let's focus on the third method. For triangles, this is especially simple because the texture coordinates are interpolated linearly (barycentric interpolation) across the triangle. Hence, the derivatives are all constant (it's just a linear function). This is why you can calculate tangents/bitangents per triangle.</p>\n\n<p>For quads, this is not so simple. First, you must agree on a way to interpolate positions and texture coordinates from the vertices of the quad to its inside. Oftentimes, bilinear interpolation is used. However, this is not a linear interpolation, i.e. the tangents and bitangents will not be constant anymore. This will only happen in special cases (if the quad is planar and the quad in uv space is a parallelogram). In general, these assumptions do not hold and you end up with different tangents/bitangents/normals for every point on the quad.</p>\n\n<p>One way to calculate the required derivatives is by introducing an auxiliary coordinate system. Let's define a coordinate system <code>st</code>, where the first corner of the quad has coordinates <code>(0, 0)</code> and the diagonally opposite corner has <code>(1, 1)</code> (the other corners have <code>(0, 1)</code> and <code>(1, 0)</code>). These are actually our interpolation coordinates. Therefore, given an arbitrary interpolation scheme, it is relatively simple to calculate the derivatives <code>d xyz / d st</code> and <code>d uv / d st</code>. The first one will be a 3x2 matrix and the second one will be a 2x2 matrix (these matrices are called Jacobians of the interpolation). Then, given these matrices, you can calculate:</p>\n\n<pre><code>d xyz / d uv = (d xyz / d st) * (d st / d uv) = (d xyz / d st) * (d uv / d st)^-1\n</code></pre>\n\n<p>This will give you a 3x2 matrix where the first column is the tangent and the second column is the bitangent.</p>\n"}], "owner": {"reputation": 129, "user_id": 8647757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd8bd7e051c26adc67e55756dd10ae4?s=128&d=identicon&r=PG&f=1", "display_name": "Macelaru Tiberiu", "link": "https://stackoverflow.com/users/8647757/macelaru-tiberiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 2, "accepted_answer_id": 47196652, "answer_count": 1, "score": 1, "last_activity_date": 1520874803, "creation_date": 1510167551, "last_edit_date": 1520874803, "question_id": 47187600, "link": "https://stackoverflow.com/questions/47187600/differences-in-calculating-tbn-matrix-for-triangles-versus-quads", "title": "Differences in calculating TBN matrix for triangles versus quads?", "body": "<p>I am trying to calculate a normal map from subdivisions of a mesh, there are 2 meshes a UV unwrapped base mesh which contains quads and triangles and a subdivision mesh that contains only quads.</p>\n\n<p>Suppose a I have a quad with all the coordinates of the vertices both in object space and UV space (quad is not flat), the quad's face normal and a pixel with it's position in UV space.</p>\n\n<p>Can I calculate the TBN matrix for the given quad and write colors to the pixel, if so then is it different for quads?</p>\n\n<p>I ask this because I couldn't find any examples for calculating a TBN matrix for quads, only triangles ?</p>\n"}, {"tags": ["c++", "c", "gcc", "decompiling"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 11, "creation_date": 1510166837, "post_id": 47187371, "comment_id": 81323921, "body": "This is the mother of XY-problems."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1510166876, "post_id": 47187371, "comment_id": 81323940, "body": "@EugeneSh. I was very clear what the original problem is."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1510166940, "post_id": 47187371, "comment_id": 81323982, "body": "C++ without pointers is no longer C++."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 2, "creation_date": 1510167059, "post_id": 47187371, "comment_id": 81324048, "body": "Using an array and running over the end will also run somewhere in the memory, also without explicit use of pointers. C/C++ without any memory access will help..."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510167111, "post_id": 47187371, "comment_id": 81324076, "body": "@Klaus an answer of &quot;it&#39;s not possible&quot; is perfectly acceptable."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1510167251, "post_id": 47187371, "comment_id": 81324165, "body": "If the specific OBJ can do some stuff, even if you forbid this stuff from a specific language, a malicious user will find a way to craft such an OBJ by other means. It means that your system architecture is just flawed in respect to it&#39;s requirements."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1510167359, "post_id": 47187371, "comment_id": 81324244, "body": "@EugeneSh. Our average user is not going to <b>want</b> to break things. Even the array out of bounds access may be an acceptable risk give the speedups to be gained."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510167371, "post_id": 47187371, "comment_id": 81324247, "body": "As others commented and voted up the comments, you can get a feeling of how realistic your solution is. If &quot;someone&quot; can access your hardware and setup new software or execute some other stuff and you have no protecting hardware and OS, you will not be able to make your device safe."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1510167675, "post_id": 47187371, "comment_id": 81324432, "body": "Anyway. You can&#39;t remove the use of pointers from C without defeating it&#39;s completeness. And of course you can&#39;t remove it from obj, because it looks like a regular memory access. You can think of some kind of static analysis tool to analyze the compiled program and warning about dangerous constructs. It won&#39;t be easy, though."}, {"owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1510167800, "post_id": 47187371, "comment_id": 81324531, "body": "@JesperJuhl Without raw pointers it is modern C++"}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1510167801, "post_id": 47187371, "comment_id": 81324533, "body": "@EugeneSh. and that sounds like the answer I was looking for (honestly). I didn&#39;t know if this was even possible when I wrote the question."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1510167905, "post_id": 47187371, "comment_id": 81324594, "body": "If you think static analysis is the only viable method to detecting pointer- and array-based memory accesses, vote up <b>original comment of @EugeneSh.</b>: <code>Anyway. You can&#39;t remove the use of pointers from C without defeating it&#39;s completeness. And of course you can&#39;t remove it from obj, because it looks like a regular memory access. You can think of some kind of static analysis tool to analyze the compiled program and warning about dangerous constructs. It won&#39;t be easy, though.</code>"}, {"owner": {"reputation": 4646, "user_id": 168683, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6c60cfdf4426b0067801bff11e836430?s=128&d=identicon&r=PG&f=1", "display_name": "Fozi", "link": "https://stackoverflow.com/users/168683/fozi"}, "edited": false, "score": 1, "creation_date": 1510168038, "post_id": 47187371, "comment_id": 81324665, "body": "Maybe you should check out Valgrind then. (I&#39;m not using it so I won&#39;t post it as an answer.)"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510168151, "post_id": 47187371, "comment_id": 81324731, "body": "You can also use dynamic testing like valgrind, you can use emulators and simulators with &quot;simulated memory protection&quot; in debug mode. You can run your code on the target with a &quot;check and execute&quot; mechanism, decreasing the speed by 10 or more... maybe some other ideas?"}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 4646, "user_id": 168683, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6c60cfdf4426b0067801bff11e836430?s=128&d=identicon&r=PG&f=1", "display_name": "Fozi", "link": "https://stackoverflow.com/users/168683/fozi"}, "edited": false, "score": 0, "creation_date": 1510168164, "post_id": 47187371, "comment_id": 81324737, "body": "@Fozi thanks! That&#39;ll detect (at least) <code>write off the end of array</code>; I&#39;ll do some more reading."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510168294, "post_id": 47187371, "comment_id": 81324807, "body": "@Klaus at the level of embedded, even <b>reading</b> a memory-mapped register may have side-effects (like clearing it)."}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 2, "creation_date": 1510168374, "post_id": 47187371, "comment_id": 81324860, "body": "Yes, and for all that situations you can use simulators, emulators, valgrind, software mmu ( check 6 execute ) and so on. So simply do it, if you really want to use C++... valgrind must be used on a different compilation of your code on another, non embedded target.  But it should be possible to find out of bounds problems and also manipulated pointers."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "edited": false, "score": 0, "creation_date": 1510168431, "post_id": 47187371, "comment_id": 81324886, "body": "what&#39;s <code>check 6 execute</code>?"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510168656, "post_id": 47187371, "comment_id": 81325035, "body": "a minimal proxy application, which checks each single assembler instruction before &quot;really&quot; execute it. This is sometimes called software mmu. But it is an exotic solution..."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510168782, "post_id": 47187371, "comment_id": 81325108, "body": "@Klaus and it\u2019d slow things down? I\u2019d rather have something that builds, runs and checks it on the PC and then if passes, builds it for the target architecture."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510170562, "post_id": 47187371, "comment_id": 81326176, "body": "@Klaus actually the sw mmu sounds interesting; are there any standard ones I can investigate?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1510173861, "post_id": 47187371, "comment_id": 81327946, "body": "If you want memory safety, C and C++ are wrong places to look for it."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510175286, "post_id": 47187371, "comment_id": 81328762, "body": "@n.m. What other languages can run on a micro controller?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1510175631, "post_id": 47187371, "comment_id": 81328916, "body": "The C Standard allows for &quot;fat pointers&quot;, i.e. pointers that also contain provenance information so that runtime checks can ensure they never go out of bounds. I heard someone tried to enable fat pointers in gcc once but there were problems (I guess, probably due to existing code that assumes non-fatness). Also there is AddressSanitizer"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510181906, "post_id": 47187371, "comment_id": 81331711, "body": "Ada comes to mind."}, {"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510181954, "post_id": 47187371, "comment_id": 81331727, "body": "@n.m. Is it binary compatible with C? Does ADA require a runtime?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510207991, "post_id": 47187371, "comment_id": 81338981, "body": "Never used it really, but it is designed for embedded systems."}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1510172554, "creation_date": 1510172554, "answer_id": 47188951, "question_id": 47187371, "link": "https://stackoverflow.com/questions/47187371/gcc-how-to-detect-pointer-based-memory-access/47188951#47188951", "title": "gcc - how to detect pointer-based memory access", "body": "<p>There could be a way of doing what you want - as long as you protect from honest mistakes, not deliberate attempts to break things.</p>\n\n<p>First, you embrace C++ Core Guidelines and use support from the tools: <a href=\"https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-tools\" rel=\"nofollow noreferrer\">https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-tools</a></p>\n\n<p>For your purposes, it will stop your code from using raw pointers and pointer arithmetic in non-library code. Period. Core guidelines do more than that, but this is what is related to your question.</p>\n\n<p>Than, you do a simple grep on the code to make sure it is not using pointers blessed by Guidelines - this would be a case of more or less simple <code>grep</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "edited": false, "score": 0, "creation_date": 1510183214, "post_id": 47189236, "comment_id": 81332172, "body": "What&#39;s <code>IRs</code>?  (more placeholder characters)"}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1510173574, "creation_date": 1510173574, "answer_id": 47189236, "question_id": 47187371, "link": "https://stackoverflow.com/questions/47187371/gcc-how-to-detect-pointer-based-memory-access/47189236#47189236", "title": "gcc - how to detect pointer-based memory access", "body": "<p>Your best chance is a GCC plugin which looks at the frontend-generated <a href=\"https://gcc.gnu.org/onlinedocs/gccint/GENERIC.html\" rel=\"nofollow noreferrer\">GENERIC</a> or <a href=\"https://gcc.gnu.org/onlinedocs/gccint/GIMPLE.html\" rel=\"nofollow noreferrer\">GIMPLE</a> IRs and implements the policies you want. Depending on the policies and the source code you want to accept, this could be a lot of work and very difficult.</p>\n\n<p>If you want a purely syntax-based or type-based approach (simply rejecting all pointer arithmetic), Clang with its ASTs is easier to work with than GCC.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1510175744, "last_edit_date": 1510175744, "creation_date": 1510174066, "answer_id": 47189398, "question_id": 47187371, "link": "https://stackoverflow.com/questions/47187371/gcc-how-to-detect-pointer-based-memory-access/47189398#47189398", "title": "gcc - how to detect pointer-based memory access", "body": "<p>In practice, it is not reasonably possible.</p>\n\n<p>You might consider changing the compilation (e.g. with a GCC plugin, like mentioned in <a href=\"https://stackoverflow.com/a/47189236/841108\">Florian Weimer's answer</a>) to check every access to arrays, but that makes the generated code significantly slower. Your native hardware is slow enough, you don't want to make it even more slow.</p>\n\n<p>And Python is not exactly the right source language. Its dynamic typing would make its quite slow already.</p>\n\n<p>Perhaps you might consider a statically typed language, like Ocaml (combined with a JIT or AOT compilation library like <a href=\"https://gcc.gnu.org/onlinedocs/jit/\" rel=\"nofollow noreferrer\">GCCJIT</a>, etc). The type system (and its inference) increase the safety (and the speed) of the generated code, and with lot of hard work (several years, probably worth a PhD\nsince you'll need do new research) you might improve the type inference to even infer the occurrences where the array index is never out-of-bounds (and an index boundary check is not even needed).</p>\n\n<p>In most case, upgrading the hardware (to a Raspberry Pi style one, with an MMU, and probably the ability to have a real OS with some virtual memory) is probably the most pragmatic approach</p>\n\n<p>PS. Be aware of <a href=\"https://en.wikipedia.org/wiki/Rice&#39;s_theorem\" rel=\"nofollow noreferrer\">Rice's theorem</a>. Most static source analysis cannot work reliably and well (be sound and complete, in technical terms).</p>\n"}], "owner": {"reputation": 4060, "user_id": 4784683, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/baa572872b7ec1fc6c1a52d1230c4872?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/4784683/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1510175744, "creation_date": 1510166738, "last_edit_date": 1510167609, "question_id": 47187371, "link": "https://stackoverflow.com/questions/47187371/gcc-how-to-detect-pointer-based-memory-access", "title": "gcc - how to detect pointer-based memory access", "body": "<p>I'm focusing on micropython, specifically the branch <a href=\"https://github.com/micropython/micropython/tree/dynamic-native-modules\" rel=\"nofollow noreferrer\">dynamic-native-modules</a>.</p>\n\n<p>This feature will, in the future, allow you to compile a C/C++ function into a native <code>.obj</code> and package it together with a <code>.py</code> interface for a huge speed boost.</p>\n\n<p>Awesome! But the issue is that if you're using a RTOS, which <a href=\"https://electronics.stackexchange.com/a/16980\">doesn't have virtual memory</a>, then any executing native code can access any part of the  address space including peripherals, the RTOS' state etc.</p>\n\n<p>You don't want the user to be able to do something like this:</p>\n\n<pre><code>void user_func()\n{\n/* point to arbitrary memory, potentially the reset registers, flash erase . . . you get the point */\n  int * a = (int*)0x1234;  \n  *a = 0x10110000; // DESTROY!!!\n}\n</code></pre>\n\n<p>Even the following should be disallowed:</p>\n\n<pre><code>void user_func()\n{\n  int a;\n  (int*)(&amp;a-1000) = 0x10010111;\n}\n</code></pre>\n\n<p><strong>SOLUTIONS?</strong></p>\n\n<ul>\n<li>Create own version of <code>gcc</code> (for each binary format)  </li>\n<li>Decompile <code>.obj</code> files and detect use of pointers (for each binary binary format)</li>\n</ul>\n\n<p><strong>FEEDBACK TO COMMENTS</strong></p>\n\n<p>I get that it may be impossible to stop a <strong>malicious</strong> user but that's not the #1 worry. We want to stop well-meaning but accidental code. If it's not possible to stop every, single case that's <em>ok</em>.</p>\n\n<p>If we can prohibit/detect explicit pointer accesses and simply provide warnings regarding array use, that is still very valuable.</p>\n\n<blockquote>\n  <p><strong>WARNING</strong>: YOU'RE USING AN ARRAY! MAKE SURE YOU DON'T GO OUT-OF-BOUNDS</p>\n</blockquote>\n"}, {"tags": ["c++", "arrays", "loops", "matrix", "zero"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 8627225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXKhO.jpg?s=128&g=1", "display_name": "Tasneem ZH", "link": "https://stackoverflow.com/users/8627225/tasneem-zh"}, "edited": false, "score": 0, "creation_date": 1510169461, "post_id": 47188017, "comment_id": 81325532, "body": "Thanks for your efforts. It appears to be more complex than I thought, that I need some time to analyze it before trying it. Thanks again."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1510169838, "post_id": 47188017, "comment_id": 81325774, "body": "I&#39;m assuming <code>K</code> and <code>MOD</code> are constants and <code>intt</code> is an alias defined elsewhere.  Recommend adding some explanation of your method because at the moment you&#39;ve got a code-only answer, and those are only truly useful to <a href=\"https://en.wikipedia.org/wiki/Cargo_cult_programming\" rel=\"nofollow noreferrer\">Cargo Cult Programmers</a> unless the code is blisteringly simple or self-documenting (which this isn&#39;t)."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 2, "creation_date": 1510171019, "post_id": 47188017, "comment_id": 81326402, "body": "<code>matrix operator * (matrix b)</code> should most likely be <code>matrix operator * (const matrix&amp; b)</code>, so you won&#39;t make an un-necessary copy."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1510173478, "post_id": 47188017, "comment_id": 81327728, "body": "@vsoftco I&#39;d also avoid returning a matrix by copy both in the multiplication and in the pow recursion. If there were the possibility of move semantics, things would be different, but as it is the number of copies would explode."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1510174428, "post_id": 47188017, "comment_id": 81328266, "body": "@BarishNamazov The idea of doing the even case by splitting in two the power is very nice."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 2, "creation_date": 1510176539, "post_id": 47188017, "comment_id": 81329321, "body": "@CostantinoGrana That&#39;s the &quot;square-and-multiply&quot; algorithm, it&#39;s very useful as it computes the power in O(log n) steps, <a href=\"https://en.wikipedia.org/wiki/Exponentiation_by_squaring\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Exponentiation_by_squaring</a> And yes you&#39;re right, the code can definitely be further optimized."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "reply_to_user": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1510176818, "post_id": 47188017, "comment_id": 81329475, "body": "@vsoftco Thank you for the link. I totally ignored both the strategy and its name. Even if I used something similar by factorizing higher powers reusing  lower ones. This is definitely smarter."}, {"owner": {"reputation": 92, "user_id": 5616061, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226907510754579/picture?type=large", "display_name": "Barish Namazov", "link": "https://stackoverflow.com/users/5616061/barish-namazov"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510237276, "post_id": 47188017, "comment_id": 81356924, "body": "@user4581301 for convenience, intt is defined long long and you can set K to any integer you want, K will be size of matrix. I don&#39;t think one who reads my code will not understand what does intt mean, or K. Anyway, in post put his code for multiplication it means s/he knows what is matrix, and the power function uses well known squaring exponentiation, which can is easy to understand. Thanks."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510243225, "post_id": 47188017, "comment_id": 81361447, "body": "&quot;the power function uses well known squaring exponentiation&quot; Add this to the answer, because in order to make this leap from the code, the reader must already know Square and Multiply. If they already knew, they likely would not have asked this question."}], "tags": [], "owner": {"reputation": 92, "user_id": 5616061, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226907510754579/picture?type=large", "display_name": "Barish Namazov", "link": "https://stackoverflow.com/users/5616061/barish-namazov"}, "is_accepted": true, "score": 3, "last_activity_date": 1510169525, "last_edit_date": 1510169525, "creation_date": 1510169013, "answer_id": 47188017, "question_id": 47187265, "link": "https://stackoverflow.com/questions/47187265/how-to-raise-a-zero-one-matrix-to-any-power-in-c/47188017#47188017", "title": "How to raise a zero-one matrix to any power in C++?", "body": "<p>Here is my implementation for matrix exponentiation:</p>\n\n<pre><code>struct matrix {\n    intt m[K][K];\n    matrix() {\n        memset (m, 0, sizeof (m));\n    }\n    matrix operator * (matrix b) {\n        matrix c = matrix();\n        for (intt i = 0; i &lt; K; i++) {\n            for (intt k = 0; k &lt; K; k++) {\n                for (intt j = 0; j &lt; K; j++) {\n                    c.m[i][j] = (c.m[i][j] + m[i][k] * b.m[k][j]) % MOD;\n                }\n            }\n        }\n        return c;\n    }\n    matrix pow (intt n) {\n        if (n &lt;= 0) {\n            return matrix();\n        }\n        if (n == 1) {\n            return *this;\n        }\n        if (n % 2 == 1) {\n            return (*this) * pow (n - 1);\n        } else {\n            matrix X = pow (n / 2);\n            return X * X;\n        }\n    }\n};\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 8627225, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXKhO.jpg?s=128&g=1", "display_name": "Tasneem ZH", "link": "https://stackoverflow.com/users/8627225/tasneem-zh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 47188017, "answer_count": 1, "score": 2, "last_activity_date": 1510169525, "creation_date": 1510166361, "question_id": 47187265, "link": "https://stackoverflow.com/questions/47187265/how-to-raise-a-zero-one-matrix-to-any-power-in-c", "title": "How to raise a zero-one matrix to any power in C++?", "body": "<p>I made a zero-one matrix with power 2. However, I want the code to be applied to any power the user enters. I tried several times, but it didn't work.</p>\n\n<p>Here's a part of the code that would concern you.</p>\n\n<p>Notes: Suppose the user has entered his (n*m) matrix which is \"a\", as n and m are equals and they are denoted by s. </p>\n\n<pre><code>k=0;\nfor(int j=0; j&lt;s; j++)\n    for(int i=0; i&lt;s; i++)\n    {\n        m[k]=0;\n\n        for(int t=0; t&lt;s; t++)\n        m[k]+=a[j][t]*a[t][i];\n\n        k++;\n    }\n</code></pre>\n"}, {"tags": ["c++", "struct", "stack"], "comments": [{"owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "edited": false, "score": 0, "creation_date": 1510166811, "post_id": 47187225, "comment_id": 81323900, "body": "Thanks for pointing that out but I didn&#39;t use that code as it wasn&#39;t compiling. But I still need to replace the value in the pop function so as to delete the value (-1 is assumed as deleted)."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167059, "post_id": 47187225, "comment_id": 81324047, "body": "Your code in the first example compile and runs fine (and correctly) for me. Expand on &quot;I still do not seem to get the concept right&quot;."}, {"owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167295, "post_id": 47187225, "comment_id": 81324202, "body": "On second note, my original pop function is correct. ci is originally pointing to an empty index to enter data."}, {"owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167432, "post_id": 47187225, "comment_id": 81324286, "body": "Regarding the concept, the functions written in the struct, do they run when I declare a struct type variable? If so then the first code should not work."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167486, "post_id": 47187225, "comment_id": 81324319, "body": "No - the functions in the struct will only run when you explicitly call them - see my answer."}, {"owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167726, "post_id": 47187225, "comment_id": 81324462, "body": "Sorry, the code did compile successfully (I was confusing this one with its another variation) but it did not give correct answers. It runs fine until the push() call in while() in the first iteration, and then stops responding prompting an error."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167784, "post_id": 47187225, "comment_id": 81324519, "body": "Edit your answer to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510167994, "post_id": 47187225, "comment_id": 81324644, "body": "while (inp != 0) {     int rem = inp % 2;     cout &lt;&lt; &quot;rem= &quot; &lt;&lt; rem &lt;&lt; endl;     inp /= 2;     cout &lt;&lt; &quot;inp= &quot; &lt;&lt; inp &lt;&lt; endl;     var.push(rem);//The code stops working here     count++; }"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510168061, "post_id": 47187225, "comment_id": 81324685, "body": "The <i>example</i> was the relevant part. What input did you provide that caused your program to fail?"}, {"owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510168164, "post_id": 47187225, "comment_id": 81324736, "body": "I entered 5 as an input. The code runs until the above mentioned line, after that visual studio gives error: lab4.exe has stopped working."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1510168359, "post_id": 47187225, "comment_id": 81324850, "body": "This isn&#39;t reproducible on my machine or on an <a href=\"https://ideone.com/DIFbSP\" rel=\"nofollow noreferrer\">online service</a>. Regardless, this is all off-topic from the actual question stated."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1510169971, "post_id": 47187225, "comment_id": 81325852, "body": "Your push and pop function should check that they do not go out of bounds."}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 0, "last_activity_date": 1510170921, "last_edit_date": 1510170921, "creation_date": 1510166695, "answer_id": 47187362, "question_id": 47187225, "link": "https://stackoverflow.com/questions/47187225/converting-decimal-number-to-binary-number-using-stack/47187362#47187362", "title": "Converting Decimal Number to Binary Number using stack", "body": "<p>When you first create an object from a <code>struct</code> or <code>class</code>, the <a href=\"http://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\"><strong>constructor</strong></a> runs - but no other function (so not your <code>init</code> function). If you want that to run, you need to call it explicitly:</p>\n\n<pre><code>bin var;\nvar.init();\n</code></pre>\n\n<p>In terms of the implementation of your functions: you should use bounds-checking to ensure that you don't push more items than you can handle, or pop more than are in the queue. Besides that I can't see much wrong with them. Consider using a <code>std::vector</code> instead of an array, but as you're just starting to learn about C++, you'll likely cover that later in your course.</p>\n\n<hr>\n\n<p>By the time you're adding constructors to a <code>struct</code> though, you may as well switch to using a <code>class</code>. In C++, structs and classes are equivalent (with the minor tweak that the default access modifier in a struct is <code>public</code>, whereas in classes it's <code>private</code>), so don't let that put you off. </p>\n"}], "owner": {"reputation": 1, "user_id": 8908850, "user_type": "registered", "profile_image": "https://graph.facebook.com/1552256098188022/picture?type=large", "display_name": "HamXa Nisar", "link": "https://stackoverflow.com/users/8908850/hamxa-nisar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 734, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510170921, "creation_date": 1510166223, "last_edit_date": 1510170841, "question_id": 47187225, "link": "https://stackoverflow.com/questions/47187225/converting-decimal-number-to-binary-number-using-stack", "title": "Converting Decimal Number to Binary Number using stack", "body": "<p>I am trying to convert a decimal number to binary number using stacks and I have to use structs.</p>\n\n<p>Now from my understanding of structs, we can have member functions in them. And stack follows a LIFO strategy.</p>\n\n<p>We can create a stack by making a struct, declaring some members, and have some functions to initialize and work on these members. </p>\n\n<p>So, I tried declaring a struct with above mentioned things and my understanding, but I still do not seem to get the concept right. I believe it is an error on my part. But reading forums still does not help as we have not been taught classes yet and on every forum, structs and classes are intermixed.</p>\n\n<p>Here is my code so far, any help and guidance regarding the concept and logic would be much appreciated.</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nstruct bin{\nint num[15];\nint ci;\n\nvoid init()\n{\n    ci = 0;\n    for (int i = 0;i &lt; 15;i++)\n        num[i] = -1;\n}\n\nvoid push(int n)\n{\n    num[ci] = n;\n    ci++;\n}\nint pop()\n{\n    int temp = num[--ci];\n    num[ci] = -1;\n    return temp;\n}\n};\n\nint main()\n{\nint inp, count = 0;\nbin var;\ncout &lt;&lt; \"Enter a decimal number to convert into binary: \";\ncin &gt;&gt; inp;\n\nwhile (inp != 0)\n{\n    int rem = inp % 2;\n    cout &lt;&lt; \"rem= \" &lt;&lt; rem &lt;&lt; endl;\n    inp /= 2;\n    cout &lt;&lt; \"inp= \" &lt;&lt; inp &lt;&lt; endl;\n    var.push(rem);\n    count++;\n}\ncout &lt;&lt; \"\\nYour binary is: \";\nwhile (count != 0)\n{\n    cout &lt;&lt; var.pop();\n    count--;\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>I tried my best to find the mistakes but couldn't. So,in the end I simply used arrays and implemented the code as follows</p>\n\n<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n\nvoid push(int bin[], int n, int &amp;ci);\nvoid init(int bin[], int &amp;count, int &amp;ci);\nint pop(int bin[], int &amp;ci);\nvoid display(int bin[], int &amp;count, int &amp;ci);\nvoid findBinary(int bin[], int &amp;count, int&amp;ci, int &amp;inp);\n\nint main()\n{\nint inp, count, ci;\nint bin[20];\nchar c = '\\0';\n\ninit(bin,count,ci);\n\n    cout &lt;&lt; \"Enter a decimal number to convert into binary: \";\n    cin &gt;&gt; inp;\n\n    findBinary(bin, count, ci, inp);\n    display(bin, count, ci);\n\nreturn 0;\n}\n\nvoid init(int bin[], int &amp;count, int &amp;ci)\n{\ncount = 0;\nci = 0;\n\nfor (int i = 0;i &lt; 20;i++)\n    bin[i] = -1;\n}\n\nint pop(int bin[], int &amp;ci)\n{\n    int temp = bin[--ci];\n    return temp;\n}\n\nvoid push(int bin[], int n, int &amp;ci)\n{\n    bin[ci] = n;\n    ci++;\n}\n\nvoid display(int bin[], int &amp;count, int &amp;ci)\n{\n    cout &lt;&lt; \"\\nYour binary is: \";\n    while (count != 0)\n    {\n        cout &lt;&lt; pop(bin, ci);\n        count--;\n    }\n    cout &lt;&lt; endl;\n}\n\nvoid findBinary(int bin[], int &amp;count, int&amp;ci, int &amp;inp)\n{\n    while (inp != 0)\n    {\n        int rem = inp % 2;\n        inp /= 2;\n        push(bin, rem, ci);\n        count++;\n    }\n}\n</code></pre>\n\n<p>So my questions are:\n 1. When we write a function within a struct, does the function runs when we create a struct type object?\n 2. Is the method I used to implement stack using struct in the first example correct?</p>\n"}, {"tags": ["c++", "algorithm", "performance", "hamming-numbers", "smooth-numbers"], "comments": [{"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 2, "creation_date": 1510166909, "post_id": 47187188, "comment_id": 81323968, "body": "If you have a known requirement of 0 to 9999, you could simply have a lookup table (O(1))"}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "reply_to_user": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1510167250, "post_id": 47187188, "comment_id": 81324163, "body": "@mnistic: could you clarify how I would go about that exactly ?"}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1510167341, "post_id": 47187188, "comment_id": 81324232, "body": "Precompute all the numbers and sort them in a table -- a one time deal. Are you allowed to do that?"}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "reply_to_user": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1510167475, "post_id": 47187188, "comment_id": 81324311, "body": "Well, the course is about algorithms. Plus I&#39;d never been introduced to lookup tables, but that&#39;s on me."}, {"owner": {"reputation": 841, "user_id": 275780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9fda69904fe03f3c3937634042e4ef6?s=128&d=identicon&r=PG", "display_name": "xyious", "link": "https://stackoverflow.com/users/275780/xyious"}, "edited": false, "score": 1, "creation_date": 1510168328, "post_id": 47187188, "comment_id": 81324830, "body": "Your program is wrong anyway (or doesn&#39;t match your question). You said you wanted the nth vivaldi&#39;s number, but you only check up to n. which means you don&#39;t ever get the nth number, you just get the number of vivaldi&#39;s numbers betwen 0 and n."}, {"owner": {"reputation": 841, "user_id": 275780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9fda69904fe03f3c3937634042e4ef6?s=128&d=identicon&r=PG", "display_name": "xyious", "link": "https://stackoverflow.com/users/275780/xyious"}, "edited": false, "score": 0, "creation_date": 1510168593, "post_id": 47187188, "comment_id": 81324993, "body": "You could change %2 to ` &amp; 1 == 0` : ` while (d &amp; 1 == 0) d = d &gt;&gt; 1;` and see if that has an impact."}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "reply_to_user": {"reputation": 841, "user_id": 275780, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9fda69904fe03f3c3937634042e4ef6?s=128&d=identicon&r=PG", "display_name": "xyious", "link": "https://stackoverflow.com/users/275780/xyious"}, "edited": false, "score": 0, "creation_date": 1510168918, "post_id": 47187188, "comment_id": 81325189, "body": "@xyious: forgot to mention, but enumeration starts from 0"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510172621, "post_id": 47187188, "comment_id": 81327291, "body": "I&#39;ve never heard of a Vivaldi number before, are you able to point me to another resource to learn about them?"}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510172685, "post_id": 47187188, "comment_id": 81327326, "body": "@AndyG: I don&#39;t think they&#39;re real. I guess they were called like that out of fun"}, {"owner": {"reputation": 441, "user_id": 789999, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gQxPzbrWxCY/AAAAAAAAAAI/AAAAAAAAAT8/VUGhtzwATDw/photo.jpg?sz=128", "display_name": "Victor", "link": "https://stackoverflow.com/users/789999/victor"}, "edited": false, "score": 1, "creation_date": 1510173207, "post_id": 47187188, "comment_id": 81327583, "body": "Maybe, if you started with the formula, and proceeded with a method to put increasing variables a,b, and c in a certain order, that would give subsequent product numbers, you wouldn&#39;t have to have a ton of division operations on each Vivaldi and each in-between number."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1510173788, "post_id": 47187188, "comment_id": 81327912, "body": "So I&#39;ve done some more research and it appears that what you&#39;re trying to compute are called <a href=\"https://en.wikipedia.org/wiki/Regular_number\" rel=\"nofollow noreferrer\">hamming numbers</a>, of which a lot of intense research has been done. There is an abundance of code out there, too."}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1510174099, "post_id": 47187188, "comment_id": 81328083, "body": "For example, this question is nearly identical to yours: <a href=\"https://stackoverflow.com/q/29286845/27678\">stackoverflow.com/q/29286845/27678</a>"}, {"owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1510174202, "post_id": 47187188, "comment_id": 81328149, "body": "@AndyG: yeah, just found about it 30 seconds ago. Eh I guess this one can be closed as a duplicate. Thank you Andy"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1510174223, "post_id": 47187188, "comment_id": 81328160, "body": "Lots of related StackOverflow questions <a href=\"https://stackoverflow.com/q/10126285/27678\">stackoverflow.com/q/10126285/27678</a>, and <a href=\"https://stackoverflow.com/q/37199032/27678\">stackoverflow.com/q/37199032/27678</a>"}, {"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "edited": false, "score": 0, "creation_date": 1580760305, "post_id": 47187188, "comment_id": 106196123, "body": "You don&#39;t need any of those <code>while</code> loops in <code>vivaldi()</code> ..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "edited": false, "score": 0, "creation_date": 1580805554, "post_id": 47187188, "comment_id": 106208816, "body": "@MikeRobinson <a href=\"https://stackoverflow.com/questions/4600048/nth-ugly-number/4600082#comment106193889_4600082\">yes, but...</a>."}], "owner": {"reputation": 389, "user_id": 4509491, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0859ed4716e7342be98b7792250caa78?s=128&d=identicon&r=PG&f=1", "display_name": "monolith937", "link": "https://stackoverflow.com/users/4509491/monolith937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "closed_date": 1510174261, "answer_count": 0, "score": 4, "last_activity_date": 1580805475, "creation_date": 1510166075, "last_edit_date": 1580805475, "question_id": 47187188, "link": "https://stackoverflow.com/questions/47187188/vivaldis-number", "closed_reason": "Duplicate", "title": "Vivaldi&#39;s number", "body": "<p>A Vivaldi's number is a number that can be factored by only 2, 3 and 5 ( <code>V = 2^a * 3^b * 5^c, a, b, c = 0,1,...</code>; also known as <a href=\"http://en.wikipedia.org/wiki/Regular_number\" rel=\"nofollow noreferrer\">Hamming number</a>). The task is to find the Nth Vivaldi number. </p>\n\n<p>The algorithm isn't too bad for small inputs, but N ranges from 0 to 9999. It took 2 minutes at 2000. I wrote the code with a pretty simple algorithm, but I'm curious (hopeful) to find another way. I tried to tackle this problem mathematically with logarithms but ended up nowhere. Is an efficient way even possible when it comes to large inputs?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n\n\nbool vivaldi(unsigned long long d) {\n\n    while (d%2 == 0)\n        d = d/2;\n\n    while (d%3 == 0)\n        d = d/3;\n\n    while (d%5 == 0)\n        d = d/5;\n\n\n    if (d == 1)\n        return true;\n\n    return false;\n}\n\n\n\nint main() {\n\n    int count = 0, N;\n    unsigned long long number = 0;\n\n    std::cin &gt;&gt; N;\n\n    std::clock_t begin = clock();\n\n    if (N &lt; 0 || N &gt; 9999) {\n        std::fprintf(stderr, \"Bad input\\n\");\n        std::exit(EXIT_FAILURE);\n    }\n\n    while (count &lt;= N) {\n\n        number++;\n        if (vivaldi(number))\n            count++;\n\n    }\n\n    std::cout &lt;&lt; number &lt;&lt; std::endl;\n    std::clock_t end = clock();\n    double elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;\n    std::cout &lt;&lt; \"TIME: \" &lt;&lt; elapsed_secs &lt;&lt; std::endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "aix", "static-initialization", "xlc", "static-order-fiasco"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1510166190, "post_id": 47187170, "comment_id": 81323556, "body": "Sounds like something that you should be able to find an answer to by digging through the xlc documentation. Have you tried searching that? Or maybe contact IBM support with your question.."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1510166370, "post_id": 47187170, "comment_id": 81323659, "body": "@JesperJuhl - <i>&quot;Have you tried searching tho [xlc docs]&quot;</i> - Yes, I&#39;ve been through both the AIX and Linux manuals, but I have not located it. I&#39;m wondering if it goes by a different name, or if I assumed it was available when its not. The Linux xlC compiler seems seems like it should have it."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1510170562, "post_id": 47187170, "comment_id": 81326175, "body": "Can you move the initializations to one file and put them in the order that you want? (using appropriate namespace statements, etc.)"}], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 7710354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f2611c4267a7cbd227e43d6c522160d?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Trudeau", "link": "https://stackoverflow.com/users/7710354/nicole-trudeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1510343645, "last_edit_date": 1510343645, "creation_date": 1510287277, "answer_id": 47215582, "question_id": 47187170, "link": "https://stackoverflow.com/questions/47187170/does-ibm-xl-c-c-provide-an-init-priority/47215582#47215582", "title": "Does IBM XL C/C++ provide an init_priority?", "body": "<p>IBM XL C/C++ for Linux V13.1.1 and up does offer a way to control initialization priorities, please see the <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSXVZZ_13.1.5/com.ibm.xlcpp1315.lelinux.doc/language_ref/var_attrib_init_priority.html\" rel=\"nofollow noreferrer\">Knowledge Center</a> for more details about how to control it via the <code>init_priority</code> variable attribute, similar to GCC, which assigns static initialization priorities at the object level. </p>\n\n<p>IBM XL C/C++ for AIX does not support <code>init_priority</code> but it does offer a way to control the order of initialization of global variables between .o files within the same link unit with <code>-qpriority</code> and <code>#pragma priority</code>. Details about those options can be found on <a href=\"https://www.ibm.com/support/knowledgecenter/SSGH3R_13.1.3/com.ibm.xlcpp1313.aix.doc/compiler_ref/opt_priority.html\" rel=\"nofollow noreferrer\">Knowledge Center</a>. In addition, <code>-qmkshrobj=priority</code> (<a href=\"https://www.ibm.com/support/knowledgecenter/SSGH3R_13.1.3/com.ibm.xlcpp1313.aix.doc/compiler_ref/opt_mkshrobj.html\" rel=\"nofollow noreferrer\">Knowledge Center</a>) controls the order of initialization of shared objects (and a.out) at program start up (XL AIX uses this method, whereas XL Linux uses dependency to determine shared object initialization order). The order within a translation unit has to be in declarative order otherwise you can get initialization referencing a variable that hasn't been initialized yet.</p>\n"}], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 47215582, "answer_count": 1, "score": 2, "last_activity_date": 1510343645, "creation_date": 1510165998, "question_id": 47187170, "link": "https://stackoverflow.com/questions/47187170/does-ibm-xl-c-c-provide-an-init-priority", "title": "Does IBM XL C/C++ provide an init_priority?", "body": "<p>We use C++ static initialization order to control the construction of several objects in a C++ library. GCC offers <a href=\"https://stackoverflow.com/q/3371968/608639\"><code>init_priority</code></a>, and Microsoft offers <a href=\"https://stackoverflow.com/q/32085048/608639\"><code>init_seg()</code></a>.</p>\n\n<p>I'm looking for similar with IBM's XL C/C++ compiler, but my search results are not revealing useful hits. The compiler runs on both Linux and AIX. Obviously Linux offers the feature, but I am not sure about AIX runtime support.</p>\n\n<p>My first question is, does the AIX platform support initialization priorities?</p>\n\n<p>My second question is, does IBM's XL C/C++ offer a way to control it via the source code?</p>\n"}, {"tags": ["c++", "time"], "comments": [{"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 1, "creation_date": 1510165482, "post_id": 47186951, "comment_id": 81323172, "body": "&quot;There should be a bus every 5 minutes, but when I come to bus stop I often have to wait less than expected 5 minutes. I get a lot of 1 and 2 minute delays before bus arrives&quot;"}, {"owner": {"reputation": 795, "user_id": 6181350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-cJ_XwGEWMs0/AAAAAAAAAAI/AAAAAAAAAJQ/CZfcSOhCshM/photo.jpg?sz=128", "display_name": "jakedipity", "link": "https://stackoverflow.com/users/6181350/jakedipity"}, "edited": false, "score": 0, "creation_date": 1510165557, "post_id": 47186951, "comment_id": 81323204, "body": "Does <code>this-&gt;camera.readFrame()</code> block until a new frame is fetched?"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7074459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37dd9f28e64219e93ef18ac6cfe0c95?s=128&d=identicon&r=PG&f=1", "display_name": "Trabool", "link": "https://stackoverflow.com/users/7074459/trabool"}, "edited": false, "score": 0, "creation_date": 1510172614, "post_id": 47187865, "comment_id": 81327286, "body": "Thanks for your answer. What I am currently measuring is the time for reading a frame right? When I speak of frames per second, I thought that was the number of times that you could read a frame during one second. So maybe I didn&#39;t really understand the concept of fps... But yes I know that the whole processing is more than 12 ms."}, {"owner": {"reputation": 2849, "user_id": 6496264, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4GXZ7-7uHNc/AAAAAAAAAAI/AAAAAAAAAFM/ax4-x7Z13Ew/photo.jpg?sz=128", "display_name": "Sami Hult", "link": "https://stackoverflow.com/users/6496264/sami-hult"}, "reply_to_user": {"reputation": 119, "user_id": 7074459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37dd9f28e64219e93ef18ac6cfe0c95?s=128&d=identicon&r=PG&f=1", "display_name": "Trabool", "link": "https://stackoverflow.com/users/7074459/trabool"}, "edited": false, "score": 0, "creation_date": 1510175284, "post_id": 47187865, "comment_id": 81328757, "body": "If you are reading the camera faster than 30 FPS, you will (depending on your software and hardware) get the same image multiple times. The reading of the frame is not supposed to last full frame&#39;s time. When it comes to cameras, they will be set up to build a image to transmit each 1/fps second. To be in sync with that, you need to consult documentation for the library you are using, but in it&#39;s simplest form, you just read in an image at same rate."}], "tags": [], "owner": {"reputation": 2849, "user_id": 6496264, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4GXZ7-7uHNc/AAAAAAAAAAI/AAAAAAAAAFM/ax4-x7Z13Ew/photo.jpg?sz=128", "display_name": "Sami Hult", "link": "https://stackoverflow.com/users/6496264/sami-hult"}, "is_accepted": false, "score": 2, "last_activity_date": 1510175468, "last_edit_date": 1510175468, "creation_date": 1510168528, "answer_id": 47187865, "question_id": 47186951, "link": "https://stackoverflow.com/questions/47186951/measured-fps-is-higher-than-theoretical-one/47187865#47187865", "title": "Measured fps is higher than theoretical one", "body": "<p>As @Revolver_Ocelot remarked, you are measuring time spent from the end of <code>get_wall_time</code> to the end of another similar call. To fix your code, do this:</p>\n\n<pre><code>double currenttime = get_wall_time();    \nwhile (true) {\n    double previoustime = currenttime;\n    this-&gt;camera.readFrame();\n    ... \n    currentime = get_wall_time();\n}\n</code></pre>\n\n<p>Can you spot the difference? This code measures the interval between each pass, which is what you want to get frames per second.</p>\n\n<p>The speed at which you can read your camera will not be the same as the rate at which it will complete a new frame. Your camera could be recording at 30 FPS and you could be reading it at 15 FPS or 90 FPS, thus subsampling or oversampling the frame stream.</p>\n\n<p>The limit at which you can oversample is 1 / time that it takes to read in an image and store it.</p>\n\n<p>That's what @Jacob Hull meant with blocking; if <code>readFrame</code> just reads the last frame, it's not blocking until a new frame and you will get the results like you do with your measurement.</p>\n"}], "owner": {"reputation": 119, "user_id": 7074459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37dd9f28e64219e93ef18ac6cfe0c95?s=128&d=identicon&r=PG&f=1", "display_name": "Trabool", "link": "https://stackoverflow.com/users/7074459/trabool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1510175468, "creation_date": 1510165124, "question_id": 47186951, "link": "https://stackoverflow.com/questions/47186951/measured-fps-is-higher-than-theoretical-one", "title": "Measured fps is higher than theoretical one", "body": "<p>I'm measuring execution time for several functions in an image processing program in C++. In particular, I want to have the actual execution time for capturing a frame with my USB camera.</p>\n\n<p>The problem is that the results don't seem consistent with the camera parameters: the camera is supposed to be 30 fps at most, and I often get a measured time that is less than 33 ms for getting a frame, which is the value I think should be expected. For instance, I get a lot of 12 ms intervals and that really seems too little.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;time.h&gt;\n#include &lt;sys/time.h&gt;\n\ndouble get_wall_time(){\n    struct timeval time;\n    if (gettimeofday(&amp;time,NULL)){\n        //  Handle error\n        return 0;\n    }\n    return (double)time.tv_sec + (double)time.tv_usec * .000001;\n}\n\nint main(){\n    while (true) {\n      double previoustime = get_wall_time();\n      this-&gt;camera.readFrame();\n      double currenttime = get_wall_time();\n      std::cout &lt;&lt; currenttime-previoustime &lt;&lt; std::endl;\n      // Other stuff\n      // ...\n      // ...\n      usleep(3000);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "openssl", "md5"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1510165307, "post_id": 47186936, "comment_id": 81323052, "body": "Post compilable code."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1510165339, "post_id": 47186936, "comment_id": 81323077, "body": "I am willing to be that the problem lies with the use of <code>(unsigned char*)&amp;cipher</code> in the call to <code>MD5</code>.. I would suggest changing it to just <code>cipher</code>"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1510165406, "post_id": 47186936, "comment_id": 81323117, "body": "@RSahu: It&#39;s already an <code>unsigned char*</code>, so the cast isn&#39;t even necessary."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510165429, "post_id": 47186936, "comment_id": 81323139, "body": "@ChristianHackl, noticed that after seeing your answer."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 1, "creation_date": 1510165540, "post_id": 47186936, "comment_id": 81323198, "body": "By the way, there&#39;s little C++ in your code. In C++, you are supposed to use <code>std::string</code> and interface with C functions via functions like <code>c_str()</code>. And you could use <code>std::cout</code> instead of <code>printf</code>, and <code>nullptr</code> instead of <code>NULL</code>, and <code>std::ifstream</code> instead of <code>fopen</code>. In fact, your code looks like C, not C++."}], "answers": [{"tags": [], "owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "is_accepted": false, "score": 4, "last_activity_date": 1510165352, "creation_date": 1510165352, "answer_id": 47187006, "question_id": 47186936, "link": "https://stackoverflow.com/questions/47186936/why-my-md5-is-always-different-if-i-launch-program-a-few-times/47187006#47187006", "title": "Why my md5 is always different if I launch program a few times?", "body": "<p>A lot of ugly casting going on here, but it looks like the problem is that you take the address of the local pointer object <code>cipher</code> instead of using what it's pointing at. Using <code>cipher</code> instead of <code>(unsigned char*)&amp;cipher</code> should fix that.</p>\n"}], "owner": {"reputation": 21, "user_id": 8851743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766305f638e784308dfe7a47fb41f6d0?s=128&d=identicon&r=PG&f=1", "display_name": "VFcdxcv", "link": "https://stackoverflow.com/users/8851743/vfcdxcv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510165352, "creation_date": 1510165095, "question_id": 47186936, "link": "https://stackoverflow.com/questions/47186936/why-my-md5-is-always-different-if-i-launch-program-a-few-times", "title": "Why my md5 is always different if I launch program a few times?", "body": "<p>I have a program that encrypt string and compute md5, but if I launch program a few times it prints different results. My program read key from the same file.</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n    FILE* f;\n    f = fopen(argv[1], \"r\");\n    RSA *private_key  =  PEM_read_RSAPrivateKey(f, NULL, NULL, NULL);\n\n    unsigned char sourceText[] = \"source_string\";\n    unsigned char *cipher =(unsigned char*) OPENSSL_malloc(RSA_size(private_key));\n\n    int ret = RSA_private_encrypt(strlen((char*)text), text, cipher, private_key, RSA_PKCS1_PADDING);\n\n    unsigned char md5Result[MD5_DIGEST_LENGTH];\n    MD5((unsigned char*)&amp;cipher, strlen((char*) cipher), (unsigned char*)&amp;md5Result);\n    printf(\"md5  %s \\n\", BN_bn2hex(BN_bin2bn(md5Result, MD5_DIGEST_LENGTH, NULL)));\n    return 0;\n}\n</code></pre>\n\n<p>What is wrong with my code ? </p>\n"}, {"tags": ["c++", "matrix", "memory", "dynamic"], "comments": [{"owner": {"reputation": 3280, "user_id": 3493289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08927897947ad3bae66cf2d02f587ffc?s=128&d=identicon&r=PG&f=1", "display_name": "MS Srikkanth", "link": "https://stackoverflow.com/users/3493289/ms-srikkanth"}, "edited": false, "score": 0, "creation_date": 1510165809, "post_id": 47186898, "comment_id": 81323342, "body": "You are mixing dynamically allocated arrays with static arrays. There is no information available to the compiler to suggest that MB is an array. As far as it is concerned it is just a double**. So u shud change notindic to accept a double** parameter."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4622479, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--rwnuTjYkGY/AAAAAAAAAAI/AAAAAAAAALQ/uUOMECZAggo/photo.jpg?sz=128", "display_name": "senior-zero", "link": "https://stackoverflow.com/users/4622479/senior-zero"}, "is_accepted": false, "score": 0, "last_activity_date": 1510170363, "creation_date": 1510170363, "answer_id": 47188404, "question_id": 47186898, "link": "https://stackoverflow.com/questions/47186898/how-to-call-a-dynamic-matrix-into-a-function/47188404#47188404", "title": "How to call a dynamic matrix into a function?", "body": "<p>Just pass array pointer as parameter </p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\nconst int NX = 65;\nconst int NY = 2;\n\nbool notindic(double** MB) {\n        for(int i = 0; i &lt; NX; ++i) {\n                for(int j = 0; j &lt; NY; ++j) {\n                        MB[i][j] = i + j;\n                }\n        }\n}\n\nint main() {\n        double **MB = new double *[650000];\n        for (int count = 0; count &lt; 650000; count++) {\n                MB[count] = new double [2];\n        }\n\n        notindic(MB);\n\n        for(int i = 0; i &lt; NX; ++i) {\n                for(int j = 0; j &lt; NY; ++j) {\n                        std::cout &lt;&lt; MB[i][j] &lt;&lt; \" \";\n                }\n                std::cout &lt;&lt; std::endl;\n        }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "is_accepted": false, "score": 0, "last_activity_date": 1510170697, "creation_date": 1510170697, "answer_id": 47188487, "question_id": 47186898, "link": "https://stackoverflow.com/questions/47186898/how-to-call-a-dynamic-matrix-into-a-function/47188487#47188487", "title": "How to call a dynamic matrix into a function?", "body": "<p>Forget about all that pointer nonsense. It's error-prone, exception-unsafe, hard to write, hard to read, hard to maintain and may perform poorly. Represent your matrix as <code>std::vector&lt;double&gt;</code> and calculate the offsets accordingly.</p>\n\n<pre><code>bool notindic (std::vector&lt;double&gt; const&amp; matrix, int m) {\n    // ...\n    auto const element = matrix[y * m + x];\n    // ...\n}\n\nauto const m = 650000;\nauto const n = 2;\nstd::vector&lt;double&gt; my_matrix(m * n);\nauto const result = notindic(my_matrix, m);\n</code></pre>\n\n<p>While you're at it, wrap it in a class like this:</p>\n\n<pre><code>template &lt;class T&gt;\nclass Matrix final\n{\npublic:\n    Matrix(int m, int n) :\n        data(m * n),\n        m(m)\n   {\n   }\n\n   T&amp; operator()(int x, int y)\n   {\n       return data[y * m + x];\n   }\n\n   T const&amp; operator()(int x, int y) const\n   {\n       return data[y * m + x];\n   }\n\nprivate:\n    std::vector&lt;T&gt; data;\n    int m;\n};\n\nbool notindic (Matrix&lt;double&gt; const&amp; matrix) {\n    // ...\n    auto const element = matrix(x, y);\n    // ...\n}\n\nauto const m = 650000;\nauto const n = 2;\nMatrix&lt;double&gt; my_matrix(m, n);\nauto const result = notindic(my_matrix);\n</code></pre>\n\n<p>Add additional member functions if you need them.</p>\n"}], "owner": {"reputation": 51, "user_id": 8890348, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214733468634045/picture?type=large", "display_name": "Luigi Bernardi", "link": "https://stackoverflow.com/users/8890348/luigi-bernardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1510170697, "creation_date": 1510164985, "question_id": 47186898, "link": "https://stackoverflow.com/questions/47186898/how-to-call-a-dynamic-matrix-into-a-function", "title": "How to call a dynamic matrix into a function?", "body": "<p>I have declared a matrix this way:</p>\n\n<pre><code>double **MB;\n    MB = new double *[650000];\n     for (int count = 0; count &lt; 650000; count++)\n     MB[count] = new double [2];\n</code></pre>\n\n<p>Now I want to call my matrix in a function that should modify it.</p>\n\n<pre><code>bool notindic (..., double MB [][2], ...) {}\n</code></pre>\n\n<p>and in the main:</p>\n\n<pre><code>notindic(..., MB, ...)\n</code></pre>\n\n<p>Now it gives me this error: *[Error] cannot convert 'double**' to 'double (<em>)[2]' for argument '3' to 'bool notindic(std::string, std::string</em>, double (<em>)[2], int, int)'</em></p>\n\n<p>How can I fix it?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1510164870, "post_id": 47186834, "comment_id": 81322785, "body": "<code>int line = 0;</code> You forgot to initialize it. But there are other issues as well."}, {"owner": {"reputation": 16685, "user_id": 2289509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F51FU.jpg?s=128&g=1", "display_name": "Elazar", "link": "https://stackoverflow.com/users/2289509/elazar"}, "edited": false, "score": 0, "creation_date": 1510164983, "post_id": 47186834, "comment_id": 81322863, "body": "The code doesn&#39;t do what you claim it is trying to do."}, {"owner": {"reputation": 19, "user_id": 8908685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43385e264b52ebd8cc6ebb4330dd48d?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/8908685/stefan"}, "edited": false, "score": 0, "creation_date": 1510165356, "post_id": 47186834, "comment_id": 81323088, "body": "Could you point out what the issues are and maybe how can i solve them?"}, {"owner": {"reputation": 3280, "user_id": 3493289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08927897947ad3bae66cf2d02f587ffc?s=128&d=identicon&r=PG&f=1", "display_name": "MS Srikkanth", "link": "https://stackoverflow.com/users/3493289/ms-srikkanth"}, "edited": false, "score": 1, "creation_date": 1510166274, "post_id": 47186834, "comment_id": 81323598, "body": "Hmm the main problem is that you are not checking if the word is present in the line. You are just incrementing the line count and blindly printing that the word is present on the last line assuming line is initialized to 0."}, {"owner": {"reputation": 3280, "user_id": 3493289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08927897947ad3bae66cf2d02f587ffc?s=128&d=identicon&r=PG&f=1", "display_name": "MS Srikkanth", "link": "https://stackoverflow.com/users/3493289/ms-srikkanth"}, "edited": false, "score": 0, "creation_date": 1510166436, "post_id": 47186834, "comment_id": 81323693, "body": "Moreover line count will not be equal to the number of lines in the file. It will be equal to the number of words in the file. Check cppreference for getline() function which is what you want to use if you want to read a line and not whitespace separated words"}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 6529775, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XFCydMsiVt0/AAAAAAAAAAI/AAAAAAAAABs/kbB4mWpYI9M/photo.jpg?sz=128", "display_name": "alaniane", "link": "https://stackoverflow.com/users/6529775/alaniane"}, "is_accepted": true, "score": 1, "last_activity_date": 1510166993, "last_edit_date": 1510166993, "creation_date": 1510166246, "answer_id": 47187232, "question_id": 47186834, "link": "https://stackoverflow.com/questions/47186834/find-the-value-of-a-line/47187232#47187232", "title": "Find the value of a line", "body": "<p>Part of your problem is that your line counter is reading the total number of lines in the file regardless of whether you find the line your are looking for.\nYou need to add a condition in the while loop that breaks out of the loop once the word is encountered.  The pseudocode would be as follows:</p>\n\n<p>while(readline from file)<br>\n      &nbsp;&nbsp;if(word found in readline)<br>\n        &nbsp;&nbsp;&nbsp;exit loop<br><br>\n      &nbsp;&nbsp;increment line<br>\n   end while loop<br></p>\n\n<p>You would need to change your while loop to read a line:</p>\n\n<pre><code>while(std::getline(readFile, candidate)){\n    // rest of your logic goes here\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8908685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43385e264b52ebd8cc6ebb4330dd48d?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/8908685/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1510874642, "accepted_answer_id": 47187232, "answer_count": 1, "score": -1, "last_activity_date": 1510166993, "creation_date": 1510164762, "last_edit_date": 1510165894, "question_id": 47186834, "link": "https://stackoverflow.com/questions/47186834/find-the-value-of-a-line", "closed_reason": "Not suitable for this site", "title": "Find the value of a line", "body": "<p>So I am trying to make a program in C++ that finds the line of a word from a text file and displays the line number.\nI don't have any errors while compiling, but the line value is always a weird number like 1972007907.</p>\n\n<p>The code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nint main()\n{\n\nstd::ifstream readFile (\"example.txt\");\n\n\n\n\n\nif( readFile.is_open() )\n{\n    int line;\n    std::cout &lt;&lt; \"Write the word you're searching for\\n\" ;\n    std::string word ;\n    std::cin &gt;&gt; word ;\n\n\n\n    std::string candidate ;\n    while( readFile &gt;&gt; candidate )\n    {\n        line++;\n\n    }\n\n    std::cout &lt;&lt; \"The word \" &lt;&lt; word &lt;&lt; \" has been found \" &lt;&lt; \" on line \" &lt;&lt;line&lt;&lt;\"\\n\";\n}\n\nelse\n{\n    std::cout &lt;&lt; \"Error! File not found!\\n\" ;\n    return 1 ;\n}\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi", "unicode"], "comments": [{"owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "edited": false, "score": 0, "creation_date": 1510164816, "post_id": 47186808, "comment_id": 81322741, "body": "Add at least comment when voting down."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1510164862, "post_id": 47186808, "comment_id": 81322773, "body": "You need to break this up. You have extracted from the resource an array of bytes that is UTF8 encoded. Now you need to convert to UTF16. Strip away all the resource code and you have a simple question. How to convert from UTF8 to UTF16. A question that has been asked many times before."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1510164877, "post_id": 47186808, "comment_id": 81322790, "body": "Your text file is UTF-8 and the MS-Windows Unicode APIs expect UTF-16LE you will need to convert either the file before storing it or the bytes from UTF-8 to UTF-16LE after reading it in."}, {"owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1510165032, "post_id": 47186808, "comment_id": 81322892, "body": "@RichardCritten: How to convert it to <code>UTF-16L</code>?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1510165119, "post_id": 47186808, "comment_id": 81322936, "body": "@Won Richard offered you two choices. Convert before compiling resource. Or convert after extracting resource. Conversion process is different for both. You are panicking and flailing around. Think."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1510165193, "post_id": 47186808, "comment_id": 81322972, "body": "See the 1st parameter to <code>MultiByteToWideChar</code> here: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd319072(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>  Or to pre-convert the text file use the <code>Save as...</code> command in Notepad and choose the encoding <code>Unicode</code>."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1510165487, "post_id": 47186808, "comment_id": 81323174, "body": "<a href=\"https://www.joelonsoftware.com/2003/10/08/\" rel=\"nofollow noreferrer\">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a>."}, {"owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "edited": false, "score": 0, "creation_date": 1510166620, "post_id": 47186808, "comment_id": 81323809, "body": "Thank you all guys. You are always as usual so helpful. I figure it through converting my text file to <code>UTF-16LE</code> Now it works fine."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1510172786, "post_id": 47186808, "comment_id": 81327366, "body": "On a side note, in your <code>.rc</code> file, you need to specify the resource type as <code>RCDATA</code> instead of <code>RT_RCDATA</code>.  <code>RT_RCDATA</code> is a constant that you pass to <code>FindResource()</code>, not to <code>rc.exe</code>."}], "owner": {"reputation": 405, "user_id": 8755549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/970b4e09b08d308c71281191d628ccf4?s=128&d=identicon&r=PG&f=1", "display_name": "WonFeiHong", "link": "https://stackoverflow.com/users/8755549/wonfeihong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510164675, "creation_date": 1510164675, "question_id": 47186808, "link": "https://stackoverflow.com/questions/47186808/how-to-retrieve-a-unicode-text-from-a-text-file", "title": "How to retrieve a unicode text from a text file?", "body": "<p>I have a text file embedded in my executable binary so I want to at run-time to read the content:</p>\n\n<p>In header file <code>myres.h</code>:</p>\n\n<pre><code>#define  UNICODE\n#define _UNICODE\n\n#define MY_RESOURCE    1000\n</code></pre>\n\n<p>In resource file <code>myres.rc</code>:</p>\n\n<pre><code>#include \"myres.h\"\n\nMY_RESOURCE   RT_RCDATA   L\"Help Topics.txt\"\n</code></pre>\n\n<p>Now in <code>WinMain.cpp</code> in DialogBox that at WM_INITDIALOG loads the content and sets it to the edit control:</p>\n\n<pre><code>case WM_INITDIALOG:{\n    HGLOBAL   res_handle = NULL;\n    HRSRC     res;\n    wchar_t*  res_data;\n    DWORD     res_size;\n\n    res = FindResourceW(GetModuleHandleW(NULL), MAKEINTRESOURCEW(MY_RESOURCE), (LPWSTR)RT_RCDATA);\n    if (!res)\n        return 1;\n\n    res_handle = LoadResource(NULL, res);\n    if (!res_handle)\n        return 2;\n\n    res_data = (wchar_t*)LockResource(res_handle);\n    res_size = SizeofResource(NULL, res);\n\n    SendDlgItemMessageW(hWnd, ID_HELP_CONTENT, WM_SETTEXT, 0, (LPARAM)res_data);\n\n    return TRUE;        \n}\nbreak;\n</code></pre>\n\n<p>Now when the dialog is created it fills the edit control with  unreadable characters like Chinese ones.</p>\n\n<p>Note If I use the ANSI version of loading the content and undefining UNICODE the code works fine but I need UNICODE.</p>\n\n<ul>\n<li>The content of the text file is saved as <code>UTF-8 BOM</code>.</li>\n</ul>\n\n<p>Is there a way around? - Some recommends me to use <code>MultiByteToWideChar()</code> but I don't know why and how?</p>\n\n<p>If so why other controls I can send them UNICODE text and retrieve it from them without any other stuff eg:</p>\n\n<pre><code>SendDlgItemMessageW(hWnd, ID_HELP_CONTENT, WM_SETTEXT, 0, (LPARAM)L\"Chinese/arabic/latin... text here\");\n</code></pre>\n\n<p>Why above works but when loading the text from a text file doesn't print correctly?</p>\n"}, {"tags": ["c++", "sorting", "vector"], "answers": [{"comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1510165074, "post_id": 47186892, "comment_id": 81322910, "body": "For completeness - the reason you need to do this is that division rounds down and discards the last number from each odd-sized subarray, so the net result is always a power of two."}], "tags": [], "owner": {"reputation": 461, "user_id": 1697239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9133529e203c6879cdca5929a84687d?s=128&d=identicon&r=PG", "display_name": "asbumste", "link": "https://stackoverflow.com/users/1697239/asbumste"}, "is_accepted": true, "score": 2, "last_activity_date": 1510165170, "last_edit_date": 1510165170, "creation_date": 1510164970, "answer_id": 47186892, "question_id": 47186777, "link": "https://stackoverflow.com/questions/47186777/merge-sort-only-returns-vectors-that-have-a-size-that-is-a-power-of-2/47186892#47186892", "title": "Merge Sort only returns vectors that have a size that is a power of 2", "body": "<p>When you construct the right vector, you are adding a number of elements equal to middle, when you should be adding vector_sort.size() - middle number of elements elements. Because division rounds down, this causes you to drop the last element on lists that are odd length. And because you merge sort down to 0 or 1 elements, it causes your results to be powers of 2.</p>\n"}], "owner": {"reputation": 91, "user_id": 8881768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03d63a2d69175fc2f04a4086361b688?s=128&d=identicon&r=PG&f=1", "display_name": "nader2929", "link": "https://stackoverflow.com/users/8881768/nader2929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 47186892, "answer_count": 1, "score": 0, "last_activity_date": 1510182523, "creation_date": 1510164573, "last_edit_date": 1510182523, "question_id": 47186777, "link": "https://stackoverflow.com/questions/47186777/merge-sort-only-returns-vectors-that-have-a-size-that-is-a-power-of-2", "title": "Merge Sort only returns vectors that have a size that is a power of 2", "body": "<p>So I am trying to write code to get a merge sort work on vectors. However I now have a problem where whenever I enter a size of vector size that isn't a power of 2 the final sorted vector will round down its size to the closest power of 2. So e.g. if the vector size is set to 10 it'll return 8, if it's 100 it'll return 64. I don't know why this is. Here is the code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;stdlib.h&gt;     /* srand, rand */\n#include &lt;time.h&gt;  /* time */\n#include &lt;vector&gt;\n#include &lt;assert.h&gt;\n#include &lt;iterator&gt;\n#include &lt;algorithm&gt; \n#include &lt;functional&gt; \nusing namespace std;\n\nvector&lt;int&gt; merge(vector&lt;int&gt; &amp;left, vector&lt;int&gt; &amp;right) {\n    vector &lt;int&gt; result;\n    while (left.size() &gt; 0 &amp;&amp; right.size()&gt;0) {\n        if (left[0] &lt;= right[0]) {\n            result.push_back(left[0]);\n            left.erase(left.begin());\n        }\n        else {\n            result.push_back(right[0]);\n            right.erase(right.begin());\n        }\n    }\n    if (left.size() &gt; 0) {\n        result.insert(result.end(), left.begin(), left.end());\n    }\n    if (right.size() &gt; 0) {\n        result.insert(result.end(), right.begin(), right.end());\n    }\n    return result;\n}\n\nvector &lt;int&gt; mergesort(vector &lt; int &gt; &amp;vector_sort) {\n    int size_of = vector_sort.size() / 2;\n    vector &lt;int &gt; left(size_of), right(size_of), result(vector_sort.size());\n    if (vector_sort.size() &lt;= 1) {\n        return vector_sort;\n    }\n    else {\n        int middle = vector_sort.size() / 2;\n        int counter = middle;\n        int second_half = middle;\n        for (int i = 0; i &lt; middle; i++) {\n            left[i] = vector_sort[i];\n        }\n        for (int i = 0; i &lt; middle; i++) {\n            right[i] = vector_sort[counter];\n            counter++;\n        }\n        left = mergesort(left);\n        right = mergesort(right);\n        if (left.back() &lt;= right[0]) {\n            left.insert(left.end(), right.begin(), right.end());\n            return left;\n        }\n        result = merge(left, right);\n        return result;\n    }\n}\nint main() {\n    const int t=10;\n    vector&lt;int&gt; vector_no(t);\n    vector&lt;int&gt; empty(t);\n    for (int i = 0; i &lt; t; i++) {\n        int hello = rand() % 100000 + 1;\n        vector_no[i] = hello;\n    }\n    int hello2 = 0;\n    for (int i = 0; i &lt; vector_no.size(); i++) {\n        hello2++; //I am using this for loop here just to count the size of the vector without getting a stack overflow error\n    }\n    cout &lt;&lt; hello2  &lt;&lt; \"\\n\";\n    vector_no = mergesort(vector_no);\n    hello2 = 0;\n    for (int i = 0; i &lt; vector_no.size(); i++) {\n        hello2++; //I am using this for loop here just to count the size of the vector without getting a stack overflow error\n    }\n    cout &lt;&lt; hello2 &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}, {"tags": ["c++", "c++-standard-library", "allocator"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1510164375, "post_id": 47186641, "comment_id": 81322476, "body": "The explanation is provided in the row that mentions the <code>operator==</code> function. <i>returns true only if the storage allocated by the allocator a1 can be deallocated through a2. Establishes reflexive, symmetric, and transitive relationship. Does not throw exceptions.</i> Is that not sufficient explanation?"}, {"owner": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1510165451, "post_id": 47186641, "comment_id": 81323150, "body": "@RSahu no, that doesn&#39;t explain why such operator is necessary"}], "answers": [{"comments": [{"owner": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "edited": false, "score": 0, "creation_date": 1510165419, "post_id": 47186714, "comment_id": 81323135, "body": "That doesn&#39;t explain why such operator is necessary"}], "tags": [], "owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "is_accepted": false, "score": 2, "last_activity_date": 1510164887, "last_edit_date": 1510164887, "creation_date": 1510164348, "answer_id": 47186714, "question_id": 47186641, "link": "https://stackoverflow.com/questions/47186641/why-c-custom-allocator-needs-comparison-operators/47186714#47186714", "title": "Why C++ custom allocator needs comparison operators?", "body": "<p>The very documentation you linked to contains the answer:</p>\n\n<blockquote>\n  <p>[<code>operator ==(a1, a2)</code>] returns true only if the storage allocated by the\n  allocator <code>a1</code> can be deallocated through <code>a2</code>. Establishes reflexive,\n  symmetric, and transitive relationship. Does not throw exceptions.</p>\n</blockquote>\n\n<p>So whenever you have an allocator for a certain type, you can check whether you can use it to deallocate memory of a different type without the need to rebind the allocator.</p>\n"}, {"comments": [{"owner": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "edited": false, "score": 0, "creation_date": 1510165389, "post_id": 47186727, "comment_id": 81323107, "body": "That doesn&#39;t explain why such operator is necessary"}, {"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "reply_to_user": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "edited": false, "score": 2, "creation_date": 1510170144, "post_id": 47186727, "comment_id": 81325955, "body": "@jaskmar You original question did not contain this question. To downvote this answer which explains at least an aspect of your original question is not the right reaction."}, {"owner": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "reply_to_user": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 0, "creation_date": 1510173763, "post_id": 47186727, "comment_id": 81327895, "body": "@Jodocus This is the quote from original question: &quot;The question is what are purposes of those 2 operators? When are they being used?&quot; So it DID contain :)"}, {"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "reply_to_user": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "edited": false, "score": 1, "creation_date": 1510174495, "post_id": 47186727, "comment_id": 81328305, "body": "@jaskmar However your question was meant, a downvote certainly is not appropriate. Nothing more to add."}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1510164386, "creation_date": 1510164386, "answer_id": 47186727, "question_id": 47186641, "link": "https://stackoverflow.com/questions/47186641/why-c-custom-allocator-needs-comparison-operators/47186727#47186727", "title": "Why C++ custom allocator needs comparison operators?", "body": "<p>Docs also says</p>\n\n<blockquote>\n  <p>a1 == a2  returns true only if the storage allocated by the allocator\n  a1 can be deallocated through a2. Establishes reflexive, symmetric,\n  and transitive relationship. Does not throw exceptions.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "edited": false, "score": 1, "creation_date": 1510170485, "post_id": 47186781, "comment_id": 81326141, "body": "@jaskmar Isn&#39;t his answer a satisfactory one? Seriously?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "reply_to_user": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1540821160, "post_id": 47186781, "comment_id": 92993456, "body": "@Nik-Lz -- the other two answers have the text from the standard."}], "tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": true, "score": 13, "last_activity_date": 1600345915, "last_edit_date": 1600345915, "creation_date": 1510164591, "answer_id": 47186781, "question_id": 47186641, "link": "https://stackoverflow.com/questions/47186641/why-c-custom-allocator-needs-comparison-operators/47186781#47186781", "title": "Why C++ custom allocator needs comparison operators?", "body": "<p>Read about the <a href=\"https://en.cppreference.com/w/cpp/named_req/Allocator\" rel=\"nofollow noreferrer\">allocator requirements</a>. <code>operator==</code> tells you whether one of the allocator object instances can free memory that was allocated by the other. That's important when you move the contents of one container into another. If the second container's allocator is <code>==</code> to the first container's, you can, in general, do the move by swapping a pointer or two, reusing the first container's memory in the second. If the allocators are not equal, then the copy operation has to copy each element, allocating memory in the second container as needed, and free the memory held by the first container.</p>\n"}], "owner": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 1, "accepted_answer_id": 47186781, "answer_count": 3, "score": 8, "last_activity_date": 1600345915, "creation_date": 1510164074, "last_edit_date": 1510165821, "question_id": 47186641, "link": "https://stackoverflow.com/questions/47186641/why-c-custom-allocator-needs-comparison-operators", "title": "Why C++ custom allocator needs comparison operators?", "body": "<p>While implementing custom C++ allocator, one needs to define:</p>\n\n<ul>\n<li><code>operator==</code> for the allocator with different <code>value_type</code></li>\n<li><code>operator!=</code> for the allocator with different <code>value_type</code></li>\n</ul>\n\n<p>You can see the example implementation of custom allocator in <a href=\"http://en.cppreference.com/w/cpp/concept/Allocator\" rel=\"noreferrer\">documentation of Allocator concept</a>:</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;new&gt;\ntemplate &lt;class T&gt;\nstruct Mallocator {\n  typedef T value_type;\n  Mallocator() = default;\n  template &lt;class U&gt; constexpr Mallocator(const Mallocator&lt;U&gt;&amp;) noexcept {}\n  T* allocate(std::size_t n) {\n    if(n &gt; std::size_t(-1) / sizeof(T)) throw std::bad_alloc();\n    if(auto p = static_cast&lt;T*&gt;(std::malloc(n*sizeof(T)))) return p;\n    throw std::bad_alloc();\n  }\n  void deallocate(T* p, std::size_t) noexcept { std::free(p); }\n};\ntemplate &lt;class T, class U&gt;\nbool operator==(const Mallocator&lt;T&gt;&amp;, const Mallocator&lt;U&gt;&amp;) { return true; }\ntemplate &lt;class T, class U&gt;\nbool operator!=(const Mallocator&lt;T&gt;&amp;, const Mallocator&lt;U&gt;&amp;) { return false; }\n</code></pre>\n\n<p>The question is what are purposes of those 2 operators? When are they being used?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Please note I am not asking <strong>how to implement</strong> such operators (explained in the link), I am asking why it is necessary to implement them, so when those are being used.</p>\n"}, {"tags": ["c++", "oop", "pointers", "polymorphism"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1510163737, "post_id": 47186497, "comment_id": 81322100, "body": "Code is best understood when presented, not described."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 0, "creation_date": 1510163876, "post_id": 47186497, "comment_id": 81322175, "body": "Yes it is possible"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1510164889, "post_id": 47186497, "comment_id": 81322803, "body": "A bit about terminology: a pointer is a pointer; there is no such thing as a &quot;polymorphic pointer&quot;. A pointer can point at an object of a polymorphic type, which is what you&#39;re looking at."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7723195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5cb0ff70e95b5bace532b2beb5d6b82?s=128&d=identicon&r=PG&f=1", "display_name": "Hunteerq", "link": "https://stackoverflow.com/users/7723195/hunteerq"}, "edited": false, "score": 0, "creation_date": 1510164620, "post_id": 47186719, "comment_id": 81322611, "body": "Yeah but I would like use a method of derived class that name hasn&#39;t been declared in base class."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 33, "user_id": 7723195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5cb0ff70e95b5bace532b2beb5d6b82?s=128&d=identicon&r=PG&f=1", "display_name": "Hunteerq", "link": "https://stackoverflow.com/users/7723195/hunteerq"}, "edited": false, "score": 2, "creation_date": 1510164689, "post_id": 47186719, "comment_id": 81322647, "body": "@Hunteerq can&#39;t be done. <code>Hero</code> only knows <code>Hero</code> stuff. It can&#39;t know about future extensions."}], "tags": [], "owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "is_accepted": false, "score": 3, "last_activity_date": 1510167043, "last_edit_date": 1510167043, "creation_date": 1510164365, "answer_id": 47186719, "question_id": 47186497, "link": "https://stackoverflow.com/questions/47186497/polymorphic-pointer/47186719#47186719", "title": "Polymorphic pointer", "body": "<p>It is possible. Here is an example. h2 is pointing to Hero however it is using method from MainPlayer. </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nclass Hero\n{\npublic:\n    virtual std::string whoAmI() const { return \"The Hero\"; }\n};\n\nclass MainPlayer : public Hero\n{\npublic:\n    std::string whoAmI() const override { return \"The Main Player\"; }\n};\n\nint main()\n{\n\n    Hero h1;\n    std::cout &lt;&lt; h1.whoAmI() &lt;&lt; std::endl;\n    Hero *h2 = new MainPlayer;\n    std::cout &lt;&lt; h2-&gt;whoAmI() &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>The Hero\nThe Main Player\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 2, "last_activity_date": 1510169123, "last_edit_date": 1510169123, "creation_date": 1510165092, "answer_id": 47186935, "question_id": 47186497, "link": "https://stackoverflow.com/questions/47186497/polymorphic-pointer/47186935#47186935", "title": "Polymorphic pointer", "body": "<p>When a <code>MainPlayer</code> is accessed through a pointer to a <code>Hero</code> the only exposed interface is that of <code>Hero</code>, and the compiler can only take advantage of functionality known to <code>Hero</code>.</p>\n\n<p>How to get around this (in order of my personal preference):</p>\n\n<p>Avoid interacting with a <code>MainPlayer</code> as a <code>Hero</code> in situations where <code>MainPlayer</code>'s additional functionality is required. <code>MainPlayer</code> attacks and takes damage (more or less thanks to the possibility of an override) just like everyone else, but if only <code>MainPlayer</code> can <code>SwingFromChandelier</code>, only <code>MainPlayer</code> should be offered the opportunity to do so. Most of the time in this case <code>MainPlayer</code> will already be available as a <code>MainPlayer</code>.</p>\n\n<p>Abstract away the need to expose additional functions. For example, perhaps <code>MainPlayer::fun</code> can call <code>MainPlayer::fun2</code> to do extra <code>MainPlayer</code> stuff. <code>MainPlayer</code>'s override of <code>Hero::Attack</code> could call the <code>BerserkRampage</code> specialty attack function, removing the need to expose <code>BerserkRampage</code> to anyone.</p>\n\n<p><code>Hero</code>s interface may be under-specified. Consider expanding <code>Hero</code> with additional virtual functions. </p>\n\n<p><code>dynamic_cast</code> <code>Hero *</code> to <code>MainPlayer *</code>, verify that the result is not  <code>nullptr</code>, and invoke <code>MainPlayer</code> functionality on the newly-minted <code>MainPlayer *</code></p>\n"}, {"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510167215, "post_id": 47187479, "comment_id": 81324130, "body": "Worth an edit to point out what the <code>override</code> keyword really does and why you should use it."}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510174626, "post_id": 47187479, "comment_id": 81328382, "body": "I&#39;ve edited the answer to clarify that it&#39;s the overriding of a virtual function that explains the &quot;important exception&quot;, not just the signature (i.e. if the base class function would not be virtual, it would call the base class version and not the derived one despite the same signature).  I agree with @user4581301 : it would be nice to explain the benefits of using <code>override</code> keyword."}], "tags": [], "owner": {"reputation": 604, "user_id": 8908931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9a2630c9ff44937efd1bcb036b018e?s=128&d=identicon&r=PG&f=1", "display_name": "OriBS", "link": "https://stackoverflow.com/users/8908931/oribs"}, "is_accepted": true, "score": 3, "last_activity_date": 1510258204, "last_edit_date": 1510258204, "creation_date": 1510167111, "answer_id": 47187479, "question_id": 47186497, "link": "https://stackoverflow.com/questions/47186497/polymorphic-pointer/47187479#47187479", "title": "Polymorphic pointer", "body": "<p>From the pointer to the base class <code>Hero</code> you can only call functions and access members of the <code>Hero</code> class.</p>\n\n<p>This has the important exception, that a virtual function of the base class that is overridden in the derived class (with the same signature as described in the derived class <code>MainPlayer</code>), it will call to the implementation of the derived class (even if it doesn't contains the keyword <code>override</code>).</p>\n\n<p>Finally a pointer to <code>Hero</code> created from <code>MainPlayer</code>, can be cast back to a pointer of <code>MainPlayer</code>, and then you can call functions and access members from <code>MainPlayer</code>, like in the following example:</p>\n\n<pre><code>Hero * h2 = new MainPlayer();\nMainPlayer * h3 = dynamic_cast&lt;MainPlayer*&gt;(h2); \n\nif (h3 != nullptr)\n{\n    h3-&gt;fun2();\n}\n\ndelete h2;\n</code></pre>\n\n<p>Finally don't forget to delete your allocated pointer</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>The <code>override</code> specifier, while not necessary, help you to ensure that you are indeed overriding a function from the base class. If the base class doesn't declare a virtual function with the same signature, the program will not compile. Here is a simple example for this concept:</p>\n\n<pre><code>struct A\n{\n    virtual void foo();\n    void bar();\n};\n\nstruct B : A\n{\n    void foo() const override; // Error: B::foo does not override A::foo\n                               // (signature mismatch)\n    void foo() override; // OK: B::foo overrides A::foo\n    void bar() override; // Error: A::bar is not virtual\n};\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7723195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5cb0ff70e95b5bace532b2beb5d6b82?s=128&d=identicon&r=PG&f=1", "display_name": "Hunteerq", "link": "https://stackoverflow.com/users/7723195/hunteerq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 47187479, "answer_count": 3, "score": 1, "last_activity_date": 1510258204, "creation_date": 1510163638, "last_edit_date": 1510173802, "question_id": 47186497, "link": "https://stackoverflow.com/questions/47186497/polymorphic-pointer", "title": "Polymorphic pointer", "body": "<p>I am struggling with Polymorphism in C++. I have 2 classes, <code>Hero</code> and <code>MainPlayer</code>. <code>Hero</code> is base class and <code>MainPlayer</code> is derived from <code>Hero</code>. In <code>Hero</code> I have some variables and methodes, and <code>MainPlayer</code> has some additional variables and methods. I am trying to create polymorphic pointer just like:</p>\n\n<pre><code>Hero *player = new MainPlayer(constructor);\n</code></pre>\n\n<p>and then with the player I can only access the methods from <code>Hero</code> class, otherwise there is a compile error. I would like to ask if it is possible\nto use <code>MainPlayer</code> methods and variables via this polymorphic pointer: <code>player</code>.    </p>\n\n<p>My code:</p>\n\n<pre><code>class Hero\n{\npublic:\n    Hero();\n    virtual void fun() = 0;\nprivate:\n    int a, b;\n};\n\nclass MainPlayer:\npublic Hero\n{   \npublic:\n    MainPlayer();\n    void fun();\n    void fun2();\nprivate:\n    int c;\n};\n\nint main()\n{\n    Hero *player = new MainPlayer(constructor);\n    player-&gt;fun(); // works\n    player-&gt;fun2(); //doesn't work\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "c++11", "pybind11"], "answers": [{"tags": [], "owner": {"reputation": 1029, "user_id": 7878485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15dabd902549f21699b86daa04ecaeed?s=128&d=identicon&r=PG&f=1", "display_name": "nitronoid", "link": "https://stackoverflow.com/users/7878485/nitronoid"}, "is_accepted": true, "score": 0, "last_activity_date": 1510172507, "creation_date": 1510172507, "answer_id": 47188943, "question_id": 47186425, "link": "https://stackoverflow.com/questions/47186425/how-to-cast-a-python-function-to-stdfunction-with-pybind11/47188943#47188943", "title": "How to cast a python function to std::function with pybind11", "body": "<p>I had to move the <code>py::scoped_interpreter python;</code> to a higher scope as it wasn't in scope when the function was called</p>\n"}], "owner": {"reputation": 1029, "user_id": 7878485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/15dabd902549f21699b86daa04ecaeed?s=128&d=identicon&r=PG&f=1", "display_name": "nitronoid", "link": "https://stackoverflow.com/users/7878485/nitronoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 47188943, "answer_count": 1, "score": 1, "last_activity_date": 1510172507, "creation_date": 1510163380, "question_id": 47186425, "link": "https://stackoverflow.com/questions/47186425/how-to-cast-a-python-function-to-stdfunction-with-pybind11", "title": "How to cast a python function to std::function with pybind11", "body": "<p>I have a c++ type <code>Foo</code> which contains a <code>std::function&lt;void()&gt; funcs</code>, which has been successfully bound to python. My aim is to define functions in python and add them to this type, then return an instance. In c++ I use pybind to get an instance of this type which works. However when I attempt to call one of the functions my program seg-faults. </p>\n\n<pre><code>class Foo\n{\n    void addFunc(std::function&lt;void()&gt; _func)\n    {\n      funcs.push_back(_func);\n    }\n\n    void call(int _index)\n    {\n      funcs[_index]();\n    }\n\nprivate:\n    std::vector&lt;std::function&lt;void()&gt;&gt; funcs;\n}\n\nnamespace py = pybind11;\n\nPYBIND11_MODULE(foo, m) \n{\n    py::class_&lt;Foo&gt;(m, \"foo\")\n        .def(py::init&lt;int, int&gt;())\n        .def(\"addFunc\", &amp;Foo::addFunc)\n        .def(\"call\", &amp;Foo::call);\n}\n</code></pre>\n\n<p>And later in c++</p>\n\n<pre><code>py::scoped_interpreter python;\nauto module = py::module::import(\"foo_module\");\nauto func = module.attr(\"create_foo\");\nauto result = func();\n//This works!\nresult.attr(\"call\")(0);\nFoo* blah = result.cast&lt;Foo*&gt;();\n//This seg-faults!\nblah-&gt;call(0);\n</code></pre>\n\n<p>My python module has this:</p>\n\n<pre><code>def newFunc():\n    print \"working!\"\n\ndef create_foo():\n\n  temp = foo.Foo(0, 100)\n  temp.addFunc(newFunc)\n  return temp\n</code></pre>\n\n<p>I'm not sure why the functions aren't being cast back to c++ correctly?</p>\n"}, {"tags": ["c++", "gcc"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1510163931, "post_id": 47186406, "comment_id": 81322215, "body": "I think the issue is that <code>static</code> in namespace scope are not constructed until right before some code in that cpp file is used. Ergo, if no code in a cpp file is ever called, those <code>static</code>s may never be constructed. This has nothing to do with Gcc optimizations, this is how C++ works. MSVC is an oddball that ignores this and constructs all namespace <code>static</code>s before starting <code>main</code>."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1510163991, "post_id": 47186406, "comment_id": 81322246, "body": "If you reference <i>some</i> symbol in a library module, it will be linked in (including the static objects). If there is no reference to anything in a module, it is not included. That&#39;s the way it is <i>supposed</i> to work. This has been asked several times before <a href=\"https://stackoverflow.com/questions/14116420/how-to-force-gcc-to-link-an-unused-static-library?noredirect=1&amp;lq=1\" title=\"how to force gcc to link an unused static library\">stackoverflow.com/questions/14116420/&hellip;</a>"}, {"owner": {"reputation": 713, "user_id": 665498, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/geOHR.jpg?s=128&g=1", "display_name": "shavera", "link": "https://stackoverflow.com/users/665498/shavera"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1510164482, "post_id": 47186406, "comment_id": 81322529, "body": "I&#39;ve browsed through the several other answers as well. My question is if there is a way to force <i>specific</i> objects to be included, as opposed to the whole-archive option, which is not only excessive, but problematic in its excess.  @BasileStarynkevitch: That may be what I&#39;m looking for, I&#39;ll dig into it to see if it fits."}, {"owner": {"reputation": 1765, "user_id": 332798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47656e20ff5e42f125fc5ea0fd636c6?s=128&d=identicon&r=PG", "display_name": "tmm1", "link": "https://stackoverflow.com/users/332798/tmm1"}, "edited": false, "score": 0, "creation_date": 1565557782, "post_id": 47186406, "comment_id": 101381829, "body": "If you simply want to ignore the multiple definition errors, you can use <code>-Wl,--allow-multiple-definition</code>"}], "answers": [{"comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1510165291, "post_id": 47186765, "comment_id": 81323046, "body": "+1 for this approach. This works beautifully and is (IMHO) much less error prone than the whole-archive approach."}, {"owner": {"reputation": 713, "user_id": 665498, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/geOHR.jpg?s=128&g=1", "display_name": "shavera", "link": "https://stackoverflow.com/users/665498/shavera"}, "edited": false, "score": 0, "creation_date": 1510165332, "post_id": 47186765, "comment_id": 81323073, "body": "I completely misunderstood the undefined symbol flag, then. Testing this approach now"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1510165354, "post_id": 47186765, "comment_id": 81323087, "body": "@templatetypedef It works reliably, but the downside is that you need to specify that linker switch when linking that archive, which can be overlooked."}, {"owner": {"reputation": 713, "user_id": 665498, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/geOHR.jpg?s=128&g=1", "display_name": "shavera", "link": "https://stackoverflow.com/users/665498/shavera"}, "edited": false, "score": 0, "creation_date": 1510168739, "post_id": 47186765, "comment_id": 81325085, "body": "I added <code>-Wl,--undefined=_ZN7animals12_GLOBAL__N_110registerMeE</code> as a flag to the linker in my test program (with <code>animals::[anonymous namespace]::RegisterInFactory&lt;Cat&gt; registerMe{&quot;cat&quot;};</code> as the object, for example). That didn&#39;t seem to include the object. I moved the registrar out of the anonymous namespace <code>--undefined=_ZN7animals10registerMeB5cxx11E</code>, and still didn&#39;t seem to work. I may need to study this undefined flag more to know what&#39;s wrong."}, {"owner": {"reputation": 713, "user_id": 665498, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/geOHR.jpg?s=128&g=1", "display_name": "shavera", "link": "https://stackoverflow.com/users/665498/shavera"}, "edited": false, "score": 0, "creation_date": 1510242975, "post_id": 47186765, "comment_id": 81361256, "body": "@MaximEgorushkin Thanks so much! I look forward to experimenting with this more"}, {"owner": {"reputation": 1765, "user_id": 332798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47656e20ff5e42f125fc5ea0fd636c6?s=128&d=identicon&r=PG", "display_name": "tmm1", "link": "https://stackoverflow.com/users/332798/tmm1"}, "edited": false, "score": 0, "creation_date": 1565544141, "post_id": 47186765, "comment_id": 101378932, "body": "This trick only works if the symbols are global (i.e. not <code>static</code>) and show up with <code>B</code> in the nm output (as opposed to <code>b</code>)."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 1765, "user_id": 332798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47656e20ff5e42f125fc5ea0fd636c6?s=128&d=identicon&r=PG", "display_name": "tmm1", "link": "https://stackoverflow.com/users/332798/tmm1"}, "edited": false, "score": 1, "creation_date": 1565544885, "post_id": 47186765, "comment_id": 101379107, "body": "@tmm1 It is not a trick, rather how linkage works. Static means internal linkage and such symbols aren&#39;t accessible from different translation units."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1510181718, "last_edit_date": 1510181718, "creation_date": 1510164530, "answer_id": 47186765, "question_id": 47186406, "link": "https://stackoverflow.com/questions/47186406/is-there-a-way-to-force-c-compiler-to-not-optimize-out-specific-static-objects/47186765#47186765", "title": "Is there a way to force c++ compiler to not optimize out specific static objects in a static library?", "body": "<p>The issue is not related to optimizations. Rather how linkers link symbols from static libraries.</p>\n\n<blockquote>\n  <p>However, when the code is compiled into a static library, when that library is linked into an executable, these static objects never get constructed, so the classes don't register to the factory, and the factory can't create anything.</p>\n</blockquote>\n\n<p>That happens because nothing else refers to that registration variable. Hence, the linker is not pulling in the definition of the symbol from the archive.</p>\n\n<p>To tell a Unix linker to keep that registration variable even if nothing else refers to it, use <code>-Wl,--undefined=&lt;symbol&gt;</code> compiler switch when linking to that static library:</p>\n\n<blockquote>\n  <p>-u symbol</p>\n  \n  <p>--undefined=symbol</p>\n  \n  <p>Force symbol to be entered in the output file as an undefined symbol. Doing this may, for example, trigger linking of additional modules from standard libraries. <code>-u</code> may be repeated with different option arguments to enter additional undefined symbols. </p>\n</blockquote>\n\n<p>If that registration variable has \"C\" linkage, then <code>&lt;symbol&gt;</code> is the variable name.</p>\n\n<p>For C++ linkage you will need to lookup the mangled name using <code>nm --defined-only &lt;object-file&gt;</code>. You may also need to put that variable into a named namespace, so that it has external linkage.</p>\n\n<hr>\n\n<p>Example:</p>\n\n<pre><code>[max@supernova:~/src/test] $ cat mylib.cc\n#include &lt;cstdio&gt;\n\nnamespace mylib {\n\nstruct Register\n{\n    Register() { std::printf(\"%s\\n\", __PRETTY_FUNCTION__); }\n};\n\nRegister register_me;\n\n}\n\n[max@supernova:~/src/test] $ cat test.cc\n#include &lt;iostream&gt;\n\nint main() {\n    std::cout &lt;&lt; \"Hello, world!\\n\";\n}\n\n[max@supernova:~/src/test] $ make\nmkdir /home/max/src/test/debug\ng++ -c -o /home/max/src/test/debug/test.o -MD -MP -std=gnu++14 -march=native -pthread -W{all,extra,error,inline} -ggdb -fmessage-length=0 -Og test.cc\ng++ -c -o /home/max/src/test/debug/mylib.o -MD -MP -std=gnu++14 -march=native -pthread -W{all,extra,error,inline} -ggdb -fmessage-length=0 -Og mylib.cc\nar rcsT /home/max/src/test/debug/libmylib.a /home/max/src/test/debug/mylib.o\ng++ -o /home/max/src/test/debug/test -ggdb -pthread /home/max/src/test/debug/test.o /home/max/src/test/debug/libmylib.a\n\n[max@supernova:~/src/test] $ ./debug/test \nHello, world! &lt;-------- Missing output from mylib::register_me.\n\n[max@supernova:~/src/test] $ nm --defined-only -C debug/mylib.o\n0000000000000044 t _GLOBAL__sub_I__ZN5mylib11register_meE\n0000000000000000 t __static_initialization_and_destruction_0(int, int)\n0000000000000000 B mylib::register_me                        &lt;-------- Need a mangled name for this.\n0000000000000000 r mylib::Register::Register()::__PRETTY_FUNCTION__\n\n[max@supernova:~/src/test] $ nm --defined-only debug/mylib.o\n0000000000000044 t _GLOBAL__sub_I__ZN5mylib11register_meE\n0000000000000000 t _Z41__static_initialization_and_destruction_0ii\n0000000000000000 B _ZN5mylib11register_meE                   &lt;-------- The mangled name for that.\n0000000000000000 r _ZZN5mylib8RegisterC4EvE19__PRETTY_FUNCTION__\n\n# Added -Wl,--undefined=_ZN5mylib11register_meE to Makefile.\n[max@supernova:~/src/test] $ make \ng++ -o /home/max/src/test/debug/test -ggdb -pthread -Wl,--undefined=_ZN5mylib11register_meE /home/max/src/test/debug/test.o /home/max/src/test/debug/libmylib.a\n\n[max@supernova:~/src/test] $ ./debug/test \nmylib::Register::Register() &lt;-------- Output from mylib::register_me as expected.\nHello, world!\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 665498, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/geOHR.jpg?s=128&g=1", "display_name": "shavera", "link": "https://stackoverflow.com/users/665498/shavera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1627, "favorite_count": 1, "accepted_answer_id": 47186765, "answer_count": 1, "score": 4, "last_activity_date": 1510181718, "creation_date": 1510163301, "last_edit_date": 1510163710, "question_id": 47186406, "link": "https://stackoverflow.com/questions/47186406/is-there-a-way-to-force-c-compiler-to-not-optimize-out-specific-static-objects", "title": "Is there a way to force c++ compiler to not optimize out specific static objects in a static library?", "body": "<p>(Only needs to work for gcc 5.4, if a general solution can't be found)</p>\n\n<p>I have a generic factory that I use to construct objects based on some key (like a string representing a class name). The factory must allow classes to register that may not be known at construction time (so I can't simply register a list of classes explicitly). </p>\n\n<p>As a means of registering these keys and their associated constructors, I have another 'RegisterInFactory' (templated) class. In each class's source file, I construct an object in an anonymous namespace corresponding to that class. This way, each class is automatically registered to the factory once the global objects are constructed. These objects never get used or referenced outside of doing this initial registration task. </p>\n\n<p>However, when the code is compiled into a static library, when that library is linked into an executable, these static objects never get constructed, so the classes don't register to the factory, and the factory can't create anything. </p>\n\n<p>I'm aware of the <code>-Wl,--whole-archive -lfoo</code> flag, which does include these global objects. But it also introduces a lot of 'multiple definition' errors. I'm aware that there's another flag that I can turn off the multiple definition errors, but I don't feel comfortable going without those errors. I'm aware of <code>-u symbolName</code> to turn off specific symbol names from these multiple definition errors (at least that's what I think it does). However, there are just too many of these redundant functions for that to be realistic (mostly from protobuf classes).</p>\n\n<p>Is there any way to tell the compiler not to optimize those objects out, but only those objects so I can avoid the multiple definition issue? Is there another pattern I might be able to follow that fits within the constraints? (Particularly that I do not know at compile time what classes may be registered to the factory.)</p>\n\n<p>Simplified Example code:\nFactory.h:</p>\n\n<pre><code>template&lt;Base&gt;\nclass Factory{\n  ...\n  template&lt;Derived&gt;\n  class RegisterInFactory{\n    RegisterInFactory(){\n      instance().regInFactory(derivedConstructorFunctional);\n    }\n  };\n};\n</code></pre>\n\n<p>In Derived.cpp:</p>\n\n<pre><code>namespace{ BaseFactory::RegisterInFactory&lt;Derived&gt; registerMe{\"Derived\"}; }\n</code></pre>\n\n<p>Final note: I've gotten lucky to some degree where without the linker flags, they still get included, but the only way that seems to happen is if the Derived class is 'sufficiently' complicated. Or maybe it's if I use the Derived class directly within the linked executable. I can't really tell why it's worked when it has.</p>\n"}, {"tags": ["c++", "c++14", "temporary"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1510164064, "post_id": 47186388, "comment_id": 81322284, "body": "Obviously? There is no UB here... The temporary constructed from <code>2</code> lives until the end of the statement."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1510164141, "post_id": 47186388, "comment_id": 81322348, "body": "@Quentin, good note. I believe people used it like <code>auto view = item_view(2); std::cout &lt;&lt; view;</code> That certainly should be UB."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1510166133, "post_id": 47186388, "comment_id": 81323526, "body": "Yep, that time around it is :)"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510171560, "post_id": 47186388, "comment_id": 81326708, "body": "By the way, constructor parameter names do not need to be different from the data member names to be initialised. You can use <code>item(int x): x(x) {}</code> and <code>item_view(const item&amp; it) : it(it) {}</code> just fine."}], "answers": [{"comments": [{"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1510163472, "post_id": 47186433, "comment_id": 81321929, "body": "Wow, this was simpler than I thought. Thanks."}, {"owner": {"reputation": 13376, "user_id": 873025, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/d8rRW.jpg?s=128&g=1", "display_name": "Snps", "link": "https://stackoverflow.com/users/873025/snps"}, "edited": false, "score": 1, "creation_date": 1510163505, "post_id": 47186433, "comment_id": 81321949, "body": "Also, ctor of <code>item</code> should probably be explicit."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 13376, "user_id": 873025, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/d8rRW.jpg?s=128&g=1", "display_name": "Snps", "link": "https://stackoverflow.com/users/873025/snps"}, "edited": false, "score": 0, "creation_date": 1510163569, "post_id": 47186433, "comment_id": 81321990, "body": "@Snps, in real code it is some user defined type. I don&#39;t have many templates lying around the codebase, so I believe it should be ok."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1510170188, "post_id": 47186433, "comment_id": 81325975, "body": "This may not be a good idea for converting constructors. The technique shown in <a href=\"https://wg21.link/lwg2993\" rel=\"nofollow noreferrer\">LWG 2993&#39;s PR</a> can be used instead."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 4, "creation_date": 1510170354, "post_id": 47186433, "comment_id": 81326060, "body": "And in any event, you&#39;d want <code>const std::string&amp;&amp;</code> here in order to correctly reject const rvalues."}, {"owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1510171710, "post_id": 47186433, "comment_id": 81326784, "body": "@T.C., can I just use a template and ban everything else?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "edited": false, "score": 0, "creation_date": 1510177216, "post_id": 47186433, "comment_id": 81329660, "body": "@Incomputable depends on if you want implicit conversions."}], "tags": [], "owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "is_accepted": true, "score": 8, "last_activity_date": 1510163703, "last_edit_date": 1510163703, "creation_date": 1510163426, "answer_id": 47186433, "question_id": 47186388, "link": "https://stackoverflow.com/questions/47186388/how-to-disallow-temporaries-in-functions-taking-const-references/47186433#47186433", "title": "How to disallow temporaries in functions taking const references?", "body": "<p>You can provide an additional overload that's a better matches for temporaries and then delete it. For example :</p>\n\n<pre><code>#include &lt;string&gt;\n\nvoid foo(const std::string &amp;) {}\nvoid foo(std::string &amp;&amp;) = delete;\n\nint main()\n{\n    std::string world = \"World\";\n    foo(\"Hello\");   // Doesn't compile, wants to use foo(std::string &amp;&amp;)\n    foo(world);     // Compiles\n}\n</code></pre>\n"}], "owner": {"reputation": 2105, "user_id": 4593721, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MQ5ui.jpg?s=128&g=1", "display_name": "Incomputable", "link": "https://stackoverflow.com/users/4593721/incomputable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 1, "accepted_answer_id": 47186433, "answer_count": 1, "score": 7, "last_activity_date": 1510164098, "creation_date": 1510163244, "last_edit_date": 1510164098, "question_id": 47186388, "link": "https://stackoverflow.com/questions/47186388/how-to-disallow-temporaries-in-functions-taking-const-references", "title": "How to disallow temporaries in functions taking const references?", "body": "<p><strong>Background:</strong></p>\n\n<p>Lets say I have something like this:</p>\n\n<pre><code>struct item\n{\n    int x;\n    item(int y): x(y) {}\n}\n\nclass item_view\n{\n    const item&amp; it;\npublic:\n    item_view(const item&amp; it_) : it(it_) {}\n\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, const item_view&amp; view)\n    {return os;} //actually is more complicated\n}\n</code></pre>\n\n<p>The reason why I cannot just overload <code>operator&lt;&lt;</code> is that it is more human friendly, and view is used to pass the data to SQL, so ticks and some other characters must be escaped.</p>\n\n<p><strong>Problem:</strong></p>\n\n<p>Somebody might want to do something like this:</p>\n\n<pre><code>auto view = item_view(2);\nstd::cout &lt;&lt; view;\n</code></pre>\n\n<p>This seems to be undefined behavior. </p>\n\n<p><strong>Question:</strong></p>\n\n<p>How can I prevent construction of <code>item_view</code> from temporaries?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1510163832, "post_id": 47186384, "comment_id": 81322153, "body": "Please, have a look at <a href=\"https://www.unrealengine.com/en-US/ue4-on-github\" rel=\"nofollow noreferrer\">Unreal Engine @ github</a>. If you have to fix something in their physics engine, you may do it in the source code. Heard, they accept pull-requests as well."}, {"owner": {"reputation": 143, "user_id": 7935193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b009466ee261b043375dec56a241?s=128&d=identicon&r=PG&f=1", "display_name": "Stephano", "link": "https://stackoverflow.com/users/7935193/stephano"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1510163903, "post_id": 47186384, "comment_id": 81322195, "body": "Oh, If that so, than I missed it. Ok , I&#39;ll keep finding it. Thanks"}, {"owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "edited": false, "score": 0, "creation_date": 1571682231, "post_id": 47186384, "comment_id": 103314201, "body": "Regardless, the solution you outline is feasible. What specifically are you having an issue with?"}], "owner": {"reputation": 143, "user_id": 7935193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b009466ee261b043375dec56a241?s=128&d=identicon&r=PG&f=1", "display_name": "Stephano", "link": "https://stackoverflow.com/users/7935193/stephano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510163605, "creation_date": 1510163223, "last_edit_date": 1510163605, "question_id": 47186384, "link": "https://stackoverflow.com/questions/47186384/connection-between-non-unreal-server-and-unreal-client", "title": "Connection between non Unreal server and Unreal client", "body": "<p>Assume the situation, that I made my own server with c++ ,based on multithreading.Than I connect client which is made by Unreal and it works successfully. Next, I want to calculate some physical operating in my own server, not using Unreal's function \"Collision hull\" .</p>\n\n<p>So this is my main question, \nis this possible that server can receive float type datas, from Unreal client which is compute for physical operating. \nI just really wonder about this, because Unreal deny to fixing their code. </p>\n\n<p>I am sorry that I am not good enough in English. Thanks.</p>\n\n<p>+Not Blueprint .</p>\n"}, {"tags": ["c++", "opencv", "histogram"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510162875, "post_id": 47186165, "comment_id": 81321563, "body": "OpenCV version? Compiler? Debug&amp;Release? x64/x86? IDE? Show includes and linked libs"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163130, "post_id": 47186165, "comment_id": 81321713, "body": "@Miki According to stacktrace, I would guess: x64."}, {"owner": {"reputation": 266, "user_id": 2620742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lC9qL.jpg?s=128&g=1", "display_name": "daniels_pa", "link": "https://stackoverflow.com/users/2620742/daniels-pa"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163548, "post_id": 47186165, "comment_id": 81321977, "body": "@Miki Added The linked libraries, and version. Laptop is X86_64 Debian based linux, IDE shouldn&#39;t be relevant but i used sublime now switched to CLion."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163617, "post_id": 47186165, "comment_id": 81322021, "body": "the folder of the libraries? -L option"}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1510163707, "post_id": 47186165, "comment_id": 81322072, "body": "Generally I&#39;d start by using an tool to look for memory corruption. Options are clang&#39;s address sanitizer (asan) or valgrind. (Clang has other sanitizers as well.)"}, {"owner": {"reputation": 266, "user_id": 2620742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lC9qL.jpg?s=128&g=1", "display_name": "daniels_pa", "link": "https://stackoverflow.com/users/2620742/daniels-pa"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163750, "post_id": 47186165, "comment_id": 81322109, "body": "@Miki /usr/local/include I have installed the opencv libraries and called the linker so that i can use them from program so no -L is required."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163827, "post_id": 47186165, "comment_id": 81322147, "body": "You are running in debug or in release?"}, {"owner": {"reputation": 266, "user_id": 2620742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lC9qL.jpg?s=128&g=1", "display_name": "daniels_pa", "link": "https://stackoverflow.com/users/2620742/daniels-pa"}, "reply_to_user": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1510163830, "post_id": 47186165, "comment_id": 81322151, "body": "@ZalmanStern what do you suspect it is? I suspected it was cause the function was static - changed so that i call new on matrix creation so i get a pointer that i can free when im finished. But same efect seg. fault on 2nd call."}, {"owner": {"reputation": 266, "user_id": 2620742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lC9qL.jpg?s=128&g=1", "display_name": "daniels_pa", "link": "https://stackoverflow.com/users/2620742/daniels-pa"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163862, "post_id": 47186165, "comment_id": 81322171, "body": "@Miki Release though i have Debug compiled and ready to go."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510163989, "post_id": 47186165, "comment_id": 81322245, "body": "Well, it seems that you have everything setup correctly..."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1510164877, "post_id": 47186165, "comment_id": 81322791, "body": "Likely something is corrupting memory -- writing off the end of a buffer, etc. Could be a lot of things and you have not posted all the code and even if you did, it is a bad use of this site to ask people to debug that much code. A tool for finding these errors has a good chance of telling you exactly what is going wrong quickly and should be a standard part of how you work. I.e. used before posting to Stack Overflow. Sometimes such tools don&#39;t work for various reasons but they are getting pretty good."}, {"owner": {"reputation": 266, "user_id": 2620742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lC9qL.jpg?s=128&g=1", "display_name": "daniels_pa", "link": "https://stackoverflow.com/users/2620742/daniels-pa"}, "reply_to_user": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 0, "creation_date": 1510240148, "post_id": 47186165, "comment_id": 81359091, "body": "Thanks @ZalmanStern Literally just ran valgrind and immediately it detected a bad write.  Namely each hist.at&lt;..&gt; should be of index 0 not 1 since i created a 1D array. And since i write at&lt;&gt;(1,..) it has a mem corruption."}], "owner": {"reputation": 266, "user_id": 2620742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lC9qL.jpg?s=128&g=1", "display_name": "daniels_pa", "link": "https://stackoverflow.com/users/2620742/daniels-pa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 617, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510163464, "creation_date": 1510162521, "last_edit_date": 1510163464, "question_id": 47186165, "link": "https://stackoverflow.com/questions/47186165/opencv-matrix-constructor-segmentation-fault", "title": "OpenCV Matrix Constructor Segmentation Fault", "body": "<p>I get a segmentation fault when executing </p>\n\n<pre><code>cv::Mat hist=cv::Mat(1,no_patterns,CV_32SC1,cv::Scalar(0));\n</code></pre>\n\n<p>Where no_patterns=256</p>\n\n<p>However it doesn't crash on the first execution of the function but on the second. </p>\n\n<p>If it is of any importance getHistFromLBP and histAVG are declared static in their class.</p>\n\n<p>Context: </p>\n\n<p>getHistFromLBP function</p>\n\n<pre><code>cv::Mat LBP::getHistFromLBP(const cv::Mat&amp; lbp_mat,unsigned no_patterns, bool normed)\n{   \n    // It crashes here \n    cv::Mat hist=cv::Mat(1,no_patterns,CV_32SC1,cv::Scalar(0));\n\n\nfor (unsigned i=0;i&lt;no_patterns;i++)\n    hist.at&lt;int32_t&gt;(1,i)=0;\n\nfor (int i=0;i&lt;lbp_mat.rows;i++)\n    for (int j=0;j&lt;lbp_mat.cols;j++)\n    {\n        uint32_t bin;\n\n        switch (lbp_mat.type())\n        {\n            case CV_8UC1: bin=static_cast&lt;uint32_t&gt;(lbp_mat.at&lt;uint8_t&gt;(i,j)); break;\n            case CV_16UC1: bin=static_cast&lt;uint32_t&gt;(lbp_mat.at&lt;uint16_t&gt;(i,j)); break;\n            case CV_32SC1: bin=static_cast&lt;uint32_t&gt;(lbp_mat.at&lt;int32_t&gt;(i,j)); break;\n        }\n\n        hist.at&lt;uint32_t&gt;(1,bin)+=1;\n    }\n\nif (normed)\n{\n    unsigned long sum=0;\n    for (int i=0;i&lt;hist.cols;i++)\n    {\n        sum += hist.at&lt;uint32_t&gt;(1, i);\n    }\n    std::cout &lt;&lt; \"Found sum = \" &lt;&lt; sum &lt;&lt; std::endl;\n    for (int i=0;i&lt;hist.cols;i++)\n    {\n        std::cout&lt;&lt; \"Working on normalizing i= \" &lt;&lt; i &lt;&lt; std::endl;\n        std::cout &lt;&lt; \"Hist(i) = \" &lt;&lt; hist.at&lt;uint32_t&gt;(1,i) &lt;&lt; std::endl;\n        hist.at&lt;float&gt;(i) = hist.at&lt;uint32_t&gt;(1, i) * 1.0 / (sum + std::numeric_limits&lt;float&gt;::epsilon());\n\n    }\n}\n\n\nreturn hist;\n}\n</code></pre>\n\n<p>The function that calls function that retrieves the histograms.</p>\n\n<pre><code>if (sliding_window_frames.window_full())\n{\n    // We can calculate the AFF hist and the CF-AFF Chi Square distance\n    std::vector&lt;cv::Mat&gt;* cf_mat=sliding_window_frames.getCFMat();\n    std::vector&lt;cv::Mat&gt;* front_mat=sliding_window_frames.getFrontMat();\n    std::vector&lt;cv::Mat&gt;* back_mat=sliding_window_frames.getBackMat();\n\n    std::vector&lt;double&gt; tmp_diffs;\n    for (unsigned i=0;i&lt;cf_mat-&gt;size();i++)\n    {\n        std::cout &lt;&lt; \"Current block analyzed is: \" &lt;&lt; i &lt;&lt; std::endl;\n        // This call of getHistFromLBP executes OK\n        cv::Mat histCF=lbp_extractor-&gt;getHistFromLBP((*cf_mat)[i],256,normed_histograms);\n        // This call fails with a segmentation fault\n        cv::Mat histFront=lbp_extractor-&gt;getHistFromLBP((*front_mat)[i],256,normed_histograms);\n        cv::Mat histBack=lbp_extractor-&gt;getHistFromLBP((*back_mat)[i],256,normed_histograms);\n        std::cout &lt;&lt; \"Found Histograms \" &lt;&lt; std::endl;\n        cv::Mat histAFF=lbp_extractor-&gt;histAvg(histFront,histBack,normed_histograms);\n        std::cout &lt;&lt; \"Found Hist AFF \" &lt;&lt; std::endl;\n        double chisquared=lbp_extractor-&gt;getChiSquaredDistanceFromHist(histCF,histAFF,normed_histograms);\n        std::cout &lt;&lt; \"Found chi squared \" &lt;&lt; std::endl;\n        tmp_diffs.push_back(chisquared);\n        std::cout &lt;&lt; \"Pushed chi squared \" &lt;&lt; std::endl;\n    }\n    ...\n}\n</code></pre>\n\n<p>Here is also the GDB backtrace when it seg-faulted: </p>\n\n<pre><code>#0  0x00007fffefc1bfff in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007fffefc1d42a in __GI_abort () at abort.c:89\n#2  0x00007fffefc59c00 in __libc_message (do_abort=do_abort@entry=2, fmt=fmt@entry=0x7fffefd4ed78 \"*** Error in `%s': %s: 0x%s ***\\n\")\nat ../sysdeps/posix/libc_fatal.c:175\n#3  0x00007fffefc5ffc6 in malloc_printerr (action=3, str=0x7fffefd4b8be \"corrupted size vs. prev_size\", ptr=&lt;optimized out&gt;, ar_ptr=&lt;optimized out&gt;)\nat malloc.c:5049\n#4  0x00007fffefc603b8 in malloc_consolidate (av=av@entry=0x7fffeff80b00 &lt;main_arena&gt;) at malloc.c:4221\n#5  0x00007fffefc61dfa in _int_malloc (av=av@entry=0x7fffeff80b00 &lt;main_arena&gt;, bytes=bytes@entry=1136) at malloc.c:3488\n#6  0x00007fffefc6293e in _int_memalign (av=av@entry=0x7fffeff80b00 &lt;main_arena&gt;, alignment=alignment@entry=64, bytes=bytes@entry=1024)\nat malloc.c:4459\n#7  0x00007fffefc6435f in _mid_memalign (alignment=64, bytes=1024, address=&lt;optimized out&gt;) at malloc.c:3158\n#8  0x00007fffefc65fef in __posix_memalign (memptr=0x7fffffffbd38, alignment=&lt;optimized out&gt;, size=&lt;optimized out&gt;) at malloc.c:5071\n#9  0x00007ffff57e967b in cv::fastMalloc(unsigned long) () at /usr/local/lib/libopencv_core.so.3.3\n#10 0x00007ffff5930ae6 in cv::Mat::create(int, int const*, int) () at /usr/local/lib/libopencv_core.so.3.3\n#11 0x000055555556995e in cv::Mat::create(int, int, int) (this=0x7fffffffbff0, _rows=1, _cols=256, _type=4)\nat /usr/local/include/opencv2/core/mat.inl.hpp:784\n#12 0x00005555555698b5 in cv::Mat::Mat(int, int, int, cv::Scalar_&lt;double&gt; const&amp;) (this=0x7fffffffbff0, _rows=1, _cols=256, _type=4, _s=...)\nat /usr/local/include/opencv2/core/mat.inl.hpp:420\n#13 0x0000555555568ccf in LBP::getHistFromLBP(cv::Mat const&amp;, unsigned int, bool) (lbp_mat=..., no_patterns=256, normed=true) at ../src/lbp.cpp:162\n#14 0x0000555555572760 in RM_Analyzer::addNewFrame(cv::Mat, bool) (this=0x7fffffffc490, img=..., is_lbp_img=false) at ../src/rm_analyzer.cpp:86\n#15 0x00005555555721ff in RM_Analyzer::analyzeVid() (this=0x7fffffffc490) at ../src/rm_analyzer.cpp:25\n#16 0x0000555555577241 in main(int, char const**) (argc=15, argv=0x7fffffffe0b8) at ../bin_src/main.cpp:198\n</code></pre>\n\n<p>Linked libraries in Makefile:<br>\nLIBSLANDMARK=-lFaceAnalyser -lLandmarkDetector -ltbb -ldlib -lboost_filesystem -lboost_system<br>\nLIBSOPENCV=-lopencv_calib3d -lopencv_core -lopencv_videoio -lopencv_objdetect -lopencv_highgui  -lopencv_imgproc -lopencv_imgcodecs  </p>\n\n<p>OpenCV Version used:3.3 (I wrote a c++ file that writes major and minor version since i wasn't sure if it was 3.2 or 3.3) </p>\n"}, {"tags": ["c++", "stl", "structure", "push-back"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1510162395, "post_id": 47186069, "comment_id": 81321268, "body": "... By pretty much putting into code exactly what you described? What didn&#39;t work?"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 1, "creation_date": 1510162957, "post_id": 47186069, "comment_id": 81321597, "body": "Do you have tried to compile? Result?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510163074, "post_id": 47186069, "comment_id": 81321669, "body": "If you are not getting the actual output, what <i>are</i> you getting? Also, C++ is not C; you don\u2019t need the <code>typedef</code> line. And although there are uses for putting pointers in vectors like this, I suspect you might actually want to just put the <code>st</code>s directly inside the vector."}, {"owner": {"reputation": 47, "user_id": 2868151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75470ee86d8d8188ca40e47ac7be7556?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/2868151/deepak"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1510163485, "post_id": 47186069, "comment_id": 81321942, "body": "@Klaus this is part of my c++ code which i am doing and ever after displaying the cout as above i am not getting any output"}, {"owner": {"reputation": 47, "user_id": 2868151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75470ee86d8d8188ca40e47ac7be7556?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/2868151/deepak"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510163626, "post_id": 47186069, "comment_id": 81322025, "body": "@DanielH is it not good practice to typedef in c++ code ? please suggest."}, {"owner": {"reputation": 47, "user_id": 2868151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75470ee86d8d8188ca40e47ac7be7556?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/2868151/deepak"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1510163724, "post_id": 47186069, "comment_id": 81322086, "body": "@DanielH i am passing the stricture to the function and was receiving through structure pointer i tried the other way also,its not working"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1510164204, "post_id": 47186069, "comment_id": 81322377, "body": "What output are you getting? What compiler errors are you getting? These are questions you need to answer in order to get to a reasonable answer with your question. If the code you have above is exactly what you are trying to compile, then I&#39;m afraid you have bigger problems; <code>function</code> is not a valid C++ function as it does not have a type."}, {"owner": {"reputation": 47, "user_id": 2868151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75470ee86d8d8188ca40e47ac7be7556?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/2868151/deepak"}, "reply_to_user": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1510164586, "post_id": 47186069, "comment_id": 81322594, "body": "@smac89 updated the code. please see the code snippet"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1510165745, "post_id": 47186069, "comment_id": 81323305, "body": "You just need to declare the vector outside the function that uses it. Maybe as a member function of the <code>Temperature_sensor</code> class? This depends on how you want to use the vector of course. If both observers will be writing to this function, then it&#39;s ok to declare it inside the <code>Temperature_sensor</code> class, otherwise the <code>Temperature_monitor</code> class may be a better option"}], "answers": [{"tags": [], "owner": {"reputation": 410, "user_id": 7680257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HIUCB.jpg?s=128&g=1", "display_name": "dcariotti", "link": "https://stackoverflow.com/users/7680257/dcariotti"}, "is_accepted": false, "score": 0, "last_activity_date": 1510162517, "creation_date": 1510162517, "answer_id": 47186158, "question_id": 47186069, "link": "https://stackoverflow.com/questions/47186069/how-to-insert-structure-pointer-into-stl-vector-and-display-the-content/47186158#47186158", "title": "How to insert structure pointer into stl vector and display the content", "body": "<p>If you use a std::vector you should do something like this:</p>\n\n<pre><code>std::vector&lt;st&gt; v; //use st as type of v\n\n//read\nfor(auto const&amp; i : v) {\n    std::cout &lt;&lt; i.param1 &lt;&lt; ' ' &lt;&lt; i.param2;\n}\n//push_back\nv.push_back({param1, param2});\n</code></pre>\n\n<p>Of course, you could have more than 2 params.</p>\n"}, {"comments": [{"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1510165632, "post_id": 47186487, "comment_id": 81323247, "body": "You can make this into an answer now that OP has updated his post. You are on the right track, you just need to flesh out the answer a bit"}], "tags": [], "owner": {"reputation": 13, "user_id": 2142717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f890cc83575a35bd391addab0859051?s=128&d=identicon&r=PG", "display_name": "Rajeev Ranjan", "link": "https://stackoverflow.com/users/2142717/rajeev-ranjan"}, "is_accepted": false, "score": 0, "last_activity_date": 1510163614, "creation_date": 1510163614, "answer_id": 47186487, "question_id": 47186069, "link": "https://stackoverflow.com/questions/47186069/how-to-insert-structure-pointer-into-stl-vector-and-display-the-content/47186487#47186487", "title": "How to insert structure pointer into stl vector and display the content", "body": "<p>Could you please share sample input data and expected output?\nWith your code it will always create a new vector and put 1 structure object there.\nif you want to have single vector store all structure objects, then declare vector  in calling function of \"function\"</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 2868151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75470ee86d8d8188ca40e47ac7be7556?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/2868151/deepak"}, "edited": false, "score": 0, "creation_date": 1510219503, "post_id": 47187738, "comment_id": 81344774, "body": "Thankyou for the comments and suggestion @Ray Hamel"}], "tags": [], "owner": {"reputation": 1119, "user_id": 6797534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tu8Gt9iJGt8/AAAAAAAAAAI/AAAAAAAAAI0/Diz261BzMYk/photo.jpg?sz=128", "display_name": "Ray Hamel", "link": "https://stackoverflow.com/users/6797534/ray-hamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1510168464, "last_edit_date": 1510168464, "creation_date": 1510168093, "answer_id": 47187738, "question_id": 47186069, "link": "https://stackoverflow.com/questions/47186069/how-to-insert-structure-pointer-into-stl-vector-and-display-the-content/47187738#47187738", "title": "How to insert structure pointer into stl vector and display the content", "body": "<p>It looks like you're allocating a buffer <code>data</code> of type <code>void*</code> with <code>malloc()</code> or a similar function, then casting <code>data</code> to <code>Temperature_sensor*</code>. It also appears that <code>Temperature_sensor</code> is a class with <code>std::string</code> members, which you are attempting to assign to and print.</p>\n\n<p>This will not work because <code>std::string</code> is not a <a href=\"http://en.cppreference.com/w/cpp/concept/PODType\" rel=\"nofollow noreferrer\">POD type</a>, and so the <code>std::string</code> constructor is never actually invoked (likewise, <code>Temperature_sensor</code> is not a POD type because it has non-POD members, and its constructor is therefore never invoked).</p>\n\n<p>To construct the objects correctly you need to use <code>operator new()</code> in place of <code>malloc()</code> like so</p>\n\n<pre><code>Temperature_sensor *tsensor = new Temperature_sensor;\nTemperature_sensor *five_tsensors = new Temperature_sensor[5];\n</code></pre>\n\n<p>It would be more idiomatic to use a smart pointer like <a href=\"http://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code></a> or <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\"><code>std::shared_ptr</code></a> instead of using <code>operator new()</code> (and <code>operator delete()</code>) directly, and best/most idiomatic to use a <code>std::vector</code>. Any of these methods will construct the allocated objects correctly.</p>\n\n<p>You should also strongly consider dramatically simplifying the <code>Temperature_sensor</code> class. It appears to have numerous instance variables that redundantly store the same information in different formats, and which would make more sense as local variables inside your functions.</p>\n\n<p>You also don't need to be creating all those <code>std::stringstream</code>'s; consider using <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stof\" rel=\"nofollow noreferrer\"><code>std::stod()</code></a> and <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow noreferrer\"><code>std::stoi()</code></a> to convert strings to floating-point or integers, and <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/to_string\" rel=\"nofollow noreferrer\"><code>std::to_string()</code></a> to convert numbers to strings.</p>\n"}], "owner": {"reputation": 47, "user_id": 2868151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75470ee86d8d8188ca40e47ac7be7556?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/2868151/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1510168464, "creation_date": 1510162199, "last_edit_date": 1510164677, "question_id": 47186069, "link": "https://stackoverflow.com/questions/47186069/how-to-insert-structure-pointer-into-stl-vector-and-display-the-content", "title": "How to insert structure pointer into stl vector and display the content", "body": "<p>I am calling a function in a loop which takes argument as structure pointer (st *ptr) and i need to push_back this data to a STL vector and display the content in a loop.How can i do it? please help.</p>\n\n<pre><code>struct st\n{\n    int a;\n    char c;\n};\ntypedef struct st st;\n\n\nfunction(st *ptr)\n{\n    vector&lt;st*&gt;myvector;\n    vector&lt;st*&gt;:: iterator it;\n    myvector.push_back(ptr);\n    it=myvector.begin();\n    cout&lt;&lt;(*it)-&gt;a&lt;&lt;(*it)-&gt;c&lt;&lt;endl;\n}\n</code></pre>\n\n<p>is this correct? i am not getting the actual output.</p>\n\n<p>Code snippet-----</p>\n\n<pre><code>void Temperature_sensor::temp_notification()//calling  thread in a class------\n{\n\n    cout&lt;&lt;\"Creating thread to read the temperature\"&lt;&lt;endl;\n    pthread_create(&amp;p1,NULL,notifyObserver_1,(void*)(this));\n    pthread_create(&amp;p2,NULL,notifyObserver_2,(void*)(this));\n    pthread_join(p1,NULL);\n    pthread_join(p2,NULL);\n\n}\n\n\nvoid* Temperature_sensor::notifyObserver_1(void *data)\n{\n\n    Temperature_sensor *temp_obj=static_cast&lt;Temperature_sensor *&gt;(data);   \n    (temp_obj)-&gt;it=(temp_obj)-&gt;observers.begin();\n    ifstream inputfile(\"temp.txt\");//Reading a text file \n\n    while(getline(inputfile,(temp_obj)-&gt;line))\n    {\n        stringstream linestream((temp_obj)-&gt;line);\n        getline(linestream,(temp_obj)-&gt;temperature,':');\n        getline(linestream,(temp_obj)-&gt;temp_type,':');\n        cout&lt;&lt;(temp_obj)-&gt;temperature&lt;&lt;\"---\"&lt;&lt;(temp_obj)-&gt;temp_type&lt;&lt;endl;\n        stringstream ss((temp_obj)-&gt;temperature);\n        stringstream sb((temp_obj)-&gt;temp_type);\n        sb&gt;&gt;(temp_obj)-&gt;c_type;\n        ss&gt;&gt;(temp_obj)-&gt;f_temp;\n        cout&lt;&lt;\"____\"&lt;&lt;(temp_obj)-&gt;f_temp&lt;&lt;endl;\n        (temp_obj)-&gt;a.temp=(temp_obj)-&gt;f_temp;\n        (temp_obj)-&gt;a.type=(temp_obj)-&gt;c_type;\n        cout&lt;&lt;\"------------------q\"&lt;&lt;(temp_obj)-&gt;a.type&lt;&lt;endl;\n        (*(temp_obj)-&gt;it)-&gt;update(&amp;(temp_obj)-&gt;a);//Calling the function -------\n\n}\n</code></pre>\n\n<pre>input file temp.txt\n20:F\n30:C\n40:c\netc</pre>\n\n<pre><code>void Temperature_monitor::update(st *p) {}//need to store in a vector------\n</code></pre>\n"}, {"tags": ["c++", "class", "oop", "inheritance", "casting"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1510161841, "post_id": 47185936, "comment_id": 81320972, "body": "Who guaranteed binary compatibility to you? The C++ standard surely doesn&#39;t."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1510162094, "post_id": 47185936, "comment_id": 81321114, "body": "No, it&#39;s undefined behaviour Read about aliasing."}, {"owner": {"reputation": 781, "user_id": 3802059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bc9b09003456393fe147dce385b444?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/3802059/ian"}, "edited": false, "score": 0, "creation_date": 1510162410, "post_id": 47185936, "comment_id": 81321277, "body": "Others have said it is undefined.  If you are going to do it anyway, you might want to protect yourself a bit with some static_asserts: #include &lt;cstddef&gt; static_assert(offsetof(A,x)==offsetof(B,x), &quot;strange compiler behaviour&quot;); static_assert(sizeof(A)==sizeof(B), &quot;strange compiler behaviour&quot;); static_assert(sizeof(A::x)==sizeof(B::x), &quot;strange compiler behaviour&quot;);"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 781, "user_id": 3802059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00bc9b09003456393fe147dce385b444?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/3802059/ian"}, "edited": false, "score": 1, "creation_date": 1510162810, "post_id": 47185936, "comment_id": 81321523, "body": "@Ian - You know, compilers do lots of things that may seem strange. But they can do them for good reasons. For instance writing specific things into padding bytes, to support various types of diagnostics. It&#39;s not that strange, once you <i>really</i> think about it. And it&#39;s something one should work with, not against. Those static assertions won&#39;t protect you, or the OP."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1510163364, "post_id": 47185936, "comment_id": 81321865, "body": "In this instance you could define a global comparison operators <code>bool operator==(const A&amp;a, const B&amp;b);</code> (and/or variants taking <code>const A&amp;, const A&amp;</code> or <code>const B&amp;, const A&amp;</code>) to do this without the casting."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1510169353, "post_id": 47185936, "comment_id": 81325467, "body": "@1201ProgramAlarm Talk about an X/Y question! From the faulty premise that comparison with <code>==</code> requires a member <code>operator</code>, straight to a question about undefined casting hackery."}], "owner": {"reputation": 227, "user_id": 2766707, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9eeb589621bc87945b14f3b6a3a5bcb0?s=128&d=identicon&r=PG&f=1", "display_name": "bernd feinman", "link": "https://stackoverflow.com/users/2766707/bernd-feinman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1510163158, "answer_count": 0, "score": 0, "last_activity_date": 1510161799, "creation_date": 1510161779, "last_edit_date": 1510161799, "question_id": 47185936, "link": "https://stackoverflow.com/questions/47185936/is-it-safe-to-cast-a-class-to-a-differnt-binary-equal-class", "closed_reason": "Duplicate", "title": "Is it safe to cast a class to a differnt, binary equal class?", "body": "<p>I am wondering if it is safe to case one class to binary-equal class that is nevertheless not the same class. </p>\n\n<p>Background: I want to do some operator-magic without \"polluting\" the original class (here A).</p>\n\n<pre><code>class A\n{\npublic:\n    int x;\n    virtual ~A() = default;\n};\n\nclass B : public A\n{\npublic:\n    B(int x) { this-&gt;x = x; }\n    bool operator==(const B&amp; b)\n    {\n        return x == b.x;\n    }\n};\n\n\n    A a;\n    a.x = 1;\n    B* b = (B*)&amp;a;\n    *b == B(1);\n</code></pre>\n\n<p>This works on all my systems, but is it safe/portable to do?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1510163411, "post_id": 47185924, "comment_id": 81321894, "body": "If what you say is true, you don&#39;t need any of the code in your C++ file to produce the problem. Just <code>#include &quot;headerGile.h&quot;</code> will do it. But this code won&#39;t produce the problem you describe; there&#39;s something else going on that you haven&#39;t mentioned."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 2148571, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70cdee5cef9b160a166f654001240447?s=128&d=identicon&r=PG", "display_name": "user2148571", "link": "https://stackoverflow.com/users/2148571/user2148571"}, "is_accepted": true, "score": 1, "last_activity_date": 1510181956, "creation_date": 1510181956, "answer_id": 47191163, "question_id": 47185924, "link": "https://stackoverflow.com/questions/47185924/including-class-less-header-file-in-another-c-file/47191163#47191163", "title": "including class-less header file in another c++ file", "body": "<p>I just found a solution. I was not including the required header files :</p>\n\n<pre><code>#include&lt;stdint.h&gt;\n#include&lt;stdlib.h&gt;\n</code></pre>\n\n<p>I included this both file in header file and this error is gone.</p>\n"}], "owner": {"reputation": 129, "user_id": 2148571, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70cdee5cef9b160a166f654001240447?s=128&d=identicon&r=PG", "display_name": "user2148571", "link": "https://stackoverflow.com/users/2148571/user2148571"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 47191163, "answer_count": 1, "score": -1, "last_activity_date": 1510181956, "creation_date": 1510161749, "question_id": 47185924, "link": "https://stackoverflow.com/questions/47185924/including-class-less-header-file-in-another-c-file", "title": "including class-less header file in another c++ file", "body": "<p>I have a header file as follows :</p>\n\n<pre><code>int64_t *id;\nint *sz;\n\nvoid setupUnionFind(int numNodes)\n{\n  id = (int64_t *)malloc(numNodes*sizeof(int64_t));\n  sz = (int *)malloc(numNodes*sizeof(int));\n  for (int64_t i = 0; i &lt; numNodes; i++)\n  {\n    id[i] = i;\n    sz[i] = 0;\n  }\n}\n</code></pre>\n\n<p>I am including this in another c++ file as follows :</p>\n\n<pre><code>#include \"headerGile.h\"\n#include \"gtest/gtest.h\"  \n\nclass UnionFindMethodsTest : public testing::Test {\n  protected:\n\n  //constructor\n  UnionFindMethodsTest(){ \n  int numNodes = 10;\n  setupUnionFind(numNodes); \n\n  }\n\n  //destructor\n  virtual ~UnionFindMethodsTest(){\n\n  }\n\n};\nother functions below this ......\n</code></pre>\n\n<p>When I compile this file, it says that id, sz of the header file was not declared in this scope. I mean it complains the same thing for every variable in the header file. \nI am not able to figure out what is going on here.</p>\n"}, {"tags": ["c++", "winapi"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 2, "creation_date": 1510160262, "post_id": 47185395, "comment_id": 81319904, "body": "Beware the memory leak.  There&#39;s not really a good reason for dynamic allocation here."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1510160288, "post_id": 47185395, "comment_id": 81319923, "body": "I suggest you add an <code>else</code> clause and see if you have some other event types sneaking in"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1510160316, "post_id": 47185395, "comment_id": 81319951, "body": "Plus, you have sleeps and returns in the loop, you&#39;re not necessarily looking at every event."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1510160497, "post_id": 47185395, "comment_id": 81320061, "body": "@Ben Voight The returns are called when the player reaches the end and I doubt if that causes the problem. I tried running with only the mouse events&#39; If statement and it still didnt work."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1510160645, "post_id": 47185395, "comment_id": 81320169, "body": "@BenVoigt Over event types comes in only when i resize and open the console. Also, is there any smoother better way for receiving input in C++ console? I know C++ console is bad in these situations, but I have no other choice."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510200861, "post_id": 47185395, "comment_id": 81336628, "body": "You&#39;re setting <code>ENABLE_WINDOW_INPUT | ENABLE_INSERT_MODE | ENABLE_EXTENDED_FLAGS | ENABLE_MOUSE_INPUT</code> on the <i>screen buffer</i> handle, <code>hOut</code>. Obviously that fails, as it should, but you&#39;re not checking the return value of <code>SetConsoleMode</code> to see that it fails."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510223953, "post_id": 47185395, "comment_id": 81347801, "body": "@eryksun Ahh, so thats where it got messed up. It works now, thanks. I was pretty confused about the way the func <code>SetConsoleMode</code> worked and kinda ignored it because it worked then."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510225618, "post_id": 47185395, "comment_id": 81348916, "body": "@eryksun Is there any must-have parameters because i&#39;m not sure if i&#39;m using the SetConsoleMode function correctly. Right now, i&#39;ve <code>ENABLE_WINDOW_INPUT | ENABLE_LINE_INPUT | ENABLE_EXTENDED_FLAGS | ENABLE_MOUSE_INPUT</code>"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510234767, "post_id": 47185395, "comment_id": 81355088, "body": "You&#39;re not using window-input mode in the code you&#39;ve show. Also, line-input mode is really only relevant with a cooked read (<code>ReadConsole</code>, <code>ReadFile</code>). Enabling extended flags is required to disable insert mode and quick-edit mode. Disabling the latter is required for getting mouse input, but you may want insert mode enabled. You may also want to enable processed input to get Ctrl+C console control events; otherwise only Ctrl+Break works."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510234897, "post_id": 47185395, "comment_id": 81355191, "body": "IMO, you&#39;re changing the console settings so much that you should consider making it a GUI app that calls <code>AllocConsole</code> for a private console. Otherwise you should save all of the current settings at startup and restore them at shutdown. Of course if your program crashes or gets terminated, your shutdown code won&#39;t run, and the console will be left in this possibly unusable state."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510243159, "post_id": 47185395, "comment_id": 81361390, "body": "@eryksun What do you mean by save all of the current settings? Right now I call the fuction InitScr whenever my program starts and I don&#39;t think i&#39;ll use AllocConsole for now. It&#39;s just a pet project for my highschool so I don&#39;t want to optimize it but rather keep it as a program that works pretty fine, and not near flawless-ish. I&#39;ll check out about AllocConsole if I have time though."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510243529, "post_id": 47185395, "comment_id": 81361673, "body": "The console state at startup includes the window position, state, size, screen buffer size, cursor visibility, console input buffer and screen buffer modes, including insert mode and quick-edit mode. If your program is run from CMD it restores some of this state after it resumes, but not all of it, and definitely none of it will be restored from other programs such as calling your program from Python, etc. You&#39;ve basically trashed the console. That&#39;s fine if it&#39;s yours to modify (<code>AllocConsole</code>), but ugly if you&#39;ve inherited the console."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510243987, "post_id": 47185395, "comment_id": 81362029, "body": "@eryksun I see, it&#39;ll most probably only be used in CMD but I&#39;ll modify the code so that it&#39;ll use <code>AllocConsole</code> so that I&#39;ll get bit more familiar with these stuff. Thanks for the help btw."}, {"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1510248109, "post_id": 47185395, "comment_id": 81364959, "body": "@eryksun Oh and another question, I don&#39;t know if i have to create a new thread but when I get the input which checks whether they&#39;re holding or not, it takes some time to confirm it and it kinda messes with the smooth flow of movement of my &#39;hero&#39; in the maze. Like if i hold up arrow, it moves one step up, waits around 250ms? not sure and then keeps moving up until i stop. So, is there any better way for receiving the Inputs or should I alter my if conditions and other things to make it smoother, probably something related to game theory? im not sure."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "edited": false, "score": 0, "creation_date": 1510160785, "post_id": 47185517, "comment_id": 81320278, "body": "I added the <code>ENABLE_MOUSE_INPUT</code> and it doesn&#39;t seem to affect this. I&#39;ll look onto the functions which discard the mouse events."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160442, "creation_date": 1510160442, "answer_id": 47185517, "question_id": 47185395, "link": "https://stackoverflow.com/questions/47185395/mouse-events-not-read-in-c-console/47185517#47185517", "title": "Mouse events not read in C++ console", "body": "<p>You may need to pass the <code>ENABLE_MOUSE_INPUT</code> flag to <a href=\"https://docs.microsoft.com/en-us/windows/console/setconsolemode\" rel=\"nofollow noreferrer\"><code>SetConsoleMode()</code></a>.</p>\n\n<p>Also notice that some functions will discard console mouse events.  Read the notes at the linked <code>SetConsoleMode</code> documentation.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 9752311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e289bcfe0c4e932b3e07dae22a60f5?s=128&d=identicon&r=PG&f=1", "display_name": "NEStenerus nester", "link": "https://stackoverflow.com/users/9752311/nestenerus-nester"}, "is_accepted": false, "score": 1, "last_activity_date": 1606214726, "creation_date": 1606214726, "answer_id": 64984807, "question_id": 47185395, "link": "https://stackoverflow.com/questions/47185395/mouse-events-not-read-in-c-console/64984807#64984807", "title": "Mouse events not read in C++ console", "body": "<p>Your problem is enabled selection by mouse in console.</p>\n<p>just open your console <code>(Win + r) -&gt; cmd</code>, open properties and disable highlighting function <a href=\"https://i.stack.imgur.com/Fep9f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fep9f.png\" alt=\"enter image description here\" /></a></p>\n<p>(I have russian language as my default, but checkbox that you need must be here (i highlighted it by red line))</p>\n"}], "owner": {"reputation": 31, "user_id": 7095593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5696dfb2064b5330a12d0cf97f7b062?s=128&d=identicon&r=PG&f=1", "display_name": "Teisted", "link": "https://stackoverflow.com/users/7095593/teisted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1606214726, "creation_date": 1510160085, "last_edit_date": 1510161293, "question_id": 47185395, "link": "https://stackoverflow.com/questions/47185395/mouse-events-not-read-in-c-console", "title": "Mouse events not read in C++ console", "body": "<p>When I move my mouse or do any mouse related operations like clicking, it isn't picked up or read by <code>ReadConsoleInput</code> while keyboard events are picked up.</p>\n\n<p>It used to work but now, I don't know what's causing problems which blocks the reading of mouse events.</p>\n\n<p>This is the code i'm using, and I referred from <a href=\"http://www.benryves.com/tutorials/winconsole/3\" rel=\"nofollow noreferrer\">This Website</a></p>\n\n<pre><code>DWORD numEvents = 0;\nDWORD numEventsRead = 0;\nwhile (appIsRunning)\n{\n    reachedEnd = false;\n    GetNumberOfConsoleInputEvents(Input_Handle, &amp;numEvents);\n    if (numEvents != 0)\n    {\n        INPUT_RECORD *eventBuffer = new INPUT_RECORD[numEvents];\n        ReadConsoleInput(Input_Handle, eventBuffer, numEvents, &amp;numEventsRead);\n        for (DWORD i = 0; i &lt; numEventsRead; ++i)\n        {\n            if (eventBuffer[i].EventType == KEY_EVENT) // this works\n            {\n                . // other \n                . // functions\n                if (eventBuffer[i].Event.KeyEvent.uChar.UnicodeChar == 'c' &amp;&amp; eventBuffer[i].Event.KeyEvent.bKeyDown)\n                    return true;\n            }\n            else if (eventBuffer[i].EventType == MOUSE_EVENT) // this doesnt work\n            {\n                cout &lt;&lt; \" E\";\n                if (eventBuffer[i].Event.MouseEvent.dwButtonState == FROM_LEFT_1ST_BUTTON_PRESSED)\n                {\n                    char x[50];\n                    fstream file;\n                    file.open(\"test.txt\", ios::out);\n                    cout &lt;&lt; \" YY\";\n                    SetConsoleCursorPosition(Output_Handle, { eventBuffer[i].Event.MouseEvent.dwMousePosition.X , eventBuffer[i].Event.MouseEvent.dwMousePosition.Y });\n                    cin &gt;&gt; x;\n                    file &lt;&lt; \"SetConsoleCursorPosition(out, { \"\n                        &lt;&lt; eventBuffer[i].Event.MouseEvent.dwMousePosition.X &lt;&lt; \" , \"\n                        &lt;&lt; eventBuffer[i].Event.MouseEvent.dwMousePosition.Y &lt;&lt; \"});   \"\n                        &lt;&lt; x;\n\n                }\n            }\n        }\n        delete[] eventBuffer;\n    }\n    if (reachedEnd)\n        return true;\n}\n</code></pre>\n\n<p>I guess i should also post the code which sets the console mode and stuff</p>\n\n<pre><code>void initScr(COORD bufferSize, HANDLE&amp; hOut, HANDLE&amp; hIn, SMALL_RECT screen, SMALL_RECT side, Box&amp; screenBox, Box&amp; sideBox)\n{\n    hOut = GetStdHandle(STD_OUTPUT_HANDLE);\n    hIn = GetStdHandle(STD_INPUT_HANDLE);\n    CONSOLE_CURSOR_INFO cursorInfo;\n    SMALL_RECT windowSize = { 0, 0, bufferSize.X - 1, bufferSize.Y - 1 };\n\n    SetWindowPos(GetConsoleWindow(), HWND_TOPMOST, 5, 5, 0, 0, SWP_NOREDRAW | SWP_SHOWWINDOW | SWP_NOSIZE);\n    SetConsoleWindowInfo(hOut, true, &amp;windowSize);\n    SetConsoleScreenBufferSize(hOut, bufferSize);\n    SetConsoleMode(hOut, ENABLE_WINDOW_INPUT | ENABLE_INSERT_MODE | ENABLE_EXTENDED_FLAGS | ENABLE_MOUSE_INPUT);\n    cls(hOut); //Clears the whole screen\n    SetConsoleTitle(L\"The Game\");\n\n    GetConsoleCursorInfo(hOut, &amp;cursorInfo);\n    cursorInfo.bVisible = false;\n    SetConsoleCursorInfo(hOut, &amp;cursorInfo);\n\n    screenBox.drawBox(screen, hOut, COLOR(bRed | bGreen | bBright ));\n    sideBox.drawBox(side, hOut, COLOR(bRed | bGreen | bBright));\n    setcursorPos({ 91, 5 }, hOut);\n    cout &lt;&lt; \"Press \\'C\\' to re-create maze\";\n    setcursorPos({ 91, 7 }, hOut);\n    cout &lt;&lt; \" Arrow keys for movement.\";\n    setcursorPos({ 0,0 }, hOut);\n}\n</code></pre>\n\n<p>I guess this part of my code is quite messy.</p>\n"}, {"tags": ["c++", "c", "double"], "comments": [{"owner": {"reputation": 1297, "user_id": 5042431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VZqF.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5042431/charles"}, "edited": false, "score": 0, "creation_date": 1510159457, "post_id": 47185165, "comment_id": 81319373, "body": "<code>double</code>s are only so precise."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1510159509, "post_id": 47185165, "comment_id": 81319407, "body": "By using an external library."}, {"owner": {"reputation": 317, "user_id": 5967672, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b7ebe06a44265a719b7a0594f259fe22?s=128&d=identicon&r=PG&f=1", "display_name": "Sv Sv", "link": "https://stackoverflow.com/users/5967672/sv-sv"}, "edited": false, "score": 0, "creation_date": 1510159512, "post_id": 47185165, "comment_id": 81319410, "body": "By writing a custom cpp compiler or adding some flags to the existing ones."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1510159540, "post_id": 47185165, "comment_id": 81319428, "body": "you really need more accuracy than a long double ?"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 1, "creation_date": 1510159585, "post_id": 47185165, "comment_id": 81319464, "body": "You can&#39;t increase accuracy in <code>double</code>. Nor any other primitive type for that mater."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1510159655, "post_id": 47185165, "comment_id": 81319514, "body": "Printing decimal digits of a fraction is a problem completely unrelated to <code>double</code>, if that&#39;s what you want to do I&#39;m sure there is an appropriate duplicate on this site"}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1510159912, "post_id": 47185165, "comment_id": 81319677, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35651574/printf-big-double-value-with-high-precision-in-c\">Printf big double value with high precision in C</a>"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1510163264, "post_id": 47185165, "comment_id": 81321794, "body": "Perhaps the more interesting question is why do you need better accuracy?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510167578, "post_id": 47185165, "comment_id": 81324369, "body": "Step 1: Use correct print specifier  <code>printf(&quot;%.62LLF&quot;, a);</code> --&gt; <code>printf(&quot;%.62LF&quot;, a);</code>  (one L and enable all compiler warings).  2) Use exponential notation <code>&quot;%.62Le&quot;</code>.  3) Use <code>a</code> for complete hex output <code>printf(&quot;%La\\n&quot;, a);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "is_accepted": true, "score": 2, "last_activity_date": 1510159635, "creation_date": 1510159635, "answer_id": 47185250, "question_id": 47185165, "link": "https://stackoverflow.com/questions/47185165/increase-long-double-accuracy/47185250#47185250", "title": "increase long double accuracy", "body": "<p>Floating Point Numbers have a limited precision. <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Mandatory Reading Here</a>.</p>\n\n<p>The <a href=\"http://www.boost.org/doc/libs/1_65_1/libs/multiprecision/doc/html/index.html\" rel=\"nofollow noreferrer\">boost.multiprecision</a> library can give you access to higher precision floating point numbers, whether in the form of <code>quad</code> types which simply double the precision of <code>double</code>, or in the form of arbitrary precision <code>rational</code> numbers. If you're willing to take the time to learn how to install and use that library, you'll be able to improve the precision of your numbers.</p>\n"}], "owner": {"reputation": 115, "user_id": 8795358, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqJbI.jpg?s=128&g=1", "display_name": "Tanhaeirad", "link": "https://stackoverflow.com/users/8795358/tanhaeirad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "closed_date": 1510874651, "accepted_answer_id": 47185250, "answer_count": 1, "score": -4, "last_activity_date": 1510159635, "creation_date": 1510159356, "question_id": 47185165, "link": "https://stackoverflow.com/questions/47185165/increase-long-double-accuracy", "closed_reason": "Needs details or clarity", "title": "increase long double accuracy", "body": "<p>how can I increase accuracy in double.</p>\n\n<p>for example in this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint main() {\n    long double a = (long double) 5 / 3;\n    printf(\"%.62LLF\", a);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "serialization", "struct"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1510159500, "post_id": 47185127, "comment_id": 81319401, "body": "You seem to be assuming that the size of <code>Direction</code> is the same as the size of an <code>int</code>.  That may indeed be the case, but C++ does not guarantee it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1510159751, "post_id": 47185127, "comment_id": 81319573, "body": "You also seem to be assuming that the members of <code>CommIO::CommCommand</code> will be laid out in memory without any padding between, which again may happen to be the case, but is not guaranteed."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1510160047, "post_id": 47185127, "comment_id": 81319754, "body": "Think about the difference between <code>wData</code> and <code>&amp;wData</code>. Which one is the address of the buffer you just allocated?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1510162115, "post_id": 47185127, "comment_id": 81321124, "body": "Search the internet for &quot;C++ Serialization&quot;.  Your process is called &quot;serialization&quot;."}, {"owner": {"reputation": 3, "user_id": 8908173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde77b726a952cd35acfb5f4a5342bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agallen90", "link": "https://stackoverflow.com/users/8908173/agallen90"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510162148, "post_id": 47185127, "comment_id": 81321144, "body": "@JohnBollinger will the #pragma pack() directives help with this?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1510162468, "post_id": 47185127, "comment_id": 81321322, "body": "@Agallen90, depending on your C++ compiler and on exactly how you apply <code>#pragma pack</code>, you might that way avoid padding between members.  That is inherently non-portable.  Packing does nothing for the possible mismatch between the size of <code>Direction</code> and the size of <code>int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1510160422, "post_id": 47185448, "comment_id": 81320006, "body": "You were on the right track until you started dereferencing."}, {"owner": {"reputation": 108, "user_id": 8906366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c004a5d4aa197432923504fbae8a8b8d?s=128&d=identicon&r=PG&f=1", "display_name": "crudeyDrawn", "link": "https://stackoverflow.com/users/8906366/crudeydrawn"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1510160925, "post_id": 47185448, "comment_id": 81320384, "body": "@molbdnilo I don&#39;t see my mistake. Can you explain?"}], "tags": [], "owner": {"reputation": 108, "user_id": 8906366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c004a5d4aa197432923504fbae8a8b8d?s=128&d=identicon&r=PG&f=1", "display_name": "crudeyDrawn", "link": "https://stackoverflow.com/users/8906366/crudeydrawn"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160577, "last_edit_date": 1510160577, "creation_date": 1510160228, "answer_id": 47185448, "question_id": 47185127, "link": "https://stackoverflow.com/questions/47185127/c-struct-to-byte-throwing-error/47185448#47185448", "title": "C++ Struct to Byte* throwing error", "body": "<p>At</p>\n\n<pre><code>memcpy(&amp;wData, bytes + offset, rwSize);\n</code></pre>\n\n<p>you copy from the location of the wData pointer and to the location of the wData pointer of the new CommCommand. But you want to copy from and to the location that the pointer points to. You need to dereference. You corrupt the heap, because you have only sizeof(BYTE*) space (plus some extra, because heap blocks cannot be arbitrarily small), but you copy rwSize bytes, which is 128 bytes. What you probably meant to write is:</p>\n\n<pre><code>memcpy(wData, *(BYTE*)(bytes + offset), rwSize);\n</code></pre>\n\n<p>which would take use the pointer stored at bytes + offset, rather than the value of bytes + offset itself.</p>\n\n<p>You also assume that your struct is tightly packed. However, C++ does not guarantee that. Is there a reason why you do not override the default copy constructor rather than write this function?</p>\n"}, {"tags": [], "owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160236, "creation_date": 1510160236, "answer_id": 47185450, "question_id": 47185127, "link": "https://stackoverflow.com/questions/47185127/c-struct-to-byte-throwing-error/47185450#47185450", "title": "C++ Struct to Byte* throwing error", "body": "<p>The memory for your struct is laid out without padding, this can be rectified by adding the macro <code>#pragma pack(1)</code> at the start of the struct and <code>#pragma pop()</code> at the end of the struct - check its syntax though.</p>\n\n<p>For your struct to byte conversion, I would use something simple as:</p>\n\n<pre><code>template&lt;typename T, typename IteratorForBytes&gt;\nvoid ConvertToBytes(const T&amp; t, IteratorForBytes bytes, std::size_t pos = 0)\n{\n    std::advance(bytes, pos);\n    const std::size_t length = sizeof(t);\n    const uint8_t* temp = reinterpret_cast&lt;const uint8_t*&gt;(&amp;t);\n    for (std::size_t i = 0; i &lt; length; ++i)\n    {\n        (*bytes) = (*temp);\n        ++temp; \n        ++bytes;\n    }\n}\n</code></pre>\n\n<p>Where <code>T</code> is the is the struct in your case your <code>Command</code> struct and <code>bytes</code> would be the array.</p>\n\n<pre><code>CommIO::CommCommand command;\ncommand.wData = new BYTE[command.rwSize];\nConvertToBytes(command, command.wData); \n</code></pre>\n\n<p>The resulting array would contain the expected <code>bytes</code> You could specify the offset as well as an extra parameter if you want to start filling your byte array from a particular location</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160334, "creation_date": 1510160334, "answer_id": 47185481, "question_id": 47185127, "link": "https://stackoverflow.com/questions/47185127/c-struct-to-byte-throwing-error/47185481#47185481", "title": "C++ Struct to Byte* throwing error", "body": "<p>The main problem is here:</p>\n\n<pre><code>memcpy(&amp;wData, bytes + offset, rwSize);\n</code></pre>\n\n<p>Member <code>wData</code> is a <code>BYTE *</code>, and you seem to mean to copy bytes into the space to which it points.  Instead, you are copying data into the memory where the pointer value itself is stored.  Therefore, if you copy more bytes than the size of the pointer then you will overrun its bounds and produce undefined behavior.  In any case, you are trashing the original pointer value.  You probably want this, instead:</p>\n\n<pre><code>memcpy(wData, bytes + offset, rwSize);\n</code></pre>\n\n<p>Additionally, although the rest of the deserialization code may be right for your actual serialization format, it is not safe to assume that it is right for the byte sequence you present to it in your test program via</p>\n\n<pre><code>CommIO::CommCommand command2(reinterpret_cast&lt;BYTE*&gt;(&amp;command));\n</code></pre>\n\n<p>As detailed in comments, you are making assumptions about the layout in memory of a <code>CommIO::CommCommand</code> that C++ does not guarantee will hold.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 0, "last_activity_date": 1510162228, "last_edit_date": 1510162228, "creation_date": 1510160530, "answer_id": 47185543, "question_id": 47185127, "link": "https://stackoverflow.com/questions/47185127/c-struct-to-byte-throwing-error/47185543#47185543", "title": "C++ Struct to Byte* throwing error", "body": "<p>The following points mentioned in comments are most likely the causes of your problem.</p>\n\n<ol>\n<li><p>You seem to be assuming that the size of <code>Direction</code> is the same as the size of an <code>int</code>. That may indeed be the case, but C++ does not guarantee it.</p></li>\n<li><p>You also seem to be assuming that the members of <code>CommIO::CommCommand</code> will be laid out in memory without any padding between, which again may happen to be the case, but is not guaranteed.</p></li>\n</ol>\n\n<p>There are couple of ways to fix the that.</p>\n\n<ol>\n<li><p>Make sure that you fill up the <code>BYTE</code> array in the calling function with matching objects, or</p></li>\n<li><p>Simply cast the <code>BYTE*</code> to <code>CommCommand*</code> and access the members directly.</p></li>\n</ol>\n\n<p>For (1), you can use:</p>\n\n<pre><code>int command = 0x6AEA6BEB;\nint dir = CommIO::WRITE;\nint rwSize = 128;\n\ntotatlSize = rwSize + 3*sizeof(int);\nBYTE* data = new BYTE[totalSize];\n\nint offset = 0;\nmemcpy(data + offset, &amp;comand, sizeof(int));\noffset += sizeof(int);\nmemcpy(data + offset, &amp;dir, sizeof(int));\noffset += sizeof(int);\nmemcpy(data + offset, &amp;rwSize, sizeof(int));\noffset += sizeof(int);\n\nfor (int i = 0; i &lt; rwSize; i++)\n{\n   data[i + offset] = i;\n}\n\nCommIO::CommCommand command2(data);\n</code></pre>\n\n<p>For (2), you can use:</p>\n\n<pre><code>CommCommand(BYTE* bytes)\n{\n   CommCommand* in = reinterpret_cast&lt;CommCommand*&gt;(bytes);\n\n   command = in-&gt;command;\n   dir = in-&gt;dir;\n   rwSize = in-&gt;size;\n\n   wData = new BYTE[rwSize];\n   if (dir == WRITE)\n   {   \n      memcpy(wData, in-&gt;wData, rwSize);\n   }\n}\n</code></pre>\n\n<p>The other error is that you are using</p>\n\n<pre><code>memcpy(&amp;wData, bytes + offset, rwSize);\n</code></pre>\n\n<p>That is incorrect since you are treating the address of the variable as though it can hold the data. It cannot.</p>\n\n<p>You need to use:</p>\n\n<pre><code>memcpy(wData, bytes + offset, rwSize);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8908173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fde77b726a952cd35acfb5f4a5342bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agallen90", "link": "https://stackoverflow.com/users/8908173/agallen90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 47185543, "answer_count": 4, "score": -3, "last_activity_date": 1510162228, "creation_date": 1510159273, "last_edit_date": 1510159460, "question_id": 47185127, "link": "https://stackoverflow.com/questions/47185127/c-struct-to-byte-throwing-error", "title": "C++ Struct to Byte* throwing error", "body": "<p>I have attached my code below. I do not see what I am doing wrong. I have a struct that I am trying to serialize into a byte array. I have wrote some some simple code to test it.  It all appears to work during runtime when I print out the values of objects, but once I hit return 0 it throws the error: </p>\n\n<p><strong><em>Run-Time Check Failure #2 - Stack around the variable 'command' was corrupted.</em></strong></p>\n\n<p>I do not see the issue. I appreciate all help.</p>\n\n<pre><code>namespace CommIO\n{\n    enum Direction {READ, WRITE};\n\n    struct CommCommand\n    {\n        int command;\n        Direction dir;\n        int rwSize;\n        BYTE* wData;\n\n         CommCommand(BYTE* bytes)\n        {\n            int offset = 0;\n            int intsize = sizeof(int);\n\n            command = 0;\n            dir = READ;\n            rwSize = 0;\n\n            memcpy(&amp;command, bytes + offset, intsize);\n            offset += intsize;\n            memcpy(&amp;dir, bytes + offset, intsize);\n            offset += intsize;\n            memcpy(&amp;rwSize, bytes + offset, intsize);\n            offset += intsize;\n\n            wData = new BYTE[rwSize];\n            if (dir == WRITE)\n            {   \n                memcpy(&amp;wData, bytes + offset, rwSize);\n            }\n        }\n\n        CommCommand() {}\n    }\n\nint main()\n{\n    CommIO::CommCommand command;\n    command.command = 0x6AEA6BEB;\n    command.dir = CommIO::WRITE;\n    command.rwSize = 128;\n    command.wData = new BYTE[command.rwSize];\n    for (int i = 0; i &lt; command.rwSize; i++)\n    {\n        command.wData[i] = i;\n    }\n\n    command.print();\n\n    CommIO::CommCommand command2(reinterpret_cast&lt;BYTE*&gt;(&amp;command));\n    command2.print();\n    cin.get();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "qt", "mingw"], "comments": [{"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1510158922, "post_id": 47184858, "comment_id": 81319014, "body": "You added this to the <code>mac</code> section, yet you&#39;re running Windows. Why?"}, {"owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "reply_to_user": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1510160969, "post_id": 47184858, "comment_id": 81320421, "body": "@MrEricSir actually the application is multi platform so I would need to generate the code coverage on both Windows and OS X. Until now I have only followed the tutorial mentioned (for OS X). As I explained, I read that the GCOV doesn&#39;t work with MinGW, but I have not tried it yet."}], "answers": [{"tags": [], "owner": {"reputation": 7482, "user_id": 313175, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/17983e85ea926e9e985c00d1a771f24a?s=128&d=identicon&r=PG", "display_name": "Alexander V", "link": "https://stackoverflow.com/users/313175/alexander-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1510163867, "creation_date": 1510163867, "answer_id": 47186577, "question_id": 47184858, "link": "https://stackoverflow.com/questions/47184858/code-coverage-in-qt-creator-using-mingw/47186577#47186577", "title": "Code coverage in Qt Creator using MinGW", "body": "<p>For this platform case your .pro file should contain:</p>\n\n<pre><code>win32 {\n  # MinGW-related settings\n}\n</code></pre>\n"}], "owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1281, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510168906, "creation_date": 1510158530, "last_edit_date": 1510168906, "question_id": 47184858, "link": "https://stackoverflow.com/questions/47184858/code-coverage-in-qt-creator-using-mingw", "title": "Code coverage in Qt Creator using MinGW", "body": "<p>How to generate and view code coverage using <strong>Qt Creator</strong> with <strong>MinGW</strong> on <strong>Windows</strong>?</p>\n\n<p>I'm already able to generate it using <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.3.0/gcc/Gcov.html\" rel=\"nofollow noreferrer\">GCOV</a> and <a href=\"http://ltp.sourceforge.net/coverage/lcov.php\" rel=\"nofollow noreferrer\">LCOV</a> on <strong>OS X</strong> with the following flags in my <code>.pro</code> file:</p>\n\n<pre><code>mac {\n    QMAKE_CXXFLAGS += --coverage\n    QMAKE_LFLAGS += --coverage\n}\n</code></pre>\n\n<p>I have accomplished that by following <a href=\"https://asmaloney.com/2017/01/code/code-coverage-of-unit-tests-using-qt-5-on-macos/\" rel=\"nofollow noreferrer\">this tutorial</a>.</p>\n\n<p>What tools/flags should I use to generate and view the code coverage on Windows?</p>\n\n<p><strong>Note</strong>: on OS X I'm using Clang.</p>\n\n<hr>\n\n<p><strong>Update</strong>:</p>\n\n<p>I have successfully generated the <strong>GCNO</strong> and <strong>GCDA</strong> files, but I don't know how can I access/visualize the code coverage properly.</p>\n\n<p>As far as I know, <strong>LCOV</strong> doesn't work on Windows.</p>\n\n<p>I found the <a href=\"https://github.com/valbok/lcov\" rel=\"nofollow noreferrer\">Ported to Windows LCOV Code Coverage tool</a> project on Github and I will try to use it.</p>\n\n<p>Some related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/4483370/qt-and-gcov-coverage-files-are-not-generated\">Qt and gcov, coverage files are not generated</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/13717920/can-gcov-be-used-in-windows\">Can GCov be used in windows?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/1816981/is-there-any-actively-supported-lcov-port-for-windows\">Is there any actively supported lcov port for windows</a></p>\n"}, {"tags": ["c++", "list", "pointers", "crash"], "comments": [{"owner": {"reputation": 133, "user_id": 7917124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/28b25be229f3cdec1ce7dbad64a0f3f9?s=128&d=identicon&r=PG&f=1", "display_name": "AldenB", "link": "https://stackoverflow.com/users/7917124/aldenb"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510159181, "post_id": 47184824, "comment_id": 81319179, "body": "@Fran&#231;oisAndrieux How so? Replacing the Button pointer with nullptr yields the same result in both cases."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510159196, "post_id": 47184824, "comment_id": 81319186, "body": "Beware of raw owning pointers. For example, the use of raw owning pointers is causing <code>MainMenuState::MainMenuState(Demo&amp; demo)</code> to not be exception safe. You also need to keep the <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule of 0/3/5</a> in mind at all time if you choose to use them."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510159367, "post_id": 47184824, "comment_id": 81319309, "body": "I misunderstood the part where you mention <code>nullptr</code>. I&#39;ve retracted my first comment. But the point stands that the problem likely lies outside of the provided code. Consider preparing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 133, "user_id": 7917124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/28b25be229f3cdec1ce7dbad64a0f3f9?s=128&d=identicon&r=PG&f=1", "display_name": "AldenB", "link": "https://stackoverflow.com/users/7917124/aldenb"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510159618, "post_id": 47184824, "comment_id": 81319493, "body": "@Fran&#231;oisAndrieux The MainMenuState class does take care of copy assignment and construction. By not exception safe are you referring to std::bad_alloc?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510160001, "post_id": 47184824, "comment_id": 81319728, "body": "I&#39;m referring to the fact that stack unwinding doesn&#39;t (can&#39;t) automatically <code>delete</code> objects owned by raw pointers. It&#39;s not immediately obvious that no part of the constructor can throw, meaning you can potentially leak which violates even the basic exception guarantee. Perhaps the constructor can&#39;t possibly throw, but that can&#39;t be assumed from the snippet. Even if it can&#39;t the, design practices shown indicate that the situation is likely wide spread. If this is a concern for you, using smart pointers avoids these issues and many many other."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1510160181, "post_id": 47184824, "comment_id": 81319849, "body": "Please <a href=\"https://stackoverflow.com/posts/47184824/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3422, "user_id": 1458030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3728aa864efa903f4d0c7db9ac39989?s=128&d=identicon&r=PG", "display_name": "qPCR4vir", "link": "https://stackoverflow.com/users/1458030/qpcr4vir"}, "is_accepted": true, "score": 0, "last_activity_date": 1511517917, "last_edit_date": 1511517917, "creation_date": 1511516185, "answer_id": 47470264, "question_id": 47184824, "link": "https://stackoverflow.com/questions/47184824/adding-element-to-list-crashes-program-sometimes/47470264#47470264", "title": "Adding element to list crashes program...sometimes", "body": "<p>It is the order in with you created the objects.</p>\n\n<p>You call the constructor of the base class (<code>Application</code>) of <code>Demo</code> in the constructor list of <code>Demo</code> and the constructor of the member <code>fsm</code>. During the construction of <code>Demo</code>, the base class is constructed first, and only after that the other members of <code>Demo</code> are constructed in the order they are declared -first <code>fsm</code> and only afteer that the list <code>m_draw_list</code>. </p>\n\n<p>But to the constructor of <code>fsm</code> you try to pass a pointer result of a call to the constructor of <code>MainMenuState</code> passing to the last <code>*this</code> with is a partially constructed <code>Demo</code> object with no list yet. So in this call to <code>MainMenuState(Demo&amp; demo)</code> what crash your program is the intent to use an uninitialized list.</p>\n\n<p>You have to think about how to organize your code and prevent circular dependences of object creation. You may need to pass some of the parameters to already fully created objects, for example inside the body of the constructor, where all members are already constructed, including the list, like in the example that \"works\". In this case, alternatively you could declare the private list  <code>m_draw_list</code> before the public <code>fsm</code>.</p>\n"}], "owner": {"reputation": 133, "user_id": 7917124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/28b25be229f3cdec1ce7dbad64a0f3f9?s=128&d=identicon&r=PG&f=1", "display_name": "AldenB", "link": "https://stackoverflow.com/users/7917124/aldenb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 47470264, "answer_count": 1, "score": 0, "last_activity_date": 1511517917, "creation_date": 1510158451, "question_id": 47184824, "link": "https://stackoverflow.com/questions/47184824/adding-element-to-list-crashes-program-sometimes", "title": "Adding element to list crashes program...sometimes", "body": "<p>I'm working on a GUI project and for some reason the following call add_gfx_object() crashes my program.</p>\n\n<pre><code>MainMenuState::MainMenuState(Demo&amp; demo)\n    : m_start_button{new Button(Sol::Rectangle{Sol::Vector{10, 10}, 100, 30}, \n      [] {std::cout &lt;&lt; \"clicked\";})}\n{\n    demo.add_gfx_object(m_start_button); // &lt;-- crashes program\n}\n</code></pre>\n\n<hr>\n\n<p>The relevent code in the Demo class is listed here.</p>\n\n<pre><code>class Demo : public Sol::Application\n{\npublic:\n    StateMachine&lt;Demo&gt; fsm;\n\n    Demo();\n    ~Demo();\n\n    //...\n\n    void add_gfx_object(const GraphicalEntity* const obj) {m_draw_list.push_back(obj);}\n\nprivate:\n    std::list&lt;const GraphicalEntity*&gt; m_draw_list;\n\n    void draw_objects();\n};\n</code></pre>\n\n<hr>\n\n<p>Strangely enough, this call to add_gfx_object() does not crash my program.</p>\n\n<pre><code>Demo::Demo()\n    : Application(\"Demo\", 800, 600, false), fsm(*this, new MainMenuState(*this))\n{\n    add_gfx_object(new Button(Sol::Rectangle(), []{})); // &lt;-- does not crash program\n}\n</code></pre>\n\n<p>Replacing the Button pointers with nullptr in these examples yields the same results. As much as I would like to provide additional information on the issue, I am unable to. Can anyone shed some insight onto why my program keeps crashing?</p>\n"}, {"tags": ["c++", "inheritance", "polymorphism"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1510157943, "post_id": 47184595, "comment_id": 81318328, "body": "This example has no multiple inheritance. To unserstand the behaviour you need to understand the difference between virtual and non-virtual member functions."}, {"owner": {"reputation": 4581, "user_id": 2791577, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rFnoU.png?s=128&g=1", "display_name": "keith", "link": "https://stackoverflow.com/users/2791577/keith"}, "edited": false, "score": 0, "creation_date": 1510157949, "post_id": 47184595, "comment_id": 81318336, "body": "You are calling <code>move</code> on a <code>Canary</code> pointer and <code>move</code> is not virtual on a <code>Canary</code>."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1510158136, "post_id": 47184595, "comment_id": 81318458, "body": "I did not know birds &quot;mumble&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1510160637, "post_id": 47184595, "comment_id": 81320165, "body": "A good C++ book should explain that. Get one!"}], "answers": [{"tags": [], "owner": {"reputation": 8871, "user_id": 1132871, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/IO6V2.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1132871/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1510157946, "creation_date": 1510157946, "answer_id": 47184631, "question_id": 47184595, "link": "https://stackoverflow.com/questions/47184595/inheritance-and-pointers-in-c/47184631#47184631", "title": "Inheritance and pointers in C++", "body": "<p>The <code>move()</code> should also be <code>virtual</code> otherwise the version of the pointer type is called.</p>\n"}, {"comments": [{"owner": {"reputation": 38771, "user_id": 31317, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3fde1f239875d7d7ce65c12108d6fdd8?s=128&d=identicon&r=PG", "display_name": "peterchen", "link": "https://stackoverflow.com/users/31317/peterchen"}, "edited": false, "score": 1, "creation_date": 1510159193, "post_id": 47184839, "comment_id": 81319185, "body": "+1. Minor thing: I&#39;d replace <i>&quot;the compiler can resolve&quot;</i> with <i>&quot;the compiler does resolve&quot;</i> - since this is not optional, butrequired behavior."}, {"owner": {"reputation": 25, "user_id": 7936506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf60c9f681315e77b717d50f9bf3db0?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/7936506/jack"}, "edited": false, "score": 0, "creation_date": 1510164067, "post_id": 47184839, "comment_id": 81322287, "body": "Follow-up/clarify question: if yellow is a Canary, then why doesn&#39;t the virtual function move call the Canary implementation of move? You&#39;re saying that the pointer type determines the implementation for non-virtual functions, but <i>what the pointer points to</i> determines it for virtual functions? And that&#39;s because of how virtual works with the compiler, i.e. dynamic dispatch as you called it?"}, {"owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "reply_to_user": {"reputation": 25, "user_id": 7936506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf60c9f681315e77b717d50f9bf3db0?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/7936506/jack"}, "edited": false, "score": 0, "creation_date": 1510172373, "post_id": 47184839, "comment_id": 81327145, "body": "@Jack - <code>yellow</code> has a static type of <code>Canary</code>. Because you&#39;re calling via a pointer then polymorphism will apply to any virtual function you call. <code>noise</code> is a virtual function so it resolves to the implementation in <code>Tweety</code> as that&#39;s what <code>yellow</code> points to. <code>move</code> isn&#39;t virtual so it&#39;s resolved statically. This means the compiler looks at the static type of <code>yellow</code> (a <code>Canary</code>) and calls the <code>move</code> function in <code>Canary</code>. If you want it to be dynamically resolved at runtime you&#39;d have to make <code>move</code> virtual."}], "tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 6, "last_activity_date": 1510161272, "last_edit_date": 1510161272, "creation_date": 1510158478, "answer_id": 47184839, "question_id": 47184595, "link": "https://stackoverflow.com/questions/47184595/inheritance-and-pointers-in-c/47184839#47184839", "title": "Inheritance and pointers in C++", "body": "<p><code>noise</code> is virtual, so it is dynamically dispatched to the <code>Tweety</code> implementation when you call it.</p>\n\n<p><code>move</code> in not virtual, so the version to call is decided at compile time based on the type of you are dispatching the call through. Since <code>yellow</code> is a <code>Canary</code> the compiler does resolve what will be called at compile time and will explicitly call the <code>move</code> method in <code>Canary</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "is_accepted": false, "score": 0, "last_activity_date": 1510159236, "creation_date": 1510159236, "answer_id": 47185115, "question_id": 47184595, "link": "https://stackoverflow.com/questions/47184595/inheritance-and-pointers-in-c/47185115#47185115", "title": "Inheritance and pointers in C++", "body": "<p>Sean and Alex are spot on.</p>\n\n<p>Here are some more call cases that should help make sense of the different scenarios.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Bird {\n  public:\n    virtual void noise() { cout &lt;&lt; \"mumble\" &lt;&lt; endl; }\n    void move() { noise(); cout &lt;&lt; \"fly\" &lt;&lt; endl; }\n\n    void noise2() { cout &lt;&lt; \"mumble2\" &lt;&lt; endl; }\n    virtual void move2() { noise2(); cout &lt;&lt; \"fly2\" &lt;&lt; endl; }\n};\n\nclass Canary: public Bird {\n  public:\n    void noise() { cout &lt;&lt; \"chirp\" &lt;&lt; endl; }\n    void move() { noise(); cout &lt;&lt; \"flap\" &lt;&lt; endl; }\n\n    void noise2() { cout &lt;&lt; \"chirp2\" &lt;&lt; endl; }\n    void move2() { noise2(); cout &lt;&lt; \"flap2\" &lt;&lt; endl; }\n};\n\nclass Tweety: public Canary {\n  public:\n    void noise() { cout &lt;&lt; \"tweet\" &lt;&lt; endl; }\n    void move() { noise(); cout &lt;&lt; \"run\" &lt;&lt; endl; }\n\n    void noise2() { cout &lt;&lt; \"tweet2\" &lt;&lt; endl; }\n    void move2() { noise2(); cout &lt;&lt; \"run2\" &lt;&lt; endl; }\n};\n\nint main() {\n    Canary *yellow = new Tweety();\n    yellow-&gt;noise();\n    yellow-&gt;move();\n    yellow-&gt;noise2();\n    yellow-&gt;move2();\n    return 0;\n}\n\n/* OUTPUT:\ntweet    &lt;- virtual dispatch\ntweet    &lt;- virtual dispatch, via Bird::move()\nflap     &lt;- direct call\nchirp2   &lt;- direct call\ntweet2   &lt;- direct call, from Tweety::move2()\nrun2     &lt;- virtual dispatch\n*/\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7936506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf60c9f681315e77b717d50f9bf3db0?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/7936506/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1510161272, "creation_date": 1510157825, "last_edit_date": 1510158029, "question_id": 47184595, "link": "https://stackoverflow.com/questions/47184595/inheritance-and-pointers-in-c", "title": "Inheritance and pointers in C++", "body": "<p>I have this code example and I want to understand why it behaves the way it does. This is a question from a past exam paper in an intro C++ course. I'm studying for the exam now and trying to solidify my understanding of class inheritance.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Bird {\n  public:\n    virtual void noise() { cout &lt;&lt; \"mumble\" &lt;&lt; endl; }\n    void move() { noise(); cout &lt;&lt; \"fly\" &lt;&lt; endl; }\n};\n\nclass Canary: public Bird {\n  public:\n    void noise() { cout &lt;&lt; \"chirp\" &lt;&lt; endl; }\n    void move() { noise(); cout &lt;&lt; \"flap\" &lt;&lt; endl; }\n};\n\nclass Tweety: public Canary {\n  public:\n    void noise() { cout &lt;&lt; \"tweet\" &lt;&lt; endl; }\n    void move() { noise(); cout &lt;&lt; \"run\" &lt;&lt; endl; }\n};\n\nint main() {\n    Canary *yellow = new Tweety();\n    yellow-&gt;noise();\n    yellow-&gt;move();\n    return 0;\n}\n</code></pre>\n\n<p>I've run this code, and the output is:</p>\n\n<p>tweet\ntweet\nflap</p>\n\n<p>Which means it's calling the <em>Tweety</em> implementation of noise(), but it's calling the <em>Canary</em> implementation of move(). I'm confused about that. I understand the idea of polymorphism, and noise() is virtual, so it makes sense that it calls the Tweety version, since *yellow is a pointer to a Tweety. But why does it call the Canary version of move()? </p>\n\n<p>I think what's confusing me, is the line:</p>\n\n<pre><code>Canary *yellow = new Tweety();\n</code></pre>\n\n<p>This says that *yellow is a Canary pointer, which points to a Tweety object. I'm sort of ok with that, because I get that pointers to base class can point to derived class. But *yellow points to a Tweety, so why doesn't it use Tweety's move()?</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 3, "creation_date": 1510157744, "post_id": 47184533, "comment_id": 81318178, "body": "So what&#39;s your question?"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 9, "creation_date": 1510157745, "post_id": 47184533, "comment_id": 81318179, "body": "You forgot to annotate the copy and move constructors."}, {"owner": {"reputation": 70, "user_id": 3700819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff48d9d526a28599f05447082d84367?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/3700819/ted"}, "edited": false, "score": 0, "creation_date": 1510158204, "post_id": 47184533, "comment_id": 81318507, "body": "My question is why I don&#39;t see what expected:     Creating cVtst 34     Creating cVtst 2     Creating cVtst -5     Closing cVtst -5     Closing cVtst 2     Closing cVtst 34"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1510158241, "post_id": 47184533, "comment_id": 81318534, "body": "Because you forgot to annotate the copy and move constructors. Don&#39;t you believe @Mat?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1510158271, "post_id": 47184533, "comment_id": 81318558, "body": "And there may be more intermediate copies in between. Also, <a href=\"https://stackoverflow.com/posts/47184533/edit\">edit</a> your question to include all necessary information, don&#39;t just comment"}, {"owner": {"reputation": 70, "user_id": 3700819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff48d9d526a28599f05447082d84367?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/3700819/ted"}, "edited": false, "score": 0, "creation_date": 1510158469, "post_id": 47184533, "comment_id": 81318707, "body": "I don&#39;t understand Mat &amp; Bathsheba. Write right code, pls!"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 1, "creation_date": 1510158531, "post_id": 47184533, "comment_id": 81318750, "body": "You don&#39;t understand how a <code>std::vector</code> grows. There are copy/move operations you are not seeing."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1510159442, "post_id": 47184533, "comment_id": 81319359, "body": "Try adding <code>vc.reserve(3)</code> after creating the vector and then use <code>emplace_back</code> instead of <code>push_back</code> and then you should get the output you expect."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1510159277, "post_id": 47184873, "comment_id": 81319246, "body": "You should comment a bit and not only show code."}, {"owner": {"reputation": 70, "user_id": 3700819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff48d9d526a28599f05447082d84367?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/3700819/ted"}, "edited": false, "score": 0, "creation_date": 1510160245, "post_id": 47184873, "comment_id": 81319893, "body": "Yes! Thanks! I need to read more about these constructors. I did not know they existed!"}], "tags": [], "owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "is_accepted": true, "score": 2, "last_activity_date": 1510159769, "last_edit_date": 1510159769, "creation_date": 1510158573, "answer_id": 47184873, "question_id": 47184533, "link": "https://stackoverflow.com/questions/47184533/why-vector-not-free-objects-or-what-happens-anyway/47184873#47184873", "title": "Why vector not free objects or what happens anyway?", "body": "<p>Annotate your class a little more, and that should make clear what is happening.</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;cstdio&gt;\n\nusing std::printf;\nusing std::vector;\n\nclass cVtst {\n  static int seqCounter;\n  int seq;\n  int v;\npublic:\n  cVtst(int v) {\n    this-&gt;v = v;\n    this-&gt;seq = ++seqCounter;\n    printf(\"Creating cVtst#%d %d\\n\", seq, v);\n  }\n  ~cVtst() {\n    printf(\"Closing cVtst#%d %d\\n\", seq, v);\n  }\n  cVtst() {\n    this-&gt;v = ~0 &amp; (~0U &gt;&gt; 1);\n    this-&gt;seq = ++seqCounter;\n    printf(\"Default Creating cVtst#%d %d\\n\", seq, v);\n  }\n  cVtst(cVtst const&amp; other) {\n    this-&gt;v = other.v;\n    this-&gt;seq = ++seqCounter;\n    printf(\"Copy Creating cVtst#%d %d\\n\", seq, v);\n  }\n};\n\nint cVtst::seqCounter = 0;\n\nint main() {\n  vector&lt;cVtst&gt; vc;\n  vc.push_back(34);\n  vc.push_back(2);\n  vc.push_back(-5);\n  while (!vc.empty()) vc.pop_back();\n}\n</code></pre>\n\n<p>UPDATE:\nWhat your original example isn't taking into account is that the C++ compiler will synthesize a copy constructor and a default constructor.</p>\n\n<p>So your output is not showing those constructors, which is why you are seeing an unbalanced set of Creating and Closing output.  (I assume that your \"So...?\" question is \"Why are they Creating and Closing output unbalanced?\")</p>\n"}], "owner": {"reputation": 70, "user_id": 3700819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff48d9d526a28599f05447082d84367?s=128&d=identicon&r=PG&f=1", "display_name": "Ted", "link": "https://stackoverflow.com/users/3700819/ted"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1510159733, "accepted_answer_id": 47184873, "answer_count": 1, "score": -5, "last_activity_date": 1510159769, "creation_date": 1510157649, "last_edit_date": 1510157714, "question_id": 47184533, "link": "https://stackoverflow.com/questions/47184533/why-vector-not-free-objects-or-what-happens-anyway", "closed_reason": "Needs more focus", "title": "Why vector not free objects or what happens anyway?", "body": "<p>I don't understand what happens here! I define class cVtst, and create vector. I watch when the objects are created and destroyed.</p>\n\n<pre><code>class cVtst { \npublic: \n    int v;\n    cVtst(int v) { \n        this-&gt;v = v; \n        printf(\"Creating cVtst %d\\n\", v); \n    }\n    ~cVtst() { \n        printf(\"Closing cVtst %d\\n\", v);\n    } \n};\n\nstd::vector&lt;cVtst&gt; vc;\nvc.push_back(34); \nvc.push_back(2); \nvc.push_back(-5);\nwhile (!vc.empty()) vc.pop_back();\n</code></pre>\n\n<p>The result is:</p>\n\n<pre><code>Creating cVtst 34\nClosing cVtst 34\nCreating cVtst 2\nClosing cVtst 34\nClosing cVtst 2\nCreating cVtst -5\nClosing cVtst 34\nClosing cVtst 2\nClosing cVtst -5\nClosing cVtst -5\nClosing cVtst 2\nClosing cVtst 34\n</code></pre>\n\n<p>So ... ?</p>\n"}, {"tags": ["c++", "r", "rcpp", "rinside"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4243578, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1d656d7b7250a3d01e7c59511758548f?s=128&d=identicon&r=PG&f=1", "display_name": "francky", "link": "https://stackoverflow.com/users/4243578/francky"}, "is_accepted": false, "score": 0, "last_activity_date": 1510226432, "creation_date": 1510226432, "answer_id": 47200540, "question_id": 47184518, "link": "https://stackoverflow.com/questions/47184518/rinside-internalfunction-on-a-class-how-to-call-the-function-from-r/47200540#47200540", "title": "RInside InternalFunction on a class, how to call the function from R", "body": "<p>I found out, I post in case someone is searching:</p>\n\n<pre><code>R.parseEval(\"names.Solver(Solver)\");\n</code></pre>\n\n<p>Not very elegant to me .., it uses functionName.class(Object) ..</p>\n\n<p>F.</p>\n"}], "owner": {"reputation": 51, "user_id": 4243578, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1d656d7b7250a3d01e7c59511758548f?s=128&d=identicon&r=PG&f=1", "display_name": "francky", "link": "https://stackoverflow.com/users/4243578/francky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510226432, "creation_date": 1510157619, "question_id": 47184518, "link": "https://stackoverflow.com/questions/47184518/rinside-internalfunction-on-a-class-how-to-call-the-function-from-r", "title": "RInside InternalFunction on a class, how to call the function from R", "body": "<p>I need to call R from C++ and I am using the excellent RInside / Rccp packages.\nI am not an R specialist, this might explain my question and sorry if it's too obvious.</p>\n\n<p>I made an object and a wrapper class, something similar to the Rinside examples/standard/rinside_interactive0.cpp. In this example it shows how to attach a method to an R attribute class.</p>\n\n<pre><code>wr.attr(\"class\") = \"Solver\";    \nR[\"Solver\"] = wr;\n... more code\nR[\"names.Solver\"] = Rcpp::InternalFunction(&amp; Names); &lt;-- Hot to call this one from R\n</code></pre>\n\n<p>Actually I never see a call from R to this function, and what would be the R syntax ? I though, using R.parseEval in such way:</p>\n\n<pre><code>R.parseEval(\"Solver.names()\");\n</code></pre>\n\n<p>But this does not work and gives the error:</p>\n\n<pre><code>Error in Solver.names() : could not find function \"Solver.names\"\nterminate called after throwing an instance of 'std::runtime_error'\nwhat():  Error evaluating: Solver.names()\n</code></pre>\n\n<p>My question is then how to call the Solver.names function in R (that is handled in the C++ code) ?\nNote that the assign / retrieval function are working fine, maybe because they are somehow \"primitive\" ?</p>\n\n<p>Thanks a lot\nFranck</p>\n"}, {"tags": ["c++", "rcpp"], "comments": [{"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1510158309, "post_id": 47184442, "comment_id": 81318581, "body": "The functions make look similar...from the outside, but internally they are doing two very different things. Any attempt to merge these into one function is sure to turn out badly. I suggest you either leave them the way they are, or parameterize the functions on the vector types they operate on; i.e. pass in a vector not a pointer to C"}, {"owner": {"reputation": 2304, "user_id": 8442410, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6421347be0480937c5b116eee3e33a67?s=128&d=identicon&r=PG&f=1", "display_name": "JRR", "link": "https://stackoverflow.com/users/8442410/jrr"}, "edited": false, "score": 0, "creation_date": 1510158742, "post_id": 47184442, "comment_id": 81318889, "body": "Why do you want to template them. Their inputs/outputs are identical: <code>void</code> and <code>XPtr</code>. They are two different functions. This code sounds correct."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 8908237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d262b65d4ef269dce7721aed6e11bb2?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Meagher", "link": "https://stackoverflow.com/users/8908237/jack-meagher"}, "is_accepted": true, "score": 3, "last_activity_date": 1510161646, "last_edit_date": 1510161646, "creation_date": 1510159933, "answer_id": 47185346, "question_id": 47184442, "link": "https://stackoverflow.com/questions/47184442/rcpp-constructing-templated-functions/47185346#47185346", "title": "Rcpp: Constructing templated functions", "body": "<p>Templating can not be used directly here, but we can use it to accomplish what I think you want! Let's consider what you've got written and what it appears you would <em>like</em> to write directly.</p>\n\n<p>You have:</p>\n\n<pre><code>// [[Rcpp::export]]\nvoid second_int(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;i_vec[0] &lt;&lt; \"\\n\";\n}\n\n// [[Rcpp::export]]\nvoid second_str(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;s_vec[0] &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>and what you would like (this is not valid C++) is this:</p>\n\n<pre><code>// [[Rcpp::export]]\ntemplate&lt; membername member_to_extract &gt;\nvoid second(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;member_to_extract[0] &lt;&lt; \"\\n\";\n}\n\n/**\n * we would like to call it like this:\n * second&lt;i_vec&gt;(p) (to get the int value)\n * second&lt;s_vec&gt;(p) (to get the str value)\n */\n</code></pre>\n\n<p>Why doesn't this work? Well, checking <a href=\"http://en.cppreference.com/w/cpp/language/template_parameters\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/template_parameters</a>, we see that you can't pass variable names in as template parameters! So this approach is doomed to fail. (NOTE: You <em>can</em> use macros for this, which may be the solution you're looking for!)</p>\n\n<p>However, while your functions arguments and return types are the same, their behavior <em>is</em> decided solely based on the type you want to work with. If you are going to be using these functions in an already templated context, then it would be desirable to get second and second interfaces!</p>\n\n<p>Template specialization to the rescue!</p>\n\n<pre><code>// generic template. We need something that fails to compile\n// so that second&lt;int&gt; and second&lt;std::string&gt; are the only\n// specializations the compiler will allow us to use.\ntemplate&lt; typename T &gt;\nvoid second(XPtr&lt;C&gt; p)\n{\n  static_assert(false, \"second can't be used with this type.\");\n}\n\ntemplate&lt; &gt;\nvoid second&lt;int&gt;(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;i_vec[0] &lt;&lt; \"\\n\";\n}\n\ntemplate&lt; &gt;\nvoid second&lt;std::string&gt;(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;s_vec[0] &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>I think this is what you want? Note that if your platform is not line-buffered you probably want to use std::endl instead of \"\\n\", as it forces a flush (which is probably the behavior you want).</p>\n\n<p>EDIT: Partial specialization -> template specialization</p>\n"}], "owner": {"reputation": 1155, "user_id": 8470971, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c7620a849af9b26e4bdd372eb1874315?s=128&d=identicon&r=PG&f=1", "display_name": "N08", "link": "https://stackoverflow.com/users/8470971/n08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 47185346, "answer_count": 1, "score": 2, "last_activity_date": 1510161646, "creation_date": 1510157367, "question_id": 47184442, "link": "https://stackoverflow.com/questions/47184442/rcpp-constructing-templated-functions", "title": "Rcpp: Constructing templated functions", "body": "<p>I have the following MWE. It contains a class with two members, an integer and a string. Using the function <code>first</code> I create an object of the class and return a pointer to it. In <code>second_int</code> and <code>second_str</code> I output the two members.</p>\n\n<p>Given that <code>second_int</code> and <code>second_str</code> have more or less the same function, it seems obvious to me to template them. Is this possible to do within Rcpp given my MWE?</p>\n\n<pre><code>class C{\npublic:\n  std::vector&lt;int&gt; i_vec;\n  std::vector&lt;std::string&gt; s_vec;\n\n  C(){\n    i_vec.push_back(0);\n    s_vec.push_back(\"R\");\n  }\n};\n\n// [[Rcpp::export]]\nXPtr&lt;C&gt; first()\n{\n  XPtr&lt;C&gt; p(new C, true);\n  return(p);\n}\n\n// [[Rcpp::export]]\nvoid second_int(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;i_vec[0] &lt;&lt; \"\\n\";\n}\n\n// [[Rcpp::export]]\nvoid second_str(XPtr&lt;C&gt; p)\n{\n  Rcout &lt;&lt; p-&gt;s_vec[0] &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}, {"tags": ["c++", "cin", "getline", "istream"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1510157831, "post_id": 47184408, "comment_id": 81318248, "body": "If the string is empty the only thing <code>find_if_not</code> can return is <code>number.end()</code>. <code>number.end() == number.end()</code> and body is not entered."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1510158215, "post_id": 47184408, "comment_id": 81318514, "body": "Assuming your <code>ws</code> works as specified, you shouldn&#39;t be able to enter an empty input. If you just press the <code>enter</code> key, that will be read as a new-line character, which is classified as white-space (i.e., <code>isspace(&#39;\\n&#39;) == true</code>). For <code>getline</code> to be called, you have to enter something that&#39;s not whitespace, so what you read with <code>getline</code> can&#39;t be empty."}, {"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "reply_to_user": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1510158373, "post_id": 47184408, "comment_id": 81318640, "body": "@JerryCoffin yes but the ws comes before the getline call"}, {"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510158417, "post_id": 47184408, "comment_id": 81318675, "body": "@user4581301 I see what you are saying, I should check if its empty first"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 1, "creation_date": 1510158457, "post_id": 47184408, "comment_id": 81318699, "body": "@MichaelGrinnell: Precisely--so for execution to proceed to calling <code>getline</code>, the user has to enter something that&#39;s not white-space. When getline is called, that non-whitespace character has to be in the input buffer, so what it reads can&#39;t possibly be empty."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510157928, "post_id": 47184606, "comment_id": 81318317, "body": "Calling <code>main</code> from within a program is bad."}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1510157948, "post_id": 47184606, "comment_id": 81318333, "body": "Ofcourse is, but it&#39;s quick and dirty example. I dont want to make 60-line program just to make it &quot;vaild&quot;, while such program behaves as it should. I don&#39;t think OP will use my code..."}, {"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "edited": false, "score": 0, "creation_date": 1510160274, "post_id": 47184606, "comment_id": 81319912, "body": "@KrzysztofSzewczyk find_if_not takes in the first and last position and returns an iterator to the first occurrence of a specific condition. So isdigit is the condition so if it returns the last element it means there are no integers"}], "tags": [], "owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1510157938, "last_edit_date": 1510157938, "creation_date": 1510157869, "answer_id": 47184606, "question_id": 47184408, "link": "https://stackoverflow.com/questions/47184408/c-getline-is-not-empty-when-no-input-is-entered/47184606#47184606", "title": "C++ getline is not empty when no input is entered", "body": "<p>I have assumed that every of function(s) that i don't know implementation are written correctly. Then, I have such code (simplified):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nint main() {\n    string number;\n    if (getline(cin, number))\n    {\n        if (number.empty())\n        {\n            cout &lt;&lt; \"No input detected\" &lt;&lt; endl;\n            main();\n        }\n        cout &lt;&lt; \"Please input a Valid number\" &lt;&lt; endl;\n        main();\n    }\n}\n</code></pre>\n\n<p>I don't know <code>find_if_not(number.begin(), number.end(), &amp;isdigit)</code> implementation so I skipped it. I've put source code on Ideone.com, you can view it <a href=\"https://ideone.com/4687Jm\" rel=\"nofollow noreferrer\">HERE</a>. After passing \"just enter\", program behaves vaildly. This means, one of function implementations that you didn't show us is working incorrectly. To help you we need full source code (if not, just only needed parts). Also, you should skip \"using namespace std;\". I think, <code>number.end() != find_if_not(number.begin(), number.end(), &amp;isdigit))</code> is implemented incorrectly. You should think about what someone told you in comments - \"If the string is empty the only thing find_if_not can return is number.end(). number.end() == number.end() and body is not entered.\"</p>\n"}, {"comments": [{"owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "edited": false, "score": 0, "creation_date": 1510160023, "post_id": 47185223, "comment_id": 81319739, "body": "Ok right, yes that took me a minute to wrap my head around. Basically get rid of the ws, check if input is empty first then check if its a digit. thanks :)"}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": true, "score": 3, "last_activity_date": 1510159540, "creation_date": 1510159540, "answer_id": 47185223, "question_id": 47184408, "link": "https://stackoverflow.com/questions/47184408/c-getline-is-not-empty-when-no-input-is-entered/47185223#47185223", "title": "C++ getline is not empty when no input is entered", "body": "<p>Assuming your <code>ws</code> works as specified (skips whitespace in the input), by the time you call <code>getline</code>, something other than whitespace has to have been entered. Thus, when <code>getline</code> gets called, that non-whitespace character has to be waiting in the input buffer, and <code>getline</code> must return a non-empty sequence of characters (i.e., everything from that first non-whitespace character up to the next new-line).</p>\n\n<p>For example, let's write our own <code>ws</code> that shows what character(s) it's skipping over:</p>\n\n<pre><code>void ws(std::istream &amp;is) {\n    while (std::isspace(is.peek())) {\n        char ch;\n        is.get(ch);\n        std::cout &lt;&lt; \"Read: \" &lt;&lt; (int)ch &lt;&lt; '\\n';\n    }\n}\n</code></pre>\n\n<p>Now, when we call <code>testStuff()</code> and just press <kbd>enter</kbd>, we get <code>Read: 10</code> as our output--i.e., <code>ws</code> has read and skipped the new-line we entered.</p>\n\n<p>So, to get to the call to <code>getline</code>, the user <em>has</em> to enter something other than whitespace, and a new-line is whitespace. So, but the time <code>getline</code> is called at all, we know there's some non-whitespace character waiting in the input buffer, so when <code>getline</code> is called, it <em>must</em> produce a non-empty result.</p>\n"}], "owner": {"reputation": 728, "user_id": 7049669, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/1256258031072147/picture?type=large", "display_name": "Michael Grinnell", "link": "https://stackoverflow.com/users/7049669/michael-grinnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 0, "accepted_answer_id": 47185223, "answer_count": 2, "score": 0, "last_activity_date": 1510160767, "creation_date": 1510157260, "question_id": 47184408, "link": "https://stackoverflow.com/questions/47184408/c-getline-is-not-empty-when-no-input-is-entered", "title": "C++ getline is not empty when no input is entered", "body": "<p>I am new to c++ and still trying to wrap my head around how input/output streams work.</p>\n\n<p>I am currently trying to write a function to make sure the user enters an int, and tell them if the input is empty or not a valid int.</p>\n\n<p>I am using getline and have tried using cin.clear and cin.ignore but i cannot seem to get this to work and have no idea where i am going wrong.</p>\n\n<p>It works if I input a letter however if i just press enter with nothing input it doesn't say no input detected.</p>\n\n<pre><code>void testStuff()\n{\n    string number;\n\n    ws(cin);//skips Whitespaces\n\n    if (getline(cin, number) &amp;&amp; number.end() !=\n        find_if_not(number.begin(), number.end(), &amp;isdigit))\n    {\n        if (number.empty())\n        {\n            cout &lt;&lt; \"No input detected\" &lt;&lt; endl;\n            testStuff();\n        }\n        cout &lt;&lt; \"Please input a Valid number\" &lt;&lt; endl;\n        testStuff();\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "dll", "heap-corruption"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510156941, "post_id": 47184240, "comment_id": 81317597, "body": "<b><i>How do I make this safe?</i></b> One way is to make sure you release a .dll for each version of Visual Studio you support both in debug and release mode. So then those who use your dll won&#39;t have more than 1 CRT involved (provided they use the correct dlls). With that said Visual Studio 2015 and 2017 are binary compatible. <a href=\"https://docs.microsoft.com/en-us/cpp/porting/binary-compat-2015-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/porting/binary-compat-2015-2017</a>"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510157256, "post_id": 47184240, "comment_id": 81317842, "body": "There seems to be more to it than simply the version of Visual Studio. All my projects in my solution are Visual Studio 2015. However, one of my tests shows solid evidence that there is a heap issue across dll boundry with a boost::shared_ptr. I&#39;ve also read that not only compiler version, but CRT, architecture, configuration, and checked iterators make a difference."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510157357, "post_id": 47184240, "comment_id": 81317922, "body": "Make sure you are not mixing debug and release. Although I believe Visual Studio may prevent this now."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510158490, "post_id": 47184240, "comment_id": 81318725, "body": "Yup, I have checked all those things. I&#39;ve even gone so far as to compare the command lines from each project for all settings. Still having problems. So, I am considering no longer taking the &quot;naive approach.&quot; As part of that consideration, I&#39;d like to gain a full understanding of the work i will have to do on objects that have members which are STL collections, and what I will have to turn them into, and what that will look like."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510158813, "post_id": 47184240, "comment_id": 81318937, "body": "One way to avoid the issue is to use PIMPL and get m_customers out of the public interface completely."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510161104, "post_id": 47184240, "comment_id": 81320500, "body": "Show code please. Take a shot at an answer for adequate space. Using PIMPL will not change the fact that the Dll expects a collection of customers and that it has to be passed in some manner."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510161597, "post_id": 47184240, "comment_id": 81320827, "body": "<b><i>Using PIMPL will not change the fact that the Dll expects a collection of customers and that it has to be passed in some manner.</i></b> You can safely pass a CustomerList to your dll if the container that holds the Customers is hidden from the public interface and CustomerList  is exported by the dll. That way all allocations and deallocations happen in the DLL and don&#39;t cross the dll boundry."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510162184, "post_id": 47184240, "comment_id": 81321166, "body": "There is no container that holds customers, and even if there was, it needs to expose a collection of some sort. &#39;Customers&#39; is what needs to be passed from the EXE to the DLL."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510162230, "post_id": 47184240, "comment_id": 81321194, "body": "<code>std::vector&lt;Customer&gt; m_customers;</code> is your container inside <code>CustomerList</code>. if you use PIMPL (with CustomerList) then the problem of crossing a DLL boundry goes away.  Or do you mean you don&#39;t want to use a <code>CustomerList</code> at all?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510164027, "post_id": 47184240, "comment_id": 81322266, "body": "Although it is not the best example since the vectors are returned from the dll: <a href=\"https://stackoverflow.com/questions/31755215/does-pimpl-fundamentally-solve-c-dll-issue\" title=\"does pimpl fundamentally solve c dll issue\">stackoverflow.com/questions/31755215/&hellip;</a>"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1510172569, "post_id": 47184240, "comment_id": 81327267, "body": "An example that doesn&#39;t address the issue isn&#39;t an example at all. i know what the PIMPL idiom is, however, I do not see how that would solve anything at all."}], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510156829, "creation_date": 1510156829, "question_id": 47184240, "link": "https://stackoverflow.com/questions/47184240/exporting-c-from-dll-domain-and-collections", "title": "Exporting C++ from dll - Domain and collections", "body": "<p>There are several questions already on stack overflow regarding classes and functions across dll boundries.</p>\n\n<p>Alot of them reference this article <a href=\"https://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL\" rel=\"nofollow noreferrer\">https://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL</a></p>\n\n<p>I want to drill down a bit and ask some more specific questions.</p>\n\n<p>The summary of most of those questions is\n1) Exporting templates and the STL across dll boundries is bad in general\n2) You cannot allocated on one side of a dll boundry and release in another.\n3) Your options are\n   a) Export only pure C interfaces\n   b) Export abstract classes that are free to use templated and the STL in their internal implementation.</p>\n\n<p>Ok. Well, I've never ever done this in 10 years of coding C++ and it has never nipped me in the butt. I've followed what the article calls \"The naive approach.\" However, I resent being called naive a little bit :), because I've always had 100% of the source in every solution and always built 100% of it with the same compiler and settings, and have been mindful of such.</p>\n\n<p>Recently, I've collected evidence that I have a problem with an object being allocated in on one side of a dll boundry and released in another. So, I may find myself having to change my ways. Perhaps, this is a result from now using third party libraries from Nuget, rather than compiling them from source.</p>\n\n<p>So, I wonder, how can I employ these options when it comes to domain objects (Or in my case, objects with no functionality)</p>\n\n<p>If I can never use std::string, then I assume everything exported has to use c-style strings and the amount of copying MBs of text just increased 500X in my solution, if I want to use std:string internally in my dlls.</p>\n\n<p>Worse, I am pondering the question: How do you then have domain objects that contain a collection?</p>\n\n<p>Consider a class in my \"naive dll\"</p>\n\n<pre><code>class CustomerList\n{\npublic:\n    // where this is not trivial\n    void AddCustomer(const Customer &amp; customer);\nprivate:\n    std::vector&lt;Customer&gt; m_customers;\n};\n</code></pre>\n\n<p>and a function or method in my dll</p>\n\n<pre><code>SubmitCustomers(const CustomerList &amp; customers);\n</code></pre>\n\n<p>How do I make this safe?\nDo I need to go reinvent vector in pure C without allocations?\nDo I have to resort to arrays with sizes? yuck? and then do yet more copying to STL containers internally?</p>\n"}, {"tags": ["java", "c++", "java-native-interface", "64-bit", "solaris"], "comments": [{"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510168385, "post_id": 47184167, "comment_id": 81324868, "body": "Does the JVM already use a C++ runtime library?  If so, what version?"}, {"owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510202821, "post_id": 47184167, "comment_id": 81337181, "body": "Where and how i can receive this information?"}, {"owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510217876, "post_id": 47184167, "comment_id": 81343878, "body": "My own lib has been compiled and linked by gcc version 4.4 with its personal libraries:"}, {"owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510221984, "post_id": 47184167, "comment_id": 81346454, "body": "g++ -g -O2  -m64 -DSOLARIS -DSUNI386 -m64  -D_REENTRANT -fPIC -DTSD   -Wall -Wextra -std=c++0x  -shared -o libchp.so ../tmp/memtest.o   -L../tmp -lpthread -lrt -lsocket -lposix4 -lumem -ldemangle -lrt -bash-3.00$ ldd libchp.so         libstdc++.so.6 =&gt;        /usr/local/gcc4/lib/amd64/libstdc++.so.6         libgcc_s.so.1 =&gt;         /usr/local/gcc4/lib/amd64/libgcc_s.so.1"}, {"owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510222262, "post_id": 47184167, "comment_id": 81346642, "body": "From java loaded libraries ( get frpom /proc/$PID_JAVA/path): lrwxrwxrwx   1 vb rnd1           0 Nov  9 12:56 nfs.311.1559.269661 -&gt; /home/x2001/lib/native/sunos/i386/libchp.so lrwxrwxrwx   1 vb rnd1           0 Nov  9 12:56 ufs.30.0.251041 -&gt; /usr/local/gcc4/lib/amd64/libgcc_s.so.1 lrwxrwxrwx   1 vb rnd1           0 Nov  9 12:56 ufs.30.0.251065 -&gt; /usr/local/gcc4/lib/amd64/libstdc++.so.6.0.13"}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510226819, "post_id": 47184167, "comment_id": 81349646, "body": "Without setting <code>LD_PRELOAD_64</code>, what C++ runtime libraries does the JVM use?  I&#39;d recommend trying to duplicate the problem with the JVM using only the C++ runtime libraries the JVM would use normally."}, {"owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "reply_to_user": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1510235399, "post_id": 47184167, "comment_id": 81355535, "body": "The java code without native part don&#39;t loaded libstdc and libgcc_s library. The remove all LD_PRELOAD_* from run script - the same result."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "is_accepted": false, "score": 2, "last_activity_date": 1510350161, "last_edit_date": 1510350161, "creation_date": 1510347533, "answer_id": 47231028, "question_id": 47184167, "link": "https://stackoverflow.com/questions/47184167/jni-code-crash-with-core-dump-when-throw-is-called-under-64-bit/47231028#47231028", "title": "JNI code crash with core dump when throw is called under 64 bit", "body": "<p>The issue has been resolved:</p>\n\n<p>There is a known issue with a slight mismatch in the ABI between these two (libgcc_s.so: _Unwind_RaiseException and Solaris libc.so: _Unwind_RaiseException). Binding symbols to the GCC runtime first causes it to be loaded before the Solaris runtime, and everything works out well. But, simply adding this explicitly to our shared library link line did not help anything.</p>\n\n<p>so my simple workaround helped me:</p>\n\n<pre><code>LD_PRELOAD=/usr/sfw/lib/amd64/libgcc_s.so\n</code></pre>\n\n<p>The main reason has been in the version of gcc, i used 4.4, but fix has been made in 4.9 - \nMixing libc and libgcc_s unwinders on 64-bit Solaris 10+/x86 breaks EH\n<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=59788\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=59788</a></p>\n"}], "owner": {"reputation": 31, "user_id": 3801880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3547e4280533ebfd127a2fd05c7b1a?s=128&d=identicon&r=PG&f=1", "display_name": "Vasily", "link": "https://stackoverflow.com/users/3801880/vasily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510350161, "creation_date": 1510156627, "last_edit_date": 1510173627, "question_id": 47184167, "link": "https://stackoverflow.com/questions/47184167/jni-code-crash-with-core-dump-when-throw-is-called-under-64-bit", "title": "JNI code crash with core dump when throw is called under 64 bit", "body": "<p>I'm working with java + c++ ( using JNI ) and i must load own native libraries but application failed with core dump when throw is called lthough the code is surrounded by an exception handler (see code below). It's the same code working without problem on linux 64bit, sparc 64bit and i386 32bit. </p>\n\n<p>The problem occurred when trying to run an application under java 8 on intel SunOs.</p>\n\n<p>The flag -m64 has been added to the Makefile and library was added to the LD_PRELOAD_64 and LD_LIBRARY_PATH_64 has been set correctly.</p>\n\n<p>The java starting, successfully load library and run the native code (Java_com_jnetx_usw_chp_CHPMain_start) and crash on the throw:</p>\n\n<pre><code>INF:17:59:33.20:CHP main(27): CHPMain.run: ok load chp library. Start it...\nNOT:17:59:33.22:CHP main(27): CHPMain.run: -&gt; chp.start\nWed Nov  8 17:59:34  CHP::startTest : cycle = 1\nWed Nov  8 17:59:35  CHP::startTest : cycle = 2\nWed Nov  8 17:59:35  Try cause Exception... \n#\n# A fatal error has been detected by the Java Runtime Environment:\n#\n#  SIGSEGV (0xb) at pc=0x0000000000012ab5, pid=10081, tid=0x0000000000000026\n#\n# JRE version: Java(TM) SE Runtime Environment (8.0_121-b13) (build 1.8.0_121-b13)\n# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.121-b13 mixed mode solaris-amd64 compressed oops)\n# Problematic frame:\n# C  0x0000000000012ab5\n#\n# Core dump written. Default location: /home/kcc_64/x2001/bin/core or core.10081\n#\n# An error report file with more information is saved as:\n# /home/kcc_64/x2001/bin/hs_err_pid10081.log\n#\n# If you would like to submit a bug report, please visit:\n#   http://bugreport.java.com/bugreport/crash.jsp\n#\n</code></pre>\n\n<p>The native code</p>\n\n<pre><code>JNIEXPORT void JNICALL Java_com_jnetx_usw_chp_CHPMain_start\n  (JNIEnv *env, jobject jobj, jint trc_level,jobjectArray j_argv,jobject chp_main,jobject chp_smp)\n{\n    chp = new CHP();\n    chp-&gt;startTest();\n}\n\nvoid CHP::startTest() {\n    int t = 1;\n\n    while (true) {\n        try {\n            poll(NULL, 0, 1000);\n            fprintf(stderr, \"%s CHP::startTest : cycle = %d\\n\", getTime(), t++);\n\n            if ( 3 == t ) {\n                fprintf(stderr, \"%s :  Try generate Exception... \\n\", getTime());\n                throw 20;\n            }\n        }\n        catch (const int &amp; e) {\n            fprintf(stderr, \"%s :  Catch, e = %d\\n\", getTime(), e);\n            break;\n        }\n        catch (...) {\n            fprintf(stderr, \"%s : Catch unknown exception...\\n\", getTime());\n            break;\n        }\n    }\n    fprintf(stderr, \"%s :  CHP::startTest : End thread, exit\\n\", getTime());\n}\n</code></pre>\n\n<p>Why the catch block is ignored and immediately we go to the system signal handler which ends with core dump (see pstack below)?</p>\n\n<p>-bash-3.00$ uname -a\nSunOS x2001 5.10 Generic_142910-17 i86pc i386 i86pc\n-bash-3.00$ pstack core</p>\n\n<p>-bash-3.00$ gcc --version\ngcc (GCC) 4.4.2\nCopyright (C) 2009 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>\n\n<pre><code>pflags core\n/38:   flags = DETACH\n        sigmask = 0xfffffeff,0x0000ffff  cursig = SIGABRT\n\npstack core\n fffffd7fff291aea _lwp_kill () + a\n fffffd7fff236c39 raise () + 19\n fffffd7fff215bb0 abort () + 90\n...\n fffffd7ffe9d0343 JVM_handle_solaris_signal () + 8d7\n fffffd7ffe9c8617 signalHandler () + 2f\n fffffd7fff28c2e6 __sighndlr () + 6\n fffffd7fff280bc2 call_user_handler () + 252\n fffffd7fff280dee sigacthandler (b, fffffd7f7e2f5208, fffffd7f7e2f4ea0) + ee\n --- called from signal handler with signal 11 (SIGSEGV) ---\n 0000000000013dd5 ???????? () + 28000d930d5\n fffffd7fff2904d9 _SUNW_Unwind_RaiseException () + 46\n fffffd7f7dea2c53 __cxa_throw () + 9b                      !!!!!!!!!\n fffffd7f7f213310 _ZN3CHP9startTestEv () + 190\n fffffd7fee215a14 * com/jnetx/usw/chp/CHPMain.start(I[Ljava/lang/String;Lcom/jnetx/usw/chp/CHPMain;Lcom/jnetx/usw/chp/CHPSmp;)V+0\n fffffd7fee2083b6 * com/jnetx/usw/chp/CHPMain.run([Ljava/lang/String;Lcom/jnetx/usw/chp/CHPUpdateListener;)V+563 (line 377)\n fffffd7fee2083b6 * com/jnetx/usw/chp/CHPProvider$1.run()V+20 (line 374)\n fffffd7fee2007a7 * com/jnetx/usw/chp/CHPProvider$1.run()V+17760\n fffffd7ffe4c10ff __1cJJavaCallsLcall_helper6FpnJJavaValue_pnMmethodHandle_pnRJavaCallArguments_pnGThread__v_ () + 8d7\n fffffd7ffe4bcd3c __1cJJavaCallsMcall_virtual6FpnJJavaValue_nLKlassHandle_pnGSymbol_5pnRJavaCallArguments_pnGThread__v_ () + 424\n fffffd7ffe4bd124 __1cJJavaCallsMcall_virtual6FpnJJavaValue_nGHandle_nLKlassHandle_pnGSymbol_6pnGThread__v_ () + 60\n fffffd7ffe64030c __1cMthread_entry6FpnKJavaThread_pnGThread__v_ () + b8\n fffffd7ffebd9679 __1cKJavaThreadDrun6M_v_ () + 5e1\n fffffd7ffe9bdc85 java_start () + 175\n fffffd7fff28bfbb _thr_setup () + 5b\n fffffd7fff28c1e0 _lwp_start ()\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "qt"], "comments": [{"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 1, "creation_date": 1510156458, "post_id": 47183985, "comment_id": 81317226, "body": "I&#39;m guessing the signal is only send when control is returned to the event loop of the signalling thread, not directly when you call emit, since it&#39;s a queued connection."}, {"owner": {"reputation": 3728, "user_id": 1341942, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b8a47fe0ece93d54dfbb0fa17e15384?s=128&d=identicon&r=PG", "display_name": "nikitablack", "link": "https://stackoverflow.com/users/1341942/nikitablack"}, "reply_to_user": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 0, "creation_date": 1510156695, "post_id": 47183985, "comment_id": 81317399, "body": "@xander This is my only guess also, but I couldn&#39;t find a prove and workaround."}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 0, "creation_date": 1510156923, "post_id": 47183985, "comment_id": 81317582, "body": "Is the return value of <code>renderManager.data()</code> the same as <code>receiver</code>?"}, {"owner": {"reputation": 11885, "user_id": 2257050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VknAq.png?s=128&g=1", "display_name": "thuga", "link": "https://stackoverflow.com/users/2257050/thuga"}, "edited": false, "score": 0, "creation_date": 1510316615, "post_id": 47183985, "comment_id": 81395130, "body": "Your code looks strange.. Does <code>renderManager.data()</code> return the object <code>receiver</code>?"}, {"owner": {"reputation": 3728, "user_id": 1341942, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b8a47fe0ece93d54dfbb0fa17e15384?s=128&d=identicon&r=PG", "display_name": "nikitablack", "link": "https://stackoverflow.com/users/1341942/nikitablack"}, "reply_to_user": {"reputation": 11885, "user_id": 2257050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VknAq.png?s=128&g=1", "display_name": "thuga", "link": "https://stackoverflow.com/users/2257050/thuga"}, "edited": false, "score": 0, "creation_date": 1510319889, "post_id": 47183985, "comment_id": 81397031, "body": "@thuga Yes, this is receiver. I copy pasted and didn&#39;t change this line. Updated the example."}, {"owner": {"reputation": 19628, "user_id": 1873944, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MaDna.jpg?s=128&g=1", "display_name": "peppe", "link": "https://stackoverflow.com/users/1873944/peppe"}, "reply_to_user": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 0, "creation_date": 1510320168, "post_id": 47183985, "comment_id": 81397183, "body": "@xander: <b>that is not the case</b>. Signals are sent immediately. The invocation of the <i>slot</i> is queued (requires event loop running in the receiver&#39;s object thread)."}, {"owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "edited": false, "score": 0, "creation_date": 1510323611, "post_id": 47183985, "comment_id": 81399550, "body": "Tried your question with a simple example and it works as expected. So you have something wrong in your code that makes your case more specific. To specify <code>Qt::QueuedConnection</code> is useless btw, it will be queued because you are using two different threads, and auto is always more robust in case of future changes in the code."}], "answers": [{"comments": [{"owner": {"reputation": 3728, "user_id": 1341942, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b8a47fe0ece93d54dfbb0fa17e15384?s=128&d=identicon&r=PG", "display_name": "nikitablack", "link": "https://stackoverflow.com/users/1341942/nikitablack"}, "edited": false, "score": 1, "creation_date": 1510157181, "post_id": 47184189, "comment_id": 81317776, "body": "Thank you. That did the job."}, {"owner": {"reputation": 3728, "user_id": 1341942, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b8a47fe0ece93d54dfbb0fa17e15384?s=128&d=identicon&r=PG", "display_name": "nikitablack", "link": "https://stackoverflow.com/users/1341942/nikitablack"}, "edited": false, "score": 0, "creation_date": 1510322617, "post_id": 47184189, "comment_id": 81398896, "body": "Sorry, I have to mark the question as un-answered. As it turned out a single call to <code>processEvents()</code> doesn&#39;t fix the problem (see <a href=\"https://stackoverflow.com/questions/47221878/why-do-i-need-to-call-qcoreapplicationprocessevents-multiple-times-in-orde\">follow-up question</a>)"}], "tags": [], "owner": {"reputation": 2059, "user_id": 1138311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67def91a371d970532624092bc75f6ec?s=128&d=identicon&r=PG", "display_name": "KimKulling", "link": "https://stackoverflow.com/users/1138311/kimkulling"}, "is_accepted": false, "score": 1, "last_activity_date": 1510156711, "creation_date": 1510156711, "answer_id": 47184189, "question_id": 47183985, "link": "https://stackoverflow.com/questions/47183985/why-a-signal-is-not-being-processed-in-receiving-thread-if-the-signalling-thread/47184189#47184189", "title": "Why a signal is not being processed in receiving thread if the signalling thread is blocked?", "body": "<p>To get this handled you need to run the event-queue once by calling </p>\n\n<pre><code>QCoreApplication::processEvents();\n</code></pre>\n\n<p>This will trigger to handling of all enqueued events from your threads.</p>\n"}, {"comments": [{"owner": {"reputation": 3728, "user_id": 1341942, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b8a47fe0ece93d54dfbb0fa17e15384?s=128&d=identicon&r=PG", "display_name": "nikitablack", "link": "https://stackoverflow.com/users/1341942/nikitablack"}, "edited": false, "score": 0, "creation_date": 1510329937, "post_id": 47225046, "comment_id": 81403752, "body": "Thank you, you&#39;re right - I couldn&#39;t reproduce the issue on minimalistic example as well. After careful codebase investigation I found the problem and it doesn&#39;t related to signals and threads."}], "tags": [], "owner": {"reputation": 2748, "user_id": 6165833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1b6bbdd7a7472d52c14da82af5eb6d20?s=128&d=identicon&r=PG&f=1", "display_name": "ymoreau", "link": "https://stackoverflow.com/users/6165833/ymoreau"}, "is_accepted": true, "score": 1, "last_activity_date": 1510324313, "creation_date": 1510324313, "answer_id": 47225046, "question_id": 47183985, "link": "https://stackoverflow.com/questions/47183985/why-a-signal-is-not-being-processed-in-receiving-thread-if-the-signalling-thread/47225046#47225046", "title": "Why a signal is not being processed in receiving thread if the signalling thread is blocked?", "body": "<p>Actually it should be. The following simple example works fine.</p>\n\n<pre><code>class SenderObj : public QObject\n{\n    Q_OBJECT\nsignals:\n    void happened();\npublic:\n    void triggerSignal() {\n        qDebug() &lt;&lt; \"Emitting 'happened'\";\n        emit happened();\n        qDebug() &lt;&lt; \"Emitted 'happened'\";\n        QThread::currentThread()-&gt;sleep(5);\n    }\n};\n\nclass ReceiverObj : public QObject\n{\n    Q_OBJECT\npublic slots:\n    void doSomething() {\n        qDebug() &lt;&lt; \"SLOT called in \" &lt;&lt; QThread::currentThread();\n    }\n};\n\n// In my MainWindow :\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n\n    auto thread = new QThread(this);\n    thread-&gt;start();\n\n    m_senderObj = new SenderObj;\n    m_receiverObj = new ReceiverObj;\n\n    m_receiverObj-&gt;moveToThread(thread);\n    connect(m_senderObj, &amp;SenderObj::happened, m_receiverObj, &amp;ReceiverObj::doSomething);\n}\n\nvoid MainWindow::on_pushButton_clicked()\n{\n    m_senderObj-&gt;triggerSignal();\n}\n</code></pre>\n\n<p>When I click the push-button the signal is emitted immediately, the second thread executes the slot right away, and my main-thread (the MainWindow) is frozen for 5s.</p>\n"}], "owner": {"reputation": 3728, "user_id": 1341942, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b8a47fe0ece93d54dfbb0fa17e15384?s=128&d=identicon&r=PG", "display_name": "nikitablack", "link": "https://stackoverflow.com/users/1341942/nikitablack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 47225046, "answer_count": 2, "score": 0, "last_activity_date": 1510324313, "creation_date": 1510156150, "last_edit_date": 1510319910, "question_id": 47183985, "link": "https://stackoverflow.com/questions/47183985/why-a-signal-is-not-being-processed-in-receiving-thread-if-the-signalling-thread", "title": "Why a signal is not being processed in receiving thread if the signalling thread is blocked?", "body": "<p>This is gets called in <code>thread A</code>:</p>\n\n<pre><code>void MainApplication::notify()\n{\n    emit mySignal();\n    QThread::currentThread()-&gt;sleep(5);\n}\n</code></pre>\n\n<p>Before this the connection and receiver creation happens happens:</p>\n\n<pre><code>// thread A\nvoid MainApplication::init()\n{\n    receiver-&gt;moveToThread(threadB);\n\n    connect(this,\n            &amp;MainApplication::mySignal,\n            receiver,\n            &amp;Receiver::onMySignal,\n            Qt::QueuedConnection);\n}\n</code></pre>\n\n<p>Expectation: slot <code>Receiver::onMySignal()</code> gets called on <code>thread B</code>.<br>\nReality: slot doesn't get called while emitting <code>thread A</code> sleeps.</p>\n\n<p>P.S.: I'm 100% sure that the event loop of <code>thread B</code> is running when the signal emitted.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 1, "creation_date": 1510156185, "post_id": 47183977, "comment_id": 81317046, "body": "Just read the input. If its not <code>M</code> or <code>F</code>, re-prompt the user."}, {"owner": {"reputation": 5390, "user_id": 5845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33c08292da6607bf653d8b42488c4003?s=128&d=identicon&r=PG", "display_name": "Liudvikas Bukys", "link": "https://stackoverflow.com/users/5845/liudvikas-bukys"}, "edited": false, "score": 0, "creation_date": 1510161944, "post_id": 47183977, "comment_id": 81321028, "body": "You want &amp;&amp; not ||."}, {"owner": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1510162303, "post_id": 47183977, "comment_id": 81321220, "body": "<code>p[i].sex !=M</code> is true if the value is <code>F</code>, and <code>p[i].sex !=F</code> is true if the value is <code>M</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8790734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTq8iDg9p20/AAAAAAAAAAI/AAAAAAAAABY/Bwgq6kIUypg/photo.jpg?sz=128", "display_name": "JACK1ETO", "link": "https://stackoverflow.com/users/8790734/jack1eto"}, "edited": false, "score": 0, "creation_date": 1510156400, "post_id": 47184007, "comment_id": 81317190, "body": "I think I&#39;m confused, doesnt || means &quot;OR&quot; and &amp;&amp; &quot;and&quot;? Tried with &amp;&amp; and its working fine now,"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 7, "user_id": 8790734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTq8iDg9p20/AAAAAAAAAAI/AAAAAAAAABY/Bwgq6kIUypg/photo.jpg?sz=128", "display_name": "JACK1ETO", "link": "https://stackoverflow.com/users/8790734/jack1eto"}, "edited": false, "score": 0, "creation_date": 1510156445, "post_id": 47184007, "comment_id": 81317224, "body": "Yes <code>||</code> does indeed mean &quot;or&quot;. But you seem to be misunderstanding what &quot;or&quot; actually means in this context."}, {"owner": {"reputation": 7, "user_id": 8790734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTq8iDg9p20/AAAAAAAAAAI/AAAAAAAAABY/Bwgq6kIUypg/photo.jpg?sz=128", "display_name": "JACK1ETO", "link": "https://stackoverflow.com/users/8790734/jack1eto"}, "edited": false, "score": 0, "creation_date": 1510156509, "post_id": 47184007, "comment_id": 81317254, "body": "Yes, just facepalmed myself right now, I dont know how I couldnt see it, thanks for the help!"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1510156522, "last_edit_date": 1510156522, "creation_date": 1510156206, "answer_id": 47184007, "question_id": 47183977, "link": "https://stackoverflow.com/questions/47183977/in-c-how-can-i-make-a-questions-that-only-accepts-2-letters-as-answers/47184007#47184007", "title": "In C++, how can I make a questions that only accepts 2 letters as answers?", "body": "<p>How can <code>p[i].sex</code> be <em>both</em> <code>M</code> and <code>F</code>?</p>\n\n<p>Did you want <code>p[i].sex !=M &amp;&amp; p[i].sex !=F</code>?</p>\n\n<p>Also, consider using a <code>do</code> <code>while</code> loop instead so you can put the condition check at the end, which will avoid your having to write <code>cin</code> twice in your code.</p>\n"}], "owner": {"reputation": 7, "user_id": 8790734, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xTq8iDg9p20/AAAAAAAAAAI/AAAAAAAAABY/Bwgq6kIUypg/photo.jpg?sz=128", "display_name": "JACK1ETO", "link": "https://stackoverflow.com/users/8790734/jack1eto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510156522, "creation_date": 1510156126, "last_edit_date": 1510156489, "question_id": 47183977, "link": "https://stackoverflow.com/questions/47183977/in-c-how-can-i-make-a-questions-that-only-accepts-2-letters-as-answers", "title": "In C++, how can I make a questions that only accepts 2 letters as answers?", "body": "<p>I'm making a survey with a a struct and I'm trying to ask the user if he is male or female answering only with M or F. I used while to make the program re-ask the question if the user introduces a no acceptable answer but I ended up with an infinite loop. What am I doing wrong?</p>\n\n<pre><code>cout &lt;&lt; \"Introduce your genre (M or F)\";\ncin &gt;&gt; p[i].sex;\nwhile  (p[i].sex !=M || p[i].sex !=F){\n        cout &lt;&lt; \"Introduce your genre using M or F \";\n        cin &gt;&gt; p[i].sex;\n}\n</code></pre>\n\n<p>This is just a part of the whole code, but thats where I'm having problems.</p>\n"}, {"tags": ["c++", "wifi", "simulator", "ns-3"], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 2318306, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d1af7fdc6f3bd885560a7119746d2808?s=128&d=identicon&r=PG", "display_name": "Warlock", "link": "https://stackoverflow.com/users/2318306/warlock"}, "is_accepted": false, "score": 1, "last_activity_date": 1523610964, "last_edit_date": 1523610964, "creation_date": 1510163477, "answer_id": 47186453, "question_id": 47183955, "link": "https://stackoverflow.com/questions/47183955/accessing-wifiphy-from-a-recevied-callback-in-ns3/47186453#47186453", "title": "Accessing WiFiPhy from a recevied callback in NS3", "body": "<p>Ok i found it..  when you create a <em>NetDeviceContainer</em> the object is of type <em>NetDevice</em> which does not have any <em>WifiPhy</em>. The solution is to DynamicCast it into <em>WifiNetDevice</em> and send the frame.</p>\n\n<pre><code>Ptr&lt;WifiNetDevice&gt; wifiNetDevice = DynamicCast&lt;WifiNetDevice&gt;(netDevice);\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 2318306, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d1af7fdc6f3bd885560a7119746d2808?s=128&d=identicon&r=PG", "display_name": "Warlock", "link": "https://stackoverflow.com/users/2318306/warlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523610964, "creation_date": 1510156056, "question_id": 47183955, "link": "https://stackoverflow.com/questions/47183955/accessing-wifiphy-from-a-recevied-callback-in-ns3", "title": "Accessing WiFiPhy from a recevied callback in NS3", "body": "<p>I want to access the WiFiPhy inside the reception callback of NetDevice with signature. </p>\n\n<pre><code>typedef Callback&lt; bool, Ptr&lt;NetDevice&gt;, Ptr&lt;const Packet&gt;, uint16_t, const Address &amp; &gt; ReceiveCallback;\n</code></pre>\n\n<p>Inside the callback, i'm the the casting the NetDevice to WiFiDevice like to WiFiPhy functions.</p>\n\n<pre><code>Ptr&lt;WifiNetDevice&gt; wifiNetDevice = DynamicCast&lt;WifiNetDevice&gt;(device);\nPtr&lt;WifiPhy&gt; wifiPhyDev = wifiNetDevice-&gt;GetPhy();\n</code></pre>\n\n<p>But I am getting a segmentation fault during the run ? What actually im doing wrong here?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["c++", "data-structures"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1510156046, "post_id": 47183903, "comment_id": 81316932, "body": "@BenVoigt Well, the OP says &quot;if Institute exist for the given name&quot;, which is kind of ambiguous. It&#39;s not clear whether both name and value are supposed to match."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1510156065, "post_id": 47183903, "comment_id": 81316943, "body": "It sounds like you want something more like     <code>std::map&lt;string, std::set&lt;string&gt;&gt;</code>  instead of <code>multimap</code>.  (where <code>string</code> can be <code>CString</code>, <code>std::string</code>, etc)"}, {"owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1510156209, "post_id": 47183903, "comment_id": 81317063, "body": "@IgorTandetnik - Yes both name and value should match."}, {"owner": {"reputation": 1884, "user_id": 2747962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JbKoL.jpg?s=128&g=1", "display_name": "Darklighter", "link": "https://stackoverflow.com/users/2747962/darklighter"}, "edited": false, "score": 0, "creation_date": 1510169420, "post_id": 47183903, "comment_id": 81325510, "body": "It depends a little on how large your set is and how long your strings are and if you need the ordering, but I\u2019d suggest using an <code>unordered_set&lt;std::pair&lt;std::string, std::string&gt;&gt; </code> container for which you would have to create a hash function in <code>std</code> but it works <a href=\"http://coliru.stacked-crooked.com/a/c5d0b65c1fddda97\" rel=\"nofollow noreferrer\">out of the box</a> in <code>boost</code>. (Unordered associative containers have better complexity guarantees)"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "edited": false, "score": 0, "creation_date": 1510168589, "post_id": 47184070, "comment_id": 81324991, "body": "Thanks, Using std::set&lt;std::pair&lt;CString, Cstring&gt;&gt; made my code really simpler."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 0, "last_activity_date": 1510168872, "last_edit_date": 1510168872, "creation_date": 1510156369, "answer_id": 47184070, "question_id": 47183903, "link": "https://stackoverflow.com/questions/47183903/check-if-element-exist-or-not/47184070#47184070", "title": "Check if element exist or not", "body": "<p>You can find the sequence elements from the multimap for a given key efficiently. There is no better way to find a particular value from this sequence, than linear search.</p>\n\n<p><code>std::map&lt;CString, std::set&lt;CString&gt;&gt;</code> would be an alternative data structure, which is also efficient for finding whether a value exists in the set associated with the key. It has a bit different interface though. Instead of simply inserting a value to a key, you must \"get\" the value set of a key, insert into that set.</p>\n\n<p>If the map aspect of your data structure isn't used otherwise, another simpler alternative is to use <code>std::set&lt;std::pair&lt;CString, Cstring&gt;&gt;</code>. This can be easily used to test if the key-value pair is in the set, but of course lacks other features that the multimap had.</p>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "edited": false, "score": 0, "creation_date": 1510168625, "post_id": 47184434, "comment_id": 81325012, "body": "Thanks for the code, I decided to with std::set&lt;std::pair&lt;CString, Cstring&gt;&gt;  ."}], "tags": [], "owner": {"reputation": 93, "user_id": 3065110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f7a51a4c20dfda922b2d20090cb2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Check", "link": "https://stackoverflow.com/users/3065110/check"}, "is_accepted": false, "score": 1, "last_activity_date": 1510157355, "creation_date": 1510157355, "answer_id": 47184434, "question_id": 47183903, "link": "https://stackoverflow.com/questions/47183903/check-if-element-exist-or-not/47184434#47184434", "title": "Check if element exist or not", "body": "<p>Use <a href=\"http://www.cplusplus.com/reference/map/multimap/equal_range/\" rel=\"nofollow noreferrer\"><code>equal_range</code></a> from <code>multimap</code>.</p>\n\n<p>Here you have a <a href=\"http://cpp.sh/5qajq\" rel=\"nofollow noreferrer\">live example</a></p>\n"}], "owner": {"reputation": 273, "user_id": 2480884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba68307bc6b4c769fc2d67ce24493f49?s=128&d=identicon&r=PG", "display_name": "Geek", "link": "https://stackoverflow.com/users/2480884/geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 47184070, "answer_count": 2, "score": 0, "last_activity_date": 1510168872, "creation_date": 1510155878, "last_edit_date": 1510156253, "question_id": 47183903, "link": "https://stackoverflow.com/questions/47183903/check-if-element-exist-or-not", "title": "Check if element exist or not", "body": "<p>I have a multimap.</p>\n\n<pre><code>std::multimap&lt;CString, CString&gt; NameInsituteMap;\n</code></pre>\n\n<p>and I have to write function which return true if both name and institute matches otherwise false;</p>\n\n<pre><code>bool InsituteExist( const CString Name, const CString Insitute )\n{\n\n}\n</code></pre>\n\n<p>I can find the key and iterate all the value to compare if Institute exist or not.</p>\n\n<p>I want to know if there is any direct way of doing that instead of looping through all the element and comparing.</p>\n\n<p>I am open to use any other data structure than multimap if that makes things nicer.</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "asynchronous"], "comments": [{"owner": {"reputation": 1084, "user_id": 4443423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwXBe.jpg?s=128&g=1", "display_name": "Maikel", "link": "https://stackoverflow.com/users/4443423/maikel"}, "edited": false, "score": 0, "creation_date": 1510155471, "post_id": 47183731, "comment_id": 81316547, "body": "async just starts a new thread for each call and starting new threads tends to be quite slow for my Mac too. Your function does not take long enough to see any benefit from it. If you would use a thread pool to submit tasks to it would be better."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1510155495, "post_id": 47183731, "comment_id": 81316561, "body": "you should run the test seperately or try it in reverse order, and what are the compiler flags? optimizations turned on?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 9, "creation_date": 1510155569, "post_id": 47183731, "comment_id": 81316600, "body": "An overhead of starting a thread likely thoroughly dominates the time to add up a thousand numbers."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1510155639, "post_id": 47183731, "comment_id": 81316649, "body": "Try using a larger vector (lets say a million elements). And run each test a few thousand times to get an average. And build with optimizations enabled and debug information disabled."}, {"owner": {"reputation": 1165, "user_id": 4493225, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-s7Jc9VuXG9Q/AAAAAAAAAAI/AAAAAAAAAJo/GRu4jVBzQ8k/photo.jpg?sz=128", "display_name": "Lin", "link": "https://stackoverflow.com/users/4493225/lin"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1510155654, "post_id": 47183731, "comment_id": 81316658, "body": "@tobi303 I have included my compiler flags in my description."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 9, "creation_date": 1510155710, "post_id": 47183731, "comment_id": 81316699, "body": "By the way, don&#39;t even bother measure performance of unoptimized code."}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 2, "creation_date": 1510156019, "post_id": 47183731, "comment_id": 81316911, "body": "moreover, 1) async will copy the vector, use std::cref to avoid that 2) beware of false sharing for small vectors"}, {"owner": {"reputation": 1165, "user_id": 4493225, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-s7Jc9VuXG9Q/AAAAAAAAAAI/AAAAAAAAAJo/GRu4jVBzQ8k/photo.jpg?sz=128", "display_name": "Lin", "link": "https://stackoverflow.com/users/4493225/lin"}, "reply_to_user": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 0, "creation_date": 1510156131, "post_id": 47183731, "comment_id": 81316999, "body": "@MassimilianoJanes Thank, this is the problem."}, {"owner": {"reputation": 1165, "user_id": 4493225, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-s7Jc9VuXG9Q/AAAAAAAAAAI/AAAAAAAAAJo/GRu4jVBzQ8k/photo.jpg?sz=128", "display_name": "Lin", "link": "https://stackoverflow.com/users/4493225/lin"}, "reply_to_user": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 0, "creation_date": 1510156228, "post_id": 47183731, "comment_id": 81317072, "body": "@MassimilianoJanes Could you please write up an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510156558, "post_id": 47184037, "comment_id": 81317288, "body": "Multi-threading can certainly, in many cases, improve the performance of CPU bound applications. This answer seems to be claiming that it&#39;s only every useful for handling blocking tasks."}, {"owner": {"reputation": 14898, "user_id": 1133179, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3a760e170dcbd539461a86a397f1abe?s=128&d=identicon&r=PG", "display_name": "luk32", "link": "https://stackoverflow.com/users/1133179/luk32"}, "edited": false, "score": 2, "creation_date": 1510156821, "post_id": 47184037, "comment_id": 81317504, "body": "&quot;<i>we go for multithreaded solution only when we can&#39;t accomplish something in a single thread</i>&quot; that is not true. Parallelization of computation for speedup is quite popular, and it&#39;s by definition doable sequentially."}, {"owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510202758, "post_id": 47184037, "comment_id": 81337159, "body": "@Fran&#231;ois Andrieux  Nothing is claimed in this answer.. Just a suggestion."}], "tags": [], "owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1510156271, "creation_date": 1510156271, "answer_id": 47184037, "question_id": 47183731, "link": "https://stackoverflow.com/questions/47183731/c-why-stdasync-slower-than-sequential-execution/47184037#47184037", "title": "c++ why std::async slower than sequential execution", "body": "<p>Well, this is the simplest possible example and the results should not be binding because of following reasons.</p>\n\n<ol>\n<li><p>when you create a thread, it takes some extra CPU cycles to create thread context and stack. Those cycles are added to the sum function.</p></li>\n<li><p>When main thread runs this code, the main thread was empty and not doing anything else other than doing the sum</p></li>\n</ol>\n\n<p>we go for multithreaded solution only when we can't accomplish something in a single thread or we need to synchronously wait for some input. </p>\n\n<p>Just by creating threads, you don't increase performance. You increase performance by carefully designing multithreaded applications where you can use empty CPU's when some other things are waiting for example IO</p>\n"}, {"comments": [{"owner": {"reputation": 1165, "user_id": 4493225, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-s7Jc9VuXG9Q/AAAAAAAAAAI/AAAAAAAAAJo/GRu4jVBzQ8k/photo.jpg?sz=128", "display_name": "Lin", "link": "https://stackoverflow.com/users/4493225/lin"}, "edited": false, "score": 0, "creation_date": 1510156592, "post_id": 47184134, "comment_id": 81317312, "body": "But the template for <code>std::async</code> accepts universal reference to extra <code>Args</code>, so the vector argument type will be deduced as <code>const std::vector&lt;Num&gt;&amp;</code> and then when calling <code>sum&lt;Num&gt;(v, ...)</code>, there shouldn&#39;t involve any copies, right?"}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "reply_to_user": {"reputation": 1165, "user_id": 4493225, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-s7Jc9VuXG9Q/AAAAAAAAAAI/AAAAAAAAAJo/GRu4jVBzQ8k/photo.jpg?sz=128", "display_name": "Lin", "link": "https://stackoverflow.com/users/4493225/lin"}, "edited": false, "score": 4, "creation_date": 1510156726, "post_id": 47184134, "comment_id": 81317423, "body": "@lingxiao nope, those universal references are forwarded to the decay_t&#39;ed constructor via std::thread, causing a copy ( or a move when applicable ). For this reason we have std::reference_wrapper"}, {"owner": {"reputation": 10317, "user_id": 666785, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/NIzSh.jpg?s=128&g=1", "display_name": "sbabbi", "link": "https://stackoverflow.com/users/666785/sbabbi"}, "edited": false, "score": 1, "creation_date": 1510599252, "post_id": 47184134, "comment_id": 81493850, "body": "There is no false sharing here, because no memory is modified. Each CPU will have a copy of the memory in its own cacheline, no inter-cache synchronization is required."}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "reply_to_user": {"reputation": 10317, "user_id": 666785, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/NIzSh.jpg?s=128&g=1", "display_name": "sbabbi", "link": "https://stackoverflow.com/users/666785/sbabbi"}, "edited": false, "score": 0, "creation_date": 1510601745, "post_id": 47184134, "comment_id": 81495214, "body": "@sbabbi you\u2019re totally right, I don\u2019t know what I was thinking, thanks... edited"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1510606161, "post_id": 47184134, "comment_id": 81497604, "body": "A decent implementation will use a thread pool rather than starting a new thread for each call. Still there is overhead,"}, {"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "reply_to_user": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1510644735, "post_id": 47184134, "comment_id": 81510357, "body": "@JiveDadson, as far as I can see, clang libc++ doesn&#39;t, it spawns a std::thread anew ( but std::thread my in turn use something like a pool of course, I&#39;ll check that ). Note that the specification requires new threads ( under the <i>as-if</i> rule ), for example, thread locals must be initialized so a &#39;trivial&#39; pool cannot be used there ..."}], "tags": [], "owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "is_accepted": true, "score": 6, "last_activity_date": 1510601768, "last_edit_date": 1510601768, "creation_date": 1510156554, "answer_id": 47184134, "question_id": 47183731, "link": "https://stackoverflow.com/questions/47183731/c-why-stdasync-slower-than-sequential-execution/47184134#47184134", "title": "c++ why std::async slower than sequential execution", "body": "<p>here</p>\n\n<pre><code>auto s1 = std::async(std::launch::async, sum&lt;Num&gt;, v, l, m);\nauto s2 = std::async(std::launch::async, sum&lt;Num&gt;, v, m+1, h);\n</code></pre>\n\n<p>async will store its own vector copy, twice. You should use <code>std::cref</code> and make sure the futures are retrieved before the vector dies ( as it is in your current code ) and that accesses get properly synchronized ( as it is in your current code ).</p>\n\n<p>As mentioned in comments, thread creation overhead may further slow down the code.</p>\n"}, {"tags": [], "owner": {"reputation": 1084, "user_id": 4495824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390a55b878d2d03dc29f1b8a5c9946b2?s=128&d=identicon&r=PG&f=1", "display_name": "hungptit", "link": "https://stackoverflow.com/users/4495824/hungptit"}, "is_accepted": false, "score": 1, "last_activity_date": 1510679203, "last_edit_date": 1510679203, "creation_date": 1510292748, "answer_id": 47216384, "question_id": 47183731, "link": "https://stackoverflow.com/questions/47183731/c-why-stdasync-slower-than-sequential-execution/47216384#47216384", "title": "c++ why std::async slower than sequential execution", "body": "<p>First, the performance of your original async function is bad compared with the sequential because it make one more copy of your test data as mentioned in other answers. Second, you might not be able to see the improvement after fixing copying issue because creating threads is not cheap and it can kill your performance gain. </p>\n\n<p>From the benchmark results, I can see async version is 1.88 times faster than that of the sequential version for N = 1000000. However, if I use N = 10000 then async version is 3.55 times slower. Both non-iterator and iterator solutions produce similar results. </p>\n\n<p>Beside that you should use iterator when writing your code because  this approach is more flexible for example you can try different container types, will give you similar performance compared to C style version, and it also is more elegant IMHO :).</p>\n\n<p>Benchmark results:</p>\n\n<pre><code>-----------------------------------------------------------------------------------------------------------------------------------------------\n     Group      |   Experiment    |   Prob. Space   |     Samples     |   Iterations    |    Baseline     |  us/Iteration   | Iterations/sec  |\n\n-----------------------------------------------------------------------------------------------------------------------------------------------\nsum             | orginal         |            Null |              50 |              10 |         1.00000 |      1366.30000 |          731.90 |\nsum             | orginal_async   |            Null |              50 |              10 |         0.53246 |       727.50000 |         1374.57 |\nsum             | iter            |            Null |              50 |              10 |         1.00022 |      1366.60000 |          731.74 |\nsum             | iter_async      |            Null |              50 |              10 |         0.53261 |       727.70000 |         1374.19 |\nComplete.\n\nCelero\nTimer resolution: 0.001000 us\n-----------------------------------------------------------------------------------------------------------------------------------------------\n     Group      |   Experiment    |   Prob. Space   |     Samples     |   Iterations    |    Baseline     |  us/Iteration   | Iterations/sec  |\n\n-----------------------------------------------------------------------------------------------------------------------------------------------\nsum             | orginal         |            Null |              50 |              10 |         1.00000 |        13.60000 |        73529.41 |\nsum             | orginal_async   |            Null |              50 |              10 |         3.55882 |        48.40000 |        20661.16 |\nsum             | iter            |            Null |              50 |              10 |         1.00000 |        13.60000 |        73529.41 |\nsum             | iter_async      |            Null |              50 |              10 |         3.53676 |        48.10000 |        20790.02 |\nComplete.\n</code></pre>\n\n<p>Complete code sample</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;chrono&gt;\n#include &lt;future&gt;\n#include &lt;iostream&gt;\n#include &lt;random&gt;\n#include &lt;type_traits&gt;\n#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\n#include \"celero/Celero.h\"\n\nconstexpr int NumberOfSamples = 50;\nconstexpr int NumberOfIterations = 10;\n\ntemplate &lt;typename Container&gt;\ndouble sum(const Container &amp;v, const std::size_t begin, const std::size_t end) {\n    double s = 0;\n    for (auto idx = begin; idx &lt; end; ++idx) {\n        s += v[idx];\n    }\n    return s;\n}\n\ntemplate &lt;typename Container&gt;\ndouble sum_async(const Container &amp;v, const std::size_t begin, const std::size_t end) {\n    auto middle = (begin + end) / 2;\n        // Removing std::cref will slow down this function because it makes two copy of v..\n    auto s1 = std::async(std::launch::async, sum&lt;Container&gt;, std::cref(v), begin, middle);\n    auto s2 = std::async(std::launch::async, sum&lt;Container&gt;, std::cref(v), middle, end);s,\n    return s1.get() + s2.get();\n}\n\ntemplate &lt;typename Iter&gt;\ntypename std::iterator_traits&lt;Iter&gt;::value_type sum_iter(Iter begin, Iter end) {\n    typename std::iterator_traits&lt;Iter&gt;::value_type results = 0.0;\n    std::for_each(begin, end, [&amp;results](auto const item) { results += item; });\n    return results;\n}\n\ntemplate &lt;typename Iter&gt;\ntypename std::iterator_traits&lt;Iter&gt;::value_type sum_iter_async(Iter begin, Iter end) {\n    Iter middle = begin + std::distance(begin, end) / 2;\n    auto s1 = std::async(std::launch::async, sum_iter&lt;Iter&gt;, begin, middle);\n    auto s2 = std::async(std::launch::async, sum_iter&lt;Iter&gt;, middle, end);\n    return s1.get() + s2.get();\n}\n\ntemplate &lt;typename T&gt; auto create_test_data(const size_t N) {\n    auto s = std::chrono::system_clock::now().time_since_epoch().count();\n    std::vector&lt;T&gt; v(N);\n    std::generate(v.begin(), v.end(), std::minstd_rand0(s));\n    return v;\n}\n\n// Create test data\nconstexpr size_t N = 10000;\nusing value_type = double;\nauto data = create_test_data&lt;value_type&gt;(N);\nusing container_type = decltype(data);\n\nCELERO_MAIN\n\nBASELINE(sum, orginal, NumberOfSamples, NumberOfIterations) {\n    celero::DoNotOptimizeAway(sum&lt;container_type&gt;(data, 0, N));\n}\n\nBENCHMARK(sum, orginal_async, NumberOfSamples, NumberOfIterations) {\n    celero::DoNotOptimizeAway(sum_async&lt;container_type&gt;(data, 0, N));\n}\n\nBENCHMARK(sum, iter, NumberOfSamples, NumberOfIterations) {\n    celero::DoNotOptimizeAway(sum_iter(data.cbegin(), data.cend()));\n}\n\nBENCHMARK(sum, iter_async, NumberOfSamples, NumberOfIterations) {\n    celero::DoNotOptimizeAway(sum_iter_async(data.cbegin(), data.cend()));\n</code></pre>\n"}], "owner": {"reputation": 1165, "user_id": 4493225, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-s7Jc9VuXG9Q/AAAAAAAAAAI/AAAAAAAAAJo/GRu4jVBzQ8k/photo.jpg?sz=128", "display_name": "Lin", "link": "https://stackoverflow.com/users/4493225/lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2438, "favorite_count": 3, "accepted_answer_id": 47184134, "answer_count": 3, "score": 9, "last_activity_date": 1512351707, "creation_date": 1510155331, "last_edit_date": 1512351707, "question_id": 47183731, "link": "https://stackoverflow.com/questions/47183731/c-why-stdasync-slower-than-sequential-execution", "title": "c++ why std::async slower than sequential execution", "body": "<pre><code>#include &lt;future&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cstdint&gt;\n#include &lt;algorithm&gt;\n#include &lt;random&gt;\n#include &lt;chrono&gt;\n#include &lt;utility&gt;\n#include &lt;type_traits&gt;\n\ntemplate &lt;class Clock = std::chrono::high_resolution_clock, class Task&gt;\ndouble timing(Task&amp;&amp; t, typename std::result_of&lt;Task()&gt;::type* r = nullptr)\n{\n  using namespace std::chrono;\n  auto begin = Clock::now();\n  if (r != nullptr) *r = std::forward&lt;Task&gt;(t)();\n  auto end = Clock::now();\n  return duration_cast&lt;duration&lt;double&gt;&gt;(end - begin).count();\n}\n\ntemplate &lt;typename Num&gt;\ndouble sum(const std::vector&lt;Num&gt;&amp; v, const std::size_t l, const std::size_t h)\n{\n  double s;\n  for (auto i = l; i &lt;= h; i++) s += v[i];\n  return s;\n}\n\ntemplate &lt;typename Num&gt;\ndouble asum(const std::vector&lt;Num&gt;&amp; v, const std::size_t l, const std::size_t h)\n{\n  auto m = (l + h) / 2;\n  auto s1 = std::async(std::launch::async, sum&lt;Num&gt;, v, l, m);\n  auto s2 = std::async(std::launch::async, sum&lt;Num&gt;, v, m+1, h);\n  return s1.get() + s2.get();\n}\n\nint main()\n{\n  std::vector&lt;uint&gt; v(1000);\n  auto s = std::chrono::system_clock::now().time_since_epoch().count();\n  std::generate(v.begin(), v.end(), std::minstd_rand0(s));\n\n  double r;\n  std::cout &lt;&lt; 1000 * timing([&amp;]() -&gt; double { return asum(v, 0, v.size() - 1); }, &amp;r) &lt;&lt; \" msec | rst \" &lt;&lt; r &lt;&lt; std::endl;\n  std::cout &lt;&lt; 1000 * timing([&amp;]() -&gt; double { return sum(v, 0, v.size() - 1); }, &amp;r) &lt;&lt; \" msec | rst \" &lt;&lt; r &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Hi,</p>\n\n<p>So above are two functions for summing up a vector of random numbers.</p>\n\n<p>I did several runs, but it seems that I did not benefit from <code>std::async</code>. Below are some results I got.</p>\n\n<pre><code>0.130582 msec | rst 1.09015e+12\n0.001402 msec | rst 1.09015e+12\n\n0.23185 msec | rst 1.07046e+12\n0.002308 msec | rst 1.07046e+12\n\n0.18052 msec | rst 1.07449e+12\n0.00244 msec | rst 1.07449e+12\n\n0.190455 msec | rst 1.08319e+12\n0.002315 msec | rst 1.08319e+12\n</code></pre>\n\n<p>All four cases the async version spent more time. But ideally I should have been two times faster right? </p>\n\n<p>Did I miss anything in my code?</p>\n\n<p>By the way I am running on <code>OS X 10.10.4</code> Macbook Air with <code>1.4 GHz Intel Core i5</code>.</p>\n\n<p>Thanks,</p>\n\n<p>Edits:</p>\n\n<ol>\n<li>compiler flags: <code>g++ -o asum asum.cpp -std=c++11</code></li>\n<li>I changed the flag to include <code>-O3</code> and vector size to be <code>10000000</code>, but the results are still weired.</li>\n</ol>\n\n<hr>\n\n<pre><code>72.1743 msec | rst 1.07349e+16\n14.3739 msec | rst 1.07349e+16\n\n58.3542 msec | rst 1.07372e+16\n12.1143 msec | rst 1.07372e+16\n\n57.1576 msec | rst 1.07371e+16\n11.9332 msec | rst 1.07371e+16\n\n59.9104 msec | rst 1.07395e+16\n11.9923 msec | rst 1.07395e+16\n\n64.032 msec | rst 1.07371e+16\n12.0929 msec | rst 1.07371e+16\n</code></pre>\n\n<hr>\n"}, {"tags": ["c++", "qt"], "comments": [{"owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "edited": false, "score": 0, "creation_date": 1510155220, "post_id": 47183630, "comment_id": 81316371, "body": "Can you put the class definition of MainWindow ? Like this, i&#39;d say you forgot to initialize one of your pointer member and it causes a seg fault"}, {"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 1, "creation_date": 1510155253, "post_id": 47183630, "comment_id": 81316388, "body": "You never initialize <code>QNetworkAccessManager *nam;</code> !? That&#39;s an invalid pointer you try to access."}, {"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 0, "creation_date": 1510155551, "post_id": 47183630, "comment_id": 81316589, "body": "Also you might want to use <a href=\"http://doc.qt.io/qt-5/json.html\" rel=\"nofollow noreferrer\">JSON Support in Qt</a> to parse the result, instead of using the <code>QScriptEngine</code>, if you&#39;re using Qt 5 at least."}, {"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 0, "creation_date": 1510155717, "post_id": 47183630, "comment_id": 81316705, "body": "@RD41 Qt has quite good examples in the documentation of all classes: see this <a href=\"http://doc.qt.io/qt-5/qnetworkaccessmanager.html#details\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qnetworkaccessmanager.html#details</a>"}, {"owner": {"reputation": 1, "user_id": 8253081, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2EtZEWWzBB4/AAAAAAAAAAI/AAAAAAAAB_8/0iMLlfuid80/photo.jpg?sz=128", "display_name": "RD41", "link": "https://stackoverflow.com/users/8253081/rd41"}, "edited": false, "score": 0, "creation_date": 1510155741, "post_id": 47183630, "comment_id": 81316725, "body": "Thank you, it seems to have solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1719, "user_id": 2619479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/127aeef4e048febca4fd6560b465359d?s=128&d=identicon&r=PG", "display_name": "Marco", "link": "https://stackoverflow.com/users/2619479/marco"}, "is_accepted": false, "score": 1, "last_activity_date": 1510157045, "creation_date": 1510157045, "answer_id": 47184326, "question_id": 47183630, "link": "https://stackoverflow.com/questions/47183630/qtnetworkrequest-cause-program-to-finish-unexpectedly/47184326#47184326", "title": "QtNetworkRequest cause program to &quot;finish unexpectedly&quot;", "body": "<p>For first:</p>\n\n<p>the line </p>\n\n<pre><code>QNetworkAccessManager *nam; \n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>QNetworkAccessManager *nam = new QNetworkAccessManager(this);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8253081, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2EtZEWWzBB4/AAAAAAAAAAI/AAAAAAAAB_8/0iMLlfuid80/photo.jpg?sz=128", "display_name": "RD41", "link": "https://stackoverflow.com/users/8253081/rd41"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510163972, "creation_date": 1510155048, "last_edit_date": 1510163972, "question_id": 47183630, "link": "https://stackoverflow.com/questions/47183630/qtnetworkrequest-cause-program-to-finish-unexpectedly", "title": "QtNetworkRequest cause program to &quot;finish unexpectedly&quot;", "body": "<p>I'm a beginner in C++ and Qt and I'm trying to make a translation program but it crashes upon the network request execution...</p>\n\n<p>The error:\n<i>Oversetter.exe exited with code 255</i></p>\n\n<p>My code:</p>\n\n<p><strong>Header file</strong></p>\n\n<pre><code>#ifndef MAINWINDOW_H\n#define MAINWINDOW_H\n#include &lt;QApplication&gt;\n...\n#include &lt;QUrl&gt;\n#include &lt;QtNetwork/QNetworkAccessManager&gt;\n#include &lt;QtNetwork/QNetworkRequest&gt;\n#include &lt;QtNetwork/QNetworkReply&gt;\n#include &lt;QtScript/QScriptEngine&gt;\n#include &lt;QtScript/QScriptValue&gt;\n#include &lt;QtScript/QScriptValueIterator&gt;\n\nclass MainWindow : public QWidget\n{\nQ_OBJECT\n\npublic:\nMainWindow();\n\npublic slots:\nvoid getTranslation();\nvoid onTranslationRecieved(QNetworkReply* reply);\n\nprivate:\nQTextEdit *te_input;\nQTextEdit *te_output;\n};\n#endif\n</code></pre>\n\n<p><strong>Code file</strong></p>\n\n<pre><code>void MainWindow::getTranslation()\n{\nte_output-&gt;setText(\"[Oversettelse p\u00e5g\u00e5r]\\n[Translation in progress]\");\n\nQString url = \"http://translate.googleapis.com/translate_a/single?client=gtx\";\n...\nurl.append(te_input-&gt;toPlainText());\nqInfo() &lt;&lt; \"url: \" + url;\n\nQNetworkAccessManager *nam;\nconnect(nam, SIGNAL(finished(QNetworkReply*)), this, SLOT(onTranslationRecieved(QNetworkReply*)));\nnam-&gt;get(QNetworkRequest(QUrl(url)));\n\n}\n\nvoid MainWindow::onTranslationRecieved(QNetworkReply* reply)\n{\nQString data = (QString) reply-&gt;readAll();\nte_output-&gt;setText(data);\n\nQScriptEngine engine;\nQScriptValue result = engine.evaluate(data);\nQString translation = result.property(\"0\").property(\"0\").property(\"0\").toString();\n}\n</code></pre>\n\n<p>Any help will be very appreciated :-)</p>\n"}, {"tags": ["android", "c++", "opencv", "android-ndk"], "comments": [{"owner": {"reputation": 9770, "user_id": 888688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e1a439c266dcf5015373dbeae410ff5?s=128&d=identicon&r=PG", "display_name": "api55", "link": "https://stackoverflow.com/users/888688/api55"}, "edited": false, "score": 1, "creation_date": 1510156029, "post_id": 47183534, "comment_id": 81316918, "body": "mFrame.at&lt;Vec3b&gt; means that each pixel of mframe is CV_8UC3 (BGR), and it is not it is 4 floats. In your example probably there should not be any harm, you read 3 bytes and you put them back... but if you change them in any way in the middle it should. use Vec4f and remember that is not BGR since you have a 4th channel !!"}], "answers": [{"tags": [], "owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "is_accepted": true, "score": 1, "last_activity_date": 1510156536, "creation_date": 1510156536, "answer_id": 47184130, "question_id": 47183534, "link": "https://stackoverflow.com/questions/47183534/android-opencv-convertto-from-cv-32fc4-to-cv-8uc4/47184130#47184130", "title": "Android OpenCV convertTo() from CV_32FC4 to CV_8UC4", "body": "<ul>\n<li>You're working on a 4 channel float matrix, so you should access it with <code>Vec4f</code>.</li>\n<li>You don't need to initialize the output matrix from a OpenCV function in general. So just use <code>Mat mResult;</code> and <code>cvtColor</code> will take care of creating it correctly.</li>\n<li>You don't need to access a pixel with <code>Point</code>, simply pass the rows and cols coordinates.</li>\n</ul>\n\n<p>So the code becomes:</p>\n\n<pre><code>Mat mFrame(height, width, CV_32FC4, (unsigned char *)pNV21FrameData);\n\nfor(int y = 0 ; y &lt; height ; y++){\n    for(int x = 0 ; x &lt; width ; x++){\n        Vec4f BGRA = mFrame.at&lt;Vec4f&gt;(y,x);\n        // BGRA Pixel Manipulations\n        mFrame.at&lt;Vec4f&gt;(y,x) = BGRA;\n    }\n}\n\nMat mResult;\nmFrame.convertTo(mResult, CV_8UC4, 1.0/255.0);\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 4669995, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/hC6Mb.jpg?s=128&g=1", "display_name": "mmuncada", "link": "https://stackoverflow.com/users/4669995/mmuncada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 47184130, "answer_count": 1, "score": 0, "last_activity_date": 1510156536, "creation_date": 1510154801, "question_id": 47183534, "link": "https://stackoverflow.com/questions/47183534/android-opencv-convertto-from-cv-32fc4-to-cv-8uc4", "title": "Android OpenCV convertTo() from CV_32FC4 to CV_8UC4", "body": "<p>I'm just new to Android &amp; OpenCV and currently I'm using <a href=\"https://github.com/ikkiChung/MyRealTimeImageProcessing\" rel=\"nofollow noreferrer\">this</a> project for real-time image processing. I am using the <a href=\"https://github.com/ikkiChung/MyRealTimeImageProcessing/blob/master/JNI/ImageProcessing.cpp\" rel=\"nofollow noreferrer\">native code cpp</a> from the project to implement the algorithm that I need which involves mathematical operations with float numbers applying modifications for the RGB channels for each pixel. Therefore I think it's just appropriate to use <strong>CV_32FC4</strong> for the first matrix. Adjustments I did in the cpp:</p>\n\n<pre><code>Mat mFrame(height, width, CV_32FC4, (unsigned char *)pNV21FrameData);\nMat mResult(height, width, CV_8UC4, (unsigned char *)poutPixels);\n\nfor(int y = 0 ; y &lt; height ; y++){\n    for(int x = 0 ; x &lt; width ; x++){\n        Vec3b BGR = mFrame.at&lt;Vec3b&gt;(Point(x,y));\n        // BGR Pixel Manipulations\n        mFrame.at&lt;Vec3b&gt;(Point(x,y)) =  BGR;\n    }\n}\n\nmFrame.convertTo(mResult, CV_8UC4, 1/255.0);\n</code></pre>\n\n<p>After implementing the algorithm, I'll need to convert the matrix to BGRA since it is the requirement so I'll used <strong>CV_8UC4</strong>. But when I run the program there is a problem with the display: <a href=\"https://i.imgur.com/ro3ac8H.jpg\" rel=\"nofollow noreferrer\"><em>link for actual image</em></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/K5TFs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K5TFs.png\" alt=\"Output Image\"></a></p>\n\n<p>The white objects in the right side seems to be multiple instances of ruined version of what is displayed. There's nothing like that with the original code that is Canny Edge Detection so I suppose it's not a problem with my device. What could possibly be the problem?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1510154723, "post_id": 47183473, "comment_id": 81315953, "body": "<code>a = +2;</code> is equivalent to <code>a = 2;</code>"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1510154726, "post_id": 47183473, "comment_id": 81315955, "body": "The last thing you do before <code>printf</code> is assigning <code>2</code> to <code>a</code>. Not sure what else you expected."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1510154746, "post_id": 47183473, "comment_id": 81315969, "body": "<code>a += 2</code> is the same as <code>a = a + 2</code>. <code>a =+ 2</code> is equal to <code>a = +2</code> which is equal to <code>a = 2</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1510154774, "post_id": 47183473, "comment_id": 81315998, "body": "Have you tried running this in a debugger? Hint: what does &quot;a = +2&quot; actually do?. Hint: &quot;= +&quot; is not an operator."}, {"owner": {"reputation": 21, "user_id": 8233299, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002950003009/picture?type=large", "display_name": "Rakesh Saini", "link": "https://stackoverflow.com/users/8233299/rakesh-saini"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510154830, "post_id": 47183473, "comment_id": 81316048, "body": "@Fran&#231;oisAndrieux ... + sign doesnt makes any sense here ?"}, {"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1510154885, "post_id": 47183473, "comment_id": 81316091, "body": "@RakeshSaini Its how you&#39;re using it. <code>+=</code> means something. but <code>= +2</code> just means <code>=2</code>."}, {"owner": {"reputation": 21, "user_id": 8233299, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002950003009/picture?type=large", "display_name": "Rakesh Saini", "link": "https://stackoverflow.com/users/8233299/rakesh-saini"}, "edited": false, "score": 0, "creation_date": 1510154899, "post_id": 47183473, "comment_id": 81316101, "body": "not yet bt now i&#39;ll @jdv"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1510154924, "post_id": 47183473, "comment_id": 81316126, "body": "@RakeshSaini <code>operator+(int)</code> exists and does nothing to the value. It&#39;s not strictly wrong here, but it&#39;s not necessary either."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1510154933, "post_id": 47183473, "comment_id": 81316136, "body": "@RakeshSaini why do you think you can put <code>+</code> anywhere you want and it would not change expression? Do you think that <code>a = 2+;</code> should work? How about <code>+a=2;</code>?"}, {"owner": {"reputation": 21, "user_id": 8233299, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002950003009/picture?type=large", "display_name": "Rakesh Saini", "link": "https://stackoverflow.com/users/8233299/rakesh-saini"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1510155182, "post_id": 47183473, "comment_id": 81316337, "body": "do not panic bro @Slava... i found this program somewhere..executed and got confused...btw what i think is stackoverflow is meant for asking questions ri8"}, {"owner": {"reputation": 21, "user_id": 8233299, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002950003009/picture?type=large", "display_name": "Rakesh Saini", "link": "https://stackoverflow.com/users/8233299/rakesh-saini"}, "edited": false, "score": 0, "creation_date": 1510155265, "post_id": 47183473, "comment_id": 81316401, "body": "thanks everyone i got it ."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1510161574, "post_id": 47183527, "comment_id": 81320811, "body": "You can&#39;t overload unary <code>operator+</code> for <code>int</code> (or any other builtin type). You can only overload operators when at least one user-defined type is involved."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1510170143, "post_id": 47183527, "comment_id": 81325954, "body": "@PeteBecker: Peter that&#39;s right."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1510191904, "post_id": 47183527, "comment_id": 81334423, "body": "@PeteBecker.: Please check it..I guess this is now complete? Thanks for suggetsions."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1510191876, "last_edit_date": 1510191876, "creation_date": 1510154797, "answer_id": 47183527, "question_id": 47183473, "link": "https://stackoverflow.com/questions/47183473/why-the-output-is-2-not-7-how-sign-makes-it-different/47183527#47183527", "title": "why the output is 2 not 7 ? how + sign makes it different", "body": "<p>I am not sure why you want to get a different output after assigning a variable to a value (immediately before printing it).</p>\n\n<p>This is not magic.  </p>\n\n<p><code>a = +2;</code> is same as <code>a= 2;</code></p>\n\n<p>You are overwriting the value of <code>a</code>.  so there is no use of <code>a+=2</code>.\nYou can directly write <code>int a=2</code>.</p>\n\n<p><sub>Interestingly, the compiler (any good one!) will probably eliminate the <code>a+=2</code> statement by using some technique known as dead code elimination.</sub></p>\n\n<p><code>+2</code> is basically applying the unary oprator <code>+</code> to the integer <code>2</code>. And then it is assignment statement.</p>\n\n<hr>\n\n<h3>Unless you overloaded unary <code>+</code>it shouldn't make you feel out of context loooking at this behavior.</h3>\n\n<p>To be more precise, you can't overload <code>int</code> or builtin type. So there is no way , you are overloading that <code>+</code>. (And there is no user-defined type)(<sup>Peter Becker's comment</sup>)</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 3257274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MVT1U.png?s=128&g=1", "display_name": "gbougiakas", "link": "https://stackoverflow.com/users/3257274/gbougiakas"}, "is_accepted": false, "score": 0, "last_activity_date": 1510154883, "creation_date": 1510154883, "answer_id": 47183579, "question_id": 47183473, "link": "https://stackoverflow.com/questions/47183473/why-the-output-is-2-not-7-how-sign-makes-it-different/47183579#47183579", "title": "why the output is 2 not 7 ? how + sign makes it different", "body": "<p>In order for the output to be 7 your code should be</p>\n\n<pre><code>int main()\n{\n        int a=3;\n        a +=2;\n        a = a+2;\n        printf(\"%d\",a);\n}\n</code></pre>\n\n<p>By typing a = +2; before your printf line you just assign the positive value of 2 to your a variable.</p>\n\n<p>a += 2 is the same thing as a = a + 2</p>\n\n<p>a =+2 sets the value to 2 no matter what the value was before.</p>\n"}], "owner": {"reputation": 21, "user_id": 8233299, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002950003009/picture?type=large", "display_name": "Rakesh Saini", "link": "https://stackoverflow.com/users/8233299/rakesh-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1510155254, "answer_count": 2, "score": -1, "last_activity_date": 1510191876, "creation_date": 1510154680, "question_id": 47183473, "link": "https://stackoverflow.com/questions/47183473/why-the-output-is-2-not-7-how-sign-makes-it-different", "closed_reason": "Duplicate", "title": "why the output is 2 not 7 ? how + sign makes it different", "body": "<pre><code>int main()\n{\n        int a=3;\n        a +=2;\n        a = +2;\n        printf(\"%d\",a);\n}\n</code></pre>\n\n<p>The output of this program is 2 why ?</p>\n"}, {"tags": ["c++", "cmake", "googletest", "qmake"], "comments": [{"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 1, "creation_date": 1510154870, "post_id": 47183439, "comment_id": 81316080, "body": "Not what you asked but Qt does support CMake as a build system."}], "answers": [{"comments": [{"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1510214255, "post_id": 47183580, "comment_id": 81341936, "body": "But can it include a project via a link to github and keep the library up to date automatically? As I understand it, this is the cool thing about cmake external project, or?"}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1510244861, "post_id": 47183580, "comment_id": 81362658, "body": "AFAIK <code>gtest-all.cc</code> an <code>gmock-all.cc</code> are auto generated by script (it combine other sources) and are always up to date. So if you build only those two it will always be up to date."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "reply_to_user": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1510255474, "post_id": 47183580, "comment_id": 81369067, "body": "Sorry I&#39;ve a bit misunderstand you. Now I see that you are referring to CMake <code>ExternalProject_Add</code> functionality. Sadly there is no equivalent in Qt pro file, but you can use git submodule functionality (or tree) to compensate that."}, {"owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "edited": false, "score": 0, "creation_date": 1510305239, "post_id": 47183580, "comment_id": 81387844, "body": "Maybe you could make that your answer? Then I could accept it."}], "tags": [], "owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1510155298, "last_edit_date": 1510155298, "creation_date": 1510154884, "answer_id": 47183580, "question_id": 47183439, "link": "https://stackoverflow.com/questions/47183439/is-there-a-qmake-equivalent-of-cmakes-externalproject/47183580#47183580", "title": "Is there a qmake equivalent of cmake&#39;s ExternalProject", "body": "<p>Yes it is it is <code>SUBDIRS</code><br>\nSee <a href=\"http://doc.qt.io/qt-5/qmake-variable-reference.html#subdirs\" rel=\"nofollow noreferrer\">documentation</a> for details.</p>\n\n<p>In subdirectory you can create *.pro file which will build a <code>gtest</code> as a library.\nIf I remember correctly you have to build only two files <code>gtest-all.cc</code> and <code>gmock-all.cc</code> and add respective include directory.</p>\n\n<p><code>gtest</code> is great, but for Qt where signals and slots are used QT Test Lib should do the job too.</p>\n"}], "owner": {"reputation": 803, "user_id": 2801669, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/01238119df8da5d4af5f0aa6a76b7261?s=128&d=identicon&r=PG&f=1", "display_name": "newandlost", "link": "https://stackoverflow.com/users/2801669/newandlost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510155298, "creation_date": 1510154571, "question_id": 47183439, "link": "https://stackoverflow.com/questions/47183439/is-there-a-qmake-equivalent-of-cmakes-externalproject", "title": "Is there a qmake equivalent of cmake&#39;s ExternalProject", "body": "<p>I wanted to figure out how to include googletest in my project. Hence I read the <a href=\"https://github.com/google/googletest/blob/master/googletest/README.md\" rel=\"nofollow noreferrer\">README</a> for the installation instructions. Like I understand it there are always three options how to add a library: </p>\n\n<ol>\n<li>static linked</li>\n<li>dynamic linked </li>\n<li>directly include the source code into your project. </li>\n</ol>\n\n<p>I guess</p>\n\n<blockquote>\n  <p>This is done by making the GoogleTest source code available to the\n  main build and adding it using CMake's add_subdirectory() command.\"</p>\n</blockquote>\n\n<p>means directly including the source code into your project, hence option 3.</p>\n\n<p>They mention that the best way to implement option 3, is to:</p>\n\n<blockquote>\n  <p>Use CMake to download GoogleTest as part of the build's configure\n  step. This is just a little more complex, but doesn't have the\n  limitations of the other methods.</p>\n</blockquote>\n\n<p>They do this by making use of a cmake feature called <em>ExternalProject</em>:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8.2)\n\nproject(googletest-download NONE)\n\ninclude(ExternalProject)\nExternalProject_Add(googletest\n  GIT_REPOSITORY    https://github.com/google/googletest.git\n  GIT_TAG           master\n  SOURCE_DIR        \"${CMAKE_BINARY_DIR}/googletest-src\"\n  BINARY_DIR        \"${CMAKE_BINARY_DIR}/googletest-build\"\n  CONFIGURE_COMMAND \"\"\n  BUILD_COMMAND     \"\"\n  INSTALL_COMMAND   \"\"\n  TEST_COMMAND      \"\"\n)\n</code></pre>\n\n<p>As I understand it, the benefit is that it automatically searches for updates when building the project. Unfortunately I have no clue about cmake. And compared to qmake the syntax of cmake is awful. Therefore I am asking: </p>\n\n<p>Is there a qmake equivalent to the ExternalProject of cmake? </p>\n"}, {"tags": ["c++", "serialization", "boost", "zeromq"], "comments": [{"owner": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 1, "creation_date": 1510211847, "post_id": 47183323, "comment_id": 81340672, "body": "As @user3666197 says below, the creation of a thread that looks like it might also be using the socket is suspicious. Also, have you considered using Google Protocol Buffers instead of Boost serialisation? It makes it easier to be programming language agnostic. I saw that there&#39;s some Python involved in your project, and GPB can generate code for Python just as well as it can for C++."}, {"owner": {"reputation": 105, "user_id": 5184827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eX3ah.jpg?s=128&g=1", "display_name": "A. Osterthun", "link": "https://stackoverflow.com/users/5184827/a-osterthun"}, "reply_to_user": {"reputation": 6143, "user_id": 2147218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JQVSl.jpg?s=128&g=1", "display_name": "bazza", "link": "https://stackoverflow.com/users/2147218/bazza"}, "edited": false, "score": 0, "creation_date": 1510583927, "post_id": 47183323, "comment_id": 81484272, "body": "I will look into GPB. But I would like to use boost serialization for now. That is just for convenience reasons and less dependencies in the whole software stack."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5184827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eX3ah.jpg?s=128&g=1", "display_name": "A. Osterthun", "link": "https://stackoverflow.com/users/5184827/a-osterthun"}, "edited": false, "score": 0, "creation_date": 1510583416, "post_id": 47187639, "comment_id": 81483914, "body": "according to @user3666197 ZMQ won&#39;t transmit incomplete messages. So it seems like there is some problem with the using ZMQ with threads even though I checked for shared zmq socket instances and couldn&#39;t find any."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 105, "user_id": 5184827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eX3ah.jpg?s=128&g=1", "display_name": "A. Osterthun", "link": "https://stackoverflow.com/users/5184827/a-osterthun"}, "edited": false, "score": 0, "creation_date": 1510591317, "post_id": 47187639, "comment_id": 81489334, "body": "I&#39;ve seen it (heck, I&#39;ve even <a href=\"https://stackoverflow.com/questions/47183323/c-boost-serialization-input-stream-error/47187639?noredirect=1#comment81343623_47195545\">made it readable for me</a>). I agree that there&#39;s likely some cause of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behaviour</a> elsewhere in the code. Undefined Behaviour <i>includes</i> data races (as suggested) but is hardly limited to that. Looking at the code once again, may I suggest add flush of streams/archive at reliable times: <a href=\"http://paste.ubuntu.com/25955032/\" rel=\"nofollow noreferrer\">paste.ubuntu.com/25955032</a>"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1510167720, "creation_date": 1510167720, "answer_id": 47187639, "question_id": 47183323, "link": "https://stackoverflow.com/questions/47183323/c-boost-serialization-input-stream-error/47187639#47187639", "title": "C++ Boost Serialization: Input Stream Error", "body": "<p>If it's timing sensitive, no doubt it's unrelated to boost: the boost code shown is completely synchronous and local. If you don't always receive the full streams you get this error. Likewise if there's a protocol error interpreting the received data you might get corrupt data.</p>\n\n<p>Both cases would easily lead to \"input stream error\".</p>\n\n<p>I have no experience with 0MQ so I don't know whether the code as shown could receive incomplete messages, but I'd look into that.</p>\n\n<hr>\n\n<p><em>A minor note is that it's rather strange to have one <code>stringstream</code> and the other <code>istringstream</code>. There might be differences in seek behaviour.</em></p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 5184827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eX3ah.jpg?s=128&g=1", "display_name": "A. Osterthun", "link": "https://stackoverflow.com/users/5184827/a-osterthun"}, "edited": false, "score": 0, "creation_date": 1510264853, "post_id": 47195545, "comment_id": 81374083, "body": "Thank you for the detailed answer. I\u2018ll review my code tomorrow and look for shared zmq instances."}, {"owner": {"reputation": 105, "user_id": 5184827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eX3ah.jpg?s=128&g=1", "display_name": "A. Osterthun", "link": "https://stackoverflow.com/users/5184827/a-osterthun"}, "edited": false, "score": 0, "creation_date": 1510582047, "post_id": 47195545, "comment_id": 81483013, "body": "So I looked for shared zmq socket instances, but I can&#39;t find any. If you look into the ZMQMessageReceiver of the rgbd-calib framework you can see that every time the a new client signs in with a handshake, the update method of the ZMQMessageReceiver is called and is going to create a new thread with ZMQMessageReceiver::receive which then creates its discrete zmq context and socket even if the context could be shared in this case because it is thread safe.  So sadly this should not be an issue in this case I think."}], "tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": false, "score": 0, "last_activity_date": 1510209959, "creation_date": 1510209959, "answer_id": 47195545, "question_id": 47183323, "link": "https://stackoverflow.com/questions/47183323/c-boost-serialization-input-stream-error/47195545#47195545", "title": "C++ Boost Serialization: Input Stream Error", "body": "<p>Let me add a few cents on ZeroMQ part of the story:</p>\n\n<h2>Fact #1:<br>ZeroMQ does never deliver a piece of trash<br> it delivers either a complete message<sub>( as it was sent )</sub> or nothing at all</h2>\n\n<p>this principal design feature helps to sort out one of the claimed potential issues.</p>\n\n<p>If an application indeed receives a ZeroMQ message delivered, one can be sure of its being of a shape and sound copy of what has been dispatched from the remote process. It is simply the same. Pullstop.</p>\n\n<h2>Fact #2:<br> ZeroMQ architects and evangelists do<br><sub> in every chapter since the very beginning of the ZeroMQ API v2.xx </sub>warn to never share</h2>\n\n<p>which seems from the code depicted above unclear.</p>\n\n<p>If one instantiates a ZeroMQ-socket AccessPoint ( of a <strong><code>SUB</code></strong>-type in the above context ), the thread owning such AccessPoint resource is the only thread that may manipulate with such resource and never \"let\" any other touch  this toy. Never. While there might be some recent talks and efforts to re-design the ZeroMQ core, so as to add a thread-safety ex-post, I remain skeptical as per these moves, being principally sure that a non-blocking high-performance + low-latency motivated designs in distributed computing should never share a common piece, right because of the costs of overheads and lost principal safety ( which is not easy to be got just ex-post bought back by any inter-thread signalling / locking / blocking ).</p>\n\n<p>You may review the code, so as to confirm or deny any kind of sharing ZeroMQ instances ( a <code>Context</code> being another, separate subject in this ) and for cases, where shared pieces were detected, your team ought re-design the code so as to avoid it.</p>\n\n<p>Yes. Avoid sharing and ZeroMQ tools will serve you as a hell. </p>\n"}], "owner": {"reputation": 105, "user_id": 5184827, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/eX3ah.jpg?s=128&g=1", "display_name": "A. Osterthun", "link": "https://stackoverflow.com/users/5184827/a-osterthun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1510605324, "creation_date": 1510154248, "last_edit_date": 1510605324, "question_id": 47183323, "link": "https://stackoverflow.com/questions/47183323/c-boost-serialization-input-stream-error", "title": "C++ Boost Serialization: Input Stream Error", "body": "<p>Hi fellow C++ developers,</p>\n\n<p>I'm trying to send a C++ class over the network with <code>zmq</code> and <code>boost::serialization</code>. </p>\n\n<p>The concept is to serialize the class <code>PlayCommand</code> on the client. Then send it to the server with <code>zmq</code>. And the deserialize it on the server.</p>\n\n<p>This works fine in the rest of the application. For some reason I get input stream errors while deserializing the <code>PlayCommand</code> on the server from time to time. I can not figure out why it is sometimes throwing this exception and sometimes not.</p>\n\n<p>It seems to be a time sensitive problem. Do I have to wait at some point to let boost do its thing ?</p>\n\n<pre><code>std::shared_ptr&lt;PlayCommand&gt; _exe(dynamic_cast&lt;PlayCommand*&gt;(_cmd.get()));\n\n\n    zmq::context_t _ctx(1);\n    zmq::socket_t _skt(_ctx, ZMQ_PUB);\n    _skt.connect(\"tcp://0.0.0.0:\" + this-&gt;kinect_daemon_com_port);\n\n    std::stringstream _type_stream;\n    std::stringstream _exe_stream;\n    boost::archive::text_oarchive _type_archive(_type_stream);\n    boost::archive::text_oarchive _exe_archive(_exe_stream);\n    _type_archive &lt;&lt; _type;\n    _exe_archive &lt;&lt; *_exe.get();\n\n\n    std::string _type_msg_str = _type_stream.str();\n    std::string _exe_msg_str = _exe_stream.str();\n    zmq::message_t _type_msg(_type_msg_str.length());\n    zmq::message_t _exe_msg(_exe_msg_str.length());\n\n\n    memcpy(_type_msg.data(), _type_msg_str.data(), _type_msg_str.length());\n    memcpy(_exe_msg.data(), _exe_msg_str.data(), _exe_msg_str.length());\n\n    _skt.send(_type_msg, ZMQ_SNDMORE);\n    _skt.send(_exe_msg, 0);\n</code></pre>\n\n\n\n<pre><code>void ZMQMessageResolver::resolve_message(std::shared_ptr&lt;Event&gt; _event, unsigned _unique_thread_id)\n{\n    std::cout &lt;&lt; \"ZMQMessageResolver::resolve_message(std::shared_ptr&lt;Event&gt; _event, unsigned _unique_thread_id)\" &lt;&lt; std::endl;\n\n\n    std::shared_ptr&lt;ZMQMessageEvent&gt; _zmq_event = std::static_pointer_cast&lt;ZMQMessageEvent&gt;(_event);\n    //(static_cast&lt;ZMQMessageEvent*&gt;(_event.get()));\n    ZMQMessageType _type;\n    PlayCommand _cmd;\n\n    auto _messages = _zmq_event-&gt;get_data();\n    auto _type_string = std::string(static_cast&lt;char*&gt;(_messages-&gt;front()-&gt;data()), _messages-&gt;front()-&gt;size());\n    auto _cmd_string = std::string(static_cast&lt;char*&gt;(_messages-&gt;back()-&gt;data()), _messages-&gt;back()-&gt;size());\n\n    std::stringstream _type_stream{_type_string};\n    std::istringstream _cmd_stream{_cmd_string};\n\n    boost::archive::text_iarchive _type_archive{_type_stream};\n    boost::archive::text_iarchive _cmd_archive{_cmd_stream};\n\n    std::cout &lt;&lt; \"1\" &lt;&lt; std::endl;\n    _type_archive &gt;&gt; _type;\n    std::cout &lt;&lt; \"2\" &lt;&lt; std::endl;\n    _cmd_archive &amp; _cmd;\n    std::cout &lt;&lt; \"3\" &lt;&lt; std::endl;\n\n    std::shared_ptr&lt;ThreadEvent&gt; _thread_event = std::make_shared&lt;ThreadEvent&gt;(_zmq_event-&gt;get_event_message());\n    _cmd.execute(_thread_event);\n\n    std::lock_guard&lt;std::mutex&gt; _lock{*this-&gt;thread_mutex};\n    this-&gt;finished_threads.push_back(_unique_thread_id);\n}\n</code></pre>\n\n<p>The complete project is on github: <a href=\"http://www.github.com/aosterthun/rgbd-calib\" rel=\"nofollow noreferrer\">rgbd-calib</a> and <a href=\"http://www.github.com/aosterthun/rgbd-calib-py\" rel=\"nofollow noreferrer\">rgbd-calib-py</a>.\nThe important files are /framework/ZMQMessageResolver.cpp in rgbd-calib and /src/KinectDaemon.cpp in rgbd-calib-py.</p>\n\n<p>I would appreciate any help.</p>\n\n<p><strong>First insights</strong>\nI checked for shared <strong><code>zmq::socket_t</code></strong> instances. I could not find any so thread safety should be a non issue. </p>\n\n<p>I found out that other developers are also experiencing problems with ZMQ multi part messages. Maybe that could be an issue in my case as well. Maybe someone as experiences with those. Do I have to take any safety measures when sending and receiving multi part messages ?</p>\n"}, {"tags": ["c++", "opengl"], "comments": [{"owner": {"reputation": 1454, "user_id": 1683902, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2d00f9a657d663d31fde89af0b2e6851?s=128&d=identicon&r=PG", "display_name": "Ian Young", "link": "https://stackoverflow.com/users/1683902/ian-young"}, "edited": false, "score": 1, "creation_date": 1510155125, "post_id": 47183216, "comment_id": 81316298, "body": "Multiplying a vector by a vector does a member by member multiplication, therefore, it might not do what you think it does.  try multiplying the diffuse colour by a single value instead, and setting the output to a vec4: <code>out vec4 color;</code>  <code>color = vec4(MaterialDiffuseColor*0.5,1.0);</code>"}, {"owner": {"reputation": 374849, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 1, "creation_date": 1510155827, "post_id": 47183216, "comment_id": 81316765, "body": "This seems far more likely to be a bug elsewhere than to be due to multiplication. So you&#39;ll have to provide your actual source code."}, {"owner": {"reputation": 99, "user_id": 1348400, "user_type": "registered", "profile_image": "https://graph.facebook.com/1577761274/picture?type=large", "display_name": "Isaac Kwan", "link": "https://stackoverflow.com/users/1348400/isaac-kwan"}, "reply_to_user": {"reputation": 1454, "user_id": 1683902, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2d00f9a657d663d31fde89af0b2e6851?s=128&d=identicon&r=PG", "display_name": "Ian Young", "link": "https://stackoverflow.com/users/1683902/ian-young"}, "edited": false, "score": 0, "creation_date": 1510155964, "post_id": 47183216, "comment_id": 81316860, "body": "@IanYoung thanks for the pointer! Turns out that it was caused by the fact that I turned <code>GL_BLEND</code> on but yielded an output of <code>vec3</code>. I am going to call this a day and post this as a &quot;solution&quot; tomorrow. Thanks again, now I can finally sleep safe and sound."}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 1348400, "user_type": "registered", "profile_image": "https://graph.facebook.com/1577761274/picture?type=large", "display_name": "Isaac Kwan", "link": "https://stackoverflow.com/users/1348400/isaac-kwan"}, "is_accepted": true, "score": 1, "last_activity_date": 1510207602, "creation_date": 1510207602, "answer_id": 47194965, "question_id": 47183216, "link": "https://stackoverflow.com/questions/47183216/opengl-flickering-when-vector-is-multiplied/47194965#47194965", "title": "OpenGL Flickering when vector is multiplied", "body": "<p>It turns out that the issue is that OpenGL is expecting RGBA (<code>vec4</code>) output instead of RGB (<code>vec3</code>) because I enabled <code>GL_BLEND</code>.</p>\n\n<p><strong>Solution 1</strong>: Turn off <code>GL_BLEND</code> by removing <code>glEnable(GL_BLEND)</code>.</p>\n\n<p><strong>Solution 2</strong>: return a <code>vec4</code>. You can use <code>vec4(existing_vec3, 1.0)</code> to \"pad\" it into a 1x4 vector.</p>\n"}], "owner": {"reputation": 99, "user_id": 1348400, "user_type": "registered", "profile_image": "https://graph.facebook.com/1577761274/picture?type=large", "display_name": "Isaac Kwan", "link": "https://stackoverflow.com/users/1348400/isaac-kwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 47194965, "answer_count": 1, "score": 0, "last_activity_date": 1510207602, "creation_date": 1510154001, "last_edit_date": 1510155551, "question_id": 47183216, "link": "https://stackoverflow.com/questions/47183216/opengl-flickering-when-vector-is-multiplied", "title": "OpenGL Flickering when vector is multiplied", "body": "<p>I am working on an OpenGL assignment that requires us to incorporate Phong lighting model. However, I am seeing flickers when I tries to multiply two 1x3 vectors together.</p>\n\n<p>Double swapping is enabled, and so is mipmap.</p>\n\n<p>Examples:</p>\n\n<blockquote>\n  <p>color = texture(myTextureSampler, UV).rgb * vec3(0.5, 0.5, 0.5);</p>\n</blockquote>\n\n<p><img src=\"https://imgur.com/WBlqS5C.gif\" alt=\"\"></p>\n\n<blockquote>\n  <p>color = texture(myTextureSampler, UV).rgb * vec3(0.9, 0.9, 0.9);</p>\n</blockquote>\n\n<p><img src=\"https://i.imgur.com/m0odf3t.gif\" alt=\"\"></p>\n\n<blockquote>\n  <p>color = texture(myTextureSampler, UV).rgb * 0.9;</p>\n</blockquote>\n\n<p><img src=\"https://i.imgur.com/Svz9kMa.gif\" alt=\"\"></p>\n\n<blockquote>\n  <p>color = texture(myTextureSampler, UV).rgb * vec3(1.0, 1.0, 1.0);</p>\n</blockquote>\n\n<p><img src=\"https://i.imgur.com/qne7EYV.gif\" alt=\"\">\n(Yes... that's a gif)</p>\n\n<p><strong>UPDATE</strong>: even this flickers: </p>\n\n<blockquote>\n  <p>color = vec3(0.9, 0.1, 0.2);</p>\n</blockquote>\n\n<p><img src=\"https://i.imgur.com/aKswjE3.gif\" alt=\"\"></p>\n\n<p>Full source code is <a href=\"https://gist.github.com/isaackwan/763e83a59d677dfd9fb98e5a3e8d85a5\" rel=\"nofollow noreferrer\">here</a> which is based on the <a href=\"https://github.com/opengl-tutorials/ogl/tree/master/tutorial08_basic_shading\" rel=\"nofollow noreferrer\">opengl-tutorials.org code</a> but (hopefully) this question will be updated very soon with a minimal reproduction of the problem.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["c++", "qt", "process", "qprocess"], "comments": [{"owner": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "edited": false, "score": 0, "creation_date": 1510163193, "post_id": 47183035, "comment_id": 81321755, "body": "The code in your main function is not valid. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "reply_to_user": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "edited": false, "score": 0, "creation_date": 1510163653, "post_id": 47183035, "comment_id": 81322043, "body": "I&#39;m sorry, I wrote it on my mobile phone whilst sitting on the train. Should be better now."}, {"owner": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "edited": false, "score": 0, "creation_date": 1510164137, "post_id": 47183035, "comment_id": 81322342, "body": "It has already been suggested that you use <code>p.program()</code>. What output do you get from that, and how does it differ from what you were expecting?"}, {"owner": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "reply_to_user": {"reputation": 97291, "user_id": 984421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9J30.png?s=128&g=1", "display_name": "ekhumoro", "link": "https://stackoverflow.com/users/984421/ekhumoro"}, "edited": false, "score": 0, "creation_date": 1510209255, "post_id": 47183035, "comment_id": 81339535, "body": "I checked it in my application and it worked. The Qt doc explanation was just some misleading for me."}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "edited": false, "score": 0, "creation_date": 1510155468, "post_id": 47183712, "comment_id": 81316544, "body": "The Qt doc says &quot;Returns the program the process was last started with&quot; which is not what I want to have - I want to get the QProcess object&#39;s executable name or path, not the main one&#39;s."}, {"owner": {"reputation": 685, "user_id": 2191057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc2b4f825e60248b44c28bfa3341f10?s=128&d=identicon&r=PG", "display_name": "ramzes2", "link": "https://stackoverflow.com/users/2191057/ramzes2"}, "reply_to_user": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "edited": false, "score": 0, "creation_date": 1510155573, "post_id": 47183712, "comment_id": 81316604, "body": "Please add a sample how you used QProcess and what you expected to get"}, {"owner": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "edited": false, "score": 0, "creation_date": 1510156013, "post_id": 47183712, "comment_id": 81316906, "body": "I added an example now."}, {"owner": {"reputation": 685, "user_id": 2191057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc2b4f825e60248b44c28bfa3341f10?s=128&d=identicon&r=PG", "display_name": "ramzes2", "link": "https://stackoverflow.com/users/2191057/ramzes2"}, "reply_to_user": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "edited": false, "score": 0, "creation_date": 1510156290, "post_id": 47183712, "comment_id": 81317118, "body": "What version of Qt you used? QProcess object hasn&#39;t a constructor with string argument and your code was not compiled with Qt5."}], "tags": [], "owner": {"reputation": 685, "user_id": 2191057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc2b4f825e60248b44c28bfa3341f10?s=128&d=identicon&r=PG", "display_name": "ramzes2", "link": "https://stackoverflow.com/users/2191057/ramzes2"}, "is_accepted": true, "score": 2, "last_activity_date": 1510155272, "creation_date": 1510155272, "answer_id": 47183712, "question_id": 47183035, "link": "https://stackoverflow.com/questions/47183035/getting-the-executable-name-of-a-qprocess-in-qt-c/47183712#47183712", "title": "Getting the executable name of a QProcess in Qt/C++", "body": "<p>Try to use <code>program()</code> method of the QProcess object, like this:</p>\n\n<pre><code>QProcess process(this);\nprocess.start(\"calc.exe\");\nqDebug() &lt;&lt; process.program();\nprocess.waitForFinished();\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 4217759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yvvTn.jpg?s=128&g=1", "display_name": "taiBsu", "link": "https://stackoverflow.com/users/4217759/taibsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "accepted_answer_id": 47183712, "answer_count": 1, "score": 2, "last_activity_date": 1510163630, "creation_date": 1510153492, "last_edit_date": 1510163630, "question_id": 47183035, "link": "https://stackoverflow.com/questions/47183035/getting-the-executable-name-of-a-qprocess-in-qt-c", "title": "Getting the executable name of a QProcess in Qt/C++", "body": "<p>Is there any possibility to figure out the executable name/path of a QProcess object? By now I only know that there is QProcess::pid() for identifying a process. Scouring the Qt doc hasn't lead to a useful solution so far.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Example</p>\n\n<pre><code>int main() {\n\u00a0\u00a0\u00a0 QProcess* p = new QProcess(this);\n\n    p-&gt;start(\"C:\\\\test.exe\");\n\n\u00a0\u00a0\u00a0 func(p);\n\n\u00a0\u00a0\u00a0 return 0;\n}\n\nvoid func (QProcess* p)\n{\n\u00a0\u00a0\u00a0\u00a0 qDebug() &lt;&lt; \"The application name of the app with pid\" &lt;&lt; p-&gt;pid() &lt;&lt; \"is\" &lt;&lt; p-&gt;name(); // name() doesn't exist, that's where I need help\n}\n</code></pre>\n"}, {"tags": ["c++", "idioms"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1510153512, "post_id": 47182977, "comment_id": 81314949, "body": "you can use <code>optional</code>, it is available in boost and afaik one of the latest c++ versions also has it"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1510153991, "post_id": 47182977, "comment_id": 81315356, "body": "Get rid of <code>sum</code> and then <code>return {terms, std::accumulate(terms.begin(), terms.end(), 0.))}</code> ?"}, {"owner": {"reputation": 3280, "user_id": 3493289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08927897947ad3bae66cf2d02f587ffc?s=128&d=identicon&r=PG&f=1", "display_name": "MS Srikkanth", "link": "https://stackoverflow.com/users/3493289/ms-srikkanth"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1510154552, "post_id": 47182977, "comment_id": 81315812, "body": "@Jarod42, that still requires two functions: one which returns {terms, std::accumulate...} and the other which returns {std::accumulate...} and doesn&#39;t address the question of code duplication when the code is more complicated than just a std:: accumulate call which is what the OP seems to be suggesting"}, {"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 1, "creation_date": 1510155701, "post_id": 47182977, "comment_id": 81316691, "body": "Can you elaborate on the performance difference you observed in practice when you implemented <code>double func() { return func_terms().second; }</code>? The optimizer may in fact be better than you expect."}], "answers": [{"comments": [{"owner": {"reputation": 4038, "user_id": 2159939, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/d4Hlu.jpg?s=128&g=1", "display_name": "Ivan Smirnov", "link": "https://stackoverflow.com/users/2159939/ivan-smirnov"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1510239877, "post_id": 47183373, "comment_id": 81358874, "body": "@Jarod42 Nice suggestion, the second solution is much more elegant indeed. I removed the other one."}], "tags": [], "owner": {"reputation": 4038, "user_id": 2159939, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/d4Hlu.jpg?s=128&g=1", "display_name": "Ivan Smirnov", "link": "https://stackoverflow.com/users/2159939/ivan-smirnov"}, "is_accepted": false, "score": 1, "last_activity_date": 1510239777, "last_edit_date": 1510239777, "creation_date": 1510154395, "answer_id": 47183373, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values/47183373#47183373", "title": "Write a function that may return either one or more values", "body": "<p><em>Here was a solution that suggested to pass an optional pointer to vector and to fill it only if present. I deleted it as other answers mention it as well and as the latter solution looks much more elegant.</em></p>\n\n<p>You can abstract your calculation to iterators, so callers remain very simple and no code is copied:</p>\n\n<pre><code>auto make_transform_counting_iterator(int i) {\n    return boost::make_transform_iterator(\n            boost::make_counting_iterator(i),\n            f);\n}\n\nauto my_begin() {\n    return make_transform_counting_iterator(0);\n}\n\nauto my_end() {\n    return make_transform_counting_iterator(100);\n}\n\ndouble only_sum() {\n    return std::accumulate(my_begin(), my_end(), 0.0);\n}\n\nstd::vector&lt;double&gt; fill_terms() {\n    std::vector&lt;double&gt; result;\n    std::copy(my_begin(), my_end(), std::back_inserter(result));\n    return result;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510163562, "post_id": 47183990, "comment_id": 81321983, "body": "That&#39;s very old-fashioned code; not only should <code>NULL</code> no longer be used ever since C++11 introduced <code>nullptr</code>, using a pointer is bad when we have <code>std::optional</code> since C++17 (and <code>boost::optional</code> or some self-made optional class before that). There&#39;s also a compilation error in your code when you access <code>terms</code> as if it was a reference and not a pointer."}], "tags": [], "owner": {"reputation": 11, "user_id": 5733988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef6a9dd6fa1a6786934b2095443272e0?s=128&d=identicon&r=PG&f=1", "display_name": "lining", "link": "https://stackoverflow.com/users/5733988/lining"}, "is_accepted": false, "score": 0, "last_activity_date": 1510156567, "last_edit_date": 1510156567, "creation_date": 1510156167, "answer_id": 47183990, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values/47183990#47183990", "title": "Write a function that may return either one or more values", "body": "<p>One of the simple way is to write a common function and use input parameter to do condition. Like this:</p>\n\n<pre><code>double logic(vector&lt;double&gt;* terms) {\n    double sum = 0.;\n    for (int i=0; i&lt;100; i++) {\n        if (terms != NULL) {\n            terms.push_back(i);\n        }\n        sum += terms[i];\n    }\n    return sum;\n}\n\ndouble func() {\n    return logic(NULL);\n}\n\n\npair&lt;vector&lt;double&gt;,double&gt; func_terms() {\n    vector&lt;double&gt; terms;\n    double sum = logic(&amp;ret);\n    return {terms, sum};\n}\n</code></pre>\n\n<p>this method is used in many conditions. The Logic can be very complicated and with many input options. You can use the same logic through different parameters. \nBut in most cases, We need not that much return values but just different input parameter. </p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1510157151, "creation_date": 1510157151, "answer_id": 47184368, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values/47184368#47184368", "title": "Write a function that may return either one or more values", "body": "<p>If you are not for:</p>\n\n<pre><code>std::pair&lt;std::vector&lt;double&gt;, double&gt; func_terms() {\n    std::vector&lt;double&gt; terms(100);\n\n    for (int i = 0; i != 100; ++i) {\n        terms[i] = f(i);\n    }\n    return {terms, std::accumulate(terms.begin(), terms.end(), 0.)};\n}\n</code></pre>\n\n<p>then maybe:</p>\n\n<pre><code>template &lt;typename Accumulator&gt;\nAccumulator&amp; func_helper(Accumulator&amp; acc) {\n    for (int i=0; i&lt;100; i++) {\n        acc(f(i));\n    }\n    return acc;\n}\n\ndouble func()\n{\n    double sum = 0;\n    func_helper([&amp;sum](double d) { sum += d; });\n    return sum;    \n}\n\nstd::pair&lt;std::vector&lt;double&gt;, double&gt; func_terms() {\n    double sum = 0.;\n    std::vector&lt;double&gt; terms;\n\n    func_helper([&amp;](double d) {\n        sum += d;\n        terms.push_back(d);\n    });\n\n    return {terms, sum};\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510163430, "post_id": 47184435, "comment_id": 81321904, "body": "The idea is not too bad and the solution looks a bit cleaner than my own, but some details about the code are strange: no initialisation list in the constructor, no <code>const</code> for <code>getSum</code>, redundant <code>protected</code> where <code>private</code> would suffice, no <code>std::</code> in code that&#39;s probably in a header file."}, {"owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1510164627, "post_id": 47184435, "comment_id": 81322614, "body": "I think you&#39;re right about const and std, thanks, I edited the code."}], "tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1510164513, "last_edit_date": 1510164513, "creation_date": 1510157358, "answer_id": 47184435, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values/47184435#47184435", "title": "Write a function that may return either one or more values", "body": "<p>I worked out an OOP solution, where a base class always compute sum and makes the current term available to derived classes, this way:</p>\n\n<pre><code>class Func\n{\npublic:\n    Func() { sum = 0.; }\n    void func()\n    {\n        for (int i=0; i&lt;100; i++)\n        {\n            double term = f(i);\n            sum += term;\n            useCurrentTerm(term);\n        }\n    }\n    double getSum() const { return sum; }\n\nprotected:\n    virtual void useCurrentTerm(double) {} //do nothing\n\nprivate:\n    double f(double d){ return d * 42;}\n    double sum;\n};\n</code></pre>\n\n<p>So a derived class can implement the virtual method and espose extra properties (other than sum):</p>\n\n<pre><code>class FuncWithTerms : public Func\n{\npublic:\n  FuncWithTerms() { terms.reserve(100); }\n  std::vector&lt;double&gt; getTerms() const { return terms; }\n\nprotected:\n  void useCurrentTerm(double t) { terms.push_back(t); }\n\nprivate:\n  std::vector&lt;double&gt; terms;\n};\n</code></pre>\n\n<p>If one doesn't want to expose these classes, could fall back to functions and use them as a fa\u00e7ade (yet <strong>two</strong> functions, but very manageable, now):</p>\n\n<pre><code>double sum_only_func()\n{\n  Func f;\n  f.func();\n  return f.getSum();\n}\n\nstd::pair&lt;std::vector&lt;double&gt;, double&gt; with_terms_func()\n{\n  FuncWithTerms fwt;\n  fwt.func();\n  return { fwt.getTerms(), fwt.getSum() };\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12663, "user_id": 139091, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/221d62beca0a3b687dad11376bc51c11?s=128&d=identicon&r=PG", "display_name": "mattnewport", "link": "https://stackoverflow.com/users/139091/mattnewport"}, "is_accepted": false, "score": 0, "last_activity_date": 1510160146, "last_edit_date": 1510160146, "creation_date": 1510159802, "answer_id": 47185309, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values/47185309#47185309", "title": "Write a function that may return either one or more values", "body": "<p>The simplest solution for this situation I think would be something like this:</p>\n\n<pre><code>double f(int x) { return x * x; }\n\nauto terms(int count) {\n    auto res = vector&lt;double&gt;{};\n    generate_n(back_inserter(res), count, [i=0]() mutable {return f(i++);});\n    return res;\n}\n\nauto func_terms(int count) {\n    const auto ts = terms(count);\n    return make_pair(ts, accumulate(begin(ts), end(ts), 0.0));\n}\n\nauto func(int count) {\n    return func_terms(count).second;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/Vt3jvX\" rel=\"nofollow noreferrer\">Live version</a>.</p>\n\n<p>But this approach gives <code>func()</code> different performance characteristics to your original version. There are ways around this with the current STL but this highlights an area where the STL is not ideal for composability. The <a href=\"https://ericniebler.github.io/range-v3/\" rel=\"nofollow noreferrer\">Ranges v3</a> library offers a better approach to composing algorithms for this type of problem and is in the process of standardization for a future version of C++.</p>\n\n<p>In general there is often a tradeoff between composability / reuse and optimal performance. At its best C++ lets us have our cake and eat it too but this is an example where there is work underway to give standard C++ better approaches to handle this sort of situation.</p>\n"}, {"comments": [{"owner": {"reputation": 487, "user_id": 1350864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/297721694e3e0d742c9789a01ebbbe37?s=128&d=identicon&r=PG", "display_name": "andrepd", "link": "https://stackoverflow.com/users/1350864/andrepd"}, "edited": false, "score": 0, "creation_date": 1510180326, "post_id": 47186321, "comment_id": 81331089, "body": "What I was thinking was almost something like this only that the compiler would actually generate the two versions of the function and statically dispatch to the appropriate function depending on the value of <code>option</code>. Because here there is <i>still</i> the creation and return of a vector and also a branch on every iteration (notwithstanding the fact that the compiler can host that out of the loop since <code>withTerms</code> is <code>const</code>), which means there is still a valid reason to just write the two separate versions."}], "tags": [], "owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "is_accepted": false, "score": 2, "last_activity_date": 1510163027, "creation_date": 1510163027, "answer_id": 47186321, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values/47186321#47186321", "title": "Write a function that may return either one or more values", "body": "<p>Your question title says <em>\"Write a function that may return either one or more values\"</em>, but it's more than that; as your example shows, the function may also do a lot of different things long before a result is returned. There really is no general solution to such a broad problem.</p>\n\n<p>However, for the specific case you've explained I'd like to offer a low-tech solution. You could simply implement both functions in terms of a third function and give that third function a parameter to determine whether the extra functionality is performed or not.</p>\n\n<p>Here is a C++17 example, in which that third function is called <code>func_impl</code> and more or less hidden inside a namespace to make life easier for the client of <code>func</code> and <code>func_terms</code>:</p>\n\n<pre><code>namespace detail {\n    enum class FuncOption {\n        WithTerms,\n        WithoutTerms\n    };\n\n    std::tuple&lt;std::vector&lt;double&gt;, double&gt; func_impl(FuncOption option) {\n        auto const withTerms = option == FuncOption::WithTerms;\n        double sum = 0.;\n        std::vector&lt;double&gt; terms(withTerms ? 100 : 0);\n        for (int i = 0; i &lt; 100; ++i) {\n            auto const result = f(i);\n            if (withTerms) {\n              terms[i] = result;\n            }\n            sum += result;\n        }\n        return std::make_tuple(terms, sum);\n    }   \n}\n\ndouble func() {\n    using namespace detail;\n    return std::get&lt;double&gt;(func_impl(FuncOption::WithTerms));\n}\n\nstd::tuple&lt;std::vector&lt;double&gt;, double&gt; func_terms() {\n    using namespace detail;\n    return func_impl(FuncOption::WithoutTerms);\n}\n</code></pre>\n\n<p>Whether that's <em>too</em> low-tech is up to you and depends on your exact problem.</p>\n"}], "owner": {"reputation": 487, "user_id": 1350864, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/297721694e3e0d742c9789a01ebbbe37?s=128&d=identicon&r=PG", "display_name": "andrepd", "link": "https://stackoverflow.com/users/1350864/andrepd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "answer_count": 6, "score": 1, "last_activity_date": 1510239777, "creation_date": 1510153341, "last_edit_date": 1510181360, "question_id": 47182977, "link": "https://stackoverflow.com/questions/47182977/write-a-function-that-may-return-either-one-or-more-values", "title": "Write a function that may return either one or more values", "body": "<p>Suppose I want to write a function that, say, returns the sum of f(x) for x in a certain range.</p>\n\n<pre><code>double func() {\n    double sum = 0.;\n    for (int i=0; i&lt;100; i++) {\n        sum += f(i);\n    }\n    return sum;\n}\n</code></pre>\n\n<p>But sometimes, in addition to the final sum I also need the partial terms, so I can do</p>\n\n<pre><code>pair&lt;vector&lt;double&gt;,double&gt; func_terms() {\n    double sum = 0.;\n    vector&lt;double&gt; terms(100);\n    for (int i=0; i&lt;100; i++) {\n        terms[i] = f(i);\n        sum += terms[i];\n    }\n    return {terms, sum};\n}\n</code></pre>\n\n<p>The thing is, this is code duplication. This seems very harmless in this example, but suppose the function is much larger (which it is in the situation that prompted me to ask this), and the two versions differ in just a handful of lines lines (in this example the logic is the same only the latter version stores the term in a vector before adding to sum, and returns a pair with that vector; any other logic is equivalent). Then I will have to write and maintain two nearly-identical versions of the same function, differing only in a couple lines and in the return statement. My question is if there is an idiom/pattern/best practice to deal with this kind of problem. Something that would let me share the common code between the two versions.</p>\n\n<p>In short: I can write two functions and have to maintain two nearly-identical versions. Or I can just use the latter but that will be very wasteful whenever I just need the sum, which is unacceptable. What's the best pattern to deal with this?</p>\n\n<hr>\n\n<p>I reckon that with C++17 one can do something like</p>\n\n<pre><code>template&lt;bool partials&gt;\ndouble func(vector&lt;double&gt;* terms=nullptr) {\n    double sum = 0.;\n    if constexpr (partials)\n        *terms = vector&lt;double&gt;(100);\n    for (int i=0; i&lt;100; i++) {\n        if constexpr (partials) {\n            (*terms)[i] = f(i);\n            sum += (*terms)[i];\n        } else {\n            sum += f(i);\n        }\n    }\n    return sum;\n}\n</code></pre>\n\n<p>Which comes very close to what I intended, apart from using pointers (I can't use references because <code>terms</code> may be empty). </p>\n"}, {"tags": ["c++", "future", "executor"], "owner": {"reputation": 1084, "user_id": 4443423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwXBe.jpg?s=128&g=1", "display_name": "Maikel", "link": "https://stackoverflow.com/users/4443423/maikel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1510168501, "creation_date": 1510153023, "last_edit_date": 1510168501, "question_id": 47182838, "link": "https://stackoverflow.com/questions/47182838/will-stdfuturethen-allocate-memory-custom-allocator-possible", "title": "Will `std::future::then` allocate memory? Custom allocator possible?", "body": "<p><code>std::promise</code> has a <a href=\"http://en.cppreference.com/w/cpp/thread/promise/promise\" rel=\"nofollow noreferrer\">constructor</a> which allocates the memory used to store the shared state. In implementations of <code>.then</code>, which I have seen so far, one stores a function in a type erased manner similar to <code>std::function</code> <em>in</em> the shared state. The <a href=\"https://github.com/stlab/libraries/blob/develop/stlab/concurrency/future.hpp\" rel=\"nofollow noreferrer\">Concurrency</a> library of stlab even goes so far as to put a </p>\n\n<pre><code>using then_t = std::vector&lt;std::pair&lt;executor_t, task&lt;void()&gt;&gt;&gt;;\n</code></pre>\n\n<p>into the shared state (to enable splittable futures). </p>\n\n<p><strong>Is there an intent to specify if an allocator could be specified for continuations?</strong> </p>\n\n<p>In <a href=\"http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0443r3.html\" rel=\"nofollow noreferrer\">P0443R3</a> they say in 1.2.9 Properties for customizing memory allocation</p>\n\n<blockquote>\n  <p>Executor implementations shall use the supplied allocator to allocate\n  any memory required to store the submitted function object.</p>\n</blockquote>\n\n<p>I think this only means the storage for agents submitted via the <code>execute</code> functions not the pointer <em>in</em> <code>std::future</code>'s shared state. </p>\n\n<p>I've looked into the recent proposals for futures or executors and I could not find anything. Recent papers seem to favour putting executors in the shared state of a future anyway. If an executor would have an associated custom allocator should this be used? </p>\n\n<p>I feel like I miss something.</p>\n\n<p>--</p>\n\n<p><strong>Edit:</strong> I thought about this more and I think I can grasp why one would like to leave this unspecified. If futures are ever parametrised by executors their shared state might schematically look like this</p>\n\n<pre><code>template &lt;typename Executor, typename T&gt;\nstruct shared_state_t {\n    // some prevention from race condition, for example\n    std::atomic&lt;unsigned&gt; flags;\n    // some sort of exception or value representation, for example\n    std::variant&lt;std::exception_ptr, T&gt; maybe_value;\n    // some handle to continuation\n    continuation_t&lt;Executor, T&gt; continuation;\n};\n</code></pre>\n\n<p>where <code>continuation_t&lt;Executor, T&gt;</code> does not need to allocate memory. It could be a pointer to an internal execution agent of one executor <code>Executor</code> or something like <code>std::function&lt;void(T&amp;&amp;)&gt;</code> for another executor.</p>\n"}, {"tags": ["c++", "glsl", "fragment-shader"], "comments": [{"owner": {"reputation": 2472, "user_id": 1749822, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4cdb85f1d8e3b018d13603b2282d074a?s=128&d=identicon&r=PG", "display_name": "Pietro Saccardi", "link": "https://stackoverflow.com/users/1749822/pietro-saccardi"}, "edited": false, "score": 1, "creation_date": 1510153581, "post_id": 47182826, "comment_id": 81315015, "body": "Welcome to StackOverflow! As you stated your question, it is difficult to tell what could be going wrong (see <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a>). Can you post the code involved? Also, too many elements are interacting; can you narrow it down to a <a href=\"https://stackoverflow.com/help/mcve\">MVCE</a>?"}, {"owner": {"reputation": 11, "user_id": 8907304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9737346357865e309bf7487891406c?s=128&d=identicon&r=PG&f=1", "display_name": "Raster", "link": "https://stackoverflow.com/users/8907304/raster"}, "reply_to_user": {"reputation": 2472, "user_id": 1749822, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4cdb85f1d8e3b018d13603b2282d074a?s=128&d=identicon&r=PG", "display_name": "Pietro Saccardi", "link": "https://stackoverflow.com/users/1749822/pietro-saccardi"}, "edited": false, "score": 0, "creation_date": 1510159873, "post_id": 47182826, "comment_id": 81319650, "body": "I really cannot post the code... I know that it is really fuzzy question, but I wasn&#39;t expecting exact solutions but rather some pointers like &quot;check XYZ for potential [conflicts/errors/bottlenecks etc.]&quot;. My question can be simplified to &quot;Why some shader sometimes works longer and sometimes shorter on the same data and how it can be connected to other GPU activities like Skype and/or in-app drawing&quot;."}, {"owner": {"reputation": 2472, "user_id": 1749822, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4cdb85f1d8e3b018d13603b2282d074a?s=128&d=identicon&r=PG", "display_name": "Pietro Saccardi", "link": "https://stackoverflow.com/users/1749822/pietro-saccardi"}, "edited": false, "score": 1, "creation_date": 1510160666, "post_id": 47182826, "comment_id": 81320183, "body": "As it is, you question is equivalent to asking vague debugging guidelines for shader performance; that\u2019s too broad and it\u2019s likely to get flagged and/or stay unanswered."}, {"owner": {"reputation": 2991, "user_id": 3877787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DPxhf.jpg?s=128&g=1", "display_name": "Zalman Stern", "link": "https://stackoverflow.com/users/3877787/zalman-stern"}, "edited": false, "score": 1, "creation_date": 1510161925, "post_id": 47182826, "comment_id": 81321015, "body": "How are you measuring the timing? The first thing to check in any GPU performance situation is that one is not including other execution in the timing scope. This is difficult as so many API calls are asynchronous."}, {"owner": {"reputation": 11, "user_id": 8907304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9737346357865e309bf7487891406c?s=128&d=identicon&r=PG&f=1", "display_name": "Raster", "link": "https://stackoverflow.com/users/8907304/raster"}, "edited": false, "score": 0, "creation_date": 1510163320, "post_id": 47182826, "comment_id": 81321836, "body": "I measure time after a glFinish(), to be sure that shader has finished."}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "edited": false, "score": 0, "creation_date": 1510240079, "post_id": 47182826, "comment_id": 81359041, "body": "Please use an OpenGL profiler <a href=\"https://en.wikipedia.org/wiki/VOGL\" rel=\"nofollow noreferrer\">like vOGL</a>, for example, and show us its output on a &#171;good&#187; and a &#171;bad&#187; pass. The source of the problem shall become way clearer \u2014 not only for us, but for you too."}], "owner": {"reputation": 11, "user_id": 8907304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9737346357865e309bf7487891406c?s=128&d=identicon&r=PG&f=1", "display_name": "Raster", "link": "https://stackoverflow.com/users/8907304/raster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510160765, "creation_date": 1510152973, "last_edit_date": 1510160765, "question_id": 47182826, "link": "https://stackoverflow.com/questions/47182826/weird-glsl-fragment-shader-behaviour-running-time", "title": "Weird GLSL fragment shader behaviour - running time", "body": "<p>I have one fragment shader, which gives me a headache, because it sometimes runs fast, and sometimes very slow, on the same data.</p>\n\n<p>This shader is run by two different classes, using the same calling code. (there used to be different calling codes, but now it is copy-paste to be sure it is not a source of this behaviour). Only one of these classes work at any single run of app, I select them before clicking \"start\". Clicking \"stop\" and then \"start\" again can lead to different running times.</p>\n\n<p>When called from first class, it gives me a consistent running times of 6~7 ms per frame.\nWhen called from second class, running times are either the same as from first class (~30% of runs), or about 3~4 times slower (18~24ms per frame). There is no pattern when it will be fast and when it will be slow. I could start my app, and first run could be slow and second run could be fast, or vice versa, or any other combination. </p>\n\n<p>These classes are both parts of their respective workflows. Both workflows gave consistent times before current changes. Nothing other than these two classes was changed. When first of these two classes was updated, it was also OK - both of them. Weird behaviour started when I made similar changes in second class. Currently shader and its calling code is now the same in both classes.</p>\n\n<p>I have also noticed that:</p>\n\n<ul>\n<li>when this shader works slower, then all other shaders are also slower (but not 3~4x, only some 50% slower). </li>\n<li>having running Skype in background, calling a coworker and sharing my desktop has very positive effect on running times - shader works fast more often, ~80% of runs. Especially when my app is started when desktop sharing is already running.</li>\n<li>disabling some drawing also has some effect, by SLOWING shader even more often (only ~10% of runs are fast), and it is even slower (24~30ms).</li>\n</ul>\n\n<p>I have no idea why it happens. I can't show the code, and I'm not expecting exact solution, but can someone point me in some direction, where to look for errors or something?</p>\n"}, {"tags": ["c++", "opencv", "cbir", "flannbasedmatcher"], "comments": [{"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510162909, "post_id": 47182666, "comment_id": 81321582, "body": "Show includes and linked libs"}, {"owner": {"reputation": 1, "user_id": 8872306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b8361a519c87680a42a407446f9ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Wendy", "link": "https://stackoverflow.com/users/8872306/wendy"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510195603, "post_id": 47182666, "comment_id": 81335320, "body": "Added to my question, thanks!"}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510211346, "post_id": 47182666, "comment_id": 81340416, "body": "You&#39;re linking to 64 bit libraries , build with vc12 (visual studio 2013). Obviously this doesn&#39;t work"}, {"owner": {"reputation": 1, "user_id": 8872306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b8361a519c87680a42a407446f9ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Wendy", "link": "https://stackoverflow.com/users/8872306/wendy"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510216955, "post_id": 47182666, "comment_id": 81343337, "body": "Ah sorry I copied the wrong configuration... I linked to x86 instead of x64, but vc12 is correct because there are only vc11 and vc12 under the folder. I think this may not be the problem because I can run opencv correctly except for this &#39;match&#39; function problem."}, {"owner": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510217019, "post_id": 47182666, "comment_id": 81343373, "body": "No, that&#39;s the problem."}, {"owner": {"reputation": 1, "user_id": 8872306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b8361a519c87680a42a407446f9ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Wendy", "link": "https://stackoverflow.com/users/8872306/wendy"}, "reply_to_user": {"reputation": 37050, "user_id": 5008845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a5f08da4793fc6fdd168f81c5100dc?s=128&d=identicon&r=PG&f=1", "display_name": "Miki", "link": "https://stackoverflow.com/users/5008845/miki"}, "edited": false, "score": 0, "creation_date": 1510218178, "post_id": 47182666, "comment_id": 81344034, "body": "Do you mean the problem is by using vc12? But what else should I use?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8872306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b8361a519c87680a42a407446f9ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Wendy", "link": "https://stackoverflow.com/users/8872306/wendy"}, "is_accepted": true, "score": 0, "last_activity_date": 1511081338, "creation_date": 1511081338, "answer_id": 47375113, "question_id": 47182666, "link": "https://stackoverflow.com/questions/47182666/opencv-program-crash-after-matching-descriptors/47375113#47375113", "title": "opencv program crash after matching descriptors", "body": "<p>I've found out the problem. The code works for opencv2.4.13 and vs2012 instead of vs2017. Maybe it's just because opencv2.4.13 is not compatible with vs2017.</p>\n"}], "owner": {"reputation": 1, "user_id": 8872306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b8361a519c87680a42a407446f9ee7?s=128&d=identicon&r=PG&f=1", "display_name": "Wendy", "link": "https://stackoverflow.com/users/8872306/wendy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 47375113, "answer_count": 1, "score": 0, "last_activity_date": 1511081338, "creation_date": 1510152510, "last_edit_date": 1510195552, "question_id": 47182666, "link": "https://stackoverflow.com/questions/47182666/opencv-program-crash-after-matching-descriptors", "title": "opencv program crash after matching descriptors", "body": "<p>I'm using SIFT descriptor and FLANN matcher to get the minimum distance of the matches between two pictures. The first picture is a query picture and the second picture is from the dataset. I want to load the second picture one by one using a loop, but right after the first iteration, the program crashes at runtime after displaying the result of the first iteration and fails to enter the second iteration. I'm using opencv 2.4.13 and vs2017. Below is my code:</p>\n\n<pre><code>#include \"opencv2/highgui/highgui.hpp\"\n#include \"opencv2/imgproc/imgproc.hpp\"\n#include \"opencv2/nonfree/nonfree.hpp\"\n#include \"opencv2/nonfree/features2d.hpp\"\n#include &lt;opencv2/legacy/legacy.hpp&gt;\n\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\nusing namespace cv;\n\n#define IMAGE_folder \"D:\\\\Project\\\\dataset1\"  // change to your folder location\n\nint main()\n{\n    initModule_nonfree();\n    const int filename_len = 900;\n    char tempname1[filename_len];\n    sprintf_s(tempname1, filename_len, \"%s\\\\%s\", IMAGE_folder, \"995.jpg\");\n    Mat i1 = imread(tempname1);\n    Mat img1, img2;\n    cvtColor(i1, img1, COLOR_BGR2GRAY);\n\n    if (!i1.data)\n    {\n        printf(\"Cannot find the input image!\\n\");\n        system(\"pause\");\n        return -1;\n    }\n\n    std::vector&lt;KeyPoint&gt; key_points1, key_points2;\n    Mat descriptors1, descriptors2;\n\n    SIFT sift;\n    sift(img1, Mat(), key_points1, descriptors1);\n\n    for (int i = 990; i &lt; 1000; i++)\n    {\n        initModule_nonfree();\n        cout &lt;&lt; i &lt;&lt; endl;\n        char tempname2[filename_len];\n        sprintf_s(tempname2, filename_len, \"%s\\\\%d.jpg\", IMAGE_folder, i);\n        Mat i2 = imread(tempname2);\n        if (!i2.data)\n        {\n            printf(\"Cannot find the input image!\\n\");\n            system(\"pause\");\n            return -1;\n        }\n        cvtColor(i2, img2, COLOR_BGR2GRAY);\n        sift(img2, Mat(), key_points2, descriptors2);\n\n        FlannBasedMatcher matcher;\n        vector&lt;DMatch&gt; matches;\n        matches.clear();\n        matcher.match(descriptors1, descriptors2, matches);  //if I comment this line and the code below to show the distance, it can work\n\n        double max_dist = 0;\n        double min_dist = 100;\n\n        for (int j = 0; j &lt; descriptors1.rows; j++)\n        {\n            double dist = matches[j].distance;\n            if (dist &lt; min_dist)\n                min_dist = dist;\n            if (dist &gt; max_dist)\n                max_dist = dist;\n        }\n\n        //matcher.clear();  //I've tried these four but still cannot help\n        //matches.clear();\n        //key_points1.clear();\n        //key_points2.clear();\n\n        printf(\"-- Max dist : %f \\n\", max_dist);\n        printf(\"-- Min dist : %f \\n\", min_dist);\n        cout &lt;&lt; \"Done!\" &lt;&lt; endl;\n    }\n\n    //waitKey(0);\n    return 0;\n}\n</code></pre>\n\n<p>I've tried a lot and here are my problems and observation:</p>\n\n<ol>\n<li>It is not because I use iterations. If I only run the <code>matcher.match(descriptors1, descriptors2, matches);</code> , it will also crash after execution.</li>\n<li>It is also not working for SURF descriptor or BruteForceMatcher, both have the same problem with the code above. I've used different pieces of code from opencv tutorial using SURF, and it still crashes after displaying the result. <a href=\"https://docs.opencv.org/2.4/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html\" rel=\"nofollow noreferrer\">Example code from opencv tutorial see here</a></li>\n<li>I've also tried <code>initModule_nonfree();</code> as some answers said, but still didn't help.</li>\n<li>The program crashes after displaying \"Done!\" and not entering the next iteration. </li>\n<li>If I delete the <code>matcher.match(descriptors1, descriptors2, matches);</code> and the relevant code below, it can work properly. So the problem must be with the \"match\" function.</li>\n</ol>\n\n<p>Thanks a lot in advance!</p>\n\n<p>-----------------------------updated-----------------------------</p>\n\n<p>My includes and linked libraries are shown below:</p>\n\n<p>C:\\Program Files (x86)\\opencv\\build\\include\nC:\\Program Files (x86)\\opencv\\build\\include\\opencv\nC:\\Program Files (x86)\\opencv\\build\\include\\opencv2</p>\n\n<p>C:\\Program Files (x86)\\opencv\\build\\x64\\vc12\\staticlib\nC:\\Program Files (x86)\\opencv\\build\\x64\\vc12\\lib</p>\n\n<p>opencv_objdetect2413.lib\nopencv_ts2413.lib\nopencv_video2413.lib\nopencv_nonfree2413.lib\nopencv_ocl2413.lib\nopencv_photo2413.lib\nopencv_stitching2413.lib\nopencv_superres2413.lib\nopencv_videostab2413.lib\nopencv_calib3d2413.lib\nopencv_contrib2413.lib\nopencv_core2413.lib\nopencv_features2d2413.lib\nopencv_flann2413.lib\nopencv_gpu2413.lib\nopencv_highgui2413.lib\nopencv_imgproc2413.lib\nopencv_legacy2413.lib\nopencv_ml2413.lib</p>\n\n<p>I think the configuration may not have problems... I use it in release mode under x86, thanks!</p>\n"}, {"tags": ["c++", "floating-point", "range", "normalization"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1510152528, "post_id": 47182590, "comment_id": 81314164, "body": "You should be aware that, in c++, a range is usually taken to mean a pair of iterators that denote the beginning and end of a set of elements in a container. While the question isn&#39;t technically wrong, the terminology may lead to some confusion."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1510152635, "post_id": 47182590, "comment_id": 81314244, "body": "@Fran&#231;oisAndrieux: I&#39;m not talking about containers"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 2, "creation_date": 1510152645, "post_id": 47182590, "comment_id": 81314253, "body": "Off the top of my head, no. Rolling your own doesn&#39;t sound fun either, but is plausible I suppose"}, {"owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1510152949, "post_id": 47182590, "comment_id": 81314510, "body": "Not sure what you are asking. You have a range of values and you want to count distinct values? Is that correct?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1510153053, "post_id": 47182590, "comment_id": 81314579, "body": "@Ron question is about a range of floating point values, in the sense of an interval [a,b], not a range of elements in a container or iterators"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1510153245, "post_id": 47182590, "comment_id": 81314716, "body": "@Ron check it out <a href=\"https://en.wikipedia.org/wiki/Unit_in_the_last_place\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Unit_in_the_last_place</a>"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 4, "creation_date": 1510153290, "post_id": 47182590, "comment_id": 81314743, "body": "@Ron no, if you think there is infinite number of floating points in [a,b] you need to either review floating points or infinity ;)"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1510153388, "post_id": 47182590, "comment_id": 81314831, "body": "@Ron i am not familiar with Computer Science SE, but as the question is asking for a concrete solution in c++, i dont see why it would not fit here"}, {"owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1510156642, "post_id": 47182590, "comment_id": 81317350, "body": "If you are interested in preserving as much available and distinct values as possible, you may consider to use <code>long double</code>s for the intermediate calculations. As it&#39;s now, you are already restricting to [0,1] and then applying the <code>pow</code> function, loosing some other distinct values."}], "answers": [{"comments": [{"owner": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 1, "creation_date": 1510153884, "post_id": 47182943, "comment_id": 81315277, "body": "I&#39;m not sure this is what the OP&#39;s <i>really</i> looking for, because the map given by ToNormalizedParam ( and its formal inverse ) is neither injective nor surjective and depends on rounding mode ( and iee754 conformance )..."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 0, "creation_date": 1510154078, "post_id": 47182943, "comment_id": 81315440, "body": "@MassimilianoJanes I made the only conclusion I can, we&#39;ll have to wait for OP to clarify I suppose."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 5334, "user_id": 8631381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMqAd.png?s=128&g=1", "display_name": "Massimiliano Janes", "link": "https://stackoverflow.com/users/8631381/massimiliano-janes"}, "edited": false, "score": 0, "creation_date": 1510155366, "post_id": 47182943, "comment_id": 81316474, "body": "@MassimilianoJanes how ToNormalizedParam round doesn&#39;t matter here. Different values will collide on different ones, yes, but the range between 0 and 1, despite the round function, is always that on a fixed machine"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510155401, "post_id": 47182943, "comment_id": 81316502, "body": "i.e. I&#39;m not asking which numbers will be used after the normalization, but how many possible values I can use"}], "tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": false, "score": 1, "last_activity_date": 1510304093, "last_edit_date": 1510304093, "creation_date": 1510153272, "answer_id": 47182943, "question_id": 47182590, "link": "https://stackoverflow.com/questions/47182590/is-there-a-function-to-retrieve-the-number-of-available-distinct-values-within-a/47182943#47182943", "title": "Is there a function to retrieve the number of available distinct values within a range?", "body": "<p>Given a positive IEEE 754 double precision floating point number with exponent <code>e</code> and mantissa <code>m</code>, both interpreted as an integer, the distinct values (not counting denormalized values) less than it but greater than zero will be exactly <code>m + (e - 1) * 2^52</code>.</p>\n\n<p>Which could be extracted like so</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;tuple&gt;\n#include&lt;cstdint&gt;\n#include&lt;cstring&gt;\n\nusing std::uint64_t;\n\nstd::tuple&lt;uint64_t, uint64_t, uint64_t&gt; explode(double d)\n{\n    static_assert(sizeof(double) == 8);\n    uint64_t u;\n    std::memcpy(&amp;u, &amp;d, sizeof(d));\n    return { (u &amp; 0x8000000000000000) &gt;&gt; 63,\n             (u &amp; 0x7FF0000000000000) &gt;&gt; 52,\n              u &amp; 0x000FFFFFFFFFFFFF };\n}\n\nuint64_t distinct(double d)\n{\n    auto [_, e, m] = explode(d);\n    return m + ((e - 1) &lt;&lt; 52);\n}\n\nint main()\n{\n    std::cout &lt;&lt; \"[-48, 48]: \" &lt;&lt; 2 * distinct(48) &lt;&lt; \"\\n[0, 1]: \" &lt;&lt; distinct(1) &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/389da19ee4f87f63\" rel=\"nofollow noreferrer\">Live</a></p>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510227742, "post_id": 47184081, "comment_id": 81350249, "body": "I don&#39;t get <code>There are as many FP numbers 0.5 to 1.0 as between 16.0 to 32.0.</code>. If between <code>0.5</code> and <code>1.0</code> there are (let say) <code>X</code> possible values, between <code>0.0</code> and <code>40.0</code> there are those <code>X</code> plus the ones between <code>0.0-0.5</code> and <code>1.0-40.0</code>. Way big. How can they be &quot;the same&quot; considering different ranges? :O"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510228570, "post_id": 47184081, "comment_id": 81350804, "body": "@markzzz Does <a href=\"https://stackoverflow.com/a/43284459/2410359\">distributed linearly but logarithmically in linear groups</a> help?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510228794, "post_id": 47184081, "comment_id": 81350929, "body": "@markzzz X values between 1.0 to 2.0, X values between 2.0 to 4.0, X values between 4.0 to 8.0, etc.  X values between 0.25 to 0.125, X values between 0.125 to 0.0625, X values between 0.0625 to 0.03125, etc"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510229500, "post_id": 47184081, "comment_id": 81351365, "body": "no you misunderstand me :) <a href=\"http://coliru.stacked-crooked.com/a/5731f7dd8f486e68\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/5731f7dd8f486e68</a> : the more the range is &quot;huge&quot;, the more available values you can use. 10 and 91 setting 1 magnitude up. X change for every range."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510229976, "post_id": 47184081, "comment_id": 81351670, "body": "@markzzz Between 0.5 to 1.0, your program will report X different values, maybe about 4.5e15 (if you let it run long enough).  Between 16.0 to 32.0, it will report the same.  Try with <code>float</code>, X should be about 8,300,000."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510232472, "post_id": 47184081, "comment_id": 81353321, "body": "@markzzz Your code compares 2 ranges, the seconds is a <a href=\"https://en.wikipedia.org/wiki/Subset#Definitions\" rel=\"nofollow noreferrer\">superset</a> of the first, so a larger number is expected.  My &quot;as many FP numbers 0.5 to 1.0 as between 16.0 to 32.0&quot; compares 2 separate <a href=\"https://en.wikipedia.org/wiki/Disjoint_sets\" rel=\"nofollow noreferrer\">disjoint sets</a>.  Yes, [0 40.0] has more members than sets [0.5 1.0] and  [16.0 32.0] combined.  Yet that is not the point.  Set [0.5 1.0] and set [16.0 32.0] each have the same member count."}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "edited": false, "score": 0, "creation_date": 1510234315, "post_id": 47184081, "comment_id": 81354675, "body": "Man, Am I on drugs? I&#39;m talking about how many different values there (i.e. I can use) between two different sets. You also said this: &quot;Yes, [0 40.0] has more <b>members</b> than sets [0.5 1.0] and [16.0 32.0] combined.&quot;"}, {"owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1510234327, "post_id": 47184081, "comment_id": 81354686, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/158607/discussion-between-markzzz-and-chux\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1510196391, "last_edit_date": 1510196391, "creation_date": 1510156399, "answer_id": 47184081, "question_id": 47182590, "link": "https://stackoverflow.com/questions/47182590/is-there-a-function-to-retrieve-the-number-of-available-distinct-values-within-a/47184081#47184081", "title": "Is there a function to retrieve the number of available distinct values within a range?", "body": "<blockquote>\n  <p>Is there a ready-to-go function in C++?</p>\n</blockquote>\n\n<p>Perhaps.  If not, it is easy enough to form a function to assigned a sequence number to each <code>double</code> value.</p>\n\n<p>Assuming matching FP/integer  for endian &amp; size and typical FP layout like <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">double64</a>, the below is valid <code>-INF</code> to <code>INF</code>.</p>\n\n<pre><code>// Return a sequence number for each `double` value.\n// Numerically sequential `double` values will have successive (+1) sequence numbers.\nuint64_t double_sequence(double x) {\n  uint64_t u64;\n  memcpy(&amp;u64, &amp;x, sizeof u64);\n  if (u64 &amp; 0x8000000000000000) {\n    u64 ^= 0x8000000000000000;\n    return 0x8000000000000000 - u64;\n  }\n  return u64 + 0x8000000000000000;\n}\n</code></pre>\n\n<blockquote>\n  <p>Is there a function to retrieve the number of available distinct values within a range?</p>\n</blockquote>\n\n<p>Simply subtract the sequence numbers.  +1 or -1 depending on if an <a href=\"https://en.wikipedia.org/wiki/Interval_(mathematics)#Terminology\" rel=\"nofollow noreferrer\">open or closed range</a>.</p>\n\n<pre><code>double_sequence(1.0)  - double_sequence(0.0)   + 1 --&gt; 0x3ff0000000000001\ndouble_sequence(48.0) - double_sequence(-48.0) + 1 --&gt; 0x8090000000000001\n</code></pre>\n\n<hr>\n\n<p>Notes:<br>\nKeep in mind that FP are logarithmically distributed overall and linear within  powers of 2.<br>\nFor about half of all FP, <code>|x| &lt; 1.0</code>.<br>\nThere are as many FP numbers 0.5 to 1.0 as between 16.0 to 32.0.<br>\nThere are over twice as many <code>double</code> in the <code>[-48.0 ... 48.0]</code> versus <code>[0.0 ... 1.0]</code> range, primarily due to negative values.</p>\n"}], "owner": {"reputation": 44495, "user_id": 365251, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2dd996e4168722dd3618db77880716e6?s=128&d=identicon&r=PG&f=1", "display_name": "markzzz", "link": "https://stackoverflow.com/users/365251/markzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 47184081, "answer_count": 2, "score": 3, "last_activity_date": 1510304093, "creation_date": 1510152267, "question_id": 47182590, "link": "https://stackoverflow.com/questions/47182590/is-there-a-function-to-retrieve-the-number-of-available-distinct-values-within-a", "title": "Is there a function to retrieve the number of available distinct values within a range?", "body": "<p>I'm using double precision floating point variables within an application I'm making.</p>\n\n<p>I normalize some ranges of values. Going from (for example; I've many ranges) <code>-48.0</code> to <code>48.0</code> to <code>0.0</code> to <code>1.0</code>, using this simply function:</p>\n\n<pre><code>double ToNormalizedParam(double nonNormalizedValue, double min, double max, double shape) {\n    return pow((nonNormalizedValue - min) / (max - min), 1.0 / shape);\n}\n</code></pre>\n\n<p>I'd like to know the differences in available and distinct values mapping from a range to another.</p>\n\n<p>Is there a ready-to-go function in C++? I've looked at <code>numeric_limits</code>, but I can't find anything useful.</p>\n"}, {"tags": ["c++", "sfml"], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1510154317, "post_id": 47183228, "comment_id": 81315625, "body": "Also some drivers have restrictions about dimensions needing to be powers of two, so it is possible to have issues even while under the maximum."}], "tags": [], "owner": {"reputation": 33251, "user_id": 409744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b055a62302498782454622c61e44aa51?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/409744/mario"}, "is_accepted": true, "score": 2, "last_activity_date": 1510154043, "creation_date": 1510154043, "answer_id": 47183228, "question_id": 47182579, "link": "https://stackoverflow.com/questions/47182579/maximum-sfml-texture-dimentions/47183228#47183228", "title": "Maximum SFML texture dimentions", "body": "<p>SFML doesn't force any maximum texture size. This is hardware dependent and SFML just uses (and reports), what the driver tells it.</p>\n\n<p>To retrieve the maximum texture size:</p>\n\n<pre><code>const unsigned int maxSize = sf::Texture::getMaximumSize();\n</code></pre>\n\n<p>On your hardware this will most likely return <code>4096</code>. What happens if you request a bigger texture is up to the drivers and their OpenGL implementation. It's outside SFML's control.</p>\n"}], "owner": {"reputation": 89, "user_id": 8328235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HLgA3.jpg?s=128&g=1", "display_name": "Adam W.", "link": "https://stackoverflow.com/users/8328235/adam-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 47183228, "answer_count": 1, "score": 1, "last_activity_date": 1510154043, "creation_date": 1510152253, "question_id": 47182579, "link": "https://stackoverflow.com/questions/47182579/maximum-sfml-texture-dimentions", "title": "Maximum SFML texture dimentions", "body": "<p>I'm using a texture for my project that has the dimentions of 7500x800. When i load it into my project and draw it on the sf::Renderwindow window, it only shows give or take half of it (i have events that make the Sprite with the texture change position and thats how i can tell). Is there a maximum pixel count or somthing like that in sfml, or is it somthing else?</p>\n"}, {"tags": ["c++", "arrays", "variable-length-array"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1510152028, "post_id": 47182429, "comment_id": 81313801, "body": "&quot;Raw&quot; arrays are never dynamic (they do not change size), but can be dynamically allocated. <code>std::vector</code> is dynamic (can resize at runtime) and should be used in this case."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1510152032, "post_id": 47182429, "comment_id": 81313805, "body": "VLA is not standard C++. it is an extention."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 0, "creation_date": 1510152343, "post_id": 47182429, "comment_id": 81314024, "body": "<i>allocates memory at compile time</i> no, that is not possible."}, {"owner": {"reputation": 9353, "user_id": 845413, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/F6eYZ.png?s=128&g=1", "display_name": "Ryan Taylor", "link": "https://stackoverflow.com/users/845413/ryan-taylor"}, "edited": false, "score": 0, "creation_date": 1510179831, "post_id": 47182429, "comment_id": 81330855, "body": "@manni66 you&#39;re right. I think they mean a static, fixed-size array"}], "answers": [{"tags": [], "owner": {"reputation": 6306, "user_id": 5662469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZYgSJ.png?s=128&g=1", "display_name": "Deepak K Gupta", "link": "https://stackoverflow.com/users/5662469/deepak-k-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1510152917, "creation_date": 1510152917, "answer_id": 47182797, "question_id": 47182429, "link": "https://stackoverflow.com/questions/47182429/dynamic-arrays-and-static-arrays-compile-time-or-runtime/47182797#47182797", "title": "Dynamic Arrays and Static Arrays Compile Time or Runtime?", "body": "<p>There are compiler extensions called \"Variable Length Array\" as part C99 standards, which allows this declaration.</p>\n\n<p>The C99 standard are not officially supported as part of C++ Language. </p>\n\n<p>The code above will not work in MSVS (Microsoft Visual Studio) as it doesn't support C99, but will be successfully compiled by <code>gcc</code> and <code>clang</code></p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 8896695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f97374caae7a590a8220c2a9f43d6b?s=128&d=identicon&r=PG", "display_name": "Elle", "link": "https://stackoverflow.com/users/8896695/elle"}, "is_accepted": false, "score": 0, "last_activity_date": 1510155074, "creation_date": 1510155074, "answer_id": 47183638, "question_id": 47182429, "link": "https://stackoverflow.com/questions/47182429/dynamic-arrays-and-static-arrays-compile-time-or-runtime/47183638#47183638", "title": "Dynamic Arrays and Static Arrays Compile Time or Runtime?", "body": "<p>Static arrays get stored on the stack, but dynamic arrays are stored on the heap. When something is stored on the stack, the moment it goes out of scope, it is disposed of. Examples are ints, chars, etc. But, if it is created on the heap, you have to ensure garbage collection does its job when it goes out of scope. If you don't clean up and de-allocate memory properly, you can get memory leaks.</p>\n"}], "owner": {"reputation": 11, "user_id": 7644891, "user_type": "registered", "profile_image": "https://graph.facebook.com/1409637479078214/picture?type=large", "display_name": "Kishor Subedi", "link": "https://stackoverflow.com/users/7644891/kishor-subedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 796, "favorite_count": 1, "closed_date": 1510541589, "answer_count": 2, "score": 0, "last_activity_date": 1510155074, "creation_date": 1510151826, "last_edit_date": 1510152055, "question_id": 47182429, "link": "https://stackoverflow.com/questions/47182429/dynamic-arrays-and-static-arrays-compile-time-or-runtime", "closed_reason": "Duplicate", "title": "Dynamic Arrays and Static Arrays Compile Time or Runtime?", "body": "<p>I understand the basic concept of Static Arrays and dynamic arrays. The main difference between these two are one(Static Array) allocates memory at compile time, and the other at runtime. However, we can create static array whose size would be the user entered value. </p>\n\n<pre><code>int value ;\ncin &gt;&gt; value  ;\n\nint array [value] ;\nint i = 0 ;\nwhile(i &lt; value)\n{\n    cin &gt;&gt; array[i] ;\n    i ++ ; \n}\n</code></pre>\n\n<p>So the program doesn't know the size of this array, until runtime. \nSo What's the actual fundamental difference between static and dynamic arrays then, if static array can also be made to allocate space on runtime?? </p>\n\n<p>Also, talking about the resizability of the array. To expand a dynamic array, we can delete the previous array after copying it's elements to a new double sized dynamic array. We can do the same with Static Arrays too right? [However, the original array can not be deleted in this case, and uses redundant stack space. IS this the only difference between S.Array and D.Array then]</p>\n"}, {"tags": ["c++", "windows"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510153004, "post_id": 47182253, "comment_id": 81314546, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms687420(v=vs.85).aspx\" rel=\"nofollow noreferrer\">NtQueryInformationProcess</a> with <i>ProcessImageFileName</i> perfect worked on xp. the <code>QueryFullProcessImageName</code> with <code>PROCESS_NAME_NATIVE</code> exactly use this. for win32 path used <i>ProcessImageFileNameWin32</i> which available from vista"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510153184, "post_id": 47182253, "comment_id": 81314669, "body": "and if you need only some exe image information (guess based on your code snippet) you can simply query <code>ProcessImageInformation</code> which return to you <code>SECTION_IMAGE_INFORMATION</code>"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510153320, "post_id": 47182253, "comment_id": 81314773, "body": "@RbMm Thanks, I am only interested in a reliable way of determining if the process is x32 or x64 bit. I will have a try with your recommendation."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510153443, "post_id": 47182253, "comment_id": 81314887, "body": "<i>in a reliable way of determining if the process is x32 or x64 bit</i> simply call <code>IsWow64Process</code> in this case. or direct <i>ProcessWow64Information</i> with the same  \t <code>NtQueryInformationProcess </code>"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510153559, "post_id": 47182253, "comment_id": 81314988, "body": "In my tests, IsWow64Process does not work properly in some windows editions..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510153641, "post_id": 47182253, "comment_id": 81315057, "body": "this only say that your test have mistake. <code>IsWow64Process</code> which simply call <code>NtQueryInformationProcess(  ProcessWow64Information)</code> - 100% correct show 32/64 bit. your test is wrong"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510226991, "post_id": 47182253, "comment_id": 81349734, "body": "I disagree, you should read: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684139(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510227636, "post_id": 47182253, "comment_id": 81350172, "body": "and so what ? what concrete you mean ?"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510228069, "post_id": 47182253, "comment_id": 81350461, "body": "It will not work on Windows XP lower than SP2, and it is not reliable... if you read it. I need reliable way of checking on ANY Windows..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510228447, "post_id": 47182253, "comment_id": 81350734, "body": "if you need lower than sp2 (which already think not exist in real word) - use <code>NtQueryInformationProcess( ProcessWow64Information)</code> - however xp not exist in 64 bit variant at all. so called xp x64- is really win2003 x64 (nt 5.2)  and about <i>it is not reliable</i> - form where you decide this ?? this is 100% <b>reliable</b>"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510228492, "post_id": 47182253, "comment_id": 81350759, "body": "I have virtual machines running all types of windows and tested... and I also have windows xp x64 edition &quot;unofficial&quot; ( which people use! ) ..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510228580, "post_id": 47182253, "comment_id": 81350807, "body": "and so what ? are this fail ? for me simply very interesting, why you decide this <b>is not reliable</b> ? however if want use this even on win2000 or nt4 - call direct NtQueryInformationProcess( ProcessWow64Information)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510228787, "post_id": 47182253, "comment_id": 81350926, "body": "<i>windows xp x64 edition</i> - this is only marketing name for users. if you check version - this is <b>5.2</b> - so this is windows 2003 x64. and <code>IsWow64Process</code> here exist of course. <code>NtQueryInformationProcess</code> exist from nt4. so you always can call it. and <code>ProcessWow64Information</code> give 100% reliable way detect are this 32/64 bit process. if it return - ivalid info class error - (win200,nt4) - this mean 32 bit"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510228819, "post_id": 47182253, "comment_id": 81350944, "body": "@RbMm Thanks, I shall test more..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510229068, "post_id": 47182253, "comment_id": 81351085, "body": "yes, can test. but again <code>IsWow64Process</code> is <b>absolute reliable</b>. it can not exist (&lt; xp sp2) but if exist of course give correct result, if you have correct process handle. internally it call <code>NtQueryInformationProcess(hProcess,ProcessWow64Information,&amp;&zwnj;&#8203;wow, sizeof(wow),0)</code>. if you mean <i>technique is not a reliable way to detect whether the operating system is a 64-bit version of Windows</i> - so you confuse <i>Windows</i> and <i>process</i>. you of course can not determinate are <i>windows</i> is 64 or 32 bit system with this api. but you can determinate wow process."}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510229209, "post_id": 47182253, "comment_id": 81351168, "body": "@RbMm I understand, checkout my code: <a href=\"https://pastebin.com/xYKqrwT1\" rel=\"nofollow noreferrer\">pastebin.com/xYKqrwT1</a> would it be &quot;reliable&quot; way to do it ?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510229517, "post_id": 47182253, "comment_id": 81351380, "body": "1 - you not need <code>PROCESS_VM_READ</code> - remove this. <code>PROCESS_QUERY_INFORMATION</code> you need only on xp/2003. if you detect vista+ (major version &gt;= 6) better use <code>PROCESS_QUERY_LIMITED_INFORMATION</code>. you forget close process handle - what is serious error. you not check any errors. this code is very not ok."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510229601, "post_id": 47182253, "comment_id": 81351432, "body": "if you want full support all versions (even very old without GepProcAddress) - direct call <code>void* wow; NtQueryInformationProcess(hProcess,ProcessWow64Information,&amp;&zwnj;&#8203;\u200c\u200bwow, sizeof(wow),0). </code>"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510229622, "post_id": 47182253, "comment_id": 81351445, "body": "@RbMm It&#39;s not the complete code, it&#39;s just the part I check if x64... But I will try your method too !"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510230525, "post_id": 47182253, "comment_id": 81352011, "body": "in any case at compile time if defined <code>_WIN64</code> - you run on 64-bit windows. if not - you can call <code>ProcessWow64Information</code> or <code>IsWow64Process</code> for <b>self</b> process - if you wow - windows 64 bit. if no (or error/IsWow64Process not exist) - windows 32 bit. for detect some <i>process</i> 32 or 64 bit - call  <code>ProcessWow64Information</code> or <code>IsWow64Process</code> for <b>this</b> process - and this is 100% reliable on all versions"}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510230586, "post_id": 47182253, "comment_id": 81352057, "body": "@RbMm Thanks, will do."}, {"owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1510303548, "post_id": 47182253, "comment_id": 81386862, "body": "@RbMm You information is correct, if you post an answer I will accept it :) BTW, could we get in touch somehow ? I see from your profile that you have a waste experience in WinAPI and that is what I do all day and I have some questions if possible."}], "owner": {"reputation": 1041, "user_id": 6583298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5xZmG.jpg?s=128&g=1", "display_name": "Norbert Boros", "link": "https://stackoverflow.com/users/6583298/norbert-boros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 801, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1510151249, "creation_date": 1510151249, "question_id": 47182253, "link": "https://stackoverflow.com/questions/47182253/c-queryfullprocessimagenamea-alternative-for-windows-xp", "title": "C++ QueryFullProcessImageNameA alternative for Windows XP?", "body": "<p>I have found the following code in several places Google, so I have started testing. It works OK ( ish ) but the problem is \"<strong>QueryFullProcessImageNameA</strong>\" because according to Microsoft: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684919(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms684919(v=vs.85).aspx</a> this function works on minimum Windows Vista.</p>\n\n<p><strong>The code:</strong></p>\n\n<pre><code>int Is64(HANDLE ProcessHandle, PBOOL Is64)\n    {\n        int Status = 1;\n        HANDLE hFile = INVALID_HANDLE_VALUE;\n        LPVOID lpFile = 0;\n        DWORD dwFileSize = 0, dwReaded = 0, dwSize = MAX_PATH;\n        PIMAGE_NT_HEADERS NtHeaders = 0;\n        char Path[MAX_PATH];\n\n        //Minimum supported client Windows Vista[desktop apps only]\n        //TODO\n        if (!QueryFullProcessImageNameA(ProcessHandle, 0, Path, &amp;dwSize) || !Is64)\n        {\n            Status = 2;\n            goto EXIT;\n        }\n        hFile = CreateFileA(Path, GENERIC_READ, 0, 0, OPEN_EXISTING, 0, 0);\n        if (!hFile || hFile == INVALID_HANDLE_VALUE)\n        {\n            Status = 3;\n            goto EXIT;\n        }\n        dwFileSize = GetFileSize(hFile, 0);\n        lpFile = VirtualAlloc(0, dwFileSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);\n        if (!lpFile)\n        {\n            Status = 4;\n            goto EXIT;\n        };\n        if (!ReadFile(hFile, lpFile, dwFileSize, &amp;dwReaded, 0))\n        {\n            Status = 5;\n            goto EXIT;\n        }\n        NtHeaders = reinterpret_cast&lt;PIMAGE_NT_HEADERS&gt;((reinterpret_cast&lt;DWORD_PTR&gt;(lpFile) + PIMAGE_DOS_HEADER(lpFile)-&gt;e_lfanew));\n        if (!NtHeaders ||\n            NtHeaders-&gt;Signature != IMAGE_NT_SIGNATURE)\n        {\n            Status = 6;\n            goto EXIT;\n        }\n        if (NtHeaders-&gt;FileHeader.Machine == IMAGE_FILE_MACHINE_AMD64 || NtHeaders-&gt;FileHeader.Machine == IMAGE_FILE_MACHINE_IA64)\n        {\n            *Is64 = true;\n            Status = 7;\n            goto EXIT;\n        }\n        if (NtHeaders-&gt;FileHeader.Machine == IMAGE_FILE_MACHINE_I386)\n        {\n            *Is64 = false;\n            Status = 7;\n            goto EXIT;\n        }\n    EXIT:\n        if (hFile)\n            CloseHandle(hFile);\n        if (lpFile)\n            VirtualFree(lpFile, dwFileSize, MEM_DECOMMIT);\n        return true;\n    }\n</code></pre>\n\n<p>So my question is, is there an \"alternative\" for \"QueryFullProcessImageNameA\" which would work on Windows XP as well, without changing this function much ?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c++", "concurrency", "tbb"], "comments": [{"owner": {"reputation": 5833, "user_id": 2527797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83539ee8bca535eca6c4be5c856a738d?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/2527797/anton"}, "edited": false, "score": 0, "creation_date": 1510151833, "post_id": 47182231, "comment_id": 81313671, "body": "&#39;loop&#39;, not &#39;stop will fail&#39; i suppose?"}, {"owner": {"reputation": 12666, "user_id": 49329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cd991227ac34793b8bae42972cbb03d6?s=128&d=identicon&r=PG", "display_name": "Don Reba", "link": "https://stackoverflow.com/users/49329/don-reba"}, "reply_to_user": {"reputation": 5833, "user_id": 2527797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83539ee8bca535eca6c4be5c856a738d?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/2527797/anton"}, "edited": false, "score": 0, "creation_date": 1510152270, "post_id": 47182231, "comment_id": 81313970, "body": "@anton, <code>stop</code> won&#39;t terminate the loop, and the loop will potentially hang."}, {"owner": {"reputation": 5833, "user_id": 2527797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83539ee8bca535eca6c4be5c856a738d?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/2527797/anton"}, "edited": false, "score": 0, "creation_date": 1510152493, "post_id": 47182231, "comment_id": 81314139, "body": "Alexey, be more specific then please, i guess &#39;fail&#39; means fail to achieve the goal but not any segfault or hang of the stop function"}, {"owner": {"reputation": 12666, "user_id": 49329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cd991227ac34793b8bae42972cbb03d6?s=128&d=identicon&r=PG", "display_name": "Don Reba", "link": "https://stackoverflow.com/users/49329/don-reba"}, "reply_to_user": {"reputation": 5833, "user_id": 2527797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83539ee8bca535eca6c4be5c856a738d?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/2527797/anton"}, "edited": false, "score": 0, "creation_date": 1510159892, "post_id": 47182231, "comment_id": 81319666, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16961990/thread-building-blocks-concurrent-bounded-queue-how-do-i-close-it\">Thread Building Blocks concurrent_bounded_queue \u2014 how do I &#171;close&#187; it?</a>"}], "owner": {"reputation": 12666, "user_id": 49329, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cd991227ac34793b8bae42972cbb03d6?s=128&d=identicon&r=PG", "display_name": "Don Reba", "link": "https://stackoverflow.com/users/49329/don-reba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510152451, "creation_date": 1510151164, "last_edit_date": 1510152451, "question_id": 47182231, "link": "https://stackoverflow.com/questions/47182231/how-to-use-tbbs-concurrent-bounded-concurrent-queue-abort-correctly", "title": "How to use TBB&#39;s concurrent_bounded_concurrent_queue abort correctly?", "body": "<p>Suppose, we have a typical queue consumer loop with a stop flag:</p>\n\n<pre><code>class consumer {\n    atomic&lt;bool&gt; keep_running;\n    concurrent_bounded_queue queue;\n\n    void loop() {\n        while (keep_running)\n            // &lt;- danger zone\n            queue.pop();\n    }\n\n    void stop() {\n        keep_running = false;\n        queue.abort();\n    }\n};\n</code></pre>\n\n<p>If used as written, <code>stop</code> will fail when called after the <code>keep_running</code> check but before the <code>pop</code> call since <code>abort</code> only terminates <code>pop</code> calls already in progress.</p>\n\n<p>We also can't use a mutex to make sure the check and the <code>pop</code> are performed atomically, since then we would not be able to call <code>abort</code> while <code>pop</code> is in progress.</p>\n\n<p>What is the correct usage here?</p>\n"}, {"tags": ["c++", "multithreading", "openmp", "geos"], "comments": [{"owner": {"reputation": 488, "user_id": 7384437, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/386e2d14621537e11c4790308b91dbd0?s=128&d=identicon&r=PG&f=1", "display_name": "lars", "link": "https://stackoverflow.com/users/7384437/lars"}, "edited": false, "score": 0, "creation_date": 1510151921, "post_id": 47182166, "comment_id": 81313734, "body": "Why do you think you&#39;re doing something wrong? With a quick search, i could not find any documentation where thread-safety is noticed.  A unique_ptr should be optimized away in a release build, so is not the cause of your problems."}, {"owner": {"reputation": 1494, "user_id": 5962321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kaylT.png?s=128&g=1", "display_name": "Silmathoron", "link": "https://stackoverflow.com/users/5962321/silmathoron"}, "reply_to_user": {"reputation": 488, "user_id": 7384437, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/386e2d14621537e11c4790308b91dbd0?s=128&d=identicon&r=PG&f=1", "display_name": "lars", "link": "https://stackoverflow.com/users/7384437/lars"}, "edited": false, "score": 0, "creation_date": 1510152292, "post_id": 47182166, "comment_id": 81313987, "body": "If I understood correctly <a href=\"https://trac.osgeo.org/geos/wiki/RFC3\" rel=\"nofollow noreferrer\">that post</a>, all <code>_r</code> functions are supposed to be thread safe, but maybe I&#39;m not using them the right way..."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1511193580, "post_id": 47182166, "comment_id": 81745314, "body": "The crash happens inside <code>operator new</code>, which typically means memory has been overwritten (i.e., access outside of allocated bounds for some object or array, or writing to a deleted object)."}, {"owner": {"reputation": 1494, "user_id": 5962321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kaylT.png?s=128&g=1", "display_name": "Silmathoron", "link": "https://stackoverflow.com/users/5962321/silmathoron"}, "edited": false, "score": 0, "creation_date": 1511203204, "post_id": 47182166, "comment_id": 81750911, "body": "I understand, thank you for the insight, I will investigate that."}], "answers": [{"tags": [], "owner": {"reputation": 1494, "user_id": 5962321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kaylT.png?s=128&g=1", "display_name": "Silmathoron", "link": "https://stackoverflow.com/users/5962321/silmathoron"}, "is_accepted": true, "score": 2, "last_activity_date": 1511859064, "creation_date": 1511859064, "answer_id": 47527373, "question_id": 47182166, "link": "https://stackoverflow.com/questions/47182166/segfault-when-testing-the-intersection-with-geos-in-parallel/47527373#47527373", "title": "Segfault when testing the intersection with geos in parallel", "body": "<p>Apparently thread-safe implementation is not ready yet (see <a href=\"http://lists.osgeo.org/pipermail/geos-devel/2017-November/008157.html\" rel=\"nofollow noreferrer\">mailing list exchange</a>).\nI solved the problem by using a copy of the global environment geometry on each thread (this obviously also allows fully concurrent tests).</p>\n"}], "owner": {"reputation": 1494, "user_id": 5962321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kaylT.png?s=128&g=1", "display_name": "Silmathoron", "link": "https://stackoverflow.com/users/5962321/silmathoron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 47527373, "answer_count": 1, "score": 3, "last_activity_date": 1511859064, "creation_date": 1510150951, "last_edit_date": 1511457397, "question_id": 47182166, "link": "https://stackoverflow.com/questions/47182166/segfault-when-testing-the-intersection-with-geos-in-parallel", "title": "Segfault when testing the intersection with geos in parallel", "body": "<p>I am using GEOS's C API to manage geometry in a parallel simulator: I need to ensure that the objects stay inside a constrained area.\nTo that end when my object makes a step, I check whether the <code>line</code> between its previous and current position intersects the border of the environment (<code>environment_manager_-&gt;get_border()</code>, which returns a <code>const GEOSPreparedGeometry*</code>).</p>\n\n<p>The code is running in parallel with several OpenMP threads. I initialized GEOS before starting the simulation through</p>\n\n<pre><code>initGEOS_r(notice, log_and_exit);\ncontext_handler_ = GEOS_init_r();\n</code></pre>\n\n<p>so I have only one handler for all threads.\nWhen running the simulation with several threads the code crashes inside <code>env_intersect</code> with a segfault if I do not wrap <code>GEOSPreparedIntersects_r</code> in a critical section.</p>\n\n<pre><code>bool SpaceManager::env_intersect(const GEOSGeometry * line) const\n{\n    bool intersect;\n    // #pragma omp critical // adding prevents segfault\n    // {\n        intersect = GEOSPreparedIntersects_r(\n            context_handler_, environment_manager_-&gt;get_border(), line);\n    // }\n    return intersect;\n}\n</code></pre>\n\n<p>Could someone point me to what I'm doing wrong? Is it the initialization of GEOS that needs to be done differently to work with OpenMP? Does it come from the fact that <code>environment_manager_</code> is a <code>unique_ptr</code>? None of those?</p>\n\n<hr>\n\n<p>Backtrace of segfault gives:</p>\n\n<pre><code>Thread 19 \"python\" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7fffd63da700 (LWP 4374)]\n0x00007ffff78816b2 in tcache_get () from /usr/lib/libc.so.6\n(gdb) bt\n#0  0x00007ffff78816b2 in tcache_get () at /usr/lib/libc.so.6\n#1  0x00007ffff5dbf0a9 in operator new(unsigned long) (sz=sz@entry=32)\n    at /build/gcc-multilib/src/gcc/libstdc++-v3/libsupc++/new_op.cc:50\n#2  0x00007fffc8468273 in geos::geom::LineString::computeEnvelopeInternal() const (this=0x555555f10170) at LineString.cpp:278\n#3  0x00007fffc845b95f in geos::geom::Geometry::getEnvelopeInternal() const (this=0x555555f10180) at Geometry.cpp:276\n#4  0x00007fffc84612ad in geos::geom::GeometryCollection::computeEnvelopeInternal() const (this=0x555555f15980) at GeometryCollection.cpp:257\n#5  0x00007fffc845b95f in geos::geom::Geometry::getEnvelopeInternal() const (this=0x555555f15998) at Geometry.cpp:276\n#6  0x00007ffff53cea66 in geos::geom::prep::BasicPreparedGeometry::envelopesIntersect(geos::geom::Geometry const*) const () at /usr/lib/libgeos-3.6.2.so\n#7  0x00007ffff53cef82 in geos::geom::prep::PreparedLineString::intersects(geos::geom::Geometry const*) const () at /usr/lib/libgeos-3.6.2.so\n#8  0x00007ffff5907380 in GEOSPreparedIntersects_r ()\n    at /usr/lib/libgeos_c.so.1\n#9  0x00007ffff61d7938 in growth::SpaceManager::env_intersect(GEOSGeom_t const*) const (this=0x555555fb3b78, line=0x7fff7c045c20)\n</code></pre>\n\n<hr>\n\n<p><strong>[EDIT]</strong> making one <code>const GEOSPreparedGeometry*</code> copy of the environment per OMP thread and accessing only the thread specific copy successfully prevents the segfault in the absence of the <code>critical</code> section. The code becomes:</p>\n\n<pre><code>intersect = GEOSPreparedIntersects_r(\n        context_handler_, environment_manager_-&gt;get_border(omp_id), line);\n</code></pre>\n\n<p>where <code>environment_manager_-&gt;get_border(omp_id)</code> returns the thread-specific <code>const GEOSPreparedGeometry*</code>. This means that the problem came from the concurrent access to the shared data when I was previously using a single pointer. This seems weird since the function is supposed to be thread safe...</p>\n"}, {"tags": ["c++", "arrays", "containers", "strict-aliasing", "placement-new"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1510151251, "post_id": 47182119, "comment_id": 81313265, "body": "At a quick glance, it appears that you placement-new an object of correct type into the storage, so the pointer should be allowed to alias it. If I&#39;m mistaken, please elaborate on why do you think you&#39;re violating aliasing rules."}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 1, "creation_date": 1510151272, "post_id": 47182119, "comment_id": 81313283, "body": "Side note: In your initializer list constructor, shouldn&#39;t <code>maxElements</code> be initialized to <code>init.size()</code>?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1510151370, "post_id": 47182119, "comment_id": 81313368, "body": "However, the lack of destructor calls is suspicious. What kind of objects do you expect to be trivially destructable, but not trivially constructable?"}, {"owner": {"reputation": 3280, "user_id": 3493289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08927897947ad3bae66cf2d02f587ffc?s=128&d=identicon&r=PG&f=1", "display_name": "MS Srikkanth", "link": "https://stackoverflow.com/users/3493289/ms-srikkanth"}, "edited": false, "score": 0, "creation_date": 1510152456, "post_id": 47182119, "comment_id": 81314112, "body": "I don&#39;t see how this violates strict aliasing rules? What do you mean by dereferencing the pointer breaks strict aliasing rules? Without the use of aligned_storage your code might be a bit inefficient in that sometimes more memory reads would be issued than required. Otherwise I don&#39;t see why strict aliasing rules are broken here."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1510153448, "post_id": 47182119, "comment_id": 81314891, "body": "<code>std::copy(init.begin(), init.end(), reinterpret_cast&lt;Type*&gt;(storage))</code> is wrong. construct should be called in loop instead."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1510153688, "post_id": 47182119, "comment_id": 81315102, "body": "I think it is ok in regard to strict aliasing. To be sure to not break strict aliasing, you may store in additional member <code>Type* data</code> the result of your first placement new. (so <code>data == storage</code> but with correct type)."}, {"owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1510195309, "post_id": 47182119, "comment_id": 81335255, "body": "@user2079303 Both <code>char* storage</code> and a pointer returned by <code>data()</code> point to the same region of memory. Moreover, subscript operator will do something like <code>return *reinterpret_cast&lt;Type*&gt;(storage + offset)</code>, i.e. dereference a pointer of incompatible type, which is UB."}, {"owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1510196208, "post_id": 47182119, "comment_id": 81335487, "body": "@Jarod42 Wouldn&#39;t dereferencing <code>data</code> lead to UB, as it points to the same memory as <code>char</code> pointer?"}, {"owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "reply_to_user": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 0, "creation_date": 1510197372, "post_id": 47182119, "comment_id": 81335747, "body": "@king_nak Ok, I removed malformed constructor not to divert reader&#39;s attention from the problem and added a more relevant example."}], "answers": [{"comments": [{"owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "edited": false, "score": 0, "creation_date": 1510227088, "post_id": 47199237, "comment_id": 81349790, "body": "Thanks for clarification! Also I removed subscript and fixed destructor to use sfinae which performs optimized deallocation only if <code>Type</code> is trivially destructible."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 1, "last_activity_date": 1510223676, "last_edit_date": 1510223676, "creation_date": 1510222713, "answer_id": 47199237, "question_id": 47182119, "link": "https://stackoverflow.com/questions/47182119/array-like-container-implementation-vs-strict-aliasing/47199237#47199237", "title": "Array-like container implementation vs strict aliasing", "body": "<blockquote>\n  <p>but dereferencing a pointer returned by data seems to violate strict aliasing rules</p>\n</blockquote>\n\n<p>I disagree.</p>\n\n<blockquote>\n  <p>Both <code>char* storage</code> and a pointer returned by <code>data()</code> point to the same region of memory.</p>\n</blockquote>\n\n<p>This is irrelevant. Multiple pointers pointing to same object doesn't violate aliasing rules.</p>\n\n<blockquote>\n  <p>Moreover, subscript operator will ... dereference a pointer of incompatible type, which is UB.</p>\n</blockquote>\n\n<p>But the object isn't of incompatible type. In <code>emplace_back</code>, you use placement new to construct objects of <code>Type</code> into the memory. Assuming no code path can avoid this placement new and therefore assuming that the subscript operator returns a pointer which points at one of these objects, then dereferencing the pointer of <code>Type*</code> is well defined, because it points to an object of <code>Type</code>, which is compatible.</p>\n\n<p>This is what is relevant for pointer aliasing: The type of the object in memory, and the type of the pointer that is dereferenced. Any intermediate pointer that the dereferenced pointer was converted from is irrelevant to aliasing.</p>\n\n<hr>\n\n<p>Note that your destructor does not call the detructor of objects constructed within <code>storage</code>, so if <code>Type</code> isn't trivially destructable, then the behaviour is undefined.</p>\n\n<hr>\n\n<blockquote>\n<pre><code>Type* ptr = reinterpret_cast&lt;Type*&gt;(storage + idx * sizeof(ptr));\n</code></pre>\n</blockquote>\n\n<p>The <code>sizeof</code> is wrong. What you need is <code>sizeof(Type)</code>, or <code>sizeof *ptr</code>. Or more simply</p>\n\n<pre><code>auto ptr = reinterpret_cast&lt;Type*&gt;(storage) + idx;\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Sometimes I see code with two static casts through <code>void*</code> instead of one reinterpret cast: How is it better than reinterpret cast?</p>\n</blockquote>\n\n<p>I can't think of any situation where the behaviour would be different.</p>\n"}], "owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 47199237, "answer_count": 1, "score": 0, "last_activity_date": 1510223676, "creation_date": 1510150830, "last_edit_date": 1510197782, "question_id": 47182119, "link": "https://stackoverflow.com/questions/47182119/array-like-container-implementation-vs-strict-aliasing", "title": "Array-like container implementation vs strict aliasing", "body": "<p>I'm trying to implement an array-like container with some special requirements and a subset of <code>std::vector</code> interface. Here is a code excerpt:</p>\n\n<pre><code>template&lt;typename Type&gt;\nclass MyArray\n{\npublic:\n    explicit MyArray(const uint32_t size) : storage(new char[size * sizeof(Type)]), maxElements(size) {}\n    MyArray(const MyArray&amp;) = delete;\n    MyArray&amp; operator=(const MyArray&amp;) = delete;\n    MyArray(MyArray&amp;&amp; op) { /* some code */ }\n    MyArray&amp; operator=(MyArray&amp;&amp; op) { /* some code */ }\n    ~MyArray() { if (storage != nullptr) delete[] storage; /* No explicit destructors. Let it go. */  }\n\n    Type* data() { return reinterpret_cast&lt;Type*&gt;(storage); }\n    const Type* data() const { return reinterpret_cast&lt;const Type*&gt;(storage); }\n\n    template&lt;typename... Args&gt;\n    void emplace_back(Args&amp;&amp;... args)\n    {\n        assert(current &lt; maxElements);\n        new (storage + current * sizeof(Type)) Type(std::forward&lt;Args&gt;(args)...);\n        ++current;\n    }\n\nprivate:\n    char* storage = nullptr;\n    uint32_t maxElements = 0;\n    uint32_t current = 0;\n};\n</code></pre>\n\n<p>It works perfectly well on my system, but dereferencing a pointer returned by <code>data</code> seems to violate <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing</a> rules. It's also a case for naive implementation of subscript operator, iterators, etc.</p>\n\n<p>So what is a proper way to implement containers backed by arrays of char without breaking strict aliasing rules? As far as I understand, using <a href=\"http://en.cppreference.com/w/cpp/types/aligned_storage\" rel=\"nofollow noreferrer\"><code>std::aligned_storage</code></a> will only provide a proper alignment, but will not save the code from being broken by compiler optimizations which rely on strict aliasing. Also, I don't want to use  <code>-fno-strict-aliasing</code> and similar flags due to performance considerations.</p>\n\n<p>For example, consider subscript operator (nonconstant for brevity), which is a classical code snippet from articles about UB in C++:</p>\n\n<pre><code>Type&amp; operator[](const uint32_t idx)\n{\n    Type* ptr = reinterpret_cast&lt;Type*&gt;(storage + idx * sizeof(ptr)); // Cast is OK.\n    return *ptr; // Dereference is UB.\n}\n</code></pre>\n\n<p>What is a proper way to implement it without any risk to find my program broken? How is it implemented is standard containers? Is there any cheating with non-documented compiler intrinsics in all compilers?</p>\n\n<p>Sometimes I see code with two static casts through <code>void*</code> instead of one reinterpret cast:</p>\n\n<pre><code>Type* ptr = static_cast&lt;Type*&gt;(static_cast&lt;void*&gt;(storage + idx * sizeof(ptr)));\n</code></pre>\n\n<p>How is it better than reinterpret cast? As to me, it does not solve any problems, but looks overcomplicated.</p>\n"}, {"tags": ["python", "c++", "boost", "boost-thread"], "owner": {"reputation": 11, "user_id": 6016794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec1399d26ec2373643e546a5c7fd070?s=128&d=identicon&r=PG&f=1", "display_name": "SecondBear", "link": "https://stackoverflow.com/users/6016794/secondbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510150814, "creation_date": 1510150814, "question_id": 47182113, "link": "https://stackoverflow.com/questions/47182113/undefined-symbol-zn5boost21recursive-timed-mutexc1ev-when-importing-so-file-i", "title": "undefined symbol: _ZN5boost21recursive_timed_mutexC1Ev when importing .so file in python", "body": "<p>I have problem including a shared object file in my python script, running ubuntu 16.04. The files to this script are supplied to me and I have no possibility to recompile them. It is a file using old boost libraries (1.34.1) thread and serialization. The error I get is:\n<code>ImportError: ./libsubs_reg.so: undefined symbol: _ZN5boost21recursive_timed_mutexC1Ev</code></p>\n\n<p>Checking dependent libraries for libsus_reg:</p>\n\n<pre><code># readelf -d libsubs_reg.so\nDynamic section at offset 0x27118 contains 28 entries:\n  Tag        Type                         Name/Value\n 0x00000001 (NEEDED)                     Shared library: [libboost_serialization-gcc42-mt-1_34_1.so.1.34.1]\n 0x00000001 (NEEDED)                     Shared library: [libboost_thread-gcc42-mt-1_34_1.so.1.34.1]\n 0x00000001 (NEEDED)                     Shared library: [libstdc++.so.6]\n 0x00000001 (NEEDED)                     Shared library: [libm.so.6]\n 0x00000001 (NEEDED)                     Shared library: [libgcc_s.so.1]\n 0x00000001 (NEEDED)                     Shared library: [libc.so.6]\n</code></pre>\n\n<p>I have created links from the 1.34.1 boost versions to the currently installed, 1.58.0.</p>\n\n<pre><code># ldd libsub_reg.so\n linux-gate.so.1 =&gt;  (0xb7762000)\n    libboost_serialization-gcc42-mt-1_34_1.so.1.34.1 =&gt; /usr/lib/i386-linux-gnu/libboost_serialization-gcc42-mt-1_34_1.so.1.34.1 (0xb76ba000)\n    libboost_thread-gcc42-mt-1_34_1.so.1.34.1 =&gt; /usr/lib/i386-linux-gnu/libboost_thread-gcc42-mt-1_34_1.so.1.34.1 (0xb7695000)\n    libstdc++.so.6 =&gt; /usr/lib/i386-linux-gnu/libstdc++.so.6 (0xb751d000)\n    libm.so.6 =&gt; /lib/i386-linux-gnu/libm.so.6 (0xb74c8000)\n    libgcc_s.so.1 =&gt; /lib/i386-linux-gnu/libgcc_s.so.1 (0xb74ab000)\n    libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb72f5000)\n    libpthread.so.0 =&gt; /lib/i386-linux-gnu/libpthread.so.0 (0xb72d8000)\n    libboost_system.so.1.58.0 =&gt; /usr/lib/i386-linux-gnu/libboost_system.so.1.58.0 (0xb72d2000)\n    librt.so.1 =&gt; /lib/i386-linux-gnu/librt.so.1 (0xb72c9000)\n    /lib/ld-linux.so.2 (0x80027000)\n</code></pre>\n\n<p>Checking the links...</p>\n\n<pre><code># ls -la libboost* | grep \"\\-&gt;\"\nlrwxrwxrwx 1 root root      24 jun 14  2016 libboost_regex.so -&gt; libboost_regex.so.1.58.0\nlrwxrwxrwx 1 root root      32 nov  8 14:53 libboost_serialization-gcc42-mt-1_34_1.so.1.34.1 -&gt; libboost_serialization.so.1.58.0\nlrwxrwxrwx 1 root root      32 jun 14  2016 libboost_serialization.so -&gt; libboost_serialization.so.1.58.0\nlrwxrwxrwx 1 root root      26 jun 14  2016 libboost_signals.so -&gt; libboost_signals.so.1.58.0\nlrwxrwxrwx 1 root root      25 jun 14  2016 libboost_system.so -&gt; libboost_system.so.1.58.0\nlrwxrwxrwx 1 root root      25 nov  8 14:54 libboost_thread-gcc42-mt-1_34_1.so.1.34.1 -&gt; libboost_thread.so.1.58.0\nlrwxrwxrwx 1 root root      25 jun 14  2016 libboost_thread.so -&gt; libboost_thread.so.1.58.0\n</code></pre>\n\n<p>Checking other similar questions, if I have understood correctly, the \u201cundefined symbol\u201d would mean that the boost lib (thread) containing recursive_timed_mutex cannot be found, but I do not see what I did wrong with the links. I can admit that I am way out of my depth on this one, but I really need to get it to work. Any help would be kindly appreciated. </p>\n"}]