[{"tags": ["c++"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542239715, "post_id": 53310463, "comment_id": 93501822, "body": "More useful than the javascript source would be a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that includes a small sample file that triggers the error This is one exceedingly rare time where I would link to the input file rather than embedding it into the post. Binary data and HTML don&#39;t mix well."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1542239934, "post_id": 53310463, "comment_id": 93501893, "body": "Note that the &quot;2nd and 3rd most significant bits&quot; of that value are the 8th and 9th bits, i.e., the low bits of the upper byte. Those low bits are the only place where the value can be off by 256 from what you expect."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 7392093, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208421632279808/picture?type=large", "display_name": "Cyrus Farsoudi", "link": "https://stackoverflow.com/users/7392093/cyrus-farsoudi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542335464, "creation_date": 1542335464, "answer_id": 53330610, "question_id": 53310463, "link": "https://stackoverflow.com/questions/53310463/integers-are-sometimes-off-by-positive-or-negative-256-when-reading-bytes-from-a/53330610#53330610", "title": "Integers are sometimes off by positive or negative 256 when reading bytes from a binary file in C++", "body": "<p>I found out what my issue was. I was reading a byte too far, and also failing to byte swap. The extra byte of seek causes it to grab the low byte of the correct integer, and the high byte of the integer after it. Since the integers doesn't change much between points, the high bytes of adjacent points are usually identical, so it usually works, but when the integer passes a multiple of 256, the high byte changes, and that byte is off by 1, which means the number is off by 256.</p>\n"}], "owner": {"reputation": 57, "user_id": 7392093, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208421632279808/picture?type=large", "display_name": "Cyrus Farsoudi", "link": "https://stackoverflow.com/users/7392093/cyrus-farsoudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542335464, "creation_date": 1542239269, "question_id": 53310463, "link": "https://stackoverflow.com/questions/53310463/integers-are-sometimes-off-by-positive-or-negative-256-when-reading-bytes-from-a", "title": "Integers are sometimes off by positive or negative 256 when reading bytes from a binary file in C++", "body": "<p>I have a data set that's in binary, and I'm trying to extract 16-bit integers by reading in 2 bytes at a time. I'm trying to copy an implementation that I already have in JavaScript, which means that I have the correct output to test against. For some odd reason, 8 out of 120 integers read in are off by exactly 256 in either direction. At first I thought the I was misreading a single bit, but after looking at the numbers in binary, some are off by more than one bit. For example, one of the integers read in was 1297 (11000010001), when it should have been 1553 (10100010001), where the 2nd and 3rd most significant bit differ. Does anyone see where I'm going wrong? I can post the correct JavaScript code if that helps.</p>\n\n<pre><code>ifstream inputFile (inp, ios::binary);\nint test = 0;\nint fileHeaderOffset = 80+648+2700;\nint x = 840;\nint y = 359;\nint columnBytes = 2414;\nint width = 120;\nint height = 121;\n\nint16_t buff[height * 2];\nint offset = fileHeaderOffset + (x * columnBytes) + (y * 2) + 8;\ninputFile.seekg(offset+1);\nfor(int j = 0; j &lt; height * 2; j++){\n   inputFile.read((char*)&amp;buff[test], 2);\n   test++;\n}\n</code></pre>\n"}, {"tags": ["c++", "oop"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542239992, "post_id": 53310461, "comment_id": 93501914, "body": "Recommend adding full error message text."}, {"owner": {"reputation": 1, "user_id": 9745882, "user_type": "registered", "profile_image": "https://graph.facebook.com/1878526048870556/picture?type=large", "display_name": "Suayb Yurdakul", "link": "https://stackoverflow.com/users/9745882/suayb-yurdakul"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542239996, "post_id": 53310461, "comment_id": 93501915, "body": "That sounds exactly like something I need to do. Thanks for the suggestion I&#39;m going to try that! I&#39;m new to OOP in C++ so I need to look up on how to implement that."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 0, "creation_date": 1542240548, "post_id": 53310461, "comment_id": 93502060, "body": "@SuaybYurdakul I think the suggestion was to add the text of the compiler error <i>to your question</i>. Error messages help a lot more than descriptions of error messages in diagnosing a problem."}, {"owner": {"reputation": 1, "user_id": 9745882, "user_type": "registered", "profile_image": "https://graph.facebook.com/1878526048870556/picture?type=large", "display_name": "Suayb Yurdakul", "link": "https://stackoverflow.com/users/9745882/suayb-yurdakul"}, "reply_to_user": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "edited": false, "score": 0, "creation_date": 1542240842, "post_id": 53310461, "comment_id": 93502122, "body": "@Caleb unfortunately my compiler spurts out its error messages in german. I&#39;m not sure if those would be helpful. But I&#39;ll definitely do that in the future, thanks for the tip!"}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1542240275, "post_id": 53310586, "comment_id": 93501989, "body": "I removed that because I wasn&#39;t sure what was attempting to be done. But yeah need to make it a reference to actually modify the passed in object."}, {"owner": {"reputation": 3275, "user_id": 6204612, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wDnGs.png?s=128&g=1", "display_name": "Adam Kotwasinski", "link": "https://stackoverflow.com/users/6204612/adam-kotwasinski"}, "edited": false, "score": 0, "creation_date": 1542240399, "post_id": 53310586, "comment_id": 93502027, "body": "As a side note - there&#39;s also <code>#pragma once</code> - <a href=\"https://stackoverflow.com/questions/1143936/pragma-once-vs-include-guards\" title=\"pragma once vs include guards\">stackoverflow.com/questions/1143936/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9745882, "user_type": "registered", "profile_image": "https://graph.facebook.com/1878526048870556/picture?type=large", "display_name": "Suayb Yurdakul", "link": "https://stackoverflow.com/users/9745882/suayb-yurdakul"}, "reply_to_user": {"reputation": 3275, "user_id": 6204612, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wDnGs.png?s=128&g=1", "display_name": "Adam Kotwasinski", "link": "https://stackoverflow.com/users/6204612/adam-kotwasinski"}, "edited": false, "score": 0, "creation_date": 1542241004, "post_id": 53310586, "comment_id": 93502167, "body": "@AdamKotwasinski I&#39;ve done that instead. Ironically VS included the line #pragma when I created the header file initially, but I didn&#39;t think much of it since I don&#39;t know anything about preprocessor directives just yet."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 1, "last_activity_date": 1542240138, "creation_date": 1542240138, "answer_id": 53310586, "question_id": 53310461, "link": "https://stackoverflow.com/questions/53310461/c-object-declaration-needs-another-object-as-parameter/53310586#53310586", "title": "C++ Object declaration needs another object as parameter", "body": "<p>Add include guards to your header files so its contents doesn't get included more than once:</p>\n\n<p><code>FrozenMeal.h</code>:</p>\n\n<pre><code>#ifndef FROZENMEAL_H_INCLUDED\n#define FROZENMEAL_H_INCLUDED\n\n// your code ...\n\n#endif /* FROZENMEAL_H_INCLUDED */\n</code></pre>\n\n<p><code>Microwave.h</code>:</p>\n\n<pre><code>#ifndef MICROWAVE_H_INCLUDED\n#define MICROWAVE_H_INCLUDED\n\n// your code ...\n\n#endif /* MICROWAVE_H_INCLUDED */\n</code></pre>\n\n<p>Also, you never initialize <code>int Microwave::power</code> and <code>double Microwave::period</code> so you will read and write garbage values in <code>Microwave::morePower()</code> and <code>Microwave::lessPower()</code></p>\n\n<p>As suggested in the comments, you want to take the parameter of <code>Microwave::heatMeal()</code> by reference so the function can modify the passed object:</p>\n\n<pre><code>void Microwave::heatMeal(FrozenMeal &amp;mealInst)\n//                                  ^\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9745882, "user_type": "registered", "profile_image": "https://graph.facebook.com/1878526048870556/picture?type=large", "display_name": "Suayb Yurdakul", "link": "https://stackoverflow.com/users/9745882/suayb-yurdakul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 53310586, "answer_count": 1, "score": -1, "last_activity_date": 1542240138, "creation_date": 1542239257, "question_id": 53310461, "link": "https://stackoverflow.com/questions/53310461/c-object-declaration-needs-another-object-as-parameter", "title": "C++ Object declaration needs another object as parameter", "body": "<p>Object-oriented C++ here.</p>\n\n<p>I'm supposed to code a <strong>Microwave</strong> object that \"heats\" a <strong>FrozenMeal</strong> object.\nOne method of the <strong>Microwave</strong> object, called <strong>void heatMeal(FrozenMeal)</strong>, is supposed to take an instance of a <strong>FrozenMeal</strong> object as a parameter and increase its temperature.</p>\n\n<p><em>FrozenMeal.h</em></p>\n\n<pre><code>#include &lt;string&gt;\n\nclass FrozenMeal {\npublic:\n    FrozenMeal(std::string, int);\n\n    void setTemperature(double);\n    std::string getName() const;\n    int getVolume() const;\n    double getCoeffizient() const;\n    double getTemperature() const;\n\nprivate:\n    std::string name;\n    int volume;\n    double temperature;\n    double coeffizient;\n};\n</code></pre>\n\n<p><em>FrozenMeal.cpp</em></p>\n\n<pre><code>#include &lt;string&gt;\n#include \"FrozenMeal.h\"\nusing namespace std;\n\nFrozenMeal::FrozenMeal(string mealName, int mealVolu) {\n    name = mealName;\n    volume = mealVolu;\n    temperature = -18;\n    coeffizient = 0.24;\n}\n\nvoid FrozenMeal::setTemperature(double mealTemp) { temperature = mealTemp; }\n\nstring FrozenMeal::getName() const { return name; }\n\nint FrozenMeal::getVolume() const { return volume; }\n\ndouble FrozenMeal::getCoeffizient() const { return coeffizient; }\n\ndouble FrozenMeal::getTemperature() const { return temperature; }\n</code></pre>\n\n<p><em>Microwave.h</em></p>\n\n<pre><code>#include \"FrozenMeal.h\"\n\nclass Microwave {\npublic:\n    Microwave();\n\n    void morePower();\n    void lessPower();\n    void setPeriod(double);\n    void heatMeal(FrozenMeal); // &lt;----------------------------\n    int getPower() const;\n    double getPeriod() const;\n\nprivate:\n    int power;\n    double period;\n};\n</code></pre>\n\n<p>Microwave.cpp</p>\n\n<pre><code>#include \"Microwave.h\"\nusing namespace std;\n\nMicrowave::Microwave() {}\n\nvoid Microwave::morePower() { if (power &lt; 1000) power += 200; }\n\nvoid Microwave::lessPower() { if (power &gt; 200) power -= 200; }\n\nvoid Microwave::setPeriod(double sessionPeri) { period = sessionPeri; }\n\nvoid Microwave::heatMeal(FrozenMeal mealInst) {\n    mealInst.setTemperature(80); //example\n}\n\nint Microwave::getPower() const { return power; }\n\ndouble Microwave::getPeriod() const { return period; }\n</code></pre>\n\n<p>Now, my problem is that my compiler says that the file <strong>FrozenMeal.h</strong> apparently redefines the object type of <strong>FrozenMeal</strong>, even though that should be the job of the <strong>FrozenMeal.cpp</strong> file, and compiling is unsuccessful.</p>\n\n<p>I tried including <strong>FrozenMeal.h</strong> to <strong>Microwave.cpp</strong> but that resulted in even more compiler errors.</p>\n\n<p>I feel like I'm doing something horribly wrong here.</p>\n"}, {"tags": ["c++", "sorting", "stl", "introsort"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1542238958, "post_id": 53310395, "comment_id": 93501619, "body": "Introsort bails out on quicksort if it&#39;s taking too long and switches to heapsort. Note the usage of <code>maxdepth</code> at <code>else if maxdepth = 0:         heapsort(A)</code>. If too deep, finish off with heapsort."}], "answers": [{"tags": [], "owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1542242909, "last_edit_date": 1542242909, "creation_date": 1542241826, "answer_id": 53310796, "question_id": 53310395, "link": "https://stackoverflow.com/questions/53310395/stl-stdsort-uses-introsort-but-how-does-it-work/53310796#53310796", "title": "STL std::sort() uses Introsort, but how does it work?", "body": "<p>Re your question on <code>\u230alog(length(A))\u230b \u00d7 2</code>, the <code>\u230a...\u230b</code> bit simply means <code>floor</code>, the highest integer less than or equal to the value.</p>\n\n<p>In a less <em>mathematical</em> language, it would be <code>int(log(length(A))) * 2</code>.</p>\n\n<hr>\n\n<p>And just in case someone brings up the difference between <code>floor</code> (round toward <code>-\u221e</code>) and <code>int</code> (round toward <code>0</code>), it's irrelevant here as the length must be a non-negative integer. You'll still run into mathematical trouble if the length is zero but that's an exceptional case since it probably doesn't need sorting :-)</p>\n\n<hr>\n\n<p>As to <em>why</em> <code>maxdepth</code> exists, this is obviously an algorithm based on trees - the use of <code>log</code> also supports this since the depth of a balanced tree tends to be proportional to the logarithm of the number of nodes in it.</p>\n\n<p>What seems to be happening is that, if the introsort gets beyond a certain depth, it just switches over to heapsort for the remainder.</p>\n\n<hr>\n\n<p>And, just one minor note: <code>std::sort()</code> is <em>not</em> required to use Introsort (as your title seems to imply), the standard mandates behaviour such as <code>at most Nlog<sub>2</sub>N comparisons, where N=last-first</code> but otherwise makes no demands on algorithm choice.</p>\n"}], "owner": {"reputation": 658, "user_id": 6134218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0812f0ddf53a19ff6930587eeb084c0?s=128&d=identicon&r=PG&f=1", "display_name": "Shalomi90", "link": "https://stackoverflow.com/users/6134218/shalomi90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 53310796, "answer_count": 1, "score": 0, "last_activity_date": 1542242909, "creation_date": 1542238793, "question_id": 53310395, "link": "https://stackoverflow.com/questions/53310395/stl-stdsort-uses-introsort-but-how-does-it-work", "title": "STL std::sort() uses Introsort, but how does it work?", "body": "<p>I don't really get the Introsort algorithm. As you can see I added the pseudocode of it. \nWhat is meant by the maxdepth? </p>\n\n<p>What does that mean \" <code>\u230alog(length(A))\u230b \u00d7 2</code>\" </p>\n\n<p>I hope someone can explain it to me. </p>\n\n<pre><code> procedure sort(A : array):\n        let maxdepth = \u230alog(length(A))\u230b \u00d7 2\n        introsort(A, maxdepth)\n\nprocedure introsort(A, maxdepth):\n    n \u2190 length(A)\n    p \u2190 partition(A)  // assume this function does pivot selection, p is the final position of the pivot\n    if n \u2264 1:\n        return  // base case\n    else if maxdepth = 0:\n        heapsort(A)\n    else:\n        introsort(A[0:p], maxdepth - 1)\n        introsort(A[p+1:n], maxdepth - 1)\n</code></pre>\n"}, {"tags": ["c++", "gcc", "clang", "glfw"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1542239112, "post_id": 53310386, "comment_id": 93501668, "body": "Check that the path containing <code>GLFW&#47;glfw3.h</code> actually contains it, that it is accessible, and that it is provided as include search path to the compiler (<code>-I</code> switch)."}, {"owner": {"reputation": 1, "user_id": 10643311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VQYV0K5II6I/AAAAAAAAAAI/AAAAAAAAB-A/bVeuK8a1hGk/photo.jpg?sz=128", "display_name": "Jesse Sparks", "link": "https://stackoverflow.com/users/10643311/jesse-sparks"}, "edited": false, "score": 0, "creation_date": 1542239389, "post_id": 53310386, "comment_id": 93501737, "body": "I added a picture that hopefully can answer those questions because I am not sure"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1542239493, "post_id": 53310386, "comment_id": 93501770, "body": "So the file is present and presumably accessible. But have you added <code>-I &#47;home&#47;jesse&#47;Documents&#47;glfw-3.2.1&#47;include</code> to the compiler command line?"}, {"owner": {"reputation": 1, "user_id": 10643311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VQYV0K5II6I/AAAAAAAAAAI/AAAAAAAAB-A/bVeuK8a1hGk/photo.jpg?sz=128", "display_name": "Jesse Sparks", "link": "https://stackoverflow.com/users/10643311/jesse-sparks"}, "edited": false, "score": 0, "creation_date": 1542239602, "post_id": 53310386, "comment_id": 93501799, "body": "No, I don&#39;t know how to do that. Atom isn&#39;t an IDE so i installed a package that compiles it for me so there isn&#39;t a lot of settings"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1542239688, "post_id": 53310386, "comment_id": 93501813, "body": "I don&#39;t know about that, but most likely there is a text field in the configuration/setting called <code>compiler command line</code> or <code>compiler options</code> or something like this, where the option can be added."}, {"owner": {"reputation": 1, "user_id": 10643311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VQYV0K5II6I/AAAAAAAAAAI/AAAAAAAAB-A/bVeuK8a1hGk/photo.jpg?sz=128", "display_name": "Jesse Sparks", "link": "https://stackoverflow.com/users/10643311/jesse-sparks"}, "edited": false, "score": 0, "creation_date": 1542239863, "post_id": 53310386, "comment_id": 93501872, "body": "I think I just added that but now I have a new error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1542239964, "post_id": 53310386, "comment_id": 93501901, "body": "Yes, your code has multiple errors and in addition to the include search path you will also need to provide a library search path for GLFW (<code>-L</code> option). Errors in code are for example missing <code>#include &lt;iostream&gt;</code> (while the <code>stdlib.h</code> and <code>stdio.h</code> are unneeded), <code>cout</code> should be <code>std::cout</code>, etc. You should start with a simple course about the base language before you try using more complex stuff like graphics libraries."}, {"owner": {"reputation": 1, "user_id": 10643311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VQYV0K5II6I/AAAAAAAAAAI/AAAAAAAAB-A/bVeuK8a1hGk/photo.jpg?sz=128", "display_name": "Jesse Sparks", "link": "https://stackoverflow.com/users/10643311/jesse-sparks"}, "edited": false, "score": 0, "creation_date": 1542240222, "post_id": 53310386, "comment_id": 93501975, "body": "Ok thank you I added the library path and i&#39;m going to learn more c++ to hopefully understand better."}], "owner": {"reputation": 1, "user_id": 10643311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VQYV0K5II6I/AAAAAAAAAAI/AAAAAAAAB-A/bVeuK8a1hGk/photo.jpg?sz=128", "display_name": "Jesse Sparks", "link": "https://stackoverflow.com/users/10643311/jesse-sparks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542239847, "creation_date": 1542238735, "last_edit_date": 1542239847, "question_id": 53310386, "link": "https://stackoverflow.com/questions/53310386/glfw-wont-compile-on-atom-i-have-gcc-and-clang-installed", "title": "GLFW won&#39;t compile on Atom. I have GCC and clang installed", "body": "<p>I have GLFW installed in my documents and I have GL installed there as well, however, GL works and GLFW doesn't <a href=\"https://i.stack.imgur.com/1cIef.png\" rel=\"nofollow noreferrer\">Shown here</a><br>\nGLFW path <a href=\"https://i.stack.imgur.com/fsUoy.png\" rel=\"nofollow noreferrer\">here</a> \nnew error <a href=\"https://i.stack.imgur.com/Q0AvR.png\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;GL/glew.h&gt;\n#include &lt;GLFW/glfw3.h&gt;\n\nint main() {\n  if(glfwInit()==false)\n    cout&lt;&lt;\"FAILED\";\n}\n</code></pre>\n"}, {"tags": ["c++", "windows", "winapi"], "comments": [{"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542238723, "post_id": 53310374, "comment_id": 93501557, "body": "MS sure doesn&#39;t maintain its winapi C++ documentation like it used to."}, {"owner": {"reputation": 51, "user_id": 6335250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd78bc6eb7351b13f78e51fb23630840?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/6335250/adam"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542239016, "post_id": 53310374, "comment_id": 93501639, "body": "@Christopher Was it good before?"}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542239375, "post_id": 53310374, "comment_id": 93501733, "body": "It was &#39;better&#39; from 1998-2003. At least the links worked."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542247086, "post_id": 53310374, "comment_id": 93503549, "body": "MSDN have been migrating its documentation from <code>msdn.microsoft.com</code> to a new format on <code>docs.microsoft.com</code> for some time now, and a lot of things are falling through the cracks (broken links, incomplete text, etc). It is horrible. IMHO, there was nothing wrong with the old documentation, they should have just left it alone."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542274039, "post_id": 53310374, "comment_id": 93512505, "body": "@rem: While I agree that the current state of the documentation is a pretty significant regression, there <i>is</i> actually a reason for moving it. Once complete, we will finally have a way to submit and <i>publicly track</i> documentation defects."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542301200, "post_id": 53310374, "comment_id": 93529302, "body": "@IInspectable Yes, and that system works (for topics that have been migrated).  Something I flagged a wile back turned up on Github."}], "answers": [{"comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542239420, "post_id": 53310432, "comment_id": 93501750, "body": "Except that doesn&#39;t work...  I think <code>ss.fHideIcons</code> has a different meaning to what the OP is hoping for"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542239543, "post_id": 53310432, "comment_id": 93501780, "body": "@PaulSanders Well hopefully you&#39;re doing <code>ss.fHideIcons = TRUE</code> <i>after</i>  zeroing the memory, otherwise it&#39;s work undone."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542240568, "post_id": 53310432, "comment_id": 93502065, "body": "@PaulSanders Well... yeah, I just tested here and, my icons blink but that&#39;s about it. Funny thing they only blink when you actually change the setting to a value different to what it was before, regardless if I&#39;m trying to hide or show the icons. It won&#39;t show icons either if I manually hide them on the Windows Explorer context menu. I don&#39;t know, maybe it&#39;s a Windows 10 bug? What Windows version are you using?"}, {"owner": {"reputation": 51, "user_id": 6335250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd78bc6eb7351b13f78e51fb23630840?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/6335250/adam"}, "edited": false, "score": 0, "creation_date": 1542240766, "post_id": 53310432, "comment_id": 93502107, "body": "I tried this and unfortunately, it doesn&#39;t work. @peter&#39;s answer worked though."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1542240772, "post_id": 53310432, "comment_id": 93502108, "body": "There are other ways of hiding desktop icons though, by hiding objects within the Windows Explorer&#39;s Window Object. You can actually customize a lot of things doing this, without actually changing any setting or modifying any file which is pretty cool too."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542240992, "post_id": 53310432, "comment_id": 93502164, "body": "@Havenard I am using Windows 10.  Having run a few tests, <code>ss.fHideIcons</code> has no discernable effect.  Maybe it used to but not now.  I have posted some code that I dug up from elsehere on SO that works and seems pretty clean."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542241184, "post_id": 53310432, "comment_id": 93502208, "body": "@PaulSanders Yeah that method is pretty old school, I&#39;m surprised it still works."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 1, "creation_date": 1542241225, "post_id": 53310432, "comment_id": 93502223, "body": "@Havenard Oh well, you know MS: backwards compatibility is king."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542248834, "post_id": 53310432, "comment_id": 93503903, "body": "@Havenard Tried this on Windows 7. The <code>fHideIcons</code> value is preserved across multiple calls, as expected, but there is simply no visual effect on the display of the desktop icons. What is odd is that when right-clicking on the Desktop, the  <code>View &gt; Show desktop icons</code> menu item IS being toggled in accordance with <code>fHideIcons</code> (the menu item itself works fine, it actually toggles the display of icons when clicked).  So the issue is <code>SHGetSetSettings()</code> is apparantly not doing everything the menu item does."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542249468, "post_id": 53310432, "comment_id": 93504068, "body": "@RemyLebeau True, it does change the setting, but it doesn&#39;t take effect immediately. I guess it&#39;s a bug after all. Verified on Windows 10."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542250031, "post_id": 53310432, "comment_id": 93504188, "body": "@Havenard Searching online, I see this is a very well-known issue going back several years. Seems <code>fHideIcons</code> merely toggles the <code>HideIcons</code> value in the <code>HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Adva&zwnj;&#8203;nced</code> Registry key (verified on my Win7), nothing more. Hiding the <code>Progman</code> window is the most common workaround (though it has a side effect that you can no longer right-click on the desktop)."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542275066, "post_id": 53310432, "comment_id": 93513186, "body": "<i>&quot;I&#39;m surprised it still works&quot;</i> - It doesn&#39;t, and the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetsetsettings\" rel=\"nofollow noreferrer\">documentation</a> says as much: <i>&quot;<code>SHGetSetSettings</code> is available for use in the operating systems specified in the Requirements section. <b>It may be altered or unavailable in subsequent versions.</b>&quot;</i> This API is supported in Windows XP/Server 2003 only."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542296375, "post_id": 53310432, "comment_id": 93526277, "body": "@IInspectable I meant the <code>FindWindow</code> method. And no, the API is verified to be supported in Windows 7 and Windows 10 too."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542297599, "post_id": 53310432, "comment_id": 93527073, "body": "You cannot verify whether any given API is supported. That&#39;s something you can only determine by looking at the documentation."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542299532, "post_id": 53310432, "comment_id": 93528325, "body": "@IInspectable The API exists in the system and you could say it does what it says it does, it just takes a reload of the Windows Explorer to take effect. In addition the docs say the <i>minimum</i> supported system is Windows XP/2003, and that it is supported in User32.dll 5.0 <b>and later</b> (5.0 was the one at Windows XP/2003). There is no mention about it being discontinued."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542315356, "post_id": 53310432, "comment_id": 93535878, "body": "In other words: The API doesn&#39;t do what the contract promises. That&#39;s what an unsupported API is. The documentation reads <i>&quot;Minimum supported client/server&quot;</i>, because there&#39;s only a single template for the entire documentation."}], "tags": [], "owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "is_accepted": false, "score": 2, "last_activity_date": 1542412882, "last_edit_date": 1542412882, "creation_date": 1542239078, "answer_id": 53310432, "question_id": 53310374, "link": "https://stackoverflow.com/questions/53310374/how-to-hide-desktop-icons-with-windows-api-in-c/53310432#53310432", "title": "How to hide Desktop icons with Windows API in C++?", "body": "<p>The third parameter isn't about changing the setting, it's to select the <code>SHGetSetSettings()</code> behavior.</p>\n\n<p><code>FALSE</code> will get the value of the current setting and store it in <code>ss</code>, <code>TRUE</code> will set the value of the setting to what is in <code>ss</code>.</p>\n\n<p>So basically you have to do <code>ss.fHideIcons = TRUE</code> and then call <code>SHGetSetSettings(&amp;ss, SSF_HIDEICONS, TRUE)</code> to set it.</p>\n\n<p>I know, it's weird, but on the other hand it allows you to change multiple settings simultaneously because <code>SSF_*</code> is a bitmask.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6335250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd78bc6eb7351b13f78e51fb23630840?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/6335250/adam"}, "edited": false, "score": 0, "creation_date": 1542240722, "post_id": 53310589, "comment_id": 93502094, "body": "@peter Thanks! Yeah I found that link, but I couldn&#39;t figure out how to make it work in C++. Can you possibly explain how this works? I don&#39;t understand it."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 51, "user_id": 6335250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd78bc6eb7351b13f78e51fb23630840?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/6335250/adam"}, "edited": false, "score": 0, "creation_date": 1542240829, "post_id": 53310589, "comment_id": 93502119, "body": "@Adam Yeah that&#39;s precisely the method I was talking about, I was just unsure if it worked across different versions of Windows. Geez I remember doing this on Windows 98..."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 51, "user_id": 6335250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd78bc6eb7351b13f78e51fb23630840?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/6335250/adam"}, "edited": false, "score": 0, "creation_date": 1542241085, "post_id": 53310589, "comment_id": 93502183, "body": "@adam As the post I linked to explains, it hides the parent window that hosts all the desktop icons.  Hopefully, MS won&#39;t break this."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1542273725, "post_id": 53310589, "comment_id": 93512323, "body": "The Shell has a public API. Don&#39;t go about handing out solutions based on implementation details, without <b>clearly</b> marking them as unsupported."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542297934, "post_id": 53310589, "comment_id": 93527323, "body": "@IInspectable Neither I nor the OP can find a public API to do what the OP wants.  Please feel free to correct me if you know better.  Added a note to my post as per your request."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542300258, "post_id": 53310589, "comment_id": 93528751, "body": "@PaulSanders <code>SHGetSetSettings(SSF_HIDEICONS)</code> is the <i>public</i> API for this. It. Is just a <i>broken</i> API at this point."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542300753, "post_id": 53310589, "comment_id": 93529029, "body": "@RemyLebeau Hmmm.  Well, given that it is deprecated and that the documentation is 90% missing anyway, it seems that is unlikely to change."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1542315536, "post_id": 53310589, "comment_id": 93535956, "body": "May also want to note, that this loses the ability to right-click on the desktop."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1542316305, "post_id": 53310589, "comment_id": 93536238, "body": "@IInspectable Done"}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": -1, "last_activity_date": 1542316280, "last_edit_date": 1542316280, "creation_date": 1542240151, "answer_id": 53310589, "question_id": 53310374, "link": "https://stackoverflow.com/questions/53310374/how-to-hide-desktop-icons-with-windows-api-in-c/53310589#53310589", "title": "How to hide Desktop icons with Windows API in C++?", "body": "<p>The following seems to work (adapted from <a href=\"https://stackoverflow.com/a/6403014/5743288\">https://stackoverflow.com/a/6403014/5743288</a>):</p>\n\n<pre><code>#include &lt;windows.h&gt;\n\nint main ()\n{\n    HWND hProgman = FindWindowW (L\"Progman\", L\"Program Manager\");\n    HWND hChild = GetWindow (hProgman, GW_CHILD);\n    ShowWindow (hChild, SW_HIDE);\n    Sleep (2000);\n    ShowWindow (hChild, SW_SHOW);\n}\n</code></pre>\n\n<p>Please note: this approach is not supported by Microsoft and disables right-clicking on ths desktop.</p>\n"}, {"tags": [], "owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "is_accepted": false, "score": 3, "last_activity_date": 1542416940, "creation_date": 1542416940, "answer_id": 53347282, "question_id": 53310374, "link": "https://stackoverflow.com/questions/53310374/how-to-hide-desktop-icons-with-windows-api-in-c/53347282#53347282", "title": "How to hide Desktop icons with Windows API in C++?", "body": "<p>The following approach which uses the official shell API is a little bit involved, but works even under Windows 10. </p>\n\n<p>Steps:</p>\n\n<ol>\n<li>Get the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifolderview2\" rel=\"nofollow noreferrer\"><code>IFolderView2</code></a> interface of the desktop (supported since Windows Vista).</li>\n<li>Call <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifolderview2-setcurrentfolderflags\" rel=\"nofollow noreferrer\"><code>IFolderView2::SetCurrentFolderFlags()</code></a> with <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/shobjidl_core/ne-shobjidl_core-folderflags\" rel=\"nofollow noreferrer\"><code>FWF_NOICONS</code></a> for both the <code>dwMask</code> and <code>dwFlags</code> parameters.</li>\n</ol>\n\n<p>The effect of the flag is visible immediately. There is no need to restart the computer nor \"explorer.exe\". The flag also persists after logoff or reboot.</p>\n\n<p>The tricky thing is step 1). Raymond Chen shows C++ code for that in his article <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20130318-00/?p=4933\" rel=\"nofollow noreferrer\">\"Manipulating the positions of desktop icons\"</a>, specifically in his <code>FindDesktopFolderView()</code> function.</p>\n\n<p>Here is a full example in form of a console application. It is based on Raymond Chen's code. The program toggles the visibility of the desktop icons each time it is run. </p>\n\n<p>The code has been tested under Windows 10 Version 1803.</p>\n\n<p><strong>\"Library\" code:</strong></p>\n\n<pre><code>#include &lt;ShlObj.h&gt;     // Shell API\n#include &lt;atlcomcli.h&gt;  // CComPtr &amp; Co.\n#include &lt;string&gt; \n#include &lt;iostream&gt; \n#include &lt;system_error&gt;\n\n// Throw a std::system_error if the HRESULT indicates failure.\ntemplate&lt; typename T &gt;\nvoid ThrowIfFailed( HRESULT hr, T&amp;&amp; msg )\n{\n    if( FAILED( hr ) )\n        throw std::system_error{ hr, std::system_category(), std::forward&lt;T&gt;( msg ) };\n}\n\n// RAII wrapper to initialize/uninitialize COM\nstruct CComInit\n{\n    CComInit() { ThrowIfFailed( ::CoInitialize( nullptr ), \"CoInitialize failed\" ); }\n    ~CComInit() { ::CoUninitialize(); }\n    CComInit( CComInit const&amp; ) = delete;\n    CComInit&amp; operator=( CComInit const&amp; ) = delete;\n};\n\n// Query an interface from the desktop shell view.\nvoid FindDesktopFolderView( REFIID riid, void **ppv, std::string const&amp; interfaceName )\n{\n    CComPtr&lt;IShellWindows&gt; spShellWindows;\n    ThrowIfFailed( \n        spShellWindows.CoCreateInstance( CLSID_ShellWindows ),\n        \"Failed to create IShellWindows instance\" );\n\n    CComVariant vtLoc( CSIDL_DESKTOP );\n    CComVariant vtEmpty;\n    long lhwnd;\n    CComPtr&lt;IDispatch&gt; spdisp;\n    ThrowIfFailed( \n        spShellWindows-&gt;FindWindowSW(\n            &amp;vtLoc, &amp;vtEmpty, SWC_DESKTOP, &amp;lhwnd, SWFO_NEEDDISPATCH, &amp;spdisp ),\n        \"Failed to find desktop window\" );\n\n    CComQIPtr&lt;IServiceProvider&gt; spProv( spdisp );\n    if( ! spProv )\n        ThrowIfFailed( E_NOINTERFACE, \"Failed to get IServiceProvider interface for desktop\" );\n\n    CComPtr&lt;IShellBrowser&gt; spBrowser;\n    ThrowIfFailed( \n        spProv-&gt;QueryService( SID_STopLevelBrowser, IID_PPV_ARGS( &amp;spBrowser ) ),\n        \"Failed to get IShellBrowser for desktop\" );\n\n    CComPtr&lt;IShellView&gt; spView;\n    ThrowIfFailed( \n        spBrowser-&gt;QueryActiveShellView( &amp;spView ),\n        \"Failed to query IShellView for desktop\" );\n\n    ThrowIfFailed( \n        spView-&gt;QueryInterface( riid, ppv ),\n        \"Could not query desktop IShellView for interface \" + interfaceName );\n}\n</code></pre>\n\n<p><strong>Example to toggle desktop icons using the above code:</strong></p>\n\n<pre><code>void ToggleDesktopIcons()\n{\n    CComPtr&lt;IFolderView2&gt; spView;\n    FindDesktopFolderView( IID_PPV_ARGS(&amp;spView), \"IFolderView2\" );\n\n    DWORD flags = 0;\n    ThrowIfFailed( \n        spView-&gt;GetCurrentFolderFlags( &amp;flags ), \n        \"GetCurrentFolderFlags failed\" );\n    ThrowIfFailed( \n        spView-&gt;SetCurrentFolderFlags( FWF_NOICONS, flags ^ FWF_NOICONS ),\n        \"SetCurrentFolderFlags failed\" );\n}\n\nint wmain(int argc, wchar_t **argv)\n{\n    try\n    {\n        CComInit init;\n\n        ToggleDesktopIcons();\n\n        std::cout &lt;&lt; \"Desktop icons have been toggled.\\n\";\n    }\n    catch( std::system_error const&amp; e )\n    {\n        std::cout &lt;&lt; \"ERROR: \" &lt;&lt; e.what() &lt;&lt; \", error code: \" &lt;&lt; e.code() &lt;&lt; \"\\n\";\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6335250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd78bc6eb7351b13f78e51fb23630840?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/6335250/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1052, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1542416940, "creation_date": 1542238631, "last_edit_date": 1542238907, "question_id": 53310374, "link": "https://stackoverflow.com/questions/53310374/how-to-hide-desktop-icons-with-windows-api-in-c", "title": "How to hide Desktop icons with Windows API in C++?", "body": "<p>The answers I've found link to <code>fHideIcon</code>, but I get a 404 error on Microsoft's page for those links.</p>\n\n<p>I've also tried: </p>\n\n<pre><code>SHELLSTATE ss;\nSecureZeroMemory(&amp;ss, sizeof(ss));\nSHGetSetSettings(&amp;ss, SSF_HIDEICONS, TRUE);\n</code></pre>\n\n<p>But that didn't work.<br>\nDoes anyone know how to do this?</p>\n"}, {"tags": ["c++", "arrays", "function", "dynamic", "delete-operator"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1542238116, "post_id": 53310287, "comment_id": 93501368, "body": "<code>oldArray = newArray</code> - in <code>addNode</code> means <i>nothing</i> to the caller of this function. Their argument passed as <code>oldArray</code> remains unchanged, and is now a dangling pointer, and you&#39;ve leaked memory (the new allocation), upon function return). Worse, future calls now feed a dangling, already-deleted pointer back to <code>addNode</code>, which will <i>likely</i> puke all over your terminal. Change <code>long *oldArray</code> in the argument list to <code>long *&amp; oldArray</code>"}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542238767, "post_id": 53310287, "comment_id": 93501571, "body": "That was... quicker than I thought. And absolutely the problem. Welp, back to learning pointers. Thanks. Do you wanna actually answer this one or do I just copy this?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542238855, "post_id": 53310287, "comment_id": 93501594, "body": "That isn&#39;t a pointer problem; its a lack of lvalue reference to a pointer problem. The pointer was fine; it was just being passed by value. As C++, changing to pass the pointer by reference is an easy fix."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1542240106, "post_id": 53310287, "comment_id": 93501943, "body": "@JohnnyCache You could avoid all of these issues if you used <code>std::vector</code> instead of raw memory and pointers."}, {"owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "edited": false, "score": 0, "creation_date": 1542241572, "post_id": 53310287, "comment_id": 93502301, "body": "All the outdated solutions are a part of the curriculum, and are mandatory. Literally written up there. Trust me, if I could use std::vector, I&#39;d be using C#."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542244195, "post_id": 53310287, "comment_id": 93502961, "body": "<i>I&#39;d be using C#</i> BLASPHEMY! Where&#39;s my stake and kindling?"}], "owner": {"reputation": 969, "user_id": 9119391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91441ccec1aeff26e087429cf3d0b2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Cache", "link": "https://stackoverflow.com/users/9119391/johnny-cache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542238400, "creation_date": 1542237976, "last_edit_date": 1542238400, "question_id": 53310287, "link": "https://stackoverflow.com/questions/53310287/deleting-a-dynamic-array-from-another-function", "title": "Deleting a dynamic array from another function", "body": "<p>Exactly as it says. I create a dynamic array in one function, then give the pointer to another one for adding a new element to the end and try to delete[] it. First it gave me a wntdll.pdb not loaded, which I quickly downloaded. Then, it just causes an exception upon deletion. I think it's something to do with protection but I have no idea on how to circumvent it.</p>\n\n<p>Any ideas?</p>\n\n<p>By the way, it loads a \"delete_scalar.cpp\" file on line 32</p>\n\n<pre><code>_free_dbg(block, _UNKNOWN_BLOCK);\n</code></pre>\n\n<p>My code (short version):</p>\n\n<pre><code>int addNode(long *oldArray, int size) {\n    long *newArray = new long[size + 1];\n    long *bufArray = oldArray;\n    for (int i = 0; i &lt; size; i++) {\n        newArray[i] = oldArray[i];\n    }\n    oldArray = newArray;\n    delete[] bufArray;  //the problem line\n    size++;\n    return size;\n}\n</code></pre>\n\n<p>My code (long version, and yes, all the outdated solutions are a part of the curriculum, and are mandatory):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nvoid convertToBin(string const nameIn, string const nameOut);\nvoid readFile(string const fileName);\nlong *getNewArr(long **arrMatrix, int *arrSizes, int arrNum);\nint addNode(long *oldArray, int size);\nvoid outputArr(long *resArr);\n\nvoid main() {\n    setlocale(LC_ALL, \"\");\n    string preinput = \"input.txt\", input = \"input.bin\", output = \"output.txt\";\n    convertToBin(preinput, input);\n    readFile(input);\n    cout &lt;&lt; \"\u0413\u043e\u0442\u043e\u0432\u043e!\\n\";       //Done!\n}\n                  //this is where the array is created\nvoid readFile(string fileName) {            \n    cout &lt;&lt; \"\u0427\u0442\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430\\n\";  //reading the file\n    ifstream streamIn;\n    streamIn.open(fileName, ios::in | ios::binary);\n    if (!streamIn.is_open()) {\n        cout &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430 \u0447\u0442\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430\\n\";  //file reading error\n        return;\n    }\n    cout &lt;&lt; \"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u0432\\n\";  //get array sizes\n    int arrNum;\n    streamIn.read((char*)&amp;arrNum, sizeof(int));\n    int *arrSize = new int[arrNum];\n    for (int i = 0; i &lt; arrNum; i++)\n    {\n        streamIn.read((char*)&amp;arrSize[i], sizeof(int));\n    }\n    cout &lt;&lt; \"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0432\u043e\u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u0432\\n\";   //setup initial arrays\n    long **arrMatrix = new long *[arrNum];\n    for (int i = 0; i &lt; arrNum; i++)\n    {\n        arrMatrix[i] = new long[arrSize[i]];\n    }\n    for (int i = 0; i &lt; arrNum; i++)\n        for (int j = 0; j &lt; arrSize[i]; j++) {\n            streamIn.read((char*)&amp;arrMatrix[i][j], sizeof(long));\n        }\n    streamIn.close();\n    outputArr(getNewArr(arrMatrix, arrSize, arrNum));\n    cout &lt;&lt; \"\u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u043f\u0430\u043c\u044f\u0442\u0438\\n\";              //memory cleanup\n    for (int i = 0; i &lt; arrNum; i++)\n        delete[] arrMatrix[i];\n    delete[] arrMatrix;\n    delete[] arrSize;\n}\n\nlong *getNewArr(long **arrMatrix, int *arrSizes, int arrNum) {\n    cout &lt;&lt; \"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043c\u0430\u0441\u0441\u0438\u0432\u0430\\n\";        //creating new array\n    long *newArr = new long [0];\n    int newArrSize = 0;\n    for (int i = 0; i &lt; arrSizes[0]; i++) {     //the heart of the\n        long x = arrMatrix[0][i];               //program. multiplies\n        bool isCommon = 1;                      //x sets, outputs the\n        for (int j = 1; j &lt; arrNum; j++) {      //result preceeded by\n            isCommon = 0;                       //size.\n            for (int k = 0; k &lt; arrSizes[j]; k++)\n                if (x == arrMatrix[j][k]) { isCommon = 1; break; }\n        }\n        if (isCommon) {\n            newArrSize = addNode(newArr, newArrSize);\n            newArr[newArrSize - 1] = x;\n        }\n    }\n    addNode(newArr, newArrSize);                  \n    for (int i = 0; i &lt; newArrSize; i++)\n        newArr[i + 1] = newArr[i];\n    newArr[0] = newArrSize;\n    return newArr;\n}\n\nint addNode(long *oldArray, int size) {           //the problem function\n    long *newArray = new long[size + 1];\n    long *bufArray = oldArray;\n    for (int i = 0; i &lt; size; i++) {\n        newArray[i] = oldArray[i];\n    }\n    oldArray = newArray;\n    delete[] bufArray;                              //the problem line\n    size++;\n    return size;\n}\n\nvoid outputArr(long *resArr) {\n    cout &lt;&lt; \"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043c\u0430\u0441\u0441\u0438\u0432\u0430\\n\";          //saving new array\n    ofstream streamOut;\n    streamOut.open(\"output.txt\");\n    if (!streamOut.is_open()) {\n        cout &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430 \u0447\u0442\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u0430\\n\";            //file read error\n        return;\n    }\n    for (int i = 0; i &lt;= resArr[0]; i++) {\n        streamOut &lt;&lt; resArr[i] &lt;&lt; \" \";\n    }\n    streamOut.close();\n    delete[] resArr;\n}\n\nvoid convertToBin(string const nameIn, string const nameOut)   \n{                                                 //he has us bloody convert\n    ifstream streamIn;                            //to binary before doing\n    streamIn.open(nameIn, ios_base::in);          //anything.\n\n    ofstream streamOut;\n    streamOut.open(nameOut, ios_base::out | ios_base::binary);\n\n    if (!(streamIn.is_open() &amp;&amp; streamOut.is_open()))\n    {\n        cout &lt;&lt; \"\u041e\u0448\u0438\u0431\u043a\u0430 \u0447\u0442\u0435\u043d\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432!\\n\";\n        return;\n    }\n    int x;\n    while (!streamIn.eof()) {\n        streamIn &gt;&gt; x;\n        streamOut.write((char*)&amp;x, sizeof(int));\n    }\n    streamIn.close();   streamOut.close();\n}\n</code></pre>\n"}, {"tags": ["c++", "xcode", "svn"], "answers": [{"tags": [], "owner": {"reputation": 26602, "user_id": 761095, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6qOuP.png?s=128&g=1", "display_name": "bahrep", "link": "https://stackoverflow.com/users/761095/bahrep"}, "is_accepted": false, "score": 0, "last_activity_date": 1542290063, "creation_date": 1542290063, "answer_id": 53321024, "question_id": 53309975, "link": "https://stackoverflow.com/questions/53309975/pre-commit-hook-exit-code-2-xcode-svn/53321024#53321024", "title": "Pre-commit hook (exit code 2), Xcode, SVN", "body": "<p>The error says <code>Commit blocked by pre-commit hook (exit code 2)</code>. The hook is installed on the SVN server's side and this hook seems to be broken. Ask your SVN server admin to double-check this. It can also be possible that your commit does not meet some requirements enforced by this hook script. E.g. maybe this hook checks the length of your commit's log message and rejects your commit because your message is to short.</p>\n"}], "owner": {"reputation": 11, "user_id": 4088046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WVruUO3JtRU/AAAAAAAAAAI/AAAAAAAAAGE/Z54UiXJIAJM/photo.jpg?sz=128", "display_name": "Timco Vanco", "link": "https://stackoverflow.com/users/4088046/timco-vanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542290063, "creation_date": 1542236280, "question_id": 53309975, "link": "https://stackoverflow.com/questions/53309975/pre-commit-hook-exit-code-2-xcode-svn", "title": "Pre-commit hook (exit code 2), Xcode, SVN", "body": "<p>I am working on a project in C++ in Xcode and we are using SVN. Everytime, when I press commit, Xcode show me this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Ugda.png\" rel=\"nofollow noreferrer\">BPPC_Project - name of our project</a></p>\n\n<p>What can I do, to solve this problem and also use SVN?</p>\n"}, {"tags": ["c++", "opengl", "optimization", "vbo", "particle-system"], "comments": [{"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1542236373, "post_id": 53309957, "comment_id": 93500800, "body": "Why aren&#39;t you performing the particle calculations on the GPU?"}, {"owner": {"reputation": 13, "user_id": 5385549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb50c369c571696aee515b7915eaa0a?s=128&d=identicon&r=PG&f=1", "display_name": "Takii Marskii", "link": "https://stackoverflow.com/users/5385549/takii-marskii"}, "reply_to_user": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1542236595, "post_id": 53309957, "comment_id": 93500879, "body": "Alright thats a start! So how I worked it out is that the shader would basically do the Velocity and Positions calculations per vertex, how would I get the updated position back to the Client side so the next time it can be done again?"}, {"owner": {"reputation": 433, "user_id": 7313789, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a4a8392e031b7a7a12a70e0efc42c9df?s=128&d=identicon&r=PG&f=1", "display_name": "Luple", "link": "https://stackoverflow.com/users/7313789/luple"}, "edited": false, "score": 0, "creation_date": 1542242093, "post_id": 53309957, "comment_id": 93502452, "body": "There are two ways of doing it on the GPU that I know of. You can either use transform feedback to update the VBO or use a texture to store the positions and render into the texture. Eitehr way you want to avoid copying the position back to the client (cpu) as that is an expensive operation."}, {"owner": {"reputation": 567, "user_id": 2304831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acceda9194ddfaaefdcd73cd0f16d769?s=128&d=identicon&r=PG", "display_name": "Rhu Mage", "link": "https://stackoverflow.com/users/2304831/rhu-mage"}, "edited": false, "score": 0, "creation_date": 1542266897, "post_id": 53309957, "comment_id": 93508821, "body": "I don&#39;t know which OpenGL version you&#39;re using, but if it&#39;s supported your best option is a compute shader with ssbo. You first update the particles in the ssbo with the compute shader, place a barrier and then draw using the same buffer as input for vertex shader."}, {"owner": {"reputation": 13, "user_id": 5385549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb50c369c571696aee515b7915eaa0a?s=128&d=identicon&r=PG&f=1", "display_name": "Takii Marskii", "link": "https://stackoverflow.com/users/5385549/takii-marskii"}, "reply_to_user": {"reputation": 433, "user_id": 7313789, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a4a8392e031b7a7a12a70e0efc42c9df?s=128&d=identicon&r=PG&f=1", "display_name": "Luple", "link": "https://stackoverflow.com/users/7313789/luple"}, "edited": false, "score": 0, "creation_date": 1542315546, "post_id": 53309957, "comment_id": 93535964, "body": "@Luple Thanks so much I&#39;ll go and try both methods but honestly transform feedback seems to be my favourite"}, {"owner": {"reputation": 13, "user_id": 5385549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb50c369c571696aee515b7915eaa0a?s=128&d=identicon&r=PG&f=1", "display_name": "Takii Marskii", "link": "https://stackoverflow.com/users/5385549/takii-marskii"}, "reply_to_user": {"reputation": 567, "user_id": 2304831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acceda9194ddfaaefdcd73cd0f16d769?s=128&d=identicon&r=PG", "display_name": "Rhu Mage", "link": "https://stackoverflow.com/users/2304831/rhu-mage"}, "edited": false, "score": 0, "creation_date": 1542315622, "post_id": 53309957, "comment_id": 93535990, "body": "@Rhu Mage good point! SSBO may be supported by my machine so I&#39;ll check tonight"}], "owner": {"reputation": 13, "user_id": 5385549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb50c369c571696aee515b7915eaa0a?s=128&d=identicon&r=PG&f=1", "display_name": "Takii Marskii", "link": "https://stackoverflow.com/users/5385549/takii-marskii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542236709, "creation_date": 1542236164, "last_edit_date": 1542236709, "question_id": 53309957, "link": "https://stackoverflow.com/questions/53309957/opengl-precompute-vertices-matrices-for-particle-system-optimization", "title": "OpenGL Precompute Vertices/Matrices for Particle System / Optimization", "body": "<p>I have a particle system which I want to make as really fast as possible without any effects on the main display function, I basically placed all particles calculations on a separate infinite thread which I keep synchronized with WaitForEvent() (Windows), DataLock flags, etc.</p>\n\n<p>I use glColorPointer, glNormalPointer, glVertexPointer etc to point to the buffered data on the GPU (glGenBuffers, glBufferData) and then glDrawElements to render them. </p>\n\n<p>At the moment I don't have the code so I hope that won't be a problem but I'll try my best to get the infrastructure described:</p>\n\n<ul>\n<li><p>Main [Init]</p>\n\n<ol>\n<li>Create a pre-calc queue 30% in size of N particles and do sequential calculations (Thread 1 #2)</li>\n</ol></li>\n<li><p>Thread 1</p>\n\n<ol>\n<li>Wait for Calculate Event signal or if pre-calc queue is not full then continue</li>\n<li>Loop through N particles and update position / velocity, storing it in pUpdate</li>\n<li>If pre-calc queue is not full, add pUpdate to it</li>\n</ol></li>\n<li><p>Main [Render]</p>\n\n<ol>\n<li>glActiveTexture(TEXTURE0)</li>\n<li>glCol/glNorm/glTex/glVertexPointer</li>\n<li>If pre-calc is empty use the most recent pUpdate </li>\n<li>OR use one of the pre-calc and delete</li>\n<li>Store item in buffer using glBufferSubData()</li>\n<li>DrawElements() to draw them</li>\n<li>SwapBuffers</li>\n</ol></li>\n</ul>\n\n<p>The problem is that the Render function uses about 50 pre-calc per second (which speeds up rendering while there are enough left) before 1 could even be added. In short order the pre-calc is empty so everything slows down and the program reverts to Main-Render #3</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "language-lawyer", "unions", "type-definition"], "comments": [{"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 1, "creation_date": 1542235220, "post_id": 53309783, "comment_id": 93500452, "body": "It looks like this is not allowed: &quot;Members of an anonymous union are injected in the enclosing scope (and must not conflict with other names declared there)&quot; <a href=\"https://en.cppreference.com/w/cpp/language/union#Anonymous_unions\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/union#Anonymous_unions</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542235572, "post_id": 53309783, "comment_id": 93500556, "body": "It is a language extension of <code>cl</code>. Disable language extensions (<code>&#47;Za</code>) and happily get: <code>error C2658: &#39;Foo::bar&#39;: redefinition in anonymous struct&#47;union</code>"}], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 9, "last_activity_date": 1542235440, "creation_date": 1542235440, "answer_id": 53309844, "question_id": 53309783, "link": "https://stackoverflow.com/questions/53309783/fields-with-the-same-name-across-different-anonymous-unions-inside-one-union/53309844#53309844", "title": "Fields with the same name across different anonymous unions inside one union", "body": "<p>This is not allowed by C++ standard. Any compiler which compiles this code is non-conformant.</p>\n\n<p>See 10.4.1/1:</p>\n\n<blockquote>\n  <p>The names of the members of an anonymous union shall be distinct from\n  the names of any other entity in the scope in which the anonymous\n  union is declared.</p>\n</blockquote>\n"}], "owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 53309844, "answer_count": 1, "score": 5, "last_activity_date": 1542319733, "creation_date": 1542235101, "last_edit_date": 1542319733, "question_id": 53309783, "link": "https://stackoverflow.com/questions/53309783/fields-with-the-same-name-across-different-anonymous-unions-inside-one-union", "title": "Fields with the same name across different anonymous unions inside one union", "body": "<p>Is it legal to have fields with the same name across different anonymous unions inside one union?</p>\n\n<pre><code>union Foo\n{\n    union\n    {\n        int bar;\n    };\n\n    union\n    {\n        int bar;\n    };\n};\n</code></pre>\n\n<p>This code fails to compile by GCC but works fine in MSVC.</p>\n"}, {"tags": ["c++", "algorithm", "hashtable", "multimap"], "comments": [{"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 1, "creation_date": 1542234932, "post_id": 53309734, "comment_id": 93500350, "body": "Have you compiled this code locally and tried to run it (perhaps in a debugger) to see if there is an infinite loop?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542235407, "post_id": 53309734, "comment_id": 93500494, "body": "Your input loop is highly suspicious.  If your input is line-based, then read your data in a line-based fashion.  Do not use <code>eof</code> as your loop test."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1542235489, "post_id": 53309734, "comment_id": 93500523, "body": "<i>I send code to testing system</i> -- And how does this &quot;testing system&quot; knows you are not using <code>std::unordered_map</code>?  Why not write the program using <code>std::unordered_map</code>, just to see if you are on the right track?  It makes no sense implementing something by hand, knowing that the better alternative also will not work with the test data."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1542236293, "post_id": 53309734, "comment_id": 93500776, "body": "What is the type of input to be expected? Arbitrary strings? The samples indicate only single characters; if this <i>was</i> true, then vector of vector of char would be much faster; your hash function would be simple index operator and your outer vector could be much smaller. I&#39;d assume that it could be much smaller anyway: less than 100000 operations does not mean that we need to expect 100000 different elements; I&#39;d assume a vector of 1009 would suffice already (saves quite some initialisation time)."}, {"owner": {"reputation": 9, "user_id": 10634196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c935f1af70ba3c985916b9147cde95c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u0441\u0438\u043b\u0438\u0439 \u042e\u0433\u0430\u0439", "link": "https://stackoverflow.com/users/10634196/%d0%92%d0%b0%d1%81%d0%b8%d0%bb%d0%b8%d0%b9-%d0%ae%d0%b3%d0%b0%d0%b9"}, "edited": false, "score": 0, "creation_date": 1542236475, "post_id": 53309734, "comment_id": 93500845, "body": "X and y can be strings of 20chars"}, {"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1542263225, "post_id": 53309734, "comment_id": 93507465, "body": "Using a good hash, even if slightly more expensive might improve the code even more. Can you use std::hash?"}], "answers": [{"comments": [{"owner": {"reputation": 13642, "user_id": 4013258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d423395e1033fa23d80a5561ab170fa?s=128&d=identicon&r=PG&f=1", "display_name": "Surt", "link": "https://stackoverflow.com/users/4013258/surt"}, "edited": false, "score": 0, "creation_date": 1542263197, "post_id": 53310667, "comment_id": 93507454, "body": "The weakness of the current std::unordered_map is that the buckets are a (unsorted?) linked list, using a sorted std::vector is most likely an improvement."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1542242637, "last_edit_date": 1542242637, "creation_date": 1542240809, "answer_id": 53310667, "question_id": 53309734, "link": "https://stackoverflow.com/questions/53309734/i-need-to-create-multimap-using-hash-table-but-i-get-time-limit-exceeded-error/53310667#53310667", "title": "I need to create MultiMap using hash-table but I get time-limit exceeded error (C++)", "body": "<p>At very first, a matter of design: Normally, one would pass the key only to the function and calculate the hash within. Your variant allows a user to place elements anywhere within the hash table (using bad hash values), so user could easily break it.</p>\n\n<p>So e. g. <code>put</code>:</p>\n\n<pre><code>using HashTable = std::vector&lt;std::vector&lt;std::pair&lt;std::string, std::string&gt;&gt;&gt;;\n\nvoid put(HashTable&amp; table, std::string&amp; key, std::string const&amp; value)\n{\n    auto hash = h1(key);\n    // ...\n}\n</code></pre>\n\n<p>If at all, the hash function could be parametrised, but then you'd write a separate class for (wrapping the vector of vectors) and provide the hash function in constructor so that a user cannot exchange it arbitrarily (and again break the hash table). A class would come with additional benefits, most important: better encapsulation (hiding the vector away, so user could not change it with vector's own interface):</p>\n\n<pre><code>class HashTable\n{\npublic:\n    // IF you want to provide hash function:\n    template &lt;typename Hash&gt;\n    HashTable(Hash hash) : hash(hash) { }\n\n    void put(std::string const&amp; key, std::string const&amp; value);\n    void remove(std::string const&amp; key, std::string const&amp; value); //(delete is keyword!)\n    // ... \nprivate:\n    std::vector&lt;std::vector&lt;std::pair&lt;std::string, std::string&gt;&gt;&gt; data;\n\n    // if hash function parametrized:\n    std::function&lt;size_t(std::string)&gt; hash; // #include &lt;functional&gt; for\n};\n</code></pre>\n\n<p>I'm not 100% sure how efficient <code>std::function</code> really is, so for high performance code, you preferrably use your hash function <code>h1</code> directly (not implenting constructor as illustrated above).</p>\n\n<p>Coming to optimisations:</p>\n\n<p>For the hash key I would prefer unsigned value: Negative indices are meaningless anyway, so why allow them at all? long long (signed or unsigned) might be a bad choice if testing system is a 32 bit system (might be unlikely, but still...). <code>size_t</code> covers both issues at once: it is unsigned and it is selected in size appropriately for given system (if interested in details: actually adjusted to address bus size, but on modern systems, this is equal to register size as well, which is what we need). Select type of <code>pow</code> to be the same.</p>\n\n<p><code>deleteAll</code> is implemented inefficiently: With each element you erase you move all the subsequent elements one position towards front. If you delete multiple elements, you do this repeatedly, so one single element can get moved multiple times. Better:</p>\n\n<pre><code>auto pos = vector.begin();\nfor(auto&amp; pair : vector)\n{\n    if(pair.first != keyToDelete)\n        *pos++ = std::move(s); // move semantics: faster than copying!\n}\nvector.erase(pos, vector.end());\n</code></pre>\n\n<p>This will move each element at most once, erasing all surplus elements in one single go. Appart from the final erasing (which you have to do explicitly then), this is more or less what <code>std::remove</code> and <code>std::remove_if</code> from <a href=\"https://en.cppreference.com/w/cpp/algorithm\" rel=\"nofollow noreferrer\">algorithm library</a> do as well. Are you allowed to use it? Then your code might look like this:</p>\n\n<pre><code>auto condition = [&amp;keyToDelete](std::pair&lt;std::string, std::string&gt; const&amp; p)\n                 { return p.first == keyToDelete; };\nvector.erase(std::remove_if(vector.begin(), vector.end(), condition), vector.end());\n</code></pre>\n\n<p>and you profit from already highly optimised algorithm.</p>\n\n<p>Just a minor performance gain, but still: You can spare variable initialisation, assignment and conditional branch (the latter one can be relatively expensive operation on some systems) within <code>put</code> if you simply return if an element is found:</p>\n\n<pre><code>//int checker = 0;\nfor(auto&amp; pair : hashTable[hash]) // just a little more comfortable to write...\n{\n    if(pair.first == key &amp;&amp; pair.second == value)\n        return;\n}\nauto key_value = std::make_pair(key, value);\nhashTable[hash].push_back(key_value);\n</code></pre>\n\n<p>Again, with algorithm library:</p>\n\n<pre><code>auto key_value = std::make_pair(key, value);\n// same condition as above!\nif(std::find_if(vector.begin(), vector.end(), condition) == vector.end();\n{\n    vector.push_back(key_value);\n}\n</code></pre>\n\n<p>Then less than 100000 operations does not indicate that each operation will require a separate key/value pair. We might expect that keys are added, removed, re-added, ..., so you most likely don't have to cope with 100000 different values. I'd assume your map is much too large (be aware that it requires initialisation of 100000 vectors as well). I'd assume a much smaller one should suffice already (possibly 1009 or 10007? You might possibly have to experiment a little...).</p>\n\n<p>Keeping the inner vectors sorted might give you some performance boost as well:</p>\n\n<ul>\n<li><code>put</code>: You could use a binary search to find the two elements in between a new one is to be inserted (if one of these two is equal to given one, no insertion, of course)</li>\n<li><code>delete</code>: Use binary search to find the element to delete.</li>\n<li><code>deleteAll</code>: Find upper and lower bounds for elements to be deleted and erase whole range at once.</li>\n<li><code>get</code>: find lower and upper bound as for <code>deleteAll</code>, distance in between (number of elements) is a simple subtraction and you could print out the texts directly (instead of first building a long string). Which of outputting directly or creating a string really is more efficient is to be found out, though, as outputting directly involves multiple system calls, which in the end might cost previously gained performance again...</li>\n</ul>\n\n<p>Considering your input loop:</p>\n\n<p>Checking for <code>eof()</code> (only) is <a href=\"https://stackoverflow.com/q/5605125/1312382\">critical</a>! If there is an error in the file, you'll end up in an endless loop, as the fail bit gets set, <code>operator&gt;&gt;</code> actually won't read anything at all any more and you won't ever reach the end of the file. This even might be the reason for your 20th test failing.</p>\n\n<p>Additionally: You have line based input (each command on a separate line), so reading a whole line at once and only afterwards parse it will spare you some system calls. If some argument is missing, you will detect it correctly instead of (illegally) reading next command (e. g. <code>put</code>) as argument, similarly you won't interpret a surplus argument as next command. If a line is invalid for whatever reason (bad number of arguments as above or unknown command), you can then decide indiviually what you want to do (just ignore the line or abort processing entirely). So:</p>\n\n<pre><code>std::string line;\nwhile(std::getline(std::cin, line))\n{\n    // parse the string; if line is invalid, appropriate error handling\n    // (ignoring the line, exiting from loop, ...)\n}\nif(!std::cin.eof())\n{\n    // some error occured, print error message!\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10634196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c935f1af70ba3c985916b9147cde95c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0412\u0430\u0441\u0438\u043b\u0438\u0439 \u042e\u0433\u0430\u0439", "link": "https://stackoverflow.com/users/10634196/%d0%92%d0%b0%d1%81%d0%b8%d0%bb%d0%b8%d0%b9-%d0%ae%d0%b3%d0%b0%d0%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542242637, "creation_date": 1542234749, "question_id": 53309734, "link": "https://stackoverflow.com/questions/53309734/i-need-to-create-multimap-using-hash-table-but-i-get-time-limit-exceeded-error", "title": "I need to create MultiMap using hash-table but I get time-limit exceeded error (C++)", "body": "<p>I'm trying to solve algorithm task: I need to create MultiMap(key,(values)) using hash-table. <strong>I can't use Set and Map libraries</strong>. I send code to testing system, but I get time-limit exceeded error on test 20. I don't know what exactly this test contains. The code must do following tasks:</p>\n\n<p>put x y - add pair (x,y).If pair exists, do nothing.</p>\n\n<p>delete x y - delete pair(x,y). If pair doesn't exist, do nothing.</p>\n\n<p>deleteall x - delete all pairs with first element x.</p>\n\n<p>get x - print number of pairs with first element x and second elements.</p>\n\n<p>The amount of operations &lt;= 100000</p>\n\n<p>Time limit - 2s</p>\n\n<p>Example:</p>\n\n<p>multimap.in:</p>\n\n<p>put a a</p>\n\n<p>put a b</p>\n\n<p>put a c</p>\n\n<p>get a</p>\n\n<p>delete a b</p>\n\n<p>get a</p>\n\n<p>deleteall a</p>\n\n<p>get a</p>\n\n<p>multimap.out:</p>\n\n<p>3 b c a</p>\n\n<p>2 c a</p>\n\n<p>0</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\ninline long long h1(const string&amp; key) {\n    long long number = 0;\n    const int p = 31;\n    int pow = 1;\n    for(auto&amp; x : key){\n        number += (x - 'a' + 1 ) * pow;\n        pow *= p;\n    }\n    return abs(number) % 1000003;\n}\n\n inline void Put(vector&lt;vector&lt;pair&lt;string,string&gt;&gt;&gt;&amp; Hash_table,const long long&amp; hash, const string&amp; key, const string&amp; value) {\n    int checker = 0;\n    for(int i = 0; i &lt; Hash_table[hash].size();i++) {\n        if(Hash_table[hash][i].first == key &amp;&amp; Hash_table[hash][i].second == value) {\n                checker = 1;\n            break;\n        }\n    }\n    if(checker == 0){\n        pair &lt;string,string&gt; key_value = make_pair(key,value);\n        Hash_table[hash].push_back(key_value);\n    }\n}\n inline void Delete(vector&lt;vector&lt;pair&lt;string,string&gt;&gt;&gt;&amp; Hash_table,const long long&amp; hash, const string&amp; key, const string&amp; value) {\n    for(int i = 0; i &lt; Hash_table[hash].size();i++) {\n        if(Hash_table[hash][i].first == key &amp;&amp; Hash_table[hash][i].second == value) {\n            Hash_table[hash].erase(Hash_table[hash].begin() + i);\n            break;\n        }\n    }\n}\n\n  inline void Delete_All(vector&lt;vector&lt;pair&lt;string,string&gt;&gt;&gt;&amp; Hash_table,const long long&amp; hash,const string&amp; key) {\n    for(int i = Hash_table[hash].size() - 1;i &gt;= 0;i--){\n        if(Hash_table[hash][i].first == key){\n            Hash_table[hash].erase(Hash_table[hash].begin() + i);\n        }\n    }\n}\ninline string Get(const vector&lt;vector&lt;pair&lt;string,string&gt;&gt;&gt;&amp; Hash_table,const long long&amp; hash, const string&amp; key) {\n    string result=\"\";\n    int counter = 0;\n    for(int i = 0; i &lt; Hash_table[hash].size();i++){\n        if(Hash_table[hash][i].first == key){\n            counter++;\n            result += Hash_table[hash][i].second + \" \";\n        }\n    }\n    if(counter != 0)\n        return to_string(counter) + \" \" + result + \"\\n\";\n    else\n        return \"0\\n\";\n\n}\n\nint main() {\n    vector&lt;vector&lt;pair&lt;string,string&gt;&gt;&gt; Hash_table;\n    Hash_table.resize(1000003);\n    ifstream input(\"multimap.in\");\n    ofstream output(\"multimap.out\");\n    string command;\n    string key;\n    int k = 0;\n    string value;\n     while(true) {\n        input &gt;&gt; command;\n        if(input.eof())\n            break;\n        if(command == \"put\") {\n            input &gt;&gt; key;\n            long long hash = h1(key);\n            input &gt;&gt; value;\n            Put(Hash_table,hash,key,value);\n        }\n        if(command == \"delete\") {\n            input &gt;&gt; key;\n            input &gt;&gt; value;\n            long long  hash = h1(key);\n            Delete(Hash_table,hash,key,value);\n        } \n        if(command == \"get\") {\n            input &gt;&gt; key;\n            long long  hash = h1(key);\n            output &lt;&lt; Get(Hash_table,hash,key);\n        }\n        if(command == \"deleteall\"){\n            input &gt;&gt; key;\n            long long hash = h1(key);\n            Delete_All(Hash_table,hash,key);\n        } \n    }  \n}\n</code></pre>\n\n<p>How can I do my code work faster?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 4, "creation_date": 1542233853, "post_id": 53309548, "comment_id": 93499933, "body": "Your use-case for doing this is - what?"}, {"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "edited": false, "score": 1, "creation_date": 1542234028, "post_id": 53309548, "comment_id": 93500001, "body": "@Neil Butterworth It was actually made by an accident as the real example is much bigger and more complex than the one I&#39;ve provided here"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542234251, "post_id": 53309548, "comment_id": 93500082, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14248044/are-anonymous-structs-standard-and-really-what-are-they\">Are &quot;anonymous structs&quot; standard? And, really, what *are* they?</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542234343, "post_id": 53309548, "comment_id": 93500112, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25542390/anonymous-union-and-struct\">Anonymous union and struct</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542235813, "post_id": 53309548, "comment_id": 93500631, "body": "Disable language extensions of <code>cl</code> (<code>&#47;Za</code>) and get: <code>error C2467: illegal declaration of anonymous &#39;struct&#39;</code> and <code>error C2658: &#39;Foo::bar&#39;: redefinition in anonymous struct&#47;union</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "edited": false, "score": 0, "creation_date": 1542234599, "post_id": 53309595, "comment_id": 93500213, "body": "I&#39;ve just updated my question, please take a look at the new version."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "edited": false, "score": 0, "creation_date": 1542234888, "post_id": 53309595, "comment_id": 93500333, "body": "@FrozenHeart I&#39;d say it warrants a separate question, probably tagged <code>language-lawyer</code>. But since both GCC and Clang reject the new snippet as well, I smell MSVC bug."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 4, "last_activity_date": 1542234003, "creation_date": 1542234003, "answer_id": 53309595, "question_id": 53309548, "link": "https://stackoverflow.com/questions/53309548/fields-with-the-same-name-across-different-anonymous-structures-inside-on-union/53309595#53309595", "title": "Fields with the same name across different anonymous structures inside on union", "body": "<p>The code is not valid, simply because C++ has no anonymous structures.</p>\n\n<p>With <code>-pedantic-errors</code>, GCC refuses to compile it with <code>error: ISO C++ prohibits anonymous structs [-Wpedantic]</code>.</p>\n"}], "owner": {"reputation": 17248, "user_id": 1608835, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/941587f86c2f65a08dec808da1e3c1ce?s=128&d=identicon&r=PG", "display_name": "FrozenHeart", "link": "https://stackoverflow.com/users/1608835/frozenheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53309595, "answer_count": 1, "score": -3, "last_activity_date": 1542235387, "creation_date": 1542233728, "last_edit_date": 1542235387, "question_id": 53309548, "link": "https://stackoverflow.com/questions/53309548/fields-with-the-same-name-across-different-anonymous-structures-inside-on-union", "title": "Fields with the same name across different anonymous structures inside on union", "body": "<p>Is it legal to have fields with the same name across different anonymous structures inside one <code>union</code>?</p>\n\n<pre><code>union Foo\n{\n    struct\n    {\n        int bar;\n    };\n\n    struct\n    {\n        int bar;\n    };\n};\n</code></pre>\n\n<p>MSVC does in fact allow this while GCC doesn't.</p>\n"}, {"tags": ["c++"], "owner": {"reputation": 286, "user_id": 8606035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00dc1fe3d87d042d46927e7b6ac6460d?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/8606035/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1542233447, "creation_date": 1542233447, "question_id": 53309500, "link": "https://stackoverflow.com/questions/53309500/how-to-create-a-custom-camera-api-that-can-be-used-in-unity", "title": "How to create a custom camera API that can be used in Unity", "body": "<p>Unity has a WebcamTexture API that grants users easy access to the camera frames. However, it has no controls for exposure, focus, brightness values. </p>\n\n<p>I want to create a custom camera API let's say in C++ for a Unity (running on .NET3.5), what are some first steps I should take or look into? I do not want to use any existing assets, nor I want to use UWP which requires .NET4.5.</p>\n"}, {"tags": ["c++", "sockets", "multicast"], "comments": [{"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 1, "creation_date": 1542233695, "post_id": 53309453, "comment_id": 93499878, "body": "You need to <code>sendto()</code> a specific <a href=\"https://en.wikipedia.org/wiki/Multicast_address\" rel=\"nofollow noreferrer\">multicast address</a>, and of course the receiver(s) need to join the multicast group using <code>setsockopt(s, IPPROTO_IPV6, IPV6_ADD_MEMBERSHIP, ...)</code>."}, {"owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1542234135, "post_id": 53309453, "comment_id": 93500038, "body": "@TypeIA There is no client/server in this application"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 1, "creation_date": 1542234233, "post_id": 53309453, "comment_id": 93500076, "body": "I didn&#39;t say client or server, but I did say receiver, and in multicast there is always a sender and zero or more receivers. The routing association between the sender and receiver(s) is made via multicast addresses, to which the sender sends and the receivers associate using a socket option."}], "owner": {"reputation": 365, "user_id": 9616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91bcf4ea4e16e38ca0eb32fb3d544f8e?s=128&d=identicon&r=PG&f=1", "display_name": "Brykyz", "link": "https://stackoverflow.com/users/9616495/brykyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1542251845, "answer_count": 0, "score": 0, "last_activity_date": 1542251792, "creation_date": 1542233251, "last_edit_date": 1542251792, "question_id": 53309453, "link": "https://stackoverflow.com/questions/53309453/sending-packet-to-interface-via-multicast", "closed_reason": "Duplicate", "title": "Sending packet to interface via multicast", "body": "<p>I am trying to send <code>u_char *packet</code> (format of specific protocol) over local multicast (IPv6).</p>\n\n<p>These are my steps I have already done:</p>\n\n<ul>\n<li>Getting interface index via <code>if_nametoindex(interface.c_str())</code>, where <code>interface.c_str()</code> is string with name of interface</li>\n<li>Getting IPv6 address of interface with <code>struct ifaddrs *ifc</code> and <code>getifaddrs(&amp;ifc)</code>, where I iterate through <code>ifc</code>, compare <code>ifc-&gt;ifa_name</code> with <code>interface.c_str()</code> and checking IPv6 address with <code>IN6_IS_ADDR_LINKLOCAL(...)</code></li>\n<li>Setting socket with <code>socket(AF_INET6, SOCK_DGRAM, 0)</code>, setting socket option <code>SO_REUSEADDR</code> to 1, <code>IPV6_MULTICAST_HOPS</code> to 255 and <code>IPV6_MULTICAST_IF</code> to index of interface</li>\n<li><p>Setting <code>struct sockaddr_in6</code> like:</p>\n\n<pre><code>struct sockaddr_in6 sa;\nbzero(&amp;sa, sizeof(sa));\nsa.sin6_family = AF_INET6;\nsa.sin6_port = htons(521); //Port RIPng\nsa.sin6_scope_id = interfaceIndex;\nsa.sin6_addr = in6addr_any;\n</code></pre></li>\n<li><p>Binding socket with <code>bind(sock, (struct sockaddr*)&amp;sa, sizeof(sa))</code></p></li>\n<li><p>Sending with <code>sendto(sock, packet,sizeof(packet) 0, (struct sockaddr*)&amp;sa, sizeof(sa))</code></p></li>\n</ul>\n\n<p>After this, I am trying to listen using wireshark, but no packet of same protocol name is detected.</p>\n\n<p>Where am I doing mistake?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542232043, "post_id": 53309165, "comment_id": 93499198, "body": "Opinion based questions are explicitly off topic. Please see <a href=\"https://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1542232167, "post_id": 53309165, "comment_id": 93499246, "body": "It&#39;s &quot;obvious&quot; if you&#39;re coming from Java, where <code>final</code> is used to declare constants."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 3, "creation_date": 1542232205, "post_id": 53309165, "comment_id": 93499263, "body": "This is a question to ask your instructors and your classmates, not for StackOverflow. Personally, I would say the test question is silly if it doesn&#39;t tell you the original intent and the expected behavior. It amounts to reading the mind of somebody who can&#39;t program correctly, and I would deny that there&#39;s a single correct answer"}, {"owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1542232253, "post_id": 53309165, "comment_id": 93499288, "body": "@melpomene Exactly, but assuming that none of us have ever learned java, final is just a random set of characters in front of the double that will cause it not to compile. It&#39;s ridiculous to assume we should know that."}, {"owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1542232286, "post_id": 53309165, "comment_id": 93499298, "body": "@alterigel I did ask my teacher and my classmates, I was seeing what the online opinion had to offer."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1542232363, "post_id": 53309165, "comment_id": 93499331, "body": "I mean, at this point, you could have just <code>std::cout &lt;&lt; &quot;x = 54.3&quot;</code>. Edit : The fact that the question asks for &quot;<b>The</b> correct/acceptable code&quot; tries to imply that there is only one way to write correct and acceptable code to achieve the goal, which is entirely incorrect."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1542232373, "post_id": 53309165, "comment_id": 93499334, "body": "Syntax error suggests to me that you should fix the syntax, and the way to do this would be exactly what you did which is to remove the offending code which happens to be that <code>final</code> keyword"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 1, "creation_date": 1542232396, "post_id": 53309165, "comment_id": 93499348, "body": "a program without syntax errors and a correct program are two different and unrelated things. Removing syntax errors is easy. Writing a correct program requires you to know what a program is intended to do, and is harder."}, {"owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542232469, "post_id": 53309165, "comment_id": 93499382, "body": "@Fran&#231;oisAndrieux I agree with you there. Regardless of &quot;Best practice&quot; it is a correct answer and deserving of full credit. Not to mention you don&#39;t always want your variables as const&#39;s, so this could have just as easily BEEN the best practice. There&#39;s not enough code to go off of to decide."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542232554, "post_id": 53309165, "comment_id": 93499426, "body": "@austintice Best practices for c++ almost unanimously include const correctness. In this case (<i>assuming the code shown is the entire body of the function</i>) <code>const</code> is warranted."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 1, "creation_date": 1542232563, "post_id": 53309165, "comment_id": 93499436, "body": "@austintice &quot;full credit&quot; is decided by your instructor and their grading rubrik. We on StackOverflow can&#39;t change that, nor can we ask your instructor to reconsider their grading. But you can :-)"}, {"owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542232684, "post_id": 53309165, "comment_id": 93499499, "body": "@Fran&#231;oisAndrieux I understand your point; however, you&#39;re so focused on the fact that this MUST be a constant, but disregarding that &quot;double x&quot;, like you said, is a correct answer. It&#39;s impossible to know what exactly what the code is &quot;supposed to do&quot; when there&#39;s only 3 lines, but I know for sure that both ways are &quot;acceptable code&quot;."}, {"owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "reply_to_user": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1542232790, "post_id": 53309165, "comment_id": 93499542, "body": "Also, @alterigel I understand where full credit is due, and am not asking you for that lol. Just seeking sanity on this very poorly written question."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542232810, "post_id": 53309165, "comment_id": 93499549, "body": "In my eyes it&#39;s an unreasonable exam question, with an unreasonable correct answer.  It only requires you to correct syntax errors.  It then prompts you to provide &quot;acceptable&quot; code, which is pretty subjective.  The expected answer requires knowledge of Java.  It also is not clear whether the <code>std</code> namespace has been imported or not, or correct headers, or a <code>main</code>...  so it&#39;s not even a MCVE.  It calls itself a &quot;program&quot;, despite being only a code snippet without context."}, {"owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542232903, "post_id": 53309165, "comment_id": 93499586, "body": "@paddy I couldn&#39;t agree more. There&#39;s so much nuance in this question and so much is left to chance."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542236287, "post_id": 53309165, "comment_id": 93500771, "body": "the question is as silly as asking to continue the sequence <code>3 5 7 ...</code>. Anybody who claims that there is a unique solution is an idiot (in the literal meaning of the word). Try to convey this to your teacher or just get over it, your choice ;)"}], "answers": [{"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1542232158, "post_id": 53309216, "comment_id": 93499242, "body": "First, <code>const</code> correctness is always desirable. It&#39;s not something that should be recommended <i>just for this class</i>. Second, we don&#39;t know that every declaration should be initialized, just that in this case it was meant to be <code>const</code> so necessitated an initializer. Third, opinion based questions should not be answers as they are off topic."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542232338, "post_id": 53309216, "comment_id": 93499319, "body": "Agreed on first and last point, but could&#39;nt resist answering anyway. And I mentionned those being good principles in general...."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542237053, "post_id": 53309216, "comment_id": 93501037, "body": "downvoted for sloppyness. There are good reasons to declare something that needs not be modified as <code>const</code> or to prefer initializing always. Imho &quot;being ahead of the class&quot; is not one of them. Following principles without knowing why leads to cargo cult programming."}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": -2, "last_activity_date": 1542232090, "creation_date": 1542232090, "answer_id": 53309216, "question_id": 53309165, "link": "https://stackoverflow.com/questions/53309165/declaring-a-variable-without-const-vs-with-const-test-question/53309216#53309216", "title": "Declaring a variable without const vs with const - Test Question", "body": "<p>You learned something. Your professor is nitpicky about RAII and const correctness. </p>\n\n<p>You now know that, moving forward, in this class, any variable that is not modified (even if it could be later after a refactor) has to be const. Put everything const, always and remove const when needed. </p>\n\n<p>You also know that you should never, for this class, have a declaration without an initialization.</p>\n\n<p>Follow those principles and you'll be ahead of the class in the final exam. Those are good principles. Maybe the professor is a bit heavy handed in their applications. But hey, you're not going to change him/her.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1542232686, "creation_date": 1542232686, "answer_id": 53309346, "question_id": 53309165, "link": "https://stackoverflow.com/questions/53309165/declaring-a-variable-without-const-vs-with-const-test-question/53309346#53309346", "title": "Declaring a variable without const vs with const - Test Question", "body": "<p>\"final\" marks virtual member functions such that they must not be overridden in subclasses, but it is not legal for variables or data members. Hence, the main syntax error I see is the illegal use of <code>final</code> together with the variable;</p>\n\n<p>The program has a syntax error, and one can just guess what the writer of the program really intended. And - as it is guessing - I'd say each valid guess that you can argue should be accepted.</p>\n"}], "owner": {"reputation": 27, "user_id": 7631546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce133fef40749268aeadb00e5dba4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "rooted", "link": "https://stackoverflow.com/users/7631546/rooted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1542232676, "answer_count": 2, "score": -7, "last_activity_date": 1542233091, "creation_date": 1542231816, "last_edit_date": 1542233091, "question_id": 53309165, "link": "https://stackoverflow.com/questions/53309165/declaring-a-variable-without-const-vs-with-const-test-question", "closed_reason": "Opinion-based", "title": "Declaring a variable without const vs with const - Test Question", "body": "<p>FYI: This is merely an opinionated question I am looking to find others opinion on.</p>\n\n<p>This was an <a href=\"https://i.stack.imgur.com/lew5K.png\" rel=\"nofollow noreferrer\">answer</a> to one of my Exams in my Computer Science class. Just so you know this was our first test and and the language used in the class is explicitly C++. If you click on the link to the image above you will see the question telling me that there are syntax errors, and that I am to write the acceptable code to make it work. The answer I put for the question was \"double x;\". Apparently this was incorrect, and I was supposed to \"assume that final meant I needed to put const there\". Now, truly, I understand my teachers logic in the fact that const does work, but there's nothing in the question stating anything regarding constants or to make the variable a constant. Regardless, both answers should be acceptable. </p>\n\n<p>The purpose of me writing this was to find a sense of, \"Am i just wrong?\", or do you guys agree that obviously this should be correct?</p>\n\n<p>Btw, in case you're wondering, this was not in a section where the instructions meant constants, or any mention of the word constant on the whole test. This was merely supposed to be intuition of some sort. </p>\n"}, {"tags": ["c++", "multithreading", "algorithm", "openmp", "selection-sort"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1542233326, "post_id": 53309157, "comment_id": 93499743, "body": "You&#39;d normally want to use a <code>reduction</code> clause with your <code>omp parallel</code> but that doesn&#39;t work for finding the index of the smallest element."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542234850, "post_id": 53309157, "comment_id": 93500319, "body": "Been a while since I used OMP, but I&#39;m pretty sure you should use <code>#pragma omp parallel for</code>, not <code>#pragma omp parallel</code>.  But also, the fact that you&#39;re doing this on an inner loop means excessive thread joins.  Not to mention the inherent issues with <code>min_index</code>."}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 5988212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e1c4c2a60541aa193f3d377d867fa8?s=128&d=identicon&r=PG&f=1", "display_name": "jdrd", "link": "https://stackoverflow.com/users/5988212/jdrd"}, "is_accepted": false, "score": 0, "last_activity_date": 1542233920, "last_edit_date": 1542233920, "creation_date": 1542233109, "answer_id": 53309420, "question_id": 53309157, "link": "https://stackoverflow.com/questions/53309157/increasing-threads-count-but-program-doesnt-work-faster-c-openmp-selection-s/53309420#53309420", "title": "Increasing threads count, but program doesn&#39;t work faster C++ OpenMP Selection Sort", "body": "<p>First, think about the selection sort algorithm. What it does is repeatedly scan a (sub)array to find the smallest element, the moves it to the front. This process is fundamentally iterative, ie. you must scan from 0 to n before you scan from 1 to n. In your case, even though you have multiple threads, you still must scan linearly from the start position to the end position, in order, hence your additional threads don't help.</p>\n\n<p>Because the algorithm is not parallelizable, adding additional threads don't help. In fact, it slows the process down because the new threads must be initialized.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7304094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e72a8172d54bc2d0180ab8278327943?s=128&d=identicon&r=PG&f=1", "display_name": "Ramade", "link": "https://stackoverflow.com/users/7304094/ramade"}, "is_accepted": false, "score": 0, "last_activity_date": 1542237922, "creation_date": 1542237922, "answer_id": 53310279, "question_id": 53309157, "link": "https://stackoverflow.com/questions/53309157/increasing-threads-count-but-program-doesnt-work-faster-c-openmp-selection-s/53310279#53310279", "title": "Increasing threads count, but program doesn&#39;t work faster C++ OpenMP Selection Sort", "body": "<p>Selection sort is really hard to parallelize but you assumed right that you can parallelize part where you need to find the smallest element in the rest of the array. </p>\n\n<p><code>#pragma omp parallel\n        for (int j = i + 1; j &lt; n; j++)\n            if (temp[j] &lt; temp[min_index])\n                min_index = j;</code><br>\nThe first problem I see is that you use plain omp parallel. This command starts this same section of code for every available thread (for num_th threads). This will definitely not give you any speed improvement and can cause that min_index can contain an index of value that is not minimal due to the fact that multiple threads can access the same variable concurrently meaning that they do not know if another thread that will overwrite variable right after has an index of smaller value or not.</p>\n\n<p>You can repair this by using<code>#pragma omp parallel for</code> which divides interval [i+1, n) into <code>num_thr</code> parts. But concurrent access to the variable is a little bit trickier. In this case, the best solution would be to use omp reduction but like you said you cannot use it. Then there are also other options like using <a href=\"https://www.ibm.com/support/knowledgecenter/SSGH2K_13.1.2/com.ibm.xlc1312.aix.doc/compiler_ref/prag_omp_atomic.html\" rel=\"nofollow noreferrer\">atomic variable</a>, <a href=\"https://msdn.microsoft.com/en-us/library/b38674ky.aspx\" rel=\"nofollow noreferrer\">critical section</a> (which will definitely not help you) or <a href=\"https://en.cppreference.com/w/cpp/atomic/atomic_compare_exchange\" rel=\"nofollow noreferrer\">compare and swap method</a>, but I doubt that these will give you any significant improvement of speed for your algorithm.</p>\n\n<p>I would suggest you use some more 'parallelization friendly' sorting algorithm like merge sort or quick sort.                            </p>\n"}, {"tags": [], "owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "is_accepted": false, "score": 0, "last_activity_date": 1542273469, "creation_date": 1542273469, "answer_id": 53316015, "question_id": 53309157, "link": "https://stackoverflow.com/questions/53309157/increasing-threads-count-but-program-doesnt-work-faster-c-openmp-selection-s/53316015#53316015", "title": "Increasing threads count, but program doesn&#39;t work faster C++ OpenMP Selection Sort", "body": "<p>Expanding on the answer from @Ramade:\nThe problematic piece of code is:</p>\n\n<pre><code>    for (int i = 0; i &lt; n - 1; i++)\n    {\n        int min_index = i;\n#pragma omp parallel                                                    // start OpenMP parallel code block\n        for (int j = i + 1; j &lt; n; j++)\n            if (temp[j] &lt; temp[min_index])\n                min_index = j;\n        std::swap(temp[i], temp[min_index]);                            // std swap method\n    }\n</code></pre>\n\n<p>What you need is :</p>\n\n<ul>\n<li><p>a <code>#pragma omp for</code> to actually distribute the inner loop</p></li>\n<li><p>some reduction scheme to avoid having each thread accessing shared variable [min_index]</p></li>\n<li><p>and preferably, avoid spawning new threads at each iteration of the outermost loop to reduce openmp overhead</p></li>\n</ul>\n\n<p>For instance :</p>\n\n<pre><code>omp_set_num_threads(num_th);                                        // set threads number\n\n// Spawn all threads once\nint min_index_all=0;\nint min_value_all=INT_MAX;\n#pragma omp parallel shared(temp,min_index_all,min_value_all)\n{\n    //these are private variables\n    int min_index,min_value;\n\n    for (int i = 0; i &lt; n - 1; i++)\n        min_index = i;\n        min_value = temp[min_index];\n\n        // OpenMP distributed loop\n        // nowait because once the loop is complete the thread can do the reduction part immediately\n        // static schedule because we don't expect a large unbalance of workload between threads\n        #pragma omp parallel schedule(static) nowait\n        for (int j = i + 1; j &lt; n; j++)\n            if (temp[j] &lt; temp[min_index]){\n                min_index = j;\n                min_value = temp[min_index];\n            }\n\n        // reduction part in a critical section\n        #pragma omp critical\n        {\n            if (min_value&lt;min_value_all){\n                min_index_all = min_index;\n                min_value_all = min_value;\n            }\n        }\n\n        // explicit barrier: wait for all threads to have finished the reduction\n        #pragma omp barrier\n\n        // swap done by a single thread\n        // + initialization of shared variables for next iteration\n        #pragma omp single\n        {\n            std::swap(temp[i], temp[min_index]);                            // std swap method\n            min_index_all = i+1;\n            min_value_all = INT_MAX;\n        }\n\n        // implicit barrier after omp single\n        // all threads will wait there until the single section is done\n        // then they will move together to next iteration of the outer loop\n    }// end for i loop\n}\n</code></pre>\n\n<p>Still, the loop that you are attempting to parallelize is very simple and likely to run very efficiently on a single thread up to large values of <code>n</code> (for which selection sort would not be an efficient algorithm). OpenMP parallelization brings some overhead and will be a liability if there are only few iterations of the inner loop.</p>\n\n<p>You may need to split the outer loop so that a parallel code is used if there are many iteration of the inner loop, and a serial one if there are only few iterations.</p>\n\n<pre><code>#define SOME_VALUE 20000 // To be tweaked \nint i;\nfor (i = 0; i &lt; n - 1 - SOME_VALUE; i++){\n  //parallel version of the code\n}\n\ni = (n - 1 - SOME_VALUE &lt; 0) ? 0 : n-1-SOME_VALUE;\nfor (; i &lt; n - 1; i++){\n  // finish with a serial version of the code\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10654426, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DdeT6T3Jhw8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jc4wZYtIyQTVBPL4AWn8SXL5B3VQ/mo/photo.jpg?sz=128", "display_name": "Edvin", "link": "https://stackoverflow.com/users/10654426/edvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1542273469, "creation_date": 1542231785, "last_edit_date": 1542235618, "question_id": 53309157, "link": "https://stackoverflow.com/questions/53309157/increasing-threads-count-but-program-doesnt-work-faster-c-openmp-selection-s", "title": "Increasing threads count, but program doesn&#39;t work faster C++ OpenMP Selection Sort", "body": "<p>I'm trying to write Selection Sort algorithm using C++ OpenMP. I wrote the code, it sorts, but as I increase the number of threads, the run time of SelectionSort algorithm increases also... I just started using OpenMP, so I'm not really good at it :D I can't use OpenMP <code>reduction</code>, because I'm using VisualStudio Community 2017 IDE.. Thanks for help ;)  </p>\n\n<pre><code>#include \"pch.h\"\n#include &lt;iostream&gt;\n#include &lt;omp.h&gt;\n#include &lt;random&gt;\n#include &lt;ctime&gt;\n#include &lt;iomanip&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nconst int n = 10000;                            // count of numbers in vector\n\n// ------------------- FUNCTIONS HEADERS -----------------------\nvector&lt;int&gt; FillVector();\nvector&lt;int&gt; SelectionSort(vector&lt;int&gt; data, int num_th);\nvoid PrintArray(vector&lt;int&gt; data);\n\nint main()\n{\n    std::vector&lt;int&gt; test_1(n);\n    std::vector&lt;int&gt; test_2(n);\n    std::vector&lt;int&gt; test_3(n);\n    std::vector&lt;int&gt; test_4(n);\n\n    cout &lt;&lt; test_1.size() &lt;&lt; endl;          // size of vector\n\n    test_1 = FillVector();\n\n    std::copy(std::begin(test_1), std::end(test_1), std::begin(test_2));    // copy vector test_1 to test_2\n    std::copy(std::begin(test_1), std::end(test_1), std::begin(test_3));    // copy vector test_1 to test_3\n    std::copy(std::begin(test_1), std::end(test_1), std::begin(test_4));    // copy vector test_1 to test_4\n\n    // Testing times of sorting with different threads count\n\n\n    // Number of Threads: 2\n    int num_th = 2;\n    clock_t begin = clock();\n    test_1 = SelectionSort(test_1, num_th);     // sort vector test_1\n    clock_t end = clock();\n    double elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;\n    cout &lt;&lt; elapsed_secs &lt;&lt; endl;\n\n    // Number of Threads: 4\n    num_th = 4;\n    begin = clock();\n    test_2 = SelectionSort(test_2, num_th);     // sort vector test_2\n    end = clock();\n    elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;\n    cout &lt;&lt; elapsed_secs &lt;&lt; endl;\n\n    // Number of Threads: 8\n    num_th = 8;\n    begin = clock();\n    test_3 = SelectionSort(test_3, num_th);     // sort vector test_3\n    end = clock();\n    elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;\n    cout &lt;&lt; elapsed_secs &lt;&lt; endl;\n\n    // Number of Threads: 16\n    num_th = 16;\n    begin = clock();\n    test_4 = SelectionSort(test_4, num_th);     // sort vector test_4\n    end = clock();\n    elapsed_secs = double(end - begin) / CLOCKS_PER_SEC;\n    cout &lt;&lt; elapsed_secs &lt;&lt; endl;\n\n    return 0;\n}\n\n// ----------------- METHODS --------------------------------\n\n// Fill vector with random integers\nvector&lt;int&gt; FillVector() {\n    vector&lt;int&gt; temp(n);\n\n    srand(time(NULL));\n    for (int i = 0; i &lt; n; i++)\n        temp[i] = rand() % n + 1;\n\n    return temp;\n}\n\n// EXECUTE parallel Selection Sort usin OpenMP\nvector&lt;int&gt; SelectionSort(vector&lt;int&gt; data, int num_th)\n{\n    // start parallel method (OpenMP)\n    //VEIKIA !!!!!!\n    vector&lt;int&gt; temp(n);\n    std::copy(std::begin(data), std::end(data), std::begin(temp));      // make a temporary copy of array\n\n    omp_set_num_threads(num_th);                                        // set threads number\n    for (int i = 0; i &lt; n - 1; i++)\n    {\n        int min_index = i;\n#pragma omp parallel                                                    // start OpenMP parallel code block\n        for (int j = i + 1; j &lt; n; j++)\n            if (temp[j] &lt; temp[min_index])\n                min_index = j;\n        std::swap(temp[i], temp[min_index]);                            // std swap method\n    }\n\n    return temp;\n}\n\n// PRINT vector as 2D array\nvoid PrintArray(vector&lt;int&gt; data)\n{\n    int rows, elem = 20;                                                // declare rows variable and column count\n\n    if (n % elem != 0)                                                  // calculate rows count\n        rows = n / elem + 1;\n    else\n        rows = n / elem;\n\n    int iii = 0;\n    for (int i = 0; i &lt; rows; i++) {\n        for (int j = 0; j &lt; elem; j++) {\n            if (iii != n) {\n                cout &lt;&lt; setw(3) &lt;&lt; left &lt;&lt; data[iii] &lt;&lt; \" \";\n                iii++;\n            }\n            else\n                break;\n        }\n        cout &lt;&lt; endl;\n    }\n    cout &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Result (when n = 5000):</p>\n\n<p>size: 5000<br>\nthreads 2:  5.607<br>\nthreads 4:  8.421<br>\nthreads 8:  10.979<br>\nthreads 16: 27.989</p>\n\n<p><a href=\"https://i.stack.imgur.com/3TvqN.png\" rel=\"nofollow noreferrer\">OPEN image</a></p>\n"}, {"tags": ["c++", "class", "crash", "access-violation", "widestring"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1542231142, "post_id": 53308995, "comment_id": 93498800, "body": "Go through with a debugger and see where the error is occuring."}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1542231266, "post_id": 53308995, "comment_id": 93498863, "body": "we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to help"}, {"owner": {"reputation": 55, "user_id": 10654165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KfyMk.jpg?s=128&g=1", "display_name": "OptoCloud", "link": "https://stackoverflow.com/users/10654165/optocloud"}, "edited": false, "score": 0, "creation_date": 1542231377, "post_id": 53308995, "comment_id": 93498914, "body": "Debugging has been done and i didnt get any useful info from it."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1542231622, "post_id": 53308995, "comment_id": 93499023, "body": "<code>Create_Player</code> class has <code>playername</code> string but ctor uses <code>avatarname</code>. Is that right?  Maybe try to eliminate as many global vars as you can."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542233860, "post_id": 53308995, "comment_id": 93499940, "body": "<i>Debugging has been done and i didnt get any useful info from it.</i> then you&#39;re dong it wrong. Build a list of expectations. Step through the code line by line. When the program does something you do not expect, either the program is wrong or your expectations are. Either one needs to be corrected before you continue."}, {"owner": {"reputation": 55, "user_id": 10654165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KfyMk.jpg?s=128&g=1", "display_name": "OptoCloud", "link": "https://stackoverflow.com/users/10654165/optocloud"}, "edited": false, "score": 0, "creation_date": 1542233995, "post_id": 53308995, "comment_id": 93499990, "body": "I simplified it :)    Sorry, im used to debugging with Qt-creator, not visual studio. I will see what i can do."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1542234771, "post_id": 53308995, "comment_id": 93500285, "body": "At a minimum, you should know which bit of code was the one that generated the violation. You could figure that out even without a debugger by adding logging."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1542235868, "post_id": 53308995, "comment_id": 93500644, "body": "@OptoCloud <code>std::wstring Object_string = 0;</code> -- What is this supposed to do?  A <code>std::wstring</code> cannot be 0 --you are not dealing with character pointers, so it makes no sense setting <code>std::wstring</code> to 0.  That has all the earmarks of undefined behavior.  Get rid of that <code>= 0;</code> and see if your problem magically disappears."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1542236586, "post_id": 53308995, "comment_id": 93500875, "body": "@OptoCloud <a href=\"http://coliru.stacked-crooked.com/a/04fa59f7f6128864\" rel=\"nofollow noreferrer\">Please look here</a>.  The issue is exactly what I pointed out.  There is no such thing as a string being 0.  Or at least, that is one of multiple issues -- but you see that the code is a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, something you should have provided up front."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542237863, "post_id": 53308995, "comment_id": 93501286, "body": "<i>im used to debugging with Qt-creator, not visual studio</i> Visual Studio has, by far, the best debugger I have ever encountered.  I can&#39;t recommend strongly enough that you learn how to use it if you plan to develop in Visual Studio."}, {"owner": {"reputation": 55, "user_id": 10654165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KfyMk.jpg?s=128&g=1", "display_name": "OptoCloud", "link": "https://stackoverflow.com/users/10654165/optocloud"}, "edited": false, "score": 0, "creation_date": 1542240171, "post_id": 53308995, "comment_id": 93501960, "body": "Now it just seems to stop in front of: while (std::getline(file, line)) And it stays there"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542238601, "post_id": 53310362, "comment_id": 93501528, "body": "Note that the same horror will happen with any <code>std::basic_string</code>"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542238639, "post_id": 53310362, "comment_id": 93501536, "body": "Yes, you&#39;re right.  Any <code>basic_string</code> will go haywire."}, {"owner": {"reputation": 55, "user_id": 10654165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KfyMk.jpg?s=128&g=1", "display_name": "OptoCloud", "link": "https://stackoverflow.com/users/10654165/optocloud"}, "edited": false, "score": 0, "creation_date": 1542241131, "post_id": 53310362, "comment_id": 93502197, "body": "I will see if that fixes it when i get the rest of the code fixed again, Thanks"}], "tags": [], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1542239153, "last_edit_date": 1542239153, "creation_date": 1542238549, "answer_id": 53310362, "question_id": 53308995, "link": "https://stackoverflow.com/questions/53308995/access-violation-when-trying-to-create-class-with-wide-string/53310362#53310362", "title": "Access Violation when trying to create class with wide string", "body": "<p>The issue with the code is that the <code>std::wstring</code> member is being constructed with the value of 0 here in your <code>Create_Object</code> class:</p>\n\n<pre><code>std::wstring Object_string = 0;\n</code></pre>\n\n<p>Constructing a <code>std::basic_string</code> (which <code>std::wstring</code> is based on) with 0 is undefined behavior.  What occurs is that the 0 is implicitly converted to a character pointer, thus this constructor will be invoked:</p>\n\n<p><code>std::wstring(const wchar_t* p)</code> </p>\n\n<p>See <a href=\"https://en.cppreference.com/w/cpp/string/basic_string/basic_string\" rel=\"nofollow noreferrer\">constructor (5) here for std::basic_string</a>.</p>\n\n<p>This constructor assumes the passed-in pointer is not null, and is pointing to a null-terminated string.  Since a null pointer will be accessed, you get the access violation error.</p>\n\n<p>The fix to this is just get rid of that initialization:</p>\n\n<pre><code>std::wstring Object_string;\n</code></pre>\n\n<p>To further demonstrate the error here is a <a href=\"http://coliru.stacked-crooked.com/a/04fa59f7f6128864\" rel=\"nofollow noreferrer\">small example showing the issue</a>.\nRemoving the initialization <a href=\"http://coliru.stacked-crooked.com/a/13eae1562b1c94c6\" rel=\"nofollow noreferrer\">fixes the issue</a>.</p>\n"}], "owner": {"reputation": 55, "user_id": 10654165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KfyMk.jpg?s=128&g=1", "display_name": "OptoCloud", "link": "https://stackoverflow.com/users/10654165/optocloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 53310362, "answer_count": 1, "score": 1, "last_activity_date": 1598916401, "creation_date": 1542230948, "last_edit_date": 1598916401, "question_id": 53308995, "link": "https://stackoverflow.com/questions/53308995/access-violation-when-trying-to-create-class-with-wide-string", "title": "Access Violation when trying to create class with wide string", "body": "<p>Im making a code which is supposed to read a debug log, parse the log, and activate a google text-to-speech which will give info about the game that spits it out.</p>\n<p>The log has UTF-8 encoding, so im using wide strings in the code, the code compiles, and parses strings just fine until i try to create a class object.</p>\n<p>Then i get a Access Violation:</p>\n<pre><code>'CMakeProject1.exe' (Win32): Loaded 'C:\\Users\\OptoCloud\\CMakeBuilds\\e36ef523-902d-0932-93cd-2201bbe1e731\\build\\x64-Release\\CMakeProject1\\CMakeProject1.exe'. Symbols loaded.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Windows\\System32\\ntdll.dll'. Cannot find or open the PDB file.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Windows\\System32\\kernel32.dll'. Cannot find or open the PDB file.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Program Files\\AVAST Software\\Avast\\x64\\aswhooka.dll'. Cannot find or open the PDB file.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Windows\\System32\\KernelBase.dll'. Cannot find or open the PDB file.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Windows\\System32\\ucrtbase.dll'. Cannot find or open the PDB file.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Windows\\System32\\msvcp140.dll'. Cannot find or open the PDB file.\n'CMakeProject1.exe' (Win32): Loaded 'C:\\Windows\\System32\\vcruntime140.dll'. Cannot find or open the PDB file.\nThe thread 0x4174 has exited with code 0 (0x0).\nException thrown at 0x00007FF7FBDA92B3 in CMakeProject1.exe: 0xC0000005: Access violation reading location 0x0000000000000000.\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/zagdI.png\" rel=\"nofollow noreferrer\">Varibale Values right before crash</a></p>\n<pre><code>#include &lt;string&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\n#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;windows.h&gt;\n#include &lt;cstdlib&gt;\n#include &lt;vector&gt;\n#include &lt;map&gt;\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;locale&gt;\n#include &lt;codecvt&gt;\n\nstd::wstring line;\nstd::wstring passed_string;\nstd::string path = &quot;c:\\\\Users\\\\OptoCloud\\\\AppData\\\\LocalLow\\\\Game\\\\output_log.txt&quot;;\n\nstd::wifstream file(path, std::ios::binary);\n\nclass Create_Object\n{\npublic:\n    Create_Object();\n    Create_Object(std::wstring passed_string);\n    std::wstring Object_string = 0;\n};\nCreate_Object::Create_Object() {}\nCreate_Object::Create_Object(std::wstring passed_string)\n{\n    Object_string.reserve(passed_string.length());\n    Object_string = passed_string;\n}\n\nstd::map&lt;std::wstring, Create_Object&gt; objectlist;\n\nint main()\n{\n    while (true)\n    {\n        file.open(path.data());\n        if (file.is_open())\n        {\n            while (std::getline(file, line))\n            {\n                if (line.find(L&quot;DELIMITER1&quot;) != std::string::npos)\n                {\n                    passed_string = line.substr(line.find(L&quot;DELIMITER1&quot;), line.find(L&quot;DELIMITER2&quot;));\n                    objectlist[passed_string] = Create_Object(passed_string); ///////////////////////POINT OF CRASH////////////////////////////////\n                }\n                file.close();\n                break;\n            }\n        }\n    }\n    return 1;\n}\n</code></pre>\n<p>(EDITED)</p>\n"}, {"tags": ["c++", "memory", "stack", "pthreads", "heap"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542230749, "post_id": 53308921, "comment_id": 93498663, "body": "Have you calculated how many possible combinations your result would have? It seems likely that you are actually running out of memory."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1542230957, "post_id": 53308921, "comment_id": 93498739, "body": "What is your purpose in generating these sequences?"}, {"owner": {"reputation": 32072, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1542230965, "post_id": 53308921, "comment_id": 93498742, "body": "string of 8 symbols with 16 symbol values would produce 16 ^ 8 combinations. Hoping that small string optimization takes place you will need a buffer at least of 16 ^ 8 * 24 = 103079215104 bytes \u2248 100 Gb"}, {"owner": {"reputation": 5, "user_id": 9963191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM-RAuMcNBY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0d4CUfgtoFTadvqeHoT6H8OzCs1Q/mo/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9963191/richard-s"}, "edited": false, "score": 0, "creation_date": 1542251101, "post_id": 53308921, "comment_id": 93504386, "body": "@NeilButterworth I am trying to adapt this to an assignment I have. I basically have to take all possible combinations of a set of ASCII characters, hash them using some cryptography function (I&#39;m using MD5 which basically converts any string into a 32 character string) and then see if any of these hashed combinations matches the hash of a string I chose. I have to accomplish this using pthreads so my approach is to create pthreads for each element in my set of characters to parallelize producing the combinations and hashing. Clearly it is not efficient and memory is an issue"}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1542264775, "post_id": 53308921, "comment_id": 93507985, "body": "Right now you seem to be brute forcing the assignment. Is it possible to devise a different approach?"}, {"owner": {"reputation": 5, "user_id": 9963191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM-RAuMcNBY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0d4CUfgtoFTadvqeHoT6H8OzCs1Q/mo/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9963191/richard-s"}, "reply_to_user": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1542284282, "post_id": 53308921, "comment_id": 93518552, "body": "@TrebuchetMS I\u2019m supposed to brute force. I believe the proper approach is to divide the total number of combinations into equal number of threads. This is the best way to evenly distribute the workload. However, I still don\u2019t see how this is good when (using my recursive function to compute combinations) one thread is producing a combination of length 3 and another is doing a length 8"}], "owner": {"reputation": 5, "user_id": 9963191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fM-RAuMcNBY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0d4CUfgtoFTadvqeHoT6H8OzCs1Q/mo/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9963191/richard-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542230572, "creation_date": 1542230572, "question_id": 53308921, "link": "https://stackoverflow.com/questions/53308921/bad-alloc-when-recursively-producing-combinations-and-storing-to-vector", "title": "bad_alloc() when recursively producing combinations and storing to vector", "body": "<p><strong>Overview</strong>:\nI am trying to produce combinations from a set of characters, with a specific starting character, where each combination is of a certain length within a range. For example if my set of characters is {A,B,C,D} and starting prefix 'A' then my combinations for lengths 1 through 3 are: A, AA, AB, AC, AD, AAA, AAB, AAC, AAD,....,ADD.</p>\n\n<p><strong>Problem</strong>: I produce each combination recursively. The problem is when I try to store combinations to a vector for a larger set of characters for range of lengths 1 through 8 (which I obviously understand are many combinations) I get a bad_alloc core dumped error. My understanding is that this means I ran out of memory (possibly due to my vector being full). I want to try allocating this vector to the heap and keeping it global. Below is my current code before attempting to modify:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;time.h&gt;\nusing namespace std;\n\n#define SIZE_SET 15 // sizeof set below, set of characters to create permutations from\nchar set[] = {'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O'};            \nvoid ProducePerms(vector&lt;string&gt;&amp;, string, const int, const int);\n\nint main(){\n\n    // Timing program run time\n    clock_t t1, t2;\n    t1 = clock();\n\n    cout &lt;&lt; \"Starting time\" &lt;&lt; endl;\n\n    vector&lt;string&gt; perms; // Stores permutations\n    string start_prefix = \"B\"; // All permutations of lengths 1-8 begin with this prefix\n    int length = 8; // Maximum length of permutation\n\n    // Produce lengths 1-8 permutations starting with prefix\n    for(int l = 0; l &lt; length; l++){\n        ProducePerms(perms, start_prefix, SIZE_SET, l);\n    }\n\n    // End run time\n    t2 = clock();\n    cout &lt;&lt; \"\\nTime elapsed: \" &lt;&lt; (t2-t1)/(double)CLOCKS_PER_SEC &lt;&lt; endl &lt;&lt; endl;\n\n    return 0;\n}\n\nvoid ProducePerms(vector&lt;string&gt;&amp; vec, string prefix, const int n, const int length){\n    if(length == 0){\n       vec.push_back(prefix);\n    }\n    else{\n       if(length == 1){\n           for(int j = 0; j &lt; n; j++){\n               vec.push_back(prefix + set[j]);\n            }\n        }\n        else{\n            for(int i = 0; i &lt; n; i++){\n                ProducePerms(vec, prefix + set[i], n, length - 1);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Also if anyone has any suggestions on how I can adapt this to using pthreads that would be helpful. I am currently thinking of creating pthreads to compute combinations for a certain length.</p>\n"}, {"tags": ["c++", "avro"], "owner": {"reputation": 21361, "user_id": 3834415, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pdydZ.png?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3834415/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542230889, "creation_date": 1542230542, "last_edit_date": 1542230889, "question_id": 53308917, "link": "https://stackoverflow.com/questions/53308917/c-avro-how-to-initialize-validschema-with-auto-generated-schema", "title": "C++ Avro: how to initialize ValidSchema with auto generated schema?", "body": "<p>I have an auto generated avro schema which I can encode and decode to avro memory streams. </p>\n\n<p>Now, I would like to write to a file, and I have to some how activate my file writer with the following: </p>\n\n<pre><code>#include \"avro/Encoder.hh\"\n#include \"avro/Decoder.hh\"\n#include \"avro/ValidSchema.hh\"\n#include \"avro/Compiler.hh\"\n#include \"avro/DataFile.hh\n\navro::ValidSchema loadSchema(const char* filename)\n{\n     std::ifstream ifs(filename);\n     avro::ValidSchema result;\n     avro::compileJsonSchema(ifs, result);\n     return result;\n}\n\nint\nmain()\n{\n     avro::ValidSchema cpxSchema = loadSchema(\"cpx.json\");\n\n     {\n         avro::DataFileWriter&lt;c::cpx&gt; dfw(\"test.bin\", cpxSchema);\n         c::cpx c1;\n         for (int i = 0; i &lt; 100; i++) {\n             c1.re = i * 100;\n             c1.im = i + 100;\n             dfw.write(c1);\n         }\n         dfw.close();\n     }\n\n     {\n         avro::DataFileReader&lt;c::cpx&gt; dfr(\"test.bin\", cpxSchema);\n         c::cpx c2;\n         while (dfr.read(c2)) {\n             std::cout &lt;&lt; '(' &lt;&lt; c2.re &lt;&lt; \", \" &lt;&lt; c2.im &lt;&lt; ')' &lt;&lt; std::endl;\n         }\n     }\n     return 0;\n\n}\n</code></pre>\n\n<p>So, I have my auto-generated file in <code>auto_generated.hh</code> (command: <code>avrogencpp -i schema.json -o auto_generated.hh -n auto_generated</code>) and I have included all relevant files therein, and short of loading the schema from my json file (which seems to be beside the point if I have already auto-generated everything), I have tried the following:</p>\n\n<pre><code>#include \"auto_generated.hh\"\n\nint main(){\n\n    /* \n        auto_generated::schema() is going to produce the datum which I am\n        storing. \n\n        auto_generated::schema is the struct which contains the data\n        members which will be set during the course of data output.\n\n    */ \n\n\n    //avro::ValidSchema vs; vs.setSchema(auto_generated::schema);\n\n    // auto_generated::schema schema = auto_generated::schema();\n    // avro::ValidSchema vs(schema);\n\n    // avro::ValidSchema vs;\n    // auto_generated::schema schema = auto_generated::schema();\n    // vs.setSchema(schema);\n\n    avro::ValidSchema vs;\n    avro::Schema s = auto_generated::schema(); // or without ()\n    vs.setSchema(s);\n\n    // etc.\n\n    avro::DataFileWriter&lt;auto_generated::schema&gt; dfw(\"foo\",vs);\n}\n</code></pre>\n\n<p>How do I initialize the <code>ValidSchema</code> and construct the <code>DataFileWriter</code> so as to write my data to a file?</p>\n"}, {"tags": ["c++", "vector", "fstream"], "comments": [{"owner": {"reputation": 64505, "user_id": 413337, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/783783f968e84cf5047544e9a0f3ccf4?s=128&d=identicon&r=PG", "display_name": "Codo", "link": "https://stackoverflow.com/users/413337/codo"}, "edited": false, "score": 0, "creation_date": 1542230806, "post_id": 53308884, "comment_id": 93498687, "body": "Which line throws the error?"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 3, "creation_date": 1542230953, "post_id": 53308884, "comment_id": 93498736, "body": "You should resize word.word before using <code>at</code> function. Try adding <code>word.word.resize(counter - holder)</code> before your loop."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1542230822, "creation_date": 1542230822, "answer_id": 53308974, "question_id": 53308884, "link": "https://stackoverflow.com/questions/53308884/trying-to-add-words-from-text-file-to-a-vector-but-keep-getting-thrown-stdout/53308974#53308974", "title": "trying to add words from text file to a vector but keep getting thrown &#39;std::out_of_range&#39;", "body": "<p>Your code is way to complicated. To read all words (=space-seperated thingies) into a <code>std::vector&lt;std::string&gt;</code> simply do:</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;iterator&gt;\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n\nint main()\n{\n    char const *filename = \"test.txt\";\n    std::ifstream is{ filename };\n\n    if (!is.is_open()) {\n        std::cerr &lt;&lt; \"Couldn't open \\\"\" &lt;&lt; filename &lt;&lt; \"\\\" for reading :(\\n\\n\";\n        return EXIT_FAILURE;\n    }\n\n    std::vector&lt;std::string&gt; words{ std::istream_iterator&lt;std::string&gt;{ is },\n                                    std::istream_iterator&lt;std::string&gt;{} };\n\n    for (auto const &amp;w : words)\n        std::cout &lt;&lt; w &lt;&lt; '\\n';\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10654385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb5306725921eba3ac8540a00ee2c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "B. Wright", "link": "https://stackoverflow.com/users/10654385/b-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542230858, "creation_date": 1542230360, "last_edit_date": 1542230858, "question_id": 53308884, "link": "https://stackoverflow.com/questions/53308884/trying-to-add-words-from-text-file-to-a-vector-but-keep-getting-thrown-stdout", "title": "trying to add words from text file to a vector but keep getting thrown &#39;std::out_of_range&#39;", "body": "<p>trying to add words from this text file but keep getting thrown an out of range error. I think the error lies somehwere in the loops but havent been able to figure out why it isnt working. Help would be greatly appreciated </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nstruct WordCount{\n    string word;\n    int count;\n};\n\nint main () {\n    vector&lt;WordCount&gt; eggsHam;\n\n    ifstream readFile (\"NewTextDocument.txt\");\n    int counter = 0;\n    int holder;\n    string lineRead;\n    WordCount word;\n\n    if(readFile.is_open()){\n        //add all the words into a vector\n        while (getline(readFile, lineRead)){\n            holder = counter;\n            for(int i = 0; i &lt; lineRead.length(); ++i) {\n                if (lineRead.at(i) != ' ') {\n                    ++counter;\n                }\n                if (lineRead.at(i) != ' ') {\n                    for (int k = 0; k &lt; (counter - holder); ++k) {\n                        word.word.at(k) = lineRead.at(holder + k);\n                    }\n                    eggsHam.push_back(word);\n                    ++counter;\n                }\n            }\n        }\n\n        readFile.close();\n    }\n    else cout &lt;&lt; \"Unable to open file\";\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "winapi", "sendinput"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1542231232, "post_id": 53308670, "comment_id": 93498849, "body": "This question gets asked many times each week. Try searching for all the other times it has been asked."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1542236008, "post_id": 53308670, "comment_id": 93500686, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3644881/simulating-keyboard-with-sendinput-api-in-directinput-applications\">Simulating Keyboard with SendInput API in DirectInput applications</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1542238468, "post_id": 53308670, "comment_id": 93501480, "body": "Games have a simple way to protect themselves against multi-player cheats, they use raw input.  The only way to fool them is to inject keyboard input at the driver level, that is not a technique that the default keyboard driver puts up with.  Replacing it has not been accomplished often."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542232635, "post_id": 53308756, "comment_id": 93499475, "body": "In which case, look at <code>MapVirtualKey&#47;Ex()</code> to get a scan code from a virtual key"}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 2, "last_activity_date": 1542230167, "last_edit_date": 1542230167, "creation_date": 1542229762, "answer_id": 53308756, "question_id": 53308670, "link": "https://stackoverflow.com/questions/53308670/simulate-keyboard-button-press-for-arrow-keys/53308756#53308756", "title": "Simulate Keyboard Button Press for arrow keys", "body": "<p>If the receiving application uses Direct Input you have to send scan codes instead of virtual key codes.</p>\n"}], "owner": {"reputation": 93, "user_id": 10602996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc2861a9c39404c2a7718baf8bb3a6e?s=128&d=identicon&r=PG&f=1", "display_name": "linjoehan", "link": "https://stackoverflow.com/users/10602996/linjoehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1542230332, "creation_date": 1542229397, "last_edit_date": 1542230332, "question_id": 53308670, "link": "https://stackoverflow.com/questions/53308670/simulate-keyboard-button-press-for-arrow-keys", "title": "Simulate Keyboard Button Press for arrow keys", "body": "<p>I've setup 2 functions to simulate keyboard button presses</p>\n\n<pre><code>void KeyboardButtonDown(DWORD a)\n{\n    INPUT Input = { 0 };\n    // Set up a generic keyboard event.\n    Input.type    = INPUT_KEYBOARD;\n    Input.ki.wVk  = a; \n    SendInput(1, &amp;Input, sizeof(INPUT));\n}\n\nvoid KeyboardButtonUp(DWORD a)\n{\n    INPUT Input = { 0 };\n    Input.type        = INPUT_KEYBOARD;\n    Input.ki.dwFlags  = KEYEVENTF_KEYUP;\n    Input.ki.wVk      = a;\n    SendInput(1, &amp;Input, sizeof(INPUT));\n}\n</code></pre>\n\n<p>It works in most cases, however it fails in some apps when simulating arrow keys, as a simple exampe</p>\n\n<pre><code>KeyboardButtonDown(VK_LEFT);\nSleep(50);\nKeyboardButtonUp(VK_LEFT);\nSleep(50);\n</code></pre>\n\n<p>It works in notepad but when playing a game it does nothing. I've mapped the controls in game to use other keys instead and it then works fine.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c++", "arduino"], "comments": [{"owner": {"reputation": 633, "user_id": 375584, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c6bc85aab7418135ca16e23f254146c4?s=128&d=identicon&r=PG", "display_name": "Soch S.", "link": "https://stackoverflow.com/users/375584/soch-s"}, "edited": false, "score": 0, "creation_date": 1542266973, "post_id": 53308521, "comment_id": 93508852, "body": "Why downvote? I fail to see how the research wasn&#39;t sufficient here."}], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 375584, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c6bc85aab7418135ca16e23f254146c4?s=128&d=identicon&r=PG", "display_name": "Soch S.", "link": "https://stackoverflow.com/users/375584/soch-s"}, "edited": false, "score": 0, "creation_date": 1542266923, "post_id": 53308703, "comment_id": 93508827, "body": "Thank you for this, it works. I have to read up on this a lot."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 0, "last_activity_date": 1542229519, "creation_date": 1542229519, "answer_id": 53308703, "question_id": 53308521, "link": "https://stackoverflow.com/questions/53308521/arduino-icon-library/53308703#53308703", "title": "Arduino Icon Library", "body": "<p>If you want the RGB data to reside in PROGMEM, since it is not a native type handled by <code>pgm_read_XXX</code> functions, just read it with <a href=\"http://www.nongnu.org/avr-libc/user-manual/group__avr__pgmspace.html#gad92fa2ebe26e65fa424051047d21a0eb\" rel=\"nofollow noreferrer\"><code>memcpy_P()</code></a>:</p>\n\n<pre><code>RGB currentColor;\nmemcpy_P(&amp;currentColor, colors + currentPixel, sizeof(RGB));\n</code></pre>\n\n<p>If this crashes, then perhaps there is an issue with the value of <code>currentPixel</code> that you read.</p>\n"}], "owner": {"reputation": 633, "user_id": 375584, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c6bc85aab7418135ca16e23f254146c4?s=128&d=identicon&r=PG", "display_name": "Soch S.", "link": "https://stackoverflow.com/users/375584/soch-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 53308703, "answer_count": 1, "score": -1, "last_activity_date": 1542229519, "creation_date": 1542228669, "question_id": 53308521, "link": "https://stackoverflow.com/questions/53308521/arduino-icon-library", "title": "Arduino Icon Library", "body": "<p>I'm working on an Arduino project and I want to display icons on a NeoMatrix 8x8 panel. </p>\n\n<p>Initially, I went in direction that relied on inheritance, and requested some input on <a href=\"https://arduino.stackexchange.com/questions/57638/custom-classes-redefinition-of-void-error\">Arduino Stack Exchange</a> where I was advised to go another route, and to ask my question elsewhere is it pertained more to C++ than to Arduino.</p>\n\n<p>Instead of relying on inheritance, I was recommended to store my icons in PROGMEM and have the program build the icons from there. </p>\n\n<p>I attempted the approach as much as I could, but I'm not at ease so I'd like some further insight!</p>\n\n<ul>\n<li>The idea is to have a byte array that composes an 8x8 icon.</li>\n<li>The values are 0-2, each representing a color set in an RGB struct array.</li>\n</ul>\n\n<p>From what I believe I understand, my byte array stored in PROGMEM is read as a pointer, and needs to be accessed using <em>ppm_read_byte</em>.</p>\n\n<p>I am unsure on how to handle the RGB struct. When I attempt to read it from PROGMEM, it causes my program to crash. So I removed it from PROGMEM, and the icon displays correctly. My byte array is in PROGMEM, but not the colors.</p>\n\n<p><strong>I am aware that I have a serious lack of knowledge about pointers which I need to work on...</strong></p>\n\n<p>Also, the idea is to have a collection of icons, so should I store all my icons (byte arrays and colors) in a header file? Will that not bloat it?</p>\n\n<p>Thank you in advance for insight on this!</p>\n\n<p><strong>header.h</strong></p>\n\n<pre><code>typedef struct {\n  byte r;\n  byte g;\n  byte b;\n} RGB;\n\nconst byte PROGMEM WifiIcon[8][8] = {\n  {1, 1, 1, 1, 1, 1, 1, 1},\n  {1, 1, 2, 2, 2, 2, 1, 1},\n  {1, 2, 1, 1, 1, 1, 2, 1},\n  {2, 1, 2, 2, 2, 2, 1, 2},\n  {1, 2, 1, 1, 1, 1, 2, 1},\n  {1, 1, 1, 2, 2, 1, 1, 1},\n  {1, 1, 2, 1, 1, 2, 1, 1},\n  {0, 0, 0, 1, 1, 0, 0, 0}\n};\n\nconst RGB WifiIconColors[3] = {\n  {0, 0, 0}, \n  {0, 0, 0}, \n  {0, 200, 61}\n};\n</code></pre>\n\n<p><strong>ESP8266Neomatrix.ino</strong></p>\n\n<pre><code>#include \"header.h\"\n\nvoid printIcon(int startPosition, const byte (&amp;icon)[8][8], const RGB (&amp;colors)[3]){  \n  for (int i = 0; i &lt; 8; i++) {\n    for (int j = 0; j &lt; 8; j++) {\n      byte currentPixel = pgm_read_byte(&amp;icon[i][j]);     \n      const RGB currentColor = colors[currentPixel];\n\n      byte red = currentColor.r;\n      byte green = currentColor.g;\n      byte blue = currentColor.b;\n\n      matrix.setPixelColor(startPosition++, red, green, blue);      \n    }\n  }  \n}\n</code></pre>\n\n<p><a href=\"https://gist.github.com/Nate1661/0eea9200e9d1c86187c2acf205ba3602\" rel=\"nofollow noreferrer\">https://gist.github.com/Nate1661/0eea9200e9d1c86187c2acf205ba3602</a></p>\n"}, {"tags": ["c++", "algorithm", "logging"], "comments": [{"owner": {"reputation": 82, "user_id": 9214689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fd016cf1c22386391df7d4c8c70404?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9214689/alex"}, "edited": false, "score": 0, "creation_date": 1542228588, "post_id": 53308248, "comment_id": 93497757, "body": "What is the size of the problem? I.e. give us a rough estimate of how many log messages/sec. Do you want the messages to be unique for the entire log? That could be hard with a large log. One way to restrict problem size would be to process the log in blocks, and only guarantee that a message is unique within its own block."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542229302, "post_id": 53308248, "comment_id": 93498057, "body": "This sounds bad. There is already alot of overhead in logging, why would you want to make it worse by tracking logged messages in the process that logs them? Why would you only want to see that first message? It looks like what you really need is a mainstream logger that provides filtering and/or to reevaluate how and what you are logging. If this is for some real world production project, I&#39;d surely raise an eyebrow. Not enough context is provided to really suggest anything."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1542230209, "post_id": 53308248, "comment_id": 93498429, "body": "Look up compression algorithms.  You are compressing the output (logging) stream."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1542230317, "post_id": 53308248, "comment_id": 93498480, "body": "Do you need to log date or time stamps?"}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "reply_to_user": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542232490, "post_id": 53308248, "comment_id": 93499390, "body": "The problem I would like to solve is the logs can, if the application is in a broken state, fill the logs with repeated sequence of messages. And so troubleshooting becomes impossible because the useful log messages have since been overwritten @ChristopherPisz"}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1542232618, "post_id": 53308248, "comment_id": 93499462, "body": "@ThomasMatthews Yeah we currently log the date and time, I would filter before, but keep the first timestamp occurrence of the message."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542233096, "post_id": 53308248, "comment_id": 93499647, "body": "@RAZ_Muh_Taz Then get your QA guy to come up with the steps to reproduce, identify the repeating messages, and put a filter on them, and then run the scenario. Trying to implement an entire permanent system and add long term overhead, for this one scenario, doesn&#39;t seem wise, imo. At any rate, you&#39;d just hash the whole message or the identifying part, and see if it exists in your hash before writing it out. It would be really expensive."}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1542233383, "post_id": 53308248, "comment_id": 93499768, "body": "@HostileFork the examples are ones where the left hand side is input, and the right hand side is the expected correct output."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1542233434, "post_id": 53308248, "comment_id": 93499789, "body": "Rather than compression, consider using a filter.  Design your system so that you can supply one or more filters.  A configuration file could help specify these filters (similar to Window&#39;s Open File dialog box).  If a logging text matches a filter, output date and time and a simple output, like &quot;removed via filter&quot;."}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1542233783, "post_id": 53308248, "comment_id": 93499906, "body": "Yeah that&#39;s what I am doing, I am going to filter the log messages based on the repeating sequences while the messages are being logged and prevent them from being logged if they are part of the repeating sequence. @ThomasMatthews"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1542234138, "post_id": 53308248, "comment_id": 93500039, "body": "I think I know what algorithm you are using but the way it is being described isn&#39;t clear so the test cases are inconsistent.  If AAABABACBCBCB would be AAABABACBCBCB-&gt;ABABACBCBCB-&gt;ABACBCBCB-&gt;ABACBCB-&gt;ABACB then ABBABBA would be ABBABBA-&gt;ABABBA-&gt;ABBA or it could be ABBABBA-&gt;ABBA but I don&#39;t see how you could get ABABA"}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1542234405, "post_id": 53308248, "comment_id": 93500135, "body": "ABBABBA -&gt; ABABA because it&#39;s not allowed to have a message outputted twice or more in a row @JerryJeremiah"}, {"owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1542234611, "post_id": 53308248, "comment_id": 93500218, "body": "you have to think of the input as a stream which doesn&#39;t stop @JerryJeremiah"}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1542236144, "post_id": 53308248, "comment_id": 93500715, "body": "Sorry, I still don&#39;t get what you&#39;re trying to do here.  You&#39;re trying to eliminate &quot;repeated sequences&quot; but then you&#39;re having a sequence show up more than once in the output (e.g. <code>ABBABBA -&gt; ABABA</code> repeating AB on the right).  If AB can appear twice in the output (and hence isn&#39;t a &quot;repeated sequence&quot; you want removed) then where does this stop?  Why aren&#39;t you considering the whole of <code>ABBABBA</code> a non-repeated sequence--it only happens once!  <i>You need to formally define the problem in very clear terms at the top of your question.</i>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1542236764, "post_id": 53308248, "comment_id": 93500920, "body": "@RAZ_Muh_Taz  if you remove any repeated occurence of single characters before moving to multiple characters then ABBABBA-&gt;ABABA and then ACDACDDDCDC-&gt;ACDACDCDC-&gt;ACDCDC-&gt;ACDC or ACDACDDDCDC-&gt;ACDACDCDC-&gt;ACDACDC-&gt;ACDC"}], "owner": {"reputation": 3954, "user_id": 6754706, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/TZSs8.jpg?s=128&g=1", "display_name": "RAZ_Muh_Taz", "link": "https://stackoverflow.com/users/6754706/raz-muh-taz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542235182, "creation_date": 1542227234, "last_edit_date": 1592644375, "question_id": 53308248, "link": "https://stackoverflow.com/questions/53308248/ignoring-repeated-sets-of-logging", "title": "Ignoring Repeated Sets of Logging", "body": "<p>There is a program that is logging a lot of information, some of which tends to repeat itself in certain situations. I've been tasked with preventing this over-logging and I need some direction as to what to do. Currently I can prevent the same message in a row from repeating, but it becomes a lot more tricky when preventing various sized unique sets of log messages from occurring.</p>\n<p>I tried to first break down the problem into a smaller one by which I am using characters to represent unique log messages.</p>\n<p><strong>Input</strong></p>\n<pre><code>aaaaababababacdefgfggfabcddggddgg\n</code></pre>\n<p><strong>Output</strong></p>\n<pre><code>abacdefgfabcdg\n0 : Hash: 100, Msg: d\n1 : Hash: 103, Msg: g\n</code></pre>\n<p>This is the output for my current program which seems to work for 1-2 unique characters. All the characters displayed in a row represent the messages that are logged and the next two lines show what my current buffer used to compare sequences contains. Therefore if I were to add &quot;xz&quot; to the original input I get the following output</p>\n<pre><code>abacdefgfabcdgdg\n0 : Hash: 120, Msg: x\n1 : Hash: 122, Msg: z\n</code></pre>\n<p>As we can see the <code>d</code>, <code>g</code> get &quot;logged&quot; and the next sequence we don't allow to occur would be 'xz' or 'z' based on what's in the sequence buffer.</p>\n<p><strong>Does anyone know of an actual algorithm that can detect/prevent repeated unique sequences?</strong></p>\n<p>I've looked at <a href=\"https://stackoverflow.com/questions/23574738/algorithm-for-finding-continuous-repeated-sequences\">this</a> but it doesn't quite fit my needs.</p>\n<p>More Examples</p>\n<blockquote>\n<p>Input -&gt; Desired Output</p>\n<ol>\n<li>ABCABCACD -&gt; ABCACD</li>\n<li>AAABABACBCBCB -&gt; ABACB</li>\n<li>ABBABBA -&gt; ABABA</li>\n<li>ACDACDDDCDC -&gt; ACDC</li>\n</ol>\n</blockquote>\n<p>The letters represent unique log messages and I'd like to prevent the repeated sets of log messages from showing up.</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 3, "creation_date": 1542226609, "post_id": 53308084, "comment_id": 93496882, "body": "<i>Why</i> are you certain that your way is wrong?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1542226658, "post_id": 53308084, "comment_id": 93496905, "body": "<i>Using</i> an array is normally not what you want to do, <code>void main()</code> is wrong, but your array definition is perfectly legal C++."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 2, "creation_date": 1542226659, "post_id": 53308084, "comment_id": 93496906, "body": "You array declaration is fine. However, the <code>cin &gt;&gt; K[i];</code> statement will be run <i>only once</i>, with <code>i=L</code>, which will go past the end of the array and cause undefined behavior. Perhaps you meant to wrap the <code>cout</code>/<code>cin</code> statements in braces <code>{}</code> to include them in the body of the <code>for</code>-loop?"}, {"owner": {"reputation": 11, "user_id": 10653241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979219abda2b4ff200227718c4ab4d10?s=128&d=identicon&r=PG&f=1", "display_name": "bashtati", "link": "https://stackoverflow.com/users/10653241/bashtati"}, "edited": false, "score": 0, "creation_date": 1542226951, "post_id": 53308084, "comment_id": 93497039, "body": "Well someone told me that i have a lot of mistakes.Why is void main () wrong ?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1542227036, "post_id": 53308084, "comment_id": 93497079, "body": "@bashtati <i>&quot;Why is void main () wrong ?&quot;</i> Because the c++ standard demands <code>main()</code> to return an <code>int</code>."}, {"owner": {"reputation": 113, "user_id": 1169205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f6b30e68d1620bbafd5c113b708886?s=128&d=identicon&r=PG", "display_name": "JimmyG", "link": "https://stackoverflow.com/users/1169205/jimmyg"}, "edited": false, "score": 0, "creation_date": 1542227074, "post_id": 53308084, "comment_id": 93497102, "body": "Declaring main as void is not wrong for a quick one-off program.  You should prefer the int main() for code you are releasing."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 113, "user_id": 1169205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f6b30e68d1620bbafd5c113b708886?s=128&d=identicon&r=PG", "display_name": "JimmyG", "link": "https://stackoverflow.com/users/1169205/jimmyg"}, "edited": false, "score": 1, "creation_date": 1542227154, "post_id": 53308084, "comment_id": 93497133, "body": "@Jim It&#39;s blatantly wrong. That the MSVC compiler still supports that is completely irrelevant."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542227436, "post_id": 53308084, "comment_id": 93497263, "body": "Then, shalt thou declare <code>main()</code> returning <code>int</code>, no more, no less. <code>int</code> shalt be the thype thou shalt use, and the thype thou shalt use shall be <code>int</code>."}, {"owner": {"reputation": 113, "user_id": 1169205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f6b30e68d1620bbafd5c113b708886?s=128&d=identicon&r=PG", "display_name": "JimmyG", "link": "https://stackoverflow.com/users/1169205/jimmyg"}, "edited": false, "score": 1, "creation_date": 1542227632, "post_id": 53308084, "comment_id": 93497343, "body": "I stand corrected.  My apologies to any folks I have led astray."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542227703, "post_id": 53308084, "comment_id": 93497376, "body": "Or more properly, according to C++11, <i>It shall have a return type of type <code>int</code>, but otherwise its type is implementation-defined. All implementations shall allow both of the following definitions of <code>main</code>: <code>int main() { &#47;* ... *&#47; }</code> and <code>int main(int argc, char* argv[]) { &#47;* ... *&#47; }</code></i>. Wording may have changed a bit in subsequent Standard revisions. See <b>[basic.start.main]</b>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542228019, "post_id": 53308084, "comment_id": 93497532, "body": "<a href=\"https://timsong-cpp.github.io/cppwp/n3337/basic.start.main\" rel=\"nofollow noreferrer\">Link to freely available draft close to C++11</a>. And a <a href=\"http://eel.is/c++draft/basic.start.main\" rel=\"nofollow noreferrer\">link to more recent wording</a>"}], "answers": [{"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 10, "last_activity_date": 1542229523, "last_edit_date": 1542229523, "creation_date": 1542227047, "answer_id": 53308209, "question_id": 53308084, "link": "https://stackoverflow.com/questions/53308084/is-this-a-correct-way-of-declaring-an-array/53308209#53308209", "title": "Is this a correct way of declaring an array", "body": "<p>The first error the compiler gives is pretty self-explanatory:</p>\n\n<pre><code>main.cpp:4:16: error: \u2018::main\u2019 must return \u2018int\u2019\n     void main ()\n                ^\n</code></pre>\n\n<p>The next two are trickier. They are caused by the forgotten <code>;</code> on the <code>int K[L]</code> line.</p>\n\n<pre><code>main.cpp: In function \u2018int main()\u2019:\nmain.cpp:7:8: error: expected initializer before \u2018int\u2019\n        int br =0;\n        ^~~\nmain.cpp:11:15: error: \u2018K\u2019 was not declared in this scope\n        cin &gt;&gt; K[i];\n</code></pre>\n\n<p>The forgotten <code>;</code> makes the compiler read the line as <code>int K[L] int br =0;</code> so the declaration of both <code>K</code> and <code>br</code> fails, and it's the failed declaration of <code>K</code> that causes the third error.</p>\n\n<p>I corrected it and removed an oddly placed std::endl.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nconst int L = 30;\n\nint main()\n{\n    int K[L];\n    // int br =0; // unused\n    int i;\n    for (i = 0; i &lt; L; i++) {\n        std::cout &lt;&lt; \"Enter a number: \";\n        std::cin &gt;&gt; K[i];\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10654211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c986c22c214791a75c6ef18f782f59b1?s=128&d=identicon&r=PG&f=1", "display_name": "PageFault", "link": "https://stackoverflow.com/users/10654211/pagefault"}, "is_accepted": false, "score": 2, "last_activity_date": 1542227342, "creation_date": 1542227342, "answer_id": 53308279, "question_id": 53308084, "link": "https://stackoverflow.com/questions/53308084/is-this-a-correct-way-of-declaring-an-array/53308279#53308279", "title": "Is this a correct way of declaring an array", "body": "<p>Your array declaration is simply missing a semicolon.</p>\n\n<p>Use <code>int K[L];</code> instead of <code>int K[L]</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10653241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979219abda2b4ff200227718c4ab4d10?s=128&d=identicon&r=PG&f=1", "display_name": "bashtati", "link": "https://stackoverflow.com/users/10653241/bashtati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1542237777, "answer_count": 2, "score": -3, "last_activity_date": 1542229523, "creation_date": 1542226439, "question_id": 53308084, "link": "https://stackoverflow.com/questions/53308084/is-this-a-correct-way-of-declaring-an-array", "closed_reason": "Not suitable for this site", "title": "Is this a correct way of declaring an array", "body": "<p>I have to make an array of whole numbers K(L) (L&lt;=30) in c++,and i need some help declarating it correctly ,because im certain my way is wrong.</p>\n\n<pre><code>    #include &lt;iostream&gt;\n    using namespace std;\n    const int L = 30;\n    void main ()\n     {\n       int K[L]\n       int br =0;\n       int i;\n       for (i = 0; i &lt; L; i++)\n       cout &lt;&lt;endl &lt;&lt; \"Enter a number\" ;\n       cin &gt;&gt; K[i];\n       }\n</code></pre>\n"}, {"tags": ["c#", "c++", "dllimport"], "comments": [{"owner": {"reputation": 6072, "user_id": 2142950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZGrD.png?s=128&g=1", "display_name": "Klaus G&#252;tter", "link": "https://stackoverflow.com/users/2142950/klaus-g%c3%bctter"}, "edited": false, "score": 0, "creation_date": 1542225378, "post_id": 53307804, "comment_id": 93496316, "body": "Does this also happen with IntPtr[] robotArray = new IntPtr[10]; UInt32 numRobots = 10; which would more closely correspond to the C++ use?"}, {"owner": {"reputation": 119, "user_id": 6505573, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OQEV_CHTdg8/AAAAAAAAAAI/AAAAAAAAAHI/Apkevom691M/photo.jpg?sz=128", "display_name": "Jonathon Hoaglin", "link": "https://stackoverflow.com/users/6505573/jonathon-hoaglin"}, "reply_to_user": {"reputation": 6072, "user_id": 2142950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZGrD.png?s=128&g=1", "display_name": "Klaus G&#252;tter", "link": "https://stackoverflow.com/users/2142950/klaus-g%c3%bctter"}, "edited": false, "score": 0, "creation_date": 1542225633, "post_id": 53307804, "comment_id": 93496437, "body": "@KlausG&#252;tter Yes, no change in the return from playing with the array size or the int value"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1542227845, "post_id": 53307804, "comment_id": 93497437, "body": "First param should be IntPtr[] phRobots"}, {"owner": {"reputation": 119, "user_id": 6505573, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OQEV_CHTdg8/AAAAAAAAAAI/AAAAAAAAAHI/Apkevom691M/photo.jpg?sz=128", "display_name": "Jonathon Hoaglin", "link": "https://stackoverflow.com/users/6505573/jonathon-hoaglin"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1542233578, "post_id": 53307804, "comment_id": 93499830, "body": "@DavidHeffernan Are you saying it doesn&#39;t need the &quot;ref&quot; keyword?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1542237176, "post_id": 53307804, "comment_id": 93501081, "body": "Er, yes, precisely"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1542239508, "post_id": 53307804, "comment_id": 93501774, "body": "An array is already a reference type, decays to a pointer to the object.  To the first element of the array, much like it does in C.  So you have to delete <code>ref</code>.  The only thing you have to worry about is to make the array large enough, that&#39;s why the PTROBOT_OVERFLOW error exists."}], "owner": {"reputation": 119, "user_id": 6505573, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OQEV_CHTdg8/AAAAAAAAAAI/AAAAAAAAAHI/Apkevom691M/photo.jpg?sz=128", "display_name": "Jonathon Hoaglin", "link": "https://stackoverflow.com/users/6505573/jonathon-hoaglin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542225111, "creation_date": 1542225111, "question_id": 53307804, "link": "https://stackoverflow.com/questions/53307804/dllimport-declaring-and-using-methods-from-c-in-c", "title": "DllImport declaring and using methods from C++ in C#", "body": "<p>I have used DllImport in the past, but I am having a lot of trouble trying to figure out the correct way to declare and use a particular method due to the parameter types. Here is the C++ prototype:</p>\n\n<pre><code>//  PTRobot_EnumRobots\n//\n//  Description:\n//      Function to enumerate the Robots on the system.\n//  Params:\n//      phRobots    points to an array of HANDLEs to store\n//                  the Robots found.\n//      pdwNumRobots    points to a DWORD containing the number of HANDLEs\n//                  in the phRobots array.  This value is an input\n//                  and an output.  The user should specify the size\n//                  (number of HANDLEs) of the phRobots array on input.\n//                  The value of the pdwNumRobots on output will be the\n//                  number of robots found.\n//\n//  Notes:\n//      Both params will be updated upon successful completion of this\n//      command.  phRobots will contain handles to robots connected to\n//      this system. pdwNumRobots will will be updated with the number of \n//      robots found.\n//      Also, note that the hDrives[] array in the PTRobotInfo will not be\n//      valid until PTRobot_EnumDrives is called.\n//\n//  Return:\n//      PTROBOT_OK if Successful\n//      PTROBOT_INVALID_ROBOT if no robots found\n//      PTROBOT_SEQUENCE if this command is called out of sequence\n//      PTROBOT_INTERNAL if an internal error occurred\n//      PTROBOT_OVERFLOW if the number of robots found is &gt; the value in \n//                       pdwNumRobots\n//\n///////////////////////////\nDWORD WINAPI PTRobot_EnumRobots(HANDLE * phRobots, DWORD * pdwNumRobots);\n</code></pre>\n\n<p>And here is the C++ usage:</p>\n\n<pre><code>HANDLE hRobots[10];\nDWORD dwRet=0, dwRobots=10;\n\ndwRet = PTRobot_EnumRobots(hRobots, &amp;dwRobots);\n</code></pre>\n\n<p>Here is my attempt at declaring it in C#:</p>\n\n<pre><code>[DllImport(\"PTRobot.dll\", CharSet = CharSet.Unicode)]\nprivate static extern uint PTRobot_EnumRobots(ref IntPtr[] phRobots, ref uint pdwNumRobots);\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>IntPtr[] robotArray = new IntPtr[1];\nUInt32 numRobots = 1;\n\nstatus = PTRobotDLL.EnumRobots(ref robotArray, ref numRobots);\n</code></pre>\n\n<p>but I don't think that is right, because I keep getting \"INVALID_ROBOT\" returned, even though the method return \"OK\" in C++. I believe the issue is when it is trying to write back to those references, probably because I am not sure how to declare them.</p>\n\n<p>Any insight into the proper way to declare the method in C#? especially with the odd HANDLE array reference?</p>\n"}, {"tags": ["c++", "module", "function-declaration", "c++20"], "answers": [{"tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": true, "score": 6, "last_activity_date": 1553971638, "last_edit_date": 1553971638, "creation_date": 1542229719, "answer_id": 53308745, "question_id": 53307773, "link": "https://stackoverflow.com/questions/53307773/c20-modules-ts-still-need-function-declaration/53308745#53308745", "title": "C++20 modules TS: still need function declaration?", "body": "<p>While Modules does change many things about name lookup (the latest paper I'm aware of is <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1103r1.pdf\" rel=\"nofollow noreferrer\">P1103R1</a>), Modules will not change the fundamental property of C++ that names must be declared before use (modulo things like dependent unqualified calls - which simply delays the lookup, but it still has to actually happen).</p>\n\n<p>This:</p>\n\n<pre><code>void f1() { f2(); }\nexport void f2() { ... }\n</code></pre>\n\n<p>will still be a compile error if there is no previous declaration of <code>f2</code> or it wasn't imported from somewhere. You'll have to write:</p>\n\n<pre><code>export void f2() { ... }\nvoid f1() { f2(); }\n</code></pre>\n"}], "owner": {"reputation": 1377, "user_id": 616363, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ba52fe6209405eee462a3f059316b5ba?s=128&d=identicon&r=PG", "display_name": "Alek86", "link": "https://stackoverflow.com/users/616363/alek86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 53308745, "answer_count": 1, "score": 2, "last_activity_date": 1553971638, "creation_date": 1542224988, "last_edit_date": 1542229449, "question_id": 53307773, "link": "https://stackoverflow.com/questions/53307773/c20-modules-ts-still-need-function-declaration", "title": "C++20 modules TS: still need function declaration?", "body": "<p>I hope a quick small question to those who tried C++20 modules</p>\n\n<p>According to TS, should this code compile in C++20?</p>\n\n<pre><code>void f1() { f2(); }\nvoid f2() { ... }\n</code></pre>\n\n<p>For example, in C++11 it won't compile, because f1() doesn't \"know\" about the f2(), f2() must be declared before usage.</p>\n\n<p>But maybe in C++20 this requirement will be eliminated in modules?</p>\n\n<p>If the first code snippet is not compiled, will this one compile</p>\n\n<pre><code>void f1() { f2(); }\nexport void f2() { ... }\n</code></pre>\n\n<p>because f2() will be seen from the BMI?</p>\n"}, {"tags": ["c++", "qt", "lapack", "blas", "msys2"], "comments": [{"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 1, "creation_date": 1542224755, "post_id": 53307489, "comment_id": 93496045, "body": "Hi there, welcome to Stack Overflow! Please read <a href=\"https://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1035, "user_id": 1494352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ztj0.jpg?s=128&g=1", "display_name": "zgyarmati", "link": "https://stackoverflow.com/users/1494352/zgyarmati"}, "is_accepted": false, "score": 1, "last_activity_date": 1542272077, "creation_date": 1542272077, "answer_id": 53315608, "question_id": 53307489, "link": "https://stackoverflow.com/questions/53307489/stand-alone-qt-app-with-lapack-blas-on-windows-and-other-missing-dlls/53315608#53315608", "title": "Stand Alone Qt app with lapack/blas on windows (and other missing dlls)", "body": "<p>Unfortunately windeployqt has some issues on MSYS2/MinGW. For starters you need to enable the --compiler-runtime command line option to get libstdc++-6.dll and libgcc_s_dw2-1.dll, but probably it's not enough. See for example this issue for further details: <a href=\"https://github.com/Alexpux/MINGW-packages/issues/221\" rel=\"nofollow noreferrer\">https://github.com/Alexpux/MINGW-packages/issues/221</a>.\nThe conclusion is that you're better off with using also an other tool (like ldd) together with windeployqt and some clever scripting to copy all of the needed .dll-s into your deployment.</p>\n"}], "owner": {"reputation": 1, "user_id": 10653900, "user_type": "registered", "profile_image": "https://graph.facebook.com/567454530363568/picture?type=large", "display_name": "Uric Bonatti Cardoso", "link": "https://stackoverflow.com/users/10653900/uric-bonatti-cardoso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542272077, "creation_date": 1542223683, "question_id": 53307489, "link": "https://stackoverflow.com/questions/53307489/stand-alone-qt-app-with-lapack-blas-on-windows-and-other-missing-dlls", "title": "Stand Alone Qt app with lapack/blas on windows (and other missing dlls)", "body": "<p>I developed a app on QT using armadillo with Lapack, Blas and Lapacke. It run on my QT (running on MSYS2 - MingW32), but when i try build a stand alone with windeployqt, apparently works. But when i tried run, it give missing .dll (liblapack.dll, libblas.dll,libstdc++-6.dll and libgcc_s_dw2-1.dll).</p>\n\n<p>I don't know what i can do to fix it.</p>\n"}, {"tags": ["c++", "oop"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 2, "creation_date": 1542222889, "post_id": 53307246, "comment_id": 93495229, "body": "<code>isEven</code> returns an <code>Array</code> by value, which is a temporary, so it certainly would invoke a move construction of <code>b</code> instead of a copy."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 4, "creation_date": 1542223032, "post_id": 53307246, "comment_id": 93495300, "body": "What sense does it make to have the move constructor allocate a new array? The point is that, given that the source object can be left &quot;empty&quot;, you can steal his pointer... Currently your implementation copies and then leaks the source object memory."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1542223103, "post_id": 53307246, "comment_id": 93495335, "body": "According ot the <a href=\"https://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule of 3/5/0</a> you will need an assignment operator. Note that your move constructor not only doesn&#39;t move, it also leaks."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542223302, "post_id": 53307246, "comment_id": 93495408, "body": "i dont think this code is &quot;relatively simple&quot;. Actually I think this is relatively complicated. Manual memory managment is never simple. Just saying..."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542223512, "post_id": 53307246, "comment_id": 93495501, "body": "unless this is one of those &quot;dont do it the c++ way&quot; assignment, you shuold use a <code>std::array</code>"}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1542223800, "post_id": 53307246, "comment_id": 93495634, "body": "@MatteoItalia Can you explain me your comment a bit, how am i supposed to steal an objects pointer? How this leaks source object memory? I see that i messed up this move constructor badly, i thought i just needed to use source object and then delete it, it just now pops-up in my mind that i have a destructor for it? Anyway, how am i supposed to do this properly and why this invoked move and not copy constructor?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542223849, "post_id": 53307246, "comment_id": 93495656, "body": "this might help: <a href=\"https://stackoverflow.com/questions/9456910/how-to-define-a-move-constructor\" title=\"how to define a move constructor\">stackoverflow.com/questions/9456910/&hellip;</a>"}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542223968, "post_id": 53307246, "comment_id": 93495707, "body": "@user463035818 That&#39;s nice, but i am not supposed to use std::move here."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542224088, "post_id": 53307246, "comment_id": 93495764, "body": "yes I also realized that the question (and the answers) are rather specific. Dont find a better question and I dont want to point you to a random online ressource, try <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">here</a> maybe"}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1542224131, "post_id": 53307246, "comment_id": 93495779, "body": "@CoryKramer so, it means that every time i have a function that returns something by value and then i am assigning it to something else, move constructor would be called, right?"}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542224283, "post_id": 53307246, "comment_id": 93495839, "body": "@user463035818 i most certainly need to check out some of those books, since i am having trouble with basic concepts such as move semantics, thanks for the effort!"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1542286371, "post_id": 53307246, "comment_id": 93519825, "body": "@cdummie: you would just copy <i>the pointer</i> and <code>n</code>, and then zero them out in <code>a1</code>. This way, you move the &quot;guts&quot; of <code>a1</code> in the newly constructed object, and leave an empty shell on the other side. That&#39;s the point of a move constructor: steal the stuff from the innards of the other object, leaving it in whatever state is more convenient, the only requirement is that its destructor will run cleanly. If you implement a move constructor that copies and then kill the other object, you could simply avoid to implement it, and leave it to the regular copy constructor."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 0, "creation_date": 1542224551, "post_id": 53307593, "comment_id": 93495968, "body": "Are you suggesting that i don&#39;t even need move and copy constructor here? I don&#39;t think i understand."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 0, "creation_date": 1542224680, "post_id": 53307593, "comment_id": 93496027, "body": "You might need them, but not to return <code>Array</code>s by value in the vast majority of cases."}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 0, "creation_date": 1542224791, "post_id": 53307593, "comment_id": 93496062, "body": "I see, i thought it was invoked, since when i was debugging it, it appeared as if the move constructor was called."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 0, "creation_date": 1542224907, "post_id": 53307593, "comment_id": 93496107, "body": "That&#39;s worth checking.  My (simple) tests show that it is not - see live demo."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 1, "creation_date": 1542225525, "post_id": 53307593, "comment_id": 93496387, "body": "Not really - read the first paragraph of the &#39;RVO&#39; (aka copy elision) link I provided - copy elision is an important optimisation when returning objects by value, I&#39;m surprised the other commentors didn&#39;t mention it."}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 0, "creation_date": 1542383700, "post_id": 53307593, "comment_id": 93561442, "body": "Ok, but still, when i tried debugging of this code in the visual studio it appeared as if move constructor was called ,this copy elision thing is something new for me."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 1, "creation_date": 1542392643, "post_id": 53307593, "comment_id": 93565681, "body": "You&#39;re right, MSVC invokes the move constructor in the body of <code>isEven</code>.  I would call this an MSVC bug - there&#39;s no need to do this."}, {"owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "edited": false, "score": 0, "creation_date": 1542467775, "post_id": 53307593, "comment_id": 93582668, "body": "Ok, i see, thanks for the help, im going to keep in mind that copy elision stuff, however, i suppose that at my level of knowledge, it is bit too advanced, since i am beginner in oop."}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": false, "score": 0, "last_activity_date": 1542224161, "creation_date": 1542224161, "answer_id": 53307593, "question_id": 53307246, "link": "https://stackoverflow.com/questions/53307246/why-is-move-constructor-used-over-copy-constructor/53307593#53307593", "title": "Why is move constructor used over copy constructor?", "body": "<p>Your assumption that calling <code>isEven</code> invokes your move constructor is not in fact correct.  Nor does it invoke your copy constructor.  Instead, <a href=\"https://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">RVO</a> ensures that the object returned is constructed directly at the calling site so neither is required.</p>\n\n<p><a href=\"https://wandbox.org/permlink/YLqTGcPlfVdUFRty\" rel=\"nofollow noreferrer\">Live Demo</a> (which doesn't address any of the flaws in your code mentioned in the comments).</p>\n"}], "owner": {"reputation": 155, "user_id": 10653802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b8a10d3c50e6fb8e21a0e82947cf13?s=128&d=identicon&r=PG&f=1", "display_name": "cdummie", "link": "https://stackoverflow.com/users/10653802/cdummie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1542657133, "creation_date": 1542222741, "last_edit_date": 1542657133, "question_id": 53307246, "link": "https://stackoverflow.com/questions/53307246/why-is-move-constructor-used-over-copy-constructor", "title": "Why is move constructor used over copy constructor?", "body": "<p>This is simple program that is supposed to handle a dynamic array of numbers and then to filter out the elements that are even and put them into a new array and then print both arrays on the screen.</p>\n\n<p>This is the header file:</p>\n\n<pre><code>#pragma once\n\n\nnamespace filter\n{\n    class Array\n    {\n        double *arr;\n        int n;\n\npublic:\n    Array();\n    Array(int);\n    Array(const Array&amp;);\n    Array(Array&amp;&amp;);\n    void PutIn();\n    void PrintOut() const;\n    Array isEven();\n    Array filter(const std::function&lt;bool(int)&gt;&amp;) const;\n    ~Array();\n\n};\n}\n</code></pre>\n\n<p>Then, this is the implementation of functions:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include \"Array.h\";\nusing namespace filter;\nusing namespace std;\n\nArray::Array() :arr(nullptr), n(0)\n{ }\n\nArray::Array(int n)\n{\n    this-&gt;n = n;\n    arr = new double[n];\n}\n\nArray::Array(const Array &amp;a1)\n{\n    n = a1.n;\n    arr = new double[n];\n    for (int i = 0; i &lt; n; i++)\n        arr[i] = a1.arr[i];\n}\n\nArray::Array(Array &amp;&amp;a1)\n{\n    n = a1.n;\n    for (int i = 0; i &lt; n; i++)\n        arr[i] = a1.arr[i];\n    a1.n = 0;\n    a1.arr = nullptr;\n}\n\nvoid Array::PutIn()\n{\n    cout &lt;&lt; \"Insert elements:\\n\";\n        for (int i = 0; i &lt; n; i++)\n            cin &gt;&gt; arr[i];\n\n}\nvoid Array::PrintOut() const\n{\n    cout &lt;&lt; \"\\nYour array is :\\n\";\n    for (int i = 0; i &lt; n; i++)\n        cout &lt;&lt; arr[i] &lt;&lt; \"\\t\";\n}\n\nArray Array::isEven()\n{\n    return filter([](int x) { return x % 2; });\n}\nArray Array::filter(const std::function&lt;bool(int)&gt; &amp;f) const\n{\n    int b = 0;\n\n    for (int i = 0; i &lt; n; i++)\n        if (f(arr[i]) == 0)\n            b++;\n\n    Array temp(b);\n    b = 0;\n    for (int i = 0; i &lt; n; i++)\n        if (f(arr[i]) == 0)\n        {\n            temp.arr[b] = arr[i];\n            b++;\n        }\n    return temp;\n}\n\nArray::~Array()\n{\n    delete[]arr;\n    n = 0;\n}\n</code></pre>\n\n<p>Finally, this is the source code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n#include \"Array.h\"\nusing namespace filter;\nusing namespace std;\n\n\n\n\nint main()\n{\n\n    Array a(5);\n\n    a.PutIn();\n\n    Array b = a.isEven();    //WHY THIS LINE OF CODE INVOKES MOVE CONSTRUCTOR AND NOT COPY CONSTRUCTOR?\n\n    a.PrintOut();\n    b.PrintOut();\n\n    getchar();\n    getchar();\n\n}\n</code></pre>\n\n<p>So, as you can see, this is relatively simple program that needs to handle an array with five elements in it entered by user and then to create a new array that consists of even elements of the first array. When i run this, it works fine, however, there is one little thing that i don't understand here.</p>\n\n<p>If you look at the source code, notice the line where i left my comment, that is the line where move constructor is called, but i don't know why. That would mean that a.IsEven() is a RVALUE, since move constructor works with RVALUES, right? Can anyone explain me why this is rvalue and what is the correct way to understand this? Any help appreciated!</p>\n"}, {"tags": ["c++", "linux", "qt", "desktop-application"], "comments": [{"owner": {"reputation": 811, "user_id": 3339316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cdagh.gif?s=128&g=1", "display_name": "Redanium", "link": "https://stackoverflow.com/users/3339316/redanium"}, "edited": false, "score": 0, "creation_date": 1542227474, "post_id": 53307173, "comment_id": 93497278, "body": "Have a look at <a href=\"https://stackoverflow.com/questions/30113311/in-qt-5-whats-the-right-way-to-show-multi-monitor-full-screen-qwidget-windows?answertab=active#tab-top\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2126, "user_id": 3558278, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/bCVxE.jpg?s=128&g=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/3558278/deep"}, "is_accepted": false, "score": 0, "last_activity_date": 1542862524, "creation_date": 1542862524, "answer_id": 53424119, "question_id": 53307173, "link": "https://stackoverflow.com/questions/53307173/qt-raise-window-to-current-desktop-workspace-on-linux-de/53424119#53424119", "title": "Qt - raise window to current desktop/workspace on Linux DE", "body": "<p>Qt not support full Linux DE/WM environment. Virtual desktop is like not real virtual desktop.</p>\n\n<p>This is complex question. I'll try explain (bad english).</p>\n\n<p>Desktops and workspaces on Linux X Window System: <a href=\"https://www.circuitousroot.com/artifice/programming/useful/fvwm/viewports/index.html\" rel=\"nofollow noreferrer\">https://www.circuitousroot.com/artifice/programming/useful/fvwm/viewports/index.html</a></p>\n\n<p>Qt use xcb: <a href=\"https://xcb.freedesktop.org/\" rel=\"nofollow noreferrer\">https://xcb.freedesktop.org/</a>\nHere we have xcb connection: <a href=\"http://doc.qt.io/qt-5/qx11info.html#connection\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qx11info.html#connection</a>\nThis is hard way without other libraries: xcb, ICCCM, EWMH only...\nI have this issue for my application, but later. I have only dirty tests on pure C, and it works.</p>\n\n<p>You can try use (or look how to implement, I watched here) KWindowSystem: <a href=\"https://api.kde.org/frameworks/kwindowsystem/html/classKWindowSystem.html\" rel=\"nofollow noreferrer\">https://api.kde.org/frameworks/kwindowsystem/html/classKWindowSystem.html</a> (which not have KDE dependencies!!!) but this class not have all functionality for all EWMH commands.</p>\n"}], "owner": {"reputation": 3107, "user_id": 4131673, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100000565112046/picture?type=large", "display_name": "jaskmar", "link": "https://stackoverflow.com/users/4131673/jaskmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542862524, "creation_date": 1542222472, "question_id": 53307173, "link": "https://stackoverflow.com/questions/53307173/qt-raise-window-to-current-desktop-workspace-on-linux-de", "title": "Qt - raise window to current desktop/workspace on Linux DE", "body": "<p><strong>Preconditions:</strong> My Qt program (MainWindow) works on <em>FIRST</em> Linux desktop, and I work on <em>SECOND</em>.</p>\n\n<p>Program invokes such piece of code:</p>\n\n<pre><code>mainWindow-&gt;raise();\n</code></pre>\n\n<p><strong>What happens?</strong> My Desktop Environment switches to the <em>FIRST</em> desktop and shows main window on my app.</p>\n\n<p><strong>What I want to happen?</strong> Main window of my app is moved to the current (<em>SECOND</em>) desktop and shows here.</p>\n\n<p>Is it possible with Qt and how?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1542222467, "post_id": 53307144, "comment_id": 93495047, "body": "You may use a <code>std::vector&lt;MyStruct&gt;</code>?"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542222679, "post_id": 53307144, "comment_id": 93495134, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53295951/readfile-function-is-there-a-way-that-i-can-no-longer-declare-specific-number\" title=\"readfile function is there a way that i can no longer declare specific number\">stackoverflow.com/questions/53295951/&hellip;</a>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542224779, "post_id": 53307144, "comment_id": 93496059, "body": "@PaulSanders that question is the whole file as one big block of bytes, not as structures. And the answers are of pretty bad quality."}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1542224951, "post_id": 53307144, "comment_id": 93496127, "body": "@user4581301 Yes, that&#39;s why I didn&#39;t vote to close as a duplicate.  It might be vaguely helpful to the OP though - it&#39;s not obvious how he proposes to map whatever is in his .txt file to structs in memory."}], "answers": [{"tags": [], "owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "is_accepted": false, "score": 0, "last_activity_date": 1542228803, "creation_date": 1542228803, "answer_id": 53308548, "question_id": 53307144, "link": "https://stackoverflow.com/questions/53307144/reading-a-txt-file-using-a-struct-data-structure-without-knowing-the-size-of-th/53308548#53308548", "title": "Reading a .txt file using a struct data structure without knowing the size of the structure needed", "body": "<p>I think this question has some bad assumptions. It would be better with a more specific example and a code attempt to go off of in order to make sure the OP's concerns are addressed.</p>\n\n<p>However, I can answer that:</p>\n\n<ul>\n<li>A data structure can be a struct or a class or aggregates thereof</li>\n<li>A data structure can be made with dynamic sizing or dynamic sizing members</li>\n<li>It is important to come up with a specification for your files and the data structures that the file will be deserialized into</li>\n</ul>\n\n<p>For example:</p>\n\n<p>I could say that I will create a file that contains</p>\n\n<ul>\n<li>A leading byte defining how many values will follow, representing an unsigned number 0-255</li>\n<li>A number of values one byte each, ranging from 0 - 255</li>\n</ul>\n\n<p>Then I could easily create a parse method that stuffed them into an std::vector of char or std::vector of unsigned or some other dynamic sizing container.</p>\n\n<p>I may or may not create a struct that wraps the vector and the Parse method.</p>\n\n<p>There certainly isn't one way of doing things, but the main point here is that you are looking for <strong>dynamically</strong> sized containers</p>\n"}, {"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1542232457, "creation_date": 1542232457, "answer_id": 53309285, "question_id": 53307144, "link": "https://stackoverflow.com/questions/53307144/reading-a-txt-file-using-a-struct-data-structure-without-knowing-the-size-of-th/53309285#53309285", "title": "Reading a .txt file using a struct data structure without knowing the size of the structure needed", "body": "<p>Without knowing the structure of the text file, only a general answer can be given.  </p>\n\n<p><strong>CSV Files</strong><br>\nMany text files are organized as columns (fields) and rows (records).  The columns are separated by commas, tabs, vertical bars or other separated characters.  Too many duplicates on StackOverflow, so search the internet for \"C++ read CSV\".  </p>\n\n<p><strong>HTML &amp; XML</strong><br>\nSome text files have data organized like a tree structure, with records of records.  Examples are HTML and XML.  Use a library to read these.  </p>\n\n<p><strong>Online Judge</strong><br>\nThese text files contain data for a programming problem.  Usually they have one row for the number of test cases, then followed by data for each test case.  The organization of the data is problem specific.  </p>\n\n<p><strong>Other</strong><br>\nText file can have their data in any, arbitrary, format.  You'll need to contact the producer of the data for the layout.  </p>\n\n<p><strong>Dynamic Data Quantity</strong><br>\nIn many instances, the quantity of the data records is not known at compile time.  You'll need a <em>dynamically sized container</em>, such as <code>std::vector, std::list, std::map,</code> etc.  </p>\n"}], "owner": {"reputation": 1, "user_id": 10653860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18413c2c7d4a7ade83745680aee43471?s=128&d=identicon&r=PG&f=1", "display_name": "Zcomp", "link": "https://stackoverflow.com/users/10653860/zcomp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1542232457, "creation_date": 1542222340, "last_edit_date": 1542222503, "question_id": 53307144, "link": "https://stackoverflow.com/questions/53307144/reading-a-txt-file-using-a-struct-data-structure-without-knowing-the-size-of-th", "title": "Reading a .txt file using a struct data structure without knowing the size of the structure needed", "body": "<p>I need to read data from a .txt file into C++ using the struct data structure. I can do this fine; however, if I don't know the initial size of the data structure needed, what would I do then?\nFor example, you normally need to define your structure like \"Points[20]\" if you have 20 pieces of data. \nSo, is there a way to read a .txt file of any size into a struct data structure?\nI have had a look on the site but can't find any question similar to mine.</p>\n"}, {"tags": ["c++", "bison"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542222966, "post_id": 53307097, "comment_id": 93495263, "body": "The problem is that <code>1-1</code> tokenizes to two consecutive numbers, values <code>1</code> and <code>-1</code>, and your expression rules don&#39;t allow two consecutive numbers.  In C, there are no negative <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.1\" rel=\"nofollow noreferrer\">integer constants</a>.  Maybe you should decide that you don&#39;t recognize them either."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542223036, "post_id": 53307304, "comment_id": 93495304, "body": "It will also treat <code>- 1</code> with a space as <code>-1</code> \u2014 which shouldn&#39;t matter much."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1542222966, "creation_date": 1542222966, "answer_id": 53307304, "question_id": 53307097, "link": "https://stackoverflow.com/questions/53307097/bison-c-subtracting/53307304#53307304", "title": "Bison C++ - subtracting", "body": "<p>Your precedence annotation didn't change anything for you because the rule <code>'-' expression</code> isn't actually used in <code>1-1</code>. The problem with that input is that the parser only sees two integer tokens and nothing you can do in the parser can change that.</p>\n\n<p>Instead you'll need to make the lexer produce three tokens for that input instead of two. You can do by simply removing the <code>[-]?</code> from your rule for <code>number</code> tokens. With that change <code>1-1</code> will be tokenized as <code>number, '-', number</code> and your parser will work.</p>\n\n<p>Note that this will still allow negative numbers because your <code>'-' expression</code> rule handles that - it just won't treat negative numbers as a single token, which is fine.</p>\n"}], "owner": {"reputation": 93, "user_id": 9022935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049d3a901d172bbd9cdd12ff180a7da0?s=128&d=identicon&r=PG&f=1", "display_name": "J.G.", "link": "https://stackoverflow.com/users/9022935/j-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 53307304, "answer_count": 1, "score": 1, "last_activity_date": 1542223210, "creation_date": 1542222161, "last_edit_date": 1542222787, "question_id": 53307097, "link": "https://stackoverflow.com/questions/53307097/bison-c-subtracting", "title": "Bison C++ - subtracting", "body": "<p>I'm making a simple calc using lex and bison. What should it do is to parse every mentioned subtracting - <code>1 - -1</code>, <code>1- 1</code>, <code>1--1</code>, and what's the most important: <code>1-1</code>. The first three cases are working, but in the last one it looks as if it separated the sentence into numbers <code>1</code> and <code>-1</code> without a sign between them and that's why there is an error.\nI read about precedence and how to use it, nothing has worked.</p>\n\n<p>Below is my shortened code, ready to copy:</p>\n\n<p>.l file</p>\n\n<pre><code>%{\n#include \"y.tab.h\"\n\nvoid yyerror (const char* s);\nint yylex();\n%}\n\n%%\n[-+*/%\\^()\\n] { return yytext[0]; }\n[0] {yylval = 0; return number;}\n[-]?[1-9][0-9]* {yylval = atoi(yytext); return number;}\n%%\n\nint yywrap(void) {return 1;}\nvoid yyerror (const char* s) {;}\n</code></pre>\n\n<p>.y file</p>\n\n<pre><code>%{\n#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n#include &lt;cmath&gt;\n\nvoid yyerror (const char*);\nint yylex();\n%}\n\n%token number\n\n\n%right NEG\n%left '-'\n\n%%\nprogram: \n       | line program\n       ;\n\nline: '\\n'\n    | expression '\\n' { std::cout &lt;&lt; \"Score: \" &lt;&lt; $1 &lt;&lt; \"\\n\";   }\n    ;\n\nexpression: number { ; }\n          | expression '-' expression { $$ = $1-$3; }\n          | '-' expression %prec NEG { $$ = -$2; }\n          ;\n%% \n\nint main (void) {\n    return yyparse();\n}\n</code></pre>\n\n<p>input and output:</p>\n\n<pre><code>1- - 1\n  Score: 2\n1--1\nScore: 2\n1-1\n&lt;here is an error&gt;\n</code></pre>\n"}, {"tags": ["c++", "3d", "vulkan"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1542227406, "post_id": 53307042, "comment_id": 93497248, "body": "Do not post text as images, please.  Use greater than followed by 6 spaces for a quoted code block."}], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 1983268, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1342a64e5ca49abb647742954a7d7840?s=128&d=identicon&r=PG", "display_name": "Carlos Romero", "link": "https://stackoverflow.com/users/1983268/carlos-romero"}, "edited": false, "score": 0, "creation_date": 1542347699, "post_id": 53331274, "comment_id": 93544012, "body": "Thank you, that makes a lot of sense. My mistake was I thought that the layouts passed to the pipeline were sort of a &quot;catalogue&quot; from which to pick and choose which ones to bind at any given time, when in fact as you say it&#39;s all of them simultaneously. I guess some sort of &quot;find or create&quot; pipeline management system would be something to consider for a general case regarding the type of layouts needed... -- Also, correct, the fragment shader indexes the correct texture by means of a vertex attribute, passed from the vertex shader with a &quot;flat&quot; modifier."}], "tags": [], "owner": {"reputation": 5299, "user_id": 126546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5300f94d7227aca52dfe170ce14a225c?s=128&d=identicon&r=PG", "display_name": "Jesse Hall", "link": "https://stackoverflow.com/users/126546/jesse-hall"}, "is_accepted": true, "score": 5, "last_activity_date": 1542341075, "creation_date": 1542341075, "answer_id": 53331274, "question_id": 53307042, "link": "https://stackoverflow.com/questions/53307042/vulkan-when-should-i-create-a-new-pipeline/53331274#53331274", "title": "Vulkan - when should I create a new pipeline?", "body": "<p>Passing multiple set layouts to the pipeline means that you want the pipeline to be able to access all the bindings in both sets simultaneously, e.g. the shaders have access to two UBOs at (set=0, binding=0) and (set=1, binding=0), four textures at (set=0, binding=1), and five textures as (set=1, binding=1).</p>\n\n<p>Then when you bind the set for the second mesh as the only set, you get the incompatibility because it has a different layout (5 textures) than the pipeline expects for set 0 (4 textures).</p>\n\n<p>So yes, when you have different descriptor set layouts, you need different pipelines. If you use the pipeline cache, much of the compilation may actually be reused between the two pipelines.</p>\n\n<p>If you're trying to use the same pipeline for both meshes, then presumably the code in your shader that accesses the fifth texture is conditional, based on a uniform or something? The alternative is to bind a dummy texture when drawing the 4-texture mesh; since it won't be accessed, it doesn't matter what its contents are, it can be 1x1, etc. Then you can use the same 5-texture set layout and same pipeline for both meshes.</p>\n"}], "owner": {"reputation": 668, "user_id": 1983268, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/1342a64e5ca49abb647742954a7d7840?s=128&d=identicon&r=PG", "display_name": "Carlos Romero", "link": "https://stackoverflow.com/users/1983268/carlos-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "accepted_answer_id": 53331274, "answer_count": 1, "score": 5, "last_activity_date": 1542341075, "creation_date": 1542221923, "last_edit_date": 1542228569, "question_id": 53307042, "link": "https://stackoverflow.com/questions/53307042/vulkan-when-should-i-create-a-new-pipeline", "title": "Vulkan - when should I create a new pipeline?", "body": "<p>So I want to render two independent meshes in Vulkan. I'm dabbling in textures and the 1st mesh uses 4 of them while the 2nd uses 5. I'm doing indexed draws.</p>\n\n<p>Each mesh has its own uniform buffer and sampler array packed into separate descriptor sets for simplicity, each one with a binding for the UBO and another binding for the samplers. The following code is run for each mesh, where <code>descriptorSet</code> is the descriptor set associated to a single mesh. <code>filepaths</code> is the vector of image paths that mesh in particular uses.</p>\n\n<pre><code>std::vector&lt;VkWriteDescriptorSet&gt; descriptorWrites;\ndescriptorWrites.resize(2);\n\nVkDescriptorBufferInfo bufferInfo = {};\nbufferInfo.buffer = buffers[i];\nbufferInfo.offset = 0;\nbufferInfo.range = sizeof(UniformBufferObject);\n\ndescriptorWrites[0].sType = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;\ndescriptorWrites[0].dstSet = descriptorSet;\ndescriptorWrites[0].dstBinding = 0;\ndescriptorWrites[0].dstArrayElement = 0;\ndescriptorWrites[0].descriptorType = VK_DESCRIPTOR_TYPE_UNIFORM_BUFFER_DYNAMIC;\ndescriptorWrites[0].descriptorCount = 1;\ndescriptorWrites[0].pBufferInfo = &amp;bufferInfo;\n\nstd::vector&lt;VkDescriptorImageInfo&gt; imageInfos;\nimageInfos.resize(filepaths.size());\nfor (size_t j = 0; j &lt; filepaths.size(); j++) {\n    imageInfos[j].imageLayout = VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL;\n    imageInfos[j].imageView = imageViews[j];\n    imageInfos[j].sampler = samplers[j];\n}\ndescriptorWrites[1].sType = VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET;\ndescriptorWrites[1].dstSet = descriptorSet;\ndescriptorWrites[1].dstBinding = 1;\ndescriptorWrites[1].dstArrayElement = 0;\ndescriptorWrites[1].descriptorType = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;\ndescriptorWrites[1].descriptorCount = imageInfos.size();\ndescriptorWrites[1].pImageInfo = imageInfos.data();\n\nvkUpdateDescriptorSets(devicesHandler-&gt;device, descriptorWrites.size(), descriptorWrites.data(), 0, nullptr);\n</code></pre>\n\n<p>So in order to tell Vulkan how these descriptor sets are laid out I need of course two descriptor set layouts i.e. one per mesh, which differ in the binding for the samplers due to the different size of <code>filepaths</code>:</p>\n\n<pre><code>// &lt;Stuff for binding 0 for UBO here&gt;\n// ...\nVkDescriptorSetLayoutBinding layoutBinding = {};\nlayoutBinding.binding = 1;\nlayoutBinding.descriptorCount = filepaths.size();\nlayoutBinding.descriptorType = VK_DESCRIPTOR_TYPE_COMBINED_IMAGE_SAMPLER;\nlayoutBinding.stageFlags = VK_SHADER_STAGE_FRAGMENT_BIT;\n</code></pre>\n\n<p>Now, when I create the pipeline I need to provide the pipeline layout. I'm doing it as follows, where <code>layouts</code> are the descriptor set layouts of the meshes stuffed into a vector.:</p>\n\n<pre><code>VkPipelineLayoutCreateInfo pipelineLayoutInfo = {};\npipelineLayoutInfo.sType = VK_STRUCTURE_TYPE_PIPELINE_LAYOUT_CREATE_INFO;\npipelineLayoutInfo.setLayoutCount = layouts.size();\npipelineLayoutInfo.pSetLayouts = layouts.data();\n</code></pre>\n\n<p>Finally before rendering I bind the aproppriate descriptor set.</p>\n\n<p>Naively I would think that way to define the pipeline layout this is the way to go (simply taking all the involved layouts and passing them on <code>pSetLayouts</code>) but it's not working. The error I get is:</p>\n\n<blockquote>\n<pre><code> descriptorSet #0 being bound is not compatible with overlapping descriptorSetLayout at index 0 of pipelineLayout 0x6e due to: DescriptorSetLayout 87 has 5 descriptors, but DescriptorSetLayout 88, which comes from pipelineLayout, has 6 descriptors.. The Vulkan spec states: Each element of pDescriptorSets must have been allocated with a VKDescriptorSetLayout that matches (is the same as, or identically defined as) the VkDescriptorSetLayout at set n in layout, where n is the sum of firstSet and the index into pDescriptorSets.\n</code></pre>\n</blockquote>\n\n<p>I also noticed that if I reduce the number of textures used from 5 to 4 in the second mesh so they match the 4 from the first mesh, then it works. So I'm wondering if I need to create a pipeline for every possible configuration of the layouts? That is, one pipeline with <code>setLayoutCount</code> set to 4 and another set to 5, and bind the corresponding one when I'm going to draw one mesh or the other? Is that stupid? Am I missing something?</p>\n\n<p>Worth noting is that if I render each mesh alone everything runs smoothly. The problem arises when I put both of them in the scene.</p>\n\n<p>Also, I know buffers should be allocated consecutively and taking into account alignments and that what I'm doing there is a bad practice - but I am just not dealing with that yet.</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542221716, "post_id": 53306863, "comment_id": 93494680, "body": "@user463035818 I reopened the question, because OP correctly tries to explicitly instantiate the class template for a specific set of template arguments, but was misguided"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 0, "creation_date": 1542221861, "post_id": 53306863, "comment_id": 93494743, "body": "@PiotrSkotnicki thanks. I saw cpp and some tempalte stuff and didnt read carefully enough"}], "answers": [{"comments": [{"owner": {"reputation": 270, "user_id": 1156580, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723a3388694475db06baf745955b8481?s=128&d=identicon&r=PG", "display_name": "David Levy", "link": "https://stackoverflow.com/users/1156580/david-levy"}, "edited": false, "score": 0, "creation_date": 1542222549, "post_id": 53307019, "comment_id": 93495082, "body": "Thanks for the clarification ! Now I need to fix my doxygen"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1542222731, "post_id": 53307019, "comment_id": 93495157, "body": "Next up: On the Confusing Nature of C++ Syntax."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 5, "last_activity_date": 1542221808, "creation_date": 1542221808, "answer_id": 53307019, "question_id": 53306863, "link": "https://stackoverflow.com/questions/53306863/function-template-specialization-syntax-for-cpp-file/53307019#53307019", "title": "function template specialization syntax for cpp file", "body": "<p>The correct syntax depends on what you're actually trying to do. Adding the <code>&lt;&gt;</code> is NOT just a way to fix Doxygen---it substantially changes the meaning of the program!</p>\n\n<p>The following are <em>explicit instantiation definitions</em>:</p>\n\n<pre><code>template void FileReader::Read&lt;uint8_t&gt;( uint8_t * );\ntemplate void FileReader::Read&lt;uint16_t&gt;( uint16_t * );\n</code></pre>\n\n<p>They tell the compiler to instantiate the function template right then and there, and to emit symbols for the instantiations so that they can be linked to by another translation unit. This seems to be what you're actually trying to do.</p>\n\n<p>The following are <em>explicit specialization declarations</em>:</p>\n\n<pre><code>template&lt;&gt; void FileReader::Read&lt;uint8_t&gt;( uint8_t * );\ntemplate&lt;&gt; void FileReader::Read&lt;uint16_t&gt;( uint16_t * );\n</code></pre>\n\n<p>They tell the compiler that you're going to define your own specializations of the template for those particular template arguments. Thus, anyone who tries to call <code>FileReader::Read&lt;uint8_t&gt;</code> will NOT instantiate the primary template that you've already defined, but rather, look for a specialized definition. It doesn't look like that's what you're trying to do, but if it were, you would actually have to define those specializations at some point.</p>\n"}], "owner": {"reputation": 270, "user_id": 1156580, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723a3388694475db06baf745955b8481?s=128&d=identicon&r=PG", "display_name": "David Levy", "link": "https://stackoverflow.com/users/1156580/david-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 53307019, "answer_count": 1, "score": 3, "last_activity_date": 1542221808, "creation_date": 1542221125, "question_id": 53306863, "link": "https://stackoverflow.com/questions/53306863/function-template-specialization-syntax-for-cpp-file", "title": "function template specialization syntax for cpp file", "body": "<p>I have a templated function declared in my .h and implemented in my .cpp:</p>\n\n<pre><code>//file.h\nclass FileReader{\ntemplate &lt;class T&gt; void Read( T *aValue );\n};\n\n//file.cpp\ntemplate&lt;class T&gt;\nvoid\nFileReader::Read( T *aValue )\n{\n    //implementation\n}\n</code></pre>\n\n<p>To allow the implementation in my .cpp, I had </p>\n\n<pre><code>template void FileReader::Read&lt;uint8_t&gt;( uint8_t * );\ntemplate void FileReader::Read&lt;uint16_t&gt;( uint16_t * );\n</code></pre>\n\n<p>But trying to fix a doxygen issue, someone pointed me <a href=\"https://stackoverflow.com/questions/53305408/no-uniquely-matching-class-member-found-for-a-template-specialization/53305449#53305449\">here</a> that I should use</p>\n\n<pre><code>template&lt;&gt; void FileReader::Read&lt;uint8_t&gt;( uint8_t * );\ntemplate&lt;&gt; void FileReader::Read&lt;uint16_t&gt;( uint16_t * );\n</code></pre>\n\n<p>This indeed, fixes the doxygen issue, but it breaks my compilation at linking.</p>\n\n<p>=>What is the correct syntax to specialize my function template in my .cpp and allow the function to be linked?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8323530/c-templates-specialization-syntax\">This</a> other question seems to indicate that I should use my second version. But <a href=\"https://isocpp.org/wiki/faq/templates#separate-template-fn-defn-from-decl\" rel=\"nofollow noreferrer\">this</a> article uses my first version.</p>\n"}, {"tags": ["c++", "windows", "cpu", "cpu-usage"], "comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542221900, "post_id": 53306819, "comment_id": 93494753, "body": "This may be something to do with logical processors versus number of cores.  I get sensible results running your code on my 2-core 4-thread core i3."}, {"owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542222078, "post_id": 53306819, "comment_id": 93494854, "body": "but task manager shows it different on my cpu and I read it uses the same function"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542222170, "post_id": 53306819, "comment_id": 93494906, "body": "Sure, my comment just FYI."}, {"owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "reply_to_user": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542223792, "post_id": 53306819, "comment_id": 93495628, "body": "the problem was the calculation formula , it was wrong and I found the correct one on some site . I&#39;ll paste the working code"}, {"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1542224211, "post_id": 53306819, "comment_id": 93495811, "body": "OK, sounds good."}], "answers": [{"tags": [], "owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "is_accepted": true, "score": 0, "last_activity_date": 1542224455, "creation_date": 1542224455, "answer_id": 53307656, "question_id": 53306819, "link": "https://stackoverflow.com/questions/53306819/accurate-system-cpu-usage-in-windows/53307656#53307656", "title": "accurate system cpu usage in windows", "body": "<p>the working code : </p>\n\n<pre><code>double accurate_usage() {\n\n  SYSTEM_INFO info = { 0 };\n  GetSystemInfo(&amp;info);\n  DWORD proc_num = info.dwNumberOfProcessors;\n  PSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION old_values = new SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION[proc_num];\n  PSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION new_values = new SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION[proc_num];\n  FILETIME old_time = { 0 }, new_time = { 0 };\n  ULARGE_INTEGER uold_time = { 0 }, unew_time = { 0 };\n\n  ULONG size;\n  fNtQuerySystemInformation(SystemProcessorPerformanceInformation, old_values, sizeof(old_values[0]) * proc_num, &amp;size);\n  GetSystemTimeAsFileTime(&amp;old_time);\n  memcpy(&amp;uold_time, &amp;old_time, sizeof(FILETIME));\n  Sleep(1000);\n  fNtQuerySystemInformation(SystemProcessorPerformanceInformation, new_values, sizeof(old_values[0]) * proc_num, &amp;size);\n  GetSystemTimeAsFileTime(&amp;new_time);\n  memcpy(&amp;unew_time, &amp;new_time, sizeof(FILETIME));\n\n  double percent = 0.0;\n  for (DWORD i = 0; i &lt; proc_num; ++i) {\n      double current_percent = (new_values[i].IdleTime.QuadPart - old_values[i].IdleTime.QuadPart) * 100 ;\n      current_percent /= ((new_values[i].KernelTime.QuadPart + new_values[i].UserTime.QuadPart) - (old_values[i].KernelTime.QuadPart + old_values[i].UserTime.QuadPart));\n      current_percent = 100 - current_percent;\n      percent += current_percent;\n  }\n  return percent / 10;\n}\n</code></pre>\n"}], "owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 53307656, "answer_count": 1, "score": 0, "last_activity_date": 1542224455, "creation_date": 1542220935, "question_id": 53306819, "link": "https://stackoverflow.com/questions/53306819/accurate-system-cpu-usage-in-windows", "title": "accurate system cpu usage in windows", "body": "<p>I'm working on adding cpu usage monitor to my process monitor and I chose to use NtQuerySystemInformation as it's the lowest api I can use to make more accurate calculation\nthe code below works well when the cpu usage is somewhat high but when the cpu is nearly idle (10 : 30) it doesn't show the usage percent as it is in task manager\nit doesn't display usage below 26 % however task manager shows it 15 % or near percent</p>\n\n<p>this is my code : </p>\n\n<pre><code>double accurate_usage() {\n\n  SYSTEM_INFO info = { 0 };\n  GetSystemInfo(&amp;info);\n  DWORD proc_num = info.dwNumberOfProcessors;\n  PSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION old_values = new SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION[proc_num];\n  PSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION new_values = new SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION[proc_num];\n  FILETIME old_time = { 0 }, new_time = { 0 };\n  ULARGE_INTEGER uold_time = { 0 }, unew_time = { 0 };\n\n  ULONG size;\n  fNtQuerySystemInformation(SystemProcessorPerformanceInformation, old_values, sizeof(old_values[0]) * proc_num, &amp;size);\n  GetSystemTimeAsFileTime(&amp;old_time);\n  memcpy(&amp;uold_time, &amp;old_time, sizeof(FILETIME));\n  Sleep(1000);\n  fNtQuerySystemInformation(SystemProcessorPerformanceInformation, new_values, sizeof(old_values[0]) * proc_num, &amp;size);\n  GetSystemTimeAsFileTime(&amp;new_time);\n  memcpy(&amp;unew_time, &amp;new_time, sizeof(FILETIME));\n\n  double percent = 0.0;\n  for (DWORD i = 0; i &lt; proc_num; ++i) {\n      double current_percent = (new_values[i].KernelTime.QuadPart - old_values[i].KernelTime.QuadPart) +\n      (new_values[i].UserTime.QuadPart - old_values[i].UserTime.QuadPart) - \n      (new_values[i].IdleTime.QuadPart - old_values[i].IdleTime.QuadPart);\n      current_percent /= (unew_time.QuadPart - uold_time.QuadPart);\n      current_percent /= proc_num;\n      current_percent *= 100;\n      percent += current_percent;\n  }\n  return percent;\n}\n</code></pre>\n"}, {"tags": ["c++", "header-files"], "comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1542219217, "post_id": 53306402, "comment_id": 93493488, "body": "Show the smallest program you can come up with that compiles, runs, and illustrates the problem. Unless, of course, in the process of reducing your actual code to the simplest example you see what&#39;s going wrong."}, {"owner": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1542279657, "post_id": 53306402, "comment_id": 93515877, "body": "@PeteBecker This question was for me to understand why it happens, not to have somebody fix my code, so I only added the relevant parts. Regardless, I added the code if you&#39;d like to try it."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1542290109, "post_id": 53306402, "comment_id": 93522049, "body": "&quot;Why it happens&quot; often depends on &quot;what it&#39;s doing&quot;; people can make guesses from code fragments, but can&#39;t give definite answers. It&#39;s quite common to see code fragments that have nothing wrong; the programmer didn&#39;t know enough about the problem to identify the critical parts. The other thing is, in reducing code to the smallest example that shows the problem, you&#39;ll often see it for yourself. That&#39;s an important skill."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "edited": false, "score": 0, "creation_date": 1542277407, "post_id": 53306465, "comment_id": 93514522, "body": "Hi, I thought it had something to do with the order of initialisation, so thanks for confirming it. However, I think the <code>inline</code> keyword is C++17 and I am unfortunately on C++14 for this issue (correct me if wrong). I will keep looking at what to do. Thanks again!"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "edited": false, "score": 1, "creation_date": 1542280382, "post_id": 53306465, "comment_id": 93516281, "body": "@Colmike Function-statics can be useful. Failing that, avoid globals!"}, {"owner": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542281383, "post_id": 53306465, "comment_id": 93516865, "body": "@LightnessRacesinOrbit Thanks for that! That helped solving the issue. I used inline functions in the header file and it prints the defined value. This seems to be a way to handle non <code>constexpr</code> types (e.g. <code>string</code>) directly. I will have to check how feasible this is in the long run for many application-wide globals though"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "edited": false, "score": 0, "creation_date": 1542281743, "post_id": 53306465, "comment_id": 93517095, "body": "@Colmike Nice one! Right on all counts. I do agree you should think hard about whether it will scale for you but it works in a pinch. Ideally I think you would leave the constants where they are and fix <code>my</code> being a global but it&#39;s not always so easy."}, {"owner": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542283012, "post_id": 53306465, "comment_id": 93517835, "body": "@LightnessRacesinOrbit Making <code>my</code> not global would also fix this issue, but in my case, this is one <code>main.cpp</code> of many (the application is a cross-platform library) and I only have access to the Linux main. I do not know if changing this is viable for other teams that may have a different API. Thanks for that, I will check."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "edited": false, "score": 0, "creation_date": 1542296121, "post_id": 53306465, "comment_id": 93526082, "body": "@Colmike In C++14, you can just do <code>constexpr char testString[] = ...</code> and it&#39;ll still work, but the object will have internal linkage, so there will be one copy per translation unit. (This is usually ok, but sometimes you may want a unique address, or you&#39;ll be targeting some embedded platform where memory is very scarce.)"}, {"owner": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "edited": false, "score": 0, "creation_date": 1542299432, "post_id": 53306465, "comment_id": 93528282, "body": "@Brian Yeah, that&#39;s what I do for ints and other primitives as that&#39;s not an issue. The problem was with non-primitive types like strings or vectors. I couldn&#39;t find anything for these types and I was wondering how initialisation worked in C++. Thanks!"}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 5, "last_activity_date": 1542219890, "last_edit_date": 1542219890, "creation_date": 1542219343, "answer_id": 53306465, "question_id": 53306402, "link": "https://stackoverflow.com/questions/53306402/global-constants-undefined-in-constructor/53306465#53306465", "title": "Global constants undefined in constructor", "body": "<p><em>Within</em> the <code>constants.cpp</code> translation unit, <code>testString</code> will be initialized before any subsequently defined non-local variable. <em>Between</em> translation units, we have what's called the \"static initialization order fiasco\"; any translation unit other than <code>constants.cpp</code> cannot assume that <code>testString</code> has been initialized until after <code>main</code> has started executing, so if it tries to read its value during one of its own non-local initializations, then it may observe a zero-initialized <code>std::string</code> object, which has undefined behaviour.</p>\n\n<p>My suggestion to avoid this problem, which is also the rule followed at my former workplace, is that if you must have global constants, make them <code>constexpr</code> if possible, and be very wary of having any non-<code>constexpr</code> global variables. <code>std::string</code> isn't <code>constexpr</code> (yet), but an old-fashioned <code>char</code> array could work:</p>\n\n<pre><code>// constants.h\ninline constexpr char testString[] = \"defined!\";\n\n// constants.cpp\n// no need to define `testString` here!\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4530384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c62cc5a2a6ba948a17aeab0e7b9b3e1?s=128&d=identicon&r=PG&f=1", "display_name": "Colmike", "link": "https://stackoverflow.com/users/4530384/colmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 53306465, "answer_count": 1, "score": -1, "last_activity_date": 1542282563, "creation_date": 1542219084, "last_edit_date": 1542282563, "question_id": 53306402, "link": "https://stackoverflow.com/questions/53306402/global-constants-undefined-in-constructor", "title": "Global constants undefined in constructor", "body": "<p>I have two files for constants:</p>\n\n<pre><code>// constants.h\nextern const std::string testString;\n\n// constants.cpp\nconst std::string testString = \"defined!\";\n</code></pre>\n\n<p>I need to use this constant in the constructor of an object when the program is initialised, but it comes as undefined. \nThe code in the constructor is:</p>\n\n<pre><code>MyClass::MyClass() {\n   printf(\"Value of test string: %s\", testString.c_str());\n}\n\n// output:\nValue of test string: (null)\n</code></pre>\n\n<p>The class and the constants are defined in the same namespace, and it does not give me an error that the constant is undefined. After the object is initialised (e.g. with a hard-coded string), it works fine and prints out the value of the constant (\"defined!\"). Primitive constants seem to work fine in the constructor. </p>\n\n<p>I think it has something to do with the constant not being initialised at that time (so from the .cpp file). \nDo you know why this might happen? Does the initialisation of extern const occur after the program fully initialises?</p>\n\n<p>Thank you in advance</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Note that the <code>string</code> type is to simplify the issue, so converting it to <code>char</code> is not an option as I am also interested in having other non-primitive types too.</p>\n\n<p>Code for a minimal dirty example of a program that shows this issue:</p>\n\n<pre><code>// constants.h\nextern const std::string testString;\n\n// constants.cpp\n#include \"constants.h\"\n\nconst std::string testString = \"defined!\";\n\n// MyClass.h\nclass MyClass {\n\npublic:\n    MyClass();\n    virtual ~MyClass();\n};\n\n// MyClass.cpp\n#include \"MyClass.h\"\n#include \"constants.h\"\n\nMyClass::MyClass() {\n   printf(\"Value of test string: %s\\n\", testString.c_str());\n}\n\nMyClass::~MyClass() {}\n\n// main.cpp\n#include \"MyClass.h\"\n#include \"constants.h\"\n\nMyClass my;            // undefined string (outputs null)\n\nint main(int argc, char** argv) {\n    MyClass my;        // defined string\n    return 0;\n}\n</code></pre>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>The solution in this case was to define an static inline function in the header file, as <a href=\"https://stackoverflow.com/a/53306465/4530384\">@Brian</a> and <a href=\"https://stackoverflow.com/a/53306465/4530384\">@LightnessRacesinOrbit</a> suggested. They both contributed to the final answer.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>inline std::string getTestString() { return \"defined!\"; }\n</code></pre>\n\n<p>This allows to have non <code>constexpr</code> types as global constants.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1542219302, "post_id": 53306395, "comment_id": 93493537, "body": "Please read <a href=\"https://isocpp.org/wiki/faq/operator-overloading#matrix-array-of-array\" rel=\"nofollow noreferrer\">isocpp.org/wiki/faq/operator-overloading#matrix-array-of-arr&zwnj;&#8203;ay</a>"}, {"owner": {"reputation": 165, "user_id": 5647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c09a3729b9df4840f225ccf9aba4fa3?s=128&d=identicon&r=PG", "display_name": "rbw", "link": "https://stackoverflow.com/users/5647014/rbw"}, "reply_to_user": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1542221999, "post_id": 53306395, "comment_id": 93494809, "body": "@Sneftel It says for a matrix. If I want to work with large matrices then this interface is fine. Furthermore, <a href=\"https://stackoverflow.com/questions/17259877/1d-or-2d-array-whats-faster\">it has been shown</a> that in general 1D is better than 2D."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 1, "creation_date": 1542262913, "post_id": 53306395, "comment_id": 93507359, "body": "I think you misunderstood that FAQ. It&#39;s not about 1D versus 2D, it&#39;s about [][] not being a good use of operator overloading."}], "answers": [{"comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1542219702, "post_id": 53306439, "comment_id": 93493728, "body": "This would be correct, but I&#39;m pretty sure you don&#39;t want that <code>const</code> to be there. If you wanted a <code>const</code> overload, it would probably return by <code>const</code> reference, or by value."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1542219768, "post_id": 53306439, "comment_id": 93493752, "body": "@mooing what, you are going to modify the state of the proxy in <code>[]</code>  What kind of mad duck are you?!"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1542219835, "post_id": 53306439, "comment_id": 93493779, "body": "Rather the opposite. I think a <code>const</code> overload should <i>prevent</i> the user from modifying the underlying data. Your code allows users to modify the underlying data, even with a <code>const proxy</code> object.  <code>const</code> should be used to demonstrate logical const-ness, not technical constness."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1542224923, "post_id": 53306439, "comment_id": 93496117, "body": "@mooing Bad idea with view types.  A pointer to const and a const pointer are not the same thing, and a const proxy is a const pointer, not a pointer to const.  I&#39;d template the target type and make it const or not instead."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1542230029, "post_id": 53306439, "comment_id": 93498352, "body": "Ironically, that&#39;s exactly the concept I&#39;m trying to preserve. A <code>const Matrixe</code> should return a <code>const proxy</code> which should return a <code>const int</code>.  A mutable <code>Matrixe</code> should return a mutable <code>proxy</code>, which should return a <code>int&amp;</code>.   Your answer could lead to a <code>const Matrixe</code> return a <code>const proxy</code>, which returns a mutable <code>int&amp;</code>. I understand what you&#39;re saying about <code>const T*</code> vs <code>T* const</code>, but my point is you&#39;ve coded <code>T* const</code>, which, though technically accurate, is a dangerous tool. This is why every stl class has a separate <code>iterator</code> and a <code>const_iterator</code>."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1542234515, "post_id": 53306439, "comment_id": 93500178, "body": "@mooing no <code>T*const</code> is not &quot;dangerous&quot; it is how the language works.  I&#39;ve gone down the path of &quot;make the reference type const for const access&quot; and it falls apart; value types being const for const access is correct, but it is wrong, error prone and bad for reference/pointer types.  Make types as close to regular as you can.  A <code>const_iterator</code> <b>is not and should not be</b> a <code>iterator const</code>.  proxy is not a value type, <code>const_proxy</code> should be a different type than <code>proxy</code>."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542242836, "post_id": 53306439, "comment_id": 93502636, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/183665/discussion-between-mooing-duck-and-yakk-adam-nevraumont\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 1, "last_activity_date": 1542234737, "last_edit_date": 1542234737, "creation_date": 1542219193, "answer_id": 53306439, "question_id": 53306395, "link": "https://stackoverflow.com/questions/53306395/overload-assign-after-overloading/53306439#53306439", "title": "Overload assign after overloading [][]", "body": "<pre><code>int&amp; operator[] (int j)const&amp;&amp;\n</code></pre>\n\n<p>Also delets <code>int j</code> member it is pointless.</p>\n\n<pre><code>int&amp; operator[] (int j) const&amp;&amp; {\n  std::cout &lt;&lt; \"proxy:\\n\\tj = \" &lt;&lt; j &lt;&lt; \" \" &lt;&lt; proxy_data[j] &lt;&lt; std::endl; \n  return proxy_data[i*rows + j];}\n};\n</code></pre>\n\n<p>or better:</p>\n\n<pre><code>    template&lt;class X&gt;\n    class proxy {\n        private:\n            X *proxy_data;\n        public:\n            proxy(X* _proxy_data, std::size_t i, std::size_t stride) : proxy_data(_proxy_data+i*stride) { }\n            X&amp; operator[] (std::size_t j) const&amp;&amp; { return proxy_data[j]; }\n    };\n</code></pre>\n\n<p>use <code>proxy&lt;int&gt;</code> and <code>proxy&lt;const int&gt;</code> as the return value from <code>[]</code> and <code>[] const</code>.</p>\n"}], "owner": {"reputation": 165, "user_id": 5647014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c09a3729b9df4840f225ccf9aba4fa3?s=128&d=identicon&r=PG", "display_name": "rbw", "link": "https://stackoverflow.com/users/5647014/rbw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 53306439, "answer_count": 1, "score": -1, "last_activity_date": 1542234737, "creation_date": 1542219055, "question_id": 53306395, "link": "https://stackoverflow.com/questions/53306395/overload-assign-after-overloading", "title": "Overload assign after overloading [][]", "body": "<p>What begun as a revision of some aspects of C++ has become a sketch of something that could be useful for me. The idea is to use a single array as a double array where indexing is transparent for the user.</p>\n\n<pre><code>class matrice {\n\n    private:\n        int* data;\n        int rows, cols;\n    public:\n        matrice(int _rows, int _cols) : rows(_rows), cols(_cols) { data = new int[_rows*_cols]; std::cout &lt;&lt; \"matrice ctr\" &lt;&lt; std::endl;}\n        // hardcoded 2x2 matrix\n        void set_value() { data[0] = 1; data[1] = 0; data[3] = 1; data[4] = 0;}\n        int get_rows() { return rows;}\n        int get_cols() { return cols;}\n\n        class proxy {\n            private:\n                int i;\n                int j;\n                const int rows; // it is constant so we don't mess up with the size of the matrix\n                int *proxy_data;\n            public:\n                proxy(int* _proxy_data, int _i, const int&amp; _rows) : proxy_data(_proxy_data), i(_i), rows(_rows) { }\n                int operator[] (int _j) { j = _j; std::cout &lt;&lt; \"proxy:\\n\\tj = \" &lt;&lt; j &lt;&lt; \" \" &lt;&lt; proxy_data[j] &lt;&lt; std::endl; return proxy_data[i*rows + j];}\n        };\n\n        proxy operator[] (int i) { std::cout &lt;&lt; \"matrice:\\n\\ti = \" &lt;&lt; i &lt;&lt; std::endl; return proxy(data, i, rows); } \n\n};\n\nint main()\n{\n    int rows = 2;\n    int cols = 2;\n\n    matrice matp(rows, cols);\n    matp.set_value();\n    matp[0][0] = 2;\n    for (int i = 0;i &lt; rows;i++) {\n        for (int j = 0;j &lt; cols;j++) {\n            std::cout &lt;&lt; \"matp[\" &lt;&lt; i &lt;&lt; \"][\" &lt;&lt; j &lt;&lt; \"] = \" &lt;&lt; matp[i][j] &lt;&lt; std::endl;\n        }\n    }\n}\n</code></pre>\n\n<p>So far I can access the data in the array however, I want to assign values to it i.e.:\n    matp[0][0] = 2;</p>\n\n<p>How could I do it ?</p>\n"}, {"tags": ["c++", "include", "bazel", "catch-unit-test"], "answers": [{"tags": [], "owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "is_accepted": false, "score": 2, "last_activity_date": 1542218023, "creation_date": 1542218023, "answer_id": 53306148, "question_id": 53306147, "link": "https://stackoverflow.com/questions/53306147/include-file-downloaded-by-bazel-http-file/53306148#53306148", "title": "Include file downloaded by Bazel http_file", "body": "<p>By default, files downloaded by <code>http_file</code> can be included as:</p>\n\n<pre><code>#include \"external/&lt;name&gt;/file/&lt;file_name&gt;\"\n</code></pre>\n\n<p>In this specific case:</p>\n\n<pre><code>#include \"external/catch/file/catch.hpp\"\n</code></pre>\n\n<p>However, this include path is ugly, it should be wrapped by a <code>cc_library</code>.\nFurthermore, compiling the full catch header file for each test will make the build slow. According to the <a href=\"https://github.com/catchorg/Catch2/blob/master/docs/slow-compiles.md\" rel=\"nofollow noreferrer\">catch docs</a>, the <em>implementation</em> part of the catch header should be compiled separately. Like this:</p>\n\n<p><strong>test/BUILD:</strong></p>\n\n<pre><code>cc_library(\n  name = \"catch\",\n  hdrs = [\"@catch//file\"],\n  srcs = [\"catch.cpp\"],\n  visibility = [\"//visibility:public\"],\n  strip_include_prefix = \"/external/catch/file\",\n  include_prefix = \"catch\",\n  linkstatic = True,   # otherwise main() will could end up in a .so\n)\n\ncc_test(\n  name = \"my_test\",\n  deps = [\"//test:catch\"],\n  srcs = [\"my_test.cc\"],\n)\n</code></pre>\n\n<p><strong>test/catch.cpp:</strong></p>\n\n<pre><code>#define CATCH_CONFIG_MAIN\n#include \"catch/catch.hpp\"\n</code></pre>\n\n<p><strong>test/my_test.cc:</strong></p>\n\n<pre><code>#include \"catch/catch.hpp\"\n\nTEST_CASE(\"my_test\", \"[main]\") { /* ... */ }\n</code></pre>\n\n<p>This way <code>catch.cpp</code> will not be re-compiled if only <code>my_test.cc</code> changes, saving precious seconds.</p>\n"}], "owner": {"reputation": 17902, "user_id": 116273, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cc60634738ece15d1de4738110c76aa8?s=128&d=identicon&r=PG", "display_name": "erenon", "link": "https://stackoverflow.com/users/116273/erenon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542218023, "creation_date": 1542218023, "question_id": 53306147, "link": "https://stackoverflow.com/questions/53306147/include-file-downloaded-by-bazel-http-file", "title": "Include file downloaded by Bazel http_file", "body": "<p>I'm using <a href=\"https://bazel.build\" rel=\"nofollow noreferrer\">Bazel</a> to build my project. I'd like to use the single-header test framework, <a href=\"https://github.com/catchorg/Catch2\" rel=\"nofollow noreferrer\">Catch v2</a>. I decided to use the <a href=\"https://github.com/bazelbuild/bazel/blob/master/tools/build_defs/repo/http.bzl#L254\" rel=\"nofollow noreferrer\">http_file</a> rule to make Bazel download the catch header. My <code>WORKSPACE</code> file looks like this:</p>\n\n<pre><code>load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_file\")\n\nhttp_file(\n  name = \"catch\",\n  downloaded_file_path = \"catch.hpp\",\n  sha256 = \"cc6cc272cf84d8e10fb28f66f52584dedbb80d1234aae69e6a1027af4f31ae6f\",\n  urls = [\"https://github.com/catchorg/Catch2/releases/download/v2.4.2/catch.hpp\"],\n)\n</code></pre>\n\n<p>According to the doc, the test depends on the generated package like this:</p>\n\n<pre><code>cc_test(\n  name = \"my_test\",\n  srcs = [\"@catch//file\", \"my_test.cc\"]\n)\n</code></pre>\n\n<p>The test file <code>my_test.cc</code> can't get any simpler:</p>\n\n<pre><code>#include \"catch.hpp\"\n</code></pre>\n\n<p>However, I get the following error:</p>\n\n<pre><code>$ bazel test --config=opt -s //...\nWARNING: [...]/BUILD:25:10: in srcs attribute of cc_test rule //test:my_test: please do not import '@catch//file:catch.hpp' directly. You should either move the file to this package or depend on an appropriate rule there\nSUBCOMMAND: # //test:my_test [action 'Compiling test/my_test.cc']\n(cd [...] &amp;&amp; \\\n  exec env - [...] \\\n  /usr/bin/gcc\n -U_FORTIFY_SOURCE -fstack-protector -Wall -B/usr/bin -B/usr/bin -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer '-std=c++0x' -MD -MF [...].d '-frandom-seed=[...].o' -fPIC\n -iquote .\n -iquote bazel-out/k8-fastbuild/genfiles\n -iquote bazel-out/k8-fastbuild/bin\n -iquote external/bazel_tools\n -iquote bazel-out/k8-fastbuild/genfiles/external/bazel_tools\n -iquote bazel-out/k8-fastbuild/bin/external/bazel_tools\n -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c test/my_test.cc\n -o [...].o)\nERROR: [...]/BUILD:23:1: C++ compilation of rule '//test:my_test' failed (Exit 1)\ntest/my_test.cc:1:28: fatal error: catch.hpp: No such file or directory\ncompilation terminated.\n[...]\nFAILED: Build did NOT complete successfully\n</code></pre>\n\n<p>Creating a <code>cc_library</code> wrapper, or including <code>catch/catch.hpp</code>, catch/file/catch.hpp produces the same error.</p>\n"}, {"tags": ["c++", "c++11", "pointers", "vector", "copy-constructor"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542217371, "post_id": 53305950, "comment_id": 93492718, "body": "If you have to objects with <code>std::vector</code>s which share &quot;pay-load&quot;, I strongly recommend to use <code>std::shared_ptr</code> instead of raw pointers. This will make your life (and especially sharing instances) easier. Copying a <code>std::vector</code> will copy its elements - raw pointers in your case. It will not copy the pointees - the objects pointed to - not if you don&#39;t do this explicitly in your code."}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542217765, "post_id": 53306064, "comment_id": 93492884, "body": "OP literally says they need a deep copy, so no"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1542217912, "post_id": 53306064, "comment_id": 93492945, "body": "Well if you&#39;re answering a question polar opposite to the question posed because &quot;the OP has no idea&quot;, you&#39;re probably on the wrong website."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1542218414, "post_id": 53306064, "comment_id": 93493161, "body": "@LightnessRacesinOrbit You are interpreting my answer incorrectly. Re-read my first sentence."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542221820, "post_id": 53306064, "comment_id": 93494733, "body": "I didn&#39;t misinterpret your answer, which is self-consistent. However, its stated premise contradicts that of the question. Furthermore it&#39;s hardly unusual that a vector of pointers should be owning, particularly in newcomer code (in production of course I would teach smart pointers instead so the ownership is clear either way), and particularly when a deep copy is specifically requested in the question&#39;s prose."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": -1, "last_activity_date": 1542217768, "last_edit_date": 1542217768, "creation_date": 1542217742, "answer_id": 53306064, "question_id": 53305950, "link": "https://stackoverflow.com/questions/53305950/how-to-copy-constructor-pointer-vector-c/53306064#53306064", "title": "how to copy constructor pointer vector c++", "body": "<p><code>std::vector&lt;Customer*&gt;</code> implies that it does not own <code>Customer</code> objects, merely refers to ones existing elsewhere. In this case you can use compiler-generated copy constructor that does member-wise (shallow) copy for you. E.g.:</p>\n\n<pre><code>Table(const Table&amp; t) = default;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "edited": false, "score": 0, "creation_date": 1542218699, "post_id": 53306073, "comment_id": 93493262, "body": "I wanted to create another vector that will contain new pointer - a new memory allocation, but with the same data. In other words, I want to copy the data to a new memory and save the new pointers in the customersList field. How can I do that ?"}, {"owner": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "edited": false, "score": 0, "creation_date": 1542219449, "post_id": 53306073, "comment_id": 93493616, "body": "This is part of an assignment for school and I can change the signatures of the functions (including the copy-constructor and the fields) so I can&#39;t create smart or shared pointers."}, {"owner": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "edited": false, "score": 0, "creation_date": 1542220158, "post_id": 53306073, "comment_id": 93493942, "body": "Thank you for your time!"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1542219094, "last_edit_date": 1542219094, "creation_date": 1542217784, "answer_id": 53306073, "question_id": 53305950, "link": "https://stackoverflow.com/questions/53305950/how-to-copy-constructor-pointer-vector-c/53306073#53306073", "title": "how to copy constructor pointer vector c++", "body": "<blockquote>\n  <p>Can someone tell me if I made a deep or sallow copy?</p>\n</blockquote>\n\n<p>You made both/either... depending on what level of indirection you're considering.</p>\n\n<p>The copy constructor of <code>std::vector</code> does a deep copy. That is: the vector <code>customersList</code> in the original object, and the vector <code>customersList</code> in the constructed object refer to different internal buffers. If you add a pointer to one, it won't automatically be reflected in the other vector.</p>\n\n<p>However, the elements inside the vector are pointers. The pointers have same values, and point to the same <code>Customer</code> objects, and no <code>Customer</code> objects were copied. As such the copy is shallow.</p>\n\n<hr>\n\n<p>Both suggestions that you show have same result, but the latter is better because it does only one operation with the vector (copy construction) rather than three (default construction of member, copy construction of local, copy assignment of member). If the functionality is correct, even simpler way to achieve same is to use the implicitly generated copy constructor: <code>Table(const Table&amp; t) = default;</code> It does the same, except members are accessed directly, instead of through member functions.</p>\n\n<p>But indeed, you need to consider what you want to copy deeply. Do you need copies of <code>Customer</code> objects? Then you do need a custom copy constructor that copy-initializes those <code>Customer</code> objects. If you do, then you probably should be using a vector of smart pointers rather than bare pointers (assuming you need pointers at all).</p>\n\n<hr>\n\n<blockquote>\n  <p>I wanted to create another vector that will contain new pointer - a new memory allocation, but with the same data. In other words, I want to copy the data to a new memory and save the new pointers in the customersList field.</p>\n</blockquote>\n\n<p>In that case your copy constructor does not do what you want. You have new pointers, which don't have new values, and no memory allocation for customer objects (there is a memory allocation for the vector though). </p>\n\n<blockquote>\n  <p>How can I do that ?</p>\n</blockquote>\n\n<p>You can write a loop that iterates over the vector that is to be copied. Within the loop, you can allocate new customer objects, and copy initialize them with the ones pointed by the vector. Then insert the pointer newly allocated pointer to the member vector that is being constructed.</p>\n\n<p>Note that the pointers will in that case be owning. You should never have owning bare pointers. To re-iterate: In this case you should use smart pointers (assuming you need pointers at all).</p>\n"}, {"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 2, "creation_date": 1542218151, "post_id": 53306103, "comment_id": 93493047, "body": "There is no information in the question on who owns <code>Customer</code> objects and how they are allocated. This code also would not compile."}, {"owner": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "edited": false, "score": 0, "creation_date": 1542218436, "post_id": 53306103, "comment_id": 93493169, "body": "customer and table are separated classes , not inherited."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "edited": false, "score": 0, "creation_date": 1542218578, "post_id": 53306103, "comment_id": 93493217, "body": "@DekelShevach It would be quite surprising for a <code>Customer</code> to be a <code>Table</code> or vice versa."}, {"owner": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "edited": false, "score": 0, "creation_date": 1542219910, "post_id": 53306103, "comment_id": 93493816, "body": "@LightnessRacesinOrbit I&#39;ll create a new customers then. Thanks !"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1542221857, "post_id": 53306103, "comment_id": 93494741, "body": "@MaximEgorushkin Don&#39;t use delete votes for disagreement."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": -1, "last_activity_date": 1542221849, "last_edit_date": 1542221849, "creation_date": 1542217892, "answer_id": 53306103, "question_id": 53305950, "link": "https://stackoverflow.com/questions/53305950/how-to-copy-constructor-pointer-vector-c/53306103#53306103", "title": "how to copy constructor pointer vector c++", "body": "<p>No, you haven't copied the things being pointed to by those vector elements. If I've guessed at your requirement correctly, you'll need to go ahead and do that \"manually\":</p>\n\n<pre><code>Table(const Table&amp; t): capacity(t.getCapacity()), open(t.isOpen()), id(t.getId()){\n    customersList.reserve(t.customersList.size());\n    for (const auto old : t.customersList)\n       customersList.push_back(new Customer(*old));\n}\n</code></pre>\n\n<p>If <code>Customer</code> is the base of an inheritance hierarchy, you're going to need a <code>virtual Customer* clone()</code> member function in each derived class that does the right <code>new</code>, so as to avoid slicing. If it isn't, why store pointers at all? Store values instead and save yourself this entire trouble.</p>\n\n<p>By the way I hope you're properly managing the lifetime of these pointees, including <code>delete</code>. Overall it would generally be better if you used some kind of smart pointer instead of <code>Customer*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1542233094, "creation_date": 1542233094, "answer_id": 53309416, "question_id": 53305950, "link": "https://stackoverflow.com/questions/53305950/how-to-copy-constructor-pointer-vector-c/53309416#53309416", "title": "how to copy constructor pointer vector c++", "body": "<p>Should you need a non-polymorphic answer in C++98/03.  It handles that some pointers in your <code>customersList</code> might no longer point anywhere.</p>\n\n<pre><code>Table(Table const &amp;t) : id(t.id), capacity(t.capacity), open(t.open), orderList(t.orderList) {\n    customersList.reserve(t.customersList.size());\n    std::vector&lt;Customer *&gt;::const_iterator b = t.customersList.begin();\n    std::vector&lt;Customer *&gt;::const_iterator const e = t.customersList.end();\n    for (; b != e; ++b) {\n        if (*b) {\n            customersList.push_back(new Customer(**b));\n        } else {\n            customersList.resize(customersList.size() + 1);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10653332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a09d8c5d2c70ed362581fb2880b1827?s=128&d=identicon&r=PG&f=1", "display_name": "Dekel Shevach", "link": "https://stackoverflow.com/users/10653332/dekel-shevach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 53306073, "answer_count": 4, "score": 0, "last_activity_date": 1542233094, "creation_date": 1542217271, "question_id": 53305950, "link": "https://stackoverflow.com/questions/53305950/how-to-copy-constructor-pointer-vector-c", "title": "how to copy constructor pointer vector c++", "body": "<p>I'm trying to create a copy constructor for a class \"Table\" with the following fields:</p>\n\n<pre><code>private:\n    int id ;\n    int capacity;\n    bool open;\n    std::vector&lt;Customer*&gt; customersList;\n    std::vector&lt;OrderPair&gt; orderList;\n</code></pre>\n\n<p>I want to make a deep copy of all the fields and I've written the following code and I'm not sure I did a deep copy on the customersList since its a pointers vector. Can someone tell me if I made a deep or sallow copy? Thank you in advance.</p>\n\n<p>the code:</p>\n\n<pre><code>Table(const Table&amp; t): capacity(t.getCapacity()), open(t.isOpen()), id(t.getId()){\n    std::vector&lt;Customer*&gt; tmp(t.customersList);\n    customersList = tmp;\n}\n</code></pre>\n\n<p>Or maybe I over copied and I should only do this? :</p>\n\n<pre><code>Table(const Table&amp; t): customersList(t.customersList), capacity(t.getCapacity()), \nopen(t.isOpen()), id(t.getId()){}\n</code></pre>\n\n<p>Thanks again!</p>\n"}, {"tags": ["c++", "c++17", "list-initialization"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1542217005, "post_id": 53305831, "comment_id": 93492546, "body": "What do you mean by &quot;not working&quot; - the code compiles with GCC 8.1.0 and <code>-std=c++17</code>"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 1, "creation_date": 1542217146, "post_id": 53305831, "comment_id": 93492606, "body": "@NeilButterworth He meant about <a href=\"https://wandbox.org/permlink/xI6iTYXN877wbQ7r\" rel=\"nofollow noreferrer\">this</a>. If I understood correctly."}, {"owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1542217222, "post_id": 53305831, "comment_id": 93492652, "body": "@JeJo Yes you are correct."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1542217308, "post_id": 53305831, "comment_id": 93492696, "body": "@JeJo That code isn&#39;t compiled with <code>-std=c++17 </code>"}, {"owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "edited": false, "score": 0, "creation_date": 1542217386, "post_id": 53305831, "comment_id": 93492723, "body": "@NeilButterworth <code>g++ -std=c++17 main.cpp  main.cpp: In function \u2018int main()\u2019: main.cpp:5:56: error: too many initializers for \u2018std::array&lt;std::vector&lt;int&gt;, 2&gt;\u2019      std::array&lt;std::vector&lt;int&gt;, 2&gt; v = { {1,2}, {3,4} };</code>"}, {"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1542265126, "post_id": 53305831, "comment_id": 93508114, "body": "Related: <a href=\"https://stackoverflow.com/questions/52231566/why-cant-a-2d-stdarray-be-initialized-with-two-layers-of-list-initializers\">Why can&#39;t a 2D std::array be initialized with two layers of list-initializers?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "edited": false, "score": 0, "creation_date": 1542218107, "post_id": 53306113, "comment_id": 93493032, "body": "But in my example the double brace is only required for <code>std::array</code>, which is an an aggregate, right? Or is brace elision only allowed when it&#39;s aggregate all the way down?"}, {"owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "edited": false, "score": 0, "creation_date": 1542218493, "post_id": 53306113, "comment_id": 93493182, "body": "I just noticed that <code>std::array&lt;std::vector&lt;int&gt;, 2&gt; v = {std::vector&lt;int&gt;{1,2}, std::vector&lt;int&gt;{3,4}};</code> compiles. Is this also the &quot;does not begin with a left brace&quot; case?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "edited": false, "score": 1, "creation_date": 1542219924, "post_id": 53306113, "comment_id": 93493822, "body": "@Svalorzen that is a different case of explicit initialization covered by <a href=\"http://eel.is/c++draft/dcl.init.aggr#3.2\" rel=\"nofollow noreferrer\">dcl.init.aggrp3.2</a> and <a href=\"http://eel.is/c++draft/dcl.init.aggr#4.2\" rel=\"nofollow noreferrer\">dcl.init.aggrp4.2)</a>"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1542225921, "post_id": 53306113, "comment_id": 93496582, "body": "OP&#39;s example is attempting to elide the braces for the <code>std::vector&lt;int&gt;[2]</code> subaggregate."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1542226146, "post_id": 53306113, "comment_id": 93496681, "body": "@T.C. so are you saying it should work and the compilers are non-conforming or that my choice of words is not correct or that it should not work but I am quoting the wrong parts?"}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1542226489, "post_id": 53306113, "comment_id": 93496826, "body": "<i>If the initializer-list begins with a left brace,</i> Does this means <i>if the first initializer-clause of the initializer-list is a brace-init-list</i>?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1542226973, "post_id": 53306113, "comment_id": 93497053, "body": "This is the right portion of the rules, but you are giving it the wrong interpretation. &quot;subaggregate&quot; doesn&#39;t require &quot;aggregate all the way down&quot;, and <a href=\"https://stackoverflow.com/questions/53305831/brace-elision-in-stdarraystdvector/53308148#comment93493182_53306113\">this example</a> definitely relies on brace elision and is not related to what you quoted in response (<code>std::array</code> has exactly one element)."}], "tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": false, "score": 4, "last_activity_date": 1542231313, "last_edit_date": 1542231313, "creation_date": 1542217929, "answer_id": 53306113, "question_id": 53305831, "link": "https://stackoverflow.com/questions/53305831/brace-elision-in-stdarraystdvector/53306113#53306113", "title": "Brace elision in std::array&lt;std::vector&gt;", "body": "<p>As T.C. pointed out my original interpretation was not corret, brace elision is allowed see <a href=\"http://eel.is/c++draft/dcl.init.aggr#15\" rel=\"nofollow noreferrer\">[dcl.init.aggr]p15</a>:</p>\n\n<blockquote>\n  <p>Braces can be elided in an initializer-list as follows. If the\n  initializer-list begins with a left brace, then the succeeding\n  comma-separated list of initializer-clauses initializes the elements\n  of a subaggregate; it is erroneous for there to be more\n  initializer-clauses than elements. If, however, the initializer-list\n  for a subaggregate does not begin with a left brace, then only enough\n  initializer-clauses from the list are taken to initialize the elements\n  of the subaggregate; any remaining initializer-clauses are left to\n  initialize the next element of the aggregate of which the current\n  subaggregate is an element. ...</p>\n</blockquote>\n\n<p>but <code>std::array</code> according to <a href=\"http://eel.is/c++draft/array#overview-2\" rel=\"nofollow noreferrer\">array.overview</a>:</p>\n\n<blockquote>\n  <p>An array is an aggregate that can be list-initialized with up to N elements whose types are convertible to T.</p>\n</blockquote>\n\n<p>which is not the case we have.</p>\n"}, {"comments": [{"owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "edited": false, "score": 0, "creation_date": 1542228596, "post_id": 53308148, "comment_id": 93497761, "body": "Thank you for the clarification, it was very useful. I&#39;m not sure I fully understood your second remark though. The initialization is not guaranteed in other cases means that it is unspecified behaviour? Why are also double braces disallowed (considering that the brace elision rule was made pretty much for <code>std::array</code> IIUC)?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "edited": false, "score": 2, "creation_date": 1542239573, "post_id": 53308148, "comment_id": 93501786, "body": "Formally, it&#39;s undefined behavior: the standard defines no behavior when a <code>std::array</code> is initialized with anything else. Double braces are not in the &quot;defined to work&quot; case because they are actually an initializer list containing a single element (the inner braced-init-list) with no type. Brace elision goes all the way back to C. <code>std::array</code> has nothing to do with it. The formal UB here is certainly a defect; the problem is finding the right words to define the behavior, preferably without regurgitating the several pages of aggregate initialization rules."}], "tags": [], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": false, "score": 8, "last_activity_date": 1542239642, "last_edit_date": 1542239642, "creation_date": 1542226772, "answer_id": 53308148, "question_id": 53305831, "link": "https://stackoverflow.com/questions/53305831/brace-elision-in-stdarraystdvector/53308148#53308148", "title": "Brace elision in std::array&lt;std::vector&gt;", "body": "<p><code>std::array&lt;std::vector&lt;int&gt;, 2&gt;</code> is effectively</p>\n\n<pre><code>struct array {\n    std::vector&lt;int&gt; elems[2];\n};\n</code></pre>\n\n<p><code>elems</code> is a subaggregate just fine. The issue is that per the language rules, if the initializer starts with a <code>{</code> it's always assumed that you aren't eliding braces; instead, <code>{1, 2}</code> is taken as the initializer of the entire subaggregate <code>elems</code>, attempting to initialize its first element with <code>1</code> and second element with <code>2</code> (this is obviously invalid - you can't convert an integer to a <code>vector</code> - but doesn't affect the interpretation), and <code>{3, 4}</code> is considered the initializer for the thing after <code>elems</code> - and since there are no such thing, it's another error.</p>\n\n<p>Initializing the first element with something that's not a <em>braced-init-list</em> is sufficient to trigger brace elision:</p>\n\n<pre><code>std::array&lt;std::vector&lt;int&gt;, 2&gt; v = { std::vector&lt;int&gt;{1,2}, {3,4} }; \n</code></pre>\n\n<hr>\n\n<p>Note that from a specification perspective, the library doesn't guarantee initialization of <code>std::array&lt;T, N&gt;</code> from anything other than another <code>std::array&lt;T, N&gt;</code> or a list of \"up to N elements whose types are convertible to <code>T</code>\". This notably excludes <em>braced-init-list</em>s because they have no type, and actually also disallows \"double braces\" because that's just a special case of having a single element that is a <em>braced-init-list</em> . </p>\n\n<p>This is an area where we may have been better off specifying it with code. The core language rules defy easy specification in words and the implementation details will leak out - and have already done so.</p>\n"}], "owner": {"reputation": 4961, "user_id": 1356926, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b0e63670616da6afe7de893470a4620b?s=128&d=identicon&r=PG", "display_name": "Svalorzen", "link": "https://stackoverflow.com/users/1356926/svalorzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1542239642, "creation_date": 1542216776, "last_edit_date": 1542217266, "question_id": 53305831, "link": "https://stackoverflow.com/questions/53305831/brace-elision-in-stdarraystdvector", "title": "Brace elision in std::array&lt;std::vector&gt;", "body": "<p>I'm compiling using <code>g++</code> for C++ 17. I have the following:</p>\n\n<pre><code>std::array&lt;std::vector&lt;int&gt;, 2&gt; v = {{ {1,2}, {3,4} }};\n</code></pre>\n\n<p>I don't understand why <em>if I remove</em> the double braces for the array it does not work anymore.</p>\n\n<pre><code>std::array&lt;std::vector&lt;int&gt;, 2&gt; v = { {1,2}, {3,4} }; // Does not compile\n</code></pre>\n\n<p>I understand how <code>std::array</code> works and the need for the double braces in general, but as I'm compiling for C++17 I expected brace elision to come into play.</p>\n\n<p>Why is brace elision not applicable here?</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1542216636, "post_id": 53305767, "comment_id": 93492342, "body": "Why would you want a reference there at all?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1542217115, "post_id": 53305767, "comment_id": 93492597, "body": "You were taking advantage of non-conforming behavior, whereby MSVC by default allowed binding a temporary to a non-const reference. Apparently, it doesn&#39;t anymore. Just drop the ampersand - it doesn&#39;t make sense to use a reference there."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1542220582, "post_id": 53305767, "comment_id": 93494135, "body": "If it used to work fine, that was just an accident."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1542220863, "post_id": 53305767, "comment_id": 93494272, "body": "I suspect that <code>stack.erase(it++);</code> could be undefined, but I can&#39;t find chapter and verse. (I would file it under &quot;too clever; rewrite&quot; just for raising doubts.)"}], "answers": [{"tags": [], "owner": {"reputation": 16695, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": true, "score": 0, "last_activity_date": 1542221661, "last_edit_date": 1542221661, "creation_date": 1542218152, "answer_id": 53306187, "question_id": 53305767, "link": "https://stackoverflow.com/questions/53305767/reference-to-iterator-not-compiling-in-visual-studio-2017/53306187#53306187", "title": "reference to iterator not compiling in visual studio 2017", "body": "<p>Non-const reference to an rvalue is not valid. See <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.cbclx01/cplr116.htm\" rel=\"nofollow noreferrer\">this</a> for more on the topic:</p>\n\n<blockquote>\n  <p>By default, the compiler cannot bind a non-const or volatile lvalue reference to an rvalue.  </p>\n</blockquote>\n\n<p>The most optimal solution here is dropping <code>&amp;</code>, since copying iterators is cheap.</p>\n"}], "owner": {"reputation": 13, "user_id": 5412965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ada9d591c1cf7922dabde515b95c90f?s=128&d=identicon&r=PG&f=1", "display_name": "Micoloth", "link": "https://stackoverflow.com/users/5412965/micoloth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53306187, "answer_count": 1, "score": -1, "last_activity_date": 1542221661, "creation_date": 1542216580, "question_id": 53305767, "link": "https://stackoverflow.com/questions/53305767/reference-to-iterator-not-compiling-in-visual-studio-2017", "title": "reference to iterator not compiling in visual studio 2017", "body": "<p>In my project in Visual c++ in visual studio 2015, I used references to iterators. </p>\n\n<p>I updated to vs2017 today, but the compiler appears to have changed more than I thought. Hopefully I can resolve most problems, but some I don't know why it would change.</p>\n\n<p>For example, I used the snippet</p>\n\n<pre><code>for (auto&amp; it = stack.begin(); it != stack.end() /* not hoisted */; /* no increment */)\n    {\n        if (it-&gt;second-&gt;empty()) { stack.erase(it++); }    // or \"it = m.erase(it)\" since C++11\n        else\n        {\n            auto obj = move(it-&gt;second);\n            stack.erase(it);\n            return move(obj);\n        }\n    }\n</code></pre>\n\n<p>where <code>stack</code> is a <code>std::map&lt;float, std::unique_ptr&lt;StackableObj&gt;</code>.</p>\n\n<p>It worked fine before, but in vs2017 does not compile, instead it produces the type error</p>\n\n<pre><code>Error   C2440   'initializing': cannot convert from 'std::_Tree_iterator&lt;std::_Tree_val&lt;std::_Tree_simple_types&lt;_Ty&gt;&gt;&gt;' to 'std::_Tree_iterator&lt;std::_Tree_val&lt;std::_Tree_simple_types&lt;_Ty&gt;&gt;&gt; &amp;'.\n</code></pre>\n\n<p>What do I do about this, or where do I look in order to know what has been changed? Googling some terms didn't give any specific answers to what is going on. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "gcc", "function-attributes"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542217175, "post_id": 53305586, "comment_id": 93492625, "body": "Note that SSO makes that <i>not</i> allocate memory in actuality."}, {"owner": {"reputation": 80313, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542217287, "post_id": 53305586, "comment_id": 93492686, "body": "@Yakk-AdamNevraumont, What is the SSO? What if the length of string constant is not 1 char, but 100? (Updated example, there was real call to malloc)"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542218057, "post_id": 53305586, "comment_id": 93493009, "body": "@osgx Short or Small String Optimization; all modern std strings store short things within their own buffer.  So the original example  had no allocations."}, {"owner": {"reputation": 80313, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542221186, "post_id": 53305586, "comment_id": 93494434, "body": "@Yakk-AdamNevraumont, it had allocation for the std::string object itself."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542227091, "post_id": 53305586, "comment_id": 93497107, "body": "std string lives in automatic storage."}], "answers": [{"tags": [], "owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "is_accepted": false, "score": 1, "last_activity_date": 1558695985, "last_edit_date": 1592644375, "creation_date": 1558695985, "answer_id": 56291389, "question_id": 53305586, "link": "https://stackoverflow.com/questions/53305586/is-function-declared-as-attribute-pure-allowed-to-return-newly-construct/56291389#56291389", "title": "Is function declared as __attribute__ ((pure)) allowed to return newly constructed std::string", "body": "<p>This documentation has been updated or you quoted it incorrectly. Now the part you quoted speaks about &quot;observable side effects&quot;, instead of &quot;side effects&quot;.</p>\n<h1>What a pure function means:</h1>\n<blockquote>\n<p>The pure attribute prohibits a function from modifying the state of the program that is observable by means other than inspecting the function\u2019s return value.</p>\n<p>tells GCC that subsequent calls to [the function] with the same string can be replaced by the result of the first call provided the state of the program observable by [the function] does not change in between.</p>\n</blockquote>\n<p>So the question you should ask is not &quot;is this legal&quot;, but &quot;if the second call is removed by the optimizer, does the behavior of my program change&quot;. If the answer is &quot;no&quot;, you can use the attribute. The behavior of pure and const functions is not enforced by the compiler, it is just a hint to the optimizer.</p>\n<h1>Does returning <code>std::string</code> have observable side effects?</h1>\n<p><code>std::string</code> allocates memory. You could take the address of the internal buffer, and put it into a global variable. In such case the side effect would be observable.</p>\n<p>A const function would not read global variables, so this side effect would not be observable in the function itself. But you could print the address of the internal buffer after calling the function, and see whether you have two distinct objects.</p>\n<p>If you used the string like you normally would, instead of trying to break your program, the side effect would not be observable.</p>\n"}], "owner": {"reputation": 80313, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1558695985, "creation_date": 1542215925, "last_edit_date": 1542217352, "question_id": 53305586, "link": "https://stackoverflow.com/questions/53305586/is-function-declared-as-attribute-pure-allowed-to-return-newly-construct", "title": "Is function declared as __attribute__ ((pure)) allowed to return newly constructed std::string", "body": "<p>In gnu world of C/C++ with GCC compiler there is <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Function-Attributes.html\" rel=\"nofollow noreferrer\">Common function attribute</a> \"pure\" (which is like \"const\" attribute, but with less restrictions):</p>\n\n<blockquote>\n  <p>Many functions have no effects except the return value and their return value depends only on the parameters and/or global variables.  ... Some common examples of pure functions are strlen or memcmp.  ... The pure attribute imposes similar but looser restrictions on a function\u2019s defintion than the const attribute: it allows the function to read global variables. ...  Because a pure function cannot have any side effects it does not make sense for such a function to return void. </p>\n</blockquote>\n\n<p>Is it allowed to pure function to call any C++ STL constructors like <code>std::string</code> or <code>std::vector</code>? For example, is this code legal and why it is not? (Will it be legal with <code>__attribute__((const))</code>?)</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;cstdio&gt;\n__attribute__((pure)) std::string GetFilesystemSeparator(int unixvar) {\n   if(unixvar) {\n      return \"/\";   \n   } else {\n      return \"\\\\\";\n   }\n}\n\nint main() {\n    std::string dirname1=\"dir1\";\n    std::string dirname2=\"dir2\";\n    std::string filename=\"file\";\n    int unixvar;\n    std::string path;\n    puts(\"Unix style:\");\n    unixvar = 1;\n    path=dirname1 + GetFilesystemSeparator(unixvar) + dirname2 +  GetFilesystemSeparator(unixvar) + filename;\n    puts(path.c_str());\n\n\n    puts(\"Not Unix style:\");\n    unixvar = 0;\n    path=dirname1 + GetFilesystemSeparator(unixvar) + dirname2 +  GetFilesystemSeparator(unixvar) + filename;\n    puts(path.c_str());\n    return 0;\n}\n\ng++ pure.cc -o pure -fverbose-asm --save-temps\nclang++ pure.cc -o pure1 -O3 -save-temps\n</code></pre>\n\n<p>There are some calls to complex std::sting constructor, which may allocate memory and write to some global variables which are used to manage free and allocated memory:</p>\n\n<pre><code>less  pure.s\n...\n_Z22GetFilesystemSeparatorB5cxx11i:\n    call    _ZNSaIcEC1Ev@PLT        #\n    call    _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEC1EPKcRKS3_@PLT    #\n</code></pre>\n\n<p>For example, after changing the length of <code>\"/\"</code> and <code>\"\\\\\"</code> constants to 100 chars, I have <code>new</code> and <code>malloc(101)</code> calls from the constructor:</p>\n\n<pre><code>ltrace -e '*@*' ./pure3\n...\nlibstdc++.so.6-&gt;strlen(\"////////////////////////////////\"...)                         = 100\nlibstdc++.so.6-&gt;_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE12_M_constructIPKcEEvT_S8_St20forward_iterator_tag(0x7ffc7b66a840, 0x558899f74570, 0x558899f745d4, 0 &lt;unfinished ...&gt;\nlibstdc++.so.6-&gt;_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE9_M_createERmm(0x7ffc7b66a840, 0x7ffc7b66a6b0, 0, 0 &lt;unfinished ...&gt;\nlibstdc++.so.6-&gt;_Znwm(101, 0x7ffc7b66a6b0, 0, 0 &lt;unfinished ...&gt;\nlibstdc++.so.6-&gt;malloc(101)                                                           = 0x55889bef0c20\n&lt;... _Znwm resumed&gt; )                                                                 = 0x55889bef0c20\n&lt;... _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE9_M_createERmm resumed&gt; )   = 0x55889bef0c20\nlibstdc++.so.6-&gt;memcpy(0x55889bef0c20, \"////////////////////////////////\"..., 100)    = 0x55889bef0c20\n</code></pre>\n"}, {"tags": ["c++", "qt", "clang", "qt-creator", "llvm-clang"], "comments": [{"owner": {"reputation": 6147, "user_id": 3767076, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/64707b213de57fb785081ba23aaea2cd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/3767076/felix"}, "edited": false, "score": 1, "creation_date": 1542500818, "post_id": 53305428, "comment_id": 93591335, "body": "QtCreator 4.8 (currently the beta) comes with support for the language-server-protocol. This might be a good alternative"}, {"owner": {"reputation": 414, "user_id": 5853141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce8326b6ce3356066944f644e5c0ba0c?s=128&d=identicon&r=PG&f=1", "display_name": "Frederik De Ruyck", "link": "https://stackoverflow.com/users/5853141/frederik-de-ruyck"}, "edited": false, "score": 0, "creation_date": 1542645605, "post_id": 53305428, "comment_id": 93633811, "body": "Probably those settings only apply to the visual output in the edit pane. I can see the warnings disappear when I apply &quot;level0 checks&quot; for instance. When I select &quot;almost everything&quot; option they re-appear instantly."}], "answers": [{"comments": [{"owner": {"reputation": 2522, "user_id": 1490214, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Tjpis.jpg?s=128&g=1", "display_name": "aalimian", "link": "https://stackoverflow.com/users/1490214/aalimian"}, "edited": false, "score": 0, "creation_date": 1543257426, "post_id": 53429857, "comment_id": 93843863, "body": "I tried it. Still getting the same bugs. Which option should I go with?"}, {"owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "reply_to_user": {"reputation": 2522, "user_id": 1490214, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Tjpis.jpg?s=128&g=1", "display_name": "aalimian", "link": "https://stackoverflow.com/users/1490214/aalimian"}, "edited": false, "score": 0, "creation_date": 1543258563, "post_id": 53429857, "comment_id": 93844439, "body": "@armanali I have updated my answer. I am not sure you can have clang ignore 3rd-party headers though. You could also try Qt Creator 4.8, the release candidate was published last week and is available in the Qt Online Installer."}], "tags": [], "owner": {"reputation": 7319, "user_id": 2667360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKqx3.png?s=128&g=1", "display_name": "Benjamin T", "link": "https://stackoverflow.com/users/2667360/benjamin-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1543258598, "last_edit_date": 1543258598, "creation_date": 1542885716, "answer_id": 53429857, "question_id": 53305428, "link": "https://stackoverflow.com/questions/53305428/qtcreator-and-clangcodemodel-plugin/53429857#53429857", "title": "QtCreator and ClangCodeModel plugin", "body": "<p>The screenshot you took is from the \"Analyzer\" settings.\nThe Analyzer performs on-demand checks like running static analysis, clang-tidy, callgrind, etc.</p>\n\n<p>To configure the Code Model, you should go to \"C++ > Code Model\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ba4sE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ba4sE.png\" alt=\"enter image description here\"></a></p>\n\n<p>You also have the possibility to override this settings on a per-project basis:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IAWcE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IAWcE.png\" alt=\"enter image description here\"></a></p>\n\n<p>In both cases you can, by clicking on <code>Manage...</code>, create your own configuration with whatever flags you want:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qsVpB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qsVpB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2522, "user_id": 1490214, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Tjpis.jpg?s=128&g=1", "display_name": "aalimian", "link": "https://stackoverflow.com/users/1490214/aalimian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 1, "accepted_answer_id": 53429857, "answer_count": 1, "score": 2, "last_activity_date": 1543258598, "creation_date": 1542215305, "question_id": 53305428, "link": "https://stackoverflow.com/questions/53305428/qtcreator-and-clangcodemodel-plugin", "title": "QtCreator and ClangCodeModel plugin", "body": "<p>I just installed <code>QtCreator 4.7.2</code>, which comes with <code>ClangCodeModel</code> plugin by default on. After my <code>CMake</code> project was parsed I saw much better highlighting of keywords in the code and also awesome intellisense handling of <code>auto</code> declared variables.</p>\n\n<p>The downside was that the <code>ClangCodeModel</code> plugin was buggy, and gave me errors and warnings in parts of code that didn't make sense, especially the ones in 3rd party library header files. So I was forced to turn it off.</p>\n\n<p>I'm wondering if <code>Clang</code> can be configured in <code>QtCreator</code>, so that minimal checks can happen. I played with these settings, but nothing made a difference:</p>\n\n<p><a href=\"https://i.stack.imgur.com/703i9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/703i9.png\" alt=\"enter image description here\"></a></p>\n\n<p>1) Has anyone been able to configure this plugin in <code>QtCreator</code> so that it can work better? I am mostly concerned about intellisense. I can open the same <code>CMake</code> project in <code>Visual Studio</code> and I have much better intellisense there, but I prefer using <code>Qt Creator.</code></p>\n\n<p>2) If #1 is not possible because the plugin has bugs, what are the other means of improving intellisense in <code>Qt Creator</code> with <code>CMake</code> projects?</p>\n"}, {"tags": ["c++", "doxygen"], "answers": [{"tags": [], "owner": {"reputation": 270, "user_id": 1156580, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723a3388694475db06baf745955b8481?s=128&d=identicon&r=PG", "display_name": "David Levy", "link": "https://stackoverflow.com/users/1156580/david-levy"}, "is_accepted": true, "score": 4, "last_activity_date": 1542235533, "creation_date": 1542235533, "answer_id": 53309857, "question_id": 53305408, "link": "https://stackoverflow.com/questions/53305408/no-uniquely-matching-class-member-found-for-a-template-instanciation/53309857#53309857", "title": "no uniquely matching class member found for a template instanciation", "body": "<p>Didnt find a correct syntax, but a kind of workaround:</p>\n\n<pre><code>/// \\relates LP::LF::FileReader\ntemplate void LP::LF::FileReader::Read&lt;uint8_t&gt;( uint8_t * );\n</code></pre>\n\n<p>Not sure why, but it silences the warning</p>\n"}], "owner": {"reputation": 270, "user_id": 1156580, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723a3388694475db06baf745955b8481?s=128&d=identicon&r=PG", "display_name": "David Levy", "link": "https://stackoverflow.com/users/1156580/david-levy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 53309857, "answer_count": 1, "score": 4, "last_activity_date": 1542235533, "creation_date": 1542215226, "last_edit_date": 1542222478, "question_id": 53305408, "link": "https://stackoverflow.com/questions/53305408/no-uniquely-matching-class-member-found-for-a-template-instanciation", "title": "no uniquely matching class member found for a template instanciation", "body": "<p>I have a class with a templated function. The function is specialized/instanciated so it can be defined in the cpp. Doxygen gives me an error about the template instanciation.</p>\n\n<p>For example, my .h:</p>\n\n<pre><code>namespace LP\n{\n    namespace LF\n    {\n        class FileReader\n        {\n        public:\n            template &lt;class T&gt; void Read( T *aValue );\n            size_t Read( uint8_t *aBuffer, size_t aSizeToRead );\n        };\n    }\n}\n</code></pre>\n\n<p>And my cpp:</p>\n\n<pre><code>/// Valid doxygen function doc\ntemplate&lt;class T&gt;\nvoid\nLP::LF::FileReader::Read( T *aValue )\n{\n    Read( reinterpret_cast&lt;uint8_t *&gt;( aValue ), sizeof( T ) );\n}\n\n//Template specialisation so it can be defined in the cpp file\ntemplate void LP::LF::FileReader::Read&lt;uint8_t&gt;( uint8_t * );\ntemplate void LP::LF::FileReader::Read&lt;uint16_t&gt;( uint16_t * );\ntemplate void LP::LF::FileReader::Read&lt;uint32_t&gt;( uint32_t * );\n</code></pre>\n\n<p>I got this error for all 3 lines of specialization:</p>\n\n<pre><code>warning: no uniquely matching class member found for \n  template void LP::LF::FileReader::Read&lt; uint8_t &gt;(uint8_t *)\nPossible candidates:\n  'template &lt; T &gt;\n  void LP::LF::FileReader::Read(T *aValue)' at line 48 of file FileReader.h\n  size_t LP::LF::FileReader::Read(uint8_t *aBuffer, size_t aSizeToRead)' at line 49 of file FileReader.h\n</code></pre>\n\n<p>If I rename one of the Read functions, it fixes the error, but I would prefer not to do it.</p>\n\n<p>The specialization dont need to be documented, the generic function is already documented</p>\n\n<p>doxygen 1.8.13</p>\n\n<p>Thanks</p>\n\n<p>EDIT: changed title to instanciation from specialization</p>\n"}, {"tags": ["c++", "c++17", "variadic-templates", "stdtuple", "structure-of-arrays"], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 4, "last_activity_date": 1542215939, "creation_date": 1542215939, "answer_id": 53305592, "question_id": 53305395, "link": "https://stackoverflow.com/questions/53305395/how-to-create-a-tuple-of-vectors-of-type-deduced-from-a-variadic-template-in-c/53305592#53305592", "title": "How to create a tuple of vectors of type deduced from a variadic template in C++17?", "body": "<p>You might do with <code>std::index_sequence</code>:</p>\n\n<pre><code>template&lt;class ... Ts&gt;\nclass Collection\n{\n    std::tuple&lt;std::vector&lt;Ts&gt;...&gt; m_col;\n\nprivate:\n\n    template &lt;std::size_t ... Is&gt;\n    void addRow(std::index_sequence&lt;Is...&gt;, const std::tuple&lt;Ts...&gt;&amp; data)\n    {\n        (std::get&lt;Is&gt;(m_col).push_back(std::get&lt;Is&gt;(data)), ...);\n    } \n\npublic:\n    void addRow(const std::tuple&lt;Ts...&gt;&amp; data)\n    {\n        addRow(std::index_sequence_for&lt;Ts...&gt;(), data);\n    } \n\n};\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/f391302295730769\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 4, "last_activity_date": 1542219359, "last_edit_date": 1542219359, "creation_date": 1542218053, "answer_id": 53306158, "question_id": 53305395, "link": "https://stackoverflow.com/questions/53305395/how-to-create-a-tuple-of-vectors-of-type-deduced-from-a-variadic-template-in-c/53306158#53306158", "title": "How to create a tuple of vectors of type deduced from a variadic template in C++17?", "body": "<p>You're using C++17 so... what about using template folding and some <code>std::apply()</code>?</p>\n\n<p>I mean</p>\n\n<pre><code>template &lt;typename ... Ts&gt;\nclass Collection\n {\n   private:\n      std::tuple&lt;std::vector&lt;Ts&gt;...&gt; m_col;\n\n   public:\n      void addRow (std::tuple&lt;Ts...&gt; const &amp; data)\n       {\n          std::apply([&amp;](auto &amp; ... vectors){\n                     std::apply([&amp;](auto &amp; ... values){\n                                (vectors.push_back(values), ...);},\n                                data); },\n                     m_col);        \n       } \n\n      void show () const\n       {\n         std::apply([](auto &amp; ... vectors){\n             ((std::cout &lt;&lt; vectors.size() &lt;&lt; '\\n'), ...);}, m_col);\n       }\n };\n</code></pre>\n"}], "owner": {"reputation": 2698, "user_id": 2030532, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ac8b7394596f759b9688d2ed419db6e6?s=128&d=identicon&r=PG", "display_name": "motam79", "link": "https://stackoverflow.com/users/2030532/motam79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 1, "accepted_answer_id": 53306158, "answer_count": 2, "score": 3, "last_activity_date": 1542228578, "creation_date": 1542215176, "last_edit_date": 1542228578, "question_id": 53305395, "link": "https://stackoverflow.com/questions/53305395/how-to-create-a-tuple-of-vectors-of-type-deduced-from-a-variadic-template-in-c", "title": "How to create a tuple of vectors of type deduced from a variadic template in C++17?", "body": "<p>I have implemented a collection class that converts a vector of tuples to a tuple of vectors (it is essentially an AOS to SOA conversion). This code works for this example of two template classes. I was trying to make it more generic  by using variadic templates. In order to do that I need to create the type for the member variable <code>m_col</code>. In C++17, is it possible to convert a tuple to a tuple of vectors? So the type of the member variance <code>m_col</code> in this example will be generated automatically from template types.</p>\n\n<pre><code>template&lt;class T1, class T2&gt;\nclass Collection\n{\n    std::tuple&lt;std::vector&lt;T1&gt;, std::vector&lt;T2&gt;&gt; m_col;\n\npublic:\n    void addRow(const std::tuple&lt;T1, T2&gt;&amp; data)\n    {\n        std::get&lt;0&gt;(m_col).push_back(std::get&lt;0&gt;(data));\n        std::get&lt;1&gt;(m_col).push_back(std::get&lt;1&gt;(data));\n    } \n\n    void show()\n    {\n        std::cout &lt;&lt; std::get&lt;0&gt;(m_col1).size() &lt;&lt;std::endl;\n    }\n};\n\n\nint main()\n{\n    using data_t = std::tuple&lt;int, double&gt;;\n    data_t data{1,1.0};\n    using col_t = Collection&lt;int, double&gt;;\n    col_t col;\n    col.addRow(data);    \n    col.show();\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "assembly", "x86", "inline-assembly"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1542215248, "post_id": 53305310, "comment_id": 93491626, "body": "The registers are real.  Yes, the performance is generally improved if you use them.  Note that the C compiler has a very good optimiser that often does a lot better job at picking registers than you, so you should avoid using inline assembly unless you know exactly what you are doing."}, {"owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "edited": false, "score": 0, "creation_date": 1542227802, "post_id": 53305310, "comment_id": 93497419, "body": "Some C compilers, such as armcc,  do use virtual registers in inline assembly. Neither Microsoft or GCC inline assembly does."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 10576039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwd0W5OhicY/AAAAAAAAAAI/AAAAAAAAAK4/cmT9fylFP34/photo.jpg?sz=128", "display_name": "Ramtin Mousavi", "link": "https://stackoverflow.com/users/10576039/ramtin-mousavi"}, "edited": false, "score": 0, "creation_date": 1542218843, "post_id": 53305506, "comment_id": 93493312, "body": "so there is another question, for example my processor is a core i5 processor which certainly has a different architecture from x86. I mean it probably has more registers than x86. and inline assembly has just a few x86 registers. what about the other registers ?"}, {"owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 259, "user_id": 10576039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwd0W5OhicY/AAAAAAAAAAI/AAAAAAAAAK4/cmT9fylFP34/photo.jpg?sz=128", "display_name": "Ramtin Mousavi", "link": "https://stackoverflow.com/users/10576039/ramtin-mousavi"}, "edited": false, "score": 0, "creation_date": 1542219196, "post_id": 53305506, "comment_id": 93493477, "body": "@RamtinMousavi: Your i5 is an x86-64 CPU.  It can run in 32-bit or 64-bit mode.  MSVC inline asm isn&#39;t available when compiling for 64-bit mode.  Compiler-generated code can use 64-bit registers just fine.  When running in 32-bit mode, you &quot;only&quot; get the 8 instead of 16 integer registers and xmm/ymm/zmm 0..7 instead of xmm/ymm0..15 or zmm0..31  But you still have the x87 stack, MPX bound registers, EFLAGS, and segment, debug, and control registers."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 259, "user_id": 10576039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwd0W5OhicY/AAAAAAAAAAI/AAAAAAAAAK4/cmT9fylFP34/photo.jpg?sz=128", "display_name": "Ramtin Mousavi", "link": "https://stackoverflow.com/users/10576039/ramtin-mousavi"}, "edited": false, "score": 0, "creation_date": 1542544727, "post_id": 53305506, "comment_id": 93598507, "body": "@RamtinMousavi Of course your CPU is an x86 CPU with the x86 architecture.  It does have other registers, but they are not general-purpose registers like eax, ebx, etc., so you can&#39;t use them directly for the same purpose."}, {"owner": {"reputation": 259, "user_id": 10576039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwd0W5OhicY/AAAAAAAAAAI/AAAAAAAAAK4/cmT9fylFP34/photo.jpg?sz=128", "display_name": "Ramtin Mousavi", "link": "https://stackoverflow.com/users/10576039/ramtin-mousavi"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1542561541, "post_id": 53305506, "comment_id": 93603626, "body": "@fuz thanks. i didn&#39;t know all core ix cpus are x86 too. do all intel cpus which are released after 8086 use same assembly lang?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 259, "user_id": 10576039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwd0W5OhicY/AAAAAAAAAAI/AAAAAAAAAK4/cmT9fylFP34/photo.jpg?sz=128", "display_name": "Ramtin Mousavi", "link": "https://stackoverflow.com/users/10576039/ramtin-mousavi"}, "edited": false, "score": 1, "creation_date": 1542564154, "post_id": 53305506, "comment_id": 93604435, "body": "@RamtinMousavi While Intel also makes processors with other architectures, all Intel CPUs you are going to encounter normally are x86 processors.  Same for AMD processors.  If the architecture was different, then x86 programs would not run on these chips without being recompiled first."}], "tags": [], "owner": {"reputation": 240669, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1542215596, "creation_date": 1542215596, "answer_id": 53305506, "question_id": 53305310, "link": "https://stackoverflow.com/questions/53305310/registers-of-inline-assembly-block-are-real-or-fake/53305506#53305506", "title": "registers of inline assembly block are real or fake?", "body": "<p><strong>They're real registers, the same ones that compiler-generated asm uses.</strong>  After assembling compiler output to machine code, there's no difference between which instructions came from inline asm vs. which ones were emitted by the compiler.</p>\n\n<blockquote>\n  <p>Does using this registers (like eax , ebx and etc.) improve the performance ?</p>\n</blockquote>\n\n<p>Compared to what?  <strong>Compiler-generated code already uses registers, so no, you can't usually beat the compiler using inline asm unless you know exactly what you're doing.</strong>  (e.g. you've read and understood all of <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">Agner Fog's optimization guides</a>, Intel's optimization manual, and so on.  See more links in <a href=\"https://stackoverflow.com/tags/x86/info\">https://stackoverflow.com/tags/x86/info</a>).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/40354978/c-code-for-testing-the-collatz-conjecture-faster-than-hand-written-assembly\">C++ code for testing the Collatz conjecture faster than hand-written assembly - why?</a> is a good example of hand-written asm being worse than compiler-generated asm.</p>\n\n<p>The more you (or the compiler) keep variables in registers the better, when they change frequently.  You can't <em>avoid</em> using registers because x86 doesn't have memory-to-memory instructions outside of a few special instructions.  But you can (and should) avoid using memory.</p>\n\n<hr>\n\n<p><strong>And even then, MSVC's poor inline-asm syntax makes it impossible to pass data into inline asm without bouncing it through memory, so you'd need to write a whole loop in asm to mitigate that overhead.</strong></p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/3323445/what-is-the-difference-between-asm-asm-and-asm/35959859#35959859\">What is the difference between &#39;asm&#39;, &#39;__asm&#39; and &#39;__asm__&#39;?</a> for more about that, and an example of the final compiler output for a simple function using MSVC inline asm that shows the compiler-generated instructions as well.</p>\n\n<p>(You can do that yourself for any code using <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">https://godbolt.org/</a>.  See also <a href=\"https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output\">How to remove &quot;noise&quot; from GCC/clang assembly output?</a> for more about looking at compiler output.)</p>\n\n<p>Most of the reasons in <a href=\"https://gcc.gnu.org/wiki/DontUseInlineAsm\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/wiki/DontUseInlineAsm</a> apply to MSVC asm as well as GNU C asm.</p>\n"}], "owner": {"reputation": 259, "user_id": 10576039, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwd0W5OhicY/AAAAAAAAAAI/AAAAAAAAAK4/cmT9fylFP34/photo.jpg?sz=128", "display_name": "Ramtin Mousavi", "link": "https://stackoverflow.com/users/10576039/ramtin-mousavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 53305506, "answer_count": 1, "score": 0, "last_activity_date": 1542215596, "creation_date": 1542214875, "question_id": 53305310, "link": "https://stackoverflow.com/questions/53305310/registers-of-inline-assembly-block-are-real-or-fake", "title": "registers of inline assembly block are real or fake?", "body": "<p>Microsoft visual studio has a feature named \"Inline assembly\" which gives you the ability of writing your x86 codes in a c++ program inside __asm block.</p>\n\n<p>Now i have a question about this feature.</p>\n\n<p>Are the registers in this block real registers or just some virtualization from registers ? </p>\n\n<p>Does using this registers (like eax , ebx and etc.) improve the performance ?</p>\n"}, {"tags": ["c++", "c++11", "copy-assignment"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 2, "creation_date": 1542214864, "post_id": 53305257, "comment_id": 93491398, "body": "What is wrong is you failed to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  In it you probably have a const field in<code>Dish</code>.  In addition, your <code>operator=</code> appears frankly insane."}, {"owner": {"reputation": 59, "user_id": 3271251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfbe4f58a96d727d403c3f17b9bd70c?s=128&d=identicon&r=PG&f=1", "display_name": "Sprint21", "link": "https://stackoverflow.com/users/3271251/sprint21"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1542217245, "post_id": 53305257, "comment_id": 93492665, "body": "I fixed it a little bit, I do have a const field in Dish, what&#39;s wrong with that?"}], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 0, "last_activity_date": 1542215039, "creation_date": 1542215039, "answer_id": 53305359, "question_id": 53305257, "link": "https://stackoverflow.com/questions/53305257/copy-assignment-operator-vector/53305359#53305359", "title": "Copy assignment operator, vector", "body": "<p>It's the move assignment, so move your objects:</p>\n\n<pre><code>open = std::move(other.open);\nmenu = std::move(other.menu);\n</code></pre>\n\n<p><code>open</code> or <code>menu</code> probably don't allow to be copied, hence the error.</p>\n\n<p>You don't need to clear <code>menu</code>, because you are replacing the content with another object.</p>\n"}], "owner": {"reputation": 59, "user_id": 3271251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfbe4f58a96d727d403c3f17b9bd70c?s=128&d=identicon&r=PG&f=1", "display_name": "Sprint21", "link": "https://stackoverflow.com/users/3271251/sprint21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542217078, "creation_date": 1542214689, "last_edit_date": 1542217078, "question_id": 53305257, "link": "https://stackoverflow.com/questions/53305257/copy-assignment-operator-vector", "title": "Copy assignment operator, vector", "body": "<p>I have this vector that hold values (Not on the Heap!)</p>\n\n<pre><code>std::vector&lt;Dish&gt; menu;\n</code></pre>\n\n<p>I want to implement copy assignment operator like this:</p>\n\n<pre><code>    Restaurant &amp;Restaurant::operator=(Restaurant &amp;&amp;other) {\n    if (this == &amp;other)\n        return *this;\n    open = other.open;\n\n    menu = std::move(other.menu);\n}\n</code></pre>\n\n<p>I get those error/warnings:</p>\n\n<pre><code>        ^\n/Users/avivlevitzky/CLionProjects/SPL-Project-1/Restaurant.cpp:49:10: note: in instantiation of member function 'std::__1::vector&lt;Dish, std::__1::allocator&lt;Dish&gt; &gt;::operator=' requested here\n    menu = other.menu;\n         ^\n/Users/avivlevitzky/CLionProjects/SPL-Project-1/Dish.h:18:15: note: copy assignment operator of 'Dish' is implicitly deleted because field 'id' is of const-qualified type 'const int'\n    const int id;\n</code></pre>\n\n<p>What's wrong??</p>\n"}, {"tags": ["c++", "copy-constructor"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 4, "creation_date": 1542214291, "post_id": 53305134, "comment_id": 93491084, "body": "Please edit your question to contain <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. From error message though it seems that <code>size()</code> is not a const method."}, {"owner": {"reputation": 49, "user_id": 10627863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4915a369a724ff95b3b398a1da9f36?s=128&d=identicon&r=PG&f=1", "display_name": "Ninhow", "link": "https://stackoverflow.com/users/10627863/ninhow"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1542214440, "post_id": 53305134, "comment_id": 93491159, "body": "THank you, i will try to edit my question!"}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1542214475, "post_id": 53305172, "comment_id": 93491176, "body": "Even when correct, answering a low-quality question only encourages more low-quality questions."}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 4, "creation_date": 1542214544, "post_id": 53305172, "comment_id": 93491219, "body": "Why is this a low quality question? They have a small snippet of code and enough of the compilation error to identify the issue. There&#39;s definitely some improvements the OP could make, but seems like a fine question to me, which is why I answered it."}, {"owner": {"reputation": 49, "user_id": 10627863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4915a369a724ff95b3b398a1da9f36?s=128&d=identicon&r=PG&f=1", "display_name": "Ninhow", "link": "https://stackoverflow.com/users/10627863/ninhow"}, "edited": false, "score": 0, "creation_date": 1542215055, "post_id": 53305172, "comment_id": 93491503, "body": "Yeah why not downvote my question so i get banned, not even argumenting why it is a low-quality question. Like i said before i am gonna edit, not done yet! That is a big reason why people get banned and can never come back from it."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542216159, "post_id": 53305172, "comment_id": 93492088, "body": "To be fair, you could have Googled that error message and got your solution really quickly; your question shows no research effort. I haven&#39;t downvoted it but let&#39;s not go overboard defending this question."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542229174, "post_id": 53305172, "comment_id": 93498008, "body": "@CoryKramer it lacked MCVE when I posted my comment. Now, when MCVE is there, it is OK"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 3, "last_activity_date": 1542214358, "creation_date": 1542214358, "answer_id": 53305172, "question_id": 53305134, "link": "https://stackoverflow.com/questions/53305134/trying-to-create-a-copy-constructor-how-can-i-fix-this-problem/53305172#53305172", "title": "Trying to create a copy-constructor, how can i fix this problem?", "body": "<p>It looks like your <code>int_buffer::size</code> method is not const. It should have a signature like</p>\n\n<pre><code>std::size_t int_buffer::size() const;\n</code></pre>\n\n<p>The reason is because you are passing <code>const int_buffer&amp; rhs</code> so you cannot call any non-const methods off of that object.</p>\n"}], "owner": {"reputation": 49, "user_id": 10627863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe4915a369a724ff95b3b398a1da9f36?s=128&d=identicon&r=PG&f=1", "display_name": "Ninhow", "link": "https://stackoverflow.com/users/10627863/ninhow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53305172, "answer_count": 1, "score": 0, "last_activity_date": 1542215961, "creation_date": 1542214236, "last_edit_date": 1542215961, "question_id": 53305134, "link": "https://stackoverflow.com/questions/53305134/trying-to-create-a-copy-constructor-how-can-i-fix-this-problem", "title": "Trying to create a copy-constructor, how can i fix this problem?", "body": "<p>I have made a copy constructor and I am trying to initialize a buffer of the same size of rhs but i am getting an error. I am expecting a container being created with the same size of the rhs with the help of the size() function in the class.</p>\n\n<pre><code>int_buffer::int_buffer(const int_buffer&amp; rhs): ptr_begin(new int[rhs.size()]){\n    std::cout &lt;&lt; \"Copy Constructor running...\" &lt;&lt; '\\n';\n    std::copy(rhs.begin(), rhs.end(), begin());\n}\n</code></pre>\n\n<p>size</p>\n\n<pre><code>size_t int_buffer::size(){\n    return ptr_end - ptr_begin;\n}\n</code></pre>\n\n<p>The error i am receiving is:\nThe object has type qualifiers that are not compatible with the member function \"int_buffer::size\" object type is: const int_buffer.</p>\n\n<p><strong>SOLUTION</strong></p>\n\n<pre><code>size_t int_buffer::size() const{\n    return ptr_end - ptr_begin;\n}\n</code></pre>\n\n<p>The solution to my problem was that my size function was not a const.</p>\n"}, {"tags": ["c++", "qt", "qt5", "qcombobox", "qlineedit"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3814253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0839e40a3aa69ad3535156567e45d04b?s=128&d=identicon&r=PG&f=1", "display_name": "DevilGale", "link": "https://stackoverflow.com/users/3814253/devilgale"}, "edited": false, "score": 0, "creation_date": 1542231706, "post_id": 53308461, "comment_id": 93499053, "body": "How do I get access to qApp functions? I tried <code>QCustomCombo : private QApplication</code>, but that breaks my <code>connect()</code> lines. The QCombo is located inside a mainwindow.cpp created by a main.cpp (main.cpp is where I have QApplication instance)."}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "reply_to_user": {"reputation": 61, "user_id": 3814253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0839e40a3aa69ad3535156567e45d04b?s=128&d=identicon&r=PG&f=1", "display_name": "DevilGale", "link": "https://stackoverflow.com/users/3814253/devilgale"}, "edited": false, "score": 0, "creation_date": 1542247623, "post_id": 53308461, "comment_id": 93503654, "body": "@DevilGale it is not necessary to inherit, just include the header: <code>#include &lt;QApplication&gt;</code>. <code>QApplication::instance()</code> is a singleton that can be used with the qApp macro."}], "tags": [], "owner": {"reputation": 879, "user_id": 10384826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b5eCIz3fk9U/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOTRIfnFbGzOcKLPms4zg6nAaZvgA/mo/photo.jpg?sz=128", "display_name": "Serhiy Kulish", "link": "https://stackoverflow.com/users/10384826/serhiy-kulish"}, "is_accepted": true, "score": 1, "last_activity_date": 1542228368, "creation_date": 1542228368, "answer_id": 53308461, "question_id": 53305074, "link": "https://stackoverflow.com/questions/53305074/event-qcombobox-to-custom-qlineedit/53308461#53308461", "title": "Event QComboBox to Custom QLineEdit", "body": "<p>Use <code>QApplication::notify</code></p>\n\n<pre><code>bool QCustomCombo::event(QEvent * event)\n{\n    if(event-&gt;type() == QEvent::KeyPress)\n    {\n        QKeyEvent * keyEvent = static_cast&lt;QKeyEvent *&gt;(event);\n        if(keyEvent-&gt;key() == Qt::Key_Tab)\n        {\n            qApp-&gt;notify(m_lineEdit, event);\n            return true;\n        }\n    }\n    return QWidget::event(event);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 1, "last_activity_date": 1542246963, "creation_date": 1542246963, "answer_id": 53311342, "question_id": 53305074, "link": "https://stackoverflow.com/questions/53305074/event-qcombobox-to-custom-qlineedit/53311342#53311342", "title": "Event QComboBox to Custom QLineEdit", "body": "<blockquote>\n  <p>I want when an event passed to QComboBox it will be passed to the\n  QComboBox->lineEdit().</p>\n</blockquote>\n\n<p><a href=\"http://doc.qt.io/qt-5/qobject.html#installEventFilter\" rel=\"nofollow noreferrer\">installEventFilter()</a> is your friend here.  It allows object A to install an event filter on another object B, so that before object B's <code>event(QEvent *)</code> method gets called, object A's <code>eventFilter(QObject *, QEvent *)</code> method will be called first, so that object A can decide how to handle the event (and whether or not the event should be passed on to object B afterwards).</p>\n\n<p>You can use that so that your <code>CustomCombo</code> can see and react to events that would otherwise go directly to the `QComboBox.</p>\n"}], "owner": {"reputation": 61, "user_id": 3814253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0839e40a3aa69ad3535156567e45d04b?s=128&d=identicon&r=PG&f=1", "display_name": "DevilGale", "link": "https://stackoverflow.com/users/3814253/devilgale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 53308461, "answer_count": 2, "score": 0, "last_activity_date": 1552029042, "creation_date": 1542214027, "last_edit_date": 1552029042, "question_id": 53305074, "link": "https://stackoverflow.com/questions/53305074/event-qcombobox-to-custom-qlineedit", "title": "Event QComboBox to Custom QLineEdit", "body": "<p>\nThe Problem: I have a custom event on <code>QLineEdit</code> inside a custom <code>QComboBox</code> and only specific events are being passed from <code>QComboBox</code> to <code>QLineEdit</code> when I want. I can't get tab to be passed.</p>\n\n<p>I want when an event passed to <code>QComboBox</code> it will be passed to the <code>QComboBox-&gt;lineEdit()</code>.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>QCustomCombo::QCustomCombo():\n    m_lineEdit(new QCustomLineEdit)\n{\n    setEditable(true);\n    setLineEdit(m_lineEdit);\n}\n\nbool QCustomCombo::event(QEvent * event)\n{\n    if(event-&gt;type() == QEvent::KeyPress)\n    {\n        QKeyEvent * keyEvent = static_cast&lt;QKeyEvent *&gt;(event);\n        if(keyEvent-&gt;key() == Qt::Key_tab)\n        {\n            //pass to lineEdit();\n            //I have tried 'return true/false and QWidget::event(event)'\n            //I have also tried commenting out QCustomCombo::event, same problem\n        }\n    }\n    return QWidget::event(event);\n}\n</code></pre>\n\n<p>QCustomLineEdit</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>bool QCustomLineEdit::event(QEvent * event)\n{\n    if(event-&gt;type() == QEvent::KeyPress)\n    {\n        QKeyEvent * keyEvent = static_cast&lt;QKeyEvent *&gt;(event);\n        if(keyEvent-&gt;key() == Qt::Key_tab)\n        {\n            //Do custom Stuff\n            return true;\n        }\n        if(keyEvent-&gt;key() == Qt::Key_Right)\n        {\n            //Do custom Stuff\n            return true;\n        }\n    }\n    return QWidget::event(event);\n}\n</code></pre>\n\n<p>The <code>QLineEdit</code> has a custom event for left and right arrow and tab. Only the arrows get passed. But I can't get the tab to pass to it. </p>\n"}, {"tags": ["c++", "visual-studio", "manifest"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1542214870, "post_id": 53304731, "comment_id": 93491403, "body": "The build directory name is very unusual, surely that has something to do with it.  Nothing that can be guessed from your question, not without you either posting the .vcxproj file or the detailed build trace."}, {"owner": {"reputation": 846, "user_id": 1011129, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sI1vm.jpg?s=128&g=1", "display_name": "Kevin Hirst", "link": "https://stackoverflow.com/users/1011129/kevin-hirst"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1542216784, "post_id": 53304731, "comment_id": 93492418, "body": "There is literally nothing in the linker trace log files.  They have no content in them.    The compile trace logs are identical between vs2010 and vs2017.  I&#39;ll post the project file."}, {"owner": {"reputation": 846, "user_id": 1011129, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sI1vm.jpg?s=128&g=1", "display_name": "Kevin Hirst", "link": "https://stackoverflow.com/users/1011129/kevin-hirst"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1542232551, "post_id": 53304731, "comment_id": 93499425, "body": "As I said in the edit, it appears as if in VS2010 the mt.exe manifest tool is running and creating trace logs, whereas in 2017 it&#39;s not.  Is there a relevant setting in the manifest section where this tool runs before the linker?"}], "owner": {"reputation": 846, "user_id": 1011129, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sI1vm.jpg?s=128&g=1", "display_name": "Kevin Hirst", "link": "https://stackoverflow.com/users/1011129/kevin-hirst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 756, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542232344, "creation_date": 1542212895, "last_edit_date": 1542232344, "question_id": 53304731, "link": "https://stackoverflow.com/questions/53304731/visual-studio-2017-wont-create-intermediate-manifest-file", "title": "Visual Studio 2017 won&#39;t create intermediate manifest file", "body": "<p>I am upgrading some big solution files (80 projects) from Visual Studio 2010 to Visual Studio 2017.  I allowed VS to upgrade the solution and project files (they are all VC++ projects). </p>\n\n<p>If you go to the \"Linker\" settings for the project, they are all set to generate an intermediate manifest.</p>\n\n<p><a href=\"https://i.stack.imgur.com/d6IRE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d6IRE.png\" alt=\"Intermediate Manifest settings\"></a></p>\n\n<p>I am running VS2017 as Administrator, and for each of the projects I try to build, I get an error similar to:</p>\n\n<p>LINK : fatal error LNK1104: cannot open file 'D:...\\intel_win32_Debug\\bundle_creator\\bundle_creator.exe.intermediate.manifest'</p>\n\n<p>This works fine building the projects in VS2010.  In VS 2010, the intermediate manifest is produced and feeds the manifest tool, and the projects build.  The output directory exists and has intermediate .obj files, as well as a .pdb file. I also checked the directory privileges and ownership, and they appear to be in order.</p>\n\n<p>This error happens for both debug/release builds.</p>\n\n<p>Does anyone know why this would work in 2010 but not in 2017?</p>\n\n<p>EDIT:  There is NO content in the linker trace log files. (Whereas plenty when done in VS2017).  Here is a sample project file.</p>\n\n<p>EDIT 2: One <em>huge</em> difference I see is that in the VS2010 case I see trace logs for the mt.ext manifest tool, whereas in 2017 I don't.  So it appears like the manifest tool isn't running for some reason.  The manifest settings haven't changed - is there some setting in VS2017 for running the manifest tool before the linker?</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"&gt;\n  &lt;ItemGroup Label=\"ProjectConfigurations\"&gt;\n    &lt;ProjectConfiguration Include=\"Debug|Win32\"&gt;\n      &lt;Configuration&gt;Debug&lt;/Configuration&gt;\n      &lt;Platform&gt;Win32&lt;/Platform&gt;\n    &lt;/ProjectConfiguration&gt;\n    &lt;ProjectConfiguration Include=\"Release|Win32\"&gt;\n      &lt;Configuration&gt;Release&lt;/Configuration&gt;\n      &lt;Platform&gt;Win32&lt;/Platform&gt;\n    &lt;/ProjectConfiguration&gt;\n    &lt;ProjectConfiguration Include=\"Template|Win32\"&gt;\n      &lt;Configuration&gt;Template&lt;/Configuration&gt;\n      &lt;Platform&gt;Win32&lt;/Platform&gt;\n    &lt;/ProjectConfiguration&gt;\n  &lt;/ItemGroup&gt;\n  &lt;PropertyGroup Label=\"Globals\"&gt;\n    &lt;ProjectGuid&gt;{FAA8F144-2DE8-4397-B694-FDA2BF43E610}&lt;/ProjectGuid&gt;\n    &lt;RootNamespace&gt;bundle_creator&lt;/RootNamespace&gt;\n    &lt;SccProjectName&gt;\n    &lt;/SccProjectName&gt;\n    &lt;SccAuxPath&gt;\n    &lt;/SccAuxPath&gt;\n    &lt;SccLocalPath&gt;\n    &lt;/SccLocalPath&gt;\n    &lt;SccProvider&gt;\n    &lt;/SccProvider&gt;\n    &lt;WindowsTargetPlatformVersion&gt;10.0.16299.0&lt;/WindowsTargetPlatformVersion&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" /&gt;\n  &lt;PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\"&gt;\n    &lt;ConfigurationType&gt;Application&lt;/ConfigurationType&gt;\n    &lt;UseOfMfc&gt;false&lt;/UseOfMfc&gt;\n    &lt;PlatformToolset&gt;v141&lt;/PlatformToolset&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\"&gt;\n    &lt;ConfigurationType&gt;Application&lt;/ConfigurationType&gt;\n    &lt;UseOfMfc&gt;false&lt;/UseOfMfc&gt;\n    &lt;PlatformToolset&gt;v141&lt;/PlatformToolset&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;PropertyGroup Label=\"Configuration\" Condition=\"'$(Configuration)|$(Platform)'=='Template|Win32'\"&gt;\n    &lt;PlatformToolset&gt;v141&lt;/PlatformToolset&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" /&gt;\n  &lt;ImportGroup Label=\"ExtensionSettings\"&gt;\n  &lt;/ImportGroup&gt;\n  &lt;ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"PropertySheets\"&gt;\n    &lt;Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" /&gt;\n    &lt;Import Project=\"..\\..\\..\\..\\..\\build\\properties\\release.props\" /&gt;\n  &lt;/ImportGroup&gt;\n  &lt;ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"PropertySheets\"&gt;\n    &lt;Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" /&gt;\n    &lt;Import Project=\"..\\..\\..\\..\\..\\build\\properties\\debug.props\" /&gt;\n  &lt;/ImportGroup&gt;\n  &lt;PropertyGroup Label=\"UserMacros\" /&gt;\n  &lt;PropertyGroup&gt;\n    &lt;_ProjectFileVersion&gt;10.0.30319.1&lt;/_ProjectFileVersion&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\"&gt;\n    &lt;ClCompile&gt;\n      &lt;AdditionalIncludeDirectories&gt;$(CORE_LIBRARIES_DIR)\\3rdParty\\zlib\\include;%(AdditionalIncludeDirectories)&lt;/AdditionalIncludeDirectories&gt;\n      &lt;PreprocessorDefinitions&gt;CONSOLE_MODE;OMIT_CRYPTO_SUPPORT=t;OMIT_SYSTEM_VALUES=t;_CONSOLE;__BUILD_STATIC_APPLICATION__;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n    &lt;/ClCompile&gt;\n    &lt;ResourceCompile&gt;\n      &lt;PreprocessorDefinitions&gt;CONSOLE_MODE;OMIT_CRYPTO_SUPPORT=t;OMIT_SYSTEM_VALUES=t;_CONSOLE;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n    &lt;/ResourceCompile&gt;\n    &lt;Link&gt;\n      &lt;AdditionalDependencies&gt;zlib.lib;%(AdditionalDependencies)&lt;/AdditionalDependencies&gt;\n      &lt;AdditionalLibraryDirectories&gt;$(CORE_LIBRARIES_DIR)\\3rdparty\\zlib\\lib;%(AdditionalLibraryDirectories)&lt;/AdditionalLibraryDirectories&gt;\n      &lt;SubSystem&gt;Console&lt;/SubSystem&gt;\n    &lt;/Link&gt;\n  &lt;/ItemDefinitionGroup&gt;\n  &lt;ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\"&gt;\n    &lt;ClCompile&gt;\n      &lt;AdditionalIncludeDirectories&gt;$(CORE_LIBRARIES_DIR)\\3rdparty\\zlib\\include;%(AdditionalIncludeDirectories)&lt;/AdditionalIncludeDirectories&gt;\n      &lt;PreprocessorDefinitions&gt;CONSOLE_MODE;OMIT_CRYPTO_SUPPORT=t;OMIT_SYSTEM_VALUES=t;_CONSOLE;__BUILD_STATIC_APPLICATION__;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n    &lt;/ClCompile&gt;\n    &lt;ResourceCompile&gt;\n      &lt;PreprocessorDefinitions&gt;CONSOLE_MODE;OMIT_CRYPTO_SUPPORT=t;OMIT_SYSTEM_VALUES=t;_CONSOLE;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n    &lt;/ResourceCompile&gt;\n    &lt;Link&gt;\n      &lt;AdditionalDependencies&gt;zlib.lib;%(AdditionalDependencies)&lt;/AdditionalDependencies&gt;\n      &lt;AdditionalLibraryDirectories&gt;$(CORE_LIBRARIES_DIR)\\3rdparty\\zlib\\lib;%(AdditionalLibraryDirectories)&lt;/AdditionalLibraryDirectories&gt;\n      &lt;SubSystem&gt;Console&lt;/SubSystem&gt;\n    &lt;/Link&gt;\n  &lt;/ItemDefinitionGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;ClCompile Include=\"bundle_creator.cpp\" /&gt;\n    &lt;ClCompile Include=\"common_bundle.cpp\" /&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;ResourceCompile Include=\"bundler_version.rc\" /&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;ProjectReference Include=\"..\\..\\..\\..\\..\\libraries\\core\\library\\basis\\basis.vcxproj\"&gt;\n      &lt;Project&gt;{571b0731-ed86-476a-a723-9ecf75cb0d51}&lt;/Project&gt;\n    &lt;/ProjectReference&gt;\n    &lt;ProjectReference Include=\"..\\..\\..\\build_prerequisites.csproj\"&gt;\n      &lt;Project&gt;{28ba1c03-7e39-4ce2-993f-72a7772fa758}&lt;/Project&gt;\n    &lt;/ProjectReference&gt;\n  &lt;/ItemGroup&gt;\n  &lt;Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.targets\" /&gt;\n  &lt;ImportGroup Label=\"ExtensionTargets\"&gt;\n  &lt;/ImportGroup&gt;\n  &lt;ProjectExtensions&gt;\n    &lt;VisualStudio&gt;\n      &lt;UserProperties RESOURCE_FILE=\"bundler_version.rc\" /&gt;\n    &lt;/VisualStudio&gt;\n  &lt;/ProjectExtensions&gt;\n&lt;/Project&gt;\n</code></pre>\n\n<p>And here is the debug property sheet</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Project DefaultTargets=\"Build\" ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"&gt;\n  &lt;PropertyGroup Label=\"UserMacros\"&gt;\n    &lt;REPOSITORY_DIR Condition=\"'$(REPOSITORY_DIR)'==''\"&gt;$(SolutionDir)&lt;/REPOSITORY_DIR&gt;\n    &lt;BUILDER_DIR&gt;$(REPOSITORY_DIR)\\..\\..\\build\\&lt;/BUILDER_DIR&gt;\n    &lt;BUILD_TOP&gt;$(REPOSITORY_DIR)\\..\\..\\&lt;/BUILD_TOP&gt;\n    &lt;LIBRARIES_DIR&gt;$(REPOSITORY_DIR)\\..\\..\\libraries\\&lt;/LIBRARIES_DIR&gt;\n    &lt;CORE_LIBRARIES_DIR&gt;$(REPOSITORY_DIR)\\..\\..\\libraries\\core\\&lt;/CORE_LIBRARIES_DIR&gt;\n    &lt;SHARED_LIBRARIES_DIR&gt;$(REPOSITORY_DIR)\\..\\..\\libraries\\shared\\&lt;/SHARED_LIBRARIES_DIR&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;PropertyGroup&gt;\n    &lt;_ProjectFileVersion&gt;10.0.30319.1&lt;/_ProjectFileVersion&gt;\n    &lt;OutDir&gt;$(REPOSITORY_DIR)\\binaries\\&lt;/OutDir&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;ImportGroup Label=\"PropertySheets\"&gt;\n    &lt;Import Project=\"$(BUILDER_DIR)\\properties\\vcoptions.props\" /&gt;\n  &lt;/ImportGroup&gt;\n  &lt;ItemDefinitionGroup&gt;\n    &lt;Midl&gt;\n      &lt;PreprocessorDefinitions&gt;DEBUG;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n    &lt;/Midl&gt;\n    &lt;ClCompile&gt;\n      &lt;Optimization&gt;Disabled&lt;/Optimization&gt;\n      &lt;InlineFunctionExpansion&gt;OnlyExplicitInline&lt;/InlineFunctionExpansion&gt;\n      &lt;WholeProgramOptimization&gt;false&lt;/WholeProgramOptimization&gt;\n      &lt;PreprocessorDefinitions&gt;_DEBUG;DEBUG;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n      &lt;MinimalRebuild&gt;false&lt;/MinimalRebuild&gt;\n      &lt;StringPooling&gt;false&lt;/StringPooling&gt;\n      &lt;FunctionLevelLinking&gt;false&lt;/FunctionLevelLinking&gt;\n      &lt;RuntimeLibrary&gt;MultiThreadedDLL&lt;/RuntimeLibrary&gt;\n    &lt;/ClCompile&gt;\n    &lt;ResourceCompile&gt;\n      &lt;PreprocessorDefinitions&gt;DEBUG;%(PreprocessorDefinitions)&lt;/PreprocessorDefinitions&gt;\n    &lt;/ResourceCompile&gt;\n    &lt;Manifest&gt;\n      &lt;AdditionalManifestFiles&gt;$(IntDir)$(TargetFileName).intermediate.manifest;$(BUILDER_DIR)\\properties\\security_manifest.txt;%(AdditionalManifestFiles)&lt;/AdditionalManifestFiles&gt;\n    &lt;/Manifest&gt;\n    &lt;Link&gt;\n      &lt;AdditionalLibraryDirectories&gt;$(REPOSITORY_DIR)\\binaries;%(AdditionalLibraryDirectories)&lt;/AdditionalLibraryDirectories&gt;\n      &lt;ProgramDatabaseFile&gt;$(REPOSITORY_DIR)\\binaries\\$(TargetName).pdb&lt;/ProgramDatabaseFile&gt;\n      &lt;ImportLibrary&gt;$(REPOSITORY_DIR)\\binaries\\$(ProjectName).lib&lt;/ImportLibrary&gt;\n&lt;AdditionalDependencies&gt;msvcrtd.lib;%(AdditionalDependencies)&lt;/AdditionalDependencies&gt;\n&lt;IgnoreSpecificDefaultLibraries&gt;msvcrt.lib;mfc.lib&lt;/IgnoreSpecificDefaultLibraries&gt; \n    &lt;/Link&gt;\n  &lt;/ItemDefinitionGroup&gt;\n&lt;/Project&gt;\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1542213254, "post_id": 53304666, "comment_id": 93490490, "body": "Not quite clear what else you want - if you return object by value you either have to move or copy it. You can move automatic but must copy static object obviously. Or use smart pointer."}, {"owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1542213402, "post_id": 53304666, "comment_id": 93490595, "body": "@Slava any better way than <code>shared_ptr</code> as I&#39;ve done, or is this a valid use of <code>shared_ptr</code>?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1542213729, "post_id": 53304666, "comment_id": 93490778, "body": "Any use of <code>std::shared_ptr</code> is valid unless you abuse it. I think in this case it is most straightforward and easy to understand solution."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1542214011, "post_id": 53304666, "comment_id": 93490934, "body": "@Slava You can return a reference to a static-local, no need for <code>shared_ptr</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1542216018, "post_id": 53304666, "comment_id": 93492022, "body": "@LightnessRacesinOrbit you can return a reference to a static, but you cannot return a reference to an automatic, and it seems you need both a static and an automatic here."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1542216058, "post_id": 53304666, "comment_id": 93492040, "body": "@n.m. Indeed, turns out the OP requires a single function (this information was only recently provided)"}, {"owner": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "edited": false, "score": 0, "creation_date": 1542221298, "post_id": 53304666, "comment_id": 93494494, "body": "Statements: <code>the object has a fixed value that can be calculated only once to save time</code> and <code>no copy constructors are required upon call, only move, to prevent copying all the data of an expensive object</code> seem to counter each other."}, {"owner": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "edited": false, "score": 0, "creation_date": 1542221351, "post_id": 53304666, "comment_id": 93494514, "body": "If you do not change value of C after the return, you can return a reference to C, which does not call any copy constructor"}], "answers": [{"comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1542213329, "post_id": 53304855, "comment_id": 93490540, "body": "There&#39;s nothing left with automatic storage then, right?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542213357, "post_id": 53304855, "comment_id": 93490566, "body": "@YSC: Nope but I&#39;m wilfully dropping that requirement because I don&#39;t really understand its value. Speaking functionally, that is. OP does allow for dynamic allocation as long as things are cleaned up automatically."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542213403, "post_id": 53304855, "comment_id": 93490596, "body": "From OP&#39;s last comment, I fully agree. +1."}, {"owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1542213526, "post_id": 53304855, "comment_id": 93490672, "body": "I&#39;m tempted to make a new requirement saying that I don&#39;t want to cache certain values. I&#39;m sure there are cases where this is a reasonable requirement? E.g. all cases are very rare except a few very common ones."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 1, "creation_date": 1542213550, "post_id": 53304855, "comment_id": 93490685, "body": "@CiroSantilli\u65b0\u7586\u6539\u9020\u4e2d\u5fc3\u516d\u56db\u4e8b\u4ef6\u6cd5\u8f6e\u529f Maybe but now we&#39;re really in the realm of me not understanding what problem you&#39;re trying to solve, sorry."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1542213912, "post_id": 53304855, "comment_id": 93490883, "body": "@CiroSantilli\u65b0\u7586\u6539\u9020\u4e2d\u5fc3\u516d\u56db\u4e8b\u4ef6\u6cd5\u8f6e\u529f You can add a flag &quot;const bool useCache = true&quot; trivially and set it to false to skip that"}, {"owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 1, "creation_date": 1542215397, "post_id": 53304855, "comment_id": 93491698, "body": "You made me realize that I had not mapped my problem well to the question. I have edited the question to reflect that, hopefully this is the right approach in this case rather than asking a new one."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1542215461, "post_id": 53304855, "comment_id": 93491742, "body": "@CiroSantilli\u65b0\u7586\u6539\u9020\u4e2d\u5fc3\u516d\u56db\u4e8b\u4ef6\u6cd5\u8f6e\u529f Thanks, that&#39;s a vast improvement to the question. The added information rules out my solution, unfortunately."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 6, "last_activity_date": 1542213974, "last_edit_date": 1542213974, "creation_date": 1542213287, "answer_id": 53304855, "question_id": 53304666, "link": "https://stackoverflow.com/questions/53304666/how-to-make-a-function-that-can-return-either-a-static-or-automatic-storage-obje/53304855#53304855", "title": "How to make a function that can return either a static or automatic storage objects without copy in C++?", "body": "<p>I don't really understand the purpose of the static/automatic stuff. If all you're trying to do is avoid repeated constructions when the argument has been used before, why not just have a cache instead?</p>\n\n<pre><code>C&amp; func_reg(const int i)\n{\n    static std::unordered_map&lt;int, C&gt; cache;\n    auto it = cache.find(i);\n    if (it == cache.end())\n      it = cache.emplace(i, C(i));\n\n    return it-&gt;second;\n}\n</code></pre>\n\n<p>Don't always want the cache? Fine! Add this:</p>\n\n<pre><code>C func_reg_nocache(const int i)\n{\n    return C(i);\n}\n</code></pre>\n\n<hr>\n\n<p>If I've misunderstood and you really need this thing where passing <code>is_static == true</code> gives you an entirely different object (one constructed with <code>0</code> rather than <code>i</code>) then just make a new function for that; it's doing something distinct.</p>\n\n<pre><code>C&amp; func_reg()\n{\n    static C obj(0);\n    return obj;\n}\n\nC func_reg(const int i)\n{\n    return C(i);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1542213670, "post_id": 53304932, "comment_id": 93490751, "body": "How this overcomplicated way is better than use <code>std::shared_ptr</code>, which is pretty obvious?"}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1542213692, "post_id": 53304932, "comment_id": 93490764, "body": "This avoids unnecessary heap allocations."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542213818, "post_id": 53304932, "comment_id": 93490822, "body": "Or just two separate functions, one returning <code>C&amp;</code> and the other returning <code>C</code>! I don&#39;t see the need for <code>shared_ptr</code> at all. I must be missing something."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1542213821, "post_id": 53304932, "comment_id": 93490829, "body": "It can be done much simpler way - <code>std::shared_ptr</code> pointing to static object if that is really necessary. I doubt it is."}, {"owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1542213853, "post_id": 53304932, "comment_id": 93490846, "body": "Avoiding heap allocations is something that was also on the back on my mind, I&#39;m going to learn more about <code>std::variant</code>. Not sure how much it matters performance-wise, but definitely inelegant."}, {"owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542213951, "post_id": 53304932, "comment_id": 93490903, "body": "@LightnessRacesinOrbit, overloads seem sensible to me, but that&#39;s really a comment on the motivation behind the original question.  I&#39;m just answering it.  Readers can judge for themselves if this is a useful pattern or not."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1542214035, "post_id": 53304932, "comment_id": 93490950, "body": "@PeterRuderman Certainly! As one of those readers, I have provided my judgement :)"}, {"owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 1, "creation_date": 1542215466, "post_id": 53304932, "comment_id": 93491743, "body": "I have updated the question to prevent cheating with different interfaces :-) Sorry for the mess."}], "tags": [], "owner": {"reputation": 11697, "user_id": 114421, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/loFOW.jpg?s=128&g=1", "display_name": "Peter Ruderman", "link": "https://stackoverflow.com/users/114421/peter-ruderman"}, "is_accepted": false, "score": 3, "last_activity_date": 1542231108, "last_edit_date": 1542231108, "creation_date": 1542213554, "answer_id": 53304932, "question_id": 53304666, "link": "https://stackoverflow.com/questions/53304666/how-to-make-a-function-that-can-return-either-a-static-or-automatic-storage-obje/53304932#53304932", "title": "How to make a function that can return either a static or automatic storage objects without copy in C++?", "body": "<p>What you want is essentially a variant:</p>\n\n<pre><code>std::variant&lt;C, C*&gt; func_reg_maybe_static(int i)\n{\n  static C static_obj{ 0 };\n  if (i == 0) {\n    return &amp;static_obj;\n  } else {\n    return std::variant&lt;C, C*&gt;{ std::inplace_type_t&lt;C&gt;{}, i };\n  }\n}\n</code></pre>\n\n<p>This has the advantage of not requiring any additional memory allocations (compared to the <code>shared_ptr</code> approach).  But it is somewhat inconvenient to use on the caller side.  We could work around this by writing a wrapper class:</p>\n\n<pre><code>template &lt;class C&gt; class value_or_ptr\n{\n  std::variant&lt;C, C*&gt; object_;\npublic:\n  explicit template &lt;class... Params&gt; value_or_ptr(Params&amp;&amp;... parameters)\n    : object_(std::inplace_type_t&lt;C&gt;{}, std::forward&lt;Params&gt;(parameters)...)\n  {}\n  explicit value_or_ptr(C* object)\n    : object_(object)\n  {}\n  // other constructors...\n\n  C&amp; operator*()\n  {\n    return object_.index() == 0 ? std::get&lt;0&gt;(object_) : *std::get&lt;1&gt;(object_);\n  }\n\n  // other accessors...\n}\n</code></pre>\n\n<p>If you don't have a C++17 compiler, the same can be done with unions, but the implementation will of course be more complex.  The original function then becomes:</p>\n\n<pre><code>value_or_ptr&lt;C&gt; func_reg_maybe_static(int i)\n{\n  static C static_obj{ 0 };\n  if (i == 0) {\n    return value_or_ptr{ &amp;static_obj };\n  } else {\n    return value_or_ptr{ i };\n  }\n}\n</code></pre>\n\n<p><strong>Contrast with Overloads</strong></p>\n\n<p>We could achieve similar results with function overloads:</p>\n\n<pre><code>C&amp; func_reg()\n{\n  static C obj{ 0 };\n  return obj;\n}\n\nC func_reg(const int i)\n{\n  return C{ i };\n}\n</code></pre>\n\n<p>This has the advantage of being simpler but might require the caller to make a copy.  It also requires the caller to know if a pre-computed object will be returned (which is undesirable).  With the variant approach, the caller can treat the results uniformly.  The caller always gets back an object with value semantics and does not need to know if he will receive a pre-computed object.</p>\n"}, {"comments": [{"owner": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "edited": false, "score": 0, "creation_date": 1542221733, "post_id": 53306688, "comment_id": 93494689, "body": "Why do we need <code>return *new (buf) C(i);</code>, and not just <code>return C(i)</code> in the else statement?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 373, "user_id": 5579840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c3ea32a6e9606728457334a4d80002?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Dhoked", "link": "https://stackoverflow.com/users/5579840/sahil-dhoked"}, "edited": false, "score": 0, "creation_date": 1542221761, "post_id": 53306688, "comment_id": 93494703, "body": "@SahilDhoked We return by reference."}, {"owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1542257941, "post_id": 53306688, "comment_id": 93505805, "body": "Cool, I didn&#39;t know about placement new. Can you clarify &quot;The placement new is perfectly legal, but using buf after the function call may or may not be legal depending on the contents of C.&quot;: when is it now legal?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 0, "creation_date": 1542265964, "post_id": 53306688, "comment_id": 93508464, "body": "@CiroSantilli\u65b0\u7586\u6539\u9020\u4e2d\u5fc3\u516d\u56db\u4e8b\u4ef6\u6cd5\u8f6e\u529f Link added."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "edited": false, "score": 1, "creation_date": 1542266479, "post_id": 53306688, "comment_id": 93508660, "body": "@CiroSantilli\u65b0\u7586\u6539\u9020\u4e2d\u5fc3\u516d\u56db\u4e8b\u4ef6\u6cd5\u8f6e\u529f And I&#39;m sorry about the billion edits, I wasn&#39;t all that awake when I wrote this."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542266678, "post_id": 53306688, "comment_id": 93508731, "body": "I may be old fashioned or weird, but I honestly think it&#39;d be better to pass <code>buf</code> by pointer. If only to make it truly explicit on the caller site that this object may be manhandled by the function."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542266864, "post_id": 53306688, "comment_id": 93508813, "body": "@StoryTeller I personally think its fine either way, as long as it&#39;s consistent. I&#39;m more worried about the semantic weirdness for the second version. I was considering deleting the post but then I saw people like this apparently."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542266964, "post_id": 53306688, "comment_id": 93508847, "body": "I get what you mean by the semantic weirdness of the second version. I guess that&#39;s what makes me more partial towards pointers too"}], "tags": [], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "is_accepted": false, "score": 4, "last_activity_date": 1542266397, "last_edit_date": 1542266397, "creation_date": 1542220404, "answer_id": 53306688, "question_id": 53304666, "link": "https://stackoverflow.com/questions/53304666/how-to-make-a-function-that-can-return-either-a-static-or-automatic-storage-obje/53306688#53306688", "title": "How to make a function that can return either a static or automatic storage objects without copy in C++?", "body": "<p>The returned object may refer to a preexisting object depending on an opaque criteria. This implies that the function needs to return by reference. But since the storage for an uncached value must outlive the function and not be on the heap, the <em>caller</em> needs to preemptively provide the storage on the stack for the returned object.</p>\n\n<pre><code>C&amp; func_reg_maybe_static(int i, void* buf)\n{\n    static C c(0);\n    if(i == 0)\n        return c;\n    else\n        return *new (buf) C(i);\n}\n\nusing uninit_C = std::aligned_storage&lt;sizeof(C), alignof(C)&gt;;\nuninit_C buf;\nauto&amp; c = func_reg_maybe_static(i, &amp;buf);\n</code></pre>\n\n<p>This requires a manual destructor call further down the line if and only if the destructor has side effects. Another take would be</p>\n\n<pre><code>C&amp; func_reg_maybe_static(int i, C&amp; buf)\n{\n    static C c(0);\n    if(i == 0)\n        return c;\n    else\n    {\n        buf.~C();\n        return *new (&amp;buf) C(i); // note below\n    }\n}\n\nC buf;\nauto&amp; c = func_reg_maybe_static(i, buf);\n</code></pre>\n\n<p>This version obviously requires <code>C</code> be default constructible. The placement new is perfectly legal, but using <code>buf</code> after the function call <a href=\"https://stackoverflow.com/a/47475941/4832499\">may or may not be legal</a> depending on the contents of <code>C</code>. The destructor will be called on scope exit.</p>\n"}], "owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 2, "answer_count": 3, "score": 12, "last_activity_date": 1542266397, "creation_date": 1542212677, "last_edit_date": 1542215333, "question_id": 53304666, "link": "https://stackoverflow.com/questions/53304666/how-to-make-a-function-that-can-return-either-a-static-or-automatic-storage-obje", "title": "How to make a function that can return either a static or automatic storage objects without copy in C++?", "body": "<p>Suppose I want to write something a function such that:</p>\n\n<ul>\n<li>it returns an object</li>\n<li>under certain circumstances, depending on a parameter of the function, the object has a fixed value that can be calculated only once to save time. So the natural choice is to make that object <code>static</code>.</li>\n<li>otherwise, the function must generate the object on the fly</li>\n</ul>\n\n<p>What is the best to write this function, with the requirements that:</p>\n\n<ul>\n<li>no copy constructors are required upon call, only move, to prevent copying all the data of an expensive object</li>\n<li>I don't want to use <code>new</code> raw pointers. If pointers are required, they must be smart and auto delete</li>\n</ul>\n\n<p>The use case is the following:</p>\n\n<ul>\n<li>certain values are very common, so I want to cache them</li>\n<li>other values are very rare, so I want them not to be cached</li>\n</ul>\n\n<p>The caller should not know which values are common, the interface should be transparent for both cases.</p>\n\n<p>So far, the only clean implementation that I've managed is to use <code>shared_ptr</code> as shown below, but it feels like overkill. In particular, because it makes a heap allocation, where it feels that one is not really required. Is there a better approach?</p>\n\n<pre><code>#include &lt;cassert&gt;\n#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nstruct C {\n    int i;\n    static int count;\n    C(int i) : i(i) {\n        std::cout &lt;&lt; \"constr\" &lt;&lt; std::endl;\n        count++;\n    }\n    C(const C&amp; c) : C(c.i) {\n        std::cout &lt;&lt; \"copy\" &lt;&lt; std::endl;\n    }\n    ~C() {\n        std::cout &lt;&lt; \"destr\" &lt;&lt; std::endl;\n        count--;\n    }\n};\nint C::count = 0;\n\nstd::shared_ptr&lt;C&gt; func_reg_maybe_static(int i) {\n    static auto static_obj = std::make_shared&lt;C&gt;(0);\n    if (i == 0) {\n        return static_obj;\n    } else {\n        return std::make_shared&lt;C&gt;(i);\n    }\n}\n\nint main() {\n    assert(C::count == 0);\n\n    {\n        auto c(func_reg_maybe_static(0));\n        assert(c-&gt;i == 0);\n        assert(C::count == 1);\n    }\n    assert(C::count == 1);\n\n    {\n        auto c(func_reg_maybe_static(0));\n        assert(c-&gt;i == 0);\n        assert(C::count == 1);\n    }\n    assert(C::count == 1);\n\n    {\n        auto c(func_reg_maybe_static(1));\n        assert(c-&gt;i == 1);\n        assert(C::count == 2);\n    }\n    assert(C::count == 1);\n\n    {\n        auto c(func_reg_maybe_static(2));\n        assert(c-&gt;i == 2);\n        assert(C::count == 2);\n    }\n    assert(C::count == 1);\n}\n</code></pre>\n\n<p>Which I compile with GCC 6.4.0:</p>\n\n<pre><code>g++ -std=c++17 -Wall -Wextra -pedantic-errors -o main.out func_ret_maybe_static.cpp\n</code></pre>\n\n<p>and it produces the expected output (guaranteed by copy elision I believe):</p>\n\n<pre><code>constr\nconstr\ndestr\nconstr\ndestr\ndestr\n</code></pre>\n\n<p>I've added the static reference counter <code>C::count</code> just to check that objects are actually getting deleted as expected.</p>\n\n<p>If I didn't have the static case, I would just do directly:</p>\n\n<pre><code>C func_reg_maybe_static(int i) {\n    return C(i);\n}\n</code></pre>\n\n<p>and copy elision / move semantics would make everything efficient.</p>\n\n<p>However, if I try something analogous as in:</p>\n\n<pre><code>C func_reg_maybe_static(int i) {\n    static C c(0);\n    return c;\n}\n</code></pre>\n\n<p>then C++ smartly stops just moving C, and starts to copy it, to avoid corrupting the <code>static</code>.</p>\n"}, {"tags": ["c++", "arrays", "types"], "comments": [{"owner": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "edited": false, "score": 0, "creation_date": 1542212582, "post_id": 53304521, "comment_id": 93490068, "body": "How about creating array of pointers each points to a dynamic Array?"}, {"owner": {"reputation": 159, "user_id": 6198531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207512211217900/picture?type=large", "display_name": "Arnaud M&#233;gret", "link": "https://stackoverflow.com/users/6198531/arnaud-m%c3%a9gret"}, "reply_to_user": {"reputation": 1775, "user_id": 9242491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBgTi.jpg?s=128&g=1", "display_name": "Ali Kanat", "link": "https://stackoverflow.com/users/9242491/ali-kanat"}, "edited": false, "score": 0, "creation_date": 1542212688, "post_id": 53304521, "comment_id": 93490130, "body": "it allocates additional memory and will fragment allocated memory"}, {"owner": {"reputation": 3667, "user_id": 4962554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qMkBt.png?s=128&g=1", "display_name": "eshirima", "link": "https://stackoverflow.com/users/4962554/eshirima"}, "edited": false, "score": 1, "creation_date": 1542212694, "post_id": 53304521, "comment_id": 93490133, "body": "What not use vectors?"}], "answers": [{"comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1542216071, "post_id": 53304742, "comment_id": 93492045, "body": "I don&#39;t see how this is better than the questioner&#39;s own version tbh. Using this is more complicated."}], "tags": [], "owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "is_accepted": false, "score": 1, "last_activity_date": 1542212917, "creation_date": 1542212917, "answer_id": 53304742, "question_id": 53304521, "link": "https://stackoverflow.com/questions/53304521/array-of-2-dimensions-one-being-known-and-the-other-unknown/53304742#53304742", "title": "array of 2 dimensions, one being known and the other unknown", "body": "<p>I'm a bit old-school, but the simplest is really </p>\n\n<pre><code>new float[size2 * 5];\n</code></pre>\n\n<p>and access it with </p>\n\n<pre><code>my_array[y * 5 + x]\n</code></pre>\n\n<p>You can even add an inline helper function</p>\n\n<pre><code>int at(int x, int y) { return y * 5 + x;}\n</code></pre>\n\n<p>...</p>\n\n<pre><code>my_array[at(x,y)]\n</code></pre>\n\n<p>And ideally combine with a std::vector instead of a dynamic array.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542218048, "post_id": 53304750, "comment_id": 93493002, "body": "You can do something similar defining a <code>typedef</code> allowing a somewhat more natural <i>pointer to array</i> allocation, e.g. <code>typedef float row_t[5]; ... row_t *block = new row_t[200];</code> (whether that is more clear or not is arguable)"}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 3, "last_activity_date": 1542213457, "last_edit_date": 1542213457, "creation_date": 1542212948, "answer_id": 53304750, "question_id": 53304521, "link": "https://stackoverflow.com/questions/53304521/array-of-2-dimensions-one-being-known-and-the-other-unknown/53304750#53304750", "title": "array of 2 dimensions, one being known and the other unknown", "body": "<pre><code>unsigned int size2=200;\nauto block = new float[size2][5];\n</code></pre>\n\n<blockquote>\n  <p>Is it correct? </p>\n</blockquote>\n\n<p>Yes it is correct.</p>\n\n<blockquote>\n  <p>What is the type of the variable block?</p>\n</blockquote>\n\n<p>Using <code>auto</code> here is the best you can do. But for learning purpose, the type of <code>block</code> is <code>float(*)[5]</code>. To define a variable with that type, you must use the following syntax:</p>\n\n<pre><code>unsigned int size2=200;\nfloat(*block)[5] = new float[size2][5];\n</code></pre>\n\n<p>Demo: <a href=\"https://godbolt.org/z/4iJMA5\" rel=\"nofollow noreferrer\">https://godbolt.org/z/4iJMA5</a></p>\n\n<hr>\n\n<p><em>\"How can I read such a thing as <code>float(*block)[5]</code>?\"</em> you might ask. It's simple, use the <a href=\"https://stackoverflow.com/a/47835838/5470596\">C++ Guru Snail Rule</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1542213455, "last_edit_date": 1592644375, "creation_date": 1542213455, "answer_id": 53304903, "question_id": 53304521, "link": "https://stackoverflow.com/questions/53304521/array-of-2-dimensions-one-being-known-and-the-other-unknown/53304903#53304903", "title": "array of 2 dimensions, one being known and the other unknown", "body": "<blockquote>\n<pre><code>unsigned int size2=200;\nauto block = new float[size2][5];\n</code></pre>\n<p>Is it correct ?</p>\n</blockquote>\n<p>Yes, although a bare owning pointer is a bad idea. It's better to use <code>std::vector</code> for dynamic arrays.</p>\n<blockquote>\n<p>What is the type of the variable block ?</p>\n</blockquote>\n<p>It is <code>float (*)[5]</code> i.e. pointer to an array of 5 float.</p>\n<hr />\n<p>As I mentioned, I recommend using <code>std::vector</code> instead to avoid pitfalls with memory management:</p>\n<pre><code>std::vector&lt;std::array&lt;float, 5&gt;&gt; block(size2);\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6198531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207512211217900/picture?type=large", "display_name": "Arnaud M&#233;gret", "link": "https://stackoverflow.com/users/6198531/arnaud-m%c3%a9gret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53304750, "answer_count": 3, "score": 2, "last_activity_date": 1542213457, "creation_date": 1542212150, "last_edit_date": 1542213154, "question_id": 53304521, "link": "https://stackoverflow.com/questions/53304521/array-of-2-dimensions-one-being-known-and-the-other-unknown", "title": "array of 2 dimensions, one being known and the other unknown", "body": "<p>I need to efficiently allocate an array of two dimensions, one being known (5) and the other being unknown.</p>\n\n<p>My aim is to have a continuous block of memory named block that stores my data in the following way :\nblock[0,0] block[0,1] block[0,2] block[0,3] block[0,4] block[1,0] ...]</p>\n\n<p>The following code compiles (in C++) :</p>\n\n<pre><code>unsigned int size2=200;\nauto block = new float[size2][5];\n</code></pre>\n\n<p>Is it correct ?\nWhat is the type of the variable block ?\nI have tried :</p>\n\n<pre><code>float[5]* block = new float[size2][5];\nfloat[5] block[] = new float[size2][5];\nfloat block[][5] = new float[size2][5];\nfloat block*[5] = new float[size2][5];\n</code></pre>\n\n<p>All of them leads to an error.\nI am running out of imagination...</p>\n"}, {"tags": ["python", "c++", "c", "python-c-api"], "comments": [{"owner": {"reputation": 141, "user_id": 5191483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4937cf76a644a1a88be5fc1104eaacdb?s=128&d=identicon&r=PG&f=1", "display_name": "Milos Matovic", "link": "https://stackoverflow.com/users/5191483/milos-matovic"}, "edited": false, "score": 1, "creation_date": 1542213065, "post_id": 53304436, "comment_id": 93490382, "body": "It could be that the python extension library is using a wrong version of python, something like this: <a href=\"https://stackoverflow.com/questions/27408123/python-extension-module-with-embedded-python-calls-wrong-library\" title=\"python extension module with embedded python calls wrong library\">stackoverflow.com/questions/27408123/&hellip;</a>"}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 141, "user_id": 5191483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4937cf76a644a1a88be5fc1104eaacdb?s=128&d=identicon&r=PG&f=1", "display_name": "Milos Matovic", "link": "https://stackoverflow.com/users/5191483/milos-matovic"}, "edited": false, "score": 0, "creation_date": 1542214408, "post_id": 53304436, "comment_id": 93491142, "body": "@MilosMatovic I read this post. I&#39;m on windows though, and just to be sure, I removed the 2.7 version I&#39;ve got installed. Either way, it shouldn&#39;t matter though, because the same instance of python is run for each line of python code, so the pip evaluation should list the same extension library. Am I mistaken?"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1542350986, "post_id": 53304436, "comment_id": 93545104, "body": "probably, your created exe hasn&#39;t the same python-path as the installed python. Check the output of  <code>import sys; print(sys.path)</code>  in your exe"}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1542366037, "post_id": 53304436, "comment_id": 93551742, "body": "@ead You&#39;re right. It&#39;s using python_d.exe instead of python.exe. Do you know if there&#39;s any way to force it to use the right one?"}], "owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542211864, "creation_date": 1542211864, "question_id": 53304436, "link": "https://stackoverflow.com/questions/53304436/python-throws-a-modulenotfounderror-when-loaded-from-c-but-not-when-directly-ex", "title": "Python throws a ModuleNotFoundError when loaded from C, but not when directly executed", "body": "<p>I'm in the process of making a module called BSPy. It's not really relevant what the module does, but its <code>setup.py</code> is:</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nsetup(name='BSPy', version='0.0.2', ext_modules=[Extension('BSPy', ['Interface.cpp'])])\n</code></pre>\n\n<p>Now, in order to do some debugging steps I'm using C to call a python file, and try to execute it using this bit of code:</p>\n\n<pre><code>#include&lt;Python.h&gt;\nint main(int argc, char **argv) {\n    wchar_t *program = Py_DecodeLocale(argv[0], NULL);\n    if (program == NULL) {\n        fprintf(stderr, \"Fatal error: cannot decode argv[0]\\n\");\n        exit(1);\n    }\n    Py_SetProgramName(program);\n    Py_Initialize();\n\n    FILE* PythonScriptFile = fopen(\"D:/- Coding/python-bsp/test.py\", \"r\");\n    if (PythonScriptFile)\n    {\n        PyRun_SimpleFile(PythonScriptFile, \"D:/- Coding/python-bsp/test.py\");\n        fclose(PythonScriptFile);\n    }\n\n    Py_Finalize();\n\n    getchar();\n    return 0;\n</code></pre>\n\n<p>So far so good. I first tested a hello world file to make sure it works, and this is working wonderfully. I then went on to change the python file to use this BSPy module (which executes fine on its own and from the command line). The file now looks like this:</p>\n\n<pre><code>import platform\nimport pip  # needed to use the pip functions\n\nprint(platform.python_version())\n\nprint(sorted([\"%s==%s\" % (i.key, i.version) for i in pip.get_installed_distributions()]))\n\nimport BSPy as bsp\n\nprint(\"Hello world! - from processor {} of {}.\".format(bsp.pid(), bsp.nprocs()))\n</code></pre>\n\n<p>And is supposed to give the output</p>\n\n<blockquote>\n<pre><code>3.6.5\n['absl-py==0.2.2', 'argh==0.26.2', 'astor==0.6.2', 'astroid==1.6.4', 'autopep8==1.3.5', 'bleach==1.5.0', 'browser-cookie3==0.6.4', 'browsercookie2==0.7.1', 'bspy==0.0.2', 'cachetools==2.1.0', 'certifi==2018.4.16', 'chardet==3.0.4', 'colorama==0.3.9', 'cycler==0.10.0', 'entrypoints==0.2.3', 'feedparser==5.2.1', 'flake8-docstrings==1.3.0', 'flake8-polyfill==1.0.2', 'flake8==3.5.0', 'future==0.16.0', 'gast==0.2.0', 'google-api-core==1.2.0', 'google-auth==1.5.0', 'google-cloud-core==0.28.1', 'google-cloud-logging==1.6.0', 'googleapis-common-protos==1.5.3', 'grpcio==1.12.0', 'gtp==0.2', 'h5py==2.8.0', 'html5lib==0.9999999', 'httplib2==0.11.3', 'idna==2.6', 'iso8601==0.1.12', 'isort==4.3.4', 'jedi==0.13.1', 'keras-applications==1.0.6', 'keras-preprocessing==1.0.5', 'keyring==10.3.2', 'kiwisolver==1.0.1', 'lazy-object-proxy==1.3.1', 'lxml==4.2.5', 'lz4==2.0.0', 'm3u8==0.3.5', 'markdown==2.6.11', 'matplotlib==2.2.2', 'mccabe==0.6.1', 'mymodule==1.0', 'numpy==1.14.3', 'oauth2client==4.1.0', 'pandas==0.23.0', 'parso==0.3.1', 'pbkdf2==1.3', 'petname==2.2', 'pillow==5.3.0', 'pip==9.0.3', 'pluggy==0.7.1', 'protobuf==3.5.2.post1', 'pyaes==1.6.1', 'pyasn1-modules==0.2.1', 'pyasn1==0.4.3', 'pybsp==0.0.1', 'pycodestyle==2.3.1', 'pycryptodome==3.6.1', 'pydocstyle==2.1.1', 'pyflakes==1.6.0', 'pylint==1.9.1', 'pyparsing==2.2.0', 'python-dateutil==2.7.3', 'python-jsonrpc-server==0.0.2', 'python-language-server==0.21.2', 'pytz==2018.4', 'pywin32-ctypes==0.1.2', 'requests==2.18.4', 'rope==0.11.0', 'rsa==3.4.2', 'setuptools==40.4.3', 'sgf==0.5', 'six==1.11.0', 'snowballstemmer==1.2.1', 'tensorboard==1.8.0', 'tensorflow-gpu==1.8.0', 'termcolor==1.1.0', 'tqdm==4.23.4', 'typed-ast==1.1.0', 'urllib3==1.22', 'virtualenv==16.1.0', 'webencodings==0.5.1', 'werkzeug==0.14.1', 'wheel==0.31.1', 'wordcloud==1.5.0', 'wrapt==1.10.11', 'yapf==0.24.0']\nHello world! - from processor 3735928559 of 24.\n</code></pre>\n</blockquote>\n\n<p>However, when I try and run the C script again, it suddenly throws out a ModuleNotFoundError:</p>\n\n<blockquote>\n<pre><code>3.6.5\n['absl-py==0.2.2', 'argh==0.26.2', 'astor==0.6.2', 'astroid==1.6.4', 'autopep8==1.3.5', 'bleach==1.5.0', 'browser-cookie3==0.6.4', 'browsercookie2==0.7.1', 'bspy==0.0.2', 'cachetools==2.1.0', 'certifi==2018.4.16', 'chardet==3.0.4', 'colorama==0.3.9', 'cycler==0.10.0', 'entrypoints==0.2.3', 'feedparser==5.2.1', 'flake8-docstrings==1.3.0', 'flake8-polyfill==1.0.2', 'flake8==3.5.0', 'future==0.16.0', 'gast==0.2.0', 'google-api-core==1.2.0', 'google-auth==1.5.0', 'google-cloud-core==0.28.1', 'google-cloud-logging==1.6.0', 'googleapis-common-protos==1.5.3', 'grpcio==1.12.0', 'gtp==0.2', 'h5py==2.8.0', 'html5lib==0.9999999', 'httplib2==0.11.3', 'idna==2.6', 'iso8601==0.1.12', 'isort==4.3.4', 'jedi==0.13.1', 'keras-applications==1.0.6', 'keras-preprocessing==1.0.5', 'keyring==10.3.2', 'kiwisolver==1.0.1', 'lazy-object-proxy==1.3.1', 'lxml==4.2.5', 'lz4==2.0.0', 'm3u8==0.3.5', 'markdown==2.6.11', 'matplotlib==2.2.2', 'mccabe==0.6.1', 'mymodule==1.0', 'numpy==1.14.3', 'oauth2client==4.1.0', 'pandas==0.23.0', 'parso==0.3.1', 'pbkdf2==1.3', 'petname==2.2', 'pillow==5.3.0', 'pip==9.0.3', 'pluggy==0.7.1', 'protobuf==3.5.2.post1', 'pyaes==1.6.1', 'pyasn1-modules==0.2.1', 'pyasn1==0.4.3', 'pybsp==0.0.1', 'pycodestyle==2.3.1', 'pycryptodome==3.6.1', 'pydocstyle==2.1.1', 'pyflakes==1.6.0', 'pylint==1.9.1', 'pyparsing==2.2.0', 'python-dateutil==2.7.3', 'python-jsonrpc-server==0.0.2', 'python-language-server==0.21.2', 'pytz==2018.4', 'pywin32-ctypes==0.1.2', 'requests==2.18.4', 'rope==0.11.0', 'rsa==3.4.2', 'setuptools==40.4.3', 'sgf==0.5', 'six==1.11.0', 'snowballstemmer==1.2.1', 'tensorboard==1.8.0', 'tensorflow-gpu==1.8.0', 'termcolor==1.1.0', 'tqdm==4.23.4', 'typed-ast==1.1.0', 'urllib3==1.22', 'virtualenv==16.1.0', 'webencodings==0.5.1', 'werkzeug==0.14.1', 'wheel==0.31.1', 'wordcloud==1.5.0', 'wrapt==1.10.11', 'yapf==0.24.0']\nTraceback (most recent call last):\n  File \"D:/- Coding/python-bsp/test.py\", line 8, in &lt;module&gt;\n    import BSPy as bsp\nModuleNotFoundError: No module named 'BSPy'\n</code></pre>\n</blockquote>\n\n<p>Note that while it throws this error, pip is still confirming that BSPy is installed; hence I have no idea what could be wrong. Sadly, I can't give out a minimal working example, since the module can't be downloaded anywhere at the moment. I'm building it in this way though:</p>\n\n<pre><code>// Declare functions\nextern \"C\" {\n    static PyObject* init(PyObject* self, PyObject* args);\n    static PyObject* begin(PyObject* self, PyObject* args);\n    static PyObject* end(PyObject* self, PyObject* args);\n    static PyObject* execute(PyObject* self, PyObject* args);\n    static PyObject* pid(PyObject* self, PyObject* args);\n    static PyObject* nprocs(PyObject* self, PyObject* args);\n}\n\n// Define the methods with docstrings\nstatic PyMethodDef myMethods[] = {\n    {\"init\", init, METH_VARARGS, \"Runs SPMD function\" },\n    {\"begin\", begin, METH_VARARGS, \"Spawns an amount of processes\"}, \n    {\"end\", end, METH_NOARGS, \"Ends the processes\"},\n    {\"execute\", execute, METH_VARARGS, \"Execute function\"},\n    {\"pid\", pid, METH_NOARGS, \"Returns processor ID\"},\n    {\"nprocs\", nprocs, METH_NOARGS, \"Returns number of processors.\"},\n    {NULL, NULL, 0, NULL}\n};\n\n// Define the module\nstatic struct PyModuleDef BSPy = {\n    PyModuleDef_HEAD_INIT,\n    \"BSPy\",\n    \"A Python implementation of BSP\",\n    -1,\n    myMethods\n};\n\n\n// Initialize the module\nPyMODINIT_FUNC PyInit_BSPy(void) {\n    return PyModule_Create(&amp;BSPy);\n}\n///* Goes on to define each function. Only the simplest example is shown here.*///\nstatic PyObject* end(PyObject* self, PyObject* args) {\n    bsp_end();\n    return Py_None;\n}\n</code></pre>\n"}, {"tags": ["c++", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1542211885, "post_id": 53304414, "comment_id": 93489623, "body": "note: <a href=\"https://stackoverflow.com/q/31816095/5470596\">stackoverflow.com/q/31816095/5470596</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542212127, "post_id": 53304414, "comment_id": 93489783, "body": "By the way, modern compilers with optimizations enabled will instead do invalid opcode trap."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1542212431, "post_id": 53304414, "comment_id": 93489968, "body": "Please <a href=\"https://stackoverflow.com/posts/53304414/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1542212482, "post_id": 53304414, "comment_id": 93490002, "body": "You really ought to avoid <code>using namespace std</code> - it is a bad habit to get into, and <a href=\"/q/1452721\">can silently change the meaning of your program</a> when you&#39;re not expecting it.  Get used to using the namespace prefix (<code>std</code> is intentionally very short), or importing <i>just the names you need</i> into the <i>smallest reasonable scope</i>.  It&#39;s especially pernicious in header files, as you now inflict the problem on every source file that includes the header!"}], "answers": [{"comments": [{"owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "edited": false, "score": 0, "creation_date": 1542212827, "post_id": 53304429, "comment_id": 93490222, "body": "When you say referencing the null pointer, are you referring to head-&gt;next?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "edited": false, "score": 1, "creation_date": 1542213217, "post_id": 53304429, "comment_id": 93490470, "body": "@SimonGarfe Yes. <code>head-&gt;</code> dereferences <code>head</code>. Dereferencing the null pointer is illegal."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 5, "last_activity_date": 1542211843, "creation_date": 1542211843, "answer_id": 53304429, "question_id": 53304414, "link": "https://stackoverflow.com/questions/53304414/why-is-this-program-giving-a-segmentation-fault/53304429#53304429", "title": "Why is this program giving a segmentation fault?", "body": "<p>Because dereferencing a null pointer (<code>head</code> <strong>IS</strong> null) is <a href=\"https://stackoverflow.com/q/2397984/5470596\">undefined behavior</a> whose consequence can be a segmentation fault:</p>\n\n<pre><code>if(head == nullptr) //if the list is empty\n{\n    head -&gt; next = new SinglyLinkedListNode(data);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42, "user_id": 4493142, "user_type": "registered", "profile_image": "https://graph.facebook.com/517965456/picture?type=large", "display_name": "Andrew McCallum", "link": "https://stackoverflow.com/users/4493142/andrew-mccallum"}, "is_accepted": false, "score": 0, "last_activity_date": 1542212187, "creation_date": 1542212187, "answer_id": 53304534, "question_id": 53304414, "link": "https://stackoverflow.com/questions/53304414/why-is-this-program-giving-a-segmentation-fault/53304534#53304534", "title": "Why is this program giving a segmentation fault?", "body": "<p>Head is null.\nYou cannot access the 'next' field of a null object.</p>\n\n<pre><code>if(head == nullptr) //if the list is empty\n{\n    head = new SinglyLinkedListNode(data);\n    return head;\n}\nreturn insertNodeAtTail(head-&gt;next, data)\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 5795193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LOLw6.jpg?s=128&g=1", "display_name": "Papaya-Automaton", "link": "https://stackoverflow.com/users/5795193/papaya-automaton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 53304429, "answer_count": 2, "score": 2, "last_activity_date": 1542213356, "creation_date": 1542211790, "last_edit_date": 1542213356, "question_id": 53304414, "link": "https://stackoverflow.com/questions/53304414/why-is-this-program-giving-a-segmentation-fault", "title": "Why is this program giving a segmentation fault?", "body": "<p>I'm currently trying to solve coding challenge for studying for my intro c++ course and I'm just trying to understand the segmentation fault error I'm getting.</p>\n\n<p>I'm writing a given function to insert nodes at the tail of a linked list. The idea is that given an input of integers the first input would be considered part of the end of the list because it's pointer member variable would be <code>nullptr</code>. Afterwards, all other inputs would have to be appended so that their insertion occurs before that null node.</p>\n\n<p>Here's my first part of the function:</p>\n\n<pre><code>SinglyLinkedListNode* insertNodeAtTail(SinglyLinkedListNode* head, int data) {\n\n\nif(head == nullptr) //if the list is empty\n{\n    head -&gt; next = new SinglyLinkedListNode(data);\n    return head;\n}\n\nreturn head;\n\n} \n</code></pre>\n\n<p>however this part of the function is giving me a segmentation fault error:</p>\n\n<pre><code>head -&gt; next = new SinglyLinkedListNode(data);\n</code></pre>\n\n<p>These are the class declarations:</p>\n\n<pre><code>#include &lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\nclass SinglyLinkedListNode {\n public:\n    int data;\n    SinglyLinkedListNode *next;\n\n    SinglyLinkedListNode(int node_data) {\n        this-&gt;data = node_data;\n        this-&gt;next = nullptr;\n    }\n     };\n\nclass SinglyLinkedList {\npublic:\n    SinglyLinkedListNode *head;\n\n    SinglyLinkedList() {\n        this-&gt;head = nullptr;\n    }\n\n };\n</code></pre>\n\n<p>and Main:</p>\n\n<pre><code>int main()\n{\nofstream fout(getenv(\"OUTPUT_PATH\"));\n\nSinglyLinkedList* llist = new SinglyLinkedList();\n\nint llist_count;\ncin &gt;&gt; llist_count;\ncin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n\nfor (int i = 0; i &lt; llist_count; i++) {\n    int llist_item;\n    cin &gt;&gt; llist_item;\n    cin.ignore(numeric_limits&lt;streamsize&gt;::max(), '\\n');\n\n    SinglyLinkedListNode* llist_head =\n    insertNodeAtTail(llist-&gt;head, llist_item);\n    llist-&gt;head = llist_head;\n}\n\nprint_singly_linked_list(llist-&gt;head, \"\\n\", fout);\nfout &lt;&lt; \"\\n\";\n\nfree_singly_linked_list(llist-&gt;head);\n\nfout.close();\n\nreturn 0;\n }\n</code></pre>\n\n<p>I was thinking that :</p>\n\n<pre><code> head -&gt; next = new SinglyLinkedListNode(data);\n</code></pre>\n\n<p>would create a new node with the data argument as it's member data and then the current head node would point to that list.</p>\n\n<p>I would like to know why this segmentation fault is occurring. Also, I cannot change any of the class declaration or constructors since that's how they are given in the challenge.</p>\n\n<p>GDB Trace:</p>\n\n<pre><code>Reading symbols from solution...done.\n[New LWP 22279]\nCore was generated by `solution'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x0000000000400eea in insertNodeAtTail (head=&lt;optimized out&gt;, \ndata=&lt;optimized out&gt;) at solution.cc:62\n62          head -&gt; next = new SinglyLinkedListNode(data);\n#0  0x0000000000400eea in insertNodeAtTail (head=&lt;optimized out&gt;, \ndata=&lt;optimized out&gt;) at solution.cc:62\n#1  0x0000000000400c2e in main () at solution.cc:88\n</code></pre>\n"}, {"tags": ["c++", "templates", "template-meta-programming"], "comments": [{"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542211683, "post_id": 53304299, "comment_id": 93489510, "body": "<a href=\"https://en.cppreference.com/w/cpp/utility/functional/not1\" rel=\"nofollow noreferrer\"><code>std::not1(base::comp)</code>?</a>"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1542211714, "post_id": 53304299, "comment_id": 93489527, "body": "Even if there would be some miniscule overhead (with optimizations there could be none), I&#39;m not seeing how you can get <code>greater_equal</code> from <code>less</code> without a <code>!</code>. This seems like a textbook premature optimization, to be honest."}, {"owner": {"reputation": 2592, "user_id": 85936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XjRa.jpg?s=128&g=1", "display_name": "veefu", "link": "https://stackoverflow.com/users/85936/veefu"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1542212016, "post_id": 53304299, "comment_id": 93489699, "body": "@YSC I did see this, but noticed it is deprecated and soon to be obsolete."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542212216, "post_id": 53304299, "comment_id": 93489837, "body": "And for a good reason: it&#39;s been made obsolete since lambdas."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1542212274, "post_id": 53304299, "comment_id": 93489870, "body": "You can create a templatized trait, which would select the opposite version based on the template argument, and specify each conversion. Tedious, and likely no quantifiable performance benefit."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542222337, "post_id": 53304299, "comment_id": 93494986, "body": "@YSC: isn&#39;t <code>not_fn</code> a replacement for it?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1542222434, "post_id": 53304299, "comment_id": 93495032, "body": "@geza And they are all evil from the perspective of the question."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1542222590, "post_id": 53304299, "comment_id": 93495095, "body": "@PasserBy: Evil? why?"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1542222644, "post_id": 53304299, "comment_id": 93495119, "body": "@geza <i>&quot;I&#39;ve simply used the not (!) operator to get the job done, but would this incur an, albeit very small, runtime cost?&quot;</i>"}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1542222890, "post_id": 53304299, "comment_id": 93495230, "body": "@PasserBy: ah, ok :) I think it&#39;s very rarely matters. I mean, most of the time, code won&#39;t be supoptimal because of it. Anyways, I&#39;ve just asked about <code>not_fn</code>, because as it seems, it is not deprecated without a replacement."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1542223572, "post_id": 53304299, "comment_id": 93495537, "body": "@veefu: I would not worry about the performance. If you use LTO, it&#39;s almost certain that you don&#39;t get any performance degradation. If you don&#39;t use LTO, then in very rare circumstances, you can get a very small hit."}, {"owner": {"reputation": 2592, "user_id": 85936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XjRa.jpg?s=128&g=1", "display_name": "veefu", "link": "https://stackoverflow.com/users/85936/veefu"}, "edited": false, "score": 0, "creation_date": 1542224820, "post_id": 53304299, "comment_id": 93496078, "body": "Why is everyone so concerned about performance? That really wasn&#39;t my question."}], "answers": [{"comments": [{"owner": {"reputation": 2592, "user_id": 85936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XjRa.jpg?s=128&g=1", "display_name": "veefu", "link": "https://stackoverflow.com/users/85936/veefu"}, "edited": false, "score": 0, "creation_date": 1542216229, "post_id": 53305268, "comment_id": 93492120, "body": "Perhaps mentioning a runtime cost at all has gotten away from what I really mean to ask. The question is whether there is a built-in way to deduce at that <code>not (std::less)</code> is more simply expressed as <code>std::greater_equal</code> at compile time."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 1, "creation_date": 1542217779, "post_id": 53305268, "comment_id": 93492889, "body": "&quot;operations that have no observable difference can be implemented identically in assembly&quot;. It is theoretically possible, but there are a lot of occasions where the compiler doesn&#39;t do it. But you&#39;re right on the part that the extra negation usually doesn&#39;t cost anything, as it can be fused into some other operation."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 2592, "user_id": 85936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XjRa.jpg?s=128&g=1", "display_name": "veefu", "link": "https://stackoverflow.com/users/85936/veefu"}, "edited": false, "score": 0, "creation_date": 1542218008, "post_id": 53305268, "comment_id": 93492988, "body": "@veefu the comparator is passed in, so definitely not?"}, {"owner": {"reputation": 2592, "user_id": 85936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XjRa.jpg?s=128&g=1", "display_name": "veefu", "link": "https://stackoverflow.com/users/85936/veefu"}, "edited": false, "score": 0, "creation_date": 1542225543, "post_id": 53305268, "comment_id": 93496395, "body": "@Yakk-AdamNevraumont I&#39;ve added to the question a bit, which maybe clarifies the question, to some degree. You mention &quot;observable differences on <i>primative</i> types&quot;. Why the qualified answer? What happens with more complicated user-defined types in such cases?"}], "tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 2, "last_activity_date": 1542214734, "creation_date": 1542214734, "answer_id": 53305268, "question_id": 53304299, "link": "https://stackoverflow.com/questions/53304299/compile-time-opposite-of-stdless/53305268#53305268", "title": "Compile-time &quot;opposite&quot; of std::less?", "body": "<p>There is no observable difference between <code>!&lt;</code> and <code>&gt;=</code> on primitive types, so your fear of a runtime cost is ungrounded.</p>\n\n<p>C++ is not assembly.  It describes the behaviour of an abstract machine.  Compilers map this to assembly, and operations that have no observable difference can be implemented identically in assembly.</p>\n\n<p>While it takes some experience to learn what is \"observable\" in C++, the general rule is write clean code that avoids allocations when reasonable, keep da contiguous and keep O-notation speed sane, then test programs for performance problems before you worry about other issues.</p>\n\n<p><code>!&lt;</code> vs <code>&gt;=</code> is not one of the \"avoid premature pessimisation\" issues, so you should ignore it unless you find the code when profiling.</p>\n"}], "owner": {"reputation": 2592, "user_id": 85936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0XjRa.jpg?s=128&g=1", "display_name": "veefu", "link": "https://stackoverflow.com/users/85936/veefu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542235703, "creation_date": 1542211437, "last_edit_date": 1542235703, "question_id": 53304299, "link": "https://stackoverflow.com/questions/53304299/compile-time-opposite-of-stdless", "title": "Compile-time &quot;opposite&quot; of std::less?", "body": "<p>Apologies in advance. I'm having a bit of difficulty finding the right phrasing for this question...</p>\n\n<p>As an exercise, I'm working on a fixed-size priority queue that throws away objects greater than the max (for a queue finding the X smallest object) and throws away objects less than min (for queue holding the largest X objects). The question is whether there is way of arriving at the logical \"opposite\" of the comparator at compile-time.</p>\n\n<p>See commented line in the code below:</p>\n\n<pre><code>template &lt;\n    typename T, \n    typename Container = std::vector&lt;T&gt;, \n    typename Compare = std::less&lt;typename Container::value_type&gt;&gt;\nclass fixed_size_priority_queue : public std::priority_queue&lt;T, Container, Compare&gt;\n{\n    typename Container::size_type maxSize;\n    using base = std::priority_queue&lt;T, Container, Compare&gt;;\n\n  public:\n    fixed_size_priority_queue(std::size_t size) : base(), maxSize(size)\n    {\n        base::c.reserve(size);\n    }\n    void push(T value)\n    {\n        if (base::size() &lt; maxSize)\n        {\n            base::push(value);\n        }\n        // is there some way of arriving at compile-time opposite of 'comp'?\n        else if (!base::comp(base::top(), value))\n        {\n            while (base::size() &gt;= maxSize)\n            {\n                base::pop();\n            }\n            base::push(value);\n        }\n    }\n};\n\nvoid test_fixedPriQueue()\n{\n\n    using smallestInts = fixed_size_priority_queue&lt;int&gt;;\n    smallestInts fq(4);\n    fq.push(5);\n    fq.push(3);\n    fq.push(5);\n    fq.push(5);\n    fq.push(7);\n    fq.push(11);\n    fq.push(1);\n    fq.push(2);\n}\n\nint main(int argc, char const *argv[])\n{\n    test_fixedPriQueue();\n    return 0;\n}\n</code></pre>\n\n<p>I've simply used the not (!) operator to get the job done, but would this incur an, albeit very small, runtime cost? Is there a way to arrive at <code>std::greater_equal</code> when my class uses <code>Compare = std::less</code>?</p>\n\n<p>I was hoping to use something like <code>std::not&lt;Compare&gt;</code> which would resolve to <code>std::greater_equal</code> when the <code>Compare</code> template parameter is <code>std::less</code>. Does that make sense?</p>\n\n<p>** edit **</p>\n\n<p>Trying the suggestion from sergeyA yielded what I was looking for:</p>\n\n<pre><code>template&lt;typename T, typename Comparison&gt;\nstruct logical_opposite\n{\n    using op = void;\n};\n\ntemplate &lt;typename T&gt;\nstruct logical_opposite&lt;T, std::less&lt;T&gt;&gt;\n{\n    using op = std::greater_equal&lt;T&gt;;\n};\n\ntemplate &lt;typename T&gt;\nstruct logical_opposite&lt;T, std::greater&lt;T&gt;&gt;\n{\n    using op = std::less_equal&lt;T&gt;;\n};\n</code></pre>\n\n<p>Then in the class derived from priority_queue, instantiate the logical opposite function object and use it when pushing into the queue:</p>\n\n<pre><code>//...\ntypename logical_opposite&lt;T, Compare&gt;::op not_comp;\n\npublic:\nfixed_size_priority_queue(std::size_t size) : base(), maxSize(size), not_comp()\n//....\n</code></pre>\n\n<p>There is a logical relationship between the comparison functor types and I was hoping that relationship was expressed in the STL.</p>\n"}, {"tags": ["c++", "visual-c++"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1542210901, "post_id": 53304056, "comment_id": 93489008, "body": "<a href=\"//stackoverflow.com/q/495021\">Why can templates only be implemented in the header file?</a>"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 1, "creation_date": 1542210921, "post_id": 53304056, "comment_id": 93489023, "body": "The declaration in your class <code>void displayGrades(std::ostream&amp;, T) const;</code> does not match your definition in grade.cpp <code>void Grades::displayGrades(std::ostream&amp; os, T letter) const</code>"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1542211513, "post_id": 53304056, "comment_id": 93489407, "body": "@Yastanub 1) What part of it doesn&#39;t match? 2) If it didn&#39;t match, you would get the error similar to &quot;<i>definition of &#39;method&#39; does not match any declaration in &#39;class&#39;</i>&quot; before linker would even be invoked."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542211711, "post_id": 53304056, "comment_id": 93489525, "body": "@AlgirdasPreid\u017eius a sry i see now i looked too quick."}], "owner": {"reputation": 11, "user_id": 10649523, "user_type": "registered", "profile_image": "https://graph.facebook.com/2365159103513528/picture?type=large", "display_name": "Albert Zhang", "link": "https://stackoverflow.com/users/10649523/albert-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542211925, "creation_date": 1542210699, "question_id": 53304056, "link": "https://stackoverflow.com/questions/53304056/lnk-2019-error-on-missing-library-in-w5-cpp", "title": "LNK 2019 error on missing library in W5.cpp", "body": "<p>I am trying to run my code of getting a grade num to changing it to a char but I keep getting the LNK 2019 error even though I think I'm not missing anything any #includes I still don't know what is wrong will post my code and the error since I can't seem to find the problem any help would be great thanks. This is the main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;typeinfo&gt;\n#include \"Grades.h\"\n#include \"Letter.h\"\nusing namespace sict;\nint main(int argc, char* argv[]) {\n\nstd::ofstream ofs(\"Lab5Output.txt\");\n\nstd::cout &lt;&lt; \"Command Line : \";\nfor (int i = 0; i &lt; argc; i++) {\n    std::cout &lt;&lt; argv[i] &lt;&lt; ' ';\n}\nstd::cout &lt;&lt; std::endl;\n\nif (argc == 1) {\n    std::cerr &lt;&lt; \"\\n*** Insufficient number of arguments ***\\n\";\n    std::cerr &lt;&lt; \"Usage: \" &lt;&lt; argv[0] &lt;&lt; \" fileName \\n\";\n    return 1;\n}\nelse if (argc != 2) {\n    std::cerr &lt;&lt; \"\\n*** Too many arguments ***\\n\";\n    std::cerr &lt;&lt; \"Usage: \" &lt;&lt; argv[0] &lt;&lt; \" fileName \\n\";\n    return 2;\n}\ntry\n{\n    sict::Grades grades(argv[1]);\n    auto letter = [](double grade)\n    {\n        int grd;\n        if ((grade &gt;= 90) &amp;&amp; (grade &lt;= 100)) {\n            grd = Aplus;\n        }\n        else if ((grade &gt;= 80) &amp;&amp; (grade &lt; 90)) { \n            grd = A;\n        }\n        else if ((grade &gt;= 75) &amp;&amp; (grade &lt; 80)) { \n            grd = Bplus;\n        }\n        else if ((grade &gt;= 70) &amp;&amp; (grade &lt; 75)) { \n            grd = B;\n        }\n        else if ((grade &gt;= 65) &amp;&amp; (grade &lt; 70)) { \n            grd = Cplus;\n        }\n        else if ((grade &gt;= 60) &amp;&amp; (grade &lt; 65)) { \n            grd = C;\n        }\n        else if ((grade &gt;= 55) &amp;&amp; (grade &lt; 60)) { \n            grd = Dplus;\n        }\n        else if ((grade &gt;= 50) &amp;&amp; (grade &lt; 55)) { \n            grd = D;\n        }\n        else {\n            grd = F;\n        }\n\n        return grd;\n    };\n    grades.displayGrades(std::cout, letter);\n}\ncatch (const char * err)\n{\n    throw err;\n    return 1;\n}\nreturn 0;\nofs.close();\n}\n</code></pre>\n\n<p>this is the grades.cpp</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include \"Letter.h\"\n#include \"Grades.h\"\nusing namespace std;\nnamespace sict {\n Grades::Grades(const char* data ) {\n     if (data != nullptr &amp;&amp; data[0] != '\\0')    {\n         int i = 0;\n         int j = 0;\n         int sn;\n         double grade;\n         string getMarks;\n         ifstream fs(data);\n         while (getline(fs, getMarks)) {\n             i++;\n         }\n         lines = i;\n         this-&gt;studentnum = new int[lines];\n         this-&gt;gradenum = new double[lines];\n         fs.close();\n         fs.open(data);\n         while (getline(fs, getMarks)){\n             while (fs &gt;&gt; sn &gt;&gt; grade)\n             {\n                 this-&gt;studentnum[i] = sn;\n                 this-&gt;gradenum[i] = grade;\n                 i++;\n             }\n         }\n     }\n }\n template &lt;typename T&gt;\n void Grades::displayGrades(std::ostream&amp; os, T letter) const {\n     for (int i = 0; i &lt; lines; i++){\n         int grade = lambda(gradenum);\n         string letter = convert(grade);\n         os &lt;&lt; studentnum[i] &lt;&lt; \" \" &lt;&lt;gradesnum[i] &lt;&lt; \" \" &lt;&lt; letter(gradenum[i])&lt;&lt; std::endl;\n     }\n }\n}\n</code></pre>\n\n<p>this the grade.h</p>\n\n<pre><code>#ifndef SICT_GRADES_H\n#define SICT_GRADES_H\n#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include \"Letter.h\"\nnamespace sict {\nclass Grades {\n    int* studentnum;\n    double* gradenum;\n    char gradeletter;\n    size_t lines;\npublic:\n    Grades(const Grades&amp;) = delete; \n    Grades(Grades&amp;&amp;) = delete; \n    Grades&amp; operator=(const Grades&amp;) = delete; \n    Grades&amp;&amp; operator=(Grades&amp;&amp;) = delete;\n    Grades(const char*);\n    template &lt;typename T&gt;\n    void displayGrades(std::ostream&amp;, T) const;\n    ~Grades() { delete [] studentnum; delete [] gradenum; };\n};\n}\n#endif // !SICT_GRADES_H\n</code></pre>\n\n<p>and this it the letter.h</p>\n\n<pre><code>#ifndef SICT_LETTER_H\n#define SICT_LETTER_H\n#include &lt;string&gt;\n#include \"Grades.h\"\nusing namespace std;\nnamespace sict {\nenum marks  {\n    F, D, Dplus, C, Cplus, B, Bplus, A, Aplus\n};\ntemplate &lt;typename T&gt;\nstring convert(T&amp; mark) {\n    string grade = \"\";\n    if (mark = marks::F){\n        grade = \"F\";\n    }\n    else if (mark = marks::D) {\n        grade = \"D\";\n    }\n    else if (mark = marks::Dplus) {\n        grade = \"D+\";\n    }\n    else if (mark = marks::C) {\n        grade = \"C\";\n    }\n    else if (mark = marks::Cplus) {\n        grade = \"C+\";\n    }\n    else if (mark = marks::B) {\n        grade = \"B\";\n    }\n    else if (mark = marks::Bplus) {\n        grade = \"B+\";\n    }\n    else if (mark = marks::A) {\n        grade = \"A\";\n    }\n    else if (mark = marks::Aplus) {\n        grade = \"A+\";\n    }\n    return grade;\n}\n}\n#endif // !SICT_GRADES_H\n</code></pre>\n\n<p>but I keep getting this error </p>\n\n<pre><code>Severity    Code    Description Project File    Line    Suppression State\nError   LNK2019 unresolved external symbol \"public: void __thiscall \nsict::Grades::displayGrades&lt;class &lt;lambda_6686105985789fb8252d1ceed5cbf23c&gt; \n&gt;(class std::basic_ostream&lt;char,struct std::char_traits&lt;char&gt; &gt; &amp;,class \n&lt;lambda_6686105985789fb8252d1ceed5cbf23c&gt;)const \" (?? $displayGrades@V&lt;lambda_6686105985789fb8252d1ceed5cbf23c&gt;@@@Grades@sict@@QBEXAA V?$basic_ostream@DU?$char_traits@D@std@@@std@@V&lt;lambda_6686105985789fb8252d1ceed5cbf23c&gt;@@@Z) \nreferenced in function _main    Lambda Experssion C:\\Users\\Albert\\Documents\\Lambda Experssion\\W5.obj    1   \n</code></pre>\n\n<p>any help would be greatly appreciated thank you</p>\n"}, {"tags": ["c++", "v8"], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 10419533, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--F3jw9Ikk28/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUo1qO8RO0j6Z6ZB0BkJSmQhsV6Hw/mo/photo.jpg?sz=128", "display_name": "Aur&#233;lien Foucault", "link": "https://stackoverflow.com/users/10419533/aur%c3%a9lien-foucault"}, "edited": false, "score": 0, "creation_date": 1542622189, "post_id": 53310597, "comment_id": 93620580, "body": "How I can handle all properties with <code>setHandler</code> because my getter take only the first property. Have you an example of a implementation of <code>setHandler</code> ? I juste add a <code>v8::NamedPropertyHandlerConfiguration</code> with only <code>getter</code> and <code>setter</code> field defined with my old functions."}, {"owner": {"reputation": 418, "user_id": 10419533, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--F3jw9Ikk28/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUo1qO8RO0j6Z6ZB0BkJSmQhsV6Hw/mo/photo.jpg?sz=128", "display_name": "Aur&#233;lien Foucault", "link": "https://stackoverflow.com/users/10419533/aur%c3%a9lien-foucault"}, "edited": false, "score": 0, "creation_date": 1542631098, "post_id": 53310597, "comment_id": 93625271, "body": "All my fields have undefined value."}], "tags": [], "owner": {"reputation": 18838, "user_id": 6036428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b632c15ba23e78e466c8d33d657378fe?s=128&d=identicon&r=PG&f=1", "display_name": "jmrk", "link": "https://stackoverflow.com/users/6036428/jmrk"}, "is_accepted": true, "score": 1, "last_activity_date": 1542240209, "creation_date": 1542240209, "answer_id": 53310597, "question_id": 53303232, "link": "https://stackoverflow.com/questions/53303232/v8-setaccesor-cant-add-to-a-existing-template/53310597#53310597", "title": "V8 - SetAccesor can&#39;t add to a existing template", "body": "<p>Don't use the same <code>ObjectTemplate</code> for objects with different numbers of properties.</p>\n\n<p>I can think of two alternatives; which one is better depends on the rest of your app:</p>\n\n<ul>\n<li><p>create a fresh <code>Object</code> every time, and call <code>SetAccessor</code> (or <code>CreateDataProperty</code>?) directly on that <code>Object</code>. No <code>ObjectTemplate</code> required.</p></li>\n<li><p>use <code>SetHandler</code> on the <code>ObjectTemplate</code> to install a single handler that intercepts <em>all</em> property queries.</p></li>\n</ul>\n"}], "owner": {"reputation": 418, "user_id": 10419533, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--F3jw9Ikk28/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUo1qO8RO0j6Z6ZB0BkJSmQhsV6Hw/mo/photo.jpg?sz=128", "display_name": "Aur&#233;lien Foucault", "link": "https://stackoverflow.com/users/10419533/aur%c3%a9lien-foucault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53310597, "answer_count": 1, "score": 1, "last_activity_date": 1542240209, "creation_date": 1542208026, "last_edit_date": 1542209336, "question_id": 53303232, "link": "https://stackoverflow.com/questions/53303232/v8-setaccesor-cant-add-to-a-existing-template", "title": "V8 - SetAccesor can&#39;t add to a existing template", "body": "<p>I have the following code :</p>\n\n<pre><code>        while (bson_iter_next(&amp;iter))\n        {\n            const char* key = bson_iter_key(&amp;iter);\n            if (!_paths.count(key)) \n            {\n                _template-&gt;SetAccessor(\n                    String::NewFromUtf8(isolate, key),\n                    &amp;BSONObject::getter,\n                    &amp;BSONObject::setter\n                );\n            }\n        }\n\n    Local&lt;Object&gt; obj = _template-&gt;NewInstance();\n</code></pre>\n\n<p>I build a object with all fields in a document BSON. I have a list of documents and they all go through this code. I realized that if the first have not fields which others have they won't be define. I explain :</p>\n\n<pre><code>BSON 1 : {foo: 3}\nBSON 2 : {foo: 2, boo: 4}\n</code></pre>\n\n<p>When I will use my getter in JS he will show me :</p>\n\n<pre><code>BSON 1 : {foo: 3}\nBSON 2 : {foo: 2}\n</code></pre>\n\n<p><strong>How I can add this field's accessor ?</strong></p>\n"}, {"tags": ["c++", "windows", "user-interface", "winapi"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542208262, "post_id": 53303231, "comment_id": 93487379, "body": "You don&#39;t need the process id of a maybe open task manager but a list of processes running on the system and a window containing a listbox to display it."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1542208291, "post_id": 53303231, "comment_id": 93487400, "body": "Some info: <a href=\"https://docs.microsoft.com/en-us/windows/desktop/procthread/process-enumeration\" rel=\"nofollow noreferrer\">Process Enumeration</a> Also, don&#39;t think you&#39;ve failed because you can&#39;t display all information about all processes. Some you don&#39;t have permissions to examine. You can run your final program as administrator to get some more info, but some will be really hard to find out."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542208943, "post_id": 53303231, "comment_id": 93487746, "body": "Is going with WIndows API to create the GUI a requirement? If it is not, I&#39;d urge you not to go down this route and use a framework."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542209748, "post_id": 53303231, "comment_id": 93488230, "body": "Otoh, there are some pretty short and simple examples on MSDN for doing this. The <a href=\"https://docs.microsoft.com/sv-se/windows/desktop/psapi/enumerating-all-processes\" rel=\"nofollow noreferrer\">Enumerating All Processes example</a> could be used as a base."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10652625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8134798dacc6d48dd5917ef34c0d5012?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/10652625/andrea"}, "edited": false, "score": 0, "creation_date": 1542255908, "post_id": 53306622, "comment_id": 93505365, "body": "Can you explain to me a bit what&#39;s going on in there? I kinda lost myself a bit"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 1, "user_id": 10652625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8134798dacc6d48dd5917ef34c0d5012?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/10652625/andrea"}, "edited": false, "score": 0, "creation_date": 1542256410, "post_id": 53306622, "comment_id": 93505466, "body": "@Alexandra I&#39;ll add comments as soon as I have time."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 1, "user_id": 10652625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8134798dacc6d48dd5917ef34c0d5012?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/10652625/andrea"}, "edited": false, "score": 0, "creation_date": 1542268876, "post_id": 53306622, "comment_id": 93509706, "body": "@Alexandra Done. If you have further questions feel free to ask away."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1542270246, "post_id": 53306622, "comment_id": 93510378, "body": "Don&#39;t think we should be doing homework projects in this way. This question should be closed rather than answered."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": -1, "last_activity_date": 1542268852, "last_edit_date": 1542268852, "creation_date": 1542220107, "answer_id": 53306622, "question_id": 53303231, "link": "https://stackoverflow.com/questions/53303231/how-to-create-a-graphical-application-where-the-list-of-active-processes-is-disp/53306622#53306622", "title": "How to create a graphical application where the list of active processes is displayed in a list", "body": "<p>I wouldn't use psapi. And it isn't toooo hard:</p>\n\n<pre><code>#include &lt;cstddef&gt;  // std::size_t\n#include &lt;vector&gt;   // std::vector&lt;&gt;\n#include &lt;string&gt;   // std::wstring\n#include &lt;sstream&gt;  // std::wostringstream\n\n#include &lt;windows.h&gt;\n#include &lt;tlhelp32.h&gt;  // CreateToolhelp32Snapshot(), Process32FirstW(),\n                       // Process32NextW(),\n#include &lt;commctrl.h&gt;  // InitCommonControlsEx(), ICC_LISTVIEW_CLASSES, WC_LISTVIEWW\n#pragma comment(lib, \"comctl32.lib\")  // tell Linker to link against the\n                                      // Windows Common Controls Library\n\nstruct process_data_t {  // datastructure to represent a process\n    std::wstring pid;    // number as string for convenience\n    std::wstring name;   // the name of the executable\n};\n\n// function to get the current processes running on the system\nvoid update_process_data(std::vector&lt;process_data_t&gt; &amp;process_data)\n{\n                   // take a snapshot of the running processes\n    auto snapshot{ CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0) };\n\n    if (snapshot == INVALID_HANDLE_VALUE) {  // validate the result\n        MessageBoxW(nullptr, L\"CreateToolhelp32Snapshot() failed :(\", L\"Error:\", MB_ICONEXCLAMATION);\n        return;\n    }\n\n    // Process32FirstW() and Process32NextW() will fill a structure of type\n    PROCESSENTRY32W pe{ sizeof pe };       // with info about one process at \n    if (!Process32FirstW(snapshot, &amp;pe)) { // a time from the snapshot\n        MessageBoxW(nullptr, L\"Process32FirstW() failed :(\", L\"Error:\", MB_ICONEXCLAMATION);\n        CloseHandle(snapshot);\n        return;\n    }\n\n    BOOL result{ true };   // result of Process32NextW()\n    process_data.clear();  // discard the old data\n\n    for (std::size_t i{}; result; result = Process32NextW(snapshot, &amp;pe), ++i) {\n        if (i + 1 &gt; process_data.capacity())  // if we come close to the vectors\n            process_data.reserve(process_data.capacity() + 100); // capacity, increase it\n\n        std::wostringstream woss;  // a stream to convert the process-id\n        woss &lt;&lt; pe.th32ProcessID;  // to a std::wstring\n\n        // add the data to our vector:\n        process_data.push_back({ woss.str(), pe.szExeFile });\n    }\n\n    // don't forget to close the handle opened by CreateToolhelp32Snapshot()\n    CloseHandle(snapshot);  // better solution: use a `std::unique_ptr&lt;&gt;` with\n};                          // a custom deleter. Sorry, was to lazy to do so.\n\n// Window procedure that will get called when our application receives messages\nLRESULT APIENTRY window_proc(HWND window, UINT message, WPARAM wparam, LPARAM lparam)\n{\n    static HWND list_view;  // a handle to the listview we'll create in WM_CREATE\n    static std::vector&lt;process_data_t&gt; process_data;  // data about processes\n                                                      // to display in the\n                                                      // listview\n\n    switch (message) {\n        case WM_CREATE:  // create child-windows when the parent gets created:\n        {\n            CREATESTRUCTW *create_struct{ reinterpret_cast&lt;CREATESTRUCTW*&gt;(lparam) };\n            list_view = CreateWindowW(WC_LISTVIEWW, L\"\", WS_CHILD | WS_VISIBLE | LVS_REPORT | LVS_OWNERDATA,\n                                      5, 5, create_struct-&gt;cx - 10, create_struct-&gt;cy - 10,\n                                      window, (HMENU)100, create_struct-&gt;hInstance, nullptr);\n            if (!list_view)  // abort window creation if\n                return -1;   // creation of the listview child failed\n\n            LVCOLUMNW columns[2];  // to add 2 columns to our listview\n            columns[0].mask = columns[1].mask = LVCF_TEXT | LVCF_WIDTH;\n            columns[0].pszText = const_cast&lt;wchar_t*&gt;(L\"PID\");\n            columns[0].cx = 200;  // width of the column\n            columns[1].pszText = const_cast&lt;wchar_t*&gt;(L\"Name\");\n            columns[1].cx = 800;  // dito\n            for (std::size_t i{}; i &lt; std::size(columns); ++i) {\n                // insert the column to the listview:\n                if (SendMessageW(list_view, LVM_INSERTCOLUMN, i, reinterpret_cast&lt;LPARAM&gt;(&amp;columns[i])) == -1)\n                    return -1;\n            }\n\n            update_process_data(process_data);  // populate our process data\n\n            // tell the listview how many items to display:\n            SendMessageW(list_view, LVM_SETITEMCOUNT, process_data.size(), LVSICF_NOSCROLL);\n\n            // have Windows send us a message (WM_TIMER) every 250 ms\n            SetTimer(window, 0, 250, nullptr);\n\n            return 0;  // all went well.\n        }\n\n        case WM_TIMER:  // message we receive every 250 ms to update\n            update_process_data(process_data);  // the process data\n\n            // and inform the listview about changes in the item count\n            SendMessageW(list_view, LVM_SETITEMCOUNT, process_data.size(), LVSICF_NOSCROLL);\n            return 0;\n\n        case WM_NOTIFY:  // we will be notified when the listview wants us\n                         // to provide data to display\n            if (reinterpret_cast&lt;NMHDR*&gt;(lparam)-&gt;code == LVN_GETDISPINFO) {\n                NMLVDISPINFO *dispinfo{ reinterpret_cast&lt;NMLVDISPINFO*&gt;(lparam) };\n                if (dispinfo-&gt;item.iSubItem) {  // if the listview wants subitem\n                                                // at index dispinfo-&gt;item.iItem\n                    dispinfo-&gt;item.pszText = const_cast&lt;wchar_t*&gt;(process_data[dispinfo-&gt;item.iItem].name.c_str());  // give it the process' name\n                }\n                else {\n                    dispinfo-&gt;item.pszText = const_cast&lt;wchar_t*&gt;(process_data[dispinfo-&gt;item.iItem].pid.c_str());   // give it the pid\n                }\n                return TRUE;\n            }\n            return 0;\n\n        case WM_SIZE:\n            // resize our child-window along with its parent:\n            MoveWindow(list_view, 5, 5, LOWORD(lparam) - 10, HIWORD(lparam) - 10, TRUE);\n            return 0;\n\n        case WM_DESTROY:\n            PostQuitMessage(0);\n            return 0;\n    }\n\n    return DefWindowProcW(window, message, wparam, lparam);\n}\n\nint WINAPI WinMain(HINSTANCE instance, HINSTANCE prev_instance, char*, int show_state)\n{\n    // initialize the Windows Common Controls library to use a listview\n    INITCOMMONCONTROLSEX iccex{ sizeof iccex, ICC_LISTVIEW_CLASSES };\n    if (!InitCommonControlsEx(&amp;iccex)) {\n        MessageBoxW(nullptr, L\"Initializing common windows controls library failed :(\", L\"Error\", MB_ICONEXCLAMATION);\n        return 0;\n    }\n\n    // prepare the window class for our window:\n    WNDCLASSW wc{};\n    wc.lpfnWndProc = window_proc;\n    wc.lpszClassName = L\"Poor Mans TaskMan Window Class\";\n    wc.hbrBackground = reinterpret_cast&lt;HBRUSH&gt;(COLOR_WINDOW + 1);\n    wc.hCursor = LoadCursor(nullptr, IDC_ARROW);\n    wc.style = CS_HREDRAW | CS_VREDRAW | CS_PARENTDC;\n\n    // register the window class and check for possible error:\n    ATOM window_class{ RegisterClass(&amp;wc) };\n    if (!window_class) {\n        MessageBoxW(nullptr, L\"Registering window class failed :(\", L\"Error\", MB_ICONEXCLAMATION);\n        return 0;\n    }\n\n    // create a window of our now registered window class and handle possible error:\n    HWND window{ CreateWindowW(reinterpret_cast&lt;LPCWSTR&gt;(window_class), L\"Poor Mans TaskMan\", WS_OVERLAPPEDWINDOW,\n                               CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, nullptr, nullptr, instance,\n                               nullptr)\n    };\n    if (!window) {\n        MessageBoxW(nullptr, L\"Creating window failed :(\", L\"Error:\", MB_ICONEXCLAMATION);\n        return 0;\n    }\n\n    // update and show the window:\n    UpdateWindow(window);\n    ShowWindow(window, show_state);\n\n    // message-pump:\n    MSG msg;\n    BOOL result;\n    while (result = GetMessageW(&amp;msg, nullptr, 0, 0)) {\n        if (result == -1)\n            return msg.wParam;\n        TranslateMessage(&amp;msg);\n        DispatchMessageW(&amp;msg);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10652625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8134798dacc6d48dd5917ef34c0d5012?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/10652625/andrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542268852, "creation_date": 1542208019, "last_edit_date": 1542220637, "question_id": 53303231, "link": "https://stackoverflow.com/questions/53303231/how-to-create-a-graphical-application-where-the-list-of-active-processes-is-disp", "title": "How to create a graphical application where the list of active processes is displayed in a list", "body": "<p>So I have this school assignment that goes like this: </p>\n\n<p>Create a graphical application where the list of active processes in the system is displayed in a list box. For the selected process from the list, the following information will be specified:</p>\n\n<ol>\n<li>The appropriate PID</li>\n<li>The name of the executable file on which the process was launched</li>\n</ol>\n\n<p>I've made this, which show me if task manager is opened and if its opened it displays memory address:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;string&gt;\n#include &lt;TlHelp32.h&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nDWORD ProcessID;\n\nint main()\n{\n    HWND hwnd = FindWindowA(0, (\"Task Manager\"));\n\n    GetWindowThreadProcessId(hwnd, &amp;ProcessID);\n\n    if (hwnd) {\n        cout &lt;&lt; ProcessID &lt;&lt; endl;\n    }\n    else\n    {\n        cout &lt;&lt; \"Windows Not Found\" &lt;&lt; endl;\n    }\n\n    system(\"pause\");\n}\n</code></pre>\n\n<p>Can you guys help me by pointing in a direction or give some information to fulfill my asignment? Thanks in advance</p>\n"}, {"tags": ["c#", "c++"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1542207011, "post_id": 53302879, "comment_id": 93486489, "body": "Use an interprocess communication library. Either in memory, or network."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1380697"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542207657, "post_id": 53302879, "comment_id": 93486937, "body": "@MatthieuBrucher, it is not possible to use more tools than those already proposed. If you have any link to an example of memory use it would be perfect"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542207787, "post_id": 53302879, "comment_id": 93487027, "body": "Open a socket in C++, connect to it in C#, that should be enough. If you can use network."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1380697"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542208671, "post_id": 53302879, "comment_id": 93487597, "body": "For now everything is in the same physical location, there is no need for different repositories"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542208812, "post_id": 53302879, "comment_id": 93487684, "body": "If you can&#39;t use a network lib, an IPC lib or the crappy file way, then you can&#39;t do what you want."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1380697"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542209269, "post_id": 53302879, "comment_id": 93487944, "body": "An example that I have seen is the use of the public void CallBack {} function in the C++ application and using Marshalling from C #, but the proposal was incomplete and impossible to prove"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542209654, "post_id": 53302879, "comment_id": 93488168, "body": "And it uses either IPC or network communication."}, {"owner": {"reputation": 2969, "user_id": 5191073, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/628f44cad275ff1e2fd7230f8cdd5cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Pisz", "link": "https://stackoverflow.com/users/5191073/christopher-pisz"}, "edited": false, "score": 0, "creation_date": 1542213923, "post_id": 53302879, "comment_id": 93490887, "body": "You have to use inter process communication. You could use COM, or you could create a socket yourself, as other people have mentioned. Both would required at least 10 pages articles to cover and won&#39;t fit in an answer box or comment here. Google &quot;C++ to C# COM&quot; or &quot;Tcp Socket for &lt;language X&gt;&quot;"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1380697"}, "edited": false, "score": 0, "creation_date": 1542207518, "post_id": 53302942, "comment_id": 93486836, "body": "@Antoine V, I have seen that kind of technique but for security reasons it is not possible to be used"}, {"owner": {"reputation": 6470, "user_id": 6230863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008565f2c61035b443406297643f68f7?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine V", "link": "https://stackoverflow.com/users/6230863/antoine-v"}, "edited": false, "score": 0, "creation_date": 1542207639, "post_id": 53302942, "comment_id": 93486928, "body": "@Fisad it&#39;s up to you, this is a proposition that was used in one of my project :)"}, {"owner": {"reputation": 954, "user_id": 1854114, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/7071c25eecdca7d088286afaae2d342e?s=128&d=identicon&r=PG", "display_name": "Ricardo Alves", "link": "https://stackoverflow.com/users/1854114/ricardo-alves"}, "edited": false, "score": 1, "creation_date": 1542207906, "post_id": 53302942, "comment_id": 93487110, "body": "@AntoineV I understand it works, but it&#39;s a very crappy way to do that."}], "tags": [], "owner": {"reputation": 6470, "user_id": 6230863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008565f2c61035b443406297643f68f7?s=128&d=identicon&r=PG&f=1", "display_name": "Antoine V", "link": "https://stackoverflow.com/users/6230863/antoine-v"}, "is_accepted": true, "score": 0, "last_activity_date": 1542207031, "creation_date": 1542207031, "answer_id": 53302942, "question_id": 53302879, "link": "https://stackoverflow.com/questions/53302879/how-to-send-a-number-from-a-form-in-c-to-a-console-program-in-c/53302942#53302942", "title": "How to send a number from a form in C# to a console program in C++", "body": "<p>One proposition: When your app C# want to send a value, it writes it in a file in folder <code>C:\\Temps\\token.txt</code>. </p>\n\n<p>Then, if your application C++ detects a file named <code>token.txt</code> (by a loop for each 10s for example) in <code>C:\\Temps</code>, it reads it and gets the value</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1380697"}, "edited": false, "score": 0, "creation_date": 1542212937, "post_id": 53304155, "comment_id": 93490297, "body": "Fantastic but, what is needed is to implement it between C ++ and C # and not between C ++ and C ++"}, {"owner": {"reputation": 931, "user_id": 1504868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b41efcdd54ba679e9e553cc9599844?s=128&d=identicon&r=PG", "display_name": "serge", "link": "https://stackoverflow.com/users/1504868/serge"}, "edited": false, "score": 0, "creation_date": 1542213674, "post_id": 53304155, "comment_id": 93490753, "body": "I see, the Microsoft&#39;s example is for marshaling between unmanaged and managed code. You may write unmanaged code in C#, too."}, {"owner": {"reputation": 931, "user_id": 1504868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b41efcdd54ba679e9e553cc9599844?s=128&d=identicon&r=PG", "display_name": "serge", "link": "https://stackoverflow.com/users/1504868/serge"}, "edited": false, "score": 0, "creation_date": 1542222268, "post_id": 53304155, "comment_id": 93494950, "body": "You may write <b>managed</b> code in C#, too. Sorry, my mistype."}], "tags": [], "owner": {"reputation": 931, "user_id": 1504868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b41efcdd54ba679e9e553cc9599844?s=128&d=identicon&r=PG", "display_name": "serge", "link": "https://stackoverflow.com/users/1504868/serge"}, "is_accepted": false, "score": 0, "last_activity_date": 1542211622, "last_edit_date": 1542211622, "creation_date": 1542210964, "answer_id": 53304155, "question_id": 53302879, "link": "https://stackoverflow.com/questions/53302879/how-to-send-a-number-from-a-form-in-c-to-a-console-program-in-c/53304155#53304155", "title": "How to send a number from a form in C# to a console program in C++", "body": "<p>There are 2 solution not related to network or interprocess communications at least</p>\n\n<ul>\n<li>call unmanaged callback or delegate from managed code (see \"<a href=\"https://docs.microsoft.com/en-us/cpp/dotnet/how-to-marshal-callbacks-and-delegates-by-using-cpp-interop\" rel=\"nofollow noreferrer\">How to: Marshal Callbacks and Delegates By Using C++ Interop</a>\")</li>\n<li>use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/sync/using-event-objects\" rel=\"nofollow noreferrer\">an event object</a> to signal pressed button and a <a href=\"https://docs.microsoft.com/en-us/windows/desktop/memory/creating-named-shared-memory\" rel=\"nofollow noreferrer\">named shared memory</a> to pass a value back</li>\n</ul>\n\n<p>Please note that implementing complex things to doing simple ones is the characteristic of not well designed application.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1380697"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53302942, "answer_count": 2, "score": -2, "last_activity_date": 1542211622, "creation_date": 1542206848, "question_id": 53302879, "link": "https://stackoverflow.com/questions/53302879/how-to-send-a-number-from-a-form-in-c-to-a-console-program-in-c", "title": "How to send a number from a form in C# to a console program in C++", "body": "<p>I need to run an unmanaged C++ application, this application must be connected to a library in C# (dll which when loading must show a form with a button) and wait for form close event to terminate.</p>\n\n<p>While the form is loaded, at the moment of pressing the button the click event should be executed, which should execute a function that can send a number of return to the console application in C ++ and this application will show the resulting number in the output of the console.</p>\n\n<p>What I need is to solve point 5. shown below, I read a lot of documents but almost all refer to the interoperation between a C++ dll and a C# application and not the reverse (Return an integer value from C# dll to a C++ console application) is what is needed here.</p>\n\n<p>The execution must be dynamic, that is, while the form is displayed, a communication should be established from a function of the C# library and a function of the parent C++ console application.</p>\n\n<p>All the examples that I have been able to find do almost the same, load the libraries, establish the communication and, from the C++ console application they call a function of the C# library and show the resulting return value and the application ends, but no example shows how to load the C# library, show the form, press a button, and send a integer number as a result to the C++ parent console application and show the result in the output of the console.</p>\n\n<p>If you have any idea how to implement the Callback, I would be very grateful.</p>\n\n<p>What I have tried:</p>\n\n<p>What has been achieved is:</p>\n\n<ol>\n<li>Load C++ console application (unmanaged), achieved</li>\n<li>Load a C# library from the C++ console application, achieved</li>\n<li>Import and communicate with some functions exported from the C# library, achieved</li>\n<li>When loading the C# library, from this library a form with an button is shown, achieved</li>\n<li>While the form is displayed, press the button and execute a function in C# that returns an integer to the C++ console application and print the result in the output of the console from the C++ console application, pending</li>\n</ol>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 5, "creation_date": 1542206314, "post_id": 53302655, "comment_id": 93486021, "body": "Your first argument to your constructor is <code>std::initializer_list&lt;int&gt;</code> yet you pass <code>{ {2}, 1 }</code>?"}, {"owner": {"reputation": 7413, "user_id": 304974, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c0bad048f40991e627962d8341092b1d?s=128&d=identicon&r=PG", "display_name": "Programmer", "link": "https://stackoverflow.com/users/304974/programmer"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1542206476, "post_id": 53302655, "comment_id": 93486111, "body": "I tried to change the line - a.ent.emplace_back({2,1,2}, FType::FD_NONE, Fmt::FMT_NONE, RWProp::PROP_RO, FId(0,TTypes::TYPE_NONE)); - but still I get the compilation issue - am I missing something?"}, {"owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 4, "creation_date": 1542206552, "post_id": 53302655, "comment_id": 93486166, "body": "<code>emplace_back</code> is function template which tries to deduce the types of arguments.  an initializer list does not have a type, so deduction fails. Use <code>std::initializer_list&lt;int&gt;{ 2, 1 }</code>."}, {"owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1542206693, "post_id": 53302655, "comment_id": 93486269, "body": "@CoryKramer what is wrong with list-initializing the first int?"}, {"owner": {"reputation": 57966, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "reply_to_user": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 0, "creation_date": 1542207606, "post_id": 53302655, "comment_id": 93486893, "body": "@PiotrSkotnicki yeah, they kind of messed up <code>initializer_list</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9311, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 1, "last_activity_date": 1542212023, "creation_date": 1542212023, "answer_id": 53304485, "question_id": 53302655, "link": "https://stackoverflow.com/questions/53302655/c-how-to-use-emplace-back-for-user-defined-structure/53304485#53304485", "title": "C++ how to use emplace_back for user defined structure", "body": "<p>The <a href=\"https://stackoverflow.com/questions/53302655/c-how-to-use-emplace-back-for-user-defined-structure#comment93486166_53302655\">comment</a> by <a href=\"https://stackoverflow.com/users/3953764/piotr-skotnicki\">@PiotrSkotnicki</a>:</p>\n\n<blockquote>\n  <p><code>emplace_back</code> is function template which tries to deduce the types of arguments. an initializer list does not have a type, so deduction fails.</p>\n</blockquote>\n\n<p>Clarifies the problem.</p>\n\n<p>An alternative way to \"fix\" this issue is to pass an rvalue of the needed type as argument of the constructor, instead of the initializer list:</p>\n\n<pre><code>EntryDef(ID &amp;&amp;id, FType ft, \u2026 ) : mid(std::forward&lt;ID&gt;(id)), ftype(ft), \u2026 {}\n</code></pre>\n\n<p>Called as:</p>\n\n<pre><code>Def a;\na.ent.emplace_back(ID{ 2, 1 }, FType::FD_NONE, \u2026);\n</code></pre>\n\n<p>Live example <a href=\"https://wandbox.org/permlink/nT8Tluv5eoc6pXYY\" rel=\"nofollow noreferrer\">HERE</a>.</p>\n"}], "owner": {"reputation": 7413, "user_id": 304974, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c0bad048f40991e627962d8341092b1d?s=128&d=identicon&r=PG", "display_name": "Programmer", "link": "https://stackoverflow.com/users/304974/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 1, "accepted_answer_id": 53304485, "answer_count": 1, "score": 1, "last_activity_date": 1542242898, "creation_date": 1542206144, "last_edit_date": 1542242898, "question_id": 53302655, "link": "https://stackoverflow.com/questions/53302655/c-how-to-use-emplace-back-for-user-defined-structure", "title": "C++ how to use emplace_back for user defined structure", "body": "<p>I am trying to make use of emplace_back for my user defined structure:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nstruct IDNumber\n{\n    IDNumber(std::vector&lt;int&gt; d) : id(d){}\n    std::vector&lt;int&gt; id;\n};\nstruct Def\n{\n    Def(std::initializer_list&lt;int&gt; id) : mid(id){}\n    IDNumber mid;\n};\n\nstruct Student\n{\n    std::vector&lt;Def&gt; ent;\n};\n\nint main()\n\n{\n Student a;\n a.ent.emplace_back({ {2000} });\n}\n</code></pre>\n\n<p>I get compilation issues:</p>\n\n<pre><code>error: no matching function for call to 'std::vector&lt;EntryDef&gt;::emplace_back'\n</code></pre>\n"}, {"tags": ["c++", "opengl", "textures", "skybox"], "comments": [{"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1542207579, "post_id": 53302550, "comment_id": 93486877, "body": "Have you tried GL_RGBA ?"}, {"owner": {"reputation": 103, "user_id": 10006396, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QnpFQAWbMio/AAAAAAAAAAI/AAAAAAAAAAU/-0DdSKXjCYY/photo.jpg?sz=128", "display_name": "Mohamed Moussa", "link": "https://stackoverflow.com/users/10006396/mohamed-moussa"}, "reply_to_user": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1542207815, "post_id": 53302550, "comment_id": 93487052, "body": "I tried it <code>glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, GL_RGB, images[i].width, images[i].height, 0, GL_RGBA , GL_UNSIGNED_BYTE, images[i].data);</code> the texture became black."}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 1, "creation_date": 1542208563, "post_id": 53302550, "comment_id": 93487546, "body": "Both should be GL_RGBA"}, {"owner": {"reputation": 103, "user_id": 10006396, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QnpFQAWbMio/AAAAAAAAAAI/AAAAAAAAAAU/-0DdSKXjCYY/photo.jpg?sz=128", "display_name": "Mohamed Moussa", "link": "https://stackoverflow.com/users/10006396/mohamed-moussa"}, "reply_to_user": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 1, "creation_date": 1542210265, "post_id": 53302550, "comment_id": 93488585, "body": "It worked, thank you. could you post it as Answer?"}], "answers": [{"tags": [], "owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "is_accepted": true, "score": 1, "last_activity_date": 1542211454, "creation_date": 1542211454, "answer_id": 53304310, "question_id": 53302550, "link": "https://stackoverflow.com/questions/53302550/opengl-render-skybox-cubmap-issue/53304310#53304310", "title": "OpenGL: Render skybox cubmap issue", "body": "<p>It seems that PNG files contain alpha channel, so you should use GL_RGBA in your glTexImage2D call like this: </p>\n\n<pre><code>glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, GL_RGBA, images[i].width, images[i].height, 0, GL_RGBA , GL_UNSIGNED_BYTE, images[i].data);\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 10006396, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QnpFQAWbMio/AAAAAAAAAAI/AAAAAAAAAAU/-0DdSKXjCYY/photo.jpg?sz=128", "display_name": "Mohamed Moussa", "link": "https://stackoverflow.com/users/10006396/mohamed-moussa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 53304310, "answer_count": 1, "score": 0, "last_activity_date": 1542211454, "creation_date": 1542205785, "question_id": 53302550, "link": "https://stackoverflow.com/questions/53302550/opengl-render-skybox-cubmap-issue", "title": "OpenGL: Render skybox cubmap issue", "body": "<p>I am creating a Sky box with a cube map so I used this site to generate the sides of the cube map <a href=\"http://wwwtyro.github.io/space-3d\" rel=\"nofollow noreferrer\">Sky box generator</a>, now I have 6 512 png files, I used the following code to render it:</p>\n\n<pre><code>glGenTextures(1, &amp;cubemapTexture);\nglActiveTexture(GL_TEXTURE0);\nglBindTexture(GL_TEXTURE_CUBE_MAP, cubemapTexture);\nfor (GLuint i = 0; i &lt; images.size(); i++) {\n    glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, GL_RGB, images[i].width, images[i].height, 0, GL_RGB, GL_UNSIGNED_BYTE, images[i].data);\n}\nglTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\nglTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\nglTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\nglTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\nglTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_R, GL_CLAMP_TO_EDGE);\nglBindTexture(GL_TEXTURE_CUBE_MAP, 0);\n</code></pre>\n\n<p>the code was working fine with different images but those images that are downloaded from this site give me the following result</p>\n\n<p><a href=\"https://i.stack.imgur.com/ATksk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ATksk.png\" alt=\"enter image description here\"></a></p>\n\n<p>this is a sample of the image used not working:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sMgst.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sMgst.png\" alt=\"Sample tha is not working\"></a></p>\n\n<p>this is a sample of the worked images:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vS7H9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vS7H9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "algorithm"], "comments": [{"owner": {"reputation": 11761, "user_id": 4964822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oTZqV.jpg?s=128&g=1", "display_name": "nice_dev", "link": "https://stackoverflow.com/users/4964822/nice-dev"}, "edited": false, "score": 0, "creation_date": 1542206151, "post_id": 53302523, "comment_id": 93485921, "body": "<code>To find if a subset of the numbers in the input array can be added up to a give target value</code>- so just recursively make 2 calls, <code>with</code> and <code>without</code> where <code>with</code> subtracts from the target and <code>without</code> pushes target to next element in it&#39;s call as is. Complexity is exponential of course."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542206238, "post_id": 53302523, "comment_id": 93485982, "body": "What do you return in the cases when the recursive functions are called? Or when none of the conditions are true? Not returning anything in a function declared to do so leads to <i>undefined behavior</i>."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542206323, "post_id": 53302523, "comment_id": 93486026, "body": "Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. And edit your question to tell us <i>how</i> &quot;the result is wrong&quot;. What result did you expect? What result did you get? And lastly please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3224, "user_id": 6878708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567e055e3d71ce025d8560333e48dfb9?s=128&d=identicon&r=PG&f=1", "display_name": "nightfury1204", "link": "https://stackoverflow.com/users/6878708/nightfury1204"}, "is_accepted": false, "score": 0, "last_activity_date": 1542209299, "creation_date": 1542209299, "answer_id": 53303588, "question_id": 53302523, "link": "https://stackoverflow.com/questions/53302523/recursive-function-to-find-if-a-subset-of-the-numbers-in-the-input-array-can-be/53303588#53303588", "title": "Recursive function to find if a subset of the numbers in the input array can be added up to a give target value", "body": "<p>You have to update your function <code>findNumTargetSum</code>. Logic was incorrect. Logic should be like: adding current element <code>a[i]</code> to the subset <code>c</code> or not adding current element <code>a[i]</code> to the subset <code>c</code>. Code is given below:</p>\n\n<pre><code>bool findNumTargetSum(int *a, int n, int *c, int &amp;k, int target, int i)\n{\n    // Recursive function to find if a subset of the numbers in the input array\n    // can be added up to a give target value.\n\n    // Required input parameters include \n    //  - input array of integers and the length of the array\n    //  - array for storing the solution, and length of the result array passed by reference\n    //  - other parameters for the control of recursion\n\n    // The input array is sorted in ascending order. This property may help to\n    // improve the computation efficiency to some exend.\n\n    // The function returns ture if a solution is found; otherwise returns false.\n\n    if (i &gt;= n)\n        return false;\n\n    // not taking ar[i] element\n    bool found = findNumTargetSum(a, n, c, k, target, i+1);\n    if(found == true) {\n        return found;\n    }\n\n    // taking ar[i] element\n    c[k] = a[i];\n    int total = 0;\n    for (int j = 0; j &lt; k + 1; j++) {\n        total += c[j];\n    }\n\n    if (total == target) {\n        k++;\n        return true;\n    }\n    if (total &lt; target) {\n        k++;\n        bool found = findNumTargetSum(a, n, c, k, target, i+1);\n        if(found == true)\n          return found;\n        k--; \n    }\n    return false;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10566626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab21720abb89ed2f45ccce52e59dbb0?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/10566626/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542209299, "creation_date": 1542205711, "last_edit_date": 1542207109, "question_id": 53302523, "link": "https://stackoverflow.com/questions/53302523/recursive-function-to-find-if-a-subset-of-the-numbers-in-the-input-array-can-be", "title": "Recursive function to find if a subset of the numbers in the input array can be added up to a give target value", "body": "<p>I am writing a recursive function to find if a subset of the numbers in the input array can be added up to a give target value. However, the result is wrong.</p>\n\n<p><code>*a</code> is the array given<br />\n<code>n</code> is the length of <code>a[]</code><br />\nThe solution is stored in array <code>c[]</code><br />\n<code>k</code> is the number of elements in <code>c[]</code><br />\n<code>target</code> is the target number<br />\n<code>i</code> is an index, which is <code>0</code> when beginning</p>\n\n<pre><code>bool findNumTargetSum(int *a, int n, int *c, int &amp;k, int target, int i)\n\n{\n    // Recursive function to find if a subset of the numbers in the input array\n    // can be added up to a give target value.\n\n    // Required input parameters include \n    //  - input array of integers and the length of the array\n    //  - array for storing the solution, and length of the result array passed by reference\n    //  - other parameters for the control of recursion\n\n    // The input array is sorted in ascending order. This property may help to\n    // improve the computation efficiency to some exend.\n\n    // The function returns ture if a solution is found; otherwise returns false.\n\n    c[k] = a[i];\n\n    int total = 0;\n    for (int j = 0; j &lt; k + 1; j++) {\n        total += c[j];\n    }\n\n    if (i &gt;= n)\n        return false;\n\n    if (total == target) {\n        k += 1;\n        return true;\n    }\n\n    else if (total &lt; target) {\n        i += 1;\n        k += 1;\n        findNumTargetSum(a, n, c, k, target, i);\n    }\n\n    else if (total &gt; target) {\n\n        k -= 1;\n\n        if (k &lt; 0)\n            return false;\n        findNumTargetSum(a, n, c, k, target, i);\n\n    }\n}\n\nvoid part_2()\n{\n    // Test data: the array is sorted in ascending order.\n    int a[] = { 8, 12, 20, 35, 36, 41, 55, 64, 72, 81 };\n    int n = 10;\n\n    int c[10];  // array for storing the solution\n    int k = 0;  // k = number of elements in c[]\n\n    cout &lt;&lt; \"\\n-----------------------------------------------------------\\n\";\n    cout &lt;&lt; \"Part-2: recursion and backtracking\\n\";\n\n    cout &lt;&lt; \"Numbers in input list:\\n\";\n    printArray(a, n);\n\n    int total = sum(a, n);\n    cout &lt;&lt; \"sum of the numbers in input list = \" &lt;&lt; total &lt;&lt; endl &lt;&lt; endl;\n\n    bool success = false;\n\n    for (int i = 1; i &lt; 7; i++)  // try 6 test cases\n    {\n        int target = total * i / 7 + 2;\n        k = 0;\n\n        success = findNumTargetSum(a, n, c, k, target, 0);\n\n        if (success)\n        {\n            cout &lt;&lt; \"Numbers in input list that add up to \" &lt;&lt; target &lt;&lt; \" :\\n\";\n            printArray(c, k);\n        }\n        else\n            cout &lt;&lt; \"DO NOT find subset of numbers in input list that add up to \" &lt;&lt; target &lt;&lt; endl &lt;&lt; endl;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c++11", "recursion", "variadic-templates", "template-meta-programming"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1542205715, "post_id": 53302451, "comment_id": 93485628, "body": "And why not just hold a <code>std::tuple</code> and use the many standard library utilities to make ones life easier?"}, {"owner": {"reputation": 3275, "user_id": 6204612, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wDnGs.png?s=128&g=1", "display_name": "Adam Kotwasinski", "link": "https://stackoverflow.com/users/6204612/adam-kotwasinski"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542206050, "post_id": 53302451, "comment_id": 93485846, "body": "The builder is unfortunately only a simplification, in real scenario it&#39;s a composite buffer composed of multiple sub-buffers that return the value (the field <code>tail</code> does not exist)."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1542206118, "post_id": 53302451, "comment_id": 93485891, "body": "The solution utilizes the <code>tail</code> field. So if the example is not indicative, and the solution is not applicable, what was accomplished here?"}], "answers": [{"tags": [], "owner": {"reputation": 3275, "user_id": 6204612, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wDnGs.png?s=128&g=1", "display_name": "Adam Kotwasinski", "link": "https://stackoverflow.com/users/6204612/adam-kotwasinski"}, "is_accepted": false, "score": 1, "last_activity_date": 1542249041, "last_edit_date": 1542249041, "creation_date": 1542205502, "answer_id": 53302452, "question_id": 53302451, "link": "https://stackoverflow.com/questions/53302451/using-fields-stored-in-variadic-data-structure-as-method-arguments/53302452#53302452", "title": "Using fields stored in variadic data structure as method arguments", "body": "<p>One of the solutions I found is to pass intermediary <code>tuple&lt;...&gt;</code> that contains the fields and then unpack it using the mechanism described in <a href=\"https://stackoverflow.com/questions/7858817/unpacking-a-tuple-to-call-a-matching-function-pointer\">&quot;unpacking&quot; a tuple to call a matching function pointer</a> :</p>\n\n<pre><code>// unpacking helpers\ntemplate&lt;int ...&gt; struct seq {};\n\ntemplate&lt;int N, int ...S&gt;\nstruct gens : gens&lt;N-1, N-1, S...&gt; {};\n\ntemplate&lt;int ...S&gt;\nstruct gens&lt;0, S...&gt; {\n    typedef seq&lt;S...&gt; type;\n};\n\n// Builder with 0 fields returns an empty tuple\ntemplate &lt;class... Ts&gt; class Builder {\npublic:\n    tuple&lt;&gt; compute_tuple() {\n        return {};\n    }\n};\n\ntemplate &lt;class T, class... Ts&gt;\nclass Builder&lt;T, Ts...&gt; : public Builder&lt;Ts...&gt; {\npublic:\n    Builder(T t, Ts... ts) : Builder&lt;Ts...&gt;(ts...), tail(t) {}\n\n    Result build() {\n        // get argument tuple\n        auto arguments = compute_tuple();\n        // use argument tuple as Result's argument\n        return build_recursively(typename gens&lt;1 + sizeof... (Ts)&gt;::type{}, arguments);\n    }\n\nprotected:\n    // computing tuple - just join current element with superclass' result\n    tuple&lt;T, Ts...&gt; compute_tuple() {\n        const tuple&lt;T&gt; head{field};\n        const tuple&lt;Ts...&gt; tail = Builder&lt;Ts...&gt;::compute_tuple();\n        return tuple_cat(head, tail);\n    }\n\nprivate:\n    template&lt;int ...S&gt;\n    Result build_recursively(seq&lt;S...&gt;, tuple&lt;T, Ts...&gt; data) {\n        // invoked matching Result's constructor\n        return { std::get&lt;S&gt;(data) ... };\n    }\n\n    const T field;\n};\n</code></pre>\n\n<p>Then it behaves properly:</p>\n\n<pre><code>Builder&lt;string, string&gt; b1{\"a\", \"b\"};\nb1.build(); // invokes Result(string, string)\n</code></pre>\n\n<p>Still, maybe it's possible to do something simpler without that <code>tuple</code> intermediary?</p>\n"}, {"comments": [{"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1542206833, "post_id": 53302641, "comment_id": 93486362, "body": "Should not the ts... be captured? Then all these values are going to be stored on the heap, that is really expensive for such a small functionality."}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1542208210, "post_id": 53302641, "comment_id": 93487337, "body": "@Oliv - sure: <code>Builder (Ts &amp; ... ts) : fn{ []{ return Result{ts...}; }</code>; but it&#39;s dangerous; if one construct <code>Builder</code> with a value that is destroyed before the <code>build()</code> calling, the corresponding saved reference is a dangling reference. Maybe it&#39;s possible to do something with perfect forwarding, but you have to templatize the constructor."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 1, "creation_date": 1542223865, "post_id": 53302641, "comment_id": 93495661, "body": "Your code is ill formed you must capture! And in order not to have UB parameters have to be captured by value. <code>[=]</code>"}, {"owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "reply_to_user": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1542226172, "post_id": 53302641, "comment_id": 93496693, "body": "@Oliv - so, it seems to me, is better to receive arguments as Ts const &amp; ...; maybe, this way, some copy are avoided (but I suspect that the compilers optimize this aspect)."}], "tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": false, "score": 1, "last_activity_date": 1542234309, "last_edit_date": 1542234309, "creation_date": 1542206087, "answer_id": 53302641, "question_id": 53302451, "link": "https://stackoverflow.com/questions/53302451/using-fields-stored-in-variadic-data-structure-as-method-arguments/53302641#53302641", "title": "Using fields stored in variadic data structure as method arguments", "body": "<p>I suppose you can use a lambda (and save it in a <code>std::function</code>) to stock values.</p>\n\n<p>Something as (caution: code not tested) (thanks to Oliv for a correction)</p>\n\n<pre><code>template &lt;typename ... Ts&gt;\nclass Builder\n {\n   private:\n      std::function&lt;Result()&gt;  fn;\n\n   public:\n      Builder (Ts const &amp; ... ts) : fn{ [=]{ return Result{ts...}; }\n       { }\n\n      Result build ()\n       { return fn(); }\n };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "is_accepted": true, "score": 2, "last_activity_date": 1542206332, "creation_date": 1542206332, "answer_id": 53302711, "question_id": 53302451, "link": "https://stackoverflow.com/questions/53302451/using-fields-stored-in-variadic-data-structure-as-method-arguments/53302711#53302711", "title": "Using fields stored in variadic data structure as method arguments", "body": "<p>If you don't want to use tuple as a member to hold the values, you could do it this way:</p>\n\n<pre><code>template &lt;class... Ts&gt; class Builder {\n  protected:\n  template&lt;class...Us&gt;\n  Result do_build(const Us&amp;...us){\n    return Result(us...);\n    }\n  };\n\ntemplate &lt;class T, class... Ts&gt;\nclass Builder&lt;T, Ts...&gt; : public Builder&lt;Ts...&gt; {\npublic:\n    Builder(T t, Ts... ts) : Builder&lt;Ts...&gt;(ts...), tail(t) {}\n\n    Result build() {\n      return do_build();\n    }\nprotected:\n  template&lt;class...Us&gt;\n  Result do_build(const Us&amp;...us){\n    return Builder&lt;Ts...&gt;::do_build(us...,tail);\n    }\nprivate:\n    const T tail;\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 1, "last_activity_date": 1542206946, "creation_date": 1542206946, "answer_id": 53302910, "question_id": 53302451, "link": "https://stackoverflow.com/questions/53302451/using-fields-stored-in-variadic-data-structure-as-method-arguments/53302910#53302910", "title": "Using fields stored in variadic data structure as method arguments", "body": "<pre><code>template &lt;class... Ts&gt;struct Builder {\n  auto as_tie() const { return std::tie(); }\n};\n\ntemplate &lt;class T, class... Ts&gt;\nstruct Builder&lt;T, Ts...&gt; : Builder&lt;Ts...&gt; {\n  using base = Builder&lt;Ts...&gt;;\n  auto as_tie()const{\n    return std::tuple_cat( base::as_tie(), std::tie( tail ) );\n  }\n</code></pre>\n\n<p>now <code>Builder::as_tie()</code> can be passed to <code>std::apply</code> (or backported version) or <code>make_from_tuple</code>.</p>\n\n<p>Naturally the <code>operator T</code> trick can be used for return type deduction.  But I'd usually advise against it.</p>\n"}, {"tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 1, "last_activity_date": 1542208836, "last_edit_date": 1542208836, "creation_date": 1542207685, "answer_id": 53303130, "question_id": 53302451, "link": "https://stackoverflow.com/questions/53302451/using-fields-stored-in-variadic-data-structure-as-method-arguments/53303130#53303130", "title": "Using fields stored in variadic data structure as method arguments", "body": "<p>You can use an <code>Idx&lt;n&gt;</code> tag to get <code>tail</code> from <code>n</code>-th <code>Builder</code>:</p>\n\n<pre><code>template&lt;std::size_t i&gt; struct Idx {};\n\ntemplate&lt;class... Ts&gt;\nclass Builder {\npublic:\n    void get_tail();\n};\n\ntemplate &lt;class T, class... Ts&gt;\nclass Builder&lt;T, Ts...&gt; : public Builder&lt;Ts...&gt; {\nprivate:\n    static constexpr auto index = sizeof...(Ts);\n\npublic:\n    Builder(T t, Ts... ts) : Builder&lt;Ts...&gt;(ts...), tail(t) {\n    }\n\n    Result build() {\n        return build_impl(std::make_index_sequence&lt;index + 1&gt;{});\n    }\n\nprotected:\n    using Builder&lt;Ts...&gt;::get_tail;\n\n    const T&amp; get_tail(Idx&lt;index&gt;) {\n        return tail;\n    }\n\nprivate:\n    template&lt;std::size_t... is&gt;\n    Result build_impl(std::index_sequence&lt;is...&gt;) {\n        return Result{get_tail(Idx&lt;index - is&gt;{})...};\n    }\n\nprivate:\n    const T tail;\n};\n</code></pre>\n"}], "owner": {"reputation": 3275, "user_id": 6204612, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wDnGs.png?s=128&g=1", "display_name": "Adam Kotwasinski", "link": "https://stackoverflow.com/users/6204612/adam-kotwasinski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 53302711, "answer_count": 5, "score": 4, "last_activity_date": 1542249041, "creation_date": 1542205502, "last_edit_date": 1542206288, "question_id": 53302451, "link": "https://stackoverflow.com/questions/53302451/using-fields-stored-in-variadic-data-structure-as-method-arguments", "title": "Using fields stored in variadic data structure as method arguments", "body": "<p>I have a variadic data structure, each \"layer\" containing one field.</p>\n\n<p>How can use all the fields stored in the structure as arguments to a function or a constructor?</p>\n\n<pre><code>template &lt;class... Ts&gt; class Builder {};\n\ntemplate &lt;class T, class... Ts&gt;\nclass Builder&lt;T, Ts...&gt; : public Builder&lt;Ts...&gt; {\npublic:\n    Builder(T t, Ts... ts) : Builder&lt;Ts...&gt;(ts...), tail(t) {}\n\n    Result build() {\n      // want to use tail, Builder&lt;Ts...&gt;::tail, etc.\n      // as ctor or function arguments without multiple specializations\n    }\n\nprivate:\n    const T tail;\n};\n</code></pre>\n\n<p>In general, I want to be capable of doing something like this:</p>\n\n<pre><code>Builder&lt;int, string, int&gt; b1{10, \"aaa\", 20};\nResult r1 = b1.build(); // should invoke Result's constructor (int, string, int)\n\nBuilder&lt;int&gt; b2{10};\nResult r2 = b2.build(); // should invoke Result's constructor (int)\n</code></pre>\n"}, {"tags": ["c++", "command", "embedded", "tcl"], "comments": [{"owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 1, "creation_date": 1542210275, "post_id": 53302415, "comment_id": 93488591, "body": "I don&#39;t know where this is documented, but the user only needs to provide the minimum prefix of the command so that it is unambiguous: <code>a</code> is sufficient to differentiate &quot;applepie&quot; from the other commands. Similarly, <code>b</code>, <code>carp</code> and <code>card</code> are unambiguous command prefixes."}, {"owner": {"reputation": 39, "user_id": 6657299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d87b37e40bb0083371fe132dd3de0d?s=128&d=identicon&r=PG", "display_name": "Adrian Micha\u0142ek", "link": "https://stackoverflow.com/users/6657299/adrian-micha%c5%82ek"}, "reply_to_user": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "edited": false, "score": 0, "creation_date": 1542211220, "post_id": 53302415, "comment_id": 93489230, "body": "Now I wonder if there is a way of turning it off. So I guess I have to add special character after the command like &quot;apple#&quot; then if an error is returned find this character and remove it. But maybe such a function exists in tcl or flag to set?"}], "answers": [{"comments": [{"owner": {"reputation": 2408, "user_id": 3207222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1338b351d1bac0e771a0c90016d3482d?s=128&d=identicon&r=PG&f=1", "display_name": "mrcalvin", "link": "https://stackoverflow.com/users/3207222/mrcalvin"}, "edited": false, "score": 0, "creation_date": 1542218353, "post_id": 53304647, "comment_id": 93493139, "body": "For a try: Put <code>Tcl_SetVar(interp, &quot;tcl_interactive&quot;, &quot;0&quot;, TCL_GLOBAL_ONLY);</code> anywhere before <code>Tcl_EvalObjv</code> is called."}, {"owner": {"reputation": 39, "user_id": 6657299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d87b37e40bb0083371fe132dd3de0d?s=128&d=identicon&r=PG", "display_name": "Adrian Micha\u0142ek", "link": "https://stackoverflow.com/users/6657299/adrian-micha%c5%82ek"}, "edited": false, "score": 0, "creation_date": 1542221579, "post_id": 53304647, "comment_id": 93494612, "body": "Thanks, it will be checked tomorrow ;)"}], "tags": [], "owner": {"reputation": 2408, "user_id": 3207222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1338b351d1bac0e771a0c90016d3482d?s=128&d=identicon&r=PG&f=1", "display_name": "mrcalvin", "link": "https://stackoverflow.com/users/3207222/mrcalvin"}, "is_accepted": true, "score": 2, "last_activity_date": 1542218520, "last_edit_date": 1542218520, "creation_date": 1542212590, "answer_id": 53304647, "question_id": 53302415, "link": "https://stackoverflow.com/questions/53302415/embedded-tcl-does-tcl-autocomplete-commands/53304647#53304647", "title": "Embedded Tcl: Does Tcl autocomplete commands?", "body": "<p>As glenn hinted at, Tcl in <a href=\"https://wiki.tcl-lang.org/page/tcl%5Finteractive\" rel=\"nofollow noreferrer\">interactive (REPL) mode</a> allows for dispatching commands using some minimal but unambiguous name prefix. I cannot tell how your embedded Tcl is configured, initialised, and ended up being run as in interactive mode. However, you may want to try to \"turn off\" (toggle) the interactive mode, by either:</p>\n\n<pre><code>unset ::tcl_interactive\n</code></pre>\n\n<p>or</p>\n\n<pre><code>set ::tcl_interactive 0\n</code></pre>\n\n<p>All of this is implemented by the default <code>unknown</code> handler. Watch out for how the list of <code>cmds</code> is looked up and how it is treated differently when <code>tcl_interactive</code> is true or false:</p>\n\n<pre><code>puts [info body unknown]\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6657299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d87b37e40bb0083371fe132dd3de0d?s=128&d=identicon&r=PG", "display_name": "Adrian Micha\u0142ek", "link": "https://stackoverflow.com/users/6657299/adrian-micha%c5%82ek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 53304647, "answer_count": 1, "score": 1, "last_activity_date": 1542257056, "creation_date": 1542205406, "last_edit_date": 1542257056, "question_id": 53302415, "link": "https://stackoverflow.com/questions/53302415/embedded-tcl-does-tcl-autocomplete-commands", "title": "Embedded Tcl: Does Tcl autocomplete commands?", "body": "<p>We have a Tcl <strong>built in</strong> our C/C++ application, I found the place in our code where <strong>Tcl_EvalObjv</strong> is called if the command was not found. I have to admit that the code is pretty old and not many of our developers know what happens in this module.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>// ... there is some checking if command is registered etc., it fails and the code goes here:\nstd::vector&lt;Tcl_Obj*&gt; tclArgs = { NULL };\nfor (int i = 1; i &lt; objc; ++i)\n    tclArgs.push_back(objv[i]);\ntclArgs.shrink_to_fit();\n// ...\ntclArgs[0] = ::Tcl_NewStringObj(ORIGINAL_UNKNOWN, ORIGINAL_UNKNOWN_SIZE);\nTcl_IncrRefCount(tclArgs[0]);\n::Tcl_ExposeCommand(pInterp, ORIGINAL_UNKNOWN, ORIGINAL_UNKNOWN);\nresult = ::Tcl_EvalObjv(pInterp, objc, &amp;tclArgs[0], TCL_EVAL_GLOBAL); //&lt;--\n::Tcl_HideCommand(pInterp, ORIGINAL_UNKNOWN, ORIGINAL_UNKNOWN);\n// ORIGINAL_UNKNOWN is char* it is just \"unknown\"\n</code></pre>\n\n<p>We have handlers for commands in our application, while executing <strong>Tcl_EvalObjv</strong> in <strong>CmdUnknown()</strong> function <strong>Tcl</strong> sometimes calls different commands. Examples below:</p>\n\n<p>List of existing commands: \"banana\", \"applepie\", \"carpet\", \"card\"</p>\n\n<p><strong>Command: \"apple\", Tcl calls \"applepie\" (wrong, \"apple\" is not \"applepie\")<br></strong> \nCommand: \"blah\", Tcl gives error (correctly).<br>\nCommand: \"car\", Tcl gives error (correctly, maybe because of 2 similar commands).<br><br>\nIs there are some kind of mechanism that <strong>Tcl</strong> does when it fails in searching for command? The thing is that I can't find anything that is related to our code that would complete the commands so maybe <strong>Tcl</strong> does?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 5, "creation_date": 1542204759, "post_id": 53302129, "comment_id": 93485010, "body": "&quot;When should I put {} on if&#39;s, while&#39;s etc.?&quot; - always."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542204821, "post_id": 53302129, "comment_id": 93485061, "body": "1) What book are you using to learn C++ from, alongside the lectures? If you aren&#39;t using any, consider picking one from <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">this list</a>. 2) What, exactly, you find unclear about the explanations given to you? What were those explanations? If you don&#39;t give such information to us, we might just repeat what your lecturer already said, which would help no-one."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1542205092, "post_id": 53302129, "comment_id": 93485221, "body": "The first commented expression is called the  &#39;conditional operator&#39;.  &quot;Expression1 ? Expression2 : Expression3&quot;"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1542205201, "post_id": 53302129, "comment_id": 93485285, "body": "tbh i think the best you can do is ask your prof or co-students. Working together with others and direct tutoring is extremely important and valuable and cannot be replaced by online Q&amp;As"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542205244, "post_id": 53302129, "comment_id": 93485315, "body": "The correct person to ask is your teacher. If they don&#39;t realise they are assuming students know certain language constructs, they won&#39;t adjust their approach to teaching the course."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542205378, "post_id": 53302129, "comment_id": 93485404, "body": "...moreover we cannot know what was your teachers intention when presenting you this code. If they didnt get the message across you should let them know. However, all that is of course not a reason to not ask questions here ;)"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542205439, "post_id": 53302129, "comment_id": 93485445, "body": "Beware that this code shows a lot of bad habits. My impression is that your teacher may be bad at what they teach..."}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542206199, "post_id": 53302129, "comment_id": 93485959, "body": "@Fran&#231;oisAndrieux For that matter, it&#39;s a terrible implementation of the Euclidean algorithm."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542206275, "post_id": 53302129, "comment_id": 93486000, "body": "@Fran&#231;oisAndrieux i would say it depends. eg. if the lesson was about using the ternary then the code has something, if the lesson was about using standard functions when applicable then the code is a fail ;)"}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "reply_to_user": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 0, "creation_date": 1542218400, "post_id": 53302129, "comment_id": 93493156, "body": "@Damien It is equivalent to the Euclidean algorithm; it just uses repeated subtraction in place of division. Division <i>is</i> repeated subtraction."}], "answers": [{"comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 2, "creation_date": 1542205029, "post_id": 53302263, "comment_id": 93485192, "body": "&quot;<i>is either one statement or a block of statements in <code>{...}</code></i>&quot; Technically speaking, it is always a single statement. It&#39;s just <code>{...}</code> is a compound statement."}], "tags": [], "owner": {"reputation": 14893, "user_id": 4645334, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-hoIJVId9WIY/AAAAAAAAAAI/AAAAAAAAGQw/r7Es0WqE4rs/photo.jpg?sz=128", "display_name": "Thomas Sablik", "link": "https://stackoverflow.com/users/4645334/thomas-sablik"}, "is_accepted": true, "score": 1, "last_activity_date": 1542211367, "last_edit_date": 1542211367, "creation_date": 1542204917, "answer_id": 53302263, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college/53302263#53302263", "title": "Explanation of this C++ code I learned in college", "body": "<p>This is the syntax for an <code>if-statement</code></p>\n\n<pre><code>if ( condition ) statement-true else statement-false\n</code></pre>\n\n<p><code>statement-true</code> is either one statement or a block of statements in <code>{...}</code></p>\n\n<p>So you can use <code>if</code> without <code>{...}</code> if there is only one line. But it is better to always use <code>{...}</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 1, "last_activity_date": 1542204921, "creation_date": 1542204921, "answer_id": 53302264, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college/53302264#53302264", "title": "Explanation of this C++ code I learned in college", "body": "<p>It is necessary when you need more that one line/statement to be executed by the if/else/while. Valid examples:</p>\n\n<pre><code>if (a != 0 || b != 0)\n    cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n\nif (a != 0 || b != 0) cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n\nif (a != 0 || b != 0) {\n    cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n    a++; }\n</code></pre>\n\n<p>If you did:</p>\n\n<pre><code>if (a != 0 || b != 0) \n    cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n    a++; \n</code></pre>\n\n<p>The the <code>a++;</code> would be executed regardless of the <code>if</code> condition.</p>\n\n<p>Some programmers like to use <code>{}</code> even for single statements because they believe it leads to more usable and maintainable code. I do not belong to that group but I can see the arguments on either side.</p>\n"}, {"tags": [], "owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "is_accepted": false, "score": 1, "last_activity_date": 1542205038, "creation_date": 1542205038, "answer_id": 53302304, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college/53302304#53302304", "title": "Explanation of this C++ code I learned in college", "body": "<pre><code>size_t min = abs(a) &lt; abs(b) ? abs(a) : abs(b); //What's that after (?)?\n</code></pre>\n\n<p>C and C++ have a construct that is similar to an <code>if</code>-<code>else</code> statement. This line basically says that if <code>abs(a)</code> is smaller than <code>abs(b)</code>, then <code>min</code> should take the value of <code>abs(a)</code>; otherwise, it should take the value of <code>abs(b)</code>.</p>\n\n<pre><code>size_t diff = max - min; //What is that variable used for?\n</code></pre>\n\n<p>It's not clear what you mean here. If you mean <code>diff</code>, the code essentially uses it in the subsequent <code>while</code> loop to perform division by repeated subtraction. This is a very strange thing to do, especially because it is so inefficient, and division would have been more  compact and efficient in the loop. It's even stranger given that earlier the author uses <code>?:</code> (which you asked about); that construction is used mainly because it's more compact and efficient than an <code>if</code>-<code>else</code> statement, but this is rather strange code, anyway.</p>\n\n<blockquote>\n  <p>When should I put {} on if's, while's etc.?</p>\n</blockquote>\n\n<p>You should do it by default. You don't <em>have</em> to do it if only one statement is to be performed when the condition is true (resp. false) but people usually do as a matter of good style and to assist readability. For instance, this code</p>\n\n<pre><code>if (a != 0 || b != 0)\n    cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\nelse\n    cout &lt;&lt; \"not possible!!!\\n\";\n</code></pre>\n\n<p>could just as easily be</p>\n\n<pre><code>if (a != 0 || b != 0) {\n    cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n} else {\n    cout &lt;&lt; \"not possible!!!\\n\";\n}\n</code></pre>\n\n<p>...and a lot of instructors would actually <em>require</em> the latter from learners.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1542205168, "creation_date": 1542205168, "answer_id": 53302351, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college/53302351#53302351", "title": "Explanation of this C++ code I learned in college", "body": "<p>In addition to the other answers:</p>\n\n<blockquote>\n<pre><code>//What's that after (?)?\n</code></pre>\n</blockquote>\n\n<pre><code>foo ? bar : qux;\n</code></pre>\n\n<p>Is the use of the ternary operator.</p>\n\n<p>If <code>foo</code> is true the expression evaluates to <code>bar</code> else it evaluates to <code>qux</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 0, "last_activity_date": 1542206023, "creation_date": 1542206023, "answer_id": 53302623, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college/53302623#53302623", "title": "Explanation of this C++ code I learned in college", "body": "<p>Just adding my two cents...</p>\n\n<p>This </p>\n\n<pre><code>if (a != 0 || b != 0)\n        cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code>if (a != 0 || b != 0) {\n        cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>The big difference comes when you realize that code is not something static that you write once and then never change again. Lets change the example a little bit (intentially weird intendation)</p>\n\n<pre><code>if ( x )           // (I)\n    y = a;\n    z = b;\n</code></pre>\n\n<p>is <strong>not</strong> the same as</p>\n\n<pre><code>if ( x ) {         // (II)\n    y = a;\n    z = b;\n}\n</code></pre>\n\n<p>Using brackets allows you to focus on only the part you care about. Consider that you later decide to swap the two lines, then </p>\n\n<pre><code>if ( x ) {\n    z = b;\n    y = a;\n}\n</code></pre>\n\n<p>is still ok (its the same as (II), apart from swapping the two instructions), while </p>\n\n<pre><code>if ( x )\n    z = b;\n    y = a;\n</code></pre>\n\n<p>is doing something completely different as the version above (I). If you use the brackets you dont need to care whether those two lines are inside a if block. To decide if you can swap them you need to look at nothing more than those two lines. This is not the case if you do not use the brackets. This may seem like a minor thing, though I have seen countless bugs caused by not putting brackets where there could be some.</p>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "is_accepted": false, "score": 0, "last_activity_date": 1546458759, "last_edit_date": 1546458759, "creation_date": 1542216204, "answer_id": 53305657, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college/53305657#53305657", "title": "Explanation of this C++ code I learned in college", "body": "<p><strong><em>For 1 line of code following <code>if</code>, <code>else</code>, <code>else if</code>, <code>while</code>, etc</em></strong></p>\n\n<pre><code>if (&lt;some condition&gt;)\n    //1 line of code`\n</code></pre>\n\n<p>and</p>\n\n<pre><code>if (&lt;some condition&gt;)\n{\n   //1 line of code\n}\n</code></pre>\n\n<p>...are equivalent and it is up to you (personal style,developer choice,readability etc.) to make that decision.</p>\n\n<p><strong><em>For > 1 line of code following <code>if, else, else if, while, etc</code></em></strong>\n<code>{}</code> is required if you want code completely scoped to the condition statement. It is up to you the developer to make sure to scope these lines of code (i.e. the compiler will not warn you about this.. it will not know if the intent was 1 line or multiple lines). </p>\n\n<p>So an example</p>\n\n<pre><code>if(&lt;some condition&gt;)\n{\n    //line of code 1\n    //line of code 2\n}\n</code></pre>\n\n<p>the compiler will let you do this...</p>\n\n<pre><code>if(&lt;some condition&gt;)\n    // line of code 1\n    // line of code 2\n</code></pre>\n\n<p>but <code>//line of code 2</code> has no relation to the <code>if</code> condition since it was not scoped with <code>{}</code> and will be executed regardless of the <code>if</code> statement condition.</p>\n"}], "owner": {"reputation": 67, "user_id": 10652362, "user_type": "registered", "profile_image": "https://graph.facebook.com/2406259852749794/picture?type=large", "display_name": "Boyan Petrov", "link": "https://stackoverflow.com/users/10652362/boyan-petrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 53302263, "answer_count": 6, "score": -1, "last_activity_date": 1546458759, "creation_date": 1542204508, "question_id": 53302129, "link": "https://stackoverflow.com/questions/53302129/explanation-of-this-c-code-i-learned-in-college", "title": "Explanation of this C++ code I learned in college", "body": "<p>I'm a newbie here and I just started college. We are learning <strong>C++</strong> and I find it a little bit difficult, because of the way the teachers explain. \nYesterday we did a task that says to create a program, which finds <strong>greatest common divisor</strong> <strong>of 2 numbers</strong>. So, the teacher started writing the code, but the explanation wasn't enough for me and I really need some help right now.\n(I putted comments on the things I don't understand.)\nHere is the code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n\nusing namespace std;\n\nint main(){\n\n    int a, b;\n    cout &lt;&lt; \"a = \";\n    cin &gt;&gt; a;\n    cout &lt;&lt; \"b = \";\n    cin &gt;&gt; b;\n    cout &lt;&lt; \"GCD (\" &lt;&lt; a &lt;&lt; \", \" &lt;&lt; b &lt;&lt; \") is \";\n\n    if (a != 0 &amp;&amp; b != 0){\n        size_t min = abs(a) &lt; abs(b) ? abs(a) : abs(b); //What's that after (?)?\n        size_t max = abs(a) &gt; abs(b) ? abs(a) : abs(b);\n        size_t diff = max - min; //What is that variable used for?\n\n        while (diff &gt; 0)\n        {\n            min = diff &lt; min ? diff : min;\n            max = diff &gt; min ? diff : min;\n            diff = max - min;\n        }\n        cout &lt;&lt; min &lt;&lt; endl;\n    }\n    else{\n        if (a != 0 || b != 0)\n            cout &lt;&lt; (a&gt;b ? a : b) &lt;&lt; endl;\n        else\n            cout &lt;&lt; \"not possible!!!\\n\";\n    }\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p><em>QUESTION:</em> When should I put {} on if's, while's etc.?</p>\n"}, {"tags": ["python", "c++", "numpy", "memory-management"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12150124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60cc837c4bc86f81e00893cf85cb9b84?s=128&d=identicon&r=PG&f=1", "display_name": "isienmai", "link": "https://stackoverflow.com/users/12150124/isienmai"}, "is_accepted": false, "score": 0, "last_activity_date": 1569955948, "last_edit_date": 1569955948, "creation_date": 1569954643, "answer_id": 58190430, "question_id": 53302105, "link": "https://stackoverflow.com/questions/53302105/exception-thrown-read-access-violation-bp-was-0xffffffffffffffff/58190430#58190430", "title": "Exception thrown: read access violation. **bp** was 0xFFFFFFFFFFFFFFFF", "body": "<p>I've encountered the same error message and just managed to fix it almost by accident.</p>\n\n<p>Summary:\nIt seems to be caused by a PyObject* having an incorrect ref count.\nThe PyObjects in use at the time of the error are not necessarily the objects with incorrect ref counts!\nReading <a href=\"https://docs.python.org/3/c-api/intro.html#objects-types-and-reference-counts\" rel=\"nofollow noreferrer\">https://docs.python.org/3/c-api/intro.html#objects-types-and-reference-counts</a> may help if you haven't already.</p>\n\n<p>In my case, my C++ was reading items from a PyObject list obtained from a python function. However, when reading these items from the list their refcount wasn't being incremented because I was calling <code>PyList_GetItem()</code> instead of <code>PySequence_GetItem()</code>. This was a right pain to debug because the error was being thrown from a completely unrelated section of code running <code>PyObject_CallFunction()</code>.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 61, "user_id": 9965058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ecba3c83bec2232e48666b601c1d734?s=128&d=identicon&r=PG&f=1", "display_name": "BIT_Bang", "link": "https://stackoverflow.com/users/9965058/bit-bang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1569955948, "creation_date": 1542204429, "last_edit_date": 1542210262, "question_id": 53302105, "link": "https://stackoverflow.com/questions/53302105/exception-thrown-read-access-violation-bp-was-0xffffffffffffffff", "title": "Exception thrown: read access violation. **bp** was 0xFFFFFFFFFFFFFFFF", "body": "<p>I cmake a project and want to get numpy array in C++ project. I can get the right nums but it reports read access violation. Here is my python code named main.py</p>\n\n<pre><code>import numpy as np\nimport tensorflow as tf\n\nclass PyInterface(object):\n    def __init__(self):\n        self.X = None\n        self.Y = None\n\n    def generate_np_uint8(self):\n        np_array = np.random.randint(low=0, high=255, size=(2,2,2),dtype=np.uint8);\n        print(\"Python, uint8:\", np_array)\n        return np_array\n\n    def generate_np_float32(self):\n        np_array = np.random.rand(2,2,2).astype(np.float32)\n        print(\"Python, float:\", np_array)\n        return np_array\n\n\nif __name__ == '__main__':\n    py = PyInterface();\n    py.generate_np_uint8();\n    py.generate_np_float32();\n</code></pre>\n\n<p>Here is my C++ code for extend python</p>\n\n<pre><code>public:\nfloat * CppPythonHandler::get_float() {\n    return generate_np_float32();\n}\nprivate:\nfloat * CppPythonHandler::generate_np_float32() {\n    const int ND{3};\n    float *c_out = new float[8];\n    PyArrayObject *np_ret;\n    PyObject* np_array = PyObject_CallMethod(interface, (const char*)\"generate_np_float32\", NULL, NULL);\n    if (np_array) {\n        np_ret = reinterpret_cast&lt;PyArrayObject*&gt;(np_array);\n        if (PyArray_NDIM(np_ret) != ND) {\n            std::cout &lt;&lt; \"Function returned with wrong dimension\" &lt;&lt; std::endl;\n            Py_DECREF(np_array);\n            Py_DECREF(np_ret);\n            return c_out;\n        }\n        c_out[0] = *((float *)PyArray_GETPTR3(np_ret, 0, 0, 0));\n        c_out[1] = *((float *)PyArray_GETPTR3(np_ret, 0, 0, 1));\n        c_out[2] = *((float *)PyArray_GETPTR3(np_ret, 0, 1, 0));\n        c_out[3] = *((float *)PyArray_GETPTR3(np_ret, 0, 1, 1));\n        c_out[4] = *((float *)PyArray_GETPTR3(np_ret, 1, 0, 0));\n        c_out[5] = *((float *)PyArray_GETPTR3(np_ret, 1, 0, 1));\n        c_out[6] = *((float *)PyArray_GETPTR3(np_ret, 1, 1, 0));\n        c_out[7] = *((float *)PyArray_GETPTR3(np_ret, 1, 1, 1));\n        for (int i = 0; i &lt; 8; ++i) {\n            std::cout &lt;&lt; c_out[i] &lt;&lt; \" \";\n        }\n        std::cout &lt;&lt; std::endl;\n        Py_DECREF(np_ret);\n        Py_DECREF(np_array);\n        return c_out;\n    }\n    else{\n        PyErr_Print();\n        Py_DECREF(np_array);\n        Py_DECREF(np_ret);\n        return c_out;\n    }\n}\n</code></pre>\n\n<p>Here is my main.cpp</p>\n\n<pre><code>static int numargs=0;\n\nstatic PyObject*\nemb_numargs(PyObject *self, PyObject *args)\n{\n    if(!PyArg_ParseTuple(args, \":numargs\"))\n        return NULL;\n    return PyLong_FromLong(numargs);\n}\n\nstatic PyMethodDef EmbMethods[] = {\n    {\"numargs\", emb_numargs, METH_VARARGS,\n     \"Return the number of arguments received by the process.\"},\n    {NULL, NULL, 0, NULL}\n};\n\nstatic PyModuleDef EmbModule = {\n    PyModuleDef_HEAD_INIT, \"emb\", NULL, -1, EmbMethods,\n    NULL, NULL, NULL, NULL\n};\n\nstatic PyObject*\nPyInit_emb(void)\n{\n    return PyModule_Create(&amp;EmbModule);\n}\n\nint main(int argc, char *argv[]) {\n    if (argc &lt; 1) {\n        fprintf(stderr,\"Usage: call pythonfile funcname [args]\\n\");\n        return 1;\n    }\n\n    numargs = argc;\n    PyImport_AppendInittab(\"emb\", &amp;PyInit_emb);\n\n    Py_Initialize();        // initialize python interpreter\n    PyRun_SimpleString(\"import sys\");\n    PyRun_SimpleString(\"if not hasattr(sys, 'argv'):\\n    sys.argv=['']\");\n    PyRun_SimpleString(\"sys.path.insert(0, \\\"./\\\")\");\n    PyRun_SimpleString(\"sys.path.insert(0, \\\"./venv/Lib\\\")\");\n    PyRun_SimpleString(\"sys.path.insert(0, \\\"./venv/Lib/site-packages\\\")\");\n\n    // instance cpp interface object\n    CppPythonHandler * pInter = new CppPythonHandler(\"main\", \"PyInterface\");\n    // unsigned char * np_uint8 = pInter-&gt;get_uint8();\n    float * np_float = pInter-&gt;get_float();\n\n    std::cout&lt;&lt;\"End test\"&lt;&lt;std::endl;\n    // delete []pInter;\n\n    if (Py_FinalizeEx() &lt; 0) {\n        std::cout &lt;&lt; \"Fails to release\" &lt;&lt; std::endl;\n        return 120;\n    }\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>by the terminal I can see that I can get the right value from python script \n<a href=\"https://i.stack.imgur.com/72SY8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/72SY8.png\" alt=\"enter image description here\"></a></p>\n\n<p>from the call stack I know it corrupts in PyObject_Alloc\n<a href=\"https://i.stack.imgur.com/7p8m8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7p8m8.png\" alt=\"enter image description here\"></a></p>\n\n<p>but I still don't what exactly the problem is. can anyone tell me</p>\n\n<p>EDIT1\uff1a\nHere is my constructor</p>\n\n<pre><code>CppPythonHandler::CppPythonHandler(const char* pModuleName, const char* pClassName) {\n    interfaceModule = NULL;\n    interfaceClass = NULL;\n    interface = NULL;\n    interfaceModule = PyImport_ImportModule(pModuleName);\n    if (interfaceModule == NULL) {\n        PyErr_Print();\n        fprintf(stderr,\"Fails to import the module.\\n\");\n        Py_DECREF(interfaceModule);\n    }\n    else{\n        // import interface class\n        interfaceClass = PyObject_GetAttrString(interfaceModule, pClassName);\n        if (interfaceClass &amp;&amp; PyCallable_Check(interfaceClass)) {\n\n            // NULL represents no args\n            interface = PyObject_CallObject(interfaceClass, NULL);\n            Py_DECREF(interfaceClass);\n            Py_DECREF(interfaceModule);\n            if(interface == NULL){\n                fprintf(stderr,\"Fails to instance interface.\\n\");\n                Py_DECREF(interface);\n            }\n            std::cout&lt;&lt;\"Initailization done\"&lt;&lt;std::endl;\n        }\n        else{\n            if (PyErr_Occurred())\n                PyErr_Print();\n            fprintf(stderr,\"Fails to import the class.\\n\");\n            Py_DECREF(interfaceClass);\n            Py_DECREF(interfaceModule);\n        }\n    }\n}\n</code></pre>\n\n<p>interfaceModule, interfaceClass and interface are private PyObject*</p>\n\n<p>EDIT2:\nhere is the local parameters of PyObject_Alloc\n<a href=\"https://i.stack.imgur.com/XuBAY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XuBAY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["java", "c++", "java-native-interface", "function-pointers", "swig"], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "edited": false, "score": 0, "creation_date": 1542205381, "post_id": 53302322, "comment_id": 93485408, "body": "Are you reffering to the part of the code where I defined global <code>JEnv*</code> and did <code>gbl_env = jenv;</code>? If you do then how else can one map Java interfaces to the function pointers in C++?"}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "reply_to_user": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "edited": false, "score": 2, "creation_date": 1542205860, "post_id": 53302322, "comment_id": 93485713, "body": "@Lisek The quote in the answer already outlines what needs to be done. See <a href=\"https://stackoverflow.com/questions/30026030/what-is-the-best-way-to-save-jnienv/30026231#30026231\">this answer</a> for more details."}, {"owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "edited": false, "score": 0, "creation_date": 1542206119, "post_id": 53302322, "comment_id": 93485892, "body": "Thanks Michael. That points out the flaw of my code but still looking for the answer how could I map function pointer to the Java object."}, {"owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "edited": false, "score": 0, "creation_date": 1542208025, "post_id": 53302322, "comment_id": 93487197, "body": "@Lisek <i>That points out the flaw of my code but still looking for the answer how could I map function pointer to the Java object.</i>  There is no way to call non-JNI type functions such as your <code>void WrapperFunction(int a)</code> directly from Java code.  However, you can save function pointers as <code>jlong</code> values.  See edits for details."}], "tags": [], "owner": {"reputation": 27440, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1542208027, "last_edit_date": 1542208027, "creation_date": 1542205080, "answer_id": 53302322, "question_id": 53301963, "link": "https://stackoverflow.com/questions/53301963/return-function-pointer-from-c-behavior-to-java-object-with-jni/53302322#53302322", "title": "Return function pointer from C++ behavior to Java object with JNI", "body": "<p>You can not cache the JNIEnv value.</p>\n\n<p>Per <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/invocation.html\" rel=\"nofollow noreferrer\">Chapter 5: The Invocation API</a> of the JNI specification (bolding mine):</p>\n\n<blockquote>\n  <p><strong>Attaching to the VM</strong></p>\n  \n  <p><strong>The JNI interface pointer (JNIEnv) is valid only in the current\n  thread</strong>. Should another thread need to access the Java VM, it must\n  first call <code>AttachCurrentThread()</code> to attach itself to the VM and\n  obtain a JNI interface pointer. Once attached to the VM, a native\n  thread works just like an ordinary Java thread running inside a native\n  method. The native thread remains attached to the VM until it calls\n  <code>DetachCurrentThread()</code> to detach itself.</p>\n</blockquote>\n\n<p>For method id and your callback object, you need to create a global references:</p>\n\n<pre><code>    gbl_method = jenv-&gt;NewGlobalReference( mid );\n    gbl_callback = jenv-&gt;NewGlobalReverend( jarg2 );\n</code></pre>\n\n<p>That does create one serious problem, though - that object reference held in <code>gbl_callback</code> will result in the Java object never getting garbage collected.</p>\n\n<p>To return a C++ callback function, you'd first need to convert the function pointer to a valid Java type.  Strict conformance with the C standard (JNI is really C and not C++, so passing objects back and forth gets a bit murky when you mix in C++) means you can't treat the function pointer as anything other than a series of bytes, which means you'd need to convert the function pointer to a Java byte array and return that to Java.  Then convert that Java byte array back to a function pointer when you want to use it in native code.  That's a lot of code, and in JNI the more code you write the more likely you'll break something - JNI is <em>fragile</em>.</p>\n\n<p>But on both Windows and POSIX, a function pointer will fit into a <code>jlong</code>, and a <code>jlong</code> can accurately represent a function pointer's value, so that's a hack that works (and under POSIX it's probably not even a hack, but I'm not going to try finding the actual POSIX function pointer specifications that would allow that cast).</p>\n\n<p>The easiest way to do that is to create a <code>long</code> field in your Java object, and <em>return</em> the function pointer cast to a <code>jlong</code>:</p>\n\n<pre><code>JNIEXPORT jlong JNICALL Java_apiJNI_Info_1t_1callbackTest_1set(\n    JNIEnv *jenv, jclass jcls, jlong jarg1, jobject jarg1_, jobject jarg2)\n{\n    ...\n\n    return( ( jlong ) WrapperFunction );\n}\n</code></pre>\n\n<p>That would be called something like this:</p>\n\n<pre><code>// Info_t has a long field called callback\nInfo_t info_t = new Info_t();\ninfo_t.callback = info_t.setCallbackTest(new CallbackTest() {\n    @Override\n    public void onCallback(int num) {\n        System.out.println(\"callback: \" + num);\n    }\n});\n</code></pre>\n\n<p>In my experience, the less JNI calls you make, the better.  So if you can pass a value via a parameter or return it from a function call, that's simpler, safer, and a lot more reliable than trying to get/set object field values with JNI calls.</p>\n\n<p>But then you'd need to pass the callback value as another parameter:</p>\n\n<pre><code>// function pointer, returns void, takes int arg\ntypedef void (*funcPtr)( int );\n\nJNIEXPORT jobject JNICALL Java_apiJNI_Info_1t_1callbackTest_1get(\nJNIEnv *jenv, jclass jcls, jlong callback, jlong jarg1, jobject jarg1_)\n{\n    funcPtr f = ( funcPtr ) callback;\n\n    f( 4 );\n\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 3045845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oo514.png?s=128&g=1", "display_name": "Lisek", "link": "https://stackoverflow.com/users/3045845/lisek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542208027, "creation_date": 1542203950, "last_edit_date": 1542204347, "question_id": 53301963, "link": "https://stackoverflow.com/questions/53301963/return-function-pointer-from-c-behavior-to-java-object-with-jni", "title": "Return function pointer from C++ behavior to Java object with JNI", "body": "<p>This is way over my head so here we go.</p>\n\n<p>I am setting a function pointer in C++ with an interface Java object which looks like that on the Java side:</p>\n\n<pre><code>    Info_t info_t = new Info_t();\n    info_t.setCallbackTest(new CallbackTest() {\n        @Override\n        public void onCallback(int num) {\n            System.out.println(\"callback: \" + num);\n        }\n    });\n</code></pre>\n\n<p>where <code>CallbackTest()</code> is the interface with just one method:</p>\n\n<pre><code>public interface CallbackTest {\n    void onCallback(int num);\n}\n</code></pre>\n\n<p>and <code>setCallbackTest()</code> refers to the Java native method which is reflected in the C++ side like that:</p>\n\n<pre><code>JNIEnv *gbl_env;\njmethodID gbl_method;\njobject gbl_callback;\n\nvoid WrapperFunction(int a) {\n    gbl_env-&gt;ExceptionClear();\n    gbl_env-&gt;CallVoidMethod(gbl_callback, gbl_method, a);\n    if(gbl_env-&gt;ExceptionOccurred()) {\n        gbl_env-&gt;ExceptionClear();\n    }\n    return;\n}\n\nJNIEXPORT void JNICALL Java_apiJNI_Info_1t_1callbackTest_1set(JNIEnv *jenv, jclass jcls, jlong jarg1, jobject jarg1_, jobject jarg2) {\n    Info *arg1 = (Info *) 0;\n\n    (void) jenv;\n    (void) jcls;\n    (void) jarg1_;\n    arg1 = *(Info **)&amp;jarg1;\n    {\n        jclass clazz;\n        jmethodID mid;\n\n        clazz = jenv-&gt;GetObjectClass(jarg2);\n        mid = jenv-&gt;GetMethodID(clazz, \"onCallback\", \"(I)V\");\n        if(mid == 0) {\n            std::cout &lt;&lt; \"could not get method id\" &lt;&lt; std::endl;\n            return;\n        }\n        gbl_env = jenv;\n        gbl_method = mid;\n        gbl_callback = jarg2;\n    }\n    // here I am setting function pointer to the helper method which invokes the java code\n    if(arg1) (arg1)-&gt;completionCB = WrapperFunction;\n}\n</code></pre>\n\n<p>All of this was written basing on the <a href=\"https://stackoverflow.com/questions/6746078/implement-callback-function-in-jni-using-interface\">Implement callback function in JNI using Interface</a></p>\n\n<p>I have tried calling the <code>onCallback()</code> method defined in Java on the C++ side and it works (just like in the link above) but now I am trying to set the value on such <code>struct</code> under C++</p>\n\n<pre><code>typedef void (*callbackFunction)(int);\ntypedef struct Info\n{\n    callbackFunction    completionCB;\n    void                *caller;\n} Info_t;\n</code></pre>\n\n<p>so later on at some point I would like to get the <code>callbackFunction completionCB</code> back to Java as an object and probably do various stuff with it.</p>\n\n<p>My question is how can I return/map the function pointer behavior from C++ back to the Java object? Basically, I would like to do the same but in the reverse order. I am able to map Java interface onto function pointer now I would like to map function pointer behavior onto Java object.</p>\n\n<p>EDIT: So far I have come up with such getter for it but I am not sure how to proceed</p>\n\n<pre><code>JNIEXPORT jobject JNICALL Java_apiJNI_Info_1t_1callbackTest_1get(JNIEnv *jenv, jclass jcls, jlong jarg1, jobject jarg1_) {\n    jobject jresult = 0;\n    Info *arg1 = (Info *) 0;\n    callbackFunction result;\n\n    (void)jenv;\n    (void)jcls;\n    (void)jarg1_;\n    arg1 = *(Info **)&amp;jarg1;\n    result = ((arg1)-&gt;completionCB);\n\n    {\n        jclass clazz = jenv-&gt;FindClass(\"com/CallbackTest\");\n        ???\n    }\n    ???\n    return ;\n}\n</code></pre>\n"}, {"tags": ["c++", "com", "windows-services", "ado"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542204638, "post_id": 53301932, "comment_id": 93484915, "body": "In my opinion, it looks like the issue most likely lies in implementation <code>Connection</code>, where the initialization of it fails with such error code, which gets, simply, returned to the user (you)."}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542205507, "post_id": 53301932, "comment_id": 93485492, "body": "I do not implement Connection, it comes from msado15.dll which, i think, is quite safe. Also, the credentialProvider uses the same implementation, right ?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542206121, "post_id": 53301932, "comment_id": 93485893, "body": "I am not familiar with the components, that you are using. I am merely stating my opinion, regarding the possible source of the error, based on information provided."}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542206372, "post_id": 53301932, "comment_id": 93486053, "body": "It doesn&#39;t seem stupid, regarding the error i get. But it&#39;s probably not the answer... I guess ! Thanks anyway"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1542206460, "post_id": 53301932, "comment_id": 93486103, "body": "Running from a Windows service can be very different than running from a desktop. There&#39;s probably to UI in that service. <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/hardware/design/dn653293(v=vs.85)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/windows/hardware/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "edited": false, "score": 0, "creation_date": 1542206985, "post_id": 53301932, "comment_id": 93486462, "body": "Hello Simon &amp; thanks for the link. Hum, ain&#39;t winlogon also running in session 0 ? I&#39;m currently trying impersonation to verify. I&#39;ll let you know the result"}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "edited": false, "score": 0, "creation_date": 1542213429, "post_id": 53301932, "comment_id": 93490614, "body": "Seems impersonation ain&#39;t the solution either"}, {"owner": {"reputation": 886, "user_id": 3868464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3JnBN.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3868464/alexander"}, "edited": false, "score": 1, "creation_date": 1542358364, "post_id": 53301932, "comment_id": 93547904, "body": "Does your service call <code>CoInitialize</code> or <code>CoInitializeEx</code>?"}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "edited": false, "score": 1, "creation_date": 1542377468, "post_id": 53301932, "comment_id": 93557867, "body": "You&#39;re a fucking genius. CoInitializeEx was failing in Service. Still don&#39;t know why Initializing through dll did not work though..."}, {"owner": {"reputation": 886, "user_id": 3868464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3JnBN.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3868464/alexander"}, "edited": false, "score": 0, "creation_date": 1542460940, "post_id": 53301932, "comment_id": 93581057, "body": "Please quote a couple lines of code with call to <code>CoInitializeEx</code> in your Service."}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "edited": false, "score": 0, "creation_date": 1542619341, "post_id": 53301932, "comment_id": 93618933, "body": "It&#39;s fine, i found the problem. I called it just before the getProcAddress and it works now. It was just a thread parameter problem as i had to choose COINIT_MULTITHREAD to be compatible."}, {"owner": {"reputation": 886, "user_id": 3868464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3JnBN.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3868464/alexander"}, "edited": false, "score": 0, "creation_date": 1542619980, "post_id": 53301932, "comment_id": 93619291, "body": "<code>CoInitializeEx(NULL, COINIT_MULTITHREADED);</code> is my first line inside of my services WinMain. My service also use a lots of COM and  ADO."}, {"owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "edited": false, "score": 0, "creation_date": 1542621583, "post_id": 53301932, "comment_id": 93620227, "body": "MyService starts at Winlogon but is useless until/unless i logon to a user session. I prefer not initializing a COM interface unless i really need it. I read it can be a bit heavy on performances. And also, my credential also initialize it. Is it fine to initialize it twice in two different threads... ? Who knows ? I can&#39;t find much documentation on COM &quot;internal&quot;"}, {"owner": {"reputation": 886, "user_id": 3868464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3JnBN.jpg?s=128&g=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3868464/alexander"}, "edited": false, "score": 0, "creation_date": 1542623846, "post_id": 53301932, "comment_id": 93621502, "body": "<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex\" rel=\"nofollow noreferrer\">Docs</a> says you can call <code>CoInitializeEx</code> as many times as you wish. Just call <code>CoUninitialize</code> same count of times."}], "owner": {"reputation": 19, "user_id": 9072807, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-k-feQR56GS0/AAAAAAAAAAI/AAAAAAAAAHg/ZYc1fXG0M7Y/photo.jpg?sz=128", "display_name": "Sillimon", "link": "https://stackoverflow.com/users/9072807/sillimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542904442, "creation_date": 1542203852, "last_edit_date": 1542904442, "question_id": 53301932, "link": "https://stackoverflow.com/questions/53301932/com-ptr-tcreateinstance-hresult-error-cannot-find-wnd-class", "title": "_com_ptr_t::CreateInstance, HRESULT = ERROR_CANNOT_FIND_WND_CLASS", "body": "<p>I'm facing a problem with getting a COM interface loaded. </p>\n\n<p>I'll explain the context a little :</p>\n\n<p>i have a CredentialProvider (running at winlogon so) which does a loadlibrary + getProcAddress on a dll. This dll, in each of its functions, load the COM interface this way :</p>\n\n<pre><code>_ConnectionPtr con;\nhr = con.CreateInstance(__uuidof(Connection));\nif(FAILED(hr)\n{\n    _com_error err(hr);\n    LPCTSTR errMsg = err.ErrorMessage();\n    Log(\"hr = {%s}\", errMsg);\n\n    CoInitializeEx(NULL, COINIT_MULTITHREADED);\n\n    hr = con.CreateInstance(__uuidof(Connection));\n}\n</code></pre>\n\n<p>And it works fine.</p>\n\n<p>However, after entering the userSession, a windows service finally loadlibrary/getProcAddress this same dll.</p>\n\n<p>And when it tries to CreateInstance on the __uuidof(Connection), it fails with error \"ERROR_CANNOT_FIND_WND_CLASS - Cannot find window class\". </p>\n\n<p>How should i interpret this error ? Actually, should i ?</p>\n\n<p>Does someone have an idea of why it could fail with windows service while it succeeds few seconds before with the credentialProvider ?</p>\n\n<p>Feel free to ask if any details is missing.</p>\n\n<p>Thank you for any solution/clue/tip.</p>\n"}, {"tags": ["c++", "namespaces"], "comments": [{"owner": {"reputation": 348, "user_id": 6025530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76903b2b126b59e3c8cafcd287317743?s=128&d=identicon&r=PG&f=1", "display_name": "nikniknik2016", "link": "https://stackoverflow.com/users/6025530/nikniknik2016"}, "edited": false, "score": 1, "creation_date": 1542204259, "post_id": 53301869, "comment_id": 93484649, "body": "just use global prefix <code>::</code>. E.g. <code>::n1::n1</code>"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542205162, "post_id": 53301869, "comment_id": 93485263, "body": "What explanation do you need? <code>using namespace</code> directives are blunt. You noticed they are blunt, and found the work arounds."}], "answers": [{"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 1, "last_activity_date": 1542204773, "creation_date": 1542204773, "answer_id": 53302221, "question_id": 53301869, "link": "https://stackoverflow.com/questions/53301869/ambiguous-namespace/53302221#53302221", "title": "Ambiguous namespace", "body": "<p>Since you are <code>using namespace n1;</code>, the first <code>n1</code> in <code>cout &lt;&lt; n1::n1::x&lt;&lt;endl;</code> doesn't know if it should match on the outer <code>n1</code> or the <code>n1</code> found in <code>n1</code>.</p>\n"}], "owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53302221, "answer_count": 1, "score": -1, "last_activity_date": 1542204773, "creation_date": 1542203671, "question_id": 53301869, "link": "https://stackoverflow.com/questions/53301869/ambiguous-namespace", "title": "Ambiguous namespace", "body": "<p>The following implementation is giving the error : \"reference to n1 is ambiguous\"</p>\n\n<pre><code>namespace n1 // (0)\n{\n    namespace n1\n    {\n        int x;\n    }\n\n    namespace n1\n    {\n        int y;\n    }\n}\n\nusing namespace n1; // (1)\n//using namespace n1::n1; // (2)\n\nint main()\n{\n    cout &lt;&lt; n1::n1::x&lt;&lt;endl;\n}\n</code></pre>\n\n<p>By commenting (1) and using (2) the problem is resolved.</p>\n\n<p>Using another namespace in (0) the variants (1) and (2) will work.</p>\n\n<p>Any explanation ? </p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1542205751, "post_id": 53301679, "comment_id": 93485645, "body": "You always call <code>happyNr(3)</code>. Since 3 is less than 100000, the only line that ever runs is <code>if (a&lt;100000 || a&gt;999999) return false;</code>"}, {"owner": {"reputation": 111, "user_id": 7220438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCbNM.png?s=128&g=1", "display_name": "Sysadmin", "link": "https://stackoverflow.com/users/7220438/sysadmin"}, "reply_to_user": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1542363045, "post_id": 53301679, "comment_id": 93550178, "body": "Right. I know what I should do. I need to save all sorted results to another array, then do a linear or binary search and then save results of lucky numbers to another array and display the result from the last array, which stores it."}], "owner": {"reputation": 111, "user_id": 7220438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCbNM.png?s=128&g=1", "display_name": "Sysadmin", "link": "https://stackoverflow.com/users/7220438/sysadmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542203077, "creation_date": 1542203077, "question_id": 53301679, "link": "https://stackoverflow.com/questions/53301679/happynri-not-functioning-as-i-understand-it-should-do", "title": "happyNr(i); not functioning as I understand it should do", "body": "<p>Write a program with a function main () and selecting a menu of functions:</p>\n\n<p>Generate a programming-random number generator data for lottery ticket / max 100 / with six-digit numbers and store them in an array</p>\n\n<p>-Overwrite generated a new array and sort this array in ascending order and display output</p>\n\n<p>-Counting and display output and numbers of all \"happy\" six digit lottery tickets /these numbers which sum of the first 3 digits is equal to the last three/</p>\n\n<p>-Save in the array and display output sequence numbers of downloaded \"lucky\" lottery tickets</p>\n\n<p>I have a problem with last two steps.Can you explain how to do it correctly?</p>\n\n<pre><code>#include &lt;cstdlib&gt;\n#include &lt;ctime&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint numbers;\nint array[100];\n\nvoid generator()\n{\n   srand((unsigned)time(0));\n   for(int i = 0; i &lt; 100; i++)\n   {\n       numbers  = (rand() % 900000) + 100000;\n       array[i] = numbers;\n       cout &lt;&lt; numbers &lt;&lt; endl;\n   }\n}\n\nvoid sorted_list()\n{\n      int i = 100, a, b, c;\n      for (a = 0; a &lt; i - 1; a++)\n      {\n          for(b = 1; b &lt; i; b++)\n          {\n              if (array[b] &lt; array[b - 1])\n              {\n                  c = array[b];\n                  array[b]= array[b - 1];\n                  array[b - 1]=c;\n              }\n           }\n      }\n\n      for (a = 0; a &lt; i; a++)\n      {\n          cout &lt;&lt; a &lt;&lt; \": \" &lt;&lt; array[a] &lt;&lt; \"\\n\";\n      }\n}\n\n\nbool happyNr(int a){\n    if (a&lt;100000 || a&gt;999999) return false;\n    int half1=0, half2=0;\n    for (int i=0;i&lt;6;i++){\n        if (i&lt;3) {half1+=a%10; a=a/10;}\n        else {half2+=a%10; a=a/10;}\n    }\n    return half1==half2;\n}\n\nint menu()\n{\n    int choice;\n    cout&lt;&lt;\"\\n_______________MENU_______________\";\n    cout&lt;&lt;\"\\n 1. Generate random numbers\";\n    cout&lt;&lt;\"\\n 2. Sorted array\";\n    cout&lt;&lt;\"\\n 3. Happy numbers\";\n    cout&lt;&lt;\"\\n 4. Exit\";\n     do\n      {\n         cout&lt;&lt;\"\\n Choice: \";\n         cin&gt;&gt;choice;\n      }while(choice&lt;1||choice&gt;4);\n\n    return(choice);\n}\nint main()\n{\nint i;\ndo\n    {\n       i=menu();\n       switch(i)\n          {\n            case 1: generator();break;\n            case 2: sorted_list();break;\n            case 3: happyNr(i);break;\n          }\n   }\nwhile(i!=4);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "xml", "parsing", "libxml2"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 1, "creation_date": 1542202826, "post_id": 53301564, "comment_id": 93483679, "body": "You forgot to ask a question... What is happening? What did you expect to happen?"}, {"owner": {"reputation": 129, "user_id": 3665387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cea0ce900ff24a38259a0f8e3fe75f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Yadav", "link": "https://stackoverflow.com/users/3665387/hemant-yadav"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1542202955, "post_id": 53301564, "comment_id": 93483764, "body": "@Thomas.....Hey thanks I edited the que. Somehow I am not getting the libxml2 right. Frankly speaking I didn&#39;t understand its documentation and complexity."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1542203796, "post_id": 53301564, "comment_id": 93484352, "body": "@HemantYadav You haven&#39;t asked a question or described a problem, you&#39;ve only shared your goals. What output are you getting? What output are you expecting? How do they differ? Are you getting errors? If you do, what kind and what do they say? Take a moment to read <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>."}, {"owner": {"reputation": 129, "user_id": 3665387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cea0ce900ff24a38259a0f8e3fe75f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Yadav", "link": "https://stackoverflow.com/users/3665387/hemant-yadav"}, "edited": false, "score": 0, "creation_date": 1542205522, "post_id": 53301564, "comment_id": 93485507, "body": "See the line number 8. I was expecting the lastChild-&gt;name to return name of tag, but it always returns &quot;text&quot; as output. So I am stuck at initial stage only."}, {"owner": {"reputation": 129, "user_id": 3665387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cea0ce900ff24a38259a0f8e3fe75f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Yadav", "link": "https://stackoverflow.com/users/3665387/hemant-yadav"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1542206155, "post_id": 53301564, "comment_id": 93485926, "body": "It worked, I am able to check the whether NextMarker is present or not. Code need be changed to xmlNodePtr lastChild = root-&gt;last-&gt;prev;        But why root-&gt;last-&gt;prev when last child is &quot;NextMarker&quot; tag. @Fran&#231;ois Andrieux @ Thomas"}, {"owner": {"reputation": 129, "user_id": 3665387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cea0ce900ff24a38259a0f8e3fe75f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Yadav", "link": "https://stackoverflow.com/users/3665387/hemant-yadav"}, "edited": false, "score": 0, "creation_date": 1542207030, "post_id": 53301564, "comment_id": 93486504, "body": "Modified the code in the question. Now still Thing#1 is left."}], "owner": {"reputation": 129, "user_id": 3665387, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cea0ce900ff24a38259a0f8e3fe75f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Hemant Yadav", "link": "https://stackoverflow.com/users/3665387/hemant-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1542207186, "creation_date": 1542202692, "last_edit_date": 1542207186, "question_id": 53301564, "link": "https://stackoverflow.com/questions/53301564/parse-xml-using-libxml2", "title": "Parse XML using libxml2", "body": "<p>I am trying from almost a day to parse the below XML using libxml2 cpp library. I need to 2 things:</p>\n\n<p>1) I need to get the list of all \"Bucket\" tag in a std::vector array.</p>\n\n<p>2) Find if \"NextMarker\" tag is present or not.</p>\n\n<p>Their are 2 possible XML that can be given as input.</p>\n\n<p><strong>XML 1</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;  \n&lt;EnumerationResults ServiceEndpoint=\"https://myaccount.blob.core.windows.net/\"&gt;  \n  &lt;MaxResults&gt;3&lt;/MaxResults&gt;  \n  &lt;Containers&gt;  \n    &lt;Bucket&gt;  \n      &lt;Name&gt;audio&lt;/Name&gt;  \n      &lt;Properties&gt;  \n        &lt;Last-Modified&gt;Wed, 26 Oct 2016 20:39:39 GMT&lt;/Last-Modified&gt;  \n        &lt;Etag&gt;0x8CACB9BD7C6B1B2&lt;/Etag&gt; \n        &lt;PublicAccess&gt;container&lt;/PublicAccess&gt; \n      &lt;/Properties&gt;  \n    &lt;/Bucket&gt;  \n    &lt;Bucket&gt;  \n      &lt;Name&gt;images&lt;/Name&gt;  \n      &lt;Properties&gt;  \n        &lt;Last-Modified&gt;Wed, 26 Oct 2016 20:39:39 GMT&lt;/Last-Modified&gt;  \n        &lt;Etag&gt;0x8CACB9BD7C1EEEC&lt;/Etag&gt;  \n      &lt;/Properties&gt;  \n    &lt;/Bucket&gt;  \n    &lt;Bucket&gt;  \n      &lt;Name&gt;textfiles&lt;/Name&gt;  \n      &lt;Properties&gt;  \n        &lt;Last-Modified&gt;Wed, 26 Oct 2016 20:39:39 GMT&lt;/Last-Modified&gt;  \n        &lt;Etag&gt;0x8CACB9BD7BACAC3&lt;/Etag&gt;  \n      &lt;/Properties&gt;  \n    &lt;/Bucket&gt;  \n  &lt;/Containers&gt;  \n  &lt;NextMarker&gt;video&lt;/NextMarker&gt;  \n&lt;/EnumerationResults&gt;\n</code></pre>\n\n<p><strong>XML 2</strong></p>\n\n<pre><code>&lt;EnumerationResults&gt;\n    &lt;Containers /&gt;\n    &lt;NextMarkerr&gt;/pdtcava01a/container1&lt;/NextMarker&gt;\n&lt;/EnumerationReslts&gt;\n</code></pre>\n\n<p>My poor code:</p>\n\n<pre><code>int main(){\n    // Read the file\n    xmlDocPtr doc; /* the resulting document tree */\n    doc = xmlReadFile(\"/home/cbs/hemant/azure_d_patch/backend_trim/file_xml.xml\", NULL, 0);\n\n    // Thing#2. Check if NextMarker tag is present. WORKING\n    xmlNode *root = xmlDocGetRootElement(doc);\n    xmlNodePtr lastChild = root-&gt;last-&gt;prev;\n    xmlChar *NextMarker = xmlCharStrdup(\"NextMarker\");\n    if(!xmlStrcmp(lastChild-&gt;name, NextMarker)) {\n        cout&lt;&lt;\"NextMarker tag present\"&lt;&lt;endl;\n    }\n\n    // thing#1. Failing to get the list of Buckets. NOT WORKING\n    xmlChar *toFind = xmlCharStrdup(\"Containers\");\n    xmlNodePtr container = findNodeByName(root-&gt;children, toFind);\n    container = container-&gt;children;\n\n    XmlVal hem(container-&gt;children);\n    std::vector&lt;XmlVal&gt; cont_list = hem.list(); // list() was my internal function which I now scraped.\n\n    for (std::vector&lt;XmlVal&gt;::iterator it = cont_list.begin(); it != cont_list.end(); ++it) {\n        bucket b;\n        b.name_ = (*it)[\"Name\"].content();\n        b.creation_time_ = (*it)[\"Last-Modified\"].content();\n        cout&lt;&lt;b.name_&lt;&lt;\"    \"&lt;&lt;b.creation_time_&lt;&lt;endl;\n        bucket_list.push_back(b);\n    }\n    return 1;\n\n}\n</code></pre>\n"}, {"tags": ["java", "c++", "jar", "segmentation-fault"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1542202670, "post_id": 53301531, "comment_id": 93483570, "body": "If you can, solve the root problem and fix the native code instead."}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1542202723, "post_id": 53301531, "comment_id": 93483605, "body": "Anyway, possible duplicate of <a href=\"https://stackoverflow.com/questions/1083154/how-can-i-catch-sigsegv-segmentation-fault-and-get-a-stack-trace-under-jni-on\">How can I catch SIGSEGV (segmentation fault) and get a stack trace under JNI on Android?</a>"}, {"owner": {"reputation": 23, "user_id": 4187627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1720c6ad42d5886c77fc89e7a8938ff?s=128&d=identicon&r=PG&f=1", "display_name": "sticker", "link": "https://stackoverflow.com/users/4187627/sticker"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1542207774, "post_id": 53301531, "comment_id": 93487016, "body": "I&#39;m not allowed to fix the native code. It&#39;s a black box for me. Moreover I have to use exactly this lib. In general, SIGSEGV will generally crash the JVM before control is returned to my Java code."}], "owner": {"reputation": 23, "user_id": 4187627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1720c6ad42d5886c77fc89e7a8938ff?s=128&d=identicon&r=PG&f=1", "display_name": "sticker", "link": "https://stackoverflow.com/users/4187627/sticker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542273235, "creation_date": 1542202609, "last_edit_date": 1542273235, "question_id": 53301531, "link": "https://stackoverflow.com/questions/53301531/extraction-of-native-c-code-to-prevent-tomcat-from-stopping-java-app", "title": "Extraction of native C++ code to prevent Tomcat from stopping - java app", "body": "<p>I'm working on java web app which uses some external JAR lib with native C++ libraries.\nFrom time to time one of the methods from C++ libraries causes SIGSEGV which  terminates my tomcat app. Is there any good way to extract this small piece of java code with native library to prevent my app from being terminated?\nI would like to make a call to this extracted part of code and if SIGSEGV occurs it should not impact on my whole web app and java VM.\nAny idea?</p>\n\n<ul>\n<li>It's not an Android platform</li>\n<li>SIGSEGV in JNI code will generally crash the JVM before control is returned to your Java code.</li>\n</ul>\n"}, {"tags": ["c++", "logging", "spdlog"], "comments": [{"owner": {"reputation": 1102, "user_id": 5088796, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/19f4fd38736f571b96696b615af97266?s=128&d=identicon&r=PG&f=1", "display_name": "Yanick Salzmann", "link": "https://stackoverflow.com/users/5088796/yanick-salzmann"}, "edited": false, "score": 0, "creation_date": 1542202872, "post_id": 53301519, "comment_id": 93483710, "body": "Have you tried creating a minimal example? In this case it could be a new project, just one c++ file including spdlog, calling <code>spdlog::set_pattern</code> in the main function and thats it. Does that crash as well?"}, {"owner": {"reputation": 2341, "user_id": 3883569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c778021c6ac70c1fe99a0294b0ed664f?s=128&d=identicon&r=PG&f=1", "display_name": "FreshD", "link": "https://stackoverflow.com/users/3883569/freshd"}, "edited": false, "score": 0, "creation_date": 1542204402, "post_id": 53301519, "comment_id": 93484753, "body": "Could you provide the error message and if you are using your <code>CMakeLists.txt</code> file"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9217278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459aac0d7344b1fdda8c224e9e867eb0?s=128&d=identicon&r=PG&f=1", "display_name": "TokenGuard", "link": "https://stackoverflow.com/users/9217278/tokenguard"}, "edited": false, "score": 0, "creation_date": 1542209735, "post_id": 53302370, "comment_id": 93488218, "body": "Hey, cheers for spotting that. Unfortunately it does not solve the issue as even the first call to <code>spdlog::stdout_color_mt()</code> segfaults"}], "tags": [], "owner": {"reputation": 149, "user_id": 3672418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac979d233ba2722b99b65c727f6f6e5b?s=128&d=identicon&r=PG&f=1", "display_name": "sergiopm", "link": "https://stackoverflow.com/users/3672418/sergiopm"}, "is_accepted": false, "score": 1, "last_activity_date": 1542205240, "creation_date": 1542205240, "answer_id": 53302370, "question_id": 53301519, "link": "https://stackoverflow.com/questions/53301519/spdlog-crash-on-factory-methods/53302370#53302370", "title": "spdlog crash on factory methods", "body": "<p>You are using the same name for both loggers, when you run it you'll get:</p>\n\n<pre><code>$ ./logger\nlibc++abi.dylib: terminating with uncaught exception of type spdlog::spdlog_ex: logger with name 'CORE' already exists\nAbort trap: 6\n</code></pre>\n\n<p>If you change the name of the client logger to something else it works fine:</p>\n\n<pre><code>sCoreLogger = spdlog::stdout_color_mt(\"CORE\");\nsClientLogger = spdlog::stdout_color_mt(\"CLIENT\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9217278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459aac0d7344b1fdda8c224e9e867eb0?s=128&d=identicon&r=PG&f=1", "display_name": "TokenGuard", "link": "https://stackoverflow.com/users/9217278/tokenguard"}, "edited": false, "score": 0, "creation_date": 1542320189, "post_id": 53309264, "comment_id": 93537776, "body": "I have tried this approach however it now doesn&#39;t compile with an error saying that <code>spdlog::logger</code> is only forward declared and not defined anywhere, when quite clearly I define it in <code>Logger.cpp</code> by including <code>spdlog.h</code> It really does seem like this is the issue though as with the setup you mentioned if I include <code>spdlog.h</code> in the client code it still segfaults so +1 for that"}, {"owner": {"reputation": 11, "user_id": 9217278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459aac0d7344b1fdda8c224e9e867eb0?s=128&d=identicon&r=PG&f=1", "display_name": "TokenGuard", "link": "https://stackoverflow.com/users/9217278/tokenguard"}, "edited": false, "score": 0, "creation_date": 1542320787, "post_id": 53309264, "comment_id": 93537946, "body": "Just to clarify: it is me trying to log a message in the application that causes the project not to compile not the actual <code>Logger::Init()</code> method"}, {"owner": {"reputation": 16381, "user_id": 192001, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/433bc3432389b34a9461e14fa3a5505f?s=128&d=identicon&r=PG", "display_name": "GabiMe", "link": "https://stackoverflow.com/users/192001/gabime"}, "reply_to_user": {"reputation": 11, "user_id": 9217278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459aac0d7344b1fdda8c224e9e867eb0?s=128&d=identicon&r=PG&f=1", "display_name": "TokenGuard", "link": "https://stackoverflow.com/users/9217278/tokenguard"}, "edited": false, "score": 0, "creation_date": 1542321090, "post_id": 53309264, "comment_id": 93538049, "body": "Right, I forgot that spdlog::logger is defined as inline, meaning its definitaion doesn&#39;t cross the compilation unit boundries."}, {"owner": {"reputation": 11, "user_id": 9217278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459aac0d7344b1fdda8c224e9e867eb0?s=128&d=identicon&r=PG&f=1", "display_name": "TokenGuard", "link": "https://stackoverflow.com/users/9217278/tokenguard"}, "edited": false, "score": 0, "creation_date": 1542359670, "post_id": 53309264, "comment_id": 93548441, "body": "Could you expand on what you mean by &quot;wrapping it in a single class&quot;? I&#39;m still a relative newbie to c++ and can&#39;t quite see how I would do it."}], "tags": [], "owner": {"reputation": 16381, "user_id": 192001, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/433bc3432389b34a9461e14fa3a5505f?s=128&d=identicon&r=PG", "display_name": "GabiMe", "link": "https://stackoverflow.com/users/192001/gabime"}, "is_accepted": false, "score": 1, "last_activity_date": 1542321588, "last_edit_date": 1542321588, "creation_date": 1542232370, "answer_id": 53309264, "question_id": 53301519, "link": "https://stackoverflow.com/questions/53301519/spdlog-crash-on-factory-methods/53309264#53309264", "title": "spdlog crash on factory methods", "body": "<p>The problem is probably that spdlog\u2019s static objects are defined twice - from inside the shared library and from client code that includes your logger header (which incldes spdlog.h). </p>\n\n<p>Try to remove the include to spdlog.h from the header file and (and use forward declaration of spdlog::logger instead), and include spdlog.h only from your Logger.cpp file.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>spdlog::logger cannot be forward declared across compilation unit boundries.\nThe solution is to wrap the logger with some simple class defined in logger.cpp and only export it in logger.h</p>\n"}], "owner": {"reputation": 11, "user_id": 9217278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459aac0d7344b1fdda8c224e9e867eb0?s=128&d=identicon&r=PG&f=1", "display_name": "TokenGuard", "link": "https://stackoverflow.com/users/9217278/tokenguard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1835, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557855215, "creation_date": 1542202571, "last_edit_date": 1557855215, "question_id": 53301519, "link": "https://stackoverflow.com/questions/53301519/spdlog-crash-on-factory-methods", "title": "spdlog crash on factory methods", "body": "<p>Yesterday I have started including <code>spdlog</code> into a personal project of mine to use for logging. So far I have had some problems with getting library inclusion to work but those are now solved completely.</p>\n\n<p>Now everything compiles just fine, with all headers found however when I try to create loggers or simply set the pattern for logging the code crashes with a segmentation fault. More specifically no matter which function I call from the <code>spdlog</code> namespace for the very first time in the program causes the crash.</p>\n\n<p>I have a class abstracting some parts from <code>spdlog</code> (based on <a href=\"https://github.com/TheCherno/Hazel\" rel=\"nofollow noreferrer\">this</a> repo) as follows:</p>\n\n<pre><code>//Logger.hpp\n#ifndef TE_LOGGER_HPP\n#define TE_LOGGER_HPP\n\n#include &lt;spdlog/spdlog.h&gt;\n\nnamespace te {\n\nclass Logger {\npublic:\n    static void Init();\n\n    inline static std::shared_ptr&lt;spdlog::logger&gt; &amp;getCoreLogger() {\n        return sCoreLogger;\n    }\n    inline static std::shared_ptr&lt;spdlog::logger&gt; &amp;getClientLogger() {\n        return sClientLogger;\n    }\n\nprivate:\n    static std::shared_ptr&lt;spdlog::logger&gt; sCoreLogger;\n    static std::shared_ptr&lt;spdlog::logger&gt; sClientLogger;\n};\n\n}\n#endif //TE_LOGGER_HPP\n\n//Logger.cpp\n#include \"Logger.hpp\"\n#include &lt;spdlog/sinks/stdout_color_sinks.h&gt;\n\nstd::shared_ptr&lt;spdlog::logger&gt; te::Logger::sCoreLogger;\nstd::shared_ptr&lt;spdlog::logger&gt; te::Logger::sClientLogger;\n\nvoid te::Logger::Init() {\n    //The first of any of the following three lines cause a crash\n    //no matter the order, regardless of the pattern used in set_pattern\n    spdlog::set_pattern(\"%v\");\n    sCoreLogger = spdlog::stdout_color_mt(\"CORE\");\n    sClientLogger = spdlog::stdout_color_mt(\"CORE\");\n\n    sCoreLogger-&gt;set_level(spdlog::level::trace);\n    sClientLogger-&gt;set_level(spdlog::level::trace);\n}\n</code></pre>\n\n<p>From the stack traces it seems that the issue is with the <code>formatter</code> class in <code>spdlog</code> being set <code>null</code> for some reason somewhere within the library. I am using the latest CLion, C++14 (I am aware that spdlog is C++11, but I need features from 14 later down the line, also setting -std=c++11 doesn't solve the issue) and the latest version of <code>spdlog</code> as of yesterday (pulled straight from their GitHub repo) on Ubuntu 18.04.</p>\n\n<p>EDIT: As per the request in the comments I have created a small project (single cpp file, include <code>spdlog</code> the way I do in the real project, or the same code and library setup as in the real project referenced from the <code>main.cpp</code> file and linked to accordingly) that aims to reproduce the issue and here are my findings:\n* The issue is not present when I use <code>spdlog</code> directly in the executable\n* The issue is present if the Logger class is moved into a shared library and linked to from there</p>\n\n<p>Here is the error message I am getting:</p>\n\n<pre><code>Process finished with exit code 139 (interrupted by signal 11: SIGSEGV)\n</code></pre>\n\n<p>And the CMakeLists.txt files I am using (I nest the library's one into the project since as of now CLion does not support \"multiple projects in the same solution\" like for example VS does):\n    #CMakeLists.txt for Library\n    cmake_minimum_required(VERSION 3.10 FATAL_ERROR)</p>\n\n<pre><code>project(TokenEngine VERSION 0.0.1 LANGUAGES CXX)\nset(CMAKE_CXX_STANDARD 14)\n\nset(SOURCE_FILES src/Application.cpp src/Application.hpp src/EntryPoint.hpp src/Logger.cpp src/Logger.hpp)\n\n#include_directories(\"${CMAKE_CURRENT_SOURCE_DIR}/libs/\")\nadd_library(TokenEngine SHARED ${SOURCE_FILES})\n\ntarget_include_directories(TokenEngine PRIVATE \"${CMAKE_CURRENT_SOURCE_DIR}/libs/spdlog-1.x/include\")\n\n#Expose the public API of the engine to any project that might use it\ntarget_include_directories(TokenEngine PUBLIC include)\n\n#CMakeLists.txt for top level project\ncmake_minimum_required(VERSION 3.10 FATAL_ERROR)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -Wall -Wextra\")\n\nadd_definitions(-DTE_PLATFORM_LINUX)\n\nproject(Build CXX)\n\nadd_subdirectory(TokenEngine)\nadd_subdirectory(Sandbox)\n</code></pre>\n"}, {"tags": ["c++", "compiler-errors", "g++", "deprecated"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542203046, "post_id": 53301496, "comment_id": 93483822, "body": "could be many things. eg in gcc you can silence warnings when a header is included via <code>-isystem</code>"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542203077, "post_id": 53301496, "comment_id": 93483849, "body": "<code>#undef SSH_DEPRECATED #include ... #define SSH_DEPRECATED ...</code>"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542203151, "post_id": 53301496, "comment_id": 93483901, "body": "@YSC how&#39;s that better than my <code>-Wno-deprecated</code>? I don&#39;t want to ignore, but to fix"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1542203245, "post_id": 53301496, "comment_id": 93483964, "body": "This is not a solution, this is one of many things that could make the warning not to appear in <code>B</code>. We cannot <i>guess</i>. At this point, this is just opinions you&#39;re asking."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1542203270, "post_id": 53301496, "comment_id": 93483985, "body": "@user463035818 so you think the cause is warning suppression?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542203308, "post_id": 53301496, "comment_id": 93484011, "body": "the symptom is that a warning is surpressed, what is the cause i have no clue ;)"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1542203374, "post_id": 53301496, "comment_id": 93484061, "body": "@YSC in that case, no such <code>#undef</code> exists. However, <code>#ifdef __GNUC__ #define SSH_DEPRECATED __attribute__ ((deprecated)) #else #define SSH_DEPRECATED #endif</code> so, could that change something?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 2, "creation_date": 1542203385, "post_id": 53301496, "comment_id": 93484069, "body": "Just so I understood: You have two compilation units in individual compiler invocations, using identical <code>libssh.h</code> (except for path) and identical compiler options, both using the deprecated function, but only one giving the warning? In that case the exact compiler command line and MCVEs of the two compilation units would be helpful."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1542203540, "post_id": 53301496, "comment_id": 93484174, "body": "After resolving the 1st error with the -Werror removal trick and clean build, I got the same error on the 2nd module... :-( I&#39;m deleting the question in a few minutes. Thanks for all your input guys!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10605163"}, "edited": false, "score": 0, "creation_date": 1542203649, "post_id": 53301496, "comment_id": 93484255, "body": "Your build system may also be filtering the output or messing with compiler flags."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1542205422, "post_id": 53301496, "comment_id": 93485428, "body": "If you expect your post to be read by actual people, then I suggest you don&#39;t do something ghastly like striking through the whole of the text you still refer too!"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1542205585, "post_id": 53301496, "comment_id": 93485543, "body": "I don&#39;t want a reader to read the original too much, only as a reference, and even that is not required as I tried to explain the case shortly in the 3 lines of text I did not strikthrough. The reminder of the strikthroug text was for those who already read and commented above"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 931, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542205439, "creation_date": 1542202512, "last_edit_date": 1542205439, "question_id": 53301496, "link": "https://stackoverflow.com/questions/53301496/g-does-not-ignore-deprecated-declaration-werror-error-when-using-wno-d", "title": "g++ does not ignore &quot;deprecated-declaration&quot; + &quot;Werror&quot; error when using &quot;-Wno-deprecated&quot;", "body": "<p>The same case from the strikethrough case down here. I have a deprecated function call, and it gives an error. I want to ignore it for now. I can use <code>#undef</code> but I prefer using a <em><code>\"-Wno-deprecated\"</code></em> compilation flag, but for some reason I stil get the same error.</p>\n\n<p>I have two modules with calls to the depracted functoin:</p>\n\n<pre><code>SSH_DEPRECATED LIBSSH_API int ssh_get_pubkey_hash(ssh_session session, unsigned char **hash);\n// SSH_DEPRECATED == __attribute__ ((deprecated))\n// as can be seen from:\n//   #define SSH_DEPRECATED __attribute__ ((deprecated))\n</code></pre>\n\n<p>Module <strong>A</strong> (the errornous module) ouputs a \"is depracted\" warning made error. I assumed the reason I saw only one error was because the compilation flags of <strong>A</strong> included <code>-Werror</code>. However, both of the modules include the same flag.</p>\n\n<p>However, module <strong>B</strong> has something different. <strong>A</strong> includes <code>libssh.h</code> from <em><code>arm-buidroot-linux-gnueabi</code></em> where <strong>B</strong> includes that <code>libssh.h</code> and another copy of <code>libssh.h</code> (I assume the 2nd copy is a copy-paste of an older version of <code>libssh.h</code>).</p>\n\n<p>I assumed that the <code>SSH_DEPRECATED</code> does not appear on the 2nd <code>libssh.h</code>, but I was wrong, so now I'm not what could be the reason.</p>\n\n<p>Currently I got it to work by removing the <em><code>-Werror</code></em> in <strong>A</strong>, but this is bad since:</p>\n\n<ol>\n<li>I don't know what is the root cause (i.e. how come it works in <strong>B</strong>)</li>\n<li>I do want that flag [<em><code>-Werror</code></em>] (this can be solved by adding <em><code>-Wno-deprecated\n</code></em> and then returning the <em><code>-Werror</code></em>, but I don't think of it as a good solution. More like a hack)</li>\n</ol>\n\n<p><strong>My question:</strong> What in <strong>A</strong> can cause this deprecated warning that does not apply in <strong>B</strong>?</p>\n\n<p><em>Using <code>powerpc-linux-gnu-g++ (Sourcery G++ Lite 4.3-74) 4.3.2</code></em></p>\n\n<p>Note: I know that <em><a href=\"https://en.cppreference.com/w/cpp/language/attributes/deprecated\" rel=\"nofollow noreferrer\"><strong>deprecated</strong> Indicates that the name or entity declared with this attribute is deprecated, that is, the use is allowed, but discouraged for some reason.</a></em> </p>\n"}, {"tags": ["c++", "c", "interrupt", "stm32f7"], "comments": [{"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542203196, "post_id": 53301251, "comment_id": 93483923, "body": "Consider usage of serial audio interface (<code>SAI</code>) in slave mode with <code>PCM&#47;DSP</code> frames (use <code>ADC</code> <code>DRDY</code> as <code>FS</code>). You can use two <code>SAI</code> channels (2*24 bit slots per channel) if <code>ADC</code> can out samples via DATA0 and DATA1."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "reply_to_user": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542207606, "post_id": 53301251, "comment_id": 93486892, "body": "@ReAl - I&#39;m reading DATA),1,2,3 simultaneously. And it&#39;s piped in at 20MHz. Not sure SAI can handle that. Thanks though!"}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542209107, "post_id": 53301251, "comment_id": 93487840, "body": "SAI has two 1-bit channels. One&#39;s can connect in parallel frame start (<code>FS</code>) and clock inputs while use data inputs separately, so SAI can receive maximum two data streams from ADC."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "reply_to_user": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542211165, "post_id": 53301251, "comment_id": 93489193, "body": "@ReAl, as I indicated before, I have four data inputs to read simultaneously - Data0, Data1, Data2, and Data3. I also have the data clock to follow. It wouldn&#39;t work. We explored that already. Thanks Though!"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 0, "creation_date": 1542317347, "post_id": 53301251, "comment_id": 93536668, "body": "@JediEngineer There are 2 SAI controllers with 2 channels each"}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1542232929, "last_edit_date": 1542232929, "creation_date": 1542211069, "answer_id": 53304190, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling/53304190#53304190", "title": "STM32F767ZI External Interrupt Handling", "body": "<p>There's a startup file generated before compile: <code>startup_stm32f767xx.s</code> - which contains all the pointers to functions. </p>\n\n<p>Under the marker <code>g_pfnVectors:</code> is  <code>.word  NMI_Handler</code> pointing to a function for handling the non-masked interrupts, and two other pointers, <code>.word     EXTI0_IRQHandler</code> and  <code>.word     EXTI1_IRQHandler</code> as vectors to the external interrupt handlers. Further down in the same file, is the following compiler directives:</p>\n\n<pre><code>.weak      NMI_Handler  \n.thumb_set NMI_Handler,Default_Handler\n\n.weak      EXTI0_IRQHandler         \n.thumb_set EXTI0_IRQHandler,Default_Handler\n\n.weak      EXTI1_IRQHandler         \n.thumb_set EXTI1_IRQHandler,Default_Handler  \n</code></pre>\n\n<p>This was the info I was looking for to be able to control my interrupts with more precision and fewer clock cycles.</p>\n"}, {"comments": [{"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542304207, "post_id": 53309362, "comment_id": 93530921, "body": "@berebdi - thanks for the input. I just arrived at a similar conclusion a few moments ago (with respect to timing). I was unsure of handling the data with the Nucleo SPI channel - I&#39;m going to set that up as you suggested. That makes sense considering that the output appears to be basically a SPI interface. With respect to that - DRDY rises and falls within the n-1 clock cycle with respect to data - that shouldn&#39;t make a difference with the SPI input, right? Furthermore, can 4 SPI channels read in data at once? The ADC clocks out all 4 channels at the same time..."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542312315, "post_id": 53309362, "comment_id": 93534659, "body": "@JediEngineer Yes, it could be a problem. Looking at the SPI timing diagram in the STM32F767 datasheet, it needs tsu(NSS)=4*Tpclk NSS setup time, that is about 37 ns @ 108MHz APB2 clock, but on the transmitting side, the delay between DRDY falling and DCLK rising is 0 to 4.5 ns. So it will miss the first bit. But I have another idea..."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542367782, "post_id": 53309362, "comment_id": 93552648, "body": "I looked into the DFSDM - it doesn&#39;t look like I can use it without the filters... from what I&#39;m seeing. But I&#39;ll keep it on hand as a second option. For the time being, I was able to get a reduction in DCLK speed to 2.5MHz, giving me about 84 clock cycles to extract my data. That should be plenty. I&#39;ll be reducing code to increase speed, and maybe we&#39;ll work with the DFSDM as well, but it&#39;s a start for now."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542378191, "post_id": 53309362, "comment_id": 93558287, "body": "@JediEngineer DFSDM filters can be bypassed, see the description of the <code>DFSDM_FLTxFCR</code> register, and it can be somehow synchronized to <code>EXTI14</code> or <code>EXTI15</code>, so that&#39;s where <code>DRDY</code> should go."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 3, "last_activity_date": 1542318049, "last_edit_date": 1542318049, "creation_date": 1542232758, "answer_id": 53309362, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling/53309362#53309362", "title": "STM32F767ZI External Interrupt Handling", "body": "<blockquote>\n  <p>10 clock cycles to do what I need to... moving data should only take me 1-2 clock cycles, leaving me 8 to handle interrupts...</p>\n</blockquote>\n\n<p>No way. Interrupt entry (pushing registers, fetching the vector and filling the pipeline) takes 10-12 cycles even on a Cortex-M7. Then consider a very simple interrupt handler, just moving the input data bits to a buffer and clearing the interrupt flag:</p>\n\n<pre><code>uint32_t *p;\nvoid handler(void) {\n    *p++ = GPIOA-&gt;IDR;\n    EXTI-&gt;PR = 0x10;\n}\n</code></pre>\n\n<p>it gets translated to something like this</p>\n\n<pre><code>handler:\n    ldr     r0, .addr_of_idr // load &amp;GPIOA-&gt;IDR\n    ldr     r1, [r0]         // load GPIOA-&gt;IDR\n    ldr     r2, .addr_ofr_p  // load &amp;p\n    ldr     r3, [r2]         // load p\n    str     r1, [r3]         // store the value from IDR to *p\n    adds    r3, r3, #4       // increment p\n    str     r3, [r2]         // store p\n    ldr     r0, .addr_of_pr  // load &amp;EXTI-&gt;PR\n    movs    r1, #0x10\n    str     r1, [r0]         // store 0x10 to EXTI-&gt;PR\n    bx      lr\n.addr_of_p:\n    .word   p\n.addr_of_idr\n    .word   0x40020010\n.addr_of_pr\n    .word   0x40013C14\n</code></pre>\n\n<p>So it's 11 instructions, each taking at least one cycle, <em>after</em> interrupt entry. That's assuming the code, vector table, and the stack are all in the fastest RAM region. I'm not sure whether literal pools work in ITCM at all, using immediate literals would add 3 more cycles. Forget it.</p>\n\n<p><strong>This has to be solved with hardware.</strong></p>\n\n<p>The controller has 6 SPI interfaces, pick 4 of them. Connect <code>DRDY</code> to all four <code>NSS</code> pins, <code>DCLK</code> to all <code>SCK</code> pins, and each <code>DOUT</code> pin to one <code>MISO</code> pin. Now each SPI interface handles a single channel, and can collect up to 32 bits in its internal FIFO.</p>\n\n<p>Then I'd set an interrupt on a rising edge on one of the <code>NSS</code> pins (<code>EXTI</code> still works even if the pin is in alternate function mode), and read all data at once.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>It turns out that the STM32 SPI requres an inordinate amount of delay between <code>NSS</code> falling and <code>SCK</code> rising, which the AD7768 does not provide, so it will not work.</p>\n\n<h1>Sigma-Delta interface</h1>\n\n<p>The STM32F767 has a DFSDM peripheral, designed to receive data from external ADCs. It can receive up to 8 channels of serial data with 20 MHz, and it can even do some preprocessing that your application might need.</p>\n\n<p>The problem is that the DFSDM has no <code>DRDY</code> input, I don't exactly know how could the data transfer be synchronized. It might work by asserting the <code>START#</code> singal to reset the communication.</p>\n\n<p>If that doesn't work, then you can try starting the DFSDM channels using a timer and DMA. Connect <code>DRDY</code> to the external trigger of <code>TIM1</code> or <code>TIM8</code> (other timers won't work, because they are connected to the slower APB1 bus and the other DMA controller), start it on the rising edge of <code>ETR</code>, and let it generate a DMA request after ~20 ns. Then let the DMA write the value needed to start the channel to the DFSDM channel configuration register. Repeat for the oher three channels.</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "is_accepted": false, "score": 0, "last_activity_date": 1542400034, "creation_date": 1542400034, "answer_id": 53344909, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling/53344909#53344909", "title": "STM32F767ZI External Interrupt Handling", "body": "<p>I readed AD7768 DS more carefully and found that it can srnd four channels data to one DOUT pin. So, I talking again about serial audio interface (<code>SAI</code>).</p>\n\n<p>If you can lower <code>DCLK</code> frequency up to 2.5MHz than you can lower sample with ratio 1:8 (as ratio 2.5 MHz to 20 MHz) irt sample rate at full ADC clock.</p>\n\n<p>If you route all 4 channels to one output DOUT0 you slow down sample rate just in ratio 1:4.</p>\n\n<p><a href=\"https://www.analog.com/media/en/technical-documentation/data-sheets/ad7768-7768-4.pdf\" rel=\"nofollow noreferrer\">AD7768-4 DS</a></p>\n\n<p>page 53</p>\n\n<blockquote>\n  <p>On the AD7768, the interface can be configured to output conversion\n  data on one, two, or eight of the DOUTx pins. The DOUTx configuration\n  for the AD7768 is selected using the FORMATx pins (see Table 33).</p>\n</blockquote>\n\n<p>page 66 table 34: (for AD7768-4)\npage 67 figure 98:</p>\n\n<blockquote>\n  <p><code>FORMAT0 = 1</code> All channels output on the DOUT0 pin, in TDM output. Only DOUT0 is in use.</p>\n</blockquote>\n\n<p>You can use <code>SAI</code> with <code>FS</code> = <code>DRDY</code> and four slots, 32 bits/slot</p>\n"}], "owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1542626864, "creation_date": 1542201751, "last_edit_date": 1542626864, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling", "title": "STM32F767ZI External Interrupt Handling", "body": "<p>I'm attempting to create a proper SPI slave interface for an AD7768-4 ADC. The ADC has a SPI interface, but it doesn't output the conversions via SPI. Instead, there are data outputs that are clocked out on individual GPIO pins. So I basically need to bit-bang data, and output to SPI to get a proper slave SPI interface. Please don't ask why I'm doing it this way, it was assigned to me. </p>\n\n<p>The issue I'm having is with the interrupts. I'm using the STM32F767ZI processor - it runs at 216 MHz, and my ADC data MUST BE clocked out at 20MHz. I've set up my NMIs but what I'm not seeing is where the system calls or points to the interrupt handler.  </p>\n\n<p>I used the STMCubeMX software to assign pins and generate the setup code, and in the <code>stm32F7xx.c</code> file, it shows the <code>NMI_Handler()</code> function, but I don't see a pointer to it anywhere in the system files. I also found void <code>HAL_GPIO_EXTI_IRQHandler()</code> function in <code>STM32F7xx_hal_gpio.c</code>, which appears to check if the pin is asserted, and clears any pending bits, but it doesn't reset the interrupt flag, or check it, and again, I see no pointer to this function. </p>\n\n<p>To more thoroughly complicate things, I have 10 clock cycles to determine which flag is set (1 of two at a time), reset it, incerment a variable, and move data from the GPIO registers. I believe this is possible, but again, I'm uncertain of what the system is doing as soon as the interrupt is tripped. </p>\n\n<p>Does anyone have any experience in working with external interrupts on this processor that could shed some light on how this particular system handles things? Again - 10 clock cycles to do what I need to... moving data should only take me 1-2 clock cycles, leaving me 8 to handle interrupts... </p>\n\n<p>EDIT:</p>\n\n<p>We changed the DCLK speed to 5.12 MHz (20.48 MHz MCLK/4) because at 2.56 MHz we had exactly 12.5 microseconds to pipe data out and set up for the next DRDY pulse, and 80 kHz speed gives us exactly zero margin. At 5.12 MHz, I have 41 clock cycles to run the interrupt routine, which I can reduce slightly if I skip checking the second flag and just handle incoming data. But I feel I must use the DRDY flag check at least, and use the routine to enable the second interrupt otherwise I'll be constantly interrupting because DCLK on the ADC is always running. This allows me 6.12 microseconds to read in the data, and 6.25 microseconds to shuffle it out before the next DRDY pulse. I should be able to do that at 32 MHz SPI clock (slave) but will most likely do it at 50MHz. This is my current interrupt code:  </p>\n\n<pre><code>void NMI_Handler(void)\n{\n    if(__HAL_GPIO_EXTI_GET_IT(GPIO_PIN_0) != RESET)         \n     {\n         count = 0;                                             \n         __HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_0);                  \n         HAL_GPIO_EXTI_Callback(GPIO_PIN_0);                        \n         //     __HAL_GPIO_EXTI_CLEAR_FLAG(GPIO_PIN_0);             \n\n         HAL_NVIC_EnableIRQ(GPIO_PIN_1);                            \n     }  \n    else\n  {  \n        if(__HAL_GPIO_EXTI_GET_IT(GPIO_PIN_1) != RESET)         \n          {\n             data_pad[count] = GPIOF-&gt;IDR;                      \n             count++;                                           \n             if (count == 31)\n              {\n                data_send = !data_send;                     \n                HAL_NVIC_DisableIRQ(GPIO_PIN_1);            \n              }\n        __  HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_1);         \n        HAL_GPIO_EXTI_Callback(GPIO_PIN_1); \n//      __HAL_GPIO_EXTI_CLEAR_FLAG(GPIO_PIN_0); \n          }\n   }\n}  \n</code></pre>\n\n<p>I am still concerned about clock cycles, and I believe I can get away with only checking the DRDY flag if I operate on the presumption that the only other EXTI flag that will trip is for the clock pin. Although I question how this will work if SYS_TICK is running in the background... I'll have to find out.    </p>\n\n<p>We're investigating a faster processor to handle the bit-banging, but right now, it looks like the PI3 won't be able to handle it if it's running Linux, and I'm unaware of too many faster processors that run either a very small reliable RTOS, or can be bare metal programmed in a pinch...</p>\n"}, {"tags": ["python", "c++", "swig"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542201871, "post_id": 53301146, "comment_id": 93483054, "body": "Debug the call that fails? I suppose there is some Python somewhere? Where is it?"}, {"owner": {"reputation": 817, "user_id": 1458214, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/8fbcbee5a048a57912d694dc7dd1970e?s=128&d=identicon&r=PG", "display_name": "robby987", "link": "https://stackoverflow.com/users/1458214/robby987"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542202141, "post_id": 53301146, "comment_id": 93483215, "body": "No python at this point, it&#39;s for passing a pointer into python so it can be used in the embedded interpreter. The code works on Linux / Mac and did using previous version of windows."}, {"owner": {"reputation": 817, "user_id": 1458214, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/8fbcbee5a048a57912d694dc7dd1970e?s=128&d=identicon&r=PG", "display_name": "robby987", "link": "https://stackoverflow.com/users/1458214/robby987"}, "edited": false, "score": 0, "creation_date": 1542202251, "post_id": 53301146, "comment_id": 93483280, "body": "Both the instance and pTypeInfo pointers are ok. The last argument is for flags, which should be set to 0"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1545224350, "post_id": 53301146, "comment_id": 94550846, "body": "On Windows, I <code>#undef _DEBUG</code> before including <code>Python.h</code> and explicitly link to the release version of Python37. Your errors may be related to debug/release linking of python libraries"}], "answers": [{"tags": [], "owner": {"reputation": 817, "user_id": 1458214, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/8fbcbee5a048a57912d694dc7dd1970e?s=128&d=identicon&r=PG", "display_name": "robby987", "link": "https://stackoverflow.com/users/1458214/robby987"}, "is_accepted": true, "score": 0, "last_activity_date": 1542310278, "creation_date": 1542310278, "answer_id": 53326711, "question_id": 53301146, "link": "https://stackoverflow.com/questions/53301146/swig-generating-c-python3-wrapper-in-windows-causes-assertion-msvc-2017/53326711#53326711", "title": "SWIG Generating C++ Python3 wrapper in Windows causes assertion MSVC 2017", "body": "<p>To resolve this issue, I needed to downgrade from Python3.7 to Python3.6</p>\n"}, {"tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1561159973, "creation_date": 1561159973, "answer_id": 56711467, "question_id": 53301146, "link": "https://stackoverflow.com/questions/53301146/swig-generating-c-python3-wrapper-in-windows-causes-assertion-msvc-2017/56711467#56711467", "title": "SWIG Generating C++ Python3 wrapper in Windows causes assertion MSVC 2017", "body": "<p>Or upgrade to SWIG 4.0, which has a <a href=\"https://github.com/swig/swig/issues/1321\" rel=\"nofollow noreferrer\">fix</a>.</p>\n"}], "owner": {"reputation": 817, "user_id": 1458214, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/8fbcbee5a048a57912d694dc7dd1970e?s=128&d=identicon&r=PG", "display_name": "robby987", "link": "https://stackoverflow.com/users/1458214/robby987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 2, "accepted_answer_id": 53326711, "answer_count": 2, "score": 2, "last_activity_date": 1561159973, "creation_date": 1542201391, "last_edit_date": 1542205513, "question_id": 53301146, "link": "https://stackoverflow.com/questions/53301146/swig-generating-c-python3-wrapper-in-windows-causes-assertion-msvc-2017", "title": "SWIG Generating C++ Python3 wrapper in Windows causes assertion MSVC 2017", "body": "<p>Using SWIG to generate a wrapper around a C++ class is causing a strange assertion at run-time: </p>\n\n<pre><code>Assertion failed!\n\nProgram: C:\\Python37\\python37_d.dll\nFile: c:\\_work\\4\\s\\objects\\typeobject.c\nLine: 3634\n\nExpression: PyTuple_Check(args)\n\nFor information on how your program can cause an assertion\nfailure, see the Visual C++ documentation on asserts\n\n(Press Retry to debug the application - JIT must be enabled)\n</code></pre>\n\n<p>If ignore is clicked on the dialogue that pops up, everything seems to work fine. </p>\n\n<p>I've created an example program to try replicate the problem and have experienced the same issue:</p>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"testwrapper.h\"\n\n#pragma push_macro(\"slots\")\n#undef slots\n#include \"Python.h\"\n#pragma pop_macro(\"slots\")\n\n#include \"SwigModules/generated/swig_runtime.h\"\n\nPyObject * ConvertToWrapper(SwigInterface * instance)\n{\n    swig_type_info * pTypeInfo = SWIG_TypeQuery(\"SwigInterface *\");\n    PyObject* obj = SWIG_NewPointerObj(instance, pTypeInfo, 0); &lt;- issue occurs here\n    return obj;\n}\n\nTestWrapper * wrapper = new TestWrapper();\n\nvoid TestSwig()\n{\n  Py_Initialize();\n  PyRun_SimpleString(\"import test_module\");\n  ConvertToWrapper(wrapper);\n  Py_Finalize();\n}\n\nint main(int argc, char *argv[])\n{\n  TestSwig();\n  return 0;\n}\n</code></pre>\n\n<p>testwrapper.h</p>\n\n<pre><code>#pragma once\n#include \"swiginterface.h\"\n\nclass TestWrapper : public  SwigInterface\n{\npublic:\n  TestWrapper(){}\n  virtual ~TestWrapper(){}\n  virtual void Test();\n};\n</code></pre>\n\n<p>swiginterface.h</p>\n\n<pre><code>#pragma once\n\nclass SwigInterface\n{\npublic:\n  virtual ~SwigInterface(){}\n  virtual void Test() = 0;\n};\n</code></pre>\n\n<p>test_module.i (swig interface file)</p>\n\n<pre><code>%module test_module\n\n%{\n#include \"../swiginterface.h\"\n%}\n\n%include \"../SwigInterface.h\"\n\n%inline %{\n  SwigInterface * test;\n%}\n</code></pre>\n\n<p>setup_function (python)</p>\n\n<pre><code>from distutils.core import setup, Extension\nsetup(name=\"test_module\",\n      py_modules=['test_module'],\n      ext_modules=[Extension(\"_test_module\",\n                     [\"test_module.i\"],\n                     extra_compile_args=[\"-DSWIG_TYPE_TABLE=test_module\"],\n                     swig_opts=[\"-c++\", \"-py3\"],\n                  )])\n</code></pre>\n\n<p>Function in swig_runtime.h where issue occurs:</p>\n\n<pre><code>SWIGRUNTIME PyObject* \nSWIG_Python_NewShadowInstance(SwigPyClientData *data, PyObject *swig_this)\n{\n#if (PY_VERSION_HEX &gt;= 0x02020000)\n  PyObject *inst = 0;\n  PyObject *newraw = data-&gt;newraw;\n  if (newraw) {\n    inst = PyObject_Call(newraw, data-&gt;newargs, NULL);\n    if (inst) {\n#if !defined(SWIG_PYTHON_SLOW_GETSET_THIS)\n      PyObject **dictptr = _PyObject_GetDictPtr(inst);\n      if (dictptr != NULL) {\n    PyObject *dict = *dictptr;\n    if (dict == NULL) {\n      dict = PyDict_New();\n      *dictptr = dict;\n      PyDict_SetItem(dict, SWIG_This(), swig_this);\n    }\n      }\n#else\n      PyObject *key = SWIG_This();\n      PyObject_SetAttr(inst, key, swig_this);\n#endif\n    }\n  } else {\n#if PY_VERSION_HEX &gt;= 0x03000000\n    inst = ((PyTypeObject*) data-&gt;newargs)-&gt;tp_new((PyTypeObject*) data-&gt;newargs, Py_None, Py_None); //&lt;----- HERE\n    if (inst) {\n      PyObject_SetAttr(inst, SWIG_This(), swig_this);\n      Py_TYPE(inst)-&gt;tp_flags &amp;= ~Py_TPFLAGS_VALID_VERSION_TAG;\n    }\n#else\n    PyObject *dict = PyDict_New();\n    if (dict) {\n      PyDict_SetItem(dict, SWIG_This(), swig_this);\n      inst = PyInstance_NewRaw(data-&gt;newargs, dict);\n      Py_DECREF(dict);\n    }\n#endif\n  }\n  return inst;\n</code></pre>\n\n<p>I've tried this with multiple versions of SWIG and all result the same. It loads the module no problem, both into the C++ code and into an external python interpreter. How do I go about debugging / fixing this issue?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 1111, "user_id": 8527313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8815a9f0576bde3d9822a630bc01aec4?s=128&d=identicon&r=PG&f=1", "display_name": "Qubit", "link": "https://stackoverflow.com/users/8527313/qubit"}, "edited": false, "score": 1, "creation_date": 1542201675, "post_id": 53301135, "comment_id": 93482908, "body": "If you don&#39;t care too much about optimising this from a performance point of view, then simply read the line, process the first character (if you have to), then simply replace all of the <code>&quot;{}&lt;&gt;,&quot;</code> with white-space, pass to a stringstream and read integers into a vector of pairs from that (that&#39;s for the line that starts with <code>E</code>, the line starting with <code>V</code> is simple enough to deal with as-is)."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542202049, "post_id": 53301135, "comment_id": 93483166, "body": "The best way is the one you are comfortable writing and maintaining. The best way is the simplest and clearest to read. The best way is the one that doesn&#39;t prematurely optimize. The best way is one that accounts for error conditions appropriate for the program&#39;s intended purpose."}], "owner": {"reputation": 756, "user_id": 7789910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9rpLE.png?s=128&g=1", "display_name": "Karim Pazoki", "link": "https://stackoverflow.com/users/7789910/karim-pazoki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542201370, "creation_date": 1542201370, "question_id": 53301135, "link": "https://stackoverflow.com/questions/53301135/reading-the-string-line-of-input-and-use-the-numbers-in-them-as-integer-in-c", "title": "Reading the string line of input and use the numbers in them as integer in c++", "body": "<p>As the example below indicates, one kind of input is the specification of a set of vertices V, and set of edges E of the undirected graph. The specification of a set of vertices starts with \u2019V\u2019, followed by a space, followed by a positive integer, all in one single line. If the integer that follows the V is i, then we assume that the vertices are identified by 0, . . . , i \u2212 1. The specification for a set of edges starts with \u2019E\u2019. It then has a space, followed by the set of edges in a single line delimited by \u2019{\u2019 and \u2019}\u2019. The two vertices of an edge are delimited by \u2019&lt;\u2019 and \u2019>\u2019 and separated by a comma. The edges in the set are also separated by a comma. There are no whitespace characters within the { }.</p>\n\n<pre><code>V 5\nE {&lt;0,4&gt;,&lt;4,1&gt;,&lt;0,3&gt;,&lt;3,4&gt;,&lt;3,2&gt;,&lt;1,3&gt;}\n</code></pre>\n\n<p>My question is What is the best way to read this input?\nOne way is to read each line as an string and split it. then convert them to int. is there any other better way to read these kind of input in c++ in standard input?</p>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 43107, "user_id": 3953764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd168106a67cbd805c107cba3252caa?s=128&d=identicon&r=PG", "display_name": "Piotr Skotnicki", "link": "https://stackoverflow.com/users/3953764/piotr-skotnicki"}, "edited": false, "score": 10, "creation_date": 1542201223, "post_id": 53301064, "comment_id": 93482607, "body": "<code>{1,2,3}</code> is not an array, it&#39;s an initialization list. <code>int arr[]</code> is not an array, it&#39;s a pointer to <code>int</code>"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1542201290, "post_id": 53301064, "comment_id": 93482644, "body": "Where is the size of your array?"}, {"owner": {"reputation": 7413, "user_id": 304974, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c0bad048f40991e627962d8341092b1d?s=128&d=identicon&r=PG", "display_name": "Programmer", "link": "https://stackoverflow.com/users/304974/programmer"}, "edited": false, "score": 1, "creation_date": 1542201362, "post_id": 53301064, "comment_id": 93482703, "body": "How can we initialize a vector using initialization list? The vector needs to be initialized by the initialization list passed as aruments"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1542201479, "post_id": 53301064, "comment_id": 93482771, "body": "Can you clarify in your question if you need to initialize the vector from an <i>array</i> or from an <i>initialization_list</i>?"}, {"owner": {"reputation": 7413, "user_id": 304974, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c0bad048f40991e627962d8341092b1d?s=128&d=identicon&r=PG", "display_name": "Programmer", "link": "https://stackoverflow.com/users/304974/programmer"}, "edited": false, "score": 1, "creation_date": 1542201588, "post_id": 53301064, "comment_id": 93482853, "body": "Sorry I was unaware of initialization_list - I was assuming it to be an array"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542202437, "post_id": 53301064, "comment_id": 93483416, "body": "you want the code in your question fixed and array was just a misunderstanding? In that case the title needs to be fixed. Its not your fault to have a wrong title (often thats part of knowing the answer), but for future readers it is an annoyment to have misleading titles"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1542202494, "post_id": 53301064, "comment_id": 93483449, "body": "maybe &quot;how to initialize vector member from list of values?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7413, "user_id": 304974, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c0bad048f40991e627962d8341092b1d?s=128&d=identicon&r=PG", "display_name": "Programmer", "link": "https://stackoverflow.com/users/304974/programmer"}, "edited": false, "score": 1, "creation_date": 1542201503, "post_id": 53301124, "comment_id": 93482789, "body": "Thanks it solves the issue - &quot;by value&quot; I assume it meant that remove the reference  const arr?"}], "tags": [], "owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": true, "score": 5, "last_activity_date": 1542201556, "last_edit_date": 1542201556, "creation_date": 1542201316, "answer_id": 53301124, "question_id": 53301064, "link": "https://stackoverflow.com/questions/53301064/c-how-to-initialize-vector-member-from-list-of-values/53301124#53301124", "title": "C++ how to initialize vector member from list of values", "body": "<p>I would just use a <code>std::initializer_list</code> since that's what you're already passing</p>\n\n<pre><code>A(std::initializer_list&lt;int&gt; arr) : mvec(arr)\n{\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1542202456, "post_id": 53301307, "comment_id": 93483424, "body": "If you were initializing a <code>std::array</code>, may as well take a <code>std::array</code> as a parameter, no?"}, {"owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1542202574, "post_id": 53301307, "comment_id": 93483504, "body": "@StoryTeller, sure. But OP took C-style array, and so did I."}], "tags": [], "owner": {"reputation": 20722, "user_id": 1625187, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6vWOZ.jpg?s=128&g=1", "display_name": "Evg", "link": "https://stackoverflow.com/users/1625187/evg"}, "is_accepted": false, "score": 4, "last_activity_date": 1542202322, "last_edit_date": 1542202322, "creation_date": 1542201911, "answer_id": 53301307, "question_id": 53301064, "link": "https://stackoverflow.com/questions/53301064/c-how-to-initialize-vector-member-from-list-of-values/53301307#53301307", "title": "C++ how to initialize vector member from list of values", "body": "<p>If for some reason you really want to initialize a vector using a C-style array and not <code>std::initializer_list</code>, you can do it using additional level of indirection:</p>\n\n<pre><code>struct A {\n    template&lt;std::size_t n&gt;\n    A(const int (&amp;arr)[n]) :\n        A(arr, std::make_index_sequence&lt;n&gt;{})\n    { }\n\n    template&lt;std::size_t... is&gt;\n    A(const int (&amp;arr)[sizeof...(is)], std::index_sequence&lt;is...&gt;) :\n        mvec{arr[is]...}\n    { }\n\n    std::vector&lt;int&gt; mvec;\n};\n\nA a({1, 2, 3});\n</code></pre>\n\n<p><strong>Edit.</strong> As <strong>Fran\u00e7ois Andrieux</strong> pointed in the comment, <code>std::vector</code> can be initialized using a pair of iterators, so the constructor simplifies to:</p>\n\n<pre><code>template&lt;std::size_t n&gt;\nA(const int (&amp;arr)[n]) : mvec(arr, arr + n)\n{ }\n</code></pre>\n\n<p>But if you were initializing, e.g., <code>std::array</code> instead of <code>std::vector</code>, <code>index_sequence</code> trick seems to be unavoidable.</p>\n"}], "owner": {"reputation": 7413, "user_id": 304974, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c0bad048f40991e627962d8341092b1d?s=128&d=identicon&r=PG", "display_name": "Programmer", "link": "https://stackoverflow.com/users/304974/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 53301124, "answer_count": 2, "score": 4, "last_activity_date": 1542206209, "creation_date": 1542201139, "last_edit_date": 1542206209, "question_id": 53301064, "link": "https://stackoverflow.com/questions/53301064/c-how-to-initialize-vector-member-from-list-of-values", "title": "C++ how to initialize vector member from list of values", "body": "<p>I am trying to initialize a vector member variable with an array of integers:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\nstruct A\n{\n    A(int arr[]) : mvec(arr)\n    { }\n    std::vector&lt;int&gt; mvec;\n};\n\nint main()\n{\n    A s({1,2,3});\n}\n</code></pre>\n\n<p>Compilation gives me error :</p>\n\n<pre><code>$ c++ -std=c++11 try59.cpp\n\ntry59.cpp:15:12: note: candidates are:\ntry59.cpp:6:1: note: A::A(int*)\n A(int arr[]) : mvec(arr)\n</code></pre>\n\n<p>How can I initialize my vector using an array of integers?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1542200997, "post_id": 53301000, "comment_id": 93482458, "body": "You have out of bounds array access. This is Undefined Behaviour and may (or may not) result in what you observed."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 5, "creation_date": 1542201050, "post_id": 53301000, "comment_id": 93482490, "body": "&quot;in a [3][3] array&quot; - Your array is not 3x3, it&#39;s 2x2."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542201156, "post_id": 53301000, "comment_id": 93482560, "body": "You have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a> as you go out of bounds of the arrays you have. The number when you declare an array is not the top index, it&#39;s the number of elements."}, {"owner": {"reputation": 406, "user_id": 8806969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a397c6039334c3579a59073d340ceb8a?s=128&d=identicon&r=PG&f=1", "display_name": "IcedLance", "link": "https://stackoverflow.com/users/8806969/icedlance"}, "edited": false, "score": 0, "creation_date": 1542201215, "post_id": 53301000, "comment_id": 93482595, "body": "For starters your array is 2x2, meaning  array.0.2 is technically out of bounds, but by magic of allocation is pointing at array.1.0. Array.1.2 is outside allocated space and its behavior is undefined."}, {"owner": {"reputation": 15, "user_id": 9374491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5cig.png?s=128&g=1", "display_name": "sanchit verma", "link": "https://stackoverflow.com/users/9374491/sanchit-verma"}, "reply_to_user": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1542201282, "post_id": 53301000, "comment_id": 93482639, "body": "@Yksisarvinen how do i repair this?"}, {"owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "edited": false, "score": 2, "creation_date": 1542201406, "post_id": 53301000, "comment_id": 93482729, "body": "Your confusion probably originates from: <code>array[2]</code> calls the <i>third</i> element but creating an <code>array[2]</code> will give you 2 Elements of size."}, {"owner": {"reputation": 15, "user_id": 9374491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5cig.png?s=128&g=1", "display_name": "sanchit verma", "link": "https://stackoverflow.com/users/9374491/sanchit-verma"}, "reply_to_user": {"reputation": 406, "user_id": 8806969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a397c6039334c3579a59073d340ceb8a?s=128&d=identicon&r=PG&f=1", "display_name": "IcedLance", "link": "https://stackoverflow.com/users/8806969/icedlance"}, "edited": false, "score": 0, "creation_date": 1542201413, "post_id": 53301000, "comment_id": 93482733, "body": "@IcedLance don&#39;t arrays start from 0?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542201509, "post_id": 53301000, "comment_id": 93482793, "body": "@sanchitverma yes, valid indexes for an <code>int foo[2]</code> are <code>foo[0]</code> and <code>foo[1]</code> but not <code>foo[2]</code>."}, {"owner": {"reputation": 406, "user_id": 8806969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a397c6039334c3579a59073d340ceb8a?s=128&d=identicon&r=PG&f=1", "display_name": "IcedLance", "link": "https://stackoverflow.com/users/8806969/icedlance"}, "edited": false, "score": 0, "creation_date": 1542201749, "post_id": 53301000, "comment_id": 93482963, "body": "When accessing elements, indexes start at 0, but when declaring you write the number of elements(length). So for &quot;int arr[3]&quot; there will be 3 elements with indexes 0, 1, 2."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 2, "last_activity_date": 1542202233, "last_edit_date": 1542202233, "creation_date": 1542201374, "answer_id": 53301138, "question_id": 53301000, "link": "https://stackoverflow.com/questions/53301000/c-copies-parts-of-2d-array/53301138#53301138", "title": "c++ copies parts of 2d array", "body": "<p>If you want to access up to <code>array[2][2]</code> your array has to be defined as <code>char array[3][3];</code>.</p>\n\n<p>Valid indexes for an array <code>T foo[SIZE]</code> are <code>0 ... SIZE - 1</code>.</p>\n\n<p>Please note that <code>array</code> is a very bad name since there is also <code>std::array&lt;&gt;</code> and you are using <code>using namespace std;</code> which will spill out all symbols from the namespace std into the global namespace.</p>\n\n<p>With</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nchar array[3][3];\n\nvoid display()\n{\n    cout &lt;&lt; endl;\n    for (int i = 0; i &lt; 3; i++) {\n        for (int j = 0; j &lt; 3; j++) {\n            cout &lt;&lt; array[i][j];\n        }\n        cout &lt;&lt; endl;\n    }\n}\n\nint main()\n{\n    for (int i = 0; i &lt; 3; i++) {\n        for (int j = 0; j &lt; 3; j++) {\n            array[i][j] = '0';\n        }\n    }\n\n    display();\n    cin &gt;&gt; array[0][2];\n    display();\n}\n</code></pre>\n\n<p>it works as expected:</p>\n\n<p>Output:</p>\n\n<pre><code>000\n000\n000\nA\n\n00A\n000\n000\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9374491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5cig.png?s=128&g=1", "display_name": "sanchit verma", "link": "https://stackoverflow.com/users/9374491/sanchit-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53301138, "answer_count": 1, "score": -2, "last_activity_date": 1542203212, "creation_date": 1542200938, "last_edit_date": 1542203212, "question_id": 53301000, "link": "https://stackoverflow.com/questions/53301000/c-copies-parts-of-2d-array", "title": "c++ copies parts of 2d array", "body": "<p>I have written a big program and it has some unexpected behavior so I've made another smaller program to test the issue.</p>\n\n<p>My problem is that for some reason in a 2x2 array whenever I <code>cin</code> element <code>[0][2]</code>\nit also copies to the element <code>[1][0]</code></p>\n\n<p>For example if my array is</p>\n\n<pre><code>000\n000\n000\n</code></pre>\n\n<p>and I input the top right element to 'A' (say) then the middle left element also changes to 'A' and vice versa.\nThe same issue exists for the elements at <code>[1][2]</code> and <code>[2][0]</code></p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include&lt;iostream&gt;\n\nusing namespace std ;\n\nchar array[2][2];\n\nvoid display()\n{\n    cout&lt;&lt;endl;\n    for (int i=0;i&lt;3;i++ )\n    {\n        for (int j=0;j&lt;3;j++ )\n        {\n            cout&lt;&lt;array[i][j];\n        }\n        cout&lt;&lt;endl;\n    }\n}\n\nint main ()\n{\n    for (int i=0;i&lt;3;i++ )\n    {\n        for (int j=0;j&lt;3;j++ )\n        {\n            array[i][j]='0';\n        }\n    }\n    display();\n    cin&gt;&gt;array[0][2];\n    display();\n}\n</code></pre>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1542199893, "post_id": 53300651, "comment_id": 93481825, "body": "This is pretty confusing. What exactly did you expect <code>m3</code> to do? Also is <code>Matrix</code> self written or from <code>Eigen</code>?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542199939, "post_id": 53300651, "comment_id": 93481858, "body": "Definitely not Eigen, as Eigen will break at compile time. You need to add checks in your expression templates, this should not even compile."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 2, "creation_date": 1542199972, "post_id": 53300651, "comment_id": 93481879, "body": "what does the operator * look like?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1542200152, "post_id": 53300651, "comment_id": 93481989, "body": "There is no way in normal matrix operations for a 1x4 matrix multiplied by a 4x1 matrix to give a 2x2 matrix.    It will (depending on order of operations) give either a 4x4 or a 1x1.    Given a 4x4 matrix, I guess you could specify a transformation to a 2x2."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1542200270, "post_id": 53300651, "comment_id": 93482049, "body": "Storing size information in the type is a very good idea. You just have to adopt initialization and <code>auto</code> instead of pre-declaring your variables. Alternatively, you can use <code>decltype(m1 * m2)</code>."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542200306, "post_id": 53300651, "comment_id": 93482072, "body": "The resulting dimension of a matrix multiplication is well defined, so you can simply write your operator to return the expected type. But no, you can&#39;t convert it to some other matrix type without an appropriate constructor, which in the case of your example would be ludicrous."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1542200387, "post_id": 53300651, "comment_id": 93482110, "body": "I added now the suggested code snippets containing further information."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542200596, "post_id": 53300651, "comment_id": 93482230, "body": "Okay not quite so ludicrous on second read. You could basically create a function to reshape the matrix (you may want two varieties: row-major and column-major). That can be templated and would return an appropriate type to match the assignment."}, {"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542201061, "post_id": 53300651, "comment_id": 93482496, "body": "@paddy, that sounds interesting, however how does one do that? I am also not sure what you mean with shape: My matrix does have the correct shape, just not the right type."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542201378, "post_id": 53300651, "comment_id": 93482715, "body": "<code>m3 = (m1 * m2).reshape&lt;2,2&gt;();</code>"}], "answers": [{"comments": [{"owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "edited": false, "score": 0, "creation_date": 1542201825, "post_id": 53301065, "comment_id": 93483021, "body": "That is basically spot on. I like your suggestion to change the =operator and check, if the assignment is valid. Maybe I did view the problem from the wrong angle: If I create a Matrix like <code>m3</code>, then I already have to know, what it has to look like and what it&#39;s going to do. To me it looks now, I cannot work around the auto OR specific in advance what I expect that is going to happen - how the matrix looks like."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": true, "score": 3, "last_activity_date": 1542201139, "creation_date": 1542201139, "answer_id": 53301065, "question_id": 53300651, "link": "https://stackoverflow.com/questions/53300651/can-one-change-templates-arguments/53301065#53301065", "title": "Can one change templates arguments?", "body": "<p>From your declaration</p>\n\n<pre><code>template &lt;typename T, size_t r, size_t c&gt; //r=rows,c=cols of the Matrix\nclass Matrix {\npublic:\n    template &lt;size_t L&gt;\n    Matrix&lt;T, r, L&gt; operator*(const Matrix&lt;T, c, L&gt; &amp;other) const;\n\n    template &lt;size_t r, size_t c&gt; // BEWARE: shadowing\n    Matrix &amp;operator=(const Matrix&lt;T, r, c&gt; &amp;other);\n\n    // ...\n};\n</code></pre>\n\n<p>we can guess what happens.</p>\n\n<pre><code>Matrix&lt;double, 1, 4&gt; m1(1.2);\nMatrix&lt;double, 4, 1&gt; m2(1.2);\nm1 * m2; // (1)\n</code></pre>\n\n<p><code>(1)</code> calls <code>Matrix&lt;double, 1, 4&gt;::operator*&lt;1&gt;(Matrix&lt;double, 4, 1&gt; const&amp;)</code>. It result has then type <code>Matrix&lt;double, 1, 1&gt;</code>.</p>\n\n<pre><code>Matrix&lt;double, 2, 2&gt; m3;\nm3 = /* (2) */ m1 * m2;\n</code></pre>\n\n<p><code>(2)</code> calls <code>Matrix&lt;double, 2, 2&gt;::operator=&lt;1, 1&gt;(Matrix&lt;double, 1, 1&gt; const&amp;)</code>. This is a problem.</p>\n\n<p>A solution would be to ensure <code>operator=</code> can only be called with another matrix of the <em>right</em> size:</p>\n\n<pre><code>template &lt;typename T, size_t r, size_t c&gt; //r=rows,c=cols of the Matrix\nclass Matrix {\npublic:\n    template &lt;size_t L&gt;\n    Matrix&lt;T, r, L&gt; operator*(Matrix&lt;T, c, L&gt; const&amp; other) const;\n\n    Matrix &amp;operator=(Matrix const&amp; other);\n\n    // ...\n};\n</code></pre>\n\n<p>You could even allow type conversions:</p>\n\n<pre><code>template&lt;class U&gt;\nMatrix &amp;operator=(Matrix&lt;U, r, c&gt; const&amp; other);\n</code></pre>\n\n<hr>\n\n<p>Finally, you might want to use <code>auto</code>:</p>\n\n<pre><code>Matrix&lt;double, 1, 4&gt; m1(1.2);\nMatrix&lt;double, 4, 1&gt; m2(1.2);\nauto m3 = m1 * m2; // m3 is Matrix&lt;double, 1, 1&gt;\n</code></pre>\n"}], "owner": {"reputation": 496, "user_id": 4040643, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/cff61ba3998d185363575058b4361d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Imago", "link": "https://stackoverflow.com/users/4040643/imago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53301065, "answer_count": 1, "score": 1, "last_activity_date": 1542201139, "creation_date": 1542199774, "last_edit_date": 1542200853, "question_id": 53300651, "link": "https://stackoverflow.com/questions/53300651/can-one-change-templates-arguments", "title": "Can one change templates arguments?", "body": "<p>I have written the following  Matrix class: </p>\n\n<pre><code>template &lt;typename T, size_t r, size_t c&gt; //r=rows,c=cols of the Matrix\nclass Matrix {\npublic:\n    size_t row = 0;\n    size_t col = 0;\n    T *data;\n\n    template &lt;size_t L&gt;\n    Matrix&lt;T, r, L&gt; operator*(const Matrix&lt;T, c, L&gt; &amp;other) const;\n\n    template &lt;size_t r, size_t c&gt;\n    Matrix &amp;operator=(const Matrix&lt;T, r, c&gt; &amp;other)\n\n    // ...\n};\n</code></pre>\n\n<p>I overrode some operators to do some basic arithmetic and everything seems to work properly - however there is an issue which I don't know how to address properly: Given the following lines of code:</p>\n\n<pre><code>  Matrix&lt;double, 1, 4&gt; m1(1.2);\n  Matrix&lt;double, 4, 1&gt; m2(1.2);\n  Matrix&lt;double, 2, 2&gt; m3; // problematic line\n  m3 = m1 * m2;\n</code></pre>\n\n<p><code>m3</code> is of type <code>Matrix&lt;double, 2, 2&gt;</code>, is correctly computed, has one row and one col and carries the <code>5.76</code>, but stays as <code>Matrix&lt;double, 2, 2&gt;</code>. The change of its number of rows and cols is not reflected in its template parameters. Naturally however I would expect the type to be also informative regarding its content. </p>\n\n<p>I don't suppose one cannot turn a <code>Matrix&lt;double, 2, 2&gt;</code> suddenly into a <code>Matrix&lt;double, 1, 1&gt;</code> Matrix, but maybe there is a good solution I just cannot think of now.  </p>\n\n<p>And replace:</p>\n\n<pre><code> template &lt;size_t r, size_t c&gt; void replace(const Matrix&lt;T, r, c&gt; &amp;other) {\n    delete[] data; \n    row = other.row; //number of rows of a matrix\n    col = other.col; //number of cols of a matrix\n    data = new T[col * row]; // data contains all the elements of my matrix\n    for (size_t i = 0; i &lt; row * col; i++)\n      data[i] = other.data[i];\n  }\n</code></pre>\n"}, {"tags": ["c++", "multithreading", "mutex", "c++17", "winsock"], "comments": [{"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542199666, "post_id": 53300440, "comment_id": 93481694, "body": "is <code>sListen</code> in nonblocking mode? Show the code for creating it too. Btw, <code>accept</code> returns -1 on failure on posix systems. Any non-negative value == success."}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542199751, "post_id": 53300440, "comment_id": 93481742, "body": "I am currently runing this on Visual Studio and accept (if I would include &lt;thread&gt; or &lt;mutex&gt; returns 4294967295. For slisten : SOCKET sListen = socket(AF_INET, SOCK_STREAM, NULL);  \tbind(sListen, (SOCKADDR*)&amp;addr, sizeof(addr));  \tlisten(sListen, SOMAXCONN);"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542199889, "post_id": 53300440, "comment_id": 93481822, "body": "Ok, then do <code>newConnection == INVALID_SOCKET</code> in your test."}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200135, "post_id": 53300440, "comment_id": 93481976, "body": "I did that and it goes in thus I assume the socket is invalid. I think the problem is that if I don&#39;t include thread or mutex the accept actually waits for a client to connect before it proceeds, while if I include it it just returns INVALID_SOCKET which seems to be equal to 4294967295. And that&#39;s what I&#39;m kinda stuck on I guess."}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200171, "post_id": 53300440, "comment_id": 93481999, "body": "Also it doesn&#39;t allow my client to connect at all."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200190, "post_id": 53300440, "comment_id": 93482009, "body": "The protocol is NULL? Shouldn&#39;t it be <code>IPPROTO_TCP</code>"}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200394, "post_id": 53300440, "comment_id": 93482112, "body": "I&#39;ve tried both NULL and IPPROTO_TCP, has exactly the same behaviour."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200493, "post_id": 53300440, "comment_id": 93482169, "body": "Be sure that you check for errors the correct way. I don&#39;t know if <code>INVALID_SOCKET == 0</code> but it looks like one possible cause for taking the wrong decision."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200614, "post_id": 53300440, "comment_id": 93482241, "body": "Also show how the <code>sockaddr</code> struct is populated."}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542200919, "post_id": 53300440, "comment_id": 93482409, "body": "I&#39;ve updated the main question with how the addr is populated. It&#39;s simply set to the default local address. INVALID_SOCKET seems to be equal to 4294967295, which is the max 32bit value of a uint. As I said in EDIT 2 : I think the main problem is that for some reason if those 2 libraries are included accept(...) does not wait for a client but just constantly returns INVALID_SOCKET and doesn&#39;t even let clients connect anymore."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542201528, "post_id": 53300440, "comment_id": 93482811, "body": "Ok, does <code>inet_pton</code> return <code>1</code> for success? If not, have you tried <code>InetPtonW</code> instead?"}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "reply_to_user": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542202124, "post_id": 53300440, "comment_id": 93483209, "body": "my inet_pton returns 1, thus is successful"}, {"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 2, "creation_date": 1542202569, "post_id": 53300440, "comment_id": 93483498, "body": "Do you have <code>using namespace std;</code> anywhere?  What happens if you change <code>bind</code> to <code>::bind</code>?"}, {"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "edited": false, "score": 0, "creation_date": 1542203409, "post_id": 53300440, "comment_id": 93484086, "body": "Thank you! That seems to do it. There are some other problems (was expected) but that ::bind seems to have done the trick for my main issue. I thought it might be related to it this morning, but when I commented it out I didn&#39;t realize I have to do ::bind. Would you mind telling me why it&#39;s ::bind? Also I don&#39;t really know how to mark a comment as the sollution, so if you comment it as an answer I will mark it as such. Thanks a lot to both of your for your help!"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1542203727, "post_id": 53300440, "comment_id": 93484306, "body": "Good catch! I&#39;ll remove my confusing answer."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1542203798, "post_id": 53300440, "comment_id": 93484354, "body": "@G.M. needs to add an answer and then you can accept it."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "edited": false, "score": 0, "creation_date": 1542204471, "post_id": 53302077, "comment_id": 93484804, "body": "I see. Thank you very much once again!"}], "tags": [], "owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "is_accepted": true, "score": 5, "last_activity_date": 1542204324, "creation_date": 1542204324, "answer_id": 53302077, "question_id": 53300440, "link": "https://stackoverflow.com/questions/53300440/accepting-a-socket-in-c-behaving-differently-based-on-thread-include/53302077#53302077", "title": "Accepting a socket in C++ behaving differently based on thread include", "body": "<p>Most implementations of the <code>thread</code> header will include (directly or otherwise) the <code>functional</code> header.  That header declares <a href=\"https://en.cppreference.com/w/cpp/utility/functional/bind\" rel=\"noreferrer\"><code>std::bind</code></a>.  Unfortunately, if you also have...</p>\n\n<pre><code>using namespace std;\n</code></pre>\n\n<p>then there's a chance that <code>std::bind</code> will be preferred to the network related <code>bind</code> you're interested in.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">Why is \u201cusing namespace std\u201d considered bad practice?</a>.</p>\n"}], "owner": {"reputation": 25, "user_id": 3625746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d3ef6f31e76f1daf50f57bd7e5154c?s=128&d=identicon&r=PG&f=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/3625746/bumblebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 53302077, "answer_count": 1, "score": 1, "last_activity_date": 1542204324, "creation_date": 1542199129, "last_edit_date": 1542200678, "question_id": 53300440, "link": "https://stackoverflow.com/questions/53300440/accepting-a-socket-in-c-behaving-differently-based-on-thread-include", "title": "Accepting a socket in C++ behaving differently based on thread include", "body": "<p>So I am trying to implement a server-client system in C++17 that also uses multithreading to deal with the clients. Thus far I managed to implement a basic outliner of it using Winsock2 for the server connections and the windows specific threads (CreateThread(...), etc...). And it's working fine.</p>\n\n<p>Though since C++11 implemented it's own threads and we want to be able to run the system on Linux as well I decided to implement the threads that way, so I don't have the hassle of dealing with possix. </p>\n\n<p>But pretty much it screwed up my thing and I don't know how to fix it. (note I am currently trying this on a local server, with both the \"server\" and the \"client\" running on the same machine).</p>\n\n<p>So originally the system looked something like :</p>\n\n<pre><code>//set up connection / server details\nwhile(true){\n    newConnection = accept(sListen, (SOCKADDR*)&amp;addr, &amp;addrlen);\n    if (newConnection == 0)\n        {\n         std::cout&lt;&lt;\"Failed to accept the client's connection.\"\" &lt;&lt;std::endl;\n        }\n        else\n        {\n        CreateThread(...);\n        }\n}\n</code></pre>\n\n<p>The problem is that if I include thread or mutex newConnection will accept a connection 24/7 even if there is none and it will always go in the else of the if. If I don't include thread and mutex the else of the if will be activated only when a client connects to the server. </p>\n\n<p>Any ideas on how I could fix this or what might cause this problem?</p>\n\n<p>Cheers</p>\n\n<p>EDIT : </p>\n\n<pre><code>SOCKADDR_IN addr;\nint addrlen = sizeof(addr); \n\ninet_pton(AF_INET, \"127.0.0.1\", &amp;ip_address);\naddr.sin_addr.s_addr = ip_address;\naddr.sin_port = htons(1111); //Port\naddr.sin_family = AF_INET; //IPv4 Socket\n\nSOCKET sListen = socket(AF_INET, SOCK_STREAM, NULL); \nbind(sListen, (SOCKADDR*)&amp;addr, sizeof(addr)); \nlisten(sListen, SOMAXCONN);\n</code></pre>\n\n<p>EDIT 2 : \nI think the problem is that if I don't include <code>&lt;thread&gt;</code> or <code>&lt;mutex&gt;</code> the accept actually waits for a client to connect before it proceeds, while if I include it it just returns INVALID_SOCKET which seems to be equal to 4294967295.</p>\n"}, {"tags": ["c++", "tcp", "ros"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1542200727, "post_id": 53300297, "comment_id": 93482308, "body": "Possibly related: <code>ss &lt;&lt; buffer</code> will stop at the first NUL byte in <code>buffer</code>. You should probably use <code>ss.str(std::string(buffer, n))</code>."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1542200892, "post_id": 53300297, "comment_id": 93482390, "body": "What does your protocol look like? <code>ss &gt;&gt; identifier</code> will read the first &quot;word&quot; (the first block of non-whitespace characters after any whitespace characters at the start)"}, {"owner": {"reputation": 3, "user_id": 10511678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6919beac6ef13f6a1c7cf73561868520?s=128&d=identicon&r=PG&f=1", "display_name": "user10511678", "link": "https://stackoverflow.com/users/10511678/user10511678"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1542370156, "post_id": 53300297, "comment_id": 93553935, "body": "Sorry for my late reply. I went ahead with (memchr) and it works for me!"}], "owner": {"reputation": 3, "user_id": 10511678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6919beac6ef13f6a1c7cf73561868520?s=128&d=identicon&r=PG&f=1", "display_name": "user10511678", "link": "https://stackoverflow.com/users/10511678/user10511678"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542199624, "creation_date": 1542198612, "last_edit_date": 1542199624, "question_id": 53300297, "link": "https://stackoverflow.com/questions/53300297/how-do-i-detect-stx-over-a-tcp-socket", "title": "How do I detect STX over a TCP socket?", "body": "<p>I have a server and a client communicating with each other over TCP. </p>\n\n<p>On the client side, I'm trying to send an STX before sending some data. When I sniff the TCP packets on Wireshark, I do see the STX, and the data is getting sent too. So there is some problem with how I'm trying to reconstruct the message on the server side.  </p>\n\n<p>On the server side, I'm trying to read the STX like this:</p>\n\n<pre><code>while(ros::ok()) {\nss.str(std::string()); \nbzero(buffer,256);\nn = read(newsockfd,buffer,255); //rcv Buffer\nif (n &lt; 0) error(\"ERROR reading from socket\");\nss &lt;&lt; buffer;\nconst char stx = '\\x02';\n\nstd::string stxstr;\nstxstr.push_back(stx);\nstd::string identifier;\nstd::stringstream::pos_type pos = ss.tellg();\nss&gt;&gt;identifier;\n\nif(identifier == stxstr){\nROS_INFO(\"Found STX\");\n}\nelse {\nss.seekg(pos); \n}\n\n\nn = write(newsockfd,\"Recd\",4); //ACK to client\nif (n &lt; 0) error(\"ERROR writing to socket\");}\n</code></pre>\n\n<p>But I am not able to get the STX from the stringstream. What am I doing wrong?</p>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 24, "creation_date": 1542198580, "post_id": 53300142, "comment_id": 93481089, "body": "By the way, in <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b20\">c++20</a> you will be able to define just one new operator and the compiler will do the juggling. It&#39;s  <code>operator &lt;=&gt;</code>."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 4, "creation_date": 1542198792, "post_id": 53300142, "comment_id": 93481212, "body": "related <a href=\"https://stackoverflow.com/q/4421706/5470596\">All you always dreamed to know about operator overloading but never cared to ask</a>."}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 3, "creation_date": 1542207793, "post_id": 53300142, "comment_id": 93487035, "body": "The bigger question, IMO, is whether the concept of equality between a <code>Foo</code> and a string is a valid concept or an inherent category error. A thing is not equivalent to its name, and the idea that it is is arguably part of  what confuses people so much about pointers and references."}, {"owner": {"reputation": 710, "user_id": 1518951, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5822f1c609c33b472d347893433c0810?s=128&d=identicon&r=PG", "display_name": "hehe3301", "link": "https://stackoverflow.com/users/1518951/hehe3301"}, "reply_to_user": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1542210232, "post_id": 53300142, "comment_id": 93488553, "body": "@cHao in my actual case there is an equivalence between name and &quot;the thing&quot;"}, {"owner": {"reputation": 1542, "user_id": 897728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672e0d8de180128eed1b101ad8b955?s=128&d=identicon&r=PG", "display_name": "Happy Green Kid Naps", "link": "https://stackoverflow.com/users/897728/happy-green-kid-naps"}, "edited": false, "score": 0, "creation_date": 1542212225, "post_id": 53300142, "comment_id": 93489848, "body": "Implement the first comparison operator as a member of <code>Foo</code>, <b>not</b> as a global freestanding function.  The second operator must simply be implemented as <code>return objB == objA</code>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1542215066, "post_id": 53300142, "comment_id": 93491510, "body": "@StoryTeller - I must have missed the bit where <code>operator&lt;=&gt;</code> will reorder arguments of different types (your first comment) - can you point to the section that specifies that?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 3, "creation_date": 1542215620, "post_id": 53300142, "comment_id": 93491820, "body": "@TobySpeight - <a href=\"http://eel.is/c++draft/over.match.oper#3.4\" rel=\"nofollow noreferrer\">eel.is/c++draft/over.match.oper#3.4</a>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1542217216, "post_id": 53300142, "comment_id": 93492648, "body": "Thanks @StoryT - I was looking in the <code>&lt;=&gt;</code> proposal instead."}], "answers": [{"comments": [{"owner": {"reputation": 710, "user_id": 1518951, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5822f1c609c33b472d347893433c0810?s=128&d=identicon&r=PG", "display_name": "hehe3301", "link": "https://stackoverflow.com/users/1518951/hehe3301"}, "edited": false, "score": 8, "creation_date": 1542198330, "post_id": 53300180, "comment_id": 93480910, "body": "So theoretically one could implement different behaviour for <code>Foo==String</code> and <code>String==Foo</code>"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 54, "creation_date": 1542198354, "post_id": 53300180, "comment_id": 93480927, "body": "Yes, you could. But you definitely shouldn&#39;t."}, {"owner": {"reputation": 710, "user_id": 1518951, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5822f1c609c33b472d347893433c0810?s=128&d=identicon&r=PG", "display_name": "hehe3301", "link": "https://stackoverflow.com/users/1518951/hehe3301"}, "edited": false, "score": 0, "creation_date": 1542203208, "post_id": 53300180, "comment_id": 93483939, "body": "@StoryTeller Do we get op!= for free with this as !(op==) or should that be implemented both directions as well? (expecting the answer no)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 710, "user_id": 1518951, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5822f1c609c33b472d347893433c0810?s=128&d=identicon&r=PG", "display_name": "hehe3301", "link": "https://stackoverflow.com/users/1518951/hehe3301"}, "edited": false, "score": 22, "creation_date": 1542203413, "post_id": 53300180, "comment_id": 93484089, "body": "@hehe3301 - I&#39;m afraid all the overloads you want will need to be implemented explicitly. Although again, the body can be <code>!(lhs == rhs)</code>. That&#39;s why <code>operator &lt;=&gt;</code> generates so much excitement. Because it can cut down on a lot of boilerplate."}, {"owner": {"reputation": 3966, "user_id": 2132213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a31de75b6e3603efbc437ab3475a757d?s=128&d=identicon&r=PG", "display_name": "Nick Matteo", "link": "https://stackoverflow.com/users/2132213/nick-matteo"}, "reply_to_user": {"reputation": 710, "user_id": 1518951, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5822f1c609c33b472d347893433c0810?s=128&d=identicon&r=PG", "display_name": "hehe3301", "link": "https://stackoverflow.com/users/1518951/hehe3301"}, "edited": false, "score": 0, "creation_date": 1542273150, "post_id": 53300180, "comment_id": 93511936, "body": "@hehe3301: You can use <a href=\"https://www.boost.org/doc/libs/1_68_0/libs/utility/operators.htm\" rel=\"nofollow noreferrer\">boost/operators.hpp</a>, which provides classes to inherit from which fill in operators based on your provided ones. For instance, if you inherit from <code>equality_comparable&lt;T, U&gt;</code> and provide <code>operator==(T, U)</code>, it will supply <code>bool operator==(const U&amp;, const T&amp;)</code>, <code>bool operator!=(const U&amp;, const T&amp;)</code>, and <code>bool operator!=(const T&amp;, const U&amp;)</code> for you."}, {"owner": {"reputation": 4026, "user_id": 8414561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa61454588bc140dada53391e1eb3c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Null", "link": "https://stackoverflow.com/users/8414561/dev-null"}, "edited": false, "score": 0, "creation_date": 1553668094, "post_id": 53300180, "comment_id": 97464531, "body": "@StoryTeller does the same logic apply to <code>Foo::operator==(const std::string&amp;)</code>?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 4026, "user_id": 8414561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa61454588bc140dada53391e1eb3c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Null", "link": "https://stackoverflow.com/users/8414561/dev-null"}, "edited": false, "score": 0, "creation_date": 1553673817, "post_id": 53300180, "comment_id": 97466940, "body": "@DevNull - Interesting that you should ask. There was a proposal merged into C++20 recently that may require a complete update to this answer (and will also address) your comment. I&#39;ll ping you once I edited it in."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 4026, "user_id": 8414561, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa61454588bc140dada53391e1eb3c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Dev Null", "link": "https://stackoverflow.com/users/8414561/dev-null"}, "edited": false, "score": 0, "creation_date": 1553675622, "post_id": 53300180, "comment_id": 97467817, "body": "@DevNull - As for C++17, the same logic applies. You can&#39;t add your own overload to <code>std::string</code> so if you want the order reversed, you need to do it yourself. Either directly or indirectly via something like Boost."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 77, "last_activity_date": 1553675545, "last_edit_date": 1553675545, "creation_date": 1542198225, "answer_id": 53300180, "question_id": 53300142, "link": "https://stackoverflow.com/questions/53300142/in-c-do-you-need-to-overload-operator-in-both-directions/53300180#53300180", "title": "In C++ do you need to overload operator== in both directions?", "body": "<p><sub><sub>(C++20 onward)</sub></sub></p>\n\n<p>With the acceptance of <a href=\"https://wg21.link/p1185\" rel=\"nofollow noreferrer\">p1185</a> into C++20, you don't need to provide more than one overload. The paper made these changes (among others) to the standard:</p>\n\n<blockquote>\n  <p><strong>[over.match.oper]</strong></p>\n  \n  <p><a href=\"http://eel.is/c++draft/over.match.oper#3.4\" rel=\"nofollow noreferrer\">3.4</a> - [...] For the <code>!=</code> operator ([expr.eq]), the rewritten candidates include all member, non-member, and built-in candidates for the operator <code>==</code> for which the rewritten expression <code>(x == y)</code> is well-formed when contextually converted to bool using that operator <code>==</code>. For the equality operators, the rewritten candidates also include a synthesized candidate, with the order of the two parameters reversed, for each member, non-member, and built-in candidate for the operator <code>==</code> for which the rewritten expression <code>(y == x)</code> is well-formed when contextually converted to bool using that operator <code>==</code>. [\u2009Note: A candidate synthesized from a member candidate has its implicit object parameter as the second parameter, thus implicit conversions are considered for the first, but not for the second, parameter. \u2014\u2009end note\u2009] [...]</p>\n  \n  <p><a href=\"http://eel.is/c++draft/over.match.oper#8\" rel=\"nofollow noreferrer\">8</a> [...] If a rewritten candidate is selected by overload resolution for a <code>!=</code> operator, <code>x != y</code> is interpreted as <code>(y == x) ? false : true</code> if the selected candidate is a synthesized candidate with reversed order of parameters, or <code>(x == y) ? false : true</code> otherwise, using the selected rewritten <code>operator==</code> candidate. If a rewritten candidate is selected by overload resolution for an <code>==</code> operator, <code>x == y</code> is interpreted as <code>(y == x) ? true : false</code> using the selected rewritten <code>operator==</code> candidate.</p>\n</blockquote>\n\n<p>The above means that not only do you <em>not</em> need to provide the operator with the order of the operands reversed, you also get <code>!=</code> for free! Furthermore, the <code>operator==</code> function can be a member if it makes sense. Though as the note in the first paragraph above says, it being a member or free function will affect implicit conversions so you still need to bear that in mind. </p>\n\n<hr>\n\n<p><sub><sub>(Upto C++17)</sub></sub></p>\n\n<p>You do if you want to support comparisons where the string is on the left and the <code>Foo</code> is on the right. An implementation won't reorder the arguments to an overloaded <code>operator==</code> to make it work.</p>\n\n<p>But you can avoid repeating the implementation's logic, though. Assuming your operator should behave as expected:</p>\n\n<pre><code>inline bool operator==(const std::string&amp; objA, const Foo&amp; objB) {\n    return objB == objA; // Reuse previously defined operator\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "edited": false, "score": 12, "creation_date": 1542229338, "post_id": 53300203, "comment_id": 93498068, "body": "Re: &quot;Just like in other languages&quot;: Overloading works sufficiently differently from one language to the next that I don&#39;t think this sort of sweeping statement is helpful."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 6, "last_activity_date": 1542232076, "last_edit_date": 1542232076, "creation_date": 1542198319, "answer_id": 53300203, "question_id": 53300142, "link": "https://stackoverflow.com/questions/53300142/in-c-do-you-need-to-overload-operator-in-both-directions/53300203#53300203", "title": "In C++ do you need to overload operator== in both directions?", "body": "<p>Yes, you do. Just like in lots of other languages, C++ takes sides and comparisons between two objects of different types will lead to calls to two different comparison operators depending on the order.</p>\n\n<p>Of course, you want them to be consistent and not surprising, so the second should be defined in terms of the first.</p>\n"}], "owner": {"reputation": 710, "user_id": 1518951, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5822f1c609c33b472d347893433c0810?s=128&d=identicon&r=PG", "display_name": "hehe3301", "link": "https://stackoverflow.com/users/1518951/hehe3301"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6615, "favorite_count": 4, "accepted_answer_id": 53300180, "answer_count": 2, "score": 57, "last_activity_date": 1553675545, "creation_date": 1542198078, "last_edit_date": 1544195313, "question_id": 53300142, "link": "https://stackoverflow.com/questions/53300142/in-c-do-you-need-to-overload-operator-in-both-directions", "title": "In C++ do you need to overload operator== in both directions?", "body": "<p>Say I am working with a class:</p>\n\n<pre><code>class Foo{\npublic:\n  std:string name;\n  /*...*/\n}/*end Foo*/\n</code></pre>\n\n<p>and I provide an overload for <code>operator==</code></p>\n\n<pre><code>bool operator==(const Foo&amp; fooObj, const std::string&amp; strObj) {\n    return (fooObj.name == strObj);\n}\n</code></pre>\n\n<p>Do I also need to re-implement the same logic in reverse?</p>\n\n<pre><code>bool operator==(const std::string&amp; strObj, const Foo&amp; fooObj) {\n    return (strObj == fooObj.name);\n}\n</code></pre>\n"}, {"tags": ["c++", "byte", "ofstream"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9506750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7eb21c841c461befdcfa97b4708834?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/9506750/joe"}, "edited": false, "score": 0, "creation_date": 1542198534, "post_id": 53300130, "comment_id": 93481057, "body": "Yes, I&#39;m on windows system, but i didn&#39;t open it by any text editor but directly read the file by another program, and still cause this translation, is there any solutions to prevent it? Or how can I only write 0A to the file?"}, {"owner": {"reputation": 1102, "user_id": 5088796, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/19f4fd38736f571b96696b615af97266?s=128&d=identicon&r=PG&f=1", "display_name": "Yanick Salzmann", "link": "https://stackoverflow.com/users/5088796/yanick-salzmann"}, "edited": false, "score": 2, "creation_date": 1542198708, "post_id": 53300130, "comment_id": 93481163, "body": "You could open the file in binary mode. See the <code>mode</code> parameter in the constructor of <code>ofstream</code>: <a href=\"https://en.cppreference.com/w/cpp/io/basic_ofstream/basic_ofstream\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/basic_ofstream/basic_ofstream</a>"}, {"owner": {"reputation": 1102, "user_id": 5088796, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/19f4fd38736f571b96696b615af97266?s=128&d=identicon&r=PG&f=1", "display_name": "Yanick Salzmann", "link": "https://stackoverflow.com/users/5088796/yanick-salzmann"}, "edited": false, "score": 1, "creation_date": 1542198852, "post_id": 53300130, "comment_id": 93481247, "body": "<a href=\"https://en.cppreference.com/w/cpp/io/c#Binary_and_text_modes\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/c#Binary_and_text_modes</a> expands on what Some programmer due explained."}, {"owner": {"reputation": 3, "user_id": 9506750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7eb21c841c461befdcfa97b4708834?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/9506750/joe"}, "edited": false, "score": 0, "creation_date": 1542199049, "post_id": 53300130, "comment_id": 93481368, "body": "Appreciate!! I&#39;ll check it out!"}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1542198177, "last_edit_date": 1542198177, "creation_date": 1542198027, "answer_id": 53300130, "question_id": 53300079, "link": "https://stackoverflow.com/questions/53300079/c-output-char-to-file-give-wrong-value/53300130#53300130", "title": "c++ output char to file give wrong value", "body": "<p>I'm guessing you're on a Windows system, where newlines (<code>'\\n'</code>, <a href=\"https://en.cppreference.com/w/cpp/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> value <code>10</code>) are automatically translated to the Windows newline <code>\"\\r\\n\"</code> (<a href=\"https://en.cppreference.com/w/cpp/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> values <code>13</code> and <code>10</code>).</p>\n\n<p>This translation happens for all files opened in text mode on Windows. And in the opposite direction when reading. Opening in binary mode will not do this translation.</p>\n"}], "owner": {"reputation": 3, "user_id": 9506750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd7eb21c841c461befdcfa97b4708834?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/9506750/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1542214089, "accepted_answer_id": 53300130, "answer_count": 1, "score": 0, "last_activity_date": 1542198177, "creation_date": 1542197892, "question_id": 53300079, "link": "https://stackoverflow.com/questions/53300079/c-output-char-to-file-give-wrong-value", "closed_reason": "Duplicate", "title": "c++ output char to file give wrong value", "body": "<p>I'm trying to write some value to a file byte by byte while when it comes to the value of 10, it write 0D0A instead of only 0A ot the file, any idea?</p>\n\n<pre><code>unsigned char m = 10;\nofstream fout(\"1.file\");\nfout &lt;&lt; m;\nfout.close();\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WgYde.png\" rel=\"nofollow noreferrer\">output of the file</a></p>\n"}, {"tags": ["c++", "multithreading", "c++14", "variadic-templates", "generic-lambda"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1542197468, "post_id": 53299885, "comment_id": 93480424, "body": "It should be <code>std::forward&lt;T&gt;(t)...</code>. I&#39;m not sure that helps with your case since you have a single-element pack, but still."}, {"owner": {"reputation": 179, "user_id": 8900666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e45401e1c745d3840a6de94cf69f64?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Faria", "link": "https://stackoverflow.com/users/8900666/leonardo-faria"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1542197588, "post_id": 53299885, "comment_id": 93480485, "body": "I think it&#39;s equivalent as the error persists but edited to have that cleaner syntax ty"}], "answers": [{"tags": [], "owner": {"reputation": 59936, "user_id": 6022656, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf138f6c424001ac8491ca86b1976c0c?s=128&d=identicon&r=PG&f=1", "display_name": "max66", "link": "https://stackoverflow.com/users/6022656/max66"}, "is_accepted": true, "score": 1, "last_activity_date": 1542235735, "last_edit_date": 1542235735, "creation_date": 1542199493, "answer_id": 53300553, "question_id": 53299885, "link": "https://stackoverflow.com/questions/53299885/forward-variadic-argument-to-thread-with-lambda/53300553#53300553", "title": "Forward variadic argument to thread with lambda", "body": "<p>Try with</p>\n\n<pre><code>template&lt;typename... T&gt; \nauto foo(T&amp;&amp;... t){\n    [](T&amp;&amp;... u){ }(std::forward&lt;T&gt;(t)...); // (1)\n\n    return std::thread( // (2) \n        [](auto &amp;&amp;... u){ },\n        std::forward&lt;T&gt;(t)...\n    );\n}\n</code></pre>\n\n<p>I mean: in the lambda you pass to <code>std::thread()</code>, <code>auto &amp;&amp; ...</code> instead of <code>T &amp;&amp; ...</code>. Or, maybe, <code>T const &amp; ...</code>.</p>\n\n<p>I'm not a language layer, and maybe someone can correct me, but it seems to me that there is a clash between universal references and r-value references. And the fact that <code>std::thread()</code> pass <strong>copies</strong> of the following arguments to the first one.</p>\n\n<p>When you write </p>\n\n<pre><code>template&lt;typename... T&gt; \nauto foo(T&amp;&amp;... t)\n</code></pre>\n\n<p>the <code>&amp;&amp;</code> are universal-references and <code>T...</code> become <code>int</code>, when you call <code>foo(1)</code>, and <code>int &amp;</code>, when you call <code>foo(n)</code>.</p>\n\n<p>Inside the function you get</p>\n\n<pre><code>[](int){ }(std::forward&lt;int&gt;(t)); // (1)\n\nreturn std::thread( // (2) \n    [](int){ },\n    std::forward&lt;int&gt;(t)...\n);\n</code></pre>\n\n<p>in case <code>f(0)</code>.</p>\n\n<p>And this works because both lambda are waiting a <code>int</code> by copy and this ever works.</p>\n\n<p>But when you call <code>f(n)</code>, inside <code>foo()</code> you get</p>\n\n<pre><code>[](int &amp;){ }(std::forward&lt;int&gt;(t)); // (1)\n\nreturn std::thread( // (2) \n    [](int &amp;){ },\n    std::forward&lt;int&gt;(t)...\n);\n</code></pre>\n\n<p>and this works for the first call, because the lambda wait a <code>int</code> left-reference variable (<code>int &amp;</code>) and get a <code>int</code> left-reference variable, but doesn't works for the second call because <code>std::thread</code> pass a <strong>copy</strong> of <code>std::forward&lt;int&gt;(t)</code> (so a right-reference, <code>int &amp;&amp;</code>) to the lambda that wait for a left-reference.</p>\n"}, {"tags": [], "owner": {"reputation": 13070, "user_id": 1639256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8KYbp.jpg?s=128&g=1", "display_name": "Oktalist", "link": "https://stackoverflow.com/users/1639256/oktalist"}, "is_accepted": false, "score": 2, "last_activity_date": 1542201927, "creation_date": 1542201927, "answer_id": 53301312, "question_id": 53299885, "link": "https://stackoverflow.com/questions/53299885/forward-variadic-argument-to-thread-with-lambda/53301312#53301312", "title": "Forward variadic argument to thread with lambda", "body": "<p><code>std::thread</code> can't simply forward its arguments to the lambda by reference, because that would mean two threads potentially having simultaneous access to the arguments without synchronisation. So instead, <code>std::thread</code> creates temporary copies of the arguments, and passes those to the lambda. Because they are temporaries, they are rvalues. This works in A.2 because the lambda's parameter is an rvalue reference (because <code>T</code> is <code>int</code>, so <code>T&amp;&amp;</code> is <code>int&amp;&amp;</code>). It doesn't work in B.2, because the lambda's parameter is an lvalue reference (because <code>T</code> is <code>int&amp;</code>, so <code>T&amp;&amp;</code> is <code>int&amp;</code>). Like max66 says, you probably want to use <code>auto&amp;&amp;...</code> in your lambda so it can accept whatever is passed to it.</p>\n"}], "owner": {"reputation": 179, "user_id": 8900666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e45401e1c745d3840a6de94cf69f64?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Faria", "link": "https://stackoverflow.com/users/8900666/leonardo-faria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 53300553, "answer_count": 2, "score": 4, "last_activity_date": 1542235735, "creation_date": 1542197223, "last_edit_date": 1542235692, "question_id": 53299885, "link": "https://stackoverflow.com/questions/53299885/forward-variadic-argument-to-thread-with-lambda", "title": "Forward variadic argument to thread with lambda", "body": "<p>I'm having trouble finding how use <code>std::thread()</code> with lambdas. Namely, with having a variadic argument lambda receive the arguments by forwarding. As an example:</p>\n\n<pre><code>template&lt;typename... T&gt; \nauto foo(T&amp;&amp;... t){\n    [](T&amp;&amp;... t){}(std::forward&lt;T&gt;(t)...); // (1)\n\n    return std::thread( // (2) \n        [](T&amp;&amp;... t){},\n        std::forward&lt;T&gt;(t)...\n    );\n}\n\nauto bar(){\n    int n=1;\n    foo(1); (A)\n    foo(n); (B)\n}\n</code></pre>\n\n<p>A.1: compiles</p>\n\n<p>A.2: compiles</p>\n\n<p>B.1: compiles</p>\n\n<p>B.2: <strong>doesn't compile</strong></p>\n\n<p>I don't understand:</p>\n\n<ul>\n<li>Why the <code>std::thread()</code> (2) version using (B) doesn't compile and (A.2) does?</li>\n<li>Why are there differences between (B.1) and (B.2)</li>\n</ul>\n"}, {"tags": ["c++", "arrays", "if-statement"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 7, "creation_date": 1542197075, "post_id": 53299799, "comment_id": 93480212, "body": "Which book are you using to learn C++? No offence but <code>if</code> statements should be right near the start."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1542197478, "post_id": 53299799, "comment_id": 93480430, "body": "Write a function to ask (until valid is given) and return 1 mark. Then call it for each mark."}], "answers": [{"tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": true, "score": 1, "last_activity_date": 1542198924, "last_edit_date": 1542198924, "creation_date": 1542197754, "answer_id": 53300039, "question_id": 53299799, "link": "https://stackoverflow.com/questions/53299799/if-statement-to-control-range-of-numbers-using-array/53300039#53300039", "title": "If statement to control range of numbers using array", "body": "<p>You should use a <a href=\"https://www.tutorialspoint.com/cplusplus/cpp_for_loop.htm\" rel=\"nofollow noreferrer\"><code>for-loop</code></a> to make the code more readable and compact. Because once you introduce <a href=\"https://en.cppreference.com/w/cpp/language/if\" rel=\"nofollow noreferrer\"><code>if</code></a> statements, the code size would grow alot. It should look like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint mark[5];\n\nint main () {\n    for (int i = 0; i &lt; 5; i++){\n        cout &lt;&lt; \"enter mark \" &lt;&lt; i &lt;&lt; \":  \";\n        cin &gt;&gt; mark[i];\n        if (mark[i] &lt; 0 || mark[i] &gt; 100){\n            cout &lt;&lt; \"invalid mark number\\n\";\n        }\n    }\n}\n</code></pre>\n\n<p>Don't use <code>using namespace std;</code> (<a href=\"https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-bad-practice\">read here why</a>) and keep the <code>int mark[5];</code> inside the <code>main</code>-function (<a href=\"https://stackoverflow.com/questions/484635/are-global-variables-bad\">read here why</a>). Also to add to the logic force the user to input again:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main () {\n    int mark[5];\n    for (int i = 0; i &lt; 5; i++){\n        bool valid_input = false;\n        while (!valid_input){\n            std::cout &lt;&lt; \"enter mark \" &lt;&lt; i &lt;&lt; \":  \";\n            std::cin &gt;&gt; mark[i];\n            if (mark[i] &lt; 0 || mark[i] &gt; 100){\n                std::cout &lt;&lt; \"invalid mark number\\n\";\n            }\n            else{\n                valid_input = true;\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9823375, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "itsTed", "link": "https://stackoverflow.com/users/9823375/itsted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 53300039, "answer_count": 1, "score": -4, "last_activity_date": 1542366430, "creation_date": 1542196916, "last_edit_date": 1542366430, "question_id": 53299799, "link": "https://stackoverflow.com/questions/53299799/if-statement-to-control-range-of-numbers-using-array", "title": "If statement to control range of numbers using array", "body": "<p>I have created an array that holds 5 numbers, and the user inputs the numbers. If the mark is less than 0 and greater than 100, I want to print out \"invalid mark number\". How could I do that?</p>\n\n<pre><code>using namespace std; \n\nint mark[5];\n\nint main () \n{\ncout &lt;&lt; \"enter mark 0:  \";\ncin &gt;&gt; mark[0];\n\n\ncout &lt;&lt; \"enter mark 1:  \";\ncin &gt;&gt; mark[1];\n\ncout &lt;&lt; \"enter mark 2:  \";\ncin &gt;&gt; mark[2];\n\ncout &lt;&lt; \"enter mark 3:  \";\ncin &gt;&gt; mark[3];\n\ncout &lt;&lt; \"enter mark 4:  \";\ncin &gt;&gt; mark[4];\n\n}\n</code></pre>\n"}, {"tags": ["c++", "webassembly"], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 3511753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c4911244c5abf838d69409b962e2b55?s=128&d=identicon&r=PG", "display_name": "Narrateur du chaos", "link": "https://stackoverflow.com/users/3511753/narrateur-du-chaos"}, "is_accepted": false, "score": 0, "last_activity_date": 1555959315, "last_edit_date": 1555959315, "creation_date": 1555951447, "answer_id": 55797858, "question_id": 53299740, "link": "https://stackoverflow.com/questions/53299740/how-can-i-include-a-webassembly-module-from-a-c-file/55797858#55797858", "title": "How can I include a WebAssembly module from a C++ file?", "body": "<h1>It's currently impossible.</h1>\n\n<p>The situation might change at some point (which is why I'm not marking this question as solved), but so far the standard doesn't support wasm-to-wasm interoperability:</p>\n\n<ul>\n<li><a href=\"https://webassembly.org/docs/modules/\" rel=\"nofollow noreferrer\">From the official website</a>:</li>\n</ul>\n\n<blockquote>\n  <p>Since the WebAssembly spec does not define how import names are interpreted [...] the host environment can interpret the module name as a file path, a URL, a key in a fixed set of builtin modules or the host environment may invoke a user-defined hook to resolve the module name to one of these;</p>\n</blockquote>\n\n<p>(eg it's implementation-defined)</p>\n\n<ul>\n<li><a href=\"https://github.com/WebAssembly/design/issues/1219#issuecomment-403937984\" rel=\"nofollow noreferrer\">From V8 developer Ben Smith</a>:</li>\n</ul>\n\n<blockquote>\n  <blockquote>\n    <p>As far as I know, currently a wasm module cannot directly import from another wasm module, instead it must use JavaScript as an intermediary.</p>\n  </blockquote>\n  \n  <p>Yes, the module defers this to the embedder (typically JS). As far as the module is concerned, it just knows that something is providing the import, but it doesn't know where it came from.</p>\n</blockquote>\n\n<ul>\n<li><a href=\"https://github.com/WebAssembly/gc/issues/58#issuecomment-457126389\" rel=\"nofollow noreferrer\">From top WebAssembly spec contributor Andreas Rossberg</a></li>\n</ul>\n\n<blockquote>\n  <p>It's not a design goal for Wasm to guarantee seamless interop between multiple languages, or even multiple compilers of the same language (whether with memory or GC). That is in line with its low-level approach and a very conscious decision: such universal interop has often been promised but never worked out well in practice. Languages are just too different.</p>\n  \n  <p>If multiple compilers or languages want to be able to interoperate, then they are of course free to define a common ABI on top of Wasm. That would be great! But Wasm itself doesn't need to prescribe it, no more than a CPU architecture does.</p>\n</blockquote>\n\n<p>Given the above comment, it seems likely that language interoperability will remain a low priority for wasm contributors in the near future.</p>\n"}], "owner": {"reputation": 175, "user_id": 3511753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c4911244c5abf838d69409b962e2b55?s=128&d=identicon&r=PG", "display_name": "Narrateur du chaos", "link": "https://stackoverflow.com/users/3511753/narrateur-du-chaos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1555959315, "creation_date": 1542196731, "last_edit_date": 1554831206, "question_id": 53299740, "link": "https://stackoverflow.com/questions/53299740/how-can-i-include-a-webassembly-module-from-a-c-file", "title": "How can I include a WebAssembly module from a C++ file?", "body": "<p>WebAssembly is a binary language that intends to, among other goals, break the barriers between programming languages.</p>\n\n<p>Currently, it's easy enough to <a href=\"https://developer.mozilla.org/en-US/docs/WebAssembly/C_to_wasm\" rel=\"nofollow noreferrer\">compile C++ code to WebAsm</a> and include it into JavaScript code. There's even <a href=\"https://github.com/webassembly/esm-integration\" rel=\"nofollow noreferrer\">a proposal</a> and a <a href=\"https://www.i-programmer.info/news/167-javascript/11602-webpack-4-adds-webassembly-support.html\" rel=\"nofollow noreferrer\">Webpack polyfill</a> to make it as easy as <code>import { foo } from 'bar.wasm'</code>.</p>\n\n<p>Moreover, WebAssembly supports wasm files that list their own dependencies, in the form of import declarations.</p>\n\n<p>Is there some polyfill build tool that allows users to include a webasm module into a C++ compilation unit, in the process of compiling it to wasm? For example, let's say I have a Rust module that I want to use inside a C++ module, both of which I'm compiling to wasm. Is there a way to write code equivalent to this:</p>\n\n<pre><code>#include \"node_modules/some_rust_utility/index.wasm\"\n\nint someCppFunction(const std::string&amp; data) {\n  return some_rust_utility::foobar(data.c_str());\n}\n</code></pre>\n\n<p>and have it compile or not depending on whether <code>foobar</code> is defined with a matching type in <code>some_rust_utility</code>?</p>\n\n<hr>\n\n<p>Note: I expect the answer to this question may change over time as WebAssembly support marches on. If you see this question years afterwards and the answer has changed, feel free to add an update.</p>\n"}, {"tags": ["c++", "arrays", "function", "loops"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1542196841, "post_id": 53299737, "comment_id": 93480081, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a <a href=\"https://en.wikipedia.org/wiki/Debugger\" rel=\"nofollow noreferrer\">debugger</a> to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 12749, "user_id": 7976805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a559df8b4b287aad23724b4c66d67c?s=128&d=identicon&r=PG&f=1", "display_name": "Yksisarvinen", "link": "https://stackoverflow.com/users/7976805/yksisarvinen"}, "edited": false, "score": 0, "creation_date": 1542196856, "post_id": 53299737, "comment_id": 93480090, "body": "Side note: this task could be easier if you solved the equation on paper, but I don&#39;t know what is the actual purpose of the task you have."}, {"owner": {"reputation": 125, "user_id": 10515311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6eWLf7uUU80/AAAAAAAAAAI/AAAAAAAAACg/LK-mDc1MW-k/photo.jpg?sz=128", "display_name": "Sarah_Xx", "link": "https://stackoverflow.com/users/10515311/sarah-xx"}, "edited": false, "score": 2, "creation_date": 1542196976, "post_id": 53299737, "comment_id": 93480159, "body": "not sure what do you mean with that the purpose of it is learning to create a function"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1542197029, "post_id": 53299737, "comment_id": 93480196, "body": "Think about what that series is showing you... It take <code>x</code> and add <code>2 * x</code>, then add <code>3 * x</code>, etc. Now what is your loop doing? Are you sure it&#39;s doing the same thing? You sure you haven&#39;t switched the <code>*</code> and <code>+</code> in your code?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542198139, "post_id": 53299737, "comment_id": 93480804, "body": "While we&amp;#39;re at it, consider ditching the loop and using the obvious mathematical expansion <code>n*(n+1)&#47;2</code> for n==15 to calculate it in constant time: <code>int functX(int x) { return 120*x; }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "is_accepted": true, "score": 4, "last_activity_date": 1542291917, "last_edit_date": 1542291917, "creation_date": 1542197034, "answer_id": 53299831, "question_id": 53299737, "link": "https://stackoverflow.com/questions/53299737/is-there-anything-wrong-with-my-function-implementation/53299831#53299831", "title": "is there anything wrong with my function implementation?", "body": "<p>The function <code>f</code> seems to be implemented incorrectly; you seem to have exchanged additiond and multiplication. A correct implementation could look as follows.</p>\n\n<pre><code>int functX(int x)\n{\n    int fx = 0;\n    for (int i = 1; i &lt;= 15; i++)\n    {\n        fx += (i * x);\n    }\n    return fx;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1542210707, "post_id": 53299850, "comment_id": 93488880, "body": "OP also needs to initialise <code>fx</code> to 0, not 1."}], "tags": [], "owner": {"reputation": 5093, "user_id": 6039995, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QuCId.png?s=128&g=1", "display_name": "Stack Danny", "link": "https://stackoverflow.com/users/6039995/stack-danny"}, "is_accepted": false, "score": 5, "last_activity_date": 1542199278, "last_edit_date": 1542199278, "creation_date": 1542197088, "answer_id": 53299850, "question_id": 53299737, "link": "https://stackoverflow.com/questions/53299737/is-there-anything-wrong-with-my-function-implementation/53299850#53299850", "title": "is there anything wrong with my function implementation?", "body": "<p>Instead of </p>\n\n<pre><code>fx *= (x + i);\n</code></pre>\n\n<p>write</p>\n\n<pre><code>fx += (x * i);\n</code></pre>\n\n<p>since you want to add the products and not multiply the sums.</p>\n\n<p>Also your formatting is weird and please read the <a href=\"https://stackoverflow.com/help/how-to-ask\">guidelines</a> on how to ask a question correctly.</p>\n"}], "owner": {"reputation": 125, "user_id": 10515311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6eWLf7uUU80/AAAAAAAAAAI/AAAAAAAAACg/LK-mDc1MW-k/photo.jpg?sz=128", "display_name": "Sarah_Xx", "link": "https://stackoverflow.com/users/10515311/sarah-xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 53299831, "answer_count": 2, "score": 0, "last_activity_date": 1542291917, "creation_date": 1542196727, "last_edit_date": 1542203916, "question_id": 53299737, "link": "https://stackoverflow.com/questions/53299737/is-there-anything-wrong-with-my-function-implementation", "title": "is there anything wrong with my function implementation?", "body": "<p>i need to write a function that will take the user input and do the following formula attached, however i keep getting the wrong output and cant seem what is the logical error in my code</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint functX(int x) {\n  int fx = 1;\n\n  for (int i = 1; i &lt;= 15; i++) {\n    fx *= (x + i);\n  }\n\n  return fx;\n}\n\nint main() {\n  int n;\n  cout &lt;&lt; \" Enter the value you want to sum\" &lt;&lt; endl;\n  cin &gt;&gt; n;\n\n  cout &lt;&lt; functX(n) &lt;&lt; endl;\n\n  system(\"Pause\");\n  return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/G8dFL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G8dFL.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c++11", "c++03"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542196675, "post_id": 53299635, "comment_id": 93479988, "body": "Please keep the title as a short summary of the problem you have, not as a piece of crucial information (like showing error messages etc.). If you have a build error, then copy-paste (as text) the full and complete output into the question body."}, {"owner": {"reputation": 43, "user_id": 3927525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abb5a2507457a1f90fc42fb5ba13bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Roma", "link": "https://stackoverflow.com/users/3927525/roma"}, "reply_to_user": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542197163, "post_id": 53299635, "comment_id": 93480268, "body": "thnx for your comments, fixed :)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3927525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abb5a2507457a1f90fc42fb5ba13bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Roma", "link": "https://stackoverflow.com/users/3927525/roma"}, "edited": false, "score": 0, "creation_date": 1542201328, "post_id": 53300910, "comment_id": 93482674, "body": "thnx, out actual function return type is bool, but putting enable_if in function arguments also work."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 43, "user_id": 3927525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abb5a2507457a1f90fc42fb5ba13bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Roma", "link": "https://stackoverflow.com/users/3927525/roma"}, "edited": false, "score": 4, "creation_date": 1542202374, "post_id": 53300910, "comment_id": 93483354, "body": "@Roma - You can specify a second argument to <code>enable_if</code>, that it should expose as <code>::type</code>. So you can put it in the return type even if you need to return <code>bool</code>."}], "tags": [], "owner": {"reputation": 151, "user_id": 10518199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56a91a6618cb07e094d613494ea1dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa\u0142 G&#243;rczewski", "link": "https://stackoverflow.com/users/10518199/rafa%c5%82-g%c3%b3rczewski"}, "is_accepted": false, "score": 6, "last_activity_date": 1542200632, "creation_date": 1542200632, "answer_id": 53300910, "question_id": 53299635, "link": "https://stackoverflow.com/questions/53299635/template-function-argument-deduction-with-enable-if-reference-to-pointer/53300910#53300910", "title": "Template function argument deduction with enable_if - reference to pointer", "body": "<p>The feature that allows you to default a function template parameter was introduced in C++11. Your compiler actually does not have a full support for this feature. As a workaround, you can put <code>std::enable_if</code> as a function return type:</p>\n\n<pre><code>template&lt;typename T &gt;\ntypename std::enable_if&lt;std::is_same&lt;typename std::remove_reference&lt;T&gt;::type,A*&gt;::value&gt;::type f(T&amp;&amp; t) { \n    return;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3927525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abb5a2507457a1f90fc42fb5ba13bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Roma", "link": "https://stackoverflow.com/users/3927525/roma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542200920, "creation_date": 1542196351, "last_edit_date": 1542200920, "question_id": 53299635, "link": "https://stackoverflow.com/questions/53299635/template-function-argument-deduction-with-enable-if-reference-to-pointer", "title": "Template function argument deduction with enable_if - reference to pointer", "body": "<p>Maybe there is good solution that work on g++ 4.6.{3,4} ? \nYou can check in on <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">https://godbolt.org/</a> </p>\n\n<pre><code>#include &lt;type_traits&gt;\nclass A{};\nclass B{};\nclass C{\n    public:\n    A* a;\n    B* b;\n};\n\ntemplate&lt;typename T, typename std::enable_if&lt;std::is_same&lt;typename std::remove_reference&lt;T&gt;::type,A*&gt;::value&gt;::type* = nullptr &gt;\nvoid f(T&amp;&amp; t) { \n    return;\n}\n\nint main() { \n    C c;\n    auto&amp; cRef = c;\n    f(cRef.a);\n    f(c.a);\n}\n</code></pre>\n\n<p>g++ /tmp/enable_if.cpp -std=c++0x</p>\n\n<pre><code>/tmp/enable_if.cpp: In function \u2018int main()\u2019:\n/tmp/enable_if.cpp:20:13: error: no matching function for call to \u2018f(A*&amp;)\u2019\n/tmp/enable_if.cpp:20:13: note: candidate is:\n/tmp/enable_if.cpp:13:6: note: template&lt;class T, typename std::enable_if&lt;std::is_same&lt;typename std::remove_reference&lt;_MemPtr&gt;::type, A*&gt;::value, void&gt;::type* &lt;anonymous&gt; &gt; void f(T&amp;&amp;)\n/tmp/enable_if.cpp:21:10: error: no matching function for call to \u2018f(A*&amp;)\u2019\n/tmp/enable_if.cpp:21:10: note: candidate is:\n/tmp/enable_if.cpp:13:6: note: template&lt;class T, typename std::enable_if&lt;std::is_same&lt;typename std::remove_reference&lt;_MemPtr&gt;::type, A*&gt;::value, void&gt;::type* &lt;anonymous&gt; &gt; void f(T&amp;&amp;)\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1542196524, "post_id": 53299631, "comment_id": 93479893, "body": "What <code>free(this);</code> is supposed to do? It&#39;s unnecessary and causes the error."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1542196616, "post_id": 53299631, "comment_id": 93479954, "body": "Also, why pass <code>const int&amp;</code> instead of a plain <code>int</code>?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1542196639, "post_id": 53299631, "comment_id": 93479968, "body": "Remove the <code>free(this)</code> from the destructor.   Calling <code>free()</code> with an argument that was not returned by <code>malloc()</code> (or related functions, like <code>calloc()</code> or <code>realloc()</code>) gives undefined behaviour.   There is nothing in your code returned by <code>malloc()</code>, and doesn&#39;t need to be."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1542196691, "post_id": 53299631, "comment_id": 93479999, "body": "See also <i>rule of three</i> <a href=\"https://stackoverflow.com/a/34740363/509868\">here</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1542196858, "post_id": 53299631, "comment_id": 93480093, "body": "@anatolyg - rule of zero is more applicable here.   The class doesn&#39;t explicitly manage any resource, compiler-supplied default implementations of copy constructor, assignment operator, and destructor are fine."}, {"owner": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1542196986, "post_id": 53299631, "comment_id": 93480165, "body": "@HolyBlackCat using const int&amp; copies reference and makes variable read only. Hence, consuming less memory and avoiding any change to the variable"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1542198952, "post_id": 53299631, "comment_id": 93481312, "body": "@user9999486 &quot;<i>Hence, consuming less memory</i>&quot; Please show me example of system, where it would consume less memory. I, personally, cannot think of the use cases where it would consume less memory, while, simultaneously, I can think of cases, where it consumes more memory (64-bit systems, having 32-bit <code>int</code>s). 2) &quot;<i>and avoiding any change to the variable</i>&quot; Since the value would be passed by value, any changes you do, would be local to the function. Even if you want to disallow that, <code>const int</code> would accomplish the same."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "edited": false, "score": 0, "creation_date": 1542196796, "post_id": 53299687, "comment_id": 93480061, "body": "using delete is also terminating the program abnormally."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "edited": false, "score": 0, "creation_date": 1542197141, "post_id": 53299687, "comment_id": 93480252, "body": "@user9999486 <code>delete</code> must match a <code>new</code>, a <code>delete[]</code> must match a <code>new[]</code>. Nowhere in your code do you use <code>new</code>, so there shouldn&#39;t be any <code>delete</code>. As I said, it will be done automatically by the compiler since it is the compiler that allocates the objects."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "edited": false, "score": 0, "creation_date": 1542197315, "post_id": 53299687, "comment_id": 93480345, "body": "@user9999486 No, not in this example anyway."}, {"owner": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "edited": false, "score": 0, "creation_date": 1542197379, "post_id": 53299687, "comment_id": 93480379, "body": "how do we know that we need to add an explicit destructor in a class"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "edited": false, "score": 0, "creation_date": 1542197516, "post_id": 53299687, "comment_id": 93480453, "body": "@user9999486 If your class obtain a resource of any kind, then you need to release it in the destructor. Lets say your constructor allocates memory (explicitly using <code>new</code>) then that memory must be deallocated, typically in a destructor."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "reply_to_user": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "edited": false, "score": 0, "creation_date": 1542199076, "post_id": 53299687, "comment_id": 93481379, "body": "@user9999486 &quot;<i>how do we know that we need to add an explicit destructor in a class</i>&quot; Example class, where one would need destructor: <code>class A {int* p; A (): p (new int) {} ~A() {delete p;}};</code> Note: <code>p</code> might be resource of any kind, which might need to be freed."}], "tags": [], "owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1542197920, "last_edit_date": 1542197920, "creation_date": 1542196538, "answer_id": 53299687, "question_id": 53299631, "link": "https://stackoverflow.com/questions/53299631/overloading-subtraction-operator-cpp/53299687#53299687", "title": "Overloading subtraction operator cpp", "body": "<p>Never ever do <code>free(this)</code>, least of all in the destructor. The memory for the objects will be free'd outside of the destructor, either by the compiler generated code or by the user doing <code>delete</code> or <code>delete[]</code>.</p>\n\n<p>In fact this is the cause of your problem, as the objects created never were allocated with <code>malloc</code>.</p>\n\n<p>The proper solution in this case is to not only remove the <code>free</code> call, but the whole destructor, since it's not needed for this class.</p>\n"}], "owner": {"reputation": 31, "user_id": 9999486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f76963540622f844af16664491c1f261?s=128&d=identicon&r=PG&f=1", "display_name": "user9999486", "link": "https://stackoverflow.com/users/9999486/user9999486"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1542200993, "creation_date": 1542196342, "last_edit_date": 1542200993, "question_id": 53299631, "link": "https://stackoverflow.com/questions/53299631/overloading-subtraction-operator-cpp", "title": "Overloading subtraction operator cpp", "body": "<p>I'm a bit new to object oriented programming in c++ and I've been trying to overload subtraction(-) operator in c++ for a Complex class I created. It is working fine except my program is terminating abnormally.<br>Below is what I've been trying to do:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;cstdlib&gt;\nclass Complex{\n    //Data-members\nprivate:\n    int re, im;\n\n    //methods\npublic:\n    //Constructor\n    Complex(){ /*default Constructor*/ }\n    Complex(const int&amp; re_, const int&amp; im_):re(re_), im(im_){}\n    //Subtraction(-) operator overloading\n    Complex operator-(const Complex&amp; op)\n    {\n        Complex res(this-&gt;re - op.re, this-&gt;im - op.im);\n        return res;\n    }\n    //get-set methods for re\n    int getReal(){ return re; }\n    void setReal(const int&amp; re){ this-&gt;re = re; }\n    //get-set methods for im\n    int getImaginary(){ return im; }\n    void setImaginary(const int&amp; im){ this-&gt;im = im; }\n    //Destructor\n    ~Complex(){ free(this); }\n};\n\nint main()\n{\n    Complex a(2, 3), b(3, 5);\n    Complex d = a - b;\n    std::cout&lt;&lt;\"d.re = \"&lt;&lt;d.getReal()&lt;&lt;\" d.im = \"&lt;&lt;d.getImaginary()&lt;&lt;\"\\n\";\n    return 0;\n}\n</code></pre>\n\n<p>Can anyone please explain the cause of error.</p>\n"}, {"tags": ["c++", "ubuntu", "smartcontracts", "eos"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542196394, "post_id": 53299568, "comment_id": 93479819, "body": "Have you looked at the paths that are indicated by the link you sent  /usr/local/include/eosiolib/ Was apt install successful?"}, {"owner": {"reputation": 1783, "user_id": 2333145, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XefgM.jpg?s=128&g=1", "display_name": "Luther", "link": "https://stackoverflow.com/users/2333145/luther"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542196572, "post_id": 53299568, "comment_id": 93479926, "body": "@MatthieuBrucher Yes, the install was successful, I did not see any error message. I&#39;ve looked in the /usr/local/include/ path but &quot;eosiolib&quot; is missing"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542196923, "post_id": 53299568, "comment_id": 93480130, "body": "Well, that&#39;s the location said they should be, so you should ask EOS directly!"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1542197953, "post_id": 53299568, "comment_id": 93480685, "body": "Unless the debian file is really special, you can see which files it contains (and thus installs to your filesystem) with <code>dpkg -c eosio.cdt-1.3.2.x86_64.deb</code>"}, {"owner": {"reputation": 1783, "user_id": 2333145, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XefgM.jpg?s=128&g=1", "display_name": "Luther", "link": "https://stackoverflow.com/users/2333145/luther"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1542198973, "post_id": 53299568, "comment_id": 93481330, "body": "@Botje thanks, the CDT files are stored in /usr/opt/eosio.cdt/"}], "answers": [{"tags": [], "owner": {"reputation": 1783, "user_id": 2333145, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XefgM.jpg?s=128&g=1", "display_name": "Luther", "link": "https://stackoverflow.com/users/2333145/luther"}, "is_accepted": false, "score": 1, "last_activity_date": 1542199212, "creation_date": 1542199212, "answer_id": 53300475, "question_id": 53299568, "link": "https://stackoverflow.com/questions/53299568/eos-cdt-where-are-the-h-and-the-cpp-files-stored-in-the-filesystem-i-need/53300475#53300475", "title": "EOS CDT: where are the *.h and the *.cpp files stored in the filesystem, I need reference to them to compile", "body": "<p>Based on Botje's comment:</p>\n\n<p><em>\"Unless the debian file is really special, you can see which files it contains (and thus installs to your filesystem) with dpkg -c eosio.cdt-1.3.2.x86_64.deb\"</em></p>\n\n<p>using the command: </p>\n\n<p>dpkg -c eosio.cdt-1.3.2.x86_64.deb</p>\n\n<p>The folder where the files are installed are shown:</p>\n\n<p>The CDT files are stored in <strong>/usr/opt/eosio.cdt/</strong> </p>\n"}, {"tags": [], "owner": {"reputation": 1564, "user_id": 618661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e91ff5db329c92d956d0bdf519675b75?s=128&d=identicon&r=PG", "display_name": "Lonkly", "link": "https://stackoverflow.com/users/618661/lonkly"}, "is_accepted": false, "score": 1, "last_activity_date": 1542966385, "creation_date": 1542966385, "answer_id": 53444170, "question_id": 53299568, "link": "https://stackoverflow.com/questions/53299568/eos-cdt-where-are-the-h-and-the-cpp-files-stored-in-the-filesystem-i-need/53444170#53444170", "title": "EOS CDT: where are the *.h and the *.cpp files stored in the filesystem, I need reference to them to compile", "body": "<p>For MacOS users reference, when installing with Brew include paths are located at</p>\n\n<pre><code>/usr/local/Cellar/eosio.cdt/1.4.1/opt/eosio.cdt/include/\n</code></pre>\n\n<p>(Please use your own version instead of 1.4.1 if applicable)</p>\n"}], "owner": {"reputation": 1783, "user_id": 2333145, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XefgM.jpg?s=128&g=1", "display_name": "Luther", "link": "https://stackoverflow.com/users/2333145/luther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1542966385, "creation_date": 1542196162, "question_id": 53299568, "link": "https://stackoverflow.com/questions/53299568/eos-cdt-where-are-the-h-and-the-cpp-files-stored-in-the-filesystem-i-need", "title": "EOS CDT: where are the *.h and the *.cpp files stored in the filesystem, I need reference to them to compile", "body": "<p>I'm trying to use the EOS CDT (contract development toolkit).</p>\n\n<p>I've downloaded and installed the repository from github, and used to following commands, as indicated from the eos.io development page.</p>\n\n<p><a href=\"https://developers.eos.io/eosio-home/docs/installing-the-contract-development-toolkit\" rel=\"nofollow noreferrer\">https://developers.eos.io/eosio-home/docs/installing-the-contract-development-toolkit</a></p>\n\n<p>console commands:</p>\n\n<p><em>wget <a href=\"https://github.com/eosio/eosio.cdt/releases/download/v1.3.2/eosio.cdt-1.3.2.x86_64.deb\" rel=\"nofollow noreferrer\">https://github.com/eosio/eosio.cdt/releases/download/v1.3.2/eosio.cdt-1.3.2.x86_64.deb</a></em></p>\n\n<p><em>sudo apt install ./eosio.cdt-1.3.2.x86_64.deb</em></p>\n\n<p>I can't find the reference to the h and cpp files in ubuntut's (16.04.5) filesystem.\nWhere are they?</p>\n\n<p>I need to reference them for compiling the test codes and the examples.\nI'm also using visual studio code ide.</p>\n"}, {"tags": ["c++", "ssl", "openssl", "network-programming"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 2, "creation_date": 1542196284, "post_id": 53299498, "comment_id": 93479747, "body": "You seem to be doing what the manual suggests, if it is a socket error you may be able to squeeze some information out of <code>errno</code> using <code>std::strerror(errno)</code>?"}, {"owner": {"reputation": 8349, "user_id": 1599260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05a92ec76b4f33674a0eca13ca56c3bd?s=128&d=identicon&r=PG", "display_name": "Rost", "link": "https://stackoverflow.com/users/1599260/rost"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1542201903, "post_id": 53299498, "comment_id": 93483077, "body": "Yes, good idea, its working!"}], "answers": [{"tags": [], "owner": {"reputation": 8349, "user_id": 1599260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05a92ec76b4f33674a0eca13ca56c3bd?s=128&d=identicon&r=PG", "display_name": "Rost", "link": "https://stackoverflow.com/users/1599260/rost"}, "is_accepted": true, "score": 2, "last_activity_date": 1543822938, "creation_date": 1543822938, "answer_id": 53589405, "question_id": 53299498, "link": "https://stackoverflow.com/questions/53299498/how-to-get-openssl-bio-do-connect-failure-reason/53589405#53589405", "title": "How to get OpenSSL BIO_do_connect() failure reason?", "body": "<p>This approach finally works for me:</p>\n\n<pre><code>    const auto sysErrorCode = errno;\n    const auto sslErrorCode = ERR_get_error();\n\n    std::string errorDescription;\n    if (sslErrorCode != 0) errorDescription = ERR_error_string(sslErrorCode, nullptr);\n    if (sysErrorCode != 0)\n    {\n        if (!errorDescription.empty()) errorDescription += '\\n';\n        errorDescription += \"System error, code=\" + std::to_string(sysErrorCode);\n        errorDescription += \", \";\n        errorDescription += strerror(sysErrorCode);\n    }\n</code></pre>\n"}], "owner": {"reputation": 8349, "user_id": 1599260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05a92ec76b4f33674a0eca13ca56c3bd?s=128&d=identicon&r=PG", "display_name": "Rost", "link": "https://stackoverflow.com/users/1599260/rost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 53589405, "answer_count": 1, "score": 1, "last_activity_date": 1543822938, "creation_date": 1542195946, "question_id": 53299498, "link": "https://stackoverflow.com/questions/53299498/how-to-get-openssl-bio-do-connect-failure-reason", "title": "How to get OpenSSL BIO_do_connect() failure reason?", "body": "<p>I'm using Ubuntu 18.04/gcc 7.3/OpenSSL 1.1.0g to make C++ app performing TLS/SSL connection with non-blocking BIO API.</p>\n\n<p>When <code>BIO_do_connect()</code> fails connecting, e.g. if using wrong host name or port, there is no errors reported by OpenSSL. <code>ERR_get_error()</code> returns zero and <code>ERR_print_errors_xx()</code> doesn't print anything.</p>\n\n<p>So the question is - how to get actual connection failure reason, e.g. 'Connection refused' or 'Host not resolved' etc?</p>\n\n<p>Used code snippet below:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n\n#include \"openssl/bio.h\"\n#include \"openssl/err.h\"\n#include \"openssl/ssl.h\"\n\nint main(int argc, char *argv[])\n{\n    OPENSSL_init_ssl(OPENSSL_INIT_SSL_DEFAULT, nullptr);\n\n    std::cout &lt;&lt; OpenSSL_version(OPENSSL_VERSION) &lt;&lt; std::endl;\n\n    SSL_CTX* ctx = SSL_CTX_new(TLS_client_method());\n    if (!ctx)\n    {\n        std::cerr &lt;&lt; \"Error creating SSL context:\" &lt;&lt; std::endl;\n        ERR_print_errors_fp(stderr);\n        return 1;\n    }\n\n    SSL_CTX_set_options(ctx, SSL_OP_NO_SSLv2);\n    SSL_CTX_set_options(ctx, SSL_OP_NO_SSLv3);\n\n    if(!SSL_CTX_load_verify_locations(ctx,\n        \"/etc/ssl/certs/ca-certificates.crt\",\n        nullptr))\n    {\n        std::cerr &lt;&lt; \"Error loading trust store into SSL context\" &lt;&lt; std::endl;\n        ERR_print_errors_fp(stderr);\n        return 1;\n    }\n\n    BIO* cbio = BIO_new_ssl_connect(ctx);\n\n    SSL* ssl = nullptr;\n    BIO_get_ssl(cbio, &amp;ssl);\n    SSL_set_mode(ssl, SSL_MODE_AUTO_RETRY);\n\n    BIO_set_conn_hostname(cbio, \"not_actually_existing_host.com:https\");\n    BIO_set_nbio(cbio, 1);\n\n    std::cout &lt;&lt; \"Start connecting\" &lt;&lt; std::endl;\n\n    next:\n    if (BIO_do_connect(cbio) &lt;= 0)\n    {\n        if (!BIO_should_retry(cbio))\n        {\n            std::cerr &lt;&lt; \"Error attempting to connect:\" &lt;&lt; std::endl;\n            ERR_print_errors_fp(stderr); // &lt;---- PRINTS NOTHING!!!\n            BIO_free_all(cbio);\n            SSL_CTX_free(ctx);\n            return 1;\n        }\n        else goto next;\n    }\n\n    std::cout &lt;&lt; \"Connected OK\" &lt;&lt; std::endl;\n\n    BIO_free_all(cbio);\n    SSL_CTX_free(ctx);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "dll", "visual-studio-2015", "dll-reference", "project-properties"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1542201743, "post_id": 53299297, "comment_id": 93482954, "body": "You talk about this as though it is a C# or VB.NET project but what you describe is normal for a C++ project.  It matters, don&#39;t force us to guess.  No, msbuild is powerless to discover dependencies of native executables.  If that DLL is not located on the PATH so the OS can find it then you have to help.  Just xcopy /d in the postbuild event."}, {"owner": {"reputation": 85, "user_id": 3008262, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a9a45d9c6394cb2712d6aed84c68e14d?s=128&d=identicon&r=PG&f=1", "display_name": "Sakuragaoka", "link": "https://stackoverflow.com/users/3008262/sakuragaoka"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1542291366, "post_id": 53299297, "comment_id": 93522877, "body": "You&#39;re right, I forgot to mention it&#39;s a C++ project. Thanks for making me aware of it! Question edited..."}, {"owner": {"reputation": 1874, "user_id": 2392247, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c75972031d4bef871cc9cb8da36a67f9?s=128&d=identicon&r=PG", "display_name": "user34660", "link": "https://stackoverflow.com/users/2392247/user34660"}, "edited": false, "score": 0, "creation_date": 1542302060, "post_id": 53299297, "comment_id": 93529795, "body": "Programmers are constantly being confusing by saying <i>DLL</i> and <i>DLL project</i> and are constantly confused by <i>DLL</i> and <i>DLL project</i> when the type of DLL is not defined. There are native DLLs (the original, raw format) and there are COM DLLs and there are .Net Class Library DLLs. If my <a href=\"http://simplesamples.info/CPluPlus/NativeWindowsDynamicLinkLibraries.aspx\" rel=\"nofollow noreferrer\">Native Windows Dynamic Link Libraries (DLLs)</a> helps then I can post some of that as an answer. You cannot make a reference to a native style DLL."}], "owner": {"reputation": 85, "user_id": 3008262, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a9a45d9c6394cb2712d6aed84c68e14d?s=128&d=identicon&r=PG&f=1", "display_name": "Sakuragaoka", "link": "https://stackoverflow.com/users/3008262/sakuragaoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542291297, "creation_date": 1542195297, "last_edit_date": 1542291297, "question_id": 53299297, "link": "https://stackoverflow.com/questions/53299297/how-to-use-a-3rd-party-dll-in-a-c-dll-project", "title": "How to use a 3rd party DLL in a C++ DLL project?", "body": "<p>In Visual Studio 2015, how do I properly set up a C++ DLL project that in turn refers to a 3rd party DLL (also implemented in C++)? I cannot add the 3rd party DLL to the references as it seems for a DLL project the \"Browse...\" option in the \"Add reference...\" window is missing (as opposed to the \"Add reference...\" window of an EXE project where there is such a \"Browse...\" button). As a consequence I cannot build the project. Is there another way to add that reference? Thanks for helping!</p>\n"}, {"tags": ["c++", "data-structures", "graph-theory"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542195698, "post_id": 53299261, "comment_id": 93479402, "body": "Why? If you have the components, you can figure out how they are connected together and then create your new graph."}, {"owner": {"reputation": 95, "user_id": 6095563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/767799cc90257a7a0dc3b29e54e70618?s=128&d=identicon&r=PG", "display_name": "WhoCares", "link": "https://stackoverflow.com/users/6095563/whocares"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542195777, "post_id": 53299261, "comment_id": 93479436, "body": "After creating new graph, I have to apply a topological sorting algorithm. Thats why."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542195855, "post_id": 53299261, "comment_id": 93479483, "body": "You need to clarify your question. It is easy to create a new graph with the components, but your constraints are not here."}, {"owner": {"reputation": 95, "user_id": 6095563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/767799cc90257a7a0dc3b29e54e70618?s=128&d=identicon&r=PG", "display_name": "WhoCares", "link": "https://stackoverflow.com/users/6095563/whocares"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542195950, "post_id": 53299261, "comment_id": 93479537, "body": "Consider me a newbie on this stuff. Thats why I am asking."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 8113571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0sjU.jpg?s=128&g=1", "display_name": "Mohaimin66", "link": "https://stackoverflow.com/users/8113571/mohaimin66"}, "is_accepted": true, "score": 1, "last_activity_date": 1542348710, "creation_date": 1542348710, "answer_id": 53332379, "question_id": 53299261, "link": "https://stackoverflow.com/questions/53299261/minimum-number-of-nodes-that-traverse-entire-graph/53332379#53332379", "title": "minimum number of nodes that traverse entire graph", "body": "<p>If there is no cycle in the graph i.e. the graph is a Directed Acyclic Graph (DAG), then we just need to count the indegrees for each node. The set of nodes with indegree 0 is the required set.</p>\n\n<p>In case you are not familiar with indegree, if there is an edge <em>a->b</em> then indegree of <em>b</em> increases by 1. </p>\n\n<p>This works because, if there is an edge <em>a->b</em> i.e. <em>b</em> has an indegree it means there is a node <em>a</em> from which <em>b</em> is reachable. So it is always better to include  node <em>a</em> to the set instead of <em>b</em>. A node with indegree 0 has no other way to get visited unless we start with the node itself. So it will be included in the set.</p>\n\n<p>In case there is a cycle in the graph, we search for Strongly Connected Components(SCC). Then we have build a new graph considering a SCC as one node and add edges from initial graph which connect two different SCC's. The new graph will be a DAG. Then we can apply the above procedure to find the required set of nodes.</p>\n"}], "owner": {"reputation": 95, "user_id": 6095563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/767799cc90257a7a0dc3b29e54e70618?s=128&d=identicon&r=PG", "display_name": "WhoCares", "link": "https://stackoverflow.com/users/6095563/whocares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 53332379, "answer_count": 1, "score": 0, "last_activity_date": 1542348710, "creation_date": 1542195220, "last_edit_date": 1542265825, "question_id": 53299261, "link": "https://stackoverflow.com/questions/53299261/minimum-number-of-nodes-that-traverse-entire-graph", "title": "minimum number of nodes that traverse entire graph", "body": "<p><strong>Note:</strong> The question is entirely changed.</p>\n\n<p>In the following graph, we can traverse entire graph if we select the nodes 0 and 2. I am looking for an efficient algorithm which returns this two nodes. Note that this is neither vertex-cover problem nor dominating-set problem since we don't need to select node 3. We say that, if we select node 0, we can go to node 1 from there and if we select node 2, we can go to node 3 and then node 4 from there. </p>\n\n<p>If I run a <strong>SCC algorithm</strong> on it, it finds all vertices as a different SCC and I can't go from there to anywhere:</p>\n\n<pre><code>C:\\&gt;project2 ../../input.txt o.txt\nFollowing are strongly connected components in given graph (Each line is a different SCC)\n2\n4\n3\n0\n1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fEW4X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fEW4X.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1542195144, "post_id": 53299200, "comment_id": 93479106, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7665021/c-member-initialization-list\">C++ Member Initialization List</a>"}, {"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1542195177, "post_id": 53299200, "comment_id": 93479114, "body": "Related: <a href=\"https://stackoverflow.com/q/926752/1025391\">stackoverflow.com/q/926752/1025391</a>"}, {"owner": {"reputation": 31, "user_id": 6130628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c3f13d93fa8e2fea5e5e9081ff0b5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Saleem", "link": "https://stackoverflow.com/users/6130628/awais-saleem"}, "reply_to_user": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1542203813, "post_id": 53299200, "comment_id": 93484362, "body": "in print.cpp it sys &#39;data&#39; has no member &#39;location&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 3, "last_activity_date": 1542195144, "creation_date": 1542195144, "answer_id": 53299229, "question_id": 53299200, "link": "https://stackoverflow.com/questions/53299200/how-can-i-initialize-struct-data-members-in-constructor/53299229#53299229", "title": "How can I initialize struct data members in Constructor?", "body": "<p>They are already initialized for the default coinstructor (which shoudl proably be <code>=default</code> instead).</p>\n\n<p>Then just use the initialization list:</p>\n\n<pre><code>data::data(std::string loc, int year, int month):loc(std::move(loc)), year(year), month(month) {\n}\n</code></pre>\n\n<p>Include string properly as well:</p>\n\n<pre><code>#include &lt;string&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6130628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c3f13d93fa8e2fea5e5e9081ff0b5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Saleem", "link": "https://stackoverflow.com/users/6130628/awais-saleem"}, "edited": false, "score": 0, "creation_date": 1542195822, "post_id": 53299318, "comment_id": 93479465, "body": "thanks for your help can you please clarify that how can i use in data.cpp file at the time of initialization"}, {"owner": {"reputation": 1110, "user_id": 5778465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xnd4J.jpg?s=128&g=1", "display_name": "snake_style", "link": "https://stackoverflow.com/users/5778465/snake-style"}, "reply_to_user": {"reputation": 31, "user_id": 6130628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c3f13d93fa8e2fea5e5e9081ff0b5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Saleem", "link": "https://stackoverflow.com/users/6130628/awais-saleem"}, "edited": false, "score": 0, "creation_date": 1542196068, "post_id": 53299318, "comment_id": 93479607, "body": "Sorry, what do you mean &quot;use data.cpp at time of initialization&quot;?"}, {"owner": {"reputation": 31, "user_id": 6130628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c3f13d93fa8e2fea5e5e9081ff0b5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Saleem", "link": "https://stackoverflow.com/users/6130628/awais-saleem"}, "edited": false, "score": 0, "creation_date": 1542200386, "post_id": 53299318, "comment_id": 93482109, "body": "for example in temp.h     <code>data d;     Node(std::string id, int year, int month); and in temp.cpp    Node::Node(std::string id, int year, int month) and in print.cpp I want to get a location     Node * n;     cout&lt;&lt;n-&gt;data-&gt;location;</code>"}, {"owner": {"reputation": 31, "user_id": 6130628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c3f13d93fa8e2fea5e5e9081ff0b5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Saleem", "link": "https://stackoverflow.com/users/6130628/awais-saleem"}, "edited": false, "score": 0, "creation_date": 1542200714, "post_id": 53299318, "comment_id": 93482298, "body": "it says &quot;data&quot; has no member &quot;location&quot; I can share print.cpp and temp.h and temp.cpp"}], "tags": [], "owner": {"reputation": 1110, "user_id": 5778465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xnd4J.jpg?s=128&g=1", "display_name": "snake_style", "link": "https://stackoverflow.com/users/5778465/snake-style"}, "is_accepted": false, "score": 0, "last_activity_date": 1542195559, "last_edit_date": 1542195559, "creation_date": 1542195347, "answer_id": 53299318, "question_id": 53299200, "link": "https://stackoverflow.com/questions/53299200/how-can-i-initialize-struct-data-members-in-constructor/53299318#53299318", "title": "How can I initialize struct data members in Constructor?", "body": "<p>Initializing data in constructor is done like this:</p>\n\n<pre><code>data::data() : \n    location(\"\"), year(0), month(0)\n{\n} \n\ndata::data(std::string loc, int year, int month) : \n    location(loc), year(year), month(month)\n{\n}\n</code></pre>\n\n<p>In some other cpp file, for example, main.cpp, you can use this like that:</p>\n\n<pre><code>#include &lt;iostream&gt;    \n#include \"data.h\"\n\nint main()\n{    \n// initializing\n    data obj(\"NY\", 2018, 11);\n\n// using  \n    std::cout &lt;&lt; \"Year:  \" &lt;&lt; obj.year &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Month: \" &lt;&lt; obj.month &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Loc:   \" &lt;&lt; obj.location &lt;&lt; std::endl;\n\n// setting properties\n    obj.year = 2100;\n    obj.month = 1;\n    std::cout &lt;&lt; \"Year:  \" &lt;&lt; obj.year &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Month: \" &lt;&lt; obj.month &lt;&lt; std::endl;\n\n// initializing by default values\n    data obj2();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10651270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U1ai7kyeo7E/AAAAAAAAAAI/AAAAAAAAAB4/_AzysO9DC3M/photo.jpg?sz=128", "display_name": "Exlife", "link": "https://stackoverflow.com/users/10651270/exlife"}, "is_accepted": false, "score": 1, "last_activity_date": 1542197089, "last_edit_date": 1542197089, "creation_date": 1542196327, "answer_id": 53299626, "question_id": 53299200, "link": "https://stackoverflow.com/questions/53299200/how-can-i-initialize-struct-data-members-in-constructor/53299626#53299626", "title": "How can I initialize struct data members in Constructor?", "body": "<p>in your \"data.cpp\", you can initialize the members like this:</p>\n\n<pre><code>#include \"data.h\"\n#include \"string\"\nusing namespace std;\ndata::data() : year(0), month(0) {\n    //initialize the data members (location,year,month)\n    //in fact, 'location' donot need initialization, \n    //because the member will be constructed first as \n    //a empty string before give control to user-defined constructor.\n    location = \"\";\n} \ndata::data(std::string loc, int _year, int _month)\n    year(_year), month(_month) {\n    //initialize the data members (location,year,month)\n    location = loc; // or location.assign(loc);\n}\n</code></pre>\n\n<p>when you use the structure in other cpp file, you may use is like this:</p>\n\n<pre><code>#include \"data.h\"\ndata x; //call default constructor: data();\n//since struct 's member is implicitly public, \n//you can access them from outside of its defination.\nx.location = \"your location\";\nx.location.assign(\"some other place\");\nx.location.append(\"etc\");\nx.year = 2018;\nx.month = 11;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1542228360, "last_edit_date": 1542228360, "creation_date": 1542227691, "answer_id": 53308336, "question_id": 53299200, "link": "https://stackoverflow.com/questions/53299200/how-can-i-initialize-struct-data-members-in-constructor/53308336#53308336", "title": "How can I initialize struct data members in Constructor?", "body": "<p>Don't overcomplicate this. If you start coding, don't split your code up in too many files.</p>\n\n<p>Other than that, learn about struct member initialization. Either <a href=\"https://stackoverflow.com/q/17080975/1025391\">on this site</a> or at <a href=\"https://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\">your favorite documentation page</a>.</p>\n\n<p>For member access you use the arrow-operator when you have a pointer to an object, vs. the dot-operator that you use when you have the object directly. For further reading:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/1238613/1025391\">What is the difference between the dot (.) operator and -&gt; in C++?</a></li>\n<li><a href=\"https://en.cppreference.com/w/cpp/language/operator_member_access#Built-in_member_access_operators\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/operator_member_access#Built-in_member_access_operators</a></li>\n</ul>\n\n<p>Here's example code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nstruct data {\n    int x_;\n    // use member initialization list to init the data value directly\n    data(int x) : x_(x) {}\n};\n\nstruct node {\n    data data_;\n    // use member initialization list to init the data value directly\n    node(int x) : data_(x) {}\n};\n\nint main() {\n    // create object\n    node n(42);\n    // acquire pointer to object\n    node *p = &amp;n;\n    // use arrow to access member with pointer, use dot to access with object\n    std::cout &lt;&lt; p-&gt;data_.x_ &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>$ g++ test.cc &amp;&amp; ./a.out\n42\n</code></pre>\n\n<p>And because it seems you might be into implementing some sort of data structure, you might also want to learn about object lifetime and ownership issues with manual memory management. So some references for further education:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/106508/1025391\">What is a smart pointer and when should I use one?</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=JfmTagWcqoE\" rel=\"nofollow noreferrer\">CppCon 2016: Herb Sutter \u201cLeak-Freedom in C++... By Default.\u201d</a></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 6130628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1c3f13d93fa8e2fea5e5e9081ff0b5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Awais Saleem", "link": "https://stackoverflow.com/users/6130628/awais-saleem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1542228360, "creation_date": 1542194991, "last_edit_date": 1542203708, "question_id": 53299200, "link": "https://stackoverflow.com/questions/53299200/how-can-i-initialize-struct-data-members-in-constructor", "title": "How can I initialize struct data members in Constructor?", "body": "<p>I am using <code>data.h</code> file which have the following code</p>\n\n<pre><code>#ifndef __DATA_h_INCLUDED__\n#define __DATA_h_INCLUDED__\n\n#include \"string\"\n\nstruct data {\n    std::string location=\"\";\n    int year = 0, month = 0;\n\n    data();\n    data(std::string location, int year, int month);\n};\n\n#endif\n</code></pre>\n\n<p>and the <code>data.cpp</code> file looks like this</p>\n\n<pre><code>#include \"data.h\"\n#include \"string\"\n\nusing namespace std;\n\ndata::data() {\n    //initialize the data members (location,year,month)\n} \n\ndata::data(std::string loc, int year, int month) {\n    //initialize the data members (location,year,month)\n}\n</code></pre>\n\n<p>in some other .cpp file how can i get these values and initialize these values.</p>\n\n<p>node.h</p>\n\n<pre><code>struct Node {\ndata d;\n\nNode(std::string id, int year, int month); \n\n};\n</code></pre>\n\n<p>node.cpp</p>\n\n<pre><code>Node::Node(string id, int year, int month){\n// here i want to initialize 'data' \n\n}\n</code></pre>\n\n<p>print.cpp</p>\n\n<pre><code>Node* node;\ncout&lt;&lt;node-&gt;data-&gt;location;\n</code></pre>\n"}, {"tags": ["c++", "qt", "qt5", "qtreeview", "libconfig"], "comments": [{"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1542196548, "post_id": 53299167, "comment_id": 93479909, "body": "QVariant... can also <a href=\"http://doc.qt.io/qt-5/qvariant.html#type\" rel=\"nofollow noreferrer\">filter which type is being used</a>."}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1542197125, "post_id": 53299167, "comment_id": 93480240, "body": "May I ask what is the use of <code>if (role != Qt::EditRole) return false;</code> in <code>TreeModel::setData()</code>? Also the example provided uses <code>if (role != Qt::DisplayRole &amp;&amp; role != Qt::EditRole) return QVariant();</code>. In your <code>TreeModel::data()</code>, <code>role != Qt::EditRole</code> was removed. Is there explanation for this as well?"}, {"owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1542303707, "post_id": 53299167, "comment_id": 93530663, "body": "you could publish your project on github and thus be able to test your code easily"}, {"owner": {"reputation": 47, "user_id": 9735024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ec1a398b0aa4716b4895cc3594aa7c?s=128&d=identicon&r=PG&f=1", "display_name": "Minikornio", "link": "https://stackoverflow.com/users/9735024/minikornio"}, "edited": false, "score": 0, "creation_date": 1542368800, "post_id": 53299167, "comment_id": 93553208, "body": "I have tried you example @vahancho , but it is still not working. I have updated the main comment showing the problem."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9735024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ec1a398b0aa4716b4895cc3594aa7c?s=128&d=identicon&r=PG&f=1", "display_name": "Minikornio", "link": "https://stackoverflow.com/users/9735024/minikornio"}, "edited": false, "score": 0, "creation_date": 1543588974, "post_id": 53314406, "comment_id": 93984713, "body": "it should have been &amp;&amp; instead of this || !! now it works"}], "tags": [], "owner": {"reputation": 18971, "user_id": 2674506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvQN8.jpg?s=128&g=1", "display_name": "vahancho", "link": "https://stackoverflow.com/users/2674506/vahancho"}, "is_accepted": false, "score": 0, "last_activity_date": 1542267103, "creation_date": 1542267103, "answer_id": 53314406, "question_id": 53299167, "link": "https://stackoverflow.com/questions/53299167/how-to-avoid-to-delete-treemodel-info-when-editing/53314406#53314406", "title": "How to avoid to delete treemodel info when editing?", "body": "<p>I think the problem is that your <code>TreeModel::data()</code> function, according to the code you provided, always returns an empty data when requested role is not display role. This means that if you bring a node into edit mode the editor (line edit) shows nothing. When you move the focus, the editor closes and sets its empty value to the model. That's why you get this '0'.</p>\n\n<p>To fix this behavior you need to expose the same data in edit mode as in display mode, i.e. you code should look like:</p>\n\n<pre><code>QVariant TreeModel::data(const QModelIndex &amp;index, int role) const\n{\n  if (!index.isValid())\n    return QVariant();\n\n  // Returns the same data both in display and edit modes.\n  if (role == Qt::DisplayRole || role == Qt::EditRole)\n  {\n    TreeItem *item = static_cast&lt;TreeItem *&gt;(index.internalPointer());\n    return item-&gt;data(index.column());\n  }\n  return QAbstractItemModel::data(index, role);\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9735024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ec1a398b0aa4716b4895cc3594aa7c?s=128&d=identicon&r=PG&f=1", "display_name": "Minikornio", "link": "https://stackoverflow.com/users/9735024/minikornio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1542368685, "creation_date": 1542194890, "last_edit_date": 1542368685, "question_id": 53299167, "link": "https://stackoverflow.com/questions/53299167/how-to-avoid-to-delete-treemodel-info-when-editing", "title": "How to avoid to delete treemodel info when editing?", "body": "<p>Good morning. I have finally created a treeconfig program to read a txt, then edit it in the interface, and then save it, but I have a problem.</p>\n\n<p>I know that there is a treemodel example that is editable (<a href=\"http://doc.qt.io/qt-5/qtwidgets-itemviews-editabletreemodel-example.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qtwidgets-itemviews-editabletreemodel-example.html</a>), but this one is not using libconfig.h++</p>\n\n<p>I decided to use libconfig.h++ in my linux because I can filter which kind of information is appearing in the values (int/string/...), because in the other example without libconfig, it uses qVariant, and accept all the types of inputs.</p>\n\n<p>So even comparing with the other example, I am not able to make the following work:\nMy problem is that when I try to edit one value, the information inside dissapears, and if I click outside the value, it becomes 0. How can I avoid this both things? I want to edit a string in the middle for example, or just not to delete then info when missclicking or something.</p>\n\n<p>The images below show an attempt at editing the value for confTimeout. Note that the text inside disappears when it is clicked into edit-mode <em>and</em> that the text sets to 0 when it is clicked out of focus.</p>\n\n<p><img src=\"https://i.stack.imgur.com/eMHYc.png\" alt=\"\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/w9HD7.png\" alt=\"\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/O1WI2.png\" alt=\"\"></p>\n\n<p>mainwindow.cpp</p>\n\n<pre><code>#include \"mainwindow.h\"\n#include \"ui_mainwindow.h\"\n\n#include &lt;QTextStream&gt;\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n}\n\nvoid MainWindow::setConfig(libconfig::Config *config)\n{\n    tm = std::make_unique&lt;TreeModel&gt;(config, this);\n    ui-&gt;treeView-&gt;setModel(tm.get());\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n\n/*\nvoid MainWindow::on_treeView_activated(const QModelIndex &amp;index)\n{\n    QString val = ui-&gt;treeView-&gt;model()-&gt;data(index).toString();\n    ui-&gt;lineEdit-&gt;setText(val);\n}\n\n*/\n\nvoid MainWindow::on_pushButton_clicked()\n{\n    tm-&gt;saveSettings();\n}\n</code></pre>\n\n<p>treeitem.cpp</p>\n\n<pre><code>#include \"treeitem.h\"\n#include &lt;libconfig.h++&gt;\n\nstatic QVariant getIndexOrName(const libconfig::Setting &amp;setting)\n{\n    if (!setting.isRoot()) {\n        const auto &amp;parent = setting.getParent();\n        if (parent.isArray() || parent.isList())\n            return setting.getIndex();\n    }\n\n    return setting.getName();\n}\n\nstatic QVariant getValueOrSize(const libconfig::Setting &amp;setting)\n{\n    using namespace libconfig;\n    switch (setting.getType()) {\n    // scalar types\n    case Setting::TypeInt:\n        return setting.operator int();\n\n    case Setting::TypeInt64:\n        return setting.operator long long();\n\n    case Setting::TypeFloat:\n        return setting.operator double();\n\n    case Setting::TypeString:\n        return setting.c_str();\n\n    case Setting::TypeBoolean:\n        return setting.operator bool();\n\n\n    // aggregate types\n    case Setting::TypeGroup:\n        return QString{\"Group. Size: %1\"}.arg(setting.getLength());\n\n    case Setting::TypeArray:\n        return QString{\"Array. Size: %1\"}.arg(setting.getLength());\n\n    case Setting::TypeList:\n        return QString{\"List. Size: %1\"}.arg(setting.getLength());\n\n\n    // not used\n    case Setting::TypeNone:\n        break;\n    }\n\n    return QVariant{};\n}\n\nstatic bool setValue(libconfig::Setting &amp;setting, const QVariant &amp;value)\n{\n    using namespace libconfig;\n    switch (setting.getType()) {\n    // scalar types\n    case Setting::TypeInt:\n        if (value.canConvert(QVariant::Int)) {\n            setting = value.toInt();\n            return true;\n        }\n    case Setting::TypeInt64:\n        if (value.canConvert(QVariant::LongLong)) {\n            setting = value.toLongLong();\n            return true;\n        }\n    case Setting::TypeFloat:\n        if (value.canConvert(QVariant::Double)) {\n            setting = value.toFloat();\n            return true;\n        }\n    case Setting::TypeString:\n        if (value.canConvert(QVariant::String)) {\n            setting = value.toString().toStdString();\n            return true;\n        }\n    case Setting::TypeBoolean:\n        if (value.canConvert(QVariant::Bool)) {\n            setting = value.toBool();\n            return true;\n        }\n    default:\n        break;\n    }\n\n    return false;\n}\n\nTreeItem::TreeItem(libconfig::Setting *setting, TreeItem *parentItem)\n    : m_setting{setting}, m_parentItem{parentItem}\n{\n    if (setting-&gt;isAggregate()) {\n        for (auto &amp;setting : *setting) {\n            m_subSettings.push_back(new TreeItem(&amp;setting, this));\n        }\n    }\n}\n\nTreeItem::~TreeItem() { qDeleteAll(m_subSettings); }\n\nTreeItem *TreeItem::child(int row) { return m_subSettings.at(row); }\n\nint TreeItem::childCount() const { return m_subSettings.size(); }\n\nint TreeItem::columnCount() const { return 2; }\n\nQVariant TreeItem::data(int column) const\n{\n    switch (column) {\n    case 0:\n        return getIndexOrName(*m_setting);\n    case 1:\n        return getValueOrSize(*m_setting);\n    default:\n        return QVariant{};\n    }\n}\n\nbool TreeItem::setData(const QVariant &amp;value)\n{\n    if (m_setting-&gt;isAggregate())\n        return false;\n\n    return setValue(*m_setting, value);\n}\n\nint TreeItem::row() const\n{\n    if (!m_parentItem)\n        return 0;\n\n    return m_parentItem-&gt;m_subSettings.indexOf(const_cast&lt;TreeItem *&gt;(this));\n}\n\nTreeItem *TreeItem::parentItem() { return m_parentItem; }\n</code></pre>\n\n<p>treemodel</p>\n\n<pre><code>    #include \"treemodel.h\"\n    #include \"treeitem.h\"\n\n    #include &lt;QFile&gt;\n    #include &lt;libconfig.h++&gt;\n    #include &lt;QDateTime&gt;\n\n    TreeModel::TreeModel(libconfig::Config *config, QObject *parent)\n        : QAbstractItemModel{parent}, m_rootSetting{std::make_unique&lt;TreeItem&gt;(\n                                                        &amp;(config-&gt;getRoot()), nullptr)}, m_config{config}\n    {\n    }\n\n    TreeModel::~TreeModel()\n    {\n    }\n\n    QVariant TreeModel::data(const QModelIndex &amp;index, int role) const\n    {\n        if (!index.isValid())\n            return QVariant();\n\n        if (role != Qt::DisplayRole)\n            return QVariant();\n\n        TreeItem *item = static_cast&lt;TreeItem*&gt;(index.internalPointer());\n\n        return item-&gt;data(index.column());\n    }\n\n    bool TreeModel::setData(const QModelIndex &amp;index, const QVariant &amp;value, int role)\n    {\n        if (!index.isValid())\n            return false;\n\n        if (role != Qt::EditRole)\n            return false;\n\n        TreeItem *item = static_cast&lt;TreeItem*&gt;(index.internalPointer());\n        return item-&gt;setData(value);\n    }\n\n    Qt::ItemFlags TreeModel::flags(const QModelIndex &amp;index) const\n    {\n\n        if (!index.isValid())\n            //return Qt::NoItemFlags;\n            return 0;\n\n        //return QAbstractItemModel::flags(index);\n        return Qt::ItemIsEditable | QAbstractItemModel::flags(index);\n    }\n\n    QVariant TreeModel::headerData(int section, Qt::Orientation orientation,\n                                   int role) const\n    {\n        if (orientation != Qt::Horizontal || role != Qt::DisplayRole)\n            return QVariant{};\n\n        switch (section) {\n        case 0:\n            return \"Name\";\n        case 1:\n            return \"Value\";\n        default:\n            return QVariant{};\n        }\n    }\n\nQModelIndex TreeModel::index(int row, int column,\n                             const QModelIndex &amp;parent) const\n{\n    if (!hasIndex(row, column, parent))\n        return QModelIndex();\n\n    TreeItem *parentItem;\n\n    if (!parent.isValid())\n        parentItem = m_rootSetting.get();\n    else\n        parentItem = static_cast&lt;TreeItem*&gt;(parent.internalPointer());\n\n    TreeItem *childItem = parentItem-&gt;child(row);\n    if (childItem)\n        return createIndex(row, column, childItem);\n    else\n        return QModelIndex();\n}\n\nQModelIndex TreeModel::parent(const QModelIndex &amp;index) const\n{\n    if (!index.isValid())\n        return QModelIndex();\n\n    TreeItem *childItem = static_cast&lt;TreeItem *&gt;(index.internalPointer());\n    TreeItem *parentItem = childItem-&gt;parentItem();\n\n    if (parentItem == m_rootSetting.get())\n        return QModelIndex();\n\n    return createIndex(parentItem-&gt;row(), 0, parentItem);\n}\n\nint TreeModel::rowCount(const QModelIndex &amp;parent) const\n{\n    TreeItem *parentItem;\n    if (parent.column() &gt; 0)\n        return 0;\n\n    if (!parent.isValid())\n        parentItem = m_rootSetting.get();\n    else\n        parentItem = static_cast&lt;TreeItem*&gt;(parent.internalPointer());\n\n    return parentItem-&gt;childCount();\n}\n\nint TreeModel::columnCount(const QModelIndex &amp;parent) const\n{\n    if (parent.isValid())\n        return static_cast&lt;TreeItem*&gt;(parent.internalPointer())-&gt;columnCount();\n    else\n        return m_rootSetting-&gt;columnCount();\n}\n\nbool TreeModel::saveSettings(QString filename) const\n{\n    if (filename.isEmpty())\n        filename = QString::fromLocal8Bit(m_config-&gt;getRoot().getSourceFile());\n    QString today = QDateTime::currentDateTime().toString(\"_yyyy.MM.dd_hh:mm\");\n    QFile::copy(filename, filename+today+\".backup\");\n    try {\n        m_config-&gt;writeFile(filename.toLocal8Bit().constData());\n    } catch (...) {\n        return false;\n    }\n\n    return true;\n}\n</code></pre>\n\n<p>o</p>\n\n<p>o</p>\n\n<p>o</p>\n\n<p>o</p>\n\n<p>EDIT:::</p>\n\n<p>First of all, thanks @vahancho and @trebuchetMS\n.\nI have tried with vahancho example, but it throws an issue</p>\n\n<p><a href=\"https://i.stack.imgur.com/eMHYc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eMHYc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also I tried with with other combinations, but he idea is not to allow for example a \"string\" where a \"int\" should be placed.</p>\n\n<p>I have also checked again the editableTreeModel of QtExamples, but it allows a string where a int should be placed, and I do not want this</p>\n\n<pre><code>QVariant TreeModel::data(const QModelIndex &amp;index, int role) const\n{\n    if (!index.isValid())\n        return QVariant();\n\n    if (role != Qt::DisplayRole &amp;&amp; role != Qt::EditRole)\n        return QVariant();\n\n    TreeItem *item = getItem(index);\n\n    return item-&gt;data(index.column());\n}\n</code></pre>\n\n<p>Any idea?</p>\n"}, {"tags": ["c++", "rust", "shared-ptr", "ffi"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1542195149, "post_id": 53299119, "comment_id": 93479109, "body": "Is it at all possible for you to design your code in such a way that either C++ or Rust owns the object and manages its lifetime?  You could trigger a callback when it is destroyed, to tell the &quot;other&quot; language to stop holding references to it."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "edited": false, "score": 0, "creation_date": 1542197165, "post_id": 53299119, "comment_id": 93480272, "body": "You can also return a <code>new shared_ptr&lt;Foo&gt;(...)</code>... a bit like the double <code>Box</code> trick that is done sometimes from the Rust side."}, {"owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542197572, "post_id": 53299119, "comment_id": 93480475, "body": "Just to clarify this is an existing c++ library and I can&#39;t control how the pointer is created. I just get given a shared_ptr&lt;Foo&gt;  from a function."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1542201300, "post_id": 53299119, "comment_id": 93482649, "body": "So you want to be able to access to pointer inner type ?"}, {"owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1542201551, "post_id": 53299119, "comment_id": 93482826, "body": "@Stargateur yep but I don&#39;t want it to be free&#39;d while I&#39;m using it and if I just use the raw pointer I can&#39;t guarantee that."}], "answers": [{"comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 3, "creation_date": 1542195769, "post_id": 53299350, "comment_id": 93479433, "body": "<i>&quot;C++ abi is not stable&quot;</i> -&gt; &quot;Is not specified&quot;"}, {"owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1542195786, "post_id": 53299350, "comment_id": 93479444, "body": "That means it has not been stabilized I guess :)"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1542195848, "post_id": 53299350, "comment_id": 93479478, "body": "It&#39;s a difference, because is has not been stabilized means (IMHO), that is about to stabilize and there is a standard for it. Not specified means there no specification at all."}, {"owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542196200, "post_id": 53299350, "comment_id": 93479688, "body": "Thanks for the suggestion. If I return a raw pointer how do I make sure c++ doesn&#39;t free the pointer? <code>Foo * create_foo() { shared_ptr&lt;Foo&gt; smart_p = lib::create_foo(); return smart_p.get(); } </code> Here smart_p&#39;s desctructor will be called at the end of the function and if its the last one it will free the pointer"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "reply_to_user": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542196570, "post_id": 53299350, "comment_id": 93479923, "body": "@Tom good question, that&#39;s up to you. I would suggest creating a struct that contains the shared pointer and if rust decides to give up the struct (e.g. call <code>destroy_foo</code>) you will also drop the shared pointer."}, {"owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1542197766, "post_id": 53299350, "comment_id": 93480577, "body": "@hellow Yeh that&#39;s what I&#39;m thinking. Basically rust holds a struct that has the shared_ptr as an opaque_blob and returns it to c++ for destruction when I&#39;m done with it. The downside is all work on the Foo must be done by passing it back to c++"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "reply_to_user": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542197818, "post_id": 53299350, "comment_id": 93480606, "body": "@Tom I would say, that&#39;s worth a new question."}, {"owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1542199037, "post_id": 53299350, "comment_id": 93481358, "body": "@E_net4 That&#39;s correct, thanks, I did not know it is so. What to use for owning a C pointer then?"}, {"owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1542199859, "post_id": 53299350, "comment_id": 93481807, "body": "@E_net4 At first, it is a link-only comment, at second, the <code>Box::from_raw</code> is used there, and third, it is about exporting Rust object to the outside, not import <code>C</code> pointers into <code>Rust</code> - there is a difference a little."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1542200202, "post_id": 53299350, "comment_id": 93482013, "body": "Again &quot;stable C ABI&quot;, there is no such thing, the rule are the same than C++ &quot;may change between compiler versions&quot; because as C++ and Rust. The C ABI &quot;Is not specified&quot;."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1542200409, "post_id": 53299350, "comment_id": 93482121, "body": "Right, sorry, I&#39;m currently in a poor position to go into details. The C API has to expose a freeing function. In Rust land, we may then make a wrapper type that calls this function on  drop."}, {"owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1542200696, "post_id": 53299350, "comment_id": 93482288, "body": "@Stargateur Okay, should I be more clear then, like to say that the only thing we need is to disable name mangling for the symbol? I was probably mistaken because name mangling is a part of ABI."}, {"owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1542200803, "post_id": 53299350, "comment_id": 93482341, "body": "@E_net4 You&#39;re right, we have to use the same (de)allocation mechanism everywhere: new/delete, malloc/free and so on, because there may be different allocators we don&#39;t know about or at least other things like internal structure pointers which we will simply not deallocate using <code>free</code>.  So, it is still an open question what to use for wrapping C code then."}, {"owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1542201767, "post_id": 53299350, "comment_id": 93482976, "body": "@E_net4 I have added my own version of code I&#39;d write for this thing. Could you check it out please?"}, {"owner": {"reputation": 269539, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 2, "creation_date": 1542297215, "post_id": 53299350, "comment_id": 93526834, "body": "TL;DR: <i>How do you work with a C++ shared_ptr&lt;T&gt; in FFI?</i> \u2014 <b>you don&#39;t</b>."}], "tags": [], "owner": {"reputation": 12555, "user_id": 1750757, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Zmc7D.jpg?s=128&g=1", "display_name": "Victor Polevoy", "link": "https://stackoverflow.com/users/1750757/victor-polevoy"}, "is_accepted": false, "score": 4, "last_activity_date": 1542297172, "last_edit_date": 1542297172, "creation_date": 1542195432, "answer_id": 53299350, "question_id": 53299119, "link": "https://stackoverflow.com/questions/53299119/how-do-you-work-with-a-c-function-that-returns-a-shared-ptrt-when-calling-it/53299350#53299350", "title": "How do you work with a C++ function that returns a shared_ptr&lt;T&gt; when calling it from Rust over FFI?", "body": "<p><code>std::shared_ptr</code> is a C++ class and a non-trivial type that can not be exported as is from a library \u2014 you need its definition in your target language to conform to the one in C++. To use FFI you need to provide your library functions with a simple C ABI (the C++ ABI is not stable and may change between compiler versions (as might Rust's ABI)) and I doubt that all of functions related to <code>std::shared_ptr</code> are such, so there is one more obstacle for that.</p>\n\n<p>I'd suggest to return a raw C-pointer from your library instead and own it in Rust.</p>\n\n<p>Even in C++, to load a C++ library you provide C-ABI functions (via <code>extern C</code>) to gain access to a pointer of your type and then you use it in C++ as how as you want.</p>\n\n<p>So, a few points:</p>\n\n<ol>\n<li><p>Return a raw C pointer from a function without name mangling so that we know its name and can link to it:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>extern \"C\" Foo* create_foo();\n</code></pre></li>\n<li><p>Add a deleter which knows how to properly deallocate the object:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>extern \"C\" void delete_foo(Foo *);\n</code></pre></li>\n<li><p>Let the library user (Rust) decide how to own it, for example, by <code>boxing</code> the value and using it with atomic reference counter via <code>std::sync::Arc</code> (as <code>std::shared_ptr</code> does):</p>\n\n<pre><code>extern \"C\" {\n    fn create_foo() -&gt; *mut Foo;\n    fn delete_foo(p: *mut Foo);\n}\n\nstruct MyFoo {\n    raw: *mut Foo,\n}\n\nimpl MyFoo {\n    fn new() -&gt; MyFoo {\n        unsafe { MyFoo { raw: create_foo() } }\n    }\n}\n\nimpl Drop for MyFoo {\n    fn drop(&amp;mut self) {\n        unsafe {\n            delete_foo(self.raw);\n        }\n    }\n}\n\nfn main() {\n    use std::sync::Arc;\n\n    let value = Arc::new(MyFoo::new());\n    let another_value = value.clone();\n    println!(\"Shared counter: {}\", Arc::strong_count(&amp;value));\n}\n</code></pre></li>\n<li><p>Let the C++ side forget about owning this pointer - you can't rely on it if it is used from outside the library and you give a raw pointer to it.</p></li>\n</ol>\n\n<p>If you don't have any access to the library sources, can't do anything with it: the <code>std::shared_ptr</code> object will not release the pointer ever and we can't make it not to delete the pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1542204393, "post_id": 53301874, "comment_id": 93484743, "body": "I <i>think</i> that <code>std::shared_ptr&lt;Foo&gt; &amp;&amp;create_foo()</code> is wrong and makes no sense at all."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1542204951, "post_id": 53301874, "comment_id": 93485136, "body": "@E_net4 Yes I just create something that compile in Rust, but indeed this struct need to match the actual struct <code>std::shared_ptr</code> if not Rust can&#39;t move it correctly."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 0, "creation_date": 1542205148, "post_id": 53301874, "comment_id": 93485255, "body": "@hellow I not sure too, as we tell to rust to use C semantic, I suppose it doesn&#39;t but in this case <code>destroy_foo(std::shared_ptr&lt;Foo&gt; &amp;&amp;foo)</code> also don&#39;t make sense. Because rust will copy the value ? is this work ? I really don&#39;t know."}, {"owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542244565, "post_id": 53301874, "comment_id": 93503045, "body": "In you&#39;re example if we wrap the shared_ptr&lt;Foo&gt; in a struct and make it opaque then we can maintain ownership and still get the raw ptr eg: <code>struct SmartPtr {</code> <code>smart_ptr: opaque_blob[u64; 2],</code> <code>raw_ptr: * mut Foo,</code> <code>}</code>"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542247169, "post_id": 53301874, "comment_id": 93503562, "body": "@Tom That a bad idea to keep the raw pointer separate of shared_ptr, in my exemple I do it but I would advise you to create a structure that hide the raw pointer of shared_ptr."}, {"owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542249404, "post_id": 53301874, "comment_id": 93504051, "body": "@Stargateur if this is not done then what prevents c++ from calling the destructor at the end of get_foo?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "reply_to_user": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "edited": false, "score": 0, "creation_date": 1542285729, "post_id": 53301874, "comment_id": 93519440, "body": "@Tom It&#39;s a reference ? <code>get_foo()</code> do not own shared_ptr, it don&#39;t have the right to call the destructor. It&#39;s just I give you this temporally."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": false, "score": 2, "last_activity_date": 1542297287, "last_edit_date": 1542297287, "creation_date": 1542203680, "answer_id": 53301874, "question_id": 53299119, "link": "https://stackoverflow.com/questions/53299119/how-do-you-work-with-a-c-function-that-returns-a-shared-ptrt-when-calling-it/53301874#53301874", "title": "How do you work with a C++ function that returns a shared_ptr&lt;T&gt; when calling it from Rust over FFI?", "body": "<blockquote>\n  <p>I can't just take the raw pointer because then the C++ code is unaware that I have a reference to <code>Foo</code> and might calls it's deconstructor.</p>\n</blockquote>\n\n<p>Yes and no. With your actual example. C++ will give ownership of the <code>shared_ptr</code> to the one who called <code>create_foo</code>, so C++ knows that there is still something that owns the pointer.</p>\n\n<p>You need to add a <code>get</code> function that will get the value for you without losing ownership of the pointer, something like this:</p>\n\n<pre><code>extern \"C\" {\n    std::shared_ptr&lt;Foo&gt; create_foo() {\n        // do the thing\n    }\n    /* or maybe this\n    std::shared_ptr&lt;Foo&gt; &amp;&amp;create_foo() {\n        // do the thing\n    }\n    */\n\n    Foo *get_foo(std::shared_ptr&lt;Foo&gt; &amp;foo) {\n        foo.get();\n    }\n\n    void destroy_foo(std::shared_ptr&lt;Foo&gt; foo) {\n    }\n    /* or maybe this\n    void destroy_foo(std::shared_ptr&lt;Foo&gt; &amp;&amp;foo) {\n    }\n    */\n}\n</code></pre>\n\n<p>Also <code>shared_ptr&lt;Foo&gt;</code> is not valid C, so I don't know if bindgen and C++ with accept this (probably a warning) but that is already present in your code.</p>\n\n<p>On the Rust side, you could do this:</p>\n\n<pre><code>// must be generated by bindgen and this might create a lot of problems\n// this need to be the same struct as the shared_ptr on the C++ side.\n// if even one octet is not correct you will run into bugs\n// BE SURE that bindgen don't implement Copy for this\nstruct shared_ptr&lt;T&gt;; \n\nstruct Foo(i32);\n\nextern \"C\" {\n    fn create_foo() -&gt; shared_ptr&lt;Foo&gt;;\n\n    fn get_foo(foo: &amp;shared_ptr&lt;Foo&gt;) -&gt; *mut Foo;\n\n    fn destroy_foo(foo: shared_ptr&lt;Foo&gt;);\n}\n\nfn main() {\n    unsafe {\n        let my_shared_foo = create_foo();\n        let foo = get_foo(&amp;my_shared_foo);\n        (*foo).0;\n        destroy_foo(my_shared_foo);\n    }\n}\n</code></pre>\n\n<p>Of course this is just an example, and nothing is really safe in any of this. And as I can't test, please let me know if I wrote something that doesn't work. <code>bindgen</code> should do the job.</p>\n"}, {"tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": false, "score": -1, "last_activity_date": 1542217369, "last_edit_date": 1542217369, "creation_date": 1542216912, "answer_id": 53305861, "question_id": 53299119, "link": "https://stackoverflow.com/questions/53299119/how-do-you-work-with-a-c-function-that-returns-a-shared-ptrt-when-calling-it/53305861#53305861", "title": "How do you work with a C++ function that returns a shared_ptr&lt;T&gt; when calling it from Rust over FFI?", "body": "<p>You can return a pointer to a dynamically allocated <code>std::shared_ptr</code></p>\n\n<p>In the C++ side:</p>\n\n<pre class=\"lang-cxx prettyprint-override\"><code>shared_ptr&lt;Foo&gt; create_foo();\nextern \"C\" void *rust_create_foo()\n{\n    shared_ptr&lt;Foo&gt; foo = create_foo();\n    return static_cast&lt;void*&gt;(new shared_ptr&lt;Foo&gt;(foo));        \n}\nextern \"C\" void rust_delete_foo(void *ptr)\n{\n    shared_ptr&lt;Foo&gt; *foo = static_cast&lt;shared_ptr&lt;Foo&gt;*&gt;(ptr);\n    delete foo;\n}\n</code></pre>\n\n<p>And in the Rust side:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>extern \"C\" {\n    pub fn rust_create_foo() -&gt; *const c_void;\n    pub fn rust_delete_foo(foo: *const c_void);\n}\n</code></pre>\n\n<p>If you fail to call <code>rust_delete_foo</code> then the dynamically allocated pointer will leak and so the object will never be deallocated.</p>\n\n<p>Then, when you want to use the object, you will have to write wrapper functions that take that <code>void*</code>, do the cast and call the appropriate function.</p>\n"}], "owner": {"reputation": 126, "user_id": 10651210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f82885b4b34d792d719830d3159ce1?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10651210/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1542297287, "creation_date": 1542194750, "last_edit_date": 1542296983, "question_id": 53299119, "link": "https://stackoverflow.com/questions/53299119/how-do-you-work-with-a-c-function-that-returns-a-shared-ptrt-when-calling-it", "title": "How do you work with a C++ function that returns a shared_ptr&lt;T&gt; when calling it from Rust over FFI?", "body": "<p>C++</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>shared_ptr&lt;Foo&gt; create_foo();\n</code></pre>\n\n<p>Rust</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>extern \"C\" {\n    pub fn create_foo() -&gt; ???;\n}\n</code></pre>\n\n<p>Bindgen turns a <code>shared_ptr</code> into an opaque blob.</p>\n\n<p>I can't just take the raw pointer because then the C++ code is unaware that I have a reference to <code>Foo</code> and might call its deconstructor.</p>\n"}, {"tags": ["c++", "windows-10", "cygwin", "clion", "32-bit"], "answers": [{"comments": [{"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1542226657, "post_id": 53308086, "comment_id": 93496904, "body": "Wait do you mean the <code>setup-x86.exe</code> from <a href=\"https://cygwin.com/install.html\" rel=\"nofollow noreferrer\">cygwin.com/install.html</a> ? Because I thought it is just the executable for the installer GUI for a 32bit Windows version? Or does it have the toolchain to compile 32bit programs??"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "reply_to_user": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 1, "creation_date": 1542226782, "post_id": 53308086, "comment_id": 93496965, "body": "<code>setup-x86.exe</code> install Cygwin 32 bit , <code>setup-x86_64.exe</code> install cygwin 64 bit. The two sytems offer almost all the same packages"}, {"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1542227057, "post_id": 53308086, "comment_id": 93497090, "body": "Alright see the problem for me is that I see dozent of packages and I just can&#39;t figure out what I need. You mentioned that the <i>simple</i> way is to install the 32bit of cygwin. Can you tell me what that exactly is? Do you mean a specific compiler or a .dll and what is it full qualifing name to look for in the package manager?"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "reply_to_user": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 1, "creation_date": 1542227297, "post_id": 53308086, "comment_id": 93497212, "body": "Why you need to build a 32bit program on your 64bit Cygwin ?"}, {"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1542227521, "post_id": 53308086, "comment_id": 93497299, "body": "I don&#39;t really know what you mean with &quot;on your 64bit Cygwin&quot;. I <i>simply</i> need to compile a program as 32bit for windows. And suggested to use 32bit Cygwin. Maybe I don&#39;t really understand what Cygwin is? You sound like Cygwin is an own operation system I want to compile for? Do I misunderstand something here very much?"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "reply_to_user": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 1, "creation_date": 1542227827, "post_id": 53308086, "comment_id": 93497427, "body": "Cygwin is a Posix enviroment, it acts as pseudo-OS on top of Windows. Cygwin program are different from windows one and require the <code>cygwin1.dll</code> as foundation of their behaviour. There are two flavours, one for 32bit and one for 64bit. Windows at 64bit can run both. Windows at 32bit only Cygwin at 32bit"}, {"owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1542228200, "post_id": 53308086, "comment_id": 93497603, "body": "Wow ok then I am on a dead end here it seems. So to compile purely for windows and not for any special-OS environment there is not alternative besides Visual C++ compiler?"}, {"owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "reply_to_user": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "edited": false, "score": 0, "creation_date": 1542228369, "post_id": 53308086, "comment_id": 93497673, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/183659/discussion-between-matzeri-and-xetra11\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 6281, "user_id": 5105383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YCB5.jpg?s=128&g=1", "display_name": "matzeri", "link": "https://stackoverflow.com/users/5105383/matzeri"}, "is_accepted": false, "score": 0, "last_activity_date": 1542226443, "creation_date": 1542226443, "answer_id": 53308086, "question_id": 53299112, "link": "https://stackoverflow.com/questions/53299112/compiling-a-32bit-c-program-with-cygwin-on-win10-clion-wont-work-with-any-c/53308086#53308086", "title": "Compiling a 32bit C++ program with CygWin on Win10 &amp; CLion won&#39;t work with any compiler", "body": "<p>It seems as first that you need to define if you want to build a windows program or a cygwin one. They are not the same as any cygwin program depends on the cygwin1.dll of his own architecture. </p>\n\n<p>On a 64bit system <code>x86_64-pc-cygwin-gcc.exe</code> is the same than <code>gcc.exe</code> and the same of \n<code>x86_64-pc-cygwin-gcc-7.3.0.exe</code>.<br>\n<a href=\"https://cygwin.com/packages/x86_64/gcc-core/gcc-core-7.3.0-3\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/gcc-core/gcc-core-7.3.0-3</a><br>\nThey all produce a 64 bit cygwin program.</p>\n\n<p>The simple way to produce a 32bit cygwin program is to install the 32bit version of cygwin and to work on that. Cygwin 32bit and 64bit can be installed in parallel and do not interfere each other.</p>\n\n<p>The alternative solution, not recommended, is to use the cross compiler from 64 to 32 bit: cygwin32-gcc-core and the associate binutils<br>\n<a href=\"https://cygwin.com/packages/x86_64/cygwin32-gcc-core/cygwin32-gcc-core-7.3.0-1\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/cygwin32-gcc-core/cygwin32-gcc-core-7.3.0-1</a>\n<a href=\"https://cygwin.com/packages/x86_64/cygwin32-binutils/cygwin32-binutils-2.29-1\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/cygwin32-binutils/cygwin32-binutils-2.29-1</a></p>\n\n<p>If you are trying to build a Windows program you need to use a cross compiler from Cygwin 64 bit to Windows.\nFor 64 bit target you need :mingw64-x86_64-gcc-core and mingw64-x86_64-binutils\n<a href=\"https://cygwin.com/packages/x86_64/mingw64-x86_64-gcc-core/mingw64-x86_64-gcc-core-7.3.0-1\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/mingw64-x86_64-gcc-core/mingw64-x86_64-gcc-core-7.3.0-1</a>\n<a href=\"https://cygwin.com/packages/x86_64/mingw64-x86_64-binutils/mingw64-x86_64-binutils-2.31.1.be46fa23-1\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/mingw64-x86_64-binutils/mingw64-x86_64-binutils-2.31.1.be46fa23-1</a></p>\n\n<p>For 32bit target you need: mingw64-i686-gcc-core and mingw64-i686-binutils\n<a href=\"https://cygwin.com/packages/x86_64/mingw64-i686-gcc-core/mingw64-i686-gcc-core-7.3.0-1\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/mingw64-i686-gcc-core/mingw64-i686-gcc-core-7.3.0-1</a>\n<a href=\"https://cygwin.com/packages/x86_64/mingw64-i686-binutils/mingw64-i686-binutils-2.31.1.be46fa23-1\" rel=\"nofollow noreferrer\">https://cygwin.com/packages/x86_64/mingw64-i686-binutils/mingw64-i686-binutils-2.31.1.be46fa23-1</a></p>\n\n<p>No compiler on cygwin is built with double architecture capability.</p>\n"}], "owner": {"reputation": 4354, "user_id": 5967828, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/fJ7P2.jpg?s=128&g=1", "display_name": "xetra11", "link": "https://stackoverflow.com/users/5967828/xetra11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542226443, "creation_date": 1542194719, "last_edit_date": 1542197261, "question_id": 53299112, "link": "https://stackoverflow.com/questions/53299112/compiling-a-32bit-c-program-with-cygwin-on-win10-clion-wont-work-with-any-c", "title": "Compiling a 32bit C++ program with CygWin on Win10 &amp; CLion won&#39;t work with any compiler", "body": "<p>I know this is a very often asked question and I really browsed through all of the answers already but I could not find my problem and the solution for it as well.</p>\n\n<h2> Preface</h2>\n\n<p>Using the Cygwin Toolchain within CLion to build a 64bit C++ program worked like a charm. No errors or whatsoever. I then tried to do the same for 32bit and quickly realised it is a lot harder to understand.</p>\n\n<p><strong>CMakeList</strong></p>\n\n<p>Here I added the <code>-m32</code> flag to the already working <code>CMakeLists.txt</code></p>\n\n<pre><code># cmake_minimum_required(VERSION &lt;specify CMake version here&gt;)\nproject(my_program)\n\nset(CMAKE_CXX_STANDARD 14)\nset(CMAKE_CXX_FLAGS -m32)\n\nadd_library(my_program SHARED library.cpp)\n</code></pre>\n\n<p>I then used CygWin to download plenty of c++ compilers just to get sure I have at least one of them that might work.</p>\n\n<p>Here is the way I configure it for the 32bit build</p>\n\n<p><a href=\"https://i.stack.imgur.com/g47SH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g47SH.png\" alt=\"enter image description here\"></a></p>\n\n<p>After doing so <code>CMake</code> is rebuilding the build files and then I started compiling the project.</p>\n\n<p>Following Error messages appear (truncated because they actually all are the same but with different \"missing\" libraries that couldn't be found)</p>\n\n<pre><code>C:\\Users\\xetra11\\.CLion2018.2\\system\\cygwin_cmake\\bin\\cmake.exe --build /cygdrive/c/Development/Github/CoopR-HQ-Extension/cmake-build-default --target all -- -j 10\n[ 50%] Linking CXX shared library cygCoopR_HQ_Extension.dll\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0//libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0//libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/libgcc_s.dll.a when searching for -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lgcc_s\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0//libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/libgcc.a when searching for -lgcc\n/usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lgcc\n</code></pre>\n\n<p><strong>C++ compilers used</strong>\nThese are the compilers I tried to use. They all yield slighty different error messages but all are unified in the rant for not finding a library</p>\n\n<p><strong>Cygwin compilers</strong>:</p>\n\n<ul>\n<li>C:\\cygwin64\\bin\\x86_64-pc-cygwin-gcc.exe (<em>the one used in this\nquestion</em>)</li>\n<li>C:\\cygwin64\\bin\\x86_64-pc-cygwin-gcc-7.3.0.exe</li>\n<li>C:\\cygwin64\\bin\\x86_64-pc-cygwin-g++.exe </li>\n<li>C:\\cygwin64\\bin\\x86_64-pc-cygwin-c++.exe </li>\n<li>C:\\cygwin64\\bin\\i686-pc-cygwin-c++.exe (<strong>broken</strong> CMake threw errors: <a href=\"https://pastebin.com/781WG6Ec\" rel=\"nofollow noreferrer\">link</a>)</li>\n<li>C:\\cygwin64\\bin\\i686-pc-cygwin-cpp.exe (<strong>broken</strong> CMake threw errors: <a href=\"https://pastebin.com/781WG6Ec\" rel=\"nofollow noreferrer\">link</a>)</li>\n<li>C:\\cygwin64\\bin\\i686-pc-cygwin-g++.exe (<strong>error</strong> occured: <a href=\"https://stackoverflow.com/questions/31600600/compilation-error-stddef-h-no-such-file-or-directory\">link</a>)</li>\n<li>C:\\cygwin64\\bin\\i686-pc-cygwin-gcc-6.4.0.exe (<strong>broken</strong> CMake threw errors: <a href=\"https://pastebin.com/781WG6Ec\" rel=\"nofollow noreferrer\">link</a>)</li>\n<li>C:\\cygwin64\\bin\\i686-pc-cygwin-gcc.exe (<strong>broken</strong> CMake threw errors: <a href=\"https://pastebin.com/781WG6Ec\" rel=\"nofollow noreferrer\">link</a>)</li>\n</ul>\n\n<p><strong>MinGW compilers</strong>:</p>\n\n<ul>\n<li>C:\\cygwin64\\bin\\x86_64-w64-mingw32-c++.exe</li>\n<li>C:\\cygwin64\\bin\\x86_64-w64-mingw32-cpp.exe (<strong>broken</strong> CMake threw errors: <a href=\"https://pastebin.com/781WG6Ec\" rel=\"nofollow noreferrer\">link</a>)</li>\n<li>C:\\cygwin64\\bin\\x86_64-w64-mingw32-g++.exe </li>\n<li>C:\\cygwin64\\bin\\x86_64-w64-mingw32-gcc-6.4.0.exe </li>\n<li>C:\\cygwin64\\bin\\x86_64-w64-mingw32-gcc.exe </li>\n<li>C:\\cygwin64\\bin\\i686-w64-mingw32-c++.exe (<strong>no errors</strong>)</li>\n</ul>\n\n<p>The last one did not threw any errors but when checking the .DLL with <em>Dependency Walker</em> I found out that all linked .DLLs to this still rely on x64 and therefore <code>Error: Modules with different CPU types were found.</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/5dhCo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5dhCo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am a bit tired now and really would appreciate some hints how to get this stuff build the right way. I already think I understood the fact that I have to bring in 32bit libraries. But I don't really know how and why. I assumed that the toolchain have this out of the box.</p>\n\n<p>Please mind that I am fairly unused to C++ on windows.</p>\n"}, {"tags": ["c++", "raspberry-pi", "i2c"], "comments": [{"owner": {"reputation": 441, "user_id": 3705763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R4BCb.jpg?s=128&g=1", "display_name": "Adashi", "link": "https://stackoverflow.com/users/3705763/adashi"}, "edited": false, "score": 0, "creation_date": 1542794290, "post_id": 53298980, "comment_id": 93693765, "body": "Have you tried using option &quot;i&quot; instead of &quot;s&quot;? You can also easily use bash or Python to implement it by calling i2cget directly"}], "owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542194300, "creation_date": 1542194300, "question_id": 53298980, "link": "https://stackoverflow.com/questions/53298980/writing-a-double-to-i2c-device", "title": "Writing a double to I2C device", "body": "<p>When I try to use <code>i2cset</code> on my raspberryPI with mode for <code>SMBus block data</code> it is saying <code>Error: Adapter does not have SMBus block write capability</code>.</p>\n\n<pre><code># sudo i2cset -y 3 0x20 0x01 0xDE 0xAD 0xC0 0xDE 0x00 0xFF s\nError: Adapter does not have SMBus block write capability\n</code></pre>\n\n<p>I looked at the WiringPi code and it has 2 functions to write data on I2C. The first uses byte data and the second a word data. It is missing the (SMBus block data) and the (I2C block data). So I suppose that RaspberryPi's do not support it.</p>\n\n<p>I want to implement a C++ code that write a double to the i2c on my raspberryPi. To write an int I am already doing.</p>\n\n<pre><code>root@sense4:~/i2c-tests# sudo i2cset -y 3 0x20 0x00 0x1f\nroot@sense4:~/i2c-tests# sudo i2cget -y 3 0x20 0x00\n0x1f\n</code></pre>\n\n<p>C++ code:</p>\n\n<pre><code>int I2CTools::write8(int value) {\n    union i2c_smbus_data data;\n\n    data.byte = value;\n\n    return i2c_smbus_access(i2cFileDescriptor, I2C_SMBUS_WRITE, 0x00, I2C_SMBUS_BYTE_DATA, &amp;data);\n}\nint I2CTools::read8() {\n\n    union i2c_smbus_data data;\n\n    if (i2c_smbus_access(i2cFileDescriptor, I2C_SMBUS_READ, 0x00, I2C_SMBUS_BYTE_DATA, &amp;data))\n        return -1;\n    else\n        return data.byte &amp; 0xFF;\n}\n</code></pre>\n\n<p>Now I suppose that I have to loop over the address like this:</p>\n\n<pre><code>root@sense4:~/i2c-tests# sudo i2cset -y 3 0x20 0x00 0x1f ; sudo i2cset -y 3 0x20 0x01 0x85 ; sudo i2cset -y 3 0x20 0x02 0xeb ; sudo i2cset -y 3 0x20 0x03 0x51 ; sudo i2cset -y 3 0x20 0x04 0xb8 ; sudo i2cset -y 3 0x20 0x05 0x1e ; sudo i2cset -y 3 0x20 0x06 0x09 ; sudo i2cset -y 3 0x20 0x07 0x40\nroot@sense4:~/i2c-tests# sudo i2cget -y 3 0x20 0x00 ;sudo i2cget -y 3 0x20 0x01 ; sudo i2cget -y 3 0x20 0x02 ; sudo i2cget -y 3 0x20 0x03 ; sudo i2cget -y 3 0x20 0x04 ; sudo i2cget -y 3 0x20 0x05 ; sudo i2cget -y 3 0x20 0x06 ; sudo i2cget -y 3 0x20 0x07\n0x1f\n0x85\n0xeb\n0x51\n0xb8\n0x1e\n0x09\n0x40\n</code></pre>\n\n<p>But in C++ of course... Is this make sense for you? I am newbie with i2c devices and I suppose it is this direction that I have to do in my code. Thanks!</p>\n\n<pre><code>int I2CTools::writeDouble(double value) {\n    union i2c_smbus_data data;\n\n    doubleToCharArray.original = value;\n\n    std::cout &lt;&lt; \"\\nBytes: \";\n    for (unsigned long address = 0; address &lt; sizeof(double); address++) {\n        std::cout &lt;&lt; (int) doubleToCharArray.output[address] &lt;&lt; ' ';\n        data.byte = (int) doubleToCharArray.output[address];\n        // std::cout &lt;&lt; hex(doubleToCharArray.output[address]) &lt;&lt; ' ';\n        i2c_smbus_access(i2cFileDescriptor, I2C_SMBUS_WRITE, address, I2C_SMBUS_BYTE_DATA, &amp;data);\n    }\n    return 0;\n}\ndouble I2CTools::readDouble() {\n\n    unsigned char charArray[sizeof(double)];\n    std::cout &lt;&lt; \"\\nBytes: \";\n    for (unsigned long address = 0; address &lt; sizeof(double); address++) {\n        union i2c_smbus_data data;\n        if (i2c_smbus_access(i2cFileDescriptor, I2C_SMBUS_READ, address, I2C_SMBUS_BYTE_DATA, &amp;data)) {\n            return -1;\n        } else {\n            std::cout &lt;&lt; (int) data.byte &lt;&lt; ' ';\n            charArray[address] = data.byte;\n        }\n    }\n    return *reinterpret_cast&lt;double *&gt;(charArray);\n}\n</code></pre>\n"}, {"tags": ["c++", "ubuntu", "gcc", "cmake", "cross-compiling"], "answers": [{"comments": [{"owner": {"reputation": 744, "user_id": 5778708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3328abe19153c39b04338b2a323ceb36?s=128&d=identicon&r=PG", "display_name": "m-bitsnbites", "link": "https://stackoverflow.com/users/5778708/m-bitsnbites"}, "edited": false, "score": 0, "creation_date": 1542197674, "post_id": 53299019, "comment_id": 93480519, "body": "That is certainly a solution that will take care of all potential problems, and it&#39;s also one that I&#39;ve considered. However, the way it&#39;s set up today (for various reasons) we would have to dedicate each build machine to a specific Docker container, which is not desirable (waste of HW). Being able to use a &quot;16.04 toolchain&quot; in a 18.04 container would therefore be ideal (since we already have a system for that in place)."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1542194402, "creation_date": 1542194402, "answer_id": 53299019, "question_id": 53298968, "link": "https://stackoverflow.com/questions/53298968/compiling-c-c-for-an-old-ubuntu-version-in-a-newer-ubuntu-version/53299019#53299019", "title": "Compiling C/C++ for an old Ubuntu version in a newer Ubuntu version", "body": "<p>Anything is possible, but the easiest thing you can do is create a new Docker image (or some other type of machine) with an older OS on it.  Then everything will \"just work.\"</p>\n\n<p>If you really don't want to do that, you need to identify all the dependencies, starting with libc, which have symbols missing on the older platform, then figure out how to avoid using those symbols.  This will probably waste a ton of time, especially considering you already have one build container (making a second one shouldn't be hard).</p>\n"}], "owner": {"reputation": 744, "user_id": 5778708, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3328abe19153c39b04338b2a323ceb36?s=128&d=identicon&r=PG", "display_name": "m-bitsnbites", "link": "https://stackoverflow.com/users/5778708/m-bitsnbites"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542194402, "creation_date": 1542194255, "question_id": 53298968, "link": "https://stackoverflow.com/questions/53298968/compiling-c-c-for-an-old-ubuntu-version-in-a-newer-ubuntu-version", "title": "Compiling C/C++ for an old Ubuntu version in a newer Ubuntu version", "body": "<p>I have build servers that run Ubuntu 18.04 (in a Docker container), but I need to build binaries (various static and shared libraries and executables) for older versions of Ubuntu (e.g. 16.04), without having to install an older version of the OS.</p>\n\n<p>Currently we use sysroot toolchains (that include compiler and libraries etc) and CMake toolchain files for building for other targets (e.g. ARM Poky/Yocto), and it would be ideal if we could use the same approach for building for older (or potentially newer) versions of Ubuntu.</p>\n\n<p>Is it possible?</p>\n"}, {"tags": ["android", "c++", "makefile", "cmake", "juce"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542193972, "post_id": 53298766, "comment_id": 93478475, "body": "Have you tried to ask on their forum? They are usually reponding very fast."}, {"owner": {"reputation": 33, "user_id": 10507743, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XV5ga-F3Cfg/AAAAAAAAAAI/AAAAAAAAAGo/cAuOCCswNqo/photo.jpg=k-s128", "display_name": "madmissmolly", "link": "https://stackoverflow.com/users/10507743/madmissmolly"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542194945, "post_id": 53298766, "comment_id": 93479007, "body": "@MatthieuBrucher Yes, I have posted on their forum and linked it to this post, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 3526549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kBNBE.jpg?s=128&g=1", "display_name": "t0m", "link": "https://stackoverflow.com/users/3526549/t0m"}, "is_accepted": false, "score": 1, "last_activity_date": 1542887432, "creation_date": 1542887432, "answer_id": 53430400, "question_id": 53298766, "link": "https://stackoverflow.com/questions/53298766/roli-juce-android-cmake-error-generated-blank-demo-app-fails-to-compile-in-andr/53430400#53430400", "title": "ROLI JUCE Android CMake Error, Generated blank demo app fails to compile in Android Studio", "body": "<p>Set the \u201cMinimum SDK Version\u201d in the Android exporter to something like 24, rather than the default of 10.</p>\n\n<p>The current default is a little low and will be bumped up to 28 in the next JUCE release.</p>\n"}], "owner": {"reputation": 33, "user_id": 10507743, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XV5ga-F3Cfg/AAAAAAAAAAI/AAAAAAAAAGo/cAuOCCswNqo/photo.jpg=k-s128", "display_name": "madmissmolly", "link": "https://stackoverflow.com/users/10507743/madmissmolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545165413, "creation_date": 1542193596, "question_id": 53298766, "link": "https://stackoverflow.com/questions/53298766/roli-juce-android-cmake-error-generated-blank-demo-app-fails-to-compile-in-andr", "title": "ROLI JUCE Android CMake Error, Generated blank demo app fails to compile in Android Studio", "body": "<p>Having downloaded the Projucer I generated a blank application, I exported it to Android (in debug mode) and opened it in Android studio. \nAfter fixing errors to do with the versions of the SDK and NDK (I updated the references to build with the most recent version) the code fails to build at the CMake stage with the below error output:</p>\n\n<pre><code>Build command failed.\nError while executing process /Users/user/Library/Android/sdk/cmake/3.6.4111459/bin/cmake with arguments {--build /Users/user/Documents/Blank/Builds/Android/app/.externalNativeBuild/cmake/debug_Debug/x86 --target juce_jni}\n[1/16] Building C object CMakeFiles/cpufeatures.dir/Users/user/Library/Android/sdk/ndk-bundle/sources/android/cpufeatures/cpu-features.c.o\n[2/16] Linking C static library libcpufeatures.a\n[3/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_audio_basics.cpp.o\n[4/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_audio_devices.cpp.o\n[5/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_audio_formats.cpp.o\n[6/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_audio_processors.cpp.o\n[7/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_core.cpp.o\n[8/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_cryptography.cpp.o\n[9/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_data_structures.cpp.o\n[10/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_events.cpp.o\n[11/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_graphics.cpp.o\n[12/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_gui_basics.cpp.o\n[13/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_gui_extra.cpp.o\n[14/16] Building CXX object CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_opengl.cpp.o\nFAILED: /Users/user/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/bin/clang++  --target=i686-none-linux-android28 --gcc-toolchain=/Users/user/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64  -DDEBUG=1 -DJUCER_ANDROIDSTUDIO_7F0E4A25=1 -DJUCE_ANDROID=1 -DJUCE_ANDROID_ACTIVITY_CLASSNAME=com_yourcompany_blank_Blank -DJUCE_ANDROID_ACTIVITY_CLASSPATH=\\\"com/yourcompany/blank/Blank\\\" -DJUCE_ANDROID_API_VERSION=10 -DJUCE_ANDROID_SHARING_CONTENT_PROVIDER_CLASSNAME=com_yourcompany_blank_SharingContentProvider -DJUCE_ANDROID_SHARING_CONTENT_PROVIDER_CLASSPATH=\\\"com/yourcompany/blank/SharingContentProvider\\\" -DJUCE_APP_VERSION=1.0.0 -DJUCE_APP_VERSION_HEX=0x10000 -DJUCE_PUSH_NOTIFICATIONS=1 -D_DEBUG=1 -Djuce_jni_EXPORTS -I../../../../../../../JuceLibraryCode -I/Users/user/Downloads/JUCE/modules -I/Users/molly/Library/Android/sdk/ndk-bundle/sources/android/cpufeatures --sysroot /Users/user/Library/Android/sdk/ndk-bundle/toolchains/llvm/prebuilt/darwin-x86_64/sysroot -g -DANDROID -fdata-sections -ffunction-sections -funwind-tables -fstack-protector-strong -no-canonical-prefixes -Wa,--noexecstack -Wformat -Werror=format-security -stdlib=libc++ -std=c++11 -fexceptions -frtti -fsigned-char -std=c++14 -O0 -fno-limit-debug-info -O0 -fPIC -MD -MT CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_opengl.cpp.o -MF CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_opengl.cpp.o.d -o CMakeFiles/juce_jni.dir/Users/user/Documents/Blank/JuceLibraryCode/include_juce_opengl.cpp.o -c /Users/user/Documents/Blank/JuceLibraryCode/include_juce_opengl.cpp\nIn file included from /Users/user/Documents/Blank/JuceLibraryCode/include_juce_opengl.cpp:9:\n/Users/user/Downloads/JUCE/modules/juce_opengl/juce_opengl.cpp:118:26: error: no member named 'glDrawBuffer' in the global namespace; did you mean simply 'glDrawBuffer'?\n JUCE_GL_BASE_FUNCTIONS (JUCE_DECLARE_GL_FUNCTION)\n ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~\n/Users/user/Downloads/JUCE/modules/juce_opengl/native/juce_OpenGLExtensions.h:69:5: note: expanded from macro 'JUCE_GL_BASE_FUNCTIONS'\n    USE_FUNCTION (glDrawBuffer,            void, (GLsizei p1, const GLenum* p2), (p1, p2))\n    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/Users/user/Downloads/JUCE/modules/juce_opengl/juce_opengl.cpp:116:72: note: expanded from macro 'JUCE_DECLARE_GL_FUNCTION'\n    returnType OpenGLExtensionFunctions::name params noexcept { return ::name callparams; }\n                                                                       ^~\n/Users/user/Downloads/JUCE/modules/juce_opengl/juce_opengl.cpp:118:2: note: 'glDrawBuffer' declared here\n JUCE_GL_BASE_FUNCTIONS (JUCE_DECLARE_GL_FUNCTION)\n ^\n/Users/user/Downloads/JUCE/modules/juce_opengl/native/juce_OpenGLExtensions.h:69:19: note: expanded from macro 'JUCE_GL_BASE_FUNCTIONS'\n    USE_FUNCTION (glDrawBuffer,            void, (GLsizei p1, const GLenum* p2), (p1, p2))\n                  ^\n1 error generated.\nninja: build stopped: subcommand failed.\n</code></pre>\n\n<p>I have tried reinstalling the Projucer, running different versions of Android Studio and generating different Demo projects but they all fail at the same point. When generating an Xcode file on the same computer (macOS) and same Projucer download the code does compile and run on an emulated iOS.</p>\n\n<p>Am I missing some library or is there an incorrect file path somewhere? </p>\n\n<p>The file that throws the error is from their own library so I am unsure what could be causing the issue, any help would be much appreciated!</p>\n\n<p>The error occurs specifically on the line USE_FUCNTION(glDrawBuffer ...) as I have tried moving this line of code in the library file and the error moves with it (it is at the end of a code block so I wanted to see if it was that code block that was failing but it seems to be specifically that line)</p>\n"}, {"tags": ["c++", "qt", "qt-creator", "fedora", "cgal"], "answers": [{"comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542266005, "post_id": 53299371, "comment_id": 93508486, "body": "@n.m Did you try this sample code? Please, drop a comment if you cannot compile it. I did it carefully but, nevertheless, the compiler usually finds something to complain about."}, {"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542280239, "post_id": 53299371, "comment_id": 93516195, "body": "unfortunately I still have a problem in using SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt; ,it cannot be used as a type"}, {"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542280423, "post_id": 53299371, "comment_id": 93516305, "body": "qWin.setCentralWidget(         new SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt;(           qWin, mesh, &quot;Basic Polyhedron Viewer&quot;, false, fColor));"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542280853, "post_id": 53299371, "comment_id": 93516565, "body": "@n.m I&#39;m such a git! Would you, please, replace <code>ColorFunctor</code> by <code>CGAL::DefaultColorFunctorPolyhedron</code>. (I completely forgot that in the sample code, <code>ColorFunctor</code> is just a template parameter.)"}, {"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542485123, "post_id": 53299371, "comment_id": 93587710, "body": "@Sceff sorry for disturbance but I have a problem within the above code  SimplePolyhedronViewerQ cannot be recognized , so I added &quot;CGAL:: &quot; before it  but now the existing error is : no matching function for call to \u2018CGAL::SimplePolyhedronViewerQt&lt;CGAL::Polyhedron_3&lt;CGAL::Epi&zwnj;&#8203;ck&gt;, CGAL::DefaultColorFunctorPolyhedron&gt;::SimplePolyhedronViewer&zwnj;&#8203;Qt(QMainWindow&amp;, Polyhedron&amp;, const char [24], bool, CGAL::DefaultColorFunctorPolyhedron&amp;)\u2019               qWin, mesh, &quot;Basic Polyhedron Viewer&quot;, false, fColor));"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542497553, "post_id": 53299371, "comment_id": 93590744, "body": "@n.m Yepp. As you said: missing <code>CGAL::</code> scope. Additionally, I forgot the <code>&amp;</code> operator before <code>qWin</code>. (1st arg. must be <code>&amp;qWin</code>.) I edited the answer."}, {"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542545549, "post_id": 53299371, "comment_id": 93598739, "body": "excuse me I&#39;m a newbie  the app stopped working cause of :  Signal received   The inferior stopped because it received a signal from the Operating System.   Signal name : SIGSEGV   Signal meaning : Segmentation fault"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542545877, "post_id": 53299371, "comment_id": 93598830, "body": "@n.m Please, research about gdb, core dump, and stack trace. With gdb, you can get more details about the crash, i.e. in which function the segmentation fault occurred and what called what before."}], "tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": true, "score": 2, "last_activity_date": 1542497421, "last_edit_date": 1542497421, "creation_date": 1542195495, "answer_id": 53299371, "question_id": 53298405, "link": "https://stackoverflow.com/questions/53298405/running-draw-polygon-example-in-cgal-package-in-qt-widget-application/53299371#53299371", "title": "running draw_polygon example in CGAl package in qt widget application", "body": "<p>I'm using Qt5 in daily business, and once considered CGAL as possible application base (without going further into this direction &ndash; not yet). Hence, this question made me curious.</p>\n\n<p>I digged through the source code of CGAL on github and found out why the error message </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>QCoreApplication::exec: The event loop is already running\n</code></pre>\n\n<p>occurs.</p>\n\n<p>For this, I copied the relevant lines from <a href=\"https://github.com/CGAL/cgal/blob/master/Polyhedron/include/CGAL/draw_polyhedron.h\" rel=\"nofollow noreferrer\">CGAL on github: Polyhedron/include/CGAL/draw_polyhedron.h</a>:</p>\n\n<pre><code>template&lt;class Polyhedron, class ColorFunctor&gt;\nvoid draw(const Polyhedron&amp; apoly,\n          const char* title,\n          bool nofill,\n          const ColorFunctor&amp; fcolor)\n{  \n#if defined(CGAL_TEST_SUITE)\n  bool cgal_test_suite=true;\n#else\n  bool cgal_test_suite=false;\n#endif\n\n  if (!cgal_test_suite)\n  {\n    int argc=1;\n    const char* argv[2]={\"polyhedron_viewer\",\"\\0\"};\n    QApplication app(argc,const_cast&lt;char**&gt;(argv));\n    SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt;\n      mainwindow(app.activeWindow(), apoly, title, nofill, fcolor);\n    mainwindow.show();\n    app.exec();\n  }\n}\n</code></pre>\n\n<p>Looking at this source code, it becomes obvious that <code>CGAL::draw()</code> is a small ful-featured Qt application in itself which establishs its own <code>QApplication</code> instance. The OP in turn tried to embed the <code>CGAL::draw()</code> in her/his own Qt application. It is not allowed to instance any derivates of <code>QCoreApplication</code> more than once (according to Qt doc. of <a href=\"http://doc.qt.io/qt-5/qapplication.html#details\" rel=\"nofollow noreferrer\"><code>QApplication</code></a>):</p>\n\n<blockquote>\n  <p>For any GUI application using Qt, there is precisely <strong>one</strong> QApplication object, no matter whether the application has 0, 1, 2 or more windows at any given time.</p>\n</blockquote>\n\n<p>(Emphasizing <em>not</em> mine.)</p>\n\n<p>The CGAL doc. provides an (even shorter) example in <a href=\"https://doc.cgal.org/latest/Polyhedron/Polyhedron_2draw_polyhedron_8cpp-example.html#a2\" rel=\"nofollow noreferrer\">Polyhedron/draw_polyhedron.cpp</a> to do this right:</p>\n\n<pre><code>#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;\n#include &lt;CGAL/Polyhedron_3.h&gt;\n#include &lt;CGAL/IO/Polyhedron_iostream.h&gt;\n#include &lt;CGAL/draw_polyhedron.h&gt;\n#include &lt;fstream&gt;\ntypedef CGAL::Exact_predicates_inexact_constructions_kernel  Kernel;\ntypedef CGAL::Polyhedron_3&lt;Kernel&gt;                       Polyhedron;\nint main(int argc, char* argv[])\n{\n  Polyhedron P;\n  std::ifstream in1((argc&gt;1)?argv[1]:\"data/cross.off\");\n  in1 &gt;&gt; P;\n  CGAL::draw(P);\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>but there is no place to insert the <code>QFileDialog</code> at the right point.</p>\n\n<p>Hence, <code>CGAL::draw()</code> is the wrong tool for what OP (probably) intends to do &ndash; embed CGAL polyhedron rendering into a Qt application. For this, it is necessary to use the things directly which are called somewhere inside of <code>CGAL::draw()</code>.</p>\n\n<p>So, this is what seems appropriate to me:<br/>\nmaking <code>SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt;</code> a (main or child) widget in OPs Qt application.</p>\n\n<p>I then walked a bit through the github repo to find out from which Qt widget <code>CGAL::SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt;</code> is actually derived from and found the following inheritance:</p>\n\n<pre><code>CGAL::SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt;\n                           |\n                           V\n                 CGAL::Basic_viewer_qt\n                           |\n                           V\n                   CGAL::QGLViewer\n                           |\n            +--------------+--------------+\n            |                             |\n            V                             V\n      QOpenGLWidget               QOpenGLFunctions\n</code></pre>\n\n<p>So, <code>CGAL::SimplePolyhedronViewerQt&lt;Polyhedron, ColorFunctor&gt;</code> can be used like any <code>QWidget</code> (which involves making it the main window). It can become as well the center widget of a <code>QMainWindow</code> which gets a menu bar/tool bar with the <code>QAction</code> to open the <code>QFileDialog</code>, request a file path, open a file stream with this file path, and load a mesh from this file stream.</p>\n\n<p>There is another minor detail where I stumbled over: The <code>CGAL::Polyhedron</code> has to be given to the <code>CGAL::SimplePolyhedronViewerQt</code> in the constructor and by const reference. To consider this, it's IMHO necessary (after successful loading of mesh) to construct the <code>CGAL::SimplePolyhedronViewerQt</code> instance by <code>new</code> and set/add it to parent widget afterwards. If this is not acceptable it's probably necessary to go even deeper and replace the <code>CGAL::SimplePolyhedronViewerQt</code> by an own implementation, using the source code of the former as &ldquo;cheat-sheet&rdquo;.</p>\n\n<p>This is how such an application could look like:</p>\n\n<pre><code>#include &lt;fstream&gt;\n\n#include &lt;QtWidgets&gt;\n\n#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;\n#include &lt;CGAL/Polyhedron_3.h&gt;\n#include &lt;CGAL/IO/Polyhedron_iostream.h&gt;\n#include &lt;CGAL/draw_polyhedron.h&gt;\n\ntypedef CGAL::Exact_predicates_inexact_constructions_kernel  Kernel;\ntypedef CGAL::Polyhedron_3&lt;Kernel&gt;                       Polyhedron;\n\nint main(int argc, char **argv)\n{\n  qDebug() &lt;&lt; \"Qt Version:\" &lt;&lt; QT_VERSION_STR;\n  QApplication app(argc, argv);\n  CGAL::DefaultColorFunctorPolyhedron fColor;\n  Polyhedron mesh;\n  // setup UI\n  QMainWindow qWin;\n  QToolBar qToolbar;\n  QAction qCmdLoad(QString::fromUtf8(\"Load File...\"));\n  qToolbar.addAction(&amp;qCmdLoad);\n  qWin.addToolBar(&amp;qToolbar);\n  qWin.show();\n  // install signal handlers\n  QObject::connect(&amp;qCmdLoad, &amp;QAction::triggered,\n    [&amp;qWin, &amp;mesh, &amp;fColor]() {\n      const QString filePath = QFileDialog::getOpenFileName(\n        &amp;qWin,\n        QString::fromUtf8(\"Open .off model\"),\n        QString::fromUtf8(\"/home\"),\n        QString::fromUtf8(\"*.off\"));\n      if (filePath.isEmpty()) return;\n      std::ifstream fIn(filePath.toUtf8().data());\n      if (!(fIn &gt;&gt; mesh) || mesh.is_empty()) {\n        qDebug() &lt;&lt; \"Loading of\" &lt;&lt; filePath &lt;&lt; \"failed!\";\n        return;\n      }\n      qWin.setCentralWidget(\n        new CGAL::SimplePolyhedronViewerQt&lt;Polyhedron, CGAL::DefaultColorFunctorPolyhedron&gt;(\n          &amp;qWin, mesh, \"Basic Polyhedron Viewer\", false, fColor));\n      qWin.centralWidget()-&gt;show();\n    });\n  // runtime loop\n  return app.exec();\n}\n</code></pre>\n\n<p>Please, take this with a &ldquo;grain of salt&rdquo; &ndash; I've no CGAL at hand and couldn't compile/test the above code.</p>\n"}, {"comments": [{"owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542280542, "post_id": 53315206, "comment_id": 93516385, "body": "it&#39;s working in main()  but I want to use it in a GUI application so I want to use it in a method and call it"}, {"owner": {"reputation": 601, "user_id": 5523687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfcfd95740cd3b1ae7cfe4dade4b226?s=128&d=identicon&r=PG", "display_name": "mgimeno", "link": "https://stackoverflow.com/users/5523687/mgimeno"}, "reply_to_user": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "edited": false, "score": 0, "creation_date": 1542294408, "post_id": 53315206, "comment_id": 93524860, "body": "You cannot do that. You&#39;ll have to extract the significant code from Surface_mesh/include/CGAL/draw_surface_mesh.h and GraphicsView/include/CGAL/Qt/Basic_viewer_qt.h and adapt it to your application."}], "tags": [], "owner": {"reputation": 601, "user_id": 5523687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfcfd95740cd3b1ae7cfe4dade4b226?s=128&d=identicon&r=PG", "display_name": "mgimeno", "link": "https://stackoverflow.com/users/5523687/mgimeno"}, "is_accepted": false, "score": 0, "last_activity_date": 1542270668, "creation_date": 1542270668, "answer_id": 53315206, "question_id": 53298405, "link": "https://stackoverflow.com/questions/53298405/running-draw-polygon-example-in-cgal-package-in-qt-widget-application/53315206#53315206", "title": "running draw_polygon example in CGAl package in qt widget application", "body": "<p>CGAL::draw() already handles the Qt stuff. You are trying to open a mainwindow in another one. Just call CGAL::draw(mesh) in your main() function without anything else and it will work.</p>\n\n<p>EDIT: Which is exactly what Sheff explained in a much more detailed way.</p>\n"}], "owner": {"reputation": 435, "user_id": 9364386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d77c6fa99fde576155f29746cf13d1f?s=128&d=identicon&r=PG&f=1", "display_name": "n.m", "link": "https://stackoverflow.com/users/9364386/n-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 53299371, "answer_count": 2, "score": 1, "last_activity_date": 1542497421, "creation_date": 1542192508, "question_id": 53298405, "link": "https://stackoverflow.com/questions/53298405/running-draw-polygon-example-in-cgal-package-in-qt-widget-application", "title": "running draw_polygon example in CGAl package in qt widget application", "body": "<p>I try to following CGAL example in Qt widget application :\n<a href=\"https://doc.cgal.org/latest/Polyhedron/Polyhedron_2draw_polyhedron_8cpp-example.html#a2\" rel=\"nofollow noreferrer\">example</a></p>\n\n<p><strong>main.ccp:</strong></p>\n\n<pre><code>#include \"mainwindow.h\"\n#include &lt;QApplication&gt;\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n     MainWindow w;\n w.show();\n\n        return a.exec();\n}\n</code></pre>\n\n<p><strong>mainwindow.ccp :</strong></p>\n\n<pre><code>#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;\n#include &lt;CGAL/Polyhedron_3.h&gt;\n#include &lt;CGAL/IO/Polyhedron_iostream.h&gt;\n#include &lt;CGAL/draw_polyhedron.h&gt;\n#include &lt;fstream&gt;\ntypedef CGAL::Exact_predicates_inexact_constructions_kernel  Kernel;\ntypedef CGAL::Polyhedron_3&lt;Kernel&gt;                       Polyhedron;\n\nvoid MainWindow::on_pushButton_clicked()\n{\n   QString fileName = QFileDialog::getOpenFileName(this,tr(\"Open .off model\"), \"/home\", tr(\"*.off\"));\n\ndraw_poly(fileName);\n }\n\nvoid MainWindow::draw_poly(QString fileName)\n{\n    QByteArray inBytes;\n    const char *c;\n     inBytes = fileName.toUtf8();\n     c = inBytes.constData();\n          std::ifstream input(c);\n\n          if (!input || !(input &gt;&gt; mesh) || mesh.is_empty()) {\n            std::cerr &lt;&lt; \"Not a valid off file.\" &lt;&lt; std::endl;\n         //   return 1;\n          }\n\n          input &gt;&gt; mesh;\n\n          CGAL::draw(mesh);\n}\n</code></pre>\n\n<p>when I ran it , it open dialog file to select .off file ,then it shows the following error:</p>\n\n<pre><code>QCoreApplication::exec: The event loop is already running\n</code></pre>\n\n<p>any help ,please ?</p>\n"}]