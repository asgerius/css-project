[{"tags": ["c++", "class", "oop", "templates"], "comments": [{"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 1, "creation_date": 1424304319, "post_id": 28596311, "comment_id": 45499220, "body": "It&#39;s not an answer but destructor of <code>Base</code> should be virtual. In other case <code>shared_ptr</code> won&#39;t call destructor of <code>Derived</code>."}, {"owner": {"reputation": 9586, "user_id": 1000282, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/371832f83b79a41443fa50d3793b0cfd?s=128&d=identicon&r=PG", "display_name": "pepper_chico", "link": "https://stackoverflow.com/users/1000282/pepper-chico"}, "edited": false, "score": 0, "creation_date": 1424305630, "post_id": 28596311, "comment_id": 45499671, "body": "<code>Derived&lt;Base&lt;Root&gt;&gt;</code> would be <code>Base&lt;Root&gt;</code> if inheritance was applied like this: <code>template&lt;class T&gt; class Derived : public T </code>. The way it&#39;s now you end up with <code>Derived : Base&lt;Base&lt;Root&gt;&gt;</code>."}], "answers": [{"owner": {"reputation": 10668, "user_id": 1062250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7bed607125818c218b48621d4a37a2?s=128&d=identicon&r=PG", "display_name": "nullptr", "link": "https://stackoverflow.com/users/1062250/nullptr"}, "is_accepted": false, "score": 1, "last_activity_date": 1424305028, "last_edit_date": 1424305028, "creation_date": 1424304620, "answer_id": 28596433, "question_id": 28596311, "link": "https://stackoverflow.com/questions/28596311/how-to-resolve-this-circular-inheritance-issue-with-template/28596433#28596433", "title": "How to resolve this circular inheritance issue with template?", "body": "<p>It seems you expect the template parameter of <code>Derived</code>, i.e. <code>Base&lt;Root&gt;</code>, to be 'upcasted' to <code>Root</code>. The cast would work for an object, but cannot happen for a template parameter: specializing a template defines a new type that is different from other specializaions.</p>\n\n<p><code>Derived&lt;Base&lt;Root&gt;&gt;</code> can be casted to <code>Base&lt;Base&lt;Root&gt;&gt;</code>, but not to <code>Derived&lt;some-ancestor-of-Base&lt;Root&gt;&gt;</code>.</p>\n\n<p>In general, if <code>Derived</code> inherits from <code>Base</code>, then <code>AnyClass&lt;Derived&gt;</code> cannot be casted to <code>AnyClass&lt;Base&gt;</code>.</p>\n"}, {"owner": {"reputation": 2808, "user_id": 779446, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b7824b872e7c61d94b262cced5f5da4?s=128&d=identicon&r=PG", "display_name": "opetroch", "link": "https://stackoverflow.com/users/779446/opetroch"}, "is_accepted": true, "score": 2, "last_activity_date": 1424306771, "last_edit_date": 1424306771, "creation_date": 1424306251, "answer_id": 28596732, "question_id": 28596311, "link": "https://stackoverflow.com/questions/28596311/how-to-resolve-this-circular-inheritance-issue-with-template/28596732#28596732", "title": "How to resolve this circular inheritance issue with template?", "body": "<p><code>Derive&lt;T&gt;</code> is <code>Based&lt;T&gt;</code>, hence <code>Derived&lt;Base&lt;Root&gt;&gt;</code> is <code>Base&lt;Base&lt;Root&gt;&gt;</code>.</p>\n\n<p>Now the question is: Is <code>Base&lt;Base&lt;Root&gt;&gt;</code> a <code>Base&lt;Root&gt;</code>?</p>\n\n<p>In other words: Does <code>Base&lt;Base&lt;Root&gt;&gt;</code> derive from <code>Base&lt;Root&gt;</code>?</p>\n\n<p>Or equivalently:  Does <code>Base&lt;A&gt;</code> derive from <code>Base&lt;B&gt;</code>, with A=<code>Base&lt;Root&gt;</code> and B=Root?</p>\n\n<p>No. A derives from B, but <code>Base&lt;A&gt;</code> doesn't derive from <code>Base&lt;B&gt;</code>.</p>\n\n<p>Just the same way a <code>vector&lt;X&gt;</code> doesn't derive from <code>vector&lt;Y&gt;</code>, even if X inherits Y.</p>\n"}], "owner": {"reputation": 157, "user_id": 2164703, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83e267c1cc0d8333e81fe62b13e781a6?s=128&d=identicon&r=PG", "display_name": "user2164703", "link": "https://stackoverflow.com/users/2164703/user2164703"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 28596732, "answer_count": 2, "score": 2, "last_activity_date": 1424306771, "creation_date": 1424303896, "question_id": 28596311, "link": "https://stackoverflow.com/questions/28596311/how-to-resolve-this-circular-inheritance-issue-with-template", "title": "How to resolve this circular inheritance issue with template?", "body": "<p>I have the following class:</p>\n\n<pre><code>template&lt;class T&gt;\nclass Base: public Root //this one abstract\n{\n    std::vector&lt;std::shared_ptr&lt;T&gt;&gt; components;\n}\n\ntemplate&lt;class T&gt;\nclass Derived : Base&lt;T&gt; //this one not abstract\n{\n //stuff\n}\n</code></pre>\n\n<p>I'm building:</p>\n\n<pre><code>Derived&lt;Base&lt;Root&gt;&gt; myDerived;\nstd::shared_ptr&lt;Base&lt;Root&gt;&gt; ptr_base;\nptr_base.reset(&amp;myDerived); // -&gt; ERROR\n</code></pre>\n\n<p>Compiler give me :</p>\n\n<pre><code>error C2664: 'std::_Ptr_base&lt;_Ty&gt;::_Reset0' : cannot convert parameter 1 from 'model::Derived &lt;T&gt; *' to 'model::Base&lt;T&gt; *'\n</code></pre>\n\n<p>So the compiler doesnt seems to get that a <code>Derived&lt;Base&lt;Root&gt;&gt;</code> is also a <code>Base&lt;Root&gt;</code> because in what im trying to do:</p>\n\n<p>1.<code>Base&lt;Root&gt; is Root</code> from the definition of Base</p>\n\n<p>2.<code>Derived&lt;T&gt;</code> is <code>Base&lt;T&gt;</code> from the definition of <code>Derived&lt;T&gt;</code></p>\n\n<p>so <code>Derived&lt;Base&lt;Root&gt;&gt;</code> is <code>Base&lt;Root&gt;</code></p>\n\n<p>Any hints ?</p>\n\n<p>Thks.</p>\n"}, {"tags": ["c++", "c++11", "stream", "c-preprocessor"], "comments": [{"owner": {"reputation": 1510, "user_id": 2577784, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0UtjR.png?s=128&g=1", "display_name": "djs", "link": "https://stackoverflow.com/users/2577784/djs"}, "edited": false, "score": 0, "creation_date": 1424303997, "post_id": 28596298, "comment_id": 45499125, "body": "it might be best to split this into separate questions"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "reply_to_user": {"reputation": 1510, "user_id": 2577784, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0UtjR.png?s=128&g=1", "display_name": "djs", "link": "https://stackoverflow.com/users/2577784/djs"}, "edited": false, "score": 0, "creation_date": 1424304184, "post_id": 28596298, "comment_id": 45499186, "body": "@djs: I see only one question here. What&#39;s the other one (that should be split off)?"}, {"owner": {"reputation": 51, "user_id": 4581768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495f47bc189580b2a387acdff97956ef?s=128&d=identicon&r=PG&f=1", "display_name": "bobobo", "link": "https://stackoverflow.com/users/4581768/bobobo"}, "edited": false, "score": 0, "creation_date": 1424304276, "post_id": 28596298, "comment_id": 45499209, "body": "The second bolded question is meant to be a specifc example clarifying the meaning of the first one.  Apologies if it was confusing!"}], "answers": [{"comments": [{"owner": {"reputation": 199084, "user_id": 56338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92fb4563ddc5ceeaa8b19b60a7a172f4?s=128&d=identicon&r=PG", "display_name": "sth", "link": "https://stackoverflow.com/users/56338/sth"}, "edited": false, "score": 0, "creation_date": 1424306184, "post_id": 28596605, "comment_id": 45499872, "body": "The compiler can only optimize out <code>ComputeExpensiveThing()</code> if it is sure that the function doesn&#39;t have any side effects. With a complex computation that might not be the case."}, {"owner": {"reputation": 18935, "user_id": 19405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b55a41a43ea0493fc64641a1ed295?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/19405/nobody"}, "edited": false, "score": 0, "creation_date": 1424308732, "post_id": 28596605, "comment_id": 45500651, "body": "Something that worked with existing code bases and didn&#39;t require modifying every call site would be <i>nice</i> (but maybe not possible)."}, {"owner": {"reputation": 153402, "user_id": 1204143, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5ca341b160687d99b1317859f91054ee?s=128&d=identicon&r=PG", "display_name": "nneonneo", "link": "https://stackoverflow.com/users/1204143/nneonneo"}, "edited": false, "score": 0, "creation_date": 1424309026, "post_id": 28596605, "comment_id": 45500728, "body": "Well, if you are already using e.g. <code>cout</code> then you could in principle substitute it using a macro. The term &quot;existing code bases&quot; is quite broad though; it is very possible that many existing code bases will already be using custom logging, which could be easily retrofit using my answer."}, {"owner": {"reputation": 51, "user_id": 4581768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495f47bc189580b2a387acdff97956ef?s=128&d=identicon&r=PG&f=1", "display_name": "bobobo", "link": "https://stackoverflow.com/users/4581768/bobobo"}, "edited": false, "score": 0, "creation_date": 1424379033, "post_id": 28596605, "comment_id": 45536310, "body": "This should be fine if (a) the compiler really does elide the if(constexpr) statement and (b) we never want to use dbglog itself as an expression.  I&#39;d prefer something that works without relying on the optimizer, but this is the best answer so far."}], "owner": {"reputation": 153402, "user_id": 1204143, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5ca341b160687d99b1317859f91054ee?s=128&d=identicon&r=PG", "display_name": "nneonneo", "link": "https://stackoverflow.com/users/1204143/nneonneo"}, "is_accepted": false, "score": 5, "last_activity_date": 1424306483, "last_edit_date": 1424306483, "creation_date": 1424305535, "answer_id": 28596605, "question_id": 28596298, "link": "https://stackoverflow.com/questions/28596298/is-it-possible-to-compile-out-stream-expressions-in-c/28596605#28596605", "title": "Is it possible to &quot;compile out&quot; stream expressions in C++?", "body": "<p>Why don't you just make the conditional something like this?</p>\n\n<pre><code>#ifdef DEBUG\n#define dbglog std::cout\n#else\n#define dbglog if(0) std::cout\n#endif\n</code></pre>\n\n<p>Then you can use it like so:</p>\n\n<pre><code>dbglog &lt;&lt; \"Hello, World!\" &lt;&lt; std::endl;\n</code></pre>\n\n<p><code>if(0)</code> and the subsequent statement will be completely deleted by the compiler (clang even does this optimization with no <code>-O</code> flag specified!).</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4581768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495f47bc189580b2a387acdff97956ef?s=128&d=identicon&r=PG&f=1", "display_name": "bobobo", "link": "https://stackoverflow.com/users/4581768/bobobo"}, "edited": false, "score": 1, "creation_date": 1424306514, "post_id": 28596623, "comment_id": 45499984, "body": "That&#39;s a good point.  So long as the test condition is a constant expression, if the compiler is at all good at its job, it ought to simply elide the <code>if</code> statement entirely.  This may end up being a &quot;dig into the assembly&quot; situation rather than a &quot;use evil/clever (clevil?) macro tricks&quot; one."}], "owner": {"reputation": 2759, "user_id": 2809008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff24f265a3c1712e989e0654a8c16f2a?s=128&d=identicon&r=PG", "display_name": "ljetibo", "link": "https://stackoverflow.com/users/2809008/ljetibo"}, "is_accepted": false, "score": 1, "last_activity_date": 1424305654, "creation_date": 1424305654, "answer_id": 28596623, "question_id": 28596298, "link": "https://stackoverflow.com/questions/28596298/is-it-possible-to-compile-out-stream-expressions-in-c/28596623#28596623", "title": "Is it possible to &quot;compile out&quot; stream expressions in C++?", "body": "<p>I'm not a good c++ programer, and I could easily be wrong. </p>\n\n<p>But shouldn't it be exactly the same if you defined a <code>const debug</code> and just do <code>if (debug) do_something;</code>. I'm gathering that compilers love <a href=\"http://en.wikipedia.org/wiki/Constant_folding\" rel=\"nofollow\">constant folding</a> and it would evaluate all the <code>if</code>s before time and there would be no branches created at all. </p>\n\n<p>If that would be correct, then it's also a good chance that you won't risk compiler ignoring inlining your function (which I also gather sometimes can happen for complex functions?).</p>\n\n<p>However, this is something completely compiler related so I can't claim universality. </p>\n"}], "owner": {"reputation": 51, "user_id": 4581768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495f47bc189580b2a387acdff97956ef?s=128&d=identicon&r=PG&f=1", "display_name": "bobobo", "link": "https://stackoverflow.com/users/4581768/bobobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1424308197, "creation_date": 1424303841, "last_edit_date": 1424308197, "question_id": 28596298, "link": "https://stackoverflow.com/questions/28596298/is-it-possible-to-compile-out-stream-expressions-in-c", "title": "Is it possible to &quot;compile out&quot; stream expressions in C++?", "body": "<p>It is well established that you can use macros to make a version of <code>printf</code> that can be stripped from the code during compilation (say, if you want to only print on debug builds).  The resulting code can be used exactly like one would use <code>printf</code>.</p>\n\n<p><strong>Is it possible to produce a similar scenario with respect to stream output?</strong></p>\n\n<p>For example, suppose I have the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Foo\n{\npublic:\n    template &lt;typename T&gt;\n    Foo&amp; operator &lt;&lt;(const T&amp; input)\n    {\n        std::cout &lt;&lt; input;\n    }\n};\n\nint ComputeExpensiveThing(); // this function is expensive\n\nvoid doSomething()\n{\n    Foo() &lt;&lt; \"Expensive thing:  \" &lt;&lt; ComputeExpensiveThing() &lt;&lt; std::endl;\n    // do other things\n}\n</code></pre>\n\n<p><strong>Is there a way to conditionally strip the first line of doSomething() at compile-time?</strong></p>\n\n<p>I can use a macro to get a similar effect by checking a global condition at runtime:</p>\n\n<pre><code>#define FOO if(!someGlobalCondition); else Foo()\n\nvoid doSomething()\n{\n    FOO &lt;&lt; \"Expensive thing:  \" &lt;&lt; ComputeExpensiveThing() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>However, this requires a conditional branch instruction each time we use <code>FOO</code>.  It's a significant improvement over calling <code>ComputeExpensiveThing</code>, but I'd still prefer to remove the excess branches.</p>\n\n<p>I've also seen an alternative that changes the target syntax to something like</p>\n\n<pre><code>void doSomething()\n{\n    Foo(\"Expensive thing:  \" &lt;&lt; ComputeExpensiveThing() &lt;&lt; std::endl);\n}\n</code></pre>\n\n<p>but the resulting syntax is a bit odd and unintuitive to some users.</p>\n"}, {"tags": ["c++", "templates", "private", "inner-classes"], "comments": [{"owner": {"reputation": 42460, "user_id": 642626, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fedc5e6b7fef29a8b539e20da8c85971?s=128&d=identicon&r=PG", "display_name": "Bryan Chen", "link": "https://stackoverflow.com/users/642626/bryan-chen"}, "edited": false, "score": 1, "creation_date": 1424304300, "post_id": 28596242, "comment_id": 45499214, "body": "<a href=\"http://coliru.stacked-crooked.com/a/ba0a804da5d34cb9\" rel=\"nofollow noreferrer\">clang reject it</a>"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1431545736, "post_id": 28596242, "comment_id": 48551379, "body": "Looks like a g++ bug, did you find an answer meanwhile? To me, it shouldn&#39;t be legal code."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 554705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3a3da79196093f01d491014a6f1429?s=128&d=identicon&r=PG", "display_name": "Anush Mohan", "link": "https://stackoverflow.com/users/554705/anush-mohan"}, "edited": false, "score": 0, "creation_date": 1424308209, "post_id": 28596377, "comment_id": 45500495, "body": "Thanks! Looks like clang has a problem with it."}], "owner": {"reputation": 2284, "user_id": 2549876, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4012ce359fbdc0baf6863bcb94bce6f5?s=128&d=identicon&r=PG", "display_name": "Hector", "link": "https://stackoverflow.com/users/2549876/hector"}, "is_accepted": true, "score": 1, "last_activity_date": 1424304346, "creation_date": 1424304346, "answer_id": 28596377, "question_id": 28596242, "link": "https://stackoverflow.com/questions/28596242/accessing-private-inner-class-type-from-non-member-template-function/28596377#28596377", "title": "Accessing private inner class type from non-member template function", "body": "<p>I get </p>\n\n<blockquote>\n  <p>Error 1   error C2248: 'Outer::Inner' : cannot access private struct declared in class 'Outer'    </p>\n</blockquote>\n\n<p>using Visual Studio 2013 update 4. Ergo, it is a problem in your compiler.</p>\n"}], "owner": {"reputation": 63, "user_id": 554705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df3a3da79196093f01d491014a6f1429?s=128&d=identicon&r=PG", "display_name": "Anush Mohan", "link": "https://stackoverflow.com/users/554705/anush-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 28596377, "answer_count": 1, "score": 4, "last_activity_date": 1424304346, "creation_date": 1424303603, "question_id": 28596242, "link": "https://stackoverflow.com/questions/28596242/accessing-private-inner-class-type-from-non-member-template-function", "title": "Accessing private inner class type from non-member template function", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nclass Outer {\n    struct Inner {\n        int num;    \n    };\n\npublic:\n static Inner GetInner() {\n    return Inner{-101};\n}\n};\n\n// void func1(Outer::Inner inner) {  // [1] Does not compile as expected\n//  cout &lt;&lt; inner.num &lt;&lt;endl;\n//}\n\ntemplate &lt;typename Dummy&gt;\nvoid func2(Outer::Inner inner, Dummy = Dummy()) {\n    cout &lt;&lt; inner.num &lt;&lt; endl;\n}\n\n\nint main() {\n    // func1(Outer::GetInner()); // [2] does not compile as expected \n    func2&lt;int&gt;(Outer::GetInner()); // [3] How does this compile? \n                                   // Outer::Inner should not be accessible\n                                   // from outside Outer\n    return 0;\n}\n</code></pre>\n\n<p>How is it that I am able to use an argument of type <code>Outer::Inner</code>, which is a private type, in the non-member function <code>func2</code>? '<code>func1</code> rightfully complains when I try and use it with the following error message:</p>\n\n<pre><code>prog.cpp: In function 'void func1(Outer::Inner)':\nprog.cpp:5:9: error: 'struct Outer::Inner' is private\n  struct Inner {\n         ^\nprog.cpp:15:19: error: within this context\n void func1(Outer::Inner inner) {\n               ^\n</code></pre>\n\n<p>I am using g++4.8.2 on ubuntu, but I also see this on gcc-4.9.2 (on www.ideone.com)</p>\n\n<p>You can try out the code here: <a href=\"http://ideone.com/8303pB\" rel=\"nofollow\">Ideone</a></p>\n"}, {"tags": ["c++", "windows", "winapi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 2, "creation_date": 1424304036, "post_id": 28596235, "comment_id": 45499129, "body": "The process is terminated as soon as your event handler returns, you don&#39;t get to override the close. So you need to do any cleanup in the event handler itself."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 2208440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/894e5a723066b84bd8b013cf097a7282?s=128&d=identicon&r=PG", "display_name": "Kenji", "link": "https://stackoverflow.com/users/2208440/kenji"}, "edited": false, "score": 0, "creation_date": 1500740106, "post_id": 28596672, "comment_id": 77476869, "body": "Tried &amp; tested tukra&#39;s answer and it works like a charm. My program terminates properly on windows and no longer segfaults on closing the console. It&#39;s ridiculous that SDL does not handle this by default and converts it into SDL_QUIT like for example terminate signals. Anyway, thank you for this solution."}, {"owner": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 0, "creation_date": 1515659201, "post_id": 28596672, "comment_id": 83386069, "body": "If you have to use Seep suspect the solution is subpar."}, {"owner": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 1, "creation_date": 1515664511, "post_id": 28596672, "comment_id": 83389255, "body": "This introduces a potential race condition. You did say you wanted to exit cleanly. The CRT does stuff after main returns, like call global destructors, atexit handlers, flush buffers, etc."}, {"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 0, "creation_date": 1515948038, "post_id": 28596672, "comment_id": 83486012, "body": "I updated the code to be more like what I really ended up with."}], "owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "is_accepted": true, "score": 6, "last_activity_date": 1515947967, "last_edit_date": 1515947967, "creation_date": 1424305931, "answer_id": 28596672, "question_id": 28596235, "link": "https://stackoverflow.com/questions/28596235/graceful-exit-when-closing-console-window/28596672#28596672", "title": "Graceful exit when closing console window", "body": "<p>Thanks Jonathan for the tip. </p>\n\n<p>I saw that the handler is called on it's own thread. If the handler returns then the whole process is forced to exit so we need to give the main thread time to exit on its own. </p>\n\n<pre><code>bool done = false;\n\nBOOL ctrl_handler(DWORD event)\n{\n    if (event == CTRL_CLOSE_EVENT) {\n        done = true;\n        Sleep(20000); // force exit after 20 seconds\n        return TRUE;\n    }\n    return FALSE;\n}\n\nint main()\n{\n    SetConsoleCtrlHandler((PHANDLER_ROUTINE)(ctrl_handler), TRUE);\n\n    while (!done)\n        do_stuff();\n\n    cleanup();\n    cout &lt;&lt; \"bye\";\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "edited": false, "score": 0, "creation_date": 1515642574, "post_id": 48190051, "comment_id": 83380134, "body": "That&#39;s a nice option. I guess it depends on specifically what you want to achieve. I looked back at the real code I ended up with related to this question and it sleeps 5 seconds and then returns, so the process will still terminate in the case the graceful exit doesn&#39;t work."}, {"owner": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 0, "creation_date": 1515663048, "post_id": 48190051, "comment_id": 83388250, "body": "This option is somewhat up in the air. Remember each of the processes attached to the console has a new thread created in them to call their handler routines: &quot;the system creates a new thread in the process to execute the function&quot;. It&#39;s the &quot;system&quot; that is orchestrating all this and exiting or terminating a thread in your process does not stop the &quot;system&quot; from processing the event. The question then becomes: how does the &quot;system&quot; handle the thread going up in a puff of smoke before it has it&#39;s answer? I can&#39;t see this behaviour described. It may not even be stable across different versions."}, {"owner": {"reputation": 1638, "user_id": 366956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dac48f00b4d8020a21400d54f8a5ff88?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/366956/steve"}, "edited": false, "score": 0, "creation_date": 1515665872, "post_id": 48190051, "comment_id": 83390168, "body": "I tried your solution, and it works, kind of: I added &quot;SetConsoleCtrlHandler(ctrl_handler, FALSE);&quot; to deregister the function and with this in the code it hangs if we forcefully exit the handler thread (I&#39;d guess it&#39;s waiting for the handler thread to finish but because we killed it it can&#39;t register its completion), so the system doesn&#39;t expect this scenario. There may be more caveats. (x86 code running on x64 version of Windows 10)."}, {"owner": {"reputation": 1721, "user_id": 941831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZdiGx.jpg?s=128&g=1", "display_name": "Gediminas", "link": "https://stackoverflow.com/users/941831/gediminas"}, "edited": false, "score": 0, "creation_date": 1515671880, "post_id": 48190051, "comment_id": 83393943, "body": "Steve, using &quot;ExitThread&quot; is a &quot;hack&quot;. Of course there can be some nuances. It&#39;s logical that &quot;SetConsoleCtrlHandler&quot; with FALSE is not working anymore, because handler thread is dead after &quot;ExitThread&quot; was called. (Solution was tested on both x64 and x86 projects, Windows 10, works without any problems.)"}], "owner": {"reputation": 1721, "user_id": 941831, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZdiGx.jpg?s=128&g=1", "display_name": "Gediminas", "link": "https://stackoverflow.com/users/941831/gediminas"}, "is_accepted": false, "score": 3, "last_activity_date": 1515656725, "last_edit_date": 1515656725, "creation_date": 1515595939, "answer_id": 48190051, "question_id": 28596235, "link": "https://stackoverflow.com/questions/28596235/graceful-exit-when-closing-console-window/48190051#48190051", "title": "Graceful exit when closing console window", "body": "<p>I think the better way would be to use:</p>\n\n<pre><code>if (event == CTRL_CLOSE_EVENT)\n{\n    ExitThread(0);\n//  return TRUE; // warning C4702: unreachable code\n}\n</code></pre>\n\n<p>The <code>ExitThread</code> will terminate the thread from which <code>ctrl_handler</code> gets called. This way <code>ExitProcess</code> will not be called, and your main thread will be able to perform all the needed cleanup.</p>\n"}], "owner": {"reputation": 847, "user_id": 4581804, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/67906d3adf1e7373d87ce47f3454a271?s=128&d=identicon&r=PG&f=1", "display_name": "tukra", "link": "https://stackoverflow.com/users/4581804/tukra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3444, "favorite_count": 3, "accepted_answer_id": 28596672, "answer_count": 2, "score": 7, "last_activity_date": 1515947967, "creation_date": 1424303566, "last_edit_date": 1424304276, "question_id": 28596235, "link": "https://stackoverflow.com/questions/28596235/graceful-exit-when-closing-console-window", "title": "Graceful exit when closing console window", "body": "<p>I'm trying to make a graceful exit from a console app when the close button is hit.</p>\n\n<pre><code>bool done = false;\n\nBOOL ctrl_handler(DWORD event)\n{\n    if (event == CTRL_CLOSE_EVENT) {\n        done = true;\n        return TRUE;\n    }\n    return FALSE;\n}\n\nint main()\n{\n    SetConsoleCtrlHandler((PHANDLER_ROUTINE)(ctrl_handler), TRUE);\n\n    while (!done)\n        do_stuff();\n\n    cleanup();\n    cout &lt;&lt; \"bye\";\n}\n</code></pre>\n\n<p>My handler gets called properly but the main thread does not resume afterwards so the \"bye\" never happens. If I trap CTRL_C_EVENT instead and hit ^C in the console then the main thread is allowed to continue and exits gracefully. Is there some way to allow the main thread to exit gracefully on console close?</p>\n\n<p>I've also tried using std::signal but it's the same. Works for ^C but not for window close.</p>\n"}, {"tags": ["c++", "c++11", "stream"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4570385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b61b1b792de88008d0f3fc3ed80d053?s=128&d=identicon&r=PG&f=1", "display_name": "painterflap", "link": "https://stackoverflow.com/users/4570385/painterflap"}, "edited": false, "score": 0, "creation_date": 1424316326, "post_id": 28596717, "comment_id": 45502527, "body": "Thanks. I changed to <code>ofstream of;</code> but now geterrors for the first two constructors: <code>error: use of deleted function &#39;std::basic_ofstream&lt;char&gt;::basic_ofstream(const std::basic_ofstream&lt;char&gt;&amp;)&#39;    Test (const string &amp; s):of {move(ofstream(s))} {}</code>. Any idea what to do?"}, {"owner": {"reputation": 459, "user_id": 1196200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/79941ab5294a74685db85edfe0db8b7f?s=128&d=identicon&r=PG", "display_name": "SplinterOfChaos", "link": "https://stackoverflow.com/users/1196200/splinterofchaos"}, "edited": false, "score": 0, "creation_date": 1424328941, "post_id": 28596717, "comment_id": 45506342, "body": "Looking in <code>&#47;usr&#47;include&#47;c++&#47;4.9&#47;fstream</code> on my system, GCC&#39;s library does not define a move constructor for <code>fstream</code>s, so you can&#39;t move one. Although the standard does require a move constructor... <a href=\"http://en.cppreference.com/w/cpp/io/basic_fstream/basic_fstream\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/basic_fstream/basic_fstream</a>"}, {"owner": {"reputation": 459, "user_id": 1196200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/79941ab5294a74685db85edfe0db8b7f?s=128&d=identicon&r=PG", "display_name": "SplinterOfChaos", "link": "https://stackoverflow.com/users/1196200/splinterofchaos"}, "edited": false, "score": 0, "creation_date": 1424329123, "post_id": 28596717, "comment_id": 45506415, "body": "Looks like they did add it upstream: <a href=\"https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/std/fstream#L910-L931\" rel=\"nofollow noreferrer\">github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/inclu&zwnj;&#8203;de/&hellip;</a>"}, {"owner": {"reputation": 84, "user_id": 4462829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BysOUZduVRM/AAAAAAAAAAI/AAAAAAAAAEU/F-KfnCaGesQ/photo.jpg?sz=128", "display_name": "imlyc", "link": "https://stackoverflow.com/users/4462829/imlyc"}, "reply_to_user": {"reputation": 15, "user_id": 4570385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b61b1b792de88008d0f3fc3ed80d053?s=128&d=identicon&r=PG&f=1", "display_name": "painterflap", "link": "https://stackoverflow.com/users/4570385/painterflap"}, "edited": false, "score": 0, "creation_date": 1424388646, "post_id": 28596717, "comment_id": 45540990, "body": "@painterflap , for the first constructor, I think you can use ` Test (const string &amp; s):of(s) {}` I don&#39;t think a move is needed here."}], "owner": {"reputation": 84, "user_id": 4462829, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BysOUZduVRM/AAAAAAAAAAI/AAAAAAAAAEU/F-KfnCaGesQ/photo.jpg?sz=128", "display_name": "imlyc", "link": "https://stackoverflow.com/users/4462829/imlyc"}, "is_accepted": false, "score": 1, "last_activity_date": 1424306141, "creation_date": 1424306141, "answer_id": 28596717, "question_id": 28596218, "link": "https://stackoverflow.com/questions/28596218/using-ofstream-rvalue-in-a-class-to-write-file/28596717#28596717", "title": "Using ofstream rvalue in a class to write file", "body": "<p>In the first constructor, an ofstream is initialized. Then \"move\" is applied on it, which only change the return type during compile time to a r-value reference. And then the reference is used to initialize another reference \"of\". Then the instance is destroyed. \"write\" try to write into a destroyed object, which cause the error.</p>\n\n<p>R-value reference is still a reference, consider it as a pointer. I think you should declare \"of\" as ofstream.</p>\n"}], "owner": {"reputation": 15, "user_id": 4570385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b61b1b792de88008d0f3fc3ed80d053?s=128&d=identicon&r=PG&f=1", "display_name": "painterflap", "link": "https://stackoverflow.com/users/4570385/painterflap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424306141, "creation_date": 1424303424, "question_id": 28596218, "link": "https://stackoverflow.com/questions/28596218/using-ofstream-rvalue-in-a-class-to-write-file", "title": "Using ofstream rvalue in a class to write file", "body": "<p>I want to make simple class for writing csv files. I have problem with passing/using ofstream. I want class to have two contractors. One taking string and making ofstream, and second taking ofstream as argument.  </p>\n\n<p>This is testing code that I use now to understand what is happening but cant:</p>\n\n<pre><code>class Test {\npublic:\n\n  Test (const string &amp; s):of {move(ofstream(s))} {}\n  Test (ofstream &amp;&amp; s):of {move(s)} {}\n\n  ~Test() {of.close();}\n\n  void write(const string &amp; s) {\n    of &lt;&lt; s &lt;&lt; endl;\n  }\n\n\nprivate:\n  ofstream &amp;&amp; of;\n};\n\n\nint main()\n{\n\n\n  // case 1\n  Test t(ofstream{\"/tmp/test2.csv\"});\n  t.write(\"SDFSDF\");\n  t.write(\"SDFSDF\");\n\n  // case 2\n  Test t2(\"/tmp/test3.csv\");\n  t2.write(\"SDFSDF\");\n  t2.write(\"SDFSDF\");\n\n\n  //case 3\n  ofstream ofs(\"/tmp/test4.csv\");\n  Test t3(move(ofs));\n  t3.write(\"SDFSDF\");\n  t3.write(\"SDFSDF\");\n\n   return 0;\n}\n</code></pre>\n\n<p>The code compiles and executes. But in cases 1 and 2 resulting files are empty. In  the 3rd case, no file is created at all. Why? What is happening? Maybe I'm using the rvalue references in a wrong way? If so, how should I use them? Or maybe there is better way to do what I am trying to achieve and rvalues are not needed?</p>\n"}, {"tags": ["c++", "visual-studio-2013", "resize", "window", "textout"], "answers": [{"owner": {"reputation": 9996, "user_id": 2360695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/542ff60c0222369f65f9af25daacc03d?s=128&d=identicon&r=PG", "display_name": "ScottMcP-MVP", "link": "https://stackoverflow.com/users/2360695/scottmcp-mvp"}, "is_accepted": false, "score": 2, "last_activity_date": 1424310244, "creation_date": 1424310244, "answer_id": 28597355, "question_id": 28596161, "link": "https://stackoverflow.com/questions/28596161/how-to-make-the-text-appear-in-center-of-the-window-when-re-sizing-it-visual-c/28597355#28597355", "title": "how to make the text appear in center of the window when re-sizing it, visual c++", "body": "<p>Call GetClientRect to get the window dimensions.  Do some math to get the center coordinate. It will be easier if you also call SetTextAlign with TA_CENTER to use the text center point as the coordianate you give to TextOut.</p>\n"}], "owner": {"reputation": 1, "user_id": 4581800, "user_type": "registered", "profile_image": "https://graph.facebook.com/890407494313577/picture?type=large", "display_name": "Stefan ", "link": "https://stackoverflow.com/users/4581800/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424310244, "creation_date": 1424303045, "question_id": 28596161, "link": "https://stackoverflow.com/questions/28596161/how-to-make-the-text-appear-in-center-of-the-window-when-re-sizing-it-visual-c", "title": "how to make the text appear in center of the window when re-sizing it, visual c++", "body": "<p>so i've got this code:</p>\n\n<pre><code>{\n    PAINTSTRUCT ps;\n    HDC hdc;\n\nswitch (message)\n{\ncase WM_PAINT:\n    hdc = BeginPaint(hWnd, &amp;ps);\n    TextOut(hdc,\n        100, 55, TEXT(\"some text here\"), 50\n        );\n\n    EndPaint(hWnd, &amp;ps);\nbreak;\ncase WM_DESTROY:\n    PostQuitMessage(0);\n    break;\ndefault:\n    return DefWindowProc(hWnd, message, wParam, lParam);\n    break;\n}\n</code></pre>\n\n<p>How can i make the text appear in the center when re-sizing the window?</p>\n"}, {"tags": ["c++", "return-value", "destructor"], "comments": [{"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424304971, "post_id": 28596092, "comment_id": 45499437, "body": "Why does your destructor need to know this information in order to clean up the state of Magic?"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "reply_to_user": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424305697, "post_id": 28596092, "comment_id": 45499699, "body": "In C++ there is no concept of Finally, because there is RAII. RAII is very powerful and exceeds in many cases its use to cleaning the object.  There are already patterns that demonstrate <a href=\"http://stackoverflow.com/questions/161177/does-c-support-finally-blocks-and-whats-this-raii-i-keep-hearing-about\" title=\"does c support finally blocks and whats this raii i keep hearing about\">stackoverflow.com/questions/161177/&hellip;</a> such usage.  It is limited though to local variables. I hope there could be a seamless way  without need of a helper local variable the return code to be obtained at system level."}, {"owner": {"reputation": 228114, "user_id": 33213, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ca5a23ced3d81ee8bfa73b8fdc1677c2?s=128&d=identicon&r=PG", "display_name": "jalf", "link": "https://stackoverflow.com/users/33213/jalf"}, "edited": false, "score": 0, "creation_date": 1424305729, "post_id": 28596092, "comment_id": 45499709, "body": "Destructors are not time machines. They do not have access to return values from functions that have not yet returned in code that has not yet executed."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424305959, "post_id": 28596092, "comment_id": 45499782, "body": "Can you call a function on magic to pass it the variable and store it as a member? Some compilers support finally as an extension."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424306136, "post_id": 28596092, "comment_id": 45499856, "body": "It was a long shot anyways, I will probably need to hide some local variable behind a macro or something."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424306156, "post_id": 28596092, "comment_id": 45499863, "body": "I think you should figure out what&#39;s wrong with your design."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424306297, "post_id": 28596092, "comment_id": 45499914, "body": "Wow, you are sure of it, hah."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424307013, "post_id": 28596092, "comment_id": 45500144, "body": "Could you go a little into why you want to do this, and more importantly, why you think it is a good idea to do this?  I have a sneaking suspicion that what you want to do is totally valid, but your implementation of the idea using &quot;return values&quot; is likely overlooking an easier implementation that we could help you find.  You say &quot;RAII is limited to local variables,&quot; and you want a &quot;system level&quot; solution.  It might help to better understand what you mean by that.  Take a look at marcus&#39; answer, I&#39;ve got a hunch its what you want, even though its not exactly what you&#39;re asking for."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424307168, "post_id": 28596092, "comment_id": 45500201, "body": "Yes, his answer is the classic RAII usage for providing finally in a particular scope with accessing local variable.  In my case if we limit the scope to a whole function, I wish there was an easy way the about to return value to be accessible, say it is a success/error code that I would like to check to determine the final logic."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424307334, "post_id": 28596092, "comment_id": 45500257, "body": "Usually this is done, with helper method, do { ... } while (0); or goto. I was just hoping that I could find a better way to do it."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424307938, "post_id": 28596092, "comment_id": 45500417, "body": "I must admit my ignorance.  I&#39;ve never seen any language mechanic which makes the return value &quot;accessable&quot; in this way in any language, except for perhaps LISP&#39;s interactive debugger.  Are there any examples of what you are trying to do in a language you&#39;re trying to emulate?"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424308139, "post_id": 28596092, "comment_id": 45500474, "body": "Other languages offer different instruments. And I cannot use exception, because my code base is mix c/c++. This is why I am stuck with using error codes ... but I hate the   int err = 0;  do {    if (something_wrong) {       err = 1;       break;    } while (0);  // finally  return err; }  pattern because it is too chatty. I am just brainstorming possibilities for the c++ part to do something better."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424308799, "post_id": 28596092, "comment_id": 45500671, "body": "Can you explain the different instruments used by different languages?  What you describe is a perfect example of RAII, so I think you&#39;re looking for a <i>very</i> specific thing in a language you&#39;ve used elsewhere.  I&#39;m a C++ person myself, so I think in C++ terms.  I haven&#39;t seen anything in your question which isn&#39;t naturally handled by RAII, which tells me that I&#39;m failing to see something that you&#39;re seeing.  If I could see an example in its native language, I may be able to better suggest which C++ features to use to emulate it."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424312118, "post_id": 28596092, "comment_id": 45501545, "body": "The other instruments I am referring to is the finally in java, and in general the exception handling, that obviously is available in c++, but for string of reasons, not for me."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424314237, "post_id": 28596092, "comment_id": 45502059, "body": "Are you referring to the ability to access local variables in java finally, or are you referring to this: <a href=\"http://stackoverflow.com/questions/8864230/javas-return-value-in-try-catch-finally-mechanism\" title=\"javas return value in try catch finally mechanism\">stackoverflow.com/questions/8864230/&hellip;</a> .  And you say exceptions are not available to you?  That is a substantial detail not in the question: if you are seeking to emulate Java exception-handling without using C++ exception handling, you should not be surprised when you need substantially ugly boilerplate."}, {"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424314401, "post_id": 28596092, "comment_id": 45502100, "body": "Also, do you have C++11?  There are many new features which may be helpful for working around the limitations you have to deal with."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424444704, "post_id": 28596092, "comment_id": 45564055, "body": "I am not surprised. I just believe what Edison said: &quot;there is always a better way&quot; ... and I keep looking for it. You will be suppressed (or maybe not) how innovative a big group like stack overflow community could be. Of course most of the time such questions are downvoted - a lot of people do not make difference between bad question and question without answer, but in some cases there is solution"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424444985, "post_id": 28596092, "comment_id": 45564250, "body": "my fevarite example of such question with an answer: <a href=\"http://stackoverflow.com/questions/19760221/c-get-the-month-as-number-at-compile-time\" title=\"c get the month as number at compile time\">stackoverflow.com/questions/19760221/&hellip;</a>"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "reply_to_user": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1474128723, "post_id": 28596092, "comment_id": 66409998, "body": "@CortAmmon I recently start using go. Interesting enough such capability is very well served in go - and not at all considered odd or anything. In go you can name your return variables- then you can access and even modify them from the lambda code in the defer statement (which is the equivalent of RAII destructor in c++). see this, for example, <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/qTTBENO_Em0\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/qTTBENO_Em0</a>"}], "answers": [{"owner": {"reputation": 113, "user_id": 4292649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a22b2ac2f1b0eb952f4c42665ed892b7?s=128&d=identicon&r=PG&f=1", "display_name": "Camleon", "link": "https://stackoverflow.com/users/4292649/camleon"}, "is_accepted": false, "score": 0, "last_activity_date": 1424303367, "creation_date": 1424303367, "answer_id": 28596205, "question_id": 28596092, "link": "https://stackoverflow.com/questions/28596092/access-the-return-code-from-c-destructor-of-a-local-class/28596205#28596205", "title": "access the return code from c++ destructor of a local class", "body": "<p>I am pretty sure there is no way you can get a destructor to return a value. Destructors don't do that;) It is also not possible to set the return type of the destructor.\nIn your example the destructor will be called after     return 0; At that point you cannot get anything at all.\nYou can set up a destructor to modify data by a pointer stored in the Magic class though.</p>\n"}, {"comments": [{"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424303584, "post_id": 28596209, "comment_id": 45499009, "body": "Not the destructor to return a value - the destructor to access the value that the function is about to return"}, {"owner": {"reputation": 3920, "user_id": 886707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc806a29b6a9ea4e5165534e2ef54e92?s=128&d=identicon&r=PG", "display_name": "Tobias Schlegel", "link": "https://stackoverflow.com/users/886707/tobias-schlegel"}, "reply_to_user": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424303797, "post_id": 28596209, "comment_id": 45499078, "body": "In your code &quot;magic&quot; is destructed after &quot;return 0;&quot; at the end of the scope. So accessing it beforehand would be too early anyway. I think you want to move code out of the destructor into a member-function."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424303988, "post_id": 28596209, "comment_id": 45499123, "body": "This is the exact order if I would like the return value to be set before I find out what it is."}], "owner": {"reputation": 3920, "user_id": 886707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc806a29b6a9ea4e5165534e2ef54e92?s=128&d=identicon&r=PG", "display_name": "Tobias Schlegel", "link": "https://stackoverflow.com/users/886707/tobias-schlegel"}, "is_accepted": false, "score": 0, "last_activity_date": 1424303385, "creation_date": 1424303385, "answer_id": 28596209, "question_id": 28596092, "link": "https://stackoverflow.com/questions/28596092/access-the-return-code-from-c-destructor-of-a-local-class/28596209#28596209", "title": "access the return code from c++ destructor of a local class", "body": "<p>No. </p>\n\n<p>A destructor can not return a value, nor should it throw exceptions.</p>\n"}, {"comments": [{"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424304737, "post_id": 28596408, "comment_id": 45499359, "body": "This is the main, but not the only use of destructors, they are very often used as guards, for example boost uses the destructor of scope_lock to unlock  the mutex."}, {"owner": {"reputation": 113, "user_id": 4292649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a22b2ac2f1b0eb952f4c42665ed892b7?s=128&d=identicon&r=PG&f=1", "display_name": "Camleon", "link": "https://stackoverflow.com/users/4292649/camleon"}, "reply_to_user": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1424305297, "post_id": 28596408, "comment_id": 45499551, "body": "Ok. I don&#39;t understand what you want to achieve with this:). Modify the return value after foo is finished? strange"}], "owner": {"reputation": 113, "user_id": 4292649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a22b2ac2f1b0eb952f4c42665ed892b7?s=128&d=identicon&r=PG&f=1", "display_name": "Camleon", "link": "https://stackoverflow.com/users/4292649/camleon"}, "is_accepted": false, "score": 0, "last_activity_date": 1424304498, "creation_date": 1424304498, "answer_id": 28596408, "question_id": 28596092, "link": "https://stackoverflow.com/questions/28596092/access-the-return-code-from-c-destructor-of-a-local-class/28596408#28596408", "title": "access the return code from c++ destructor of a local class", "body": "<p>I see. In that case you can conveniently find another elegant solution that does not require using the destructor. The destructor is supposed to free memory and clean up stuff. What you can do (if you really insist) is deleting the object from the heap before return 0 is called...</p>\n"}, {"owner": {"reputation": 667, "user_id": 3602281, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5yMLT.jpg?s=128&g=1", "display_name": "Don Larynx", "link": "https://stackoverflow.com/users/3602281/don-larynx"}, "is_accepted": false, "score": 0, "last_activity_date": 1424305210, "creation_date": 1424305210, "answer_id": 28596547, "question_id": 28596092, "link": "https://stackoverflow.com/questions/28596092/access-the-return-code-from-c-destructor-of-a-local-class/28596547#28596547", "title": "access the return code from c++ destructor of a local class", "body": "<p>Yes; the above code simply performs a <code>cout</code> statement in a destructor, i.e. another function. You would have to call the destructor before the return statement since the constructor remains in-scope after <code>return 0</code>.Recall the constructor (and destructor) is just a function returning nothing.</p>\n"}, {"comments": [{"owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424306664, "post_id": 28596609, "comment_id": 45500047, "body": "I modified your code to store a <code>const int&amp;</code> instead of an <code>int</code>.  That lets you construct <code>Magic</code> more near the top of the function, which is more similar to the OP&#39;s example."}, {"owner": {"reputation": 138, "user_id": 4577482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8cb36210b02627671d3504d3894b384?s=128&d=identicon&r=PG&f=1", "display_name": "marcus", "link": "https://stackoverflow.com/users/4577482/marcus"}, "reply_to_user": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "edited": false, "score": 0, "creation_date": 1424307088, "post_id": 28596609, "comment_id": 45500171, "body": "Sure sure...thanks. Am new to this, so sorry for the wrong code flags and thanks for the change, too."}], "owner": {"reputation": 138, "user_id": 4577482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8cb36210b02627671d3504d3894b384?s=128&d=identicon&r=PG&f=1", "display_name": "marcus", "link": "https://stackoverflow.com/users/4577482/marcus"}, "is_accepted": false, "score": 1, "last_activity_date": 1424306615, "last_edit_date": 1424306615, "creation_date": 1424305575, "answer_id": 28596609, "question_id": 28596092, "link": "https://stackoverflow.com/questions/28596092/access-the-return-code-from-c-destructor-of-a-local-class/28596609#28596609", "title": "access the return code from c++ destructor of a local class", "body": "<p>am not sure if I got the point but maybe this will help you...</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n\nclass Magic {\n\n    const int&amp; _retVal;\n\npublic:\n    Magic(const int&amp; retVal) : _retVal(retVal)  {}\n\n    ~Magic() {\n        std::cout &lt;&lt; \"foo() returns \" &lt;&lt; _retVal &lt;&lt; std::endl;\n    }\n\n};\n\n\nint foo() {\n\n    int fooRetVal=0;\n    Magic magic(fooRetVal);\n\n    if(true)    fooRetVal=1;\n    else        fooRetVal=-1;\n\n\n    return fooRetVal;\n}\n</code></pre>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1474128874, "creation_date": 1424302709, "last_edit_date": 1474128874, "question_id": 28596092, "link": "https://stackoverflow.com/questions/28596092/access-the-return-code-from-c-destructor-of-a-local-class", "title": "access the return code from c++ destructor of a local class", "body": "<pre><code>int foo() {\n    Magic magic;\n\n    if (something) return 1;\n    if (something_else) return 2;\n\n    return 0;\n}\n</code></pre>\n\n<p>Let's say that I have a function such as the above;</p>\n\n<ul>\n<li>is it possible for <code>magic</code> destructor to refer to the value the function is about to return?</li>\n</ul>\n\n<p><sup></sup></p>\n\n<pre><code>class Magic {\n    ~Magic() {\n        int return_code = &lt;magic spell&gt;;\n        std::cout &lt;&lt; \"the method returns\" &lt;&lt; return_code;\n    }\n};\n</code></pre>\n\n<p>-- EDIT --</p>\n\n<p>For example, golang has named return variables that you can access and/or modify from a defer statement - after they are \"returned\" from the body of the function.</p>\n"}, {"tags": ["c++", "lambda"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1424303051, "post_id": 28596087, "comment_id": 45498823, "body": "What doesn&#39;t work, and how? Do you really want to modify <code>x</code>, <code>*x</code>, or whatever lvalue is passed to <code>Start</code>? Maybe expand it to an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>?"}, {"owner": {"reputation": 1080, "user_id": 2202062, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9d373645b729af8b768a9de78a7e1269?s=128&d=identicon&r=PG", "display_name": "Assassinbeast", "link": "https://stackoverflow.com/users/2202062/assassinbeast"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1424304173, "post_id": 28596087, "comment_id": 45499180, "body": "Oh, i actually wanted to modify the (*x), NO_NAME answered it correctly for me. Thanks though!"}], "answers": [{"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "is_accepted": true, "score": 2, "last_activity_date": 1424303798, "last_edit_date": 1424303798, "creation_date": 1424303108, "answer_id": 28596173, "question_id": 28596087, "link": "https://stackoverflow.com/questions/28596087/how-to-modify-a-lambda-pointer-capture/28596173#28596173", "title": "How to modify a lambda pointer capture?", "body": "<p><code>x</code> is still a pointer inside the lambda.</p>\n\n<p>Code bellow should work.</p>\n\n<pre><code>auto func = [&amp;x]()-&gt;void\n{\n    (*x)++;\n    cout &lt;&lt; (*x);\n};\n</code></pre>\n\n<p>Capture by reference means you can modify value of original <code>x</code> but it is not changing type of the variable.\nIf you are capturing the variable by reference, you can set address which is pointed by <code>x</code>. This is because you have a reference to the original pointer inside lambda. When you capture <code>x</code> by value, you create copy of it.</p>\n"}], "owner": {"reputation": 1080, "user_id": 2202062, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9d373645b729af8b768a9de78a7e1269?s=128&d=identicon&r=PG", "display_name": "Assassinbeast", "link": "https://stackoverflow.com/users/2202062/assassinbeast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 28596173, "answer_count": 1, "score": 1, "last_activity_date": 1424303798, "creation_date": 1424302682, "question_id": 28596087, "link": "https://stackoverflow.com/questions/28596087/how-to-modify-a-lambda-pointer-capture", "title": "How to modify a lambda pointer capture?", "body": "<p>So what i want to do is just modify the x value passed in the parameter.</p>\n\n<pre><code>class B\n{\npublic:\n    void DoSomething(function&lt;void()&gt; func)\n    {\n        func();\n    }\n};\n\nclass A\n{\npublic:\n    void Start(B* b, int* x)\n    {\n        auto func = [&amp;x]()-&gt;void\n        {\n            x++;\n            cout &lt;&lt; x;\n        };\n        b-&gt;DoSomething(func);\n    }\n};\n</code></pre>\n\n<p>I have tried all sorts of combinations, but it just wont work.\nIf the x value was a valuetype and not a pointer, then it would work.</p>\n"}, {"tags": ["c++", "debugging", "while-loop"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1424302642, "post_id": 28596057, "comment_id": 45498686, "body": "did you run the code in a debugger? What did it show was the value of your variables such as range_max"}, {"owner": {"reputation": 29, "user_id": 4563313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbc0428287d6a80ca487747fd55a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Evans", "link": "https://stackoverflow.com/users/4563313/holly-evans"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1424303093, "post_id": 28596057, "comment_id": 45498833, "body": "I just added a memory check after the initial input, but it doesn&#39;t print that screen. I don&#39;t think it&#39;s taking in the input at all."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1424303194, "post_id": 28596057, "comment_id": 45498876, "body": "did you run it under a debbuger - what platform are you on?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424303228, "post_id": 28596057, "comment_id": 45498886, "body": "<i>&quot;I just added a memory check after the initial input ...&quot;</i> You were asked about the anomalies observed when stepping through your code line by line with a debugger, not putting a <i>&quot;memory check&quot;</i> (WTH this should be). <code>std::cin</code> could be in failed state because of invalid input as well."}, {"owner": {"reputation": 29, "user_id": 4563313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbc0428287d6a80ca487747fd55a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Evans", "link": "https://stackoverflow.com/users/4563313/holly-evans"}, "edited": false, "score": 0, "creation_date": 1424303388, "post_id": 28596057, "comment_id": 45498945, "body": "This is literally my second day so I have no clue how to operate a debugger. I&#39;ve been having it print to screen the values of the variables in place of the debugger until I can learn. I&#39;m on Eclipse"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424305240, "post_id": 28596057, "comment_id": 45499535, "body": "<i>This is literally my second day so I have no clue how to operate a debugger</i>.  Well, take a break, read up on debuggers.  Searching the internet for &quot;Eclipse c++ debugger tutorial&quot; should yield some good reading."}], "answers": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1424305484, "creation_date": 1424305484, "answer_id": 28596594, "question_id": 28596057, "link": "https://stackoverflow.com/questions/28596057/cant-find-the-error-in-while-loop/28596594#28596594", "title": "Can&#39;t find the error in while loop?", "body": "<p>You would benefit by adding another expression in the <code>while</code> statement:  </p>\n\n<pre><code>while ((range_min &lt; 0) || (range_max &lt; 0))\n{\n  cout &lt;&lt; \"Please enter positive range values: \";\n  cin &gt;&gt; range_min &gt;&gt; range_max;\n}\n</code></pre>\n\n<p>The \"||\" means logical OR.  It is read as <em>while range_min &lt; 0 OR range_max &lt; 0</em>.</p>\n"}, {"owner": {"reputation": 138, "user_id": 4577482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8cb36210b02627671d3504d3894b384?s=128&d=identicon&r=PG&f=1", "display_name": "marcus", "link": "https://stackoverflow.com/users/4577482/marcus"}, "is_accepted": false, "score": 0, "last_activity_date": 1424355199, "last_edit_date": 1424355199, "creation_date": 1424313300, "answer_id": 28597767, "question_id": 28596057, "link": "https://stackoverflow.com/questions/28596057/cant-find-the-error-in-while-loop/28597767#28597767", "title": "Can&#39;t find the error in while loop?", "body": "<p>True, the construct as you use it will also accept the values 3 and -1 as legal range as the outer while loop just checks the range_min value. If the range_min is 3 and thus greater than 0 the while loop will not execute. </p>\n\n<p>So there are a few cases in which you want the user to enter new values:</p>\n\n<p>1) One of the two is negativ or both</p>\n\n<p>2) Both are positive but equal or range_min is greater than range_max</p>\n\n<pre><code> while ((range_min &lt; 0 || range_max &lt;= 0) || ((range_min&gt;0 &amp;&amp; range_max&gt;0) &amp;&amp; (range_min-range_max)&lt;=0 )) {\n    cout &lt;&lt; \"Invalid range! Enter two new values: \";\n    cin &gt;&gt; range_min &gt;&gt; range_max;\n}\n</code></pre>\n\n<p>But ok, this still does not explain the reason for the behavior as you described. \nI compiled your code and didn't notice such a behavior. The first question would be if this is a reproducable \"error\"? Does it always remain the same for these two numbers?</p>\n"}], "owner": {"reputation": 29, "user_id": 4563313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abbc0428287d6a80ca487747fd55a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Evans", "link": "https://stackoverflow.com/users/4563313/holly-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1424355199, "creation_date": 1424302526, "last_edit_date": 1424303032, "question_id": 28596057, "link": "https://stackoverflow.com/questions/28596057/cant-find-the-error-in-while-loop", "title": "Can&#39;t find the error in while loop?", "body": "<p>I've set up a while loop that filters out bad input. I'm inputting numbers for which the condition for the first while loop is false, 2 and 35, yet it's printing \"Please input two <em>positive</em> integers\" to screen. It shouldn't be, and I can't find my error. Sorry if this is a dumb question, very new beginner. Any help is much appreciated! Thanks </p>\n\n<p>This is what prints to screen:</p>\n\n<p>Enter range to test for primes. Enter two positive integers, the smaller first, separated by whitespace.</p>\n\n<p>2</p>\n\n<p>35</p>\n\n<p>Please input two <em>positive</em> integers.</p>\n\n<pre><code>//Input range\ncout &lt;&lt; \"Enter range to test for primes. Enter two positive integers, the smaller first, separated by whitespace.\\n\";\ncin &gt;&gt; range_min &gt;&gt; range_max;\ncout &lt;&lt; range_min &lt;&lt; range_max;\n\n//Check if input is valid.\nwhile (range_min &lt; 0)\n{\n    cout &lt;&lt; \"Please input two *positive* integers.\\n\";\n    cin &gt;&gt; range_min &gt;&gt; range_max;\n    while (range_max &lt; 0)\n    {\n        cout &lt;&lt; \"Please input two *positive* integers.***\\n\";\n        cin &gt;&gt; range_min &gt;&gt; range_max;\n        while (range_min &gt; range_max)\n        {\n            cout &lt;&lt; \"Please input the smaller integer first.\\n\";\n            cin &gt;&gt; range_min &gt;&gt; range_max;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "random", "srand"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1424301794, "post_id": 28595916, "comment_id": 45498391, "body": "<a href=\"http://stackoverflow.com/questions/7343833/srand-why-call-it-only-once/\">Don&#39;t call <code>srand()</code> more than once!</a>"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1424301858, "post_id": 28595916, "comment_id": 45498414, "body": "You should probably call <code>srand ( time(NULL) );</code> outside of your class (e.g. in <code>main()</code>), unless you&#39;re sure you construct only a single object of it."}, {"owner": {"reputation": 934, "user_id": 3491770, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a4f7b59753e81a7b35f32105b0f627f1?s=128&d=identicon&r=PG", "display_name": "LumberSzquatch", "link": "https://stackoverflow.com/users/3491770/lumberszquatch"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424302232, "post_id": 28595916, "comment_id": 45498545, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6, This did it.  It&#39;s always something simple that does the trick. Thank you, I figured the problem lied in my lack of understanding."}], "answers": [{"owner": {"reputation": 645, "user_id": 4253485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f487d4517c8377afb2de167d325aa2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Mido", "link": "https://stackoverflow.com/users/4253485/mido"}, "is_accepted": false, "score": 0, "last_activity_date": 1424301924, "creation_date": 1424301924, "answer_id": 28595951, "question_id": 28595916, "link": "https://stackoverflow.com/questions/28595916/troubles-with-a-random-number-generator/28595951#28595951", "title": "Troubles with a random number generator", "body": "<p>srand should be called only once before any random number is generated. It should not be called again. Otherwise, your numbers won't be as random as you want them to be.</p>\n"}], "owner": {"reputation": 934, "user_id": 3491770, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a4f7b59753e81a7b35f32105b0f627f1?s=128&d=identicon&r=PG", "display_name": "LumberSzquatch", "link": "https://stackoverflow.com/users/3491770/lumberszquatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1424301838, "answer_count": 1, "score": 0, "last_activity_date": 1424303108, "creation_date": 1424301747, "last_edit_date": 1424303108, "question_id": 28595916, "link": "https://stackoverflow.com/questions/28595916/troubles-with-a-random-number-generator", "closed_reason": "Duplicate", "title": "Troubles with a random number generator", "body": "<p>I have a class that represents a checking account, and in the checking account there is a class member that represents an account number. This account number is initialized in the constructor (random numbers obviously) for several different objects. I am having difficulties getting different numbers for each object. Mainly because I am just starting out in C++ and I implemented this RNG idea via several posts I have viewed here on SO.</p>\n\n<p>Here is my constructor:</p>\n\n<pre><code>CheckingAccount::CheckingAccount(const Customer&amp; owner): Account(owner){\n    srand ( time(NULL) );\n    int acctStartNum = 9;\n    int firstDigit = rand() % 10;\n    int secondDigit = rand() % 10;\n    int thirdDigit = rand() % 10;\n    int fourthDigit = rand() % 10;\n\n     ostringstream oss;\n     oss &lt;&lt; acctStartNum &lt;&lt; firstDigit &lt;&lt; secondDigit &lt;&lt; thirdDigit &lt;&lt; fourthDigit;\n    accountNumber = stoi(oss.str());\n\n}\n</code></pre>\n\n<p>I understand <code>srand()</code> seeds the random numbers to provide a nice spread of values each time. But when I had excluded it from my code, each object had a different <code>accountNumber</code>. The catch though was, that each time I ran my program the values never changed (i.e. it generated random values for each object only once and then kept those values), which is why I implemented <code>srand()</code>, but now all objects have the exact same <code>accountNumber</code>, granted they change each time I run the program. What is the deal here? Why were they all different before I implemented <code>srand()</code> and never change, but now they change but apply to all objects? Also just as a side note, I know this may look quite sloppy, but this is for an assignment that instructs me to do this IN the constructor, otherwise I'd make a function. </p>\n"}, {"tags": ["c++", "function"], "comments": [{"owner": {"reputation": 786, "user_id": 1208277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEhwo.jpg?s=128&g=1", "display_name": "Kerry Kobashi", "link": "https://stackoverflow.com/users/1208277/kerry-kobashi"}, "edited": false, "score": 0, "creation_date": 1424301914, "post_id": 28595888, "comment_id": 45498434, "body": "You pass the drawn card as an argument to printcard. If you are not going to change the contents of the card in the printcard method, then just pass a copy of it, not a pointer."}, {"owner": {"reputation": 53, "user_id": 3010803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/03231e3f8eee0bc71db15a9fc781ce7f?s=128&d=identicon&r=PG&f=1", "display_name": "aishere", "link": "https://stackoverflow.com/users/3010803/aishere"}, "reply_to_user": {"reputation": 786, "user_id": 1208277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KEhwo.jpg?s=128&g=1", "display_name": "Kerry Kobashi", "link": "https://stackoverflow.com/users/1208277/kerry-kobashi"}, "edited": false, "score": 0, "creation_date": 1424302142, "post_id": 28595888, "comment_id": 45498520, "body": "Passing it as an argument so <code>printCard(drawnCard)</code> gives me the error, printCard declared void and drawnCard not declared in this scope. I added it in the class prototype, but in my header I get drawnCard does not name a type error. What type would drawnCard be in this case?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424302693, "post_id": 28595888, "comment_id": 45498704, "body": "@aishere You probably need something like <code>printCard(const Card&amp; drawnCard)</code> but you&#39;re not giving enough context to explain why the errors you got actually appear. Consider to edit your question and give a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 53, "user_id": 3010803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/03231e3f8eee0bc71db15a9fc781ce7f?s=128&d=identicon&r=PG&f=1", "display_name": "aishere", "link": "https://stackoverflow.com/users/3010803/aishere"}, "edited": false, "score": 0, "creation_date": 1424303268, "post_id": 28595888, "comment_id": 45498895, "body": "Okay, I used what you suggested. Now to simply test my printCard function to see if the output is a random card, what would the call be in main? Since this is a fairly complicated function header, I&#39;m not sure."}], "owner": {"reputation": 53, "user_id": 3010803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/03231e3f8eee0bc71db15a9fc781ce7f?s=128&d=identicon&r=PG&f=1", "display_name": "aishere", "link": "https://stackoverflow.com/users/3010803/aishere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424304075, "creation_date": 1424301618, "last_edit_date": 1424304075, "question_id": 28595888, "link": "https://stackoverflow.com/questions/28595888/how-to-pass-drawncard-into-a-deal-function", "title": "How to pass drawnCard into a deal function?", "body": "<p>I'm trying to pass my drawnCard, that is chosen randomly in my <code>drawRandomCard()</code> function into my <code>printCard()</code> function and <code>deal()</code> function, so it can be used in these functions. So basically how would I do this, what is the best way to pass this from one function to another, keeping the exact values, in this case a card from the deck. I'm not sure if a pointer would work. <strong>Thanks!</strong></p>\n\n<p><strong>functions.cpp</strong></p>\n\n<pre><code>void Deck::createDeck() {\ndeck.clear();\nstatic const char suits[] = {'C','D','H','S'};\nfor (int suit=0; suit &lt; 4; suit++)\n    for (int val=1; val &lt;=13; val++)\n        deck.push_back(Card(val,suits[suit]));\n}\n\nCard Deck::drawRandomCard()\n{\nint RandIndex=rand() % deck.size();\nCard drawnCard=deck[RandIndex];\ndeck.erase(deck.begin()+RandIndex);\nreturn drawnCard;\n\n}\n\nvoid Card::printCard() const { //for debugging purposes\ncout &lt;&lt; value &lt;&lt; \" of \" &lt;&lt; suit &lt;&lt; endl;\n//want to pass drawnCard here\n}\nvoid StudPoker::deal() {\n//want to pass drawnCard here\n}\n</code></pre>\n\n<p><strong>header file</strong></p>\n\n<pre><code>class Card{\npublic:\n    int value;\n    char suit;\n    string drawnCard;\n    Card(int value, char suit) : value(value), suit(suit) {}\n    void printCard(drawnCard) const;\n\n};\n</code></pre>\n"}, {"tags": ["c++", "animation", "assimp"], "answers": [{"owner": {"reputation": 1046, "user_id": 10019394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPHEq.jpg?s=128&g=1", "display_name": "AdaRaider", "link": "https://stackoverflow.com/users/10019394/adaraider"}, "is_accepted": false, "score": 11, "last_activity_date": 1534335286, "last_edit_date": 1534335286, "creation_date": 1534334140, "answer_id": 51858229, "question_id": 28595852, "link": "https://stackoverflow.com/questions/28595852/how-do-i-get-models-to-animate-using-assimp/51858229#51858229", "title": "How do I get models to animate using Assimp?", "body": "<p>This is an old question but I'm sure it could be of future use to others so I'll try to outline some options you have for doing animation with the Assimp library. </p>\n\n<p>First off, I'd just like to mention that you can do animation without the Assimp library. The library just provides you with a nice way to load your models, but as you've discovered it won't do the animation for you. </p>\n\n<p>Conceptually animation is going to be fairly similar regardless of whether or not you use Assimp. For example; if you have written your own model loader you could easily use that instead of Assimp and still be able to do animation. However, as there is more than one way to do animation, you may be more limited in the way you can achieve it as doing skeletal animation without Assimp would involve writing a model loader that can get the bone transforms, weights and various data out of the model files, and that could take a while.</p>\n\n<p>There are multiple ways to do the animation; both in terms of technique and whether you want to do it with hardware acceleration (on the GPU or on the CPU). I'm going to mention a few of the options you have here since most people use Assimp to do skeletal animation which can be pretty intimidating if you aren't strong in your math skills and just want something that is easy to put together.</p>\n\n<p>Generally there are three accepted ways to do animation:</p>\n\n<ol>\n<li>Keyframe</li>\n<li>Keframe with Interpolation</li>\n<li>Skeletal Animation (hardware skinning)</li>\n</ol>\n\n<p>Keyframe</p>\n\n<p>Keyframe animation is when you create a separate model for each frame of the animation, similar to a 2D sprite sheet. You render the models in succession to produce the animation. This method is probably the simplest, but most naive implementation, since you need to load multiple models for each animation. The transitions between these frames may be noticeable depending on how many frames you produce and you may need to export several model files before it looks acceptable. \nAnother downside to this method is that you would likely need to produce your own models.</p>\n\n<p>Keyframe with Interpolation</p>\n\n<p>This method is similar to the above however rather than producing each key frame as a separate model, just a few key frames are produced and the \"missing\" models are produced with the engine using interpolation. We can do this because if we know the starting point of a vertex and the ending point of a vertex we can interpolate to find out where the vertex should be at time = t. </p>\n\n<p>This tutorial does a great job of explaining how to do key frame animation:</p>\n\n<p><a href=\"https://www.khronos.org/opengl/wiki/Keyframe_Animation\" rel=\"noreferrer\">https://www.khronos.org/opengl/wiki/Keyframe_Animation</a></p>\n\n<p>Again, it doesn't talk about Assimp but the concepts are the same, and you can still use Assimp to load your models.\nThis form of animation is fairly simple to implement and is quite good for a beginner. However it does come with some drawbacks. \nIf you choose to go this route you may be limited by memory as this method can consume a lot of memory with VBO's, this will depend on how detailed your models are.\nIf you choose to create your own models you will also want to preserve the vertex order in the model files so that interpolating between vertex 2 of one model file (key frame 1) to vertex 2 of another model file (key frame 2) will be correct.</p>\n\n<p>Skeletal Animation</p>\n\n<p>This is probably the most difficult way to do animation but it deals with a lot of the issues in method 1 and 2. You'll also find that by doing skeletal animation you are able to load a lot of the newer file formats; those that specify bone transformation and rotations rather than having to load new files for each key frame.</p>\n\n<p>This is one case where I think having Assimp will be of great benefit. Assimp is very well equipped to deal with getting the data you need out of the model file to do skeletal animation.</p>\n\n<p>If you are interested in doing skeletal animation this tutorial is a fantastic way to go about it, and even uses Assimp as well.</p>\n\n<p><a href=\"http://ogldev.atspace.co.uk/www/tutorial38/tutorial38.html\" rel=\"noreferrer\">http://ogldev.atspace.co.uk/www/tutorial38/tutorial38.html</a></p>\n\n<p>I used this tutorial myself to achieve skeletal animation in my own engine. So I strongly encourage you to read this if you decide to go down that path.</p>\n\n<p>The last thing I will mention that I've noticed confuses some people is that animation can be done using hardware acceleration, but it's not strictly necessary.</p>\n\n<p>In the previous tutorial links I provided, both of these are doing animation using hardware acceleration. In this context, it means that the vertex computations are being done on the GPU in the body of the vertex shader. </p>\n\n<p>However I know that a lot people may not be familiar with modern OpenGL in which case you can still do these same calculations on the CPU. The idea here being be to look at what is happening in the vertex shader and create a function that performs those calculations for you.</p>\n\n<p>You also asked about file formats for animation; this is going to depend what route you take to do the animation. If you want to do animation for formats like .fbx and .md5 you will likely be doing skeletal animation. If you go for key frame animation I would probably stick with .obj, this is the format I find the easiest to work with as the format specification is quite easy to understand.</p>\n\n<p>While you're debugging the animation in your engine make sure you have a file which you <em>know</em> works; another pitfall is that downloading free models on the internet can contain any old format, absolute texture paths and different coordinate systems (Y is up or Z is up) etc.</p>\n"}], "owner": {"reputation": 263, "user_id": 4312650, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/90f63738cd04605a5c95ed377a3aa1d0?s=128&d=identicon&r=PG&f=1", "display_name": "WhyYouNoWork", "link": "https://stackoverflow.com/users/4312650/whyyounowork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2632, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1593170829, "creation_date": 1424301407, "question_id": 28595852, "link": "https://stackoverflow.com/questions/28595852/how-do-i-get-models-to-animate-using-assimp", "title": "How do I get models to animate using Assimp?", "body": "<p>Currently I'm trying to make a game engine in C++ with OpenGL and want to get 3D animations to work. I have been advised to use Assimp and was able to find a tutorial to get static models to work, but I have no idea where to even start with animations. I have been trying to Google it, but haven't been able to find anything that works. How can I modify my code to get animations? What file format is recommended for it?</p>\n\n<p>This is the code I have currently:</p>\n\n<pre><code>//Mesh.h    \n#include &lt;string&gt;\n\n#include \"glut\\include\\GL\\glew.h\"\n#include \"glut\\include\\GL\\glut.h\"\n\n#include &lt;assimp/Importer.hpp&gt;      // C++ importer interface\n#include &lt;assimp/scene.h&gt;           // Output data structure\n#include &lt;assimp/postprocess.h&gt;     // Post processing fla\n\n//textures\n#include &lt;SOIL.h&gt;\n\nclass Mesh\n{\npublic:\n    Mesh(void);\n    Mesh(std::string filename, std::string textureFilename, float x, float y, float z, float width, float height, float depth, float rotX, float rotY, float rotZ);\n    ~Mesh(void);\n\n    void Init(std::string filename);\n    void LoadTexture(std::string textureName);\n    void Draw();\n\nprivate:\n    GLfloat *vertexArray;\n    GLfloat *normalArray;\n    GLfloat *uvArray;\n\n    GLint numVerts;\n\n    GLuint m_Texture[1];\n\n    float m_CenterX, m_CenterY, m_CenterZ, m_Width, m_Height, m_Depth;\n    float m_XRotation, m_YRotation, m_ZRotation;\n};\n\n//Mesh.cpp\n#include \"Mesh.h\"\n\nMesh::Mesh(void)\n{\n}\n\nMesh::Mesh(std::string filename, std::string textureFilename, float x, float y, float z, float width, float height, float depth, float rotX, float rotY, float rotZ)\n{\n    //fills in variables\n    Init(filename);\n    LoadTexture(textureFilename);\n}\n\nMesh::~Mesh(void)\n{\n\n}\n\nvoid Mesh::Init(std::string filename)\n{\n    Assimp::Importer importer;\n    const aiScene *scene = importer.ReadFile(filename,aiProcessPreset_TargetRealtime_Fast);//aiProcessPreset_TargetRealtime_Fast has the configs you'll need\n\n    aiMesh *mesh = scene-&gt;mMeshes[0]; //assuming you only want the first mesh\n\n    numVerts = mesh-&gt;mNumFaces*3;\n\n    vertexArray = new float[mesh-&gt;mNumFaces*3*3];\n    normalArray = new float[mesh-&gt;mNumFaces*3*3];\n    uvArray = new float[mesh-&gt;mNumFaces*3*2];\n\n    for(unsigned int i=0;i&lt;mesh-&gt;mNumFaces;i++)\n    {\n        const aiFace&amp; face = mesh-&gt;mFaces[i];\n\n        for(int j=0;j&lt;3;j++)\n        {\n            aiVector3D uv = mesh-&gt;mTextureCoords[0][face.mIndices[j]];\n            memcpy(uvArray,&amp;uv,sizeof(float)*2);\n            uvArray+=2;\n\n            aiVector3D normal = mesh-&gt;mNormals[face.mIndices[j]];\n            memcpy(normalArray,&amp;normal,sizeof(float)*3);\n            normalArray+=3;\n\n            aiVector3D pos = mesh-&gt;mVertices[face.mIndices[j]];\n            memcpy(vertexArray,&amp;pos,sizeof(float)*3);\n            vertexArray+=3;\n        }\n    }\n\n    uvArray-=mesh-&gt;mNumFaces*3*2;\n    normalArray-=mesh-&gt;mNumFaces*3*3;\n    vertexArray-=mesh-&gt;mNumFaces*3*3;\n}\n\nvoid Mesh::LoadTexture(std::string textureName)         \n{\n    glGenTextures(1, &amp;m_Texture[0]);\n    glBindTexture(GL_TEXTURE_2D, m_Texture[0]);\n    // Set our texture parameters\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);\n    // Set texture filtering\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);  // NOTE the GL_NEAREST Here! \n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);  // NOTE the GL_NEAREST Here! \n\n    m_Texture[0] = SOIL_load_OGL_texture // load an image file directly as a new OpenGL texture\n    (\n        textureName.c_str(),\n        SOIL_LOAD_AUTO,\n        SOIL_CREATE_NEW_ID,\n        SOIL_FLAG_MIPMAPS | SOIL_FLAG_NTSC_SAFE_RGB | SOIL_FLAG_COMPRESS_TO_DXT\n    );\n}\n\nvoid Mesh::Draw()\n{\n    glPushMatrix();\n        glTranslatef(m_CenterX, m_CenterY, m_CenterZ);\n\n        glRotatef(m_XRotation, 1, 0, 0);\n        glRotatef(m_YRotation, 0, 1, 0);\n        glRotatef(m_ZRotation, 0, 0, 1);\n\n        glScalef(m_Width, m_Height, m_Depth);\n\n        glEnableClientState(GL_NORMAL_ARRAY);\n        glEnableClientState(GL_TEXTURE_COORD_ARRAY);\n        glEnableClientState(GL_VERTEX_ARRAY);\n\n            glNormalPointer(GL_FLOAT,0,normalArray);\n            glTexCoordPointer(2,GL_FLOAT,0,uvArray);\n            glVertexPointer(3,GL_FLOAT,0,vertexArray);\n\n            glActiveTexture(GL_TEXTURE0);\n            glBindTexture(GL_TEXTURE_2D, m_Texture[0]);\n            glDrawArrays(GL_TRIANGLES,0,numVerts);\n\n        glDisableClientState(GL_NORMAL_ARRAY);\n        glDisableClientState(GL_TEXTURE_COORD_ARRAY);\n        glDisableClientState(GL_VERTEX_ARRAY);\n    glPopMatrix();\n}\n</code></pre>\n"}, {"tags": ["c++", "string", "size"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1424302295, "post_id": 28595767, "comment_id": 45498569, "body": "can you clarify whether <code>test2</code> is meant to be an array of <code>n</code> strings, or a single string with length <code>n</code> ?  And how do you calculate <code>4</code> as the length of <code>Hello</code> ?"}, {"owner": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424302503, "post_id": 28595767, "comment_id": 45498639, "body": "Thank you for your attention, Matt. test_2 is meant to be an array of n strings. Hello&#39;s length = 4 based on -&gt; length - 1."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424304888, "post_id": 28595767, "comment_id": 45499409, "body": "So you actually want the dimension of <code>test_2</code> to be one less than the number of characters the user input (not &quot;equal to&quot; as you said in your first line) ?"}, {"owner": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424339847, "post_id": 28595767, "comment_id": 45511591, "body": "Yes. Basically I said equal as test_2 is an array starting from index 0."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424341060, "post_id": 28595767, "comment_id": 45512352, "body": "maybe you misunderstand - if the array has dimension 4 then it has 4 entries whose indices are 0,1,2,3."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "edited": false, "score": 0, "creation_date": 1424301613, "post_id": 28595818, "comment_id": 45498319, "body": "Thanks a lot. Is there any other way to do this? Because after using that first code, I won&#39;t be able to use the sort function to sort the words in test_2. And after using the second code I won&#39;t be able to use test_2[i] = test_1.substr(i, test_1.size() - i);"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "edited": false, "score": 0, "creation_date": 1424301732, "post_id": 28595818, "comment_id": 45498364, "body": "@fovetobi Of course you can use the <a href=\"http://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\">sort</a> function on vectors. I don&#39;t understand the problem."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "edited": false, "score": 1, "creation_date": 1424302228, "post_id": 28595818, "comment_id": 45498544, "body": "@fovetobi The the pieces of code do different things. I listed them because it was not entirely clear to me what you meant. If you want to sort words, you most likely need the first one. But <i>&quot;How can I sort words?&quot;</i> would be another question. (There is a one question per question rule here on SO, so you would need to start a new one)."}, {"owner": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "edited": false, "score": 0, "creation_date": 1424302630, "post_id": 28595818, "comment_id": 45498683, "body": "Thank you. Yes, I actually want to sort words and I already have done it, and my program works. But I have done it with defining test_2 as test_2[32]. But I don&#39;t want to define a constant value for test_2 (as the user input&#39;s string might vary) so that&#39;s why I opened up this question."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "edited": false, "score": 0, "creation_date": 1424302866, "post_id": 28595818, "comment_id": 45498766, "body": "@fovetobi I do not know your code or your requirements, but I would guess that something like <code>void mySort(std::vector&lt;std::string&gt;&amp; input) {&#47;* sort logic here*&#47;}</code> should suite your needs. <code>n</code> does not need to be constant here at all. You should prefer <a href=\"http://en.cppreference.com/w/cpp/algorithm/sort\" rel=\"nofollow noreferrer\">std::sort</a> over your own sort of course if you are allowed to. It is most likely much better than yours. :) However, the answer to the question you posted is on top of my answer, how to use it with your sort function a different one."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424304911, "post_id": 28595818, "comment_id": 45499420, "body": "OP has clarified he/she does not want the single string option"}], "owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "is_accepted": false, "score": 2, "last_activity_date": 1424335316, "last_edit_date": 1424335316, "creation_date": 1424301282, "answer_id": 28595818, "question_id": 28595767, "link": "https://stackoverflow.com/questions/28595767/defining-the-size-of-an-array-based-on-the-size-of-a-string/28595818#28595818", "title": "Defining The Size of an Array Based on the Size of a String", "body": "<p>Here is how you can get <code>text.size()</code> many empty <code>strings</code>:</p>\n\n<pre><code>std::vector&lt;std::string&gt; test_2 (n);\n</code></pre>\n\n<p>That is the preferred (only real) way to get a dynamically sized array in C++. Do not do it with <code>new[]</code>. It is bad. Really, really bad.</p>\n"}], "owner": {"reputation": 1, "user_id": 4581489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52c453576f029fe6a678a43b6ffb2ca?s=128&d=identicon&r=PG&f=1", "display_name": "fovetobi", "link": "https://stackoverflow.com/users/4581489/fovetobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424335316, "creation_date": 1424301093, "question_id": 28595767, "link": "https://stackoverflow.com/questions/28595767/defining-the-size-of-an-array-based-on-the-size-of-a-string", "title": "Defining The Size of an Array Based on the Size of a String", "body": "<p>I want the size of test_2 to be equal to the number of characters user inputs into test_1. </p>\n\n<p>For example, if the user enters \"Hello\", test_2[n] becomes test_2[4].</p>\n\n<p>The following code doesn't work:</p>\n\n<pre><code>std::string test_1;\ncin &gt;&gt; text;\nint n = text.size();\nstd::string test_2[n];\n</code></pre>\n\n<p>Gives me the error that \"n\" has to be a constant value. Can someone please tell me how to fix this?</p>\n"}, {"tags": ["c++", "gcc", "linker", "makefile", "poco"], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 2452412, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/798f792db7482e224388a59acea80df1?s=128&d=identicon&r=PG", "display_name": "Victor Elizondo", "link": "https://stackoverflow.com/users/2452412/victor-elizondo"}, "edited": false, "score": 0, "creation_date": 1424365708, "post_id": 28606098, "comment_id": 45528538, "body": "It did not work, i believe the makefile is already making the mkdir, please see the the post i will update it with the entire Compile rule definitions for the makefile."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "reply_to_user": {"reputation": 225, "user_id": 2452412, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/798f792db7482e224388a59acea80df1?s=128&d=identicon&r=PG", "display_name": "Victor Elizondo", "link": "https://stackoverflow.com/users/2452412/victor-elizondo"}, "edited": false, "score": 0, "creation_date": 1424439642, "post_id": 28606098, "comment_id": 45560762, "body": "I see some targets that have rules which will create directories, but nothing in your makefile depends on those targets, that I can see, so they won&#39;t ever be run (unless you run them directly via <code>make objdirs</code> or something).  Are you saying that <code>&#47;cygdrive&#47;c&#47;poco-1.4.6p4-all&#47;Foundation&#47;obj&#47;CYGWIN&#47;x86_64&#47;de&zwnj;&#8203;bug_shared</code> does exist?  I&#39;m assuming you have permissions to write to that directory and that you have plenty of disk space.  I can&#39;t see any reason why the compiler would not be able to create the object file, if all those things are true."}], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": false, "score": 0, "last_activity_date": 1424347945, "creation_date": 1424347945, "answer_id": 28606098, "question_id": 28595683, "link": "https://stackoverflow.com/questions/28595683/recipe-fails-when-building-poco-with-gcc/28606098#28606098", "title": "Recipe fails when building poco with gcc", "body": "<p>I would say the problem is that the directory doesn't exist.  The compiler won't create a directory that doesn't exist.  Try modifying your rule to create the directory before invoking the compiler:</p>\n\n<pre><code>$(OBJPATH_DEBUG_SHARED)/%.o: $(SRCDIR)/%.cpp $(DEPPATH)/%.d\n        @echo \"** Compiling\" $&lt; \"(debug, shared)\"\n        mkdir -p $(dir $@)\n        $(CXX) $(INCLUDE) $(CXXFLAGS) $(DEBUGOPT_CXX) $(SHAREDOPT_CXX) -c $&lt; -o $@\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 2452412, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/798f792db7482e224388a59acea80df1?s=128&d=identicon&r=PG", "display_name": "Victor Elizondo", "link": "https://stackoverflow.com/users/2452412/victor-elizondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1011, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424365816, "creation_date": 1424300734, "last_edit_date": 1424365816, "question_id": 28595683, "link": "https://stackoverflow.com/questions/28595683/recipe-fails-when-building-poco-with-gcc", "title": "Recipe fails when building poco with gcc", "body": "<p>Hi im getting this error when trying to build poco with gcc at cygwin console, it is related with a recipe failed and im not sure how to solved this...</p>\n\n<p>Here is the error code:</p>\n\n<pre><code>$ make\nmake -C /cygdrive/c/poco-1.4.6p4-all/Foundation\nmake[1]: Entering directory '/cygdrive/c/poco-1.4.6p4-all/Foundation'\n** Compiling src/ArchiveStrategy.cpp (debug, shared)\ng++  -Iinclude -I/cygdrive/c/poco-1.4.6p4-all/CppUnit/include -I/cygdrive/c/poco-1.4.6p4-all/Foundation/include -I/cygdrive/c/poco-1.4.6p4-all/XML/include -I/cygdrive/c/poco-1.4.6p4-all/Util/include -I/cygdrive/c/poco-1.4.6p4-all/Net/include -I/cygdrive/c/poco-1.4.6p4-all/Crypto/include -I/cygdrive/c/poco-1.4.6p4-all/NetSSL_OpenSSL/include -I/cygdrive/c/poco-1.4.6p4-all/Data/include -I/cygdrive/c/poco-1.4.6p4-all/Data/SQLite/include -I/cygdrive/c/poco-1.4.6p4-all/Data/ODBC/include -I/cygdrive/c/poco-1.4.6p4-all/Data/MySQL/include -I/cygdrive/c/poco-1.4.6p4-all/Zip/include -I/cygdrive/c/poco-1.4.6p4-all/PageCompiler/include -I/cygdrive/c/poco-1.4.6p4-all/PageCompiler/File2Page/include -DPOCO_NO_FPENVIRONMENT -DPOCO_NO_WSTRING -DPOCO_NO_SHAREDMEMORY -DPOCO_BUILD_HOST=PB00YCT7  -D_XOPEN_SOURCE=500  -g -D_DEBUG  -c src/ArchiveStrategy.cpp -o /cygdrive/c/poco-1.4.6p4-all/Foundation/obj/CYGWIN/x86_64/debug_shared/ArchiveStrategy.o\nAssembler messages:\nFatal error: can't create /cygdrive/c/poco-1.4.6p4-all/Foundation/obj/CYGWIN/x86_64/debug_shared/ArchiveStrategy.o: No such file or directory\n/cygdrive/c/poco-1.4.6p4-all/build/rules/compile:53: recipe for target '/cygdrive/c/poco-1.4.6p4-all/Foundation/obj/CYGWIN/x86_64/debug_shared/ArchiveStrategy.o' failed\nmake[1]: *** [/cygdrive/c/poco-1.4.6p4-all/Foundation/obj/CYGWIN/x86_64/debug_shared/ArchiveStrategy.o] Error 1\nmake[1]: Leaving directory '/cygdrive/c/poco-1.4.6p4-all/Foundation'\nMakefile:62: recipe for target 'Foundation-libexec' failed\nmake: *** [Foundation-libexec] Error 2\n</code></pre>\n\n<p>Here is the bunch of code that is close to the line 53 that is showed as error:</p>\n\n<pre><code>$(OBJPATH_DEBUG_SHARED)/%.o: $(SRCDIR)/%.cpp $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(debug, shared)\"\n    $(CXX) $(INCLUDE) $(CXXFLAGS) $(DEBUGOPT_CXX) $(SHAREDOPT_CXX) -c $&lt; -o $@\n</code></pre>\n\n<p>This may be easy to solve but i haven't figure it out in days because im not an expert on c++ and makefiles.</p>\n\n<p>Update: Im still getting the same error, i will add the complete rule definitions file:</p>\n\n<pre><code># $Id: //poco/1.4/build/rules/compile#1 $\n#\n# compile\n#\n# Compile rule definitions for makefiles\n#\n\n#\n# Targets\n#\n.PHONY: all all_static all_shared all_debug all_release \\\n        clean static_debug static_release shared_debug shared_release\n\nall: $(DEFAULT_TARGET)\nall_static: static_debug static_release\nall_shared: shared_debug shared_release\nall_debug: static_debug shared_debug\nall_release: static_release shared_release\n\n#\n# Create directories if necessary\n#\n.PHONY: objdirs libdirs bindirs static_bindirs\nobjdirs: $(OBJPATH_RELEASE_STATIC) $(OBJPATH_DEBUG_STATIC) $(OBJPATH_RELEASE_SHARED) $(OBJPATH_DEBUG_SHARED) \nlibdirs: objdirs $(LIBPATH) \nbindirs: objdirs $(BINPATH)\nstatic_bindirs: objdirs $(BINPATH)/static\n\n$(OBJPATH_RELEASE_STATIC) $(OBJPATH_DEBUG_STATIC) $(OBJPATH_RELEASE_SHARED) $(OBJPATH_DEBUG_SHARED) $(LIBPATH) $(BINPATH) $(BINPATH)/static:\n    $(MKDIR) $@\n\n#\n# Rules for compiling\n#   \n$(OBJPATH_DEBUG_STATIC)/%.o: $(SRCDIR)/%.cpp $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(debug, static)\"\n    $(CXX) $(INCLUDE) $(CXXFLAGS) $(DEBUGOPT_CXX) $(STATICOPT_CXX) -c $&lt; -o $@\n\n$(OBJPATH_RELEASE_STATIC)/%.o: $(SRCDIR)/%.cpp $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(release, static)\"\n    $(CXX) $(INCLUDE) $(CXXFLAGS) $(RELEASEOPT_CXX) $(STATICOPT_CXX) -c $&lt; -o $@\n\n$(OBJPATH_DEBUG_STATIC)/%.o: $(SRCDIR)/%.c $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(debug, static)\"\n    $(CC) $(INCLUDE) $(CFLAGS) $(DEBUGOPT_CC) $(STATICOPT_CC) -c $&lt; -o $@\n\n$(OBJPATH_RELEASE_STATIC)/%.o: $(SRCDIR)/%.c $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(release, static)\"\n    $(CC) $(INCLUDE) $(CFLAGS) $(RELEASEOPT_CC) $(STATICOPT_CC) -c $&lt; -o $@\n\n$(OBJPATH_DEBUG_SHARED)/%.o: $(SRCDIR)/%.cpp $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(debug, shared)\"\n    $(CXX) $(INCLUDE) $(CXXFLAGS) $(DEBUGOPT_CXX) $(SHAREDOPT_CXX) -c $&lt; -o $@\n\n$(OBJPATH_RELEASE_SHARED)/%.o: $(SRCDIR)/%.cpp $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(release, shared)\"\n    $(CXX) $(INCLUDE) $(CXXFLAGS) $(RELEASEOPT_CXX) $(SHAREDOPT_CXX) -c $&lt; -o $@\n\n$(OBJPATH_DEBUG_SHARED)/%.o: $(SRCDIR)/%.c $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(debug, shared)\"\n    $(CC) $(INCLUDE) $(CFLAGS) $(DEBUGOPT_CC) $(SHAREDOPT_CC) -c $&lt; -o $@\n\n$(OBJPATH_RELEASE_SHARED)/%.o: $(SRCDIR)/%.c $(DEPPATH)/%.d\n    @echo \"** Compiling\" $&lt; \"(release, shared)\"\n    $(CC) $(INCLUDE) $(CFLAGS) $(RELEASEOPT_CC) $(SHAREDOPT_CC) -c $&lt; -o $@\n\n#\n# Rules for creating dependency information\n#\n$(DEPPATH)/%.d: $(SRCDIR)/%.cpp\n    @echo \"** Creating dependency info for\" $^\n    $(MKDIR) $(DEPPATH)\n    $(DEP) $(SRCDIR)/$(patsubst %.d,%.cpp,$(notdir $@)) $@ $(OBJPATH_DEBUG_STATIC) $(OBJPATH_RELEASE_STATIC) $(OBJPATH_DEBUG_SHARED) $(OBJPATH_RELEASE_SHARED) $(INCLUDE) $(CXXFLAGS) \n\n$(DEPPATH)/%.d: $(SRCDIR)/%.c\n    @echo \"** Creating dependency info for\" $^\n    $(MKDIR) $(DEPPATH)\n    $(DEP) $(SRCDIR)/$(patsubst %.d,%.c,$(notdir $@)) $@ $(OBJPATH_DEBUG_STATIC) $(OBJPATH_RELEASE_STATIC) $(OBJPATH_DEBUG_SHARED) $(OBJPATH_RELEASE_SHARED) $(INCLUDE) $(CFLAGS)\n\ndepend: $(addprefix $(DEPPATH)/,$(addsuffix .d,$(objects)))\n</code></pre>\n"}, {"tags": ["c++", "class", "operators", "nodes", "singly-linked-list"], "comments": [{"owner": {"reputation": 86516, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1424301080, "post_id": 28595661, "comment_id": 45498116, "body": "<a href=\"http://www.google.com/\" rel=\"nofollow noreferrer\">Google</a> is your friend!"}], "answers": [{"comments": [{"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1424305568, "post_id": 28595758, "comment_id": 45499656, "body": "@zeDante And for the other part of the code in question, you might want to read up on how a <code>for</code> loop works. See <a href=\"http://www.cprogramming.com/tutorial/c/lesson3.html\" rel=\"nofollow noreferrer\">this page</a> for some info on that subject. I&#39;ll leave the linked list portion of that line of code to you since the class subject appears to be linked lists."}, {"owner": {"reputation": 53, "user_id": 4573629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82c2d3faf4f626d0ca055a0ce69c9f6b?s=128&d=identicon&r=PG&f=1", "display_name": "zeDante", "link": "https://stackoverflow.com/users/4573629/zedante"}, "edited": false, "score": 0, "creation_date": 1424322068, "post_id": 28595758, "comment_id": 45503998, "body": "thank you soo much this really makes alot more sense now. one final question just for clarification, do the line os&lt;&lt;current -&gt; data &lt;&lt; &quot; &quot; a way of saying &#39;cout&#39;"}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1424357403, "post_id": 28595758, "comment_id": 45522480, "body": "yes, <code>os</code> represents the input stream of the function, passed by reference. So when you say <code>cout &lt;&lt; my_list</code>, <code>cout</code> is being passed to <code>operator&lt;&lt;</code> as the first argument. Inside the function it is referred as <code>os</code>. Note also that it is not necessarily to use <code>cout</code>, you can as well use a file <code>out_file &lt;&lt; my_list</code>, and the content will be send to the file, since the latter is also an <code>ostream</code>. That&#39;s the beauty of using inheritance and writing a function that works for the base of a well designed hierarchy."}, {"owner": {"reputation": 53, "user_id": 4573629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82c2d3faf4f626d0ca055a0ce69c9f6b?s=128&d=identicon&r=PG&f=1", "display_name": "zeDante", "link": "https://stackoverflow.com/users/4573629/zedante"}, "edited": false, "score": 0, "creation_date": 1424361893, "post_id": 28595758, "comment_id": 45525761, "body": "thank you. you are a life saver"}], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 3, "last_activity_date": 1424301472, "last_edit_date": 1495540258, "creation_date": 1424301056, "answer_id": 28595758, "question_id": 28595661, "link": "https://stackoverflow.com/questions/28595661/can-someone-explain-to-what-this-line-of-code-does-it-is-about-linked-lists/28595758#28595758", "title": "can someone explain to what this line of code does? It is about Linked Lists", "body": "<p>The line</p>\n\n<pre><code>friend ostream&amp; operator&lt;&lt;( ostream&amp; os, const LinkedList &amp;ll )\n</code></pre>\n\n<p>overloads the \"insertion operator\", so you can display your list using the common C++ syntax:</p>\n\n<pre><code>std::cout &lt;&lt; mylist;\n</code></pre>\n\n<p>The line above is equivalent to:</p>\n\n<pre><code>operator&lt;&lt;(std::cout, mylist)\n</code></pre>\n\n<p>The first argument is of type <code>std::ostream</code>, and the second one of type <code>LikedList</code>. </p>\n\n<p>The operator needs to be a friend since it (probably) needs access to private/protected members.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/4421706/operator-overloading\">this</a> for more details on operator overloading.</p>\n"}], "owner": {"reputation": 53, "user_id": 4573629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82c2d3faf4f626d0ca055a0ce69c9f6b?s=128&d=identicon&r=PG&f=1", "display_name": "zeDante", "link": "https://stackoverflow.com/users/4573629/zedante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1424311288, "accepted_answer_id": 28595758, "answer_count": 1, "score": 0, "last_activity_date": 1424301472, "creation_date": 1424300633, "last_edit_date": 1424300789, "question_id": 28595661, "link": "https://stackoverflow.com/questions/28595661/can-someone-explain-to-what-this-line-of-code-does-it-is-about-linked-lists", "closed_reason": "Needs details or clarity", "title": "can someone explain to what this line of code does? It is about Linked Lists", "body": "<p>i was given the following declaration by my professor and i have a couple functions i need to write based on this declaration of LinkedList but i am stuck on determining what a couple lines of code does. i understand everything pretty much up to these lines;</p>\n\n<pre><code>friend ostream&amp; operator&lt;&lt;( ostream&amp; os, const LinkedList &amp;ll )\n{\nLinkedList::Node *current;\nfor (current = ll.head; current != NULL; current = current-&gt;next)\nos &lt;&lt; current-&gt;data &lt;&lt; \" \";\nreturn os;\n}\n</code></pre>\n\n<p>here is the complete code.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstdlib&gt;\nusing namespace std;\nclass LinkedList\n{\npublic:\nLinkedList() { head = NULL; } // default constructor makes an empty list\n// functions to aid in debugging\n// -----------------------------\nfriend ostream&amp; operator&lt;&lt;( ostream&amp; os, const LinkedList &amp;ll );\nvoid insertHead( int item );\nprivate:\nclass Node // inner class for a linked list node\n{\npublic:\nNode( int item, Node *n ) // constructor\nint data; // the data item in a node\nNode *next; // a pointer to the next node in the list\n};\nNode *head; // the head of the list\n};\nfriend ostream&amp; operator&lt;&lt;( ostream&amp; os, const LinkedList &amp;ll )\n{\nLinkedList::Node *current;\nfor (current = ll.head; current != NULL; current = current-&gt;next)\nos &lt;&lt; current-&gt;data &lt;&lt; \" \";\nreturn os;\n}\nvoid LinkedList::insertHead( int item ) // insert at head of list\n{\nhead = new Node( item, head );\n}\nLinkedList::Node::Node( int item, Node *n ) {Node::data = item; next = n;}\n</code></pre>\n\n<hr>\n\n<p>ps. can someone also please explain what friend operator does, coz i have never used it before?</p>\n"}, {"tags": ["c++", "opengl", "glsl", "glm-math"], "answers": [{"comments": [{"owner": {"reputation": 2761, "user_id": 2329287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5c25b179f8b1396a39e89019a7791?s=128&d=identicon&r=PG", "display_name": "GuyRT", "link": "https://stackoverflow.com/users/2329287/guyrt"}, "edited": false, "score": 0, "creation_date": 1424358317, "post_id": 28597384, "comment_id": 45523124, "body": "Shouldn&#39;t the stride be 64 (not 48)?"}, {"owner": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "reply_to_user": {"reputation": 2761, "user_id": 2329287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e5c25b179f8b1396a39e89019a7791?s=128&d=identicon&r=PG", "display_name": "GuyRT", "link": "https://stackoverflow.com/users/2329287/guyrt"}, "edited": false, "score": 0, "creation_date": 1424365431, "post_id": 28597384, "comment_id": 45528347, "body": "@GuyRT Yeah, that&#39;s what I had originally, then I edited the question without adequate sleep :P"}, {"owner": {"reputation": 45, "user_id": 4581640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a437221219a2b22a671ddfccba8e01e?s=128&d=identicon&r=PG&f=1", "display_name": "Woodfighter", "link": "https://stackoverflow.com/users/4581640/woodfighter"}, "edited": false, "score": 0, "creation_date": 1424371757, "post_id": 28597384, "comment_id": 45532146, "body": "@Andon Thank you very much, that worked! I only had to add a reinterpret_cast to GLvoid* around the last attribute of glVertexAttribPointer"}], "owner": {"reputation": 39713, "user_id": 2423205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EX7y2.png?s=128&g=1", "display_name": "Andon M. Coleman", "link": "https://stackoverflow.com/users/2423205/andon-m-coleman"}, "is_accepted": true, "score": 6, "last_activity_date": 1424365444, "last_edit_date": 1424365444, "creation_date": 1424310450, "answer_id": 28597384, "question_id": 28595598, "link": "https://stackoverflow.com/questions/28595598/glm-mat4x4-to-layout-qualifier/28597384#28597384", "title": "GLM mat4x4 to layout qualifier", "body": "<p>Your problem is not actually the <code>layout</code> qualifier at all, you need to understand some nuances of vertex attributes.</p>\n\n<p>On GPUs, every vertex attribute is a 4-component vector, whether you declare it <code>float</code>, <code>vec2</code>, <code>vec3</code> or <code>vec4</code>. That works fine for all of the types I just mentioned, the unused parts of that 4-component vector are assigned <strong>0,0,1</strong> respectively.</p>\n\n<p>For <code>mat4</code>, however, the story is very different. A <code>mat4</code> is effectively an array of four <code>vec4</code>s, and this means that <code>layout(location = 4) in mat4 transformation;</code> actually occupies 4 different locations (all sequential).</p>\n\n<p><code>transformation</code> is composed of four 4-component vectors assigned to locations <strong>4</strong>, <strong>5</strong>, <strong>6</strong> and <strong>7</strong>. <code>glVertexAttribPointer(4, 16, GL_FLOAT, GL_FALSE, 0, 0);</code> is wrong, and this needs to be split into multiple calls like so:</p>\n\n<pre><code>// Setup 4 different vertex attributes (one for each column of your matrix).\n\n// Each matrix has a stride of 64-bytes and each column of the matrix advances 16-bytes\nglVertexAttribPointer (4, 4, GL_FLOAT, GL_FALSE, 64, 0);\nglVertexAttribPointer (5, 4, GL_FLOAT, GL_FALSE, 64, 16);\nglVertexAttribPointer (6, 4, GL_FLOAT, GL_FALSE, 64, 32);\nglVertexAttribPointer (7, 4, GL_FLOAT, GL_FALSE, 64, 48);\n</code></pre>\n\n<p>You will also need to enable, disable and setup a vertex attribute divisor for all four of those attribute locations to make your code work correctly.</p>\n"}], "owner": {"reputation": 45, "user_id": 4581640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a437221219a2b22a671ddfccba8e01e?s=128&d=identicon&r=PG&f=1", "display_name": "Woodfighter", "link": "https://stackoverflow.com/users/4581640/woodfighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "accepted_answer_id": 28597384, "answer_count": 1, "score": 2, "last_activity_date": 1495319396, "creation_date": 1424300336, "last_edit_date": 1495319396, "question_id": 28595598, "link": "https://stackoverflow.com/questions/28595598/glm-mat4x4-to-layout-qualifier", "title": "GLM mat4x4 to layout qualifier", "body": "<p>I am currently learning OpenGL for a hobby project and I reached the point where I want to do some particle effects with instancing.</p>\n\n<p>To give each of my particles its own transformation, I am building a vector with transformation matrices and use the values for the buffer:</p>\n\n<pre><code>    glBindBuffer(GL_ARRAY_BUFFER, particleEffect-&gt;getTransformationBufferID());\n    std::vector&lt;glm::mat4x4&gt; particleTransformations;\n    const std::vector&lt;Particle&gt;&amp; particles = particleEffect-&gt;getParticles();\n    for(std::vector&lt;Particle&gt;::const_iterator particleIt = particles.cbegin();\n        particleIt != particles.cend();\n        ++ particleIt)\n    {\n        particleTransformations.push_back(particleIt-&gt;getTransformation());\n    }\n    glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(particleTransformations[0]) * particles.size(),  particleTransformations.data());\n    glEnableVertexAttribArray(4);\n    glVertexAttribPointer(4, 16, GL_FLOAT, GL_FALSE, 0, 0);\n</code></pre>\n\n<p>I am initializing my transformation buffer this way:</p>\n\n<pre><code>        glGenBuffers(1, &amp;transformationBufferID_);\n        glBindBuffer(GL_ARRAY_BUFFER, transformationBufferID_);\n        glBufferData(GL_ARRAY_BUFFER, sizeof(glm::mat4x4) * particles_.size(), nullptr, GL_STREAM_DRAW);\n</code></pre>\n\n<p>And I use this simple draw code:</p>\n\n<pre><code>    glVertexAttribDivisor(0, 0);\n    glVertexAttribDivisor(1, 0);\n    glVertexAttribDivisor(2, 0);\n    glVertexAttribDivisor(3, 0);\n    glVertexAttribDivisor(4, 1); //(4, 1), because each particle has its own transformation matrix at (layout location = 4)?!\n    glDrawArraysInstanced(GL_TRIANGLE_STRIP, 0, particleEffect-&gt;getVertices().size(), particleEffect-&gt;getParticles().size());//getVertices() are the same vertices for each particle\n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n    glDisableVertexAttribArray(2);\n    glDisableVertexAttribArray(3);\n    glDisableVertexAttribArray(4);\n</code></pre>\n\n<p>My vertex shader header looks like this:</p>\n\n<pre><code>    #version 430 core\n    layout(location = 0) in vec3 vertexPosition;\n    layout(location = 1) in vec3 normals;\n    layout(location = 2) in vec4 colors;\n    layout(location = 3) in vec2 uvCoordinates;\n    layout(location = 4) in mat4 transformation;\n</code></pre>\n\n<p>This leads to a crash with the glError 1281, but only if I use glEnableVertexAttribArray(4).  Otherwise this doesn't crash. I am also able to draw my simple particle mesh when I use an identity matrix instead of my transformation matrix.</p>\n\n<p>I used glGetAttribLocation(programID, \"transformation\") to find out if the location is correct. Yep, it is correct.</p>\n"}, {"tags": ["c++", "mysql"], "owner": {"reputation": 1261, "user_id": 2303378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ff8bb3b43552420897498876c08527d?s=128&d=identicon&r=PG", "display_name": "Denis Blank", "link": "https://stackoverflow.com/users/2303378/denis-blank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1426682246, "creation_date": 1424300335, "last_edit_date": 1426682246, "question_id": 28595597, "link": "https://stackoverflow.com/questions/28595597/mysql-c-connector-execute-huge-200mb-queries-dumps-with-mysql-query", "title": "MySQL C++ connector: Execute huge (&gt; 200MB) queries (dumps) with &#39;mysql_query&#39;", "body": "<p>I've got a connection (with MYSQL_OPTION_MULTI_STATEMENTS_ON enabled) and i want to use it to populate a database from a full dump (200 MB) with mysql_query(). (<strong>I don't want to use a mysql cli or something</strong>).</p>\n\n<p>This works well for queries below 100 MB. As soon as the table is half populated the batching process aborts without returning any error, max_allowed_packet is set to 1 GB.</p>\n\n<p>Is it possible to use mysql_query with huge queries or do i need to split it in multiple substeps?</p>\n\n<p>Im running on:</p>\n\n<ul>\n<li>MariaDB 10.0.14 x64</li>\n<li>Xeon E3, 4x 3.3ghz</li>\n<li>8 gb ram</li>\n<li>Win 8.1 x64</li>\n</ul>\n"}, {"tags": ["c++", "pointers", "vector"], "comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1424300217, "post_id": 28595537, "comment_id": 45497756, "body": "Why does the pointer become NULL in the other scope? Show that code please."}, {"owner": {"reputation": 15025, "user_id": 862351, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c7ac8ffed3327e80c6b77651ba30b83e?s=128&d=identicon&r=PG", "display_name": "Pradhan", "link": "https://stackoverflow.com/users/862351/pradhan"}, "edited": false, "score": 5, "creation_date": 1424300225, "post_id": 28595537, "comment_id": 45497759, "body": "The issue is elsewhere. The behaviour you have described has nothing to do with <code>vector::push_back</code>."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 1, "creation_date": 1424300256, "post_id": 28595537, "comment_id": 45497770, "body": "This doesn&#39;t make sense.  Pointers are passed by-value and there is nothing the <code>addGameObject</code> function can do to make the original pointer <code>NULL</code>.  Modern C++ should probably use smart pointers instead, anyway."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1424300278, "post_id": 28595537, "comment_id": 45497781, "body": "This vaguely sounds like a design the designer stopped understanding."}, {"owner": {"reputation": 8029, "user_id": 3137499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7acff2bbbdb9c51ea478377a0f6dcb03?s=128&d=identicon&r=PG&f=1", "display_name": "aruisdante", "link": "https://stackoverflow.com/users/3137499/aruisdante"}, "edited": false, "score": 0, "creation_date": 1424300309, "post_id": 28595537, "comment_id": 45497796, "body": "Unless by &#39;NULL&#39; they actually mean &#39;goes out of scope and is destroyed, creating an invalid pointer&#39;, in which case they need to learn about both <code>new</code> and <code>smart_ptr</code>."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 2, "creation_date": 1424300317, "post_id": 28595537, "comment_id": 45497803, "body": "I guess you have bungled your ownership semantics. Who owns those <code>GameObjects</code>, and is on the hook for <code>delete</code>-ing them?"}], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1424301353, "post_id": 28595628, "comment_id": 45498229, "body": "Why no <code>std::move</code>? Also, <code>std::unique_ptr</code> can conceivably be more appropriate there, though we cnnot really tell."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1424301446, "post_id": 28595628, "comment_id": 45498253, "body": "@Deduplicator <i>&quot;though we cannot really tell.&quot;</i> Yeah. At least I have mentioned the other (main) available smart pointer variants. What the OP actually needs, completely depends on the (not further explained) semantics."}], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 1, "last_activity_date": 1424301933, "last_edit_date": 1424301933, "creation_date": 1424300487, "answer_id": 28595628, "question_id": 28595537, "link": "https://stackoverflow.com/questions/28595537/how-to-contain-derived-types-in-a-vector/28595628#28595628", "title": "How to contain derived types in a vector?", "body": "<blockquote>\n  <p><em>\"The problem that arises happens when I want to add GameObjects to the vector. When I pass in a pointer to addGameObject, the pointer becomes NULL in the other scope.\"</em></p>\n</blockquote>\n\n<p>I can't tell why these pointers <em>become <code>NULL</code> in the other scope</em>, as you don't mentioned enough context to proove this.</p>\n\n<p>But I think the better choice seems to be using a <a href=\"http://en.cppreference.com/w/cpp/memory\" rel=\"nofollow\">smart pointer</a> like this</p>\n\n<pre><code>// Game.h\nclass Game {\nprivate:\n    std::vector&lt;std::shared_ptr&lt;GameObject&gt;&gt; gameObjects;\npublic:\n    void addGameObject(std::shared_ptr&lt;GameObject&gt; gameObject) {\n        gameObjects.push_back(gameObject);\n    }\n}\n</code></pre>\n\n<p>There are more choices for smart pointers, depending on your actual use cases for them, namely <code>std::unique_ptr&lt;GameObject&gt;</code> or <code>std::weak_ptr&lt;GameObject&gt;</code>.</p>\n\n<p><code>std::shared_ptr&lt;GameObject&gt;</code> (or the other mentioned smart pointer variants) should serve well for instances derived from <code>GameObject</code> class like e.g.</p>\n\n<pre><code>class Player : public GameObject {\n    // ...\n};\n</code></pre>\n\n<p>This would manage references to your <code>GameObject</code> instance, as they are in use, or being owned in any scope.</p>\n"}], "owner": {"reputation": 51, "user_id": 3562571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVsTW.jpg?s=128&g=1", "display_name": "bmchugh82", "link": "https://stackoverflow.com/users/3562571/bmchugh82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1424309156, "answer_count": 1, "score": -1, "last_activity_date": 1424301933, "creation_date": 1424300044, "last_edit_date": 1424301147, "question_id": 28595537, "link": "https://stackoverflow.com/questions/28595537/how-to-contain-derived-types-in-a-vector", "closed_reason": "Not suitable for this site", "title": "How to contain derived types in a vector?", "body": "<p>I am making a game in C++ and I want my Game class to hold all of the GameObjects. It has a vector of the abstract base GameObject class, but in order for it to hold derived types it must be a vector of pointers to GameObjects:</p>\n\n<pre><code>// Game.h\nclass Game {\nprivate:\n    std::vector&lt;GameObject*&gt; gameObjects;\npublic:\n    void addGameObject(GameObject* gameObject) {\n        gameObjects.push_back(gameObject);\n    }\n}\n</code></pre>\n\n<p>The problem that arises happens when I want to add GameObjects to the vector. When I pass in a pointer to addGameObject, the pointer becomes NULL in the other scope. So I would like for the pointer to be stored in the vector, but not become NULL immediately afterwards. I do not know how I could get around this problem. Any ideas?</p>\n\n<p>Edit: Thank you all for commenting. I have used C++ for a while now but I am new to using pointers and do not fully understand them yet. I knew that you needed to use them to create the vector that held the derived objects. I guess I need to research pointers a lot more.</p>\n"}, {"tags": ["c++", "visual-c++", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 1037, "user_id": 4316334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cbfe91ab0a007708f8bbe52327aaf640?s=128&d=identicon&r=PG&f=1", "display_name": "FelipeDurar", "link": "https://stackoverflow.com/users/4316334/felipedurar"}, "edited": false, "score": 0, "creation_date": 1424301163, "post_id": 28595518, "comment_id": 45498149, "body": "I know you double checked it, but are you sure you didn&#39;t forget to link SDL2.lib (don&#39;t forget the &quot;2&quot; in SDL2.lib)"}, {"owner": {"reputation": 11, "user_id": 4581656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxVkZ.jpg?s=128&g=1", "display_name": "Minkai Ong", "link": "https://stackoverflow.com/users/4581656/minkai-ong"}, "reply_to_user": {"reputation": 1037, "user_id": 4316334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cbfe91ab0a007708f8bbe52327aaf640?s=128&d=identicon&r=PG&f=1", "display_name": "FelipeDurar", "link": "https://stackoverflow.com/users/4316334/felipedurar"}, "edited": false, "score": 0, "creation_date": 1424375357, "post_id": 28595518, "comment_id": 45534144, "body": "Yeap, checked that. Updated my post to show all the settings."}, {"owner": {"reputation": 1037, "user_id": 4316334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cbfe91ab0a007708f8bbe52327aaf640?s=128&d=identicon&r=PG&f=1", "display_name": "FelipeDurar", "link": "https://stackoverflow.com/users/4316334/felipedurar"}, "edited": false, "score": 1, "creation_date": 1424376289, "post_id": 28595518, "comment_id": 45534677, "body": "do you tried to use the x86 folder for libraries? even your computer using a 64-bit os, your project is by default a x86 project."}, {"owner": {"reputation": 42694, "user_id": 1175077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AWgLI.jpg?s=128&g=1", "display_name": "jpw", "link": "https://stackoverflow.com/users/1175077/jpw"}, "edited": false, "score": 1, "creation_date": 1424380770, "post_id": 28595518, "comment_id": 45537222, "body": "Try changing the order in additional dependecies and place <code>SDL2main.lib</code> before <code>SDL2.lib</code>. I have a vague memory that the order might matter (at least it used to iirc). But I think the most likely cause of the problem is that you include 64-bit libs and link with a dll built for x86."}, {"owner": {"reputation": 11, "user_id": 4581656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxVkZ.jpg?s=128&g=1", "display_name": "Minkai Ong", "link": "https://stackoverflow.com/users/4581656/minkai-ong"}, "edited": false, "score": 1, "creation_date": 1424400683, "post_id": 28595518, "comment_id": 45544075, "body": "Yes! It worked. I just needed to use x86 folder for libraries and change SDL2.dll to the x86 version."}, {"owner": {"reputation": 42694, "user_id": 1175077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AWgLI.jpg?s=128&g=1", "display_name": "jpw", "link": "https://stackoverflow.com/users/1175077/jpw"}, "edited": false, "score": 0, "creation_date": 1424692242, "post_id": 28595518, "comment_id": 45639644, "body": "Voting to close this question as it has been resolved and don&#39;t need answering any longer."}], "answers": [{"owner": {"user_type": "does_not_exist", "display_name": "user1608171"}, "is_accepted": false, "score": 0, "last_activity_date": 1426083256, "last_edit_date": 1426083256, "creation_date": 1426082466, "answer_id": 28988641, "question_id": 28595518, "link": "https://stackoverflow.com/questions/28595518/sdl-2-0-build-error-using-vs/28988641#28988641", "title": "SDL 2.0 build error using VS", "body": "<p>In order to build an x64 SDL 2.0 application with VS2013, you need to create the platform and setup the following from your project properties :</p>\n\n<p>1 - \"Project Properties\" -> \"Configuration Manager\" -> \"Active solution platform\" drop-down menu and select \"&lt; New... >\"</p>\n\n<p>2 - In the \"New Solution Platform\" dialog, choose \"x64\" in the \"Type or select the new platform\" drop-down menu</p>\n\n<p>3 - In the same dialog, leave \"Copy settings from\" on Win32, check \"create new project platform\" check-box</p>\n\n<p>Note : Yet after these 3 steps, your VC++ Directories for this project will all be correctly set for the x64 flavor (check VC++ Directories in the project settings).</p>\n\n<p>4 - Make sure (or setup) your \"C/C++\" -> \"General\" -> \"Additional Include Directories\" contains a path to your \"SDL/include\" folder</p>\n\n<p>5 - Make sure (or setup) your \"Linker\" -> \"General\" -> \"Additional Library Directories\" contains a path to your \"SDL/lib/x64\" folder</p>\n\n<p>6 - Make sure (or setup) your \"Linker\" -> \"Input\" -> \"Additional Dependencies\" contains \"SDL2.lib;\" and \"SDL2main.lib;\"</p>\n\n<p>7 - Your sample should compile and link now. Make sure your executable can access \"SDL/lib/x64/SDL2.dll\" (eg. paste it next your exe) in order to run it</p>\n\n<p>HTH</p>\n"}, {"owner": {"reputation": 1, "user_id": 15045849, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gj93VgShHckbjNgeAQWigg14LC8g5iHWrHk-YifiQ=k-s128", "display_name": "Prachet Shah", "link": "https://stackoverflow.com/users/15045849/prachet-shah"}, "is_accepted": false, "score": -1, "last_activity_date": 1618377014, "creation_date": 1618377014, "answer_id": 67085847, "question_id": 28595518, "link": "https://stackoverflow.com/questions/28595518/sdl-2-0-build-error-using-vs/67085847#67085847", "title": "SDL 2.0 build error using VS", "body": "<p>To run SDL Program , you need to add the include libraries in directories setting and include this line in your code:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#define SDL_MAIN_HANDLED</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 11, "user_id": 4581656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kxVkZ.jpg?s=128&g=1", "display_name": "Minkai Ong", "link": "https://stackoverflow.com/users/4581656/minkai-ong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1317, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1618377014, "creation_date": 1424299972, "last_edit_date": 1424691911, "question_id": 28595518, "link": "https://stackoverflow.com/questions/28595518/sdl-2-0-build-error-using-vs", "title": "SDL 2.0 build error using VS", "body": "<p>I was following <a href=\"http://lazyfoo.net/tutorials/SDL/01_hello_SDL/windows/msvsnet2010u/index.php\" rel=\"nofollow\">Lazy Foo's tutorial for getting started with SDL</a>.<br>\nSo I followed all the instructions on the page and got some compilation error.</p>\n\n<p>Here's the source code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;SDL.h&gt;\n\n\nint main(int argc, char *argv[]){\n   if (SDL_Init(SDL_INIT_EVERYTHING) != 0){\n      std::cout &lt;&lt; \"SDL_Init Error: \" &lt;&lt; SDL_GetError() &lt;&lt; std::endl;\n      return 1;\n   }\n   SDL_Quit();\n\n   return 0;\n}\n</code></pre>\n\n<blockquote>\n<pre><code>Error 1 error LNK2019: unresolved external symbol _SDL_GetError referenced in function _SDL_main\nError 2 error LNK2019: unresolved external symbol _SDL_Init referenced in function _SDL_main\nError 3 error LNK2019: unresolved external symbol _SDL_Quit referenced in function _SDL_main\nError 4 error LNK2019: unresolved external symbol _WinMain@16 referenced in __tmainCRTStartup\n</code></pre>\n</blockquote>\n\n<p>I've double checked to make sure my settings are correct.</p>\n\n<p>Configuration Properties > VC++ Directories > Include Directories</p>\n\n<blockquote>\n<pre><code>C:\\Users\\Minkai\\Documents\\Visual Studio 2013\\Projects\\SDL2-2.0.3\\include;$(IncludePath)\n</code></pre>\n</blockquote>\n\n<p>Configuration Properties > VC++ Directories > Library Directories</p>\n\n<blockquote>\n<pre><code>C:\\Users\\Minkai\\Documents\\Visual Studio 2013\\Projects\\SDL2-2.0.3\\lib\\x64;$(LibraryPath)\n</code></pre>\n</blockquote>\n\n<p>Configuration Properties > Linker > Input > Additional Dependencies </p>\n\n<blockquote>\n<pre><code>SDL2.lib;SDL2main.lib;%(AdditionalDependencies)\n</code></pre>\n</blockquote>\n\n<p>Configuration Properties > Linker > System > SubSystem\nI tried switching between Window and Console, doesn't work. </p>\n\n<p>I put my SDL2.dll everywhere in the project just to make sure.</p>\n\n<p>Some information:</p>\n\n<ol>\n<li>Using the latest SDL SDL2-devel-2.0.3-VC.zip</li>\n<li>IDE is Microsoft Visual Studio Express 2013 for Windows Desktop\nVersion 12.0.31101.00 Update 4</li>\n<li>OS is 64-bit Windows 8.1</li>\n</ol>\n"}, {"tags": ["c++", "constructor", "linked-list"], "comments": [{"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 0, "creation_date": 1424299287, "post_id": 28595352, "comment_id": 45497379, "body": "You can just use <code>std::list</code>. It is a linked list."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 5, "creation_date": 1424299361, "post_id": 28595352, "comment_id": 45497408, "body": "The very idea is bad. See this: <a href=\"http://www.gotw.ca/gotw/023.htm\" rel=\"nofollow noreferrer\">gotw.ca/gotw/023.htm</a>"}, {"owner": {"reputation": 18300, "user_id": 212870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51619fe88436dc413b2c6e9498835646?s=128&d=identicon&r=PG", "display_name": "Alan Stokes", "link": "https://stackoverflow.com/users/212870/alan-stokes"}, "edited": false, "score": 2, "creation_date": 1424299484, "post_id": 28595352, "comment_id": 45497459, "body": "Just copy and swap. Easier and not broken"}, {"owner": {"reputation": 1098, "user_id": 2987744, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jaa04.png?s=128&g=1", "display_name": "T145", "link": "https://stackoverflow.com/users/2987744/t145"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1424299980, "post_id": 28595352, "comment_id": 45497654, "body": "NO_NAME: Just trying to learn the tricks of the trade :) @Fred Larson Would making separate functions to handle all of the functionality be better, or could I just use what I have? Maybe in assignment of a new list? Alan Stokes: Where does the &quot;swap&quot; come into play?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1424300152, "post_id": 28595352, "comment_id": 45497723, "body": "@T145: See <a href=\"http://www.gotw.ca/gotw/059.htm\" rel=\"nofollow noreferrer\">another GOTW article for how to use a swap</a>."}], "answers": [{"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "is_accepted": false, "score": 3, "last_activity_date": 1424300422, "last_edit_date": 1424300422, "creation_date": 1424299576, "answer_id": 28595436, "question_id": 28595352, "link": "https://stackoverflow.com/questions/28595352/properly-using-constructors-in-c/28595436#28595436", "title": "Properly using constructors in C++", "body": "<p>Manual calling constructors or destructors is almost always a very bad idea. They are not designed to it.</p>\n\n<p>You should create separate functions to clearing and copying the list. Constructor and destructor can use these methods.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1424300301, "post_id": 28595563, "comment_id": 45497792, "body": "I think the destructor/new version is valid code, however if the <code>new</code> throws then you end up in a horrible mess, so there is good reason to avoid it."}, {"owner": {"reputation": 1098, "user_id": 2987744, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jaa04.png?s=128&g=1", "display_name": "T145", "link": "https://stackoverflow.com/users/2987744/t145"}, "edited": false, "score": 0, "creation_date": 1424300651, "post_id": 28595563, "comment_id": 45497961, "body": "So all I need is <code>swap(*this, &amp;l); return *this;</code>?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 1098, "user_id": 2987744, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jaa04.png?s=128&g=1", "display_name": "T145", "link": "https://stackoverflow.com/users/2987744/t145"}, "edited": false, "score": 0, "creation_date": 1424300880, "post_id": 28595563, "comment_id": 45498037, "body": "@T145 yes, but without the <code>&amp;</code>.  And the assignment operator function should take <code>l</code> by value (not by reference)."}, {"owner": {"reputation": 1098, "user_id": 2987744, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jaa04.png?s=128&g=1", "display_name": "T145", "link": "https://stackoverflow.com/users/2987744/t145"}, "edited": false, "score": 0, "creation_date": 1424300936, "post_id": 28595563, "comment_id": 45498057, "body": "Ah yes! Thanks a lot!"}], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1424300197, "last_edit_date": 1495535052, "creation_date": 1424300197, "answer_id": 28595563, "question_id": 28595352, "link": "https://stackoverflow.com/questions/28595352/properly-using-constructors-in-c/28595563#28595563", "title": "Properly using constructors in C++", "body": "<p>The correct syntax for what you're attempting is:</p>\n\n<pre><code>this-&gt;~LinkedList();  \nnew(this) LinkedList(l);\n</code></pre>\n\n<p>You've clearly realized that it's good to avoid code duplication, however the preferred way to go about it is to use the <a href=\"https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom\">copy and swap idiom</a> to write the assignment operator.</p>\n"}], "owner": {"reputation": 1098, "user_id": 2987744, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jaa04.png?s=128&g=1", "display_name": "T145", "link": "https://stackoverflow.com/users/2987744/t145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 28595563, "answer_count": 2, "score": 1, "last_activity_date": 1424300422, "creation_date": 1424299095, "question_id": 28595352, "link": "https://stackoverflow.com/questions/28595352/properly-using-constructors-in-c", "title": "Properly using constructors in C++", "body": "<p>I have a simple assignment function as follows:</p>\n\n<pre><code>LinkedList&amp; LinkedList::operator=(const LinkedList &amp;l) {\n    // handle self assignment\n    if (this == &amp;l) {\n        return *this;\n    }\n\n    // free old elements of the list before the new elements from l are assigned\n    ~*this();\n\n    // build the list as a deep copy of l (copy constructor handles empty case)\n    this(l);\n\n    return *this;\n}\n</code></pre>\n\n<p>and whenever I run my program I get a <code>error: \u2018this\u2019 cannot be used as a function</code> response. How do am I supposed to use the constructors in their actual context? Any help is greatly appreciated!</p>\n"}, {"tags": ["c++", "inheritance", "smart-pointers"], "comments": [{"owner": {"reputation": 153402, "user_id": 1204143, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5ca341b160687d99b1317859f91054ee?s=128&d=identicon&r=PG", "display_name": "nneonneo", "link": "https://stackoverflow.com/users/1204143/nneonneo"}, "edited": false, "score": 3, "creation_date": 1424299085, "post_id": 28595337, "comment_id": 45497284, "body": "The question you have to answer is <i>who owns A</i>. That determines entirely what pointer to use."}, {"owner": {"reputation": 3109, "user_id": 708399, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/da63b842391ce46f35d46ac3314873f0?s=128&d=identicon&r=PG", "display_name": "Andrew Spott", "link": "https://stackoverflow.com/users/708399/andrew-spott"}, "reply_to_user": {"reputation": 153402, "user_id": 1204143, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5ca341b160687d99b1317859f91054ee?s=128&d=identicon&r=PG", "display_name": "nneonneo", "link": "https://stackoverflow.com/users/1204143/nneonneo"}, "edited": false, "score": 0, "creation_date": 1424299165, "post_id": 28595337, "comment_id": 45497320, "body": "@nneonneo:  So, if A is not owned by anyone (maybe &quot;main&quot;?), then what would I want?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1424299259, "post_id": 28595337, "comment_id": 45497364, "body": "Who else is using <code>a</code>, is it only <code>C</code>. Or are there others? why not have <code>C</code> just create an <code>a</code>?"}, {"owner": {"reputation": 3109, "user_id": 708399, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/da63b842391ce46f35d46ac3314873f0?s=128&d=identicon&r=PG", "display_name": "Andrew Spott", "link": "https://stackoverflow.com/users/708399/andrew-spott"}, "reply_to_user": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1424299507, "post_id": 28595337, "comment_id": 45497466, "body": "@Ben: because then <code>C</code> would have to cary around <code>B</code>&#39;s instead of <code>A</code>&#39;s."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1424303616, "post_id": 28595337, "comment_id": 45499022, "body": "@AndrewSpott, not true, you could still use a pointer or a unique pointer and instantiate a <code>B</code> and equate it to an <code>a</code>, i am just saying why not have <code>c</code> create the memory for that pointer? Or is <code>a</code> being used in something else which prohibits this?"}], "answers": [{"comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 1, "creation_date": 1424301539, "post_id": 28595486, "comment_id": 45498288, "body": "I think you have leapt to using <code>shared_ptr</code> too eagerly. If some other object has unique ownership of a dynamically-allocated <code>A</code> instance and will outlive <code>C</code> then that class should use a <code>unique_ptr</code> and <code>C</code> should use a pointer or reference. I would only resort to a <code>shared_ptr</code>/<code>weak_ptr</code> combination if the lifetimes are less clear."}, {"owner": {"reputation": 153402, "user_id": 1204143, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5ca341b160687d99b1317859f91054ee?s=128&d=identicon&r=PG", "display_name": "nneonneo", "link": "https://stackoverflow.com/users/1204143/nneonneo"}, "reply_to_user": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1424302817, "post_id": 28595486, "comment_id": 45498738, "body": "@ChrisDrew: Thanks for the feedback. I&#39;ll work that into the answer."}], "owner": {"reputation": 153402, "user_id": 1204143, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5ca341b160687d99b1317859f91054ee?s=128&d=identicon&r=PG", "display_name": "nneonneo", "link": "https://stackoverflow.com/users/1204143/nneonneo"}, "is_accepted": true, "score": 3, "last_activity_date": 1424303010, "last_edit_date": 1424303010, "creation_date": 1424299830, "answer_id": 28595486, "question_id": 28595337, "link": "https://stackoverflow.com/questions/28595337/appropriate-smart-pointer-for-composition/28595486#28595486", "title": "Appropriate smart pointer for composition", "body": "<p>The answer depends strongly on <em>what</em> owns the <code>A</code> instance.</p>\n\n<ul>\n<li>If \"nobody\" owns the <code>A</code> instance, then it must be global or statically allocated. In that case, you should use a plain reference (<code>A&amp;</code>). This also asserts that the object can never be null (i.e. it always exists for the lifetime of the <code>C</code>).</li>\n</ul>\n\n<p>Otherwise, the object is dynamically allocated:</p>\n\n<ul>\n<li>If some other object owns the <code>A</code> instance, and can be proven to outlive the <code>C</code>, then the situation is pretty similar to the statically-allocated case. The owner should have a <code>unique_ptr&lt;A&gt;</code>, and <code>C</code> can have a plain reference.</li>\n<li>If some other object owns the <code>A</code> instance, but may or may not outlive <code>C</code>, then the owner should use a <code>shared_ptr&lt;A&gt;</code> and <code>C</code> should use a <code>weak_ptr&lt;A&gt;</code>. If the owner is deleted before <code>C</code> is, then the <code>weak_ptr</code> will automatically become null.</li>\n<li>If ownership should be <em>shared</em> between the <code>C</code> instance and some other owner, then you should use a <code>shared_ptr&lt;A&gt;</code> in both places. Then, the <code>C</code> instance guarantees that its <code>A</code> member is always valid, and shares ownership (in the sense that all owners must be deleted before the <code>A</code> will be deleted).</li>\n</ul>\n"}], "owner": {"reputation": 3109, "user_id": 708399, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/da63b842391ce46f35d46ac3314873f0?s=128&d=identicon&r=PG", "display_name": "Andrew Spott", "link": "https://stackoverflow.com/users/708399/andrew-spott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 1, "accepted_answer_id": 28595486, "answer_count": 1, "score": 1, "last_activity_date": 1424303010, "creation_date": 1424298981, "question_id": 28595337, "link": "https://stackoverflow.com/questions/28595337/appropriate-smart-pointer-for-composition", "title": "Appropriate smart pointer for composition", "body": "<p>I have an inherited structure for a class:</p>\n\n<pre><code>struct A {\n    ObjectByValue obv;\n};\n\nstruct B : A {\n    OtherThings ot;\n};\n</code></pre>\n\n<p>And another class that wants a pointer to <code>A</code>:</p>\n\n<pre><code>struct C {\n    smartpointer&lt;A&gt; a;\n};\n</code></pre>\n\n<p>When I create <code>C</code>, I pass in an already created <code>B</code> (as a pointer to <code>A</code>).  <code>C</code> doesn't OWN <code>A</code> (and a <code>C</code> without an <code>A</code> doesn't make any sense).  <code>C</code> will (hopefully) always die before the <code>A</code> pointer is freed.  Should I use a smart pointer?  A reference?  A raw pointer?  Is there a best practice here?</p>\n"}, {"tags": ["c++", "c", "enums"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1424298803, "post_id": 28595206, "comment_id": 45497135, "body": "<code>strtok()</code> is probably the worst choice :-( ... And <code>static_cast&lt;type_t &gt;(type_char )</code> doesn&#39;t work, because these types are completely unrelated."}, {"owner": {"reputation": 633, "user_id": 3167839, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/9733482d33613b69ce278f902ecf93bc?s=128&d=identicon&r=PG&f=1", "display_name": "eswaat", "link": "https://stackoverflow.com/users/3167839/eswaat"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424298845, "post_id": 28595206, "comment_id": 45497148, "body": "But I need to split my string in to &quot;|&quot; symbol."}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 1, "creation_date": 1424298896, "post_id": 28595206, "comment_id": 45497182, "body": "Consider more simple solution with defining array (or vector) of strings (or char *) and using enum as an index"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1424306165, "post_id": 28595206, "comment_id": 45499867, "body": "Your code is <i>definitely</i> not valid C, and it is not valid C++; and yet, you&#39;ve tagged both. <code>static_cast</code> implies you meant only the C++ tag, so please <i>only</i> use the language-appropriate tag. C != C++."}], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 3167839, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/9733482d33613b69ce278f902ecf93bc?s=128&d=identicon&r=PG&f=1", "display_name": "eswaat", "link": "https://stackoverflow.com/users/3167839/eswaat"}, "edited": false, "score": 0, "creation_date": 1424299207, "post_id": 28595309, "comment_id": 45497344, "body": "my enum contain around 100 element for simplification I just mention 2 elements. Also char type[] is dynamic,  for simplification I put static value."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 633, "user_id": 3167839, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/9733482d33613b69ce278f902ecf93bc?s=128&d=identicon&r=PG&f=1", "display_name": "eswaat", "link": "https://stackoverflow.com/users/3167839/eswaat"}, "edited": false, "score": 0, "creation_date": 1424305672, "post_id": 28595309, "comment_id": 45499688, "body": "@eswaat There isn&#39;t much you can do - apart from using a macro for adding items to <code>nameToTypeT</code>, e.g. <code>#define ADD_ENUM_NAME(x) nameToTypeT[#x] = x</code> and using <code>ADD_ENUM_NAME(MSG_1); ADD_ENUM_NAME(MSG_2); ... ADD_ENUM_NAME(MSG_1000);</code> there are no simple tricks to make the task simple. It&#39;s perfectly OK to dynamic content in <code>type[]</code>, though."}], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 5, "last_activity_date": 1424298873, "creation_date": 1424298873, "answer_id": 28595309, "question_id": 28595206, "link": "https://stackoverflow.com/questions/28595206/coverting-char-to-enum-in-c/28595309#28595309", "title": "Coverting char * to enum in c++", "body": "<p>Unlike other languages that have stronger run-time \"reflection\" capabilities, in C++ <code>enum</code>s are a purely compile-time artifact. Once the compiler is done, there is no way to get the names of enumeration constants. Debuggers can get them by reading special tables the compiler prepares for the debuggers, but it would be counterproductive to access these files.</p>\n\n<p>If you want to be able to convert names of enumerations to their values, make a <code>unordered_map</code> from <code>string</code> to your <code>enum</code>, populate it statically, and perform lookups as needed:</p>\n\n<pre><code>static std::unordered_map&lt;std::string,type_t&gt; nameToTypeT;\n...\nnameToTypeT[\"MSG_1\"] = MSG_1;\nnameToTypeT[\"MSG_2\"] = MSG_2;\n...\ntype_t = nameToTypeT[std::string(type_char)];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1424309152, "post_id": 28595331, "comment_id": 45500762, "body": "Don&#39;t forget to <code>#undef X</code> if you do it this way."}], "owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "is_accepted": false, "score": 2, "last_activity_date": 1424298957, "creation_date": 1424298957, "answer_id": 28595331, "question_id": 28595206, "link": "https://stackoverflow.com/questions/28595206/coverting-char-to-enum-in-c/28595331#28595331", "title": "Coverting char * to enum in c++", "body": "<p>You will have to write code that translates the text in the string into the relevant enum value. </p>\n\n<p>I typically do this by writing a function along these lines:</p>\n\n<pre><code>type_t str_to_type_t(const char *str)\n{\n#define X(x) { #x, x }\n  struct entry\n  {\n     const char *name;\n     type_t value;\n  };\n  entry table[] = {\n      X(MSG_1),\n      X(MSG_2)\n  };\n\n  for(auto e : table)\n  {\n     if (strcmp(e.name, s) == 0)\n       return e.value;\n  }\n  return -1;   // Or MSG_UNKNOWN or similar. \n}\n</code></pre>\n\n<p>If there are a large number of enums, then using a <code>std::map&lt;std::string, type_t&gt; table;</code> and then <code>if ((auto it = table.find(s)) != table.end()) { return it-&gt;second;</code> [or <code>unordered_map</code>, perhaps would be the better solution, but for a small number it makes little difference.</p>\n"}, {"owner": {"reputation": 4857, "user_id": 1405614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9a70943a5d825c32446259aa7e9348?s=128&d=identicon&r=PG", "display_name": "Valeri Atamaniouk", "link": "https://stackoverflow.com/users/1405614/valeri-atamaniouk"}, "is_accepted": false, "score": 1, "last_activity_date": 1424298973, "creation_date": 1424298973, "answer_id": 28595336, "question_id": 28595206, "link": "https://stackoverflow.com/questions/28595206/coverting-char-to-enum-in-c/28595336#28595336", "title": "Coverting char * to enum in c++", "body": "<p>Here is an example:</p>\n\n<pre><code>struct entry_t\n{\n   type_t      value;\n   const char *literal;\n};\nstatic const entry_t table[] =\n{\n   {MSG_1, \"MSG1\"},\n   {MSG_2, \"MSG2\"},\n};\n\ntype_t typeFromLiteral(const char *literal)\n{\n   for (size_t i = 0; i &lt; sizeof(table)/sizeof(table[0]); ++i)\n   {\n     if (0 == strcmp(table[i].literal, literal))\n     {\n        return table[i].value;\n     }\n   };\n   abort();\n}\n</code></pre>\n"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1472850084, "last_edit_date": 1472850084, "creation_date": 1424301521, "answer_id": 28595876, "question_id": 28595206, "link": "https://stackoverflow.com/questions/28595206/coverting-char-to-enum-in-c/28595876#28595876", "title": "Coverting char * to enum in c++", "body": "<p>You can't cast from <code>char *</code> to <code>enum</code>, they are incompatible types. You have three options</p>\n\n<ol>\n<li><p>Use an </p>\n\n<pre><code>if (strcmp(textualRepresentation, \"EnumValue1\") == 0)\n     return EnumValue1;\nelse if (strcmp(textualRepresentation, \"EnumValue2\") == 0)\n     return EnumValue2;\n</code></pre></li>\n<li><p>Create a struct containing both the textual representation and the value of the <code>enum</code> and then use <code>bsearch()</code> to match the textual representation and retrieve the <code>enum</code> value.</p>\n\n<pre><code>struct EnumData {\n    const char *name;\n    Enum value;\n};\n\nEnumData enums[ENUM_COUNT] = {\n    {\"EnumValue1\", EnumValue1},\n    {\"EnumValue2\", EnumValue2}\n};\n\nint compare_enums(const void *const lhs, const void *const rhs)\n{\n    return strcmp(reinterpret_cast&lt;const EnumData *&gt;(lhs)-&gt;name,\n                  reinterpret_cast&lt;const EnumData *&gt;(rhs)-&gt;name);\n}\n</code></pre>\n\n<p>and then search like this</p>\n\n<pre><code>EnumData  key;\nvoid     *found;\n\nkey.name = \"EnumValue2\";\nfound    = bsearch(&amp;key, enums, ENUM_COUNT, sizeof(EnumData), compare_enums);\nif (found != NULL)\n    std::cout &lt;&lt; reinterpret_cast&lt;EnumData *&gt;(found)-&gt;value &lt;&lt; \" is the enum value\" &lt;&lt; std::endl;\n</code></pre></li>\n<li><p>Use <code>std::map&lt;const char *,Enum&gt;</code>, this is the best option.</p></li>\n</ol>\n\n<p>The following code demonstrates the methods 2 and 3, method 1 is evident</p>\n\n<pre><code>enum Enum {\n    InvalidEnumValue,\n    EnumValue1,\n    EnumValue2,\n    EnumCount\n};\n\nstruct EnumData {\n    const char *name;\n    Enum        value;\n};\n\nstatic EnumData enums[EnumCount] = {\n    {\"EnumValue1\", EnumValue1},\n    {\"EnumValue2\", EnumValue2},\n    {\"InvalidEnumValue\", InvalidEnumValue}\n};   \n\nint compare_enums(const void *const lhs, const void *const rhs)\n{\n    return strcmp(reinterpret_cast&lt;const EnumData *&gt;(lhs)-&gt;name,\n                  reinterpret_cast&lt;const EnumData *&gt;(rhs)-&gt;name);\n}\n\nEnum find_enum_value_with_bsearch(const char *const name)\n{\n    EnumData  key;\n    void     *found;\n\n    key.name = name;\n    found    = bsearch(&amp;key, enums, EnumCount, sizeof(EnumData), compare_enums);\n    if (found == NULL)\n        return InvalidEnumValue;\n    return reinterpret_cast&lt;EnumData *&gt;(found)-&gt;value;\n}\n\n\nint\nmain()\n{\n    Enum                        value;\n    std::map&lt;const char *,Enum&gt; enumsMap;\n\n    enumsMap[\"EnumValue1\"] = EnumValue1;\n    enumsMap[\"EnumValue2\"] = EnumValue2;\n\n    value = find_enum_value_with_bsearch(\"EnumValue2\");\n\n    std::cerr &lt;&lt; value &lt;&lt; std::endl;\n    std::cerr &lt;&lt; enumsMap[\"EnumValue1\"] &lt;&lt; std::endl;\n}\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 3167839, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/9733482d33613b69ce278f902ecf93bc?s=128&d=identicon&r=PG&f=1", "display_name": "eswaat", "link": "https://stackoverflow.com/users/3167839/eswaat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3133, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1472850084, "creation_date": 1424298530, "last_edit_date": 1495542168, "question_id": 28595206, "link": "https://stackoverflow.com/questions/28595206/coverting-char-to-enum-in-c", "title": "Coverting char * to enum in c++", "body": "<p>I want to convert <code>char *</code> to <code>enum</code> so I used <a href=\"https://stackoverflow.com/questions/1297385/c-enum-from-char\">this</a>. But I am getting error while converting <code>char *</code> to <code>enum</code></p>\n\n<p>I cannot change my <code>enum</code>. Also <code>type[]</code> is dynamic for simplification I am showing static value.</p>\n\n<pre><code>enum type_t {\n    MSG_1 = 0,\n    MSG_2\n};\n\nchar type[] = \"MSG_1|MSG_2\";\nchar *type_char;\ntype_char = strtok (type,\"|\");\nwhile (type_char != NULL)\n{\n    type_t type_enum = static_cast&lt;type_t &gt;(type_char );\n    type_char = strtok (NULL, \"|;\");\n}\n</code></pre>\n\n<p>I am getting below error </p>\n\n<pre><code>error: invalid static_cast from type 'char*' to type 'type_t'\n</code></pre>\n\n<p>I want to convert <code>char *</code> to <code>enum</code></p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 1, "creation_date": 1424298603, "post_id": 28595145, "comment_id": 45497057, "body": "Without looking at the rest of your code, note that in <code>a&amp;2 != 0</code> the <code>!=</code> operator has higher precedence than <code>&amp;</code> (unfortunately). So put parentheses around the <code>a&amp;2</code>. See <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/operator_precedence</a> (If you are testing if <code>a</code> is odd you want <code>(a&amp;1)</code>)"}, {"owner": {"reputation": 1, "user_id": 4184147, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7d8905ad95f6322d82edd85c19f73a33?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4184147/peter"}, "edited": false, "score": 0, "creation_date": 1424298660, "post_id": 28595145, "comment_id": 45497090, "body": "It just gives me a build error, when I comment it out it works, but when its there it doesn&#39;t. I just don&#39;t understand what&#39;s wrong with it."}, {"owner": {"reputation": 2234, "user_id": 3052438, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/X9OWu.png?s=128&g=1", "display_name": "NO_NAME", "link": "https://stackoverflow.com/users/3052438/no-name"}, "edited": false, "score": 1, "creation_date": 1424299056, "post_id": 28595145, "comment_id": 45497271, "body": "@Peter Can you paste this error here?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1424299282, "post_id": 28595145, "comment_id": 45497376, "body": "The function itself <a href=\"http://coliru.stacked-crooked.com/a/d0fb153a66d2822d\" rel=\"nofollow noreferrer\">compiles fine</a>."}, {"owner": {"reputation": 1, "user_id": 4184147, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7d8905ad95f6322d82edd85c19f73a33?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4184147/peter"}, "edited": false, "score": 0, "creation_date": 1424299326, "post_id": 28595145, "comment_id": 45497400, "body": "The higher precedence wasn&#39;t the issue, the error is"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1424299377, "post_id": 28595145, "comment_id": 45497415, "body": "@Peter We need an <a href=\"http://www.sscce.org\" rel=\"nofollow noreferrer\">SSCCE</a> and then this will most likely be solved in minutes."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1424299395, "post_id": 28595145, "comment_id": 45497422, "body": "<b>What Error</b> ? My build-log-clairvoyance is on the fritz today."}, {"owner": {"reputation": 1, "user_id": 4184147, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7d8905ad95f6322d82edd85c19f73a33?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4184147/peter"}, "edited": false, "score": 0, "creation_date": 1424299580, "post_id": 28595145, "comment_id": 45497488, "body": ": error C3861: &#39;collatztwo&#39;: identifier not found  warning C4554: &#39;&amp;&#39; : check operator precedence for possible error; use parentheses to clarify precedence"}, {"owner": {"reputation": 1, "user_id": 4184147, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7d8905ad95f6322d82edd85c19f73a33?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4184147/peter"}, "reply_to_user": {"reputation": 18084, "user_id": 2700898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V3RkV.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/2700898/matt"}, "edited": false, "score": 0, "creation_date": 1424300197, "post_id": 28595145, "comment_id": 45497743, "body": "@Matt I fixed the precedence errors, but I still get the error. Also the previous function that works doesn&#39;t have the problem and its identical"}, {"owner": {"reputation": 116848, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "edited": false, "score": 0, "creation_date": 1424301625, "post_id": 28595145, "comment_id": 45498322, "body": "@Peter What&#39;s the main question?"}], "answers": [{"owner": {"reputation": 41878, "user_id": 257465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/882a999c825707d8bfa799ee20bda1f2?s=128&d=identicon&r=PG", "display_name": "tzaman", "link": "https://stackoverflow.com/users/257465/tzaman"}, "is_accepted": true, "score": 0, "last_activity_date": 1424300187, "creation_date": 1424300187, "answer_id": 28595561, "question_id": 28595145, "link": "https://stackoverflow.com/questions/28595145/collatz-conjecture-c/28595561#28595561", "title": "Collatz Conjecture C++", "body": "<p>From the errors OP listed in his comment: </p>\n\n<pre><code>error C3861: 'collatztwo': identifier not found \n</code></pre>\n\n<p>When you made your new function, did you include a <a href=\"http://en.wikipedia.org/wiki/Function_prototype\" rel=\"nofollow\">prototype</a> for it before the call site? You have to declare <code>int collatztwo(int a);</code> at the top of your source file, or move the function definition before where you use it. </p>\n\n<pre><code>warning C4554: '&amp;' : check operator precedence for possible error; use parentheses to clarify precedence\n</code></pre>\n\n<p>As already mentioned in the comments, you need to include a pair of parentheses around <code>a&amp;2</code> or it will do the wrong thing. <code>else if ((a&amp;2) != 0){</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4184147, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7d8905ad95f6322d82edd85c19f73a33?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4184147/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "closed_date": 1424304706, "accepted_answer_id": 28595561, "answer_count": 1, "score": -1, "last_activity_date": 1424300187, "creation_date": 1424298295, "last_edit_date": 1424299980, "question_id": 28595145, "link": "https://stackoverflow.com/questions/28595145/collatz-conjecture-c", "closed_reason": "Needs details or clarity", "title": "Collatz Conjecture C++", "body": "<p>I created this function (see below), that works perfectly; however, I was tasked in changing the function to take a parameter that does the same thing just for the function I passed into it.   </p>\n\n<pre><code>int collatz(){\nint temp, num;\n//num = 0;\ncout &lt;&lt; \"pick a number to turn into one:\";\ncin &gt;&gt; num;\ntemp = 0;\n\nwhile(num != 1){\n    if(num%2 == 0){\n    num = num/2;\n    temp++;\n    }\n    else if(num&amp;2 != 0){\n        num = (3*num) + 1;\n        temp++;\n    }\n\n}\ncout &lt;&lt; num &lt;&lt; \"number of times run: \" &lt;&lt; temp;\nreturn 0;}\n</code></pre>\n\n<p>I came up with this; however, it gives me an error:</p>\n\n<pre><code>error C3861: 'collatztwo': identifier not found warning C4554: '&amp;' : \ncheck operator precedence for possible error; \nuse parentheses to clarify precedence\n</code></pre>\n\n<hr>\n\n<pre><code>int collatztwo(int a){\nint temp, num;\n//num = a;\n\ntemp = 0;\n\nwhile(a != 1){\n    if(a%2 == 0){\n    a = a/2;\n    temp++;\n    }\n    else if(a&amp;2 != 0){\n        a = (3*a) + 1;\n        temp++;\n    }\n\n}\ncout &lt;&lt;  \"looped: \" &lt;&lt; temp;\nreturn 0;}\n</code></pre>\n"}, {"tags": ["c++", "c++11"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 3, "creation_date": 1424298302, "post_id": 28595117, "comment_id": 45496926, "body": "But try to move it. Try to change its state. <code>std::move</code> by itself doesn&#39;t do anything to the object. One could argue <code>std::move</code> is poorly named."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1424298322, "post_id": 28595117, "comment_id": 45496936, "body": "It doesn&#39;t actually <i>move</i> anything. All it does is cast to an rvalue reference. try <code>CAT cat2 = std::move(cat);</code>, assuming <code>CAT</code> supports regular move-assignment."}, {"owner": {"reputation": 3681, "user_id": 2817371, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fafb901e8d840c703f4a5089692427ad?s=128&d=identicon&r=PG&f=1", "display_name": "Red Alert", "link": "https://stackoverflow.com/users/2817371/red-alert"}, "edited": false, "score": 13, "creation_date": 1424298338, "post_id": 28595117, "comment_id": 45496944, "body": "<code>std::move</code> is just a cast, it does not actually move anything"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1424298564, "post_id": 28595117, "comment_id": 45497042, "body": "@WhozCraig: Careful, as the code you posted compiles and executes without warning, making it sort of misleading."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1424298651, "post_id": 28595117, "comment_id": 45497086, "body": "@MooingDuck Never said it wouldn&#39;t compile. it works only because the default copy-ctor is enabled. Squelch that and the wheels fall off."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 1, "creation_date": 1424300012, "post_id": 28595117, "comment_id": 45497670, "body": "If <code>std::move</code> was forbidden from operating on a <code>const</code> object, it would still be allowed on types that lack a move constructor, which would still silently copy, exactly what you want to prevent."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 1, "creation_date": 1424302202, "post_id": 28595117, "comment_id": 45498537, "body": "@hvd That seems like a bit of a non-argument to me. Just because OP&#39;s suggestion doesn&#39;t fix all bugs in the world doesn&#39;t necessarily mean it is a bad idea (it probably is, but not for the reason you give)."}, {"owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 1, "creation_date": 1424303147, "post_id": 28595117, "comment_id": 45498860, "body": "I&#39;d say there&#39;s nothing wrong with <code>move</code> in Scott&#39;s snippet. On the other hand taking an argument by <code>const value</code> is odd and you usually don&#39;t want to do that. That&#39;s really in a section about <code>move</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 0, "creation_date": 1424327902, "post_id": 28595117, "comment_id": 45505956, "body": "@ChrisDrew But it doesn&#39;t even fix the bug the OP wants to fix (insofar as it can be called a bug). The OP wants to fix copy constructors being called even when the caller spells out <code>std::move</code>. That would still be the case with the OP&#39;s change."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1424397729, "post_id": 28595117, "comment_id": 45543410, "body": "Poor question : the problem is that you&#39;re trying to move a cat, which can&#39;t succeed by definition."}, {"owner": {"reputation": 9397, "user_id": 230744, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4bcb6018a359bd2291e3765d22b9671?s=128&d=identicon&r=PG", "display_name": "ony", "link": "https://stackoverflow.com/users/230744/ony"}, "edited": false, "score": 0, "creation_date": 1444376267, "post_id": 28595117, "comment_id": 53886811, "body": "Compiler actually have all needed information to tell if move semantic will be applied. At least compiler should give a choice of turning on warnings on such ridiculous errors. I just found dummy error in my code where I took <code>const Value &amp;value = stack.top()</code> instead of <code>Value &amp;value = stack.top()</code> before doing <code>std::move(value)</code>."}, {"owner": {"reputation": 9397, "user_id": 230744, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4bcb6018a359bd2291e3765d22b9671?s=128&d=identicon&r=PG", "display_name": "ony", "link": "https://stackoverflow.com/users/230744/ony"}, "edited": false, "score": 0, "creation_date": 1444377462, "post_id": 28595117, "comment_id": 53887470, "body": "Warning proposal for gcc: <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67906\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=67906</a>"}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1424298898, "post_id": 28595207, "comment_id": 45497183, "body": "Upticked. Worth noting the implicit deletion of the copy-ctor upon user-defined definition of the regular move-constructor or assignment operator will also demonstrate this via broken compilation. Nice answer."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1424302851, "post_id": 28595207, "comment_id": 45498756, "body": "Also worth mentioning that a copy-constructor which needs a non-<code>const</code> lvalue also won&#39;t help. [class.copy] &#167;8: &quot;Otherwise, the implicitly-declared copy constructor will have the form <code>X::X(X&amp;)</code>&quot;"}, {"owner": {"reputation": 20235, "user_id": 1462718, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7d451483b64aa999fecf316e7132afc6?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/1462718/brandon"}, "edited": false, "score": 11, "creation_date": 1424309298, "post_id": 28595207, "comment_id": 45500821, "body": "I don&#39;t think he meant &quot;trap&quot; in computer/assembly terms. I think he means it &quot;traps&quot; him sneaky sneaky because if he doesn&#39;t realise, he ends up with a copy which is not what he intended. I guess.."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1424399339, "post_id": 28595207, "comment_id": 45543772, "body": "may you get 1 more upvote, and I get 4 more, for a gold badge.  ;)"}, {"owner": {"reputation": 16572, "user_id": 159658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rxpqw.jpg?s=128&g=1", "display_name": "Brent Writes Code", "link": "https://stackoverflow.com/users/159658/brent-writes-code"}, "edited": false, "score": 0, "creation_date": 1582309268, "post_id": 28595207, "comment_id": 106746322, "body": "High five on that code sample.  Gets the point across really well."}], "owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "is_accepted": false, "score": 116, "last_activity_date": 1424453428, "last_edit_date": 1424453428, "creation_date": 1424298531, "answer_id": 28595207, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object/28595207#28595207", "title": "Why can we use `std::move` on a `const` object?", "body": "<p>There's a trick here you're overlooking, namely that <code>std::move(cat)</code> <em>doesn't actually move anything</em>.  It merely tells the compiler to <em>try</em> to move.  However, since your class has no constructor that accepts a <code>const CAT&amp;&amp;</code>, it will instead use the implicit <code>const CAT&amp;</code> copy constructor, and safely copy.  No danger, no trap.  If the copy constructor is disabled for any reason, you'll get a compiler error.</p>\n\n<pre><code>struct CAT\n{\n   CAT(){}\n   CAT(const CAT&amp;) {std::cout &lt;&lt; \"COPY\";}\n   CAT(CAT&amp;&amp;) {std::cout &lt;&lt; \"MOVE\";}\n};\n\nint main() {\n    const CAT cat;\n    CAT cat2 = std::move(cat);\n}\n</code></pre>\n\n<p>prints <code>COPY</code>, not <code>MOVE</code>.</p>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/0dff72133dbf9d1f\" rel=\"noreferrer\">http://coliru.stacked-crooked.com/a/0dff72133dbf9d1f</a></p>\n\n<p>Note that the bug in the code you mention is a <em>performance</em> issue, not a <em>stability</em> issue, so such a bug won't cause a crash, ever.  It will just use a slower copy.  Additionally, such a bug also occurs for non-const objects that don't have move constructors, so merely adding a <code>const</code> overload won't catch all of them.  We could check for the ability to move construct or move assign from the parameter type, but that would interfere with generic template code that is <em>supposed</em> to fall back on the copy constructor.\nAnd heck, maybe someone wants to be able to construct from <code>const CAT&amp;&amp;</code>, who am I to say he can't?</p>\n"}, {"comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 4, "creation_date": 1424299582, "post_id": 28595415, "comment_id": 45497490, "body": "+1 for being the first answer that actually attempts to explain why you would <i>want</i> to call <code>std::move</code> on a <code>const</code> object."}, {"owner": {"reputation": 667, "user_id": 2336195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ed656ca39ebdc018e4055c90f9bf96?s=128&d=identicon&r=PG", "display_name": "F Pereira", "link": "https://stackoverflow.com/users/2336195/f-pereira"}, "edited": false, "score": 1, "creation_date": 1584579362, "post_id": 28595415, "comment_id": 107482741, "body": "+1 for showing a function taking <code>const T&amp;&amp;</code>. This expresses an &quot;API protocol&quot; of the kind &quot;I will take an rvalue-ref but I promise I won&#39;t modify it&quot;. I guess, apart from when using mutable, it&#39;s uncommon. Maybe another use case is to be able to use <code>forward_as_tuple</code> on almost anything and later use it."}], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 62, "last_activity_date": 1424299442, "creation_date": 1424299442, "answer_id": 28595415, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object/28595415#28595415", "title": "Why can we use `std::move` on a `const` object?", "body": "<pre><code>struct strange {\n  mutable size_t count = 0;\n  strange( strange const&amp;&amp; o ):count(o.count) { o.count = 0; }\n};\n\nconst strange s;\nstrange s2 = std::move(s);\n</code></pre>\n\n<p>here we see a use of <code>std::move</code> on a <code>T const</code>.  It returns a <code>T const&amp;&amp;</code>.  We have a move constructor for <code>strange</code> that takes exactly this type.</p>\n\n<p>And it is called.</p>\n\n<p>Now, it is true that this strange type is more rare than the bugs your proposal would fix.</p>\n\n<p>But, on the other hand, the existing <code>std::move</code> works better in generic code, where you don't know if the type you are working with is a <code>T</code> or a <code>T const</code>.</p>\n"}, {"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "is_accepted": false, "score": 20, "last_activity_date": 1424304630, "creation_date": 1424304630, "answer_id": 28596435, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object/28596435#28596435", "title": "Why can we use `std::move` on a `const` object?", "body": "<p>One reason the rest of the answers have overlooked so far is the ability for <em>generic</em> code to be resilient in the face of move.  For example lets say that I wanted to write a generic function which moved all of the elements out of one kind of container to create another kind of container with the same values:</p>\n\n<pre><code>template &lt;class C1, class C2&gt;\nC1\nmove_each(C2&amp;&amp; c2)\n{\n    return C1(std::make_move_iterator(c2.begin()),\n              std::make_move_iterator(c2.end()));\n}\n</code></pre>\n\n<p>Cool, now I can relatively efficiently create a <code>vector&lt;string&gt;</code> from a <code>deque&lt;string&gt;</code> and each individual <code>string</code> will be moved in the process.</p>\n\n<p>But what if I want to move from a <code>map</code>?</p>\n\n<pre><code>int\nmain()\n{\n    std::map&lt;int, std::string&gt; m{{1, \"one\"}, {2, \"two\"}, {3, \"three\"}};\n    auto v = move_each&lt;std::vector&lt;std::pair&lt;int, std::string&gt;&gt;&gt;(m);\n    for (auto const&amp; p : v)\n        std::cout &lt;&lt; \"{\" &lt;&lt; p.first &lt;&lt; \", \" &lt;&lt; p.second &lt;&lt; \"} \";\n    std::cout &lt;&lt; '\\n';\n}\n</code></pre>\n\n<p>If <code>std::move</code> insisted on a non-<code>const</code> argument, the above instantiation of <code>move_each</code> would not compile because it is trying to move a <code>const int</code> (the <code>key_type</code> of the <code>map</code>).  But this code <em>doesn't care</em> if it can't move the <code>key_type</code>.  It wants to move the <code>mapped_type</code> (<code>std::string</code>) for performance reasons.</p>\n\n<p>It is for this example, and countless other examples like it in generic coding that <code>std::move</code> is a <em>request to move</em>, not a demand to move.</p>\n"}, {"owner": {"reputation": 21, "user_id": 2247343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2154bfab35553d6ef0ca7efc72de45?s=128&d=identicon&r=PG&f=1", "display_name": "Bogeegee", "link": "https://stackoverflow.com/users/2247343/bogeegee"}, "is_accepted": false, "score": 2, "last_activity_date": 1472242092, "creation_date": 1472242092, "answer_id": 39173979, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object/39173979#39173979", "title": "Why can we use `std::move` on a `const` object?", "body": "<p>I have the same concern as the OP.</p>\n\n<p>std::move does not move an object, neither guarantees the object is movable. Then why is it called move?</p>\n\n<p>I think being not movable can be one of following two scenarios:</p>\n\n<p><strong>1. The moving type is const.</strong></p>\n\n<p>The reason we have const keyword in the language is that we want the compiler to prevent any change to an object defined to be const. Given the example in Scott Meyers' book:</p>\n\n<pre><code>    class Annotation {\n    public:\n     explicit Annotation(const std::string text)\n     : value(std::move(text)) // \"move\" text into value; this code\n     { \u2026 } // doesn't do what it seems to!    \n     \u2026\n    private:\n     std::string value;\n    };\n</code></pre>\n\n<p>What does it literally mean? Move a const string to the value member - at least, that's my understanding before I reading the explanation.</p>\n\n<p>If the language intends to not do move or not guarantee move is applicable when std::move() is called, then it is literally misleading when using word move.</p>\n\n<p>If the language is encouraging people using std::move to have better efficiency, it has to prevent traps like this as early as possible, especially for this type of obvious literal contradiction.</p>\n\n<p>I agree that people should be aware moving a constant is impossible, but this obligation should not imply the compiler can be silent when obvious contradiction happens.</p>\n\n<p><strong>2. The object has no move constructor</strong></p>\n\n<p>Personally, I think this is a separate story from OP's concern, as Chris Drew said</p>\n\n<blockquote>\n  <p>@hvd That seems like a bit of a non-argument to me. Just because OP's suggestion doesn't fix all bugs in the world doesn't necessarily mean it is a bad idea (it probably is, but not for the reason you give). \u2013 Chris Drew</p>\n</blockquote>\n"}, {"owner": {"reputation": 11, "user_id": 10459266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70648911ef80a914924afe37ac3d386a?s=128&d=identicon&r=PG&f=1", "display_name": "mlo", "link": "https://stackoverflow.com/users/10459266/mlo"}, "is_accepted": false, "score": 1, "last_activity_date": 1538760434, "creation_date": 1538760434, "answer_id": 52670645, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object/52670645#52670645", "title": "Why can we use `std::move` on a `const` object?", "body": "<p>I'm surprised nobody mentioned the backward compatibility aspect of this. I believe, <code>std::move</code> was purposely designed to do this in C++11. Imagine you're working with a legacy codebase, that heavily relies on C++98 libraries, so without the fallback on copy assignment, moving would break things. </p>\n"}, {"owner": {"reputation": 405, "user_id": 1073080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6412eb50c7b7dba0af8cef9797a2609?s=128&d=identicon&r=PG", "display_name": "Zinovy Nis", "link": "https://stackoverflow.com/users/1073080/zinovy-nis"}, "is_accepted": false, "score": 1, "last_activity_date": 1581671167, "creation_date": 1581671167, "answer_id": 60223120, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object/60223120#60223120", "title": "Why can we use `std::move` on a `const` object?", "body": "<p>Fortunately you can use clang-tidy's check to find such issues: <a href=\"https://clang.llvm.org/extra/clang-tidy/checks/performance-move-const-arg.html\" rel=\"nofollow noreferrer\">https://clang.llvm.org/extra/clang-tidy/checks/performance-move-const-arg.html</a></p>\n"}], "owner": {"reputation": 8551, "user_id": 440403, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1f6698434e6b31de0de985726bb87364?s=128&d=identicon&r=PG", "display_name": "camino", "link": "https://stackoverflow.com/users/440403/camino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35902, "favorite_count": 27, "accepted_answer_id": 28595415, "answer_count": 6, "score": 122, "last_activity_date": 1581671167, "creation_date": 1424298166, "last_edit_date": 1426901616, "question_id": 28595117, "link": "https://stackoverflow.com/questions/28595117/why-can-we-use-stdmove-on-a-const-object", "title": "Why can we use `std::move` on a `const` object?", "body": "<p>In C++11, we can write this code:</p>\n\n<pre><code>struct Cat {\n   Cat(){}\n};\n\nconst Cat cat;\nstd::move(cat); //this is valid in C++11\n</code></pre>\n\n<p>when I call <code>std::move</code>, it means I want to move the object, i.e. I will change the object. To move a <code>const</code> object is unreasonable, so why does <code>std::move</code> not restrict this behaviour?  It will be a trap in the future, right?</p>\n\n<p>Here trap means as Brandon mentioned in the comment:</p>\n\n<blockquote>\n  <p>\" I think he means it \"traps\" him sneaky sneaky because if he doesn't\n  realize, he ends up with a copy which is not what he intended.\"</p>\n</blockquote>\n\n<p>In the book 'Effective Modern C++' by Scott Meyers, he gives an example:</p>\n\n<pre><code>class Annotation {\npublic:\n    explicit Annotation(const std::string text)\n     : value(std::move(text)) //here we want to call string(string&amp;&amp;),\n                              //but because text is const, \n                              //the return type of std::move(text) is const std::string&amp;&amp;\n                              //so we actually called string(const string&amp;)\n                              //it is a bug which is very hard to find out\nprivate:\n    std::string value;\n};\n</code></pre>\n\n<p>If <code>std::move</code> was forbidden from operating on a <code>const</code> object, we could easily find out the bug, right?</p>\n"}, {"tags": ["c++", "c++11", "c++14", "reverse-iterator"], "comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1424299843, "post_id": 28595084, "comment_id": 45497599, "body": "I think the problem is not with <code>it</code> but with <code>*it</code>, subtle difference. If you added <code>const</code> to the reference it would work I&#39;m sure."}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1424299974, "post_id": 28595084, "comment_id": 45497648, "body": "Hi Mark, when I add const, it&#39;s not a bidirectional iterator anymore I&#39;m afraid, and the reverse_iterator won&#39;t accept it."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 3, "creation_date": 1424299976, "post_id": 28595084, "comment_id": 45497651, "body": "<code>reverse_iterator::operator*</code> returns a reference into a temporary in this case: It internally creates a <i>new</i> iterator object, decrements that, and returns what that new, decremented operator refers to (which is a data member of a local variable): <a href=\"http://en.cppreference.com/w/cpp/iterator/reverse_iterator/operator%2A\" rel=\"nofollow noreferrer\">cppreference: <code>reverse_iterator::operator*</code></a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1424300101, "post_id": 28595084, "comment_id": 45497707, "body": "Sorry, I meant <code>const int &amp;i</code>, you evidently tried to add it to <code>it</code>."}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1424300203, "post_id": 28595084, "comment_id": 45497745, "body": "@MarkRansom If I change <b>int &amp;i</b> into <b>int const &amp;i</b> or <b>const int &amp;i</b> the behavior is the same. EDIT: only the else-branch behavior stays the same, the memory violations of the if-branch are gone."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1424300396, "post_id": 28595084, "comment_id": 45497842, "body": "<a href=\"http://coliru.stacked-crooked.com/a/dfd25528cd435662\" rel=\"nofollow noreferrer\">Live example of the lifetime issue</a>"}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1424300483, "post_id": 28595084, "comment_id": 45497882, "body": "@dyp You mean <b>new my_iterator</b> I guess, does that mean that this is intrinsically determined to not work, since I have no way to make sure the references stay in scope long enough, as there is no underlying data structure storing all of them?"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1424300582, "post_id": 28595084, "comment_id": 45497927, "body": "It seems so: the iterators are supposed to have pointer semantics, not &quot;value semantics&quot;, i.e. they&#39;re not supposed to own the values they&#39;re pointing to."}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "edited": false, "score": 0, "creation_date": 1424301584, "post_id": 28595084, "comment_id": 45498309, "body": "One way to do it, I guess, is using a shared_ptr&lt;int&gt;, each time the cc is called, the shared_ptr&lt;int&gt; is also cc&#39;ed, however, each time the value is updated, the iterator with the value  get&#39;s a fresh shared_ptr with the new value."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424310219, "post_id": 28595084, "comment_id": 45501071, "body": "How does that solve the problem? When the decrement happens inside <code>reverse_iterator::operator*</code>, you&#39;d make a fresh <code>shared_ptr</code> for the copy, but then the copy gets destroyed, and the <code>shared_ptr</code> with it. You might be better off just &quot;lying&quot; and using <code>int</code> as <code>my_iterator::reference</code>. After all, the standard library also lies with <code>vector&lt;bool&gt;::iterator</code>, which is purportedly a random access iterator, but in reality isn&#39;t even a forward iterator."}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424343308, "post_id": 28595084, "comment_id": 45513704, "body": "@T.C. It doesn&#39;t really, as iterators can not be made responsible for keeping the data the reference to in scope. However, using the shared_ptr&#39;s, the data stays in the same place when the iterator is copied or moved. It gets duplicated if the iterator is updated using ++/-- and hence may go out of scope if all the other iterators with the same shared_ptr do. So it partially solves the problem, but it&#39;s not Pandora&#39;s box. However, this requirement is enough for std::copy to work :) <a href=\"http://ideone.com/KLcfX5\" rel=\"nofollow noreferrer\">ideone.com/KLcfX5</a>"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424343921, "post_id": 28595084, "comment_id": 45514075, "body": "@Herbert Nah, it&#39;s UB. Remember that the problem is with <code>Iterator tmp = current; return *--tmp;</code> in <code>operator *</code>&#39;s body. After <code>--tmp</code> it has a new <code>shared_ptr</code> pointing to a new block of memory, and since it&#39;s now the only <code>shared_ptr</code> that owns the memory, the memory is freed when <code>tmp</code> is destoryed, and you still return a dangling reference."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424343962, "post_id": 28595084, "comment_id": 45514099, "body": "@Herbert You just got (un)lucky because the memory, though freed, happens to still contain the desired value. If you use something that <a href=\"http://coliru.stacked-crooked.com/a/6ecb8333636f82b3\" rel=\"nofollow noreferrer\">overwrites the stored value when it is destroyed</a> (or run it under valgrind) it will break."}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424345014, "post_id": 28595084, "comment_id": 45514758, "body": "@T.C. You are right :( I think value iterators are to be considered evil."}], "answers": [{"comments": [{"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "edited": false, "score": 0, "creation_date": 1424962958, "post_id": 28597146, "comment_id": 45773936, "body": "Well, the iterators are allowed to invalidate returned references and pointers after destruction ([iterator.requirements.general] /10). Since std::reverse_iterator returns references/pointers it obtained via destructed iterators (since it does not store the original iterator), it does not meet requirement [iterator.iterators]/2, since *it may return an invalid reference or pointer. Is this a leak in the standard, or am I missing something? Why is std::reverse_iterator not an iterator, as one would expect?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "edited": false, "score": 1, "creation_date": 1425001607, "post_id": 28597146, "comment_id": 45793471, "body": "@Herbert <code>reverse_iterator</code> is not a class. It&#39;s a class template. A specialization <code>reverse_iterator&lt;sane_iterator&gt;</code> is a perfectly valid iterator, as long as <code>sane_iterator</code>&#39;s destructor does not invalidate pointers and references. I&#39;m also not convinced that a stashing iterator is a valid forward iterator - [forward.iterators]/p6 says that &quot;If <code>a</code> and <code>b</code> are both dereferenceable, then <code>a == b</code> if and only if <code>*a</code> and <code>*b</code> are bound to the same object.&quot; This implies that a copy of a stashing iterator cannot compare equal to the original, which in turn breaks CopyConstructible requirements."}, {"owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "edited": false, "score": 0, "creation_date": 1425032573, "post_id": 28597146, "comment_id": 45804725, "body": "That is true, however my shared_ptr implementation would fix this: <a href=\"http://ideone.com/KLcfX5\" rel=\"nofollow noreferrer\">ideone.com/KLcfX5</a> However, std::reverse_iterator does not keep the copy in memory post-derement. Hence after the decrement, the reference is invalidated."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "edited": false, "score": 0, "creation_date": 1425050135, "post_id": 28597146, "comment_id": 45815204, "body": "@Herbert Not really. For forward iterators, <code>a == b</code> implies <code>++a == ++b</code>, but in your design, given <code>a</code> and <code>b</code> with a <code>shared_ptr</code> to the same thing, <code>++a</code> and <code>++b</code> will point to different things (as each will do an allocation separately), hence violating the requirement in [forward.iterators]/p6."}], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": false, "score": 9, "last_activity_date": 1424316104, "last_edit_date": 1424316104, "creation_date": 1424308856, "answer_id": 28597146, "question_id": 28595084, "link": "https://stackoverflow.com/questions/28595084/reference-invalidation-after-applying-reverse-iterator-on-a-custom-made-iterator/28597146#28597146", "title": "Reference invalidation after applying reverse_iterator on a custom made iterator", "body": "<p><code>reverse_iterator</code> does not work with so-called \"stashing iterators\", iterators that returns references to things within themselves. The <code>operator*</code> of <code>reverse_iterator</code> makes a copy of the wrapped iterator, decrements it, and returns the result of dereferencing the copy. Hence, if dereferencing iterator returns a reference to something inside itself, the reference will become dangling.</p>\n\n<p>An attempt was made in the C++11 specification to make it work, but it turns out that it's impossible to implement without adding massive overhead<sup>*</sup> for non-stashing iterators, so <a href=\"http://cplusplus.github.io/LWG/lwg-defects.html#2360\" rel=\"noreferrer\">the specification was reverted to the C++03 version</a>.</p>\n\n<hr>\n\n<p><sub> <sup>*</sup> To support \"stashing iterators\", an additional data member must be added that stores the decremented current iterator, doubling the size of <code>reverse_iterator</code>; and then some form of synchronization must be used since <code>operator *</code> is <code>const</code> - and so must be simultaneously callable from multiple threads without causing a data race - but must modify this additional data member. That's a lot of overhead to add to all <code>reverse_iterator</code>s for such an uncommon use case.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "edited": false, "score": 0, "creation_date": 1486295643, "post_id": 33851951, "comment_id": 71275608, "body": "Hi, could you please clarify the license of your code snippet? I see that the whole stackoverflow is CC-BY-SA 3.0; can you maybe re-license this under BSD or Apache or something similar?"}], "owner": {"reputation": 11, "user_id": 5588399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50c117aeffe7622498ceba6ee92f2b7?s=128&d=identicon&r=PG&f=1", "display_name": "J.C. Moyer", "link": "https://stackoverflow.com/users/5588399/j-c-moyer"}, "is_accepted": false, "score": 1, "last_activity_date": 1448170320, "creation_date": 1448170320, "answer_id": 33851951, "question_id": 28595084, "link": "https://stackoverflow.com/questions/28595084/reference-invalidation-after-applying-reverse-iterator-on-a-custom-made-iterator/33851951#33851951", "title": "Reference invalidation after applying reverse_iterator on a custom made iterator", "body": "<p>As has been mentioned, the C++03 and C++14 standards define <code>reverse_iterator::operator*</code> in this way:</p>\n\n<blockquote>\n  <p>24.5.1.3.4 <code>operator*</code> [reverse.iter.op.star]</p>\n  \n  <p><code>reference operator*() const;</code></p>\n  \n  <p>1 Effects:</p>\n</blockquote>\n\n<pre><code>Iterator tmp = current;\nreturn *--tmp;\n</code></pre>\n\n<p><code>tmp</code> is destroyed after <code>operator*</code> returns, so any references to data stored inside of <code>tmp</code> will become invalid. The C++11 standard changed this and added a note:</p>\n\n<blockquote>\n  <p>24.5.1.3.4 <code>operator*</code> [reverse.iter.op.star]</p>\n  \n  <p><code>reference operator*() const;</code></p>\n  \n  <p>1 Effects:</p>\n</blockquote>\n\n<pre><code>deref_tmp = current;\n--deref_tmp;\nreturn *deref_tmp;\n</code></pre>\n\n<blockquote>\n  <p>2 [ Note: This operation must use an auxiliary member variable rather than\n  a temporary variable to avoid returning a reference that persists beyond\n  the lifetime of its associated iterator. (See 24.2.) \u2014end note ]</p>\n</blockquote>\n\n<p>This is actually impossible to implement because of the <code>const</code> qualifier on <code>operator*</code>, so the wording was reverted between C++11 and C++14.</p>\n\n<p>The best solution is probably to just implement your own version of <code>reverse_iterator</code> based on the C++11 wording for whatever version of C++ you are targeting. Fortunately, the specification is very straightforward and easy to follow. As a working example, here's one I wrote for C++14:</p>\n\n<pre><code>template &lt;class Iterator&gt;\nclass stashing_reverse_iterator :\n  public std::iterator&lt;\n    typename std::iterator_traits&lt;Iterator&gt;::iterator_category,\n    typename std::iterator_traits&lt;Iterator&gt;::value_type,\n    typename std::iterator_traits&lt;Iterator&gt;::difference_type,\n    typename std::iterator_traits&lt;Iterator&gt;::pointer,\n    typename std::iterator_traits&lt;Iterator&gt;::reference\n  &gt; {\n  typedef std::iterator_traits&lt;Iterator&gt; traits_type;\npublic:\n  typedef Iterator iterator_type;\n  typedef typename traits_type::difference_type difference_type;\n  typedef typename traits_type::reference       reference;\n  typedef typename traits_type::pointer         pointer;\n\n  stashing_reverse_iterator() : current() {}\n\n  explicit stashing_reverse_iterator(Iterator x) : current(x) {}\n\n  template &lt;class U&gt;\n  stashing_reverse_iterator(const stashing_reverse_iterator&lt;U&gt;&amp; u) : current(u.current) {}\n\n  template &lt;class U&gt;\n  stashing_reverse_iterator&amp; operator=(const stashing_reverse_iterator&lt;U&gt;&amp; u) {\n    current = u.base();\n    return *this;\n  }\n\n  Iterator base() const {\n    return current;\n  }\n\n  // Differs from reverse_iterator::operator*:\n  // 1. const qualifier removed\n  // 2. current iterator is stored in a member field to ensure references are\n  //    always valid after this function returns\n  reference operator*() {\n    deref_tmp = current;\n    --deref_tmp;\n    return *deref_tmp;\n  }\n\n  pointer operator-&gt;() const {\n    return std::addressof(operator*());\n  }\n\n  stashing_reverse_iterator&amp; operator++() {\n    --current;\n    return *this;\n  }\n\n stashing_reverse_iterator operator++(int) {\n    stashing_reverse_iterator tmp = *this;\n    --current;\n    return tmp;\n  }\n\n  stashing_reverse_iterator&amp; operator--() {\n    ++current;\n    return *this;\n  }\n\n  stashing_reverse_iterator operator--(int) {\n    stashing_reverse_iterator tmp = *this;\n    ++current;\n    return tmp;\n  }\n\n  stashing_reverse_iterator  operator+ (difference_type n) const {\n    return stashing_reverse_iterator(current - n);\n  }\n\n  stashing_reverse_iterator&amp; operator+=(difference_type n) {\n    current -= n;\n    return *this;\n  }\n\n  stashing_reverse_iterator  operator- (difference_type n) const {\n    return stashing_reverse_iterator(current + n);\n  }\n\n  stashing_reverse_iterator&amp; operator-=(difference_type n) {\n    current += n;\n    return *this;\n  }\n\n  // Differs from reverse_iterator::operator[]:\n  // 1. const qualifier removed because this function makes use of operator*\n  reference operator[](difference_type n) {\n    return *(*this + n);\n  }\n\nprotected:\n  Iterator current;\nprivate:\n  Iterator deref_tmp;\n};\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nbool operator==(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y)\n{ return x.base() == y.base(); }\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nbool operator&lt;(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y)\n{ return x.base() &gt; y.base(); }\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nbool operator!=(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y)\n{ return !(x.base() == y.base()); }\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nbool operator&gt;(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y)\n{ return x.base() &lt; y.base(); }\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nbool operator&gt;=(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y)\n{ return x.base() &lt;= y.base(); }\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nbool operator&lt;=(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y)\n{ return x.base() &gt;= y.base(); }\n\ntemplate &lt;class Iterator1, class Iterator2&gt;\nauto operator-(\n  const stashing_reverse_iterator&lt;Iterator1&gt;&amp; x,\n  const stashing_reverse_iterator&lt;Iterator2&gt;&amp; y) -&gt; decltype(y.base() - x.base())\n{ return y.base() - x.base(); }\n\ntemplate &lt;class Iterator&gt;\nstashing_reverse_iterator&lt;Iterator&gt; operator+(\n  typename stashing_reverse_iterator&lt;Iterator&gt;::difference_type n,\n  const stashing_reverse_iterator&lt;Iterator&gt;&amp; x)\n{ return stashing_reverse_iterator&lt;Iterator&gt;(x.base() - n); }\n\ntemplate &lt;class Iterator&gt;\nstashing_reverse_iterator&lt;Iterator&gt; make_stashing_reverse_iterator(Iterator i)\n{ return stashing_reverse_iterator&lt;Iterator&gt;(i); }\n</code></pre>\n\n<p>Usage is the same as <code>reverse_iterator</code>:</p>\n\n<pre><code>// prints 5,4,3,2,1, for a sanely implemented number_iterator\nstd::copy(\n  make_stashing_reverse_iterator(number_iterator(5)),\n  make_stashing_reverse_iterator(number_iterator(0)),\n  std::ostream_iterator&lt;int&gt;(std::cout, \",\"));\n</code></pre>\n"}], "owner": {"reputation": 4384, "user_id": 853462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gYrq3.jpg?s=128&g=1", "display_name": "Herbert", "link": "https://stackoverflow.com/users/853462/herbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1448170320, "creation_date": 1424298076, "last_edit_date": 1424299079, "question_id": 28595084, "link": "https://stackoverflow.com/questions/28595084/reference-invalidation-after-applying-reverse-iterator-on-a-custom-made-iterator", "title": "Reference invalidation after applying reverse_iterator on a custom made iterator", "body": "<p>I implemented a bidirectional iterator, however instead of operating on a data structure, it returns a mathematical series which one can iteratively calculate through in both directions. In fact, I'm iterating through the integers, using ++ and -- on an int. This means that the data is not stored in a different structure, and hence when the iterator goes out of scope, so does the value.</p>\n\n<p>Nevertheless, I would expect the next code (minimal failing example) sample to work, as the iterator stays in scope the whole time. But it does not work :(</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;iterator&gt;\n#include &lt;vector&gt;\n\nclass my_iterator : public std::iterator&lt;std::bidirectional_iterator_tag, int&gt; {\n  int d_val = 12;\npublic:\n  my_iterator  operator--(int) { std::cout &lt;&lt; \"decrement--\\n\"; return my_iterator(); }\n  my_iterator &amp;operator--()    { std::cout &lt;&lt; \"--decrement\\n\"; return *this; }\n  my_iterator  operator++(int) { std::cout &lt;&lt; \"increment++\\n\"; return my_iterator(); }\n  my_iterator &amp;operator++()    { std::cout &lt;&lt; \"++increment\\n\"; return *this; }\n\n  int &amp;operator*() { std::cout &lt;&lt; \"*dereference\\n\"; return d_val; }\n\n  bool operator==(my_iterator const  &amp;o) { return false; }\n  bool operator!=(my_iterator const  &amp;o) { return true ; }\n};\n\n\nint main() {\n  auto it = std::reverse_iterator&lt;my_iterator&gt;();\n  int &amp;i = *it;\n  if (true)\n  {\n    std::cout &lt;&lt; i &lt;&lt; '\\n';\n  }\n  else\n  {\n    std::vector&lt;int&gt; vec;\n    vec.push_back(i);\n    std::cout &lt;&lt; vec[0] &lt;&lt; '\\n';\n  }\n}\n</code></pre>\n\n<p>source: <a href=\"http://ideone.com/YJKvpl\" rel=\"noreferrer\">http://ideone.com/YJKvpl</a></p>\n\n<p>The if-branch results in memory violations, as properly detected by valgrind:</p>\n\n<pre><code>--decrement\n*dereference\n==7914== Use of uninitialised value of size 8\n==7914==    at 0x4EC15C3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4EC16FB: std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; std::num_put&lt;char, std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; &gt;::_M_insert_int&lt;long&gt;(std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt;, std::ios_base&amp;, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4EC1C7C: std::num_put&lt;char, std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; &gt;::do_put(std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt;, std::ios_base&amp;, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4ECEFB9: std::ostream&amp; std::ostream::_M_insert&lt;long&gt;(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x40087B: main (divine.cc:25)\n==7914== \n==7914== Conditional jump or move depends on uninitialised value(s)\n==7914==    at 0x4EC15CF: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4EC16FB: std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; std::num_put&lt;char, std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; &gt;::_M_insert_int&lt;long&gt;(std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt;, std::ios_base&amp;, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4EC1C7C: std::num_put&lt;char, std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; &gt;::do_put(std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt;, std::ios_base&amp;, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4ECEFB9: std::ostream&amp; std::ostream::_M_insert&lt;long&gt;(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x40087B: main (divine.cc:25)\n==7914== \n==7914== Conditional jump or move depends on uninitialised value(s)\n==7914==    at 0x4EC1724: std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; std::num_put&lt;char, std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; &gt;::_M_insert_int&lt;long&gt;(std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt;, std::ios_base&amp;, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4EC1C7C: std::num_put&lt;char, std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt; &gt;::do_put(std::ostreambuf_iterator&lt;char, std::char_traits&lt;char&gt; &gt;, std::ios_base&amp;, char, long) const (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x4ECEFB9: std::ostream&amp; std::ostream::_M_insert&lt;long&gt;(long) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20)\n==7914==    by 0x40087B: main (divine.cc:25)\n==7914== \n12\n==7914== \n==7914== HEAP SUMMARY:\n==7914==     in use at exit: 0 bytes in 0 blocks\n==7914==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated\n==7914== \n==7914== All heap blocks were freed -- no leaks are possible\n==7914== \n==7914== For counts of detected and suppressed errors, rerun with: -v\n==7914== Use --track-origins=yes to see where uninitialised values come from\n==7914== ERROR SUMMARY: 5 errors from 3 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>The else-branch doesn't result in memory violations, or at least as far as my valgrind can detect. However, the value stored in the vector is 'random':</p>\n\n<pre><code>--decrement\n*dereference\n-16777520\n</code></pre>\n\n<p>I'm a bit surprised by what happens. The iterator should be in scope all the time, yet the reference seems to get invalidated. Why do I get the memory violations, whilst 12 is printed or why don't I get them whilst something different from 12 is stored?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 4857, "user_id": 1405614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9a70943a5d825c32446259aa7e9348?s=128&d=identicon&r=PG", "display_name": "Valeri Atamaniouk", "link": "https://stackoverflow.com/users/1405614/valeri-atamaniouk"}, "edited": false, "score": 1, "creation_date": 1424298038, "post_id": 28595021, "comment_id": 45496798, "body": "what are you trying to make with that? T is a good type. You can use typenames as T::K or T::V if there are such type definitions in T..."}], "answers": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 2, "last_activity_date": 1424298492, "last_edit_date": 1424298492, "creation_date": 1424298152, "answer_id": 28595112, "question_id": 28595021, "link": "https://stackoverflow.com/questions/28595021/making-a-template-that-requires-a-template/28595112#28595112", "title": "Making a template that requires a template", "body": "<p>What you need is </p>\n\n<pre><code> template &lt;template&lt;typename, typename&gt; class T, size_t count&gt; \n class DoubleTemplate { ... };\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cstddef&gt;\n\ntemplate &lt;typename K, typename V&gt;\nclass Foo {};\n\nclass Bar {};\n\ntemplate &lt;template&lt;typename, typename&gt; class T, std::size_t COUNT&gt;\nclass DoubleTemplate {}; // you need class T, not typename T, to be corrected in C++17\n\nint main()\n{\n    DoubleTemplate&lt;Foo, 10&gt; dt;\n    // DoubleTemplate&lt;Bar, 20&gt; dt2; //oops, Bar is not a 2-param template class\n}\n</code></pre>\n"}], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 28595112, "answer_count": 1, "score": 0, "last_activity_date": 1424298492, "creation_date": 1424297830, "question_id": 28595021, "link": "https://stackoverflow.com/questions/28595021/making-a-template-that-requires-a-template", "title": "Making a template that requires a template", "body": "<p>I am trying to make a templated class that only works on other templated classes.</p>\n\n<p>My attempt looks like:</p>\n\n<pre><code>template&lt;typename T&lt;K,V&gt;, size_t COUNT&gt;\nclass DoubleTemplate { ..... };\n</code></pre>\n\n<p>But this give a compiler error where I try to specify <code>T&lt;K,V&gt;</code>.</p>\n\n<p>Is there a good way to require that the typename can only be a template on two params?</p>\n"}, {"tags": ["c++", "boost"], "answers": [{"comments": [{"owner": {"reputation": 3724, "user_id": 1541314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2ceb52c0856a59e538733aca23d0499f?s=128&d=identicon&r=PG", "display_name": "Matt Stokes", "link": "https://stackoverflow.com/users/1541314/matt-stokes"}, "edited": false, "score": 0, "creation_date": 1424298989, "post_id": 28595286, "comment_id": 45497238, "body": "ahh, that is exactly how to think about the problem. Solid answer."}], "owner": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "is_accepted": true, "score": 4, "last_activity_date": 1424298791, "creation_date": 1424298791, "answer_id": 28595286, "question_id": 28594947, "link": "https://stackoverflow.com/questions/28594947/c-boost-max-deviation/28595286#28595286", "title": "C++ Boost Max Deviation", "body": "<p>The maximum deviation is either the maximum value minus the mean or the mean minus the minimum, whichever is greater. This suggests the following simple implementation:</p>\n\n<pre><code>double max_deviation(accumulator_set&lt;double, features&lt;tag::min, tag::max, tag::mean&gt; &gt; const &amp;acc) {\n  return std::max(max(acc) - mean(acc), mean(acc) - min(acc));\n}\n</code></pre>\n"}], "owner": {"reputation": 3724, "user_id": 1541314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2ceb52c0856a59e538733aca23d0499f?s=128&d=identicon&r=PG", "display_name": "Matt Stokes", "link": "https://stackoverflow.com/users/1541314/matt-stokes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 28595286, "answer_count": 1, "score": 2, "last_activity_date": 1424298791, "creation_date": 1424297505, "last_edit_date": 1424298600, "question_id": 28594947, "link": "https://stackoverflow.com/questions/28594947/c-boost-max-deviation", "title": "C++ Boost Max Deviation", "body": "<p>Little bit of a brain teaser, I'm wondering if there is a simple way using Boost to get the max deviation of a value from the mean using an accumulator_set? Just the furthest point from the mean.</p>\n\n<p>Values are in a <code>accumulator_set&lt;float, stats&lt;tag::variance&gt;&gt; val</code> though I suspect other tags might be needed.</p>\n\n<pre><code>// defined by: MAX(abs(val[x] - mean)) \nfloat max_stdev(accumulator_set&lt;float, stats&lt;tag::variance&gt;&gt;&amp; val) {\n  // mean(val) gives mean\n\n  // can't just use max on the set \n}\n\n// e.g. val contains 1,2,3\naccumulator_set&lt;float, stats&lt;tag::variance&gt;&gt; val\nval(1), val(2), val(3);\nfloat max_val = max_stdev(val);  // would return 1\n</code></pre>\n"}, {"tags": ["c++", "boost"], "answers": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 2, "last_activity_date": 1424310269, "last_edit_date": 1424310269, "creation_date": 1424304709, "answer_id": 28596450, "question_id": 28594736, "link": "https://stackoverflow.com/questions/28594736/what-is-the-best-way-to-send-many-buffers-with-boostasio-method-async-send-to/28596450#28596450", "title": "What is the best way to send many buffers with Boost::Asio method async_send_to", "body": "<p>Well. </p>\n\n<p>I'm not sure what you are observing. Here's the answer to</p>\n\n<blockquote>\n  <p><strong>Q.</strong> Is it possible to place the m_IOService.run(); call outside on_asyncSendPushButton_clicked</p>\n</blockquote>\n\n<p>Yes, you should use <code>io_service::work</code> to keep the IO service running. Here's a demo program:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/8087d6aa611abff1\" rel=\"nofollow\">Live On Coliru</a></kbd></strong></p>\n\n<ul>\n<li>I've created a single IO thread to serve the async operations/completion handlers</li>\n<li><p>I've stripped the Qt dependency; demo <code>Run</code>s are configured randomly:</p>\n\n<pre><code>struct Run {\n    std::vector&lt;char&gt; buffer = std::vector&lt;char&gt;(rand()%800 + 200, '\\0');\n    int remainingToSend      = rand()%10 + 1;\n    int transferredBuffers   = 0;\n    Clock::time_point start  = Clock::now();\n\n    void stopTimerAndLog() const;\n};\n</code></pre></li>\n<li><p>As a bonus, I added <em>proper</em> statistics using <a href=\"http://www.boost.org/doc/libs/1_57_0/doc/html/accumulators/user_s_guide.html\" rel=\"nofollow\">Boost Accumulators</a></p></li>\n<li><p>Instead of doing (expensive) IO in <code>stopTimerAndLog</code> we add the samples to the accumulators:</p>\n\n<pre><code>void stopTimerAndLog()\n{\n    using namespace std::chrono;\n\n    Clock::duration const elapsed = Clock::now() - start;\n    int tmm = duration_cast&lt;microseconds&gt;(elapsed).count();\n\n    double mBitPerSecond = tmm\n        ? buffer.size() * transferredBuffers * 8.0 / 1024 / 1024 / (tmm / 1000000.0)\n        : std::numeric_limits&lt;double&gt;::infinity();\n\n    std::lock_guard&lt;std::mutex&gt; lk(demo_results::mx);\n\n    demo_results::bufsize(buffer.size());\n    demo_results::micros(tmm);\n    if (tmm)\n        demo_results::mbps(mBitPerSecond);\n}\n</code></pre></li>\n<li><p>You can run multiple demo Runs in overlap: </p>\n\n<pre><code>Demo demo;\ndemo.on_connect(argv[1], argv[2]);\n\nfor (int i = 0; i&lt;100; ++i) {\n    std::this_thread::sleep_for(std::chrono::milliseconds(10));\n    demo.on_async_testrun();\n}\n// Demo destructor joins IO thread, making sure all stats are final\n</code></pre></li>\n<li><p>The <code>mutex</code> guarding the statistics is redundant but GoodPractive(TM) since you may want to test with multiple IO threads</p></li>\n</ul>\n\n<p>Output:</p>\n\n<pre><code>avg. Buffer size: 613.82, std.dev. 219.789\navg. b/w:         160.61 mbps, std.dev. 81.061\navg. time:        153.64 \u03bcs, std.dev. 39.0163\n</code></pre>\n\n<h3>Full Listing</h3>\n\n<pre><code>#include &lt;boost/asio.hpp&gt;\n#include &lt;boost/array.hpp&gt;\n#include &lt;boost/make_shared.hpp&gt;\n#include &lt;boost/bind.hpp&gt;\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;chrono&gt;\n#include &lt;memory&gt;\n#include &lt;iostream&gt;\n#include &lt;boost/accumulators/accumulators.hpp&gt;\n#include &lt;boost/accumulators/statistics.hpp&gt;\n\nusing boost::asio::ip::udp;\ntypedef std::chrono::high_resolution_clock Clock;\n\nnamespace demo_results {\n    using namespace boost::accumulators;\n\n    static std::mutex mx;\n    accumulator_set&lt;double, stats&lt;tag::mean, tag::median, tag::variance&gt; &gt; bufsize, mbps, micros;\n}\n\nstruct Run {\n    std::vector&lt;char&gt; buffer = std::vector&lt;char&gt;(rand()%800 + 200, '\\0');\n    int remainingToSend      = rand()%10 + 1;\n    int transferredBuffers   = 0;\n    Clock::time_point start  = Clock::now();\n    Clock::duration elapsed;\n\n    void stopTimerAndLog()\n    {\n        using namespace std::chrono;\n\n        Clock::duration const elapsed = Clock::now() - start;\n        int tmm = duration_cast&lt;microseconds&gt;(elapsed).count();\n\n        double mBitPerSecond = tmm\n            ? buffer.size() * transferredBuffers * 8.0 / 1024 / 1024 / (tmm / 1000000.0)\n            : std::numeric_limits&lt;double&gt;::infinity();\n\n        std::lock_guard&lt;std::mutex&gt; lk(demo_results::mx);\n\n        demo_results::bufsize(buffer.size());\n        demo_results::micros(tmm);\n        if (tmm)\n            demo_results::mbps(mBitPerSecond);\n\n#if 0\n        std::cout &lt;&lt; __FUNCTION__ &lt;&lt; \"  -----------------------------------------------\\n\";\n        std::cout &lt;&lt; __FUNCTION__ &lt;&lt; \": \" &lt;&lt; \"Buffer size: \" &lt;&lt; buffer.size()      &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; __FUNCTION__ &lt;&lt; \": \" &lt;&lt; \"Num Buffers: \" &lt;&lt; transferredBuffers &lt;&lt; \"\\n\";\n        std::cout &lt;&lt; __FUNCTION__ &lt;&lt; \": \" &lt;&lt; \"Time: \"        &lt;&lt; tmm                &lt;&lt; \" \u03bcs\\n\";\n        std::cout &lt;&lt; __FUNCTION__ &lt;&lt; \": \" &lt;&lt; mBitPerSecond   &lt;&lt; \" MBit/s\\n\";\n#endif\n    }\n\n    typedef boost::shared_ptr&lt;Run&gt; Ptr;\n};\n\nstruct Demo {\n    boost::asio::io_service                        m_IOService;\n    std::unique_ptr&lt;boost::asio::io_service::work&gt; m_work;\n    std::unique_ptr&lt;boost::asio::ip::udp::socket&gt;  m_pSocket;\n    boost::asio::ip::udp::endpoint                 m_ReceiverEndpoint;\n    std::thread                                    m_io_thread;\n\n    Demo() :\n        m_IOService(),\n        m_work(new boost::asio::io_service::work(m_IOService)),\n        m_io_thread([this] { m_IOService.run(); })\n    {\n    }\n\n    ~Demo() {\n        m_work.reset();\n        m_io_thread.join();\n    }\n\n    void on_connect(std::string const&amp; host, std::string const&amp; port)\n    {\n        try {\n            udp::resolver resolver(m_IOService);\n            m_ReceiverEndpoint = *resolver.resolve(udp::resolver::query(udp::v4(), host, port));\n            m_pSocket = std::unique_ptr&lt;boost::asio::ip::udp::socket&gt;(new boost::asio::ip::udp::socket(m_IOService));\n            m_pSocket-&gt;open(udp::v4());\n        }\n        catch (std::exception&amp; e)\n        {\n            std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n        }\n    }\n\n    void perform_run(Run::Ptr state) {\n        if (state-&gt;remainingToSend) {\n            std::fill(state-&gt;buffer.begin(), state-&gt;buffer.end(), state-&gt;remainingToSend);\n\n            m_pSocket-&gt;async_send_to(boost::asio::buffer(state-&gt;buffer),\n                    m_ReceiverEndpoint,\n                    boost::bind(&amp;Demo::handle_sent, this,\n                        boost::asio::placeholders::error,\n                        boost::asio::placeholders::bytes_transferred,\n                        state));\n        } else {\n            state-&gt;stopTimerAndLog();\n        }\n    }\n\n    void handle_sent(boost::system::error_code const&amp;error, size_t actually_transferred, Run::Ptr state)\n    {\n        assert(actually_transferred == state-&gt;buffer.size());\n        state-&gt;transferredBuffers += 1;\n        state-&gt;remainingToSend    -= 1;\n\n        if (error) {\n            // missing error propagation to main thread\n            std::cerr &lt;&lt; __FUNCTION__ &lt;&lt; \": ERROR: Client error while sending (error code = \" &lt;&lt; error.message() &lt;&lt; \"): \";\n            std::cerr &lt;&lt; __FUNCTION__ &lt;&lt; \": ERROR: Recovering...\";\n        }\n\n        perform_run(state); // remaining buffers for run\n    }\n\n    void on_async_testrun() {\n        perform_run(boost::make_shared&lt;Run&gt;());\n    }\n};\n\nint main(int argc, char const** argv)\n{\n    assert(argc==3);\n\n    {\n        Demo demo;\n        demo.on_connect(argv[1], argv[2]);\n\n        for (int i = 0; i&lt;100; ++i) {\n            std::this_thread::sleep_for(std::chrono::milliseconds(10));\n            demo.on_async_testrun();\n        }\n    } // Demo destructor joins IO thread, making sure all stats are final\n\n    using namespace boost::accumulators;\n    std::cout &lt;&lt; \"avg. Buffer size: \" &lt;&lt; mean(demo_results::bufsize) &lt;&lt; \", std.dev. \"      &lt;&lt; sqrt(variance(demo_results::bufsize)) &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"avg. b/w:         \" &lt;&lt; mean(demo_results::mbps)    &lt;&lt; \" mbps, std.dev. \" &lt;&lt; sqrt(variance(demo_results::mbps))    &lt;&lt; \"\\n\";\n    std::cout &lt;&lt; \"avg. time:        \" &lt;&lt; mean(demo_results::micros)  &lt;&lt; \" \u03bcs, std.dev. \"   &lt;&lt; sqrt(variance(demo_results::micros))  &lt;&lt; \"\\n\";\n}\n</code></pre>\n"}, {"owner": {"reputation": 73, "user_id": 1707166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/544a9eaff4e5e588fc3b37ffdb628cde?s=128&d=identicon&r=PG", "display_name": "ThomasL.", "link": "https://stackoverflow.com/users/1707166/thomasl"}, "is_accepted": false, "score": 0, "last_activity_date": 1424356583, "creation_date": 1424356583, "answer_id": 28609041, "question_id": 28594736, "link": "https://stackoverflow.com/questions/28594736/what-is-the-best-way-to-send-many-buffers-with-boostasio-method-async-send-to/28609041#28609041", "title": "What is the best way to send many buffers with Boost::Asio method async_send_to", "body": "<p>Thank you very much for your answer. This was a very good starting point to improve my code.</p>\n\n<p>I changed a little bit the way how to add the async_send_to methods. </p>\n\n<pre><code>void perform_run(Run::Ptr state) {\n\n    for(decltype(state-&gt;buffersToSend) i = 0; i &lt; state-&gt;buffersToSend; i++ )\n    {\n        std::fill(state-&gt;buffer.begin(), state-&gt;buffer.end(), i);\n\n        m_pSocket-&gt;async_send_to(boost::asio::buffer(state-&gt;buffer),\n                m_ReceiverEndpoint,\n                boost::bind(&amp;Demo::handle_sent, this,\n                    boost::asio::placeholders::error,\n                    boost::asio::placeholders::bytes_transferred,\n                    state));\n    }\n}\n\nvoid handle_sent(boost::system::error_code const&amp;error, size_t actually_transferred, Run::Ptr state)\n{\n    assert(actually_transferred == state-&gt;buffer.size());\n    state-&gt;transferredBuffers += 1;\n\n    if (error) {\n        // missing error propagation to main thread\n        std::cerr &lt;&lt; __FUNCTION__ &lt;&lt; \": ERROR: Client error while sending (error code = \" &lt;&lt; error.message() &lt;&lt; \"): \";\n        std::cerr &lt;&lt; __FUNCTION__ &lt;&lt; \": ERROR: Recovering...\";\n    }\n\n    if (state-&gt;transferredBuffers &gt;= state-&gt;buffersToSend ) {\n                    state-&gt;stopTimerAndLog();\n    }\n}\n</code></pre>\n\n<p>And here is the full code in <a href=\"http://coliru.stacked-crooked.com/a/b793b36f3c9fa881\" rel=\"nofollow\">coliru</a></p>\n\n<p>Greetings,</p>\n\n<p>Thomas</p>\n"}], "owner": {"reputation": 73, "user_id": 1707166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/544a9eaff4e5e588fc3b37ffdb628cde?s=128&d=identicon&r=PG", "display_name": "ThomasL.", "link": "https://stackoverflow.com/users/1707166/thomasl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "accepted_answer_id": 28596450, "answer_count": 2, "score": 2, "last_activity_date": 1424356583, "creation_date": 1424296658, "last_edit_date": 1424301496, "question_id": 28594736, "link": "https://stackoverflow.com/questions/28594736/what-is-the-best-way-to-send-many-buffers-with-boostasio-method-async-send-to", "title": "What is the best way to send many buffers with Boost::Asio method async_send_to", "body": "<p>What ist he best way to send many buffers with Boost::Asio method <code>async_send_to</code>?\nAnd this whole <em>send procedure</em> can be repeated at any time. And furthermore I want to determine the (correct) elapsed time of each <em>send procedure</em>.</p>\n\n<p>I tried in this way:</p>\n\n<pre><code>//MainWindow.h\n\nclass MainWindow : public QMainWindow\n{\n    Q_OBJECT\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n    ~MainWindow();\nprivate slots:\n    void on_connectPushButton_clicked();\n    void on_asyncSendPushButton_clicked();\nprivate:\n    Ui::MainWindow *ui;\n    QTime m_Timer;\n    int m_BufferSize;\n    int m_NumBuffersToSend;\n    int m_TransferredBuffers;\n    boost::asio::io_service m_IOService;\n    std::unique_ptr&lt;boost::asio::ip::udp::socket&gt;     m_pSocket;\n    boost::asio::ip::udp::endpoint m_ReceiverEndpoint;\n    void handle_send(const boost::system::error_code&amp; error, std::size_t size);\n    void stopTimerAndLog();\n};\n\n//MainWindow.cpp\n\n#include \"MainWindow.h\"\n#include \"ui_MainWindow.h\"\n\n//Some Qt includes\n\n#include &lt;boost/timer/timer.hpp&gt;\n#include &lt;boost/array.hpp&gt;\n#include &lt;boost/bind.hpp&gt;\n\nusing boost::asio::ip::udp;\n\nMainWindow::MainWindow(QWidget *parent) :\n    m_BufferSize(0),\n    m_NumBuffersToSend(0),\n    m_TransferredBuffers(0),\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n\n\nvoid MainWindow::on_connectPushButton_clicked()\n{\n    try\n    {\n        udp::resolver resolver(m_IOService);\n        udp::resolver::query query(udp::v4(), ui-&gt;serverIpAddressLineEdit-&gt;text().toStdString(),\n                ui-&gt;serverPortLineEdit-&gt;text().toStdString());\n        m_ReceiverEndpoint = *resolver.resolve(query);\n        m_pSocket = std::unique_ptr&lt;boost::asio::ip::udp::socket&gt;(new boost::asio::ip::udp::socket(m_IOService));\n        m_pSocket-&gt;open(udp::v4());\n    }\n    catch (std::exception&amp; e)\n    {\n        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n    }\n}\n\nvoid MainWindow::stopTimerAndLog()\n{\n    int tmm = m_Timer.elapsed();\n    double mBitPerSecond = 1000.0 * static_cast&lt;double&gt;(m_BufferSize * m_NumBuffersToSend)\n            / ( 1024.0 * 1024.0 * tmm) * 8.0;\n    LOG_INFO(__FUNCTION__ &lt;&lt; \": \" &lt;&lt; QString(\"Buffer size: %1\").arg(m_BufferSize).toStdString());\n    LOG_INFO(__FUNCTION__ &lt;&lt; \": \" &lt;&lt; QString(\"Num Buffers: %1\").arg(m_NumBuffersToSend).toStdString());\n    LOG_INFO(__FUNCTION__ &lt;&lt; \": \" &lt;&lt; QString(\"Time: %1 ms\").arg(tmm).toStdString());\n    LOG_INFO(__FUNCTION__ &lt;&lt; \": \" &lt;&lt; QString(\"%1 MBit/s\").arg(mBitPerSecond).toStdString());\n    ui-&gt;mBitperSecondDoubleSpinBox-&gt;setValue(mBitPerSecond);\n}\n\nvoid MainWindow::handle_send(const boost::system::error_code &amp;error, size_t size)\n{\n    m_TransferredBuffers++;\n\n    if (error)\n    {\n        //missing error propagation to main thread\n        LOG_ERROR(__FUNCTION__ &lt;&lt; \": ERROR: Client error while sending (error code = \" &lt;&lt; error &lt;&lt; \"): \");\n        LOG_ERROR(__FUNCTION__ &lt;&lt; \": ERROR: Recovering...\");\n    }\n\n    if ( m_TransferredBuffers &gt;= m_NumBuffersToSend )\n    {\n        stopTimerAndLog();\n        m_IOService.stop();\n    }\n}\n\nvoid MainWindow::on_asyncSendPushButton_clicked()\n{\n    try\n    {\n        m_BufferSize = ui-&gt;sendBufferSpinBox-&gt;value();\n        char* data = new char[m_BufferSize];\n        memset(data, 0, m_BufferSize);\n        m_NumBuffersToSend = ui-&gt;numBufferSpinBox-&gt;value();\n\n        m_Timer.start();\n\n        for (int i=0; i &lt; m_NumBuffersToSend; i++)\n        {\n            memset(data, i, m_BufferSize);\n\n            m_pSocket-&gt;async_send_to(boost::asio::buffer(data, m_BufferSize),\n                    m_ReceiverEndpoint,\n                    boost::bind(&amp;MainWindow::handle_send, this,\n                        boost::asio::placeholders::error,\n                        boost::asio::placeholders::bytes_transferred));\n        }\n        m_TransferredBuffers = 0;\n        m_IOService.run();\n        delete[] data;\n    }\n    catch (std::exception&amp; e)\n    {\n        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>As you can see, the <em>user</em> can click on the <em>connect</em> button (<code>on_connectPushButton_clicked</code>). And then the <em>send procedure</em> starts by clicking on the <em>async send</em> button (<code>on_asyncSendPushButton_clicked</code>). And here I start the timer and call <code>m_NumBuffersToSend</code> times the async_send_to method. Then I run the <code>IOService</code>. For each <code>async_send_to</code> the handler <code>handle_send</code> will be called And the <code>m_TransferredBuffers</code> variable will be incremented until it reaches <code>m_NumBuffersToSend</code>. If this is the case, I stop the timer and the <code>IOService</code>.</p>\n\n<p>But if I compare the time which was calculated in my program with the <em>real</em> sent udp\u2019s with Wireshark there is always a big difference. How can I have a more accurate time calculation?</p>\n\n<p>Is it possible to place the <code>m_IOService.run();</code> call outside  <code>on_asyncSendPushButton_clicked</code>?</p>\n"}, {"tags": ["c++", "c", "ffmpeg"], "comments": [{"owner": {"reputation": 116848, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "edited": false, "score": 0, "creation_date": 1424301407, "post_id": 28594614, "comment_id": 45498241, "body": "Do you have any code that you can paste it which you&#39;ve tried so far?"}, {"owner": {"reputation": 39, "user_id": 1816574, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/02fcde8b3e51fe996b8b295e2fa7b64c?s=128&d=identicon&r=PG", "display_name": "user1816574", "link": "https://stackoverflow.com/users/1816574/user1816574"}, "reply_to_user": {"reputation": 116848, "user_id": 55075, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8bbc94977312d285045b2412257b6cb8?s=128&d=identicon&r=PG", "display_name": "kenorb", "link": "https://stackoverflow.com/users/55075/kenorb"}, "edited": false, "score": 0, "creation_date": 1424361041, "post_id": 28594614, "comment_id": 45525105, "body": "I have added the code. thanks."}], "owner": {"reputation": 39, "user_id": 1816574, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/02fcde8b3e51fe996b8b295e2fa7b64c?s=128&d=identicon&r=PG", "display_name": "user1816574", "link": "https://stackoverflow.com/users/1816574/user1816574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1586, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1424362958, "creation_date": 1424296193, "last_edit_date": 1424361006, "question_id": 28594614, "link": "https://stackoverflow.com/questions/28594614/how-to-set-up-ffmpeg-options-for-hls", "title": "How to set up ffmpeg options for HLS?", "body": "<p>I have a streaming device that streams mpegts video and audio. I am trying to capture those streams and save them multiple .ts file using HLS of ffmpeg. </p>\n\n<p>So, I have been successful in capturing and saving the streams in a single .ts file. It seems like when I send the output file to be .m3u8, ffmpeg automatically chooses hls demuxer.  But, doing so I get a floating point exception.\nHere is my simple code...</p>\n\n<pre><code>static int ipcam_streaming_main_configure_input_parameters(const char *p_ifilename, AVFormatContext **ppx_ifmt_ctx)\n\n{\n   AVStream *px_istream          = NULL;\n   AVCodecContext *px_icodec_ctx = NULL;\n   int ret                       = -1;\n   unsigned int i                = 0;\n   enum AVCodecID input_codec_id = AV_CODEC_ID_NONE;\n   AVCodec *p_decoder            = NULL;\n\n\n   if (avformat_open_input(ppx_ifmt_ctx, p_ifilename, NULL, NULL) &lt; 0)\n\n   {\n      printf(\"%s(): avformat_open_input() failed\\n\", __FUNCTION__);\n\n   }\n   else if (avformat_find_stream_info(*ppx_ifmt_ctx, NULL) &lt; 0)\n   {\n      printf(\"%s(): avformat_find_stream_info() failed\\n\", __FUNCTION__);\n   }\n   else\n   {\n      /* find the input streams to be remuxed */\n      for (i = 0; i &lt; (*ppx_ifmt_ctx)-&gt;nb_streams; i++)\n      {\n         /* get the stream, codec context for the stream */\n         px_istream = (*ppx_ifmt_ctx)-&gt;streams[i];\n         px_icodec_ctx = px_istream-&gt;codec;\n\n         if ((AVMEDIA_TYPE_VIDEO == px_icodec_ctx-&gt;codec_type)\n             || (AVMEDIA_TYPE_AUDIO == px_icodec_ctx-&gt;codec_type))\n         {\n            /* get the codec_id for the audio/video stream */\n            input_codec_id = px_icodec_ctx-&gt;codec_id;\n\n            /* get the decoder for the input codec id */\n            p_decoder = avcodec_find_decoder(px_icodec_ctx-&gt;codec_id);\n\n            /* Open decoder for the input codec audio/video */\n            ret = avcodec_open2(px_icodec_ctx,\n                                p_decoder,\n                                NULL);\n            if (ret &lt; 0)\n            {\n               printf(\"%s(): avcodec_open2() failed\\n\", __FUNCTION__);\n            }\n            else\n            {\n               printf(\"Input stream type &lt;%d&gt; with codec_id &lt;%d&gt; found and decoder opened\\n\", px_icodec_ctx-&gt;codec_type, input_codec_id);\n            }\n         }\n      }\n   }\n\n   /* dump the data into stdout */\n   av_dump_format(*ppx_ifmt_ctx, 0, p_ifilename, 0);\n\n   return ret;\n}\n\nstatic int ipcam_streaming_main_configure_output_parameters(const char *p_ofilename,\n                                                            AVFormatContext *px_ifmt_ctx,\n                                                            AVFormatContext **ppx_ofmt_ctx)\n{\n   AVStream *px_ostream       = NULL;\n   AVStream *px_istream       = NULL;\n   AVCodecContext *px_dec_ctx = NULL;\n   AVCodecContext *px_enc_ctx = NULL;\n   int ret                    = -1;\n   unsigned int i             = 0;\n\n   if ((NULL == p_ofilename) || (NULL == px_ifmt_ctx) || (NULL == ppx_ofmt_ctx))\n   {\n      printf(\"%s(): NULL arg(s) &lt;%p, %p, %p&gt;\", __FUNCTION__, p_ofilename, px_ifmt_ctx, ppx_ofmt_ctx);\n      return -1;\n   }\n\n   /* remove the output file if already exists */\n   remove(p_ofilename);\n\n   /* allocate the output format context */\n   if (avformat_alloc_output_context2(ppx_ofmt_ctx, NULL, NULL, p_ofilename) &lt; 0)\n   {\n      printf(\"%s(): avformat_alloc_output_context2() failed\\n\", __FUNCTION__);\n   }\n   else\n   {\n      for (i = 0; i &lt; px_ifmt_ctx-&gt;nb_streams; i++)\n      {\n         if ((AVMEDIA_TYPE_VIDEO == px_ifmt_ctx-&gt;streams[i]-&gt;codec-&gt;codec_type)\n             || (AVMEDIA_TYPE_AUDIO == px_ifmt_ctx-&gt;streams[i]-&gt;codec-&gt;codec_type))\n         {\n            printf(\"Stream &lt;%d&gt; is type &lt;%d&gt;: Adding to output stream\\n\", i, px_ifmt_ctx-&gt;streams[i]-&gt;codec-&gt;codec_type);\n\n            /* create a new output stream */\n            px_ostream = avformat_new_stream(*ppx_ofmt_ctx, NULL);\n            if (NULL == px_ostream)\n            {\n               printf(\"%s(): avformat_new_stream() failed\\n\", __FUNCTION__);\n            }\n            else\n            {\n               px_istream = px_ifmt_ctx-&gt;streams[i];\n               px_dec_ctx = px_istream-&gt;codec;\n               px_enc_ctx = px_ostream-&gt;codec;\n\n               /* Since, we do not need to encode the video stream, it is just remuxing\n                  just copying the input codec context to output is sufficient */\n               ret = avcodec_copy_context((*ppx_ofmt_ctx)-&gt;streams[i]-&gt;codec,\n                                          px_ifmt_ctx-&gt;streams[i]-&gt;codec);\n\n               if ((*ppx_ofmt_ctx)-&gt;oformat-&gt;flags &amp; AVFMT_GLOBALHEADER)\n               {\n                  px_enc_ctx-&gt;flags |= CODEC_FLAG_GLOBAL_HEADER;\n               }\n            }\n         }\n         else\n         {\n            printf(\"Stream &lt;%d&gt; is Unknown: Ignore it \\n\", i);\n         }\n      }\n\n      /* dump the output media file into stdout */\n      av_dump_format(*ppx_ofmt_ctx, 0, p_ofilename, 1);\n\n      if (0 == ((*ppx_ofmt_ctx)-&gt;oformat-&gt;flags &amp; AVFMT_NOFILE))\n      {\n         /* open the output media file so that we can write the data into it */\n         ret = avio_open(&amp;(*ppx_ofmt_ctx)-&gt;pb, p_ofilename, AVIO_FLAG_WRITE);\n         if (ret &lt; 0)\n         {\n            printf(\"%s(): avio_open() failed\\n\", __FUNCTION__);\n         }\n         else\n         {\n            /* init muxer, write output file header */\n            ret = avformat_write_header((*ppx_ofmt_ctx), NULL);\n            if (ret &lt; 0)\n            {\n               printf(\"%s(): avformat_write_header() failed\\n\", __FUNCTION__);\n            }\n         }\n      }\n   }\n\n   return ret;\n}\n\n\nint main(int argnum, char **argv)\n{\n   AVFormatContext *px_ifmt_ctx = NULL;\n   AVFormatContext *px_ofmt_ctx = NULL;\n   AVPacket packet              = {0};\n   enum AVMediaType type        = AVMEDIA_TYPE_UNKNOWN;\n   unsigned int stream_index    = -1;\n   unsigned int i               = 0;\n   int ret                      = -1;\n\n   if (argnum != 3)\n   {\n      printf(\"Please enough number of parameters\\n\");\n      return -1;\n   }\n\n   /* register all the services requred */\n   av_register_all();\n   avformat_network_init();\n\n   if (0 != ipcam_streaming_main_configure_input_parameters(argv[1],\n                                                            &amp;px_ifmt_ctx))\n   {\n      printf(\"%s(): ipcam_streaming_main_configure_iput_parameters() failed\\n\", __FUNCTION__);\n   }\n   else if (0 != ipcam_streaming_main_configure_output_parameters(argv[2],\n                                                                  px_ifmt_ctx,\n                                                                  &amp;px_ofmt_ctx)) \n   {\n      printf(\"%s(): ipcam_streaming_main_configure_output_parameters() failed\\n\", __FUNCTION__);\n   }\n   else\n   {\n      printf(\"Input and output configuration done successfully: Now reading packets\\n\");\n      while (true)\n      {\n         if ((ret = av_read_frame(px_ifmt_ctx, &amp;packet)) &lt; 0)\n         {\n            printf(\"av_read_frame() failed with error &lt;%d&gt;: Exit\\n\", ret);\n            break;\n         }\n\n         /* get the stream index and codec type of the packet read */\n         stream_index = packet.stream_index;\n         type = px_ifmt_ctx-&gt;streams[stream_index]-&gt;codec-&gt;codec_type;\n\n         /* remux only if the type is video, otherwise ignore it */\n         if ((AVMEDIA_TYPE_VIDEO == type)\n             || (AVMEDIA_TYPE_AUDIO == type))\n         {\n            printf(\"Remuxing the stream type &lt;%d&gt;, frame with stream index &lt;%d&gt;\\n\", type, stream_index);\n\n            /* remux this frame without reencoding */\n            packet.dts = av_rescale_q_rnd(packet.dts,\n                                          px_ifmt_ctx-&gt;streams[stream_index]-&gt;time_base,\n                                          px_ofmt_ctx-&gt;streams[stream_index]-&gt;time_base,\n                                          AV_ROUND_NEAR_INF | AV_ROUND_PASS_MINMAX);\n\n            packet.pts = av_rescale_q_rnd(packet.pts,\n                                          px_ifmt_ctx-&gt;streams[stream_index]-&gt;time_base,\n                                          px_ofmt_ctx-&gt;streams[stream_index]-&gt;time_base,\n                                          AV_ROUND_NEAR_INF | AV_ROUND_PASS_MINMAX);\n\n            /* write the frame into the output media file */\n            ret = av_write_frame(px_ofmt_ctx, &amp;packet);\n\n            if (ret &lt; 0)\n            {\n               printf(\"Ignoring video packet stream index &lt;%d&gt;\\n\", packet.stream_index);\n            }\n\n            /* free the packet for next use */\n            av_free_packet(&amp;packet);\n         }\n         else\n         {\n            printf(\"Ignoring stream index &lt;%d&gt;, type &lt;%d&gt;\\n\", packet.stream_index, type);\n         }\n      }\n   }\n\n   /* write the trailer */\n   av_write_trailer(px_ofmt_ctx);\n\n   av_free_packet(&amp;packet);\n\n   for (i = 0; i &lt; px_ifmt_ctx-&gt;nb_streams; i++)\n   {\n      /* close the input codec that has been opened */\n      avcodec_close(px_ifmt_ctx-&gt;streams[i]-&gt;codec);\n\n      if ((NULL != px_ofmt_ctx) &amp;&amp; (px_ofmt_ctx-&gt;nb_streams &gt; i) &amp;&amp; \n          (NULL != px_ofmt_ctx-&gt;streams[i]) &amp;&amp; ( NULL != px_ofmt_ctx-&gt;streams[i]-&gt;codec))\n      {\n         /* close the output code */\n         avcodec_close(px_ofmt_ctx-&gt;streams[i]-&gt;codec);\n      }\n   }\n\n   /* close the input */\n   avformat_close_input(&amp;px_ifmt_ctx);\n\n   if ((NULL != px_ofmt_ctx) &amp;&amp; (0 == (px_ofmt_ctx-&gt;oformat-&gt;flags &amp; AVFMT_NOFILE)))\n   {\n      /* close the output context */\n      avio_close(px_ofmt_ctx-&gt;pb);\n   }\n\n   /* free the output context */\n   avformat_free_context(px_ofmt_ctx);\n\n   return ret;\n}\n</code></pre>\n\n<p>So, If i pass the output filename to be .m3u8 file, it gives a floating point exception.</p>\n"}, {"tags": ["c++", "ios", "c", "image", "opencv"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4225236, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4cad1a27a51b42f30978791eb9f71473?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Tchadenis", "link": "https://stackoverflow.com/users/4225236/steven-tchadenis"}, "edited": false, "score": 0, "creation_date": 1424371468, "post_id": 28597538, "comment_id": 45531996, "body": "Thank you for all this information. I&#39;ve been trying to run Instruments myself but am getting multiple &quot;Apple Mach-O Linker Error&quot; issues.   I will try reducing the camera images, because to be honest I&#39;m under-qualified to make major changes to your code.  Of course, if I do happen to stumble upon any improvements, I will send a pull request."}, {"owner": {"reputation": 30809, "user_id": 1375695, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df08e9e25d8fa6007a35d9c906864516?s=128&d=identicon&r=PG", "display_name": "foundry", "link": "https://stackoverflow.com/users/1375695/foundry"}, "reply_to_user": {"reputation": 151, "user_id": 4225236, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4cad1a27a51b42f30978791eb9f71473?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Tchadenis", "link": "https://stackoverflow.com/users/4225236/steven-tchadenis"}, "edited": false, "score": 1, "creation_date": 1424372182, "post_id": 28597538, "comment_id": 45532377, "body": "@Ryan, see my update. Resizing the camera output is your best bet for now."}, {"owner": {"reputation": 151, "user_id": 4225236, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4cad1a27a51b42f30978791eb9f71473?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Tchadenis", "link": "https://stackoverflow.com/users/4225236/steven-tchadenis"}, "edited": false, "score": 0, "creation_date": 1424380363, "post_id": 28597538, "comment_id": 45537001, "body": "Ok. If you make any progress on the tiling and cacheing let me know! Thanks for everything."}], "owner": {"reputation": 30809, "user_id": 1375695, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df08e9e25d8fa6007a35d9c906864516?s=128&d=identicon&r=PG", "display_name": "foundry", "link": "https://stackoverflow.com/users/1375695/foundry"}, "is_accepted": true, "score": 6, "last_activity_date": 1446729250, "last_edit_date": 1446729250, "creation_date": 1424311689, "answer_id": 28597538, "question_id": 28594416, "link": "https://stackoverflow.com/questions/28594416/issue-with-stitching-images-using-opencv-for-ios/28597538#28597538", "title": "Issue with stitching images using openCV for iOS", "body": "<p>You are hitting memory limits. The four demo images included are 720 x 960 px, whereas you are using the full resolution image from the device camera.</p>\n\n<p>Here is an Allocations trace in instruments leading up to the crash, stitching two images from the camera...</p>\n\n<p><img src=\"https://i.stack.imgur.com/q2kv7.png\" alt=\"enter image description here\"> </p>\n\n<p>The point of this github sample is to illustrate a few things...<br>\n(1) how to integrate openCV with iOS;<br>\n(2) how to separate Objective-C and C++ code using a wrapper;<br>\n(3) how to implement the <em>most basic</em> stitching function in openCV. </p>\n\n<p>It is best regarded as a 'hello world' project for iOS+openCV, and was not designed to work robustly with camera images. If you want to use my code as-is, I would suggest first reducing your camera images to a manageable size (e.g. max 1000 on the long side). </p>\n\n<p>In any case the openCV framework you are using is as old as the project. Thanks to your question, I have just updated it (now arm64-friendly), although the memory limitations still apply. </p>\n\n<p>V2, <a href=\"https://github.com/foundry/OpenCVSwiftStitch\" rel=\"nofollow noreferrer\">OpenCVSwiftStitch</a> may be a more interesting starting-point for your experiments - the interface is written in Swift, and it uses cocoaPods to keep up with openCV versions (albeit currently fixed to 2.4.9.1 as 2.4.10 breaks everything). So it still illustrates the three points, and also shows how to use Swift with C++ using an Objective-C wrapper as an intermediary.</p>\n\n<p><strike>I may be able to improve memory handling (by passing around pointers). If so I will push an update to both v1 and v2. If <em>you</em> can make any improvements, please send a pull request.</strike></p>\n\n<p><strong>update</strong> i've had another look and I am fairly sure it won't be possible to improve the memory handling without getting deeper into the openCV stitching algorithms. The images are already allocated on the heap so there are no improvements to be made there. I expect the best bet would be to tile and cache the intermediate images which it seems openCV is creating as part of the process. I will post an update if I get any further with this. Meanwhile, resizing the camera images is the way to go.</p>\n\n<p><strong>update 2</strong><br>\nSome while later, I found the underlying cause of the issue. When you use images from the iOS camera as your inputs, if those images are in portrait orientation they will have the incorrect input dimensions (and orientation) for openCV. This is because all iOS camera photos are taken natively as 'landscape left'. The pixel dimensions are landscape, with the home button on the right. To display portrait, the 'imageOrientation' flag is set to UIImageOrientationRight. This is <em>only</em> an indication to the OS to rotate the image 90 degrees to the right for display. </p>\n\n<p>The image is stored unrotated, landscape left. The incorrect pixel orientation leads to higher memory requirements and unpredictable/broken results in openCV.  </p>\n\n<p>I have <a href=\"https://github.com/foundry/OpenCVSwiftStitch/issues/12\" rel=\"nofollow noreferrer\">fixed this</a> in the latest version of openCVSwiftStitch: when necessary images are rotated pixelwise before adding to the openCV pipeline.</p>\n"}], "owner": {"reputation": 151, "user_id": 4225236, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4cad1a27a51b42f30978791eb9f71473?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Tchadenis", "link": "https://stackoverflow.com/users/4225236/steven-tchadenis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1444, "favorite_count": 2, "accepted_answer_id": 28597538, "answer_count": 1, "score": 2, "last_activity_date": 1446729250, "creation_date": 1424295446, "last_edit_date": 1438783646, "question_id": 28594416, "link": "https://stackoverflow.com/questions/28594416/issue-with-stitching-images-using-opencv-for-ios", "title": "Issue with stitching images using openCV for iOS", "body": "<p>I'm trying to adopt the code from here:</p>\n\n<p><a href=\"https://github.com/foundry/OpenCVStitch\" rel=\"nofollow\">https://github.com/foundry/OpenCVStitch</a></p>\n\n<p>into my program. However, I've run up against a wall. This code stitches images together that are already existing. The program I'm trying to make will stitch images together that the user took. The error I'm getting is that when I pass the images to the stitch function, it is saying they are of invalid size (0 x 0). </p>\n\n<p>Here is the stitching function: </p>\n\n<pre><code>- (IBAction)stitchImages:(UIButton *)sender {\n    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{\n\n\n        NSArray* imageArray = [NSArray arrayWithObjects:\n                               chosenImage, chosenImage2, nil];\n        UIImage* stitchedImage = [CVWrapper processWithArray:imageArray]; // error occurring within processWithArray function\n        dispatch_async(dispatch_get_main_queue(), ^{\n\n            NSLog (@\"stitchedImage %@\",stitchedImage);\n            UIImageView *imageView = [[UIImageView alloc] initWithImage:stitchedImage];\n            self.imageView = imageView;\n            [self.scrollView addSubview:imageView];\n            self.scrollView.backgroundColor = [UIColor blackColor];\n            self.scrollView.contentSize = self.imageView.bounds.size;\n            self.scrollView.maximumZoomScale = 4.0;\n            self.scrollView.minimumZoomScale = 0.5;\n            self.scrollView.contentOffset = CGPointMake(-(self.scrollView.bounds.size.width-self.imageView.bounds.size.width)/2, -(self.scrollView.bounds.size.height-self.imageView.bounds.size.height)/2);\n            [self.spinner stopAnimating];\n\n        });\n\n\n    });\n\n}\n</code></pre>\n\n<p>chosenImage and chosenImage2 are images the user has taken using these two functions:</p>\n\n<pre><code>- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {\n    savedImage = info[UIImagePickerControllerOriginalImage];\n\n    // display photo in the correct UIImageView\n    switch(image_location){\n        case 1:\n            chosenImage = info[UIImagePickerControllerOriginalImage];\n            self.imageView2.image = chosenImage;\n            image_location++;\n            break;\n        case 2:\n            chosenImage2 = info[UIImagePickerControllerOriginalImage];\n            self.imageView3.image = chosenImage2;\n            image_location--;\n            break;\n\n    }\n    // if user clicked \"take photo\", it should save photo\n    // if user clicked \"select photo\", it should not save photo\n    /*if (should_save){\n     UIImageWriteToSavedPhotosAlbum(chosenImage, nil, nil, nil);\n     }*/\n    [picker dismissViewControllerAnimated:YES completion:NULL];\n\n}\n\n- (IBAction)takePhoto:(UIButton *)sender {\n    UIImagePickerController *picker = [[UIImagePickerController alloc] init];\n    picker.delegate = self;\n    picker.allowsEditing = NO;\n    picker.sourceType = UIImagePickerControllerSourceTypeCamera;\n    //last_pressed = 1;\n    should_save = 1;\n    [self presentViewController:picker animated:YES completion:NULL];\n}\n</code></pre>\n\n<p>The stitchesImages function passes an array of these two images to this function:</p>\n\n<pre><code>+ (UIImage*) processWithArray:(NSArray*)imageArray\n{\n    if ([imageArray count]==0){\n        NSLog (@\"imageArray is empty\");\n        return 0;\n        }\n    cv::vector&lt;cv::Mat&gt; matImages;\n\n    for (id image in imageArray) {\n        if ([image isKindOfClass: [UIImage class]]) {\n            cv::Mat matImage = [image CVMat3];\n            NSLog (@\"matImage: %@\",image);\n            matImages.push_back(matImage);\n        }\n    }\n    NSLog (@\"stitching...\");\n    cv::Mat stitchedMat = stitch (matImages); // error occurring within stitch function\n    UIImage* result =  [UIImage imageWithCVMat:stitchedMat];\n    return result;\n}\n</code></pre>\n\n<p>This is where the program is running into a problem. When it is passed images that are saved locally in the application file, it works fine. However, when it is passed images that are saved in variables (chosenImage and chosenImage2), it doesn't work. </p>\n\n<p>Here is the stitch function that is being called in the processWithArray function and is causing the error:</p>\n\n<pre><code>cv::Mat stitch (vector&lt;Mat&gt;&amp; images)\n{\n    imgs = images;\n    Mat pano;\n    Stitcher stitcher = Stitcher::createDefault(try_use_gpu);\n    Stitcher::Status status = stitcher.stitch(imgs, pano);\n\n    if (status != Stitcher::OK)\n        {\n        cout &lt;&lt; \"Can't stitch images, error code = \" &lt;&lt; int(status) &lt;&lt; endl;\n            //return 0;\n        }\n    return pano;\n}\n</code></pre>\n\n<p>The error is \"Can't stitch images, error code = 1\".</p>\n"}, {"tags": ["c++", "templates", "stl", "max", "min"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1424294677, "post_id": 28594170, "comment_id": 45494976, "body": "Not (yet) your problem, but <a href=\"http://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file\" title=\"why can templates only be implemented in the header file\">stackoverflow.com/questions/495021/&hellip;</a>"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1424294680, "post_id": 28594170, "comment_id": 45494979, "body": "Note that since C++11, you may directly write <code>std::max({firstElement, secondElement, thirdElement});</code>"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1424294809, "post_id": 28594170, "comment_id": 45495049, "body": "I don&#39;t see any const methods, just a bunch of const parameters and generally meaningless const return values.  A const method looks like <code>void foo() const {}</code>"}], "answers": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "is_accepted": true, "score": 7, "last_activity_date": 1424295262, "last_edit_date": 1424295262, "creation_date": 1424294742, "answer_id": 28594239, "question_id": 28594170, "link": "https://stackoverflow.com/questions/28594170/error-with-max-and-min-in-a-template-class/28594239#28594239", "title": "Error with max and min in a template class", "body": "<p><code>threeTriplet.maximum()</code> returns a <code>const Employee</code> object.\nThen you invoke the <code>Employee::getName()</code> (which is not marked <code>const</code>) function on it, so the compiler complains, since you are not allow to invoke non-const member functions on <code>const</code> objects.</p>\n\n<p>Either mark the <code>getName() const</code> (always a good idea when your function doesn't need to modify the object), or just return from <code>Triple&lt;T&gt;::median()</code>, <code>Triple&lt;T&gt;::minimum()</code>, <code>Triple&lt;T&gt;::maximum()</code> by non-const value.</p>\n"}, {"comments": [{"owner": {"reputation": 1359, "user_id": 3203447, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ca4cd1cca9f68191aec907fc8e468609?s=128&d=identicon&r=PG&f=1", "display_name": "JTK", "link": "https://stackoverflow.com/users/3203447/jtk"}, "edited": false, "score": 0, "creation_date": 1424299176, "post_id": 28595154, "comment_id": 45497326, "body": "This is what I did to fix the problem, I&#39;d figured it out before you posted this thanks to @vsoftco answer, I misunderstood how I should implement const on a function, I&#39;m surprised it took me till now to realize I was doing this wrong."}], "owner": {"reputation": 61, "user_id": 4009660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91a019d87c4dd546662be82a8dc5772?s=128&d=identicon&r=PG&f=1", "display_name": "Daniofb", "link": "https://stackoverflow.com/users/4009660/daniofb"}, "is_accepted": false, "score": 1, "last_activity_date": 1424298324, "creation_date": 1424298324, "answer_id": 28595154, "question_id": 28594170, "link": "https://stackoverflow.com/questions/28594170/error-with-max-and-min-in-a-template-class/28595154#28595154", "title": "Error with max and min in a template class", "body": "<p>Try to add <strong>const</strong> to your <em>&lt;></em> overload operators:</p>\n\n<p>in Employee.cpp:</p>\n\n<pre><code>bool Employee::operator &lt; (const Employee &amp;rop) const\n{\n    return (salary &lt; rop.salary);\n}\n\nbool Employee::operator &lt; (const Employee &amp;rop) const\n{\n    return (salary &lt; rop.salary);\n}\n</code></pre>\n\n<p>in Employee.h</p>\n\n<pre><code>bool Employee::operator&lt;(const Employee &amp;rop)const;\nbool Employee::operator&gt;(const Employee &amp;rop)const;\n</code></pre>\n"}], "owner": {"reputation": 1359, "user_id": 3203447, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ca4cd1cca9f68191aec907fc8e468609?s=128&d=identicon&r=PG&f=1", "display_name": "JTK", "link": "https://stackoverflow.com/users/3203447/jtk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 28594239, "answer_count": 2, "score": 0, "last_activity_date": 1424298324, "creation_date": 1424294501, "question_id": 28594170, "link": "https://stackoverflow.com/questions/28594170/error-with-max-and-min-in-a-template-class", "title": "Error with max and min in a template class", "body": "<p>I have written a template class called <code>Triple</code> to take 3 objects of <code>type T</code> and I have three functions to get the min, max and median of these 3 objects.</p>\n\n<p>I'm using the <code>min</code> and <code>max</code> functions from the STL to accomplish this.\nI had to make all my methods const to get the max and min to work and it does work, with normal types, but then I created a class called <code>Employee</code>, this class has 2 functions <code>getSalary()</code> and the <code>getName()</code>, I'v overloaded the <code>&lt; &gt;</code> operators so I can use this class in my template.</p>\n\n<p>This is where I run in to problems, the compiler is complaining with: const std::string Employee::getName(void)' : cannot convert 'this' pointer from 'const Employee' to 'Employee &amp;'</p>\n\n<p>I've tried changing everything to const in the employee class without success, and I cant get the triple class to work unless everything is const.</p>\n\n<p>Where have I gone wrong?</p>\n\n<p>Triple.h</p>\n\n<pre><code>#ifndef TRIPLE_H\n#define TRIPLE_H\ntemplate&lt;class T&gt;\nclass Triple{\npublic:\n    Triple();\n    Triple(const T fE, const T sE, const T tE);\n    const T maximum();\n    const T minimum();\n    const T median();\nprivate:\n    const T firstElement;\n    const T secondElement;\n    const T thirdElement;\n\n\n};\n#endif\n</code></pre>\n\n<p>Triple.CPP</p>\n\n<pre><code>#include \"Triple.h\"\n#include &lt;algorithm&gt; \nusing std::max;\nusing std::min;\n\ntemplate&lt;class T&gt;\nTriple&lt;T&gt;::Triple(){\n\n}\ntemplate&lt;class T&gt;\nTriple&lt;T&gt;::Triple(const T fE, const T sE, const T tE)\n    :firstElement(fE), secondElement(sE), thirdElement(tE){\n}\ntemplate&lt;class T&gt;\n const T Triple&lt;T&gt;::maximum(){\n\n     return max(max(firstElement, secondElement), thirdElement);\n}\ntemplate&lt;class T&gt;\nconst T Triple&lt;T&gt;::minimum(){\n\n    return min(min(firstElement, secondElement), thirdElement);\n}\ntemplate&lt;class T&gt;\nconst T Triple&lt;T&gt;::median(){\n\n    return max(min(firstElement, secondElement), min(max(firstElement, secondElement), thirdElement));\n}\n</code></pre>\n\n<p>Employee.h</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\nusing  std::ostream;\nusing std::string;\nclass Employee{\npublic:\n    Employee();\n    Employee(string,  double);\n    const string getName();\n    double getSalary();\n    bool Employee::operator&lt;(const Employee &amp;rop);\n    bool Employee::operator&gt;(const Employee &amp;rop);\n\nprivate:\n    double salary;\n    string name;\n};\n</code></pre>\n\n<p>Employee.cpp</p>\n\n<pre><code>#include \"Employee.h\"\n\nEmployee::Employee(){\n\n}\nEmployee::Employee(string nameIn, double salaryIn)\n    :name(nameIn), salary(salaryIn) {\n};\nconst string Employee::getName(){\n    return name;\n}\ndouble Employee::getSalary(){\n    return salary;\n}\nbool Employee::operator &lt; (const Employee &amp;rop)\n{\n    return (salary &lt; rop.salary);\n}\nbool Employee::operator &gt;(const Employee &amp;rop)\n{\n    return (salary &gt; rop.salary);\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"Triple.h\"\n#include \"Triple.cpp\"\n#include \"Employee.h\"\n#include &lt;iostream&gt;\nusing std::cout;\nusing std::endl;\n\nint main(){\n\n     Employee john(\"John\", 70000);\n     Employee tom(\"Tom\", 30000);\n     Employee mark(\"Mark\", 10000);\n\n\n    Triple&lt;int&gt; oneTriplet(1, 2, 3);\n    Triple&lt;char&gt; twoTriplet('A', 'B', 'C');\n    Triple&lt;Employee&gt; threeTriplet(john, tom, mark);\n\n\n    cout &lt;&lt; oneTriplet.maximum() &lt;&lt; endl;\n    cout &lt;&lt; oneTriplet.minimum() &lt;&lt; endl;\n    cout &lt;&lt; oneTriplet.median() &lt;&lt; endl;\n\n    cout &lt;&lt; twoTriplet.maximum() &lt;&lt; endl;\n    cout &lt;&lt; twoTriplet.minimum() &lt;&lt; endl;\n    cout &lt;&lt; twoTriplet.median() &lt;&lt; endl;\n\n    cout &lt;&lt; threeTriplet.maximum().getName() &lt;&lt; endl;\n    cout &lt;&lt; threeTriplet.minimum().getName() &lt;&lt; endl;\n\n\n\n    system(\"pause\");\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c++", "validation", "while-loop"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424293613, "post_id": 28593892, "comment_id": 45494397, "body": "I&#39;m curious, why do people make 1980s-style interactive programs when a C++ tool that reads from a lightly delimited text file would be way easier to run repeatedly? Even better is to embrace using <code>argv</code> when possible to communicate with your program."}, {"owner": {"reputation": 3849, "user_id": 3701807, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1d08e47ba80a547518f3927d50e46735?s=128&d=identicon&r=PG&f=1", "display_name": "Nithin", "link": "https://stackoverflow.com/users/3701807/nithin"}, "edited": false, "score": 0, "creation_date": 1424293935, "post_id": 28593892, "comment_id": 45494568, "body": "by digit, you mean a single digit or any number ?"}, {"owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424294054, "post_id": 28593892, "comment_id": 45494635, "body": "@tadman probably because any beginner&#39;s C++ book I&#39;ve seen tends to start off with i/o like that."}, {"owner": {"reputation": 25, "user_id": 4521212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1270211866/picture?type=large", "display_name": "Art Byra", "link": "https://stackoverflow.com/users/4521212/art-byra"}, "edited": false, "score": 0, "creation_date": 1424294215, "post_id": 28593892, "comment_id": 45494717, "body": "For digit I mean number -- edited to fix that"}, {"owner": {"reputation": 25, "user_id": 4521212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1270211866/picture?type=large", "display_name": "Art Byra", "link": "https://stackoverflow.com/users/4521212/art-byra"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424294401, "post_id": 28593892, "comment_id": 45494815, "body": "@tadman I am new to C++ and I was just trying to make a program in my free time. It isn&#39;t the prettiest code and it may not be the most effective but you have to start somewhere right? In the end it will work when I have all the bugs removed and that&#39;s a good start for me."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424294571, "post_id": 28593892, "comment_id": 45494909, "body": "Not criticizing, just asking. When you&#39;re trying to debug code like this I&#39;ve found using a simple test framework makes getting things right a lot easier, and way faster than having to repeatedly run and type things in. For example. <a href=\"https://github.com/philsquared/Catch/blob/master/docs/tutorial.md\" rel=\"nofollow noreferrer\">Catch</a> is super simple and can build confidence you&#39;re doing things correctly. Being able to edit code, and effortlessly re-run it to check functionality quickly helps a lot. An interface like that can really slow down the cycles."}, {"owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "edited": false, "score": 0, "creation_date": 1424294614, "post_id": 28593892, "comment_id": 45494940, "body": "If you try and read a number and get a non number, it sets the error state of the stream. When the error state is set all reads will fail on all read attempts. You need to reset the error state so it is clear."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4521212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1270211866/picture?type=large", "display_name": "Art Byra", "link": "https://stackoverflow.com/users/4521212/art-byra"}, "edited": false, "score": 0, "creation_date": 1424461765, "post_id": 28594678, "comment_id": 45573692, "body": "THANK YOU for the simple solution! I tweaked the code to fit in my code and it worked perfectly. If you could explain how it works, it would make it even better! I understand up until numeric_limits&lt;streamsize&gt;. Regardless, thank you for the help!"}], "owner": {"reputation": 694, "user_id": 4321774, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XBNKmQRq_NM/AAAAAAAAAAI/AAAAAAAAABE/OAyGYx3aB20/photo.jpg?sz=128", "display_name": "vdelricco", "link": "https://stackoverflow.com/users/4321774/vdelricco"}, "is_accepted": true, "score": 0, "last_activity_date": 1424296766, "last_edit_date": 1495540513, "creation_date": 1424296443, "answer_id": 28594678, "question_id": 28593892, "link": "https://stackoverflow.com/questions/28593892/validating-user-input-of-a-number/28594678#28594678", "title": "Validating user input of a number", "body": "<p>I think you are validating your input incorrectly. Try doing something like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;limits&gt;\n\nint main()\n{\n    int x;\n    std::cin &gt;&gt; x;\n    while(std::cin.fail())\n    {\n        std::cin.clear();\n        std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(),'\\n');\n        std::cout &lt;&lt; \"Bad entry.  Enter a NUMBER: \";\n        std::cin &gt;&gt; x;\n    }\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/19018294/c-to-check-if-user-input-is-a-number-not-a-character-or-a-symbol\">Source</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4521212, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1270211866/picture?type=large", "display_name": "Art Byra", "link": "https://stackoverflow.com/users/4521212/art-byra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 28594678, "answer_count": 1, "score": 0, "last_activity_date": 1424296766, "creation_date": 1424293504, "last_edit_date": 1424294194, "question_id": 28593892, "link": "https://stackoverflow.com/questions/28593892/validating-user-input-of-a-number", "title": "Validating user input of a number", "body": "<p>Trying to create a while loop that will re-ask to enter correct input. In this case, the correct input needs to be a number.  When I test it and put in a non-number answer, it ends the program.  The while loop isn't working.</p>\n\n<pre><code>if (variableQuestionsVf == \"Yes\" || variableQuestionsVf == \"yes\")\n                    {\n                        cout &lt;&lt; \"Input final velocity (in m/s): \" ;\n                        while (cin &gt;&gt; finalVelocity)\n                        {\n                            istringstream s(sVf);\n                            s &gt;&gt; value;\n\n                            if (value &lt;= 0 || value &gt;= 0) //Validating input for final velocity\n                            break;\n\n                            cout &lt;&lt; \"Please enter final velocity (in m/s): \" ;\n                        }\n                    }\n</code></pre>\n\n<p>Is there an easier way?</p>\n"}, {"tags": ["c++", "std", "iostream"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424293501, "post_id": 28593847, "comment_id": 45494327, "body": "What&#39;s wrong with just using the <a href=\"http://en.cppreference.com/w/cpp/io/manip/hex\" rel=\"nofollow noreferrer\">std::hex</a> I/O stream manipulator, instead of rolling your own?"}, {"owner": {"reputation": 231, "user_id": 774432, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5fbf3a7311f0edd6d650364f9a76cd9?s=128&d=identicon&r=PG", "display_name": "JEdot", "link": "https://stackoverflow.com/users/774432/jedot"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424293589, "post_id": 28593847, "comment_id": 45494382, "body": "using <code>_ss &lt;&lt; &quot;0x&quot; &lt;&lt; std::hex &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; (unsigned int)x;</code> give the same result."}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 774432, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5fbf3a7311f0edd6d650364f9a76cd9?s=128&d=identicon&r=PG", "display_name": "JEdot", "link": "https://stackoverflow.com/users/774432/jedot"}, "edited": false, "score": 0, "creation_date": 1424296842, "post_id": 28594449, "comment_id": 45496166, "body": "thanks to pointing it out. I see what&#39;s my error.  But dont see the point of the community about the downvote."}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "reply_to_user": {"reputation": 231, "user_id": 774432, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5fbf3a7311f0edd6d650364f9a76cd9?s=128&d=identicon&r=PG", "display_name": "JEdot", "link": "https://stackoverflow.com/users/774432/jedot"}, "edited": false, "score": 0, "creation_date": 1424297692, "post_id": 28594449, "comment_id": 45496617, "body": "I agree.  Some people are just jerks.  You provided all the relevant information, and it was an interesting problem."}], "owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "is_accepted": true, "score": 1, "last_activity_date": 1424295558, "creation_date": 1424295558, "answer_id": 28594449, "question_id": 28593847, "link": "https://stackoverflow.com/questions/28593847/read-binary-file-translate-bytes-in-base16-format-write-back-in-an-ascii-file/28594449#28594449", "title": "read binary file, translate bytes in base16, format, write back in an ascii file", "body": "<p>A char is not the same data type as an unsigned int.  I think your cast is sign-extending the upper bit of your char ( which is 1) and filling the remaining 24 bits of an unsigned int. This is kludgey, but try masking off the upper bits. I tried this after/before:</p>\n\n<pre><code>char y = 0x90;\n cout &lt;&lt; \"0x\" &lt;&lt; hex &lt;&lt; setw(2) &lt;&lt; setfill('0') &lt;&lt; (unsigned int)(y&amp;0xFF) &lt;&lt; endl;\n cout &lt;&lt; \"0x\" &lt;&lt; hex &lt;&lt; setw(2) &lt;&lt; setfill('0') &lt;&lt; (unsigned int)y &lt;&lt; endl;\n</code></pre>\n\n<p>and got this output:</p>\n\n<p><img src=\"https://i.stack.imgur.com/WrK2o.png\" alt=\"enter image description here\"></p>\n\n<p>The other option is to properly change your data type to an unsigned char also.  Your template call currently has it as a char, not unsigned char. That will also work w/o the masking.</p>\n"}], "owner": {"reputation": 231, "user_id": 774432, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e5fbf3a7311f0edd6d650364f9a76cd9?s=128&d=identicon&r=PG", "display_name": "JEdot", "link": "https://stackoverflow.com/users/774432/jedot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 28594449, "answer_count": 1, "score": -1, "last_activity_date": 1424295558, "creation_date": 1424293333, "question_id": 28593847, "link": "https://stackoverflow.com/questions/28593847/read-binary-file-translate-bytes-in-base16-format-write-back-in-an-ascii-file", "title": "read binary file, translate bytes in base16, format, write back in an ascii file", "body": "<p>Using the following code, I read an executable file and I create a file that will be used to store a variable, a simple <code>C char array</code>. </p>\n\n<pre><code>    ifstream fIn( argv[1], ios::binary );\n    if( !fIn.is_open() )\n        throw (exception(\"Could not open file.\"));\n\n    ofstream fOut( argv[2] );\n    if( !fOut.is_open() )\n        throw (exception(\"Could not create file.\"));\n\n    // def of the C array\n    // name of the variable which will be write in the new file\n    fOut &lt;&lt; \"unsigned char \" &lt;&lt; varName &lt;&lt; \"[] =\\n{\"; // varName = \"foobar\";\n\n    stringstream ss;\n    string s;\n    static char c = 0;\n    // copy each byte in 's'\n    while(fIn.get(c)) s += c;\n    // generate the file\n    fOut &lt;&lt;  for_each(s.begin(), s.end(), hexify&lt;char&gt;(ss));\n    // end of def\n    fOut &lt;&lt; \"\\n};\\n\";\n</code></pre>\n\n<p>The <code>hexify&lt;T&gt; struct</code> body and <code>operator&lt;&lt;</code> used to satisfy my formating needs</p>\n\n<pre><code>    template&lt;typename T&gt; struct hexify \n    {\n        hexify(stringstream&amp; out) : _ss(out), _n(0) {}\n        void operator() (T&amp; x) \n        { \n            if(  _n &gt; 0 )        _ss &lt;&lt; \", \";\n            if( (_n % 16) == 0 ) _ss &lt;&lt; \"\\n\\t\";\n                _ss &lt;&lt; \"0x\" &lt;&lt; setbase(16) &lt;&lt; setw(2) &lt;&lt; setfill('0') &lt;&lt; (unsigned int)x;\n            _n++;\n        }\n        stringstream&amp; _ss;\n        int _n;\n    };\n\n    template&lt;typename T&gt;\n    ostream&amp; operator&lt;&lt;( ostream&amp; os, const hexify&lt;T&gt;&amp; h ) { os &lt;&lt; h._ss.str(); return os; }\n</code></pre>\n\n<p>-</p>\n\n<p>For this situation let me say I read only <strong>the first 4 bytes</strong> of the file and save thoses bytes in a <code>char</code> array <code>foobar[]</code> :</p>\n\n<blockquote>\n  <p>4d5a 9000 0300 0000 0400 0000 ffff 0000</p>\n</blockquote>\n\n<p>The result I expect for the <code>foobar array</code> definition <em>(in the previoulsy created file)</em> should be : </p>\n\n<pre><code> unsigned char foobar[] = { 0x4d, 0x5a, 0x90, 0x00 };\n</code></pre>\n\n<p>The result I obtain myself :</p>\n\n<pre><code> unsigned char foobar[] = { 0x4d, 0x5a, 0xffffff90, 0x00 };\n</code></pre>\n\n<p><strong>Why the third byte is wrapped with 'f' ?</strong></p>\n\n<p>Another example with 112 bytes :</p>\n\n<pre><code>   unsigned char foobar[] =\n   {\n        0x4d, 0x5a, 0xffffff90, 0x00, 0x03, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0xffffffff, 0xffffffff, 0x00, 0x00, \n        0xffffffb8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \n        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfffffff0, 0x00, 0x00, 0x00, \n        0x0e, 0x1f, 0xffffffba, 0x0e, 0x00, 0xffffffb4, 0x09, 0xffffffcd, 0x21, 0xffffffb8, 0x01, 0x4c, 0xffffffcd, 0x21, 0x54, 0x68, \n        0x69, 0x73, 0x20, 0x70, 0x72, 0x6f, 0x67, 0x72, 0x61, 0x6d, 0x20, 0x63, 0x61, 0x6e, 0x6e, 0x6f, \n        0x74, 0x20, 0x62, 0x65, 0x20, 0x72, 0x75, 0x6e, 0x20, 0x69, 0x6e, 0x20, 0x44, 0x4f, 0x53, 0x20\n   };\n</code></pre>\n"}, {"tags": ["c++", "c++11", "stdstring", "iomanip"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1424293460, "post_id": 28593791, "comment_id": 45494300, "body": "Both version are wrong (not taking a ostream&amp;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1424294040, "post_id": 28593791, "comment_id": 45494628, "body": "And as usual:  Be not(!) concerned about optimizations unless you have a performance problem or a flawed algorithm."}, {"owner": {"reputation": 115, "user_id": 2101363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a9f83b23a2d6d8be12cc877fcaa5be?s=128&d=identicon&r=PG", "display_name": "Dmitriy Kumshayev", "link": "https://stackoverflow.com/users/2101363/dmitriy-kumshayev"}, "edited": false, "score": 0, "creation_date": 1424294740, "post_id": 28593791, "comment_id": 45495014, "body": "I fixed typo in my example. Thanks for pointing out. Yes it should be ostream&amp;."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1424295068, "post_id": 28593791, "comment_id": 45495203, "body": "Does your string contain NUL bytes or isn&#39;t guaranteed to be NUL-terminated?  If the answer to both questions is \u201cno\u201d, simply use <code>os &lt;&lt; str</code>."}, {"owner": {"reputation": 115, "user_id": 2101363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a9f83b23a2d6d8be12cc877fcaa5be?s=128&d=identicon&r=PG", "display_name": "Dmitriy Kumshayev", "link": "https://stackoverflow.com/users/2101363/dmitriy-kumshayev"}, "edited": false, "score": 0, "creation_date": 1424295158, "post_id": 28593791, "comment_id": 45495260, "body": "It is not guaranteed to be null-terminated."}, {"owner": {"reputation": 3036, "user_id": 3466415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610a8a95f861678ab9f72ee483d1c1a7?s=128&d=identicon&r=PG&f=1", "display_name": "David K", "link": "https://stackoverflow.com/users/3466415/david-k"}, "edited": false, "score": 0, "creation_date": 1424295696, "post_id": 28593791, "comment_id": 45495554, "body": "First, if the cost of <code>std::string(str,len)</code> is significant in any way then I would question whether it is a good idea to print that string at all, except possibly if this is only going to a data file. Second, I would be wary of <i>other</i> inefficiencies that might crop up in any alternative technique."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424296426, "post_id": 28593791, "comment_id": 45495938, "body": "@DieterL&#252;cking ostreams are slow enough as it is, it seems reasonable to ask how to avoid an extra heap allocation and free which would be associated with a std::string (if the data is too big for SSO)"}], "answers": [{"comments": [{"owner": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "edited": false, "score": 0, "creation_date": 1424295746, "post_id": 28594484, "comment_id": 45495589, "body": "For the sake of completion, you can write a massive hack that invokes a plethora of undefined behavior to get what you&#39;re looking for, but you really shouldn&#39;t."}, {"owner": {"reputation": 115, "user_id": 2101363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a9f83b23a2d6d8be12cc877fcaa5be?s=128&d=identicon&r=PG", "display_name": "Dmitriy Kumshayev", "link": "https://stackoverflow.com/users/2101363/dmitriy-kumshayev"}, "edited": false, "score": 0, "creation_date": 1424355741, "post_id": 28594484, "comment_id": 45521273, "body": "I guess in my case I will need to make these char arrays null-terminanted. Thanks for the answers."}], "owner": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "is_accepted": false, "score": 2, "last_activity_date": 1424296293, "last_edit_date": 1424296293, "creation_date": 1424295699, "answer_id": 28594484, "question_id": 28593791, "link": "https://stackoverflow.com/questions/28593791/send-formatted-char-array-to-ostream-without-extra-memory-copying/28594484#28594484", "title": "Send formatted char array to ostream without extra memory copying", "body": "<p>There's no easy or reasonable way to do this. </p>\n\n<p>The underlying issue is that <code>operator&lt;&lt;(basic_ostream&lt;charT, ...&gt;&amp;, basic_string&lt;charT, ...&gt;)</code> is defined as behaving equivalent to <code>operator&lt;&lt;(basic_ostream&lt;charT, ...&gt;&amp;, const charT*)</code>, which calculates the number of characters to write via <code>basic_ostream&lt;charT, ...&gt;::traits_type::length(str)</code>. There's no possibility of passing in a length with this interface.</p>\n\n<p>If you can re-write it to take <code>char*</code> instead of <code>const char*</code>, you can temporarily set one of the characters to <code>NULL</code> before invoking the formatted output operator, and then reset it to it's original value after.</p>\n\n<p>There was a proposal to add <code>basic_string_view</code>, which would do what you're looking for, but it wasn't included in C++14.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424296457, "post_id": 28594526, "comment_id": 45495954, "body": "is that the same as <code>out.write(str,len);</code> ?"}], "owner": {"reputation": 4175, "user_id": 1082038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEql2.jpg?s=128&g=1", "display_name": "Nevin", "link": "https://stackoverflow.com/users/1082038/nevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1424295867, "creation_date": 1424295867, "answer_id": 28594526, "question_id": 28593791, "link": "https://stackoverflow.com/questions/28593791/send-formatted-char-array-to-ostream-without-extra-memory-copying/28594526#28594526", "title": "Send formatted char array to ostream without extra memory copying", "body": "<p>You could use a <a href=\"http://www.boost.org/doc/libs/1_57_0/libs/range/doc/html/range/reference/utilities/iterator_range.html\" rel=\"nofollow\">boost::iterator_range</a> to stop the copying, as in:</p>\n\n<pre><code>out &lt;&lt; boost::iterator_range&lt;const char*&gt;(str, str + len);\n</code></pre>\n\n<p>I don't think you can affect the formatting, as that is based in the type being inserted into the stream.</p>\n"}], "owner": {"reputation": 115, "user_id": 2101363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a9f83b23a2d6d8be12cc877fcaa5be?s=128&d=identicon&r=PG", "display_name": "Dmitriy Kumshayev", "link": "https://stackoverflow.com/users/2101363/dmitriy-kumshayev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1424296293, "creation_date": 1424293099, "last_edit_date": 1424294692, "question_id": 28593791, "link": "https://stackoverflow.com/questions/28593791/send-formatted-char-array-to-ostream-without-extra-memory-copying", "title": "Send formatted char array to ostream without extra memory copying", "body": "<p>I need to send a char array to ostream. Say I have the following print function:</p>\n\n<p>Version 1:</p>\n\n<pre><code>void print(ostream &amp;out, const char *str, unsigned len)\n{\n    out &lt;&lt; string(str,len);\n}\n</code></pre>\n\n<p>Version 2:</p>\n\n<pre><code>void print(ostream &amp;out, const char *str, unsigned len)\n{\n    out.write(str,len);\n}\n</code></pre>\n\n<p>Both versions above work to a certain extent.\nVersion 1 looks less efficient because it will create an extra string object (causing memory allocation and data copying). </p>\n\n<p>However Version 2 eliminates formatting possibilities. In the following example Version 1 works great (meaning that io manipulator successfully sets width to 10 and applies it to the next output field) :</p>\n\n<pre><code>out &lt;&lt; setw(10);\nprint(out,s,slen);\n</code></pre>\n\n<p>Is there a way to keep functionality as in V1, but without paying extra for allocation/memcopy?</p>\n"}, {"tags": ["c++", "macos", "opencv", "imshow"], "comments": [{"owner": {"reputation": 1138, "user_id": 4481702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3d1996e9e23c213ead478a86b7e780?s=128&d=identicon&r=PG&f=1", "display_name": "Ha Dang", "link": "https://stackoverflow.com/users/4481702/ha-dang"}, "edited": false, "score": 0, "creation_date": 1424294457, "post_id": 28593645, "comment_id": 45494848, "body": "And if you reduce the resolution of the frame, will it be still slow? What is the config of your machine? What do you think might be the cause of your problem?"}, {"owner": {"reputation": 3402, "user_id": 1598485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/61ba944d40ec73b12ff598051cfb47e4?s=128&d=identicon&r=PG", "display_name": "cyriel", "link": "https://stackoverflow.com/users/1598485/cyriel"}, "edited": false, "score": 0, "creation_date": 1424308132, "post_id": 28593645, "comment_id": 45500471, "body": "If you are using debug mode, try to use release mode - sometimes difference in speed is really big."}, {"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "reply_to_user": {"reputation": 3402, "user_id": 1598485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/61ba944d40ec73b12ff598051cfb47e4?s=128&d=identicon&r=PG", "display_name": "cyriel", "link": "https://stackoverflow.com/users/1598485/cyriel"}, "edited": false, "score": 0, "creation_date": 1424311978, "post_id": 28593645, "comment_id": 45501502, "body": "@cyriel, that was a good suggestion. I changed from debug to release, and it did improve the speed, but still not real-time. I am now getting about 10 frames per second instead of 30fps."}, {"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "reply_to_user": {"reputation": 1138, "user_id": 4481702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3d1996e9e23c213ead478a86b7e780?s=128&d=identicon&r=PG&f=1", "display_name": "Ha Dang", "link": "https://stackoverflow.com/users/4481702/ha-dang"}, "edited": false, "score": 0, "creation_date": 1424312513, "post_id": 28593645, "comment_id": 45501637, "body": "@HaDang, I reduced the frame size of the frames in the frame buffer from HD to 860x540 (0.5x, 0.5y) and I am now getting about 20fps, so still not quite real-time. My MacBook Air is 1.7GHz, 2 cores i7, 8GB DDR3, Intel HD Graphics 5000 1536MB, 500GB SSD."}, {"owner": {"reputation": 4898, "user_id": 1348388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y17NZ.png?s=128&g=1", "display_name": "Kornel", "link": "https://stackoverflow.com/users/1348388/kornel"}, "edited": false, "score": 0, "creation_date": 1424351894, "post_id": 28593645, "comment_id": 45518781, "body": "What&#39;s the value of <code>TEST_COUNT</code>? I would suggest setting the delay to 1 ms, because a single sleep (or here <code>waitKey</code>) call will typically block for far longer than a millisecond."}, {"owner": {"reputation": 3402, "user_id": 1598485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/61ba944d40ec73b12ff598051cfb47e4?s=128&d=identicon&r=PG", "display_name": "cyriel", "link": "https://stackoverflow.com/users/1598485/cyriel"}, "edited": false, "score": 0, "creation_date": 1424390287, "post_id": 28593645, "comment_id": 45541500, "body": "What version of OpenCV are you using?"}, {"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "reply_to_user": {"reputation": 3402, "user_id": 1598485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/61ba944d40ec73b12ff598051cfb47e4?s=128&d=identicon&r=PG", "display_name": "cyriel", "link": "https://stackoverflow.com/users/1598485/cyriel"}, "edited": false, "score": 0, "creation_date": 1424447849, "post_id": 28593645, "comment_id": 45566108, "body": "@cyriel, I am using opencv 2.4.9."}, {"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "reply_to_user": {"reputation": 4898, "user_id": 1348388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y17NZ.png?s=128&g=1", "display_name": "Kornel", "link": "https://stackoverflow.com/users/1348388/kornel"}, "edited": false, "score": 0, "creation_date": 1424448080, "post_id": 28593645, "comment_id": 45566248, "body": "@Kornel. The value of TEST_COUNT is 240, and I have already tried waitKey(1). TEST_COUNT is just the video buffer size. I have used a number of different video buffer sizes from 60 to 500. It does not affect the playback speed. I have also tried just reading each frame from a video file and displaying it without any buffer at all. None of this makes any difference to the video playback speed. I can never get real-time performance. My next step is to try a completely different video library to isolate whether the problem is in opencv or the performance of my computer."}, {"owner": {"reputation": 4898, "user_id": 1348388, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y17NZ.png?s=128&g=1", "display_name": "Kornel", "link": "https://stackoverflow.com/users/1348388/kornel"}, "edited": false, "score": 0, "creation_date": 1424688347, "post_id": 28593645, "comment_id": 45637421, "body": "Since the OS has a minimum time between switching threads, the <code>waitKey</code> will not wait exactly <code>delay</code> ms, it will wait at least <code>delay</code> ms, depending on what else is running on your computer at that time, so <code>cv::waitKey(1)</code> will suspend the current thread around 4-5ms. In your case it is 240*(4-5ms) which is equal to 960-1200ms per loop. That&#39;s why your loop runs about 10x slower."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "edited": false, "score": 0, "creation_date": 1424312632, "post_id": 28596328, "comment_id": 45501670, "body": "I have tried to lower waitKey down to 2ms, but it doesn&#39;t help at all. I will try shutting down other processes. I am still confused since many applications can display video in real-time, so this may be an opencv implementation performance issue."}], "owner": {"reputation": 31, "user_id": 3798903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b884fabea7c3ab5c34a994c51c2830?s=128&d=identicon&r=PG&f=1", "display_name": "user3798903", "link": "https://stackoverflow.com/users/3798903/user3798903"}, "is_accepted": false, "score": 0, "last_activity_date": 1424304010, "creation_date": 1424304010, "answer_id": 28596328, "question_id": 28593645, "link": "https://stackoverflow.com/questions/28593645/opencv-imshow-with-waitkey-too-slow-on-mac-os-x-10-10-2-using-c/28596328#28596328", "title": "opencv imshow with waitKey too slow on Mac OS X 10.10.2 (using c++)", "body": "<p>You would have to reduce the input to the function wait key. Try using a lower number in the range of 2-5. It also depends on the other processes you have running simultaneously, try shutting down other processes and see if it improves</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "edited": false, "score": 0, "creation_date": 1426110565, "post_id": 28641569, "comment_id": 46244132, "body": "Thank you for your suggestion. I have reinstalled opencv with the parameters that you recommended. I am seeing video playback at about 1/2 real-time speed, so I am much closer to real-time than I was getting before. For the purpose, of my project, this is sufficient. I still don&#39;t know why it will not run in real-time, but I can&#39;t chase this down any further at this time. Thank you."}, {"owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "edited": false, "score": 0, "creation_date": 1426718877, "post_id": 28641569, "comment_id": 46493809, "body": "Promise not to laugh, but it turns out that my video source material is 60fps, not 30fps. I first I thought that that was why it was running slow, but Cyriel is still correct that my system is just too slow. It can actually play back correctly at 30fps, but it just can&#39;t seem to handle 60fps. I still don&#39;t really know why. Cyriel suggestion to reinstall was a good one, and it helped, but I am still not able to do full HD at 60fps playback. Looks like I may need a more powerful computer."}], "owner": {"reputation": 3402, "user_id": 1598485, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/61ba944d40ec73b12ff598051cfb47e4?s=128&d=identicon&r=PG", "display_name": "cyriel", "link": "https://stackoverflow.com/users/1598485/cyriel"}, "is_accepted": false, "score": 1, "last_activity_date": 1424487429, "creation_date": 1424487429, "answer_id": 28641569, "question_id": 28593645, "link": "https://stackoverflow.com/questions/28593645/opencv-imshow-with-waitkey-too-slow-on-mac-os-x-10-10-2-using-c/28641569#28641569", "title": "opencv imshow with waitKey too slow on Mac OS X 10.10.2 (using c++)", "body": "<p>I could be wrong but for me the problem is not with your code, but with your os/configuration. I've written a small test:</p>\n\n<pre><code>import cv2\nimport numpy as np\nfrom random import randrange\nimg = np.zeros((1920, 1080), dtype = np.uint8)\ncounter = 0\nwhile counter &lt; 1000:\n    cv2.line(img, (randrange(0, 1920), randrange(0, 1080)), (randrange(0, 1920), randrange(0, 1080)), (randrange(0, 255)))\n    cv2.imshow('test', img)\n    temp = cv2.waitKey(1)\n    counter += 1\n    print counter\n</code></pre>\n\n<p>On my machine (Core 2 duo 2,6Ghz x64, 8gb ram, ssd) it took about 30 seconds for this test to complete. Run it and if you will get significantly bigger time than definitelly something is wrong with your laptop/opencv configuration/etc. I've used OpenCV 2.4.x on Mac OS X (it was 10.9 i think) and it was running fine. Reinstalling OpenCV is the most obvious solution which comes to my mind. When you remove OpenCV, use brew to install it again - <code>brew install opencv --with-tbb --with-python --with-ffpmeg</code> (or something similar - check using <code>brew options opencv</code>) should be fine. First options tells brew to build opencv with tbb(thread building block - library for multithreading, sometimes can significantly improve speed), second to install python wrappers, and the last one to install ffmpeg(handle codecs etc).</p>\n"}, {"owner": {"reputation": 4231, "user_id": 2482283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9caab59935b8b776edb86adf1ce7b23b?s=128&d=identicon&r=PG", "display_name": "lbsweek", "link": "https://stackoverflow.com/users/2482283/lbsweek"}, "is_accepted": false, "score": 0, "last_activity_date": 1545309937, "last_edit_date": 1545309937, "creation_date": 1545230182, "answer_id": 53853454, "question_id": 28593645, "link": "https://stackoverflow.com/questions/28593645/opencv-imshow-with-waitkey-too-slow-on-mac-os-x-10-10-2-using-c/53853454#53853454", "title": "opencv imshow with waitKey too slow on Mac OS X 10.10.2 (using c++)", "body": "<p>you can create your own window to show the image. Add MyWindow.m MyWindow.h file to project. </p>\n\n<p>MyWindow.h</p>\n\n<pre><code>#ifndef MY_WINDOW_H\n#define MY_WINDOW_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n    void* createNSWindow(int x, int y, int w, int h);\n    void renderNSWindow(void* inwindow, void* data, int w, int h, int c);\n    void processNSEvent();\n#ifdef __cplusplus\n}\n#endif\n\n#endif\n</code></pre>\n\n<p>usage, in main.cpp, do not forget waitKey</p>\n\n<pre><code>#include \"MyWindow.h\"\n\n// need create a cv window and do nothing\ncv::namedWindow(\"xxx\", 1);\n\n// create window\nvoid* w = createNSWindow(0, 0, 0, 0);\n\n// frame image\ncv::Mat frameImage;\n\n// render loop\nrenderNSWindow(w, frameImage.data, frameImage.cols, frameImage.rows, frameImage.channels());\n\n// need waitKey to display window\nprocessNSEvent();\n</code></pre>\n\n<p>implement, in MyWindow.m, <strong>delete import \"MyWindow.h\"</strong></p>\n\n<pre><code>#import &lt;Cocoa/Cocoa.h&gt;\n\n@interface MyWindow : NSWindow\n@property(nonatomic, strong) NSImageView *imgv;\n@end\n\n@implementation MyWindow\n@end\n\n\nstatic NSImage* _createNSImage(void* data, int w, int h, int c);\n\nvoid* createNSWindow(int x, int y, int w, int h) {\n\n    NSRect screenFrame = [[NSScreen mainScreen] frame];\n    NSRect frame = NSMakeRect(x, y, w, h);\n    if (w == 0 || h == 0) {\n        frame = screenFrame;\n    }\n\n    MyWindow* window  = [[MyWindow alloc] initWithContentRect:frame\n                                                    styleMask:NSWindowStyleMaskBorderless\n                                                      backing:NSBackingStoreBuffered\n                                                        defer:NO] ;\n\n\n    //_initApp(window);\n\n    [window makeKeyAndOrderFront:NSApp];\n    window.titleVisibility = TRUE;\n    window.styleMask = NSWindowStyleMaskResizable | NSWindowStyleMaskTitled |NSWindowStyleMaskFullSizeContentView;\n\n    window.imgv = [[NSImageView alloc] initWithFrame:NSMakeRect(0, 0, frame.size.width, frame.size.height)];\n    [window.contentView addSubview:window.imgv];\n\n\n    return (void*)CFBridgingRetain(window);\n}\n\n\nstatic NSImage* _createNSImage(void* data, int w, int h, int c) {\n\n    size_t bufferLength = w * h * c;\n\n    CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, data, bufferLength, NULL);\n    size_t bitsPerComponent = 8;\n    size_t bitsPerPixel = c * bitsPerComponent;\n    size_t bytesPerRow = c * w;\n    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();\n    CGBitmapInfo bitmapInfo = kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedLast;\n    if (c &lt; 4) {\n        bitmapInfo = kCGBitmapByteOrderDefault | kCGImageAlphaNone;\n        unsigned char* buf = data;\n        for(int i = 0; i &lt; w*h; i++) {\n            unsigned char temp = buf[i*c];\n            buf[i*c] = buf[i*c+c-1];\n            buf[i*c+c-1] = temp;\n        }\n    }\n    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;\n\n    CGImageRef iref = CGImageCreate(w,\n                                    h,\n                                    bitsPerComponent,\n                                    bitsPerPixel,\n                                    bytesPerRow,\n                                    colorSpaceRef,\n                                    bitmapInfo,\n                                    provider,   // data provider\n                                    NULL,       // decode\n                                    YES,        // should interpolate\n                                    renderingIntent);\n\n    NSImage* image = [[NSImage alloc] initWithCGImage:iref size:NSMakeSize(w, h)];\n    return image;\n}\n\nvoid renderNSWindow(void* inwindow, void* data, int w, int h, int c) {\n    MyWindow* window = (__bridge MyWindow*)inwindow;\n\n    window.imgv.image = _createNSImage(data, w, h, c);\n\n}\n\nvoid processNSEvent() {\n    for (;;)\n    {\n        NSEvent* event = [NSApp nextEventMatchingMask:NSEventMaskAny\n                                            untilDate:[NSDate distantPast]\n                                               inMode:NSDefaultRunLoopMode\n                                              dequeue:YES];\n        if (event == nil)\n            break;\n\n        [NSApp sendEvent:event];\n    }\n}\n</code></pre>\n\n<p>other things, the waitKey now take about 20ms, you can do OpenCV in background thread, and show window in main thread. Also use processNSEvent instead of waitKey that only take about 10ms. </p>\n\n<p>full source code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"opencv2/core/core.hpp\"\n#include \"opencv2/highgui/highgui.hpp\"\n#include &lt;dispatch/dispatch.h&gt;\n#include \"MyWindow.h\"\n\n\nusing namespace std;\nusing namespace cv;\n\n\nint opencvfunc(int argc, const char *argv[]);\nbool newFrame = false;\ncv::Mat back_frame;\n\nint main(int argc, const char * argv[]) {\n    cv::namedWindow(\"render\", 1);\n\n    void* w = createNSWindow(0, 0, 0, 0);\n\n    dispatch_queue_t opencvq = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0);\n    dispatch_async(opencvq, ^{\n        opencvfunc(argc, argv);\n    });\n\n\n    while(true) {\n        usleep(3*1000);\n        if(newFrame) {\n            std::chrono::system_clock::time_point starttime = std::chrono::system_clock::now();\n            renderNSWindow(w, back_frame.data, back_frame.cols, back_frame.rows, back_frame.channels());\n            newFrame = false;\n            //auto key = cv::waitKey(1);\n            //if (key == 'q') {\n            //    break;\n            //}\n            processNSEvent();\n            std::chrono::system_clock::time_point endtime = std::chrono::system_clock::now();\n            std::cout &lt;&lt; \"imshow:\" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::duration&lt;double&gt;&gt;(endtime-starttime).count()*1000 &lt;&lt; std::endl;\n        }\n    }\n\n    return 0;\n}\n\nint opencvfunc(int argc, const char *argv[]) {\n\n    cv::VideoCapture cap;\n    cap.open(0);\n    if (!cap.isOpened()) {\n        std::cout &lt;&lt; \"Couldn't open camera 0.\" &lt;&lt; endl;\n        return EXIT_FAILURE;\n    }\n\n    Mat frame, unmodified_frame;\n\n    for (;;) {\n\n        cap &gt;&gt; frame; // get a new frame from camera\n        if (frame.empty()) { // stop if we're at the end of the video\n            break;\n        }\n\n\n        //unmodified_frame = frame.clone();\n\n        // ...\n\n        back_frame = frame.clone();\n        newFrame = true;\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"owner": {"reputation": 4231, "user_id": 2482283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9caab59935b8b776edb86adf1ce7b23b?s=128&d=identicon&r=PG", "display_name": "lbsweek", "link": "https://stackoverflow.com/users/2482283/lbsweek"}, "is_accepted": false, "score": 0, "last_activity_date": 1545548418, "last_edit_date": 1545548418, "creation_date": 1545547557, "answer_id": 53901776, "question_id": 28593645, "link": "https://stackoverflow.com/questions/28593645/opencv-imshow-with-waitkey-too-slow-on-mac-os-x-10-10-2-using-c/53901776#53901776", "title": "opencv imshow with waitKey too slow on Mac OS X 10.10.2 (using c++)", "body": "<p>OpenCV 4 had resolved this issue, please update to new version.</p>\n\n<p>One more thing, process video and show video in two thread.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n\n#include &lt;opencv2/opencv.hpp&gt;\n#include &lt;dispatch/dispatch.h&gt;\n\nusing namespace cv;\nusing namespace std;\n\n\nbool newFrame = false;\nMat back_frame;\n\nint opencvmain(int argc, char** argv ) {\n\n    // open camear\n    cv::VideoCapture cap;\n    cap.open(0);\n    if (!cap.isOpened()) {\n        std::cout &lt;&lt; \"Couldn't open camera 0.\" &lt;&lt; std::endl;\n        return EXIT_FAILURE;\n    }\n\n    // define frame images\n    cv::Mat frame;\n\n    // frame loop\n    for (;;) {\n\n        // get video frame\n        cap &gt;&gt; frame;\n        if (frame.empty()) {\n            break;\n        }\n\n        // render\n        back_frame = frame.clone();\n        newFrame = true;        \n    }\n    return 0;\n}\n\nint main(int argc, char** argv ) {\n\n\n    namedWindow(\"video\", WINDOW_AUTOSIZE );\n\n    dispatch_queue_t opencvq = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0);\n    dispatch_async(opencvq, ^{\n        opencvmain(argc, argv);\n    });\n\n\n    while(true) {\n        usleep(3*1000);\n        if(newFrame) {                \n            imshow(\"video\", back_frame);\n            auto key = cv::waitKey(1);\n            if (key == ' ') {\n                break;\n            }\n            newFrame = false;                \n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4580983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a624edee582c73c4d4bd2220c61c9e60?s=128&d=identicon&r=PG&f=1", "display_name": "radzfoto", "link": "https://stackoverflow.com/users/4580983/radzfoto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6262, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1545548418, "creation_date": 1424292610, "last_edit_date": 1424295578, "question_id": 28593645, "link": "https://stackoverflow.com/questions/28593645/opencv-imshow-with-waitkey-too-slow-on-mac-os-x-10-10-2-using-c", "title": "opencv imshow with waitKey too slow on Mac OS X 10.10.2 (using c++)", "body": "<p>I am using opencv c++ on Mac OS X 10.10.2 to process video frames and display them. The performance of imshow with waitKey to display the video is extremely slow.</p>\n\n<p>I have the following code which displays HD (1920x1080) grayscale frames correctly, except that it runs about 10 times too slow (i.e. 2 to 3 frames per second instead of 30 frames per second).</p>\n\n<pre><code>          cv::Mat framebuf[TEST_COUNT];\n\n    //--- Code here to allocate and fill the frame buffer with about 4 seconds of video. This part works correctly.\n\n        //--- This loop runs too slow by factor of approximately 10x\n    for (int f = 0; f &lt; TEST_COUNT; f++)\n    {\n        cv::imshow(windowName, framebuf[f]);\n        cv::waitKey(33);\n    }\n</code></pre>\n\n<p>Can anyone suggest how to get real-time or near real-time performance from opencv imshow()? I have seen many posts that state that they are displaying video in real-time or even faster than real-time, so I am not sure what I am doing wrong. Any help would be greatly appreciated.</p>\n"}, {"tags": ["c++", "casting"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424292827, "post_id": 28593635, "comment_id": 45493935, "body": "According to the documentation, it requires a &quot;pointer to an array of vertex buffers&quot;. Therefore, if you have one, a pointer to that one is enough. What you&#39;re trying to do now is relatable to <code>void foo(int arr[3]); foo(5);</code>."}, {"owner": {"reputation": 347, "user_id": 2359879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3f675292839a2c69f5f0be5a33a45105?s=128&d=identicon&r=PG", "display_name": "413X", "link": "https://stackoverflow.com/users/2359879/413x"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424293619, "post_id": 28593635, "comment_id": 45494402, "body": "I guess that makes sense. But still unsure how to use that information as all my attemps still fails :P"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1424293812, "post_id": 28593635, "comment_id": 45494518, "body": "Assuming <code>GetBuffer</code> doesn&#39;t return a reference, you&#39;d have to create a separate variable to hold it in order to get the address of that variable and treat it like an array of one element."}, {"owner": {"reputation": 347, "user_id": 2359879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3f675292839a2c69f5f0be5a33a45105?s=128&d=identicon&r=PG", "display_name": "413X", "link": "https://stackoverflow.com/users/2359879/413x"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424295591, "post_id": 28593635, "comment_id": 45495493, "body": "As I understand it now. GetBuffer() returns a pointer to an object that doesnt really exists. By assigning it to another object. We can use that adress into the function; like so: ID3D11Buffer* uglyTemp = this-&gt;mVertexBuffer.GetBuffer(); \t_deviceContext-&gt;IASetVertexBuffers(0, 1, &amp;uglyTemp, &amp;stride, &amp;offset);"}, {"owner": {"reputation": 347, "user_id": 2359879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3f675292839a2c69f5f0be5a33a45105?s=128&d=identicon&r=PG", "display_name": "413X", "link": "https://stackoverflow.com/users/2359879/413x"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424295627, "post_id": 28593635, "comment_id": 45495512, "body": "Urgh.... Im just going to an Apply function or something, that just looks horrid"}], "owner": {"reputation": 347, "user_id": 2359879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3f675292839a2c69f5f0be5a33a45105?s=128&d=identicon&r=PG", "display_name": "413X", "link": "https://stackoverflow.com/users/2359879/413x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424292580, "creation_date": 1424292580, "question_id": 28593635, "link": "https://stackoverflow.com/questions/28593635/convert-ptr-to-ptr-const", "title": "Convert ptr* to ptr* const*", "body": "<p>I currently have this error; \nerror C2664: cannot convert parameter 3 from 'ID3D11Buffer *' to 'ID3D11Buffer *const *'</p>\n\n<p>Code line;</p>\n\n<pre><code>_deviceContext-&gt;IASetVertexBuffers(0, 1, this-&gt;mVertexBuffer.GetBuffer(), &amp;stride, &amp;offset);\n</code></pre>\n\n<p>this->mVertexBuffer.GetBuffer() returns ID3D11Buffer*, a pointer that Im unable to make it fit. Tried a bunch of methods but the answer eludes me, help anyone?</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1424291963, "post_id": 28593406, "comment_id": 45493455, "body": "If the functor passed as <code>F</code> doesn&#39;t fit your requirements of having 2 arguments, then your compiler will let you know.  That is what you want to have, and that is the compiler stopping the user from giving you an improper function."}, {"owner": {"reputation": 25, "user_id": 4109401, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b_f-iIsZosU/AAAAAAAAAAI/AAAAAAAAAB0/9NFlY1v74Vg/photo.jpg?sz=128", "display_name": "airbender", "link": "https://stackoverflow.com/users/4109401/airbender"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1424292044, "post_id": 28593406, "comment_id": 45493505, "body": "I did not define f there, how does the compiler know I need 2 arguments exactly."}, {"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1424292064, "post_id": 28593406, "comment_id": 45493522, "body": "Is it ok to use <a href=\"http://www.cplusplus.com/reference/functional/function/\" rel=\"nofollow noreferrer\">C++11</a>?"}, {"owner": {"reputation": 25, "user_id": 4109401, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b_f-iIsZosU/AAAAAAAAAAI/AAAAAAAAAB0/9NFlY1v74Vg/photo.jpg?sz=128", "display_name": "airbender", "link": "https://stackoverflow.com/users/4109401/airbender"}, "edited": false, "score": 0, "creation_date": 1424292109, "post_id": 28593406, "comment_id": 45493550, "body": "how please tell me thanks!"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1424292117, "post_id": 28593406, "comment_id": 45493555, "body": "Implement your usage of <code>F</code>.  In the usage, you will write it expecting 2 arguments.  When the compiler sees that the (bad) functor is only suitable for one argument, you get the compiler error.  In other words, don&#39;t worry about it.  Let the compiler do the detection work for you."}, {"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1424292118, "post_id": 28593406, "comment_id": 45493557, "body": "The assumption is that the implementation of <code>insert</code> will involve calling the <code>f</code> parameter with two arguments, which won&#39;t compile unless <code>f</code> is a function of two arguments."}, {"owner": {"reputation": 25, "user_id": 4109401, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b_f-iIsZosU/AAAAAAAAAAI/AAAAAAAAAB0/9NFlY1v74Vg/photo.jpg?sz=128", "display_name": "airbender", "link": "https://stackoverflow.com/users/4109401/airbender"}, "edited": false, "score": 0, "creation_date": 1424292314, "post_id": 28593406, "comment_id": 45493669, "body": "thanks, another question then the definition of the class involves two templates, is it usual way to do that? What will you do when realizing a similar question."}, {"owner": {"reputation": 8029, "user_id": 3137499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7acff2bbbdb9c51ea478377a0f6dcb03?s=128&d=identicon&r=PG&f=1", "display_name": "aruisdante", "link": "https://stackoverflow.com/users/3137499/aruisdante"}, "edited": false, "score": 0, "creation_date": 1424292490, "post_id": 28593406, "comment_id": 45493754, "body": "Please don&#39;t chain questions, ask new questions instead. But yes, it&#39;s perfectly reasonable for a class to have many template parameters."}], "answers": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "is_accepted": false, "score": 0, "last_activity_date": 1424292872, "creation_date": 1424292872, "answer_id": 28593726, "question_id": 28593406, "link": "https://stackoverflow.com/questions/28593406/template-used-in-class-involving-a-generic-comparison-function/28593726#28593726", "title": "template used in class involving a generic comparison function", "body": "<p>A functor is a struct providing one or more overloads of operator (), which makes it a choice if you have several comparisons:</p>\n\n<pre><code>// Having a struct X { K key, V value };\nstruct Less {\n    template &lt;typename K, typename V&gt;\n    operator bool () (const X&lt;K, V&gt;&amp; a, const X&lt;K, V&gt;&amp; b&gt; const { \n        return a.key &lt; b.key;\n    }\n    template &lt;typename K, typename V&gt;\n    operator bool () (const X&lt;K, V&gt;&amp; a, const K&amp; b&gt; const { \n        return a.key &lt; b;\n    }\n    template &lt;typename K, typename V&gt;\n    operator bool () (const K&amp; a, const X&lt;K, V&gt;&amp; b&gt; const { \n        return a &lt; b.key;\n    }\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4109401, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b_f-iIsZosU/AAAAAAAAAAI/AAAAAAAAAB0/9NFlY1v74Vg/photo.jpg?sz=128", "display_name": "airbender", "link": "https://stackoverflow.com/users/4109401/airbender"}, "edited": false, "score": 0, "creation_date": 1424293978, "post_id": 28593917, "comment_id": 45494596, "body": "could you also share some way to use functor rather than function pointer here? since I have finished a course in C which does function pointer a lot. thanks"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "reply_to_user": {"reputation": 25, "user_id": 4109401, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b_f-iIsZosU/AAAAAAAAAAI/AAAAAAAAAB0/9NFlY1v74Vg/photo.jpg?sz=128", "display_name": "airbender", "link": "https://stackoverflow.com/users/4109401/airbender"}, "edited": false, "score": 0, "creation_date": 1424294595, "post_id": 28593917, "comment_id": 45494930, "body": "@airbender Added links to show compilation results when using a function object."}], "owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1424294569, "last_edit_date": 1424294569, "creation_date": 1424293599, "answer_id": 28593917, "question_id": 28593406, "link": "https://stackoverflow.com/questions/28593406/template-used-in-class-involving-a-generic-comparison-function/28593917#28593917", "title": "template used in class involving a generic comparison function", "body": "<p>You should implement your class and the <code>insert</code> function, assuming whatever is passed is correct in terms of the number of arguments.  If the number of arguments is not 2, the compiler will let you know.</p>\n\n<p>This is the desired effect in these cases.  Let the compiler detect that the function is not valid, and thus the user has to change the function to the correct requirements.</p>\n\n<p>A demonstration using your code would be this:</p>\n\n<pre><code>#include &lt;vector&gt;\n\ntemplate &lt;class T, class F&gt;\nclass Bheap\n{\npublic:\n    Bheap(int allocateSize) {}\n    void insert(T value, F f)\n    {\n        f(value, value);\n    }\n    void getMax();\nprivate:\n    int sizeUsed;\n    int allocateSize;\n    std::vector&lt;T&gt; myBheap;\n};\n\nvoid SomeFunction(int, int)\n{}\n\nint main()\n{\n    typedef void (*fn)(int, int);\n    Bheap&lt;int, fn&gt; b(10);\n    b.insert(10, SomeFunction);\n}\n</code></pre>\n\n<p>You will see that this compiles and links correctly (I used a function pointer, but a functor with an overloaded <code>operator()</code> would also suffice).</p>\n\n<p>Now if the user's function is changed to one that takes 1 argument, we get a different scenario:</p>\n\n<pre><code>#include &lt;vector&gt;\n\ntemplate &lt;class T, class F&gt;\nclass Bheap\n{\npublic:\n    Bheap(int allocateSize) {}\n    void insert(T value, F f)\n    {\n        f(value, value);\n    }\n    void getMax();\nprivate:\n    int sizeUsed;\n    int allocateSize;\n    std::vector&lt;T&gt; myBheap;\n};\n\nvoid SomeFunction(int)\n{}\n\nint main()\n{\n    typedef void (*fn)(int);\n    Bheap&lt;int, fn&gt; b(10);\n    b.insert(10, SomeFunction);\n}\n</code></pre>\n\n<p>The invalid function will make your class fail to compile.  Since your template requires a 2 argument function, passing a 1 argument function via pointer causes the error (which you can see here: <a href=\"http://ideone.com/rT7RRa\" rel=\"nofollow\">http://ideone.com/rT7RRa</a>)</p>\n\n<hr>\n\n<p>For function objects, here is an example of successful compilation:</p>\n\n<p><a href=\"http://ideone.com/yvWD5o\" rel=\"nofollow\">http://ideone.com/yvWD5o</a></p>\n\n<p>For unsuccessful compilation:</p>\n\n<p><a href=\"http://ideone.com/yjeAWB\" rel=\"nofollow\">http://ideone.com/yjeAWB</a></p>\n"}], "owner": {"reputation": 25, "user_id": 4109401, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b_f-iIsZosU/AAAAAAAAAAI/AAAAAAAAAB0/9NFlY1v74Vg/photo.jpg?sz=128", "display_name": "airbender", "link": "https://stackoverflow.com/users/4109401/airbender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 28593917, "answer_count": 2, "score": 0, "last_activity_date": 1424294569, "creation_date": 1424291734, "question_id": 28593406, "link": "https://stackoverflow.com/questions/28593406/template-used-in-class-involving-a-generic-comparison-function", "title": "template used in class involving a generic comparison function", "body": "<p>I am trying to write a Bheap in templates and the insert function involving a generic comparison function. What is the usual way to do this? I know how to use function pointer in C. But Is there any typical C++ way to do that?</p>\n\n<p>Someone told the first one, which class F could represent anything any function. But I want this function to be a comparison function which like f(T,T). While the second guy say something about the functors</p>\n\n<pre><code>  template &lt;class T, class F&gt;class Bheap\n{\npublic:\n    Bheap&lt;T&gt;(int allocateSize);\n    void insert(T value, F f);\n    void getMax();\nprivate:\n    int sizeUsed;\n    int allocateSize;\n    vector&lt;T&gt; myBheap;\n};\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424289736, "post_id": 28592798, "comment_id": 45492166, "body": "The chart at the top of this page should be helpful: <a href=\"http://en.cppreference.com/w/cpp/language/operator_incdec\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/operator_incdec</a>"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 2, "creation_date": 1424290469, "post_id": 28592798, "comment_id": 45492585, "body": "Why would you want such an operator for a table class? Operator overloading is supposed to make code easier to read. What does it mean to &quot;increment&quot; or &quot;advance&quot; a table? And will your code readers be familiar with this interpretation?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424290546, "post_id": 28592798, "comment_id": 45492635, "body": "@ChristianHackl I will change the class name later. It is internally a linked list."}, {"owner": {"reputation": 5811, "user_id": 2726734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkA2E.jpg?s=128&g=1", "display_name": "ryanpattison", "link": "https://stackoverflow.com/users/2726734/ryanpattison"}, "edited": false, "score": 0, "creation_date": 1424290633, "post_id": 28592798, "comment_id": 45492689, "body": "you may want to use pre-increment to avoid unnecessarily copying the iterator."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 2, "creation_date": 1424290649, "post_id": 28592798, "comment_id": 45492707, "body": "@iharob: That has the same problem. It is easy to picture a list iterator being advanced, but certainly not the list itself. As a matter of fact, <code>std::list</code> does not have a <code>++</code> operator, but its iterators do."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424290718, "post_id": 28592798, "comment_id": 45492736, "body": "@ChristianHackl yes, immediately after fixing this problem, I am learning how to write an iterator. If you can give any help, a link to a good resource it will be appreciated."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424290880, "post_id": 28592798, "comment_id": 45492826, "body": "@iharob: <a href=\"http://stackoverflow.com/q/8054273/845092\">How to implement an STL-style iterator and avoid common pitfalls?</a>"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424290890, "post_id": 28592798, "comment_id": 45492834, "body": "@iharob: While learning how to write iterators is certainly a good thing to do, all I wanted to point out here is that you might use operator overloading for the wrong purpose."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424291003, "post_id": 28592798, "comment_id": 45492896, "body": "@ChristianHackl I understood that. Thanks for the feedback."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1424289844, "post_id": 28592842, "comment_id": 45492235, "body": "Very very simple... :) And of course, there had to be a way to diferentiate the two. I just didn&#39;t find anything, the link posted by @chris explains it very well."}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1424290248, "post_id": 28592842, "comment_id": 45492478, "body": "@iharob: You are not to blame for getting this wrong. In my opinion, it is the worst design decision in all of the vast C++ language."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 3, "creation_date": 1424290348, "post_id": 28592842, "comment_id": 45492522, "body": "@TonyK agree I would prefer something like <code>Class::++operator()</code> and <code>Class::operator++()</code> it would be more obvious."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1424290988, "post_id": 28592842, "comment_id": 45492888, "body": "@iharob: Or have the <code>operator++(int)</code> be compiler generated when you implement <code>operator++</code>."}], "owner": {"reputation": 15025, "user_id": 862351, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c7ac8ffed3327e80c6b77651ba30b83e?s=128&d=identicon&r=PG", "display_name": "Pradhan", "link": "https://stackoverflow.com/users/862351/pradhan"}, "is_accepted": true, "score": 11, "last_activity_date": 1424290283, "last_edit_date": 1424290283, "creation_date": 1424289772, "answer_id": 28592842, "question_id": 28592798, "link": "https://stackoverflow.com/questions/28592798/i-have-problems-implementing-the-increment-operator/28592842#28592842", "title": "I have problems implementing the ++ increment operator", "body": "<p><code>operator++()</code> is the prefix increment operator. Implement the postfix operator as <code>operator++(int)</code>.</p>\n\n<p>The canonical implementations are have the prefix operator return a reference and the postfix operator return by value. Also, you would typically implement the postfix operator in terms of the prefix operator in the interests of least surprise and easy maintenance. Example:</p>\n\n<pre><code>struct T\n{\n T&amp; operator++()\n {\n  this-&gt;increment();\n  return *this;\n }\n\n T operator++(int)\n {\n   T ret = *this;\n   this-&gt;operator++();\n   return ret;\n }\n};\n</code></pre>\n\n<p>(<a href=\"http://en.cppreference.com/w/cpp/language/operator_incdec\" rel=\"noreferrer\">Increment/decrement operators at cppreference.</a>)</p>\n"}], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4357, "favorite_count": 1, "closed_date": 1424290910, "accepted_answer_id": 28592842, "answer_count": 1, "score": 0, "last_activity_date": 1424290283, "creation_date": 1424289630, "question_id": 28592798, "link": "https://stackoverflow.com/questions/28592798/i-have-problems-implementing-the-increment-operator", "closed_reason": "Duplicate", "title": "I have problems implementing the ++ increment operator", "body": "<p>I am trying to provide a c++ interface for a c library I just finished, and I want it to be possible to write</p>\n\n<pre><code>for (DBITable table = db.tables() ; table != NULL ; table++)\n</code></pre>\n\n<p>where <code>db</code> is a class with a <code>tables()</code> method that returns the <code>DBITable</code> associated with it.</p>\n\n<p>On compilation I get the following error with <code>clang++</code>\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>error: cannot increment value of type 'DBITable'\nfor (DBITable table = db.tables() ; table != NULL ; table++)\n                                                    ~~~~~^\n</code></pre>\n\n<p>This is how i have implemented the <code>++</code> operator overload method\n</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>DBITable\nDBITable::operator++()\n{\n    return next();\n}\n</code></pre>\n\n<p>and it's declared in the <code>DBITable</code> class as</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>public:\n    DBITable operator++();\n</code></pre>\n\n<p>the <code>table != NULL</code> part worked as I expected by doing this </p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>bool operator!=(void *) \n{\n    // evaluate and get the value\n    return value;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "optimization", "compiler-optimization"], "comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 4, "creation_date": 1424289658, "post_id": 28592721, "comment_id": 45492107, "body": "so there are some serious issues with your benchmark programs. That will break anything you&#39;re trying to test anyway. Most notably you&#39;re mixing types and have type coersion going on which is VERY expensive in and of itself (and could be what your friend was referring to). Also there is nothing here a compiler can&#39;t calculate at compile time."}, {"owner": {"reputation": 192274, "user_id": 36565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ccfec45e3fba785daf0e89a797c9216?s=128&d=identicon&r=PG", "display_name": "David Rodr&#237;guez - dribeas", "link": "https://stackoverflow.com/users/36565/david-rodr%c3%adguez-dribeas"}, "edited": false, "score": 5, "creation_date": 1424289843, "post_id": 28592721, "comment_id": 45492234, "body": "<code>n = i * 0.5;</code> promotes <code>i</code> to <code>double</code>, multplies by .5 and converts back to <code>float</code>. <code>n = i &#47; 2;</code> divides (probably shifts) <code>i</code> by 2, then converts to double. You are not testing multiply vs. divide, but unrelated operations."}, {"owner": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 1, "creation_date": 1424289855, "post_id": 28592721, "comment_id": 45492243, "body": "If you want your &quot;benchmarks&quot; to not get optimized away, try accumulating the result within each iteration in the <code>s</code> variable. Then print the final value of <code>s</code> after you&#39;ve made the timing calculation."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 1, "creation_date": 1424290209, "post_id": 28592721, "comment_id": 45492453, "body": "To add to David&#39;s correct point: even if you did <code>i &#47; 2.0</code> and <code>i * 0.5</code>, the compiler is not (legally) allowed to optimize the divide into a multiplication. <a href=\"http://stackoverflow.com/questions/6430448/why-doesnt-gcc-optimize-aaaaaa-to-aaaaaa\">Floating point operations need to be performed as specified</a>. (although you might be able to argue that <code>2.0</code> and <code>0.5</code> are both perfectly representable by IEEE-754, so the compiler <i>might</i> be able to do this optimization in this specific case, but in general it can&#39;t)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1424290318, "post_id": 28592721, "comment_id": 45492511, "body": "I seriously doubt you are getting <i>&quot;1,000,000,000 calculations per microsecond!&quot;</i>"}, {"owner": {"reputation": 1836, "user_id": 351861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540239cb3a1089fcb53aae8abea1cfdd?s=128&d=identicon&r=PG&f=1", "display_name": "specializt", "link": "https://stackoverflow.com/users/351861/specializt"}, "edited": false, "score": 0, "creation_date": 1424290621, "post_id": 28592721, "comment_id": 45492681, "body": "to explain your friends attempt : multiplication is ALWAYS faster than division - BUT since modern hardware is massively optimized and has dedicated circuits for different purposes --- together with MANY OS-optimizations of various kind its pretty much impossible to make a statement about arithmetic speed, you can only measure it - and the results will never be general results, they will ALWAYS be specific ones, benchmarks for your current hardware &amp; software. The exact same testing-method WILL yield different results on different machines, even contradicting ones. Its only theory, not reality"}, {"owner": {"reputation": 1061, "user_id": 2529423, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oQkBi.png?s=128&g=1", "display_name": "thephpdev", "link": "https://stackoverflow.com/users/2529423/thephpdev"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1424291059, "post_id": 28592721, "comment_id": 45492915, "body": "@Mgetz, I agree. I&#39;ve rewritten it. How&#39;s that?"}, {"owner": {"reputation": 1061, "user_id": 2529423, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oQkBi.png?s=128&g=1", "display_name": "thephpdev", "link": "https://stackoverflow.com/users/2529423/thephpdev"}, "reply_to_user": {"reputation": 99973, "user_id": 241631, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6099f76a0c24b09ca71f3e25eea7ce65?s=128&d=identicon&r=PG", "display_name": "Praetorian", "link": "https://stackoverflow.com/users/241631/praetorian"}, "edited": false, "score": 0, "creation_date": 1424291088, "post_id": 28592721, "comment_id": 45492931, "body": "@Praetorian, done. See edit."}, {"owner": {"reputation": 1061, "user_id": 2529423, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oQkBi.png?s=128&g=1", "display_name": "thephpdev", "link": "https://stackoverflow.com/users/2529423/thephpdev"}, "reply_to_user": {"reputation": 1836, "user_id": 351861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540239cb3a1089fcb53aae8abea1cfdd?s=128&d=identicon&r=PG&f=1", "display_name": "specializt", "link": "https://stackoverflow.com/users/351861/specializt"}, "edited": false, "score": 0, "creation_date": 1424291125, "post_id": 28592721, "comment_id": 45492949, "body": "@specializt, check latest edit,."}, {"owner": {"reputation": 3993, "user_id": 125405, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/71e57d309c0a11cc78732e82e3486f3e?s=128&d=identicon&r=PG", "display_name": "wolfPack88", "link": "https://stackoverflow.com/users/125405/wolfpack88"}, "edited": false, "score": 5, "creation_date": 1424291162, "post_id": 28592721, "comment_id": 45492969, "body": "@thephpdev: Don&#39;t completely change the question after you&#39;ve gotten answers. Ask a new question; otherwise you invalidate the answers already given."}, {"owner": {"reputation": 1061, "user_id": 2529423, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oQkBi.png?s=128&g=1", "display_name": "thephpdev", "link": "https://stackoverflow.com/users/2529423/thephpdev"}, "reply_to_user": {"reputation": 3993, "user_id": 125405, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/71e57d309c0a11cc78732e82e3486f3e?s=128&d=identicon&r=PG", "display_name": "wolfPack88", "link": "https://stackoverflow.com/users/125405/wolfpack88"}, "edited": false, "score": 0, "creation_date": 1424291222, "post_id": 28592721, "comment_id": 45493009, "body": "@wolfPack88, will do. Apologies."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1424291970, "post_id": 28592721, "comment_id": 45493457, "body": "<a href=\"http://coliru.stacked-crooked.com/a/ba74dc83a98bde77\" rel=\"nofollow noreferrer\">Fixed sandbox app that explores the issue</a>"}, {"owner": {"reputation": 1130, "user_id": 3494492, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/j7gkb.png?s=128&g=1", "display_name": "kiwixz", "link": "https://stackoverflow.com/users/3494492/kiwixz"}, "edited": false, "score": 0, "creation_date": 1424292478, "post_id": 28592721, "comment_id": 45493748, "body": "Anyway <code>*2</code> is <code>&lt;&lt;1</code> and <code>&#47;2</code> is <code>&gt;&gt;1</code>..."}, {"owner": {"reputation": 1836, "user_id": 351861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540239cb3a1089fcb53aae8abea1cfdd?s=128&d=identicon&r=PG&f=1", "display_name": "specializt", "link": "https://stackoverflow.com/users/351861/specializt"}, "edited": false, "score": 0, "creation_date": 1424292692, "post_id": 28592721, "comment_id": 45493868, "body": "i dont see how your edit changes the fact that digital multiplication is always faster than division if measured for the exact same, non-specialized, arithmetic circuit ..."}, {"owner": {"reputation": 3681, "user_id": 2817371, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/fafb901e8d840c703f4a5089692427ad?s=128&d=identicon&r=PG&f=1", "display_name": "Red Alert", "link": "https://stackoverflow.com/users/2817371/red-alert"}, "edited": false, "score": 0, "creation_date": 1424293763, "post_id": 28592721, "comment_id": 45494487, "body": "If you compile with <code>-ffast-math</code>, gcc will favor fast operations over strict adherence to the standard. Substituting division with a reciprocal approximation should be one such optimization."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 2413844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZKPJF.png?s=128&g=1", "display_name": "dwn", "link": "https://stackoverflow.com/users/2413844/dwn"}, "edited": false, "score": 0, "creation_date": 1424290293, "post_id": 28592795, "comment_id": 45492500, "body": "Just to be clear, I think @wolfPack88 is saying basically all your code evaluates is &#39;(float)((m-1)&gt;&gt;1)&#39;. You should probably look at the asm."}, {"owner": {"reputation": 3993, "user_id": 125405, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/71e57d309c0a11cc78732e82e3486f3e?s=128&d=identicon&r=PG", "display_name": "wolfPack88", "link": "https://stackoverflow.com/users/125405/wolfpack88"}, "reply_to_user": {"reputation": 523, "user_id": 2413844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZKPJF.png?s=128&g=1", "display_name": "dwn", "link": "https://stackoverflow.com/users/2413844/dwn"}, "edited": false, "score": 2, "creation_date": 1424290493, "post_id": 28592795, "comment_id": 45492599, "body": "@dwn: No, look at the third code block (the one he timed with and without optimization). He has a loop that calculates something 1000000 times, but the calculation is exactly the same. The compiler is smart enough to notice that, and calculate it only once (perhaps even at compile time), leaving the executable with very little to do."}, {"owner": {"reputation": 523, "user_id": 2413844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZKPJF.png?s=128&g=1", "display_name": "dwn", "link": "https://stackoverflow.com/users/2413844/dwn"}, "edited": false, "score": 0, "creation_date": 1424290638, "post_id": 28592795, "comment_id": 45492699, "body": "Oh, then I think I disagree; the variable &#39;n&#39; is never referenced in the loop, so it is probably just ignored."}, {"owner": {"reputation": 3993, "user_id": 125405, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/71e57d309c0a11cc78732e82e3486f3e?s=128&d=identicon&r=PG", "display_name": "wolfPack88", "link": "https://stackoverflow.com/users/125405/wolfpack88"}, "reply_to_user": {"reputation": 523, "user_id": 2413844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZKPJF.png?s=128&g=1", "display_name": "dwn", "link": "https://stackoverflow.com/users/2413844/dwn"}, "edited": false, "score": 0, "creation_date": 1424290746, "post_id": 28592795, "comment_id": 45492751, "body": "@dwn: That&#39;s more or less what I said... the compiler is smart enough to recognize that things aren&#39;t being used, and it gets optimized away. That&#39;s how optimization can have such a large effect."}, {"owner": {"reputation": 523, "user_id": 2413844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZKPJF.png?s=128&g=1", "display_name": "dwn", "link": "https://stackoverflow.com/users/2413844/dwn"}, "edited": false, "score": 0, "creation_date": 1424290786, "post_id": 28592795, "comment_id": 45492776, "body": "@woldPack88 Okay, sounds like we agree more or less"}, {"owner": {"reputation": 1061, "user_id": 2529423, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oQkBi.png?s=128&g=1", "display_name": "thephpdev", "link": "https://stackoverflow.com/users/2529423/thephpdev"}, "edited": false, "score": 0, "creation_date": 1424291191, "post_id": 28592795, "comment_id": 45492990, "body": "OK, it appears that was happening."}], "owner": {"reputation": 3993, "user_id": 125405, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/71e57d309c0a11cc78732e82e3486f3e?s=128&d=identicon&r=PG", "display_name": "wolfPack88", "link": "https://stackoverflow.com/users/125405/wolfpack88"}, "is_accepted": true, "score": 19, "last_activity_date": 1424289628, "creation_date": 1424289628, "answer_id": 28592795, "question_id": 28592721, "link": "https://stackoverflow.com/questions/28592721/1-000-000-000-calculations-per-microsecond/28592795#28592795", "title": "1,000,000,000 calculations per microsecond?", "body": "<p>Since the code doesn't do anything differently in each iteration of the loop, the compiler is free to move the code within the loop outside (the result will be exactly the same), and remove the loop entirely, leaving you with an almost 0 run-time, as you saw.</p>\n"}, {"owner": {"reputation": 7120, "user_id": 168610, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JGCpk.png?s=128&g=1", "display_name": "davbryn", "link": "https://stackoverflow.com/users/168610/davbryn"}, "is_accepted": false, "score": 5, "last_activity_date": 1424289896, "creation_date": 1424289896, "answer_id": 28592876, "question_id": 28592721, "link": "https://stackoverflow.com/questions/28592721/1-000-000-000-calculations-per-microsecond/28592876#28592876", "title": "1,000,000,000 calculations per microsecond?", "body": "<pre><code>for (i = 0; i &lt; m; i++)\n{\n    //  make it a trivial pure float calculation with no int casting to float\n    n = 11.1 * 0.53;\n    o = n * 0.53;\n    p = o * 0.53;\n    q = p * 0.53;\n    r = q * 0.53;\n    s = r * 0.53;\n}\n</code></pre>\n\n<p>is a loop that does not reference <code>i</code> or <code>m</code> and contains no circular references so it is trivial for the compiler to remove the looping statement</p>\n"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 5, "last_activity_date": 1424766811, "last_edit_date": 1424766811, "creation_date": 1424765717, "answer_id": 28690939, "question_id": 28592721, "link": "https://stackoverflow.com/questions/28592721/1-000-000-000-calculations-per-microsecond/28690939#28690939", "title": "1,000,000,000 calculations per microsecond?", "body": "<p>This is a good example of how benchmarking a high level language is even harder than benchmarking assembly (which is hard enough to get right already). The compiler can, and often will, interfere with your benchmark.</p>\n\n<p>Your friend has a point, a division (<em>actual</em> division, not just writing <code>/</code> in C) is slower than a multiplication. For doubles, the ratio is about 4 for the latency, and division isn't pipelined whereas multiplication is, so the throughput ratio is much worse: around 20. (these numbers are for Haswell, but are typical)</p>\n\n<p>Integer division is slower than floating point division, but using floating point multiplication on integer causes two conversions. The conversions aren't too bad, so in total, the floating point multiplication is still faster.</p>\n\n<p>But any proper compiler will turn integer division by a constant into integer multiplication and a shift, and maybe some extra fix-up stuff (depending on the divisor and the type). Division by a power of two is even simpler. For details, see <a href=\"https://gmplib.org/~tege/divcnst-pldi94.pdf\" rel=\"noreferrer\">Division by Invariant Integers using Multiplication</a>. As an example, consider</p>\n\n<pre><code>int div2(int i)\n{\n    return i / 2;\n}\n</code></pre>\n\n<p>GCC turns this into</p>\n\n<pre><code>mov eax, edi\nshr eax, 31\nadd eax, edi\nsar eax\nret\n</code></pre>\n\n<p>Which depending on the \u00b5arch, would take 3 or 4 cycles (excluding control flow).</p>\n\n<p>On the other hand,</p>\n\n<pre><code>int div2(int i)\n{\n    return i * 0.5;\n}\n</code></pre>\n\n<p>Is turned into</p>\n\n<pre><code>    cvtsi2sd    xmm0, edi\n    mulsd   xmm0, QWORD PTR .LC0[rip]\n    cvttsd2si   eax, xmm0\n    ret\n.LC0:\n    .long   0\n    .long   1071644672\n</code></pre>\n\n<p>Which would take about 4+5+4 = 13 cycles.</p>\n\n<p>A compiler is also allowed to turn <code>f / 2.0</code> into <code>f * 0.5</code> even without any \"unsafe optimizations\", division by a <em>power of two</em> is equivalent to multiplication by its inverse. That does not hold for numbers that are not a power of two.</p>\n\n<p>So even with a benchmark that at least measured <em>something</em>, it probably wouldn't have measured the right thing. In order to measure the latency floating point division vs multiplication, you could write something like:</p>\n\n<pre><code>.section data\nalign 16\none: dq 1.0, 1.0\n.section text\n_bench1:\n  mov ecx, -10000000\n  movapd xmm0, [one]\nloopone:\n  mulpd xmm0, xmm0\n  mulpd xmm0, xmm0\n  add ecx, 1\n  jnz loopone\n  ret\n_bench2:\n  mov ecx, -10000000\n  movapd xmm0, [one]\nlooptwo:\n  divpd xmm0, xmm0\n  divpd xmm0, xmm0\n  add ecx, 1\n  jnz looptwo\n  ret\n</code></pre>\n\n<p>Call both a thousand, wrapped in <code>rdtsc</code> to get the time. Take the lowest time for both. Multiply the time by the ratio between your base clock and turbo clock. Then you should have (approximately) the number of cycles both loops take, divide by 20000000 to get the number of cycles per <code>mulpd</code> or <code>divpd</code>. The time division takes depends on the values being divided, so it doesn't give the most general result.</p>\n\n<p>You may also be interested in a <a href=\"http://www.agner.org/optimize/instruction_tables.pdf\" rel=\"noreferrer\">list of instruction latencies and throughputs</a>.</p>\n"}], "owner": {"reputation": 1061, "user_id": 2529423, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/oQkBi.png?s=128&g=1", "display_name": "thephpdev", "link": "https://stackoverflow.com/users/2529423/thephpdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1607, "favorite_count": 2, "accepted_answer_id": 28592795, "answer_count": 3, "score": 12, "last_activity_date": 1424766811, "creation_date": 1424289387, "last_edit_date": 1424291127, "question_id": 28592721, "link": "https://stackoverflow.com/questions/28592721/1-000-000-000-calculations-per-microsecond", "title": "1,000,000,000 calculations per microsecond?", "body": "<p>OK, I've been talking to a friend about compilers and optimisation of programs, and he suggested that <code>n * 0.5</code> is faster than <code>n / 2</code>. I said that compilers do that kind of optimisation automatically, so I wrote a small program to see if there was a difference between <code>n / 2</code> and <code>n * 0.5</code>:</p>\n\n<p>Division:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(int argc, const char * argv[]) {\n    int i, m;\n    float n, s;\n    clock_t t;\n\n    m = 1000000000;\n    t = clock();\n    for(i = 0; i &lt; m; i++) {\n        n = i / 2;\n    }\n    s = (float)(clock() - t) / CLOCKS_PER_SEC;\n\n    printf(\"n = i / 2: %d calculations took %f seconds (last calculation = %f)\\n\", m, s, n);\n\n    return 0;\n}\n</code></pre>\n\n<p>Multiplication:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(int argc, const char * argv[]) {\n    int i, m;\n    float n, s;\n    clock_t t;\n\n    m = 1000000000;\n    t = clock();\n    for(i = 0; i &lt; m; i++) {\n        n = i * 0.5;\n    }\n    s = (float)(clock() - t) / CLOCKS_PER_SEC;\n\n    printf(\"n = i * 0.5: %d calculations took %f seconds (last calculation = %f)\\n\", m, s, n);\n\n    return 0;\n}\n</code></pre>\n\n<p>And for both versions I got 0.000002s avg. when compiled with <code>clang main.c -O1</code>. And he said there must be something wrong with the time measurement. So he then wrote a program:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n\nusing namespace std;\n\nint main()\n{\n    clock_t ts, te;\n    double  dT;\n\n    int i, m;\n    double n, o, p, q, r, s;\n    m = 1000000000;\n\n    cout &lt;&lt; \"Independent calculations:\\n\";\n    ts = clock();\n    for (i = 0; i &lt; m; i++)\n    {\n        //  make it a trivial pure float calculation with no int casting to float\n        n = 11.1 / 2.3;\n        o = 22.2 / 2.3;\n        p = 33.3 / 2.3;\n        q = 44.4 / 2.3;\n        r = 55.5 / 2.3;\n        s = 66.6 / 2.3;\n    }\n\n    te = clock();\n    dT = ((float)(te - ts)) / CLOCKS_PER_SEC;   //  make initial call to get the elapsed time to run the loop\n    ts = clock();\n\n    printf(\"Division: %d calculations took %f seconds\\n\", m, dT);\n\n    for (i = 0; i &lt; m; i++)\n    {\n        //  make it a trivial pure float calculation with no int casting to float\n        n = 11.1 * 0.53;\n        o = 22.2 * 0.53;\n        p = 33.3 * 0.53;\n        q = 44.4 * 0.53;\n        r = 55.5 * 0.53;\n        s = 66.6 * 0.53;\n    }\n\n    te = clock();\n    dT = ((float)(te - ts)) / CLOCKS_PER_SEC;   //  make initial call to get the elapsed time to run the loop\n    ts = clock();\n\n    printf(\"Multiplication: %d calculations took %f seconds\\n\", m, dT);\n\n    cout &lt;&lt; \"\\nDependent calculations:\\n\";\n    for (i = 0; i &lt; m; i++)\n    {\n        //  make it a trivial pure float calculation with no int casting to float\n        n = 11.1 / 2.3;\n        o = n / 2.3;\n        p = o / 2.3;\n        q = p / 2.3;\n        r = q / 2.3;\n        s = r / 2.3;\n    }\n\n\n    te = clock();\n    dT = ((float)(te - ts)) / CLOCKS_PER_SEC;   //  make initial call to get the elapsed time to run the loop\n    ts = clock();\n\n    printf(\"Division: %d calculations took %f seconds\\n\", m, dT);\n\n    for (i = 0; i &lt; m; i++)\n    {\n        //  make it a trivial pure float calculation with no int casting to float\n        n = 11.1 * 0.53;\n        o = n * 0.53;\n        p = o * 0.53;\n        q = p * 0.53;\n        r = q * 0.53;\n        s = r * 0.53;\n    }\n\n\n    te = clock();\n    dT = ((float)(te - ts)) / CLOCKS_PER_SEC;   //  make initial call to get the elapsed time to run the loop\n    ts = clock();\n\n    printf(\"Multiplication: %d calculations took %f seconds\\n\", m, dT);\n\n    return 0;\n}\n</code></pre>\n\n<p>And for that he got...</p>\n\n<pre><code>1.869570s\n1.868254s\n25.674016s\n3.497555s\n</code></pre>\n\n<p>...in that order.</p>\n\n<p>So I ran the program on my machine compiled with <code>clang++ main.cpp -O1</code> and I got similar results as before: <code>0.000002 to 0.000011</code>.</p>\n\n<p>However, when I compiled the program without optimisation, I got similar results to him on his first test. So my question is, how can any amount of optimisation make the program <em>that</em> much faster?</p>\n"}, {"tags": ["c++", "templates", "c++11", "template-meta-programming"], "comments": [{"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 3, "creation_date": 1424289494, "post_id": 28592704, "comment_id": 45492000, "body": "Why is templating the container not an option? That&#39;s the canonical way in C++."}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1424289764, "post_id": 28592704, "comment_id": 45492183, "body": "Because the question is about storing different typed data in one class, instead of having as many classes as many different T exist. This Container class is just an simple example to illustrate what i want to do"}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 1, "creation_date": 1424290011, "post_id": 28592704, "comment_id": 45492339, "body": "Seems you need boost::any or if your space of variation is less than everything then boost::variant&lt;type1,type2,etc&gt;"}, {"owner": {"reputation": 12855, "user_id": 754456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496c29be59a54e53f43c79d5f9b9b380?s=128&d=identicon&r=PG", "display_name": "mfitzp", "link": "https://stackoverflow.com/users/754456/mfitzp"}, "edited": false, "score": 1, "creation_date": 1424290204, "post_id": 28592704, "comment_id": 45492450, "body": "It may be helpful if you add your current &quot;inelegant&quot; solution (borgs, etc.) so it&#39;s possible to see exactly what you&#39;re trying to achieve."}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 12855, "user_id": 754456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496c29be59a54e53f43c79d5f9b9b380?s=128&d=identicon&r=PG", "display_name": "mfitzp", "link": "https://stackoverflow.com/users/754456/mfitzp"}, "edited": false, "score": 0, "creation_date": 1424290710, "post_id": 28592704, "comment_id": 45492732, "body": "@mfitzp Yes, i am working on it, obviosly i wasn&#39;t very clear in the question"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1424291024, "post_id": 28592704, "comment_id": 45492899, "body": "Please post a <a href=\"http://stackoverflow.com/help/mcve\">mcve</a> that describes what you want to happen.  Demonstrate how you want your class to be used, what results you want, and what results you get with your current non-working attempt."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1424291546, "post_id": 28592704, "comment_id": 45493204, "body": "@Goldseeker <i>&quot;Woking on it!&quot;</i> Do that prior asking next time please!"}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1424296251, "post_id": 28592704, "comment_id": 45495846, "body": "@Yakk  Edited question, it should be much clearer now"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424297630, "post_id": 28592704, "comment_id": 45496579, "body": "The top question is about storing and retrieving a <code>T*</code>, but then all the later code stores a <code>std::function&lt;T*()&gt;</code> and retrieves a <code>T*</code>.  Which is it that you want?"}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424298340, "post_id": 28592704, "comment_id": 45496947, "body": "@Mooing Duck there is little to none difference, solution for the first one will be pretty much the same as the solution for the second one"}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1424341622, "post_id": 28592704, "comment_id": 45512731, "body": "@JonathanWakely borg pattern or monostate pattern, is a singletone-like pattern. With singletone you can construct only one instance of an object, and with borg you can have as many instances as you want, but all borg instances work with the same static data."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1424353793, "post_id": 28592704, "comment_id": 45520067, "body": "OK, that&#39;s Monostate ... I haven&#39;t come across the alternative name, and don&#39;t think it&#39;s a good idea to use two different names for the same pattern, it defeats the point of using a common  vocabulary to talk about the pattern."}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1424354955, "post_id": 28592704, "comment_id": 45520752, "body": "@JonathanWakely I came to know it as borg, so i used that name. Actually google gives ~2500 results for &quot;borg pattern&quot; query and ~1400 result for &quot;monostate pattern&quot;, so, arguably, borg is even more  commonly used than monostate. Anyway, that is offtopic."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 0, "creation_date": 1424290564, "post_id": 28592819, "comment_id": 45492648, "body": "Obviosly i intend for user to specify type for Get, and i do not what the behavior where Get returns last item set, what i want to to is for Get&lt;int&gt; return data that was set with last Set&lt;int&gt; call"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 3, "creation_date": 1424290931, "post_id": 28592819, "comment_id": 45492860, "body": "@Goldseeker no, that was not obvious."}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1424340508, "post_id": 28592819, "comment_id": 45512006, "body": "No, it wasn&#39;t obvious. Maybe if you&#39;d included the example in your original question, instead of some vague references to &quot;borgs&quot; it would have been clearer. Anyway, my answer still applies: use <code>any</code>"}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1424343001, "post_id": 28592819, "comment_id": 45513510, "body": "@JonathanWakely, you misunderstood my question. I know how to accomplish what i want using <code>void*</code>, <code>any</code> and/or RTTI, what i wanted is a solution that somehow uses templates to do it during compile-time, @Yakk explained to me why it is not possible in his answer"}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "edited": false, "score": 0, "creation_date": 1424353634, "post_id": 28592819, "comment_id": 45519949, "body": "As I said above, &quot;Templates (and the return type of functions) are static, compile-time properties. What you stored last in an object is a dynamic property.&quot; That&#39;s still true if you remove the word &quot;last&quot;. And &quot;the call to Set might be in a different translation unit not visible to the compiler&quot;. Apparently you misunderstood my answer too, because it was still relevant  :)"}], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": false, "score": 1, "last_activity_date": 1424290143, "last_edit_date": 1424290143, "creation_date": 1424289691, "answer_id": 28592819, "question_id": 28592704, "link": "https://stackoverflow.com/questions/28592704/sharing-data-of-template-type-between-2-template-functions/28592819#28592819", "title": "Sharing data of template type between 2 template functions", "body": "<p>If you just want to be able to call <code>c.Get()</code> and have it return whatever was stored last, that's not possible.</p>\n\n<blockquote>\n  <p>Maybe i'm overestimating metaprogramming capabilities of C++</p>\n</blockquote>\n\n<p>Not overestimating, you're confusing them for something they are not. </p>\n\n<p>Templates (and the return type of functions) are static, compile-time properties. What you stored last in an object is a dynamic property.</p>\n\n<p>The return type of <code>Get</code> must be known at compile-time, which would require the compiler to statically-analyze the rest of the program to determine what the last call to <code>Set</code> was and what type it stored. That's not possible in the general case, the call to <code>Set</code> might be in a different translation unit not visible to the compiler, or you could do:</p>\n\n<pre><code>Container c;\nint i = 1;\nstd::string s = \"two\";\nif (rand() % 2)\n  c.Set(&amp;i);\nelse\n  c.Set(&amp;s);\nauto res = c.Get();  // What is the type here?\n</code></pre>\n\n<p>If making the container a template is not an option you'll need to write the code yourself to dynamically store any type (look into \"type erasure\") and then either</p>\n\n<ul>\n<li>have <code>Get</code> return something \"un-typed\" like <code>void*</code> or <code>std::experimental::any</code> or <code>boost::any</code> and require the user to cast back to the original type; or</li>\n<li>require the user to call <code>Get&lt;int&gt;()</code> so they specify the type and have the container do the casting.</li>\n</ul>\n\n<p>For example, using <code>std::experimental::any</code> to perform the type erasure and casting looks like this:</p>\n\n<pre><code>class Container\n{\n    std::experimental::any m_data;\n\npublic:\n    template&lt;class T&gt; void Set(T* data)\n    {\n        m_data = std::experimental::any(data);\n    }\n\n    template&lt;class T&gt; T* Get()\n    {\n        return std::experimental::any_cast&lt;T*&gt;(m_data)\n    }\n};\n\nContainer c;\nint i = 1;\nc.Set(&amp;i);\nint* pi = c.Get&lt;int&gt;();\nstd::string s = \"two\";\nc.Set(&amp;s);\nstd::string* ps = c.Get&lt;std::string*&gt;();\n// this will return a null pointer:\npi = c.Get&lt;int*&gt;();\n</code></pre>\n\n<p>(N.B. this doesn't really give you any advantage over using <code>any</code> directly, but maybe you want to add other functionality so the <code>Container</code> type would make sense.)</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 0, "creation_date": 1424290798, "post_id": 28592992, "comment_id": 45492783, "body": "Actually that is very close to what i want to do, but obviosly  i need to automagically compose the list of types for data to derive from"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1424291559, "post_id": 28592992, "comment_id": 45493217, "body": "You may use <code>std::tuple</code> and <code>std::get&lt;T&gt;</code> instead of <code>Data</code>."}], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1424290307, "creation_date": 1424290307, "answer_id": 28592992, "question_id": 28592704, "link": "https://stackoverflow.com/questions/28592704/sharing-data-of-template-type-between-2-template-functions/28592992#28592992", "title": "Sharing data of template type between 2 template functions", "body": "<p>Not quite what you are looking for but hopefully the following code gives you some ideas.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Container\n{\n   public:\n\n    template&lt;class T&gt; void Set(T data)\n    {\n       static_cast&lt;Datum&lt;T&gt;&amp;&gt;(data_).datum = data;\n    }\n\n    template&lt;class T&gt; T Get() const\n    {\n       return static_cast&lt;Datum&lt;T&gt; const&amp;&gt;(data_).datum;\n    }\n\n   private:\n\n    template &lt;typename T&gt;\n    struct Datum\n    {\n       T datum;\n    };\n\n    struct Data : Datum&lt;int&gt;,\n                  Datum&lt;float&gt;,\n                  Datum&lt;double&gt;\n   {\n   };\n\n    Data data_;\n};\n\nint main()\n{\n   Container c;\n   c.Set(10);\n   c.Set(20.125f);\n   c.Set(30.7890);\n\n   std::cout &lt;&lt; c.Get&lt;int&gt;() &lt;&lt; std::endl;\n   std::cout &lt;&lt; c.Get&lt;float&gt;() &lt;&lt; std::endl;\n   std::cout &lt;&lt; c.Get&lt;double&gt;() &lt;&lt; std::endl;\n\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 0, "creation_date": 1424296119, "post_id": 28593449, "comment_id": 45495780, "body": "I actually like this approach, but in my situation there will be much more types in Args, so it will be very inconvenient for the user to specify so many types when creating Container."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 1, "creation_date": 1424298643, "post_id": 28593449, "comment_id": 45497082, "body": "@Goldseeker: sounds like you just want to use <code>boost::any</code> <i>instead</i> of <code>Container</code>."}], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 2, "last_activity_date": 1424291939, "creation_date": 1424291939, "answer_id": 28593449, "question_id": 28592704, "link": "https://stackoverflow.com/questions/28592704/sharing-data-of-template-type-between-2-template-functions/28593449#28593449", "title": "Sharing data of template type between 2 template functions", "body": "<p>Similarly to R.Sahu's answer but using <code>std::tuple</code> (requires C++14, but can be done in C++11)</p>\n\n<pre><code>template&lt;typename ... Args&gt;\nclass Container\n{\npublic:\n    template&lt;class T&gt; void Set(const T&amp; value)\n    {\n        std::get&lt;T&gt;(data) = value;\n    }\n\n    template&lt;class T&gt; const T&amp; Get() const\n    {\n       return std::get&lt;T&gt;(data);\n    }\n\nprivate:\n    std::tuple&lt;Args...&gt; data;\n};\n\nint main()\n{\n   Container&lt;int, float, double&gt; c;\n   c.Set(10);\n   c.Set(20.125f);\n   c.Set(30.7890);\n\n   std::cout &lt;&lt; c.Get&lt;int&gt;() &lt;&lt; std::endl;\n   std::cout &lt;&lt; c.Get&lt;float&gt;() &lt;&lt; std::endl;\n   std::cout &lt;&lt; c.Get&lt;double&gt;() &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/2397a48598d5b300\" rel=\"nofollow\">Live example</a></p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 0, "creation_date": 1424298248, "post_id": 28594819, "comment_id": 45496901, "body": "I have considered solution with typeid(not as fancy as yours, but the idea was the same), but it really bums me out to use RTTI when the data is clearly known in compile-time(with simple code generation i could have created a list of all the types used with Get or Set and used solution akin to the one Jaron42 proposed). I will continue to look for better solution. Anyway, thank you for trying to help."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 1, "creation_date": 1424298773, "post_id": 28594819, "comment_id": 45497123, "body": "@Goldseeker I think I see your problem.  You think that the compiler knows what types are used for a given instance at compile time.  The compiler only sees what happens within a given translation unit (cpp file), while objects of a given type can live in more than one.  In one translation unit stores an <code>int</code>, that data cannot be communicated to other translation units.  The <code>sizeof</code> an instance of <code>Container</code> cannot be a function of how it or its members are used.  So <code>Container</code> needs to either dynamically grow (see above <code>typeindex</code> solution), or the data cannot be stored there."}, {"owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "edited": false, "score": 0, "creation_date": 1424299160, "post_id": 28594819, "comment_id": 45497319, "body": "Ah yes, thank you! That is exactly what my problem was. How i could have missed that. Now i know for sure that it cannot be done as i imagined and can move one to runtime solutions. I will mark you answer as accepted."}], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": true, "score": 3, "last_activity_date": 1424297000, "creation_date": 1424297000, "answer_id": 28594819, "question_id": 28592704, "link": "https://stackoverflow.com/questions/28592704/sharing-data-of-template-type-between-2-template-functions/28594819#28594819", "title": "Sharing data of template type between 2 template functions", "body": "<p>So there are a few parts.  First, looking up runtime data based off a type.  <code>std::type_index</code> solves this problem for you together with <code>typeid</code> operator.</p>\n\n<p>The second part is storing data of an unknown type.  <code>std::experimental::any</code> does this.</p>\n\n<p>The third part would be to wrap it up so you don't have to think about it.</p>\n\n<pre><code>struct poly_storage {\n  std::unordered_map&lt; std::type_index, std::experimental::any &gt; data;\n  template&lt;class T, class...Args&gt; void store( Args&amp;&amp;... args ) {\n    auto it = data.find(typeid(T));\n    if (it == data.end()) {\n      data.emplace(\n        std::make_pair( typeid(T), T{std::forward&lt;Args&gt;(args)...} )\n      );\n    } else {\n      data[typeid(T)] = T{ std::forward&lt;Args&gt;(args)... };\n    }\n  }\n  template&lt;class T&gt;\n  T* get() {\n    auto it = data.find(typeid(T));\n    if (it == data.end()) return nullptr;\n    return std::any_cast&lt;T&gt;(&amp;(it-&gt;second));\n  }\n  template&lt;class T&gt;\n  T const* get() const {\n    auto it = data.find(typeid(T));\n    if (it == data.end()) return nullptr;\n    return std::any_cast&lt;T&gt;(&amp;(it-&gt;second));\n  }\n};\n</code></pre>\n\n<p><code>poly_storage.store&lt;T&gt;( blah )</code> stores <code>blah</code> under the key of <code>T</code> as a <code>T</code>.</p>\n\n<p><code>poly_storage.get&lt;T&gt;()</code> returns a <code>T*</code> that is <code>nullptr</code> if the get failed.  It also supports <code>const</code> access.</p>\n\n<p><code>any</code> is basically a type-safe <code>void*</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 4581076, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MT_hFZ0uzGs/AAAAAAAAAAI/AAAAAAAAAPI/asGlVTivnxs/photo.jpg?sz=128", "display_name": "Goldseeker", "link": "https://stackoverflow.com/users/4581076/goldseeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 28594819, "answer_count": 4, "score": 1, "last_activity_date": 1424297000, "creation_date": 1424289332, "last_edit_date": 1424296304, "question_id": 28592704, "link": "https://stackoverflow.com/questions/28592704/sharing-data-of-template-type-between-2-template-functions", "title": "Sharing data of template type between 2 template functions", "body": "<p>Maybe I'm overestimating the metaprogramming capabilities of C++, but I expected to be able to create a class that acts as follows:</p>\n\n<pre><code>class Container\n{\n    template&lt;class T&gt; void Set(T* data)\n    {\n        //Store data somewhere\n    }\n\n    template&lt;class T&gt; T* Get()\n    {\n        //Return the data saved for T object\n    }\n};\n</code></pre>\n\n<p>Note: Templating Container itself is not an option.</p>\n\n<p>If C++ allowed for template fields it would have been really simple, but instead I am resorting to an ugly technique that involves borgs, static variables in functions and passing <code>this</code> to distinguish between templated data for different instances of example.</p>\n\n<p>I would really like a more elegant solution.</p>\n\n<p>EDIT:\nHere is an example of what i currently use(it is still a bit simplified version to make the point clearer)</p>\n\n<p>Container.h</p>\n\n<pre><code>#include &lt;functional&gt;\n#include &lt;map&gt;\nusing namespace std;\ntemplate&lt;class T&gt;\nclass FactoryContainer\n{\npublic:\n    function&lt;T*()&gt; GetFactoryForContainerInstance(void* container)\n    {\n        return FactoryContainer&lt;T&gt;::factories[container];\n    };\n\n    void SetFactoryForContainerInstance(void* container, function&lt;T*()&gt; factory)\n    {\n        FactoryContainer&lt;T&gt;::factories[container] = factory;\n    };\n\nprivate:\n    static map&lt;void*, function&lt;T*()&gt; &gt; factories;\n};\n\ntemplate&lt;class T&gt;\nmap&lt;void*, function&lt;T*()&gt; &gt; FactoryContainer&lt;T&gt;::factories = map&lt;void*, function&lt;T*()&gt;&gt; ();\n\nclass Container\n{\npublic:\n    template&lt;class T&gt; void Register(function&lt;T*()&gt; factory)\n    {\n        SetFactory&lt;T&gt;(factory);\n    };\n    template&lt;class T&gt; T* Resolve()\n    {\n        return GetFactory&lt;T&gt;()();\n    };\n\nprivate:\n    template&lt;class T&gt;\n    function&lt;T*()&gt; GetFactory()\n    {\n        return FactoryContainer&lt;T&gt;().GetFactoryForContainerInstance(this);\n    };\n\n    template&lt;class T&gt;\n    void  SetFactory(function&lt;T*()&gt; factory)\n    {\n        FactoryContainer&lt;T&gt;().SetFactoryForContainerInstance(this, factory);\n    };\n};\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;functional&gt;\n#include \"Container.h\"\nusing namespace std;\nvoid main()\n{\n    std::cout &lt;&lt; \"And thus it has began\" &lt;&lt; std::endl;\n\n    Container c;\n    function&lt;int*()&gt; foo = [] () { return new int(1);};\n    c.Register&lt;int&gt;(foo);\n    int* i = c.Resolve&lt;int&gt;();\n    std::cout &lt;&lt; *i  &lt;&lt; std::endl; // prints 1\n    delete i;\n    function&lt;string*()&gt; foo2 = [] () { return new string(\"I hope it is clear now!\");};\n    c.Register&lt;string&gt;(foo2);\n    string* s = c.Resolve&lt;string&gt;();\n    std::cout &lt;&lt; *c.Resolve&lt;string&gt;() &lt;&lt; std::endl; // prints I hope it is clear now!\n    delete s;\n    Container c2;\n    try\n    {\n        string* s2 = c2.Resolve&lt;string&gt;();\n    }\n    catch (...)\n    {\n        std::cout &lt;&lt; \"Exception caught, yay!\" &lt;&lt; std::endl; // exception is intended as there was no registrations on c2,\n                                                            //that is why passing void* is needed in implementation\n    }\n\n}\n</code></pre>\n\n<p>What i would like to be able to do is to avoid using <code>FactoryContainer</code> borg.</p>\n\n<p>That is my first question on SO, so please cut me some slack.\nThank you!</p>\n"}, {"tags": ["c++", "opencv"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1424289418, "post_id": 28592672, "comment_id": 45491945, "body": "You need to convert the values in the string to actual integers before adding them to your vector. See <code>std::stoi</code>."}, {"owner": {"reputation": 1276, "user_id": 1810440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ceb12b1be9323851b0d28a2847093e97?s=128&d=identicon&r=PG", "display_name": "Peter Goldsborough", "link": "https://stackoverflow.com/users/1810440/peter-goldsborough"}, "edited": false, "score": 0, "creation_date": 1424289676, "post_id": 28592672, "comment_id": 45492116, "body": "You&#39;re trying to pass an unsigned char* to a vector of unsigned chars. Those don&#39;t convert."}, {"owner": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "reply_to_user": {"reputation": 1276, "user_id": 1810440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ceb12b1be9323851b0d28a2847093e97?s=128&d=identicon&r=PG", "display_name": "Peter Goldsborough", "link": "https://stackoverflow.com/users/1810440/peter-goldsborough"}, "edited": false, "score": 0, "creation_date": 1424289796, "post_id": 28592672, "comment_id": 45492202, "body": "@PeterGoldsborough: How can I fix that?"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1424330197, "post_id": 28592672, "comment_id": 45506803, "body": "Just one more note: Whenever you think you need <code>new something[..]</code>, you should try <code>vector&lt;something&gt;</code> first. It&#39;s much easier to handle, in particular you avoid the memory leak in the code above."}, {"owner": {"reputation": 1276, "user_id": 1810440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ceb12b1be9323851b0d28a2847093e97?s=128&d=identicon&r=PG", "display_name": "Peter Goldsborough", "link": "https://stackoverflow.com/users/1810440/peter-goldsborough"}, "edited": false, "score": 0, "creation_date": 1424344843, "post_id": 28592672, "comment_id": 45514652, "body": "Same goes for char pointers and std::string. These containers were created to make interaction with primitive types easier and less error prone. On another note, if any of these answers solved your problem, please mark the appropriate one as accepted by clicking the tick next to it."}], "answers": [{"owner": {"reputation": 1276, "user_id": 1810440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ceb12b1be9323851b0d28a2847093e97?s=128&d=identicon&r=PG", "display_name": "Peter Goldsborough", "link": "https://stackoverflow.com/users/1810440/peter-goldsborough"}, "is_accepted": true, "score": 0, "last_activity_date": 1424292263, "last_edit_date": 1424292263, "creation_date": 1424290073, "answer_id": 28592930, "question_id": 28592672, "link": "https://stackoverflow.com/questions/28592672/conversion-error-from-string-to-unsigned-char/28592930#28592930", "title": "Conversion error from string to unsigned char", "body": "<p>\"Error Reference to type 'const value_type' (aka 'const unsigned char') could not bind to an lvalue of type 'unsigned char *'\"</p>\n\n<p>You have a vector of unsigned chars, whose <code>push_back()</code> method only takes unsigned chars, whereas you are trying to push back an unsigned char <em>pointer</em>. If you really need to use unsigned char * and can't just use <code>std::string</code>, your colors vector will have to be <code>std::vector&lt;unsigned char*&gt;</code>.</p>\n\n<p>Assuming Vec3B only accepts <code>std::vector&lt;unsigned char*&gt;</code>, I'd actually be inclined to use std::string till the very end, at which point you can call <code>std::string::c_str</code> to get a null terminated string.</p>\n\n<p>Like so:</p>\n\n<pre><code>std::ifstream myfile(\"DedicatedColors.txt\");\n\nstd::string line;\n\nstd::vector&lt;Vec3b&gt; origColors;\n\nif (myfile.is_open())\n{\n    while (std::getline(myfile,line))\n    {\n        std::vector&lt;std::string&gt; colors;\n\n        std::string::const_iterator last, itr;\n\n        last = itr = line.begin();\n\n        while (std::find(itr, line.end(), ',') != line.end())\n        {\n            colors.push_back(std::string(last, itr));\n\n            last = itr++;\n        }\n\n        dedColors.push_back(Vec3b(colors[0].c_str(),colors[1].c_str(),colors[2].c_str()));\n    }\n}\n</code></pre>\n\n<p>EDIT: I actually just noticed that you might be trying to convert the RGB values to unsigned chars and not actually use the string as you are now. </p>\n\n<p>Then, have an <code>std::vector&lt;unsigned char&gt;</code> instead of <code>std::vector&lt;std::string&gt;</code> and use <code>std::stoi</code> to convert the RGB values you get as an <code>std::string</code> from <code>std::getline</code> to an int, and then pass them like this:</p>\n\n<p><code>colors.push_back(std::stoi(std::string(last, itr)));</code></p>\n"}, {"owner": {"reputation": 316, "user_id": 4521999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdcf3793b1e71197f4a08cf854a1e173?s=128&d=identicon&r=PG&f=1", "display_name": "homeless", "link": "https://stackoverflow.com/users/4521999/homeless"}, "is_accepted": false, "score": 0, "last_activity_date": 1424294342, "creation_date": 1424294342, "answer_id": 28594116, "question_id": 28592672, "link": "https://stackoverflow.com/questions/28592672/conversion-error-from-string-to-unsigned-char/28594116#28594116", "title": "Conversion error from string to unsigned char", "body": "<p>As already pointed out, you are trying to <code>push_back</code> an <code>unsigned char*</code> into a vector which only accepts <code>unsigned char</code> on the following line:</p>\n\n\n\n<pre><code>colors.push_back(val);\n</code></pre>\n\n<p>If you have access to the boost library, you can try the following code (not tested):</p>\n\n \n\n<pre><code>#include &lt;boost/lexical_cast.hpp&gt;\n// ... &lt;your code&gt; ...\nwhile (getline(myfile, line)) {\n    vector&lt;string&gt; colors;\n    boost::split(line, colors, boost::is_any_of(','));\n    dedColors.push_back(Vec3b(boost::lexical_cast&lt;uchar&gt;(colors[0]),\n                              boost::lexical_cast&lt;uchar&gt;(colors[1]),\n                              boost::lexical_cast&lt;uchar&gt;(colors[2])));\n}\n// ... &lt;continue with your code&gt; ...\n</code></pre>\n"}], "owner": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 28592930, "answer_count": 2, "score": 0, "last_activity_date": 1424294342, "creation_date": 1424289236, "question_id": 28592672, "link": "https://stackoverflow.com/questions/28592672/conversion-error-from-string-to-unsigned-char", "title": "Conversion error from string to unsigned char", "body": "<p>I am working on opencv. I am reading color values(in the form: 123,32,123) from a text file. I need to insert these values into vector(Vec3b)origColors. Below is my code.</p>\n\n<pre><code>ifstream myfile;\nstring line;\nstring delimiter = \",\";\nstring temp;\nvector&lt;uchar&gt; colors;\nvector&lt;Vec3b&gt; origColors;\nmyfile.open(\"DedicatedColors.txt\");\nif (myfile.is_open())\n{\n    while ( getline (myfile,line) )\n    {\n        while(line.find(\",\",0) != string::npos)\n        {\n            size_t pos = line.find(\",\",0);\n            temp = line.substr(0, pos);\n            line.erase(0,pos+1);\n            unsigned char* val=new unsigned char[temp.size() + 1]();\n            copy(temp.begin(), temp.end(), val);\n            colors.push_back(val); //Error Reference to type 'const value_type' (aka 'const unsigned char') could not bind to an lvalue of type 'unsigned char *'\n        }\n        dedColors.push_back(Vec3b(colors[0],colors[1],colors[2]));\n        colors.clear();\n    }\n    myfile.close();\n}\n</code></pre>\n\n<p>Could someone please help me fix this code? Thanks in advance. </p>\n"}, {"tags": ["c++", "opencv", "windows-runtime", "windows-phone-8.1"], "comments": [{"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1424289314, "post_id": 28592640, "comment_id": 45491871, "body": "please clarify: c++, not c# ?"}, {"owner": {"reputation": 73, "user_id": 4220334, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68c7995e2f2b8f89bc1418462f0f7986?s=128&d=identicon&r=PG&f=1", "display_name": "Fa\u010dko", "link": "https://stackoverflow.com/users/4220334/fa%c4%8dko"}, "reply_to_user": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1424289464, "post_id": 28592640, "comment_id": 45491975, "body": "this code is in WinRT in C++ and then I call methods to Windows Phone C# project"}, {"owner": {"reputation": 3039, "user_id": 3824740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DzLm.jpg?s=128&g=1", "display_name": "mcchu", "link": "https://stackoverflow.com/users/3824740/mcchu"}, "edited": false, "score": 0, "creation_date": 1424305733, "post_id": 28592640, "comment_id": 45499712, "body": "Maybe try <code>std::vector&lt;cv::Rect&gt; faces;</code> instead."}, {"owner": {"reputation": 73, "user_id": 4220334, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68c7995e2f2b8f89bc1418462f0f7986?s=128&d=identicon&r=PG&f=1", "display_name": "Fa\u010dko", "link": "https://stackoverflow.com/users/4220334/fa%c4%8dko"}, "edited": false, "score": 0, "creation_date": 1424335096, "post_id": 28592640, "comment_id": 45508890, "body": "std::vector&lt;cv::Rect&gt; faces does not help me , still same error"}], "answers": [{"owner": {"reputation": 73, "user_id": 4220334, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68c7995e2f2b8f89bc1418462f0f7986?s=128&d=identicon&r=PG&f=1", "display_name": "Fa\u010dko", "link": "https://stackoverflow.com/users/4220334/fa%c4%8dko"}, "is_accepted": false, "score": 1, "last_activity_date": 1424379297, "creation_date": 1424379297, "answer_id": 28616697, "question_id": 28592640, "link": "https://stackoverflow.com/questions/28592640/wrong-arguments-for-cascadeclassifier-detection/28616697#28616697", "title": "Wrong arguments for CascadeClassifier detection", "body": "<p>It should look like :</p>\n\n<pre><code>std::vector&lt;cv::rect&gt; faces; \nface_cascade.detectMultiScale(mat, faces, 1.1, 2, 0, cv::Size(30, 30));\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4220334, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68c7995e2f2b8f89bc1418462f0f7986?s=128&d=identicon&r=PG&f=1", "display_name": "Fa\u010dko", "link": "https://stackoverflow.com/users/4220334/fa%c4%8dko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424379297, "creation_date": 1424289124, "question_id": 28592640, "link": "https://stackoverflow.com/questions/28592640/wrong-arguments-for-cascadeclassifier-detection", "title": "Wrong arguments for CascadeClassifier detection", "body": "<p>I work on CascadeClassifier MultiScale detection  for WindowsPhone 8.1 C# using Windows Runtime Component. \nHere is my code in WinRT:</p>\n\n<pre><code>cv::Mat mat(width, height, CV_8UC4);\ncv::CascadeClassifier face_cascade;\nface_cascade.load(\"haarcascade_frontalface_alt.xml\");\nstd::vector&lt;Rect&gt; faces;\n .\n .\n .\n .\nequalizeHist(mat, mat);\nface_cascade.detectMultiScale(mat, faces, 1.1, 2, 0, Size(30, 30));\n</code></pre>\n\n<p>And I still get error: \nerror C2664: 'void cv::CascadeClassifier::detectMultiScale(cv::InputArray,std::vector&lt;_Ty> &amp;,double,int,int,cv::Size,cv::Size)' : cannot convert parameter 2 from 'std::vector&lt;_Ty>' to 'std::vector&lt;_Ty> &amp;'    </p>\n\n<p>I follow the tutorial on OpenCV website and I do not why  my parameters should be wrong.</p>\n\n<p>Thanks for reply.</p>\n"}, {"tags": ["c++", "qt", "signals-slots"], "comments": [{"owner": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 1, "creation_date": 1424291237, "post_id": 28592583, "comment_id": 45493012, "body": "Why not just call the click() method?"}, {"owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "reply_to_user": {"reputation": 7466, "user_id": 2146682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7120fc7548c43237662da906e3c84f43?s=128&d=identicon&r=PG", "display_name": "MrEricSir", "link": "https://stackoverflow.com/users/2146682/mrericsir"}, "edited": false, "score": 0, "creation_date": 1424341317, "post_id": 28592583, "comment_id": 45512536, "body": "@MrEricSir because that doesn&#39;t work; see my reply to JeremyFriesner down below."}], "answers": [{"comments": [{"owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424691167, "post_id": 28594198, "comment_id": 45638984, "body": "thanks for the idea with the slot; that&#39;s what I have implemented by now, but I wanted a solution to a <i>direct</i> call to the signal, which seems to be not available after all. Thanks for the answer!"}], "owner": {"reputation": 549, "user_id": 457072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0a0b29dfe8c4cea54f8f5364870f70?s=128&d=identicon&r=PG", "display_name": "Juraj Majer", "link": "https://stackoverflow.com/users/457072/juraj-majer"}, "is_accepted": true, "score": 1, "last_activity_date": 1424294616, "creation_date": 1424294616, "answer_id": 28594198, "question_id": 28592583, "link": "https://stackoverflow.com/questions/28592583/how-to-externally-call-a-signal-in-qt/28594198#28594198", "title": "How to externally call a signal in Qt?", "body": "<p>You cannot emit signal directly from the parent object. </p>\n\n<blockquote>\n  <p>Only the class that defines a signal and its subclasses can emit the signal. (<a href=\"http://qt-project.org/doc/qt-4.8/signalsandslots.html#signals\" rel=\"nofollow\">http://qt-project.org/doc/qt-4.8/signalsandslots.html#signals</a>)</p>\n</blockquote>\n\n<p>You can define a method in your QPushButton <code>emitClicked()</code> where you emit the signal. Then you call <code>emitClicked()</code> on instance of your QPushButton from the code.</p>\n"}, {"comments": [{"owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424341280, "post_id": 28594958, "comment_id": 45512511, "body": "well I&#39;m not sure: <code>Qt Test</code>, as the name says, is for tests and that is not what a I want; to use it would be at best &quot;bad code&quot; (we in Brazil would call it a &quot;gambiarra&quot;), and I&#39;m not in favour of such kinds of solution. I would rather prefer to know how Qt Test calls a signal externally and implement that directly. Any suggestions?"}], "owner": {"reputation": 3665, "user_id": 2502409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3bb7da4ea752f8cbe91601e127d3bccf?s=128&d=identicon&r=PG", "display_name": "Nazar554", "link": "https://stackoverflow.com/users/2502409/nazar554"}, "is_accepted": false, "score": 0, "last_activity_date": 1424297544, "creation_date": 1424297544, "answer_id": 28594958, "question_id": 28592583, "link": "https://stackoverflow.com/questions/28592583/how-to-externally-call-a-signal-in-qt/28594958#28594958", "title": "How to externally call a signal in Qt?", "body": "<p>Seems that <code>Qt Test</code> module is just for this case.\nCheck out <a href=\"http://doc.qt.io/qt-5/qttestlib-tutorial3-example.html\" rel=\"nofollow\">this</a> tutorial on simulating GUI events.\nBasically you use <a href=\"http://doc.qt.io/qt-5/qtest.html#mouseClick\" rel=\"nofollow\"><code>QTest::\u200bmouseClick</code></a> and pass pointer to your push button.</p>\n"}, {"comments": [{"owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424341113, "post_id": 28597752, "comment_id": 45512401, "body": "to be honest, that was precisely the solution I first thought and tried to implement, without success, before coming to SO. In case, when I call the signal directly by the code, I get the error &quot;error: &#39;void QImageButton::clicked(button_id)&#39; is protected&quot; - &quot;within this context&quot;. So, I would say, your proposed solution don&#39;t work. :T"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424361366, "post_id": 28597752, "comment_id": 45525350, "body": "What&#39;s a QImageButton?  AFAICT there&#39;s no class named QImageButton in the Qt API.  I tested this technique with a QPushButton and it worked for me there."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 1, "creation_date": 1424362721, "post_id": 28597752, "comment_id": 45526380, "body": "Btw if QImageButton is a subclass of QPushButton, then the problem is probably that the QPushButton::clicked() signal-method is being hidden by QImageButton::clicked(button_id), which is a protected method you aren&#39;t allowed to call.  In that case, you can call the QPushButton::clicked() method via something like:  static_cast&lt;QPushButton*&gt;(myButton)-&gt;clicked();"}, {"owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424427126, "post_id": 28597752, "comment_id": 45553508, "body": "well, that changes things... I used QPushButton as just an example in my question, while my actual solution is implemented over QImageButton, a subclass of QAbstractButton. About clicked(button_id), it is, as I sad, a signal declared under <code>signals:</code> in the .hpp of QImageButton and it is emitted when a slot connected to QAbstractButton::clicked() is called. Your &quot;static_cast&quot; solution isn&#39;t sufficient for me, since I want the <code>button_id</code> information. =]"}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424447096, "post_id": 28597752, "comment_id": 45565600, "body": "If you want the clicked(button_id) signal to be emitted, then call that instead, with the appropriate argument,"}, {"owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424691101, "post_id": 28597752, "comment_id": 45638940, "body": "but the problem is that I&#39;m being unable to call <code>clicked(button_id)</code> for the reasons mentioned above: error message appears, saying my signal is protected although I never explicitly told it to be so =/ So my problem persists: I&#39;m being unable to <i>directly</i> call my signal <code>clicked(button_id)</code> while wanting to know if that is possible."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "reply_to_user": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "edited": false, "score": 0, "creation_date": 1424716518, "post_id": 28597752, "comment_id": 45654490, "body": "Is QImageButton class using protected inheritance to derive from its superclass?  If so, you can either change QImageButton to use public inheritance instead, or you can add a public method to QImageButton (or to some subclass of QImageButton) that calls through to clicked(button_id), and call your public method instead."}], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 0, "last_activity_date": 1424313153, "creation_date": 1424313153, "answer_id": 28597752, "question_id": 28592583, "link": "https://stackoverflow.com/questions/28592583/how-to-externally-call-a-signal-in-qt/28597752#28597752", "title": "How to externally call a signal in Qt?", "body": "<p>The Qt headers contain this interesting line (in qobjectdefs.h):</p>\n\n<pre><code>#define emit\n</code></pre>\n\n<p>Which means that presence or absence of the emit keyword has no effect on the code, it's only there to make it more obvious to the human reader that you are emitting a signal.  That is to say:</p>\n\n<pre><code> emit clicked();\n</code></pre>\n\n<p>is exactly the same (as far as the C++ compiler is concerned) as</p>\n\n<pre><code> clicked();\n</code></pre>\n\n<p>Given that, if you want your button to emit its clicked() signal, it's just a matter of doing this:</p>\n\n<pre><code> myButton-&gt;clicked();\n</code></pre>\n\n<p>(although if you wanted to be clever about it, this would work equally well):</p>\n\n<pre><code> emit myButton-&gt;clicked();\n</code></pre>\n"}], "owner": {"reputation": 2043, "user_id": 2876498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EyAS1.jpg?s=128&g=1", "display_name": "Momergil", "link": "https://stackoverflow.com/users/2876498/momergil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1134, "favorite_count": 1, "accepted_answer_id": 28594198, "answer_count": 3, "score": 0, "last_activity_date": 1424313153, "creation_date": 1424288954, "question_id": 28592583, "link": "https://stackoverflow.com/questions/28592583/how-to-externally-call-a-signal-in-qt", "title": "How to externally call a signal in Qt?", "body": "<p>I know how to call a signal from inside the class where the signal is located: by using <code>emit</code>. But what if I want to call it externally, from the parent object?</p>\n\n<p>The reason why I want to do is is because a given QPushButton is connected to a slot which picks the button that called it by using <code>sender()</code>. Now I want the same functionallity of that slot to be called but not after a manual click in the button, but from within the code itself. Normally I would just programatically call for the slot, but because of the usage of <code>sender()</code>, that way is invalid: calling the slot directly will not give it the id of the button. </p>\n\n<p>So how could I \"externally\" ask for the object for it to emit one of its signals? That is, how can I make my QPushButton emit its <code>clicked()</code> signal from within the code, not by clicking the button with the mouse?</p>\n"}, {"tags": ["c++", "random"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1424288645, "post_id": 28592472, "comment_id": 45491458, "body": "The result of <code>rand() % 2</code> is going to be either <code>0</code> or <code>1</code>. That&#39;s all you get &quot;modulo 2&quot;. <code>myrand = myrand &amp; 0x3ff</code> won&#39;t do anything for you at that point, so I&#39;m not sure why you have that."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424288725, "post_id": 28592472, "comment_id": 45491511, "body": "<code>std::vector&lt;bool&gt;</code>?  <code>boost::dynamic_bitset</code>?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1424292796, "post_id": 28592472, "comment_id": 45493920, "body": "As you use 50 values, you may use an <code>std::uint64_t</code> and use bit masking/shifting for the wanted value."}], "answers": [{"comments": [{"owner": {"reputation": 2547, "user_id": 1503898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CX5eA.jpg?s=128&g=1", "display_name": "Amxx", "link": "https://stackoverflow.com/users/1503898/amxx"}, "edited": false, "score": 0, "creation_date": 1424289561, "post_id": 28592536, "comment_id": 45492041, "body": "&quot; probably uses a better underlying algorithm than <code>rand</code> &quot; you can remove &quot;probably&quot;"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 2547, "user_id": 1503898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CX5eA.jpg?s=128&g=1", "display_name": "Amxx", "link": "https://stackoverflow.com/users/1503898/amxx"}, "edited": false, "score": 0, "creation_date": 1424289722, "post_id": 28592536, "comment_id": 45492154, "body": "@Amxx Many do use a crappy LCRNG, but there&#39;s nothing that <i>prevents</i> a C library from using MT19337 or ChaCha or something even better to implement <code>rand</code>.  (I find the explicit specification of algorithms in <code>std::random</code> to be somewhat unfortunate.)"}, {"owner": {"reputation": 2547, "user_id": 1503898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CX5eA.jpg?s=128&g=1", "display_name": "Amxx", "link": "https://stackoverflow.com/users/1503898/amxx"}, "edited": false, "score": 0, "creation_date": 1424289883, "post_id": 28592536, "comment_id": 45492261, "body": "My vision is that you either know what you need, and then use a specific generator in <code>std::radom</code> or you just don&#39;t know what you do and use <code>rand()</code>.  <code>rand()</code> is as bad as the worst generator that may be used below it ... <code>std::rand</code> enables you to control the generator, and control is ALWAYS better"}, {"owner": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "edited": false, "score": 0, "creation_date": 1424289907, "post_id": 28592536, "comment_id": 45492276, "body": "thanks a&#39;lot, does it makes binary random numbers too ?"}, {"owner": {"reputation": 2547, "user_id": 1503898, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CX5eA.jpg?s=128&g=1", "display_name": "Amxx", "link": "https://stackoverflow.com/users/1503898/amxx"}, "reply_to_user": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "edited": false, "score": 0, "creation_date": 1424290101, "post_id": 28592536, "comment_id": 45492399, "body": "@farshadsoheily There is no fondamental difference difference between random numbers of different type. An <code>int</code> is juste 32 random bits. If you look at the <code>std::random</code> spec it always talk of random bits. In <code>std::random</code> you basically have generator which generates random bits, and distribution which transforms thoses random bits to <code>bool</code>/<code>int</code>/<code>float</code>/... following different distributions ..."}], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1424288781, "creation_date": 1424288781, "answer_id": 28592536, "question_id": 28592472, "link": "https://stackoverflow.com/questions/28592472/how-to-make-a-list-of-binary-numbers/28592536#28592536", "title": "How to make a list of binary numbers", "body": "<p>You can return a <code>vector&lt;bool&gt;</code> or a <code>vector&lt;uint32_t&gt;</code>.  That will be easier than any other option.  BTW, C++11 added a new <a href=\"http://en.cppreference.com/w/cpp/numeric/random\" rel=\"nofollow\">random number generator</a> that is friendlier <em>and</em> probably uses a better underlying algorithm than <code>rand</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "edited": false, "score": 0, "creation_date": 1424289798, "post_id": 28592720, "comment_id": 45492207, "body": "I had tried to use pointers but it didn&#39;t work . Actually i was searching to find another solution. .By the way, Thanks ;)"}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "reply_to_user": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "edited": false, "score": 0, "creation_date": 1424292857, "post_id": 28592720, "comment_id": 45493963, "body": "Actually you don&#39;t even need to return anything\u2014once the caller allocated an array, your function needs only to fill it; the array remains where if was so there&#39;s no need to inform the calling function where it is.."}, {"owner": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "edited": false, "score": 0, "creation_date": 1424294536, "post_id": 28592720, "comment_id": 45494889, "body": "You mean without returning anything it  still works?"}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "reply_to_user": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "edited": false, "score": 0, "creation_date": 1424345550, "post_id": 28592720, "comment_id": 45515074, "body": "Yes. Of course that needs changing the function declaration to <code>void SourceNode::database(long int chunk_var[])</code> or better <code>void SourceNode::database(long int chunk_var[], int len)</code> or something like that."}], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": false, "score": 0, "last_activity_date": 1424289377, "creation_date": 1424289377, "answer_id": 28592720, "question_id": 28592472, "link": "https://stackoverflow.com/questions/28592472/how-to-make-a-list-of-binary-numbers/28592720#28592720", "title": "How to make a list of binary numbers", "body": "<p>Just return the array you got as a parameter:</p>\n\n<pre><code>long int *SourceNode::database(long int chunk_var[])\n{\n    ......... // fill the array with numbers\n    return chunk_var;\n}\n</code></pre>\n\n<p>However I suppose you will also need to pass the array length to the function as another parameter so that the function knows how many items it is allowed to overwrite.</p>\n"}], "owner": {"reputation": 31, "user_id": 4527549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb97a7c059c6446248a1d53d451e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "farshad soheily", "link": "https://stackoverflow.com/users/4527549/farshad-soheily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1424289377, "creation_date": 1424288540, "last_edit_date": 1424288629, "question_id": 28592472, "link": "https://stackoverflow.com/questions/28592472/how-to-make-a-list-of-binary-numbers", "title": "How to make a list of binary numbers", "body": "<p>I want to have a function to make a list of binary random numbers.. I don't know which method is appropriate for this purpose. I can make it with an array , a while command, linked list or a std .. </p>\n\n<p>I want to return the whole list from the function. In array i think i can't do that. For example the following function only return the first elements.</p>\n\n<pre><code>long int  SourceNode::database(long int chunk_var[])\n{\n    srand ( time(0) );\n    for(int j = 0; j&lt;50 ;j++)\n    {\n        int myrand = rand() % 2 ;\n        myrand = myrand &amp; 0x3ff;\n        chunk_var[j]= myrand;\n    }\n    return *chunk_var;\n}\n</code></pre>\n\n<p>i want something to return the whole list, because i want to invoke that function( the whole list) in another function . is there any alternative solution instead of making an array?</p>\n"}, {"tags": ["c++", "templates"], "answers": [{"comments": [{"owner": {"reputation": 899, "user_id": 3276237, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3d2cb579c59bca6fad8da7e9fab261b?s=128&d=identicon&r=PG&f=1", "display_name": "pragmatist1", "link": "https://stackoverflow.com/users/3276237/pragmatist1"}, "edited": false, "score": 0, "creation_date": 1424352856, "post_id": 28593828, "comment_id": 45519422, "body": "Thanks for your help, both answers were great. I did have a question though. Is there any distinct advantage/disadvantage to storing the derived classes in a vector of pointers as opposed to storing a vector of the objects themselves?"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "reply_to_user": {"reputation": 899, "user_id": 3276237, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3d2cb579c59bca6fad8da7e9fab261b?s=128&d=identicon&r=PG&f=1", "display_name": "pragmatist1", "link": "https://stackoverflow.com/users/3276237/pragmatist1"}, "edited": false, "score": 0, "creation_date": 1424357685, "post_id": 28593828, "comment_id": 45522712, "body": "@pragmatist1: You will have slicing issue if you use a <code>vector</code> of Base object."}], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1424293266, "creation_date": 1424293266, "answer_id": 28593828, "question_id": 28592465, "link": "https://stackoverflow.com/questions/28592465/class-template-with-constructor-forwarding/28593828#28593828", "title": "Class template with constructor forwarding", "body": "<p>Following may help:</p>\n\n<pre><code>template &lt;class Base&gt;\nclass ParallelBaseClass\n{\nprivate:\n     std::vector&lt;std::unique_ptr&lt;Base&gt;&gt; classes;\n\n public:\n\n    template&lt;typename Derived, typename ... Ts&gt;\n    void Add(Ts&amp;&amp;...args)\n    {\n        classes.push_back(std::make_unique&lt;Derived&gt;(std::forward&lt;Ts&gt;(args)...));\n    }\n\n};\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>struct B { virtual ~B() = default; };\nstruct D : B { D(int) {} };\n\nParallelBaseClass&lt;B&gt; p;\n\np.Add&lt;D&gt;(42);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 899, "user_id": 3276237, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3d2cb579c59bca6fad8da7e9fab261b?s=128&d=identicon&r=PG&f=1", "display_name": "pragmatist1", "link": "https://stackoverflow.com/users/3276237/pragmatist1"}, "edited": false, "score": 0, "creation_date": 1424352668, "post_id": 28593862, "comment_id": 45519306, "body": "Thank you! This was precisely what I was looking for."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1424356702, "post_id": 28593862, "comment_id": 45521948, "body": "Using <code>std::forward</code> in a loop may have (user) unexpected result (think about <code>std::unique_ptr&lt;T&gt;&amp;&amp;</code>)."}], "owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "is_accepted": true, "score": 1, "last_activity_date": 1424356908, "last_edit_date": 1424356908, "creation_date": 1424293398, "answer_id": 28593862, "question_id": 28592465, "link": "https://stackoverflow.com/questions/28592465/class-template-with-constructor-forwarding/28593862#28593862", "title": "Class template with constructor forwarding", "body": "<p>If the classes are such that they all have a function (for example <code>execute</code>) that does something, and <code>ParallelBaseClass</code> should call it on several objects at the same time in different threads, this might be a design:</p>\n\n<pre><code>#include &lt;utility&gt; // for std::forward\n\nclass Base {\npublic:\n    virtual void execute() = 0;\n}\n\n\nclass Example : public Base {\npublic:\n    void execute() override { .... }\n}\n\ntemplate&lt;typename D&gt;\nclass Parallel : public Base {\nprivate:\n    std::vector&lt;D&gt; objects_; // Called objects, since classes refers to the type and not instances of it\npublic:\n    template&lt;typename... Args&gt;\n    explicit ParallelBase(int threads, Args&amp;&amp;... args) {\n        for(int i = 0; i &lt; threads; ++i)\n            objects_.emplace_back( args... );\n            // not using std::forward&lt;Args&gt;(args)... here:\n            // need to make (multiple) copies instead of moving\n    }\n\n    void execute() override {\n        for(D&amp; obj : objects_)\n            //create thread and run objects_[i].execute()\n    }\n}\n</code></pre>\n\n<p>The constructor is a variadic template function that forwards the arguments to <code>D</code>'s constructor. <code>std::forward</code> forwards than as rvalue reference or as reference when possible. The <code>...</code> expands the template parameter pack. <code>explicit</code> makes sure that an <code>int</code> can't be implicitly converted to a <code>ParallelBase</code> using a construction with zero <code>args</code> arguments.</p>\n\n<p>Here <code>Base</code> is abstract and polymorphic. This would correspond to a composition design pattern. <code>Parallel</code> (not a base class here) corresponds to a parallelization of the functionality of <code>D</code>, and has an <code>execute</code> implementation itself.</p>\n\n<p><strong>Update</strong>\nFixed move construction.</p>\n"}], "owner": {"reputation": 899, "user_id": 3276237, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b3d2cb579c59bca6fad8da7e9fab261b?s=128&d=identicon&r=PG&f=1", "display_name": "pragmatist1", "link": "https://stackoverflow.com/users/3276237/pragmatist1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 28593862, "answer_count": 2, "score": 0, "last_activity_date": 1424356908, "creation_date": 1424288503, "question_id": 28592465, "link": "https://stackoverflow.com/questions/28592465/class-template-with-constructor-forwarding", "title": "Class template with constructor forwarding", "body": "<p>I wondering what was the best way of implementing the following. </p>\n\n<p>I have a number of classes that derive from an abstract class, <code>BaseClass</code>. I want to create a new class <code>ParallelBaseClass</code> that basically performs a parallelization of all children of <code>BaseClass</code>. </p>\n\n<p>The design I was thinking of was this:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;class D&gt;\nclass ParallelBaseClass\n{\n  private:\n     std::vector&lt;D&gt; _classes;\n\n   public:\n\n   ParallelBaseClass(int threads, constructor_args)\n   {\n       for(int i = 0; i &lt; threads; i++)\n         _classes.push_back(D(constructor_args));\n   }\n}\n</code></pre>\n\n<p>However, I don't know that this is the best design. I have two issues: </p>\n\n<ol>\n<li>Ensuring that the template type is a descendent of <code>BaseClass</code></li>\n<li>forwarding constructor arguments as shown above. </li>\n</ol>\n\n<p>Any guidance is greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "file-io"], "comments": [{"owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "edited": false, "score": 0, "creation_date": 1424288077, "post_id": 28592112, "comment_id": 45491093, "body": "bp should have been sarray. That was a typo."}], "answers": [{"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "is_accepted": true, "score": 4, "last_activity_date": 1424287767, "creation_date": 1424287767, "answer_id": 28592230, "question_id": 28592112, "link": "https://stackoverflow.com/questions/28592112/writing-an-array-of-shorts-to-a-file/28592230#28592230", "title": "Writing an array of shorts to a file", "body": "<p>In Windows you need to tell <a href=\"https://msdn.microsoft.com/en-us/library/yeby3zcb.aspx\" rel=\"nofollow\">fopen</a> that the data is binary or it messes up \"\\n\" to \"\\r\\n\".</p>\n\n<pre><code>fopen(\"E:\\\\audio_rec\\\\test_1.raw\", \"wb\");\n</code></pre>\n"}], "owner": {"reputation": 1595, "user_id": 1119161, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=128&d=identicon&r=PG", "display_name": "dsp_user", "link": "https://stackoverflow.com/users/1119161/dsp-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 28592230, "answer_count": 1, "score": 1, "last_activity_date": 1424287877, "creation_date": 1424287392, "last_edit_date": 1424287877, "question_id": 28592112, "link": "https://stackoverflow.com/questions/28592112/writing-an-array-of-shorts-to-a-file", "title": "Writing an array of shorts to a file", "body": "<p>For some reason (that I've yet to figure out), the following code doesn't quite work as expected. I'm trying to write an array of shorts to a file and while the file is generated successfully, the values are just not right. The example code is</p>\n\n<pre><code>short* sarray = new short[2000];\nfor(int i=0;i&lt;2000;i++)\n    sarray[i]=i*2;\n\n    FILE* oFile;\n\n    oFile =  fopen(\"E:\\\\audio_rec\\\\test_1.raw\", \"w\");\n\n    int shortsRead =fwrite(sarray, sizeof(short), 2000, oFile);\n    fclose(oFile);\n</code></pre>\n\n<p>The file content (as displayed in a hex editor). It's clear that only the first 5 values (up to 8) are as expected. \nAny ideas?</p>\n\n<p><img src=\"https://i.stack.imgur.com/Bnke3.jpg\" alt=\"hex dump\"></p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "mongodb"], "comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 1, "creation_date": 1424289348, "post_id": 28592090, "comment_id": 45491890, "body": "Perhaps the macros are for convenient filling. Empty objects you can typically get directly like mongo::BSONArray() or mongo::BSONArray::empty"}], "answers": [{"owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "is_accepted": true, "score": 0, "last_activity_date": 1424294360, "creation_date": 1424294360, "answer_id": 28594124, "question_id": 28592090, "link": "https://stackoverflow.com/questions/28592090/empty-bson-array-in-mongo-c-driver/28594124#28594124", "title": "Empty BSON_ARRAY() in mongo C++ driver", "body": "<p>It seems that <code>BSONArray()</code> solves the problem:</p>\n\n<pre><code>  BSONObj cr4 = BSON(\"providingApplication\" &lt;&lt; \"http://cpr2.com\" &lt;&lt;\n                     \"entities\" &lt;&lt; BSON_ARRAY(\n                         BSON(\"id\" &lt;&lt; \"E1\" &lt;&lt; \"type\" &lt;&lt; \"T\")\n                         ) &lt;&lt;\n                     \"attrs\" &lt;&lt; BSONArray()\n                     );\n</code></pre>\n\n<p>Thanks \u00d6\u00f6 Tiib for the tip!</p>\n"}], "owner": {"reputation": 10131, "user_id": 1485926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/t4pjt.jpg?s=128&g=1", "display_name": "fgalan", "link": "https://stackoverflow.com/users/1485926/fgalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 28594124, "answer_count": 1, "score": 0, "last_activity_date": 1424294360, "creation_date": 1424287322, "question_id": 28592090, "link": "https://stackoverflow.com/questions/28592090/empty-bson-array-in-mongo-c-driver", "title": "Empty BSON_ARRAY() in mongo C++ driver", "body": "<p>The following works with mongo C++ BSON() and BSON_ARRAY() macros:</p>\n\n<pre><code>  BSONObj cr4 = BSON(\"providingApplication\" &lt;&lt; \"http://cpr2.com\" &lt;&lt;\n                     \"entities\" &lt;&lt; BSON_ARRAY(\n                         BSON(\"id\" &lt;&lt; \"E1\" &lt;&lt; \"type\" &lt;&lt; \"T\")\n                         ) &lt;&lt;\n                     \"attrs\" &lt;&lt; BSON_ARRAY(\n                         BSON(\"name\" &lt;&lt; \"A5\" &lt;&lt; \"type\" &lt;&lt; \"T\" &lt;&lt; \"isDomain\" &lt;&lt; \"false\")\n                         )\n                     );\n</code></pre>\n\n<p>However, if I try to use an empty BSON array for <code>attrs</code> field</p>\n\n<pre><code>  BSONObj cr4 = BSON(\"providingApplication\" &lt;&lt; \"http://cpr2.com\" &lt;&lt;\n                     \"entities\" &lt;&lt; BSON_ARRAY(\n                         BSON(\"id\" &lt;&lt; \"E1\" &lt;&lt; \"type\" &lt;&lt; \"T\")\n                         ) &lt;&lt;\n                     \"attrs\" &lt;&lt; BSON_ARRAY()\n                     );\n</code></pre>\n\n<p>it doesn't work (it doesn't even compile).</p>\n\n<p>Any hint on how to produce an empty array using BSON macros in mongo c++ driver, please?</p>\n"}, {"tags": ["c++", "stl", "iterator", "shared-ptr"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1424287579, "post_id": 28592074, "comment_id": 45490810, "body": "Why do you want pointers to a std::string in the first place? Do not use any pointer (smart or not smart) without reason!"}, {"owner": {"reputation": 25, "user_id": 4581033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e77aeb46d00feb4a8225926e30521681?s=128&d=identicon&r=PG&f=1", "display_name": "Daemonstool", "link": "https://stackoverflow.com/users/4581033/daemonstool"}, "edited": false, "score": 0, "creation_date": 1424288251, "post_id": 28592074, "comment_id": 45491197, "body": "The code above was an example. I would like to store share pointers to objects which allocate memory in a vector. With the smart pointers I want to make sure that no memory leaks will occur."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4581033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e77aeb46d00feb4a8225926e30521681?s=128&d=identicon&r=PG&f=1", "display_name": "Daemonstool", "link": "https://stackoverflow.com/users/4581033/daemonstool"}, "edited": false, "score": 0, "creation_date": 1424354932, "post_id": 28594879, "comment_id": 45520733, "body": "Thanks, I should look more at the facilities of STL!"}], "owner": {"reputation": 12800, "user_id": 214796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d05177bba9d853a9c546c4a965085e99?s=128&d=identicon&r=PG", "display_name": "Collin Dauphinee", "link": "https://stackoverflow.com/users/214796/collin-dauphinee"}, "is_accepted": true, "score": 1, "last_activity_date": 1424297275, "creation_date": 1424297275, "answer_id": 28594879, "question_id": 28592074, "link": "https://stackoverflow.com/questions/28592074/inserting-shared-pointers-to-strings-from-cin-into-vector/28594879#28594879", "title": "Inserting shared pointers to strings from cin into vector", "body": "<p><code>std::copy</code> isn't appropriate here, because you're reading strings, but trying to store pointers to strings. </p>\n\n<p>Your source and destination types are different, so you need <code>std::transform</code>, instead. This function is similar to copy, but it applies a function to transform the input before writing it to the output iterator.</p>\n\n<pre><code>transform(istream_iterator&lt;string&gt;(cin), istream_iterator&lt;string&gt;(), back_inserter(data), \n    [](const string&amp; str) { return make_shared&lt;string&gt;(str); });\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4581033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e77aeb46d00feb4a8225926e30521681?s=128&d=identicon&r=PG&f=1", "display_name": "Daemonstool", "link": "https://stackoverflow.com/users/4581033/daemonstool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 28594879, "answer_count": 1, "score": 0, "last_activity_date": 1424297275, "creation_date": 1424287269, "question_id": 28592074, "link": "https://stackoverflow.com/questions/28592074/inserting-shared-pointers-to-strings-from-cin-into-vector", "title": "Inserting shared pointers to strings from cin into vector", "body": "<p>I am trying to insert shared pointers to strings into a vector using the copy algorithm. Is it possible to read lines from the istream and store shared_ptr's to those strings in a vector using the copy algorithm? So far I'm stuck with the following class. </p>\n\n<pre><code>class DVector\n{\n    typedef vector&lt;shared_ptr&lt;string&gt;&gt; PTSVector;\n    PTSVector data;\n\npublic:\n    void push_back()\n    {\n        copy(istream_iterator&lt;string&gt;(cin),\n            istream_iterator&lt;string&gt;(),\n            back_inserter(data));\n    }\n};\n</code></pre>\n\n<p>Can anyone tell me what might go wrong?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "eclipse", "eclipse-cdt"], "comments": [{"owner": {"reputation": 1958, "user_id": 1150249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b22ba9a5573439e1f850203c465467c3?s=128&d=identicon&r=PG", "display_name": "dhavenith", "link": "https://stackoverflow.com/users/1150249/dhavenith"}, "edited": false, "score": 0, "creation_date": 1424289125, "post_id": 28592058, "comment_id": 45491767, "body": "&quot;Works for me&quot;. In other words: CDT does exactly those things that you say it doesn&#39;t."}, {"owner": {"reputation": 15365, "user_id": 52074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd14249e07e1f1d6a949bffa569377ad?s=128&d=identicon&r=PG", "display_name": "Trevor Boyd Smith", "link": "https://stackoverflow.com/users/52074/trevor-boyd-smith"}, "edited": false, "score": 0, "creation_date": 1424289529, "post_id": 28592058, "comment_id": 45492023, "body": "RE - lack of auto-complete:I believe that it does have auto-complete for library and user functions (I use it all the time) but the auto-completion behavior is different than for Eclipse-Java. |||| RE - as you type syntax highlighting: this feature is implemented in CDT but again behaves differently... as you type syntax checking is provided by the static code analysis Eclipse program &quot;CODAN&quot; but is only doing static code analysis (i.e. may miss some things or present false-positives)... many errors are only revealed when you compile (and likewise false-positives are revealed as false-positi)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1424292376, "post_id": 28592058, "comment_id": 45493694, "body": "I just realized your question is ambiguous. Do you want these features <i>for Java</i>, or do you want the feature that are already available for Java to be available <i>for C++</i>? I&#39;m guessing the latter, since the question is tagged C++ but not Java, but the recently posted answer assumes the former. Please update your question to clarify that."}, {"owner": {"reputation": 1076, "user_id": 668636, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd0d1ba423c4cb719f2af5d01dfeae42?s=128&d=identicon&r=PG", "display_name": "cppcoder", "link": "https://stackoverflow.com/users/668636/cppcoder"}, "reply_to_user": {"reputation": 15365, "user_id": 52074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd14249e07e1f1d6a949bffa569377ad?s=128&d=identicon&r=PG", "display_name": "Trevor Boyd Smith", "link": "https://stackoverflow.com/users/52074/trevor-boyd-smith"}, "edited": false, "score": 0, "creation_date": 1424294194, "post_id": 28592058, "comment_id": 45494704, "body": "@Trevor - I only have as you type syntax highlighting out of the box with CDT. How do I get auto-complete and as you type syntax checking. Do I need to create a new project and add the files. I&#39;m editing an existing *.cpp file developed elsewhere."}, {"owner": {"reputation": 15365, "user_id": 52074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd14249e07e1f1d6a949bffa569377ad?s=128&d=identicon&r=PG", "display_name": "Trevor Boyd Smith", "link": "https://stackoverflow.com/users/52074/trevor-boyd-smith"}, "edited": false, "score": 0, "creation_date": 1424352026, "post_id": 28592058, "comment_id": 45518868, "body": "Sounds like you are somehow not using Eclipse-CDT correctly. ||||| Suffice to say these two features have been around in some form since about 2007 (when I started using Eclipse-CDT). In 2007 these two features were less featureful and did not work as well."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1424292496, "post_id": 28593525, "comment_id": 45493760, "body": "I <i>think</i> the OP is asking about feature for C++, but the question seems to be ambiguous."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424305258, "post_id": 28593525, "comment_id": 45499543, "body": "It looks like this isn&#39;t what the OP is asking for."}], "owner": {"reputation": 11, "user_id": 4581189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcYrC.jpg?s=128&g=1", "display_name": "jhb", "link": "https://stackoverflow.com/users/4581189/jhb"}, "is_accepted": false, "score": 0, "last_activity_date": 1424292195, "creation_date": 1424292195, "answer_id": 28593525, "question_id": 28592058, "link": "https://stackoverflow.com/questions/28592058/eclipse-plugin-for-c-with-all-functionality-available-for-java/28593525#28593525", "title": "Eclipse Plugin for C++ with all functionality available for Java", "body": "<p>CDT comes only with C and C++ tools. You need to <em>also</em> install the Java tools, like this:</p>\n\n<ol>\n<li><p>Choose: Help | Install New Software...</p></li>\n<li><p>In the \"Works with:\" drop-down box, choose: --All Available Sites--</p></li>\n<li><p>Select: Eclipse Java Development Tools</p></li>\n</ol>\n"}], "owner": {"reputation": 1076, "user_id": 668636, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd0d1ba423c4cb719f2af5d01dfeae42?s=128&d=identicon&r=PG", "display_name": "cppcoder", "link": "https://stackoverflow.com/users/668636/cppcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424294027, "creation_date": 1424287199, "last_edit_date": 1424294027, "question_id": 28592058, "link": "https://stackoverflow.com/questions/28592058/eclipse-plugin-for-c-with-all-functionality-available-for-java", "title": "Eclipse Plugin for C++ with all functionality available for Java", "body": "<p>I recently installed the CDT plugin for C++ development in Eclipse. It provides useful features for build and debug. But it does not have the following features available for java:  </p>\n\n<ol>\n<li>Auto-complete of library functions or even user defined functions, variables etc.  </li>\n<li>Syntax checking as you type. For e.g., if I miss a ';' at end of line, it is not highlighted.  </li>\n</ol>\n\n<p>In short I'm looking for a plugin or someway to customize CDT to have all the support Eclipse provides for Java code.<br>\nClarification - All the features I'm looking for is related to C++ code development. </p>\n"}, {"tags": ["c++", "matlab", "opencv", "image-processing"], "comments": [{"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 1, "creation_date": 1424316101, "post_id": 28591973, "comment_id": 45502472, "body": "If by &quot;branch&quot; points you want to search for those points where there is a split, use a 3 x 3 pixel neighbourhood and search to see if the total number of white pixels is 4 or more.  If the count is three, this means that we are following along the skeleton.  If the count is two, then this is an end point.  Search for neighbourhoods where the total number of white pixels is 4 or more.  If that&#39;s the case, the centre of the neighbourhood is a potential branch point."}, {"owner": {"reputation": 317, "user_id": 2003951, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e4a63c9abd576baca6ad21f0dde7acf?s=128&d=identicon&r=PG", "display_name": "ben18785", "link": "https://stackoverflow.com/users/2003951/ben18785"}, "reply_to_user": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1424346873, "post_id": 28591973, "comment_id": 45515786, "body": "@rayryeng - thanks for your comment. Can I confirm - are white pixels those that are not part of the structure of interest? (The others being black)."}, {"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1424356688, "post_id": 28591973, "comment_id": 45521942, "body": "White are those that belong to the skeleton."}, {"owner": {"reputation": 317, "user_id": 2003951, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e4a63c9abd576baca6ad21f0dde7acf?s=128&d=identicon&r=PG", "display_name": "ben18785", "link": "https://stackoverflow.com/users/2003951/ben18785"}, "reply_to_user": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1424368147, "post_id": 28591973, "comment_id": 45530101, "body": "@rayryeng thanks for that. Much appreciated!"}], "owner": {"reputation": 317, "user_id": 2003951, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3e4a63c9abd576baca6ad21f0dde7acf?s=128&d=identicon&r=PG", "display_name": "ben18785", "link": "https://stackoverflow.com/users/2003951/ben18785"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1356, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424286907, "creation_date": 1424286907, "last_edit_date": 1495542510, "question_id": 28591973, "link": "https://stackoverflow.com/questions/28591973/implementing-bwmorphimage-thin-inf-then-finding-number-of-branchpoints-in", "title": "Implementing bwmorph(image,&#39;thin&#39;,&#39;inf&#39;) then finding number of branchpoints in c++ using opencv", "body": "<p>I would like to implement the following Matlab code for a given image in c++, which calculates the number of branch points in a medial axis skeleton representation of an image:</p>\n\n<pre><code>skelImg   = bwmorph(imageName, 'thin', 'inf');\nbranchImg = bwmorph(skelImg, 'branchpoints');\n[row, column] = find(branchImg);\nbranchPts     = [row column];\ncNumBranchPoints = length(branchPts);\n</code></pre>\n\n<p>I have seen this example: <a href=\"https://stackoverflow.com/questions/22058485/how-to-implement-an-function-equivalent-to-bwmorph-matlab-function-in-opencv\">How to implement an function equivalent to bwmorph Matlab function in OpenCV</a> which is similar in nature, although slightly different, in that I do not want to 'clean' the image, but rather 'thin' it. I also want to determine the number of <em>branch points</em>, not <em>end points</em>, as in the aforementioned example.</p>\n\n<p>Anyone have an idea as to how I can do this in c++?</p>\n\n<p>Best,</p>\n\n<p>Ben</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "std", "stdthread"], "comments": [{"owner": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "edited": false, "score": 2, "creation_date": 1424287121, "post_id": 28591954, "comment_id": 45490526, "body": "Your next problem will be the data race on <code>i</code>: the main thread is changing it while the child threads are trying to observe it. Pass <code>i</code> by value: <code>mThreads.emplace_back(&amp;DJM::Terrain::GenBlocks, i);</code> and of course adjust the signature of <code>DJM::Terrain::GenBlocks</code> to agree."}, {"owner": {"reputation": 828, "user_id": 3110529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e7cd657480d3e547be462d7a8aff5?s=128&d=identicon&r=PG", "display_name": "Dillanm", "link": "https://stackoverflow.com/users/3110529/dillanm"}, "reply_to_user": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "edited": false, "score": 0, "creation_date": 1424287539, "post_id": 28591954, "comment_id": 45490791, "body": "As said below, your comment + T.C.&#39;s got it working perfectly, I didn&#39;t realise threads were noncopyable. Thanks for your help."}], "answers": [{"comments": [{"owner": {"reputation": 828, "user_id": 3110529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e7cd657480d3e547be462d7a8aff5?s=128&d=identicon&r=PG", "display_name": "Dillanm", "link": "https://stackoverflow.com/users/3110529/dillanm"}, "edited": false, "score": 0, "creation_date": 1424287365, "post_id": 28591995, "comment_id": 45490677, "body": "Yours + Caseys replies got it working, thanks very much for your help."}], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1424286966, "creation_date": 1424286966, "answer_id": 28591995, "question_id": 28591954, "link": "https://stackoverflow.com/questions/28591954/stdthread-class-method-errors/28591995#28591995", "title": "std::thread class method errors", "body": "<p><code>std::thread</code>s cannot be copied. Move it into the vector:</p>\n\n<pre><code>mThreads.push_back(std::move(t));\n</code></pre>\n"}], "owner": {"reputation": 828, "user_id": 3110529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e7cd657480d3e547be462d7a8aff5?s=128&d=identicon&r=PG", "display_name": "Dillanm", "link": "https://stackoverflow.com/users/3110529/dillanm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 28591995, "answer_count": 1, "score": 0, "last_activity_date": 1424287290, "creation_date": 1424286839, "last_edit_date": 1424287290, "question_id": 28591954, "link": "https://stackoverflow.com/questions/28591954/stdthread-class-method-errors", "title": "std::thread class method errors", "body": "<p>I'm trying to create threads to run row-by-row on a grid-based terrain (i'm not asking if this is efficient, I'm just testing something out) but I keep coming across 2 errors:</p>\n\n<p>first being that if I don't pass the function as </p>\n\n<pre><code>&amp;DJM::Terrain:GenBlocks\n</code></pre>\n\n<p>The compiler tells me to append the &amp; at the start but when I do use the reference it gives me a seperate error connected to xmemory</p>\n\n<pre><code>error C2248: 'std::thread::thread' : cannot access private member declared in class 'std::thread'\n1&gt;          d:\\program files\\visual studio 2012\\vc\\include\\thread(73) : see declaration of 'std::thread::thread'\n1&gt;          d:\\program files\\visual studio 2012\\vc\\include\\thread(32) : see declaration of 'std::thread'\n</code></pre>\n\n<p>and I seriously do not understand why. I've read in multiple places that you should put <em>this</em> as the 2nd argument but that gives exactly the same error as above. I have also tried passing <em>i</em> as an std::ref but that gives the same error.</p>\n\n<pre><code>    for(size_t i = 0; i &lt; mHEIGHT; ++i){\n            std::thread t(&amp;DJM::Terrain::GenBlocks, &amp;i);\n            mThreads.push_back(t);\n    }\n\n    for(std::vector&lt;std::thread&gt;::iterator iter = mThreads.begin(); iter != mThreads.end(); iter++){\n            iter-&gt;join();\n    }\n</code></pre>\n\n<p>Quite a large code file so I'd rather not post the entirety of the class but if there's no immediate errors with the code I've posted I'd be happy to post the rest of the code. Note that mThreads is stored as a member variable.</p>\n"}, {"tags": ["c++", "c++11", "gcc", "cmake"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 1, "creation_date": 1424287093, "post_id": 28591933, "comment_id": 45490509, "body": "For g++ debug: <code>set(CMAKE_CXX_FLAGS_DEBUG &quot;-std=c++11 -g -pthread ${CMAKE_CXX_FLAGS_DEBUG}&quot;)</code>"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 4, "creation_date": 1424287106, "post_id": 28591933, "comment_id": 45490516, "body": "cmake and c++11 are 2 nice keywords to pass to google... (you forgot stdlib.h/cstdlib for EXIT_SUCCESS)"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1424287208, "post_id": 28591933, "comment_id": 45490573, "body": "Look at the accepted answer here: <a href=\"http://stackoverflow.com/a/26318013/487892\">stackoverflow.com/a/26318013/487892</a>"}, {"owner": {"reputation": 1150, "user_id": 1228757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38d0587b6d790f154a6bad78a6a39e36?s=128&d=identicon&r=PG", "display_name": "scap3y", "link": "https://stackoverflow.com/users/1228757/scap3y"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1424287396, "post_id": 28591933, "comment_id": 45490699, "body": "@drescherjm&#39;s answer worked. Thanks!"}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1424314028, "post_id": 28591933, "comment_id": 45502009, "body": "Since CMake 3.1 there&#39;s the <a href=\"http://www.cmake.org/cmake/help/v3.1/variable/CMAKE_CXX_STANDARD.html\" rel=\"nofollow noreferrer\"><code>CMAKE_CXX_STANDARD</code></a> variable, as well as the whole <a href=\"http://www.cmake.org/cmake/help/v3.1/manual/cmake-compile-features.7.html#manual:cmake-compile-features%287%29\" rel=\"nofollow noreferrer\">CMake compiler features thing</a>.. Otherwise you could just append to <code>CMAKE_CXX_FLAGS</code>."}, {"owner": {"reputation": 2746, "user_id": 894271, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f638548883e3ac44aeefd0ea7bf0bb9c?s=128&d=identicon&r=PG", "display_name": "ar31", "link": "https://stackoverflow.com/users/894271/ar31"}, "edited": false, "score": 0, "creation_date": 1424391094, "post_id": 28591933, "comment_id": 45541715, "body": "Setting CMAKE_CXX_FLAGS doesn&#39;t always work, the better solution is to use <code>add_compile_options(-std=c++11 -g -pthread)</code>"}], "owner": {"reputation": 1150, "user_id": 1228757, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38d0587b6d790f154a6bad78a6a39e36?s=128&d=identicon&r=PG", "display_name": "scap3y", "link": "https://stackoverflow.com/users/1228757/scap3y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "closed_date": 1424287690, "answer_count": 0, "score": 0, "last_activity_date": 1424287630, "creation_date": 1424286742, "last_edit_date": 1424287630, "question_id": 28591933, "link": "https://stackoverflow.com/questions/28591933/cmake-problems-using-stdunique-ptr-with-gcc-4-9", "closed_reason": "Duplicate", "title": "CMAKE problems using std::unique_ptr&lt;&gt; with GCC 4.9", "body": "<p>I am not able to use <code>std::unique_ptr&lt;&gt;</code> while using CMake. This same code is compiling and running perfectly fine on Visual Studio 2012 but it is complaining with the following error while trying to compile on GCC 4.9.2:</p>\n\n<pre><code>test_uniqueptr/src/main.cpp:19:5: error: \"unique_ptr\" is not a member of \"std\"\n     std::unique_ptr&lt;Foo&gt; p1(new Foo);  // p1 owns Foo\n     ^\ntest_uniqueptr/src/main.cpp:19:24: error: expected primary-expression before \"&gt;\" token\n     std::unique_ptr&lt;Foo&gt; p1(new Foo);  // p1 owns Foo\n                        ^\ntest_uniqueptr/src/main.cpp:19:36: error: \"p1\" was not declared in this scope\n     std::unique_ptr&lt;Foo&gt; p1(new Foo);  // p1 owns Foo\n</code></pre>\n\n<p>There is also another related error:</p>\n\n<pre><code>test_uniqueptr/src/main.cpp:34:9: error: \"EXIT_SUCCESS\" was not declared in this scope.\n</code></pre>\n\n<p>My source code is displayed below:</p>\n\n<p><strong>src/main.cpp:</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nstruct Foo\n{\n    Foo()      { std::cout &lt;&lt; \"Foo::Foo\\n\";  }\n    ~Foo()     { std::cout &lt;&lt; \"Foo::~Foo\\n\"; }\n    void bar() { std::cout &lt;&lt; \"Foo::bar\\n\";  }\n};\n\nvoid f(const Foo &amp;)\n{\n    std::cout &lt;&lt; \"f(const Foo&amp;)\\n\";\n}\n\nint main()\n{\n    std::unique_ptr&lt;Foo&gt; p1(new Foo);  // p1 owns Foo\n    if (p1) p1-&gt;bar();\n\n    {\n        std::unique_ptr&lt;Foo&gt; p2(std::move(p1));  // now p2 owns Foo\n        f(*p2);\n\n        p1 = std::move(p2);  // ownership returns to p1\n        std::cout &lt;&lt; \"destroying p2...\\n\";\n    }\n\n    if (p1) p1-&gt;bar();\n\n    // Foo instance is destroyed when p1 goes out of scope\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p><strong>CMakeLists.txt:</strong></p>\n\n<pre><code>CMAKE_MINIMUM_REQUIRED( VERSION 2.8 )\n\nSET( PROJECT_NAME Test_UniquePtr ) # change project name here\n\nSET( SOURCE_DIRECTORY ${PROJECT_SOURCE_DIR}/src )\n\n# Done for temporary testing\nFILE( GLOB MainSources\n    \"${SOURCE_DIRECTORY}/*.h\"\n    \"${SOURCE_DIRECTORY}/*.cpp\"\n)\n\nINCLUDE_DIRECTORIES(\n    ${CMAKE_CURRENT_BINARY_DIR}\n    ${CMAKE_CURRENT_SOURCE_DIR}\n)\n\nADD_EXECUTABLE( \n    ${PROJECT_NAME} \n    ${MainSources} \n)\n\n## Installation (optional)\nSET_TARGET_PROPERTIES( ${PROJECT_NAME} PROPERTIES INSTALL_RPATH_USE_LINK_PATH TRUE )\n\nINSTALL( TARGETS ${PROJECT_NAME} DESTINATION bin )\n</code></pre>\n\n<p>All the answers I have read indicate towards compiling the code using <code>g++ main.cpp -std=c++11</code> but I want it to be done via CMake.</p>\n"}, {"tags": ["c++", "syntax"], "comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1424286255, "post_id": 28591766, "comment_id": 45489999, "body": "<code>const TestList*</code> this is a pointer to a const TestList, <code>const TestListPtr</code> this is a const pointer to a TestList. The compiler won&#39;t let you go from <code>const T</code> to <code>T</code> without a <code>const_cast</code> (or a C-cast <i>shudders</i>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 1, "creation_date": 1424286483, "post_id": 28591766, "comment_id": 45490141, "body": "Note: const Testlist* is a mutable pointer with immutable content, const TestlistPtr is a immutable pointer  with mutable content."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1424287292, "post_id": 28591766, "comment_id": 45490629, "body": "Some fun reading on this subject: <a href=\"http://www.drdobbs.com/conversationsa-midsummer-nights-madness/184403835\" rel=\"nofollow noreferrer\">drdobbs.com/conversationsa-midsummer-nights-madness/18440383&zwnj;&#8203;5</a>"}], "answers": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 7, "last_activity_date": 1424286350, "creation_date": 1424286350, "answer_id": 28591813, "question_id": 28591766, "link": "https://stackoverflow.com/questions/28591766/const-t-vs-typedef/28591813#28591813", "title": "const T* vs typedef", "body": "<p>The compiler is right, all conformant compilers must reject that. The reason is that the declarations group differently:</p>\n\n<p><code>const TestList * p1</code> declares <code>p1</code> to be a pointer to a constant <code>TestList</code>.</p>\n\n<p><code>const TestListPtr p2</code> declares <code>p2</code> to be a constant <code>TestListPtr</code>. <code>TestListPtr</code> is a pointer to (non-constant) <code>TestList</code>. Spelling out <code>p2</code> without the typedef is this:</p>\n\n<pre><code>TestList * const p2 = p1;\n</code></pre>\n"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1424287712, "creation_date": 1424287712, "answer_id": 28592210, "question_id": 28591766, "link": "https://stackoverflow.com/questions/28591766/const-t-vs-typedef/28592210#28592210", "title": "const T* vs typedef", "body": "<p>This is one place where the syntax of the language is not intuitive.</p>\n\n<pre><code>int const i;\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>const int i;\n</code></pre>\n\n<p>When you mix pointers, there are four possible options:</p>\n\n<pre><code>int* p1;               // You can modify both p1 and *p1\nint const* p2;         // You can modify p2 but not *p2\nint* const p3;         // You can not modify p3 but can modify *p3\nint const* const p3;   // You can not modify p4 or *p4\n</code></pre>\n\n<p>Unfortunately, you can write</p>\n\n<pre><code>int const* p2;\n</code></pre>\n\n<p>as</p>\n\n<pre><code>const int* p2;\n</code></pre>\n\n<p>also, which is the source of your confusion.</p>\n\n<p>Instead of using</p>\n\n<pre><code>const TestListPtr p2 = p1;\n</code></pre>\n\n<p>if you use</p>\n\n<pre><code>TestListPtr const p2 = p1;\n</code></pre>\n\n<p>it is clear which part of <code>p2</code> is constant. It would be clear that <code>p2</code> cannot be modified by <code>*p2</code> can.</p>\n"}], "owner": {"reputation": 46, "user_id": 4580981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c468f6576bc810aff5b082356616fcc?s=128&d=identicon&r=PG&f=1", "display_name": "AlexK", "link": "https://stackoverflow.com/users/4580981/alexk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1424287712, "creation_date": 1424286167, "last_edit_date": 1424286377, "question_id": 28591766, "link": "https://stackoverflow.com/questions/28591766/const-t-vs-typedef", "title": "const T* vs typedef", "body": "<p>The following code doesn't compile for me in visual studio 2012:</p>\n\n<pre><code>//1. Define struct\nstruct TestList\n{\n...\n};\n\n//2 define a pointer to 1. struct as typedef\ntypedef TestList * TestListPtr;\n\n//3. use it latter on in the code as follows:\n    const TestList* p1 = 0;\n    const TestListPtr p2 = p1;\n</code></pre>\n\n<p>Then, get this compile error:</p>\n\n<pre><code>error C2440: 'initializing' : cannot convert from 'const TestList *' to 'const TestListPtr'\n</code></pre>\n\n<p>An reason why the above can be considered illegal syntax?</p>\n\n<p>Haven't tried it with other compilers yet.</p>\n"}, {"tags": ["c++", "multiple-inheritance"], "comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 2, "creation_date": 1424286474, "post_id": 28591700, "comment_id": 45490136, "body": "It feels sprite and text are parts of your button ... so should be members, not base classes."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1424286648, "post_id": 28591700, "comment_id": 45490242, "body": "As @&#214;&#246;Tiib says, be sure your <code>Button</code> class <i>isA</i> <code>Text</code> and <i>isA</i> <code>Sprite</code> when inheriting from both (I&#39;d suspect it isn&#39;t). You&#39;re asking for a XY-problem, and your design is flawed."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1424286715, "post_id": 28591700, "comment_id": 45490287, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 Notice there&#39;s private inheritance used. That&#39;s not <code>is-a</code>, that&#39;s <code>implemented-in-terms-of-a</code>."}, {"owner": {"reputation": 9, "user_id": 4580900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19c236b647cd4c5aa409573100209e95?s=128&d=identicon&r=PG&f=1", "display_name": "Gamer2015", "link": "https://stackoverflow.com/users/4580900/gamer2015"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1424287202, "post_id": 28591700, "comment_id": 45490567, "body": "hm... well, it feels like you&#39;re right @&#214;&#246;Tiib, thanks!  But is it possible to just Rename the Function in the derived class?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4580900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19c236b647cd4c5aa409573100209e95?s=128&d=identicon&r=PG&f=1", "display_name": "Gamer2015", "link": "https://stackoverflow.com/users/4580900/gamer2015"}, "edited": false, "score": 1, "creation_date": 1424286401, "post_id": 28591803, "comment_id": 45490088, "body": "Nope, i inherit private. And i want to call the Method with a different name to make it obvious which one is used. (just casting the arguments would probably work too)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424286732, "post_id": 28591803, "comment_id": 45490300, "body": "<i>&quot;I believe ...&quot;</i> doesn&#39;t make this a really trustworthy answer."}], "owner": {"reputation": 678, "user_id": 2666293, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0uI26.png?s=128&g=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/2666293/samuel"}, "is_accepted": false, "score": 0, "last_activity_date": 1424286311, "creation_date": 1424286311, "answer_id": 28591803, "question_id": 28591700, "link": "https://stackoverflow.com/questions/28591700/how-do-i-differentiate-between-commonly-named-methods-shared-by-two-components-o/28591803#28591803", "title": "How do I differentiate between commonly named methods shared by two components of my class?", "body": "<p>I believe that you can  call the functions like this</p>\n\n<pre><code>button myButton;\nmyButton.text::setOrigin();\nmyButton.sprite::setOrigin();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1424287341, "post_id": 28592030, "comment_id": 45490662, "body": "That&#39;s not actually an answer to the question. And whether it contains by base-subobject or member-subobject seems unimportant here."}, {"owner": {"reputation": 9, "user_id": 4580900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19c236b647cd4c5aa409573100209e95?s=128&d=identicon&r=PG&f=1", "display_name": "Gamer2015", "link": "https://stackoverflow.com/users/4580900/gamer2015"}, "edited": false, "score": 0, "creation_date": 1424287510, "post_id": 28592030, "comment_id": 45490773, "body": "Well, It&#39;s an anwer to my Problem, not to the question.  I&#39;ll still appoint it as accepted because I&#39;ll have to rework something and doing something like using the same method as in the base but with a different name is probably not really usefull in general"}, {"owner": {"reputation": 156256, "user_id": 33732, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea2bfac80ecc1d368ff3a5bb0e58568?s=128&d=identicon&r=PG", "display_name": "Rob Kennedy", "link": "https://stackoverflow.com/users/33732/rob-kennedy"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1424288345, "post_id": 28592030, "comment_id": 45491266, "body": "I agree, @Deduplicator. This is the accepted answer, but it only really addressed the <i>example</i> that motivated the question, rather than answering the question head-on. I&#39;ve therefore edited the question a little to make this answer fit better."}], "owner": {"reputation": 46, "user_id": 4580981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c468f6576bc810aff5b082356616fcc?s=128&d=identicon&r=PG&f=1", "display_name": "AlexK", "link": "https://stackoverflow.com/users/4580981/alexk"}, "is_accepted": true, "score": 0, "last_activity_date": 1424287116, "creation_date": 1424287116, "answer_id": 28592030, "question_id": 28591700, "link": "https://stackoverflow.com/questions/28591700/how-do-i-differentiate-between-commonly-named-methods-shared-by-two-components-o/28592030#28592030", "title": "How do I differentiate between commonly named methods shared by two components of my class?", "body": "<p>Well, it looks to me that the button is better implemented as containing Sprite and Text.  It won't save you anything on typing, in fact, you'll likely write a little bit more code, but it be a cleaner design.  The button is neither a sprite or text - it can have a sprite and a text.  So making the sprite and text member variables would be a lot more straightforward way of expressing the nature of their relationship.</p>\n\n<p>Also, should the button have an origin different from either the sprite or text, e.g. say, the location of button's corner?</p>\n\n<p>Are all buttons on the system expected to have both the text and the image?\nIs it possible to add other elements to the button with the origin.  I don't know, maybe two text elements with different fonts?</p>\n\n<p>In this case, you may end up aggregating the origin elements.  </p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 4580900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19c236b647cd4c5aa409573100209e95?s=128&d=identicon&r=PG&f=1", "display_name": "Gamer2015", "link": "https://stackoverflow.com/users/4580900/gamer2015"}, "edited": false, "score": 0, "creation_date": 1424287677, "post_id": 28592135, "comment_id": 45490877, "body": "Yeah, I&#39;d have to reimplement them for each Method where i want to change the name, and since this method may be overloaded I&#39;d have to implement a method for each different overload."}], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 0, "last_activity_date": 1424287466, "creation_date": 1424287466, "answer_id": 28592135, "question_id": 28591700, "link": "https://stackoverflow.com/questions/28591700/how-do-i-differentiate-between-commonly-named-methods-shared-by-two-components-o/28592135#28592135", "title": "How do I differentiate between commonly named methods shared by two components of my class?", "body": "<p>You could implement two different named methods:  </p>\n\n<pre><code>class Button : public Sprite, public Text\n{\n  public:\n    void SetSpriteOrigin()\n    {\n      Sprite::SetOrigin();\n    }\n    void SetTextOrigin()\n    {\n      Text::SetOrigin();\n    }\n  private:\n    void SetOrigin(); // Prevent users from using this ambiguous method.\n};\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4580900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19c236b647cd4c5aa409573100209e95?s=128&d=identicon&r=PG&f=1", "display_name": "Gamer2015", "link": "https://stackoverflow.com/users/4580900/gamer2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 28592030, "answer_count": 3, "score": 0, "last_activity_date": 1424288168, "creation_date": 1424285928, "last_edit_date": 1424288168, "question_id": 28591700, "link": "https://stackoverflow.com/questions/28591700/how-do-i-differentiate-between-commonly-named-methods-shared-by-two-components-o", "title": "How do I differentiate between commonly named methods shared by two components of my class?", "body": "<p>I have a class structure that looks something like this:</p>\n\n<pre><code>template &lt;typename T&gt;\nclass Origin\n{\npublic:\n    void SetOrigin(T x, T y) { __x = x; __y = y; }\n    void SetOrigin(vector2&lt;T&gt; vect) { __x = vect.x; __y = vect.y; }\n\nprivate:\n    T __x;\n    T __y;\n}\nclass Sprite : Origin&lt;float&gt;\n{\npublic:\n    using Origin::SetOrigin;\n}\nclass Text : Origin&lt;int&gt;\n{\npublic:\n    using Origin::SetOrigin;\n}\nclass Button : Sprite, Text\n{\npublic:\n    using Sprite::SetOrigin;\n    using Text::SetOrigin;\n}\n</code></pre>\n\n<p>The class <code>Button</code> should have 2 different origins, the origin of the <code>Text</code> (where is the text in the <code>Button</code>) and the origin of the <code>Button</code> itself.</p>\n\n<p>I don't want to have to cast the argument to <code>float</code> or <code>int</code>, because it should be obvious what method is called, so I'd like to call the second one <code>btn.SetTextOrigin(x, y)</code>.</p>\n\n<p>In this very simple case, I can just reimplement the methods with different names, but I have to make as many implementations as there are overloads of <code>SetOrigin</code> in class <code>Sprite</code>.</p>\n\n<p>Is there an easier way to use all <code>SetOrigin</code> methods with a different name than to reimplement all of them? (Implementing 20 functions just to have a different name is pretty boring.)</p>\n\n<p>For example, is it possible to change the name of a method in the derived class without rewriting each overloaded function? I think of something like: </p>\n\n<pre><code>using Text::SetOrigin as SetTextOrigin;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>using SetTextOrigin = Text::SetOrigin\n</code></pre>\n\n<p>But I haven't found anything, if there is nothing like that, what would you suggest doing in that case?</p>\n"}, {"tags": ["c++", "opengl", "visual-studio-2013", "glfw", "glew"], "comments": [{"owner": {"reputation": 1293, "user_id": 559751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ZXCr8.jpg?s=128&g=1", "display_name": "BonzaiThePenguin", "link": "https://stackoverflow.com/users/559751/bonzaithepenguin"}, "edited": false, "score": 0, "creation_date": 1424286115, "post_id": 28591612, "comment_id": 45489914, "body": "Linking isn&#39;t the only issue, you also need to include the correct header. When I checked Google it said the function is defined in Wingdi.h."}, {"owner": {"reputation": 1249, "user_id": 2903567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/378bI.png?s=128&g=1", "display_name": "matt-pielat", "link": "https://stackoverflow.com/users/2903567/matt-pielat"}, "reply_to_user": {"reputation": 1293, "user_id": 559751, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ZXCr8.jpg?s=128&g=1", "display_name": "BonzaiThePenguin", "link": "https://stackoverflow.com/users/559751/bonzaithepenguin"}, "edited": false, "score": 0, "creation_date": 1424286392, "post_id": 28591612, "comment_id": 45490085, "body": "This generates a few hundred errors (mostly missing &#39;;&#39;)."}, {"owner": {"reputation": 283, "user_id": 5778786, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-X0h6DNSZhYY/AAAAAAAAAAI/AAAAAAAAAZg/Q07JX5NHJoE/photo.jpg?sz=128", "display_name": "Suici Doga", "link": "https://stackoverflow.com/users/5778786/suici-doga"}, "edited": false, "score": 0, "creation_date": 1492615122, "post_id": 28591612, "comment_id": 74053803, "body": "The tutorial says do not run this code"}], "answers": [{"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 4, "last_activity_date": 1424286488, "creation_date": 1424286488, "answer_id": 28591859, "question_id": 28591612, "link": "https://stackoverflow.com/questions/28591612/wglgetprocaddress-is-undefined/28591859#28591859", "title": "wglGetProcAddress is undefined", "body": "<p>This is not a linker error, this is a compiler error - so the libraries you link do not matter at this stage at all.</p>\n\n<p>Your compiler is telling you that it doesn't know <code>wglGetProcAddress</code>, because it never saw a declaration for this. Your compiler should also not know <code>GENBUFFERS</code>, as this type is not defined anywhere either. In the <a href=\"https://www.opengl.org/registry/api/GL/glext.h\" rel=\"nofollow\">official <code>glext.h</code> file</a>, the type you are looking for is called <code>PFNGLGENBUFFERS</code>.</p>\n\n<p>If you really want to manually use the <code>wgl</code> API, you probably should include <code>GL/gl.h</code> along with the latest <code>glext.h</code>and use the correct type names.</p>\n\n<p>The big question to me is: What you are trying to do at all here? You are including <code>glew.h</code>, which is a library those sole purpose is to do the GL function pointer queries for you. All you need to do is calling <code>glewInit()</code> and you're done (well, don't forget to set <code>glewExperimental=GL_TRUE</code> before in a core profile, since GLEW is broken and won't work without that in core profiles). No need to mess with <code>wglGetProcAddress()</code> manually at all.</p>\n\n<p>Furthermore, you are also using GLFW. So if you manually want to query the function pointers, you would be best of using GLFW's abstraction of the platform specific pointer query APIs, which would be <code>glfwGetProcAddress()</code>, and should at already be declared - again no need to mess with <code>wglGetProcAddress()</code>.</p>\n"}], "owner": {"reputation": 1249, "user_id": 2903567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/378bI.png?s=128&g=1", "display_name": "matt-pielat", "link": "https://stackoverflow.com/users/2903567/matt-pielat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3058, "favorite_count": 1, "accepted_answer_id": 28591859, "answer_count": 1, "score": 1, "last_activity_date": 1424286488, "creation_date": 1424285643, "last_edit_date": 1592644375, "question_id": 28591612, "link": "https://stackoverflow.com/questions/28591612/wglgetprocaddress-is-undefined", "title": "wglGetProcAddress is undefined", "body": "<p>I'm following <a href=\"https://open.gl/context\" rel=\"nofollow noreferrer\">this</a> OpenGL tutorial but I'm stuck on linking libraries.</p>\n<pre><code>#define GLEW_STATIC\n\n#include &lt;glew.h&gt;\n#include &lt;glfw3.h&gt;\n#include &lt;thread&gt;\n\n\ntypedef void (*GENBUFFERS) (GLsizei, GLuint*);\n\nint main()\n{\n    glfwInit();\n\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);\n    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 2);\n    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\n    glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);\n\n    glfwWindowHint(GLFW_RESIZABLE, GL_FALSE);\n\n    GLFWwindow* window = glfwCreateWindow(800, 600, &quot;OpenGL&quot;, nullptr, nullptr);\n\n    glfwMakeContextCurrent(window);\n\n    while (glfwWindowShouldClose(window))\n    {\n        glfwSwapBuffers(window);\n        glfwPollEvents();\n    }\n\n    GENBUFFERS glGenBuffers = (GENBUFFERS) wglGetProcAddress(&quot;glGenBuffers&quot;);\n    GLuint buffer;\n    glGenBuffers(1, &amp;buffer);\n\n\n    glfwTerminate();\n}\n</code></pre>\n<p>For some reason function <code>wglGetProcAddress</code> is undefined. These are the libs I linked: glew32.lib, glew32s.lib, glfw3.lib, opengl32.lib.</p>\n<p>MSDN <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd374386%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">says</a> that <code>wglGetProcAddress</code> is included in opengl32.lib. What am I doing wrong?</p>\n<blockquote>\n<p>Error  1   error C3861: 'wglGetProcAddress': identifier not found  e:\\workspaces\\visual studio\\learningopengl1\\learningopengl1\\main.cpp    32  1   LearningOpenGl1</p>\n<p>2   IntelliSense: identifier &quot;wglGetProcAddress&quot; is undefined   e:\\Workspaces\\Visual Studio\\LearningOpenGl1\\LearningOpenGl1\\main.cpp    34  41  LearningOpenGl1</p>\n</blockquote>\n"}, {"tags": ["c++", "visual-studio", "header", "g++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424285921, "post_id": 28591558, "comment_id": 45489780, "body": "Was <code>lexer.c</code> compiled using <code>gcc</code> (i.e. the c-compiler), not <code>g++</code> actually?"}, {"owner": {"reputation": 7, "user_id": 3426951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f822f8deeeb85699c3af55e42f12882e?s=128&d=identicon&r=PG&f=1", "display_name": "robo", "link": "https://stackoverflow.com/users/3426951/robo"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424286692, "post_id": 28591558, "comment_id": 45490271, "body": "No, it was compiled using g++."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424286945, "post_id": 28591558, "comment_id": 45490428, "body": "<i>&quot;No, it was compiled using <code>g++</code>&quot;</i> Then this was probably wrong, use <code>gcc</code> to compile it as c-code. The marked duplicate has some explanations about c++ name mangling, and how linkage is affected by this."}, {"owner": {"reputation": 7, "user_id": 3426951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f822f8deeeb85699c3af55e42f12882e?s=128&d=identicon&r=PG&f=1", "display_name": "robo", "link": "https://stackoverflow.com/users/3426951/robo"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424290419, "post_id": 28591558, "comment_id": 45492551, "body": "The compiler automatically compiles as g++. The three files are main.cpp, lexer.c, and lexer.h. I believe it is compiling correctly in this respect?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424290499, "post_id": 28591558, "comment_id": 45492603, "body": "<i>&quot;The compiler automatically compiles as g++.&quot;</i> What do you mean? How is it called? From an IDE or a makefile? You either remove the <code>extern &quot;C&quot;</code> block surrounding the <code>#include &quot;lexer.h&quot;</code> statement, or manage getting <code>lexer.c</code> compiled as plain c code."}], "owner": {"reputation": 7, "user_id": 3426951, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f822f8deeeb85699c3af55e42f12882e?s=128&d=identicon&r=PG&f=1", "display_name": "robo", "link": "https://stackoverflow.com/users/3426951/robo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "closed_date": 1424285644, "answer_count": 0, "score": 0, "last_activity_date": 1424285477, "creation_date": 1424285477, "question_id": 28591558, "link": "https://stackoverflow.com/questions/28591558/g-compile-fail-not-linking-to-header-correctly", "closed_reason": "Duplicate", "title": "G++ Compile Fail (Not Linking to header correctly)", "body": "<p>I have code that compiles correctly in Visual Studios. I need to compile it using g++ but when I do I get a something like the text below. From what I understand this means it's not properly linking he header file that the undefined references are supposed to come from. The way I am linking them is also posted. Please suggest a fix?</p>\n\n<pre><code>extern \"C\" \n{\n    #include \"lexer.h\"\n}\n</code></pre>\n\n<p>\"COMPILE_FAIL\nSource.cpp: In function \u2018void checkForAllRightEpsilon()\u2019:\n/tmp/ccQGWPkN.o: In function <code>parseFile()':\nSource.cpp:(.text+0xe86): undefined reference to</code>getToken'\n...\n/tmp/ccQGWPkN.o:Source.cpp:(.text+0x1249): more undefined references to `token' follow\"</p>\n"}, {"tags": ["c++", "xcode", "macos", "templates"], "comments": [{"owner": {"reputation": 11800, "user_id": 1594913, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tLf29.jpg?s=128&g=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/1594913/jbl"}, "edited": false, "score": 2, "creation_date": 1424285280, "post_id": 28591469, "comment_id": 45489367, "body": "Could you post the relevant code?"}, {"owner": {"reputation": 9, "user_id": 4580875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a977754c16949233bd4d36dcd51d8a4d?s=128&d=identicon&r=PG&f=1", "display_name": "CrEmUp", "link": "https://stackoverflow.com/users/4580875/cremup"}, "reply_to_user": {"reputation": 11800, "user_id": 1594913, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tLf29.jpg?s=128&g=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/1594913/jbl"}, "edited": false, "score": 0, "creation_date": 1424287090, "post_id": 28591469, "comment_id": 45490508, "body": "Excuse me but what is there to post? The usage is quite simple value = clamp(something,min,max). I simply would like to know, what do I have to do, to use regular templates in XCode, every programmer with some basic knowledge should know that. Seeing that I get downvotes on a quite simple question I&#39;m not quite up to sharing code to a community where questions remain unsolved. Sorry."}, {"owner": {"reputation": 11800, "user_id": 1594913, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tLf29.jpg?s=128&g=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/1594913/jbl"}, "edited": false, "score": 0, "creation_date": 1424287885, "post_id": 28591469, "comment_id": 45490986, "body": "If you don&#39;t give us the tools to help you, that&#39;s going to be hard. And as such, it&#39;s on hold. Post the code where you call it. Even a &quot;quite simple usage&quot; like <code>clamp(something,min,max)</code> can fail to compile. It&#39;s completely up to you if you want help."}, {"owner": {"reputation": 9, "user_id": 4580875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a977754c16949233bd4d36dcd51d8a4d?s=128&d=identicon&r=PG&f=1", "display_name": "CrEmUp", "link": "https://stackoverflow.com/users/4580875/cremup"}, "reply_to_user": {"reputation": 11800, "user_id": 1594913, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tLf29.jpg?s=128&g=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/1594913/jbl"}, "edited": false, "score": 0, "creation_date": 1424289325, "post_id": 28591469, "comment_id": 45491876, "body": "Updated my post to suit the requirements."}], "answers": [{"owner": {"reputation": 11800, "user_id": 1594913, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tLf29.jpg?s=128&g=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/1594913/jbl"}, "is_accepted": false, "score": 0, "last_activity_date": 1424290741, "creation_date": 1424290741, "answer_id": 28593109, "question_id": 28591469, "link": "https://stackoverflow.com/questions/28591469/xcode-gives-an-error-with-c-templates/28593109#28593109", "title": "XCode gives an error with C++ templates", "body": "<p>And there it is. The code you posted cannot compile as it is currently.</p>\n\n<p>Indeed, the signature of your templated function is <code>T(const T&amp;, const T&amp;, const T&amp;)</code> which means the three arguments must share the same type., but you pass a <code>float</code> and two <code>int</code>s.\nClang will give you a nice error message about that: </p>\n\n<blockquote>\n  <p>candidate template ignored: deduced conflicting types for parameter 'T' ('float' vs. 'int')</p>\n</blockquote>\n\n<p>Either use arguments that share the same type, or change the template arguments so that it may accepts different types, i.e.</p>\n\n<pre><code>template&lt;typename T, typename U, typename V&gt;\nT (const T&amp;, const U&amp;, const V&amp;)\n{...}\n</code></pre>\n\n<p>You can even use type traits if you want to force types to have some properties (e.g. <code>std::is_arithmetic</code>).</p>\n"}], "owner": {"reputation": 9, "user_id": 4580875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a977754c16949233bd4d36dcd51d8a4d?s=128&d=identicon&r=PG&f=1", "display_name": "CrEmUp", "link": "https://stackoverflow.com/users/4580875/cremup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1424290741, "creation_date": 1424285208, "last_edit_date": 1424288959, "question_id": 28591469, "link": "https://stackoverflow.com/questions/28591469/xcode-gives-an-error-with-c-templates", "title": "XCode gives an error with C++ templates", "body": "<p>When I'm using custom templates, that work in VS2010, I get an error.\nIt's obviously because the systems are different, but how can I make XCode read the templates? \nHere's the templates file:</p>\n\n<pre><code>#ifndef TEMPLATE_H_INCLUDED\n#define TEMPLATE_H_INCLUDED\n#include &lt;algorithm&gt;\n#include &lt;math.h&gt;\n#include &lt;vector&gt;\n#include &lt;cmath&gt;        // std::abs\n#include &lt;float.h&gt;\n\nusing namespace std;\n\nnamespace Geometry\n{\n\n    #if _MSC_VER // this is defined when compiling with Visual Studio\n        #define M_PI 3.14159265358979f\n    #endif\n        #define Deg2Rad(deg)  ((deg) * M_PI / 180)\n\n        #define Rad2Deg(rad)  ((rad) * 180 / M_PI)\n\n        template &lt;typename T&gt; int sgn(T val)\n        { return (T(0) &lt; val) - (val &lt; T(0)); }\n\n        template &lt;typename T&gt; bool isnan (T value)\n        { return value != value; }\n\n        template &lt;typename T&gt; T Clamp(const T&amp; value, const T&amp; low, const T&amp; high)\n        {\n          return value &lt; low ? low : (value &gt; high ? high : value);\n        }\n        template &lt;typename T&gt; T Clamp01(const T&amp; value)\n        {\n          return value &lt; 0 ? 0 : (value &gt; 1 ? 1 : value);\n        }\n        /// Return the real part of the square root of x.\n        inline float fsqrtf (float x)\n        { return x &gt; 0.0f ? std::sqrt (x) : 0.0f; }\n\n};\n</code></pre>\n\n<p>What I'm doing with this header, is quite simple.\nI simply include the header and start using the templates.\nThey work in VS2010 but they don't in XCode, so how can I solve this issue?\nI also am using namespace Geometry in the start of the cpp file.</p>\n\n<p>Here's the error message:</p>\n\n<pre><code> No matching function for call to 'Clamp'\n</code></pre>\n\n<p>As Requested by JBL, heres the code:</p>\n\n<pre><code>#include \"templates.h\"\nusing namespace Geometry;\n\nclass Curve\n{\n    public:\n        GetClampedValue(float value);\n};\n\n#include \"myclass.h\"\nvoid MyClass::GetClampedValue(float value)\n{\n    return Clamp(value,-1,1);// Error Here\n}\n</code></pre>\n"}, {"tags": ["c++", "assembly", "linker", "masm"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1424285245, "post_id": 28591452, "comment_id": 45489334, "body": "Why such a big left margin? And you might want to dump the symbols from &quot;main.o&quot;, to see what the decorated names are."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1424285410, "post_id": 28591452, "comment_id": 45489449, "body": "<code>extern &quot;C&quot; int promptFirst();</code>, otherwise <code>promptFirst()</code> will have a mangled name."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1424341063, "post_id": 28591452, "comment_id": 45512357, "body": "<i>&quot;However now it still doesn&#39;t seem to be calling the functions, ie. prompting the user for input.&quot;</i> Where are you expecting the call to <code>promptFirst</code> to come from? All you do in the code you&#39;ve shown us is <code>mov first, promptFirst</code>, which doesn&#39;t perform any function call. All that <code>mov</code> does it read the first DWORD located at the address of <code>promptFirst</code> and store it into <code>first</code>."}], "answers": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1424285392, "creation_date": 1424285392, "answer_id": 28591531, "question_id": 28591452, "link": "https://stackoverflow.com/questions/28591452/calling-c-functions-in-masm/28591531#28591531", "title": "Calling C++ functions in MASM", "body": "<p>The problem is that C++ compilers <a href=\"http://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B\" rel=\"nofollow\"><em>mangles</em> the symbols</a>, which is one of the reasons behind the <code>extern \"C\"</code> construct, so that symbols are not mangled.</p>\n\n<p>If you declare the function to be <code>extern \"C\"</code> then the compiler will not mangle the name, just like you do with the assembler function you call.</p>\n"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 2, "last_activity_date": 1424285486, "creation_date": 1424285486, "answer_id": 28591559, "question_id": 28591452, "link": "https://stackoverflow.com/questions/28591452/calling-c-functions-in-masm/28591559#28591559", "title": "Calling C++ functions in MASM", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/20y05bd5.aspx\" rel=\"nofollow\"><code>dumpbin.exe</code></a> on your object-file to get the mangled name of your C++ functions.</p>\n\n<p>Or ask for a symbol with C-linkage using <code>extern \"C\"</code> on the function-declarations in your C++ code.</p>\n\n<p>Then you will know what to call in your assembly-code.</p>\n"}], "owner": {"reputation": 987, "user_id": 2808815, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/70187014304e474cc2faedcbb3974c58?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Caruso", "link": "https://stackoverflow.com/users/2808815/joe-caruso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2963, "favorite_count": 2, "accepted_answer_id": 28591531, "answer_count": 2, "score": 1, "last_activity_date": 1485828284, "creation_date": 1424285159, "last_edit_date": 1592644375, "question_id": 28591452, "link": "https://stackoverflow.com/questions/28591452/calling-c-functions-in-masm", "title": "Calling C++ functions in MASM", "body": "<p>I'm working on a program that will use MASM to call some C++ functions. I defined, in a separate file, to sum 2 integers and display the output.</p>\n<p>Currently, I can't get 'main.cpp' to run <code>asmMain()</code> to call functions from 'main.cpp'.</p>\n<h3>code.asm</h3>\n<pre><code>; ---------------------------------------\n    \npromptFirst PROTO C\npromptSecond PROTO C\nprintInt PROTO C\n\n.586\n.model flat, stdcall\n\n.stack 4096\n\n; ---------------------------------------\n\n.DATA\n\nfirst DWORD 0\nsecond DWORD 0\n\n; --------------------------------\n\n.CODE\n\nasmMain PROC C  \n    mov first, promptFirst              \n    ret \nasmMain ENDP\n\nPUBLIC asmMain  \nEND\n</code></pre>\n<h3>main.cpp</h3>\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nvoid asmMain();\n\nint promptFirst();\nint promptSecond();\nvoid printInt(int myint);\n    \nint main() {\n    asmMain();\n}\n\nint promptFirst() {\n    cout &lt;&lt; &quot; The first number = &quot;;\n    int newint;\n    cin &gt;&gt; newint;\n\n    return newint;\n}\n\nint promptSecond() {\n    cout &lt;&lt; &quot;\\nThe second number = &quot;;\n    int newint;\n    cin &gt;&gt; newint;\n\n    return newint;\n}\n\nvoid printInt(int myint) {\n    cout &lt;&lt; myint;\n}\n</code></pre>\n<p>The error I get for the current code is such:</p>\n<blockquote>\n<p>Build started: Project: Project_Name, Configuration: Debug Win32<br />\nmain.cpp<br />\ncode.obj: error LNK2019: unresolved external symbol _promptFirst referenced in function _asmMain</p>\n</blockquote>\n<p>Any hints on how to resolve this?</p>\n"}, {"tags": ["c++", "boost-thread"], "comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 4, "creation_date": 1424285009, "post_id": 28591370, "comment_id": 45489208, "body": "It&#39;s not dangerous to read global variables concurrently from multiple threads (assuming basic data types - more complex data structures could involve updating state during what appears to be a read operation).  However, if the variable is being written to, that&#39;s a very different story."}, {"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 3, "creation_date": 1424285064, "post_id": 28591370, "comment_id": 45489240, "body": "This is undefined behaviour, and yes, quite dangerous in practice, depending on your platform. In particular, even if the type is of a machine word size and your CPU gives you atomic reads/writes (assuming proper alignment) to machine words, the memory ordering of other reads/writes will almost certainly not be what you expect."}, {"owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "edited": false, "score": 1, "creation_date": 1424285923, "post_id": 28591370, "comment_id": 45489783, "body": "Reading in absence of writing is always safe. Reading while another thread writes is, under normal conditions, <i>practically</i> safe with the exception of not guaranteeing a particular order (since all CPUs work with caches and cannot access memory non-atomically except if you cross a cacheline -- which won&#39;t happen if you have standard alignment) but is not defined by the C++ standard. Note that <i>writing to</i> and e.g. <i>incrementing</i> a variable are very different things (writes being <i>practically</i> safe but not theoretically, and read-modify-write operations being <i>not safe at all</i>)."}, {"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "edited": false, "score": 0, "creation_date": 1424286227, "post_id": 28591370, "comment_id": 45489986, "body": "The op clearly states both writing and reading at the same time."}], "answers": [{"comments": [{"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424285703, "post_id": 28591414, "comment_id": 45489631, "body": "oh, then a simple yes would have been sufficient."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424285885, "post_id": 28591414, "comment_id": 45489755, "body": "Now that it says &quot;Yes&quot;: downvote is changed to upvote and comment removed."}, {"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1424286102, "post_id": 28591414, "comment_id": 45489900, "body": "I try to improve if I can."}], "owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "is_accepted": false, "score": 2, "last_activity_date": 1424285808, "last_edit_date": 1424285808, "creation_date": 1424285026, "answer_id": 28591414, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28591414#28591414", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>The simple answer is yes. Once variables are starting to be shared amongs multiple threads for both reading and writing you will need some kind of protection.\nThere are different flavours to achieve this :\nSemaphores,\nlocks,\nmutex,\nevents,\ncritical section\nmessage queues.\nEspecially when your globals are references things can become ugly.\nSuppose you have global list of objects in a consumers / producers scenario with multiple consumers, the producer instantiates objects, the consumer takes them, does something with them and finally disposes them, without protection of some sort this leads to terrible problems.\nThere is a lot of specialised literature about this topic and there are dedicated college courses about this topic, and well known problems that are being given to students. For instance the dining philosefers problem, howto make a readerswritersemaphore without starvation, ... .\nInteresting book : the little book about semaphores.</p>\n"}, {"owner": {"reputation": 3552, "user_id": 335794, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9a06031c83e483b8ff7720a9d30fdca7?s=128&d=identicon&r=PG", "display_name": "Telavian", "link": "https://stackoverflow.com/users/335794/telavian"}, "is_accepted": false, "score": 1, "last_activity_date": 1424285052, "creation_date": 1424285052, "answer_id": 28591420, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28591420#28591420", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>This really depends on a number of factors but is generally a bad idea and can lead to <a href=\"http://en.wikipedia.org/wiki/Race_condition\" rel=\"nofollow\">race conditions</a>. You can avoid this by locking the value so that reads and writes are all atomic and thus can't collide.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 0, "creation_date": 1424285743, "post_id": 28591431, "comment_id": 45489669, "body": "Ok! I have no plans for simultaneous writes, and it doesn&#39;t affect me whether I read before or after. So I guess I don&#39;t need mutexes, your answer corroborates with one of my co-worker (who just got to the lab)."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 4, "creation_date": 1424285746, "post_id": 28591431, "comment_id": 45489673, "body": "Concurrent read+write is not safe unless the write is atomic.  If the write is not atomic, then read+write is not safe.  If I have a variable 0x0F, and one thread reads it at the same time a second thread writes 0x10, then it could be the 0x1 gets writen, then the first thread reads 0x1F, then the second thread writes the 0xF.  Thus, the read thread got a completely unsafe invalid value."}, {"owner": {"reputation": 1373, "user_id": 655027, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d94649cf365de22fa125f0a45f5ebb4?s=128&d=identicon&r=PG", "display_name": "rubikonx9", "link": "https://stackoverflow.com/users/655027/rubikonx9"}, "edited": false, "score": 0, "creation_date": 1424328524, "post_id": 28591431, "comment_id": 45506193, "body": "My bad! I was unaware. I&#39;ll edit the answer, thanks for pointing it out."}], "owner": {"reputation": 1373, "user_id": 655027, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d94649cf365de22fa125f0a45f5ebb4?s=128&d=identicon&r=PG", "display_name": "rubikonx9", "link": "https://stackoverflow.com/users/655027/rubikonx9"}, "is_accepted": false, "score": -1, "last_activity_date": 1424328541, "last_edit_date": 1424328541, "creation_date": 1424285095, "answer_id": 28591431, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28591431#28591431", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>Concurrent writes are not safe. Concurrent read and write are always safe (assuming atomic writes), but you never know whether you've read the value before or after write.</p>\n\n<p>Main thread behaves just the same as spawned threads, there's no difference at all.</p>\n\n<p>So, for concurrent write you'll need mutexes.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 0, "creation_date": 1424285761, "post_id": 28591446, "comment_id": 45489686, "body": "But mutexes are used for simultaneous writes right?"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 0, "creation_date": 1424285846, "post_id": 28591446, "comment_id": 45489733, "body": "@ch0l1n3: No, you need mutexes for a write+anything."}, {"owner": {"reputation": 34, "user_id": 3877712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4nlY.jpg?s=128&g=1", "display_name": "FrankieTheSkin", "link": "https://stackoverflow.com/users/3877712/frankietheskin"}, "edited": false, "score": 1, "creation_date": 1424285928, "post_id": 28591446, "comment_id": 45489789, "body": "They can be used for anything that needs to prevent multiple threads from accessing the same resource at the same time, all it does is refusing to be re-acquired before it&#39;s been released, there&#39;s nothing more to it."}, {"owner": {"reputation": 34, "user_id": 3877712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4nlY.jpg?s=128&g=1", "display_name": "FrankieTheSkin", "link": "https://stackoverflow.com/users/3877712/frankietheskin"}, "edited": false, "score": 0, "creation_date": 1424286124, "post_id": 28591446, "comment_id": 45489919, "body": "Okay, why are correct answers being downvoted on this thread?"}], "owner": {"reputation": 34, "user_id": 3877712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F4nlY.jpg?s=128&g=1", "display_name": "FrankieTheSkin", "link": "https://stackoverflow.com/users/3877712/frankietheskin"}, "is_accepted": false, "score": 0, "last_activity_date": 1424285147, "creation_date": 1424285147, "answer_id": 28591446, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28591446#28591446", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>You must create a mutex (mutual exclusion object), only one thread at a time can own the mutex, and use it to control access to the variables. <a href=\"https://msdn.microsoft.com/en-us/library/z3x8b09y.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/z3x8b09y.aspx</a> </p>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 1, "creation_date": 1424285807, "post_id": 28591574, "comment_id": 45489712, "body": "&quot;If only one thread writes while others read&quot; - in the absence of synchronization, unless nobody reads what that thread wrote, it&#39;s UB, period."}, {"owner": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 0, "creation_date": 1424286050, "post_id": 28591574, "comment_id": 45489871, "body": "Ok! So since I don&#39;t care about synchronization, then it&#39;s perfect! I was just afraid the value would get cut off because the worker thread hasn&#39;t finished writing, etc."}], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 4, "last_activity_date": 1424285536, "creation_date": 1424285536, "answer_id": 28591574, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28591574#28591574", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>If your different threads only read values of global variables, there will be no problem.</p>\n\n<p>If more than one thread tries to update same variable (example read, add 1 write), then you <strong>must</strong> use a synchronization system to ensure that the value cannot be modified between the read and the write.</p>\n\n<p>If only one thread writes while others read, it depends. If the different variables are unrelated, say number of apples and oranges in a basket, you do not need any synchronization, provided you accept not exactly accurate values. But if the values are related say amount of money on two bank accounts with a transfert between them, you need synchronization to ensure that what you read is coherent. It could be too old when you use it because it has already be updated but you have coherent values.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 0, "creation_date": 1424287294, "post_id": 28591924, "comment_id": 45490633, "body": "Well, the global variable I am talking about is simply storing an integer. It contains the position of some sensor and gets updated by the worker thread. The main thread can look at that value and depending on what the value is it does some more work. I&#39;m researching atomic operations atm, so I&#39;m not too sure if that counts as one."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 1, "creation_date": 1424287522, "post_id": 28591924, "comment_id": 45490777, "body": "@ch0l1n3 Unless you are using something in <code>&lt;atomic&gt;</code> (or the boost equivalent), it isn&#39;t."}, {"owner": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 0, "creation_date": 1424287954, "post_id": 28591924, "comment_id": 45491030, "body": "So I can solve this by adding a mutex lock whenever the worker thread is writing to the global var?"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "edited": false, "score": 1, "creation_date": 1424288500, "post_id": 28591924, "comment_id": 45491375, "body": "@ch0l1n3: Sounds like all you need is to replace the <code>int</code> with a <code>std::atomic&lt;int&gt;</code>."}], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 10, "last_activity_date": 1424286724, "creation_date": 1424286724, "answer_id": 28591924, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28591924#28591924", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>\u00a71.10 [intro.multithread] (quoting N4140):</p>\n\n<blockquote>\n  <p>6 Two expression evaluations <em>conflict</em> if one of them modifies a\n  memory location (1.7) and the other one accesses or modifies the same\n  memory location.</p>\n  \n  <p>23 Two actions are <em>potentially concurrent</em> if</p>\n  \n  <ul>\n  <li>they are performed by different threads, or</li>\n  <li>they are unsequenced, and at least one is performed by a signal handler.</li>\n  </ul>\n  \n  <p>The execution of a program contains a <em>data race</em> if it contains two\n  potentially concurrent conflicting actions, at least one of which is\n  not atomic, and neither happens before the other, except for the\n  special case for signal handlers described below. Any such data race\n  results in undefined behavior.</p>\n</blockquote>\n\n<p><em>Purely</em> concurrent reads do not conflict, and so is safe.</p>\n\n<p>If at least one of the threads write to a memory location, and another reads from that location, then they conflict and are potentially concurrent. The result is a data race, and hence undefined behavior, unless appropriate synchronization is used, either by using atomic operations for all reads and writes, or by using synchronization primitives to establish a <em>happens before</em> relationship between the read and the write.</p>\n"}, {"owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "is_accepted": false, "score": 2, "last_activity_date": 1424288643, "creation_date": 1424288643, "answer_id": 28592495, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28592495#28592495", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<h2>Yes. No. Maybe.</h2>\n\n<p>The formally correct answer is: <em>This is not safe</em>.</p>\n\n<p>The practical answer is not that easy. It's something like <em>\"This is safe, kind of, under some conditions\"</em>.</p>\n\n<p>Reads (any number of them) in absence of concurrent writes are <em>always</em> safe. Reads (even a single one) in presence of concurrent writes (even a single one) are <em>formally</em> never safe, but they are atomic on most processors in most situations, and this can be <em>just good enough</em>. Changing values (like incrementing a counter) is nearly always troublesome, even in practice, without explicitly using atomic operations.</p>\n\n<h2>Atomicity</h2>\n\n<p>The C++ standard mandates that you use <a href=\"http://en.cppreference.com/w/cpp/atomic/atomic\" rel=\"nofollow\"><code>std::atomic</code></a> or one of its specializations (or higher level synchronization primitives), or you are doomed. Demons will fly out of your nose (no, they won't... but as far as the standard goes, they might as well).</p>\n\n<p>All real, non-theoretical CPUs access memory exclusively via cache lines except in very special conditions which you must expclicitly provoke (such as using write-combining instructions). An entire cache line can be read or written to, atomically, at a time -- never anything different. Reading any memory location that is being written to might not give the value that you expect (if it has been updated in the mean time), but it will never return a \"garbage\" value.<br>\nNow of course a variable <em>might</em> cross a cacheline, in which case access isn't atomic, but unless you deliberately provoke it, this will not happen (since integral variables are power-of-two sized such as 2, or 4, or 8, and cache lines are also power-of-two sized and larger such as 64 or 128 -- if your variables are properly aligned to the former as by default, they are <em>automatically</em> also completely contained within the latter. Always.).</p>\n\n<h2>Ordering</h2>\n\n<p>Although your reads (and writes) may be atomic, and you might say that you only care whether some flag is zero or not so who cares even if a value is garbled, you don't have a guarantee that things happen in the order that you expect!<br>\nThe \"normal\" expectation that if you say that A happens before B, then A indeed happens before B and A <em>can be seen by someone else</em> before B is generally <strong>not true</strong>. In other words, it is perfectly possible that your worker thread prepares some data and then sets the <code>ready</code> flag. Your main thread sees that the <code>ready</code> flag is set, and begins reading some random garbage while the real data is still on its way somewhere in the cache hierarchy. Or maybe half of it is visible to the main thread already, but the other half isn't.</p>\n\n<p>For this, C++11 introduced the concept of <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"nofollow\">memory order</a>. This means no more and no less than besides having the guarantee of atomicity, you <em>also</em> have a way of requesting a happens-before guarantee.<br>\nMost of the time, this only prevents the compiler from moving around loads and stores, but on some architectures, it may cause special instructions to be emitted (that's not your problem, though).</p>\n\n<h2>Read-Modify-Write</h2>\n\n<p>This is a particularly nefarious one. A simple thing like <code>++flag;</code> can be desastrous. This is <em>not at all the same</em> as <code>flag = 1;</code></p>\n\n<p>Without using proper atomic instructions, this is <strong>never</strong> safe, as it involves (atomically) reading, then modifying, and then (atomically) writing a cache line.<br>\nThe problem is, while reading and writing are both atomic, the whole thing isn't. Nor is there any guarantee about ordering.</p>\n\n<h2>Solution?</h2>\n\n<p>Either use <code>std::atomic</code> or block on a condition variable. The former will involve spinning, which may or may not be detrimental (depending on the frequency and latency requirements) while the latter will be CPU conservative.<br>\nYou could use a <code>mutex</code> to synchronize access to the global variable, too, but if you involve a heavyweight primitive, you might as well go for the condition variable instead of spinning (which will be the \"correct\" approach).</p>\n"}, {"owner": {"reputation": 11, "user_id": 4581012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eGgyeBS5ocU/AAAAAAAAAAI/AAAAAAAAI-s/xZhj0iB2pik/photo.jpg?sz=128", "display_name": "rokumar", "link": "https://stackoverflow.com/users/4581012/rokumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1424289071, "creation_date": 1424289071, "answer_id": 28592620, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th/28592620#28592620", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>This actually points to a race condition between writer thread and reader thread. The places where we access/write the global variable would be the critical sections of the code. Ideally we must synchronize between the read/write threads whenever we operate in the critical sections or else we may see unspecific behavior in the code.</p>\n\n<p>Your problem is similar to a reader-writer problem and we must synchronize using semaphores, mutex and other locking mechanisms to avoid the race condition. Assuming 1 writer and multiple reader we may use the following code to avoid undefined behavior:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>// Using read and write semaphores\r\nsemaphore rd, wrt; \r\nint readCount;\r\n\r\n// Writer Thread \r\n\r\ndo\r\n{\r\n...\r\n// Critical Section Starts  \r\n\r\nwait(wrt);\r\n    global variable = someValues;   // Write to the global Variable.\r\nsignal(wrt);\r\n\r\n// Critical Section Ends  \r\n...\r\n} while(1)\r\n\r\n\r\n// Reader thread \r\n\r\ndo\r\n{\r\n...\r\n// Critical Section 1 Starts  \r\n\r\nwait(rd)\r\nreadcount++;\r\n    if(readCount == 1) \r\n        wait(wrt);\r\nsignal(rd);\r\n\r\n// Critical Section 1 Ends\r\n\r\n// Do Reading \r\n\r\n// Critical Section 2 Starts\r\nwait(rd)  \r\n    readcount--;\r\n    if(readCount == 0)\r\n        signal(wrt);\r\nsignal(rd)\r\n// Critical Section 2 Ends\r\n...\r\n} while(1)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 255, "user_id": 3359379, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2a94579c86c2d9b242961a1c56fc39b7?s=128&d=identicon&r=PG&f=1", "display_name": "ch0l1n3", "link": "https://stackoverflow.com/users/3359379/ch0l1n3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4612, "favorite_count": 1, "accepted_answer_id": 28591924, "answer_count": 8, "score": 7, "last_activity_date": 1424328541, "creation_date": 1424284836, "question_id": 28591370, "link": "https://stackoverflow.com/questions/28591370/is-it-dangerous-to-read-global-variables-from-separate-threads-at-potentially-th", "title": "Is it dangerous to read global variables from separate threads at potentially the same time?", "body": "<p>So I'm writing this neat little program to teach myself threading, I'm using boost::thread and C++ to do so.</p>\n\n<p>I need the main thread to communicate with the worker thread, and to do so I have been using global variables. It is working as expected, but I can't help but feel a bit uneasy.  </p>\n\n<p>What if the the worker thread tries write to a global variable at the same time as the main thread is reading the value. Is this bad, dangerous, or hopefully taken into account behind the scenes??</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1424284977, "post_id": 28591309, "comment_id": 45489189, "body": "<code>67&#47;24</code> yields <code>2</code> because of integer division. <code>67.0&#47;24.0</code> would give you a floating point result."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1424285030, "post_id": 28591309, "comment_id": 45489221, "body": "First of all, 67/24 means you need 2 boxes and 19 engines. Second, If you don&#39;t know how to convert 2.7 to 2 and 7, you have some serious learning to do."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424287660, "post_id": 28591309, "comment_id": 45490867, "body": "You should add 0.5 to the result then convert to an integer.  You want to round up, unless you can have 0.7 boxes assigned to an engine."}], "answers": [{"owner": {"reputation": 1, "user_id": 4572278, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PriRjhIkoOE/AAAAAAAAAAI/AAAAAAAAACo/Ir7SV3pW8as/photo.jpg?sz=128", "display_name": "Albert Drudis", "link": "https://stackoverflow.com/users/4572278/albert-drudis"}, "is_accepted": false, "score": 0, "last_activity_date": 1424285519, "last_edit_date": 1424285519, "creation_date": 1424285326, "answer_id": 28591505, "question_id": 28591309, "link": "https://stackoverflow.com/questions/28591309/making-a-decimal-a-variable/28591505#28591505", "title": "Making a decimal a variable", "body": "<pre><code>int main (){\n    double param, fractpart, intpart;\n\n    param = 2.7;\n    fractpart = modf (param , &amp;intpart);\n\n    return 0;\n}\n</code></pre>\n\n<p>This way <code>param=2</code> and <code>intpart=0.7</code></p>\n\n<p>Here is the whole code\n<a href=\"http://www.cplusplus.com/reference/cmath/modf/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cmath/modf/</a></p>\n"}], "owner": {"reputation": 13, "user_id": 4580896, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e85feb223c4225158c96e11428ea3a9e?s=128&d=identicon&r=PG&f=1", "display_name": "Notkrokidal", "link": "https://stackoverflow.com/users/4580896/notkrokidal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1424285519, "creation_date": 1424284642, "last_edit_date": 1424285376, "question_id": 28591309, "link": "https://stackoverflow.com/questions/28591309/making-a-decimal-a-variable", "title": "Making a decimal a variable", "body": "<p>So I have a type of code that tells me the number of boxes and packages needed. So for an instances E = number of engines and B = boxes and P =packages. Lets say I need 67 engines, I have B = E(67)/24 which should give me 2.7 because 67/24. I have to have the computer say 2 boxes and 7 engines, but I dont know how to do that.</p>\n\n<p>Thanks!</p>\n\n<pre><code>    // Include Section\n     #include &lt;iostream&gt;\n     #include &lt;iomanip&gt;\n     #include &lt;cstdlib&gt;\n     using namespace std;\n\n     // Main Program\n     int main( )\n     {\n        int E;     // number of engines needed\n        double CB; // The cost of the boxes containing 24 engines\n        double CP; // The cost of the packages containing 3 engines\n        int B;     // The number of boxes needed to get the amount                  \n        int P;     // The number of packages needed to get the amount of engines\n        double C;  // The total cost of all the engines desired.\n\n    // Output Identification\n     system(\"CLS\");\n     cout &lt;&lt; \"Take Home #5 by Yousef Saqer - \"\n         &lt;&lt; \"Calculate Engine Purchase\\n\\n\";\n\n    cout &lt;&lt; \" Enter the number of engines needed: \";\n    cin &gt;&gt; E;\n    cout &lt;&lt; \" Enter the cost of a box of 24 engines: \";\n    cin &gt;&gt; CB;\n    cout &lt;&lt; \" Enter the cost of a package of 3 engines: \";\n    cin  &gt;&gt; CP;\n\n\n\n   if(E &lt; 24)\n   {\n    B = E / 24;\n    P = E / 3;\n    C = CB * B + CP * P;\n\n    if(E &gt; 3)\n    {\n        P++;\n        cout &lt;&lt; \" You will need to purchase \" &lt;&lt; P \n        &lt;&lt; \" packages of engines at a total cost of $\"&lt;&lt; C &lt;&lt; endl;\n    }\n\n    else\n    {\n        cout &lt;&lt; \" You will need to purchase \" &lt;&lt; 1\n        &lt;&lt; \" package of engines at a total cost of $\"&lt;&lt; CP &lt;&lt; endl;\n    }\n\n\n   }\n\n   else\n   {\n    B = E / 24;\n    P = E/24.0;\n    C = CB * B + CP * P;\n\n    if( B != 1)\n    {\n        cout &lt;&lt; \" You will need to purchase \" &lt;&lt; B &lt;&lt; \" boxes and \"\n         &lt;&lt; P &lt;&lt; \" packages of engines at a total cost of $\"&lt;&lt; C&lt;&lt; endl;\n    }\n\n    else\n    {\n        cout &lt;&lt; \" You will need to purchase \" &lt;&lt; B &lt;&lt; \" box and \" \n        &lt;&lt; P &lt;&lt; \" packages of engines at a total of $\" &lt;&lt; C &lt;&lt; endl;\n    }\n\n}\ncout &lt;&lt; \"\\n\\nEnd Program.\\n\";\n\ncin.get();\ncin.get();\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "visual-studio-2010", "visual-studio", "visual-c++"], "comments": [{"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1424285391, "post_id": 28591289, "comment_id": 45489438, "body": "The cleanest solution is to reinstall. Start directly with <a href=\"http://www.visualstudio.com/en-us/products/visual-studio-community-vs.aspx\" rel=\"nofollow noreferrer\">VS 2013 Community Edition</a>, no need to use outdated stripped version."}, {"owner": {"reputation": 19, "user_id": 4529544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e30ebeef4df420837c3272f1f9b317db?s=128&d=identicon&r=PG&f=1", "display_name": "nagaratna", "link": "https://stackoverflow.com/users/4529544/nagaratna"}, "reply_to_user": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1424627835, "post_id": 28591289, "comment_id": 45617718, "body": "Language settings shows only espanol. It is mandatory to use the 2010 version of VC++ in our institution."}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1424637121, "post_id": 28591289, "comment_id": 45620815, "body": "(1) You skipped the most important step from the link above: <code>Install your version (German). Once the installation is finished you can install the English trial version: Microsoft Visual Studio 2010 Professional Trial - Web Installer...</code>. (2) If they all use 2010, at least consider a possibility of changing the institution ;)"}], "owner": {"reputation": 19, "user_id": 4529544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e30ebeef4df420837c3272f1f9b317db?s=128&d=identicon&r=PG&f=1", "display_name": "nagaratna", "link": "https://stackoverflow.com/users/4529544/nagaratna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1424804337, "answer_count": 0, "score": 0, "last_activity_date": 1424284891, "creation_date": 1424284575, "last_edit_date": 1424284891, "question_id": 28591289, "link": "https://stackoverflow.com/questions/28591289/changing-language-on-microsoft-visual-c-2010-express", "closed_reason": "Duplicate", "title": "changing language on microsoft visual c++ 2010 express", "body": "<p>I am new to the forum. I want to know how to change the language from Spanish to English in Microsoft Visual Studio c++ 2010 express edition.\nI have tried to change it under tools>options>international settings, but still no change is seen.</p>\n"}, {"tags": ["c++", "bit-manipulation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 3, "creation_date": 1424284786, "post_id": 28591285, "comment_id": 45489098, "body": "None - C/C++ does not deal with hardware/system representations of fundamental types."}, {"owner": {"reputation": 2274, "user_id": 3970469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a344e4614ffe33aea3a66f2696e7d064?s=128&d=identicon&r=PG&f=1", "display_name": "Prikso NAI", "link": "https://stackoverflow.com/users/3970469/prikso-nai"}, "edited": false, "score": 0, "creation_date": 1424285038, "post_id": 28591285, "comment_id": 45489225, "body": "@DieterL&#252;cking thanks!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1424286254, "post_id": 28591285, "comment_id": 45489998, "body": "@DieterL&#252;cking: That&#39;s not entirely true. First off, there is no &quot;C/C++&quot; language; the two languages are quite similar, but not identical. The <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> (that&#39;s the N1570 draft) discusses representations of integer types in section 6.2.6.2, and goes into a fair amount of detail. There&#39;s probably something similar in the C++ standard, but I haven&#39;t checked."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1424286279, "post_id": 28591285, "comment_id": 45490016, "body": "@Cyber: This is not a duplicate of that question, which only discusses the <i>sizes</i> of integer types, not their representations."}], "answers": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 4, "last_activity_date": 1424287109, "last_edit_date": 1424287109, "creation_date": 1424286806, "answer_id": 28591947, "question_id": 28591285, "link": "https://stackoverflow.com/questions/28591285/what-part-of-integer-bit-representation-is-part-of-the-standard/28591947#28591947", "title": "What part of integer bit-representation is part of The Standard?", "body": "<p>The <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">C standard</a> discusses the representations of integer types in section 6.2.6.2.</p>\n\n<p>It specifies a binary representation for integer types. For unsigned types, the bits are divided into <em>value bits</em> and <em>padding bits</em>. Padding bits do not contribute to the value; there needn't be any padding bits. For signed types, there is a single sign bit. Signed types may be represented using either <em>sign and magnitude</em>, <em>two's complement</em>, or <em>one's complement</em> (two's complement is nearly universal for modern systems).</p>\n\n<p>The ordering of the bits, and the presence and number of padding bits, are implementation-defined. (Most modern implementations do not have padding bits).</p>\n\n<p>The concept of padding bits, and the restriction to the three canonical representations, were introduced in C99.</p>\n\n<p>The bitwise operators (<code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&amp;</code>, et al) are defined in terms of the bits making up the representation of the values of the operands, but the requirements on the representations are specific enough that this is unambiguous for most cases. The description of the <code>&lt;&lt;</code> and <code>&gt;&gt;</code> shift operators specifically says that, for example, the result of <code>E1 &lt;&lt; E2</code> is <code>E1</code> \u00d7 <code>2</code><sup><code>E2</code></sup>; see section 6.5.7 of the cited N1570 draft.</p>\n\n<p>The C++ standard has a non-normative note that says it permits 2\u2019s complement, 1\u2019s complement and signed magnitude representations for integral types, but there doesn't seem to be an explicit statement that no other representations are permitted. It does require that \"The representations of integral types shall define values by use of a pure binary numeration system.\". You can see the gory details in the <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf\" rel=\"nofollow\">N4296 working draft</a> of the C++ standard (or in any other draft, or in the standard itself if you have a copy).</p>\n"}], "owner": {"reputation": 2274, "user_id": 3970469, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a344e4614ffe33aea3a66f2696e7d064?s=128&d=identicon&r=PG&f=1", "display_name": "Prikso NAI", "link": "https://stackoverflow.com/users/3970469/prikso-nai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 1, "closed_date": 1424287867, "accepted_answer_id": 28591947, "answer_count": 1, "score": 1, "last_activity_date": 1424287724, "creation_date": 1424284567, "last_edit_date": 1424287724, "question_id": 28591285, "link": "https://stackoverflow.com/questions/28591285/what-part-of-integer-bit-representation-is-part-of-the-standard", "closed_reason": "Duplicate", "title": "What part of integer bit-representation is part of The Standard?", "body": "<p>How much can one assume about integers' representation in memory?  </p>\n\n<p>How portable way of slicing and splicing integers together are bit-wise operations?</p>\n"}, {"tags": ["c++", "gdb", "copy-constructor"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1424283644, "post_id": 28590937, "comment_id": 45488433, "body": "I&#39;d suspect for undefined behavior because using an uninitialized object."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1424283713, "post_id": 28590937, "comment_id": 45488466, "body": "&quot;Why no warnings when calling a copy constructor with an uninitialised object?&quot; There are way to many stupid things you can do in C++, it is not compiler writers job to catch them all."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1556909275, "post_id": 28590937, "comment_id": 98601728, "body": "@Slavia, In this case I think the complier should give an error and nothing else. While compiling, it has all the required information to understand this is an error. Why not detect it?"}], "answers": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": true, "score": 7, "last_activity_date": 1424283689, "creation_date": 1424283689, "answer_id": 28591003, "question_id": 28590937, "link": "https://stackoverflow.com/questions/28590937/calling-copy-constructor-on-yourself/28591003#28591003", "title": "Calling copy constructor on yourself", "body": "<p>Since you have a member variable of type <code>int</code>, whose indeterminate value is copied to itself, the code is technically Undefined Behavior.</p>\n\n<p>However, in practice, with current computers nothing bad will happen. But on the third hand, nothing good happens either.</p>\n\n<p>Regarding warnings, that's a Quality Of Implementation issue. The C++ standard has nothing to say about that.</p>\n"}], "owner": {"reputation": 2647, "user_id": 2891462, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a27bd5b9762d5fad9cffc4f4f2812046?s=128&d=identicon&r=PG&f=1", "display_name": "user2891462", "link": "https://stackoverflow.com/users/2891462/user2891462"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 28591003, "answer_count": 1, "score": 3, "last_activity_date": 1424283689, "creation_date": 1424283457, "question_id": 28590937, "link": "https://stackoverflow.com/questions/28590937/calling-copy-constructor-on-yourself", "title": "Calling copy constructor on yourself", "body": "<p>I am curious about what is happening in this code I wrote almost by mistake:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nclass Test\n{\npublic:\n  Test() {\n    std::cout &lt;&lt; \"Default constructor\";\n    a= 10;\n  }\n  int a;\n};\n\nint main() {\n  Test obj(obj);\n  std::cout &lt;&lt; obj.a &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>It compiles in gcc without warnings of any kind (using -Wall -Werror).\nExecuting it only prints garbage.</p>\n\n<p>If I am not mistaken, this is calling the implicit copy-constructor on itself, without ever initialising. I am curious about what the copy-constructor would do in such a situation, but gdb will not stop in that line (breakpoints set to that line jump to the next one).</p>\n\n<p>Everything breaks if \"complex\" attributes are added to the class (like a <code>std::string</code>), probably because of how the '=' operator is overloaded for such classes.</p>\n\n<p>Is my hypothesis correct? Why doesn't gdb stop in that line? Why no warnings when calling a copy constructor with an uninitialised object?</p>\n"}, {"tags": ["c++", "libtiff"], "comments": [{"owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1424283730, "post_id": 28590925, "comment_id": 45488476, "body": "How much memory does your system have? Not sure that matters, but depends on what TIFFOpen is doing."}, {"owner": {"reputation": 1, "user_id": 4552772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6052bf56db265795e6e2aae02be056?s=128&d=identicon&r=PG&f=1", "display_name": "Andreww", "link": "https://stackoverflow.com/users/4552772/andreww"}, "reply_to_user": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1424285245, "post_id": 28590925, "comment_id": 45489333, "body": "The system has 4 GB DDR3 RAM. I&#39;m not sure what TIFFOpen is doing because the debugger doesn&#39;t allow me to follow the instructions inside the library."}, {"owner": {"reputation": 1, "user_id": 4552772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6052bf56db265795e6e2aae02be056?s=128&d=identicon&r=PG&f=1", "display_name": "Andreww", "link": "https://stackoverflow.com/users/4552772/andreww"}, "reply_to_user": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1424285759, "post_id": 28590925, "comment_id": 45489683, "body": "In my opinion I think that you are right and TIFFOpen might fail to open a file because the file is out of memory but I don&#39;t know how to solve it."}, {"owner": {"reputation": 1, "user_id": 4552772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6052bf56db265795e6e2aae02be056?s=128&d=identicon&r=PG&f=1", "display_name": "Andreww", "link": "https://stackoverflow.com/users/4552772/andreww"}, "reply_to_user": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1424286447, "post_id": 28590925, "comment_id": 45490120, "body": "If I try to use CImg header to open the image, the program gives me the next exception: &quot; Failed to allocate memory (652.2 Mio) for image (6482,6594,1,8)&quot;"}, {"owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1424286993, "post_id": 28590925, "comment_id": 45490459, "body": "Is the test file you&#39;re using 652MB or is it closer to 50MB? Big difference in the required memory. Opening all of a 652MB file on 4GB might not be possible. You have to figure out how to stream it, or cut it into chunks."}, {"owner": {"reputation": 3241, "user_id": 781162, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/440977e8e1ca487a0979daf9c975ed3e?s=128&d=identicon&r=PG", "display_name": "Eugene K", "link": "https://stackoverflow.com/users/781162/eugene-k"}, "edited": false, "score": 0, "creation_date": 1424287212, "post_id": 28590925, "comment_id": 45490577, "body": "I haven&#39;t used LibTiff personally, but the other problem might be that you need properly allocate memory onto the heap for TIFFOpen. Look at some &#39;alloc&#39; functions in the library."}], "answers": [{"owner": {"reputation": 32, "user_id": 3347392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1a5ddef1597c189a8cb02371d6ce28?s=128&d=identicon&r=PG&f=1", "display_name": "user3347392", "link": "https://stackoverflow.com/users/3347392/user3347392"}, "is_accepted": false, "score": -1, "last_activity_date": 1433257534, "creation_date": 1433257534, "answer_id": 30599808, "question_id": 28590925, "link": "https://stackoverflow.com/questions/28590925/opening-large-tiff-files/30599808#30599808", "title": "Opening large TIFF files", "body": "<p>Try this:</p>\n\n<pre><code>TIFF* tif = TIFFOpen(dir_imd, \"mr\");\n</code></pre>\n\n<p>If memory serves this disables memory-mapping of files. I have found that when dealing with large files that this can solve some crashes.</p>\n"}], "owner": {"reputation": 1, "user_id": 4552772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6052bf56db265795e6e2aae02be056?s=128&d=identicon&r=PG&f=1", "display_name": "Andreww", "link": "https://stackoverflow.com/users/4552772/andreww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433257534, "creation_date": 1424283419, "question_id": 28590925, "link": "https://stackoverflow.com/questions/28590925/opening-large-tiff-files", "title": "Opening large TIFF files", "body": "<p>I have a problem with my code: </p>\n\n<pre><code>cout &lt;&lt; \"image root\"; \nfflush(stdin); \ncin.getline(dir_imd,2048);\nTIFF* tif = TIFFOpen(dir_imd, \"r\");\n</code></pre>\n\n<p>It's quite simple, but when I try to load a image larger than 50 MB the code gives me a message saying the image cannot be open. I'm using the libtiff library.</p>\n\n<p>Any idea about what is the problem?</p>\n"}, {"tags": ["c++", "arrays", "serialization", "boost", "binary"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1424295110, "post_id": 28590908, "comment_id": 45495226, "body": "Seems that <code>RawData</code> is little more than <code>std::deque&lt;double&gt;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424382515, "post_id": 28594224, "comment_id": 45538207, "body": "Still getting the same error (and setting the array to be the same value fixes it as before). I assume this worked fine for you?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424382652, "post_id": 28594224, "comment_id": 45538288, "body": "@godan safe assumption :) (It&#39;s even live in front of your own nose :))"}, {"owner": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424384436, "post_id": 28594224, "comment_id": 45539211, "body": "Yah! I figured....However, I&#39;ve literally just copied and pasted your code in to a fresh project and the error persists. Must be me - but I can&#39;t figure it out. Maybe tomorrow."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424384498, "post_id": 28594224, "comment_id": 45539253, "body": "@godan Time to create the SSCCE, list compiler and library versions, switches etc."}, {"owner": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424897211, "post_id": 28594224, "comment_id": 45744730, "body": "This is the simplest example (I think) where I get this error. If you serialize wtih the text archive, it works. With binary, it doesn&#39;t. I&#39;m compiling with MSVC 2012. Here is the code...<a href=\"https://gist.github.com/danhambleton/ed0572af7ace373dc1ba\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424897738, "post_id": 28594224, "comment_id": 45745038, "body": "Looks fine. I&#39;d file a bug. What&#39;s the boost library version?"}, {"owner": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "edited": false, "score": 0, "creation_date": 1424898462, "post_id": 28594224, "comment_id": 45745436, "body": "I&#39;m using boost version 1.56. Thanks for your help, btw!"}], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1424294695, "creation_date": 1424294695, "answer_id": 28594224, "question_id": 28590908, "link": "https://stackoverflow.com/questions/28590908/boost-binary-serialization-double-array-of-fixed-length-error/28594224#28594224", "title": "Boost binary serialization - double array of fixed length error", "body": "<p>You will want to use</p>\n\n<pre><code>template &lt;class Archive&gt; void serialize(Archive &amp;ar, unsigned) {\n    ar &amp; end;\n    ar &amp; boost::serialization::make_array(data, end);\n}\n</code></pre>\n\n<p>See <a href=\"http://www.boost.org/doc/libs/1_46_1/libs/serialization/doc/wrappers.html#arrays\" rel=\"nofollow\">http://www.boost.org/doc/libs/1_46_1/libs/serialization/doc/wrappers.html#arrays</a></p>\n\n<p>Here is the demo, selfcontained:</p>\n\n<p><strong><kbd><a href=\"http://coliru.stacked-crooked.com/a/4556b5aeadeb3597\" rel=\"nofollow\">Live On Coliru</a></kbd></strong></p>\n\n<pre><code>#include &lt;boost/serialization/vector.hpp&gt;\n#include &lt;boost/serialization/array.hpp&gt;\n\nstruct DataChunk {\n  public:\n    double data[2048]; // THIS IS THE PROBLEM AREA\n    int end;\n\n  private:\n    friend class boost::serialization::access;\n    template &lt;class Archive&gt; void serialize(Archive &amp;ar, unsigned) {\n        ar &amp; end;\n        ar &amp; boost::serialization::make_array(data, end);\n    }\n};\n\n#include &lt;boost/range.hpp&gt;\n#include &lt;boost/range/algorithm.hpp&gt;\n\nclass RawData {\n  private:\n    std::vector&lt;DataChunk&gt; chunks;\n    friend class boost::serialization::access;\n    template &lt;class Archive&gt; void serialize(Archive &amp;ar, unsigned) { ar &amp;chunks; }\n\n  public:\n    void add_chunk(DataChunk chunk) { chunks.push_back(chunk); };\n    std::vector&lt;DataChunk&gt; get_chunks() { return chunks; };\n    static void save(RawData rd, std::string path);\n    static bool load(RawData &amp;rd, std::string path);\n\n    void add_raw_data(std::vector&lt;double&gt; raw_data) {\n        DataChunk chunk;\n        auto const csize = boost::size(chunk.data);\n\n        size_t n    = raw_data.size(), \n               offs = 0ul;\n\n        while (n&gt;0) {\n            auto n_ = std::min(n, csize);\n            std::copy_n(raw_data.begin() + offs, n_, chunk.data);\n            chunk.end = n_;\n            chunks.push_back(chunk);\n            offs += n_;\n            n    -= n_;\n        }\n    }\n\n    std::vector&lt;double&gt; combine_chunks() {\n        std::vector&lt;double&gt; r;\n        boost::for_each(chunks, [&amp;r](DataChunk const&amp; c) {std::copy_n(c.data, c.end, back_inserter(r));});\n        return r;\n    }\n};\n\n#include &lt;boost/archive/binary_oarchive.hpp&gt;\n#include &lt;boost/archive/binary_iarchive.hpp&gt;\n#include &lt;fstream&gt;\n\nvoid RawData::save(RawData rd, std::string path) {\n    std::ofstream file(path);\n    if (file.good()) {\n\n        boost::archive::binary_oarchive oa(file, std::ios::binary);\n        // boost::archive::text_oarchive oa(file);\n        oa &lt;&lt; rd;\n    }\n    file.flush();\n    file.close();\n}\n\nbool RawData::load(RawData &amp;rd, std::string path) {\n    std::ifstream file(path);\n    if (file.good()) {\n\n        boost::archive::binary_iarchive ia(file, std::ios::binary);\n        // boost::archive::text_iarchive ia(file);\n        ia &gt;&gt; rd;\n        file.close();\n        return true;\n    } else\n        return false;\n}\n\n#include &lt;iostream&gt;\n\nRawData generate() {\n    RawData data;\n    std::vector&lt;double&gt; raw_data;\n    for (int i = 0; i &lt; 5000; i++)\n        raw_data.push_back(i * 2048);\n    data.add_raw_data(raw_data);\n    return data;\n}\n\nint main() {\n    std::string const path = \"test.data\";\n\n    {\n        // serialize\n        RawData const old_data = generate();\n        RawData::save(old_data, path);\n    }\n\n    {\n        // deserialize\n        RawData new_data;\n        RawData::load(new_data, path);\n\n        // grab the chunks and test the values\n        for (auto d : new_data.combine_chunks())\n            std::cout &lt;&lt; d &lt;&lt; \", \";\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3271579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86ff0ab8e86b516f77675eb34f6889db?s=128&d=identicon&r=PG&f=1", "display_name": "godan", "link": "https://stackoverflow.com/users/3271579/godan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1420, "favorite_count": 0, "accepted_answer_id": 28594224, "answer_count": 1, "score": 1, "last_activity_date": 1424294695, "creation_date": 1424283364, "question_id": 28590908, "link": "https://stackoverflow.com/questions/28590908/boost-binary-serialization-double-array-of-fixed-length-error", "title": "Boost binary serialization - double array of fixed length error", "body": "<p>I'm creating a class that stores lots of doubles for saving/loading with boost. The load needs to be as fast as possible, so getting the binary format to work is the goal.</p>\n\n<p>Basically, I have a class that stores a vector of structs:</p>\n\n<pre><code>vector&lt;DataChunk&gt;\n</code></pre>\n\n<p>where DataChunk stores a double array of fixed length</p>\n\n<pre><code>double data[2048]\n</code></pre>\n\n<p>When I test the functionality with using a text archive (text_iarchive), everything works great. However, when using the binary archive, I get memory access violation on deserializing the class.</p>\n\n<p>More bizarrely, if I fill the double array with the same double value (i.e all elements of data[2048] are equal to 12345), it works. Varying double values seems to crash it, though (see below).</p>\n\n<p>Here's my RawData class:</p>\n\n<pre><code>#pragma once\n#include &lt;boost\\serialization\\vector.hpp&gt;\n#include &lt;boost\\serialization\\array.hpp&gt;\n\nusing namespace std;\n\nstruct DataChunk\n{\npublic:\n    double data[2048]; //THIS IS THE PROBLEM AREA\n    int end;\nprivate:\n    friend class boost::serialization::access;\n    template&lt;class Archive&gt;\n    void serialize(Archive&amp; ar, const unsigned int version)\n    {\n        ar &amp; data;\n        ar &amp; end;\n    }\n};\n\n\nclass RawData\n{\nprivate:\n    vector&lt;DataChunk&gt; chunks;\n    friend class boost::serialization::access;\n    template&lt;class Archive&gt;\n    void serialize(Archive&amp; ar, const unsigned int version)\n    {\n        ar &amp; chunks;\n    }\npublic:\n    void add_chunk(DataChunk chunk){chunks.push_back(chunk);};\n    vector&lt;DataChunk&gt; get_chunks(){return chunks;};\n    static void save(RawData rd, string path);\n    static bool load(RawData &amp; rd, string path);\n    void add_raw_data(vector&lt;double&gt; raw_data);\n    vector&lt;double&gt; combine_chunks();\n};\n</code></pre>\n\n<p>My save and load functions look like this:</p>\n\n<pre><code>void RawData::save(RawData rd, string path)\n{\n    std::ofstream file(path); \n    if(file.good())\n    {\n\n        boost::archive::binary_oarchive oa(file, std::ios::binary);\n        //boost::archive::text_oarchive oa(file);\n        oa &lt;&lt; rd;\n    }\n    file.flush();\n    file.close();\n}\n\nbool RawData::load(RawData &amp; rd, string path)\n{\n    std::ifstream file(path);\n    if(file.good())\n    {\n\n        boost::archive::binary_iarchive ia(file, std::ios::binary); \n        //boost::archive::text_iarchive ia(file);\n        ia &gt;&gt; rd;\n        file.close();\n        return true;\n    }\n    else\n        return false;\n}\n</code></pre>\n\n<p>In my main function, I test it like this:</p>\n\n<pre><code>string path = \"test.data\";\nRawData old_data;\nvector&lt;double&gt; raw_data;\nfor(int i = 0; i &lt; 5000; i++)\n    raw_data.push_back(i * 2048); //change this to constant value and it works...\nold_data.add_raw_data(raw_data);\n\n//serialize\nRawData::save(old_data, path);\n\n//deserialize\nRawData new_data;\nRawData::load(new_data, path);\n\n//grab the chunks and test the values\nvector&lt;DataChunk&gt; chunks_in = new_data.get_chunks();\nfor(int i = 0; i &lt; chunks_in.size(); i++)\n    for(int j = 0; j &lt; chunks_in[i].end; j++)\n        cout&lt;&lt;chunks_in[i].data[j]&lt;&lt;\", \";\nreturn 0;\n</code></pre>\n"}, {"tags": ["c++", "c", "unit-testing", "testing", "doxygen"], "comments": [{"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 2, "creation_date": 1424285511, "post_id": 28590887, "comment_id": 45489512, "body": "I got the snippet to work. After the brief command either put a . (when JAVADOC_BRIEF is enabled) or an empty line (i.e. line with just a *) to end the brief, now [Zero test] is seen as continuation of @brief (as shown in my case with the error message: warning: block marked with [Zero Test.] for \\snippet should appear twice in file test\\test_suite_1.c. Set also the EXAMPLE path to the path leading to the test directory (not including the test)Small remark don&#39;t use \\ (backslash) in the path makes it less portable and also might lead strange effects when seen as escape character."}, {"owner": {"reputation": 12137, "user_id": 451007, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3a48b34dda00ca0a5745a5c285068c?s=128&d=identicon&r=PG", "display_name": "010110110101", "link": "https://stackoverflow.com/users/451007/010110110101"}, "reply_to_user": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1424286980, "post_id": 28590887, "comment_id": 45490451, "body": "Perfect!  If you&#39;ll write this as a complete answer, I&#39;ll give you credit."}], "answers": [{"owner": {"reputation": 1698, "user_id": 2214806, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/RgdBJ.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/2214806/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1429310620, "last_edit_date": 1495541169, "creation_date": 1429310620, "answer_id": 29710624, "question_id": 28590887, "link": "https://stackoverflow.com/questions/28590887/how-to-embed-the-body-of-a-live-unit-test-function-as-example-usage-with-doxygen/29710624#29710624", "title": "How to embed the body of a live unit test function as example usage with Doxygen?", "body": "<p>Notice that the error says it's looking for <code>[Zero Test.]</code>, and not <code>[Zero Test]</code>.  This is because your snippet is actually part of the brief, and it looks like a brief is automatically terminated with a <code>.</code> regardless if you put one.  </p>\n\n<p>The snippet is actually looking for the markers <code>[Zero Test.]</code>; if you put the <code>.</code> in the marker, it'll actually work.  But your solution is better, just terminate the brief! :)</p>\n\n<p>To be completely honest, it was your comment that led me to solve the issue (which I was having too); <a href=\"https://stackoverflow.com/users/451007/010110110101\">010110110101</a> is right, you should get credit for this.</p>\n"}], "owner": {"reputation": 12137, "user_id": 451007, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3d3a48b34dda00ca0a5745a5c285068c?s=128&d=identicon&r=PG", "display_name": "010110110101", "link": "https://stackoverflow.com/users/451007/010110110101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1429310620, "creation_date": 1424283295, "last_edit_date": 1495541169, "question_id": 28590887, "link": "https://stackoverflow.com/questions/28590887/how-to-embed-the-body-of-a-live-unit-test-function-as-example-usage-with-doxygen", "title": "How to embed the body of a live unit test function as example usage with Doxygen?", "body": "<p><strong>I want to embed the body of a live unit test function as the example.</strong>  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/25511878/in-doxygen-how-can-include-a-snippet-by-function-name-from-example-code-instead\">This is a similar question</a></p>\n\n<p>In doxygen, we can show example usage:</p>\n\n<ul>\n<li>with an entire .c file using the @example instruction.</li>\n<li>with a snipper using the @code instruction</li>\n<li>somehow with the @snippet directive + EXAMPLE_PATH (can't get it to work)</li>\n</ul>\n\n<p><code>@example</code> won't work because I don't have just one unit test per c file.  My test files have a bunch of unit tests in them organized as functions.</p>\n\n<p><code>@code</code> means I have to write some code that isn't going to get compiled or actually executed.  (In Python, there are doctests -- which is the reverse of what I'm looking for because doctests can be actually executed as a unit test.  Something like that would be fine here.)</p>\n\n<p><code>@snippet</code> might work. It looks like we would decorate the unit test and that makes it into a snippet.  I can't get this to work. (see below)</p>\n\n<p>Here's an example:</p>\n\n<pre><code>/**\n * @brief Sets the values to zero\n *\n */\nvoid set_to_zero(my_type_t *t)\n{\n    t-&gt;x = 0;\n    t-&gt;y = 0;\n}\n</code></pre>\n\n<p>... in another test_suite_1.c file, where I have lots of unit tests.  Here's one ...</p>\n\n<pre><code>int test_set_to_zero()\n{\n    my_type_t t;\n    set_to_zero(t);\n    MYASSERT(t.x == 0);\n    MYASSERT(t.y == 0);\n}\n</code></pre>\n\n<p>I would like just this unit test, from my test_suite_1.c file (not <em>all</em> unit tests in the whole file) to appear in the documentation as example usage of this particular function.</p>\n\n<p>The reason I want to do this is so that I can keep practicing DRY.  The unit test is essentially a pretty good example of basic usage.  </p>\n\n<p><strong>Is there some directive like:  <code>@embed_function_body_here&lt;test_set_to_zero&gt;</code></strong></p>\n\n<p>Going back to <code>@snippet</code>.  As I said, it didn't work.  Here's what I tried to do with the <code>@snippet</code> directive:</p>\n\n<p>My unit tests are in a \\test folder.  There are separate .c files containing unit tests (e.g. test_suite_1.c, test_suite_2.c, etc</p>\n\n<p>... in test_suite_1.c ...</p>\n\n<pre><code>//! [Zero Test]\nint test_set_to_zero()\n{\n    my_type_t t;\n    set_to_zero(t);\n    MYASSERT(t.x == 0);\n    MYASSERT(t.y == 0);\n}\n//! [Zero Test]\n</code></pre>\n\n<p>... in regular_code.c ...</p>\n\n<pre><code>/**\n * @brief Sets the values to zero\n * @snippet test\\test_suite_1.c Zero Test\n *\n */\nvoid set_to_zero(my_type_t *t)\n{\n    t-&gt;x = 0;\n    t-&gt;y = 0;\n}\n</code></pre>\n\n<p>... in doxyfile ...</p>\n\n<pre><code>...\nEXAMPLE_PATH = test\nEXAMPLE_RECURSIVE = YES\n...\n</code></pre>\n\n<p>This whole <code>@snippet</code> endeavor doesn't work.  Nothing shows in the resulting html where the snippet should be.</p>\n"}, {"tags": ["c++", "c", "gcc", "assembly"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1424286723, "post_id": 28590730, "comment_id": 45490294, "body": "Stay away from tricks. Stick to plain and simple. Things can get tricky enough anyway."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "edited": false, "score": 0, "creation_date": 1424311094, "post_id": 28595292, "comment_id": 45501276, "body": "Thanks for your comment. Regarding %c, would be it correct to understand that &quot;%c6(%5)&quot; == sum of the values of %5 and %6 and use this as an constant address in the memory from where we can only read but cannot write?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "reply_to_user": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "edited": false, "score": 1, "creation_date": 1424344359, "post_id": 28595292, "comment_id": 45514336, "body": "No, the address is constant not the value. It&#39;s a <code>foo* const</code> not a <code>const foo*</code>."}], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": true, "score": 1, "last_activity_date": 1424298811, "creation_date": 1424298811, "answer_id": 28595292, "question_id": 28590730, "link": "https://stackoverflow.com/questions/28590730/inline-assembly-operand-constraints/28595292#28595292", "title": "inline assembly operand constraints", "body": "<p><code>%c</code> forces output as a constant address, here it is used to get rid of the <code>$</code> normally emitted in at&amp;t syntax mode for immediates (that the <code>i</code> constraint implies).</p>\n\n<p>The <code>%b</code>, <code>%w</code>, <code>%l</code> and <code>%q</code> are size override modifiers, they force the appropriate sized register (that is byte, word, long or quad) for the operand.</p>\n\n<p>The parentheses are just part of your everyday at&amp;t style effective address syntax.</p>\n\n<p><code>i</code> is an immediate integer operand (one with constant value).</p>\n\n<p><code>\"1\"</code> and <code>\"2\"</code> are matching constraints, that is place them in the same location as the indicated other operands.</p>\n"}], "owner": {"reputation": 323, "user_id": 1082170, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8f364ad4c94b4b5eb5747b0d123f31e?s=128&d=identicon&r=PG", "display_name": "user1082170", "link": "https://stackoverflow.com/users/1082170/user1082170"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 28595292, "answer_count": 1, "score": 2, "last_activity_date": 1424342370, "creation_date": 1424282861, "last_edit_date": 1424342370, "question_id": 28590730, "link": "https://stackoverflow.com/questions/28590730/inline-assembly-operand-constraints", "title": "inline assembly operand constraints", "body": "<p>I have the a few questions regarding a piece of code I am trying to understand. I have read <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Using-Assembly-Language-with-C.html#Using-Assembly-Language-with-C\" rel=\"nofollow\">the manual here</a>. But it does not seem to explain or answer all of the tricks being used here. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>#define SAMPLE_OFFSET1 0\n#define SAMPLE_OFFSET2 100\n#define SAMPLE_OFFSET1 1000\n#define STRINGIFY(s) #s\n\nstruct data {\n    int m1;\n    int m2;\n    const uint *m3;\n    const uint *m4;\n};\n\n#define assembly_function(param1, ... param15) \\\n... body \\\n... body \\\n... body \\\n... body\n\nvoid testFunction (data* c, uint *const sample) {\nint bat, tmp;\n    __asm__ volatile(\n        assembly_function(\"%0\", \"%q0\", \"(%4)\", \"%1\", \"%w1\",\n                             \"%2\", \"%q2\", \"%3\", \"%b3\",\n                             \"%c6(%5)\", \"%c7(%5)\",\n                             STRINGIFY(SAMPLE_OFFSET1),\n                             STRINGIFY(SAMPLE_OFFSET2),\n                             STRINGIFY(SAMPLE_OFFSET3),\n                             \"%8\")\n        : \"=&amp;r\"(bat), \"=&amp;r\"(c-&gt;m1), \"=&amp;r\"(c-&gt;m2), \"=&amp;q\"(tmp)\n        : \"r\"(sample), \"r\"(c),\n          \"i\"(offsetof(data, m3)),\n          \"i\"(offsetof(data, m4)),\n          \"1\"(c-&gt;m1), \"2\"(c-&gt;m2)\n        : \"%rcx\", \"memory\"\n    );\n}\n</code></pre>\n\n<p>I have wild guesses about the usage of some of the following constraints/options. But I feel its better to confirm from other fellows (or get link to some detailed manual).</p>\n\n<ul>\n<li>%c in \"%c6(%5)\" and \"%c7(%5)\"</li>\n<li>%q in \"%q0\" and \"%q2\", </li>\n<li>%b in \"%b3\"</li>\n<li>%w in \"%w1\"</li>\n<li>parentheses in \"(%4)\"</li>\n<li>\"i\" for two of the input parameters.</li>\n<li>\"1\" and \"2\" for two of the input parameters.</li>\n</ul>\n\n<p>Thanks for your help.   </p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1424282937, "post_id": 28590728, "comment_id": 45488020, "body": "If <code>i</code> and <code>j</code> never diverge, why have two variables? <code>i &lt; 3, j &lt; 3</code> is not a valid expression."}, {"owner": {"reputation": 7490, "user_id": 4417613, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/leKlt.jpg?s=128&g=1", "display_name": "m0bi5", "link": "https://stackoverflow.com/users/4417613/m0bi5"}, "edited": false, "score": 0, "creation_date": 1424282969, "post_id": 28590728, "comment_id": 45488045, "body": "you are meant to have nested loops"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1424282970, "post_id": 28590728, "comment_id": 45488049, "body": "FYI: <a href=\"http://en.wikipedia.org/wiki/Comma_operator\" rel=\"nofollow noreferrer\">Comma operator</a>"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424283050, "post_id": 28590728, "comment_id": 45488089, "body": "@tadman, It is valid, hence the warning not being an error."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424284057, "post_id": 28590728, "comment_id": 45488670, "body": "Just so you know, they are not char arrays but string arrays (but that&#39;s good). I would make them static const. I would also reconsider whether days should be string or int, depending how it&#39;s used later."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3920237"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1424284434, "post_id": 28590728, "comment_id": 45488883, "body": "@chris Technically, it&#39;s not required to be an error, diagnostics are implementation-defined. He&#39;s just plain wrong in general that it&#39;s not a valid expression."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424286837, "post_id": 28590728, "comment_id": 45490374, "body": "@remyabel, I&#39;m going to have to refine these statements to just apply to the major implementations until I figure out exactly what they are and aren&#39;t allowed to do. Interesting topic, thanks."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1424286875, "post_id": 28590728, "comment_id": 45490394, "body": "@remyabel Technically a valid expression in terms of syntax, but also completely invalid in terms of capturing the desired logical condition. Argh, phrasing."}], "answers": [{"comments": [{"owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 0, "creation_date": 1424287243, "post_id": 28590769, "comment_id": 45490600, "body": "That is very interesting. you&#39;re absolutely right that it works, but it&#39;s not as clear to me why. I think it&#39;s a temporary writable reference?"}], "owner": {"reputation": 35430, "user_id": 7536, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69aa4b5b81a1d2120c98ceed09446489?s=128&d=identicon&r=PG", "display_name": "eduffy", "link": "https://stackoverflow.com/users/7536/eduffy"}, "is_accepted": false, "score": 2, "last_activity_date": 1424282960, "creation_date": 1424282960, "answer_id": 28590769, "question_id": 28590728, "link": "https://stackoverflow.com/questions/28590728/how-to-write-a-for-statement-that-iterates-through-two-arrays-in-c/28590769#28590769", "title": "How to write a for statement that iterates through two arrays in c++", "body": "<p>Change this:</p>\n\n<pre><code>i &lt; 3, j &lt; 3\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>i &lt; 3 &amp;&amp; j &lt; 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 0, "creation_date": 1424287107, "post_id": 28590807, "comment_id": 45490518, "body": "Yes, I see that now. You&#39;re absolutely right. Thank you very much."}], "owner": {"reputation": 1181, "user_id": 2708904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b7b059287e83e57ccf1ffd04ccbd6314?s=128&d=identicon&r=PG&f=1", "display_name": "Innot Kauker", "link": "https://stackoverflow.com/users/2708904/innot-kauker"}, "is_accepted": false, "score": 6, "last_activity_date": 1424283062, "creation_date": 1424283062, "answer_id": 28590807, "question_id": 28590728, "link": "https://stackoverflow.com/questions/28590728/how-to-write-a-for-statement-that-iterates-through-two-arrays-in-c/28590807#28590807", "title": "How to write a for statement that iterates through two arrays in c++", "body": "<p>Why would you use two indices? Just write a regular loop:</p>\n\n<pre><code>    for (int i = 0; i &lt; 3; ++i) {\n        ss &lt;&lt; months[i] &lt;&lt; \" \" &lt;&lt; days[i] &lt;&lt; \" \";\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 0, "creation_date": 1424287378, "post_id": 28591053, "comment_id": 45490687, "body": "Wow, that&#39;s an impressive answer. Thank you so much for explaining it to me. I&#39;ve seen the same thing before in something else I&#39;d written, but didn&#39;t know why it was happening. Now I know."}, {"owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 0, "creation_date": 1424289409, "post_id": 28591053, "comment_id": 45491939, "body": "Is there a way to do this with a ranged based for loop?"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 1, "creation_date": 1424289665, "post_id": 28591053, "comment_id": 45492112, "body": "@TimElhajj: Not any reasonable one, because here you need to iterate <i>two</i> different ranges at the same time, and a range-based for loop is used to iterate <i>one</i> range."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 0, "creation_date": 1424289894, "post_id": 28591053, "comment_id": 45492268, "body": "@TimElhajj: I&#39;d like to add that this question (iterating two ranges at once) will become moot once you do what&#39;s really needed here, namely creating a class that has two members, one for name and one for days, and then create a collection of that class. Something like <code>class Month { &#47;* ... *&#47; std::string name; int days; }</code> to be used in <code>std::vector&lt;Month&gt;</code>."}], "owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "is_accepted": true, "score": 4, "last_activity_date": 1424284030, "last_edit_date": 1424284030, "creation_date": 1424283814, "answer_id": 28591053, "question_id": 28590728, "link": "https://stackoverflow.com/questions/28590728/how-to-write-a-for-statement-that-iterates-through-two-arrays-in-c/28591053#28591053", "title": "How to write a for statement that iterates through two arrays in c++", "body": "<blockquote>\n<pre><code>stringstream ss;\n</code></pre>\n</blockquote>\n\n<p>Replace with <code>std::ostringstream ss;</code>.</p>\n\n<blockquote>\n<pre><code>for (auto i = 0, j = 0; i &lt; 3, j &lt; 3; ++i, ++j)\n{\n    ss &lt;&lt; months[i] &lt;&lt; \" \" &lt;&lt; days[j] &lt;&lt; \" \";\n}\n</code></pre>\n</blockquote>\n\n<p>In <code>i &lt; 3, j &lt; 3</code>, the comma operator is used. As <a href=\"http://en.cppreference.com/w/cpp/language/operator_other#Built-in_comma_operator\" rel=\"nofollow\">http://en.cppreference.com/w/cpp/language/operator_other#Built-in_comma_operator</a> says:</p>\n\n<blockquote>\n  <p>In a comma expression <code>E1, E2</code>, the expression <code>E1</code> is evaluated, its\n  return value is <strong>discarded</strong>, and its side effects are completed before\n  evaluation of the expression <code>E2</code> begins [...]. The return type and value\n  category of the comma operator are exactly the return type and the value\n  category of the second operand, <code>E2</code>.</p>\n</blockquote>\n\n<p>In other words, the <code>i &lt; 3</code> part is completely ignored (it does not have any side effects, either), and your code is equivalent to <code>for (auto i = 0, j = 0; j &lt; 3; ++i, ++j)</code>.</p>\n\n<p>Here is a simpler example to show this behaviour:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    int i = 0;\n    std::cout &lt;&lt; (i != 0, i == 0);\n}\n</code></pre>\n\n<p>This prints <code>1</code>, because only the <code>i == 0</code> is considered.</p>\n\n<p>To me, the question is: What exactly do you want to do? Do you want to print both arrays? In that case, you do not need two different index variables at all:</p>\n\n<pre><code>for (auto i = 0; i &lt; 3; ++i)\n{\n    ss &lt;&lt; months[i] &lt;&lt; \" \" &lt;&lt; days[i] &lt;&lt; \" \";\n}\n</code></pre>\n\n<p>There is still room for improvement, though. For example, you may want to <code>assert</code> that both arrays have the same size before iterating them, and you may want to get rid of the magic number <code>3</code> in the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424284671, "post_id": 28591190, "comment_id": 45489035, "body": "Looks extremely C-ish to me."}, {"owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 1, "creation_date": 1424287055, "post_id": 28591190, "comment_id": 45490492, "body": "ha, this is the next part of the question, and it was already answered here: <a href=\"http://stackoverflow.com/questions/6810656/creating-an-array-of-structs-in-c\" title=\"creating an array of structs in c\">stackoverflow.com/questions/6810656/&hellip;</a> Thank you!"}, {"owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "edited": false, "score": 0, "creation_date": 1424289033, "post_id": 28591190, "comment_id": 45491719, "body": "@abelenky Do I need to include a library to get that ARRAY_SIZE to run? I can use i &lt; sizeof(calendar)/sizeof(calendar[0]). I am just curious about ARRAY_SIZE. Thank you!"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 1, "creation_date": 1424289127, "post_id": 28591190, "comment_id": 45491769, "body": "<code>ARRAY_SIZE</code> varies depending on platform/compiler.  Or it may be <code>_countof(calendar)</code>.   Do some google depending on your particular platform/compiler to find the right answer."}], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1424284293, "creation_date": 1424284293, "answer_id": 28591190, "question_id": 28590728, "link": "https://stackoverflow.com/questions/28590728/how-to-write-a-for-statement-that-iterates-through-two-arrays-in-c/28591190#28591190", "title": "How to write a for statement that iterates through two arrays in c++", "body": "<p>Use a single index, and use a single array while you're at it:</p>\n\n<pre><code>void f()\n{\n    struct\n    {\n        std::string month;\n        std::string days;\n    } calendar[] = {\n        { \"January\",  \"31\" },\n        { \"February\", \"28\" },\n        { \"March\",    \"31\" }\n    };\n\n    for(auto i=0; i&lt;ARRAY_SIZE(calendar); ++i)\n    {\n        ss &lt;&lt; calendar[i].month &lt;&lt; \" \" &lt;&lt; caledar[i].days &lt;&lt; \" \";\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 625, "user_id": 800197, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/eba0bfb9af129395388a8c909884c6ab?s=128&d=identicon&r=PG", "display_name": "Tim Elhajj", "link": "https://stackoverflow.com/users/800197/tim-elhajj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 28591053, "answer_count": 4, "score": 0, "last_activity_date": 1424284293, "creation_date": 1424282858, "question_id": 28590728, "link": "https://stackoverflow.com/questions/28590728/how-to-write-a-for-statement-that-iterates-through-two-arrays-in-c", "title": "How to write a for statement that iterates through two arrays in c++", "body": "<p>I have completed an assignment, but Xcode is giving me a warning about the syntax of my for loop, and I'm not sure how to change it. I am new to programming. I am taking a course. </p>\n\n<p>The assignment is to create two char arrays. One for month names, the other for total days in each month, then print both arrays combined sequentially (Jan 31 Feb 28 etc).</p>\n\n<p>This is what I came up with:</p>\n\n<pre><code>f()\n{\n    std::string months[] = { \"January\", \"February\", \"March\" };\n    std::string days[] = { \"31\", \"28\", \"31\" };\n\n    stringstream ss;\n\n    for (auto i = 0, j = 0; i &lt; 3, j &lt; 3; ++i, ++j)\n\n    {\n        ss &lt;&lt; months[i] &lt;&lt; \" \" &lt;&lt; days[j] &lt;&lt; \" \";\n    }\n\n}\n</code></pre>\n\n<p>The compiler doesn't like the middle part of the for statement, the test to stop. The message I get says \"Expression result unused\". </p>\n\n<p>I confess I'm mostly mimicking the samples I've seen from class, but we've never done a loop that evaluates two arrays. I tried a range for loop, but I can't get that to work at all. </p>\n"}, {"tags": ["c++", "vector", "filter", "stl"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1424285391, "post_id": 28590447, "comment_id": 45489435, "body": "OT: I&#39;m just warning you <code>cout&lt;&lt;&quot;Error deleting item with index &quot;+index&lt;&lt;endl;</code> does not do what you think it does. That <code>+</code> should be <code>&lt;&lt;</code>. This is repeated several times in your code. And I really think you need to decide wether you&#39;re reading your directory from a file-based input stream or <code>std::cin</code>, because right now you code looks like it tries to do <i>both</i>. Also, <code>data=vector&lt;cityPhone&gt;();</code> is useless in the default constructor."}], "answers": [{"owner": {"reputation": 2779, "user_id": 2037422, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fbe43538cf41cb5974a7bf75b7f9d843?s=128&d=identicon&r=PG", "display_name": "Pavel Davydov", "link": "https://stackoverflow.com/users/2037422/pavel-davydov"}, "is_accepted": true, "score": 2, "last_activity_date": 1424282789, "last_edit_date": 1424282789, "creation_date": 1424282437, "answer_id": 28590598, "question_id": 28590447, "link": "https://stackoverflow.com/questions/28590447/filter-vector-in-function-and-return-another-vector-with-the-filtered-results/28590598#28590598", "title": "filter vector in function and return another vector with the filtered results", "body": "<p>You can filter your phone numbers like this in c++11:</p>\n\n<pre><code>std::vector&lt;cityPhone&gt; contacts;\nadd_contacts(contacts); //add some data\nstd::vector&lt;cityPhone&gt; varna_contacts;\nstd::copy_if(contacts.begin(), contacts.end(), std::back_inserter(varna_contacts), \n  [] (const cityPhone&amp; contact) { return contact.getCity() == \"Varna\"; });\n</code></pre>\n\n<p>or without lambda (c++03):</p>\n\n<pre><code>class phoneDirectory {\n  static void predicate(const cityPhone&amp; cp) {\n    return contact.getCity() == \"Varna\";\n  }\n}\n\nint main() {\n  std::vector&lt;cityPhone&gt; contacts;\n  add_contacts(contacts); //add some data\n  std::vector&lt;cityPhone&gt; varna_contacts;\n  std::copy_if(contacts.begin(), contacts.end(), \n    std::back_inserter(varna_contacts), phoneDirectory::predicate);\n}\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 3218392, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100002906586796/picture?type=large", "display_name": "user3218392", "link": "https://stackoverflow.com/users/3218392/user3218392"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1435, "favorite_count": 0, "accepted_answer_id": 28590598, "answer_count": 1, "score": 0, "last_activity_date": 1424282789, "creation_date": 1424281980, "question_id": 28590447, "link": "https://stackoverflow.com/questions/28590447/filter-vector-in-function-and-return-another-vector-with-the-filtered-results", "title": "filter vector in function and return another vector with the filtered results", "body": "<p>i'm working on a class project and i'm stuck on one of the last things i need to do before i'm finished.. The problem is i need to create a function for my custom class (with a vector as one of its elements) that filters the vector of my class and returns another vector with only the matched items of the vector, and this thing has to be done with an STL algorithm, i know im supposed to use remove_if/copy_if but just cant seem to figure out the function that i need to input into the STL filtering algorithm. This is my code : </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;fstream&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nclass cityPhone {\nprivate: \n    string cityName;\n    string cityCode;\npublic:\n void setCode(string code){\n    cityCode=code;\n}\n void setName(string name){\n    cityName=name;\n}\n cityPhone(){\n    cityName=\"Varna\";\n    cityCode=\"0888123123\";\n}\n cityPhone(string name, string code){\n    cityName=name;\n    cityCode=code;\n}\n string getCity(){\nreturn cityName;    \n}\n string getCode(){\n    return cityCode;\n}\n};\n\nbool cmpCity(cityPhone a, cityPhone b)\n        {   \n            if (a.getCity().compare(b.getCity())&gt;0)return false;\n    return true;\n        }   \n\nbool cmpCode(cityPhone a, cityPhone b)\n        {   \n           if (a.getCode().compare(b.getCode())&gt;0)return false;\n    return true;\n}\n\n class phoneDirectory {\n private :\n     vector&lt;cityPhone&gt; data;\n public:\n     phoneDirectory (string path){\n        read(path); \n    }\n     phoneDirectory (){\n        data=vector&lt;cityPhone&gt;();   \n    }\n\n   void read(string path){\n        cout&lt;&lt;endl;\n        try {\nstring line;\n  ifstream myfile (path);\n  cityPhone bla = cityPhone();\n  if (myfile.is_open())\n  {\n    while ( getline (myfile,line) )\n    {\n        try{\n      bla = cityPhone(line.substr(0,line.find_first_of(\" \")),line.substr(line.find_first_of(\" \")+1));\n      data.push_back(bla);\n        }\n        catch(exception){ }\n    }\n    myfile.close();\n  }\n\n  else cout &lt;&lt; \"Unable to open file\"; \n        } catch (exception) {}\n}\n\n   void addCityPhone(string city,string phone){\n       try{\n   data.push_back(cityPhone(city,phone)); \n       }\n       catch(exception){\n       cout&lt;&lt;\"Error adding item \"&lt;&lt;endl;\n       }\n   }\n\n   void delCityPhone(int index){\n       try{\n   vector&lt;cityPhone&gt;::iterator p=data.begin();\n   p+=index;\n   data.erase(p);\n       } \n       catch(exception){\n       cout&lt;&lt;\"Error deleting item with index \"+index&lt;&lt;endl;\n       }\n   }\n\n      cityPhone getCityPhone(unsigned index){\n       try{\n   vector&lt;cityPhone&gt;::iterator p=data.begin();\n   p+=index;\n   return *p;\n       }\n       catch(exception){\n       cout&lt;&lt;\"Error deleting item with index \"+index&lt;&lt;endl;\n       return cityPhone();\n       }\n   }\n\nvector&lt;cityPhone&gt;&amp; getData(){\n   return data;\n}\n\n   void phoneChange(string city, string newPhone){\n   try{\n       int i=0;\n       vector&lt;cityPhone&gt;::iterator p=data.begin();\n       for(p=data.begin();p&lt;data.end();p++,i++){\n       if (getCityPhone(i).getCity().compare(city)==0){\n           string oldPhone = getCityPhone(i).getCode();\n           getCityPhone(i).setCode(newPhone);\n           cout&lt;&lt;\"Phone of city \"+city + \" was changed from \"+oldPhone + \" to \" + newPhone&lt;&lt;endl;\n           return;\n       }\n       cout&lt;&lt;\"No such city exists!\\n\";\n       }\n   }\n   catch(exception){\n   cout&lt;&lt;\"Error changing phone\"&lt;&lt;endl;\n        }\n   }\n\n    friend istream&amp; operator&gt;&gt;(ostream&amp; out,phoneDirectory a);\n    friend ostream&amp; operator&lt;&lt;(ostream&amp; out,phoneDirectory a);\n };\n\nistream&amp; operator&gt;&gt;(istream&amp; in,phoneDirectory&amp; a){\n    string city,phone;\nin &gt;&gt; city &gt;&gt; phone;\na.addCityPhone(city,phone);\nreturn in;\n}\n\nostream&amp; operator&lt;&lt;(ostream &amp;out, cityPhone a){\nreturn out &lt;&lt; a.getCity()  &lt;&lt;\" \" &lt;&lt; a.getCode() &lt;&lt;endl;\n}\n\nvoid sortByCity(phoneDirectory &amp;a){\n        std::sort(a.getData().begin(),a.getData().end(),cmpCity);\n        for(unsigned i=0;i&lt;a.getData().size();i++)\n      cout&lt;&lt;a.getCityPhone(i);\n       }\n\nvoid sortByCode(phoneDirectory &amp;a){\n        std::sort(a.getData().begin(),a.getData().end(),cmpCode);\n        for(unsigned i=0;i&lt;a.getData().size();i++)\n      cout&lt;&lt;a.getCityPhone(i);\n       }\n\nint main()\n{\n\n    phoneDirectory test(\"C:\\\\t.txt\");\n\n    cin&gt;&gt;test;\n    sortByCity(test);\n    cout&lt;&lt;endl&lt;&lt;endl;\n    sortByCode(test);\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>I'm completely stuck, and any help would be greatly appreciated p.s. sorry for the bad english (not my mother language)</p>\n"}, {"tags": ["c++", "string"], "comments": [{"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1424282066, "post_id": 28590433, "comment_id": 45487489, "body": "if you just need access to the underlying <code>char</code> array you can use <code>.c_str()</code> but that doesn&#39;t guarantee unsigned.  Why don&#39;t the methods in that other question work for you?"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1424282103, "post_id": 28590433, "comment_id": 45487506, "body": "Just to be sure, you want an <code>unsigned char</code> <i>array</i>, right? Not just an <code>unsigned char</code>?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424282139, "post_id": 28590433, "comment_id": 45487537, "body": "What exactly are you trying to get out of this &quot;conversion&quot;? If the string is <code>&quot;abcde&quot;</code>, what should be the result?"}, {"owner": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "edited": false, "score": 0, "creation_date": 1424282541, "post_id": 28590433, "comment_id": 45487786, "body": "Sorry I just edited the description."}], "answers": [{"comments": [{"owner": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "edited": false, "score": 0, "creation_date": 1424283022, "post_id": 28590748, "comment_id": 45488077, "body": "why is it ugly? Can you please tell me a better way to do? I have Vector&lt;uchar&gt; colors. I am getting strings by reading the file. I need to insert these string into &quot;colors&quot;. please tell me if there is a cleaner way to achieve this."}, {"owner": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "reply_to_user": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "edited": false, "score": 0, "creation_date": 1424283216, "post_id": 28590748, "comment_id": 45488181, "body": "@aries It is ugly to put a string in a unsigned char array. You should use std::vector. The answer is okay, your question implies that you want to do something which will not be okay. (But you didn&#39;t tell)"}, {"owner": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "reply_to_user": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "edited": false, "score": 0, "creation_date": 1424283374, "post_id": 28590748, "comment_id": 45488282, "body": "@aries Get the code running with the piece I provided. Then ask a new question how to do it better. Your question in the comment exceed what a comment should provide in the first place. It should be part of the question (with more code)."}], "owner": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "is_accepted": false, "score": 8, "last_activity_date": 1424283257, "last_edit_date": 1424283257, "creation_date": 1424282911, "answer_id": 28590748, "question_id": 28590433, "link": "https://stackoverflow.com/questions/28590433/how-to-convert-a-string-to-unsigned-char-array-in-c/28590748#28590748", "title": "How to convert a string to unsigned char array in c++", "body": "<p>It is ugly to put a string in a raw unsigned char buffer and you should not do that, but this is stack overflow and we have to answer.</p>\n\n<pre><code>unsigned char *val=new unsigned char[temp.length()+1];\nstrcpy((char *)val,temp.c_str());\n</code></pre>\n"}], "owner": {"reputation": 659, "user_id": 4555266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/57ecbea5399f6c938f88e15636a06b7d?s=128&d=identicon&r=PG&f=1", "display_name": "aries", "link": "https://stackoverflow.com/users/4555266/aries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21529, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1464800276, "creation_date": 1424281928, "last_edit_date": 1495539857, "question_id": 28590433, "link": "https://stackoverflow.com/questions/28590433/how-to-convert-a-string-to-unsigned-char-array-in-c", "title": "How to convert a string to unsigned char array in c++", "body": "<pre><code>string temp;\ntemp = line.substr(0, pos);\n</code></pre>\n\n<p>I need to convert the string temp to an unsigned char array. Could someone please tell me how this can be done? I tried the methods mentioned in the below link but they didn't work.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2206050/how-to-convert-a-string-literal-to-unsigned-char-in-visual-c\">How to convert a string literal to unsigned char array in visual c++</a></p>\n\n<pre><code>unsigned char* val=new[temp.size() + 1](); //Error: Expected a type.\ncopy(temp.begin(), temp.end(), val);\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1424281375, "post_id": 28590219, "comment_id": 45487091, "body": "This has nothing to do with overloading the operator. It&#39;s the same as trying to do specially-formatted input in <code>main</code>. <code>~</code> is not a valid integer."}, {"owner": {"reputation": 23, "user_id": 4335133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfe6fbe2236d4d5a7fd577e118e306f?s=128&d=identicon&r=PG&f=1", "display_name": "ThrawnProg", "link": "https://stackoverflow.com/users/4335133/thrawnprog"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424281594, "post_id": 28590219, "comment_id": 45487220, "body": "it&#39;s a requirement for my assignment, this isn&#39;t all of the code I have but I figured this would give an idea of what I have to do, the instructions say:Create an overload of the extraction operator &gt;&gt; for reading Time objects from an input stream.  The format for the input of a Time object is the same as the output format listed above.  This operator will need to do some error checking, as well."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424281737, "post_id": 28590219, "comment_id": 45487287, "body": "I should have clarified. The <i>problem you&#39;re having</i> has nothing to do with the overload. That is, you could post a complete example consisting of just a <code>main</code> function, it would exhibit the same problem, and we wouldn&#39;t even have to know the overload exists because it&#39;s not relevant (though it could be mentioned for context)."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424282465, "post_id": 28590219, "comment_id": 45487733, "body": "The point is that when you do the reading from <code>cin</code> you must take care to read the <code>~</code> and <code>:</code> characters as necessary, and verify that what you read is indeed what you expected."}, {"owner": {"reputation": 23, "user_id": 4335133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfe6fbe2236d4d5a7fd577e118e306f?s=128&d=identicon&r=PG&f=1", "display_name": "ThrawnProg", "link": "https://stackoverflow.com/users/4335133/thrawnprog"}, "edited": false, "score": 0, "creation_date": 1424283349, "post_id": 28590219, "comment_id": 45488268, "body": "okay, yea I thought it would just read the integers, I forgot I have to ignore those values. I did that and they all have a value now but double digit figures only show up as 0 and the last digit, should be much easier to work with now though, thanks!"}], "owner": {"reputation": 23, "user_id": 4335133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcfe6fbe2236d4d5a7fd577e118e306f?s=128&d=identicon&r=PG&f=1", "display_name": "ThrawnProg", "link": "https://stackoverflow.com/users/4335133/thrawnprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424281288, "creation_date": 1424281288, "question_id": 28590219, "link": "https://stackoverflow.com/questions/28590219/overloading-extraction-operator", "title": "Overloading Extraction operator", "body": "<p>For a hw assignment for a Time class I have the instructions to overload the extraction operator, however the input format has to be the same as the output which is (days~HH:MM:SS). This is what i have for the operator:\nheader file</p>\n\n<pre><code>friend ostream&amp; operator&lt;&lt;(ostream&amp; out, const Time&amp; t);\nfriend istream&amp; operator&gt;&gt;(istream&amp; in, Time&amp; t);\n</code></pre>\n\n<p>cpp file</p>\n\n<pre><code>istream&amp; operator&gt;&gt;(istream&amp; in,  Time&amp; t)\n{\n    in &gt;&gt; t.day;\n    in &gt;&gt; t.hour;\n    in &gt;&gt; t.minute;\n    in &gt;&gt; t.second;\n\n    if (t.day &lt; 0 || t.hour &lt; 0 || t.minute &lt; 0 || t.second &lt; 0)\n    {\n        t.day = t.hour = t.minute = t.second = 0;\n    }\n    //else\n\n\n\n\n    return in;\n}\n</code></pre>\n\n<p>main file for output</p>\n\n<p>cout &lt;&lt; \"Enter first Time object (DAYS~HH:MM:SS):  \";\n    cin >> t1;</p>\n\n<pre><code>cout &lt;&lt; t1;\n</code></pre>\n\n<p>when i go to output a Time object, however, it only prints out days and 00:00:00 afterwards, as if I didn't get the rest of them. How can I get days into t.day, HH into t.hour, etc...  The examples in my book show distance examples but none where I have to extract from a stream, they normally ask for the input of each separate part. How can I do this all at once from the format I listed?</p>\n"}, {"tags": ["c++", "templates", "polymorphism"], "comments": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "edited": false, "score": 0, "creation_date": 1424281817, "post_id": 28590103, "comment_id": 45487341, "body": "The <code>useCRTP</code> function has little UB. You need to pass by reference, or use the most derived type."}], "answers": [{"owner": {"reputation": 135186, "user_id": 464581, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/v2PxU.jpg?s=128&g=1", "display_name": "Cheers and hth. - Alf", "link": "https://stackoverflow.com/users/464581/cheers-and-hth-alf"}, "is_accepted": true, "score": 2, "last_activity_date": 1424282502, "last_edit_date": 1424282502, "creation_date": 1424281991, "answer_id": 28590453, "question_id": 28590103, "link": "https://stackoverflow.com/questions/28590103/crtp-vs-name-hiding-for-static-polymorphism/28590453#28590453", "title": "CRTP vs name hiding for static polymorphism", "body": "<p>Consider the case where a base class method calls some other method.</p>\n\n<p>With CRTP the called method can be overridden.</p>\n\n<p>With name hiding there is no override mechanism.</p>\n\n<hr>\n\n<p>Example.\nThis code uses CRTP for static polymorphism where the <code>kind</code> method is overridden in the derived class.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\ntemplate&lt; class Derived &gt;\nclass Animal\n{\npublic:\n    auto self() const\n        -&gt; Derived const&amp;\n    { return static_cast&lt;Derived const&amp;&gt;( *this ); }\n\n    auto kind() const -&gt; char const* { return \"Animal\"; }\n    void identify() const { cout &lt;&lt; \"I'm a \" &lt;&lt; self().kind() &lt;&lt; \".\" &lt;&lt; endl; }\n};\n\nclass Dog\n    : public Animal&lt; Dog &gt;\n{\npublic:\n    auto kind() const -&gt; char const* { return \"Dog\"; }\n};\n\nauto main() -&gt; int\n{\n    Dog().identify();\n}\n</code></pre>\n"}], "owner": {"reputation": 6911, "user_id": 2970186, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Vo0Wc.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2970186/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 1, "accepted_answer_id": 28590453, "answer_count": 1, "score": 0, "last_activity_date": 1424282502, "creation_date": 1424280896, "last_edit_date": 1424281986, "question_id": 28590103, "link": "https://stackoverflow.com/questions/28590103/crtp-vs-name-hiding-for-static-polymorphism", "title": "CRTP vs name hiding for static polymorphism", "body": "<p>How does using the Curiously recurring template pattern (CRTP) differ from name hiding to achieve static polymorphism?</p>\n\n<p>For example, here is a simple example demonstrating static polymorphism using the CRTP and name hiding:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct BaseCRTP {\n    void foo() { \n        static_cast&lt;T*&gt;(this)-&gt;foo(); \n    }\n\n    void bar() { \n        std::cout &lt;&lt; \"bar from Base\" &lt;&lt; std::endl; \n    }\n};\n\nstruct DerivedCRTP : public BaseCRTP&lt;DerivedCRTP&gt; {\n    void foo() {\n        std::cout &lt;&lt; \"foo from Derived\" &lt;&lt; std::endl;\n    }\n};\n\nstruct BaseNH {\n    void foo() {}\n\n    void bar() {\n        std::cout &lt;&lt; \"bar from Base\" &lt;&lt; std::endl;\n    }\n};\n\nstruct DerivedNH : public BaseNH {\n    void foo() {\n        std::cout &lt;&lt; \"foo from Derived\" &lt;&lt; std::endl;\n    }\n};\n\ntemplate &lt;typename T&gt;\nvoid useCRTP(BaseCRTP&lt;T&gt;&amp; b) {\n    b.foo();\n    b.bar();\n}\n\ntemplate &lt;typename T&gt;\nvoid useNH(T b) {\n    b.foo();\n    b.bar();\n}\n\nint main(int argc, char** argv) {\n    DerivedCRTP instance_crtp; // \"foo from Derived\"\n    DerivedNH instance_nm; // \"bar from Base\"\n    useCRTP(instance_crtp); // \"foo from Derived\"\n    useNH(instance_nm); // \"bar from Base\"\n    return 0;\n}\n</code></pre>\n\n<p>To clarify, this isn't a question about mechanics, rather of behaviour and use.</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 2, "creation_date": 1424280985, "post_id": 28590034, "comment_id": 45486869, "body": "Why not just use <code>std::string</code> and be done with it?"}], "answers": [{"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1424281183, "last_edit_date": 1424281183, "creation_date": 1424280877, "answer_id": 28590095, "question_id": 28590034, "link": "https://stackoverflow.com/questions/28590034/c-how-to-create-an-empty-char-array-of-the-size-of-an-existing-char-array/28590095#28590095", "title": "c++ how to create an empty char array of the size of an existing char array?", "body": "<p>Use a <code>std::string</code>, something like:</p>\n\n<pre><code>std::string aValue;\naValue.resize(strlen(pLine));\n</code></pre>\n\n<p>then you can get at the c-string with:</p>\n\n<pre><code>aValue.c_str();\n</code></pre>\n"}, {"owner": {"reputation": 4009, "user_id": 1922748, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/09w3M.jpg?s=128&g=1", "display_name": "Martin Schlott", "link": "https://stackoverflow.com/users/1922748/martin-schlott"}, "is_accepted": true, "score": 0, "last_activity_date": 1424280957, "creation_date": 1424280957, "answer_id": 28590118, "question_id": 28590034, "link": "https://stackoverflow.com/questions/28590034/c-how-to-create-an-empty-char-array-of-the-size-of-an-existing-char-array/28590118#28590118", "title": "c++ how to create an empty char array of the size of an existing char array?", "body": "<p>As far as I understood your question, you want a buffer with the length of the max of pLine</p>\n\n<pre><code>char *aValue=new char[strlen(pLine)];\nsscanf(pLine, \"Word %s\", aValue);\n</code></pre>\n\n<p>do not forget to delete aValue after use:</p>\n\n<pre><code>delete[] aValue; \n</code></pre>\n"}], "owner": {"reputation": 1561, "user_id": 3235192, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/qgDTX.png?s=128&g=1", "display_name": "timakro", "link": "https://stackoverflow.com/users/3235192/timakro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 0, "accepted_answer_id": 28590118, "answer_count": 2, "score": 0, "last_activity_date": 1424281183, "creation_date": 1424280728, "question_id": 28590034, "link": "https://stackoverflow.com/questions/28590034/c-how-to-create-an-empty-char-array-of-the-size-of-an-existing-char-array", "title": "c++ how to create an empty char array of the size of an existing char array?", "body": "<p>I want to create aValue with the size of pLine, because i don't want aValue to cut off the line if its longer than 128.</p>\n\n<pre><code>char aValue[128];\nsscanf(pLine, \"Word %127s\", aValue);\n</code></pre>\n\n<p>Hope you can help me, thanks in advance.</p>\n"}, {"tags": ["c++", "opencv", "mat"], "comments": [{"owner": {"reputation": 8020, "user_id": 1633399, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/wK6kY.png?s=128&g=1", "display_name": "BConic", "link": "https://stackoverflow.com/users/1633399/bconic"}, "edited": false, "score": 0, "creation_date": 1424281027, "post_id": 28590031, "comment_id": 45486890, "body": "Try <code>newMat = Mat1+Mat2;</code>."}], "answers": [{"owner": {"reputation": 1369, "user_id": 4080268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/86VTz.jpg?s=128&g=1", "display_name": "zedv", "link": "https://stackoverflow.com/users/4080268/zedv"}, "is_accepted": false, "score": 7, "last_activity_date": 1424282044, "creation_date": 1424282044, "answer_id": 28590472, "question_id": 28590031, "link": "https://stackoverflow.com/questions/28590031/add-the-contents-of-2-mats-to-another-mat-opencv-c/28590472#28590472", "title": "Add the contents of 2 Mats to another Mat opencv c++", "body": "<p>You can use push_back():</p>\n\n<pre><code>newMat.push_back(Mat1);\nnewMat.push_back(Mat2);\n</code></pre>\n"}, {"owner": {"reputation": 3039, "user_id": 3824740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DzLm.jpg?s=128&g=1", "display_name": "mcchu", "link": "https://stackoverflow.com/users/3824740/mcchu"}, "is_accepted": true, "score": 31, "last_activity_date": 1424312708, "creation_date": 1424312708, "answer_id": 28597696, "question_id": 28590031, "link": "https://stackoverflow.com/questions/28590031/add-the-contents-of-2-mats-to-another-mat-opencv-c/28597696#28597696", "title": "Add the contents of 2 Mats to another Mat opencv c++", "body": "<p>It depends on what you want to <em>add</em>. For example, you have two 3x3 Mat:</p>\n\n<pre><code>cv::Mat matA(3, 3, CV_8UC1, cv::Scalar(20));\ncv::Mat matB(3, 3, CV_8UC1, cv::Scalar(80));\n</code></pre>\n\n<p>You can add <code>matA</code> and <code>matB</code> to a new 3x3 Mat with value 100 using <a href=\"http://docs.opencv.org/modules/core/doc/basic_structures.html#matrix-expressions\">matrix operation</a>: </p>\n\n<pre><code>auto matC = matA + matB;\n</code></pre>\n\n<p>Or using array operation <a href=\"http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#add\">cv::add</a> that does the same job:</p>\n\n<pre><code>cv::Mat matD;\ncv::add(matA, matB, matD);\n</code></pre>\n\n<p>Or even <a href=\"http://docs.opencv.org/doc/tutorials/core/adding_images/adding_images.html#adding-images\">mixing</a> two images using <a href=\"http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#addweighted\">cv::addWeighted</a>:</p>\n\n<pre><code>cv::Mat matE;\ncv::addWeighted(matA, 1.0, matB, 1.0, 0.0, matE);\n</code></pre>\n\n<p>Sometimes you need to merge two Mat, for example create a 3x6 Mat using <a href=\"http://docs.opencv.org/modules/core/doc/basic_structures.html#mat-push-back\">cv::Mat::push_back</a>:</p>\n\n<pre><code>cv::Mat matF;\nmatF.push_back(matA);\nmatF.push_back(matB);\n</code></pre>\n\n<p>Even merge into a two-channel 3x3 Mat using <a href=\"http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#merge\">cv::merge</a>:</p>\n\n<pre><code>auto channels = std::vector&lt;cv::Mat&gt;{matA, matB};\ncv::Mat matG;\ncv::merge(channels, matG);\n</code></pre>\n\n<p>Think about what you want to add and choose a proper function.</p>\n"}], "owner": {"reputation": 783, "user_id": 4474553, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qerC9.jpg?s=128&g=1", "display_name": "fakeaccount", "link": "https://stackoverflow.com/users/4474553/fakeaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25905, "favorite_count": 4, "accepted_answer_id": 28597696, "answer_count": 2, "score": 6, "last_activity_date": 1424312708, "creation_date": 1424280725, "question_id": 28590031, "link": "https://stackoverflow.com/questions/28590031/add-the-contents-of-2-mats-to-another-mat-opencv-c", "title": "Add the contents of 2 Mats to another Mat opencv c++", "body": "<p>I just want to add the contents of 2 different <code>Mat</code>s to 1 other <code>Mat</code>. I tried:</p>\n\n<pre><code>Mat1.copyTo(newMat);\nMat2.copyTo(newMat);\n</code></pre>\n\n<p>But that just seemed to overwrite the previous contents of the <code>Mat</code>.</p>\n\n<p>This may be a simple question, but I'm lost. </p>\n"}, {"tags": ["c++", "pointers", "memory-management", "stack-overflow", "osx-yosemite"], "comments": [{"owner": {"reputation": 2884, "user_id": 2558027, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/srmnC.jpg?s=128&g=1", "display_name": "sjdowling", "link": "https://stackoverflow.com/users/2558027/sjdowling"}, "edited": false, "score": 5, "creation_date": 1424280540, "post_id": 28589928, "comment_id": 45486584, "body": "You are running out of heap memory, not stack memory."}, {"owner": {"reputation": 414, "user_id": 4369740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/465640e769a726efeeb7d16db1b01259?s=128&d=identicon&r=PG&f=1", "display_name": "tipaye", "link": "https://stackoverflow.com/users/4369740/tipaye"}, "edited": false, "score": 0, "creation_date": 1424280790, "post_id": 28589928, "comment_id": 45486737, "body": "You can&#39;t use [] because you&#39;re getting back a pointer to the unordered_map, not an object of type unordered_map. You need to dereference that pointer first: vector&lt;string&gt; &amp;myVec = (*allMeds)[myString];"}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1424280791, "post_id": 28589928, "comment_id": 45486738, "body": "You do not show your code for bullet #3, so how are we supposed to know?  show ALL relevant code, please."}, {"owner": {"reputation": 249, "user_id": 1730417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c848bbf364702b4ebdb8275343f8445?s=128&d=identicon&r=PG", "display_name": "JDRomano2", "link": "https://stackoverflow.com/users/1730417/jdromano2"}, "edited": false, "score": 0, "creation_date": 1424280824, "post_id": 28589928, "comment_id": 45486760, "body": "OK so I&#39;m running out of heap space, not stack, but still, how do I approach the issue?"}, {"owner": {"reputation": 249, "user_id": 1730417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c848bbf364702b4ebdb8275343f8445?s=128&d=identicon&r=PG", "display_name": "JDRomano2", "link": "https://stackoverflow.com/users/1730417/jdromano2"}, "reply_to_user": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1424281026, "post_id": 28589928, "comment_id": 45486887, "body": "To @OldProgrammer : example code added in the question as an edit."}, {"owner": {"user_type": "does_not_exist", "display_name": "user146043"}, "edited": false, "score": 0, "creation_date": 1424281223, "post_id": 28589928, "comment_id": 45487002, "body": "&quot;OK, so the comments inform me that I&#39;m running out of heap space, not stack space, but this really doesn&#39;t solve my problem at all&quot;  so change the question title/details to reflect your current problem"}, {"owner": {"reputation": 249, "user_id": 1730417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c848bbf364702b4ebdb8275343f8445?s=128&d=identicon&r=PG", "display_name": "JDRomano2", "link": "https://stackoverflow.com/users/1730417/jdromano2"}, "edited": false, "score": 0, "creation_date": 1424281446, "post_id": 28589928, "comment_id": 45487136, "body": "Edited question as requested."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1424281595, "post_id": 28589928, "comment_id": 45487221, "body": "If your app is 32bit then obvious solution is to switch to 64bit"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1424281726, "post_id": 28589928, "comment_id": 45487282, "body": "@JDRomano2 If your application is 64-bit, then you have one poorly designed application, or you have a bug that has corrupted the heap (and is not a memory exhaustion error)."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1424282053, "post_id": 28589928, "comment_id": 45487482, "body": "@JDRomano2 size=8949833580846596096 do you know how much memory is that? That&#39;s 8139826 Terrabytes, there is something definately wrong with your program. Unless you work for NASA or NBA"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1424282258, "post_id": 28589928, "comment_id": 45487606, "body": "@JDRomano2 I agree with Slava.  There is something wrong with your program that is more than likely <i>not</i> memory related, given that ridiculously high value for <code>size</code>.  Maybe your objects are become invalidated, and you still have pointers to them, thus the crazy values?"}, {"owner": {"reputation": 249, "user_id": 1730417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c848bbf364702b4ebdb8275343f8445?s=128&d=identicon&r=PG", "display_name": "JDRomano2", "link": "https://stackoverflow.com/users/1730417/jdromano2"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1424282392, "post_id": 28589928, "comment_id": 45487696, "body": "@PaulMcKenzie Right, that makes sense. It doesn&#39;t look like I have any dangling pointers or the like, so I&#39;m combing through the function where the crash occurs to see where the problem is. I&#39;ve added the function as an edit to the question."}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1424282435, "post_id": 28589928, "comment_id": 45487714, "body": "Your example code shows no pointers."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1424282456, "post_id": 28589928, "comment_id": 45487726, "body": "@JDRomano2 - <code>medSynonymsMap[medSynVec[0]] = medSynVec[1];</code>  You ddid&#39;t check if there are at least 2 entries in <code>medSynVec</code>.  If the number of entries &lt; 2, that line invokes undefined behavior."}, {"owner": {"reputation": 249, "user_id": 1730417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c848bbf364702b4ebdb8275343f8445?s=128&d=identicon&r=PG", "display_name": "JDRomano2", "link": "https://stackoverflow.com/users/1730417/jdromano2"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1424282726, "post_id": 28589928, "comment_id": 45487894, "body": "@PaulMcKenzie Wow, simply testing for <code>medSynVec.size() == 2</code> seems to have resolved the issue. I wonder why not doing so could have resulted in such bizarre behavior."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1424282905, "post_id": 28589928, "comment_id": 45488002, "body": "@JDRomano2 I posted my comment as an answer.  Anytime you go out of bounds of a vector, expect anything to happen, including what you observed."}], "answers": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1424282827, "creation_date": 1424282827, "answer_id": 28590716, "question_id": 28589928, "link": "https://stackoverflow.com/questions/28589928/c-storing-accessing-large-objects-with-pointers-to-avoid-running-out-of-memor/28590716#28590716", "title": "C++: Storing/accessing large objects with pointers to avoid running out of memory", "body": "<p>One issue with the function is this:</p>\n\n<pre><code>  medSynonymsMap[medSynVec[0]] = medSynVec[1];\n</code></pre>\n\n<p>You didn't check to see if <code>medSynVec</code> has at least 2 entries.  If the number of entries is &lt; 2, then the line above invokes undefined behavior.</p>\n"}], "owner": {"reputation": 249, "user_id": 1730417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c848bbf364702b4ebdb8275343f8445?s=128&d=identicon&r=PG", "display_name": "JDRomano2", "link": "https://stackoverflow.com/users/1730417/jdromano2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 28590716, "answer_count": 1, "score": -1, "last_activity_date": 1424282827, "creation_date": 1424280427, "last_edit_date": 1424282262, "question_id": 28589928, "link": "https://stackoverflow.com/questions/28589928/c-storing-accessing-large-objects-with-pointers-to-avoid-running-out-of-memor", "title": "C++: Storing/accessing large objects with pointers to avoid running out of memory", "body": "<p>I have a C++ application that needs to have several extremely large unordered_maps loaded into memory simultaneously, and as a result I run out of <s>stack space</s> <strong>heap space</strong> during runtime (after some of the large unordered_maps are already loaded):</p>\n\n<pre><code>granger(34190, 0x7fff73062300) malloc: *** mach_vm_map(size=8949833580846596096) failed (error code=3)\n*** error: can't allocate region\n*** set a breakpoint in malloc_error_break to debug\nlibc++abi.dylib: terminating with uncaught exception of type std::bad_alloc: std::bad_alloc\n[1]    34488 abort      ./granger\n</code></pre>\n\n<p>It seems like a potential solution would be to keep some of these large data structures <s>in the heap</s> <strong>stored as pointers</strong>, allowing me to avoid running out of memory. <strong>Is this logic correct?</strong></p>\n\n<p>If yes, here's the next issue I encounter when I try to implement the change: </p>\n\n<ul>\n<li>When I declare the unordered_maps that I want to keep in the heap, I do so using a pointer (e.g.; <code>unordered_map&lt; string,vector&lt;string&gt; &gt; *allMeds = mapAllMeds(ALL_MEDS_FILE);</code></li>\n<li>The <code>mapAllMeds</code> function creates the large unordered_map and I assume it returns it to the pointer named <code>*allMeds</code>. No issue yet</li>\n<li>When I try to access elements in <code>*allMeds</code> (or any of the other unordered_maps I defined as pointers), I get the error <code>no viable overloaded operator[] for type 'unordered_map&lt;string, vector&lt;string&gt; &gt; *</code>.</li>\n</ul>\n\n<p><strong>EDIT:</strong> Example code for 3rd bullet point: <code>vector&lt;string&gt; medsForPatient = allMeds[aPatient.getDeid()];</code> returns the error I described above.</p>\n\n<p>Does this mean that I can't use the normal <code>[]</code> operator when I try to access key/value pairs in unordered maps that are defined by pointer? If not, what workaround can be used instead?</p>\n\n<p><strong>EDIT 2: OK, so the comments inform me that I'm running out of heap space, not stack space, but this really doesn't solve my problem at all: What approach can I take to get all of the data structures into memory at the same time without running out of addressable memory space?</strong></p>\n\n<p><strong>EDIT 3:</strong> Here's the function that the application crashes on running:</p>\n\n<pre><code>unordered_map&lt;string,string&gt; makeMedSynonyms() {\n    unordered_map&lt;string,string&gt; medSynonymsMap;\n    string delimiters = \"|\";\n    ifstream ifs(MED_SYNONYMS_FILE);\n    string line;\n    while(std::getline(ifs, line)) {\n        vector&lt;string&gt; medSynVec;\n        string::size_type lastPos = line.find_first_not_of(delimiters, 0);\n        string::size_type pos = line.find_first_of(delimiters, lastPos);\n        while(string::npos != pos || string::npos != lastPos) {\n            medSynVec.push_back(line.substr(lastPos, pos - lastPos));\n            lastPos = line.find_first_not_of(delimiters, pos);\n            pos = line.find_first_of(delimiters, lastPos);\n        }\n        medSynonymsMap[medSynVec[0]] = medSynVec[1];\n    }\n    return medSynonymsMap;\n}\n</code></pre>\n"}, {"tags": ["c++", "c++14", "string-literals", "user-defined-literals"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1424280339, "post_id": 28589863, "comment_id": 45486426, "body": "I much prefer doing <code>using namespace std::literals;</code> to doing <code>using std::operator&quot;&quot; s;</code> or <code>using namespace std;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3920237"}, "edited": false, "score": 1, "creation_date": 1424280952, "post_id": 28589863, "comment_id": 45486849, "body": "Better yet, just watch <a href=\"https://www.youtube.com/watch?v=dTeKf5Oek2c\" rel=\"nofollow noreferrer\">CppCon 2014: Stephan Lavavej &quot;STL Features And Implementation Techniques&quot;</a>, he briefly talks about UDL&#39;s in inline namespaces."}], "owner": {"reputation": 11552, "user_id": 499359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Xrx9K.gif?s=128&g=1", "display_name": "PaperBirdMaster", "link": "https://stackoverflow.com/users/499359/paperbirdmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "closed_date": 1424280976, "answer_count": 0, "score": 5, "last_activity_date": 1424280250, "creation_date": 1424280250, "question_id": 28589863, "link": "https://stackoverflow.com/questions/28589863/is-there-a-reason-to-place-operator-s-into-stdliteralsstring-literals", "closed_reason": "Duplicate", "title": "Is there a reason to place operator &quot;&quot;s into std::literals::string_literals?", "body": "<p>I'm pretty surprised to discover that this code doesn't compile (assuming we're using a C++14 compiler):</p>\n\n<pre><code>std::cout &lt;&lt; \"hello world!\\n\"s;\n</code></pre>\n\n<p>The error showed by ideone is the <a href=\"http://ideone.com/NiTBaL\" rel=\"noreferrer\">following</a>:</p>\n\n<blockquote>\n  <p>unable to find string literal operator 'operator\"\"s'</p>\n</blockquote>\n\n<p>Luckily is pretty simple to fix with a <code>using</code> statement:</p>\n\n<pre><code>using namespace std::literals::string_literals;\nstd::cout &lt;&lt; \"hello world!\\n\"s; // Compiles!\n</code></pre>\n\n<p>I'm wondering if there's a reason behind the placement of the standard string user defined literals in a different namespace than the <code>std::string</code> itself; I have been thinking on it and I cannot figure the reason.</p>\n\n<p>Isn't possible to collide with the <code>operator\"\"s</code> from <code>std::chrono</code> because they operate with different types:</p>\n\n<pre><code>auto ten_seconds = 10s; // ten seconds\nauto some_string = \"some string\"s; // some string\n</code></pre>\n\n<p>I was thinking that the resason could be to not collide with my user defined literals but <em>the standard says</em> that <a href=\"http://ideone.com/AOUoqI\" rel=\"noreferrer\">I must preceed them with <code>'_'</code> underscore</a>:</p>\n\n<blockquote>\n  <p>warning: literal operator suffixes not preceded by '_' are reserved for future standardization</p>\n</blockquote>\n\n<p>So, I'm pretty surprised, anyone knows the reason behind placing the string literal operator into the <code>std::literals::string_literals</code>?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "inheritance"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1424278355, "post_id": 28589080, "comment_id": 45485078, "body": "This looks like a case for Polymorphism: <a href=\"http://www.cplusplus.com/doc/tutorial/polymorphism/\" rel=\"nofollow noreferrer\">cplusplus.com/doc/tutorial/polymorphism</a>"}, {"owner": {"reputation": 532, "user_id": 1125868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea68b48580e664f10518f86293b74f9?s=128&d=identicon&r=PG", "display_name": "sanjayk79", "link": "https://stackoverflow.com/users/1125868/sanjayk79"}, "edited": false, "score": 0, "creation_date": 1424278426, "post_id": 28589080, "comment_id": 45485121, "body": "read about virtual functions."}, {"owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424278583, "post_id": 28589080, "comment_id": 45485241, "body": "As I said, I can&#39;t make the function virtual because I need to create an instance of the class. I&#39;m reading about Polymorphism, thanks for the reply."}, {"owner": {"reputation": 235784, "user_id": 673730, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d1e4893fe7a566e6e4b90876b642163?s=128&d=identicon&r=PG", "display_name": "Luchian Grigore", "link": "https://stackoverflow.com/users/673730/luchian-grigore"}, "edited": false, "score": 0, "creation_date": 1424278651, "post_id": 28589080, "comment_id": 45485293, "body": "You can and probably should make them virtual. What you mean is you can&#39;t make them pure virtual."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1424278697, "post_id": 28589080, "comment_id": 45485331, "body": "@farukdgn You actually can make functions <code>virtual</code> without the need for having them abstract (<i>pure  virtual</i>) in the base."}, {"owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424278753, "post_id": 28589080, "comment_id": 45485374, "body": "Ah, yes, I was talking about making pure virtual. But I already tried using virtual function, but it didn&#39;t help"}, {"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 1, "creation_date": 1424278778, "post_id": 28589080, "comment_id": 45485393, "body": "@farukdgn Not only can you make the function virtual, but you can probably make it pure virtual. Your difficulty lies in trying to instantiate an array of the base class which in C++ is not at all what you need. It&#39;s quite different from Java where all classes are passed around as references."}, {"owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424278902, "post_id": 28589080, "comment_id": 45485492, "body": "I make the function virtual, and I get LNK2019 errors if I don&#39;t define it in chessman class, and if I define it in chessman and use the code below, it still uses the one in the chessman class."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424284221, "post_id": 28589080, "comment_id": 45488754, "body": "Personally I wouldn&#39;t use polymorphism for this. I would just create an enum field depending what piece it is."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424287209, "post_id": 28589080, "comment_id": 45490574, "body": "@NeilKirk: That means <code>move()</code> has to look at the enum and perform any number of different validations based on the enum value.  That also puts the burden on the caller to pass the correct enum to <code>move()</code>.  Polymorphism makes that more isolated and specialized.  What you describe is how it should be done in C, not in C++."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1424291165, "post_id": 28589080, "comment_id": 45492972, "body": "@RemyLebeau This is Chess, right? There are not that many possibilities. Why is the burden on the caller? The enum field is still a member of the class. Is it worth the dynamic memory allocations just to use the fancy feature of virtual functions? Right tool for the right job."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1424300696, "post_id": 28589080, "comment_id": 45497976, "body": "@NeilKirk: # of possible moves - pawn: 4, rook: 5, knight: 8, bishop: 4, queen: 8, king: 9.  That&#39;s 38 possible moves. Obviously, <code>move()</code> would have to filter by piece type, then check that type&#39;s specific possibilities. Which is the same thing that the polymorphic solution would also do."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1424304110, "post_id": 28589080, "comment_id": 45499154, "body": "@RemyLebeau I don&#39;t understand why 6 virtual functions is super and 1 function with a switch statement and 6 cases is so bad. You can even get some redundancy as, for example, the queen moves as a bishop and a rook. I&#39;ve done Chess AI before."}], "answers": [{"comments": [{"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 1, "creation_date": 1424279546, "post_id": 28589287, "comment_id": 45485903, "body": "Regarding your last sentence, I disagree. In fact, I think this <code>move</code> is a perfect candidate for a non-virtual public function, because there are basic <code>pos</code> checks independent of any concrete chessman, namely checking if the position is within the board. Pseudo code: <code>void move(pos p) { if (p not within board) then error handling else doMove(p); }</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1424282577, "post_id": 28589287, "comment_id": 45487811, "body": "<code>move()</code> should be virtual because different types of chess pieces have different rules regarding their valid moves.  <code>chessman::move()</code> could do the basic validation of making sure the position is within the board, but then each piece should override <code>move()</code> to make sure the position is also a valid move for that particular type of piece."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1424282895, "post_id": 28589287, "comment_id": 45487997, "body": "@RemyLebeau: I am talking about making <code>move</code> non-virtual and have it delegate to a private virtual function. Requiring derived classes to call parent functions is error-prone. In C++, the guideline is to make virtual functions private and public functions non-virtual (except of the destructor, of course)."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424282989, "post_id": 28589287, "comment_id": 45488063, "body": "P.S.: This old article by Herb Sutter still sums it up nicely: <a href=\"http://www.gotw.ca/publications/mill18.htm\" rel=\"nofollow noreferrer\">gotw.ca/publications/mill18.htm</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424283360, "post_id": 28589287, "comment_id": 45488276, "body": "@ChristianHackl: virtual methods that are <code>private</code> cannot be overridden in descendants, they need to be <code>protected</code> or <code>public</code> instead. But I understand what you are saying."}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1424284049, "post_id": 28589287, "comment_id": 45488663, "body": "@RemyLebeau: This is wrong. In C++, you <i>can</i> override private virtual methods. And you <i>should</i> do so, too, as I said. Please refer to the article, or just try it in any compiler."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "edited": false, "score": 0, "creation_date": 1424284606, "post_id": 28589287, "comment_id": 45488992, "body": "@ChristianHackl: In my 16 years of being a C++ programmer, I have <i>never once</i> heard that a <code>private</code> virtual method can be overridden in a descendant class.  <code>private</code> data members are not accessible to descendants, and <code>private</code> base methods cannot be called directly by descendants. But a <code>private</code> virtual method can be overridden by a descendant? That is new to me.  I tried it, and it works!"}, {"owner": {"reputation": 25063, "user_id": 3313064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBXlB.jpg?s=128&g=1", "display_name": "Christian Hackl", "link": "https://stackoverflow.com/users/3313064/christian-hackl"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1424284872, "post_id": 28589287, "comment_id": 45489146, "body": "@RemyLebeau: Well, I remember it sounded wrong to me, too, when I heard it for the first time. But it quickly started to feel normal, and nowadays I sorely miss it in languages like Java (which do not allow it). I consider this distinction a great feature of C++, as it better separates client concerns from implementer concerns."}], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1424284218, "last_edit_date": 1424284218, "creation_date": 1424278650, "answer_id": 28589287, "question_id": 28589080, "link": "https://stackoverflow.com/questions/28589080/using-inherited-function-instead-of-the-base-not-abstract/28589287#28589287", "title": "Using inherited function instead of the base (not abstract)", "body": "<p>In C++ you would create a <code>vector</code> (or possibly <code>array</code> in C++11) of some sort of pointer (the pointer type would be dictated by the object ownership) to a chessman, and have chessman be abstract. It's just a slightly different way of thinking about things.</p>\n\n<p>(Edited as the comments made a great point):\nTo make it select the proper <code>move</code> function, utilize the <code>virtual</code> mechanism in the base class. I would suggest to separate interface from implementation by not having public virtual functions. Instead, use a public non-virtual interface and a private or protected virtual implementation. You would use a private implementation which each child totally replaces the functionality while you would use protected when the child class needs to also invoke the parent functionality.</p>\n"}, {"comments": [{"owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424285671, "post_id": 28590608, "comment_id": 45489605, "body": "I have problems about creating 2D array of pointers. I define it with <code>chessman *board[8][8];</code> and try to access with <code>*(board[i][j]).color</code>. But IntelliSense tells me that <code>expression must have class type</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424286314, "post_id": 28590608, "comment_id": 45490037, "body": "Use <code>(*(board[i][j])).color</code> or <code>board[i][j]-&gt;color</code> instead."}, {"owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424286547, "post_id": 28590608, "comment_id": 45490185, "body": "Oh sorry, my bad. But I expected *(board[i][j]).color to work. Does it not seem okay?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 1, "creation_date": 1424286796, "post_id": 28590608, "comment_id": 45490340, "body": "No, it is not OK, because of <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">Operator Precedence</a>. The <code>.</code> operator has a higher priority than the <code>*</code> operator, so <code>*(board[i][j]).color</code> is essentially the same as <code>*((board[i][j]).color)</code> - trying to dereference the <code>color</code> value instead of the <code>chessman</code> pointer, hence the error and why the extra explicit parenthesis are needed to tell the compiler what you want the <code>*</code> operator applied to.  Using <code>-&gt;</code> instead makes this cleaner.  When using pointers, you really should be using <code>ptr-&gt;member</code> and not <code>(*ptr).member</code>."}, {"owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "edited": false, "score": 0, "creation_date": 1424286946, "post_id": 28590608, "comment_id": 45490430, "body": "Thanks! I already use -&gt;, but since I&#39;m new to C++, I usually mix things with Java."}], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 3, "last_activity_date": 1424284689, "last_edit_date": 1424284689, "creation_date": 1424282465, "answer_id": 28590608, "question_id": 28589080, "link": "https://stackoverflow.com/questions/28589080/using-inherited-function-instead-of-the-base-not-abstract/28590608#28590608", "title": "Using inherited function instead of the base (not abstract)", "body": "<blockquote>\n  <p>I can't make chessman an abstract class because I need to create an 2D array of it.</p>\n</blockquote>\n\n<p>Yes, you can.  You don't create an array of <code>chessman</code> objects, you create an array of <strong>pointers to</strong> <code>chessman</code> objects.  Then <code>chessman</code> can be abstract (as it should be, since you should not be creating instances of <code>chessman</code> directly to begin with).</p>\n\n<blockquote>\n  <p>pawn class inherits chessman and I need to use move function of pawn when I write this</p>\n</blockquote>\n\n<p>Polymorphism handles that for you.  But in order to use an array of polymorphic objects, the array needs to hold pointers/references to objects that are stored elsewhere in memory, not hold the actual objects themselves.</p>\n\n<blockquote>\n  <p>In Java, it's easy since you can create arrays of abstract classes, but in C++ it is just confusing.</p>\n</blockquote>\n\n<p>You do the exact same thing in C++.  In Java, objects are reference types, so they are always referenced by pointer (the Java language simply hides that detail from you).</p>\n\n<p>Try something like this:</p>\n\n<pre><code>class chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos) = 0;\n\npublic:\n    int i;\n    int j;\n    string name;\n    char color;\n    chessman(string aname, char acolor);\n    bool move(string final_pos);\n};\n\nchessman::chessman(string aname, char acolor)\n    : name(aname), color(acolor)\n{\n}\n\nbool chessman::move(string final_pos)\n{\n    // validate that final_pos is a valid position on the board...\n\n    // validate that final_pos is a valid position for the piece being moved...\n    if (!isValidMove(final_pos))\n        return false;\n\n    // move to the position...\n\n    return true;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>class pawn : public chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos);\n\npublic:\n    pawn(string pos, char color);\n};\n\npawn::pawn(string pos, char color)\n    : chessman(\"pawn\", color)\n{\n    //...\n}\n\nbool pawn::isValidMove(string final_pos)\n{\n    // validate that final_pos is a valid position for this pawn to move to...\n    return ...;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>class rook : public chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos);\n\npublic:\n    rook(string pos, char color);\n};\n\nrook::rook(string pos, char color)\n    : chessman(\"rook\", color)\n{\n    //...\n}\n\nbool rook::isValidMove(string final_pos)\n{\n    // validate that final_pos is a valid position for this rook to move to...\n    return ...;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>class knight : public chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos);\n\npublic:\n    knight(string pos, char color);\n};\n\nknight::knight(string pos, char color)\n    : chessman(\"knight\", color)\n{\n    //...\n}\n\nbool knight::isValidMove(string final_pos)\n{\n    // validate that final_pos is a valid position for this knight to move to...\n    return ...;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>class bishop : public chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos);\n\npublic:\n    bishop(string pos, char color);\n};\n\nbishop::bishop(string pos, char color)\n    : chessman(\"bishop\", color)\n{\n    //...\n}\n\nbool bishop::isValidMove(string final_pos)\n{\n    // validate that final_pos is a valid position for this bishop to move to...\n    return ...;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>class queen : public chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos);\n\npublic:\n    queen(string pos, char color);\n};\n\nqueen::queen(string pos, char color)\n    : chessman(\"queen\", color)\n{\n    //...\n}\n\nbool queen::isValidMove(string final_pos)\n{\n    // validate that final_pos is a valid position for this queen to move to...\n    return ...;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>class king : public chessman\n{\nprivate:\n    virtual bool isValidMove(string final_pos);\n\npublic:\n    king(string pos, char color);\n};\n\nking::king(string pos, char color)\n    : chessman(\"king\", color)\n{\n    //...\n}\n\nbool king::isValidMove(string final_pos)\n{\n    // validate that final_pos is a valid position for this king to move to...\n    return ...;\n}\n</code></pre>\n\n<p>Then you can do somthing like this:</p>\n\n<pre><code>chessman* white_pieces[16];\nchessman* black_pieces[16];\n\nfor (int i = 0; i &lt; 8; ++i)\n{\n    white_pieces[i] = new pawn(...);\n    black_pieces[i] = new pawn(...);\n}\n\nfor (int i = 8; i &lt; 10; ++i)\n{\n    white_pieces[i] = new rook(...);\n    black_pieces[i] = new rook(...);\n}\n\nfor (int i = 10; i &lt; 12; ++i)\n{\n    white_pieces[i] = new knight(...);\n    black_pieces[i] = new knight(...);\n}\n\nfor (int i = 12; i &lt; 14; ++i)\n{\n    white_pieces[i] = new bishop(...);\n    black_pieces[i] = new bishop(...);\n}\n\nwhite_pieces[14] = new queen(...);\nblack_pieces[14] = new queen(...);\n\nwhite_pieces[15] = new king(...);\nblack_pieces[15] = new king(...);\n</code></pre>\n\n<p>And move them around as needed:</p>\n\n<pre><code>white_pieces[index]-&gt;move(pos);\n...\nblack_pieces[index]-&gt;move(pos);\n</code></pre>\n\n<p>And of course, don't forget to cleanup when you are done:</p>\n\n<pre><code>for (int i = 0; i &lt; 16; ++i)\n{\n    delete white_pieces[i];\n    delete black_pieces[i];\n}\n</code></pre>\n\n<p>To make the cleanup automatic, you can use an array of <code>std::auto_ptr&lt;chessman&gt;</code> objects. Or, in C++11 and later, a <code>std::vector</code>/<code>std::array</code> of <code>std::unique_ptr&lt;chessman&gt;</code> objects.</p>\n"}], "owner": {"reputation": 799, "user_id": 3025112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3969372f245ff510feb5ba5ae7d08474?s=128&d=identicon&r=PG&f=1", "display_name": "omerfarukdogan", "link": "https://stackoverflow.com/users/3025112/omerfarukdogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 28590608, "answer_count": 2, "score": 0, "last_activity_date": 1424284689, "creation_date": 1424278117, "last_edit_date": 1495540616, "question_id": 28589080, "link": "https://stackoverflow.com/questions/28589080/using-inherited-function-instead-of-the-base-not-abstract", "title": "Using inherited function instead of the base (not abstract)", "body": "<p>I want to have classes named <code>chessman</code> and <code>pawn</code>, for example. I can't make chessman an abstract class because I need to create an 2D array of it. <code>pawn</code> class inherits <code>chessman</code> and I need to use <code>move</code> function of <code>pawn</code> when I write this:</p>\n\n<pre><code>chessman *cm = new pawn(\"a3\", 'w');\ncm-&gt;move(pos);\n</code></pre>\n\n<p>This code uses <code>chessman::move</code>. What can I do to make it use the one from <code>pawn</code> class? My question is very similar to <a href=\"https://stackoverflow.com/questions/10026637/how-to-call-overloading-functions-from-the-base-class-not-abstract\" title=\"this question\">this question</a>, but my function doesn't take <code>pawn</code> as an argument. In Java, it's easy since you can create arrays of abstract classes, but in C++ it is just confusing.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is definition of chessman class (function already is virtual as you can see):</p>\n\n<pre><code>class chessman\n{\npublic:\n    int i;\n    int j;\n    string name;\n    char color;\n    virtual bool move(string final_pos);\n};\n</code></pre>\n\n<p>And pawn:</p>\n\n<pre><code>class pawn : public chessman\n{\npublic:\n    pawn(string pos, char color);\n    bool move(string final_pos);\n};\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1424278216, "post_id": 28589051, "comment_id": 45484976, "body": "I would think that since you are using <code>_tmain</code> that this is an issue with Unicode."}, {"owner": {"reputation": 9466, "user_id": 350685, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/62636c0bbd7f647a022b3374849b03a6?s=128&d=identicon&r=PG", "display_name": "Sriram", "link": "https://stackoverflow.com/users/350685/sriram"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1424278569, "post_id": 28589051, "comment_id": 45485227, "body": "@NathanOliver: Can you please elaborate?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1424278662, "post_id": 28589051, "comment_id": 45485303, "body": "@NathanOliver since the string clearly isn&#39;t a wide string it doesn&#39;t matter if the build is Unicode or not."}, {"owner": {"reputation": 9466, "user_id": 350685, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/62636c0bbd7f647a022b3374849b03a6?s=128&d=identicon&r=PG", "display_name": "Sriram", "link": "https://stackoverflow.com/users/350685/sriram"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1424278676, "post_id": 28589051, "comment_id": 45485317, "body": "@KarolyHorvath: <code>string</code> is <code>typedef basic_string&lt;char, char_traits&lt;char&gt;, allocator&lt;char&gt; &gt; \tstring;</code>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1424278972, "post_id": 28589051, "comment_id": 45485539, "body": "@MarkRansom: Your right.  I was thinking basic_string which takes a charT."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424361917, "post_id": 28589051, "comment_id": 45525783, "body": "Please update your question to show the <code>#include</code> directives. It could matter whether you&#39;re using the <code>isalnum</code> function defined in <code>&lt;cctype&gt;</code>, or the template function defined in <code>&lt;locale&gt;</code>."}, {"owner": {"reputation": 9466, "user_id": 350685, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/62636c0bbd7f647a022b3374849b03a6?s=128&d=identicon&r=PG", "display_name": "Sriram", "link": "https://stackoverflow.com/users/350685/sriram"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424412488, "post_id": 28589051, "comment_id": 45547041, "body": "@KeithThompson: Updated the code. The version I am using is within &lt;locale&gt;."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424418907, "post_id": 28589051, "comment_id": 45549281, "body": "You might still be using the <code>isalnum</code> declared in <code>&lt;cctype&gt;</code>. Headers can include other headers, and I&#39;m not sure enough about C++ rules to be certain."}, {"owner": {"reputation": 9466, "user_id": 350685, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/62636c0bbd7f647a022b3374849b03a6?s=128&d=identicon&r=PG", "display_name": "Sriram", "link": "https://stackoverflow.com/users/350685/sriram"}, "edited": false, "score": 0, "creation_date": 1424419711, "post_id": 28589051, "comment_id": 45549652, "body": "How can I check this?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424452625, "post_id": 28589051, "comment_id": 45569007, "body": "@Sriram: Someone who knows C++ better than I do will have to answer that. It&#39;s entirely possible that I&#39;m wrong."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424731168, "post_id": 28589051, "comment_id": 45662563, "body": "Correction: You&#39;re definitely using the <code>isalnum</code> declared in <code>&lt;cctype&gt;</code>. See the answer I just posted. (I&#39;m still not 100% sure of this, since I don&#39;t do a whole lot of C++; wait for the C++ experts to review what I wrote.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424731810, "post_id": 28589051, "comment_id": 45662840, "body": "@KeithThompson your answer is good"}], "answers": [{"comments": [{"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 2, "creation_date": 1424278906, "post_id": 28589340, "comment_id": 45485495, "body": "To be pedantic here, the signed-ness of <code>char</code>acters is implementation defined, not signed by default."}, {"owner": {"reputation": 9466, "user_id": 350685, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/62636c0bbd7f647a022b3374849b03a6?s=128&d=identicon&r=PG", "display_name": "Sriram", "link": "https://stackoverflow.com/users/350685/sriram"}, "edited": false, "score": 0, "creation_date": 1424279135, "post_id": 28589340, "comment_id": 45485631, "body": "@MarkRansom: Changing the input to <code>unsigned char</code> does work, as I have indicated in my question. What I do not understand is that the function description for <code>isalnum</code> states that it accepts <code>charT</code> as input: <a href=\"http://www.cplusplus.com/reference/locale/isalnum/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/locale/isalnum</a>. I am assuming the <code>charT</code> is the signed char. If that is true, then the straight call to <code>isalnum</code> should work too, right? No need to cast it to <code>unsigned char</code>?"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 0, "creation_date": 1424280336, "post_id": 28589340, "comment_id": 45486424, "body": "@MarkB to be even more pedantic, the question is specifically about Visual Studio which absolutely defaults to signed."}, {"owner": {"reputation": 16519, "user_id": 19100, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d85c685bac51d4cc044f3bc15f09316f?s=128&d=identicon&r=PG", "display_name": "dalle", "link": "https://stackoverflow.com/users/19100/dalle"}, "edited": false, "score": 1, "creation_date": 1424291124, "post_id": 28589340, "comment_id": 45492947, "body": "<code>isalnum</code> et al should be avoided for anything which isn&#39;t ASCII [0-127]. Use a good Unicode library for anything which isn&#39;t ASCII."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 16519, "user_id": 19100, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d85c685bac51d4cc044f3bc15f09316f?s=128&d=identicon&r=PG", "display_name": "dalle", "link": "https://stackoverflow.com/users/19100/dalle"}, "edited": false, "score": 1, "creation_date": 1424294883, "post_id": 28589340, "comment_id": 45495086, "body": "@dalle that&#39;s good advice, but sometimes you don&#39;t have any control over your input. The function is very explicit about which characters it will return <code>true</code> for, so as long as you don&#39;t expect a <code>true</code> for anything outside of the ASCII range it should still be usable."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424362233, "post_id": 28589340, "comment_id": 45526028, "body": "@MarkRansom: The <code>isalnum()</code> function declared in <code>&lt;cctype&gt;</code> pays attention to the current locale. In the default <code>&quot;C&quot;</code> locale, it returns true only for the 52 upper and lower case letters and the 10 digits."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424362542, "post_id": 28589340, "comment_id": 45526265, "body": "@KeithThompson do you know if Microsoft&#39;s implementation produces <code>true</code> for characters other than the ones in the documentation if you specify a different locale? If so then the documentation is faulty - it wouldn&#39;t be the first time."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1424362703, "post_id": 28589340, "comment_id": 45526370, "body": "@MarkRansom: No, I don&#39;t know. The standard says that it can return true for any member of a locale-specific set of characters (there are more details in the standard). That set may legally be empty."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1424731916, "post_id": 28589340, "comment_id": 45662903, "body": "The &quot;why&quot; is for historical reasons. The function is defined so that it can be implemented via lookup table, e.g. the implementation headers can have <code>extern char __isalnum_table[UCHAR_MAX];</code> and <code>#define isalnum(x) __isalnum_table[x]</code>.  However the standard also requires non-macro implementations to be available, so if you wrote <code>(isalnum)(x)</code> you have to get a function implementation, and I believe vendors typically wrote those to cope with negative values even though the standard doesn&#39;t require it."}], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": false, "score": 1, "last_activity_date": 1424280965, "last_edit_date": 1424280965, "creation_date": 1424278783, "answer_id": 28589340, "question_id": 28589051, "link": "https://stackoverflow.com/questions/28589051/using-isalnum-with-signed-character-inputs-visual-c/28589340#28589340", "title": "Using isalnum with signed character inputs - Visual C++", "body": "<p>The problem is that characters are signed by default, and anything over 0x7f is being treated as a negative number when passed to <code>isalnum</code>. Make this simple change:</p>\n\n<pre><code>        if (isalnum((unsigned char)test[i])) {\n</code></pre>\n\n<p>Microsoft's <a href=\"https://msdn.microsoft.com/en-us/library/k84c0490.aspx\" rel=\"nofollow\">documentation</a> clearly states that the parameter is <code>int</code>, not <code>char</code>. I believe you're getting confused with a <a href=\"https://msdn.microsoft.com/en-us/library/w53whada.aspx\" rel=\"nofollow\">different version of <code>isalnum</code></a> that comes from the <code>locale</code> header. I don't know why the function doesn't accept sign-extended negative numbers, but suspect that it's based on wording in the standard.</p>\n"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 3, "last_activity_date": 1424731110, "creation_date": 1424731110, "answer_id": 28684920, "question_id": 28589051, "link": "https://stackoverflow.com/questions/28589051/using-isalnum-with-signed-character-inputs-visual-c/28684920#28684920", "title": "Using isalnum with signed character inputs - Visual C++", "body": "<p>The <code>isalnum</code> function is declared in <code>&lt;cctype&gt;</code> (the C++ version of <code>&lt;ctype.h&gt;</code>) -- which means you really should have <code>#include &lt;cctype&gt;</code> at the top of your source file. You're getting away with calling it without the <code>#include</code> directive because either <code>\"stdafx.h\"</code> or one of the standard headers (likely <code>&lt;locale&gt;</code>) includes it -- but it's a bad idea to depend on that.</p>\n\n<p><code>isalnum</code> and friends come from C. The <code>isalnum</code> function takes an argument of type <code>int</code>, which must be either within the range of <code>unsigned char</code> <em>or</em> equal to <code>EOF</code> (which is typically <code>-1</code>). If the argument has any other value, the behavior is undefined.</p>\n\n<p>Annoyingly, this means that if plain <code>char</code> happens to be signed, passing a <code>char</code> value to <code>isalnum</code> causes undefined behavior if the value happens to be negative and not equal to <code>EOF</code>. The signedness of plain <code>char</code> is implementation-defined; it seems to be signed on most modern systems.</p>\n\n<p>C++ adds a <em>template</em> function <code>isalnum</code> that takes an argument of any character type and a second argument of type <code>std::locale</code>.  Its declaration is:</p>\n\n<pre><code>template &lt;class charT&gt; bool isalnum (charT c, const locale&amp; loc);\n</code></pre>\n\n<p>I'm fairly sure that this version of <code>isalnum</code> doesn't suffer from the same problem as the one in <code>&lt;cctype&gt;</code>. You can pass it a <code>char</code> value and it will handle it correctly. You can also pass it an argument of some wide character type like <code>wchar_t</code>. But it requires two arguments. Since you're only passing one argument to <code>isalnum()</code>, you're not using this version; you're using the <code>isalnum</code> declared in <code>&lt;cctype&gt;</code>.</p>\n\n<p>If you want to use this version, you can pass the default locale as the second argument:</p>\n\n<pre><code>std::isalnum(test[i], std::locale())\n</code></pre>\n\n<p>Or, if you're sure you're only working with narrow characters (type <code>char</code>), you can cast the argument to <code>unsigned char</code>:</p>\n\n<pre><code>std::isalnum(static_cast&lt;unsigned char&gt;(test[i]))\n</code></pre>\n"}], "owner": {"reputation": 9466, "user_id": 350685, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/62636c0bbd7f647a022b3374849b03a6?s=128&d=identicon&r=PG", "display_name": "Sriram", "link": "https://stackoverflow.com/users/350685/sriram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1424731110, "creation_date": 1424278020, "last_edit_date": 1424412458, "question_id": 28589051, "link": "https://stackoverflow.com/questions/28589051/using-isalnum-with-signed-character-inputs-visual-c", "title": "Using isalnum with signed character inputs - Visual C++", "body": "<p>I have a very simple program where I am using the <code>isalnum</code> function to check if a string contains alpha-numeric characters. The code is:  </p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;locale&gt;\nusing namespace std;\n\nint _tmain(int argc, _TCHAR* argv[]) {\n\n    string test = \"(\u2026\u2026.\";\n\n    for ( unsigned int i = 0; i &lt; test.length(); i++) {     \n            if (isalnum(test[i])) {\n                cout &lt;&lt; \"True: \" &lt;&lt; test[i] &lt;&lt; \" \" &lt;&lt; (int)test[i] &lt;&lt; endl;\n            }\n            else {\n                cout &lt;&lt; \"False: \" &lt;&lt; isalnum(test[i]) &lt;&lt; test[i] &lt;&lt; \" \" &lt;&lt; (int)test[i] &lt;&lt; endl;\n            }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I am using Visual Studio Desktop Edition 2013 for this snippet. \nThe issue(s):<br>\n1. When this program is run in Debug mode, the program fails with a debug assertion that says: \"Expression c >= -1 &amp;&amp; c &lt;= 255\"<br>\nPrinting the character at the <code>ith</code> position results in a negative integer (-123). Converting all calls to isalnum to accept <code>unsigned char</code> as input causes the above error to disappear.  </p>\n\n<p>I checked the documentation for <code>isalnum</code> and it accepts arguments of type <code>char</code>. Then why does this code snippet fail? I am sure I am missing something trivial here but any help is welcome.</p>\n"}, {"tags": ["c++", "mongodb", "insert", "server-side"], "comments": [{"owner": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1424377272, "post_id": 28588900, "comment_id": 45535254, "body": "I&#39;m sorry - could you clarify what you want to do? You want a call from the client, like an insert, to trigger another insert purely on the database side?"}, {"owner": {"reputation": 121, "user_id": 3877763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e4b90438714644aaa5b1894b4877eba8?s=128&d=identicon&r=PG&f=1", "display_name": "Paam", "link": "https://stackoverflow.com/users/3877763/paam"}, "reply_to_user": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1424426638, "post_id": 28588900, "comment_id": 45553209, "body": "I want to develop a code, such that when a query comes in, for example a &quot;find&quot; function, then automatically an insertion will take place to a separated collection and save a record of the query. Something like profiling does in MongoDB.  But I can not find the proper code for it."}, {"owner": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1424448287, "post_id": 28588900, "comment_id": 45566389, "body": "You&#39;ll need to insert the query to another collection with using the client. You can&#39;t have the server so it automatically for you - except via profiling. Why can&#39;t you use profiling if you want to track queries?"}, {"owner": {"reputation": 121, "user_id": 3877763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e4b90438714644aaa5b1894b4877eba8?s=128&d=identicon&r=PG&f=1", "display_name": "Paam", "link": "https://stackoverflow.com/users/3877763/paam"}, "reply_to_user": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1424452576, "post_id": 28588900, "comment_id": 45568974, "body": "Because I am trying to develop a tool which I like to test its functionality on MongoDB code. So I will appreciate if you can point me to the part of MongoDB code where profiling is actually coded, so that I can mimic its usage or at least see if I can make the changes that I need to it?"}, {"owner": {"reputation": 121, "user_id": 3877763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e4b90438714644aaa5b1894b4877eba8?s=128&d=identicon&r=PG&f=1", "display_name": "Paam", "link": "https://stackoverflow.com/users/3877763/paam"}, "reply_to_user": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1424484906, "post_id": 28588900, "comment_id": 45581504, "body": "this is more like an exercise for me to gain a better understanding of MongoDB code structure  from a developer point of view and see how I can develop new code around it. Unless this first part could have been done with profiling."}], "owner": {"reputation": 121, "user_id": 3877763, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e4b90438714644aaa5b1894b4877eba8?s=128&d=identicon&r=PG&f=1", "display_name": "Paam", "link": "https://stackoverflow.com/users/3877763/paam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424277672, "creation_date": 1424277672, "question_id": 28588900, "link": "https://stackoverflow.com/questions/28588900/trigger-insertion-from-within-server-code-of-mongodb", "title": "trigger insertion from within server code of MongoDB", "body": "<p>I need to trigger insertion to a collection from within the server code without involving client driver.   </p>\n\n<p>I wrote the following code:</p>\n\n<pre><code>BatchedCommandRequest request (BatchedCommandRequest::BatchType_Insert);\nrequest.setNS(\"tutorial.test\");\nrequest.setOrdered(false);\nBSONObj myObject = BSON(GENOID &lt;&lt; \"namespace\"&lt;&lt; \"theNameSpace\" &lt;&lt; \"query\" &lt;&lt; \"myQuery\" &lt;&lt; \"fields\" &lt;&lt; \"theQueryFields\" );\nrequest.getInsertRequest()-&gt;addToDocuments(myObject);\n</code></pre>\n\n<p>and expected that every time the function that I placed this code inside is running, this part of code will insert the myObject document to the tutorial.test collection, but it doesn't.\nAny idea what do I do wrong? and how to do it?</p>\n"}, {"tags": ["c++", "c++11", "type-conversion", "shared-ptr", "implicit-conversion"], "comments": [{"owner": {"reputation": 866, "user_id": 2219912, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/usjhB.jpg?s=128&g=1", "display_name": "Rupesh Yadav.", "link": "https://stackoverflow.com/users/2219912/rupesh-yadav"}, "edited": false, "score": 0, "creation_date": 1424278060, "post_id": 28588827, "comment_id": 45484871, "body": "@@vsoftco you should mention that it is working only for <code>f(0)</code>, apart from zero nothing is compiling, same error for other values even in first call."}, {"owner": {"reputation": 15025, "user_id": 862351, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c7ac8ffed3327e80c6b77651ba30b83e?s=128&d=identicon&r=PG", "display_name": "Pradhan", "link": "https://stackoverflow.com/users/862351/pradhan"}, "edited": false, "score": 0, "creation_date": 1424278183, "post_id": 28588827, "comment_id": 45484949, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/nullptr\" rel=\"nofollow noreferrer\">This</a> hints at an explanation - &quot;There exist implicit conversions from nullptr to null pointer value of any pointer type and any pointer to member type. Similar conversions exist for any value of type std::nullptr_t as well as for the macro NULL, the null pointer constant.&quot; But it would be interesting to see it explained with standard references and more clarity."}, {"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "reply_to_user": {"reputation": 866, "user_id": 2219912, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/usjhB.jpg?s=128&g=1", "display_name": "Rupesh Yadav.", "link": "https://stackoverflow.com/users/2219912/rupesh-yadav"}, "edited": false, "score": 1, "creation_date": 1424278196, "post_id": 28588827, "comment_id": 45484962, "body": "@RupeshYadav. done. Indeed, it is very weird, looks like some kind of implicit pointer conversion is being performed."}, {"owner": {"reputation": 866, "user_id": 2219912, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/usjhB.jpg?s=128&g=1", "display_name": "Rupesh Yadav.", "link": "https://stackoverflow.com/users/2219912/rupesh-yadav"}, "edited": false, "score": 0, "creation_date": 1424278293, "post_id": 28588827, "comment_id": 45485037, "body": "yes of course, and answers would be interesting."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1424280475, "post_id": 28588827, "comment_id": 45486534, "body": "Zero is very convertible in C++, things like f(false) and f(&#39;\\0&#39;) should work as well AFAIK."}], "answers": [{"owner": {"reputation": 38390, "user_id": 923854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OecRr.png?s=128&g=1", "display_name": "Casey", "link": "https://stackoverflow.com/users/923854/casey"}, "is_accepted": false, "score": 2, "last_activity_date": 1424278183, "creation_date": 1424278183, "answer_id": 28589107, "question_id": 28588827, "link": "https://stackoverflow.com/questions/28588827/implicit-conversion-from-int-to-shared-ptr/28589107#28589107", "title": "Implicit conversion from int to shared_ptr", "body": "<p>Per [conv.ptr]/1 (quoting N4296 here):</p>\n\n<blockquote>\n  <p>A <em>null pointer constant</em> is an integer literal (2.13.2) with value zero or a prvalue of type <code>std::nullptr_t</code>. ... A null pointer constant of integral type can be converted to a prvalue of type <code>std::nullptr_t</code>.</p>\n</blockquote>\n\n<p><code>shared_ptr</code> has a non-explicit constructor that accepts <code>std::nullptr_t</code> per [util.smartptr.shared.const]/1:</p>\n\n<pre><code>constexpr shared_ptr(nullptr_t) noexcept : shared_ptr() { }\n</code></pre>\n\n<p>which constructs an empty, non-owning <code>shared_ptr</code>.</p>\n\n<p>When you call <code>f(0)</code> directly, <code>0</code> is a <em>null pointer constant</em> that is implicitly converted to <code>shared_ptr&lt;int&gt;</code> by the above constructor. When you instead call <code>call_f(f, 0)</code>, the type of the literal 0 is deduced to <code>int</code> and of course an <code>int</code> cannot be converted to a <code>shared_ptr&lt;int&gt;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1424281396, "post_id": 28589112, "comment_id": 45487103, "body": "Might want to use a more updated draft (see @Casey&#39;s answer below). IIRC &quot;integral constant expression (5.19) prvalue of integer type that evaluates to zero&quot; includes such gems as <code>(3 * 5 + 8 - 7) &#47; 4 - 4</code>, and interacts weirdly with overload resolution for nondependent calls involving non-type template arguments, so they changed it to literal zero only in a DR."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1424357511, "post_id": 28589112, "comment_id": 45522572, "body": "@BenVoigt seems like it, although I agree I would prefer a literal zero. Perhaps supporting integral constant expressions for a time being as an extension would help."}], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 5, "last_activity_date": 1424318581, "last_edit_date": 1424318581, "creation_date": 1424278193, "answer_id": 28589112, "question_id": 28588827, "link": "https://stackoverflow.com/questions/28588827/implicit-conversion-from-int-to-shared-ptr/28589112#28589112", "title": "Implicit conversion from int to shared_ptr", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr/shared_ptr\" rel=\"nofollow\">std::shared_ptr</a> has a constructor that takes <em>std::nullptr_t</em>, literal <code>0</code> is a null pointer constant that is convertiable to <em>std::nullptr_t</em> from the draft C++ standard section <code>4.10</code> <em>[conv.ptr]</em> (<em>emphasis mine going forward</em>):</p>\n\n<blockquote>\n  <p><strong>A null pointer constant is an integral constant expression (5.19) prvalue of integer type that evaluates to zero or a prvalue of type\n  std::nullptr_t</strong>. A null pointer constant can be converted to a\n  pointer type; the result is the null pointer value of that type and is\n  distinguishable from every other value of object pointer or function\n  pointer type. Such a conversion is called a null pointer conversion.\n  Two null pointer values of the same type shall compare equal. The\n  conversion of a null pointer constant to a pointer to cv-qualified\n  type is a single conversion, and not the sequence of a pointer\n  conversion followed by a qualification conversion (4.4). <strong>A null\n  pointer constant of integral type can be converted to a prvalue of\n  type std::nullptr_t</strong>. [ Note: The resulting prvalue is not a null\n  pointer value. \u2014end note ]</p>\n</blockquote>\n\n<p>in your second case <code>p</code> is being deduced as type <em>int</em> which although has the value zero is no longer a null pointer constant and so does not fit the same case.</p>\n\n<p>As T.C. points out the wording was changed with <a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3714.html#903\" rel=\"nofollow\">DR 903</a> which requires an integer literal with value zero as opposed to an <em>integral constant expression</em> which evaluates to zero:</p>\n\n<blockquote>\n  <p>A null pointer constant is an <strong>integer literal (2.14.2) with value\n  zero</strong> or a prvalue of type std::nullptr_t. A null pointer constant\n  can be converted to a pointer type; the result is the null pointer\n  value of that type and is distinguishable from every other value of\n  object pointer or function pointer type.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "edited": false, "score": 0, "creation_date": 1424278986, "post_id": 28589241, "comment_id": 45485549, "body": "Yes, it makes sense after reading the answers above. The code <code>f(3-3)</code> is ok, since <code>3-3</code> or <code>3*0</code> is a prvalue evaluated to 0. &quot;A null pointer constant is an integral constant expression (5.19) prvalue of integer type that evaluates to zero or a prvalue of type std::nullptr_t.&quot; On the other hand, <code>int x = 0; f(x);</code> won&#39;t work anymore, since <code>x</code> is not a 0 prvalue anymore but a lvalue, hence not a null pointer constant anymore."}], "owner": {"reputation": 131, "user_id": 3319335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0df58b8f62b10b18afd62ff02e01a5f?s=128&d=identicon&r=PG&f=1", "display_name": "Milan", "link": "https://stackoverflow.com/users/3319335/milan"}, "is_accepted": false, "score": 1, "last_activity_date": 1424278525, "creation_date": 1424278525, "answer_id": 28589241, "question_id": 28588827, "link": "https://stackoverflow.com/questions/28588827/implicit-conversion-from-int-to-shared-ptr/28589241#28589241", "title": "Implicit conversion from int to shared_ptr", "body": "<p>The firs call f(0) is compiled as f(nullptr), which is fine for the compiler (but it should not be in my opinion). The second call will create declaration for a function to work on any int, which is illegal. </p>\n\n<p>Funny thing is, that even this code works:</p>\n\n<pre><code>f(3-3);\nf(3*0); \n</code></pre>\n"}], "owner": {"reputation": 52050, "user_id": 3093378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8214cf99b0fa33b4f7d571801914b53?s=128&d=identicon&r=PG", "display_name": "vsoftco", "link": "https://stackoverflow.com/users/3093378/vsoftco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1883, "favorite_count": 1, "accepted_answer_id": 28589112, "answer_count": 3, "score": 6, "last_activity_date": 1483757778, "creation_date": 1424277462, "last_edit_date": 1483757778, "question_id": 28588827, "link": "https://stackoverflow.com/questions/28588827/implicit-conversion-from-int-to-shared-ptr", "title": "Implicit conversion from int to shared_ptr", "body": "<p>Consider the code below:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nvoid f(std::shared_ptr&lt;int&gt; sp) {}\n\ntemplate &lt;typename FuncType, typename PtrType&gt;\nauto call_f(FuncType f, PtrType p) -&gt; decltype(f(p))\n{\n    return f(p);\n}\n\nint main()\n{\n    f(0); // doesn't work for any other int != 0, thanks @Rupesh\n    // call_f(f, 0); // error, cannot convert int to shared_ptr\n}\n</code></pre>\n\n<p>In the first line in <code>main()</code>, the integer <code>0</code> is converted to a <code>std::shared_ptr&lt;int&gt;</code> and the call <code>f(0)</code> succeeds without any problem. However, using a template to call the function make things different. Second line will not compile anymore, the error being </p>\n\n<pre><code>error: could not convert 'p' from 'int' to 'std::shared_ptr&lt;int&gt;'\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Why does the first call succeed and the second doesn't? Is there anything I'm missing here?</li>\n<li>I don't understand also how the conversion from <code>int</code> to <code>std::shared_ptr</code> is being performed in the call <code>f(0)</code>, as it looks like <code>std::shared_ptr</code> has only explicit constructors. </li>\n</ol>\n\n<p>PS: A variant of this example appears in Scott Meyers' <em>Effective Modern C++</em> Item 8, as a way of protecting such calls with <code>nullptr</code>.</p>\n"}, {"tags": ["c++", "c++14", "sfinae", "result-of"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3920237"}, "edited": false, "score": 0, "creation_date": 1424278292, "post_id": 28588743, "comment_id": 45485035, "body": "It compiles in GCC trunk and clang 3.5."}, {"owner": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 0, "creation_date": 1424278309, "post_id": 28588743, "comment_id": 45485047, "body": "Damn, I misread the question at first. This appears to be library-related. I cannot reproduce the error with either clang 3.5 or gcc 4.9 using libstdc++, but I can reproduce it with libc++ using both compilers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3920237"}, "reply_to_user": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 0, "creation_date": 1424278413, "post_id": 28588743, "comment_id": 45485110, "body": "@Wintermute In clang 3.6 with libc++, it doesn&#39;t compile. But it does give different errors. Also, how do you use GCC with libc++?"}], "answers": [{"comments": [{"owner": {"reputation": 1152, "user_id": 407260, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/02e6fb526f520850f781f172cd6cae43?s=128&d=identicon&r=PG", "display_name": "KentH", "link": "https://stackoverflow.com/users/407260/kenth"}, "edited": false, "score": 0, "creation_date": 1424280769, "post_id": 28589227, "comment_id": 45486725, "body": "@TC -- thanks. I never considered a libc++ bug, because my usual source of bugs &amp; misunderstands is me!  Do you have a suggested work-around? Also, I note that in my third case above, using plus&lt;int*&gt; instead of plus&lt;int&gt; results in the same problem as the &quot;diamond functor&quot; case."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 1152, "user_id": 407260, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/02e6fb526f520850f781f172cd6cae43?s=128&d=identicon&r=PG", "display_name": "KentH", "link": "https://stackoverflow.com/users/407260/kenth"}, "edited": false, "score": 0, "creation_date": 1424280965, "post_id": 28589227, "comment_id": 45486860, "body": "@KentH <code>plus&lt;non-void&gt;</code> etc. are not SFINAE-friendly. The <code>operator()</code> signature isn&#39;t SFINAE&#39;d away if the body won&#39;t compile, so you get a hard error instead when you actually try to call it. Not much can be done for non-SFINAE-friendly functors, unfortunately."}], "owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "is_accepted": true, "score": 9, "last_activity_date": 1425163915, "last_edit_date": 1425163915, "creation_date": 1424278482, "answer_id": 28589227, "question_id": 28588743, "link": "https://stackoverflow.com/questions/28588743/unexpected-sfinae-failure-using-stdresult-of/28589227#28589227", "title": "Unexpected SFINAE failure using std::result_of", "body": "<p>This is caused by a <a href=\"http://llvm.org/bugs/show_bug.cgi?id=22600\" rel=\"nofollow\">bug in libc++</a>, which I actually just reported a few days ago. (<strong>Update</strong>: The bug <a href=\"http://reviews.llvm.org/D7862\" rel=\"nofollow\">has been fixed</a> in trunk.)</p>\n\n<p>The problem is that their \"diamond functor\" implementation is non-conforming. For instance, they implemented <code>std::plus&lt;void&gt;::operator()</code> as follows:</p>\n\n<pre><code>template &lt;class _T1, class _T2&gt;\n_LIBCPP_CONSTEXPR_AFTER_CXX11 _LIBCPP_INLINE_VISIBILITY\nauto operator()(_T1&amp;&amp; __t, _T2&amp;&amp; __u) const\n    { return _VSTD::forward&lt;_T1&gt;(__t) + _VSTD::forward&lt;_T2&gt;(__u); }\n</code></pre>\n\n<p>when it should be</p>\n\n<pre><code>template &lt;class _T1, class _T2&gt;\n_LIBCPP_CONSTEXPR_AFTER_CXX11 _LIBCPP_INLINE_VISIBILITY\nauto operator()(_T1&amp;&amp; __t, _T2&amp;&amp; __u) const\n    -&gt; decltype(_VSTD::forward&lt;_T1&gt;(__t) + _VSTD::forward&lt;_T2&gt;(__u))\n    { return _VSTD::forward&lt;_T1&gt;(__t) + _VSTD::forward&lt;_T2&gt;(__u); }\n</code></pre>\n\n<p>The missing <em>trailing-return-type</em> means two things:</p>\n\n<ol>\n<li>They are no longer \"perfectly returning\"; instead, the return type is deduced using the rules for <code>auto</code>, essentially causing it to be decayed. The trailing return type, when the expression in it is well-formed, is equivalent to returning <code>decltype(auto)</code>.</li>\n<li>SFINAE no longer applies to the expression <code>_VSTD::forward&lt;_T1&gt;(__t) + _VSTD::forward&lt;_T2&gt;(__u)</code>. In a bug-free implementation, the <code>operator()</code> declaration would be removed from the overload set, overload resolution will fail, and <code>std::result_of</code> will then do its SFINAE-friendly magic. Instead, the function declaration is successfully instantiated, selected by overload resolution, and then a hard error occurs when the compiler attempts to instantiate the body to actually deduce the return type.</li>\n</ol>\n\n<p>Your problem is caused by #2.</p>\n"}], "owner": {"reputation": 1152, "user_id": 407260, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/02e6fb526f520850f781f172cd6cae43?s=128&d=identicon&r=PG", "display_name": "KentH", "link": "https://stackoverflow.com/users/407260/kenth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 28589227, "answer_count": 1, "score": 2, "last_activity_date": 1425163915, "creation_date": 1424277228, "last_edit_date": 1424278038, "question_id": 28588743, "link": "https://stackoverflow.com/questions/28588743/unexpected-sfinae-failure-using-stdresult-of", "title": "Unexpected SFINAE failure using std::result_of", "body": "<p>In c++14, std::result_of is supposed to result in SFINAE if the expression is ill-formed*. Instead I'm getting a compilation error (\"invalid operands to binary expression\") on my final case below (i.e. letting the compiler deduce type for std::plus&lt;>). The first three cases work as expected. Code and results shown below.</p>\n\n<pre><code>#include &lt;boost/mpl/placeholders.hpp&gt;\n#include &lt;boost/mpl/apply.hpp&gt;\n#include &lt;iostream&gt;\n#include &lt;utility&gt;\n#include &lt;stdexcept&gt;\n#include &lt;functional&gt;\n\nnamespace mpl = boost::mpl;\n\n\ntemplate &lt;typename OP, typename T, typename OP_T = typename mpl::apply&lt;OP, T&gt;::type&gt;\nstruct apply_if_ok: OP_T {\n\n    template &lt;typename...Args, typename R = std::result_of_t&lt;OP_T(Args...)&gt;&gt;\n    R operator()(Args&amp;&amp;...args) const {\n        return static_cast&lt;OP_T&gt;(*this)(std::forward&lt;Args&gt;(args)...);\n    }\n    template &lt;typename...Args&gt;\n    auto operator()(...) const {\n        // throw std::runtime_error(\"Invalid arguments\");\n        return \"Invalid arguments\";\n    }\n};\n\n\nint main() {\n    using OP = std::plus&lt;mpl::_&gt;;\n    int i = 3;\n\n    auto n1 = apply_if_ok&lt;OP, void&gt;()(1, 2);\n    std::cout &lt;&lt; \"plus (1, 2) = \" &lt;&lt; n1 &lt;&lt; std::endl;\n\n    auto n2 = apply_if_ok&lt;OP, void&gt;()(1, &amp;i);\n    std::cout &lt;&lt; \"plus (1, *) = \" &lt;&lt; n2 &lt;&lt; std::endl;\n\n    auto n3 = apply_if_ok&lt;OP, int&gt;()(&amp;i, &amp;i);\n    std::cout &lt;&lt; \"plus (*, *) = \" &lt;&lt; n3 &lt;&lt; std::endl;\n\n    // auto n4 = apply_if_ok&lt;OP, void&gt;()(&amp;i, &amp;i);\n    // std::cout &lt;&lt; \"plus (*, *) = \" &lt;&lt; n4 &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>% c++ -std=c++1y -g -pedantic    sfinae_result_of.cc   -o sfinae_result_of\n./sfinae_result_of\nplus (1, 2) = 3\nplus (1, *) = 0x7fff5e782a80\nplus (*, *) = Invalid arguments\n\n% c++ -v\nApple LLVM version 6.0 (clang-600.0.56) (based on LLVM 3.5svn)\nTarget: x86_64-apple-darwin14.1.0\nThread model: posix\n</code></pre>\n\n<p>Any pointers on what I'm doing wrong would be appreciated!</p>\n\n<p>Thanks.</p>\n\n<ul>\n<li>From <a href=\"http://en.cppreference.com/w/cpp/types/result_of\" rel=\"nofollow\" title=\"cppreference.com\">cppreference.com</a>. I think relevant standard reference is 20.10.7.6, comments on last table entry.</li>\n</ul>\n"}, {"tags": ["c++", "stl"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1424277297, "post_id": 28588706, "comment_id": 45484392, "body": "One <a href=\"http://www.sscce.org\" rel=\"nofollow noreferrer\">SSCCE</a> please."}, {"owner": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 1, "creation_date": 1424277387, "post_id": 28588706, "comment_id": 45484467, "body": "Performance is tricky. Trust experimental data over theory. Repeat your performance tests for different list lengths (especially huge ones). See if it makes a difference what kind of background processes you have running at the time."}, {"owner": {"reputation": 9854, "user_id": 1741450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7900ed57a92b336effd879fa61de226?s=128&d=identicon&r=PG", "display_name": "lucasg", "link": "https://stackoverflow.com/users/1741450/lucasg"}, "edited": false, "score": 0, "creation_date": 1424277396, "post_id": 28588706, "comment_id": 45484474, "body": "compilers optimize everything nowadays. Might as well flatten your recursive reverse function."}, {"owner": {"reputation": 4003, "user_id": 4331480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oWiMU.jpg?s=128&g=1", "display_name": "therainmaker", "link": "https://stackoverflow.com/users/4331480/therainmaker"}, "reply_to_user": {"reputation": 6849, "user_id": 1896761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e28ac3e5849a144937aa74efbc272e?s=128&d=identicon&r=PG", "display_name": "Austin Mullins", "link": "https://stackoverflow.com/users/1896761/austin-mullins"}, "edited": false, "score": 0, "creation_date": 1424277723, "post_id": 28588706, "comment_id": 45484666, "body": "@AustinMullins : I had written this code for oj.leetcode.com They ran this code on 44 test cases and the execution took 8 ms. Other recursive codes have shown an execution of around 4 ms."}, {"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 1, "creation_date": 1424277742, "post_id": 28588706, "comment_id": 45484681, "body": "You&#39;d have to measure. The call stack is probably faster than the free store (since each stack frame is created just by adjusting a couple of registers, and maybe writing a few values to it, with no need for thread safety or heap management), but typically has a finite size and explodes horribly when it overflows. But if it&#39;s a linked list, you should be able to reverse it by moving nodes from one list to another (popping from the front of one, then pushing to the front of the other) with no extra storage."}, {"owner": {"reputation": 532, "user_id": 1125868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea68b48580e664f10518f86293b74f9?s=128&d=identicon&r=PG", "display_name": "sanjayk79", "link": "https://stackoverflow.com/users/1125868/sanjayk79"}, "edited": false, "score": 1, "creation_date": 1424277827, "post_id": 28588706, "comment_id": 45484741, "body": "Have a look at the following answer <a href=\"http://stackoverflow.com/questions/161053/c-which-is-faster-stack-allocation-or-heap-allocation\" title=\"c which is faster stack allocation or heap allocation\">stackoverflow.com/questions/161053/&hellip;</a>"}, {"owner": {"reputation": 4003, "user_id": 4331480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oWiMU.jpg?s=128&g=1", "display_name": "therainmaker", "link": "https://stackoverflow.com/users/4331480/therainmaker"}, "reply_to_user": {"reputation": 532, "user_id": 1125868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ea68b48580e664f10518f86293b74f9?s=128&d=identicon&r=PG", "display_name": "sanjayk79", "link": "https://stackoverflow.com/users/1125868/sanjayk79"}, "edited": false, "score": 0, "creation_date": 1424278338, "post_id": 28588706, "comment_id": 45485067, "body": "@sanjayk79 , So that answer supports my observation since the STL would be using heap memory. Hence recursion should be faster. Any other views?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424279649, "post_id": 28588706, "comment_id": 45485976, "body": "You have to consider branching (function calls) as well as data access.  On many processors, a jump or branch instruction will cause the processor to flush the instruction cache and reload.  This may be more of a performance hit than whether the data is in one part of memory (stack) versus another (heap)."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424279790, "post_id": 28588706, "comment_id": 45486094, "body": "As far as data access performance goes, generally, there is no performance difference between accessing a variable on the stack, heap, or global memory.  The processor still has to fetch the data from external memory into the data cache, then into registers.  If the stack or heap lies in memory that is in on the same piece of silicon as the processor, this will speed up access; otherwise, it doesn&#39;t make a difference."}], "owner": {"reputation": 4003, "user_id": 4331480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oWiMU.jpg?s=128&g=1", "display_name": "therainmaker", "link": "https://stackoverflow.com/users/4331480/therainmaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424277488, "creation_date": 1424277130, "last_edit_date": 1424277488, "question_id": 28588706, "link": "https://stackoverflow.com/questions/28588706/performance-of-stl-stack-v-s-function-stack", "title": "Performance of STL Stack v/s Function Stack", "body": "<p>I was working on a code related to reversing parts of linked lists. For the reversal part, the algorithm I was using was to push the nodes of the list onto a stack, and then keep popping the stack and correct the next pointer of each node. The question that I had was that would using the STL stack provide a better performance over the function call stack, or vice-versa.</p>\n\n<p>I had expected the STL stack to perform better because there are other overheads with calling a function stack, but from the submission details it seems otherwise. Did I miss something, or does the function stack somehow perform better?</p>\n\n<p>Thanks for any help provided.</p>\n\n<p>Attaching the code also, in case someone wants a look. The parameters to the reverse between function are the head of the list, and the two indexes (1 based, inclusive), between which the nodes should be reversed. I don't think you need to go through the code though:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;cmath&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;stack&gt;\n\nusing namespace std;\n\n struct ListNode {\n      int val;\n      ListNode *next;\n      ListNode(int x) : val(x), next(NULL) {}\n  };\n\nclass Solution {\npublic:\nListNode *reverseBetween(ListNode *head, int m, int n)\n{\n    int counter = 1;\n    stack&lt;ListNode*&gt; holder;\n    ListNode* current = head;\n    ListNode* pre_flip = NULL;\n    ListNode* to_return = head;\n    while (counter &lt; m)\n    {\n      pre_flip = current;\n      current = current-&gt;next;\n      counter++;\n    }\n    while (counter &lt;= n)\n    {\n      holder.push(current);\n      if (counter != n)\n        current = current-&gt;next;\n      counter++;\n    }\n    if (m == 1)\n      to_return = current;\n    ListNode* post_flip;\n    post_flip = current-&gt;next;\n    if (pre_flip == NULL)\n      pre_flip = to_return;\n    while (holder.empty() == 0)\n    {\n      ListNode* temp = holder.top();\n      pre_flip-&gt;next = temp;\n      pre_flip = pre_flip-&gt;next;\n      holder.pop();\n    }\n    pre_flip-&gt;next = post_flip;\n    return to_return;\n}\n};\n</code></pre>\n"}, {"tags": ["c++", "exception", "visual-studio-2008", "scope", "throw"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424279129, "post_id": 28588671, "comment_id": 45485629, "body": "Just have a look-see at the assembly listing that the compiler can generate with /FAs.  You can&#39;t miss the exception filters that ensure that they are destroyed."}], "answers": [{"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 1, "last_activity_date": 1424277197, "creation_date": 1424277197, "answer_id": 28588732, "question_id": 28588671, "link": "https://stackoverflow.com/questions/28588671/c-if-an-exception-is-thrown-are-objects-that-go-out-of-scope-destroyed/28588732#28588732", "title": "C++: If an exception is thrown, are objects that go out of scope destroyed?", "body": "<p>Yes. When you leave a scope (whether normally or via exception) objects local to that scope are destroyed. This is the basic fact that makes RAII/SBRM work.</p>\n"}, {"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": false, "score": 3, "last_activity_date": 1424277209, "creation_date": 1424277209, "answer_id": 28588739, "question_id": 28588671, "link": "https://stackoverflow.com/questions/28588671/c-if-an-exception-is-thrown-are-objects-that-go-out-of-scope-destroyed/28588739#28588739", "title": "C++: If an exception is thrown, are objects that go out of scope destroyed?", "body": "<p>Yes any scope bound variables will be destroyed.</p>\n\n<pre><code>void work()\n{\n     Foo a;\n     Foo* b = new Foo;\n     // ... later\n\n     // exception thrown\n\n     delete b;\n}\n</code></pre>\n\n<p>In this example <code>a</code>'s destructor would be called when the exception was thrown as the stack unwound, but the memory pointed to by <code>b</code> would be leaked since it would never reach the <code>delete</code> call. This is one of the many reasons why RAII is so helpful.</p>\n"}, {"comments": [{"owner": {"reputation": 1142, "user_id": 359353, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7ea5964814a6d0e134998c924e7b547e?s=128&d=identicon&r=PG", "display_name": "Dula", "link": "https://stackoverflow.com/users/359353/dula"}, "edited": false, "score": 1, "creation_date": 1468019970, "post_id": 28588809, "comment_id": 63972576, "body": "Let&#39;s say <code>class A</code> has a mutex member variable. Thread T1 comes into <code>A::doSomething()</code> which locks the mutex using a stack created lock object. After locking the mutex an exception is thrown which is NOT caught. Does the mutex ever get unlocked?"}], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": true, "score": 12, "last_activity_date": 1424285140, "last_edit_date": 1424285140, "creation_date": 1424277411, "answer_id": 28588809, "question_id": 28588671, "link": "https://stackoverflow.com/questions/28588671/c-if-an-exception-is-thrown-are-objects-that-go-out-of-scope-destroyed/28588809#28588809", "title": "C++: If an exception is thrown, are objects that go out of scope destroyed?", "body": "<p>Yes.</p>\n\n<p>C++ Standard n3337</p>\n\n<h2>15 Exception handling</h2>\n\n<p><strong>\u00a7</strong> 15.2 Constructors and destructors</p>\n\n<blockquote>\n  <p>1) As control passes from a throw-expression to a handler, destructors\n  are invoked for <strong>all automatic objects constructed since the try block\n  was entered</strong>. The automatic objects are destroyed in the reverse order\n  of the completion of their construction.</p>\n  \n  <p>2) An object of any storage duration whose initialization or\n  destruction is terminated by an exception will have destructors\n  executed for <strong>all</strong> of its <strong>fully constructed subobjects</strong> (excluding the\n  variant members of a union-like class), that is, for subobjects for\n  which the principal constructor (12.6.2) has completed execution and\n  the destructor has not yet begun execution. Similarly, if the\n  non-delegating constructor for an object has completed execution and a\n  delegating constructor for that object exits with an exception, the\n  object\u2019s destructor will be invoked. If the object was allocated in a\n  new-expression, the matching deallocation function (3.7.4.2, 5.3.4,\n  12.5), if any, is called to free the storage occupied by the object.</p>\n  \n  <p>3) The process of calling destructors for automatic objects\n  constructed on the path from a try block to a throw-expression is\n  called \u201cstack unwinding.\u201d If a destructor called during stack\n  unwinding exits with an exception, std::terminate is called (15.5.1).\n  [ Note: So destructors should generally catch exceptions and not let\n  them propagate out of the destructor. \u2014 end note ]</p>\n</blockquote>\n\n<p>example:</p>\n\n<pre><code>SomeClass c;              // declared before try{} so it is\n                          // still valid in catch{} block\ntry {\n    SomeClass t;\n    throw;\n} catch( ...) {\n    // t destroyed\n    // c valid\n}\n</code></pre>\n"}], "owner": {"reputation": 1018, "user_id": 3339089, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/14221701/picture?type=large", "display_name": "mczarnek", "link": "https://stackoverflow.com/users/3339089/mczarnek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3687, "favorite_count": 0, "accepted_answer_id": 28588809, "answer_count": 3, "score": 7, "last_activity_date": 1424285140, "creation_date": 1424277042, "question_id": 28588671, "link": "https://stackoverflow.com/questions/28588671/c-if-an-exception-is-thrown-are-objects-that-go-out-of-scope-destroyed", "title": "C++: If an exception is thrown, are objects that go out of scope destroyed?", "body": "<p>Normally it would be destructed upon the scope ending.. I could see issues occurring if exceptions were thrown though.</p>\n"}, {"tags": ["c++", "qt", "qmake"], "comments": [{"owner": {"reputation": 3533, "user_id": 10278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904fd802987f5f63162639b0ac9de136?s=128&d=identicon&r=PG", "display_name": "pestophagous", "link": "https://stackoverflow.com/users/10278/pestophagous"}, "edited": false, "score": 0, "creation_date": 1578075286, "post_id": 28588645, "comment_id": 105332959, "body": "qmake continues to regularly stump me, too. But it seems that maybe <code>.qmake.conf</code> is the tool that you are seeking? <a href=\"https://doc.qt.io/qt-5/qmake-environment-reference.html\" rel=\"nofollow noreferrer\">doc.qt.io/qt-5/qmake-environment-reference.html</a>"}, {"owner": {"reputation": 2071, "user_id": 1143162, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8c91769f55c3c29033007ecd8e8b553e?s=128&d=identicon&r=PG", "display_name": "Zeks", "link": "https://stackoverflow.com/users/1143162/zeks"}, "reply_to_user": {"reputation": 3533, "user_id": 10278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904fd802987f5f63162639b0ac9de136?s=128&d=identicon&r=PG", "display_name": "pestophagous", "link": "https://stackoverflow.com/users/10278/pestophagous"}, "edited": false, "score": 0, "creation_date": 1604911867, "post_id": 28588645, "comment_id": 114481080, "body": "I have since moved to using qbs. much better experience"}], "answers": [{"owner": {"reputation": 2071, "user_id": 1143162, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8c91769f55c3c29033007ecd8e8b553e?s=128&d=identicon&r=PG", "display_name": "Zeks", "link": "https://stackoverflow.com/users/1143162/zeks"}, "is_accepted": false, "score": 1, "last_activity_date": 1424277438, "last_edit_date": 1424277438, "creation_date": 1424276973, "answer_id": 28588651, "question_id": 28588645, "link": "https://stackoverflow.com/questions/28588645/how-to-make-subdirs-level-defines-visible-in-subprojects-in-qt/28588651#28588651", "title": "How to make SUBDIRS level defines visible in subprojects in qt?", "body": "<p>The basis for my solution is this post:\n<a href=\"http://qt-project.org/wiki/QMake-top-level-srcdir-and-builddir\" rel=\"nofollow\">http://qt-project.org/wiki/QMake-top-level-srcdir-and-builddir</a></p>\n\n<p>We first need to add a custom .pro file to the superproject parse order.\nIn super1.pro we add:</p>\n\n<pre><code>SUBDIRS += super1_DEFINES.pro sub1 sub2 sub3....\n</code></pre>\n\n<p>In super1_DEFINES.pro we write the following</p>\n\n<pre><code>TEMPLATE=subdirs\nSUBDIRS= # don't build anything, we're just generating the .qmake.cache file\nsystem(rm .qmake_cache.in)\nsystem(cp .qmake.cache.super1 .qmake.cache.in)\nQMAKE_SUBSTITUTES += .qmake.cache.in\n</code></pre>\n\n<p>what happens there, is that we utilise a system call to rewrite .qmake.cache.in placeholder file with the one specified by the the superproject *_DEFINES file. This rewritten file is then picked by the system and placed into builddir as .qmake.cache and, most importantly, DEFINES from that file <strong>will</strong> be picked by all the subprojects. .qmake.cache.super1 is actually just a simple .pro file which might look like this:</p>\n\n<pre><code>DEFINES += SOMEVARIABLE\n</code></pre>\n\n<p>when you want to build say, super42.pro you just use</p>\n\n<pre><code>SUBDIRS += super42_DEFINES.pro sub1 sub2 sub3....\n</code></pre>\n\n<p>and </p>\n\n<pre><code>system(cp .qmake.cache.super42 .qmake.cache.in)\n</code></pre>\n\n<p>and that's it. Like I said, the solution does seem too complex. I hope there is a better way, but this works for me so far.</p>\n"}], "owner": {"reputation": 2071, "user_id": 1143162, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8c91769f55c3c29033007ecd8e8b553e?s=128&d=identicon&r=PG", "display_name": "Zeks", "link": "https://stackoverflow.com/users/1143162/zeks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1424338840, "creation_date": 1424276950, "last_edit_date": 1424338840, "question_id": 28588645, "link": "https://stackoverflow.com/questions/28588645/how-to-make-subdirs-level-defines-visible-in-subprojects-in-qt", "title": "How to make SUBDIRS level defines visible in subprojects in qt?", "body": "<p>The problem is as follows: </p>\n\n<p>I have a folder that contains a bunch of library projects and 2 projects generating actual executables. Both <strong>exe</strong> projects utilize the libraries from that folder to do its stuff but otherwise are separate programs. So, I have two SUBDIRS projects in that folder.</p>\n\n<pre><code>super1.pro\nsuper2.pro \n</code></pre>\n\n<p>Also, there is not a lot of that, but <strong>some</strong> code paths in libraries depend on the superproject that is actually being built. The dependency is resolved by adding this into the .cpp file</p>\n\n<pre><code>#ifdef SUPER1\n</code></pre>\n\n<p>So, what's the problem? The problem is that</p>\n\n<pre><code>DEFINES+=SUPER1\n</code></pre>\n\n<p>added in super1.pro will not be visible in subprojects and adding it into subprojects either directly or by means of .pri file fails to address the \ntime when one will need to build the <strong>other</strong> project. It will have to be manual code change to <strong>super2</strong> then and this is just no good.</p>\n\n<p>I have my solution to that problem below, but it just feels way too complex. If anyone has a better one that I am missing, please comment/answer.</p>\n"}, {"tags": ["c++", "templates", "c++11", "variadic-templates", "boost-mpl"], "answers": [{"owner": {"reputation": 526, "user_id": 4146202, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/fA4dF.png?s=128&g=1", "display_name": "se0808", "link": "https://stackoverflow.com/users/4146202/se0808"}, "is_accepted": false, "score": 0, "last_activity_date": 1424936521, "creation_date": 1424936521, "answer_id": 28736908, "question_id": 28588637, "link": "https://stackoverflow.com/questions/28588637/retrieve-iterator-position-from-mpl-fold-expression/28736908#28736908", "title": "Retrieve iterator position from mpl fold expression", "body": "<pre><code>using types = mpl::vector&lt;int, double, float, float, float&gt;\nusing unique_types&lt;types, mpl::set0&lt;&gt;, mpl::insert&lt;_1, _2&gt;&gt;::type;\nusing iter = mpl::find&lt;unique_edge_types, int&gt;::type;\n// std::cout &lt;&lt; iter::pos::value &lt;&lt; std::endl;\n// error: 'boost::mpl::iter&lt;boost::mpl::s_item&lt;...a lot of text... &gt; &gt;::pos'\n//        has not been declared (mpl::s_item is a piece of mpl::set implementation)\n</code></pre>\n\n<p>While <strong>edge_types</strong> is an <em>mpl::vector</em>, <strong>unique_edge_types</strong> is (up to implementation details) an <em>mpl::set</em>, and <em>mpl::find</em> does not work with <em>mpl::set</em>. A similar error occurs for</p>\n\n<pre><code>using unique_types = mpl::set&lt;int, double, float&gt;;\nusing iter = mpl::find&lt;unique_types, int&gt;::type;\n// std::cout &lt;&lt; iter::pos::value &lt;&lt; std::endl;\n// error: 'boost::mpl::iter&lt;boost::mpl::set&lt;...a lot of text... &gt; &gt;::pos'\n//        has not been declared\n</code></pre>\n\n<p>You can use the standard function <em>mpl::unique</em> returning an <em>mpl::vector</em>:</p>\n\n<pre><code>#include &lt;boost/mpl/unique.hpp&gt;\n#include &lt;boost/type_traits/is_same.hpp&gt;\n\nusing unique_types = mpl::unique&lt;types, boost::is_same&lt;_1,_2&gt;&gt;::type;\n</code></pre>\n"}], "owner": {"reputation": 7427, "user_id": 293195, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/seTSX.png?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/293195/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424936521, "creation_date": 1424276926, "question_id": 28588637, "link": "https://stackoverflow.com/questions/28588637/retrieve-iterator-position-from-mpl-fold-expression", "title": "Retrieve iterator position from mpl fold expression", "body": "<p>How can I obtain the index of the following folded type with <code>boost::mpl</code> (which is some kind of mpl::set but not quite). The <code>value iter::pos::value</code> is somehow not defined??</p>\n\n<pre><code>using unique_types =\n            typename mpl::fold&lt;\n            mpl::vector&lt;int,double,float,float,float&gt;\n            , mpl::set0&lt;&gt;\n            , mpl::insert&lt;mpl::placeholders::_1, mpl::placeholders::_2&gt; /** _1 = State = set&lt;...&gt;, _2 element of NodeTypes*/\n            &gt;::type;\n\n        using iter =  typename boost::mpl::find&lt; unique_types , int&gt;::type;\n\nstd::cout &lt;&lt; iter::pos::value &lt;&lt; std::endl;  // &lt;&lt;&lt;&lt; Not defined!\n</code></pre>\n\n<p>Compile online : <a href=\"http://coliru.stacked-crooked.com/a/ab67af9e3b8cf0d1\" rel=\"nofollow\">Coliru</a></p>\n"}, {"tags": ["c++"], "answers": [{"comments": [{"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 0, "creation_date": 1424294537, "post_id": 28589332, "comment_id": 45494890, "body": "Good point, though considering <a href=\"http://stackoverflow.com/q/9527820/603688\">this</a> I&#39;m not sure if there&#39;s a way to avoid that besides a comment saying not to. I think this ends up also being UB because you&#39;re referring to a temporary that has been destroyed."}], "owner": {"reputation": 876, "user_id": 4537511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb4bbc2836b3dcb6564ce5f4b3f4f2c?s=128&d=identicon&r=PG", "display_name": "Adam Sosnowski", "link": "https://stackoverflow.com/users/4537511/adam-sosnowski"}, "is_accepted": false, "score": 3, "last_activity_date": 1424278774, "creation_date": 1424278774, "answer_id": 28589332, "question_id": 28588537, "link": "https://stackoverflow.com/questions/28588537/transparently-insert-temporary-into-callers-scope/28589332#28589332", "title": "Transparently insert temporary into caller&#39;s scope", "body": "<p>There is no guarantee that all changes will be caught:</p>\n\n<pre><code>Foo &amp;x = f-&gt;bar;\nx = 6; /* undetected change */\n</code></pre>\n"}, {"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1424290316, "creation_date": 1424290316, "answer_id": 28592994, "question_id": 28588537, "link": "https://stackoverflow.com/questions/28588537/transparently-insert-temporary-into-callers-scope/28592994#28592994", "title": "Transparently insert temporary into caller&#39;s scope", "body": "<p>If there is no way to grab a reference to any data within <code>T</code> through <code>T</code>'s interface or otherwise, I think this should be safe. If there's any way to grab such a pointer or reference, you're done and in undefined behavior as soon as someone saves off such reference and uses it later.</p>\n"}], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1424369081, "creation_date": 1424276686, "last_edit_date": 1424369081, "question_id": 28588537, "link": "https://stackoverflow.com/questions/28588537/transparently-insert-temporary-into-callers-scope", "title": "Transparently insert temporary into caller&#39;s scope", "body": "<p>In C++, <code>operator-&gt;</code> has special semantics, in that if the returned type isn't a pointer, it will call <code>operator-&gt;</code> again on that type. But, the intermediate value is kept as a temporary by the calling expression. This allows code to detect changes in the returned value:</p>\n\n<pre><code>template&lt;class T&gt;\nclass wrapper\n{\n    // ...\n    T val;\n\n    struct arrow_helper\n    {\n        arrow_helper(const T&amp; temp)\n            : temp(temp){}\n        T temp;\n        T* operator-&gt;() { return &amp;temp; }\n        ~arrow_helper() { std::cout &lt;&lt; \"modified to \" &lt;&lt; temp &lt;&lt; '\\n'; }\n    };\n\n    arrow_helper operator-&gt;() { return{ val }; }\n    //return const value to prevent mistakes\n    const T operator*() const { return val; }\n}\n</code></pre>\n\n<p>and then <code>T</code>'s members can be accessed transparently:</p>\n\n<pre><code>wrapper&lt;Foo&gt; f(/*...*/);\nf-&gt;bar = 6;\n</code></pre>\n\n<p>Is there anything that could go wrong from doing this? Also, is there a way to get this effect with functions other than <code>operator-&gt;</code>?</p>\n\n<p>EDIT: Another issue I've come across is in expressions like</p>\n\n<pre><code>f-&gt;bar = f-&gt;bar + 6;\n</code></pre>\n\n<p>since when the <code>arrow_helper</code> from the second <code>operator-&gt;</code> is destructed it re-overwrites the value back to the original. My semi-elegant solution is for <code>arrow_helper</code> to have a <code>T orig</code> that is hidden, and <code>assert(orig == *owner)</code> in the destructor.</p>\n"}, {"tags": ["c++", "loops", "for-loop", "geometry", "sine-wave"], "comments": [{"owner": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 0, "creation_date": 1424276655, "post_id": 28588292, "comment_id": 45483943, "body": "could look like <code>abs(((i + 2) % 5) - 2)</code> except it gives 0 1 2 2 1 0 1 2 ..."}], "answers": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1424276601, "creation_date": 1424276601, "answer_id": 28588502, "question_id": 28588292, "link": "https://stackoverflow.com/questions/28588292/is-there-a-triangle-wave-function/28588502#28588502", "title": "Is There a Triangle Wave Function?", "body": "<p>You'd have to make your own:</p>\n\n<pre><code>// Assumes 0 &lt;= i &lt; n\nint foo(int i, int n) {\n    int ix = i % n;\n    if ( ix &lt; n/2 )\n        return ix;\n    else\n        return n-1-ix;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1424278635, "post_id": 28588656, "comment_id": 45485276, "body": "Your function&#39;s a little wak there bro. It not only fails to take the input I specified in the question, it also fails to compile cause <code>x</code> isn&#39;t defined. In any event <a href=\"http://stackoverflow.com/users/2296458/cyber\">Cyber</a> did do a good job finding that duplicate."}, {"owner": {"reputation": 435, "user_id": 1590930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1946bd3f1654342077ef798550ab0b14?s=128&d=identicon&r=PG", "display_name": "Hans Goldman", "link": "https://stackoverflow.com/users/1590930/hans-goldman"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1424278893, "post_id": 28588656, "comment_id": 45485482, "body": "Right, I just noticed that right before I read your comment. I edited it and should be fixed now."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1424279234, "post_id": 28588656, "comment_id": 45485691, "body": "Getting closer, It still doesn&#39;t match the signature specified in the question but it compiles now. (I know we can all imply what you should be doing in <code>foo</code>, but we also could have all followed <a href=\"http://stackoverflow.com/users/2296458/cyber\">Cyber</a>&#39;s link and implied an <code>foo</code> from there. If you&#39;re going to use someone else&#39;s solution to answer this question, it seems like you should at least tailor their answer to the actual question.)"}, {"owner": {"reputation": 435, "user_id": 1590930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1946bd3f1654342077ef798550ab0b14?s=128&d=identicon&r=PG", "display_name": "Hans Goldman", "link": "https://stackoverflow.com/users/1590930/hans-goldman"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1424279549, "post_id": 28588656, "comment_id": 45485905, "body": "Sorry, I was already writing the answer when Cyber posted the link. I wasn&#39;t just taking it from him. You probably should have done a 2 second Google search before even asking the question. Because that&#39;s how long it took me to find that link on my own. Just my 2 cents..."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1424284378, "post_id": 28588656, "comment_id": 45488854, "body": "I believe you are correct that I should have taken more time to research, my mistake. Anyway back to working on this answer; it&#39;s close to right, have a look at <a href=\"http://stackoverflow.com/a/1073628/2642059\">Eric Bainville&#39;s answer</a> that&#39;s the one you want to copy."}], "owner": {"reputation": 435, "user_id": 1590930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1946bd3f1654342077ef798550ab0b14?s=128&d=identicon&r=PG", "display_name": "Hans Goldman", "link": "https://stackoverflow.com/users/1590930/hans-goldman"}, "is_accepted": false, "score": 2, "last_activity_date": 1424278821, "last_edit_date": 1495540979, "creation_date": 1424276987, "answer_id": 28588656, "question_id": 28588292, "link": "https://stackoverflow.com/questions/28588292/is-there-a-triangle-wave-function/28588656#28588656", "title": "Is There a Triangle Wave Function?", "body": "<p>Looks like a very similar question was answered here: <a href=\"https://stackoverflow.com/questions/1073606/is-there-a-one-line-function-that-generates-a-triangle-wave\">Is there a one-line function that generates a triangle wave?</a></p>\n\n<p>Taken from Noldorin answer:</p>\n\n<p><strong>Triangular Wave</strong></p>\n\n<pre><code>y = abs((x++ % 6) - 3);\n</code></pre>\n\n<p>This gives a triangular wave of period 6, oscillating between 3 and 0.</p>\n\n<p>Now put that in a function:</p>\n\n<pre><code>int foo(int inputPosition, int period, int amplitude)\n{\n    return abs((inputPosition % period) - amplitude);\n}\n</code></pre>\n"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": true, "score": 0, "last_activity_date": 1520342332, "last_edit_date": 1520342332, "creation_date": 1424346569, "answer_id": 28605617, "question_id": 28588292, "link": "https://stackoverflow.com/questions/28588292/is-there-a-triangle-wave-function/28605617#28605617", "title": "Is There a Triangle Wave Function?", "body": "<p>I thought we should at least post the correct answer here before this question is closed cause it is a duplicate.</p>\n\n<p><a href=\"https://stackoverflow.com/a/1073628/2642059\">Eric Bainvile's answer</a> is the correct one.</p>\n\n<pre><code>int foo(const int position, const int period){return period - abs(position % (2 * period) - period);}\n</code></pre>\n\n<p>However this gives a triangle wave with a range from [0, <code>period</code>] and a frequency of <code>2 * period</code> and I want a range from [0, <code>period / 2</code>] and a cycle of <code>period</code>. This can be accomplished by just passing half of the period to <code>foo</code> or by adjusting the function:</p>\n\n<pre><code>int foo(const int position, const int period){return period / 2 - abs(position % period - period / 2);}\n</code></pre>\n\n<p>With such a simple function inlining seems preferable though so our final result will be:</p>\n\n<pre><code>for(auto position = 0; position &lt; 5 * 2; ++position) cout &lt;&lt; 5 / 2 - abs(position % 5 - 5 / 2) &lt;&lt; endl;\n</code></pre>\n\n<p>Yielding the requested:</p>\n\n<blockquote>\n  <p>0<br>\n  1<br>\n  2<br>\n  1<br>\n  0<br>\n  0<br>\n  1<br>\n  2<br>\n  1<br>\n  0</p>\n</blockquote>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4618, "favorite_count": 0, "closed_date": 1424347528, "accepted_answer_id": 28605617, "answer_count": 3, "score": 0, "last_activity_date": 1520342332, "creation_date": 1424276017, "last_edit_date": 1424324461, "question_id": 28588292, "link": "https://stackoverflow.com/questions/28588292/is-there-a-triangle-wave-function", "closed_reason": "Duplicate", "title": "Is There a Triangle Wave Function?", "body": "<p>in a <code>for</code>-loop with <code>%</code> to get a saw function, for example using a period of 5 printing 2 cycles would look like this:</p>\n\n<pre><code>for(auto i = 0; i &lt; 5 * 2; ++i) cout &lt;&lt; i % 5 &lt;&lt; endl;\n</code></pre>\n\n<p>Results in:</p>\n\n<blockquote>\n  <p>0<br>\n  1<br>\n  2<br>\n  3<br>\n  4<br>\n  0<br>\n  1<br>\n  2<br>\n  3<br>\n  4</p>\n</blockquote>\n\n<p>I want a function returns a triangle wave, so for some function <code>foo</code>:</p>\n\n<pre><code>for(auto i = 0; i &lt; 5 * 2; ++i) cout &lt;&lt; foo(i, 5) &lt;&lt; endl;\n</code></pre>\n\n<p>Would result in:</p>\n\n<blockquote>\n  <p>0<br>\n  1<br>\n  2<br>\n  1<br>\n  0<br>\n  0<br>\n  1<br>\n  2<br>\n  1<br>\n  0</p>\n</blockquote>\n\n<p>Is there such a function, or do I need to come up with my own?</p>\n"}, {"tags": ["c++", "multithreading", "c++11", "for-loop"], "comments": [{"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1424275997, "post_id": 28588267, "comment_id": 45483458, "body": "What platform, compiler, etc?"}, {"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "reply_to_user": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 0, "creation_date": 1424276197, "post_id": 28588267, "comment_id": 45483601, "body": "Edited the question. I forgot to include that information."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1424276367, "post_id": 28588267, "comment_id": 45483741, "body": "Did you also try to use some native thread implementation without using those std::thread facilities?"}, {"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424276732, "post_id": 28588267, "comment_id": 45484000, "body": "Isn&#39;t std::thread an abstraction over native threads and using whatever native thread implementation is available on a platform?"}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1424276835, "post_id": 28588267, "comment_id": 45484062, "body": "It would be great if you posted a MCVE that others could just run on their machine."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1424276914, "post_id": 28588267, "comment_id": 45484113, "body": "<code>I changed to release and the difference was ~1ms in favor of index based for</code> How many times did you repeat the measurement? Is that 1ms significant compared to the variance? What steps did you take to ensure that a warmer cache wouldn&#39;t favor one test more than another?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1424277038, "post_id": 28588267, "comment_id": 45484192, "body": "Of course it is an abstraction of the native threads. But anyone who used native threads before knows how many degrees of freedom and how many decisions are to be made. So the abstraction is 1 path through that decision tree."}, {"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424277380, "post_id": 28588267, "comment_id": 45484462, "body": "I added the pastebin link with the main function is someone  wants to test this. Okay, so to answer that question: I didn&#39;t try without std::thread abstraction, I might try later. I repeated the measurement a few times, like I said it&#39;s not a big deal it just made me curious."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424280156, "post_id": 28588267, "comment_id": 45486301, "body": "In order for threads to help with performance, the code executing inside the thread must take longer to execute than the overhead of creating, switching and destroying the thread.  Whether a threads run on single, or multiple cores or different processors is up to the Operating System."}, {"owner": {"reputation": 23269, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "edited": false, "score": 0, "creation_date": 1424288811, "post_id": 28588267, "comment_id": 45491571, "body": "i guess no cache ping pong since you dont write to array after you start threads. One explanation could be that you simply hit the cache/ram bandwith limit before you hit add limit(cpu logic is starved) . Aditional test to see if it is related to thread creation to see how numbers behave when you double and half the size of test vector."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424277160, "post_id": 28588551, "comment_id": 45484295, "body": "Yes, I know that. I checked and the CPU was at 4.5GHz while this was running."}], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 2, "last_activity_date": 1424276733, "creation_date": 1424276733, "answer_id": 28588551, "question_id": 28588267, "link": "https://stackoverflow.com/questions/28588267/for-loop-performance-and-multithreaded-performance-questions/28588551#28588551", "title": "For loop performance and multithreaded performance questions", "body": "<p>With optimisation not turned on, all the method calls that are performed behind the scenes are likely real method calls. Inline functions are likely not inlined but really called. For template code, you really need to turn on optimisation to avoid that all the code is taken literally. For example, it's likely that your iterator code will call iter.end () 800,000 times, and operator!= for the comparison 800,000 times, which calls operator== and so on and so on. </p>\n\n<p>For the multithreaded code, processors are complicated. Operating systems are complicated. Your code isn't alone on the computer. Your computer can change its clock speed, change into turbo mode, change into heat protection mode. And rounding the times to milliseconds isn't really helpful. Could be one thread to 6.49 milliseconds and another too 6.51 and it got rounded differently. </p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424278457, "post_id": 28588614, "comment_id": 45485147, "body": "So, is there a way to force std::thread are spawned on individual cores? Or maybe native Windows threads?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424280817, "post_id": 28588614, "comment_id": 45486753, "body": "Windows: SetThreadAffinityMask(). The point of this answer is, that there are many more degrees of freedom as to what std::thread might do than is good for using it in benchmarkings. Another example: Does it call CoInitializeEx(..)?"}, {"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424285576, "post_id": 28588614, "comment_id": 45489549, "body": "For 8,000,000:     Single threaded sum: 13ms. Result = -1805322496     Multi threaded sum: 2ms. Result = -1805322496 For 80,000,000:     Single threaded sum: 133ms. Result = 216376832     Multi threaded sum: 22ms. Result = 216376832 And I couldn&#39;t run it for 800,000,000. It was all with the unoptimized debug build. This basically destroys the std::thread performance in my original post."}], "owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "is_accepted": false, "score": 1, "last_activity_date": 1424289934, "last_edit_date": 1424289934, "creation_date": 1424276879, "answer_id": 28588614, "question_id": 28588267, "link": "https://stackoverflow.com/questions/28588267/for-loop-performance-and-multithreaded-performance-questions/28588614#28588614", "title": "For loop performance and multithreaded performance questions", "body": "<p>Not knowing how those std::thread classes are implemented, one possible explanation for the 53ms could be:</p>\n\n<p>The threads are started right away when they get instantiated. (I see no thread.start() or threads.StartAll() or alike). So, during the time the first thread instance gets active, the main thread might (or might not) be preempted. There is no guarantee that the threads are getting spawned on individual cores, after all (thread affinity). </p>\n\n<p>If you have a closer look at POSIX APIs, there is the notion of \"application context\" and \"system context\", which basically implies, that there might be an OS policy in place which would not use all cores for 1 application.</p>\n\n<p>On Windows (this is where you were testing), maybe the threads are not being spawned directly but via a thread pool, maybe with some extra std::thread functionality, which could produce overhead/delay. (Such as completion ports etc.).</p>\n\n<p>Unfortunately my machine is pretty fast so I had to increase the amount of data processed to yield significant times. But on the upside, this reminded me to point out, that typically, it starts to pay off to go parallel when the computation times are way beyond the time of a time slice (rule of thumb).</p>\n\n<p>Here my \"native\" Windows implementation, which - for a large enough array finally makes the threads win over a single threaded computation.</p>\n\n<pre><code>#include &lt;stdafx.h&gt;\n#include &lt;nativethreadTest.h&gt;\n\n#include &lt;vector&gt;\n#include &lt;cstdint&gt;\n#include &lt;Windows.h&gt;\n#include &lt;chrono&gt;\n#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nstruct Range\n{\n    Range( const int32_t *p, size_t l)\n        : data(p)\n        , length(l)\n        , result(0)\n    {}\n    const int32_t *data;\n    size_t length;\n    int32_t result;\n};\n\nstatic int32_t Sum(const int32_t * data, size_t length)\n{\n    int32_t sum = 0;\n    const int32_t *end = data + length;\n    for (; data != end; data++)\n    {\n        sum += *data;\n    }\n    return sum;\n}\n\nstatic int32_t TestSingleThreaded(const Range&amp; range)\n{\n    return Sum(range.data, range.length);\n}\n\nDWORD \nWINAPI \nCalcThread\n(_In_  LPVOID lpParameter\n)\n{\n    Range * myRange = reinterpret_cast&lt;Range*&gt;(lpParameter);\n    myRange-&gt;result = Sum(myRange-&gt;data, myRange-&gt;length);\n    return 0;\n}\n\nstatic int32_t TestWithNCores(const Range&amp; range, size_t ncores)\n{\n    int32_t result = 0;\n    std::vector&lt;Range&gt; ranges;\n    size_t nextStart = 0;\n    size_t chunkLength = range.length / ncores;\n    size_t remainder = range.length - chunkLength * ncores;\n    while (nextStart &lt; range.length)\n    {\n        ranges.push_back(Range(&amp;range.data[nextStart], chunkLength));\n        nextStart += chunkLength;\n    }\n    Range remainderRange(&amp;range.data[range.length - remainder], remainder);\n\n    std::vector&lt;HANDLE&gt; threadHandles;\n    threadHandles.reserve(ncores);\n    for (size_t i = 0; i &lt; ncores; ++i)\n    {\n        threadHandles.push_back(::CreateThread(NULL, 0, CalcThread, &amp;ranges[i], 0, NULL));\n    }\n    int32_t remainderResult = Sum(remainderRange.data, remainderRange.length);\n    DWORD waitResult = ::WaitForMultipleObjects((DWORD)threadHandles.size(), &amp;threadHandles[0], TRUE, INFINITE);\n    if (WAIT_OBJECT_0 == waitResult)\n    {\n        for (auto&amp; r : ranges)\n        {\n            result += r.result;\n        }\n        result += remainderResult;\n    }\n    else\n    {\n        throw std::runtime_error(\"Something went horribly - HORRIBLY wrong!\");\n    }\n    for (auto&amp; h : threadHandles)\n    {\n        ::CloseHandle(h);\n    }\n    return result;\n}\n\nstatic int32_t TestWithSTLThreads(const Range&amp; range, size_t ncores)\n{\n    int32_t result = 0;\n    std::vector&lt;Range&gt; ranges;\n    size_t nextStart = 0;\n    size_t chunkLength = range.length / ncores;\n    size_t remainder = range.length - chunkLength * ncores;\n    while (nextStart &lt; range.length)\n    {\n        ranges.push_back(Range(&amp;range.data[nextStart], chunkLength));\n        nextStart += chunkLength;\n    }\n    Range remainderRange(&amp;range.data[range.length - remainder], remainder);\n\n    std::vector&lt;std::thread&gt; threads;\n    for (size_t i = 0; i &lt; ncores; ++i)\n    {\n        threads.push_back(std::thread([](Range* range){ range-&gt;result = Sum(range-&gt;data, range-&gt;length); }, &amp;ranges[i]));\n    }\n\n    int32_t remainderResult = Sum(remainderRange.data, remainderRange.length);\n    for (auto&amp; t : threads)\n    {\n        t.join();\n    }\n    for (auto&amp; r : ranges)\n    {\n        result += r.result;\n    }\n    result += remainderResult;\n    return result;\n}\n\nvoid TestNativeThreads()\n{\n    const size_t DATA_SIZE = 800000000ULL;\n    typedef std::vector&lt;int32_t&gt; DataVector;\n    DataVector data;\n    data.reserve(DATA_SIZE);\n\n    for (size_t i = 0; i &lt; DATA_SIZE; ++i)\n    {\n        data.push_back(static_cast&lt;int32_t&gt;(i));\n    }\n\n    Range r = { data.data(), data.size() };\n    std::chrono::system_clock::time_point singleThreadedStart = std::chrono::high_resolution_clock::now();\n    int32_t result = TestSingleThreaded(r);\n    std::chrono::system_clock::time_point singleThreadedEnd = std::chrono::high_resolution_clock::now();\n    std::cout\n        &lt;&lt; \"Single threaded sum: \"\n        &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(singleThreadedEnd - singleThreadedStart).count()\n        &lt;&lt; \"ms.\" &lt;&lt; \" Result = \" &lt;&lt; result &lt;&lt; std::endl;\n\n    std::chrono::system_clock::time_point multiThreadedStart = std::chrono::high_resolution_clock::now();\n    result = TestWithNCores(r, 8);\n    std::chrono::system_clock::time_point multiThreadedEnd = std::chrono::high_resolution_clock::now();\n\n    std::cout \n        &lt;&lt; \"Multi threaded sum: \"\n        &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(multiThreadedEnd - multiThreadedStart).count()\n        &lt;&lt; \"ms.\" &lt;&lt; \" Result = \" &lt;&lt; result &lt;&lt; std::endl;\n\n    std::chrono::system_clock::time_point stdThreadedStart = std::chrono::high_resolution_clock::now();\n    result = TestWithSTLThreads(r, 8);\n    std::chrono::system_clock::time_point stdThreadedEnd = std::chrono::high_resolution_clock::now();\n\n    std::cout\n        &lt;&lt; \"std::thread sum: \"\n        &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(stdThreadedEnd - stdThreadedStart).count()\n        &lt;&lt; \"ms.\" &lt;&lt; \" Result = \" &lt;&lt; result &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Here the output on my machine of this code:</p>\n\n<pre><code>Single threaded sum: 382ms. Result = -532120576\nMulti threaded sum: 234ms. Result = -532120576\nstd::thread sum: 245ms. Result = -532120576\nPress any key to continue . . ..\n</code></pre>\n\n<p>Last not least, I feel urged to mention that the way this code is written it is rather a memory IO performance benchmark than a core CPU computation benchmark.\nBetter computation benchmarks would use small amounts of data which is local, fits into CPU caches etc.</p>\n\n<p>Maybe it would be interesting to experiment with the splitting of the data into ranges. What if each thread were \"jumping\" over the data from the start to an end with a gap of ncores? Thread 1: 0 8 16... Thread 2: 1 9 17 ... etc.? Maybe then the \"locality\" of the memory could gain extra speed.</p>\n"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1424278674, "creation_date": 1424278674, "answer_id": 28589293, "question_id": 28588267, "link": "https://stackoverflow.com/questions/28588267/for-loop-performance-and-multithreaded-performance-questions/28589293#28589293", "title": "For loop performance and multithreaded performance questions", "body": "<blockquote>\n  <p>should there be a difference this big in debug mode between these three for loops?</p>\n</blockquote>\n\n<p>Yes. If allowed, a decent compiler can produce identical output for each of the 3 different loops, but if optimizations are not enabled, the iterator version has more function calls and function calls have certain overhead.</p>\n\n<blockquote>\n  <p>Or even a difference in 1ms in release mode?</p>\n</blockquote>\n\n<p>Your test code:</p>\n\n<pre><code>    start = ...\n    for (auto&amp; val : ints)\n            sum += val;\n    end = ...\n    diff = end - start;\n    sum = 0;\n</code></pre>\n\n<p>Doesn't use the result of the loop at all so when optimized, the compiler should simply choose to throw away the code resulting in something like:</p>\n\n<pre><code>    start = ...\n    // do nothing...\n    end = ...\n    diff = end - start;\n</code></pre>\n\n<p>For all your loops. </p>\n\n<p>The difference of 1ms may be produced by high granularity of the \"<code>high_resolution_clock</code>\" in the used implementation of the standard library and by differences in process scheduling during the execution. I measured the index based for being 0.04 ms slower, but that result is meaningless.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424286062, "post_id": 28589882, "comment_id": 45489881, "body": "Did you use std::thread and does OpenMP offer better performance? I just tested std::thread and native Windows threads, and it showed a huge difference."}, {"owner": {"reputation": 189, "user_id": 4377400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fac73b3df34c14d5e5405e83a840c1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathilion", "link": "https://stackoverflow.com/users/4377400/nathilion"}, "reply_to_user": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424370156, "post_id": 28589882, "comment_id": 45531232, "body": "Based on your code I made a version of my own which tests the Index For, Iterator For, Ranged For, StdThread and BoostThread. I haven&#39;t gotten round yet to putting in POSIX/Windows threads. And the results matched up yours. On an i7-860 with 100.000.000 ints and 8 threads, release build, VS2013. Of the three single-threaded all are &lt;1ms. std::thread around 120ms, boost 130ms. OpenMP 3800ms.  OpenMP is disappointing but all three show the impact of thread switching. Though, VS2013 uses 2.0 while 4.0 is out.  Here&#39;s a link to my code: <a href=\"https://dl.dropboxusercontent.com/u/6108803/thread_tester.cpp\" rel=\"nofollow noreferrer\">dl.dropboxusercontent.com/u/6108803/thread_tester.cpp</a>"}, {"owner": {"reputation": 189, "user_id": 4377400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fac73b3df34c14d5e5405e83a840c1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathilion", "link": "https://stackoverflow.com/users/4377400/nathilion"}, "reply_to_user": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424377007, "post_id": 28589882, "comment_id": 45535099, "body": "I just tested it on a linux box with an intel G1820 (dual core, dual threaded). I compiled it with GCC 4.9.1 which has OpenMP4 and hoped for a better outcome for OpenMP. Sadly enough: the results were in line with the Windows box. The single-threaded loops were a magnitude faster than the threaded versions. std::thread still beats boost::thread. And OpenMP still lags behind as if it tried to run without legs. Man, what a let-down. The OpenMP version was so much easier to make than the other threaded versions!  The results: 0, 0, 0 (index, ranged, iterator), 18 (std), 23 (boost), 4098ms OpenMP."}, {"owner": {"reputation": 189, "user_id": 4377400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fac73b3df34c14d5e5405e83a840c1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathilion", "link": "https://stackoverflow.com/users/4377400/nathilion"}, "reply_to_user": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424421971, "post_id": 28589882, "comment_id": 45550633, "body": "Okay, the OpenMP results galled me so I figured I must have done something wrong. Which I did. I updated my code with a new test show-casing a much better OMP construction. The results on my office machine with an i7-4770 on Win8.1 with VS2013 are now:  Index/Ranged/Iterator: &lt;1ms. std: 117-152 ms, boost: 127-156ms, OpenMP old: ~1900ms, OpenMP new: 77-136ms. OpenMP is now consistently faster than the other thread tests."}, {"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424469040, "post_id": 28589882, "comment_id": 45577164, "body": "Thanks for sharing your results. I&#39;ll have to try OpenMP and play around with it once I have some free time. I refactored the initial code, and got the multithreaded test to be faster than the singlethreaded, using std::thread. Results were a lot different when everything measuring related was moved out of the lambda used by threads."}], "owner": {"reputation": 189, "user_id": 4377400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fac73b3df34c14d5e5405e83a840c1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathilion", "link": "https://stackoverflow.com/users/4377400/nathilion"}, "is_accepted": false, "score": 1, "last_activity_date": 1424280316, "creation_date": 1424280316, "answer_id": 28589882, "question_id": 28588267, "link": "https://stackoverflow.com/questions/28588267/for-loop-performance-and-multithreaded-performance-questions/28589882#28589882", "title": "For loop performance and multithreaded performance questions", "body": "<p>Aside from how std::thread is implemented on Windows I would to point your attention to your available execution units and context switching.</p>\n\n<p>An i7 does <em>not</em> have 8 real execution units. It's a quad-core processor with hyper-threading. And HT does not magically double the available number of threads, no matter how it's advertised. It's a really clever system which tries to fit in instructions from an extra pipeline whenever possible. But in the end all instructions go through only four execution units.\nSo running 8 (or 7) threads is still more than your CPU can really handle simultaneously. That means your CPU has to switch a lot between 8 hot threads clamouring for calculation time. Top that off with several hundred more threads from the OS, admittedly most of which are asleep, that need time and you're left with a high degree of uncertainty in your measurements.</p>\n\n<p>With a single threaded for-loop the OS can dedicate a single core to that task and spread the half-sleeping threads across the other three. This is why you're seeing such a difference between 1 thread and 8 threads.</p>\n\n<p>As for your debugging questions: you should check if Visual Studio has Iterator checking enabled in debugging. When it's enabled every time an iterator is used it is bounds-checked and such. See: <a href=\"https://msdn.microsoft.com/en-us/library/aa985965.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa985965.aspx</a> </p>\n\n<p>Lastly: have a look at the -openmp switch. If you enable that and apply the OpenMP #pragmas to your for-loops you can do away with all the manual thread creation. I toyed around with similar threading tests (because it's cool. :) ) and OpenMPs performance is pretty damn good.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "edited": false, "score": 0, "creation_date": 1424285692, "post_id": 28591323, "comment_id": 45489623, "body": "With optimized release build and 800,000 ints all I got were zeroes, so I increased it to 80,000,000 and got this: index loop: 28.0016ms, 8 threads total: 87.0051ms"}], "owner": {"reputation": 1530, "user_id": 4562911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebc7b3d9f657ab929c232596182c861?s=128&d=identicon&r=PG&f=1", "display_name": "halfflat", "link": "https://stackoverflow.com/users/4562911/halfflat"}, "is_accepted": false, "score": 1, "last_activity_date": 1424284684, "creation_date": 1424284684, "answer_id": 28591323, "question_id": 28588267, "link": "https://stackoverflow.com/questions/28588267/for-loop-performance-and-multithreaded-performance-questions/28591323#28591323", "title": "For loop performance and multithreaded performance questions", "body": "<p>For the first question, regarding the difference in performance between the range, iterator and index implementations, others have pointed out that in a non-optimized build, much which would normally be inlined may not be.</p>\n\n<p>However there is an additional wrinkle: by default, in Debug builds, <a href=\"https://msdn.microsoft.com/en-us/library/hh697468.aspx\" rel=\"nofollow\">Visual Studio will use checked iterators</a>. Access through a checked iterator is checked for safety (does the iterator refer to a valid element?), and consequently operations which use them, including the range-based iteration, are heavily penalized.</p>\n\n<p>For the second part, I have to say that those durations seem abnormally long. When I run the code locally, compiled with g++ -O3 on a core i7-4770 (Linux), I get sub-millisecond timings for each method, less in fact than the jitter between runs. Altering the code to iterate each test 1000 times gives more stable results, with the per test times being 0.33 ms for the index and range loops with no extra tweaking, and about 0.15 ms for the parallel test.</p>\n\n<p>The parallel threads are doing in total the same number of operations, and what's more, using all four cores limits the CPU's ability to dynamically increase its clock speed. So how can it take less total time?</p>\n\n<p>I'd wager that the gains result from better utilization of the per-core L2 caches, four in total. Indeed, using four threads instead of eight threads reduces the total parallel time to 0.11 ms, consistent with better L2 cache use.</p>\n\n<p>Browsing the Intel processor documentation, all the Core i7 processors, including the mobile ones, have at least 4 MB of L3 cache, which will happily accommodate 800 thousand 4-byte ints. So I'm surprised both by the raw times being 100 times larger than I'm seeing, and the 8-thread time totals being so much greater, which as you surmise, is a strong hint that they are thrashing the cache. I'm presuming this is demonstrating just how suboptimal the Debug build code is. Could you post results from an optimised build?</p>\n"}], "owner": {"reputation": 137, "user_id": 2201364, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b79cd8e462f77d1013fa0431688f330f?s=128&d=identicon&r=PG", "display_name": "rndm", "link": "https://stackoverflow.com/users/2201364/rndm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1627, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1424289934, "creation_date": 1424275925, "last_edit_date": 1424277214, "question_id": 28588267, "link": "https://stackoverflow.com/questions/28588267/for-loop-performance-and-multithreaded-performance-questions", "title": "For loop performance and multithreaded performance questions", "body": "<p>I was kind of bored so I wanted to try using std::thread and eventually measure performance of single and multithreaded console application. This is a two part question. So I started with a single threaded sum of a massive vector of ints (800000 of ints).</p>\n\n<pre><code>int sum = 0;\nauto start = chrono::high_resolution_clock::now();\n\nfor (int i = 0; i &lt; 800000; ++i)\n    sum += ints[i];\n\nauto end = chrono::high_resolution_clock::now();\nauto diff = end - start;\n</code></pre>\n\n<p>Then I added range based and iterator based for loop and measured the same way with chrono::high_resolution_clock.</p>\n\n<pre><code>for (auto&amp; val : ints)\n    sum += val;\n\nfor (auto it = ints.begin(); it != ints.end(); ++it)\n    sum += *it;\n</code></pre>\n\n<p>At this point console output looked like:</p>\n\n<pre><code>index loop: 30.0017ms\nrange loop: 221.013ms\niterator loop: 442.025ms\n</code></pre>\n\n<p>This was a debug version, so I changed to release and the difference was ~1ms in favor of index based for. No big deal, but just out of curiosity: should there be a difference this big in debug mode between these three for loops? Or even a difference in 1ms in release mode?</p>\n\n<p>I moved on to the thread creation, and tried to do a parallel sum of the array with this lambda (captured everything by reference so I could use vector of ints and a mutex previously declared) using index based for.</p>\n\n<pre><code>auto func = [&amp;](int start, int total, int index)\n{\n    int partial_sum = 0;\n\n    auto s = chrono::high_resolution_clock::now();\n    for (int i = start; i &lt; start + total; ++i)\n        partial_sum += ints[i];\n    auto e = chrono::high_resolution_clock::now();\n    auto d = e - s;\n\n    m.lock();\n    cout &lt;&lt; \"thread \" + to_string(index) + \": \" &lt;&lt; chrono::duration&lt;double, milli&gt;(d).count() &lt;&lt; \"ms\" &lt;&lt; endl;\n    sum += partial_sum;\n    m.unlock();\n};\n\nfor (int i = 0; i &lt; 8; ++i)\n    threads.push_back(thread(func, i * 100000, 100000, i));\n</code></pre>\n\n<p>Basically every thread was summing 1/8 of the total array, and the final console output was:</p>\n\n<pre><code>thread 0: 6.0004ms\nthread 3: 6.0004ms\nthread 2: 6.0004ms\nthread 5: 7.0004ms\nthread 4: 7.0004ms\nthread 1: 7.0004ms\nthread 6: 7.0004ms\nthread 7: 7.0004ms\n8 threads total: 53.0032ms\n</code></pre>\n\n<p>So I guess the second part of this question is what's going on here? Solution with 2 threads ended with ~30ms as well. Cache ping pong? Something else? If I'm doing something wrong, what would be the correct way to do it? Also if It's relevant, I was trying this on an i7 with 8 threads, so yes I know I didn't count the main thread, but tried it with 7 separate threads and pretty much got the same result.</p>\n\n<p>EDIT: Sorry forgot the mention this was on Windows 7 with Visual Studio 2013 and Visual Studio's v120 compiler or whatever it's called.</p>\n\n<p>EDIT2: Here's the whole main function: \n<a href=\"http://pastebin.com/HyZUYxSY\" rel=\"nofollow\">http://pastebin.com/HyZUYxSY</a></p>\n"}, {"tags": ["c++", "file", "file-io"], "comments": [{"owner": {"reputation": 3993, "user_id": 125405, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/71e57d309c0a11cc78732e82e3486f3e?s=128&d=identicon&r=PG", "display_name": "wolfPack88", "link": "https://stackoverflow.com/users/125405/wolfpack88"}, "edited": false, "score": 0, "creation_date": 1424275901, "post_id": 28588214, "comment_id": 45483389, "body": "What do you mean by terminates? Do you get the command prompt back immediately afterwards?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1424275904, "post_id": 28588214, "comment_id": 45483393, "body": "1) Variable length arrays are a compiler extension (consider using <code>std::vector</code>), 2) you seem to want to save the numbers in the file but you used an <code>ifstream</code>"}, {"owner": {"reputation": 5680, "user_id": 278235, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/90727b648e0c2e00980bf52180027709?s=128&d=identicon&r=PG", "display_name": "Sungguk Lim", "link": "https://stackoverflow.com/users/278235/sungguk-lim"}, "edited": false, "score": 0, "creation_date": 1424276407, "post_id": 28588214, "comment_id": 45483761, "body": "No. Impossible. because you don&#39;t the size of array in compile time."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424280525, "post_id": 28588214, "comment_id": 45486569, "body": "Your title says you are writing to a file, but I only see reading from a file.  Which is it, reading or writing?  By the way, reading uses <code>ifstream</code> and writing uses <code>ofstream</code>.  Note the difference in the first letter, &#39;i&#39; for input and &#39;o&#39; for output."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1424280594, "post_id": 28588214, "comment_id": 45486611, "body": "I suggest placing a breakpoint at the end of <code>main</code>.  When running the debugger, this should stop the IDE from closing the console window."}], "answers": [{"comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1424276905, "post_id": 28588448, "comment_id": 45484110, "body": "Recommending a <code>std::vector&lt;int&gt;</code> would probably be the better choice."}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1424278597, "post_id": 28588448, "comment_id": 45485247, "body": "If that was the problem, the program would not compile, but it does (because it&#39;s using a compiler extension)."}], "owner": {"reputation": 447, "user_id": 2317442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aefe8947911bf62d25c2a6d2102dad5d?s=128&d=identicon&r=PG", "display_name": "iwlagn", "link": "https://stackoverflow.com/users/2317442/iwlagn"}, "is_accepted": false, "score": -1, "last_activity_date": 1424276457, "creation_date": 1424276457, "answer_id": 28588448, "question_id": 28588214, "link": "https://stackoverflow.com/questions/28588214/writing-a-file-in-array-in-c/28588448#28588448", "title": "Writing a file in array in C++", "body": "<p>You can not create static array like you are trying to do:</p>\n\n<pre><code>int a [x];\n</code></pre>\n\n<p>Instead you need to dynamically allocate memory:</p>\n\n<pre><code>int *a = new int[x];\n</code></pre>\n\n<p>And properly release it before exit:</p>\n\n<pre><code>delete [] a;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3593450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424276457, "creation_date": 1424275779, "question_id": 28588214, "link": "https://stackoverflow.com/questions/28588214/writing-a-file-in-array-in-c", "title": "Writing a file in array in C++", "body": "<p>When i run my program it just asks for the size and terminates. Is there anything wrong with the logic?</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\nusing namespace std;\n\nint main()\n{\ncout &lt;&lt; \"Enter size of array\\n\";\nint x;\ncin &gt;&gt; x;\nint a [x];\nifstream data (\"numbers.txt\");\n\nif(data.is_open()){\n    cout &lt;&lt; \"Enter the elements\\n\";\n    for(int i = 0 ; i&lt;x ; i++){\n        data &gt;&gt; a[i];\n    }\nfor(int j = 0 ; j&lt;x ; j++){\n    cout &lt;&lt; a[j];\n}\n\n}\n}\n</code></pre>\n"}, {"tags": ["java", "android", "c++", "c", "pci"], "answers": [{"comments": [{"owner": {"reputation": 8260, "user_id": 906738, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/40909afbdc397444acebc91b63958a99?s=128&d=identicon&r=PG", "display_name": "JohnnyFromBF", "link": "https://stackoverflow.com/users/906738/johnnyfrombf"}, "edited": false, "score": 0, "creation_date": 1462366421, "post_id": 35379234, "comment_id": 61606678, "body": "Gives me the following runtime error: <code>FATAL EXCEPTION: main                                                                           Process: com.example.me.antennas, PID: 21831                                                                           java.lang.NullPointerException: Attempt to invoke interface method &#39;java.util.Iterator java.util.List.iterator()&#39; on a null object reference</code> at <code>for (CellInfo m : cellInfo)</code>."}], "owner": {"reputation": 113, "user_id": 4568636, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O3QXWgyfDOM/AAAAAAAAAAI/AAAAAAAAACs/U-mPRGJ01Pw/photo.jpg?sz=128", "display_name": "Shakawat Hossain", "link": "https://stackoverflow.com/users/4568636/shakawat-hossain"}, "is_accepted": false, "score": 1, "last_activity_date": 1455362552, "creation_date": 1455362552, "answer_id": 35379234, "question_id": 28588212, "link": "https://stackoverflow.com/questions/28588212/how-to-get-pci-info-about-display-device-on-android/35379234#35379234", "title": "How to get PCI info about display device on Android", "body": "<p>Here is the java class </p>\n\n<pre><code>import android.support.v7.app.AppCompatActivity;\nimport android.os.Bundle;\nimport android.telephony.CellInfo;\nimport android.telephony.CellInfoLte;\nimport android.telephony.PhoneStateListener;\nimport android.telephony.TelephonyManager;\nimport android.util.Log;\nimport android.view.Window;\nimport android.widget.TextView;\nimport java.util.List;\n\npublic class MainActivity extends AppCompatActivity {\n\nphoneStateListener listener;\nTelephonyManager telephonyManager;\nTextView tv;\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n\n    telephonyManager = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);\n    listener = new phoneStateListener();\n    telephonyManager.listen(listener,PhoneStateListener.LISTEN_CELL_INFO);\n    tv = (TextView) findViewById(R.id.tv);\n}\n\n@Override\nprotected void onResume() {\n    super.onResume();\n}\n\npublic class phoneStateListener extends PhoneStateListener{\n    public phoneStateListener(){\n\n    }\n\n    @Override\n    public void onCellInfoChanged(List&lt;CellInfo&gt; cellInfo) {\n        super.onCellInfoChanged(cellInfo);\n        for(CellInfo m: cellInfo)\n            if (m instanceof CellInfoLte){\n                CellInfoLte cellInfoLte=(CellInfoLte) m;\n                int pciNum = cellInfoLte.getCellIdentity().getPci();\n                Log.d(\"onCellInfoChanged\", \"CellInfoLte--\" + m);\n                tv.setText(\"PCINUMBER: \"+pciNum);\n            }\n    }\n}\n\n@Override\nprotected void onStop() {\n    super.onStop();\n    telephonyManager = null;\n}\n}\n</code></pre>\n\n<p>Don't forget to use permission\n    <strong>android.permission.READ_PHONE_STATE</strong>\n    <strong>android.permission.ACCESS_COARSE_LOCATION</strong></p>\n"}], "owner": {"reputation": 124, "user_id": 4580234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2525747d9ffe887ee7ab69f0ce559f4?s=128&d=identicon&r=PG", "display_name": "Frank Secilia", "link": "https://stackoverflow.com/users/4580234/frank-secilia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455362552, "creation_date": 1424275773, "last_edit_date": 1424280238, "question_id": 28588212, "link": "https://stackoverflow.com/questions/28588212/how-to-get-pci-info-about-display-device-on-android", "title": "How to get PCI info about display device on Android", "body": "<p>Morning, folks!</p>\n\n<p>I'm porting a desktop OpenGL c++ app to Android. This app is already fairly cross-platform. It requires reliable rendering on all platforms, so it accounts for differences in graphics driver implementations by enabling or disabling certain code paths based on the the host OS and the card's PCI information. Specifically, it switches over the device, vendor, and revision IDs. </p>\n\n<p>I need to get these PCI IDs from within Android. </p>\n\n<p>I'd prefer to do it programmatically from native code, but a JNI path or even parsing output of an external command are reasonable alternatives.</p>\n\n<p>I've been looking around but I can't find anything reliable. Any google search I can come up with involving Android and PCI or ID, even with a ton of filtering, returns getting the Android device's ID, a database or list of all known PCI device IDs, or the PCI Security Standards Council. Nothing about actual PCI headers. Maybe I just need more google-fu?</p>\n\n<p>There is no lspci on Android. Poking around in adb shell, I see that there is no accessible /sys filesystem and /proc/bus/pci/devices is empty. The closest I've seen is /proc/device-tree/nvidia-boardids on a Tegra, which prints out a fairly cryptic string that I'm pretty sure contains these IDs. This will probably work for devices which have it, but that's only the subset of devices running nVidia cards.</p>\n\n<p>As a last resort, we can probably use the info that comes back from glGetString, but that varies far more than PCI IDs. I would strongly prefer avoiding this route.</p>\n\n<p>This app is meant for Google Play distribution, so I absolutely cannot root these devices. </p>\n\n<p>Any ideas?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "windows", "dll"], "comments": [{"owner": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "edited": false, "score": 0, "creation_date": 1424978347, "post_id": 28588151, "comment_id": 45783732, "body": "I accepted the answer below since - while there don&#39;t seem to be any side effects to separating the lib from dll - it seemed  better to use the defaults provided by Visual Studio, with dependencies clearly next to the needy dlls. And make downstream application filter the input."}], "answers": [{"comments": [{"owner": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "edited": false, "score": 0, "creation_date": 1424292860, "post_id": 28591170, "comment_id": 45493967, "body": "thank you, I have no problem linking libraries. I can link either as I described, or by adding the dependencies as references. What I am trying to do is place ONLY DLL files into specific folders (renaming project configurations is a nice idea, thank you), without the lib files."}, {"owner": {"reputation": 684, "user_id": 4534262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94daeebeb9889bb4614963266ce719b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikerboker", "link": "https://stackoverflow.com/users/4534262/nikerboker"}, "reply_to_user": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "edited": false, "score": 0, "creation_date": 1424324605, "post_id": 28591170, "comment_id": 45504824, "body": "Are you sure, you really need this? It will require additional efforts."}, {"owner": {"reputation": 684, "user_id": 4534262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94daeebeb9889bb4614963266ce719b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikerboker", "link": "https://stackoverflow.com/users/4534262/nikerboker"}, "reply_to_user": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "edited": false, "score": 0, "creation_date": 1424324817, "post_id": 28591170, "comment_id": 45504875, "body": "Anyway, I would advice to create a property sheet for solution and specify common setting in it, not overriding them in each project."}, {"owner": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "edited": false, "score": 0, "creation_date": 1424366171, "post_id": 28591170, "comment_id": 45528873, "body": "Very good point about making a common property sheet... and yes I really need this - my needs are dictated by other peoples&#39; desires. As scary as that warning is though, so far it seems I can leave the projects with different output directories for dll and lib, with no adverse efects"}], "owner": {"reputation": 684, "user_id": 4534262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94daeebeb9889bb4614963266ce719b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikerboker", "link": "https://stackoverflow.com/users/4534262/nikerboker"}, "is_accepted": true, "score": 1, "last_activity_date": 1424284198, "creation_date": 1424284198, "answer_id": 28591170, "question_id": 28588151, "link": "https://stackoverflow.com/questions/28588151/separate-dll-from-other-output-files-in-c-projects/28591170#28591170", "title": "Separate dll from other output files in c++ projects", "body": "<p>The standard approach is to leave <strong>all</strong> these properties unchanged (inherit from parent). In this case linker will create DLL and LIB in <code>$(Output)</code> directory, which by default is <code>$(SolutionDir)$(Configuration)</code>.\nYou just specify the name for x64 configuration, and all output files will be separated automatically.</p>\n\n<p>The standard (and the easest) way to link import library is to add reference to corresponding project in <code>Common Properties / References</code> page. Nothing else is required. </p>\n\n<p>If, for any reason, it is impossible, add <code>$(SolutionDir)$(Configuration)</code> to <code>Configuration Properties / VC++ Directories / Library Directories</code> and add library to be linked to <code>Linker / Additional Dependencies</code>. If there are many projects in your solution, you may create Property Sheet for the solution and specify <code>Library Directories</code> only once.</p>\n"}], "owner": {"reputation": 11175, "user_id": 1217150, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6ryIf.png?s=128&g=1", "display_name": "Thalia", "link": "https://stackoverflow.com/users/1217150/thalia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 28591170, "answer_count": 1, "score": 0, "last_activity_date": 1424292521, "creation_date": 1424275643, "last_edit_date": 1424292521, "question_id": 28588151, "link": "https://stackoverflow.com/questions/28588151/separate-dll-from-other-output-files-in-c-projects", "title": "Separate dll from other output files in c++ projects", "body": "<p>I have a few dll projects in a solution (some depending on each other)</p>\n\n<pre><code>Project1 -&gt; Properties -&gt; Linker -&gt; Input -&gt; Additional Dependencies -&gt; Project2.lib\nProject1 -&gt; Properties -&gt; Linker -&gt; General -&gt; Additional Library Directories -&gt; $(OutDir)\n</code></pre>\n\n<p>All is working fine.</p>\n\n<p>Projects are Win7Debug Win32, Win7Debug x64..... and a Win32 project with only Debug and Release configurations.</p>\n\n<p>I would like to have all dll's for Win32 placed in one folder and the x64 ones in another folder. So I added the x64 configuration for the Win32 project, and changed</p>\n\n<pre><code>Project1 -&gt; Properties -&gt; Linker -&gt; General -&gt; Output File -&gt; $(SolutionDir)/i386/$(TargetName)/$(TargetExt)\n</code></pre>\n\n<p>(for Win32 - similar change for x64)</p>\n\n<p>all seemed fine - and I only received dlls in the i386 folder... until I had to rebuild and got </p>\n\n<pre><code>Warning 23  warning MSB8012: \nTargetPath(C:\\Path\\Win7Debug\\Project1.dll) does not match the Linker's OutputFile \nproperty value (C:\\Path\\i386\\Project1.dll). This may cause your project to build \nincorrectly. To correct this, please make sure that $(OutDir), $(TargetName) and \n$(TargetExt) property values match the value specified in %(Link.OutputFile).   \n</code></pre>\n\n<p>This seems serious... and I don't want to have problems with missing dependencies (though everything seems to be working fine - and not just on my machine)</p>\n\n<p>I changed </p>\n\n<pre><code> Project1 -&gt; Properties -&gt; Configuration Properties -&gt; General -&gt; OutputDirectory -&gt; $(SolutionDir)/i386\n</code></pre>\n\n<p>(to match the linker output) but now of course I get lib and exp files in the same folder as the dll's.</p>\n\n<p>Other than using post build script, is there a way to separate the output files ? </p>\n\n<p>Should I just leave the settings how I had them and disregard the warning above ?</p>\n\n<p><strong>Note</strong>: I am not trying to separate the Platform/configuration output files... That is done automagically using the default output directory.</p>\n\n<p>What I need is, for each platform, to place only DLL files in one folder away from anything else. Redirecting Linker output (and leaving project output to standard) accomplishes that - I just am not sure if it is correct. Logically I should not have any build problems since I am giving linker all the info it needs...</p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 96896, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 2, "creation_date": 1424275596, "post_id": 28588071, "comment_id": 45483172, "body": "It would be <code>vec[0].first</code>."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1424275743, "post_id": 28588071, "comment_id": 45483278, "body": "<code>vec</code> is a vector of pairs, not a &quot;vector pair&quot;. So &quot;the first character of the first element of the first column of a vector pair&quot; doesn&#39;t make any sense. Can you explain in more detail what you want to achieve ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2514456"}, "edited": false, "score": 0, "creation_date": 1424275898, "post_id": 28588071, "comment_id": 45483384, "body": "So the vector has information stored as <code>10515 This is a string\\\\ 20515 This is also a string</code> And I want to be able to input, say, 2 and only have the second string displayed."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1424276068, "post_id": 28588071, "comment_id": 45483515, "body": "As a sidenote, you can replace the erase wtih <code>vec.clear();</code>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1424279800, "post_id": 28588071, "comment_id": 45486099, "body": "@DaveScott : to access the second string, you want <code>vec[1].second</code> - <code>vec[1]</code> gets the second pair from the vector, and the <code>.second</code> bit gets the string from that pair."}], "answers": [{"owner": {"reputation": 2978, "user_id": 2763256, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EmWiu.jpg?s=128&g=1", "display_name": "Kacy", "link": "https://stackoverflow.com/users/2763256/kacy"}, "is_accepted": true, "score": 2, "last_activity_date": 1424275629, "creation_date": 1424275629, "answer_id": 28588144, "question_id": 28588071, "link": "https://stackoverflow.com/questions/28588071/c-accessing-first-character-of-first-element-in-first-column-of-vector-pair/28588144#28588144", "title": "(C++) Accessing first character of first element in first column of vector pair", "body": "<p>Change:</p>\n\n<pre><code>&amp;vec.first[0]\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>vec.front().first\n</code></pre>\n\n<p>And as stated by Cyber in the comments, <code>vec[0].first</code> is also valid.</p>\n"}, {"owner": {"reputation": 1034, "user_id": 2215331, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/lrto1.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/2215331/leo"}, "is_accepted": false, "score": 1, "last_activity_date": 1424275779, "creation_date": 1424275779, "answer_id": 28588215, "question_id": 28588071, "link": "https://stackoverflow.com/questions/28588071/c-accessing-first-character-of-first-element-in-first-column-of-vector-pair/28588215#28588215", "title": "(C++) Accessing first character of first element in first column of vector pair", "body": "<p>You need to access the position of the verctor first, and then the first element of the pair:</p>\n\n<pre><code>vec[0].first \n</code></pre>\n"}, {"owner": {"reputation": 398, "user_id": 836887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLm2b.png?s=128&g=1", "display_name": "Encaitar", "link": "https://stackoverflow.com/users/836887/encaitar"}, "is_accepted": false, "score": 0, "last_activity_date": 1424276313, "creation_date": 1424276313, "answer_id": 28588398, "question_id": 28588071, "link": "https://stackoverflow.com/questions/28588071/c-accessing-first-character-of-first-element-in-first-column-of-vector-pair/28588398#28588398", "title": "(C++) Accessing first character of first element in first column of vector pair", "body": "<p>The first method allows you to easily access the first item in a pair. When applied to a pair variable, first will give you the first item (the int in your case) and second will give you the second item (the string in your case). </p>\n\n<p>You are mistakenly applying the method called 'first' to the vector and not to one of the pairs in the vector. </p>\n\n<p>To access one of the pairs in the vector use:</p>\n\n<pre><code>vec[i].first\n</code></pre>\n\n<p>where you are accessing the ith element in the vector (sticking with your example where you are using i to denote the loop counter). vec[i] returns a variable of type pair, which you can then call the first method on. </p>\n\n<p>The error you get </p>\n\n<pre><code>error: 'class std::vector&lt;std::pair&lt;int, std::basic_string&lt;char&gt; &gt; &gt;' has no member named 'first'\n</code></pre>\n\n<p>tries to explain this, C++ are always quite hard to read. It tells you that there is no member (in this case a method) named 'first' that can be found to be applied to a variable of type vector of pairs of ints mapped to strings. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2514456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 28588144, "answer_count": 3, "score": 0, "last_activity_date": 1424276313, "creation_date": 1424275376, "question_id": 28588071, "link": "https://stackoverflow.com/questions/28588071/c-accessing-first-character-of-first-element-in-first-column-of-vector-pair", "title": "(C++) Accessing first character of first element in first column of vector pair", "body": "<p>I am attempting to compare the first character of the first element of the first column of a vector pair to a user input <code>int</code> and only keep those values that start with that number. The pair is formatted as </p>\n\n<pre><code>vector&lt; pair &lt;int, string&gt; &gt; vec;\n</code></pre>\n\n<p>I've tried</p>\n\n<pre><code>for(int i = 0; i &lt; vec.size(); ++i)\n{\n    if(&amp;vec.first[0] != userInput)\n    {\n        vec.erase(vec.begin(), vec.end());\n    }\n}\n</code></pre>\n\n<p>which throws the error</p>\n\n<pre><code>error: 'class std::vector&lt;std::pair&lt;int, std::basic_string&lt;char&gt; &gt; &gt;' has no member named 'first'\n</code></pre>\n\n<p>If anyone has a way to do this (seemingly simple) task, I would be hugely grateful - many an hour has been spent searching for the solution, but to no avail.</p>\n"}, {"tags": ["c++", "function", "polymorphism", "virtual"], "comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 6, "creation_date": 1424275166, "post_id": 28587909, "comment_id": 45482888, "body": "The above code is bad practice.  It contains flag values (<code>-1</code>), and uses polymorphism needlessly (why is a spare part that is not on hand anything more than a spare part with no location and quantity?  Having an optional (sub set of) properties is insufficient justification for polymorphism, especially because (in the above case) it is clear the property isn&#39;t really optional (as it is exposed in the root type!)  Even your accessors: how is spare_part not just flat data?"}, {"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1424275543, "post_id": 28587909, "comment_id": 45483143, "body": "To add to what Yakk is saying: It sounds like you are polluting your base class with information about a derived class. Perhaps you are trying to get a list of Spare_Part*, but be able to tell something about a On_hand, and you want to do that without using a union or doing dynamic casting. Perhaps you should instead consider another class in the middle of the hierarchy that implements what you need."}, {"owner": {"reputation": 79, "user_id": 3144635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Ktlfr.png?s=128&g=1", "display_name": "Adam Payne", "link": "https://stackoverflow.com/users/3144635/adam-payne"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1424275589, "post_id": 28587909, "comment_id": 45483167, "body": "@Yakk The whole hierarchy is a little bit more complex. Alongside the &#39;On_hand&#39; class there is class for parts available through contracted suppliers. The assumption is that I wouldn&#39;t be able to know how many parts are available through the suppliers and that is why &#39;quantity&#39; is not included in the base class."}], "answers": [{"owner": {"reputation": 59234, "user_id": 496161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c425873f547d93f4079ca252b42a886d?s=128&d=identicon&r=PG", "display_name": "TartanLlama", "link": "https://stackoverflow.com/users/496161/tartanllama"}, "is_accepted": false, "score": 4, "last_activity_date": 1424275418, "creation_date": 1424275418, "answer_id": 28588080, "question_id": 28587909, "link": "https://stackoverflow.com/questions/28587909/is-it-considered-a-good-practice-to-define-virtual-get-and-set-functions-in-c/28588080#28588080", "title": "Is it considered a good practice to define virtual get and set functions in C++?", "body": "<p>In this case, yes, this is bad practice; if it doesn't make sense to call <code>getQuantity</code> on a <code>Spare_Part</code>, it shouldn't compile. It should definitely not just return a flag value.</p>\n\n<p>A redesign of your classes is probably necessary. Polymorphism should be used to model an <em>is-a</em> relationship, but your use is mostly to tag more data onto the class. You should use composition instead, perhaps making a <code>Part_Store</code> class which contains a <code>Spare_Part</code>, the quantity and location.</p>\n"}, {"owner": {"reputation": 12261, "user_id": 3866447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/52ieQ.jpg?s=128&g=1", "display_name": "Sam Protsenko", "link": "https://stackoverflow.com/users/3866447/sam-protsenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1424276523, "last_edit_date": 1495541662, "creation_date": 1424276523, "answer_id": 28588474, "question_id": 28587909, "link": "https://stackoverflow.com/questions/28587909/is-it-considered-a-good-practice-to-define-virtual-get-and-set-functions-in-c/28588474#28588474", "title": "Is it considered a good practice to define virtual get and set functions in C++?", "body": "<p>IMO, getters and setters must be considered as a bad practice and even an anti-pattern in <em>almost</em> all cases. The whole point of using OOP is to conceal implementation details (well, not only this, but this is also among others). Getters/setters are intended to expose implementation details, hence it ruins one of OOP principles. In the end, why not using old plain C structs, if you are using getters/setters? In such case, classes don't have any advantages over structs.</p>\n\n<p>Well, there <strong>are</strong> cases when getters/setters may look good. The point is, there are too many programmers use them as replacement for structs. And the reason usually -- they don't understand how to design application in OOP manner.</p>\n\n<p>In your case you don't need getters/setters. Just think about how you are gonna use this class further. Is it gonna have any extra functionality or just store some data? If so, maybe just use POD structs?</p>\n\n<p>Further reading:</p>\n\n<p>[1] <a href=\"http://www.javaworld.com/article/2073723/core-java/why-getter-and-setter-methods-are-evil.html\" rel=\"nofollow noreferrer\">http://www.javaworld.com/article/2073723/core-java/why-getter-and-setter-methods-are-evil.html</a></p>\n\n<p>[2] <a href=\"http://www.yegor256.com/2014/09/16/getters-and-setters-are-evil.html\" rel=\"nofollow noreferrer\">http://www.yegor256.com/2014/09/16/getters-and-setters-are-evil.html</a></p>\n\n<p>[3] <a href=\"http://typicalprogrammer.com/doing-it-wrong-getters-and-setters/\" rel=\"nofollow noreferrer\">http://typicalprogrammer.com/doing-it-wrong-getters-and-setters/</a></p>\n\n<p>[4] <a href=\"https://stackoverflow.com/questions/1568091/why-use-getters-and-setters\">Why use getters and setters?</a></p>\n\n<p>[5] <a href=\"http://berryllium.nl/2011/02/getters-and-setters-evil-or-necessary-evil/\" rel=\"nofollow noreferrer\">http://berryllium.nl/2011/02/getters-and-setters-evil-or-necessary-evil/</a></p>\n"}, {"owner": {"reputation": 2876, "user_id": 2653222, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8e1982d6681fda864de3c34a35807984?s=128&d=identicon&r=PG", "display_name": "Giulio Franco", "link": "https://stackoverflow.com/users/2653222/giulio-franco"}, "is_accepted": false, "score": 1, "last_activity_date": 1424279280, "last_edit_date": 1424279280, "creation_date": 1424277040, "answer_id": 28588670, "question_id": 28587909, "link": "https://stackoverflow.com/questions/28587909/is-it-considered-a-good-practice-to-define-virtual-get-and-set-functions-in-c/28588670#28588670", "title": "Is it considered a good practice to define virtual get and set functions in C++?", "body": "<p>Let's try sorting things out.</p>\n\n<p>There's nothing wrong in having a base calling its derived class to read a property. There are cases when it's known that every implementation of a base class must have a property, and the base class offers some functionalities that require that property, and that would be the same in all reasonable implementation, except for that property.\nIn such cases, there's absolutely nothing wrong in doing that.</p>\n\n<p>As an alternative, if you're really sure that property is always going to be implemented with a simple fixed-type variable in any reasonable implementation, you can just add a protected variable to the base class, and let the implementations write to it.</p>\n\n<p>It's all a matter of how much flexibility you need.</p>\n\n<p><strong>In your case</strong>, I think your conceptual inheritance model is flawed, which kind of empties your case of any meaning.</p>\n\n<p>You are saying that <code>On_hand</code> derives from <code>Spare_Part</code>, which means, by definition, that every <code>On_hand</code> is a <code>Spare_Part</code>. This sounds weird to me, as being \"on hand\" sounds more like a quality of the spare part, than a special case of it. Maybe it'd be better to add an <code>optional&lt;On_Hand&gt;</code> to <code>Spare_Part</code>.</p>\n\n<p>Or, even better, I suspect you want something like</p>\n\n<pre><code>struct On_Hand_Info { int quantity; string location; };\nstd::map&lt;Spare_Part, On_Hand_Info&gt; on_hand;\n</code></pre>\n\n<h3>EDIT</h3>\n\n<p>Seen your last updates, maybe you should do something like:</p>\n\n<pre><code>struct IRetrievalInformation {\n  virtual int getQuantity() const=0;\n};\n\nclass SparePart{\n  string name;\n  double price;\n  std::unique_ptr&lt;IRetrievalInformation&gt; retinfo;\npublic:\n  Spare_Part();\n  string const&amp; getName() const { return name; }\n  double getPrice() const { return price; }\n  IRetrievalInformation const&amp; getRetrievalInformation() const {\n    assert(retinfo);\n    return *retinfo;\n  }\n  IRetrievalInformation&amp; getRetrievalInformation() {\n    return const_cast&lt;IRetrievalInformation&amp;&gt;(\n      const_cast&lt;SparePart const*&gt;(this)-&gt;getRetrievalInformation()\n    );\n  }\n};\n\nclass OnHandRetrieval : public IRetrievalInformation {\n  int quantity;\n  string location;\npublic:\n  On_hand();\n  int getQuantity() const final override { return quantity; }\n};\n</code></pre>\n\n<p>PS: for God's sake, don't use <em>both</em> camelcase and underscores.</p>\n"}], "owner": {"reputation": 79, "user_id": 3144635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Ktlfr.png?s=128&g=1", "display_name": "Adam Payne", "link": "https://stackoverflow.com/users/3144635/adam-payne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1815, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1424279280, "creation_date": 1424274914, "last_edit_date": 1424275760, "question_id": 28587909, "link": "https://stackoverflow.com/questions/28587909/is-it-considered-a-good-practice-to-define-virtual-get-and-set-functions-in-c", "title": "Is it considered a good practice to define virtual get and set functions in C++?", "body": "<p>If I have a simple 2 level class hierarchy as, for instance, this one:</p>\n\n<pre><code>// level 1\nclass Spare_Part{\nprivate:\n    string name;\n    double price;\npublic:\n    Spare_Part();\n    string getName() { return name; }\n    double getPrice() { return price; }\n    virtual int getQuantity() { return -1; }; // may also define it as pure virtual\n};\n//level 2\nclass On_hand : public Spare_Part{\nprivate:\n    int quantity;\n    string location;\npublic:\n    On_hand();\n    int getQuantity(){ return quantity; }\n};\n</code></pre>\n\n<p>I want to have access to the member 'quantity' in the class 'On_hand' using a pointer to the base class 'Spare_part', so I made the 'getQuantity' function a virtual one. The code works fine, however, I have a feeling that I shouldn't have a get/set function (even though a virtual one) to access a member that is defined somewhere down the hierarchy. Is this really considered a bad practice that should be avoided by, for example, redesign of the classes?\nEdit:The whole hierarchy is a little bit more complex. Alongside the 'On_hand' class there is class for parts available through contracted suppliers. The assumption is that I wouldn't be able to know how many parts are available through the suppliers and that is why 'quantity' is not included in the base class.</p>\n"}, {"tags": ["c++", "numpy", "eigen3"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4040789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434a39905d9720f4ceecf0905944a393?s=128&d=identicon&r=PG&f=1", "display_name": "ReedWood", "link": "https://stackoverflow.com/users/4040789/reedwood"}, "edited": false, "score": 0, "creation_date": 1427093081, "post_id": 28988003, "comment_id": 46620175, "body": "Thanks for your answer. I accepted it since I think that, in general, this is a good solution. As I stated in the question, I do not want to change the interface of the function to call. Therefore, my solution is to create the Map I need. This results in waste of memory and cpu time, but compared to the rest of the program it does not matter."}, {"owner": {"reputation": 254, "user_id": 4382376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNAmq.jpg?s=128&g=1", "display_name": "Aperture Laboratories", "link": "https://stackoverflow.com/users/4382376/aperture-laboratories"}, "reply_to_user": {"reputation": 115, "user_id": 4040789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434a39905d9720f4ceecf0905944a393?s=128&d=identicon&r=PG&f=1", "display_name": "ReedWood", "link": "https://stackoverflow.com/users/4040789/reedwood"}, "edited": false, "score": 0, "creation_date": 1427097732, "post_id": 28988003, "comment_id": 46621839, "body": "Thanks! I have thought it some more, and i think i have found another answer that will do exactly what you ask, and not change the function declaration. I will update my answer!"}, {"owner": {"reputation": 427, "user_id": 6216474, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac3955e01aeb169c30a14ded2f0e057b?s=128&d=identicon&r=PG&f=1", "display_name": "NameRakes", "link": "https://stackoverflow.com/users/6216474/namerakes"}, "edited": false, "score": 1, "creation_date": 1479178751, "post_id": 28988003, "comment_id": 68437931, "body": "It&#39;s been 18 months, but SO has so much useful info. Here <code>new (&amp;a)</code> is the placement version, and thus casting from <code>Map</code> to <code>Matrix</code> object implicitly I believe (please correct me if I am wrong). I guess the resizing you are referring to is that <code>a</code> is not the owner of the data, so cannot assign another matrix to it, using say, assignment <code>operator=</code>. I do this by keeping track of ownership of the data - initially <code>a</code> may not own the data, but before assignment, I resize it, when it is NOT the owner or the current size is not correct."}], "owner": {"reputation": 254, "user_id": 4382376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNAmq.jpg?s=128&g=1", "display_name": "Aperture Laboratories", "link": "https://stackoverflow.com/users/4382376/aperture-laboratories"}, "is_accepted": true, "score": 3, "last_activity_date": 1427098591, "last_edit_date": 1427098591, "creation_date": 1426080811, "answer_id": 28988003, "question_id": 28587893, "link": "https://stackoverflow.com/questions/28587893/using-eigenmapeigenmatrixxd-as-function-argument-of-type-eigenmatrixxd/28988003#28988003", "title": "Using Eigen::Map&lt;Eigen::MatrixXd&gt; as function argument of type Eigen::MatrixXd", "body": "<p>Pass it as plain pointer to data, and Eigen::Map it there. Alternatively, use <code>template &lt;typename Derived&gt;</code> and the like, found in <a href=\"http://eigen.tuxfamily.org/dox/TopicFunctionTakingEigenTypes.html\" rel=\"nofollow\">http://eigen.tuxfamily.org/dox/TopicFunctionTakingEigenTypes.html</a> \nMy personal Choice is the first though, as it is better to have code that doesn't expose all the stubbornness of every API you have used. Also, you won't lose compatibility neither with eigen ,nor with any other kind of library that you (or anyone else) may use later. </p>\n\n<p>There is also another trick i found out, which can be used in numerous occasions:</p>\n\n<p><code>Eigen::MatrixXd a;\n//lets assume a data pointer like double* DATA that we want to map\n//Now we do \nnew (&amp;a) Eigen::Map&lt;Eigen::Matrix&lt;Double,Eigen::Dynamic,Eigen::Dynamic&gt;&gt; (DATA,DATA rows,DATA cols);</code></p>\n\n<p>This will do what you ask, without wasting memory. I think it is a cool trick, and <code>a</code> will behave as a matrixXd, but i haven't tested every occasion. <strong>It has no memory copy.</strong> However, you might need to resize <code>a</code> to the right size before assigning. Even so, the compiler will not immediately allocate all memory at the time you request the <code>resize</code> operation, so there won't be big useless memory allocations either!</p>\n\n<blockquote>\n  <p><strong>Be careful! Resizing operations might <em>reallocate</em> the memory used by an eigen matrix!</strong> So, if you ::Map a memory but then you perform an action that resizes the matrix, it might be mapped to a different place in memory.</p>\n</blockquote>\n"}, {"owner": {"reputation": 406, "user_id": 5838189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d833feaf4bcb27f85029427160797c?s=128&d=identicon&r=PG&f=1", "display_name": "KamKam", "link": "https://stackoverflow.com/users/5838189/kamkam"}, "is_accepted": false, "score": 2, "last_activity_date": 1540165666, "last_edit_date": 1540165666, "creation_date": 1540164804, "answer_id": 52920791, "question_id": 28587893, "link": "https://stackoverflow.com/questions/28587893/using-eigenmapeigenmatrixxd-as-function-argument-of-type-eigenmatrixxd/52920791#52920791", "title": "Using Eigen::Map&lt;Eigen::MatrixXd&gt; as function argument of type Eigen::MatrixXd", "body": "<p>For anyone still struggling with the problem of passing an <code>Eigen::Map</code> to a function with signature <code>Eigen::Matrix</code> or vice versa, and found the <code>Eigen::Matrix</code> to <code>Eigen::Map</code> implicit casting trick which @Aperture Laboratories suggested didn't work (in my case this gave runtime errors associated with trying to free already released memory, [Mismatched delete / Invalid delete errors when ran with <code>valgrind</code>]),</p>\n\n<p>I suggest using the <code>Eigen::Ref</code> class for function signatures as suggested in the answer given by @ggael here:\n<a href=\"https://stackoverflow.com/questions/22193538/passing-eigenmaparrayxd-to-a-function-expecting-arrayxd?rq=1\">Passing Eigen::Map&lt;ArrayXd&gt; to a function expecting ArrayXd&amp;</a></p>\n\n<p>and written in the documentation:\n<a href=\"http://eigen.tuxfamily.org/dox/TopicFunctionTakingEigenTypes.html#TopicUsingRefClass\" rel=\"nofollow noreferrer\">http://eigen.tuxfamily.org/dox/TopicFunctionTakingEigenTypes.html#TopicUsingRefClass</a>\nunder the title:</p>\n\n<blockquote>\n  <p>How to write generic, but non-templated function?</p>\n</blockquote>\n\n<p>For example, for the function specified in the question, changing the signature to</p>\n\n<pre><code>void npMatrix(const Eigen::Ref&lt;const Eigen::MatrixXd&gt; &amp; data, Eigen::Ref&lt; Eigen::MatrixXd&gt; result);\n</code></pre>\n\n<p>means passing either <code>Eigen::Map&lt;Eigen::MatrixXd&gt;</code> or<code>Eigen::MatrixXd</code> objects to the function would work seamlessly (see @ggael's answer to <a href=\"https://stackoverflow.com/questions/21132538/correct-usage-of-the-eigenref-class\">Correct usage of the Eigen::Ref&lt;&gt; class</a> for different ways to use Eigen::Ref in function signature).</p>\n\n<p>I appreciate OP said he didn't want to change the function signatures, but in terms of using <code>Eigen::Map</code>s and <code>Eigen::Matrix</code>'s interchangeably I found this the easiest and most robust method.</p>\n"}], "owner": {"reputation": 115, "user_id": 4040789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434a39905d9720f4ceecf0905944a393?s=128&d=identicon&r=PG&f=1", "display_name": "ReedWood", "link": "https://stackoverflow.com/users/4040789/reedwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7905, "favorite_count": 4, "accepted_answer_id": 28988003, "answer_count": 2, "score": 10, "last_activity_date": 1540165666, "creation_date": 1424274870, "last_edit_date": 1424288006, "question_id": 28587893, "link": "https://stackoverflow.com/questions/28587893/using-eigenmapeigenmatrixxd-as-function-argument-of-type-eigenmatrixxd", "title": "Using Eigen::Map&lt;Eigen::MatrixXd&gt; as function argument of type Eigen::MatrixXd", "body": "<p>In short, the question is how to pass a</p>\n\n<pre><code>Eigen::Map&lt;Eigen::MatrixXd&gt;\n</code></pre>\n\n<p>object to a function which expects a</p>\n\n<pre><code>Eigen::MatrixXd\n</code></pre>\n\n<p>object.</p>\n\n<hr>\n\n<p>Longer story:</p>\n\n<p>I have this C++ function declaration</p>\n\n<pre><code>void npMatrix(const Eigen::MatrixXd &amp;data, Eigen::MatrixXd &amp;result);\n</code></pre>\n\n<p>together with this implementation</p>\n\n<pre><code>void npMatrix(const Eigen::MatrixXd &amp;data, Eigen::MatrixXd &amp;result)\n{\n//Just do s.th. with arguments\nstd::cout &lt;&lt; data &lt;&lt; std::endl;\n\nresult(1,1) = -5;\nstd::cout &lt;&lt; result &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>I want to call this function from python using numpy.array as arguments. To this end, I use a wrapper function written in c++</p>\n\n<pre><code>void pyMatrix(const double* p_data, const int dimData[],\n                              double* p_result, const int dimResult[]);\n</code></pre>\n\n<p>which takes a pointer to data, the size of the data array, a pointer to result, and the size of the result array. The data pointer points to a const patch of memory, since data is not to be altered while the patch of memory reserved for result is writeable. The implementation of the function</p>\n\n<pre><code>void pyMatrix(const double *p_data, const int dimData[], double *p_result, const int dimResult[])\n{\nEigen::Map&lt;const Eigen::MatrixXd&gt; dataMap(p_data, dimData[0], dimData[1]);\nEigen::Map&lt;Eigen::MatrixXd&gt; resultMap(p_result, dimResult[0], dimResult[1]);\n\nresultMap(0,0) = 100;\n\nnpMatrix(dataMap, resultMap);\n}\n</code></pre>\n\n<p>defines a Eigen::Map for data and result, respectively. A Eigen::Map allows to access raw memory as a kind of Eigen::Matrix. The dataMap is of type</p>\n\n<pre><code>&lt;const Eigen::MatrixXd&gt;\n</code></pre>\n\n<p>since the associated memory is read only; resultMap in contrast is of type</p>\n\n<pre><code>&lt;Eigen::MatrixXd&gt;\n</code></pre>\n\n<p>since it must we writeable. The line</p>\n\n<pre><code>resultMap(0,0) = 100;\n</code></pre>\n\n<p>shows, that resultMap is in deed writeable. While passing dataMap to the npMatrix() where a const Eigen::MatrixXd is expected works, I could not find a way to pass resultMap in the same way. I am sure, the trouble comes from the fact, that the first argument of npMatrix is const, and the second is not. A possible solution I found is to define</p>\n\n<pre><code>Eigen::MatrixXd resultMatrix = resultMap;\n</code></pre>\n\n<p>and pass this resutlMatrix to npMatrix(). However, I guess, this creates a copy and hence kills the nice memory mapping of Eigen::Map. So my question is.</p>\n\n<p>Is there a way to pass a Eigen:Map to a function which expects a non-const Eigen::MatrixXd instead?</p>\n\n<p>As a side note: I could change npMatrix to expect a Eigen::Map, but since in the real project, functions are already there and tested, I would rather not temper with them.</p>\n\n<p>To complete the question, here is the python file to call pyMatrix()</p>\n\n<pre><code>import ctypes as ct\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Load libfit and define input types\nct.cdll.LoadLibrary(\"/home/wmader/Methods/fdmb-refactor/build/pyinterface/libpyfit.so\")\nlibfit = ct.CDLL(\"libpyfit.so\")\n\nlibfit.pyMatrix.argtypes = [np.ctypeslib.ndpointer(dtype=np.float64, ndim=2),\n                                                     np.ctypeslib.ndpointer(dtype=np.int32, ndim=1),\n                                                     np.ctypeslib.ndpointer(dtype=np.float64, ndim=2, flags='WRITEABLE'),\n                                                     np.ctypeslib.ndpointer(dtype=np.int32, ndim=1)\n                                                     ]\n\ndata = np.array(np.random.randn(10, 2), dtype=np.float64, order='F')\nresult = np.zeros_like(data, dtype=np.float64, order='F')\n\nlibfit.pyMatrix(data, np.array(data.shape, dtype=np.int32),\n                              result, np.array(result.shape, dtype=np.int32))\n</code></pre>\n"}, {"tags": ["c++", "pointers"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1424275095, "post_id": 28587889, "comment_id": 45482835, "body": "Why would you want to switch from using a C++ container? There is no reason to dynamically allocate memory here."}, {"owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1424275220, "post_id": 28587889, "comment_id": 45482920, "body": "it&#39;s for an assignment @crashmstr"}, {"owner": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 0, "creation_date": 1424275304, "post_id": 28587889, "comment_id": 45482981, "body": "Are you wanting to use malloc/free for real memory allocation, or new/delete with a C++ class?"}, {"owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "reply_to_user": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 0, "creation_date": 1424275457, "post_id": 28587889, "comment_id": 45483077, "body": "@user2867342 new/delete, thanks in advance"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "reply_to_user": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 1, "creation_date": 1424275485, "post_id": 28587889, "comment_id": 45483102, "body": "@user2867342 &quot;real memory allocation&quot;? While <code>malloc</code> has uses in C++, <code>new</code> should be used in most cases for <i>any</i> dynamic memory allocations (which should be avoided when possible)."}, {"owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1424275848, "post_id": 28587889, "comment_id": 45483342, "body": "@crashmstr my main problem of understanding is with the file, i have managed to do this with an array."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1424275982, "post_id": 28587889, "comment_id": 45483448, "body": "I&#39;m having a hard time believing that you could write the above code and not know how to do it with a pointer."}, {"owner": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "edited": false, "score": 0, "creation_date": 1424276023, "post_id": 28587889, "comment_id": 45483477, "body": "What do you mean <code>i am struggling with the concept of doing this for a pointer</code> ? What exactly is your question?"}, {"owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1424276557, "post_id": 28587889, "comment_id": 45483873, "body": "@NathanOliver because i understand lists, i can&#39;t seem to allocate the file to a pointer, what i have tried is now in the question."}, {"owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "reply_to_user": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "edited": false, "score": 0, "creation_date": 1424276607, "post_id": 28587889, "comment_id": 45483904, "body": "@AtlasC1 My question is how to allocate the file to a pointer, find the average then delete instead of using a list. What i have tried is now in the question."}], "answers": [{"comments": [{"owner": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "edited": false, "score": 0, "creation_date": 1424276601, "post_id": 28588405, "comment_id": 45483898, "body": "<code>Use a std::vector instead of a list</code> Don&#39;t just blindly use vectors. Each container type has its strengths and weaknesses, which depend on the context of the problem you&#39;re trying to solve. For example, the complexity of insertion and removal operations is linear in distance to the end of the vector <i>O(n)</i>, whereas it is constant in a list <i>O(1)</i>."}, {"owner": {"reputation": 201, "user_id": 4548299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ulKeb.png?s=128&g=1", "display_name": "Philip Wardlaw", "link": "https://stackoverflow.com/users/4548299/philip-wardlaw"}, "reply_to_user": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "edited": false, "score": 0, "creation_date": 1424282695, "post_id": 28588405, "comment_id": 45487875, "body": "Good point. I checked it out and list elements are also on the heap."}], "owner": {"reputation": 201, "user_id": 4548299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ulKeb.png?s=128&g=1", "display_name": "Philip Wardlaw", "link": "https://stackoverflow.com/users/4548299/philip-wardlaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1424282834, "last_edit_date": 1495540614, "creation_date": 1424276336, "answer_id": 28588405, "question_id": 28587889, "link": "https://stackoverflow.com/questions/28587889/using-a-pointer-to-dynamically-allocate-storage-for-the-numbers-from-file-c/28588405#28588405", "title": "using a pointer to dynamically allocate storage for the numbers from file C++", "body": "<p>Using C++ containers you need not worry about memory allocation. List elements are stored on the HEAP. This is essentially what you would be trying to achieve by using a pointer.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/8882442/list-and-list-elements-where-are-stored\">List and list elements, where are stored?</a>, <a href=\"https://stackoverflow.com/questions/8036474/allocating-vectors-memory-on-heap-or-stack\">When vectors are allocated, do they use memory on the heap or the stack?</a> for more info.</p>\n\n<p>If you still want to use pointers I would recommend using shared pointers <a href=\"http://en.cppreference.com/w/cpp/memory/shared_ptr\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/memory/shared_ptr</a>, or another std smart pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "edited": false, "score": 0, "creation_date": 1424278240, "post_id": 28588979, "comment_id": 45485000, "body": "ah right, yeah i&#39;m starting to grasp that more. One question, how would i open my file to then do this with the pointer as thats the bit i&#39;m struggling with."}, {"owner": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "reply_to_user": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "edited": false, "score": 0, "creation_date": 1424278623, "post_id": 28588979, "comment_id": 45485267, "body": "@louiej15 You already know that part :) You don&#39;t need to change anything there; <code>std::ifstream in(&quot;numbers.txt&quot;);</code> is all you need. I&#39;ve updated my answer with this."}, {"owner": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 0, "creation_date": 1424279318, "post_id": 28588979, "comment_id": 45485763, "body": "AtlasC1 has the answer, although for extra brownie points, you should always check that numElements is not zero before doing the divide."}], "owner": {"reputation": 1605, "user_id": 1339615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6MHBM.png?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/1339615/julian"}, "is_accepted": true, "score": 2, "last_activity_date": 1426003103, "last_edit_date": 1426003103, "creation_date": 1424277813, "answer_id": 28588979, "question_id": 28587889, "link": "https://stackoverflow.com/questions/28587889/using-a-pointer-to-dynamically-allocate-storage-for-the-numbers-from-file-c/28588979#28588979", "title": "using a pointer to dynamically allocate storage for the numbers from file C++", "body": "<p>The main problem you need to overcome is to determine how much memory to allocate to hold all of your doubles. There a few ways you can do this:</p>\n\n<p>The \"easiest\" way would be to do something naive, like reading the file once fully to get the number of doubles, then reading the file again to actually store the values in the the array:</p>\n\n<pre><code>std::ifstream in(\"numbers.txt\");\nunsigned int numElements = 0;\n\n// Read the file once to determine how many elements it contains\ndouble discard;\nwhile (in &gt;&gt; discard) {\n    numElements++;\n}\n\n// Go back to the beginning of file\nin.clear() ;\nin.seekg(0, std::ios::beg);\n\n// Allocate array and read file contents into it\ndouble* data = new double[numElements];\nfor ( int i = 0; i &lt; numElements &amp;&amp; is &gt;&gt; data[i]; i++ );\n\n// Calculate the sum and average\ndouble sum = 0;\nfor ( int i = 0; i &lt; numElements; i++ ) {\n    sum += data[i];\n}\n\ndouble average = sum / numElements;\n\n// Free the dynanmically allocated memory\ndelete[] data;\n</code></pre>\n\n<p>It's pretty inefficient to read a file twice; and there are other ways to obtain the size beforehand. For example you could have a convention in your input file to include the number of elements as the first value before the data:</p>\n\n<pre><code>[infile.txt]\n5 1.0 2.0 3.0 4.0 5.0\n</code></pre>\n\n<p>Now you can read the first value from the file, and you'll know that the rest of this file contains 5 doubles. Allocate your array with new (similar to above example), then continue to read the rest of the file into it.</p>\n\n<p>Another alternative would be to do what <code>std::vector</code> does, which is begin by allocating enough memory in your array for 1 element. If you need to add another element, and the array is already full, re-allocate your array with twice as much memory and copy/move your old elements over to it. Repeat as necessary.</p>\n"}], "owner": {"reputation": 61, "user_id": 4580324, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f30f9ec1bdda8f6b18cbca047a1554b?s=128&d=identicon&r=PG&f=1", "display_name": "louiej15", "link": "https://stackoverflow.com/users/4580324/louiej15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 28588979, "answer_count": 2, "score": 1, "last_activity_date": 1426003103, "creation_date": 1424274858, "last_edit_date": 1424282757, "question_id": 28587889, "link": "https://stackoverflow.com/questions/28587889/using-a-pointer-to-dynamically-allocate-storage-for-the-numbers-from-file-c", "title": "using a pointer to dynamically allocate storage for the numbers from file C++", "body": "<p>I am wanting to allocate storage for numbers from a file instead of storing them in a list and then finding the mean of the number. I have done this for a list below but i am struggling with the concept of doing this for a pointer. Any help is appreciated.</p>\n"}, {"tags": ["c++", "c", "curl", "libcurl", "ntlm"], "answers": [{"owner": {"reputation": 381, "user_id": 3410377, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MGgp0.png?s=128&g=1", "display_name": "Razlo3p", "link": "https://stackoverflow.com/users/3410377/razlo3p"}, "is_accepted": true, "score": 0, "last_activity_date": 1453972763, "creation_date": 1453972763, "answer_id": 35057359, "question_id": 28587817, "link": "https://stackoverflow.com/questions/28587817/error-http-407-using-libcurl-and-ntml/35057359#35057359", "title": "Error http 407 using libcurl and ntml", "body": "<p>Solved: i was missing this instruction</p>\n\n<pre><code>curl_easy_setopt(ctx, CURLOPT_PROXYUSERPWD, \":\");\n</code></pre>\n\n<p>This (i think) tell curl to use Username an Password retrieved from SO passing througt ntlm auth</p>\n"}], "owner": {"reputation": 381, "user_id": 3410377, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MGgp0.png?s=128&g=1", "display_name": "Razlo3p", "link": "https://stackoverflow.com/users/3410377/razlo3p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 1, "accepted_answer_id": 35057359, "answer_count": 1, "score": 0, "last_activity_date": 1453972763, "creation_date": 1424274685, "last_edit_date": 1424293397, "question_id": 28587817, "link": "https://stackoverflow.com/questions/28587817/error-http-407-using-libcurl-and-ntml", "title": "Error http 407 using libcurl and ntml", "body": "<p>i'm developing a small application.\nFor testing purpouse i'm tryng to \"ping\" google using libcurl while behind an ntlm proxy.\nThis is my c++ code:</p>\n\n<pre><code>CURLcode testConnection(void)\n{\n    CURL *curl;\n    CURLcode res = CURLE_OK;\n    res = curl_global_init(CURL_GLOBAL_ALL);\n    curl = curl_easy_init();\n    if (curl)\n    {\n        cout &lt;&lt; \"Url: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_URL, \"http://www.google.com\")) &lt;&lt; \"\\n\";\n        cout &lt;&lt; \"T-out: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_CONNECTTIMEOUT, 3)) &lt;&lt; \"\\n\";\n        cout &lt;&lt; \"No_body: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_NOBODY, true)) &lt;&lt; \"\\n\";\n        cout &lt;&lt; \"Proxy Url: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_PROXY, \"proxyrm.wind.root.it\")) &lt;&lt; \"\\n\";\n        cout &lt;&lt; \"Proxy Port: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_PROXYPORT, 8080)) &lt;&lt; \"\\n\";\n        cout &lt;&lt; \"Ntml: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_HTTPAUTH, CURLAUTH_NTLM)) &lt;&lt; \"\\n\";\n        cout &lt;&lt; \"Verbose: \" &lt;&lt; curl_easy_strerror(curl_easy_setopt(curl, CURLOPT_VERBOSE, true)) &lt;&lt; \"\\n\";\n\n        res = curl_easy_perform(curl);\n        curl_easy_cleanup(curl);\n    }\n    else\n        res = CURLE_FAILED_INIT;\n    curl_global_cleanup();\n    return res;\n}\n</code></pre>\n\n<p>All thi went good, since the verbose output is the following.</p>\n\n<pre><code>Url: No error\nT-out: No error\nNo_body: No error\nProxy Url: No error\nProxy Port: No error\nNtml: No error\nVerbose: No error\n* About to connect() to proxy myroxy  port 8080 (#0)\n*   Trying IP...\n* Connected to myroxy   (IP) port 8080 (#0)\n&gt; HEAD http://www.google.com HTTP/1.1\nHost: www.google.com\nAccept: */*\nProxy-Connection: Keep-Alive\n\n&lt; HTTP/1.1 407 Proxy Authentication Required\n&lt; Proxy-Authenticate: NTLM\n&lt; Proxy-Authenticate: BASIC realm=\"windroot\"\n&lt; Cache-Control: no-cache\n&lt; Pragma: no-cache\n&lt; Content-Type: text/html; charset=utf-8\n* HTTP/1.1 proxy connection set close!\n&lt; Proxy-Connection: close\n&lt; Set-Cookie: BCSI-CS-602d36a7505d346e=2; Path=/\n&lt; Connection: close\n&lt; Content-Length: 989\n&lt;\n* Closing connection 0\n\nCurl Final: No error\n</code></pre>\n\n<p>But, if i try to ping <a href=\"https://google.com\" rel=\"nofollow\">https://google.com</a> the result become this</p>\n\n<pre><code>Url: No error\nT-out: No error\nNo_body: No error\nProxy Url: No error\nProxy Port: No error\nNtml: No error\nNtml: No error\nNtml: No error\nVerbose: No error\n* About to connect() to proxy myroxy port 8080 (#0\n*   Trying IP...\n* Connected to myroxy  (IP) port 8080 (#0)\n* Establish HTTP proxy tunnel to www.google.com:443\n&gt; CONNECT www.google.com:443 HTTP/1.1\nHost: www.google.com:443\nProxy-Connection: Keep-Alive\n\n&lt; HTTP/1.1 407 Proxy Authentication Required\n&lt; Proxy-Authenticate: NTLM\n&lt; Proxy-Authenticate: BASIC realm=\"windroot\"\n&lt; Cache-Control: no-cache\n&lt; Pragma: no-cache\n&lt; Content-Type: text/html; charset=utf-8\n&lt; Proxy-Connection: close\n&lt; Set-Cookie: BCSI-CS-602d36a7505d346e=2; Path=/\n&lt; Connection: close\n&lt; Content-Length: 1135\n&lt;\n* Ignore 1135 bytes of response-body\n* Received HTTP code 407 from proxy after CONNECT\n* Connection #0 to host myroxy left intact\n\nCurl Final: Failure when receiving data from the peer\n</code></pre>\n\n<p>Using curl in command line allow me to ping https (i have to specify the -k argument) but i don't know if this is really relevant. Someone can help me to figure out what's happening? And how to avoid that?</p>\n"}, {"tags": ["c++", "linux", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1424276726, "post_id": 28587643, "comment_id": 45483998, "body": "Works for me, but it may be window manager dependent (or even compositing). Anyway, your <code>if(resizeDone)</code> looks like a better place to do actual resizing; event handling should just raise flag that resize needs to be performed."}, {"owner": {"reputation": 491, "user_id": 3012194, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0fa3858dbb269cc422e5e5ff251686e4?s=128&d=identicon&r=PG&f=1", "display_name": "Scam", "link": "https://stackoverflow.com/users/3012194/scam"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1424287021, "post_id": 28587643, "comment_id": 45490473, "body": "@keltar: with what system did you test this? Anyway, thanks for the suggestion, I try this with other window managers. The <code>if (resizeDone)</code> is indeed a better place for resizing, but with my current setup the window is not resized to correct aspect ratio if the call is done from there."}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 3012194, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0fa3858dbb269cc422e5e5ff251686e4?s=128&d=identicon&r=PG&f=1", "display_name": "Scam", "link": "https://stackoverflow.com/users/3012194/scam"}, "edited": false, "score": 0, "creation_date": 1424329873, "post_id": 28600312, "comment_id": 45506678, "body": "I quickly tested some window managers with the example code. GNOME and XFCE do not work correctly, Unity works."}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "reply_to_user": {"reputation": 491, "user_id": 3012194, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0fa3858dbb269cc422e5e5ff251686e4?s=128&d=identicon&r=PG&f=1", "display_name": "Scam", "link": "https://stackoverflow.com/users/3012194/scam"}, "edited": false, "score": 0, "creation_date": 1424330662, "post_id": 28600312, "comment_id": 45507002, "body": "Yeah my initial test was with openbox."}, {"owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "edited": false, "score": 0, "creation_date": 1508046885, "post_id": 28600312, "comment_id": 80450093, "body": "Is there an example somewhere ?"}], "owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "is_accepted": true, "score": 2, "last_activity_date": 1424328979, "creation_date": 1424328979, "answer_id": 28600312, "question_id": 28587643, "link": "https://stackoverflow.com/questions/28587643/sdl2-how-to-keep-aspect-ratio-when-resizing-the-window/28600312#28600312", "title": "SDL2: How to keep aspect ratio when resizing the window", "body": "<p>Some window managers seems to ignore resize requests made while WM itself resizes window (e.g. while mouse button held). On contrary, <code>SDL_GetWindowSize</code> returns cached values, which in that specific case sometimes happens to be wrong.</p>\n\n<p>I see no platform-independent way to achieve that, other than constantly calling <code>SDL_SetWindowSize</code> on each frame, just in case. It could be achieved using platform-specific APIs, though (like <code>SDL_GetWindowSysWMInfo</code> and then using Xlib).</p>\n"}, {"owner": {"reputation": 12674, "user_id": 35440, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/VAkMs.png?s=128&g=1", "display_name": "Tomas Andrle", "link": "https://stackoverflow.com/users/35440/tomas-andrle"}, "is_accepted": false, "score": 1, "last_activity_date": 1571731118, "creation_date": 1571731118, "answer_id": 58499572, "question_id": 28587643, "link": "https://stackoverflow.com/questions/28587643/sdl2-how-to-keep-aspect-ratio-when-resizing-the-window/58499572#58499572", "title": "SDL2: How to keep aspect ratio when resizing the window", "body": "<p>On <strong>macOS</strong>, I have solved it like this:</p>\n\n<p>cocoa.m:</p>\n\n<pre><code>#import &lt;Cocoa/Cocoa.h&gt;\n\nvoid SetWindowRatio(void *window) {\n    NSWindow *win = (__bridge NSWindow*) window;\n    win.aspectRatio = NSMakeSize( 1280, 720 );\n}\n</code></pre>\n\n<p>main.cpp:</p>\n\n<pre><code>#include &lt;SDL.h&gt;\n#include &lt;SDL_syswm.h&gt;\n\nextern \"C\" void SetWindowRatio(void *window);\n\n// and later..\n\nSDL_SysWMinfo wmInfo;\nSDL_VERSION(&amp;wmInfo.version);\nSDL_GetWindowWMInfo(sdl.window, &amp;wmInfo);\nSetWindowRatio(wmInfo.info.cocoa.window);\n</code></pre>\n\n<p>Perhaps something similar could be done on Linux, only access different part of wmInfo.info. and call the native function?</p>\n"}], "owner": {"reputation": 491, "user_id": 3012194, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0fa3858dbb269cc422e5e5ff251686e4?s=128&d=identicon&r=PG&f=1", "display_name": "Scam", "link": "https://stackoverflow.com/users/3012194/scam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4305, "favorite_count": 2, "accepted_answer_id": 28600312, "answer_count": 2, "score": 5, "last_activity_date": 1571731118, "creation_date": 1424274300, "question_id": 28587643, "link": "https://stackoverflow.com/questions/28587643/sdl2-how-to-keep-aspect-ratio-when-resizing-the-window", "title": "SDL2: How to keep aspect ratio when resizing the window", "body": "<p>I am trying to create a SDL window which keeps its aspect ratio when resize event happens. If user widens the window, the height is increased and vice versa. I catch the SDL_WINDOWEVENT_RESIZED event, calculate new width or height which maintains the aspect ratio and then call SDL_SetWindowSize() with calculated values.</p>\n\n<p>The problem is that calling the SDL_SetWindowSize() function inside the event polling loop does nothing on the screen. SDL does update the window size variables (calling SDL_GetWindowSize() in my main loop returns the updated window dimensions). However, the actual window is not updated.</p>\n\n<p>The only way I can get this to work is to call constantly SDL_SetWindowSize() in the main loop, but I think that is the wrong way of doing things. The code below illustrates my problem. Is there a better and cleaner way to get this to work?</p>\n\n<p>I am using SDL 2.0.3 and 64-bit Ubuntu Linux with GNOME desktop.</p>\n\n<pre><code>#include &lt;SDL2/SDL.h&gt;\n\nstatic const float ASPECT_RATIO = 16.f/9.f;\n\nSDL_Window* window;\nSDL_Renderer* renderer;\n\nuint32_t windowID;\nSDL_Rect screen;\nbool done = false;\nbool resizeDone = false;\n\nvoid handle_events()\n{\n    SDL_Event e;\n    while (SDL_PollEvent(&amp;e)) {\n        switch (e.type) {\n\n        case SDL_WINDOWEVENT: \n            if(e.window.windowID == windowID) {\n                switch(e.window.event) {\n                    case SDL_WINDOWEVENT_RESIZED: { \n                        int width = e.window.data1;\n                        int height = e.window.data2;\n                        float aspectRatio = (float)width/(float)height;\n\n                        if(aspectRatio != ASPECT_RATIO) {\n                            if(aspectRatio &gt; ASPECT_RATIO) {\n                                height = (1.f / ASPECT_RATIO) * width; \n                            }\n                            else {\n                                width = ASPECT_RATIO * height; \n                            }\n\n                            printf(\"Setting window size to %d, %d, aspect ratio: %f\\n\", \n                                width, height, (float)width/(float)height);\n                    }\n                    screen.w = width;\n                    screen.h = height; \n\n                    SDL_SetWindowSize(window, width, height); // &lt;-- does not work\n                    resizeDone = true;\n                    break;\n                    }\n                }\n             }\n             break;\n\n        case SDL_QUIT:\n            done = true;\n            break;\n\n        default:\n            break;\n        }\n    }   \n}\n\nvoid run() {\n    while(!done) {\n        //SDL_SetWindowSize(window, screen.w, screen.h); // &lt;-- works\n        handle_events();\n        SDL_RenderClear(renderer);\n        SDL_RenderPresent(renderer);\n\n        if(resizeDone) {\n            int w, h;\n            SDL_GetWindowSize(window, &amp;w, &amp;h);\n            printf(\"SDL_GetWindowSize: %d, %d\\n\", w, h);\n            resizeDone = false;\n        }\n    }\n}\n\nint main(int, char**) {\n    SDL_Init(SDL_INIT_VIDEO);\n    uint32_t window_flags = SDL_WINDOW_SHOWN | SDL_WINDOW_ALLOW_HIGHDPI | SDL_WINDOW_RESIZABLE;\n    window = SDL_CreateWindow(\"Test\", SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED, 1280, 720, window_flags);\n    windowID = SDL_GetWindowID(window);\n    renderer = SDL_CreateRenderer(window, -1, 0);\n    SDL_SetRenderDrawColor(renderer, 255, 0, 0, 255);\n    run();\n    SDL_Quit();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "operator-overloading", "template-classes"], "comments": [{"owner": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1424274304, "post_id": 28587514, "comment_id": 45482258, "body": "It&#39;s a dependent name, so not treated as a type name unless you say <code>typename Array&lt;T&gt;::value_type</code>."}, {"owner": {"reputation": 11, "user_id": 2448718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/335d86468bca8ab6dacb8f7ae0576845?s=128&d=identicon&r=PG", "display_name": "Adam Gabry\u015b", "link": "https://stackoverflow.com/users/2448718/adam-gabry%c5%9b"}, "reply_to_user": {"reputation": 234649, "user_id": 204847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf6da0eaa5db9219d7a731c7daf9c9e?s=128&d=identicon&r=PG", "display_name": "Mike Seymour", "link": "https://stackoverflow.com/users/204847/mike-seymour"}, "edited": false, "score": 0, "creation_date": 1424437663, "post_id": 28587514, "comment_id": 45559592, "body": "That&#39;s right now I understand thanks a lot :)"}], "owner": {"reputation": 11, "user_id": 2448718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/335d86468bca8ab6dacb8f7ae0576845?s=128&d=identicon&r=PG", "display_name": "Adam Gabry\u015b", "link": "https://stackoverflow.com/users/2448718/adam-gabry%c5%9b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1424274272, "answer_count": 0, "score": 0, "last_activity_date": 1424274300, "creation_date": 1424273977, "last_edit_date": 1424274300, "question_id": 28587514, "link": "https://stackoverflow.com/questions/28587514/overloaded-operator-of-normal-class-nested-in-template-class-defined-outside-c", "closed_reason": "Duplicate", "title": "overloaded operator% of normal class nested in template class, defined outside classes", "body": "<p>I have problem with defining operator% outside my template class. I solved this problem doing it inside, but I would like to know why it doesn't work the other way.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>namespace std{\n    class vector{};class deque{};class list{};class multiset{};class set{}; class map{}; class multimap{};\n};\n\n//---------------------------------------\n\nnamespace oop{\n    template&lt;typename T&gt; class Array{\n        public:\n            class value_type{\n                public:\n                    value_type(T val):_val(val){};\n                    T _val;\n            };\n            Array(int size);\n            Array&amp; insert(T ob);\n            virtual ~Array(){delete [] _arr;};\n            static unsigned int _inserted;\n            T&amp; operator[](int i){return _arr[i];};\n            Array&amp; operator%(const value_type&amp; right){this-&gt;insert(right._val);Array&amp; ref=*this; return ref;};  // inside class it works fine\n            unsigned int operator~(){return _inserted;}\n        private:\n            T* _arr;\n            int _size;\n    };\n\n    template&lt;typename T&gt; unsigned int Array&lt;T&gt;::_inserted=0;\n\n    template&lt;typename T&gt; Array&lt;T&gt;::Array(int size){\n        _size=size;\n        _arr=new T[size];\n    }\n\n    template&lt;typename T&gt; Array&lt;T&gt;&amp; Array&lt;T&gt;::insert(T ob){\n        _arr[Array&lt;T&gt;::_inserted]=ob;\n        Array&lt;T&gt;::_inserted++;\n        Array&lt;T&gt;&amp; ref=*this;\n        return ref;\n    }\n\n// But outside it throws an error during compilation: \"'oop::Array&lt;T&gt;::value_type' is not a type\"\n//\n//              |\n//              v\n//\n//  template&lt;typename T&gt; Array&lt;T&gt;&amp; operator%(Array&lt;T&gt;&amp; left, Array&lt;T&gt;::value_type &amp; right){\n//      left.insert(right._val);                                \n//      return left;\n//  }\n};\n\n//---------------------------------------\n\n#include&lt;cstdlib&gt;\n#include&lt;iostream&gt;\n\n//---------------------------------------\n\nint main(){\n    typedef oop::Array&lt;char&gt; type; \n    type a(rand()%10+5);\n    a.insert('#').insert('C')%type::value_type('P')%type::value_type('P')%'&amp;';\n    for(unsigned int i=0; i!=~a; ++i)\n        std::cout&lt;&lt;i&lt;&lt;\":\"&lt;&lt;a[i]&lt;&lt;((i+1)!=~a?\" \":\"\\n\");\n    return 0;\n}\n//output: 0:# 1:C 2:P 3:P 4:&amp;\n</code></pre>\n\n<p>Compiler seems to treat type_value like something else than type, why does he?</p>\n"}, {"tags": ["c++", "opengl", "qt4", "qtopengl"], "comments": [{"owner": {"reputation": 49036, "user_id": 3530129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IYkz8.jpg?s=128&g=1", "display_name": "Reto Koradi", "link": "https://stackoverflow.com/users/3530129/reto-koradi"}, "edited": false, "score": 1, "creation_date": 1424277943, "post_id": 28587486, "comment_id": 45484794, "body": "This is all blind guessing without code, but one possibility is that lighting is enabled. Try <code>glDisable(GL_LIGHTING)</code>."}, {"owner": {"reputation": 2599, "user_id": 1259884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVyHk.jpg?s=128&g=1", "display_name": "Adri C.S.", "link": "https://stackoverflow.com/users/1259884/adri-c-s"}, "reply_to_user": {"reputation": 49036, "user_id": 3530129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IYkz8.jpg?s=128&g=1", "display_name": "Reto Koradi", "link": "https://stackoverflow.com/users/3530129/reto-koradi"}, "edited": false, "score": 0, "creation_date": 1424278599, "post_id": 28587486, "comment_id": 45485249, "body": "@RetoKoradi It didn&#39;t work. As for the code, I wasn&#39;t the one who wrote it, I was just handed it so I don&#39;t really know which parts are important. Should I post the <code>paintGL</code> method (see update)? The method where the textures are created?"}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 1, "creation_date": 1424286766, "post_id": 28587486, "comment_id": 45490323, "body": "Another option might be that texturing is on and set up in a way that ignores the input color. YOu could try disabling <code>GL_TEXTURE_2D</code> (for any texture unit potentially in use)."}, {"owner": {"reputation": 2599, "user_id": 1259884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVyHk.jpg?s=128&g=1", "display_name": "Adri C.S.", "link": "https://stackoverflow.com/users/1259884/adri-c-s"}, "edited": false, "score": 0, "creation_date": 1424296515, "post_id": 28587486, "comment_id": 45495990, "body": "Yeah! That worked. Post an answer, then."}, {"owner": {"reputation": 2599, "user_id": 1259884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVyHk.jpg?s=128&g=1", "display_name": "Adri C.S.", "link": "https://stackoverflow.com/users/1259884/adri-c-s"}, "reply_to_user": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1424342230, "post_id": 28587486, "comment_id": 45513064, "body": "@derhass I don&#39;t know if you&#39;ll read my other comment since I forgot to tag you in it..."}], "answers": [{"comments": [{"owner": {"reputation": 2599, "user_id": 1259884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVyHk.jpg?s=128&g=1", "display_name": "Adri C.S.", "link": "https://stackoverflow.com/users/1259884/adri-c-s"}, "edited": false, "score": 0, "creation_date": 1424364256, "post_id": 28611803, "comment_id": 45527478, "body": "Thanks. Disabling the texture units while drawing the point solved the issue!"}], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 1, "last_activity_date": 1424363821, "creation_date": 1424363821, "answer_id": 28611803, "question_id": 28587486, "link": "https://stackoverflow.com/questions/28587486/point-drawed-over-texture-doesnt-get-the-desired-colour/28611803#28611803", "title": "Point drawed over texture doesn&#39;t get the desired colour", "body": "<p>In the fixed function pipeline, there are many states which could lead to the vertex color beeing completely ignored.</p>\n\n<p>As Reto Koradi pointed out in the comments, when lighting is enabled, the colors have no effect (unless <code>GL_COLOR_MATERIAL</code> is enabled, in which case the color value is used to update the material parameters used for the lighting equation.)</p>\n\n<p>As I pointed out in the comments, another case is texturing. Depending on the <code>GL_TEX_ENV_MODE</code> selected, the fragment's color (as determined by lighting, or directly interpolated from the vertex colors) is modulated by the texture color, or completely replaced. In that case, disabling texturing for every texture unit in use can solve the issue.</p>\n"}], "owner": {"reputation": 2599, "user_id": 1259884, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MVyHk.jpg?s=128&g=1", "display_name": "Adri C.S.", "link": "https://stackoverflow.com/users/1259884/adri-c-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 28611803, "answer_count": 1, "score": -1, "last_activity_date": 1424363821, "creation_date": 1424273903, "last_edit_date": 1424350022, "question_id": 28587486, "link": "https://stackoverflow.com/questions/28587486/point-drawed-over-texture-doesnt-get-the-desired-colour", "title": "Point drawed over texture doesn&#39;t get the desired colour", "body": "<p><strong>Important:</strong> I have to work with the <strong>fixed pipeline</strong> (I have no voice in this matter).</p>\n\n<p>I have to modify some existing <code>OpenGL</code> code (a panoramic picture viewer, where the panorama is split into the six faces of a cube) so we're able to draw lines/points on top of the loaded textures, where the points are the mouse coordinates unprojected to object coordinates.</p>\n\n<p>I wrote a test program with a coloured cube just to try the line painting on top of it:</p>\n\n<p><img src=\"https://i.stack.imgur.com/EiFwB.png\" alt=\"Test program\"></p>\n\n<p>I got this with the code pushing the <em>GL_DEPTH_BUFFER_BIT</em> attribute to the stack, disabling it before painting the points and poping the stack attribute after I have done with the painting.</p>\n\n<p>I tried to use that same approach in the existing application, but I got these results (here, I'm trying only to paint a point):</p>\n\n<p><img src=\"https://i.stack.imgur.com/XoUz2.png\" alt=\"Point over texture, 1\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/FkF6S.png\" alt=\"Point over texture, 2\"></p>\n\n<p>I specified <em>red</em> as the color for the point but, as you can see, it doesn't have the desired one. I thought it might be due to blending and that it might be mixing its color with the underlying texture, so I pushed the <em>GL_BLEND</em> attribute to the stack as well and disabled it before painting, but the point isn't getting the desired color anyway.</p>\n\n<p>What is happening here? Is there a way to \"force\" the pipeline to paint the point red?</p>\n\n<p><strong>initCube() :</strong> this is call before updating the GL scene.</p>\n\n<pre><code> void panoViewer::initCube() {\n    makeCurrent();\n    if(texture){\n        glDisable( texture );\n        textName = 0;\n        texture = 0;\n    }\n\n    glDisable( GL_TEXTURE_GEN_S );\n    glDisable( GL_TEXTURE_GEN_T );\n    glDisable( GL_TEXTURE_GEN_R );\n\n    glFrontFace( GL_CCW );\n    glEnableClientState(GL_VERTEX_ARRAY);\n    glDisableClientState(GL_TEXTURE_COORD_ARRAY);\n    glDisableClientState(GL_NORMAL_ARRAY);\n\n    texture = GL_TEXTURE_CUBE_MAP;\n    textName = texnms[1];\n    glEnableClientState(GL_NORMAL_ARRAY);\n    glTexGenf( GL_S, GL_TEXTURE_GEN_MODE, GL_REFLECTION_MAP );\n    glTexGenf( GL_T, GL_TEXTURE_GEN_MODE, GL_REFLECTION_MAP );\n    glTexGenf( GL_R, GL_TEXTURE_GEN_MODE, GL_REFLECTION_MAP );\n    glEnable( GL_TEXTURE_GEN_S );\n    glEnable( GL_TEXTURE_GEN_T );\n    glEnable( GL_TEXTURE_GEN_R );\n\n    // Add the textures to the cube faces.\n    // ...\n }\n</code></pre>\n\n<p><strong>initializeGL() :</strong></p>\n\n<pre><code> void panoViewer::initializeGL() {\n    qglClearColor(Qt::black);\n    glShadeModel(GL_SMOOTH);\n    glEnable(GL_CULL_FACE);\n    glEnable( GL_DEPTH_TEST );\n\n  // create texture objects\n    glGenTextures( 1, textName );\n    glBindTexture( GL_TEXTURE_CUBE_MAP, textName );\n\n  // find the largest feasible textures\n    maxTex2Dsqr = maxTexSize( GL_PROXY_TEXTURE_2D, max2d, max2d );\n    maxTex2Drec = maxTexSize( GL_PROXY_TEXTURE_2D, max2d, max2d / 2 );\n    maxTexCube = maxTexSize( GL_PROXY_TEXTURE_CUBE_MAP, maxcube, maxcube );\n\n  // constant texture mapping parameters...\n    glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL);\n  // for cube maps...\n    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_R, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\n\n  // enable alpha blending for overlay\n    glEnable (GL_BLEND);\n    glBlendFunc (GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\n\n\n    glEnable(GL_POINT_SMOOTH);\n    glEnable(GL_LINE_SMOOTH);\n    glHint(GL_POINT_SMOOTH_HINT, GL_NICEST);\n    glHint(GL_LINE_SMOOTH_HINT, GL_NICEST);\n    glDisable(GL_LIGHTING);\n\n    // Create display list: dispList\n    // ...\n }\n</code></pre>\n\n<p><strong>paintGL() :</strong></p>\n\n<pre><code> void panoViewer::paintGL() {\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n    if(texture) {\n        glBindTexture(texture, textName);\n        glEnable( texture );\n    }\n\n    glMatrixMode(GL_TEXTURE);\n    glLoadIdentity();\n        glRotated( 180, 0, 1, 0 );   // camera looks at the front of the van\n        glRotated( 180, 0, 0, 1 );   // van's roof points to the sky\n\n    glMatrixMode(GL_PROJECTION);\n    glLoadIdentity();\n\n//    double hFOV, vFOV;    // angular size at sphere center (deg)\n//    double minFOV, maxFOV; // limits on vFOV\n//    double wFOV;  // vert angle at eye (deg) sets magnification\n\n    double  hhnear = Znear * tan( 0.5 * RAD(wFOV) ),\n            hwnear = hhnear * aspectRatio,\n            dxnear = 2 * hwnear * fcompx,\n            dynear = 2 * hhnear * fcompy;\n\n    glFrustum( -(hwnear + dxnear), hwnear - dxnear,\n               -(hhnear + dynear), hhnear - dynear,\n               Znear, Zfar\n              );\n    glRotated( 180, 0, 1, 0 );\n    glTranslated( eyex, eyey, eyez );\n\n    glRotated( tiltAngle, 1, 0, 0 );\n    glRotated( panAngle, 0, 1, 0 );\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n\n    glCallList(dispList);\n\n    glPushAttrib(GL_ENABLE_BIT | GL_DEPTH_BUFFER_BIT);\n        glDisable(GL_BLEND);\n        glDisable(GL_DEPTH_TEST);\n\n        // Paint the point in red\n        // ...\n    glPopAttrib();\n}\n</code></pre>\n\n<p><strong>UPDATE:</strong> I forgot to mention that the code is based in <code>Qt</code>. It uses the <code>QtOpenGL</code> module extensively.</p>\n\n<p><strong>UPDATE #2:</strong> I've added some code.</p>\n"}, {"tags": ["c++", "polymorphism", "dynamic-cast"], "comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1424274542, "post_id": 28587394, "comment_id": 45482438, "body": "The idea of an interface is to expose most of the operations that you need to perform on a particular type. If you find yourself downcasting often, that&#39;s the sign of a bad design. I don&#39;t see anything wrong with the big switch statement."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1424274757, "post_id": 28587394, "comment_id": 45482594, "body": "The very design of that interface&#39;s <code>operator +</code> is suspect. I realize you can&#39;t change it, but it in itself is fundamentally whack. A lhs-const-ref + rhs-const-ref results in a const <i>pointer</i> ??. What fiend came up with that?"}, {"owner": {"reputation": 61, "user_id": 2949070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e58354c479a44f51c4bce933016d7e?s=128&d=identicon&r=PG", "display_name": "Cubox", "link": "https://stackoverflow.com/users/2949070/cubox"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1424275340, "post_id": 28587394, "comment_id": 45483005, "body": "@WhozCraig Just checked the subject, and the interface is right. I may have removed the spaces after the * and &amp;. <code>virtual IOperand const * operator+( IOperand const &amp; rhs ) const = 0;</code> is what I just copied and pasted from the subject."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1424275612, "post_id": 28587394, "comment_id": 45483181, "body": "@Cubox I had little doubt it was correctly posted, which was why I questioned the sanity of the person who contrived it. When I first saw the question I wondered whether the assignment was trying to drive you toward covariant return types, but that isn&#39;t a silver bullet here."}, {"owner": {"reputation": 20275, "user_id": 887836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UmvnY.jpg?s=128&g=1", "display_name": "Alexander Oh", "link": "https://stackoverflow.com/users/887836/alexander-oh"}, "edited": false, "score": 0, "creation_date": 1424277115, "post_id": 28587394, "comment_id": 45484259, "body": "not the answer, but an interface like this: <a href=\"https://github.com/JasonL9000/cppcon14\" rel=\"nofollow noreferrer\">github.com/JasonL9000/cppcon14</a> would make your code probably look a bit nicer"}], "answers": [{"owner": {"reputation": 930, "user_id": 776142, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5d7f290f5c21eea3d32876da2f513e93?s=128&d=identicon&r=PG", "display_name": "Daerst", "link": "https://stackoverflow.com/users/776142/daerst"}, "is_accepted": false, "score": 0, "last_activity_date": 1424276234, "last_edit_date": 1424276234, "creation_date": 1424274662, "answer_id": 28587805, "question_id": 28587394, "link": "https://stackoverflow.com/questions/28587394/best-way-to-downcast-to-right-template-from-abstract-class/28587805#28587805", "title": "Best way to downcast to right template from abstract class", "body": "<blockquote>\n  <p>hitting a wall when I tried to use Operand with T being\n  the enum</p>\n</blockquote>\n\n<p>Templates are evaluated at compile time. The compiler generates code for each type you have used. A dynamic value like <code>op.getType()</code> would require the compiler to <em>create code after you have compiled</em>, which is certainly possible in JIT compiled languages, but not in C++.</p>\n\n<p>I'm afraid there is no 'pretty' solution to your problem. You really need a kind of switch statement as you've shown, and decide your cast based on the value of <code>getType()</code>. Depending on your use cases, virtual functions could help you, e.g. if you would like to know the byte size of <code>T</code></p>\n\n<pre><code>virtual size_t getSizeOf()\n{\n    return sizeof(T);\n}\n</code></pre>\n\n<p>but since you're not allowed to modify <code>IOperand</code>, you're stuck with your solution.</p>\n"}], "owner": {"reputation": 61, "user_id": 2949070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e58354c479a44f51c4bce933016d7e?s=128&d=identicon&r=PG", "display_name": "Cubox", "link": "https://stackoverflow.com/users/2949070/cubox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 660, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1424276234, "creation_date": 1424273616, "question_id": 28587394, "link": "https://stackoverflow.com/questions/28587394/best-way-to-downcast-to-right-template-from-abstract-class", "title": "Best way to downcast to right template from abstract class", "body": "<p>I recently had a C++ assignment, where I was confronted to a problem about polymorphism.</p>\n\n<p>We needed to store values in a templated class, which was inheriting from an abstract interface class.</p>\n\n<pre><code>enum eOperandType {\n    Int8,\n    Int16,\n    Int32,\n    Float,\n    Double\n};\n\nclass IOperand {\npublic:\n    virtual eOperandType getType() const = 0; // Type of the instance\n    virtual IOperand const *operator+(IOperand const &amp;rhs) const = 0;\n    virtual ~IOperand() {}\n};\n\ntemplate&lt;typename T&gt;\nclass Operand : public IOperand {\npublic:\n    Operand(T const &amp;n, eOperandType type);    \n    eOperandType getType() const;    \n    IOperand const *operator+(IOperand const &amp;rhs) const;\n\n    T const value;\n    eOperandType const type;\n};\n</code></pre>\n\n<p>For all the assignment, we were forbidden to edit the IOperand class, but free to use any class we need behind.</p>\n\n<p>Later on the code execution, numbers are instanced and then stored in a container as IOperand*. We then get this list in order to manipulate numbers.</p>\n\n<p>My problem was to find how to downcast the IOperand* into the right Operand type, in order to manipulate it and get it's value.</p>\n\n<p>I tried multiples approaches for a week, looking into all templates behaviour (with hitting a wall when I tried to use <code>Operand&lt;op.getType()&gt;</code> with T being the enum)</p>\n\n<p>My actual design is using a lot of switches:</p>\n\n<pre><code>switch (op.value-&gt;getType()) {\n    case Int8:\n        if (dynamic_cast&lt;Operand&lt;int8_t&gt;*&gt;(op.value.get())-&gt;value != dynamic_cast&lt;Operand&lt;int8_t&gt;*&gt;(stack.front().get())-&gt;value) {\n            throw RuntimeError(\"Assert failed. Whoopsie\");\n        }\n        break;\n    case Int16:\n        if (dynamic_cast&lt;Operand&lt;int16_t&gt;*&gt;(op.value.get())-&gt;value != dynamic_cast&lt;Operand&lt;int16_t&gt;*&gt;(stack.front().get())-&gt;value) {\n            throw RuntimeError(\"Assert failed. Whoopsie\");\n        }\n        break;\n    case Int32:\n        if (dynamic_cast&lt;Operand&lt;int32_t&gt;*&gt;(op.value.get())-&gt;value != dynamic_cast&lt;Operand&lt;int32_t&gt;*&gt;(stack.front().get())-&gt;value) {\n            throw RuntimeError(\"Assert failed. Whoopsie\");\n        }\n        break;\n    case Float:\n        if (dynamic_cast&lt;Operand&lt;float&gt;*&gt;(op.value.get())-&gt;value != dynamic_cast&lt;Operand&lt;float&gt;*&gt;(stack.front().get())-&gt;value) {\n            throw RuntimeError(\"Assert failed. Whoopsie\");\n        }\n        break;\n    case Double:\n        if (dynamic_cast&lt;Operand&lt;double&gt;*&gt;(op.value.get())-&gt;value != dynamic_cast&lt;Operand&lt;double&gt;*&gt;(stack.front().get())-&gt;value) {\n            throw RuntimeError(\"Assert failed. Whoopsie\");\n        }\n        break;\n    default:\n        throw RuntimeError(\"wut\");\n        break;\n}\n</code></pre>\n\n<p>What would be the best clean solution to solve my problem? I need to \"downcast\" my value at multiples places and functions in order to manipulate the value, the assert code here is just an example among many others.</p>\n\n<p>I can here use C++14, but not any external libs.</p>\n"}]