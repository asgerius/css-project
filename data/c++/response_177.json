[{"tags": ["c++", "algorithm", "c++11", "stdvector"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527724925, "post_id": 50614858, "comment_id": 88239568, "body": "Do you have to use a <code>vector</code> of <code>vector</code>s? One contiguous <code>vector</code> and handling the 1D-&gt;2D mapping yourself will make this pretty simple."}, {"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 1, "creation_date": 1527725046, "post_id": 50614858, "comment_id": 88239604, "body": "Are your <code>vector</code>&#39;s sorted? Because then you could probably pull off <code>O(log(n))</code> with a modified binary search. If not you&#39;ll probably be looking at <code>O(n)</code>..."}, {"owner": {"reputation": 145, "user_id": 8959976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0K0qo.jpg?s=128&g=1", "display_name": "Inter Veridium", "link": "https://stackoverflow.com/users/8959976/inter-veridium"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527725378, "post_id": 50614858, "comment_id": 88239689, "body": "@user4581301 Yes. Basically, it should have stored a custom class. I have just presented a case where possible algorithm is implemented. However, I am not sure about workarounds."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1527725398, "post_id": 50614858, "comment_id": 88239694, "body": "If your data is not sorted then obviously you have to scan all elements,"}, {"owner": {"reputation": 145, "user_id": 8959976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0K0qo.jpg?s=128&g=1", "display_name": "Inter Veridium", "link": "https://stackoverflow.com/users/8959976/inter-veridium"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1527725485, "post_id": 50614858, "comment_id": 88239714, "body": "@scohe001 My vector is sorted, yet custom comparator is being used."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1527726257, "post_id": 50614858, "comment_id": 88239876, "body": "If they&#39;re sorted, then isn&#39;t the first element of each vector the lowest in that vector? I assume your global minimum is based on the same comparator."}, {"owner": {"reputation": 145, "user_id": 8959976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0K0qo.jpg?s=128&g=1", "display_name": "Inter Veridium", "link": "https://stackoverflow.com/users/8959976/inter-veridium"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527726999, "post_id": 50614858, "comment_id": 88240032, "body": "@Barmar Not in this case. I think it&#39;s a faulty design from my side, going to rethink it. Yet it would require me to sort everything one more time."}, {"owner": {"reputation": 816, "user_id": 5352221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8451ba1b588ab60305b93c6fa2658c7?s=128&d=identicon&r=PG&f=1", "display_name": "AdvSphere", "link": "https://stackoverflow.com/users/5352221/advsphere"}, "edited": false, "score": 0, "creation_date": 1527727919, "post_id": 50614858, "comment_id": 88240284, "body": "If you have a probability statistical distribution that is not uniform,  you could &quot;guess&quot; a location based on this probability without sorting."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1527731719, "post_id": 50614858, "comment_id": 88241011, "body": "As with most optimization problems, knowing the exact <i>constraints</i> and <i>requirements</i> is important.  Vector-of-vectors is, more often than not, a poor choice of data structure.  It would be important to know why you use this specifically, and if there are other more practical choices that could lead to a better algorithm.  Some have mentioned ensuring the inner vectors are sorted.  Another example would be if you always guarantee a fixed number of elements in each &quot;row&quot;, that opens up other interesting opportunities like organizing your code and data structures to suit SIMD architectures."}], "answers": [{"tags": [], "owner": {"reputation": 229, "user_id": 9869006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/9869006/phil"}, "is_accepted": false, "score": 0, "last_activity_date": 1527731000, "creation_date": 1527731000, "answer_id": 50615492, "question_id": 50614858, "link": "https://stackoverflow.com/questions/50614858/index-of-vector-containing-the-global-minimum/50615492#50615492", "title": "Index of vector containing the global minimum", "body": "<p>Since neither your vectors nor the numbers inside a vector are <strong>sorted</strong>, you have to check every number to be the smallest value.\nThus you get a complexity of <strong>O(n)</strong>.</p>\n\n<p>You can either use iterators like you did or simply use 2 for loops and access the vector with a[i][j] (which should be minor faster because of the missing overhead from iterators).</p>\n\n<p>Also - since you only have unsigned int, you can break as soon as you find 0.</p>\n"}], "owner": {"reputation": 145, "user_id": 8959976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0K0qo.jpg?s=128&g=1", "display_name": "Inter Veridium", "link": "https://stackoverflow.com/users/8959976/inter-veridium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527731000, "creation_date": 1527724701, "last_edit_date": 1527724961, "question_id": 50614858, "link": "https://stackoverflow.com/questions/50614858/index-of-vector-containing-the-global-minimum", "title": "Index of vector containing the global minimum", "body": "<p>Given a vector of vectors, is there an optimal way to determine the index of the vector which holds the global minimum? \nWhat is the complexity in Big-O notation?</p>\n\n<pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nunsigned getMinimumIndex(std::vector&lt;std::vector&lt;unsigned&gt;&gt; const&amp; a) {\n\n  if (!a.size())\n    return 0;\n\n  unsigned ret = 0; unsigned temp; unsigned global = 1 &lt;&lt; 31;\n  for (std::size_t idx = 0; idx &lt; a.size(); ++idx) {\n    if ((temp = *std::min_element(std::begin(a[idx]), std::end(a[idx]))) &lt; global) {\n      global = temp;\n      ret = idx;\n    }\n  }\n  return ret;\n}\n\nint main() {\n  std::vector&lt;std::vector&lt;unsigned&gt;&gt; a = {{2, 4, 6, 8}, {3, 9, 5, 7},\n                                          {3, 4, 4, 3}, {2, 8, 3, 2},\n                                          {4, 4, 4, 0}, {1, 2, 3, 4}};\n  std::cout &lt;&lt; getMinimumIndex(a);  // 4-th vector posseses the value '0'\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1527724816, "post_id": 50614788, "comment_id": 88239535, "body": "How are you dealing with optimization?  -O3?"}, {"owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "edited": false, "score": 0, "creation_date": 1527725039, "post_id": 50614788, "comment_id": 88239601, "body": "How many threads do you expect this code to create ?"}, {"owner": {"reputation": 686, "user_id": 4464567, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9ce21f9e271e8cf89efd4e87b9ef451?s=128&d=identicon&r=PG&f=1", "display_name": "Endi Zhupani", "link": "https://stackoverflow.com/users/4464567/endi-zhupani"}, "edited": false, "score": 0, "creation_date": 1599505404, "post_id": 50614788, "comment_id": 112788836, "body": "did you manage to solve this? I&#39;m facing the same issue..."}], "owner": {"reputation": 299, "user_id": 8569915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a7276f14ba4c0c329b9218809ba947?s=128&d=identicon&r=PG&f=1", "display_name": "Tes", "link": "https://stackoverflow.com/users/8569915/tes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527763412, "creation_date": 1527724154, "last_edit_date": 1527726417, "question_id": 50614788, "link": "https://stackoverflow.com/questions/50614788/why-openmp-based-jacobi-stencil-program-is-slower-than-sequential-version", "title": "Why OpenMP-based Jacobi Stencil program is slower than sequential version", "body": "<p>Can someone tell me why the OpenMP-based Jacobi iteration is so slower than the sequential version?</p>\n\n<pre><code>ITERATION = 100;\nDIM = 4000;\n\n// sequential version takes only ~5 seconds\nfor(size_t i=0; i&lt;ITERATION; ++i) {\n  for(size_t y=1; y&lt;(DIM-1); ++y) {\n    for(int x=(y*DIM)+1; x&lt;(y*DIM) + DIM-1; ++x) {                                                                                              \n      dest[x]=(src[x-DIM]+src[x+DIM]+src[x]+src[x-1]+src[x+1])*0.2;\n    }   \n  }   \n  std::swap(dest, src);\n}\n\n// openmp version takes 7s on 4 cores\nfor(size_t i=0; i&lt;ITERATION; ++i) {\n  #pragma omp parallel for\n  for(size_t y=1; y&lt;(DIM-1); ++y) {\n    for(int x=(y*DIM)+1; x&lt;(y*DIM) + DIM-1; ++x) {\n      dest[x]=(src[x-DIM]+src[x+DIM]+src[x]+src[x-1]+src[x+1])*0.2;\n    }\n  }\n  std::swap(dest, src);\n}\n</code></pre>\n\n<p>I use four threads and compile the program with O2 flag.</p>\n"}, {"tags": ["c++", "c++11", "gcc", "mingw"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527724615, "post_id": 50614721, "comment_id": 88239475, "body": "Hard to say if you misunderstand. What were you expecting? <a href=\"https://ideone.com/4Ps6V0\" rel=\"nofollow noreferrer\">Unable to reproduce either result</a>, by the way. Could be differences in the floating point encoding."}, {"owner": {"reputation": 21, "user_id": 8853166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b163488902e00388ab7c1e860564c6?s=128&d=identicon&r=PG", "display_name": "James Raynard", "link": "https://stackoverflow.com/users/8853166/james-raynard"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1527725201, "post_id": 50614721, "comment_id": 88239646, "body": "I was expecting output that contained a hexadecimal representation of the data. I certainly wasn&#39;t expecting a crash!"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527726564, "post_id": 50614721, "comment_id": 88239934, "body": "That&#39;s reasonable. I don&#39;t have a match for your version of MinGW and I can&#39;t reproduce with GCC6.3, so I can offer you nothing useful."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527737477, "post_id": 50614721, "comment_id": 88242331, "body": "Use MinGW-w64 instead. The old minGW is poorly maintained"}, {"owner": {"reputation": 21, "user_id": 8853166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b163488902e00388ab7c1e860564c6?s=128&d=identicon&r=PG", "display_name": "James Raynard", "link": "https://stackoverflow.com/users/8853166/james-raynard"}, "edited": false, "score": 0, "creation_date": 1527759583, "post_id": 50614721, "comment_id": 88252104, "body": "I am using MinGW-w64."}], "owner": {"reputation": 21, "user_id": 8853166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b163488902e00388ab7c1e860564c6?s=128&d=identicon&r=PG", "display_name": "James Raynard", "link": "https://stackoverflow.com/users/8853166/james-raynard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527724153, "creation_date": 1527723602, "last_edit_date": 1527724153, "question_id": 50614721, "link": "https://stackoverflow.com/questions/50614721/hexfloat-and-mingw", "title": "hexfloat and MinGW?", "body": "<p>the following program crashes when compiled and run in MinGW (it displays the \"a.exe has stopped working\" Windows dialogue):</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    double pi{3.1415926535};\n    cout &lt;&lt; hexfloat &lt;&lt; pi &lt;&lt; endl;\n}\n</code></pre>\n\n<p>The following program produces the output 2e-081:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; hexfloat &lt;&lt; 100.0 &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Have I misunderstood how to use hexfloat?</p>\n\n<p>This is with version 6.3.0-1 of MinGW and gcc 6.3.0, using --std=c++11.</p>\n"}, {"tags": ["c++", "gradient", "autodiff"], "comments": [{"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "reply_to_user": {"reputation": 8101, "user_id": 9199167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BqdLV.jpg?s=128&g=1", "display_name": "Max Vollmer", "link": "https://stackoverflow.com/users/9199167/max-vollmer"}, "edited": false, "score": 1, "creation_date": 1527913633, "post_id": 50614613, "comment_id": 88317395, "body": "I have added the requested code.  Sorry about that!"}, {"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 0, "creation_date": 1528009215, "post_id": 50614613, "comment_id": 88338142, "body": "So far, it looks like multiple levels might be the correct answer (such as in <a href=\"https://coin-or.github.io/CppAD/doc/mul_level.cpp.htm\" rel=\"nofollow noreferrer\">coin-or.github.io/CppAD/doc/mul_level.cpp.htm</a>), but it&#39;s not clear to me how to apply this an arbitrary number of times, which is what I need."}], "answers": [{"comments": [{"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 0, "creation_date": 1528393400, "post_id": 50714835, "comment_id": 88502052, "body": "Thanks for the example.  This almost works - except that you have to know the number of levels of differentiation you want a priori.  Is there a way to take nth order derivatives without having to specify n in advance?"}, {"owner": {"reputation": 828, "user_id": 9784795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paolo Crosetto", "link": "https://stackoverflow.com/users/9784795/paolo-crosetto"}, "reply_to_user": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 1, "creation_date": 1528533600, "post_id": 50714835, "comment_id": 88552272, "body": "I added another snippet in which arbitrary order derivation is computed"}, {"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 0, "creation_date": 1528652709, "post_id": 50714835, "comment_id": 88579236, "body": "Thank you.  I haven&#39;t verified this yet (I hopefully will tomorrow), but I gave you the bounty anyway since I won&#39;t be able to check it until after it ended."}, {"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 0, "creation_date": 1530158341, "post_id": 50714835, "comment_id": 89138308, "body": "Can you explain in a little more depth what each of the components here do?"}, {"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 1, "creation_date": 1530158778, "post_id": 50714835, "comment_id": 89138427, "body": "I believe there are actually bugs in this counstruction, since for order=2, it&#39;s outputting &quot;f&#39;&#39; computed by CppAD = 0&quot;  Which is wrong; it should be 2.0."}, {"owner": {"reputation": 828, "user_id": 9784795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paolo Crosetto", "link": "https://stackoverflow.com/users/9784795/paolo-crosetto"}, "reply_to_user": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 1, "creation_date": 1530197073, "post_id": 50714835, "comment_id": 89159830, "body": "oh right, there was a bug. I was calling Independent(X) and Y[0]=f(X) in the wrong order. I fixed it. I&#39;ll add some extra explanation in a bit.."}, {"owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "edited": false, "score": 0, "creation_date": 1530217425, "post_id": 50714835, "comment_id": 89169689, "body": "Thanks for the quick fix.  One other question though - it is not clear how one would use this code to pass in a value for the dependent vector.  How would one do that?"}], "tags": [], "owner": {"reputation": 828, "user_id": 9784795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Paolo Crosetto", "link": "https://stackoverflow.com/users/9784795/paolo-crosetto"}, "is_accepted": false, "score": 6, "last_activity_date": 1530196951, "last_edit_date": 1530196951, "creation_date": 1528270937, "answer_id": 50714835, "question_id": 50614613, "link": "https://stackoverflow.com/questions/50614613/using-derivatives-as-functions-in-cppad/50714835#50714835", "title": "Using derivatives as functions in CppAD", "body": "<p>If you want to nest functions, you should nest the AD&lt;> as well. You can nest Jacobians as other functions, for instance see the code snippet below, which is computing the double derivative by nesting Jacobian</p>\n\n<pre><code>#include &lt;cstring&gt;\n#include &lt;iostream&gt;      // standard input/output                                                                                                                                                                                      \n#include &lt;vector&gt;        // standard vector                                                                                                                                                                                            \n#include &lt;cppad/cppad.hpp&gt; // the CppAD package http://www.coin-or.org/CppAD/                                                                                                                                                          \n\n// main program                                                                                                                                                                                                                        \nint main(void)\n{     using CppAD::AD;           // use AD as abbreviation for CppAD::AD                                                                                                                                                               \n  using std::vector;         // use vector as abbreviation for std::vector                                                                                                                                                             \n  size_t i;                  // a temporary index                                                                                                                                                                                      \n\n\n  // domain space vector                                                                                                                                                                                                               \n  auto Square = [](auto t){return t*t;};\n  vector&lt; AD&lt;AD&lt;double&gt;&gt; &gt; X(1); // vector of domain space variables                                                                                                                                                                   \n\n  // declare independent variables and start recording operation sequence                                                                                                                                                              \n  CppAD::Independent(X);\n\n  // range space vector                                                                                                                                                                                                                \n  vector&lt; AD&lt;AD&lt;double&gt;&gt; &gt; Y(1); // vector of ranges space variables                                                                                                                                                                   \n  Y[0] = Square(X[0]);      // value during recording of operations                                                                                                                                                                    \n\n  // store operation sequence in f: X -&gt; Y and stop recording                                                                                                                                                                          \n  CppAD::ADFun&lt;AD&lt;double&gt;&gt; f(X, Y);\n\n  // compute derivative using operation sequence stored in f                                                                                                                                                                           \n  vector&lt;AD&lt;double&gt;&gt; jac(1); // Jacobian of f (m by n matrix)                                                                                                                                                                          \n  vector&lt;AD&lt;double&gt;&gt; x(1);       // domain space vector                                                                                                                                                                                \n\n  CppAD::Independent(x);\n  jac  = f.Jacobian(x);      // Jacobian for operation sequence                                                                                                                                                                        \n  CppAD::ADFun&lt;double&gt; f2(x, jac);\n  vector&lt;double&gt; result(1);\n  vector&lt;double&gt; x_res(1);\n  x_res[0]=15.;\n  result=f2.Jacobian(x_res);\n\n  // print the results                                                                                                                                                                                                                 \n  std::cout &lt;&lt; \"f'' computed by CppAD = \" &lt;&lt; result[0] &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>As a side-note, since C++14 or 11 implementing expression templates and automatic differentiation became easier and can be done with much less effort, as shown e.g. in this video towards the end <a href=\"https://www.youtube.com/watch?v=cC9MtflQ_nI\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=cC9MtflQ_nI</a> (sorry for the poor quality). If I had to implement reasonably simple symbolic operations I would start from scratch with modern C++: you can write simpler code, and you get errors that you can understand easily.</p>\n\n<p><strong>Edit:</strong>\nGeneralizing the example to build arbitrary order derivatives can be a template metaprogramming exercice. The snippet below shows it is possible using template recursion</p>\n\n<pre><code>#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cppad/cppad.hpp&gt;\n\nusing CppAD::AD;\nusing std::vector;\n\ntemplate&lt;typename T&gt;\nstruct remove_ad{\n    using type=T;\n};\n\ntemplate&lt;typename T&gt;\nstruct remove_ad&lt;AD&lt;T&gt;&gt;{\n    using type=T;\n};\n\ntemplate&lt;int N&gt;\nstruct derivative{\n    using type = AD&lt;typename derivative&lt;N-1&gt;::type &gt;;\n    static constexpr int order = N;\n};\n\ntemplate&lt;&gt;\nstruct derivative&lt;0&gt;{\n    using type = double;\n    static constexpr int order = 0;\n};\n\ntemplate&lt;typename T&gt;\nstruct Jac{\n    using value_type = typename remove_ad&lt;typename T::type&gt;::type;\n\n    template&lt;typename P, typename Q&gt;\n    auto operator()(P &amp; X, Q &amp; Y){\n\n    CppAD::ADFun&lt;value_type&gt; f(X, Y);\n    vector&lt;value_type&gt; jac(1);\n    vector&lt;value_type&gt; x(1);\n\n    CppAD::Independent(x);\n    jac  = f.Jacobian(x);\n\n    return Jac&lt;derivative&lt;T::order-1&gt;&gt;{}(x, jac);\n    }\n\n};\n\ntemplate&lt;&gt;\nstruct Jac&lt;derivative&lt;1&gt;&gt;{\n    using value_type = derivative&lt;0&gt;::type;\n\n    template&lt;typename P, typename Q&gt;\n    auto operator()(P &amp; x, Q &amp; jac){\n\n    CppAD::ADFun&lt;value_type&gt; f2(x, jac);\n    vector&lt;value_type&gt; res(1);\n    vector&lt;value_type&gt; x_res(1);\n    x_res[0]=15.;\n    return f2.Jacobian(x_res);\n    }\n};\n\nint main(void)\n{\n    constexpr int order=4;\n    auto Square = [](auto t){return t*t;};\n    vector&lt; typename derivative&lt;order&gt;::type &gt; X(1);\n    vector&lt; typename derivative&lt;order&gt;::type &gt; Y(1);\n\n    CppAD::Independent(X);   \n    Y[0] = Square(X[0]);\n    auto result = Jac&lt;derivative&lt;order&gt;&gt;{}(X, Y);\n\n    std::cout &lt;&lt; \"f'' computed by CppAD = \" &lt;&lt; result[0] &lt;&lt; std::endl;\n} \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16677, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1539727958, "post_id": 52844529, "comment_id": 92605433, "body": "Even though this technically answers the question, it would be much improved if it included any relevant code in the answer itself."}], "tags": [], "owner": {"reputation": 11, "user_id": 10515530, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e04a968a61ce5339b1fbd5c91adb6baf?s=128&d=identicon&r=PG", "display_name": "Bradley Bell", "link": "https://stackoverflow.com/users/10515530/bradley-bell"}, "is_accepted": false, "score": 1, "last_activity_date": 1539726873, "creation_date": 1539726873, "answer_id": 52844529, "question_id": 50614613, "link": "https://stackoverflow.com/questions/50614613/using-derivatives-as-functions-in-cppad/52844529#52844529", "title": "Using derivatives as functions in CppAD", "body": "<p>There is a new feature in CppAD that eliminates the need for AD&lt; AD >, see\n<a href=\"https://coin-or.github.io/CppAD/doc/base2ad.cpp.htm\" rel=\"nofollow noreferrer\">https://coin-or.github.io/CppAD/doc/base2ad.cpp.htm</a></p>\n"}], "owner": {"reputation": 1671, "user_id": 650261, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/17b8f98f99b006787b7e42aed572a23b?s=128&d=identicon&r=PG", "display_name": "user650261", "link": "https://stackoverflow.com/users/650261/user650261"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 2, "answer_count": 2, "score": 28, "last_activity_date": 1539726873, "creation_date": 1527722734, "last_edit_date": 1528681959, "question_id": 50614613, "link": "https://stackoverflow.com/questions/50614613/using-derivatives-as-functions-in-cppad", "title": "Using derivatives as functions in CppAD", "body": "<p>I am trying to modify the example <a href=\"https://www.coin-or.org/CppAD/Doc/jacobian.cpp.htm\" rel=\"noreferrer\">here</a>:</p>\n\n<pre><code># include &lt;cppad/cppad.hpp&gt;\nnamespace { // ---------------------------------------------------------\n// define the template function JacobianCases&lt;Vector&gt; in empty namespace\ntemplate &lt;typename Vector&gt;\nbool JacobianCases()\n{     bool ok = true;\n     using CppAD::AD;\n     using CppAD::NearEqual;\n     double eps99 = 99.0 * std::numeric_limits&lt;double&gt;::epsilon();\n     using CppAD::exp;\n     using CppAD::sin;\n     using CppAD::cos;\n\n     // domain space vector\n     size_t n = 2;\n     CPPAD_TESTVECTOR(AD&lt;double&gt;)  X(n);\n     X[0] = 1.;\n     X[1] = 2.;\n\n     // declare independent variables and starting recording\n     CppAD::Independent(X);\n\n     // a calculation between the domain and range values\n     AD&lt;double&gt; Square = X[0] * X[0];\n\n     // range space vector\n     size_t m = 3;\n     CPPAD_TESTVECTOR(AD&lt;double&gt;)  Y(m);\n     Y[0] = Square * exp( X[1] );\n     Y[1] = Square * sin( X[1] );\n     Y[2] = Square * cos( X[1] );\n\n     // create f: X -&gt; Y and stop tape recording\n     CppAD::ADFun&lt;double&gt; f(X, Y);\n\n     // new value for the independent variable vector\n     Vector x(n);\n     x[0] = 2.;\n     x[1] = 1.;\n\n     // compute the derivative at this x\n     Vector jac( m * n );\n     jac = f.Jacobian(x);\n\n     /*\n     F'(x) = [ 2 * x[0] * exp(x[1]) ,  x[0] * x[0] * exp(x[1]) ]\n             [ 2 * x[0] * sin(x[1]) ,  x[0] * x[0] * cos(x[1]) ]\n             [ 2 * x[0] * cos(x[1]) , -x[0] * x[0] * sin(x[i]) ]\n     */\n     ok &amp;=  NearEqual( 2.*x[0]*exp(x[1]), jac[0*n+0], eps99, eps99);\n     ok &amp;=  NearEqual( 2.*x[0]*sin(x[1]), jac[1*n+0], eps99, eps99);\n     ok &amp;=  NearEqual( 2.*x[0]*cos(x[1]), jac[2*n+0], eps99, eps99);\n\n     ok &amp;=  NearEqual( x[0] * x[0] *exp(x[1]), jac[0*n+1], eps99, eps99);\n     ok &amp;=  NearEqual( x[0] * x[0] *cos(x[1]), jac[1*n+1], eps99, eps99);\n     ok &amp;=  NearEqual(-x[0] * x[0] *sin(x[1]), jac[2*n+1], eps99, eps99);\n\n     return ok;\n}\n} // End empty namespace\n# include &lt;vector&gt;\n# include &lt;valarray&gt;\nbool Jacobian(void)\n{     bool ok = true;\n     // Run with Vector equal to three different cases\n     // all of which are Simple Vectors with elements of type double.\n     ok &amp;= JacobianCases&lt; CppAD::vector  &lt;double&gt; &gt;();\n     ok &amp;= JacobianCases&lt; std::vector    &lt;double&gt; &gt;();\n     ok &amp;= JacobianCases&lt; std::valarray  &lt;double&gt; &gt;();\n     return ok;\n}\n</code></pre>\n\n<p>I am trying to modify it in the following way:</p>\n\n<p>Let G be the Jacobian <code>jac</code> that is calculated in this example, in the line:</p>\n\n<pre><code>jac = f.Jacobian(x);\n</code></pre>\n\n<p>and, as in the example, let <code>X</code> be the independent variables.  I would like to construct a new function, <code>H</code>, which is a function of <code>jac</code>, i.e. <code>H(jacobian(X))</code> = something, such that H is autodifferentiable.  An example may be <code>H(X) = jacobian( jacobian(X)[0])</code>, i.e. the jacobian of the first element of <code>jacobian(X)</code> w.r.t <code>X</code> (a second derivative of sorts).</p>\n\n<p>The problem is that <code>jac</code> as written here is of type <code>Vector</code>, which is a parameterized type on a raw <code>double</code>, not an <code>AD&lt;double&gt;</code>.  To my knowledge, this means the output is not autodifferentiable.</p>\n\n<p>I am looking for some advice on if it is possible to use the Jacobian in a larger operation, and take the Jacobian of that larger operation (not unlike any arithmetic operator) or if this is not possible.</p>\n\n<p>EDIT: This has been put up for a bounty once, but I'm putting it up again to see if there's a better solution, because I think this is important.  To be a bit more clear, the elements that the \"correct\" answer needs are:</p>\n\n<p>a) A means of calculating arbitrary order derivatives.</p>\n\n<p>b) An intelligent way of not having to specify the order of derivatives a priori.  If the maximum order derivative must be known at compile time, the order of derivative can't be determined algorithmically.  Further, specifying an enormously large order as in the current answer given will lead to memory allocation issues and, I imagine, performance issues.</p>\n\n<p>c) Abstracting the templating of derivative order away from the end-user.  This is important, because it can be difficult to keep track of the order of derivatives needed.  This is probably something that comes \"for free\" if b) is solved.</p>\n\n<p>If anybody can crack this, it would be an awesome contribution and an extremely useful operation.</p>\n"}, {"tags": ["python", "c++", "dll", "swig", "boost-python"], "comments": [{"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 1, "creation_date": 1527722619, "post_id": 50614576, "comment_id": 88239015, "body": "<code>ctypes</code> <i>can</i> wrap C++ classes, it&#39;s just very ugly. You have to mangle the names manually (or using the appropriate platform API), call constructors and destructors and operators manually, etc."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 0, "creation_date": 1527722857, "post_id": 50614576, "comment_id": 88239073, "body": "Anyway: hopefully the DLL comes with a header file? If so: With a bit of work, you can use cffi to parse the headers and access the DLL directly, but it&#39;s probably not worth trying that, especially if you don&#39;t know C++ and don&#39;t know cffi. SWIG may or may not work. If you already know SWIG, just try it. But if it fails, I wouldn&#39;t try too hard to debug it; I&#39;d fall back to a different solution."}, {"owner": {"reputation": 310996, "user_id": 908494, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7e41acaa8f6a0e0f5a7c645e93add55a?s=128&d=identicon&r=PG", "display_name": "abarnert", "link": "https://stackoverflow.com/users/908494/abarnert"}, "edited": false, "score": 2, "creation_date": 1527722903, "post_id": 50614576, "comment_id": 88239083, "body": "A lot simpler, you can just write your own trivial wrapper around the DLL in C++, and then use Boost.Python or PyCXX or whatever you like best to export a Python module that binds that wrapper, instead of one that binds the original library directly. Or, maybe even simpler, write the wrapper in Cython, which feels a lot more like Python, which you already know."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1527889167, "post_id": 50614576, "comment_id": 88313491, "body": "With SWIG my answer to: <a href=\"https://stackoverflow.com/a/10531844/168175\">stackoverflow.com/a/10531844/168175</a> pretty much applies here, even though you&#39;re talking Python not Java, because the tricky bit is working out what to write in the .i file."}, {"owner": {"reputation": 454, "user_id": 1093967, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f78a2fffe75752b747bdbc41378e78eb?s=128&d=identicon&r=PG", "display_name": "deepyaman", "link": "https://stackoverflow.com/users/1093967/deepyaman"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1527890350, "post_id": 50614576, "comment_id": 88313834, "body": "@Flexo I haven&#39;t looked at SWIG in depth yet, but I don&#39;t see reconstructing the headers as being a challenge. At least for my DLL, Dependency Walker looks like it does a great job of unmangling function signatures."}], "owner": {"reputation": 454, "user_id": 1093967, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f78a2fffe75752b747bdbc41378e78eb?s=128&d=identicon&r=PG", "display_name": "deepyaman", "link": "https://stackoverflow.com/users/1093967/deepyaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527722445, "creation_date": 1527722445, "question_id": 50614576, "link": "https://stackoverflow.com/questions/50614576/is-it-possible-to-wrap-a-c-dll-in-python-without-using-the-underlying-source", "title": "Is it possible to wrap a C++ DLL in Python without using the underlying source?", "body": "<p>I have a C++ DLL that is distributed as part of a free utility. While I have found the source code, it is not distributed publicly, and I have not tried building it (not familiar with C++, code is legacy and sits in an old VCS, etc.). Ideally, I would like to use this DLL from Python without relying on header or source files.</p>\n\n<p>Is this possible using Boost.Python or SWIG (or something else)? If so, can you point me to an example or resources that shows how? I initially tried using <code>ctypes</code>, but I learned that it cannot bind C++ classes. Some Googling suggested these alternatives, but I have yet to see how to do it without having to compile the C++ source from their tutorials.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 21162, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527721978, "post_id": 50614491, "comment_id": 88238878, "body": "First of all <code>*(flow + i*n + j)</code> means that you have missed providing declaration and definition for <code>flow</code>, <code>i</code>, <code>n</code> and <code>j</code>. Please provide some context, without that relevant information, your question too broad."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1527723031, "post_id": 50614491, "comment_id": 88239111, "body": "Strongly strongly STRONGLY recommend grabbing yourself <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">a good book</a> and get familiar with C++ (not to be confused with C) or you will be totally &lt;expletive deleted&gt;ed when the course gets into full swing. A decent Algorithms course is hard enough. Tacking learning C++ at the same time without a good reference onto that is a good way to have to take the course twice."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527723075, "post_id": 50614491, "comment_id": 88239121, "body": "If buying text books and food simultaneously is a problem, as it often is with students, here&#39;s a link to a good stop-gap since you are already familiar with programming: <a href=\"https://isocpp.org/tour\" rel=\"nofollow noreferrer\">isocpp.org/tour</a> . It&#39;s terse, but it&#39;s free."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1527722537, "post_id": 50614550, "comment_id": 88238997, "body": "This is basically treating <code>flow</code> as a pointer to a 2-d array in row-major order, and incrementing <code>flow[i][j]</code>."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1527724358, "post_id": 50614550, "comment_id": 88239417, "body": "Yes, and that&#39;s more of a C-thing to do rather than C++. In C++, you&#39;d probably just overload []."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527749777, "post_id": 50614550, "comment_id": 88246459, "body": "More accurately, the multiplication operator <code>*</code> has highest precedence so <code>i</code> binds to <code>n</code> and <code>i*n</code> is calculated first. From thereon, the <code>+</code> operator has left-to-right associativity,  so <code>flow + i*n</code> is calculated next, the result of the expression being of same pointer type as <code>flow</code>. And then that result <code>+ j</code> is calculated, the result again being of the same pointer type. Meaning that strictly speaking <code>i*n + j</code> is never calculated. Does it matter? Well maybe, <code>i*n+j</code> could in theory give an integer overflow which won&#39;t necessarily happen with pointer arithmetic."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 5, "last_activity_date": 1527758968, "last_edit_date": 1527758968, "creation_date": 1527722203, "answer_id": 50614550, "question_id": 50614491, "link": "https://stackoverflow.com/questions/50614491/what-does-flow-in-j-mean-in-c-i-have-no-idea-what-this-topic-is-called/50614550#50614550", "title": "what does *(flow + i*n + j) mean in C? I have no idea what this topic is called", "body": "<p>It's hard to be sure without more context, but given the expression</p>\n\n<pre><code> *(flow + i*n + j) += minFlowPath;\n</code></pre>\n\n<p>it's likely that <code>flow</code> is a pointer.  The subexpression <code>flow + i*n + j</code> constitutes <em>pointer arithmetic</em>.  Addition of a pointer and an integer yields a new pointer pointing to an element counted beyond the original pointer, so here we're pointing to the element which is <code>i*n + j</code> elements beyond wherever <code>flow</code> points.  (As Barmar points out in a comment, this suggests that <code>flow</code> is being treated as a flattened 2D array, accessing the <code>i,j</code>th element.)</p>\n\n<p>Given any pointer or pointer-valued expression, the unary <code>*</code> operator access the value that the pointer points to.  So</p>\n\n<pre><code> *(flow + i*n + j)\n</code></pre>\n\n<p>is the value which is <code>i*n + j</code> past whatever <code>flow</code> points to.</p>\n\n<p>When you access a pointer using <code>*</code> in this way, you get something called an <em>lvalue</em>, a technical term meaning that you can do more than just fetch the pointed-to value, you can also <em>modify</em> the pointed-to value.  And that's exactly what we do here.  C's <code>+=</code> operator adds to a value, in-place.  So whatever the pointed-to value was, we add the value <code>minFlowPath</code> to it.</p>\n\n<p>To learn more about this, read up on <em>pointer arithmetic</em>, <em>pointer indirection</em>, and <em>assignment operators</em>.</p>\n"}], "owner": {"reputation": 13, "user_id": 3424522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2c383244b37f63873a8dfad35a3977?s=128&d=identicon&r=PG&f=1", "display_name": "user3424522", "link": "https://stackoverflow.com/users/3424522/user3424522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1527740451, "answer_count": 1, "score": -5, "last_activity_date": 1527758968, "creation_date": 1527721679, "last_edit_date": 1527722001, "question_id": 50614491, "link": "https://stackoverflow.com/questions/50614491/what-does-flow-in-j-mean-in-c-i-have-no-idea-what-this-topic-is-called", "closed_reason": "Needs more focus", "title": "what does *(flow + i*n + j) mean in C? I have no idea what this topic is called", "body": "<p>I am new to C and C++ Programming however I saw in my Algorithms class(I transferred from a Java oriented school to a C++ oriented curriculum) that I had no idea what this meant:  </p>\n\n<pre><code>*(flow + i*n + j) += minFlowPath;\n</code></pre>\n\n<p>I am not sure what this pointer thing is called. I want to learn the logic of what that means and what is being stored. Thank you\nPlease redirect me.</p>\n"}, {"tags": ["c++", "winapi", "gdi+"], "comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 6, "creation_date": 1527723325, "post_id": 50614469, "comment_id": 88239188, "body": "You probably have DPI settings at 125%, and you application is not DPI aware. Your window will be stretched and it doesn&#39;t look as sharp."}, {"owner": {"reputation": 620, "user_id": 1824143, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c03128747ba8f3c3e6323614c2273b04?s=128&d=identicon&r=PG", "display_name": "grimgrom", "link": "https://stackoverflow.com/users/1824143/grimgrom"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1527725138, "post_id": 50614469, "comment_id": 88239634, "body": "That&#39;s correct. Getting the result I am looking for when I changed my DPI settings from 125% to 100%. How can I override the DPI settings for my window?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 6, "creation_date": 1527725572, "post_id": 50614469, "comment_id": 88239737, "body": "You have to <a href=\"https://msdn.microsoft.com/en-us/library/ms701681.aspx\" rel=\"nofollow noreferrer\">make your app be DPI-aware</a>, and then scale your drawing accordingly to the current resolution. Also see <a href=\"https://msdn.microsoft.com/library/windows/desktop/mt843498.aspx\" rel=\"nofollow noreferrer\">High DPI desktop application development</a>."}, {"owner": {"reputation": 620, "user_id": 1824143, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c03128747ba8f3c3e6323614c2273b04?s=128&d=identicon&r=PG", "display_name": "grimgrom", "link": "https://stackoverflow.com/users/1824143/grimgrom"}, "edited": false, "score": 0, "creation_date": 1527959009, "post_id": 50614469, "comment_id": 88328382, "body": "This issue has been solved by following the steps mentioned in the MSDN documents linked by Remy Lebeau, thanks."}], "owner": {"reputation": 620, "user_id": 1824143, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c03128747ba8f3c3e6323614c2273b04?s=128&d=identicon&r=PG", "display_name": "grimgrom", "link": "https://stackoverflow.com/users/1824143/grimgrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527723431, "creation_date": 1527721530, "last_edit_date": 1527723431, "question_id": 50614469, "link": "https://stackoverflow.com/questions/50614469/blurry-gdi-textdrawstring", "title": "Blurry GDI+ text(DrawString)", "body": "<p>The output of DrawString is getting very blurry for some reason. I'm looking for the same sharpness as the Windows menus, see attached image as reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LgMPe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LgMPe.png\" alt=\"enter image description here\"></a>\nThe text of top window at is generated by the following code:</p>\n\n<pre><code>Gdiplus::Graphics graphics(m_DeviceContextHandle);\n\nGdiplus::FontFamily nameFontFamily(L\"Segoe UI\");\nGdiplus::Font       font(&amp;nameFontFamily, 9);\nGdiplus::SolidBrush solidbrush(Gdiplus::Color(255, 0, 0, 0));\n\ngraphics.SetCompositingQuality(Gdiplus::CompositingQuality::CompositingQualityAssumeLinear);\ngraphics.SetSmoothingMode(Gdiplus::SmoothingMode::SmoothingModeHighQuality);\ngraphics.SetPixelOffsetMode(Gdiplus::PixelOffsetMode::PixelOffsetModeHighQuality);\ngraphics.SetTextRenderingHint(Gdiplus::TextRenderingHint::TextRenderingHintClearTypeGridFit);\ngraphics.DrawString(L\"File   Edit   Format   View   Help\", -1, &amp;font, Gdiplus::PointF(10, 10), &amp;solidbrush);\n</code></pre>\n\n<p>Any ideas how I can sharpen the text?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here's the result when I draw to a bitmap instead of a window.\nThe first text is from the bitmap output, the last text is from when I draw to a window.\n<a href=\"https://i.stack.imgur.com/8mcNR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8mcNR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>// Draw to bitmap.\nGdiplus::Bitmap b(100, 100);\nGdiplus::Graphics *g = Gdiplus::Graphics::FromImage(&amp;b);\n\n// Draw text.\n// ...\n\n\n// Save bitmap.\nCLSID pngClsid;\nCLSIDFromString(L\"{557cf406-1a04-11d3-9a73-0000f81ef32e}\", &amp;pngClsid);\n\nb.Save(L\"C:\\\\my_path_here\\\\out.png\", &amp;pngClsid, NULL);\n</code></pre>\n\n<p>Any ideas? Incorrect settings of my window?</p>\n"}, {"tags": ["python", "c++", "gcc"], "comments": [{"owner": {"reputation": 541, "user_id": 3822038, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/edb32f7a768bcafce4b72dbcf5dacd5a?s=128&d=identicon&r=PG&f=1", "display_name": "echo", "link": "https://stackoverflow.com/users/3822038/echo"}, "edited": false, "score": 1, "creation_date": 1527720535, "post_id": 50614328, "comment_id": 88238492, "body": "I have PhraseSpotter.a and pyOkHound.cpp in the same directory"}, {"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 0, "creation_date": 1527723910, "post_id": 50614328, "comment_id": 88239330, "body": "Can you cheat and put another <code>gcc</code> on your <code>PATH</code> that\u2019s just a shell script that shows its arguments?"}], "owner": {"reputation": 541, "user_id": 3822038, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/edb32f7a768bcafce4b72dbcf5dacd5a?s=128&d=identicon&r=PG&f=1", "display_name": "echo", "link": "https://stackoverflow.com/users/3822038/echo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527721453, "creation_date": 1527720530, "last_edit_date": 1527721453, "question_id": 50614328, "link": "https://stackoverflow.com/questions/50614328/how-to-convert-python-distutils-core-function-call-extension-to-a-gcc-command", "title": "How to convert python distutils.core function call &quot;extension&quot; to a gcc command", "body": "<p>How to convert python distutils.core function call \"extension\" to a gcc command</p>\n\n<p>So I use a third party python library that uses a script that calls distuils to install the library</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nmodule1 = Extension(\"okhound\",\n                    sources = [\"pyOkHound.cpp\"],\n                    libraries = [\"PhraseSpotter\"],\n                    library_dirs = [\".\"])\n\nsetup(name = \"OkHound\",\n      version = \"1.0\",\n      description = \"'Ok Hound' phrase spotter.\",\n      ext_modules = [module1])\n</code></pre>\n\n<p>Upon some investigation I find out that the result of the script is a output.so file. Since we are using a cross-compiler with make files for our target machine, I am trying to find a way to do what the script does in gcc. \nI have access to the PhraseSpotter.a file and pyOkHound.cpp file and was wondering how to get the output.so file like the above script did?</p>\n\n<p>What is setup doing behind the scene?</p>\n\n<p>Update\nThings I have tried: </p>\n\n<pre><code>gcc -o output -l PhraseSpotter main.o\ngcc -c -fPIC pyOkHound.cpp -o pyOkHound.o\ngcc -shared -o output.so -fPIC pyOkHound.cpp\n</code></pre>\n\n<p>But they do not link the libraries with the source like the extension command did. \nI am not sure how the link the static library to the cpp file. </p>\n"}, {"tags": ["c++", "smart-pointers", "initializer-list"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1527720131, "post_id": 50614244, "comment_id": 88238398, "body": "Perhaps you should worry less about move semantics and unique pointers, and more about writing a useful application in C++. Have you done that yet?"}, {"owner": {"reputation": 391, "user_id": 7302562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da41a3c556c58aaafd9eff747da66a93?s=128&d=identicon&r=PG&f=1", "display_name": "Duke", "link": "https://stackoverflow.com/users/7302562/duke"}, "edited": false, "score": 0, "creation_date": 1527721668, "post_id": 50614244, "comment_id": 88238782, "body": "That&#39;s what I&#39;m trying to do. I want to write a small program to evaluate arithmetic expressions. <code>term</code> is supposed to be an abstract base class for operations, holding a vector of operands (terms themselves), hence the vector of unique_ptr. The derived classes should implement the actual various behaviors of plus, minus, mult etc. Is this a bad way to approach that?"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 7302562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da41a3c556c58aaafd9eff747da66a93?s=128&d=identicon&r=PG&f=1", "display_name": "Duke", "link": "https://stackoverflow.com/users/7302562/duke"}, "edited": false, "score": 0, "creation_date": 1527750618, "post_id": 50614294, "comment_id": 88246902, "body": "Still trying to figure this out... Can you please tell me why you called the function <code>SingletonVector</code>? I don&#39;t see a &quot;singleton&quot; (as I know it) being involved here. I also don&#39;t get why you use <code>std::decay_t</code> - isn&#39;t <code>x</code> an rvalue reference anyway, so decay should not have an effect (according to <a href=\"http://www.cplusplus.com/reference/type_traits/decay\" rel=\"nofollow noreferrer\">the C++ reference</a>)?"}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 391, "user_id": 7302562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da41a3c556c58aaafd9eff747da66a93?s=128&d=identicon&r=PG&f=1", "display_name": "Duke", "link": "https://stackoverflow.com/users/7302562/duke"}, "edited": false, "score": 1, "creation_date": 1527802998, "post_id": 50614294, "comment_id": 88276671, "body": "@Duke a singleton is a set that contains one element. <code>x</code> is a forwarding reference, so <code>T</code> may be deduced to an lvalue reference if an lvalue is passed in. <code>decay_t</code> is used to remove both the reference and any cv-qualifiers that <code>T</code> may carry."}, {"owner": {"reputation": 391, "user_id": 7302562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da41a3c556c58aaafd9eff747da66a93?s=128&d=identicon&r=PG&f=1", "display_name": "Duke", "link": "https://stackoverflow.com/users/7302562/duke"}, "edited": false, "score": 1, "creation_date": 1527836009, "post_id": 50614294, "comment_id": 88285246, "body": "Thanks a lot! And sorry for the stupid questions... C++ is pretty hard when coming from Java... I&#39;m not even sure <code>unique_ptr</code> is the best pointer type for what I want to do. It all seems so clumsy..."}], "tags": [], "owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "is_accepted": true, "score": 3, "last_activity_date": 1527720264, "creation_date": 1527720264, "answer_id": 50614294, "question_id": 50614244, "link": "https://stackoverflow.com/questions/50614244/initialize-a-vector-with-unique-ptr-in-c-within-constructor/50614294#50614294", "title": "Initialize a vector with unique_ptr in C++ within constructor", "body": "<p>You can do this with a helper function template:</p>\n\n<pre><code>template &lt;class T&gt;\nauto SingletonVector(T&amp;&amp; x) {\n    std::vector&lt;std::decay_t&lt;T&gt;&gt; ret;\n    ret.push_back(std::forward&lt;T&gt;(x));\n    return ret;\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>term_array::term_array(std::unique_ptr&lt;term&gt;&amp;&amp; opd) \n: term(SingletonVector(std::move(opd))) {...}\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 7302562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da41a3c556c58aaafd9eff747da66a93?s=128&d=identicon&r=PG&f=1", "display_name": "Duke", "link": "https://stackoverflow.com/users/7302562/duke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1044, "favorite_count": 2, "accepted_answer_id": 50614294, "answer_count": 1, "score": 3, "last_activity_date": 1527720264, "creation_date": 1527719863, "question_id": 50614244, "link": "https://stackoverflow.com/questions/50614244/initialize-a-vector-with-unique-ptr-in-c-within-constructor", "title": "Initialize a vector with unique_ptr in C++ within constructor", "body": "<p>I am new to C++, and after having read A LOT about move semantics and unique pointers (and initializer lists), I get why this code won't work (throwing \"attempting to reference a deleted function\"):</p>\n\n<pre><code>term_array::term_array(std::unique_ptr&lt;term&gt;&amp;&amp; opd) \n    : term(std::vector&lt;std::unique_ptr&lt;term&gt;&gt; {std::move(opd)}) {...}\n</code></pre>\n\n<p>It's a constructor intended to pass a pointer <code>opd</code> (pointing to a <code>term</code> object) on from a derived class <code>term_array</code> to the base class <code>term</code>, where the <code>term</code> constructor expects a <strong>vector</strong> or pointers. Therefore, I tried to create a <code>std::vector&lt;std::unique_ptr&lt;term&gt;&gt;</code> on the fly and fill it with the one <code>opd</code> pointer received from the <code>term_array</code> constructor. Obviously, this doesn't work since a <code>unique_ptr</code> cannot be copied, and the <code>initializer_list</code> initialization won't allow a move operation.</p>\n\n<p>I saw in <a href=\"https://stackoverflow.com/questions/8468774/can-i-list-initialize-a-vector-of-move-only-type\">this question</a> how to \"list-initialize a vector of move-only type\" in regular program flow (meaning when you can use several lines of code). But (how) can this be done within a simple constructor call? Or am I completely off-track?</p>\n"}, {"tags": ["c++", "list", "class", "methods"], "comments": [{"owner": {"reputation": 5867, "user_id": 9125195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75fc90d1f6de6ff28c739b85bdb82f4c?s=128&d=identicon&r=PG&f=1", "display_name": "Sid S", "link": "https://stackoverflow.com/users/9125195/sid-s"}, "edited": false, "score": 5, "creation_date": 1527719700, "post_id": 50614200, "comment_id": 88238271, "body": "Make the list a <code>static</code> member of the class, then append <code>this</code> to it in your class&#39; constructors."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1527720867, "post_id": 50614200, "comment_id": 88238555, "body": "And don&#39;t forget to remove <code>this</code> from the list in the destructor."}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1527721563, "post_id": 50614200, "comment_id": 88238758, "body": "Please don&#39;t do this. I am certain this will be a bad idea."}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 0, "creation_date": 1527723365, "post_id": 50614200, "comment_id": 88239198, "body": "How strong of a requirement is &quot;ever&quot;? Do you also want to know about every temporary object that was created? Are you trying to find a memory leak? I would recommend you rethink your approach to the problem you&#39;re really trying to solve."}], "answers": [{"tags": [], "owner": {"reputation": 2144, "user_id": 9760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ixxpj.jpg?s=128&g=1", "display_name": "Daniel Waechter", "link": "https://stackoverflow.com/users/9760/daniel-waechter"}, "is_accepted": false, "score": 1, "last_activity_date": 1527720914, "creation_date": 1527720914, "answer_id": 50614376, "question_id": 50614200, "link": "https://stackoverflow.com/questions/50614200/how-could-i-create-a-linked-list-of-all-objects-that-were-ever-created-with-that/50614376#50614376", "title": "How could I create a linked list of all objects that were ever created with that class?", "body": "<p>The simplest way would be to use a static list, and modify it from the constructor and destructor. For example:</p>\n\n<pre><code>class A {\n    static std::list&lt;A *&gt; s_instances;\n\npublic:\n    A() { A::s_instances.push_back(this); }\n\n    ~A() { A::s_instances.remove(this); }\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "is_accepted": false, "score": 0, "last_activity_date": 1527721320, "creation_date": 1527721320, "answer_id": 50614433, "question_id": 50614200, "link": "https://stackoverflow.com/questions/50614200/how-could-i-create-a-linked-list-of-all-objects-that-were-ever-created-with-that/50614433#50614433", "title": "How could I create a linked list of all objects that were ever created with that class?", "body": "<p>Here's an example of what Sid S meant:</p>\n\n<p><strong>A.h</strong></p>\n\n<pre><code>class A {\npublic:\n    A(vector&lt;A*&gt;&amp; a_objects_vector) {\n        a_objects_vector.push_back(this);\n    }\n    ~A(vector&lt;A*&gt;&amp; a_objects_vector) {\n        a_objects_vector.remove(this);\n    }\n};\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include \"A.h\"\n\nint main() {\n    vector&lt;A*&gt; all_a_objects;\n    A a(all_a_objects), *a1 = new A(all_a_objects);\n    /*Do your magic here...*/\n    delete a1;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 9747784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LzigCdBIbgc/AAAAAAAAAAI/AAAAAAAAABg/AxQvAnUM0xo/photo.jpg?sz=128", "display_name": "Dinno Koluh", "link": "https://stackoverflow.com/users/9747784/dinno-koluh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527721320, "creation_date": 1527719565, "question_id": 50614200, "link": "https://stackoverflow.com/questions/50614200/how-could-i-create-a-linked-list-of-all-objects-that-were-ever-created-with-that", "title": "How could I create a linked list of all objects that were ever created with that class?", "body": "<p><strong>Hello</strong></p>\n\n<p>I have class A, and that class has constructors, mutator methods, inspector methods and so on. How could I create a linked list of all objects that were ever created with that class (by all objects I mean that a \"new\" object should also be linked as a new one if it is changed by the mutator method). If possible with a small example.</p>\n"}, {"tags": ["c++", "makefile", "header-files", "googletest", "makefile-project"], "comments": [{"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1527776024, "post_id": 50613989, "comment_id": 88262791, "body": "Don&#39;t you want to use CMake instead?"}], "answers": [{"tags": [], "owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "is_accepted": false, "score": 0, "last_activity_date": 1527784120, "creation_date": 1527784120, "answer_id": 50628862, "question_id": 50613989, "link": "https://stackoverflow.com/questions/50613989/how-to-import-all-source-code-and-header-files-from-other-directories-in-makefil/50628862#50628862", "title": "How to import all source code and header files from other directories in Makefile", "body": "<p>You haven't given us <a href=\"https://stackoverflow.com/help/mcve\">enough information to reproduce your problem</a>, but this may be enough:</p>\n\n<pre><code>PROJECT_ROOT := ../../..\n# or you can use an absolute path\n\nOTHER_DIRS := $(addprefix $(PROJECT_ROOT)/, commons/core commons/backends os/core public/os wsi/comp)\n\nVPATH = $(OTHER_DIRS)\nCPPFLAGS += $(addprefix -I, $(OTHER_DIRS))\n</code></pre>\n\n<p>Now you can construct a new test:</p>\n\n<pre><code>something.o : something.cc whatever.h $(GTEST_HEADERS)\n    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $&lt;\n\nsomething_unittest.o : $(USER_DIR)/something_unittest.cc whatever.h $(GTEST_HEADERS)\n    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $&lt;\n\nsomething_unittest : something.o something_unittest.o gtest_main.a\n    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -lpthread $^ -o $@\n</code></pre>\n\n<p>If this doesn't work, we can investigate and adjust. Further refinements are possible, once this much is working.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9872883"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1527784120, "creation_date": 1527718054, "last_edit_date": 1527775577, "question_id": 50613989, "link": "https://stackoverflow.com/questions/50613989/how-to-import-all-source-code-and-header-files-from-other-directories-in-makefil", "title": "How to import all source code and header files from other directories in Makefile", "body": "<p>I am very unfamiliar with makefiles and am trying to figure out how to setup googletest and the makefile in a project. How would one import all source and header files from the project which can be found in other directories, into the makefile build so that I could access the header files within the test files?</p>\n\n<p>The structure looks like this </p>\n\n<pre><code>project_root/\n            commons/core/{lots of files}\n            commons/backends/{lots of files}\n            os/core/{lots of files}\n            public/os/{lots of files}\n            wsi/comp/{lots of files}\n            tests/googletests/[Makefile tests/ include/ src/] # where I am testing from.\n</code></pre>\n\n<p>I would like to have all the .h and .cpp files accessible to files in tests/googletests/tests/ but I am unsure how to do that with the Makefile. </p>\n\n<p>Inside the tests folder I am using the sample1.h, sample1.cc, and sample1_unnitetest.cc to play around with trying to load header files from other places found here: <a href=\"https://github.com/google/googletest/tree/master/googletest/samples\" rel=\"nofollow noreferrer\">https://github.com/google/googletest/tree/master/googletest/samples</a></p>\n\n<p>The makefile i am using is:</p>\n\n<pre><code># A sample Makefile for building Google Test and using it in user\n# tests.  Please tweak it to suit your environment and project.  You\n# may want to move it to your project's root directory.\n#\n# SYNOPSIS:\n#\n#   make [all]  - makes everything.\n#   make TARGET - makes the given target.\n#   make clean  - removes all files generated by make.\n\n# Please tweak the following variable definitions as needed by your\n# project, except GTEST_HEADERS, which you can use in your own targets\n# but shouldn't modify.\n\n# Points to the root of Google Test, relative to where this file is.\n# Remember to tweak this if you move this file.\nGTEST_DIR = .\n\n# Where to find user code.\nUSER_DIR = ./tests\n\n# Flags passed to the preprocessor.\n# Set Google Test's header directory as a system directory, such that\n# the compiler doesn't generate warnings in Google Test headers.\nCPPFLAGS += -isystem $(GTEST_DIR)/include\n\n# Flags passed to the C++ compiler.\nCXXFLAGS += -g -Wall -Wextra -pthread\n\n# All tests produced by this Makefile.  Remember to add new tests you\n# created to the list.\nTESTS = sample1_unittest\n\n# All Google Test headers.  Usually you shouldn't change this\n# definition.\nGTEST_HEADERS = $(GTEST_DIR)/include/gtest/*.h \\\n                $(GTEST_DIR)/include/gtest/internal/*.h\n\n# House-keeping build targets.\n\nall : $(TESTS)\n\nclean :\n    rm -f $(TESTS) gtest.a gtest_main.a *.o\n\n# Builds gtest.a and gtest_main.a.\n\n# Usually you shouldn't tweak such internal variables, indicated by a\n# trailing _.\nGTEST_SRCS_ = $(GTEST_DIR)/src/*.cc $(GTEST_DIR)/src/*.h $(GTEST_HEADERS)\n\n# For simplicity and to avoid depending on Google Test's\n# implementation details, the dependencies specified below are\n# conservative and not optimized.  This is fine as Google Test\n# compiles fast and for ordinary users its source rarely changes.\ngtest-all.o : $(GTEST_SRCS_)\n    $(CXX) $(CPPFLAGS) -I$(GTEST_DIR) $(CXXFLAGS) -c \\\n            $(GTEST_DIR)/src/gtest-all.cc\n\ngtest_main.o : $(GTEST_SRCS_)\n    $(CXX) $(CPPFLAGS) -I$(GTEST_DIR) $(CXXFLAGS) -c \\\n            $(GTEST_DIR)/src/gtest_main.cc\n\ngtest.a : gtest-all.o\n    $(AR) $(ARFLAGS) $@ $^\n\ngtest_main.a : gtest-all.o gtest_main.o\n    $(AR) $(ARFLAGS) $@ $^\n\n# Builds a sample test.  A test should link with either gtest.a or\n# gtest_main.a, depending on whether it defines its own main()\n# function.\n\nsample1.o : $(USER_DIR)/sample1.cc $(USER_DIR)/sample1.h $(GTEST_HEADERS)\n    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(USER_DIR)/sample1.cc\n\nsample1_unittest.o : $(USER_DIR)/sample1_unittest.cc \\\n                     $(USER_DIR)/sample1.h $(GTEST_HEADERS)\n    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(USER_DIR)/sample1_unittest.cc\n\nsample1_unittest : sample1.o sample1_unittest.o gtest_main.a\n    $(CXX) $(CPPFLAGS) $(CXXFLAGS) -lpthread $^ -o $@\n</code></pre>\n"}, {"tags": ["c++", "bash", "process", "subprocess", "subshell"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1527719014, "post_id": 50613945, "comment_id": 88238082, "body": "What are you really trying to do? <code>$(...)</code> is for running a command and putting its output into the current shell command. If you run the command in the background, how can you capture its output?"}], "answers": [{"comments": [{"owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 0, "creation_date": 1527718340, "post_id": 50614012, "comment_id": 88237904, "body": "as in replace the first 3 lines of <code>main()</code> with <code>thread::detach();</code> ?"}, {"owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 0, "creation_date": 1527718677, "post_id": 50614012, "comment_id": 88238005, "body": "<code>thread t(somefunction, somearguments);  t.detach();  this_thread::sleep_for(chrono::milliseconds(3000));</code>"}, {"owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 0, "creation_date": 1527719435, "post_id": 50614012, "comment_id": 88238195, "body": "It works, thank you!! Moving from bash to c++ is not ideal but I think it&#39;s the best I&#39;m going to get."}, {"owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 0, "creation_date": 1527720481, "post_id": 50614012, "comment_id": 88238480, "body": "You&#39;re welcome, glad to help :) BTW, you might find something more helpful about the bush here: <a href=\"https://superuser.com/questions/178587/how-do-i-detach-a-process-from-terminal-entirely\" title=\"how do i detach a process from terminal entirely\">superuser.com/questions/178587/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "is_accepted": false, "score": 2, "last_activity_date": 1527718375, "last_edit_date": 1527718375, "creation_date": 1527718235, "answer_id": 50614012, "question_id": 50613945, "link": "https://stackoverflow.com/questions/50613945/bash-run-command-in-background-inside-subshell/50614012#50614012", "title": "Bash run command in background inside subshell", "body": "<p>I hope I've got you right. Fix me if I'm wrong- you want that your main thread will ba able to die before the sub-threads ends?\nI f this is the situation you can use <code>detach</code> method on the thread.</p>\n"}, {"comments": [{"owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 1, "creation_date": 1527719365, "post_id": 50614153, "comment_id": 88238182, "body": "&quot;My only constraint is that I can&#39;t edit the function call in the subshell.&quot; Even if I could remove the <code>$</code> from the subshell, I wouldn&#39;t because the function produces output that needs to be captured."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 2, "creation_date": 1527719469, "post_id": 50614153, "comment_id": 88238209, "body": "If it needs to be captured, you have to wait for it to finish. Otherwise the main command will just start executing without the output."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 2, "creation_date": 1527719644, "post_id": 50614153, "comment_id": 88238252, "body": "<code>$(...)</code> will run the subcommand with a pipe connected to its <code>stdout</code>, and it will wait for EOF on the pipe. That basically means it has to wait for the command to finish, even though it&#39;s in the background. So what&#39;s the point of putting it in the background?"}, {"owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 1, "creation_date": 1527719897, "post_id": 50614153, "comment_id": 88238326, "body": "<code>func() { some_stuff; sleep 3 &amp;; more_stuff; };</code>$(func)` Is roughly the setup I have. I need the other code in <code>func</code> to execute and produce output that will be captured, but I also need to run sleep in the &quot;bg&quot;. It doesn&#39;t look like this is possible in bash which is why I am using the c++ solution."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 0, "creation_date": 1527719989, "post_id": 50614153, "comment_id": 88238356, "body": "Get rid of the <code>;</code> after <code>&amp;</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 1, "creation_date": 1527720006, "post_id": 50614153, "comment_id": 88238361, "body": "<code>func() { some_stuff; sleep 3 &amp; more_stuff; }</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 1, "creation_date": 1527720068, "post_id": 50614153, "comment_id": 88238379, "body": "<code>&amp;</code> is a command separator just like <code>;</code>. Putting <code>;</code> after it creates an empty command, and that&#39;s not allowed."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 1, "creation_date": 1527720169, "post_id": 50614153, "comment_id": 88238408, "body": "I still don&#39;t understand the point of that. It just means that the <code>$(func)</code> will be delayed 3 seconds after <code>some_stuff</code> finishes, even if <code>more_stuff</code> takes less time."}, {"owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 1, "creation_date": 1527720348, "post_id": 50614153, "comment_id": 88238450, "body": "<code>sleep 3 &amp;</code> is just a placeholder. It represents a git command in my script that pulls data from a repo. The latency from that download is causing issues, which is why I&#39;m trying to run it in the background."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 2, "creation_date": 1527721013, "post_id": 50614153, "comment_id": 88238601, "body": "If you don&#39;t want to wait for it, you&#39;ll also need to redirect its output: <code>git ... &gt;&#47;dev&#47;null &amp;</code>"}, {"owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "edited": false, "score": 0, "creation_date": 1527726102, "post_id": 50614153, "comment_id": 88239846, "body": "Absolutely dumbfounded. I can&#39;t believe it was that simple."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1527721143, "last_edit_date": 1527721143, "creation_date": 1527719163, "answer_id": 50614153, "question_id": 50613945, "link": "https://stackoverflow.com/questions/50613945/bash-run-command-in-background-inside-subshell/50614153#50614153", "title": "Bash run command in background inside subshell", "body": "<p>The <code>$(...)</code> command substitution mechanism waits for EOF on the pipe that the subshell's <code>stdout</code> is connected to. So even if you background a command in the subshell, the main shell will still wait for it to finish and close its <code>stdout</code>. To avoid waiting for this, you need to redirect its output away from the pipe.</p>\n\n<pre><code>echo \"$( cat file1; sleep 3 &gt;/dev/null &amp; cat file2 )\"\n</code></pre>\n"}], "owner": {"reputation": 802, "user_id": 5673922, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dbf835b56b5a5dc577080b8452040157?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson", "link": "https://stackoverflow.com/users/5673922/nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2128, "favorite_count": 0, "accepted_answer_id": 50614153, "answer_count": 2, "score": 2, "last_activity_date": 1527721143, "creation_date": 1527717778, "question_id": 50613945, "link": "https://stackoverflow.com/questions/50613945/bash-run-command-in-background-inside-subshell", "title": "Bash run command in background inside subshell", "body": "<p>I want to be able to bg a process inside a subshell as if it were not in a subshell.</p>\n\n<p><code>$( sleep 3 &amp; )</code> just ignores the ampersand.</p>\n\n<p>I've tried:</p>\n\n<pre><code>$( sleep 3 &amp; )\n$( sleep 3 &amp; ) &amp;\n$( sleep 3 ) &amp;\n</code></pre>\n\n<p>but nothing changes.</p>\n\n<p>Then I tried <code>$( disown sleep 3 &amp; )</code> which returned</p>\n\n<blockquote>\n  <p>disown: can't manipulate jobs in subshell</p>\n</blockquote>\n\n<p>which led me to try <code>$( set -m; disown sleep 3 &amp; )</code> but I got the same output.</p>\n\n<p>I even tried creating a c++ program that would daemonize itself:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;chrono&gt;\n#include &lt;thread&gt;\nusing namespace std;\n\nint main() {\n    int ret = fork();\n    if (ret &lt; 0) return ret;  // fork error\n    if (ret &gt; 0) return 0;  // parent exits\n\n    this_thread::sleep_for(chrono::milliseconds(3000));\n\n    return 0;\n}\n</code></pre>\n\n<p>But after running it, realized that because I am <code>fork</code>ing instead of <code>separate_from_parent_and_let_parent_die</code>ing the subshell will still wait for the process to end.</p>\n\n<p>To step out of my MCVE, a function is being called from a subshell, and in that function, I need to pull data from a server and it needs to be run in the bg. My only constraint is that I can't edit the function call in the subshell.</p>\n\n<p>Is there any way to not fork but separate from the parent process in a c++ program so that it can die without consequence or force a command to separate from a subshell in bash?</p>\n\n<p>Preferably the latter.</p>\n"}, {"tags": ["java", "c++", "java-native-interface", "jnienv"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527717857, "post_id": 50613889, "comment_id": 88237763, "body": "Check the documentation to find out who is responsible for deleting <code>body</code>. I&#39;m no JNI guru, but it&#39;s very possible that the garbage collector manages it for you. Don&#39;t <code>delete</code> stuff unless you allocated it or the API documentation says you are responsible for deleting it. Prefer not to allocate it in the first place."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1527717998, "post_id": 50613889, "comment_id": 88237802, "body": "A quick look into the subject says the array&#39;s memory is locked into place until you call <code>ReleaseShortArrayElements</code>. Again, look up the appropriate documentation page for details."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527723277, "post_id": 50613889, "comment_id": 88239172, "body": "God willing someone who actually knows this stuff can drop by and give this a real answer. If not, see if you can throw a bone to other programmers who run into this problem by turning the results of your work and research into an answer."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 0, "creation_date": 1527728481, "post_id": 50613889, "comment_id": 88240388, "body": "I would instead focus on figuring out a way to get the needed functionality without using <code>t_data</code> in the first place. (This would require more context than is in the question.)"}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 2, "creation_date": 1527745910, "post_id": 50613889, "comment_id": 88244692, "body": "Yes, definitely don&#39;t call <code>free</code> or <code>delete</code> on the pointer returned by <code>GetShortArrayElements</code>, because you don&#39;t know what <code>GetShortArrayElements</code> did internally. It might not have allocated any memory at all. Some implementations just pin the Java array to avoid having it moved by the GC, and then returns a pointer to the actual Java array contents. Just call <code>ReleaseShortArrayElements</code> when you&#39;re done with the pointer."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1527807639, "post_id": 50613889, "comment_id": 88278014, "body": "@Michael or Remaldeep, you should post that as the answer."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6478764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb29f27a27befcac2c794aa5f965cbae?s=128&d=identicon&r=PG", "display_name": "Remaldeep", "link": "https://stackoverflow.com/users/6478764/remaldeep"}, "is_accepted": true, "score": 0, "last_activity_date": 1527892474, "last_edit_date": 1527892474, "creation_date": 1527890844, "answer_id": 50651515, "question_id": 50613889, "link": "https://stackoverflow.com/questions/50613889/how-to-free-memory-allocated-with-jshortarray-jbytearray-from-jni-java-and-c/50651515#50651515", "title": "How to free memory allocated with jShortArray/jByteArray from JNI, Java and C++", "body": "<p>What Michael said was correct and that indeed solved the problem. Referring to his comment:</p>\n\n<blockquote>\n  <p>Yes, definitely don't call free or delete on the pointer returned by GetShortArrayElements, because you don't know what GetShortArrayElements did internally. It might not have allocated any memory at all. Some implementations just pin the Java array to avoid having it moved by the GC, and then returns a pointer to the actual Java array contents. Just call ReleaseShortArrayElements when you're done with the pointer. \u2013 Michael</p>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 6478764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb29f27a27befcac2c794aa5f965cbae?s=128&d=identicon&r=PG", "display_name": "Remaldeep", "link": "https://stackoverflow.com/users/6478764/remaldeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 50651515, "answer_count": 1, "score": 0, "last_activity_date": 1527892474, "creation_date": 1527717369, "question_id": 50613889, "link": "https://stackoverflow.com/questions/50613889/how-to-free-memory-allocated-with-jshortarray-jbytearray-from-jni-java-and-c", "title": "How to free memory allocated with jShortArray/jByteArray from JNI, Java and C++", "body": "<p>I am trying to free the memory of t_data which is assigned as dummy variable. (The code is below). Now as soon as I free t_data the program throws a heap corruption error but instead if I copy all the stuff from body to a new memory for t_data, everything works fine. The delete code is called somewhere down the line in another class method (not shown here), it just uses t_Data pointer to delete the memory.</p>\n\n<pre><code>jshortArray val = (jshortArray)(m_pJVMInstance-&gt;m_pEnv-&gt;CallStaticObjectMethod(m_imageJ_cls, method_id, arr, (jint)t, (jint)c));\njsize len = m_pJVMInstance-&gt;m_pEnv-&gt;GetArrayLength(val);\njshort* body = m_pJVMInstance-&gt;m_pEnv-&gt;GetShortArrayElements(val, 0);       \nunsigned short int* dummy = reinterpret_cast&lt;unsigned short int*&gt;(body);\n//t_data = dummy; //NOTE: Once you free t_data later exception is thrown.\nt_data = new unsigned short int[len];\nfor (int i = 0; i &lt; len; i++) {\n    unsigned short int test = *(body + i);\n    *((unsigned short int*)t_data + i) = test;\n}\n</code></pre>\n\n<p>I am trying to figure out a way where I dont have to run the for loop to copy the body data to t_data and still be able to free the memory. (The for loop takes too much time for big images.)</p>\n"}, {"tags": ["c++", "eclipse"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 1, "creation_date": 1527717001, "post_id": 50613715, "comment_id": 88237505, "body": "This code is not portable C++.  It is written specifically for the Visual C++ compiler.  You should expect that of most &quot;C++&quot; code offered at  <a href=\"https://msdn.microsoft.com\" rel=\"nofollow noreferrer\">msdn.microsoft.com</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1527717062, "post_id": 50613715, "comment_id": 88237520, "body": "Try swapping the order of <code>windows.h</code> and <code>winsock2.h</code>.  <code>iptypes.h</code> declares the affected types and constants only if <code>winsock2.h</code> is used, but <code>windows.h</code> uses <code>winsock.h</code> instead, which interferes with <code>winsock2.h</code>.  If you include <code>winsock2.h</code> before <code>windows.h</code>, <code>winsock2.h</code> will disable <code>winsock.h</code>"}, {"owner": {"reputation": 141, "user_id": 9146883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de73dc992874fb2e22653ba9d5813d6?s=128&d=identicon&r=PG&f=1", "display_name": "Ali-T", "link": "https://stackoverflow.com/users/9146883/ali-t"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527718501, "post_id": 50613715, "comment_id": 88237951, "body": "@RemyLebeau swapped. not work"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1527720620, "post_id": 50613715, "comment_id": 88238504, "body": "@heydar Well, then the remaining culprit is either you are using outdated versions of <code>iphlpapi.h</code>/<code>iptypes.h</code> that simply do not declare what you are trying to use, or they are wrapped in an <code>#ifdef</code> that is not getting defined in your project (in my compiler&#39;s Win32 SDK, they are wrapped in <code>#ifdef _WINSOCK2API_</code>, hence the requirement on <code>winsock2.h</code>)."}], "owner": {"reputation": 141, "user_id": 9146883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de73dc992874fb2e22653ba9d5813d6?s=128&d=identicon&r=PG&f=1", "display_name": "Ali-T", "link": "https://stackoverflow.com/users/9146883/ali-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 846, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527717327, "creation_date": 1527716384, "last_edit_date": 1527717327, "question_id": 50613715, "link": "https://stackoverflow.com/questions/50613715/error-when-i-use-ip-adapter-addresses", "title": "Error when I use &quot;IP_ADAPTER_ADDRESSES&quot;", "body": "<p>I'm new to C++, and I want to test the example in this link:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366058.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa366058.aspx</a></p>\n\n<p>When I build my project, I get many errors, and I don't know WHY.</p>\n\n<p>I copied the example code exactly, and include the necessary headers.</p>\n\n<p>I'm using Eclipse as my IDE.</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;winsock2.h&gt;\n#include &lt;iphlpapi.h&gt;\n#include &lt;iptypes.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n#pragma comment(lib, \"IPHLPAPI.lib\")\n\n#define MALLOC(x) HeapAlloc(GetProcessHeap(), 0, (x))\n#define FREE(x) HeapFree(GetProcessHeap(), 0, (x))\n\n/* Note: could also use malloc() and free() */\n\nint __cdecl main(int argc, char **argv)\n{\n\n    /* Declare and initialize variables */\n\n    DWORD dwSize = 0;\n    DWORD dwRetVal = 0;\n\n    unsigned int i = 0;\n\n    // Set the flags to pass to GetAdaptersAddresses\n    ULONG flags = GAA_FLAG_INCLUDE_PREFIX;\n\n    // default to unspecified address family (both)\n    ULONG family = AF_UNSPEC;\n\n    LPVOID lpMsgBuf = NULL;\n\n    PIP_ADAPTER_ADDRESSES pAddresses = NULL;\n    ULONG outBufLen = 0;\n\n    PIP_ADAPTER_ADDRESSES pCurrAddresses = NULL;\n    PIP_ADAPTER_UNICAST_ADDRESS pUnicast = NULL;\n    PIP_ADAPTER_ANYCAST_ADDRESS pAnycast = NULL;\n    PIP_ADAPTER_MULTICAST_ADDRESS pMulticast = NULL;\n    IP_ADAPTER_DNS_SERVER_ADDRESS *pDnServer = NULL;\n    IP_ADAPTER_PREFIX *pPrefix = NULL;\n\n    if (argc != 2) {\n        printf(\" Usage: getadapteraddresses family\\n\");\n        printf(\"        getadapteraddresses 4 (for IPv4)\\n\");\n        printf(\"        getadapteraddresses 6 (for IPv6)\\n\");\n        printf(\"        getadapteraddresses A (for both IPv4 and IPv6)\\n\");\n        exit(1);\n    }\n\n    if (atoi(argv[1]) == 4)\n        family = AF_INET;\n    else if (atoi(argv[1]) == 6)\n        family = AF_INET6;\n\n    outBufLen = sizeof (IP_ADAPTER_ADDRESSES);\n    pAddresses = (IP_ADAPTER_ADDRESSES *) MALLOC(outBufLen);\n\n    // Make an initial call to GetAdaptersAddresses to get the\n    // size needed into the outBufLen variable\n    if (GetAdaptersAddresses(family, flags, NULL, pAddresses, &amp;outBufLen)\n        == ERROR_BUFFER_OVERFLOW) {\n        FREE(pAddresses);\n        pAddresses = (IP_ADAPTER_ADDRESSES *) MALLOC(outBufLen);\n    }\n\n    if (pAddresses == NULL) {\n        printf(\"Memory allocation failed for IP_ADAPTER_ADDRESSES struct\\n\");\n        exit(1);\n    }\n    // Make a second call to GetAdapters Addresses to get the\n    // actual data we want\n    printf(\"Memory allocated for GetAdapterAddresses = %d bytes\\n\", outBufLen);\n    printf(\"Calling GetAdaptersAddresses function with family = \");\n    if (family == AF_INET)\n        printf(\"AF_INET\\n\");\n    if (family == AF_INET6)\n        printf(\"AF_INET6\\n\");\n    if (family == AF_UNSPEC)\n        printf(\"AF_UNSPEC\\n\\n\");\n\n    dwRetVal =\n        GetAdaptersAddresses(family, flags, NULL, pAddresses, &amp;outBufLen);\n\n    if (dwRetVal == NO_ERROR) {\n        // If successful, output some information from the data we received\n        pCurrAddresses = pAddresses;\n        while (pCurrAddresses) {\n            printf(\"\\tLength of the IP_ADAPTER_ADDRESS struct: %ld\\n\",\n                   pCurrAddresses-&gt;Length);\n            printf(\"\\tIfIndex (IPv4 interface): %u\\n\", pCurrAddresses-&gt;IfIndex);\n            printf(\"\\tAdapter name: %s\\n\", pCurrAddresses-&gt;AdapterName);\n\n            pUnicast = pCurrAddresses-&gt;FirstUnicastAddress;\n            if (pUnicast != NULL) {\n                for (i = 0; pUnicast != NULL; i++)\n                    pUnicast = pUnicast-&gt;Next;\n                printf(\"\\tNumber of Unicast Addresses: %d\\n\", i);\n            } else\n                printf(\"\\tNo Unicast Addresses\\n\");\n\n            pAnycast = pCurrAddresses-&gt;FirstAnycastAddress;\n            if (pAnycast) {\n                for (i = 0; pAnycast != NULL; i++)\n                    pAnycast = pAnycast-&gt;Next;\n                printf(\"\\tNumber of Anycast Addresses: %d\\n\", i);\n            } else\n                printf(\"\\tNo Anycast Addresses\\n\");\n\n            pMulticast = pCurrAddresses-&gt;FirstMulticastAddress;\n            if (pMulticast) {\n                for (i = 0; pMulticast != NULL; i++)\n                    pMulticast = pMulticast-&gt;Next;\n                printf(\"\\tNumber of Multicast Addresses: %d\\n\", i);\n            } else\n                printf(\"\\tNo Multicast Addresses\\n\");\n\n            pDnServer = pCurrAddresses-&gt;FirstDnsServerAddress;\n            if (pDnServer) {\n                for (i = 0; pDnServer != NULL; i++)\n                    pDnServer = pDnServer-&gt;Next;\n                printf(\"\\tNumber of DNS Server Addresses: %d\\n\", i);\n            } else\n                printf(\"\\tNo DNS Server Addresses\\n\");\n\n            printf(\"\\tDNS Suffix: %wS\\n\", pCurrAddresses-&gt;DnsSuffix);\n            printf(\"\\tDescription: %wS\\n\", pCurrAddresses-&gt;Description);\n            printf(\"\\tFriendly name: %wS\\n\", pCurrAddresses-&gt;FriendlyName);\n\n            if (pCurrAddresses-&gt;PhysicalAddressLength != 0) {\n                printf(\"\\tPhysical address: \");\n                for (i = 0; i &lt; pCurrAddresses-&gt;PhysicalAddressLength;\n                     i++) {\n                    if (i == (pCurrAddresses-&gt;PhysicalAddressLength - 1))\n                        printf(\"%.2X\\n\",\n                               (int) pCurrAddresses-&gt;PhysicalAddress[i]);\n                    else\n                        printf(\"%.2X-\",\n                               (int) pCurrAddresses-&gt;PhysicalAddress[i]);\n                }\n            }\n            printf(\"\\tFlags: %ld\\n\", pCurrAddresses-&gt;Flags);\n            printf(\"\\tMtu: %lu\\n\", pCurrAddresses-&gt;Mtu);\n            printf(\"\\tIfType: %ld\\n\", pCurrAddresses-&gt;IfType);\n            printf(\"\\tOperStatus: %ld\\n\", pCurrAddresses-&gt;OperStatus);\n            printf(\"\\tIpv6IfIndex (IPv6 interface): %u\\n\",\n                   pCurrAddresses-&gt;Ipv6IfIndex);\n            printf(\"\\tZoneIndices (hex): \");\n            for (i = 0; i &lt; 16; i++)\n                printf(\"%lx \", pCurrAddresses-&gt;ZoneIndices[i]);\n            printf(\"\\n\");\n\n            pPrefix = pCurrAddresses-&gt;FirstPrefix;\n            if (pPrefix) {\n                for (i = 0; pPrefix != NULL; i++)\n                    pPrefix = pPrefix-&gt;Next;\n                printf(\"\\tNumber of IP Adapter Prefix entries: %d\\n\", i);\n            } else\n                printf(\"\\tNo IP Adapter Prefix entries\\n\");\n\n            printf(\"\\n\");\n\n            pCurrAddresses = pCurrAddresses-&gt;Next;\n        }\n    } else {\n        printf(\"Call to GetAdaptersAddresses failed with error: %d\\n\",\n               dwRetVal);\n        if (dwRetVal == ERROR_NO_DATA)\n            printf(\"\\tNo addresses were found for the requested parameters\\n\");\n        else {\n\n            if (FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS, NULL, dwRetVal, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),   // Default language\n                              (LPTSTR) &amp; lpMsgBuf, 0, NULL)) {\n                printf(\"\\tError: %s\", lpMsgBuf);\n                LocalFree(lpMsgBuf);\n                FREE(pAddresses);\n                exit(1);\n            }\n        }\n    }\n    FREE(pAddresses);\n    return 0;\n}\n</code></pre>\n\n<p>These is the errors:</p>\n\n<pre><code>Info: Internal Builder is used for build\ng++ -O0 -g3 -Wall -c -fmessage-length=0 -o \"src\\\\test3.o\" \"..\\\\src\\\\test3.cpp\" \n..\\src\\test3.cpp:7:0: warning: ignoring #pragma comment  [-Wunknown-pragmas]\n #pragma comment(lib, \"IPHLPAPI.lib\")\n\n..\\src\\test3.cpp:8:0: warning: ignoring #pragma comment  [-Wunknown-pragmas]\n #pragma comment(lib, \"Ws2_32.lib\")\n\n..\\src\\test3.cpp: In function 'int main(int, char**)':\n..\\src\\test3.cpp:26:19: error: 'GAA_FLAG_INCLUDE_PREFIX' was not declared in this scope\n     ULONG flags = GAA_FLAG_INCLUDE_PREFIX;\n                   ^~~~~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:33:5: error: 'PIP_ADAPTER_ADDRESSES' was not declared in this scope\n     PIP_ADAPTER_ADDRESSES pAddresses = NULL; // @suppress(\"Type cannot be resolved\")\n     ^~~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:36:27: error: expected ';' before 'pCurrAddresses'\n     PIP_ADAPTER_ADDRESSES pCurrAddresses = NULL;\n                           ^~~~~~~~~~~~~~\n..\\src\\test3.cpp:37:5: error: 'PIP_ADAPTER_UNICAST_ADDRESS' was not declared in this scope\n     PIP_ADAPTER_UNICAST_ADDRESS pUnicast = NULL;\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:38:5: error: 'PIP_ADAPTER_ANYCAST_ADDRESS' was not declared in this scope\n     PIP_ADAPTER_ANYCAST_ADDRESS pAnycast = NULL;\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:39:5: error: 'PIP_ADAPTER_MULTICAST_ADDRESS' was not declared in this scope\n     PIP_ADAPTER_MULTICAST_ADDRESS pMulticast = NULL;\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:40:5: error: 'IP_ADAPTER_DNS_SERVER_ADDRESS' was not declared in this scope\n     IP_ADAPTER_DNS_SERVER_ADDRESS *pDnServer = NULL;\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:40:36: error: 'pDnServer' was not declared in this scope\n     IP_ADAPTER_DNS_SERVER_ADDRESS *pDnServer = NULL;\n                                    ^~~~~~~~~\n..\\src\\test3.cpp:41:5: error: 'IP_ADAPTER_PREFIX' was not declared in this scope\n     IP_ADAPTER_PREFIX *pPrefix = NULL;\n     ^~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:41:24: error: 'pPrefix' was not declared in this scope\n     IP_ADAPTER_PREFIX *pPrefix = NULL;\n                        ^~~~~~~\n..\\src\\test3.cpp:56:25: error: 'IP_ADAPTER_ADDRESSES' was not declared in this scope\n     outBufLen = sizeof (IP_ADAPTER_ADDRESSES);\n                         ^~~~~~~~~~~~~~~~~~~~\n..\\src\\test3.cpp:57:5: error: 'pAddresses' was not declared in this scope\n     pAddresses = (IP_ADAPTER_ADDRESSES *) MALLOC(outBufLen);\n     ^~~~~~~~~~\n..\\src\\test3.cpp:57:41: error: expected primary-expression before ')' token\n     pAddresses = (IP_ADAPTER_ADDRESSES *) MALLOC(outBufLen);\n                                         ^\n..\\src\\test3.cpp:61:73: error: 'GetAdaptersAddresses' was not declared in this scope\n     if (GetAdaptersAddresses(family, flags, NULL, pAddresses, &amp;outBufLen)\n                                                                         ^\n..\\src\\test3.cpp:64:45: error: expected primary-expression before ')' token\n         pAddresses = (IP_ADAPTER_ADDRESSES *) MALLOC(outBufLen);\n                                             ^\n..\\src\\test3.cpp:73:78: warning: format '%d' expects argument of type 'int', but argument 2 has type 'ULONG {aka long unsigned int}' [-Wformat=]\n     printf(\"Memory allocated for GetAdapterAddresses = %d bytes\\n\", outBufLen);\n                                                                              ^\n..\\src\\test3.cpp:83:73: error: 'GetAdaptersAddresses' was not declared in this scope\n         GetAdaptersAddresses(family, flags, NULL, pAddresses, &amp;outBufLen);\n                                                                         ^\n..\\src\\test3.cpp:87:9: error: 'pCurrAddresses' was not declared in this scope\n         pCurrAddresses = pAddresses;\n         ^~~~~~~~~~~~~~\n..\\src\\test3.cpp:94:13: error: 'pUnicast' was not declared in this scope\n             pUnicast = pCurrAddresses-&gt;FirstUnicastAddress;\n             ^~~~~~~~\n..\\src\\test3.cpp:102:13: error: 'pAnycast' was not declared in this scope\n             pAnycast = pCurrAddresses-&gt;FirstAnycastAddress;\n             ^~~~~~~~\n..\\src\\test3.cpp:110:13: error: 'pMulticast' was not declared in this scope\n             pMulticast = pCurrAddresses-&gt;FirstMulticastAddress;\n             ^~~~~~~~~~\n..\\src\\test3.cpp:167:24: warning: format '%d' expects argument of type 'int', but argument 2 has type 'DWORD {aka long unsigned int}' [-Wformat=]\n                dwRetVal);\n                        ^\n..\\src\\test3.cpp:174:47: warning: format '%s' expects argument of type 'char*', but argument 2 has type 'LPVOID {aka void*}' [-Wformat=]\n                 printf(\"\\tError: %s\", lpMsgBuf);\n                                               ^\n..\\src\\test3.cpp:20:11: warning: unused variable 'dwSize' [-Wunused-variable]\n     DWORD dwSize = 0;\n           ^~~~~~\n</code></pre>\n"}, {"tags": ["c++", "unicode"], "comments": [{"owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "edited": false, "score": 0, "creation_date": 1528237836, "post_id": 50613451, "comment_id": 88428674, "body": "I posted some thoughts on this <a href=\"https://stackoverflow.com/questions/50413471/what-exactly-can-wchar-t-represent/50540643#50540643\">here</a>, the point of my argument being that Windows and MacOS have decent (but different) Unicode support that you might want to abstract away behind some API whereas (AFAIK) Linux doesn&#39;t.  Or you could go with ICU.  I&#39;ve never used it but it looks pretty good from looking at the API documentation.  There&#39;s no regex support in the Win32 API, so you might be forced into using it anyway."}, {"owner": {"reputation": 37, "user_id": 9296005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e92619921cef48f36b7a915f6943638c?s=128&d=identicon&r=PG&f=1", "display_name": "dashthird", "link": "https://stackoverflow.com/users/9296005/dashthird"}, "edited": false, "score": 0, "creation_date": 1581166645, "post_id": 50613451, "comment_id": 106344151, "body": "May be your answer is there in this post :-) <a href=\"https://stackoverflow.com/questions/60092291/unable-to-extract-unicode-symbols-from-c-stdstring\" title=\"unable to extract unicode symbols from c stdstring\">stackoverflow.com/questions/60092291/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1527721500, "post_id": 50614394, "comment_id": 88238745, "body": "&quot;most C++ programs/programmers just assume that a text is an almost opaque sequence of bytes&quot; - how so? And what do you mean by &quot;a text&quot;?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1527792950, "post_id": 50614394, "comment_id": 88271998, "body": "&quot;The text&quot; = whatever is in an <code>std::string</code> (not wstring) or pointed-to be an <code>std::string_view</code>. You don&#39;t actually have to know how to interpret the octets to copy, move, or make calls such as regexp matching and so on - other people&#39;s code will take care of any Unicode considerations."}, {"owner": {"reputation": 674, "user_id": 1138721, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DD2mV.gif?s=128&g=1", "display_name": "Nicole", "link": "https://stackoverflow.com/users/1138721/nicole"}, "edited": false, "score": 0, "creation_date": 1528225229, "post_id": 50614394, "comment_id": 88423443, "body": "I&#39;d be inclined to use the localisation functions in boost. They do a rather good job of handling stuff like this, even if you need to dig a bit."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 13, "last_activity_date": 1527721085, "last_edit_date": 1592644375, "creation_date": 1527721085, "answer_id": 50614394, "question_id": 50613451, "link": "https://stackoverflow.com/questions/50613451/the-proper-way-to-handle-unicode-with-c-in-2018/50614394#50614394", "title": "The proper way to handle Unicode with C++ in 2018?", "body": "<p>I will try to throw some ideas here:</p>\n<ul>\n<li><p>most C++ programs/programmers just assume that a text is an almost opaque sequence of bytes. UTF-8 is probably guilty for that, and there is no surprise that many comments resume to: <em>don't worry with Unicode, just process UTF-8 encoded strings</em></p>\n</li>\n<li><p>files only contains bytes. At a moment, if you try to internally process true Unicode code points, you will have to serialize that to bytes -&gt; here again UTF-8 wins the point</p>\n</li>\n<li><p>as soon as you go out of the Basic Multilingual Plane (16 bits code points), things become more and more complex. The <a href=\"https://en.wikipedia.org/wiki/Emoji\" rel=\"noreferrer\">emoji</a> is specifically awful to process: an emoji can be followed by a <em>variation selector</em> (U+FE0E VARIATION SELECTOR-15 (VS15) for text or U+FE0F VARIATION SELECTOR-16 (VS16) for emoji-style) to alter its display style, more or less the old <code>i bs ^</code> that was used in 1970 ascii when one wanted to print <code>\u00ee</code>. That's not all, the characters  U+1F3FB to U+1F3FF are use to provide a skin color for 102 human emoji spread across six blocks: Dingbats, Emoticons, Miscellaneous Symbols, Miscellaneous Symbols and Pictographs, Supplemental Symbols and Pictographs, and Transport and Map Symbols.</p>\n<p>That simply means that up to 3 consecutive unicode code points can represent one single glyph... So the idea that one character is one <code>char32_t</code> is still an approximation</p>\n</li>\n</ul>\n<p>My conclusion is that Unicode <strong>is</strong> a complex thing, and really requires a dedicated library like ICU. You can try to use simple tools like the converters of the standard library when you only deal with the BMP, but full support is far beyond that.</p>\n<hr />\n<p>BTW: even other languages like Python that pretend to have a native unicode support (which is IMHO far better than current C++ one) ofter fails on some part:</p>\n<ul>\n<li>the tkinter GUI library cannot display any code point outside the BMP - while it is the standard IDLE Python tool</li>\n<li>different modules or the standard library are dedicated to Unicode in addition to the core language support (codecs and unicodedata), and other modules are available in the Python Package Index like the emoji support because the standard library does not meet all needs</li>\n</ul>\n<p>So support for Unicode is poor for more than 10 years, and I do not really hope that things will go much better in the next 10 years...</p>\n"}], "owner": {"reputation": 537, "user_id": 2088672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8168ac2769914af0612f8032e5b7d6a8?s=128&d=identicon&r=PG", "display_name": "Lfod", "link": "https://stackoverflow.com/users/2088672/lfod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4995, "favorite_count": 17, "accepted_answer_id": 50614394, "answer_count": 1, "score": 32, "last_activity_date": 1527721085, "creation_date": 1527714979, "last_edit_date": 1527716419, "question_id": 50613451, "link": "https://stackoverflow.com/questions/50613451/the-proper-way-to-handle-unicode-with-c-in-2018", "title": "The proper way to handle Unicode with C++ in 2018?", "body": "<p>I have tried searching stackoverflow to find an answer to this but the questions and answers I've found are around <strong>10 years old</strong> and I can't seem to find consensus on the subject due to changes and possible progress.</p>\n\n<p>There are several libraries that I know of outside of the stl that are supposed to handle unicode-</p>\n\n<ul>\n<li><a href=\"http://userguide.icu-project.org/\" rel=\"noreferrer\">http://userguide.icu-project.org/</a></li>\n<li><a href=\"https://github.com/nemtrif/utfcpp\" rel=\"noreferrer\">https://github.com/nemtrif/utfcpp</a></li>\n<li><a href=\"https://github.com/CaptainCrowbar/unicorn-lib\" rel=\"noreferrer\">https://github.com/CaptainCrowbar/unicorn-lib</a></li>\n</ul>\n\n<p>There are a few features of the stl (<a href=\"https://stackoverflow.com/questions/27225196/is-wstring-character-is-unicode-what-happens-during-conversion\">wstring</a>,<a href=\"http://en.cppreference.com/w/cpp/locale/codecvt_utf8\" rel=\"noreferrer\">codecvt_utf8</a>) that were included but people seem to be ambivalent about using because they deal with UTF-16 which this site: (<a href=\"https://utf8everywhere.org/\" rel=\"noreferrer\">utf-8 everywhere</a>) says shouldn't be used and many people online seem agree with the premise.</p>\n\n<p>The only thing I'm looking for is the ability to do 4 things with a unicode strings-</p>\n\n<ol>\n<li>Read a string into memory</li>\n<li>Search the string with regex using unicode or ascii, concatenate or do text replacement/formatting with it with either ascii+unicode numbers or characters.</li>\n<li>Convert to ascii + the unicode number format for characters that don't fit in the ascii range.</li>\n<li>Write a string to disk or send wherever.</li>\n</ol>\n\n<p>From what I can tell icu handles this and more.  What I would like to know is if there is a standard way of handling this on Linux, Windows, and MacOS.</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["c++", "winapi", "device"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1527714938, "post_id": 50613327, "comment_id": 88236760, "body": "you can use &quot;\\\\\\\\?\\\\globalroot\\\\Device\\\\0000006f&quot;` - so you can use any device name in call <code>CreateFile</code>"}, {"owner": {"reputation": 144, "user_id": 8492420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkFgt.jpg?s=128&g=1", "display_name": "Javad Bayat", "link": "https://stackoverflow.com/users/8492420/javad-bayat"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1527715893, "post_id": 50613327, "comment_id": 88237125, "body": "@RbMm Thank you. It works. But imagine you have the display name of a device as it appears in Device Manager. Then how would you obtain its Physical Device Object name as it appears in WinObj?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1527716392, "post_id": 50613327, "comment_id": 88237296, "body": "you need call <code>CM_Get_Device_Interface_ListW</code> with <code>GUID_DEVINTERFACE_MONITOR</code> and use returned name in call <code>CreateFile</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1527737650, "post_id": 50614114, "comment_id": 88242361, "body": "Talking about parsing &quot;\\Sessions\\0\\DosDevices\\&lt;luid&gt;&quot; and following the &quot;Global&quot; link to &quot;\\Global??&quot; is a useful way to understand the big picture of how device lookup works, but of course in practice it isn&#39;t implemented like this. Initially, from the token&#39;s <code>LogonSession</code>, we have the session&#39;s <code>pDeviceMap</code>, which references the <code>DosDevicesDirectory</code>. Subsequently the <code>DeviceMap</code> gets cached in the Process object, and used unless a thread is impersonating. The Directory object itself also caches the <code>DeviceMap</code>, from which the <code>GlobalDosDevicesDirectory</code> is accessed as a &#39;shadow&#39; directory."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1527737898, "post_id": 50614114, "comment_id": 88242426, "body": "Unless we&#39;re in a SYSTEM process, which is hard coded to use the system device map, in which &quot;\\Global??&quot; is the <code>DosDevicesDirectory</code> and <code>GlobalDosDevicesDirectory</code> is <code>NULL</code>, to terminate further lookup. Nowadays we also have server silos to contend with, with container namespaces. So this is handled more flexibly, and the default global silo device map is set as <code>PspHostSiloGlobals-&gt;ObSiloState.SystemDeviceMap</code>."}, {"owner": {"reputation": 144, "user_id": 8492420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkFgt.jpg?s=128&g=1", "display_name": "Javad Bayat", "link": "https://stackoverflow.com/users/8492420/javad-bayat"}, "edited": false, "score": 0, "creation_date": 1527784618, "post_id": 50614114, "comment_id": 88267923, "body": "Your answer is good. Though it raised a question for me. Under &quot;\\Sessions\\0\\DosDevices\\&quot; folder, there are three subfolders with weird names (you called their names &quot;luid&quot;). What does each of them represent? Also, in each of these folders, there&#39;s an item named Global which you explained well about it. But in one of these folders, there are two additional items &quot;NDISTAPI&quot; and &quot;NDPROXY&quot;. What are those two items?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 144, "user_id": 8492420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkFgt.jpg?s=128&g=1", "display_name": "Javad Bayat", "link": "https://stackoverflow.com/users/8492420/javad-bayat"}, "edited": false, "score": 1, "creation_date": 1527785832, "post_id": 50614114, "comment_id": 88268565, "body": "@JavadBayat - this numbers - is logon session id (luid) from token.run this <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/logonsessions\" rel=\"nofollow noreferrer\">utility</a> for example and compare luids in winobj and from it. of course in some sessions can be created local objects. otherwise which sense in folder if it will be always empty ?"}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1527842394, "post_id": 50614114, "comment_id": 88288692, "body": "Note that local logon-session devices take precedence over global devices. As I explained in my first comment, the Object Manager doesn&#39;t use the &quot;Global&quot; link, so here we see the real reason that this link exists. With it, you can still refer to a &quot;\\\\?\\Global\\Z:&quot; when local &quot;Z:&quot; exists. That&#39;s also why RbMm said that &quot;\\\\?\\Global\\GlobalRoot&quot; is better than &quot;\\\\?\\GlobalRoot&quot; ; given the chance that another program set a local &quot;GlobalRoot&quot; link via <code>NtCreateSymbolicLinkObject</code>."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1527843170, "post_id": 50614114, "comment_id": 88289155, "body": "Also note that there&#39;s no Directory for the SYSTEM logon session (0x3e7) in &quot;\\Sessions\\0\\DosDevices&quot;. As I explained in my second comment, the SYSTEM logon uses the system device map (or current silo device map), which uses the system&#39;s global DOS device directory as the primary <code>DosDevicesDirectory</code>. For consistency in this case, the global DOS devices directory has a &quot;Global&quot; link (e.g. &quot;\\Global??\\Global&quot;, if not a silo) that points back to its parent, even though this seems a bit silly."}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 4, "last_activity_date": 1527718936, "creation_date": 1527718936, "answer_id": 50614114, "question_id": 50613327, "link": "https://stackoverflow.com/questions/50613327/can-createfile-function-open-a-handle-to-the-devices-that-are-only-listed-under/50614114#50614114", "title": "Can CreateFile function open a handle to the devices that are only listed under Global?? directory in WinObj utility?", "body": "<p>at first in <code>CreateFile</code> we can use any name from NT namespace, if prefix it with <strong><code>\\\\?\\globalroot</code></strong> or even better <strong><code>\\\\?\\global\\globalroot</code></strong> prefix. say if we want open <code>\\Device\\0000006f</code> we can use <code>\\\\?\\globalroot\\Device\\0000006f</code> or <code>\\\\?\\global\\globalroot\\Device\\0000006f</code> name. the win32 sybsystem when convert win32 path to NT-path - if view '\\?` prefix - simply convert it to <code>\\??\\</code>. so nt path will be look like <code>\\??\\[global\\]globalroot\\Device\\0000006f</code>. the <code>\\??</code> is <a href=\"https://googleprojectzero.blogspot.com/2015/10/windows-drivers-are-truely-tricky.html\" rel=\"nofollow noreferrer\">virtual directory</a> - it not exist really. object manager look in <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/local-and-global-ms-dos-device-names\" rel=\"nofollow noreferrer\">Local and Global MS-DOS Device Names</a> when view <code>\\??\\</code>. first in local (which look like <code>\\Sessions\\0\\DosDevices\\&lt;luid&gt;</code>) and if not found in global - <code>\\GLOBAL??</code>. however in any local dos device directory exist symbolic link <code>Global</code> which point to <code>\\Global??</code>. as result after parse <code>\\??\\global</code> we will be redirected to <code>\\Global??</code>. then in <code>\\Global??</code> folder exist symbolic link <code>GLOBALROOT</code> which is empty - point to root of NT namespace.\nas result after parse\n<code>\\\\?\\global\\globalroot\\Device\\0000006f</code> will be re-parsed to <code>\\Device\\0000006f</code> and  <code>\\\\?\\globalroot\\Device\\0000006f</code> also, if no <code>globalroot</code> object in Local device namespace (usually not exist, but suddenly somebody create it).</p>\n\n<p>now about how open monitor device. we must not hard-code any device name. instead we need search for devices which support <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/install/guid-devinterface-monitor\" rel=\"nofollow noreferrer\"><code>GUID_DEVINTERFACE_MONITOR</code></a> by call <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff538463(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CM_Get_Device_Interface_ListW</code></a> and use returned name in call <code>CreateFile</code></p>\n\n<pre><code>#include &lt;ntddvdeo.h&gt;\n\nCONFIGRET EnumMonitors()\n{\n    CONFIGRET err;\n\n    static volatile UCHAR guz;\n\n    PVOID stack = alloca(guz);\n    ULONG BufferLen = 0, NeedLen = 128;\n\n    union {\n        PVOID buf;\n        PWSTR pszDeviceInterface;\n    };\n\n    for(;;) \n    {\n        if (BufferLen &lt; NeedLen)\n        {\n            BufferLen = RtlPointerToOffset(buf = alloca((NeedLen - BufferLen) * sizeof(WCHAR)), stack) / sizeof(WCHAR);\n        }\n\n        switch (err = CM_Get_Device_Interface_ListW(const_cast&lt;PGUID&gt;(&amp;GUID_DEVINTERFACE_MONITOR), \n            0, pszDeviceInterface, BufferLen, CM_GET_DEVICE_INTERFACE_LIST_PRESENT))\n        {\n        case CR_BUFFER_SMALL:\n            if (err = CM_Get_Device_Interface_List_SizeW(&amp;NeedLen, const_cast&lt;PGUID&gt;(&amp;GUID_DEVINTERFACE_MONITOR), \n                0, CM_GET_DEVICE_INTERFACE_LIST_PRESENT))\n            {\n        default:\n            return err;\n            }\n            continue;\n\n        case CR_SUCCESS:\n\n            while (*pszDeviceInterface)\n            {\n                HANDLE hFile = CreateFileW(pszDeviceInterface, 0, FILE_SHARE_READ|FILE_SHARE_WRITE, 0,\n                    OPEN_EXISTING, 0, 0);\n\n                if (hFile != INVALID_HANDLE_VALUE)\n                {\n                    OVERLAPPED ov = {};\n                    DISPLAY_BRIGHTNESS db;\n                    DeviceIoControl(hFile, IOCTL_VIDEO_QUERY_DISPLAY_BRIGHTNESS, 0, 0,\n                        &amp;db, sizeof(db), 0, &amp;ov);\n                    CloseHandle(hFile);\n\n                    DbgPrint(\"(%x,%x,%x) %S\\n\", db.ucDisplayPolicy, db.ucACBrightness, db.ucDCBrightness, pszDeviceInterface);\n                }\n\n                pszDeviceInterface += 1 + wcslen(pszDeviceInterface);\n            }\n            return 0;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 8492420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TkFgt.jpg?s=128&g=1", "display_name": "Javad Bayat", "link": "https://stackoverflow.com/users/8492420/javad-bayat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 50614114, "answer_count": 1, "score": 1, "last_activity_date": 1527718936, "creation_date": 1527714188, "question_id": 50613327, "link": "https://stackoverflow.com/questions/50613327/can-createfile-function-open-a-handle-to-the-devices-that-are-only-listed-under", "title": "Can CreateFile function open a handle to the devices that are only listed under Global?? directory in WinObj utility?", "body": "<p>You know - in C++, you can obtain a handle to an I/O device by passing its path as the first parameter in a call to CreateFile function. But I wonder how CreateFile locates and identifies the device by the path given. One day, I discovered something about this topic using WinObj utility, which may be probably true.<br>\nIn WinObj, there is a directory named <em>Global??</em> which is located under the root directory, and can be seen on the left pane. This directory contains lots of items of type \"SymbolicLink\".<br>\nWhen you pass the path of an I/O device (such as \"\\.\\C:\" or \"\\.\\Changer0\") as the first parameter in a call to <code>CreateFile</code> function, the CreateFile function parses out the path and removes \"\\.\\\" from it to find a portion of the path. Then it searches the <em>Global??</em> directory for a SymbolicLink with the same name as that portion. Then it finds the address that the symbolic link refers to, which is the primary <strong>Physical Device Object Name</strong> (for example, \"\\Device\\CdRom0\").<br>\nSo, is my discovery true? Are the devices contained within <em>Global??</em> directory the only devices that <code>CreateFile</code> function can open? Just to mention something:  not all of the items in <em>Global??</em> directory refer to a device, I guess.  </p>\n\n<h3>The second part of my question</h3>\n\n<p>One day, I wanted to decrease the screen brightness of my monitor programmatically, by sending an <code>IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS</code> control code to my monitor. The problem was that I didn't know what to specify for the first parameter of <code>CreateFile</code> function. So I did the following:  </p>\n\n<ol>\n<li>I opened <em>Device Manager</em> and found my monitor device among the list. The name of that device was \"Generic Non-PnP Monitor\".</li>\n<li>I right clicked on that list item and clicked on <em>Properties</em>.</li>\n<li>In the <em>Properties</em> window, I clicked on <em>Details</em> tab. Then I selected <em>Physical Device Object name</em> from the <em>Property</em> drop-down list.</li>\n<li>On the value section, I found the text \"\\Device\\0000006f\".</li>\n<li>In WinObj, I searched the <em>Global??</em> directory for a SymbolicLink which refers to \"\\Device\\0000006f\". The name of that SymbolicLink was long:</li>\n</ol>\n\n<blockquote>\n  <p>DISPLAY#Default_Monitor#5&amp;1193a8c7&amp;0&amp;UID100663553#{866519b5-3f07-4c97-b7df-24c5d8a8ccb8}</p>\n</blockquote>\n\n<ol start=\"6\">\n<li>Then I put a \"\\.\\\" before the aforementioned SymbolicLink name and\nspecified it as the first parameter of <code>CreateFile</code> function.  </li>\n</ol>\n\n<p>Any ideas on how to do all of this operation programmatically? I mean, I'd like my program itself to obtain the value of <code>lpFileName</code> parameter. Not I place this string directly in my program's source code.</p>\n"}, {"tags": ["c++", "polymorphism", "virtual"], "comments": [{"owner": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 6, "creation_date": 1527713178, "post_id": 50613081, "comment_id": 88236078, "body": "Where did you get the idea to write <code>void(*firstfunc)() = (void(*)(void))(*(int*)*(int*)p);</code> and what did you expect it to do?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 6, "creation_date": 1527713237, "post_id": 50613081, "comment_id": 88236105, "body": "Vtables and vptrs are internal implementation details, this code is depending on undefined behavior."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 3, "creation_date": 1527713326, "post_id": 50613081, "comment_id": 88236146, "body": "No need (and actually no guaranteed support) to access any <code>vtable</code>; just do <code>p-&gt;fun_1()</code> or <code>p-&gt;fun_2()</code>; the language handles dynamic binding then for you."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 1, "creation_date": 1527713341, "post_id": 50613081, "comment_id": 88236158, "body": "Don&#39;t take this the wrong way, but you&#39;re way, way off track as far as learning C++, inheritance and polymorphism. @scohe001&#39;s question is on point - where are you getting this and what are you really trying to do?"}, {"owner": {"reputation": 1779, "user_id": 1065992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sWiDT.png?s=128&g=1", "display_name": "Blood-HaZaRd", "link": "https://stackoverflow.com/users/1065992/blood-hazard"}, "reply_to_user": {"reputation": 13849, "user_id": 2602718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CQ4Gj.jpg?s=128&g=1", "display_name": "scohe001", "link": "https://stackoverflow.com/users/2602718/scohe001"}, "edited": false, "score": 0, "creation_date": 1527713404, "post_id": 50613081, "comment_id": 88236174, "body": "@scohe001: I am with you and they are internals. but I read that all is done by the magic of deferencing."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1527713420, "post_id": 50613081, "comment_id": 88236182, "body": "<code>*(void(*)(void))(*(int*)*(int*)p) sttill fuzzy in my mind*</code> -- It should be -- it&#39;s probably fuzzy in most programmer&#39;s minds."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527713426, "post_id": 50613081, "comment_id": 88236187, "body": "@Blood-HaZaRd Yes, that&#39;s how it works internally, but you can&#39;t do it portably in your own code."}, {"owner": {"reputation": 1779, "user_id": 1065992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sWiDT.png?s=128&g=1", "display_name": "Blood-HaZaRd", "link": "https://stackoverflow.com/users/1065992/blood-hazard"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527713523, "post_id": 50613081, "comment_id": 88236236, "body": "@Barmar : I saw tthat here <a href=\"https://en.wikipedia.org/wiki/Virtual_method_table\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Virtual_method_table</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527713591, "post_id": 50613081, "comment_id": 88236260, "body": "If you want to call virtual functions dynamically through a variable, use <code>void(base::*firstfunc)() = p-&gt;fun_1;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1527713674, "post_id": 50613081, "comment_id": 88236295, "body": "@Blood-HaZaRd From that page: <b>Many compilers place the virtual table pointer as the last member of the object; other compilers place it as the first</b>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1527713938, "post_id": 50613081, "comment_id": 88236389, "body": "If you think you need to care about the internals of this stuff then stop. You&#39;re doing it wrong. While it may be useful to know how things are implemented &quot;under the hood&quot;, you as a <i>user</i> of the language should never need to know nor care."}, {"owner": {"reputation": 1779, "user_id": 1065992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sWiDT.png?s=128&g=1", "display_name": "Blood-HaZaRd", "link": "https://stackoverflow.com/users/1065992/blood-hazard"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1527714264, "post_id": 50613081, "comment_id": 88236519, "body": "@JesperJuhl: Agree and stopped by the way :) There is nor harm with curiosity when it is just for learning (not to use in real life). :D"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527715739, "post_id": 50613081, "comment_id": 88237058, "body": "Perhaps this question could be clarified.  Are you asking how to <b>manually</b> find a vtable pointer and index into it?"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1527989661, "post_id": 50613081, "comment_id": 88335245, "body": "You know that virtual member functions have a this parameter, right?"}], "answers": [{"tags": [], "owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "is_accepted": false, "score": 1, "last_activity_date": 1527715667, "creation_date": 1527715667, "answer_id": 50613585, "question_id": 50613081, "link": "https://stackoverflow.com/questions/50613081/calling-virtual-function-by-vptr/50613585#50613585", "title": "calling virtual function by vptr", "body": "<blockquote>\n  <p>how could I do to call the second function ?</p>\n</blockquote>\n\n<p>You would call it like this:</p>\n\n<pre><code>p-&gt;fun_2();\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>derived-2\n</code></pre>\n\n<p>Virtual tables and virtual function pointers are implementation details of your compiler. In general you should not care about such implementation details, because if you do you write non-portable code. Actually I am not even sure if your code has undefined behaviour or not, if it does then even a compiler that does place the vpointer at the place you expect could print garbage. Anyhow, dont do it, unless you need to, which is actually never ;).</p>\n\n<p>As a sidenote, function pointers loose lots of their scariness if you use aliases, eg</p>\n\n<pre><code>using base_mem_fun = void (base::*)();\nbase_mem_fun first_base = &amp;base::fun_1;\n(p-&gt;*first_base)();\n</code></pre>\n\n<p>prints: </p>\n\n<pre><code>base-1\n</code></pre>\n"}], "owner": {"reputation": 1779, "user_id": 1065992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sWiDT.png?s=128&g=1", "display_name": "Blood-HaZaRd", "link": "https://stackoverflow.com/users/1065992/blood-hazard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1527715667, "creation_date": 1527713018, "last_edit_date": 1527714341, "question_id": 50613081, "link": "https://stackoverflow.com/questions/50613081/calling-virtual-function-by-vptr", "title": "calling virtual function by vptr", "body": "<p>I was recently reading about virtual functions and inheritance in C++, and ended up with the vptr and VTABLE. </p>\n\n<p>My question is related to calling the methods of derived objects with means of vprt. </p>\n\n<p>I explain, below is my code :</p>\n\n<pre><code>    #include &lt;iostream&gt;\n    using namespace std;\n\n\n    class base\n    {\n    public:\n        void fun_1() { cout &lt;&lt; \"base-1\\n\"; }\n        virtual void fun_2() { cout &lt;&lt; \"base-2\\n\"; }\n        virtual void fun_3() { cout &lt;&lt; \"base-3\\n\"; }\n        virtual void fun_4() { cout &lt;&lt; \"base-4\\n\"; }\n    };\n\n    class derived : public base\n    {\n    public:\n        void fun_1() { cout &lt;&lt; \"derived-1\\n\"; }\n        void fun_2() { cout &lt;&lt; \"derived-2\\n\"; } \n        void fun_4() { cout &lt;&lt; \"derived-4\\n\"; }\n    };\n\n    int main()\n    {\n        base *p;\n        derived obj1;\n        p = &amp;obj1;\n\n        void(*firstfunc)() = (void(*)(void))(*(int*)*(int*)p);\n        firstfunc();\n    }\n</code></pre>\n\n<p>the result is : </p>\n\n<blockquote>\n  <p>derived-2</p>\n</blockquote>\n\n<p>Ok, till now, the operations done with <code>(void(*)(void))(*(int*)*(int*)p)</code> sttill fuzzy in my mind, butt how could I do to call the second function ?</p>\n\n<p>Thx</p>\n"}, {"tags": ["python", "c++", "swig"], "comments": [{"owner": {"reputation": 183, "user_id": 6317020, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-Z8aCfSFeyrY/AAAAAAAAAAI/AAAAAAAAC3s/PJ25l9b83jw/photo.jpg?sz=128", "display_name": "Jake Steele", "link": "https://stackoverflow.com/users/6317020/jake-steele"}, "edited": false, "score": 0, "creation_date": 1527714962, "post_id": 50613010, "comment_id": 88236771, "body": "Have you thought about serializing it in JSON or xml and then using a constructor to build the object in python?"}, {"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "reply_to_user": {"reputation": 183, "user_id": 6317020, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-Z8aCfSFeyrY/AAAAAAAAAAI/AAAAAAAAC3s/PJ25l9b83jw/photo.jpg?sz=128", "display_name": "Jake Steele", "link": "https://stackoverflow.com/users/6317020/jake-steele"}, "edited": false, "score": 0, "creation_date": 1527715178, "post_id": 50613010, "comment_id": 88236845, "body": "nope. My goal is to be able to share the memory for the object, so no copying should be needed."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1527778707, "post_id": 50613010, "comment_id": 88264543, "body": "There&#39;s no <code>pFunc</code> object in your snippets. It doesn&#39;t work that way. <code>myObject</code> must be a <b>valid</b> <code>PyObject</code> (which I don&#39;t think it is - I can&#39;t be sure until I see <code>MyObject</code>&#39;s definition). <i>&quot;The C++ class have already been wrapped using swig&quot;</i>: then I don&#39;t think that you should be required to write this  <i>C</i> code."}, {"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1527783454, "post_id": 50613010, "comment_id": 88267329, "body": "Thanks CristiFati, In this question, the python interpreter is embedded in a C++ application, and so the python function above is called from C/C++.  The MyObject is an empty &quot;demo&quot; C++ class, and its internals is irrelevant. Its only used for getting the concept right, concept being, as stated in the title, &quot;how to pass a C++ object to Python?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1527975585, "post_id": 50650532, "comment_id": 88332836, "body": "This is pretty much the answer. You should be able to write <code>SWIG_TypeQuery(&quot;MyClass *&quot;)</code> though if you prefer."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1527976051, "post_id": 50650532, "comment_id": 88332926, "body": "What I might be tempted to do though would be make <code>execute</code> &#39;find&#39; the <code>obj</code> instance via a wrapped C++ function instead of as an argument though, e.g. it calls <code>api.getInstance()</code>, where <code>api</code> is provided through the <code>PyImport_AppendInittab()</code>."}, {"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1528394505, "post_id": 50650532, "comment_id": 88502580, "body": "Thanks Flexo, Perhaps inclusion of swig wrapper header not too bad. and the ability to query the type using your sueggestion, with &quot;MyClass *&quot; removes the necessity to having to look inside the swig wrapper code, which is a big improvement, imo. Not sure how to use the AppendInittab technique."}], "tags": [], "owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "is_accepted": false, "score": 9, "last_activity_date": 1527889725, "last_edit_date": 1527889725, "creation_date": 1527884495, "answer_id": 50650532, "question_id": 50613010, "link": "https://stackoverflow.com/questions/50613010/passing-a-c-object-to-python/50650532#50650532", "title": "Passing a C++ object to Python", "body": "<p>This is a partial answer to my own question. I'm saying partial, because I do believe there is a better way.</p>\n\n<p>Building on this post <a href=\"http://swig.10945.n7.nabble.com/Pass-a-Swig-wrapped-C-class-to-embedded-Python-code-td8812.html\" rel=\"noreferrer\">http://swig.10945.n7.nabble.com/Pass-a-Swig-wrapped-C-class-to-embedded-Python-code-td8812.html</a>\nI generated the swig runtime header, as described here, section 15.4: <a href=\"http://www.swig.org/Doc2.0/Modules.html#Modules_external_run_time\" rel=\"noreferrer\">http://www.swig.org/Doc2.0/Modules.html#Modules_external_run_time</a></p>\n\n<p>Including the generated header in the C++ code above, allow the following code to be written:</p>\n\n<pre><code>    PyObject* pObj = SWIG_NewPointerObj((void*)&amp;obj, SWIG_TypeQuery(\"_p_MyClass\"),  0 ); \n</code></pre>\n\n<p>This code is using information from the Swig python wrap source files, namely the \"swig\" name of the type MyClass, i.e. <em>_p_MyClass</em>.</p>\n\n<p>With the above PyObject* as an argument to the  PyObject_CallObject function, the python <strong>execute()</strong> function in the code above executes fine, and the Python code, using the generated python module, do have proper access to the MyClass objects internal data. This is great.</p>\n\n<p>Although the above code illustrate how to pass, and retrieve data between C++ and Python in a quite simple fashion, its not ideal, in my opinion.</p>\n\n<p>The usage of the swig header file in the C++ code is really not that pretty, and in addition, it requires a user to \"manually\" look into swig generated wrapper code in order to find the \"_p_MyClass\" code. </p>\n\n<p>There must be a better way!? Perhaps something should be added to the swig interface file in order to get this looking nicer?</p>\n"}, {"comments": [{"owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "edited": false, "score": 0, "creation_date": 1528394608, "post_id": 50738937, "comment_id": 88502629, "body": "Curious, whats pInstance, x and &quot;add&quot;?"}], "tags": [], "owner": {"reputation": 9, "user_id": 9908265, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9b17bce13c3f330efb245330a9f0fdf4?s=128&d=identicon&r=PG", "display_name": "PewDie", "link": "https://stackoverflow.com/users/9908265/pewdie"}, "is_accepted": false, "score": -1, "last_activity_date": 1528370121, "last_edit_date": 1528370121, "creation_date": 1528367256, "answer_id": 50738937, "question_id": 50613010, "link": "https://stackoverflow.com/questions/50613010/passing-a-c-object-to-python/50738937#50738937", "title": "Passing a C++ object to Python", "body": "<pre><code>PyObject *pValue;\npValue = PyObject_CallMethod(pInstance, \"add\",\"(i)\",x);\nif (pValue)\n    Py_DECREF(pValue);\nelse\n    PyErr_Print();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 316, "user_id": 7060174, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zr5jg8G2l70/AAAAAAAAAAI/AAAAAAAAABQ/kPPYahW1Dxk/photo.jpg?sz=128", "display_name": "Mosolov Sergey", "link": "https://stackoverflow.com/users/7060174/mosolov-sergey"}, "edited": false, "score": 0, "creation_date": 1613468255, "post_id": 65704334, "comment_id": 117077430, "body": "give a try to <code>SWIG_TypeQuery(&quot;MyClass *&quot;)</code> if you want to export a pointer to a class MyClass"}], "tags": [], "owner": {"reputation": 921, "user_id": 2043980, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/17e881e92b245bcb71fe579f34acb1b0?s=128&d=identicon&r=PG", "display_name": "Demaunt", "link": "https://stackoverflow.com/users/2043980/demaunt"}, "is_accepted": false, "score": 0, "last_activity_date": 1610549536, "creation_date": 1610549536, "answer_id": 65704334, "question_id": 50613010, "link": "https://stackoverflow.com/questions/50613010/passing-a-c-object-to-python/65704334#65704334", "title": "Passing a C++ object to Python", "body": "<p>Unfortunatle it does not work in my case.\nI get nullptr exception inside <code>SWIG_TypeQuery(&quot;_p_MyClass&quot;)</code> macros.</p>\n<p>Could you please share more details how to do such passing?</p>\n<ol>\n<li>I have MyClass library</li>\n<li>Based on this library I created module using swig</li>\n<li>Next I created swigpyrun.h file using -external-runtime</li>\n<li>I included this file into my main.cpp, and SWIG_TypeQuery(&quot;_p_MyClass&quot;) gives an error</li>\n</ol>\n<p>I even tried to add definitions like SWIG_TYPE_TABLE, but it did not help.</p>\n<p>BTW I am using MSVS compilter</p>\n"}], "owner": {"reputation": 1304, "user_id": 1927753, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0f9533437be5bdcf493bfbbd101747a2?s=128&d=identicon&r=PG", "display_name": "Totte Karlsson", "link": "https://stackoverflow.com/users/1927753/totte-karlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2954, "favorite_count": 5, "answer_count": 3, "score": 31, "last_activity_date": 1610549536, "creation_date": 1527712699, "last_edit_date": 1529696734, "question_id": 50613010, "link": "https://stackoverflow.com/questions/50613010/passing-a-c-object-to-python", "title": "Passing a C++ object to Python", "body": "<p>This question is about <em>how to pass a C++ object to a python function that is called in a (C++) embedded Python interpreter</em>. </p>\n\n<p>The following C++ class (MyClass.h) is designed for testing:</p>\n\n<pre><code>#ifndef MyClassH\n#define MyClassH\n#include &lt;string&gt;\n\nusing std::string;\nclass MyClass\n{\n    public:\n                        MyClass(const string&amp; lbl): label(lbl) {}\n                        ~MyClass(){}\n        string          getLabel() {return label;}\n\n    private:\n        string          label;\n};\n#endif\n</code></pre>\n\n<p>A python module, exposing the C++ class, can be generated by the following Swig interface file:</p>\n\n<pre><code>%module passmetopython\n\n%{    #include \"MyClass.h\"    %}\n\n%include \"std_string.i\"\n\n//Expose to Python\n%include \"MyClass.h\"\n</code></pre>\n\n<p>Below is a Python script using the python module</p>\n\n<pre><code>import passmetopython as pmtp\n\ndef execute(obj):\n    #This function is to be called from C/C++, with a\n    #MyClass object as an argument\n    print (\"Entering execute function\")\n    lbl = obj.getLabel();\n    print (\"Printing from within python execute function. Object label is: \" + lbl)\n    return True\n\ndef main():\n    c = pmtp.MyClass(\"Test 1\")\n    retValue = execute(c)\n    print(\"Return value: \" + str(retValue))\n\n#Test function from within python\nif __name__ == '__main__':\n    main()\n</code></pre>\n\n<p>This question is about how to get the python <em>execute()</em> function working, when called from c++, with a C++ object as an argument.</p>\n\n<p>The following C++ program was written to test the functions (minimum amount of error checking):</p>\n\n<pre><code>#include \"Python.h\"\n#include &lt;iostream&gt;\n#include &lt;sstream&gt;\n#include \"MyClass.h\"\n\nusing namespace std;\n\nint main()\n{\n    MyClass obj(\"In C++\");\n    cout &lt;&lt; \"Object label: \\\"\" &lt;&lt; obj.getLabel() &lt;&lt; \"\\\"\" &lt;&lt; endl;\n\n    //Setup the Python interpreter and eventually call the execute function in the\n    //demo python script\n    Py_Initialize();\n\n    //Load python Demo script, \"passmetopythonDemo.py\"\n    string PyModule(\"passmetopythonDemo\");\n    PyObject* pm = PyUnicode_DecodeFSDefault(PyModule.c_str());\n\n    PyRun_SimpleString(\"import sys\");\n    stringstream cmd;\n    cmd &lt;&lt; \"sys.path.append(\\\"\" &lt;&lt; \".\" &lt;&lt; \"\\\")\";\n    PyRun_SimpleString(cmd.str().c_str());\n    PyObject* PyModuleP = PyImport_Import(pm);\n    Py_DECREF(pm);\n\n    //Now create PyObjects for the Python functions that we want to call\n    PyObject* pFunc = PyObject_GetAttrString(PyModuleP, \"execute\");\n\n    if(pFunc)\n    {\n        //Setup argument\n        PyObject* pArgs = PyTuple_New(1);\n\n        //Construct a PyObject* from long\n        PyObject* pObj(NULL);\n\n        /* My current attempt to create avalid argument to Python */\n        pObj = PyLong_FromLong((long) &amp;obj);\n\n\n        PyTuple_SetItem(pArgs, 0, pObj);\n\n        /***** Calling python here *****/\n        cout&lt;&lt;endl&lt;&lt;\"Calling function with an MyClass argument\\n\\n\";\n        PyObject* res = PyObject_CallObject(pFunc, pArgs);\n        if(!res)\n        {\n            cerr &lt;&lt; \"Failed calling function..\";\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>When running the above code, the <strong>execute()</strong> python function, with a MyClass object as an argument, fails and returns NULL. However, the Python function is entered, as I can see the output (<em>Entering execute function</em>) in the console output, indicating that the object passed is not, <strong>indeed</strong>, a valid MyClass object.</p>\n\n<p>There are a lot of examples on how to pass simple types, like ints, doubles or string types to Python from C/C++. But there are very few example showing how to pass a C/C++ object/ pointer, which is kind of puzzling.</p>\n\n<p>The above code, with a CMake file, can be checked out from github: \n<a href=\"https://github.com/TotteKarlsson/miniprojects/tree/master/passMeToPython\" rel=\"nofollow noreferrer\">https://github.com/TotteKarlsson/miniprojects/tree/master/passMeToPython</a></p>\n\n<p>This code is not to use any boost python or other API's. Cython sounds interesting though, and if it can be used to simplify on the C++ side, it could be acceptable.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1527712417, "post_id": 50612935, "comment_id": 88235819, "body": "What is the point of right-padding a line with spaces - you would not be able to see them?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527712931, "post_id": 50612935, "comment_id": 88236009, "body": "@NeilButterworth Most likely this will have something else concatenated after it. Notice that there&#39;s no newline."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1527713192, "post_id": 50612935, "comment_id": 88236083, "body": "The question is tagged C++, so why are you using C style formatting via <code>sprintf()</code> at all, and not C++ style formatting via <code>std::ostream</code>, such as <code>std::ostringstream</code>? You can pad and align the output using the <a href=\"http://en.cppreference.com/w/cpp/io/manip/setw\" rel=\"nofollow noreferrer\"><code>std::setw()</code></a> and <a href=\"http://en.cppreference.com/w/cpp/io/manip/left\" rel=\"nofollow noreferrer\"><code>std::left</code></a> stream manipulators."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527713839, "post_id": 50612935, "comment_id": 88236360, "body": "<a href=\"https://ideone.com/EpihqE\" rel=\"nofollow noreferrer\">Live Demo for C++</a>"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527713844, "post_id": 50612935, "comment_id": 88236362, "body": "@RemyLebeau: TBH, even in C++ I&#39;d use <code>sprintf</code> (actually, my wrapper which handles the buffer by itself and returns an <code>std::string</code>), way more concise and easier to read, without all those stupid formatters (and the time lost to check which is sticky and which is not) in the way. Then to pad right I&#39;d just call <code>.resize(20, &#39; &#39;)</code>. <code>oss &lt;&lt; std::setfill(&#39;0&#39;) &lt;&lt; std::setw(2) &lt;&lt; month &lt;&lt; &quot;&#47;&quot; &lt;&lt; std::setw(2) &lt;&lt; day &lt;&lt; &quot;&#47;&quot; &lt;&lt; std::setw(4) &lt;&lt; year;</code> - seriously? I cannot even see that we are talking about a date in <code>mm&#47;dd&#47;yyyy</code> format without parsing through a row of line noise."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1527714138, "post_id": 50612935, "comment_id": 88236465, "body": "@MatteoItalia perhaps, but the C++ way is much safer. Too many times, people get the <code>printf</code> format string wrong (case in point)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1527714176, "post_id": 50612935, "comment_id": 88236489, "body": "<code>sprintf(lcdContent_line1, &quot;%-19s&quot;, lcdContent_line1);</code> has the source and destination overlap.  This is <i>undefined behavior</i> and a wrong solution.  Better to post your answer as an answer below than appending to the question.  The question needs a bit more detail and your answer is wrong.  DV until repaired."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527714930, "post_id": 50612935, "comment_id": 88236758, "body": "@RemyLebeau: <a href=\"https://ideone.com/5VDW4T\" rel=\"nofollow noreferrer\">that&#39;s why you have to domesticate it a bit...</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1527715147, "post_id": 50612935, "comment_id": 88236836, "body": "@MatteoItalia C++11 and later have <a href=\"http://en.cppreference.com/w/cpp/io/manip/put_time\" rel=\"nofollow noreferrer\"><code>std::put_time()</code></a>, which is closer to the <code>printf</code> functionality without losing safety.  I updated <a href=\"https://ideone.com/EpihqE\" rel=\"nofollow noreferrer\">my demo</a> to show it"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527715353, "post_id": 50612935, "comment_id": 88236916, "body": "@RemyLebeau: that&#39;s nice and everything for this use case, but I still find absurd that C++ still doesn&#39;t have a type-safe, placeholder-based formatting straight in the standard."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1527715426, "post_id": 50612935, "comment_id": 88236944, "body": "@MatteoItalia feel free to write your own implementation and submit it to the C++ committee for review."}], "answers": [{"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 3, "last_activity_date": 1527713202, "last_edit_date": 1527713202, "creation_date": 1527712537, "answer_id": 50612979, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50612979#50612979", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>AFAIK there's no way to do it in a single step; your second example is wrong because input and output overlap (actually, they are the same string), and this is definitely not allowed.</p>\n\n<p>You may fix it by using a separate buffer and let an <code>sprintf</code> pad your string, or you may come up with more clever stuff, such as</p>\n\n<pre><code>for(int i = sprintf(lcdContent_line1, \"%02d/%02d/%04d\", month, day, year);\n    i &lt; 20; ++i) lcdContent_line1[i] = ' ';\nlcdContent_line1[20] = 0;\n</code></pre>\n\n<p>to pad it inplace. </p>\n\n<p>But honestly, in this case the easiest solution is probably</p>\n\n<pre><code>sprintf(lcdContent_line1, \"%02d/%02d/%04d          \", month, day, year);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 142, "user_id": 3664012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dc9411b4c9a7800a70b5d91d5f18195?s=128&d=identicon&r=PG&f=1", "display_name": "Iridium237", "link": "https://stackoverflow.com/users/3664012/iridium237"}, "edited": false, "score": 0, "creation_date": 1527873563, "post_id": 50613184, "comment_id": 88307153, "body": "I&#39;m not sure I understand what you mean by 10 circa about. Could you clarify this solution? What does the %*c formatting do? Why are their 5 arguments but only 4 format placeholders?"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "reply_to_user": {"reputation": 142, "user_id": 3664012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dc9411b4c9a7800a70b5d91d5f18195?s=128&d=identicon&r=PG&f=1", "display_name": "Iridium237", "link": "https://stackoverflow.com/users/3664012/iridium237"}, "edited": false, "score": 0, "creation_date": 1527877236, "post_id": 50613184, "comment_id": 88308832, "body": "1. &quot;circa&quot; - ... count characters You require. 2. <a href=\"https://linux.die.net/man/3/sprintf\" rel=\"nofollow noreferrer\">linux.die.net/man/3/sprintf</a> and find here <code>%*</code> example. Star is very interesting (gets one more parameters than simple arguments)"}], "tags": [], "owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "is_accepted": false, "score": 4, "last_activity_date": 1527877358, "last_edit_date": 1527877358, "creation_date": 1527713532, "answer_id": 50613184, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50613184#50613184", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>My proposal</p>\n\n<pre><code>int whatYouWant = 10 circa about;\nsprintf(lcdContent_line1, \"%02d/%02d/%04d%*c\", month, day, year, whatYouWant, ' ');\n</code></pre>\n\n<p>Update: Link to documentation: <a href=\"https://linux.die.net/man/3/sprintf\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/sprintf</a>\nand here go to example </p>\n\n<pre><code>printf(\"%*d\", width, num);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1527714351, "creation_date": 1527714351, "answer_id": 50613352, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50613352#50613352", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>In addition to the answer of Jacek Cz, which is based on a fixed size date format, you could use <code>%n</code> to get the number of characters of a non-fixed format. See the following code demonstrating this on the example of a single integral value with variable length in the output:</p>\n\n<pre><code>int main() {\n\n    char x[50];\n    int nrOfChars=0;\n    sprintf(x,\"%d%n\",123567,&amp;nrOfChars);\n    sprintf(x+nrOfChars,\"%*c|\",20-nrOfChars,' ');\n\n    printf(\"012345678901234567890123456789\\n\");\n    printf(\"%s\\n\",x);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>012345678901234567890123456789\n123567              |\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1527715052, "creation_date": 1527715052, "answer_id": 50613464, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50613464#50613464", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p><code>sprintf</code> conveniently returns \"the number of characters printed (excluding the null byte used to end output to strings).\" (Found in <code>man sprintf</code> although roughly the same wording appears in the C standard.)</p>\n\n<p>So: </p>\n\n<pre><code>char lcdContent_line1[40]; /* Or whatever you need */\n/* Use snprintf just in case */\nint printed = snprintf(lcdContent_line1, sizeof(lcdContent), \n                       \"%02d/%02d/%04d\", month, day, year);\nif (printed &gt;= 0 &amp;&amp; printed &lt; 20)\n  sprintf(lcdContent_line1 + printed, \"%*s\", 20 - printed, \"\");\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 3664012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dc9411b4c9a7800a70b5d91d5f18195?s=128&d=identicon&r=PG&f=1", "display_name": "Iridium237", "link": "https://stackoverflow.com/users/3664012/iridium237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 50612979, "answer_count": 4, "score": 2, "last_activity_date": 1527877358, "creation_date": 1527712346, "last_edit_date": 1527805534, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>So I'm using sprintf to produce a formatted char[] for displaying the date.</p>\n\n<pre><code>sprintf(lcdContent_line1, \"%02d/%02d/%04d\", month, day, year);\n</code></pre>\n\n<p>But I would also like to have the entire result right-padded with spaces for a total length of 20 characters. I've tried:</p>\n\n<pre><code>sprintf(lcdContent_line1, \"%-20s\", lcdContent_line1);\n</code></pre>\n\n<p>But that just blows out the whole thing. Is there a way to compose the format string so that I can right pad this entire thing?</p>\n\n<p>EDIT:</p>\n\n<p>LOLOL simple solution:</p>\n\n<pre><code>memset(lcdContent_line1, 0, 20);\nsprintf(lcdContent_line1, \"%02d/%02d/%04d\", month, day, year);\nsprintf(lcdContent_line1, \"%-19s\", lcdContent_line1);\n</code></pre>\n\n<p>Turns out I was overrunning the buffer with %-20s since that was the entire length, you have to leave room for the 0. >.&lt;</p>\n\n<p>EDIT 2:</p>\n\n<p>Thanks to @chux for pointing out that this is, in fact, a terrible solution that has no right to work as well as it does. Undefined behavior hell is a real place where you will be sent at the first sign of defiance.</p>\n"}, {"tags": ["c++", "c++14"], "comments": [{"owner": {"reputation": 370, "user_id": 8326488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hv1L3.jpg?s=128&g=1", "display_name": "Sanjit Prasad", "link": "https://stackoverflow.com/users/8326488/sanjit-prasad"}, "edited": false, "score": 0, "creation_date": 1527795058, "post_id": 50612924, "comment_id": 88272963, "body": "Problem is here -&gt; outcomes.erase(it); . This should be changed to -&gt; outcomes.erase(it++);"}], "owner": {"reputation": 6080, "user_id": 270661, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1f113fa4c0a2e259f6f65accd611e3f6?s=128&d=identicon&r=PG", "display_name": "cateof", "link": "https://stackoverflow.com/users/270661/cateof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "closed_date": 1527712511, "answer_count": 0, "score": 1, "last_activity_date": 1527712266, "creation_date": 1527712266, "question_id": 50612924, "link": "https://stackoverflow.com/questions/50612924/error-when-removing-elements-from-stdmap", "closed_reason": "Duplicate", "title": "Error when removing elements from std::map", "body": "<p>I am trying to delete some elements from an std::map.\nIn particular the elements that have </p>\n\n<blockquote>\n  <p>value = 100</p>\n</blockquote>\n\n<p>should be deleted. However after running the following piece of code a bug occurs. An element with value 100 appears in the remaining map, after the erase(it) method. Where is the bug? </p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;map&gt;\n\nint main() {\n    std::map&lt;int, int&gt; outcomes;\n    outcomes.clear();\n\n    if ( !outcomes.insert( std::make_pair( 10, 1 ) ).second ) \n        return 0;\n    if ( !outcomes.insert( std::make_pair( 11, 100 ) ).second ) \n        return 0;\n    if ( !outcomes.insert( std::make_pair( 12, 100 ) ).second ) \n        return 0;\n    if ( !outcomes.insert( std::make_pair( 13, 100 ) ).second ) \n        return 0;\n    if ( !outcomes.insert( std::make_pair( 14, 100 ) ).second ) \n        return 0;\n    if ( !outcomes.insert( std::make_pair( 15, 101 ) ).second ) \n        return 0;\n    if ( !outcomes.insert( std::make_pair( 16, 101 ) ).second )\n        return 0;\n    if ( !outcomes.insert( std::make_pair( 17, 100 ) ).second )\n        return 0;\n\n    std::map&lt;int, int&gt;::iterator it = outcomes.begin();\n    while(it != outcomes.end())\n    {\n        std::cout&lt;&lt;it-&gt;first&lt;&lt;\" :: \"&lt;&lt;it-&gt;second&lt;&lt;std::endl;\n        it++;\n    }\n\n    it = outcomes.begin();\n    while(it != outcomes.end())\n    {\n        if( it-&gt;second == 100 )\n            outcomes.erase(it);\n        it++;\n    }\n    std::cout &lt;&lt; \"after delete\" &lt;&lt; std::endl;\n    it = outcomes.begin();\n    while(it != outcomes.end())\n    {\n        std::cout&lt;&lt;it-&gt;first&lt;&lt;\" :: \"&lt;&lt;it-&gt;second&lt;&lt;std::endl;\n        it++;\n    }\n    return 0;\n}  \n</code></pre>\n\n<p>Result is the following:</p>\n\n<pre><code>10 :: 1\n11 :: 100\n12 :: 100\n13 :: 100\n14 :: 100\n15 :: 101\n16 :: 101\n17 :: 100\nafter delete\n10 :: 1\n14 :: 100\n15 :: 101\n16 :: 101\n</code></pre>\n"}, {"tags": ["c++", "queue", "priority-queue", "singly-linked-list"], "comments": [{"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527712435, "post_id": 50612853, "comment_id": 88235829, "body": "You are saying that <code>bt1.getFrequence() - bt2.getFrequence()</code> is always <code>0</code>?  We would probably need to see that function to explain why that is."}, {"owner": {"reputation": 13, "user_id": 8775932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9152a6916c03e47af547b13692a1268?s=128&d=identicon&r=PG&f=1", "display_name": "Phyllis Vance", "link": "https://stackoverflow.com/users/8775932/phyllis-vance"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527713052, "post_id": 50612853, "comment_id": 88236046, "body": "The problem is not with getFrequence() function because the returned value is correct.                                                              ` ` `            <code>class PriorityQueue;            class BinaryTree { \t        Node* root; \t        BinaryTree* next; \t        int frequence; \t        friend class PriorityQueue;            public:           \tBinaryTree(const TElement&amp; e, int frq) { \t\troot = new Node(e); \t\tfrequence = frq; \t\tnext = nullptr; \t}  \tconst TFrequence&amp; getFrequence() const{ \t\treturn frequence; \t}       };</code>"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1527723720, "post_id": 50612853, "comment_id": 88239281, "body": "A larger question: Are you trying to implement a heap in that binary tree, or are you just building a binary search tree to serve as a priority queue? I&#39;ll tell you right away that it&#39;s much easier to implement a binary heap in an array or vector than it is to implement in a binary tree. If you&#39;re determined to implement a node-based heap, consider a <a href=\"https://en.wikipedia.org/wiki/Pairing_heap\" rel=\"nofollow noreferrer\">Paring Heap</a>, which is easier to implement and will perform better."}], "owner": {"reputation": 13, "user_id": 8775932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9152a6916c03e47af547b13692a1268?s=128&d=identicon&r=PG&f=1", "display_name": "Phyllis Vance", "link": "https://stackoverflow.com/users/8775932/phyllis-vance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1527711951, "creation_date": 1527711951, "question_id": 50612853, "link": "https://stackoverflow.com/questions/50612853/inline-function-always-returns-the-same-value", "title": "Inline function always returns the same value", "body": "<p>I am trying to implement my own priority queue that does the same thing as the standard priority queue from STL. The elements from queue have to respect an order, and for this I used a compare function. For this case the elements from queue are sorted ascending by their frequency and the compare function returns the difference between 2 elements' frequency. If the difference is less than 0, we found the place where the element should be inserted, otherwise the iteration continues.</p>\n\n<p>My struggle is that the compare function always returns the value 0 regardless of difference between frequences (eg if one element has frequency equals to 2 and other has it equals to 3, their difference if -1, but relation function will return 0). </p>\n\n<p>Here is the source code:</p>\n\n<pre><code>#pragma once\n#include\"BinaryTree.h\"\ntypedef int(*TRelation)(const BinaryTree&amp; bt1, const BinaryTree&amp; bt2);\n\n\ninline int getPriority(const BinaryTree&amp; bt1, const BinaryTree&amp; bt2) {\n    return bt1.getFrequence() - bt2.getFrequence();\n }\n\n\nclass PriorityQueue {\n\nTRelation relation;\nBinaryTree* first;\n\n\npublic:\n\nPriorityQueue() {\n    relation = getPriority;\n    first = nullptr;\n}\n\nvoid add(BinaryTree* e) {\n\n    if (first == nullptr) {\n        first = e;\n        return;\n    }\n    //add at start\n    if (relation(*e, *first)&lt;0)\n    {\n        BinaryTree *aux= first;\n        first = e;\n        e-&gt;next = aux;\n        return;\n    }\n    BinaryTree *pre=first ;\n    BinaryTree *current = first;\n    while (current!=nullptr &amp;&amp; relation(*e, *current)&gt;=0) {\n        pre = current;\n        current = current-&gt;next;\n    }\n    pre-&gt;next = e;\n    e-&gt;next = current;\n}\n</code></pre>\n\n<p>I also tried different implementation of getPriority() function like changing its returning type, elements' type, etc.</p>\n"}, {"tags": ["c++", "string", "search"], "comments": [{"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 3, "creation_date": 1527711786, "post_id": 50612799, "comment_id": 88235570, "body": "Hint: <code>&quot;$&quot;</code> and <code>&#39;$&#39;</code> are two very different things."}, {"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 1, "creation_date": 1527711821, "post_id": 50612799, "comment_id": 88235590, "body": "&#39;$&#39; single quotes not double"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527711826, "post_id": 50612799, "comment_id": 88235592, "body": "Those password requirements are awful, so hopefully you can fix that unless this is a purely academic exercise."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1527725766, "post_id": 50612799, "comment_id": 88239777, "body": "There&#39;s a separate problem: &quot;upr == lwr == dlr == num == 1` doesn&#39;t do anything sensible."}, {"owner": {"reputation": 57, "user_id": 9853182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c5dd6d58c5ec20493ae41593db633f?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterious User", "link": "https://stackoverflow.com/users/9853182/mysterious-user"}, "edited": false, "score": 0, "creation_date": 1527779087, "post_id": 50612799, "comment_id": 88264772, "body": "<a href=\"https://stackoverflow.com/users/87189/tadman\">@tadman</a> yes, this is just an exercise."}, {"owner": {"reputation": 57, "user_id": 9853182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c5dd6d58c5ec20493ae41593db633f?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterious User", "link": "https://stackoverflow.com/users/9853182/mysterious-user"}, "edited": false, "score": 0, "creation_date": 1527780011, "post_id": 50612799, "comment_id": 88265333, "body": "<a href=\"https://stackoverflow.com/users/1593860/pete-becker\">@Pete Becker</a> when all conditions are met, all of upr, lwr, dlr and num should be equal to 1."}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1527859445, "post_id": 50612799, "comment_id": 88299221, "body": "@MysteriousUser: C++ operators don&#39;t work like that. It&#39;ll work like <code>(((upr == lwr) == dlr) == num) == 1</code>, which will end up true if an even number of conditions is false. (If <i>all four</i> are false, for example, then you have <code>(((false == false) == false) == false) == 1</code> -&gt; <code>((true == false) == false) == 1</code> -&gt; <code>(false == false) == 1</code> -&gt; <code>true == 1</code>. (BTW, this in&#39;t C. Booleans are <code>true</code> and <code>false</code>, not 1 and 0.) Try <code>if (upr &amp;&amp; lwr &amp;&amp; dlr &amp;&amp; num)</code> instead."}, {"owner": {"reputation": 57, "user_id": 9853182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c5dd6d58c5ec20493ae41593db633f?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterious User", "link": "https://stackoverflow.com/users/9853182/mysterious-user"}, "edited": false, "score": 0, "creation_date": 1527860740, "post_id": 50612799, "comment_id": 88300069, "body": "Actually I didn&#39;t know that before, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527711876, "post_id": 50612830, "comment_id": 88235616, "body": "@NeilButterworth Yeah, it&#39;s integery-enough that the compiler gets what you&#39;re doing."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527711995, "post_id": 50612830, "comment_id": 88235671, "body": "@NeilButterworth I mean in contrast to an <code>int</code> or <code>long</code> integer, where &quot;integer&quot; and <code>int</code> are not to be confused."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527712082, "post_id": 50612830, "comment_id": 88235707, "body": "@NeilButterworth I know what you&#39;re saying, but what I mean is when people say &quot;integer&quot; in the context of C++ it often means <code>int</code> not as in integer vs. real in mathematical terms."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527712278, "post_id": 50612830, "comment_id": 88235770, "body": "@NeilButterworth Added some clarification."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1527712270, "last_edit_date": 1527712270, "creation_date": 1527711793, "answer_id": 50612830, "question_id": 50612799, "link": "https://stackoverflow.com/questions/50612799/searching-for-returns-an-error-in-c/50612830#50612830", "title": "Searching for &quot;$&quot; returns an error in C++", "body": "<p><code>\"$\"</code> is a <em>C string</em> because it uses double quotes, so it's similar to <code>const char*</code>. What you want is a character:</p>\n\n<pre><code>if(x[i] == '$') {\n  // ...\n}\n</code></pre>\n\n<p>Where <code>'$'</code> uses single quotes and is a character, or <code>char</code>, which is an integer value. Here <a href=\"https://en.wikipedia.org/wiki/Integer\" rel=\"nofollow noreferrer\">\"integer\"</a> is not to be confused with the specific <code>int</code> type.</p>\n"}], "owner": {"reputation": 57, "user_id": 9853182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c5dd6d58c5ec20493ae41593db633f?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterious User", "link": "https://stackoverflow.com/users/9853182/mysterious-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1527712092, "accepted_answer_id": 50612830, "answer_count": 1, "score": 0, "last_activity_date": 1527712270, "creation_date": 1527711683, "question_id": 50612799, "link": "https://stackoverflow.com/questions/50612799/searching-for-returns-an-error-in-c", "closed_reason": "Duplicate", "title": "Searching for &quot;$&quot; returns an error in C++", "body": "<p>I want to find whether a password entered by the user is valid or invalid. For this case, a valid password is one which contains at least one uppercase letter, one lowercase letter, one number and one dollar sign ($). When I search for the dollar sign the compiler throws an error:</p>\n\n<blockquote>\n  <p>ISO C++ forbids comparison between pointer and integer</p>\n</blockquote>\n\n<p>This is how I search for the dollar sign:</p>\n\n<pre><code>for(int i = 0; i &lt; x.length(); i++) {\n  if(x[i] == \"$\") {\n    dlr = 1;\n  }\n}\n</code></pre>\n\n<p>And this is the complete program:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n\nusing namespace std;\n\nint main () {\n  string x(\"\");\n  cin &gt;&gt; x;\n  bool upr = 0;\n  bool lwr = 0;\n  bool dlr = 0;\n  bool num = 0;\n  for(int i = 0; i &lt; x.length(); i++) {\n    if(isupper(x[i])) {\n      upr = 1;\n    }\n\n    if(islower(x[i])) {\n      lwr = 1;\n    }\n\n    if(x[i] == \"$\") {\n      dlr = 1;\n    }\n\n    if(isdigit(x[i])) {\n      num = 1;\n    }\n  }\n  if(upr == lwr == dlr == num == 1) {\n    cout &lt;&lt; \"The password is valid\";\n  } else {\n    cout &lt;&lt; \"The password is invalid\";\n  }\n  cout &lt;&lt; dlr;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "header-files"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527711707, "post_id": 50612774, "comment_id": 88235531, "body": "Short answer: Because C. Because compilers."}, {"owner": {"reputation": 697, "user_id": 1160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431cd02524d6ee187fcd1b3d9658498c?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/1160404/maddy"}, "edited": false, "score": 0, "creation_date": 1527711745, "post_id": 50612774, "comment_id": 88235548, "body": "Header file shall have your class signature while your cpp file will have the implementation details"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1527711803, "post_id": 50612774, "comment_id": 88235579, "body": "Have you tried without? Did it work?"}, {"owner": {"reputation": 194, "user_id": 8708368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKZAv.png?s=128&g=1", "display_name": "luG_0", "link": "https://stackoverflow.com/users/8708368/lug-0"}, "edited": false, "score": 0, "creation_date": 1527711861, "post_id": 50612774, "comment_id": 88235609, "body": "Nope it didnt work"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1527712389, "post_id": 50612774, "comment_id": 88235808, "body": "The marked duplicate doesn&#39;t really answer the question this one seems to be asking.  This question seems to specifically be interested in why the header with a class&#39;s definition needs to be included in the translation unit(s) defining that class&#39;s members."}, {"owner": {"reputation": 194, "user_id": 8708368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKZAv.png?s=128&g=1", "display_name": "luG_0", "link": "https://stackoverflow.com/users/8708368/lug-0"}, "edited": false, "score": 0, "creation_date": 1527712508, "post_id": 50612774, "comment_id": 88235860, "body": "Exactly!! thats what i wanted to ask"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1527713378, "post_id": 50612774, "comment_id": 88236169, "body": "@MilesBudnek: I&#39;ve added another dupe to cover that. The first covers the title question."}, {"owner": {"reputation": 194, "user_id": 8708368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKZAv.png?s=128&g=1", "display_name": "luG_0", "link": "https://stackoverflow.com/users/8708368/lug-0"}, "edited": false, "score": 0, "creation_date": 1527713453, "post_id": 50612774, "comment_id": 88236201, "body": "Yup ,that does answer it."}], "owner": {"reputation": 194, "user_id": 8708368, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QKZAv.png?s=128&g=1", "display_name": "luG_0", "link": "https://stackoverflow.com/users/8708368/lug-0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "closed_date": 1527711744, "answer_count": 0, "score": 0, "last_activity_date": 1527713086, "creation_date": 1527711519, "question_id": 50612774, "link": "https://stackoverflow.com/questions/50612774/purpose-of-header-files-in-cpp", "closed_reason": "Duplicate", "title": "Purpose of header files in cpp", "body": "<p>Why is there a need to include the header file of a class into the implementation file of the same class??\nDoes it serve a purpose??</p>\n\n<p>Since i thought it is needed only where we need to use that class.</p>\n"}, {"tags": ["c++", "cmake", "position-independent-code"], "comments": [{"owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "edited": false, "score": 0, "creation_date": 1527711270, "post_id": 50612673, "comment_id": 88235360, "body": "What versions of <code>cmake</code> and <code>g++</code> are you using?"}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1527711961, "post_id": 50612673, "comment_id": 88235654, "body": "Note that the use of <code>$(A_SRC)</code> is deprecated. You should be using <code>${A_SRC}</code> instead (I&#39;ve never used <code>$(...)</code>, so I&#39;m not certain on how it works, so it might be slightly different than that)"}, {"owner": {"reputation": 6693, "user_id": 233928, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2ebb47a2f272e8fe85a1b9106c4c1714?s=128&d=identicon&r=PG", "display_name": "Dov", "link": "https://stackoverflow.com/users/233928/dov"}, "edited": false, "score": 0, "creation_date": 1527793621, "post_id": 50612673, "comment_id": 88272328, "body": "Sorry, I typed a shortened version and messed that up. The variables are using curly braces"}], "owner": {"reputation": 6693, "user_id": 233928, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2ebb47a2f272e8fe85a1b9106c4c1714?s=128&d=identicon&r=PG", "display_name": "Dov", "link": "https://stackoverflow.com/users/233928/dov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527793540, "creation_date": 1527711011, "last_edit_date": 1527793540, "question_id": 50612673, "link": "https://stackoverflow.com/questions/50612673/position-indepdendent-code-for-shared-object-file-under-cmake", "title": "position indepdendent code for shared object file under cmake?", "body": "<p>We created a shared object file and linked to our executable:</p>\n\n<pre><code>add_executable(a ${A_SRC})\nadd_library(testso SHARED src/mainlib.cc test1.cc test2.cc)\ntarget_link_libraries(a, testso)\n</code></pre>\n\n<p>we notice that the code is compiling without <code>-fPIC</code>, but the link uses <code>-fPIC</code>:</p>\n\n<pre><code>g++ -std=c++11 -g -c -i../../src ./test1.cc\ng++ -std=c++11 -shared -fPIC ../mainlib.cc test1.o -o testso.so\n</code></pre>\n\n<p>Is the <code>-fPIC</code> flag required on each file?  Will we crash at some point or is this ok?</p>\n"}, {"tags": ["c++", "operator-overloading", "operators", "chrono"], "comments": [{"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1527709281, "post_id": 50612295, "comment_id": 88234509, "body": "ms means milliseconds, ns means nanoseconds..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1527709352, "post_id": 50612295, "comment_id": 88234547, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/user_literal\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/user_literal</a>"}, {"owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1527709461, "post_id": 50612295, "comment_id": 88234589, "body": "@Rakete1111 I said that"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1527709571, "post_id": 50612295, "comment_id": 88234649, "body": "No, you didn&#39;t: <code>ns means milliseconds</code>"}, {"owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "edited": false, "score": 0, "creation_date": 1527709573, "post_id": 50612295, "comment_id": 88234650, "body": "@NeilButterworth you can post this an answer , it was useful"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1527709774, "post_id": 50612295, "comment_id": 88234728, "body": "I can post it without your permission, but I won&#39;t as links are not answers."}, {"owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "edited": false, "score": 0, "creation_date": 1527709799, "post_id": 50612295, "comment_id": 88234738, "body": "@NeilButterworth Ah it was typo"}], "answers": [{"comments": [{"owner": {"reputation": 177852, "user_id": 576911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2a2941970f141aad669d13375dc57c4f?s=128&d=identicon&r=PG", "display_name": "Howard Hinnant", "link": "https://stackoverflow.com/users/576911/howard-hinnant"}, "edited": false, "score": 2, "creation_date": 1527717849, "post_id": 50612600, "comment_id": 88237762, "body": "Literal suffix identifiers that do not start with an underscore are reserved for future standardization."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 1, "last_activity_date": 1527710884, "last_edit_date": 1527710884, "creation_date": 1527710672, "answer_id": 50612600, "question_id": 50612295, "link": "https://stackoverflow.com/questions/50612295/operators-in-c-chrono/50612600#50612600", "title": "Operators in c++ chrono", "body": "<p>Those are <a href=\"http://en.cppreference.com/w/cpp/language/user_literal\" rel=\"nofollow noreferrer\">User Defined Literals</a>. Yes, you can define your own.</p>\n\n<p>In a product I work on, we have defined several literals. For example, one is named <code>_qs</code> for <code>QString</code> literals, so we can write <code>\"meow\"_qs</code> and that is then a <code>QString</code> object - so we can do, for example:</p>\n\n<pre><code>const int num_cats = 42;\nconst auto foo = \"we have %1 cats\"_qs.arg(num_cats);\n</code></pre>\n\n<p>and <code>foo</code> will be a <code>QString</code> containing the text <code>\"we have 42 cats\"</code>. Quite handy.</p>\n"}], "owner": {"reputation": 991, "user_id": 9679554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c0ec4ba34353083598e5abe63e7bc7?s=128&d=identicon&r=PG&f=1", "display_name": "dev65", "link": "https://stackoverflow.com/users/9679554/dev65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 50612600, "answer_count": 1, "score": -4, "last_activity_date": 1527732422, "creation_date": 1527709233, "last_edit_date": 1527732422, "question_id": 50612295, "link": "https://stackoverflow.com/questions/50612295/operators-in-c-chrono", "title": "Operators in c++ chrono", "body": "<p>What are these operators in C++ chrono : <code>s</code> <code>10s</code> , <code>ns 10ns</code> , <code>ms 10 ms</code> , <code>h 10h</code>, <code>min 10 min</code>  I know that in <code>10s</code> means 10 seconds, <code>ms</code> means milliseconds, and so on.</p>\n\n<p>Can I use letters as operators, or can I overload them?</p>\n"}, {"tags": ["c++", "arrays"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527708223, "post_id": 50611993, "comment_id": 88234021, "body": "Unrelated, <code>int Bush[total];</code> - don&#39;t do that. VLAs are not standard compliant. use a <code>std::vector&lt;int&gt; Bush(total);</code>. And fyi, this whole thing falls apart when <code>total</code> isn&#39;t successfully read, so you may as well fix that while you&#39;re at it. Finally, something tells me the <i>modulo</i> operator would make most of the conditionals in this code disappear. Look in to that too."}, {"owner": {"reputation": 826, "user_id": 1402389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599c4eaaff0f5d2c3fe5feca6560173b?s=128&d=identicon&r=PG", "display_name": "FBergo", "link": "https://stackoverflow.com/users/1402389/fbergo"}, "edited": false, "score": 0, "creation_date": 1527708234, "post_id": 50611993, "comment_id": 88234030, "body": "the last element is total-1, not total, the if (i==0) line is accessing garbage past the end of the array."}, {"owner": {"reputation": 415, "user_id": 7305358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909955eb7835150dae7bfbfa4e587e23?s=128&d=identicon&r=PG&f=1", "display_name": "Zinki", "link": "https://stackoverflow.com/users/7305358/zinki"}, "edited": false, "score": 0, "creation_date": 1527708271, "post_id": 50611993, "comment_id": 88234044, "body": "off-topic, but comments like &quot;assigning the temp value to the current output value&quot; are completely unnecessary. Everyone knows what <code>temp = output</code> does. If you&#39;re going to comment, you should comment on things that aren&#39;t immediately apparent."}], "answers": [{"tags": [], "owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "is_accepted": false, "score": 1, "last_activity_date": 1527708101, "creation_date": 1527708101, "answer_id": 50612041, "question_id": 50611993, "link": "https://stackoverflow.com/questions/50611993/checking-the-neighbour-values-of-arrays/50612041#50612041", "title": "Checking the neighbour values of arrays", "body": "<p>When <code>i = 0</code>, the expression <code>Bush[i-1]</code> results in accessing an invalid location of the array <code>(- 1)</code>.</p>\n\n<p>Similarly, when <code>i = total - 1</code> (last index of iteration), the expression  <code>Bush[i+1]</code> gives you an index of <code>total</code> which is out of bounds of the array. </p>\n"}, {"comments": [{"owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "reply_to_user": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 0, "creation_date": 1527708387, "post_id": 50612086, "comment_id": 88234102, "body": "if(i == 0)output = Bush[i] + Bush[i+1] + Bush[total]; //Bush[total] is wrong should be Bush[total-1]"}, {"owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "reply_to_user": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "edited": false, "score": 0, "creation_date": 1527710985, "post_id": 50612086, "comment_id": 88235265, "body": "there were some comments now deleted...so I thought that an edit was a kind of messing up the thing..."}], "tags": [], "owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "is_accepted": false, "score": 0, "last_activity_date": 1527708272, "creation_date": 1527708272, "answer_id": 50612086, "question_id": 50611993, "link": "https://stackoverflow.com/questions/50611993/checking-the-neighbour-values-of-arrays/50612086#50612086", "title": "Checking the neighbour values of arrays", "body": "<p>The last element of <code>Bush</code> is at index <code>total -1</code>, but you are accessing <code>Bush[total]</code> when <code>i==0</code></p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 9872285, "user_type": "registered", "profile_image": "https://graph.facebook.com/2022004191459809/picture?type=large", "display_name": "\u041f\u043b\u0430\u043c\u0435\u043d \u0426\u0430\u043d\u0435\u0432", "link": "https://stackoverflow.com/users/9872285/%d0%9f%d0%bb%d0%b0%d0%bc%d0%b5%d0%bd-%d0%a6%d0%b0%d0%bd%d0%b5%d0%b2"}, "edited": false, "score": 0, "creation_date": 1527768815, "post_id": 50612222, "comment_id": 88257881, "body": "ok, thanks for sharing this code, but I have only the question why is temp equal to INT_MIN"}, {"owner": {"reputation": 11, "user_id": 9324637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e8e09fff879345f0f8025755542de5?s=128&d=identicon&r=PG&f=1", "display_name": "Snapster", "link": "https://stackoverflow.com/users/9324637/snapster"}, "reply_to_user": {"reputation": 63, "user_id": 9872285, "user_type": "registered", "profile_image": "https://graph.facebook.com/2022004191459809/picture?type=large", "display_name": "\u041f\u043b\u0430\u043c\u0435\u043d \u0426\u0430\u043d\u0435\u0432", "link": "https://stackoverflow.com/users/9872285/%d0%9f%d0%bb%d0%b0%d0%bc%d0%b5%d0%bd-%d0%a6%d0%b0%d0%bd%d0%b5%d0%b2"}, "edited": false, "score": 0, "creation_date": 1527800995, "post_id": 50612222, "comment_id": 88275907, "body": "sorry actually output should be INT_MIN, I modified the above code, because for the first time, the temp value can be negative number, but still output should save that value or if your list is (-1,-2,-3) result should be -6 but the program may output 0 if output is initialized to 0 instead of INT_MIN"}], "tags": [], "owner": {"reputation": 11, "user_id": 9324637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e8e09fff879345f0f8025755542de5?s=128&d=identicon&r=PG&f=1", "display_name": "Snapster", "link": "https://stackoverflow.com/users/9324637/snapster"}, "is_accepted": false, "score": 0, "last_activity_date": 1527800795, "last_edit_date": 1527800795, "creation_date": 1527708919, "answer_id": 50612222, "question_id": 50611993, "link": "https://stackoverflow.com/questions/50611993/checking-the-neighbour-values-of-arrays/50612222#50612222", "title": "Checking the neighbour values of arrays", "body": "<p>I think the below code would work</p>\n\n<pre><code>int main()\n{\nint total;\n\ncout &lt;&lt; \"Enter Number of Elements \" &lt;&lt; endl;\ncin&gt;&gt;total;\nint Bush[total];//array of numbers\nint temp = 0, output = INT_MIN; //output variable and a container for the last resurt a.k.a temp\ncout &lt;&lt; \"Enter the Elements \" &lt;&lt; endl;\n\nfor(int i = 0; i&lt;=total - 1; i++)\n{\n    cin&gt;&gt;Bush[i];//inputting the array elements\n}\nfor(int i = 0; i&lt;total; i++)\n{\n    if(i == 0)\n        temp = Bush[i] + Bush[i+1] + Bush[total -1];//checking if the loop checks the first number\n\n    else if(i == total - 1)\n        temp = Bush[i] + Bush[0] + Bush[i-1];//checking if the loop checks the first number\n    else\n        temp = Bush[i] + Bush[i+1] + Bush[i-1]; //assigning the temp value to the current output value\n\n    output = (temp &gt; output)?temp:output;\n\n}\ncout&lt;&lt;output&lt;&lt;endl;//outputting\nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1012, "user_id": 1140699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03e1201825435665b90495a653c4643?s=128&d=identicon&r=PG", "display_name": "Stefano Buora", "link": "https://stackoverflow.com/users/1140699/stefano-buora"}, "is_accepted": false, "score": 0, "last_activity_date": 1527709166, "creation_date": 1527709166, "answer_id": 50612282, "question_id": 50611993, "link": "https://stackoverflow.com/questions/50611993/checking-the-neighbour-values-of-arrays/50612282#50612282", "title": "Checking the neighbour values of arrays", "body": "<p>At the end, there are many mistakes in your code, nonetheless, the problem with the if/else structure.</p>\n\n<p>I would suggest you to use another inner loop, based on module operator that simplify the code a lot:</p>\n\n<pre><code>int max = 0;\nfor(int i = 0; i&lt;total; i++)\n{\n  output = Bush[i] + Bush[(i+1)%total] + Bush[(i-1+total)%total];\n  if(max &lt; output) max = output;//checking the max\n}\ncout&lt;&lt;max&lt;&lt;endl;//outputting\n</code></pre>\n\n<p>that does the operation you required.</p>\n\n<p>Hope this may help.</p>\n"}], "owner": {"reputation": 63, "user_id": 9872285, "user_type": "registered", "profile_image": "https://graph.facebook.com/2022004191459809/picture?type=large", "display_name": "\u041f\u043b\u0430\u043c\u0435\u043d \u0426\u0430\u043d\u0435\u0432", "link": "https://stackoverflow.com/users/9872285/%d0%9f%d0%bb%d0%b0%d0%bc%d0%b5%d0%bd-%d0%a6%d0%b0%d0%bd%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1527800795, "creation_date": 1527707867, "last_edit_date": 1527709157, "question_id": 50611993, "link": "https://stackoverflow.com/questions/50611993/checking-the-neighbour-values-of-arrays", "title": "Checking the neighbour values of arrays", "body": "<p>I have an array of numbers with length <code>L</code>, and I have to make the program check the sums of every array element with its preceding and following neighbors.</p>\n\n<p>So, for example, if I have the array being <code>{1, 2, 3}</code>, the output for the 2nd element should be <code>6</code> because <code>1 + 2 + 3 = 6</code> and they are all neighbors.</p>\n\n<p>If the chosen element is the first element in the array, its preceding neighbor is the last element of the array, and if the element is the last element in the array, the following neighbor is the first element of the array.  So, in the <code>{1, 2, 3}</code> example, no matter what number you check, you always get <code>6</code>, but if it were <code>{1, 2, 3, 4}</code> instead, the answer for the 3rd element would be <code>9</code> because <code>3 + 2 + 4 = 9</code>.</p>\n\n<p>I hope you understood how it should work.</p>\n\n<p>The problem I am getting is that the output is out of control. I tried to check the array itself and it is completely normal. In the <code>{1, 2, 3}</code> example, I get an output of <code>7208681</code> and I don't know why.</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\n    int total;\n    cin &gt;&gt; total;\n    int Bush[total]; //array of numbers\n\n    int temp, output = 0; //output variable and a container for the last resurt a.k.a temp\n\n    for (int i = 0; i &lt;= total - 1; i++)\n    {\n        cin &gt;&gt; Bush[i]; //inputting the array elements\n    }\n    for (int i = 0; i &lt; total; i++)\n    {\n        if (i == 0)\n            output = Bush[i] + Bush[i + 1] + Bush[total]; //checking if the loop checks the first number\n        if (i == total - 1)\n            output = Bush[i] + Bush[0] + Bush[i - 1]; //checking if the loop checks the first number\n\n        temp = output;                                //assigning the temp value to the current output value\n        output = Bush[i] + Bush[i + 1] + Bush[i - 1]; //assigning a new output value\n\n        if (temp &gt; output)\n            output = temp; //checking values\n    }\n\n    cout &lt;&lt; output &lt;&lt; endl; //outputting\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "boost", "boost-hana"], "answers": [{"tags": [], "owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "is_accepted": true, "score": 2, "last_activity_date": 1527709611, "last_edit_date": 1527709611, "creation_date": 1527708888, "answer_id": 50612217, "question_id": 50611863, "link": "https://stackoverflow.com/questions/50611863/boost-hana-convert-hana-types-to-stdstrings/50612217#50612217", "title": "Boost Hana : Convert Hana Types to std::string&#39;s", "body": "<p>If you are using Clang, Hana has an experimental feature <a href=\"http://boostorg.github.io/hana/group__group-experimental.html#gaf14876d1f1a3c42ce7a0243d7b263bec\" rel=\"nofollow noreferrer\"><code>hana::experimental::type_name</code></a>. This can be used to get the type-names of the members of the struct:</p>\n\n<pre><code>#include &lt;boost/hana.hpp&gt;\n#include &lt;boost/hana/experimental/type_name.hpp&gt;\n\nnamespace hana = boost::hana;\n\ntemplate &lt;typename Struct&gt;\nauto member_type_names() {\n    constexpr auto accessors = hana::accessors&lt;Struct&gt;();\n\n    return hana::transform(\n        accessors,\n        hana::compose(\n            [](auto get) {\n                using member_type\n                    = std::decay_t&lt;decltype(get(std::declval&lt;Struct&gt;()))&gt;;\n\n                return hana::experimental::type_name&lt;member_type&gt;();\n            },\n            hana::second\n        )\n    );\n}\n</code></pre>\n\n<p>Demo (<a href=\"https://wandbox.org/permlink/uuhN0Ua9oYGvhmmy\" rel=\"nofollow noreferrer\">live on Wandbox</a>):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nstruct MyType {\n    int a;\n    std::string b;\n    float c;\n};\n\nBOOST_HANA_ADAPT_STRUCT(MyType, a, b, c);\n\nint main() {\n    hana::for_each(member_type_names&lt;MyType&gt;(), [](auto name) {\n        // Note that the type of `name` is a hana::string, not a std::string\n        std::cout &lt;&lt; name.c_str() &lt;&lt; '\\n';\n    });\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>int\nstd::__1::basic_string&lt;char&gt;\nfloat\n</code></pre>\n"}], "owner": {"reputation": 270, "user_id": 8245487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z5WQK.jpg?s=128&g=1", "display_name": "&#208;..", "link": "https://stackoverflow.com/users/8245487/%c3%90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 50612217, "answer_count": 1, "score": 2, "last_activity_date": 1527864030, "creation_date": 1527707310, "last_edit_date": 1527864030, "question_id": 50611863, "link": "https://stackoverflow.com/questions/50611863/boost-hana-convert-hana-types-to-stdstrings", "title": "Boost Hana : Convert Hana Types to std::string&#39;s", "body": "<p>Does there exist a Boost Hana method for compile-time converting the types of members of a <strong>Struct</strong> concept to a STL container of std::string's of the typenames?</p>\n\n<p>For example,</p>\n\n<pre><code>MyType t();\nstd::array&lt;std::string, 3&gt; ls = boost::hana::typesToString(t);\nfor(std::string x : ls){\n     std::cout &lt;&lt; x &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Yields \"int string bool\" to STDOUT, </p>\n\n<p>With </p>\n\n<pre><code>class MyType{\n     int x; \n     std::string y;\n     bool z;\n}\n</code></pre>\n\n<p>The documentation clearly provides methods for getting the members and their values of an instance of a <strong>Struct</strong> concept, but I haven't found anything there that does this for the <em>types of the members</em>. A simpler task would be to do:</p>\n\n<pre><code> int x;\n std::string tName = boost::hana::typeId(x); //tName has value \"int\"\n</code></pre>\n\n<p>I've read <a href=\"https://stackoverflow.com/questions/81870/is-it-possible-to-print-a-variables-type-in-standard-c\">this post</a> but I'd like to know if there's a clean way out-of-the-box in Hana. Even better would be a way to iterate through the members of the <strong>Struct</strong> without having to know them by name.</p>\n"}, {"tags": ["c++", "function-pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1527707239, "post_id": 50611810, "comment_id": 88233596, "body": "In the code you posted, there is no point in dereferencing."}, {"owner": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "edited": false, "score": 0, "creation_date": 1527707285, "post_id": 50611810, "comment_id": 88233624, "body": "@NeilButterworth yes, but my question is in general ..."}, {"owner": {"reputation": 415, "user_id": 7305358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909955eb7835150dae7bfbfa4e587e23?s=128&d=identicon&r=PG&f=1", "display_name": "Zinki", "link": "https://stackoverflow.com/users/7305358/zinki"}, "edited": false, "score": 6, "creation_date": 1527707291, "post_id": 50611810, "comment_id": 88233629, "body": "It&#39;s valid C++ because the standard allows it. It is, however, pointless, as the standard also says that dereferencing a function pointer just gives the function pointer. <code>(**add)(3,2)</code> is also valid, as is <code>(***********add)(3,2)</code>, and all are functionally equivalent."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 415, "user_id": 7305358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909955eb7835150dae7bfbfa4e587e23?s=128&d=identicon&r=PG&f=1", "display_name": "Zinki", "link": "https://stackoverflow.com/users/7305358/zinki"}, "edited": false, "score": 2, "creation_date": 1527710301, "post_id": 50611810, "comment_id": 88234969, "body": "@Zinki Dereferencing the function pointer doesn&#39;t give the function pointer itself, but a reference to the function (which then decays back to a function pointer as often as necessary)."}], "answers": [{"tags": [], "owner": {"reputation": 3331, "user_id": 8038186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ac0cc4d0f1414caf2172751b2ded50?s=128&d=identicon&r=PG&f=1", "display_name": "KoralK", "link": "https://stackoverflow.com/users/8038186/koralk"}, "is_accepted": false, "score": 0, "last_activity_date": 1527820194, "last_edit_date": 1527820194, "creation_date": 1527723611, "answer_id": 50614724, "question_id": 50611810, "link": "https://stackoverflow.com/questions/50611810/function-call-syntax-through-a-pointer-dereference/50614724#50614724", "title": "Function call syntax through a pointer dereference", "body": "<p>I can't be sure if I am right, but here is a possible explanation:\nEvery function in c and as well as in c++ is a potential variable.\nPossible declaration of function is:</p>\n\n<pre><code>int (*MyFunction)(int, double);\n</code></pre>\n\n<p>In this case- Variable name: <code>MyFunction</code> | Type: function that returns <code>int</code> with <code>int, double</code> parameters.</p>\n\n<p>So, even when you declare function, you actually declare variable with a \"function\" type. In this case, it is make sense why can you use, in your case <code>(*add)(3, 2)</code> for function calling (or using a variable).</p>\n\n<p>It may by more clearly for you to have a look on lambda expressions, which can make a function implementation, and then let you use it like a local function variable:</p>\n\n<pre><code>int(*MyFunction)(int, double) = [](int a, double b) -&gt; int {\n    return (int)((a + b) * 10);\n};\n</code></pre>\n\n<p>Here we declare on function type variable, and implement a function for it with a lambda expression. Now we can use it in two forms:</p>\n\n<pre><code>MyFunction(1, 2.5); // Like a regular function\n(*MyFunction)(1, 2.5); // As a function type variable\n</code></pre>\n\n<p>Again, it is the most sense explanation that I could think of. I don't sure if it is a right/best/fully explanation, but I hope it gave you a new perspective of functions.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1527738806, "creation_date": 1527738806, "answer_id": 50616391, "question_id": 50611810, "link": "https://stackoverflow.com/questions/50611810/function-call-syntax-through-a-pointer-dereference/50616391#50616391", "title": "Function call syntax through a pointer dereference", "body": "<p>This syntax exists because C had it, and C++ syntax was originally based on C. </p>\n\n<p>There is no difference in the code behaviour of <code>f(args)</code> and <code>(*f)(args)</code>.</p>\n"}], "owner": {"reputation": 841, "user_id": 3450869, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4cd9f192289fd574ad0c67b24b096684?s=128&d=identicon&r=PG&f=1", "display_name": "ampawd", "link": "https://stackoverflow.com/users/3450869/ampawd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 50616391, "answer_count": 2, "score": 3, "last_activity_date": 1527820194, "creation_date": 1527707102, "question_id": 50611810, "link": "https://stackoverflow.com/questions/50611810/function-call-syntax-through-a-pointer-dereference", "title": "Function call syntax through a pointer dereference", "body": "<p>Consider the code</p>\n\n<pre><code>int add(int a, int b)\n{\n    return a + b;\n}    \n\nint main()\n{\n    std::cout &lt;&lt; (*add)(3, 2);\n}\n</code></pre>\n\n<p>What is the point of dereferencing the function pointer ???</p>\n\n<p>I can't think of such a use case where it would give an advantage ...</p>\n\n<p>Why this function call syntax exists in C++ ?</p>\n"}, {"tags": ["c++", "visual-studio-2017", "debuggervisualizer"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 5, "creation_date": 1527706877, "post_id": 50611661, "comment_id": 88233410, "body": "No, they are being shown &quot;right&quot; in the debugger, and truncated  when output in your program. The answer is to fix the formatting in your program, if you want the &quot;right&quot; answer, and to read up on how floating point variables are implemented - start at <a href=\"http://floating-point-gui.de/\" rel=\"nofollow noreferrer\">floating-point-gui.de</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 1, "creation_date": 1527706917, "post_id": 50611661, "comment_id": 88233432, "body": "The real question is why the <code>cout &lt;&lt;</code> result is not same as what OP sees in the debugger? Is <code>cout &lt;&lt;</code> rounding somehow?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1527706939, "post_id": 50611661, "comment_id": 88233441, "body": "@Arkady, yes it is."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 1, "creation_date": 1527706983, "post_id": 50611661, "comment_id": 88233469, "body": "@Arkadiy iostreams&#39; default precision is 6 digits"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1527707167, "post_id": 50611661, "comment_id": 88233556, "body": "@vu1p3n0x I found some references to that, yes. Where is it specified?"}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1527707484, "post_id": 50611661, "comment_id": 88233710, "body": "@Arkadiy in the iso c++ standard presumably. I don&#39;t know the standard and don&#39;t care to look for it, if you&#39;d like to be sure you can ask a separate question and tag <code>language-lawyer</code> for an appropriate answer"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1527709044, "post_id": 50611661, "comment_id": 88234400, "body": "Reference to default of <code>6</code> here: <a href=\"http://en.cppreference.com/w/cpp/io/ios_base/precision\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/ios_base/precision</a>  also here: <a href=\"http://en.cppreference.com/w/cpp/io/basic_ios/init\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/basic_ios/init</a>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1527711308, "post_id": 50611661, "comment_id": 88235376, "body": "<a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1527712191, "post_id": 50611661, "comment_id": 88235743, "body": "So the answer to this question is: <i>default precision for float is 6, here is why</i>. How is <code>[language-agnostic]</code> &quot;Floating point math is broken&quot; a duplicate?"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1527713572, "post_id": 50611661, "comment_id": 88236253, "body": "@Arkadiy Because the question simplifies to: <i>&quot;why can&#39;t the computer hold 9.9 exactly&quot;</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1527713700, "post_id": 50611661, "comment_id": 88236301, "body": "@RichardCritten, I am arguing that it&#39;s not the case here, that this question is about rounding in <code>cout</code>. Of course I may be wrong. Maybe OP should clarify, if he wants the question reopened."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1527714373, "post_id": 50611661, "comment_id": 88236560, "body": "Added another answer to the dup. @RichardCritten, let me know if you&#39;d rather own it."}, {"owner": {"reputation": 653, "user_id": 5074998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qVVC3.jpg?s=128&g=1", "display_name": "Rog&#233;rio Dec", "link": "https://stackoverflow.com/users/5074998/rog%c3%a9rio-dec"}, "edited": false, "score": 0, "creation_date": 1527714433, "post_id": 50611661, "comment_id": 88236579, "body": "The fact is, I&#39;ve learned that a simple command like <code>float f = 9.9</code> will never store exactly <code>9.9</code> and that&#39;s sad, although the huge text indicated by @Neil Butterworth has millions of technical reasons for it. I also learned that <code>cout</code> and other commands round float result, never showing their exact value. But we have to adapt to reality and deal with it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1527770866, "post_id": 50611661, "comment_id": 88259246, "body": "@Rog&#233;rioDec At least the cout precision can be adjusted."}], "owner": {"reputation": 653, "user_id": 5074998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qVVC3.jpg?s=128&g=1", "display_name": "Rog&#233;rio Dec", "link": "https://stackoverflow.com/users/5074998/rog%c3%a9rio-dec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1527706999, "answer_count": 0, "score": 1, "last_activity_date": 1527712295, "creation_date": 1527706496, "last_edit_date": 1527712295, "question_id": 50611661, "link": "https://stackoverflow.com/questions/50611661/debugger-showing-wrong-values-for-float", "closed_reason": "Duplicate", "title": "Debugger showing wrong values for float", "body": "<p>I noticed that some float variables are being shown wrong in Visual Studio 2017 debugger, although the internal value is right, that is, it is only wrong in the debug view.</p>\n\n<p>For example:</p>\n\n<pre><code>obj_carro.vel1000rpm.push_back(stof(parte[2].substr(0, pos)));\n\ncout &lt;&lt; stof(parte[2].substr(0, pos)) &lt;&lt; endl;\ncout &lt;&lt; obj_carro.vel1000rpm[obj_carro.vel1000rpm.size() - 1]  &lt;&lt; endl;\n</code></pre>\n\n<p>It shows the correct value:</p>\n\n<pre><code>9.9\n9.9\n</code></pre>\n\n<p>But VS 2017 debugger shows:</p>\n\n<pre><code>9.89999962  float\n</code></pre>\n\n<p>What is wrong?\nHow to solve this?</p>\n\n<p>Update: the <code>cout</code> output rounds to 6 decimal places after the point. This should be an answer, but the question is on hold...</p>\n"}, {"tags": ["c++", "linker"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1527707145, "post_id": 50611621, "comment_id": 88233547, "body": "As it has nothing to do with jsoncpp, you should be able to provide a small example of the problem, complete with the command lines you are using to build things."}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1527707646, "post_id": 50611621, "comment_id": 88233782, "body": "Well, you could have zero-based address in compiled object - it is, after all, address relative to the start of .text segment. But in typical object file only one symbol will have relative address of 0, all others would be at some different position. But if you have one source file per function, this might be ok"}, {"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1527707675, "post_id": 50611621, "comment_id": 88233792, "body": "Let me link some answer here to clarify things <a href=\"https://stackoverflow.com/questions/1863613/what-does-symbol-value-from-nm-command-mean\" title=\"what does symbol value from nm command mean\">stackoverflow.com/questions/1863613/&hellip;</a>"}, {"owner": {"reputation": 1315, "user_id": 1300177, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4996dd0400f07c6dd5776f5498c04aea?s=128&d=identicon&r=PG", "display_name": "screwnut", "link": "https://stackoverflow.com/users/1300177/screwnut"}, "reply_to_user": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1527707744, "post_id": 50611621, "comment_id": 88233826, "body": "@SeverinPappadeux It&#39;s not one source file by function. There&#39;s three source files in total. The same setup produces the expected output for MacOS."}, {"owner": {"reputation": 1315, "user_id": 1300177, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4996dd0400f07c6dd5776f5498c04aea?s=128&d=identicon&r=PG", "display_name": "screwnut", "link": "https://stackoverflow.com/users/1300177/screwnut"}, "edited": false, "score": 0, "creation_date": 1527707879, "post_id": 50611621, "comment_id": 88233879, "body": "@NeilButterworth My very problem is in the command lines used to produce this output. What you see is the smallest description of the problem I can make. I&#39;m going backwards here, from the result and trying to figure what flag is injected in the resulting command that could produce this output. <code>webrtc&#39;s</code> build system is further wrpped in our own build system. The commands issued for those would tell you nothing."}], "answers": [{"comments": [{"owner": {"reputation": 15136, "user_id": 4044696, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/54xyv.jpg?s=128&g=1", "display_name": "Severin Pappadeux", "link": "https://stackoverflow.com/users/4044696/severin-pappadeux"}, "edited": false, "score": 0, "creation_date": 1527775567, "post_id": 50615024, "comment_id": 88262497, "body": "Good one to know"}], "tags": [], "owner": {"reputation": 1315, "user_id": 1300177, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4996dd0400f07c6dd5776f5498c04aea?s=128&d=identicon&r=PG", "display_name": "screwnut", "link": "https://stackoverflow.com/users/1300177/screwnut"}, "is_accepted": true, "score": 1, "last_activity_date": 1527726156, "creation_date": 1527726156, "answer_id": 50615024, "question_id": 50611621, "link": "https://stackoverflow.com/questions/50611621/why-are-all-symbols-values-in-my-a-file-0/50615024#50615024", "title": "Why are all symbols&#39; values in my `.a` file 0", "body": "<p>There's actually nothing wrong with the values being <code>0</code>. Presumably, its a by-product of link-time optimization. When a final executable gets produced, the symbols will see their value addresses) assigned.</p>\n\n<p>My actual problem was that I was mixing libraries built with <code>libc++</code> and other with <code>libstdc++</code>. The unresolved symbols referred to function that had things like <code>std::string</code> or <code>std::unique_ptr</code> as parameters. In this instance, <code>libjsoncpp.a</code> had symbols like <code>Json::Value(std::__1::basic_string)</code> (a constructor that takes a string) because it was build with clang and expecting to be linked with LLVM's <code>libc++</code> but I was ultimately attempting to link the final executable with GNU's <code>libstdc++</code> and the symbol <code>Json::Value(std::basic_string)</code> was unresolved.</p>\n"}], "owner": {"reputation": 1315, "user_id": 1300177, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4996dd0400f07c6dd5776f5498c04aea?s=128&d=identicon&r=PG", "display_name": "screwnut", "link": "https://stackoverflow.com/users/1300177/screwnut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50615024, "answer_count": 1, "score": 4, "last_activity_date": 1527726156, "creation_date": 1527706322, "last_edit_date": 1527710459, "question_id": 50611621, "link": "https://stackoverflow.com/questions/50611621/why-are-all-symbols-values-in-my-a-file-0", "title": "Why are all symbols&#39; values in my `.a` file 0", "body": "<p>Long story short, I'm building <code>jsoncpp</code> through another library's build system (<code>webrtc</code>'s, which to say is behemoth would be an understatement). What that means is that I'm navigating through a build system I have little control over and have little familiarity with.</p>\n\n<p>Suffice to say that when I build <code>libjsoncpp.a</code> on MacOS, the resulting file works perfectly fine. When I compile on Linux, linking with the resulting <code>.a</code> results in <code>undefined reference</code> for everything I use. Diving into the file, I noticed that while the MacOS version appears \"normal\", like so (excerpt):</p>\n\n<pre><code>0000000000001c10 T __ZNK4Json5ValueeqERKS0_\n0000000000001c00 T __ZNK4Json5ValuegeERKS0_\n0000000000001bc0 T __ZNK4Json5ValuegtERKS0_\n0000000000003d10 T __ZNK4Json5ValueixEPKc\n0000000000003de0 T __ZNK4Json5ValueixERKNSt3__112basic_stringIcNS1_11char_traitsIcEENS1_9allocatorIcEEEE\n</code></pre>\n\n<p>the same portion for the one built for Linux looks like this:</p>\n\n<pre><code>0000000000000000 T _ZNK4Json5ValuegeERKS0_\n0000000000000000 T _ZNK4Json5ValuegtERKS0_\n0000000000000000 T _ZNK4Json5ValueixEi\n0000000000000000 T _ZNK4Json5ValueixEj\n0000000000000000 T _ZNK4Json5ValueixEPKc\n0000000000000000 T _ZNK4Json5ValueixERKNSt3__112basic_stringIcNS1_11char_traitsIcEENS1_9allocatorIcEEEE\n</code></pre>\n\n<p>Note that all the values are zero. I suspect that that's a clue to my problem but I just don't know what I'm supposed to conclude from it. I believe my issue with building on Linux is some compilation switch somewhere in the bowels of the build system and knowing what all the zeroes mean could help zero in on what to look for.</p>\n\n<p>Edit: this has nothing to do with jsoncpp specifically. I'm hitting the same issue with other libs. I just picked that as an example.</p>\n\n<p>Edit: Breakthrough. Here's a sample of the command line that's ultimately used to build one the three <code>.o</code> file and the linker command afterwards. Hope that helps.</p>\n\n<pre><code>[3/4] ../../../src/third_party/llvm-build/Release+Asserts/bin/clang++ -MMD -MF obj/third_party/jsoncpp/jsoncpp/json_reader.o.d -DJSON_USE_EXCEPTION=0 -DV8_DEPRECATION_WARNINGS -DUSE_UDEV -DUSE_AURA=1 -DUSE_GLIB=1 -DUSE_NSS_CERTS=1 -DUSE_X11=1 -DFULL_SAFE_BROWSING -DSAFE_BROWSING_CSD -DSAFE_BROWSING_DB_LOCAL -DOFFICIAL_BUILD -DCHROMIUM_BUILD -DFIELDTRIAL_TESTING_ENABLED -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DCR_CLANG_REVISION=\\\"332335-1\\\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D_FORTIFY_SOURCE=2 -D_LIBCPP_DISABLE_VISIBILITY_ANNOTATIONS -D_LIBCXXABI_DISABLE_VISIBILITY_ANNOTATIONS -DCR_LIBCXX_REVISION=332543 -DCR_LIBCXXABI_REVISION=331450 -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0 -I../../../src/third_party/jsoncpp/source/src/lib_json -I../../../src -Igen -I../../../src/third_party/jsoncpp/overrides/include -I../../../src/third_party/jsoncpp/source/include -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector -funwind-tables -fPIC -pipe -B../../../src/third_party/binutils/Linux_x64/Release/bin -pthread -fcolor-diagnostics -fmerge-all-constants -Xclang -mllvm -Xclang -instcombine-lower-dbg-declare=0 -no-canonical-prefixes -m64 -march=x86-64 -Wall -Wextra -Wimplicit-fallthrough -Wthread-safety -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-covered-switch-default -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-nonportable-include-path -Wno-address-of-packed-member -Wno-unused-lambda-capture -Wno-user-defined-warnings -Wno-enum-compare-switch -Wno-null-pointer-arithmetic -Wno-ignored-pragma-optimize -O2 -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g2 -ggnu-pubnames -fvisibility=hidden -Xclang -load -Xclang ../../../src/third_party/llvm-build/Release+Asserts/lib/libFindBadConstructs.so -Xclang -add-plugin -Xclang find-bad-constructs -Xclang -plugin-arg-find-bad-constructs -Xclang enforce-in-thirdparty-webkit -Xclang -plugin-arg-find-bad-constructs -Xclang check-enum-max-value -Xclang -plugin-arg-find-bad-constructs -Xclang check-ipc -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -std=gnu++11 -fno-exceptions -fno-rtti -nostdinc++ -isystem../../../src/buildtools/third_party/libc++/trunk/include -isystem../../../src/buildtools/third_party/libc++abi/trunk/include -fvisibility-inlines-hidden -c ../../../src/third_party/jsoncpp/overrides/src/lib_json/json_reader.cpp -o obj/third_party/jsoncpp/jsoncpp/json_reader.o\n[4/4] python \"../../../src/build/toolchain/gcc_ar_wrapper.py\"  --output=obj/third_party/jsoncpp/libjsoncpp.a --ar=\"../../../src/third_party/llvm-build/Release+Asserts/bin/llvm-ar\" \" -r -c -s -D\" @\"obj/third_party/jsoncpp/libjsoncpp.a.rsp\"\n</code></pre>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1527706420, "post_id": 50611602, "comment_id": 88233189, "body": "Hint: you already took the first step: <a href=\"http://en.cppreference.com/w/cpp/header/fstream\" rel=\"nofollow noreferrer\"><code>#include &lt;fstream&gt;</code></a>. What tutorial and/or book are you using that does <i>not</i> cover basic file IO ?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9872073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa16320eede46a03a995c4a66d74c50?s=128&d=identicon&r=PG&f=1", "display_name": "conDon", "link": "https://stackoverflow.com/users/9872073/condon"}, "edited": false, "score": 0, "creation_date": 1527709503, "post_id": 50611887, "comment_id": 88234608, "body": "okay thank you it worked great. now I have another question. how do i get the program to recognize certain numbers? I want it to output something like &quot;there was twelve number -11s counted&quot;"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 9, "user_id": 9872073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa16320eede46a03a995c4a66d74c50?s=128&d=identicon&r=PG&f=1", "display_name": "conDon", "link": "https://stackoverflow.com/users/9872073/condon"}, "edited": false, "score": 0, "creation_date": 1527709994, "post_id": 50611887, "comment_id": 88234832, "body": "You can use a <a href=\"http://en.cppreference.com/w/cpp/container/map\" rel=\"nofollow noreferrer\"><code>std::map</code></a> to keep track of them, eg: <code>std::map&lt;int, int&gt; hits; ... hits[input]++;</code> Then you can loop through <code>hits</code> outputting the values as needed."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 9, "user_id": 9872073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa16320eede46a03a995c4a66d74c50?s=128&d=identicon&r=PG&f=1", "display_name": "conDon", "link": "https://stackoverflow.com/users/9872073/condon"}, "edited": false, "score": 0, "creation_date": 1527711816, "post_id": 50611887, "comment_id": 88235585, "body": "@conDon And? Do you not understand what it is telling you? &quot;<i>&#39;auto&#39; type specifier is a C++11 extension ... range-based for loop is a C++11 extension</i>&quot; - you are clearly not compiling for C++11, or else you would not be getting the warnings. So, you will have to use a more traditional loop using iterators instead. I updated my answer to show that."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1527711809, "last_edit_date": 1527711809, "creation_date": 1527707371, "answer_id": 50611887, "question_id": 50611602, "link": "https://stackoverflow.com/questions/50611602/directing-output-into-a-txt-file-in-c/50611887#50611887", "title": "Directing output into a .txt file in C++", "body": "<p>Use <code>std::ifstream</code> to read input from a file, and <code>std::ofstream</code> to write output to a file.  For example:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n\nint main()\n{\n    int sum = 0; \n    int counter = 0;\n\n    std::ifstream in(\"hits.txt\");\n    if (in.is_open())\n    {\n        while (in &gt;&gt; input)\n        {\n            sum += input; \n            ++counter;\n        }\n    }\n    else\n    {\n        std::ofstream out(\"hits.txt\");\n        int input;\n\n        do\n        {\n            std::cout &lt;&lt; \"Please enter the hit data: \"; \n\n            // after putting in data, input zero \n            if (!(std::cin &gt;&gt; input) || (input == 0))\n                break; \n\n            out &lt;&lt; input &lt;&lt; \" \";\n\n            sum += input; \n            ++counter;\n        }\n        while (true);\n    }\n\n    std::cout &lt;&lt; \"Sum of hits entered: \" &lt;&lt; sum &lt;&lt; endl ; \n    std::cout &lt;&lt; \"Number of hits entered: \" &lt;&lt; counter &lt;&lt; endl ;\n\n    if (counter &lt; 100)\n    {\n        std::cout &lt;&lt; \"The hits are less than 100\" &lt;&lt; std::endl;\n    }\n    else if (counter &gt; 100) \n    {\n        std::cout &lt;&lt; \"The hits are greater than 100\" &lt;&lt; std::endl;\n    }\n    else\n    {\n        std::cout &lt;&lt; \"The hits are equal to 100\" &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Also, how do I get the program to recognize certain numbers? I want it to output something like \"there was twelve number -11s counted\".</p>\n</blockquote>\n\n<p>You can use <a href=\"http://en.cppreference.com/w/cpp/container/map\" rel=\"nofollow noreferrer\"><code>std:map</code></a> for that, eg:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;map&gt;\n\nint main()\n{\n    int sum = 0; \n    int counter = 0;\n    std::map&lt;int, int&gt; hits; // hit counter\n\n    std::ifstream in(\"hits.txt\");\n    if (in.is_open())\n    {\n        while (in &gt;&gt; input)\n        {\n            hits[input]++;\n            sum += input; \n            ++counter;\n        }\n    }\n    else\n    {\n        std::ofstream out(\"hits.txt\");\n        int input;\n\n        do\n        {\n            std::cout &lt;&lt; \"Please enter the hit data: \"; \n\n            // after putting in data, input zero \n            if (!(std::cin &gt;&gt; input) || (input == 0))\n                break; \n\n            out &lt;&lt; input &lt;&lt; \" \";\n\n            hits[input]++;\n            sum += input; \n            ++counter;\n        }\n        while (true);\n    }\n\n    std::cout &lt;&lt; \"Sum of hits entered: \" &lt;&lt; sum &lt;&lt; endl ; \n    std::cout &lt;&lt; \"Number of hits entered: \" &lt;&lt; counter &lt;&lt; endl ;\n\n    if (counter &lt; 100)\n    {\n        std::cout &lt;&lt; \"The hits are less than 100\" &lt;&lt; std::endl;\n    }\n    else if (counter &gt; 100) \n    {\n        std::cout &lt;&lt; \"The hits are greater than 100\" &lt;&lt; std::endl;\n    }\n    else\n    {\n        std::cout &lt;&lt; \"The hits are equal to 100\" &lt;&lt; std::endl;\n    }\n\n    for (auto &amp;p : hits)\n    {\n        if (p.second == 1)\n            std::cout &lt;&lt; \"there was 1 number \" &lt;&lt; p.first &lt;&lt; \" counted\" &lt;&lt; std:::endl;\n        else\n            std::cout &lt;&lt; \"there were \" &lt;&lt; p.second &lt;&lt; \" number \" &lt;&lt; p.first &lt;&lt; \"'s counted\" &lt;&lt; std:::endl;\n    }\n\n    /* or, if you are not using C++11 or later:\n\n    for (std::map&lt;int, int&gt;::iterator iter = hits.begin(); iter != hits.end(); ++iter)\n    {\n        std::map&lt;int, int&gt;::value_type &amp;p = *iter;\n\n        if (p.second == 1)\n            std::cout &lt;&lt; \"there was 1 number \" &lt;&lt; p.first &lt;&lt; \" counted\" &lt;&lt; std:::endl;\n        else\n            std::cout &lt;&lt; \"there were \" &lt;&lt; p.second &lt;&lt; \" number \" &lt;&lt; p.first &lt;&lt; \"'s counted\" &lt;&lt; std:::endl;\n    }\n    */\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7631422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NgVXy.png?s=128&g=1", "display_name": "marCOmics", "link": "https://stackoverflow.com/users/7631422/marcomics"}, "is_accepted": false, "score": 0, "last_activity_date": 1527707494, "creation_date": 1527707494, "answer_id": 50611911, "question_id": 50611602, "link": "https://stackoverflow.com/questions/50611602/directing-output-into-a-txt-file-in-c/50611911#50611911", "title": "Directing output into a .txt file in C++", "body": "<p>Outputting data to a .txt file is easy indeed. You already included , now you need to create an object from the type std::ofstream and use it to write your text into a file. I would create a function like this (above main):</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n\nvoid outputTextToFile (std::string p_text) {\n//is created under your project filepath:\n  std::ofstream file(\"nameoffile.txt\", std::ios::app); //\"app\" = appending, instead of overwriting text\n  file &lt;&lt; \"Writing this to a file.\\n\";\n  file.close();\n}\n</code></pre>\n\n<p>Afterwards you can call your function in the while loop with the string text you want, like this for example:</p>\n\n<pre><code>outputTextToFile(\"test Text\");\n</code></pre>\n\n<p>Reading text from a .txt file is very similar to this, I would suggest you look up this thread: <a href=\"https://stackoverflow.com/questions/7868936/read-file-line-by-line\">Read file line by line</a></p>\n"}], "owner": {"reputation": 9, "user_id": 9872073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa16320eede46a03a995c4a66d74c50?s=128&d=identicon&r=PG&f=1", "display_name": "conDon", "link": "https://stackoverflow.com/users/9872073/condon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527711809, "creation_date": 1527706215, "last_edit_date": 1527710351, "question_id": 50611602, "link": "https://stackoverflow.com/questions/50611602/directing-output-into-a-txt-file-in-c", "title": "Directing output into a .txt file in C++", "body": "<p>How do I direct the output of this code into a <code>.txt</code> file? </p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;fstream&gt;\n\nusing namespace std;\n\nint main() {\n\n    using std::cin;\n    using std::cout;\n    using std::endl;\n\n    int input=1; \n    int sum=0; \n    int counter=1;\n\n    while (input != 0) \n    {\n        std::cout &lt;&lt; \"Please enter the hit data: \"; \n        std::cin &gt;&gt; input; \n\n        if (input == 0) // after puting in data input zero \n        {\n            break;\n        }\n        else if (input != 0)\n        {\n            sum += input; \n            counter++; \n        }\n    }\n    counter = counter - 1 ; \n    std::cout &lt;&lt; \"Sum of hits entered: \" &lt;&lt; sum &lt;&lt; endl ; \n    std::cout &lt;&lt; \"Number of hits entered: \" &lt;&lt; counter &lt;&lt; endl ;\n\n    if ( counter &lt; 100 ) \n    {\n        std::cout &lt;&lt; \"The hits are less than 100\" ;\n    }\n    else if ( counter &gt; 100 ) \n    {\n        std::cout &lt;&lt; \"The hits are greater than 100\" ;\n    }\n    else if ( counter == 100 ) \n    {\n        std::cout &lt;&lt; \"The hits are equal to 100\" ;\n    }\n}\n</code></pre>\n\n<p>Also, instead of a user having to input data, how can I get the program to read data from another <code>.txt</code> file?  I understand you can do this all easily in the terminal; however, I would like for the program to create the <code>.txt</code> file.</p>\n\n<p>Also, how do I get the program to recognize certain numbers? I want it to output something like \"there was twelve number -11s counted\".</p>\n"}, {"tags": ["c++", "multithreading", "mpi", "raspberry-pi3", "fftw"], "comments": [{"owner": {"reputation": 144839, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 3, "creation_date": 1527706946, "post_id": 50611597, "comment_id": 88233444, "body": "If you know <code>pthreads</code> and don&#39;t envisage going to a multi-raspberry cluster, I am not sure I personally see any benefit of using <code>MPI</code>, but that&#39;s just my 2 pence worth!"}, {"owner": {"reputation": 47129, "user_id": 463827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gwR2m.jpg?s=128&g=1", "display_name": "Jonathan Dursi", "link": "https://stackoverflow.com/users/463827/jonathan-dursi"}, "edited": false, "score": 4, "creation_date": 1527708170, "post_id": 50611597, "comment_id": 88234004, "body": "Yeah, I&#39;d say that if you are running (a) completely independent tasks, (b) on a single node, there are simpler ways to do what you want to do - you can just run multiple copies of the program at once, either by hand or using a tool like <a href=\"https://www.gnu.org/software/parallel/\" rel=\"nofollow noreferrer\">GNU Parallel</a>"}, {"owner": {"reputation": 965, "user_id": 2337156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFUjt.png?s=128&g=1", "display_name": "Dr.Tower", "link": "https://stackoverflow.com/users/2337156/dr-tower"}, "edited": false, "score": 3, "creation_date": 1527708843, "post_id": 50611597, "comment_id": 88234312, "body": "One of the things that MPI effectively enforces is data localization. This can be important on single-node systems with multiple sockets (not the case with a Pi). Data within MPI programs is not shared by default, whereas with threads it is.  One thing you may have to be careful of with FFTW, though, is that you have to jump through a hoop or two to make sure it is thread-safe. If you are using MPI for your parallelization, you don&#39;t have to worry about thread safety.  I also second the comment of looking at GNU Parallel."}], "answers": [{"tags": [], "owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "is_accepted": false, "score": 1, "last_activity_date": 1528281387, "creation_date": 1528281387, "answer_id": 50718277, "question_id": 50611597, "link": "https://stackoverflow.com/questions/50611597/using-mpi-on-a-single-raspberry-pi/50718277#50718277", "title": "Using MPI on a single Raspberry-Pi", "body": "<p>MPI can be an awesome choice depending on how much work can be done per unit communication. That's how I would consider MPI or not.  </p>\n\n<p>I am coauthor of an MRI simulation framework. There we deal with individual \"macro\" spins, which can be dealt with generally as spatially non-interacting. This allows one to do poor man's parallelisation on every single spin and the local bloch equations. So a lot of physics for very little communication. Even on a single device it can perform as well as pthreads.  </p>\n\n<p>However on the other side of the spectrum I's see massive parallel matrix inversion as done with SCALAPACK. There you'll find a lot of communication per unit calculation. That's where there is not a chance in the world you could compete with pthreads.  </p>\n\n<p>Even if you were going to use a pi cluster, you'd use both MPI and pthreads in such cases and might not be able to break even, as the 100Mbit network has significant latency issues.<br>\nThere are single board machines with 1Gb/s network and stronger fp performance as raspberry pi, where the cost of communication might be worth it.</p>\n\n<p>tldr: For MPI to make sense one wants <code>computation/communication &gt;&gt; 1</code>.  </p>\n"}], "owner": {"reputation": 5555, "user_id": 1547699, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/DfkK6.jpg?s=128&g=1", "display_name": "Sumudu", "link": "https://stackoverflow.com/users/1547699/sumudu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1528281387, "creation_date": 1527706204, "question_id": 50611597, "link": "https://stackoverflow.com/questions/50611597/using-mpi-on-a-single-raspberry-pi", "title": "Using MPI on a single Raspberry-Pi", "body": "<p>I am working on an application (in C++) which involves several independent operations (<a href=\"http://www.fftw.org/\" rel=\"nofollow noreferrer\">FFTW</a> + signal processing) on data arrays.\nArray sizes can be either 512 or 1024 (yet to decide), and the data type is double.</p>\n\n<p>I am hoping to make those independent operations parallalized to get the best out of the Pi.\nObvious thing I would have done in the past is using pthreads.</p>\n\n<p>However, (unfortunately :) ) I learned about MPI recently and I wonder whether I should use it here instead of good old threads.\nObviously MPI would be the way to go if I have a device cluster (that's what I get when I search the internet).</p>\n\n<p>But is MPI still a good choice in my situation, where there is just one device? (and specially when that device is a Raspberry-Pi).</p>\n\n<p>(If the answer to above is \"no\", does that mean MPI is a bad choice in general when there is only one computer?)</p>\n"}, {"tags": ["c++", "modular-arithmetic", "mod"], "comments": [{"owner": {"reputation": 6188, "user_id": 7703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2bc3387440ec2c075d16d2bb152a540?s=128&d=identicon&r=PG&f=1", "display_name": "Jodocus", "link": "https://stackoverflow.com/users/7703564/jodocus"}, "edited": false, "score": 5, "creation_date": 1527706232, "post_id": 50611595, "comment_id": 88233096, "body": "Do you mean the modulus <code>%</code> operator?"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1527707187, "post_id": 50611595, "comment_id": 88233569, "body": "IMHO <code>fmodX()</code> is port of more primary <code>%</code> concept to floating point (BTW unnatural )"}], "answers": [{"comments": [{"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1527707085, "post_id": 50611693, "comment_id": 88233519, "body": "Pumping of reputation?"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 1, "creation_date": 1527708204, "post_id": 50611693, "comment_id": 88234014, "body": "@JacekCz Despicable isn&#39;t it? I&#39;ll get the pitchforks."}, {"owner": {"reputation": 1832, "user_id": 4441547, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-_a7aQ1gNiFY/AAAAAAAAAAI/AAAAAAAAABw/2usMjLqKwgI/photo.jpg?sz=128", "display_name": "Aaron Franke", "link": "https://stackoverflow.com/users/4441547/aaron-franke"}, "edited": false, "score": 0, "creation_date": 1545285560, "post_id": 50611693, "comment_id": 94574027, "body": "So why can&#39;t the operator work for floats if there&#39;s already an operator in the language?"}], "tags": [], "owner": {"reputation": 5721, "user_id": 3823831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10a2607a7827988b6ac570fe168e02a?s=128&d=identicon&r=PG", "display_name": "TheGreatContini", "link": "https://stackoverflow.com/users/3823831/thegreatcontini"}, "is_accepted": true, "score": 4, "last_activity_date": 1527706605, "creation_date": 1527706605, "answer_id": 50611693, "question_id": 50611595, "link": "https://stackoverflow.com/questions/50611595/is-there-a-function-for-integer-fmod-in-c/50611693#50611693", "title": "Is there a function for integer fmod in C++?", "body": "<p>Yes, '%' is used for modulus operator, as Joducus said in the comment.  See <a href=\"https://www.cprogramming.com/tutorial/modulus.html\" rel=\"nofollow noreferrer\">example</a>.</p>\n"}], "owner": {"reputation": 1832, "user_id": 4441547, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-_a7aQ1gNiFY/AAAAAAAAAAI/AAAAAAAAABw/2usMjLqKwgI/photo.jpg?sz=128", "display_name": "Aaron Franke", "link": "https://stackoverflow.com/users/4441547/aaron-franke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 50611693, "answer_count": 1, "score": 2, "last_activity_date": 1527706605, "creation_date": 1527706190, "question_id": 50611595, "link": "https://stackoverflow.com/questions/50611595/is-there-a-function-for-integer-fmod-in-c", "title": "Is there a function for integer fmod in C++?", "body": "<p><a href=\"http://en.cppreference.com/w/c/numeric/math/fmod\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/numeric/math/fmod</a></p>\n\n<p>Alright, cool. There's this function called <code>fmod</code>, but it appears to only work with <code>float</code>, <code>double</code>, and <code>long double</code>. Is there a version of this function that works with integers in C++?</p>\n"}, {"tags": ["c++", "inheritance", "initialization"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1527706184, "post_id": 50611574, "comment_id": 88233072, "body": "You don&#39;t call <code>setdata</code> on the <code>b1</code> instance. And please read up on constructors."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1527706197, "post_id": 50611574, "comment_id": 88233078, "body": "It seems like you assume <code>b1</code> should print the values provided to <code>a1</code>, but <code>b1</code> has nothing to do with <code>a1</code>. What if you have another <code>A</code>? How would <code>b1</code> know which <code>A</code>&#39;s value to use? I&#39;m not sure I understand your mental model for how inheritance works."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9223423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a45e6d60668ad3609862e700babd0a4?s=128&d=identicon&r=PG&f=1", "display_name": "ravikiran", "link": "https://stackoverflow.com/users/9223423/ravikiran"}, "edited": false, "score": 0, "creation_date": 1527707265, "post_id": 50611620, "comment_id": 88233612, "body": "It&#39;s ok. But my question is, as B inherits the member functions of A, I am trying to print the values of a and b  of  a1  using  b1 through showdata () as  b1  can use it. But it is not working, why?."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33, "user_id": 9223423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a45e6d60668ad3609862e700babd0a4?s=128&d=identicon&r=PG&f=1", "display_name": "ravikiran", "link": "https://stackoverflow.com/users/9223423/ravikiran"}, "edited": false, "score": 0, "creation_date": 1527708239, "post_id": 50611620, "comment_id": 88234033, "body": "Read the 1st paragraph of my answer, I already addressed that question. Just because <code>B</code> derives from <code>A</code> does not mean that object <code>b1</code> can access object <code>a1</code>&#39;s data. You clearly have a fundamental misunderstanding of how objects actually work.  You need to get yourself a <a href=\"https://stackoverflow.com/questions/388242/\">good C++ book</a> that covers this in detail."}, {"owner": {"reputation": 33, "user_id": 9223423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a45e6d60668ad3609862e700babd0a4?s=128&d=identicon&r=PG&f=1", "display_name": "ravikiran", "link": "https://stackoverflow.com/users/9223423/ravikiran"}, "edited": false, "score": 0, "creation_date": 1527740000, "post_id": 50611620, "comment_id": 88242864, "body": "What I am trying to do is to print the variables of  a1 using  b1 but not the variables of  b1 as  b1 can access the showdata() function because of inheritance."}, {"owner": {"reputation": 33, "user_id": 9223423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a45e6d60668ad3609862e700babd0a4?s=128&d=identicon&r=PG&f=1", "display_name": "ravikiran", "link": "https://stackoverflow.com/users/9223423/ravikiran"}, "edited": false, "score": 0, "creation_date": 1527740764, "post_id": 50611620, "comment_id": 88243041, "body": "@Remy Lebeau  If B cannot access the values of a then how was I able to set values to a and b of class A using setdata() with the help of an obj of class B that is b1 and was able to print them using showdata() usng the same b1."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 33, "user_id": 9223423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a45e6d60668ad3609862e700babd0a4?s=128&d=identicon&r=PG&f=1", "display_name": "ravikiran", "link": "https://stackoverflow.com/users/9223423/ravikiran"}, "edited": false, "score": 0, "creation_date": 1527746472, "post_id": 50611620, "comment_id": 88244901, "body": "@ravikiran You clearly do not understand what inheritance is or how objects work. Again, stop what you are doing and go get some <a href=\"https://stackoverflow.com/questions/388242/\">good C++ books</a> to study. <code>B</code> simply inherits the same <i>functionality</i> as <code>A</code>. What <code>A</code> can do, <code>B</code> can also do. That DOES NOT mean that <code>b1</code> has access to <code>a1</code>&#39;s data members. <code>b1</code> has its own data members. <code>a1</code> and <code>b1</code> DO NOT share the same memory, so what you are asking for is simply not possible."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1527709200, "last_edit_date": 1527709200, "creation_date": 1527706322, "answer_id": 50611620, "question_id": 50611574, "link": "https://stackoverflow.com/questions/50611574/issue-in-accessing-member-variables/50611620#50611620", "title": "Issue in accessing member variables", "body": "<p><code>a1</code> and <code>b1</code> are completely separate object instances in memory.  They have their own copies of the <code>a</code> and <code>b</code> members in memory.  They have nothing to do with each other at all.  Whatever you do to <code>a1</code> does not affect <code>b1</code> at all, and vice versa.</p>\n\n<p>You are initializing the members of <code>a1</code> only, you are not initializing the members of <code>b1</code> at all.  That is why you are seeing garbage when you try to print out the members of <code>b1</code>.</p>\n\n<p>Before calling <code>b1.showdata()</code>, you need to call <code>b1.setdata()</code> to initialize <code>b1</code>'s members, eg:</p>\n\n<pre><code>int main() {\n    A  a1;\n    B  b1;\n    a1.setdata(5, 4);\n    a1.showdata();\n    b1.setdata(1, 2); // &lt;-- add this!\n    b1.showdata();\n}\n</code></pre>\n\n<p>You should also give <code>class A</code> a default constructor that initializes the members to default values, in case <code>setdata()</code> is not called after construction (such as what happened in your case), eg:</p>\n\n<pre><code>class A {\n    int a, b;\npublic:\n    A() : a(0), b(0) {} // &lt;-- add this!\n    void setdata(int x, int y) { a = x; b = y; }\n    void showdata() { std::cout &lt;&lt; a &lt;&lt; b; }\n};\n</code></pre>\n\n<p>Alternatively, you might consider giving <code>class A</code> and <code>class B</code> a constructor that takes values as input, eg:</p>\n\n<pre><code>class A {\n    int a, b;\npublic:\n    A() : a(0), b(0) {}\n    A(int x, int y) : a(x), b(y) {} // &lt;-- add this!\n    void setdata(int x, int y) { a = x; b = y; }\n    void showdata() { std::cout &lt;&lt; a &lt;&lt; b; }\n};\n\nclass B : public A {\npublic:\n    B() : A() {}\n    B(int x, int y) : A(x, y) {}\n};\n\n/* or simpler:\n\nclass B : public A {\npublic:\n    using A::A; // &lt;-- inherit all constructors\n};\n*/\n\nint main() {\n    A  a1(5, 4);\n    B  b1(1, 2);\n    a1.showdata();\n    b1.showdata();\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9223423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a45e6d60668ad3609862e700babd0a4?s=128&d=identicon&r=PG&f=1", "display_name": "ravikiran", "link": "https://stackoverflow.com/users/9223423/ravikiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527709200, "creation_date": 1527706068, "last_edit_date": 1527706581, "question_id": 50611574, "link": "https://stackoverflow.com/questions/50611574/issue-in-accessing-member-variables", "title": "Issue in accessing member variables", "body": "<pre><code>#include&lt;iostream&gt;\n\nclass A {\n    int a, b;\npublic:\n    void setdata(int x, int y) { a = x; b = y; }\n    void showdata() { std::cout &lt;&lt; a &lt;&lt; b; }\n};\n\nclass B : public A { };\n\nint main() {\n    A  a1;\n    B  b1;\n    a1.setdata(5, 4);\n    a1.showdata();\n    b1.showdata();\n}\n</code></pre>\n\n<p>I just want to print the values of the <code>a</code> and <code>b</code> members using the <code>b1</code> object of class <code>B</code>, as it can access the member functions of class <code>A</code> since class <code>B</code> has public inheritance of class <code>A</code>. But, I am getting garbage values when I try to print the values of <code>a</code> and <code>b</code> using <code>b1</code>.</p>\n\n<p>Can someone explain why this is happening and how to fix it?</p>\n"}, {"tags": ["c++", "recursion", "vector", "iterator"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1527706282, "post_id": 50611492, "comment_id": 88233119, "body": "<a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">Your rubber duck</a> wants to know why <code>it</code> is global."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1527706408, "post_id": 50611492, "comment_id": 88233184, "body": "Using global variables in recursive functions is very frequently wrong. Using global variables as iteration variables is also usually wrong. You&#39;re breaking both guidelines here."}], "answers": [{"tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 1, "last_activity_date": 1527708321, "last_edit_date": 1592644375, "creation_date": 1527708321, "answer_id": 50612097, "question_id": 50611492, "link": "https://stackoverflow.com/questions/50611492/how-can-i-use-iterator-to-pass-the-value-in-a-recursive-function-in-c/50612097#50612097", "title": "How can I use iterator to pass the value in a recursive function in c++?", "body": "<h1>Problem</h1>\n<p><code>it</code> is global, so every call to <code>DFS</code> is using the same <code>it</code>. So when you</p>\n<pre><code>for(it = graph[vertex].begin(); it != graph[vertex].end(); it++){\n</code></pre>\n<p><code>it</code> is &quot;pointed&quot; at a different <code>vector</code> to iterate. When <code>DFS</code> returns, the calling <code>DFS</code> tries to carry on where it left off with the wrong <code>vector</code> AND that <code>vector</code> has already been iterated to <code>end()</code>. <code>it</code> will be incremented out of range, and once that happens any use is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined Behaviour</a>. In addition <code>it != graph[vertex].end()</code> can only be true by freak accident because they are both referring to different <code>vector</code>s, so the loop wanders further off into uncharted territories and eventually this bug is manifested, for the asker at any rate, in a crash.</p>\n<h1>Solution</h1>\n<p>Remove</p>\n<pre><code>vector&lt;pair&lt;int, int&gt; &gt;:: iterator it;\n</code></pre>\n<p>and replace</p>\n<pre><code>for(it = graph[vertex].begin(); it != graph[vertex].end(); it++)\n</code></pre>\n<p>with</p>\n<pre><code>for(auto it = graph[vertex].begin(); it != graph[vertex].end(); it++)\n</code></pre>\n<p>or</p>\n<pre><code>for(vector&lt;pair&lt;int, int&gt; &gt;::iterator it = graph[vertex].begin(); \n    it != graph[vertex].end(); \n    it++)\n</code></pre>\n<p>depending on the target C++ standard.</p>\n<h1>Caveat</h1>\n<p>This only resolves the most visible problem. There may be others. I have not checked.</p>\n"}], "owner": {"reputation": 31, "user_id": 8524075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MwOIo.jpg?s=128&g=1", "display_name": "rosudel", "link": "https://stackoverflow.com/users/8524075/rosudel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527708321, "creation_date": 1527705690, "last_edit_date": 1527706260, "question_id": 50611492, "link": "https://stackoverflow.com/questions/50611492/how-can-i-use-iterator-to-pass-the-value-in-a-recursive-function-in-c", "title": "How can I use iterator to pass the value in a recursive function in c++?", "body": "<p>If I run the code as below then it crashes for the inputs. But if I do not use the iterator and use the code written in the comment section(in <code>DFS()</code> function) then it gets run well and doesn't crash anymore. I can't understand why this code is getting crashes by iterator. </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;cstdio&gt;\n#include&lt;vector&gt;\n#include&lt;cstring&gt;\n#include&lt;stack&gt;\n\nusing namespace std;\n\nvector&lt;pair&lt;int, int&gt; &gt; graph[30009];\nvector&lt;pair&lt;int, int&gt; &gt;:: iterator it;\n\nlong long int far;\nint  visit[30001], last;\n\nvoid DFS(int vertex, long long int edge)\n{\n    if(edge &gt; far){\n        far = edge;\n        last = vertex;\n    }\n    /*for(int i = 0; i &lt; graph[vertex].size(); i++){\n        int node = graph[vertex][i].first;\n        int weight = graph[vertex][i].second;\n        if(visit[node] == 0){\n        visit[node] = 1;\n        DFS(node, edge+weight);\n    }\n}*/\n    for(it = graph[vertex].begin(); it != graph[vertex].end(); it++){\n        int node = it-&gt;first;\n        int weight = it-&gt;second;\n        if(visit[node] == 0){\n            visit[node] = 1;\n            DFS(node, edge+weight);\n        }\n    }\n\nreturn;\n\n}\nint main()\n{\n    int T, n,u,v,w;\n    scanf(\"%d\", &amp;T);\n    for(int i = 1; i &lt;= T; i++){\n            far = 0;\n\n        memset(visit, 0, sizeof(visit));\n        scanf(\"%d\", &amp;n);\n        for(int j = 0; j &lt; 30001; j++)\n            graph[j].clear();\n        for(int j = 1; j &lt; n; j++){\n            scanf(\"%d%d%d\", &amp;u, &amp;v, &amp;w);\n            graph[u].push_back(make_pair(v,w));\n            graph[v].push_back(make_pair(u,w));\n        }\n        visit[0] = 1;\n        DFS(0, 0);\n\n        memset(visit, 0, sizeof(visit));\n        visit[last] = 1;\n        DFS(last, 0);\n\n        printf(\"Case %d: %lld\\n\", i, far);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "linux", "windows", "build", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1527706388, "post_id": 50611405, "comment_id": 88233174, "body": "<code>How is it possible for A to build without the symbols from C and D?</code> - <b>Static</b> libraries are <b>not linked</b>, so they needn&#39;t symbols from other libraries to be defined. <code>Should I just build A,B,C and D as .a static libraries and have the Main include them all?</code> - If this works, why do you need to find other ways?"}, {"owner": {"reputation": 313, "user_id": 6133698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfa4373992c2edad6b81ff6b764630e4?s=128&d=identicon&r=PG&f=1", "display_name": "hamza keurti", "link": "https://stackoverflow.com/users/6133698/hamza-keurti"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1527707058, "post_id": 50611405, "comment_id": 88233502, "body": "For me it just didn&#39;t make sense that the application should include second degree dependencies. If the dependencies were deeper, it will mean I will have to include the whole chain."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1527709436, "post_id": 50611405, "comment_id": 88234576, "body": "You probably want <i>SHARED</i> libraries - they are linked with their dependencies, and store that linkage inside."}, {"owner": {"reputation": 313, "user_id": 6133698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfa4373992c2edad6b81ff6b764630e4?s=128&d=identicon&r=PG&f=1", "display_name": "hamza keurti", "link": "https://stackoverflow.com/users/6133698/hamza-keurti"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1527709765, "post_id": 50611405, "comment_id": 88234726, "body": "I&#39;ve seen some of the code from my teammates and it involves having additional headers with some confusing macros: __declspec(dllexport/dllimport), that I don&#39;t understand till now."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 6133698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfa4373992c2edad6b81ff6b764630e4?s=128&d=identicon&r=PG&f=1", "display_name": "hamza keurti", "link": "https://stackoverflow.com/users/6133698/hamza-keurti"}, "edited": false, "score": 0, "creation_date": 1527774314, "post_id": 50614679, "comment_id": 88261599, "body": "Great answer! Thank you!   Just for the sake of discussion and clarification on a particular case. If A and B both depend on C, and I do the target_link_libraries(...), will it mean I add the code from C twice when I build Main?"}, {"owner": {"reputation": 2270, "user_id": 8964493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/569f20d32952eb1847a1c159e95997aa?s=128&d=identicon&r=PG&f=1", "display_name": "joe_chip", "link": "https://stackoverflow.com/users/8964493/joe-chip"}, "reply_to_user": {"reputation": 313, "user_id": 6133698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfa4373992c2edad6b81ff6b764630e4?s=128&d=identicon&r=PG&f=1", "display_name": "hamza keurti", "link": "https://stackoverflow.com/users/6133698/hamza-keurti"}, "edited": false, "score": 0, "creation_date": 1527779503, "post_id": 50614679, "comment_id": 88265021, "body": "No, C will be linked only once. CMake will pass libraries to the linker in correct order (because <code>ld</code> needs libs in the correct order, when there are dependencies between them), without duplicating them unnecessarily. I think that a lib can be mentioned more than once only when there are circular dependencies between libs.  Btw - if you use CMake&#39;s Makefile generator, you can peek at generated commands by setting <code>CMAKE_VERBOSE_MAKEFILE</code> to <code>YES</code>."}], "tags": [], "owner": {"reputation": 2270, "user_id": 8964493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/569f20d32952eb1847a1c159e95997aa?s=128&d=identicon&r=PG&f=1", "display_name": "joe_chip", "link": "https://stackoverflow.com/users/8964493/joe-chip"}, "is_accepted": true, "score": 2, "last_activity_date": 1527723207, "creation_date": 1527723207, "answer_id": 50614679, "question_id": 50611405, "link": "https://stackoverflow.com/questions/50611405/c-build-process-lib-dependencies/50614679#50614679", "title": "C++ build process - lib dependencies", "body": "<p>Static libraries are merely archives containing object files (i. e. separately compiled source files). For this reason, when building a static library you don't \"link\" it, but \"archive\" it. </p>\n\n<p>Symbols have to be resolved when linking an executable or a shared library. At this point linker tries to resolve all symbols, at if it cannot, you get <code>undefined reference</code> errors. But, again, this pertains to linking. Static libraries do not need to have all symbols defined within them.</p>\n\n<p>In your case, if <code>A</code>, <code>B</code>, <code>C</code> and <code>D</code> are static libs, they will be built independently from each other. The only thing you need to build <code>A</code> from <code>C</code> and <code>D</code> are header files, which are needed by the compiler.</p>\n\n<p>When you are building an executable, you need to specify all static libraries, even if <code>Main</code> doesn't \"directly\" reference symbols from <code>C</code> or <code>D</code>.</p>\n\n<p>Now, even though static libraries cannot implicitly depend on other libraries, CMake provides a way to express such dependencies on build system level. You can do the following</p>\n\n<pre><code>add_library(C STATIC ${B_SOURCES})\nadd_library(D STATIC ${D_SOURCES})\n\nadd_library(A STATIC ${A_SOURCES})\ntarget_link_libraries(A PUBLIC C D)\n</code></pre>\n\n<p><code>target_link_libraries</code> command above does not cause <code>A</code> to be linked with <code>C</code> and <code>D</code> - as I wrote, that's not have static libs work. Instead, it informs CMake that when linking an executable with <code>A</code>, it has to link it with <code>C</code> and <code>D</code> too:</p>\n\n<pre><code>add_executable(Main ${MAIN_SOURCES})\ntarget_link_libraries(Main PRIVATE A)\n</code></pre>\n\n<p>Even though <code>target_link_libraries</code> includes only <code>A</code>, Makefile generated by CMake will also link <code>C</code> and <code>D</code> - because they were specified as dependencies of <code>A</code>.</p>\n\n<hr>\n\n<p><strong>dllexport and dllimport</strong></p>\n\n<p>These two attributes pertain only to shared libraries (DLLs). They control which symbols are exported from a DLL (i. e. accessible from an executable which links to that DLL). <a href=\"https://gcc.gnu.org/wiki/Visibility\" rel=\"nofollow noreferrer\">Here's a link</a> describing the idea and equivalent on Linux.</p>\n"}], "owner": {"reputation": 313, "user_id": 6133698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfa4373992c2edad6b81ff6b764630e4?s=128&d=identicon&r=PG&f=1", "display_name": "hamza keurti", "link": "https://stackoverflow.com/users/6133698/hamza-keurti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "accepted_answer_id": 50614679, "answer_count": 1, "score": 1, "last_activity_date": 1527723207, "creation_date": 1527705344, "question_id": 50611405, "link": "https://stackoverflow.com/questions/50611405/c-build-process-lib-dependencies", "title": "C++ build process - lib dependencies", "body": "<p>I have a Visual studio solution with 5 projects</p>\n\n<ul>\n<li>Main: application</li>\n<li>A,B,C,D: static libraries</li>\n</ul>\n\n<p>Main depends on A,B. A depends on C,D.</p>\n\n<p>I have a fragile understanding of the build process.</p>\n\n<p>The libs were building alone fine, especially A; I did not feel I was linking C and D to A.</p>\n\n<p>And to build the Main application, I had to have A,B,C and D as input libraries even though Main only directly depends on A,B.</p>\n\n<p>Now I am trying to build he whole thing on Linux with CMake, and I find myself exposed to these linking again. This time I don't want to use brute force and would prefer to understand how this links together.</p>\n\n<p>Should I just build A,B,C and D as .a static libraries and have the Main include them all?</p>\n\n<p>How is it possible for A to build without the symbols from C and D?</p>\n"}, {"tags": ["c++", "recursion", "static-variables"], "comments": [{"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "edited": false, "score": 1, "creation_date": 1527705172, "post_id": 50611310, "comment_id": 88232583, "body": "Static variables are destroyed on program exit. They are initialized when the code is first encountered."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1527705563, "post_id": 50611310, "comment_id": 88232758, "body": "Just so that the duplicate makes more sense - the fact that function is recursive have no effect on lifetime of a static variable."}], "owner": {"reputation": 91, "user_id": 4674433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b26dd155d8a1de186dc472494e6fde?s=128&d=identicon&r=PG&f=1", "display_name": "Naruto Uzumaki", "link": "https://stackoverflow.com/users/4674433/naruto-uzumaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1527704991, "answer_count": 0, "score": 1, "last_activity_date": 1527707040, "creation_date": 1527704927, "last_edit_date": 1527707040, "question_id": 50611310, "link": "https://stackoverflow.com/questions/50611310/static-variable-lifespan-in-c", "closed_reason": "Duplicate", "title": "Static variable lifespan in c++", "body": "<p>Will the static variable declared in a recursive function be destroyed once the first return executes?<br>\nFor example:  </p>\n\n<pre><code>int func(int x) {\n    static int n;\n    // recursive call\n}\n</code></pre>\n"}, {"tags": ["android", "c++", "wifi"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527705786, "post_id": 50611288, "comment_id": 88232876, "body": "I think you got a bracket in the wrong place somewhere in <code>if(JStringToString(wifiInfo-&gt;getSSID()-&gt;equals(&quot;\\&quot;HomeWifi\\&quot;&zwnj;&#8203;&quot;)))</code> As coded you are trying to the output of <code>equals</code>, probably a boolean of some sort, with <code>JStringToString</code>."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1527705906, "post_id": 50611288, "comment_id": 88232935, "body": "<code>wifiInfo-&gt;getSSID()</code> -- This is repeated at least 4 times in the code you posted.  Why not save the value to a variable the first time and just use that variable?  It not only makes the program more readable, but also a good chance that your program runs (slightly) faster."}, {"owner": {"reputation": 11, "user_id": 5533348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dc2cf5759322a5336087f6a7c97d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Hezekiel Nkambule", "link": "https://stackoverflow.com/users/5533348/hezekiel-nkambule"}, "edited": false, "score": 0, "creation_date": 1527706647, "post_id": 50611288, "comment_id": 88233295, "body": "even if i call wifiInfo-&gt;getSSID() once i still get an error. the problem is in the IF statement and the bracket are correct i checked."}, {"owner": {"reputation": 11, "user_id": 5533348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dc2cf5759322a5336087f6a7c97d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Hezekiel Nkambule", "link": "https://stackoverflow.com/users/5533348/hezekiel-nkambule"}, "edited": false, "score": 0, "creation_date": 1527706915, "post_id": 50611288, "comment_id": 88233431, "body": "String ssid = JStringToString(wifiInfo-&gt;getSSID()-&gt;toString());  \t if(wifiInfo-&gt;getSSID()-&gt;equals(ssid))// i still get an error"}, {"owner": {"reputation": 623, "user_id": 2008273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VTTvj.jpg?s=128&g=1", "display_name": "ricco19", "link": "https://stackoverflow.com/users/2008273/ricco19"}, "edited": false, "score": 0, "creation_date": 1527707040, "post_id": 50611288, "comment_id": 88233494, "body": "The error message isn&#39;t useful? Looks like <code>equals()</code> expects an object &#39;_di_JString&#39; and you are passing a string literal?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527708901, "post_id": 50611288, "comment_id": 88234341, "body": "You get a different error. You have multiple bugs. You likely want something like <code>if(ssid-&gt;equals(String(&quot;\\&quot;HomeWifi\\&quot;&quot;)))</code>"}, {"owner": {"reputation": 11, "user_id": 5533348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dc2cf5759322a5336087f6a7c97d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Hezekiel Nkambule", "link": "https://stackoverflow.com/users/5533348/hezekiel-nkambule"}, "edited": false, "score": 0, "creation_date": 1527749853, "post_id": 50611288, "comment_id": 88246487, "body": "if i do this :                                                                                             if(wifiInfo-&gt;getSSID()-&gt;equals(&quot;\\&quot;HomeWifi\\&quot;&quot;))                            i get an erro: no viable conversion from &#39;const char [12]&#39; to &#39;_di_JObject&#39; (aka DelphiInterface&lt;Androidapi::Jni::Javatypes::JObject&gt;&#39;)"}, {"owner": {"reputation": 11, "user_id": 5533348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dc2cf5759322a5336087f6a7c97d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Hezekiel Nkambule", "link": "https://stackoverflow.com/users/5533348/hezekiel-nkambule"}, "edited": false, "score": 0, "creation_date": 1530711926, "post_id": 50611288, "comment_id": 89333086, "body": "i have changed my statement to, if(JStringToString(wifiInfo-&gt;getSSID()-&gt;toString()) == tmpSSID). this statement compiles with no errors but it doesn&#39;t go to the if statement. please help"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5533348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dc2cf5759322a5336087f6a7c97d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Hezekiel Nkambule", "link": "https://stackoverflow.com/users/5533348/hezekiel-nkambule"}, "is_accepted": false, "score": 0, "last_activity_date": 1530714805, "creation_date": 1530714805, "answer_id": 51176082, "question_id": 50611288, "link": "https://stackoverflow.com/questions/50611288/comparing-wifi-ssid-to-a-string-in-c/51176082#51176082", "title": "Comparing wifi SSID to a string in c++", "body": "<p>the solution to my problem is</p>\n\n<pre><code>if((JStringToString(wifiInfo-&gt;getSSID()-&gt;toString())) == \"\\\"\" + tmpSSID + \"\\\"\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5533348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9dc2cf5759322a5336087f6a7c97d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Hezekiel Nkambule", "link": "https://stackoverflow.com/users/5533348/hezekiel-nkambule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530714805, "creation_date": 1527704860, "last_edit_date": 1527706380, "question_id": 50611288, "link": "https://stackoverflow.com/questions/50611288/comparing-wifi-ssid-to-a-string-in-c", "title": "Comparing wifi SSID to a string in c++", "body": "<p><strong>I am trying to compare the WiFi SSID of the connected wifi to the one I want it to connect to. i'm using rad studio 10.2.3 c++. So I am using the following code</strong>:</p>\n\n<pre><code> _di_JObject obj = SharedActivityContext()-&gt;getApplicationContext()-&gt; \n getSystemService(TJContext::JavaClass-&gt;WIFI_SERVICE);\n _di_JWifiManager wifiMng = TJWifiManager::Wrap(((_di_ILocalObject)obj)-&gt; \n GetObjectID());\n\n _di_JWifiInfo wifiInfo = wifiMng-&gt;getConnectionInfo();\n\n String ssid = JStringToString(wifiInfo-&gt;getSSID()-&gt;toString());\n\n //ive also tried the below code with no success\n String ssid = wifiInfo-&gt;getSSID()-&gt;toString();\n\n if(JStringToString(wifiInfo-&gt;getSSID()-&gt;equals(\"\\\"HomeWifi\\\"\")))\n {\n    ShowMessage(\"Connected to: \"+JStringToString(wifiInfo-&gt;getSSID()));\n }\n else\n {\n    ShowMessage(\"Not connected to: \"+JStringToString(wifiInfo-&gt;getSSID()));\n }\n</code></pre>\n\n<p>i get an error in the if statement.\nError: no viable conversion from 'const char [12]' to '_di_JString' (aka 'DelphiInterface')</p>\n\n<p>please help...</p>\n"}, {"tags": ["c++", "this", "resharper"], "answers": [{"comments": [{"owner": {"reputation": 6577, "user_id": 122951, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/689d383717f92bc02f16fbb8ce47683f?s=128&d=identicon&r=PG", "display_name": "Sergey Podobry", "link": "https://stackoverflow.com/users/122951/sergey-podobry"}, "edited": false, "score": 0, "creation_date": 1558936768, "post_id": 50613640, "comment_id": 99249163, "body": "Checking for <code>__RESHARPER__</code> has been added to plog. Just get the latest version of it."}], "tags": [], "owner": {"reputation": 1187, "user_id": 5712330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzKU4.png?s=128&g=1", "display_name": "Igor Akhmetov", "link": "https://stackoverflow.com/users/5712330/igor-akhmetov"}, "is_accepted": true, "score": 2, "last_activity_date": 1527715968, "creation_date": 1527715968, "answer_id": 50613640, "question_id": 50610921, "link": "https://stackoverflow.com/questions/50610921/resharper-c-and-plog-logger/50613640#50613640", "title": "Resharper C++ and Plog logger", "body": "<p>I've filed <a href=\"https://youtrack.jetbrains.com/issue/RSCPP-22423\" rel=\"nofollow noreferrer\">RSCPP-22423</a>, we'll try to fix this in one of the 2018.2 EAP builds. Until then, you can redefine the <code>PLOG_GET_THIS</code> macro for ReSharper C++ like this:</p>\n\n<pre><code>#include &lt;plog/Log.h&gt;\n#if defined(__RESHARPER__)\n#define PLOG_GET_THIS() reinterpret_cast&lt;void*&gt;(0)\n#endif\n</code></pre>\n\n<p>Or similarly update the original definition of <code>PLOG_GET_THIS</code> (it already checks for the similar <code>__INTELLISENSE__</code> macro to determine if <code>__if_exists</code> can be used).</p>\n"}], "owner": {"reputation": 1764, "user_id": 488336, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/36a13e5f78aa4b60b02a4106b2916056?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/488336/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 50613640, "answer_count": 1, "score": 2, "last_activity_date": 1527715968, "creation_date": 1527703344, "last_edit_date": 1527705538, "question_id": 50610921, "link": "https://stackoverflow.com/questions/50610921/resharper-c-and-plog-logger", "title": "Resharper C++ and Plog logger", "body": "<p>I am using Plog in my project for logging.  I also use resharper c++.</p>\n\n<p>There are several macros used for logging that make it less verbose.  One of the macros always gets marked as an issue with Resharper but I don't know why.</p>\n\n<p>The macro is LOGD which expands to </p>\n\n<pre><code>            if (!plog::get&lt;0&gt;() || !plog::get&lt;0&gt;()- \n              &gt;checkSeverity(plog::debug)) {;} else (*plog::get&lt;0&gt;()) += \n              plog::Record(plog::debug, __FUNCTION__, 151, \"\", \n              __if_exists(this) { this } __if_not_exists(this) { 0 }) &lt;&lt; \n              \"Message\";\n</code></pre>\n\n<p>The warning points to the usage of \"this\" as it expects an identifier.</p>\n\n<p>The method it is calling has a signature of:</p>\n\n<pre><code>Record(Severity severity, const char* func, size_t line, const char* file, const void* object)\n        : m_severity(severity), m_tid(util::gettid()), m_object(object), m_line(line), m_func(func), m_file(file)\n</code></pre>\n\n<p>Does anyone have experience with this an know how to modify the macro so it does not complain?</p>\n"}, {"tags": ["android", "c++", "visual-studio", "opensl"], "owner": {"reputation": 3454, "user_id": 6485082, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3c127a713f55a0f952b1b7941f25ace8?s=128&d=identicon&r=PG&f=1", "display_name": "FCin", "link": "https://stackoverflow.com/users/6485082/fcin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527703342, "creation_date": 1527703342, "question_id": 50610920, "link": "https://stackoverflow.com/questions/50610920/how-to-add-opensl-es-library-as-a-dependency-to-a-project", "title": "How to add OpenSL ES library as a dependency to a project?", "body": "<p>I have started adding OpenSL ES code to my Dynamic Shared Library project, but when I try to compile it, linker says: </p>\n\n<pre><code>undefined reference to 'slCreateEngine'\n</code></pre>\n\n<p>I can see <code>OpenSLES.h</code> in \"External Dependencies\", but linker cannot see it somehow. This is the code:</p>\n\n<pre><code>#include \"Processing.h\"\n#include &lt;SLES/OpenSLES.h&gt;\n#include &lt;SLES/OpenSLES_Android.h&gt;\n\nextern \"C\" {\n    int Java_com_example_Android_MainPageViewModel_GetValue()\n    {\n        SLObjectItf engine_obj;\n        slCreateEngine(&amp;engine_obj, 0, NULL, 0, NULL, NULL);\n\n        return 42;\n    }\n}\n</code></pre>\n\n<p>How can I add NDK library to Dynamic Shared Library project in Visual Studio?</p>\n"}, {"tags": ["c++", "cmake", "kate"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7142428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0623bff1e02b99d1c3dd816996e82e29?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/7142428/pablo"}, "edited": false, "score": 0, "creation_date": 1527711362, "post_id": 50610760, "comment_id": 88235395, "body": "Qt was installed using apt-get install qtbase5-dev. And it looks that the cmake is recognizing it-s path. It is just specifically this QWidget which id doesn&#39;t seem to find. Do you know how to verify within the cmake if the path is properly defined? Thanks"}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1527702668, "creation_date": 1527702668, "answer_id": 50610760, "question_id": 50610673, "link": "https://stackoverflow.com/questions/50610673/how-to-build-kate-with-cmake/50610760#50610760", "title": "how to build kate with cmake?", "body": "<p>QWidgetAction is a part of Qt. Have you got the Qt libraries and headers properly in your path?</p>\n\n<p>Header: #include </p>\n"}], "owner": {"reputation": 23, "user_id": 7142428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0623bff1e02b99d1c3dd816996e82e29?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/7142428/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548248265, "creation_date": 1527702315, "question_id": 50610673, "link": "https://stackoverflow.com/questions/50610673/how-to-build-kate-with-cmake", "title": "how to build kate with cmake?", "body": "<p>Dear stackoverflow users,</p>\n\n<p>I'm trying to compile kate from source but I'm getting an error with a not declared variable.\nSo far these are the commands I'm using:</p>\n\n<pre><code>#! /bin/bash\ncmake \\  \n-D CMAKE_BUILD_TYPE=RelWithDebInfo \\  \n-D CMAKE_INSTALL_PREFIX=~/kde/usr \\  \n-D KDE_INSTALL_USE_QT_SYS_PATHS:BOOL=ON \\  \n-D TARGET_include_directories:PATH=\"/usr/include/x86_64-linux-gnu/qt5/\" \\  \n-D Qt5_INCLUDE_DIRS:PATH=\"/usr/include/x86_64-linux-gnu/qt5/\" \\  \n-D Qt5_LIBRARY_DIRS:PATH=\"/usr/lib/x86_64-linux-gnu/qt5/\" \\  \n../kate/  \nmake  \nmake install\n</code></pre>\n\n<p>Please find below the error during compiling: I think it has to be related with not including some path file that should be there which declares the variable QWidgetAction, however I'm not sure why, since I installed all required packages as per the website. </p>\n\n<p>(qtbase5-dev qtscript5-dev extra-cmake-modules plasma-framework-dev libkf5crash-dev libkf5config-dev libkf5activities-dev kinit-dev kdoctools-dev libkf5i18n-dev libkf5parts-dev libkf5guiaddons-dev libkf5iconthemes-dev libkf5jobwidgets-dev kio-dev libkf5texteditor-dev libkf5windowsystem-dev libkf5xmlgui-dev libgit2-dev).\nThe reason I'm compiling it is because I messed up with my original installed kate and I just can't load back all plugins, since my /.config kate folder is gone. Please any help is appreciated.</p>\n\n<blockquote>\n  <p>[ 69%] Automatic moc for target katecloseexceptplugin    [ 69%] Built\n  target katecloseexceptplugin_automoc     [ 71%] Built target\n  katecloseexceptplugin     [ 71%] Automatic moc for target\n  katesqlplugin      [ 71%] Built target katesqlplugin_automoc     [\n  71%] Building CXX object addons/katesql/CMakeFiles/katesqlplugin.dir<br>\n  /katesqlview.cpp.o\n  /home/pablo/kde/kate/addons/katesql/katesqlview.cpp: In member\n  function \u2018void     KateSQLView::setupActions()\u2019:<br>\n  /home/pablo/kde/kate/addons/katesql/katesqlview.cpp:141:3: error:<br>\n  \u2018QWidgetAction\u2019 was not declared in this scope        QWidgetAction\n  *wa = new QWidgetAction(this);        ^      /home/pablo/kde/kate/addons/katesql/katesqlview.cpp:141:18: error:\n  \u2018wa\u2019 was     not declared in this scope         QWidgetAction *wa =\n  new QWidgetAction(this);<br>\n                    ^     /home/pablo/kde/kate/addons/katesql/katesqlview.cpp:141:27: error:\n  expected      type-specifier before \u2018QWidgetAction\u2019<br>\n  QWidgetAction <em>wa = new QWidgetAction(this);<br>\n                             ^      addons/katesql/CMakeFiles/katesqlplugin.dir/build.make:96: recipe for\n  target<br>\n  'addons/katesql/CMakeFiles/katesqlplugin.dir/katesqlview.cpp.o' failed\n  make[2]: <strong></em>\n  [addons/katesql/CMakeFiles/katesqlplugin.dir/katesqlview.cpp.o]<br>\n  Error 1      CMakeFiles/Makefile2:2439: recipe for target\n  'addons/katesql/CMakeFiles    /katesqlplugin.dir/all' failed<br>\n  make[1]: *</strong> [addons/katesql/CMakeFiles/katesqlplugin.dir/all] Error 2\n  Makefile:138: recipe for target 'all' failed      make: *** [all]\n  Error 2</p>\n</blockquote>\n"}, {"tags": ["c++", "sockets"], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1527702348, "post_id": 50610590, "comment_id": 88231218, "body": "And if James would realloc his size plus BUFSIZE the code could just call read() with the current buffer, saving the cost of memcpy."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1527702506, "post_id": 50610590, "comment_id": 88231296, "body": "@ZanLynx this is true, but since the whole idea of intermediate realloc&#39;ed buffer is not clear to me, I just assumed it&#39;s an artifact of an actual problem and left it as is."}, {"owner": {"reputation": 103, "user_id": 9534874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/9534874/james"}, "edited": false, "score": 0, "creation_date": 1527702692, "post_id": 50610590, "comment_id": 88231394, "body": "Thanks, I misunderstood that strncpy always copies exactly n characters."}, {"owner": {"reputation": 103, "user_id": 9534874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/9534874/james"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1527702707, "post_id": 50610590, "comment_id": 88231406, "body": "@Zan Lynx Thanks for advice. That&#39;s a great idea"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 7, "last_activity_date": 1527701966, "last_edit_date": 1527701966, "creation_date": 1527701909, "answer_id": 50610590, "question_id": 50610548, "link": "https://stackoverflow.com/questions/50610548/can-using-strncpy-to-copy-tcp-stream-cause-malfunction/50610590#50610590", "title": "Can using strncpy to copy tcp stream cause malfunction?", "body": "<p>You can't use <code>strncpy</code> (and friends) to copy binary data. This function copies bytes until it encounters nul-terminator (<code>'\\0'</code>). Binary data, in particularly, images, have a lot of those characters in them, and string functions will not copy it completely.</p>\n\n<p>To copy binary data, you can use <code>memcpy</code> or <code>std::copy</code>. </p>\n\n<p>On a side note, your <code>memset</code> before <code>read</code> is completely unnecessary and just contributes to global warming without doing anything useful.</p>\n"}], "owner": {"reputation": 103, "user_id": 9534874, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/9534874/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50610590, "answer_count": 1, "score": 2, "last_activity_date": 1527702097, "creation_date": 1527701698, "last_edit_date": 1527702097, "question_id": 50610548, "link": "https://stackoverflow.com/questions/50610548/can-using-strncpy-to-copy-tcp-stream-cause-malfunction", "title": "Can using strncpy to copy tcp stream cause malfunction?", "body": "<p>I am making a simple proxy server. And I have a very hard time with parsing response.</p>\n\n<pre><code>// Case 1\ndo {\n    memset(buffer, 0, BUFSIZE);\n    con = read(sockfd, buffer, BUFSIZE);\n    write(client, buffer, con);\n} while(con);\n\n// Case 2\ndo {\n    memset(buffer, 0, BUFSIZE);\n    con = read(sockfd, buffer, BUFSIZE);\n    size += con;\n    cachebuf = (char*)realloc(cachebuf, size);\n    strncpy(cachebuf+(size-con), buffer, con);\n} while(con);\nwrite(client, cachebuf, size);\n</code></pre>\n\n<p>These two samples receive a TCP stream from the end server, and forward it to browser. The only difference is that first one forwards the stream as soon as it receives it, and second one saves the stream in the cachebuf pointer and sends as a whole(which it the case I want to use)</p>\n\n<p>It seems same, and both works fine when it receives a HTML file. However, the second one can not send images. Why does this happen? </p>\n"}, {"tags": ["c++", "profiling", "intel-pin"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 4417867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/23132faa970a1bc27f527c7f450ea464?s=128&d=identicon&r=PG&f=1", "display_name": "Simus", "link": "https://stackoverflow.com/users/4417867/simus"}, "edited": false, "score": 0, "creation_date": 1527754775, "post_id": 50616300, "comment_id": 88249186, "body": "Would there still be zero instrumentation if, instead of empty callbacks, I used callbacks which do very simple operations with negligible overhead, e.g. incrementing a counter?"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 309, "user_id": 4417867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/23132faa970a1bc27f527c7f450ea464?s=128&d=identicon&r=PG&f=1", "display_name": "Simus", "link": "https://stackoverflow.com/users/4417867/simus"}, "edited": false, "score": 0, "creation_date": 1527777710, "post_id": 50616300, "comment_id": 88263890, "body": "@Simus Callbacks don&#39;t get inlined, only analysis routines. if you increment a global counter or a thread-local counter in an analysis routine, then there will be some instrumentation."}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": true, "score": 1, "last_activity_date": 1527738119, "creation_date": 1527738119, "answer_id": 50616300, "question_id": 50610477, "link": "https://stackoverflow.com/questions/50610477/intel-pin-measuring-empty-instrumentation-overhead/50616300#50616300", "title": "Intel Pin: measuring empty instrumentation overhead", "body": "<p>Pin performs a number of optimizations to generate very efficient instrumented code. In particular, empty analysis routines will definitely get inlined into the application routines. Empty functions in C/C++ will most likely get compiled to a single instruction (on x86, it's some form of <code>ret</code>). Pin may be able to recognize that and completely remove that instruction, leaving you with zero instrumentation. You can determine whether Pin removes <code>ret</code> by comparing the performance without any instrumentation and that of with empty analysis routines. If the difference is zero, there is a good chance that Pin eliminated the instruction. Although this is not documented as far as I know.</p>\n"}], "owner": {"reputation": 309, "user_id": 4417867, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/23132faa970a1bc27f527c7f450ea464?s=128&d=identicon&r=PG&f=1", "display_name": "Simus", "link": "https://stackoverflow.com/users/4417867/simus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 50616300, "answer_count": 1, "score": 2, "last_activity_date": 1527738130, "creation_date": 1527701434, "last_edit_date": 1527738130, "question_id": 50610477, "link": "https://stackoverflow.com/questions/50610477/intel-pin-measuring-empty-instrumentation-overhead", "title": "Intel Pin: measuring empty instrumentation overhead", "body": "<p>I want to measure how my Pintool worsens the execution time of an executable in the case where it simply does \"empty instrumentation\".</p>\n\n<p>Basicly in my Pintool I got a callback which is called every time an Image is loaded which, in turn, inserts analysis functions for specific routines.</p>\n\n<p>So I was thinking of measuring the \"empty instrumentation\" overhead using two modes of operation:</p>\n\n<ol>\n<li>Having an empty Image callback function, to be called when each image is loaded, instead of the ordinary one</li>\n<li>Having empty routine analysis functions to be called instead of the ordinary ones</li>\n</ol>\n\n<p>Is this approach viable? Are there better solutions I am unaware of?</p>\n"}, {"tags": ["java", "c++", "regex", "performance", "c++11"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 3, "creation_date": 1527701354, "post_id": 50610414, "comment_id": 88230650, "body": "Obvious question: How did you compile the c++ code? Did you have optimizations on?"}, {"owner": {"reputation": 39204, "user_id": 5761558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cf04bfac11ef3ee693852eccde3b3c?s=128&d=identicon&r=PG&f=1", "display_name": "ernest_k", "link": "https://stackoverflow.com/users/5761558/ernest-k"}, "edited": false, "score": 3, "creation_date": 1527701361, "post_id": 50610414, "comment_id": 88230658, "body": "So you conclude that there&#39;s something wrong with your code because Java performs better than C++?"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 2, "creation_date": 1527701374, "post_id": 50610414, "comment_id": 88230670, "body": "Please confirm you coumpiled your C++ code with optimizations turned on. Also, you&#39;re not measuring just the regex, you&#39;re also measuring the print statement. I would not consider this a valid test."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1527701496, "post_id": 50610414, "comment_id": 88230751, "body": "i think it is because <code>std::regex</code> aren&#39;t precompiled meening that the regex and the expression to check are parsed at run-time"}, {"owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "edited": false, "score": 0, "creation_date": 1527701507, "post_id": 50610414, "comment_id": 88230763, "body": "Try it without printing the result to get the true value of the regex runtimes. Also, is the regex compiled on the C++ side?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1527701530, "post_id": 50610414, "comment_id": 88230774, "body": "how did you measure? I have the feeling that the numbers you quote primariliy reflect the time your code needs to print something on the console and the time needed for the regex is just some noise on top of that"}, {"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1527701623, "post_id": 50610414, "comment_id": 88230826, "body": "@user463035818 The &quot;measuring code&quot; is in the question..."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 0, "creation_date": 1527701658, "post_id": 50610414, "comment_id": 88230858, "body": "@Borgleader ups, then my feeling was right ;)"}, {"owner": {"reputation": 67, "user_id": 8581556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd9b29cdd586a215fb37a454a8b15c5?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/8581556/eddy"}, "edited": false, "score": 0, "creation_date": 1527701923, "post_id": 50610414, "comment_id": 88230984, "body": "i use visual studio17 for compiling c++"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 1, "creation_date": 1527702179, "post_id": 50610414, "comment_id": 88231128, "body": "Did you time a Debug or Release build? There can be a significant performance difference between them (Release enables optimizations)."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1527702401, "post_id": 50610414, "comment_id": 88231245, "body": "Right! In Release build I get 1672ms for VS2017."}, {"owner": {"reputation": 67, "user_id": 8581556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd9b29cdd586a215fb37a454a8b15c5?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/8581556/eddy"}, "edited": false, "score": 0, "creation_date": 1527702880, "post_id": 50610414, "comment_id": 88231480, "body": "i think i have problem in my VS build settings. what should i change?? or can u tell me the command line compilation code."}, {"owner": {"reputation": 67, "user_id": 8581556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd9b29cdd586a215fb37a454a8b15c5?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/8581556/eddy"}, "edited": false, "score": 0, "creation_date": 1527702897, "post_id": 50610414, "comment_id": 88231489, "body": "Downvoters it would be nice if u give a solution."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527703991, "post_id": 50610414, "comment_id": 88232032, "body": "In release build I get no output at all for GCC. In case it helps: here&#39;s the hotspot JVM assembly output <a href=\"http://stackoverflow-sehe.s3.amazonaws.com/fea76143-b712-4df9-97c3-4725b2f9e695/disasm.a.xz\" rel=\"nofollow noreferrer\">from <code>LD_PRELOAD=&#47;home&#47;sehe&#47;Projects&#47;stackoverflow&#47;fcml-1.1.3&#47;exam&zwnj;&#8203;ple&#47;hsdis&#47;.libs&#47;libh&zwnj;&#8203;sdis-amd64.so .&#47;jre1.8.0_171&#47;bin&#47;java -XX:+UnlockDiagnosticVMOptions -XX:+PrintAssembly Main  2&gt;&amp;1 &gt; disasm.a</code></a>"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1527706725, "post_id": 50610414, "comment_id": 88233335, "body": "This is going to depend on the regex engine. The one in <code>GCC</code> for example is not the fastest. Try it with <code>PCRE</code> (pcrecpp) and it should be a great deal faster."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1527707116, "post_id": 50610414, "comment_id": 88233529, "body": "In my tests, <code>GCC</code> regex is 20% slower than the <code>Java</code> one but using <code>PCRE</code> regex is 3 times <i>faster</i> that the <code>Java</code> test."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1527708872, "post_id": 50610414, "comment_id": 88234325, "body": "The MSVC regex implementation is <a href=\"https://twitter.com/StephanTLavavej/status/958129309130014720\" rel=\"nofollow noreferrer\">notoriously slow and in need of an overhaul</a>. A Better comparison would be boost::regex."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1527709507, "post_id": 50610414, "comment_id": 88234613, "body": "Related <a href=\"https://stackoverflow.com/a/14229152/332733\">stackoverflow.com/a/14229152/332733</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3960, "user_id": 654614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc0d43eb99234ed9702badb191b7d96?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Boyne", "link": "https://stackoverflow.com/users/654614/frank-boyne"}, "is_accepted": false, "score": 2, "last_activity_date": 1527706518, "creation_date": 1527706518, "answer_id": 50611668, "question_id": 50610414, "link": "https://stackoverflow.com/questions/50610414/regex-performance-java-vs-c11/50611668#50611668", "title": "regex performance java vs c++11", "body": "<p>As various commenters have pointed out it sounds like you are compiling your C++ code in <code>debug</code> mode which turns off many compiler optimizations and adds some extra diagnostic code to your program.</p>\n\n<p>Since you are using Visual Studio 2017 look for the Solution Configuration drop-down and change it from <code>Debug</code> to <code>Release</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/n1Zbq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n1Zbq.png\" alt=\"screenshot of Visual Studio 2017\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 1, "creation_date": 1527709807, "post_id": 50611867, "comment_id": 88234742, "body": "Try passing <a href=\"http://en.cppreference.com/w/cpp/regex/syntax_option_type\" rel=\"nofollow noreferrer\"><code>std::regex::optimize</code></a> to the constructor to force a FSA creation (in theory)"}, {"owner": {"reputation": 1512, "user_id": 7885750, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43lAl.jpg?s=128&g=1", "display_name": "Stephen M. Webb", "link": "https://stackoverflow.com/users/7885750/stephen-m-webb"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 1, "creation_date": 1527711063, "post_id": 50611867, "comment_id": 88235292, "body": "@Mgetz optimize makes the engine generate a DFA (deterministic finite automaton) instead of an NFA (non-deterministic finite automaton).  They&#39;re both Finite State Automata, but a DFA takes more effort to generate (although it will run faster and  cannot represent all regexes)."}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1527711541, "post_id": 50611867, "comment_id": 88235463, "body": "@Mgetz Or <code>optimize</code> does something else than we expect. Adding <a href=\"https://plot.ly/~sehe/19/\" rel=\"nofollow noreferrer\">clang+libc++</a>. Also, for fun: comparative benchmark using GCC;libstdc++;Boost1.67: <a href=\"https://plot.ly/~sehe/21/\" rel=\"nofollow noreferrer\">plot.ly/~sehe/21</a> (<a href=\"https://paste.ubuntu.com/p/FYn4nmfSZn/\" rel=\"nofollow noreferrer\">benchmark code</a>)"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527713602, "post_id": 50611867, "comment_id": 88236265, "body": "Added a Boost Xpressive <a href=\"https://www.boost.org/doc/libs/1_67_0/doc/html/xpressive/user_s_guide.html#xpressive.user_s_guide.creating_a_regex_object\" rel=\"nofollow noreferrer\">static regex</a> into the mix. The Benchmark is still at only <a href=\"https://paste.ubuntu.com/p/hTJnC3WjFr/\" rel=\"nofollow noreferrer\">&lt;30 LoC</a> and the results are still <a href=\"https://plot.ly/~sehe/23/\" rel=\"nofollow noreferrer\">clearly favouring Boost Regex</a>"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 1, "creation_date": 1527714423, "post_id": 50611867, "comment_id": 88236576, "body": "@rustyx That was a good call. Adding <code>ECMAScript | optimized</code> made the optimized regexen slightly faster - making a bit more sense. <a href=\"https://stackoverflow.com/posts/50611867/revisions\">Updated the answer</a> (again)."}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 16, "last_activity_date": 1527714982, "last_edit_date": 1527714982, "creation_date": 1527707315, "answer_id": 50611867, "question_id": 50610414, "link": "https://stackoverflow.com/questions/50610414/regex-performance-java-vs-c11/50611867#50611867", "title": "regex performance java vs c++11", "body": "<p>Made the C++ sample portable:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;regex&gt;\n\nusing C = std::chrono::high_resolution_clock;\nusing namespace std::chrono_literals;\n\nint main()\n{\n    auto start = C::now();\n    std::regex pat(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\");\n    for (long i = 0; i &lt; 1000000; i++) {\n        regex_match(\"abcd_ed123.t12y@haha.com\", pat);\n    }\n    std::cout &lt;&lt; (C::now() - start)/1.0ms;\n}\n</code></pre>\n\n<p>On linux, and with <code>clang++ -std=c++14 -march=native -O3 -o clang ./test.cpp</code> I get <code>595.970 ms</code>. See also <strong><kbd><a href=\"https://wandbox.org/permlink/seyy4DD0ZTruAe6q\" rel=\"noreferrer\">Live On Wandbox</a></kbd></strong></p>\n\n<p>The java runs in <code>561 ms</code>, on the same machine.</p>\n\n<blockquote>\n  <p><strong>Update</strong>: Boost Regex runs much faster, see below comparative benchmark</p>\n</blockquote>\n\n\n\n<blockquote>\n  <p><strong>Caveat</strong>: synthetic benchmarks like these are very prone to error: the compiler might sense that no observable side effects are done, and optimize the whole loop out, just to give an example.</p>\n</blockquote>\n\n<h2>More Fun: Adding Boost To The Mix</h2>\n\n<p>Using <a href=\"https://www.boost.org/users/history/version_1_67_0.html\" rel=\"noreferrer\">Boost 1.67</a> and <a href=\"https://nonius.io/\" rel=\"noreferrer\">Nonius Micro-Benchmarking Framework</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/z8cGT.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/z8cGT.png\" alt=\"enter image description here\"></a></p>\n\n<p>We can see that Boost's Regex implementations are <em>considerably</em> faster.</p>\n\n<p>See the detailed sample data interactive online: <a href=\"https://plot.ly/~sehe/25/\" rel=\"noreferrer\">https://plot.ly/~sehe/25/</a></p>\n\n<p><strong><kbd><a href=\"https://paste.ubuntu.com/p/JVBY2ZxBjJ/\" rel=\"noreferrer\">Code Used</a></kbd></strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;regex&gt;\n#include &lt;boost/regex.hpp&gt;\n#include &lt;boost/xpressive/xpressive_static.hpp&gt;\n#define NONIUS_RUNNER\n#include &lt;nonius/benchmark.h++&gt;\n#include &lt;nonius/main.h++&gt;\n\ntemplate &lt;typename Re&gt;\nvoid test(Re const&amp; re) {\n    regex_match(\"abcd_ed123.t12y@haha.com\", re);\n}\n\nstatic const std::regex std_normal(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\");\nstatic const std::regex std_optimized(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\", std::regex::ECMAScript | std::regex::optimize);\nstatic const boost::regex boost_normal(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\");\nstatic const boost::regex boost_optimized(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\", static_cast&lt;boost::regex::flag_type&gt;(boost::regex::ECMAScript | boost::regex::optimize));\n\nstatic const auto boost_xpressive = []{\n    using namespace boost::xpressive;\n    return cregex { bos &gt;&gt; +(_w | '.' | '_') &gt;&gt; '@' &gt;&gt; +_w &gt;&gt; '.' &gt;&gt; +alpha &gt;&gt; eos };\n}();\n\nNONIUS_BENCHMARK(\"std_normal\",      [] { test(std_normal);      })\nNONIUS_BENCHMARK(\"std_optimized\",   [] { test(std_optimized);   })\nNONIUS_BENCHMARK(\"boost_normal\",    [] { test(boost_normal);    })\nNONIUS_BENCHMARK(\"boost_optimized\", [] { test(boost_optimized); })\nNONIUS_BENCHMARK(\"boost_xpressive\", [] { test(boost_xpressive); })\n</code></pre>\n\n\n\n<blockquote>\n  <p><strong>Note</strong> Here's the output of the Hotspot JVM JIT compiler: </p>\n  \n  <ul>\n  <li><a href=\"http://stackoverflow-sehe.s3.amazonaws.com/fea76143-b712-4df9-97c3-4725b2f9e695/disasm.a.xz\" rel=\"noreferrer\">http://stackoverflow-sehe.s3.amazonaws.com/fea76143-b712-4df9-97c3-4725b2f9e695/disasm.a.xz</a></li>\n  </ul>\n  \n  <p>This was generated using</p>\n  \n  <p>LD_PRELOAD=/home/sehe/Projects/stackoverflow/fcml-1.1.3/example/hsdis/.libs/libhsdis-amd64.so ./jre1.8.0_171/bin/java -XX:+UnlockDiagnosticVMOptions -XX:+PrintAssembly Main  2>&amp;1 > disasm.a </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527801366, "post_id": 50612461, "comment_id": 88276054, "body": "&quot;JIT&quot; implies PCRE does compile directly into machine instructions? From what I&#39;ve seen regex usually compile into DFA, with the engine being highly optimized, but clearly ahead-of-time compiled code. +1 for the data point"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 2, "creation_date": 1527803134, "post_id": 50612461, "comment_id": 88276718, "body": "@sehe yes, it compiles <a href=\"https://github.com/luvit/pcre2/tree/master/src/sljit\" rel=\"nofollow noreferrer\">directly</a> into machine instructions. Kind of hard to beat"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527803178, "post_id": 50612461, "comment_id": 88276733, "body": "TIL. Awesome library. Nice addition!"}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 5, "last_activity_date": 1527776151, "last_edit_date": 1527776151, "creation_date": 1527709941, "answer_id": 50612461, "question_id": 50610414, "link": "https://stackoverflow.com/questions/50610414/regex-performance-java-vs-c11/50612461#50612461", "title": "regex performance java vs c++11", "body": "<p>Just to add to the already provided answers...</p>\n\n<p>Yes, the C++11 <code>std::regex</code> is slightly slower (even in Release mode) than the Java one.</p>\n\n<p>But PCRE2 with JIT is 3 times faster:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#define PCRE2_STATIC\n#define PCRE2_CODE_UNIT_WIDTH 8\n#include \"pcre2.h\"\n\nusing namespace std;\nusing namespace std::chrono;\nusing namespace std::chrono_literals;\n\nint main()\n{\n    auto start = high_resolution_clock::now();\n    int errn;\n    PCRE2_SIZE erroffset;\n    auto pattern = (PCRE2_SPTR8)\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\";\n    pcre2_code* re = pcre2_compile(pattern, PCRE2_ZERO_TERMINATED, 0, &amp;errn, &amp;erroffset, nullptr);\n    if (!re)\n        cerr &lt;&lt; \"pcre2_compile failed\\n\";\n    pcre2_match_data* match_data = pcre2_match_data_create_from_pattern(re, nullptr);\n    for (long i = 0; i &lt; 1000000; i++) {\n        auto text = (PCRE2_SPTR8)\"abcd_ed123.t12y@haha.com\";\n        int rc = pcre2_match(re, text, PCRE2_ZERO_TERMINATED, 0, 0, match_data, nullptr);\n        if (rc &lt;= 0)\n            cerr &lt;&lt; \"pcre2_match failed\\n\";\n    }\n    auto end = high_resolution_clock::now();\n    cout &lt;&lt; (end - start) / 1ms &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>\n\n<p><strong>Results:</strong></p>\n\n<ul>\n<li>PCRE2 v10.21: <code>139ms</code></li>\n<li>Java: <code>440ms</code></li>\n</ul>\n"}], "owner": {"reputation": 67, "user_id": 8581556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd9b29cdd586a215fb37a454a8b15c5?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/8581556/eddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1369, "favorite_count": 1, "accepted_answer_id": 50612461, "answer_count": 3, "score": 2, "last_activity_date": 1527776151, "creation_date": 1527701207, "last_edit_date": 1527701892, "question_id": 50610414, "link": "https://stackoverflow.com/questions/50610414/regex-performance-java-vs-c11", "title": "regex performance java vs c++11", "body": "<p>I am learning regex in c++ and java. So i did a performance test on c++11 regex and java regex with same expression and same no of inputs. Strangely java regex is faster than c++11 regex. Is there anything wrong in my code? Pls correct me</p>\n\n<p>Java code:</p>\n\n<pre><code>import java.util.regex.*;\n\npublic class Main {\n    private final static int MAX = 1_000_000;\n    public static void main(String[] args) {\n        long start = System.currentTimeMillis();\n        Pattern p = Pattern.compile(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\");\n        for (int i = 0; i &lt; MAX; i++) {\n            p.matcher(\"abcd_ed123.t12y@haha.com\").matches();\n        }\n        long end = System.currentTimeMillis();\n        System.out.print(end-start);\n    }\n}\n</code></pre>\n\n<p>C++ code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;regex&gt;\n\nusing namespace std;\n\nint main()\n{\n    long long start = GetTickCount64();\n    regex pat(\"^[\\\\w._]+@\\\\w+\\\\.[a-zA-Z]+$\");\n    for (long i = 0; i &lt; 1000000; i++) {\n        regex_match(\"abcd_ed123.t12y@haha.com\", pat);\n    }\n    long long end = GetTickCount64();\n    cout &lt;&lt; end - start;\n    return 0;\n}\n</code></pre>\n\n<p>Performance:</p>\n\n<pre><code>Java -&gt; 1003ms\nC++  -&gt; 124360ms\n</code></pre>\n"}, {"tags": ["c++", "qt"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 0, "creation_date": 1527795995, "post_id": 50612624, "comment_id": 88273415, "body": "Yes i did have a slight idea of how i would do that and that there has to be a variable that would help keep the Points look the same size on different SceneRects , ive tried transfom() , as a little test ive tried different Sizes (SceneRects) and qDebug() from transform() but it never changes (the values from transform) , regardless of my Scene&#39;s size , so i didnt think THAT would be what i needed."}, {"owner": {"reputation": 118, "user_id": 9426480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5xOC.jpg?s=128&g=1", "display_name": "vcloarec", "link": "https://stackoverflow.com/users/9426480/vcloarec"}, "reply_to_user": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 0, "creation_date": 1527801554, "post_id": 50612624, "comment_id": 88276142, "body": "The transform function gives me different value depending of the sceneRect which the view fits. I have some code that give me point with the same size in the screen. This not the perfect solution because the scaling of the Ellipse is base on the insert point that is not the center f the ellipse, so the center of the point is not really fix. I think the solution have to pass by subclassing a QGraphicsItems to move the point according to his size or scalling. PS : apologize my bad english"}, {"owner": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 0, "creation_date": 1527806801, "post_id": 50612624, "comment_id": 88277791, "body": "I tried the code and it works (zooming the view) , which will result in scrollbars and all (because of fitting the scene in the view after scaling) , but im bound to a fixed size unless the user wanted to Manually zoom (which will result in scrollbars) ... but im starting to think that this issue is a bit beyond what i imagined , see what we really want is to give the user the all Points regardless of the distance , so : Line : (0,0),(100,0) and Line : (0,0),(1000,0) will look the same to the user , so im starting to think that the problem isnt scaling at all ! Tell me What you think ?"}, {"owner": {"reputation": 118, "user_id": 9426480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5xOC.jpg?s=128&g=1", "display_name": "vcloarec", "link": "https://stackoverflow.com/users/9426480/vcloarec"}, "reply_to_user": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 0, "creation_date": 1527818074, "post_id": 50612624, "comment_id": 88280259, "body": "Finaly, it is less complicated than I say before, I am a specialist to find solution too complicated ... No need to subclass, just make the points to have their insertion point on their center. I have change the code above to integrate a zoom with the wheel. As you can see, the point keep the same size regardeless of the distance. I am not sure to have understood your problem, but maybe it would help. Four yours Line : (0,0),(100,0) and Line : (0,0),(1000,0), If you fit the view on the scene for each case, the two lines will look the same."}, {"owner": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 0, "creation_date": 1527870991, "post_id": 50612624, "comment_id": 88306044, "body": "The code does resize the created Points but still results in scrollbars , i wonder if resize() is resetting something ? PS : ive posted the Full latest code including the resize() function you suggested"}, {"owner": {"reputation": 118, "user_id": 9426480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5xOC.jpg?s=128&g=1", "display_name": "vcloarec", "link": "https://stackoverflow.com/users/9426480/vcloarec"}, "reply_to_user": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 1, "creation_date": 1527873980, "post_id": 50612624, "comment_id": 88307353, "body": "i have add some explanations"}, {"owner": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "edited": false, "score": 0, "creation_date": 1527875082, "post_id": 50612624, "comment_id": 88307868, "body": "Yes indeed , that really solved it , i had to set the center of the point when its created to -0.5 , -0.5 and than set the position with setPose() , it all looks good now and thanks for the WheelMouse code , i was gonna implement that as well , thanks for your help , really appreaciate it ! Marked as Best Answer."}], "tags": [], "owner": {"reputation": 118, "user_id": 9426480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5xOC.jpg?s=128&g=1", "display_name": "vcloarec", "link": "https://stackoverflow.com/users/9426480/vcloarec"}, "is_accepted": true, "score": 1, "last_activity_date": 1527873848, "last_edit_date": 1527873848, "creation_date": 1527710817, "answer_id": 50612624, "question_id": 50610346, "link": "https://stackoverflow.com/questions/50610346/qt-resize-text-on-qgraphicsscene-after-drawing/50612624#50612624", "title": "Qt - Resize Text on QGraphicsScene after drawing", "body": "<p>The dimensions of the points end the text is define in the scene coordinate, not in the viewport (the windows) coordinate .</p>\n\n<p>If you want the points and text keep their dimension on the display, you have to update the dimension depending of the \"zoom\" of your viewport. </p>\n\n<p><strong>Edit :</strong></p>\n\n<p>I try an analogy :</p>\n\n<ul>\n<li>QGraphicsView is a camera </li>\n<li>QGraphicScene is the real life</li>\n<li>QGraphicsItems are people ant things</li>\n</ul>\n\n<p>If you want to see a particular part of the scene, you use  <code>QGraphicsView::setSceneRect(const QRectF &amp; rect)</code> to \"zoom\" on the part define by <code>rect</code>. \nWhen you \"zoom\" or \"unzoom\" with the camera on objects, this objects don't change their size in the real life, but in the screen the size change. It is the same behaviour with QGraphicsView.</p>\n\n<p>If you want a fix size of the representation of your object, you have to adapt the size of your object with the scale of your scene. In your example with <code>addPoint(0 , 0 , \"P1\"); addPoint(0 , 1000 , \"P2\")</code>, the two points are far away from each other, and the points and texts are very small in comparison of this distance.</p>\n\n<p>The solution of your problem depends of the type of the representation you want (dynamic, static,...)</p>\n\n<p>Maybe you can use the matrix returned by <code>QTransform QGraphicsView::transform() const</code> and their diagonal elements to find the scale to use.</p>\n\n<p>Look at this :</p>\n\n<pre><code>    class MyView:public QGraphicsView\n{\npublic:\n    MyView(QWidget *parent):QGraphicsView(parent),sizeInView(5) {}\n\n    void resize();\n\nprotected:\n    void wheelEvent(QWheelEvent *event);\n\nprivate:\n    int sizeInView;\n\n};\n\nnamespace Ui {\nclass MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n    ~MainWindow();\n\n    void putPoint();\n\nprivate:\n\n    Ui::MainWindow *ui;\n    QGraphicsScene *scene;\n    MyView *view;\n};\n</code></pre>\n\n<p>And</p>\n\n<pre><code>   MainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n   ui-&gt;setupUi(this);\n   view=new MyView(this);\n   centralWidget()-&gt;setLayout(new QHBoxLayout());\n   centralWidget()-&gt;layout()-&gt;addWidget(view);\n\n   scene=new QGraphicsScene(this);\n   view-&gt;setScene(scene);\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n\nvoid MainWindow::putPoint()\n{\n    QGraphicsEllipseItem *point1= new QGraphicsEllipseItem(-0.5,-0.5,1,1);\n    point1-&gt;setPos(0,0);\n    QGraphicsEllipseItem *point2= new QGraphicsEllipseItem(-0.5,-0.5,1,1);\n    point2-&gt;setPos(0,100);\n    QGraphicsEllipseItem *point3= new QGraphicsEllipseItem(-0.5,-0.5,1,1);\n    point3-&gt;setPos(0,1000);\n    QGraphicsEllipseItem *point4= new QGraphicsEllipseItem(-0.5,-0.5,1,1);\n    point4-&gt;setPos(100,0);\n    QGraphicsEllipseItem *point5= new QGraphicsEllipseItem(-0.5,-0.5,1,1);\n    point5-&gt;setPos(100,100);\n    QGraphicsEllipseItem *point6= new QGraphicsEllipseItem(-0.5,-0.5,1,1);\n    point6-&gt;setPos(100,1000);\n\n    scene-&gt;addItem(point1);\n    scene-&gt;addItem(point2);\n    scene-&gt;addItem(point3);\n    scene-&gt;addItem(point4);\n    scene-&gt;addItem(point5);\n    scene-&gt;addItem(point6);\n\n    view-&gt;fitInView(scene-&gt;sceneRect(),Qt::KeepAspectRatio);\n    view-&gt;resize();\n}\n\n\nvoid MyView::resize()\n{\n    qreal scale=sizeInView/transform().m11();\n    for (int i=0;i&lt;scene()-&gt;items().count();++i)\n        scene()-&gt;items().at(i)-&gt;setScale(scale);\n}\n\nvoid MyView::wheelEvent(QWheelEvent *event)\n{\n    float fact=1.5;\n    if (event-&gt;delta()&gt;=120)\n    {\n        setTransform(transform()*fact);\n        resize();\n    }\n\n    if (event-&gt;delta()&lt;=-120)\n    {\n       setTransform(transform()/fact);\n       resize();\n    }\n}\n</code></pre>\n\n<p>Be careful, the insertion point of your QGraphicsItem in the scene is define by QGraphicsItem::setPos. The (x,y), you use when you create the point, is the position in the local coordinate system, not in the scene coordinate systeme and it is not the center on you point but the topleft rectangle containing the ellipse. </p>\n\n<p>So if the center of your point is not on the point of insertion, when you resize, the point move ... That's why i place the point at (-0.5,-0.5) in local coordinate with a height and width equal to 1. Then, I place the point with setPos in the scene coordinate.</p>\n\n<p>If you want to disable the scrollbar : </p>\n\n<pre><code>setHorizontalScrollBarPolicy ( Qt::ScrollBarAlwaysOff )\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 3780331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adecfec9f953965ddc73a9b2ff7ae6a4?s=128&d=identicon&r=PG", "display_name": "RedZ", "link": "https://stackoverflow.com/users/3780331/redz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "accepted_answer_id": 50612624, "answer_count": 1, "score": 2, "last_activity_date": 1527875455, "creation_date": 1527700971, "last_edit_date": 1527875455, "question_id": 50610346, "link": "https://stackoverflow.com/questions/50610346/qt-resize-text-on-qgraphicsscene-after-drawing", "title": "Qt - Resize Text on QGraphicsScene after drawing", "body": "<p>Im doing a little Plotting program with a group of students , we are using Qt's QGraphicsScene on a QGraphicsView to let the user plot custom Points on Specific Positions (x , y) , each point has to have a text on top of it.</p>\n\n<p>Here is the function responsible for adding Points to the Scene :</p>\n\n<pre><code>void MainWindow::AddPoint(float x, float y, QString name)\n{\n    y = y * -1; // To Flip Y-Axis\n    float Radius = 1; // Point's (Eclipse) Radius\n    QGraphicsItem *Point = p_Scene-&gt;addEllipse(x , y , Radius , Radius , QPen(QColor(Qt::red)) , QBrush(QColor(Qt::red))); // Creates a Red Colored Point on the given Coordinates (x , y) \n    /*\n    QGraphicsTextItem *Text = p_Scene-&gt;addText(name); // Creates a Text\n    Text-&gt;setDefaultTextColor(QColor(Qt::red)); // Sets Text's Color to Red\n    Text-&gt;setFont(QFont(\"Courier New\" , 4)); // Sets Text's Font Size\n    Text-&gt;setPos(x , y - 10); // Set Text's Position (On top of the Point)\n    ui-&gt;graphicsView-&gt;setScene(p_Scene); // Adds Text to the Scene\n    */\n}\n</code></pre>\n\n<p>so the Implementation would be like :</p>\n\n<pre><code>AddPoint(0 , 0 , \"P1\"); // Point 1\nAddPoint(50 , 100 , \"P2\"); // Point 2\nAddPoint(100 , 0 , \"P3\"); // Point 3 \n</code></pre>\n\n<p>This will results in :</p>\n\n<p><a href=\"https://i.stack.imgur.com/JZvfe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JZvfe.png\" alt=\"An Example of Plotting\"></a></p>\n\n<p>We are using : </p>\n\n<pre><code>ui-&gt;graphicsView-&gt;fitInView(ui-&gt;graphicsView-&gt;scene()-&gt;sceneRect() , Qt::KeepAspectRatio);\n</code></pre>\n\n<p>to make sure that QGraphicsView shows only whats visible (pretty important).</p>\n\n<p>so the problem here is , if we were to make the drawing larger , say for example :</p>\n\n<pre><code>AddPoint(0 , 0 , \"P1\");\nAddPoint(0 , 1000 , \"P2\"); // y = 1000\n</code></pre>\n\n<p>This will draw a very long line which will make the Points + Text we created so small that it cant even be seen :</p>\n\n<p><a href=\"https://i.stack.imgur.com/RsGju.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RsGju.png\" alt=\"Example of Plotting using Large numbers\"></a></p>\n\n<p>So what we need here is to somehow calculate the SceneRect (i think) and find out the radius value + font size that we should use for both the Point and the Text so they stay the same size regardless of the Scene's Size.</p>\n\n<p><strong>EDIT :</strong> \nThis is the NEW code (according to vcloarec's solution) : </p>\n\n<p>GraphicsWindow.h (QGraphicsView Subclass) :</p>\n\n<pre><code>#ifndef GRAPHICSVIEW_H\n#define GRAPHICSVIEW_H\n\n#include &lt;QGraphicsView&gt;\n#include &lt;QGraphicsScene&gt;\n#include &lt;QGraphicsItem&gt;\n#include &lt;QDebug&gt;\n\nclass GraphicsView : public QGraphicsView\n{\n    Q_OBJECT\n\npublic:\n    explicit GraphicsView(QWidget *parent = 0);\n    void AddPoint(float x , float y , QString name = \"\");\n    void resize();\n\nprivate:\n    QGraphicsScene *p_Scene;\n    int p_SizeInView;\n};\n\n#endif // GRAPHICSVIEW_H\n</code></pre>\n\n<p>GraphicsWindow.cpp :</p>\n\n<pre><code>#include \"GraphicsView.h\"\n\nGraphicsView::GraphicsView(QWidget *parent) : QGraphicsView(parent)\n{\n    p_PointRadius = 0.0;\n    p_PointsLastN = 0;\n    p_SizeInView = 5;\n    p_Scene = new QGraphicsScene(this);\n\n    this-&gt;setScene(p_Scene);\n}\n\nvoid GraphicsView::AddPoint(float x, float y, QString name)\n{\n    y = y * -1;\n\n    QGraphicsItem *_Point = p_Scene-&gt;addEllipse(x , y , 1 , 1 , QPen(QColor(Qt::red)) , QBrush(QColor(Qt::red)));\n\n    this-&gt;fitInView(scene()-&gt;sceneRect() , Qt::KeepAspectRatio);\n    resize();\n}\n\nvoid GraphicsView::resize()\n{\n    qreal scale = p_SizeInView / this-&gt;transform().m11();\n\n    for(int i = 0; i &lt; this-&gt;scene()-&gt;items().count(); i++)\n    {\n        this-&gt;scene()-&gt;items().at(i)-&gt;setScale(scale);\n    }\n}\n</code></pre>\n\n<p>MainWindow.cpp :</p>\n\n<pre><code>#include \"mainwindow.h\"\n#include \"ui_mainwindow.h\"\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n\n    ui-&gt;toolBar-&gt;addWidget(ui-&gt;ZoomUp_Button);\n    ui-&gt;toolBar-&gt;addWidget(ui-&gt;ZoomDown_Button);\n\n    setCentralWidget(ui-&gt;graphicsView);\n\n    ui-&gt;graphicsView-&gt;AddPoint(0 , 0);\n    ui-&gt;graphicsView-&gt;AddPoint(1000 , 0);\n    ui-&gt;graphicsView-&gt;AddPoint(1000 , 50);\n    ui-&gt;graphicsView-&gt;AddPoint(0 , 50);\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n</code></pre>\n\n<p>This code scales the Points according to a fixed Scale but still results in Scrollbars which is something we have to solve.\nSomehow it ignores fitInView() , OR it does actually fit it but when the Points are resized it resizes the SceneRect or something</p>\n\n<p>Here is the result : </p>\n\n<p><a href=\"https://i.stack.imgur.com/vW0mm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vW0mm.png\" alt=\"enter image description here\"></a></p>\n\n<p>PS : We subclassed QGraphicsView because we will need MouseEvents and other things later.</p>\n\n<p><strong>EDIT : Solved by vcloarec</strong> :\nThe solution was to insert the Points at (-0.5 , -0.5) and than setPose(x , y) which will set the Position to the x , y we pass to the AddPoint(x , y).\nThe Points now keep the same size regardless of the Scene's size , and it will show all the Points created at once without any scrollbars or anything.</p>\n\n<p>Thank You !</p>\n"}, {"tags": ["python", "c++", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9865833, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Giovanni Paolinelli", "link": "https://stackoverflow.com/users/9865833/giovanni-paolinelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1527860858, "last_edit_date": 1527860858, "creation_date": 1527855898, "answer_id": 50643383, "question_id": 50610334, "link": "https://stackoverflow.com/questions/50610334/wrap-a-double-c-function-with-cython/50643383#50643383", "title": "Wrap a double** c++ function with cython", "body": "<p>I have found a solution for the case <code>double *</code>. First of all, the  file <code>fib.pxd</code> is useless. \nThen we need a new <code>fib.pyx</code> file: </p>\n\n<pre><code># distutils: language = c++\n# distutils: sources = fib.cpp\n\n\nimport numpy as np \ncimport numpy as cnp \n\n\n\ncdef extern from \"fib.hpp\":\n     double fib(int n)\n     double add (double a, double b)\n     double* mult(double a)\n\n\n\ndef make_mult(double a):\n    cdef double[:] mv = &lt;double[:4]&gt; mult(a) # the 4 stands for\n    return np.asarray(mv)   # the dimension of the array defined in fib.cpp \n</code></pre>\n\n<p>In the case of a function which returns a nrows*ncols matrix; such as <code>double* make_mat(int nrows, int ncols)</code> , the second line of the  function <code>make_mult</code> has to be rewritten as:</p>\n\n<pre><code>cdef double[:,:] mv=&lt;double[:nrows,:ncols]&gt; make_mat(nrows, ncols) \n</code></pre>\n\n<p>Regrettably, If I have a  function <code>double** make_mat(int nrows, int ncols)</code> which always returns a matrix, then the previous code rises the error :</p>\n\n<blockquote>\n  <p>Pointer base type does not match cython.array base type</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 9865833, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Giovanni Paolinelli", "link": "https://stackoverflow.com/users/9865833/giovanni-paolinelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527860858, "creation_date": 1527700922, "last_edit_date": 1527701428, "question_id": 50610334, "link": "https://stackoverflow.com/questions/50610334/wrap-a-double-c-function-with-cython", "title": "Wrap a double** c++ function with cython", "body": "<p>I have a C++ function which returns a pointer <code>double**</code> - a high dimensional  matrix in particular - and I'd like to wrap it to some python code using Cython. How should I act? </p>\n\n<p>Here an example  with a function with a <code>double*</code> pointer for sake of simplicity.</p>\n\n<p>My C++ <code>fib.cpp</code> code:</p>\n\n<pre><code>double add(double a, double b)\n{\n return a+b;\n}\n\ndouble p[]= {1,2,3,4}; \n\ndouble* mult(double a)    \n{\np[0]=p[0]*a;\np[1]=p[1]*a;\nreturn p; \n}\n</code></pre>\n\n<p>Then there is the <code>fib.hpp</code> file:</p>\n\n<pre><code>double add(double a,double b);\ndouble* mult(double a);\n</code></pre>\n\n<p>Then the pxd file <code>fib.pxd</code>:</p>\n\n<pre><code>cdef extern from \"fib.hpp\":\n     double add(double a,double b);\n     double* mult(double a);\n</code></pre>\n\n<p>In the end the pyx file</p>\n\n<pre><code># distutils: language = c++\n# distutils: sources = fib.cpp \n\ncimport fib \n\ndef add(a,b):\n    return fib.add(a,b)\ndef mult(a):           # dropping these lines\n    return fib.mult(a) # the code works without the double* function\n</code></pre>\n\n<p>Everything  is compiled with the rather standard <code>setup.py</code> :</p>\n\n<pre><code>from distutils.core import setup, Extension\nfrom Cython.Build import cythonize\n\next = Extension(\"fib2cpp\",\n            sources=[\"fib.pyx\", \"fib.cpp\"],\n            language=\"c++\")\n\nsetup(name=\"fib\",\next_modules=cythonize(ext))\n</code></pre>\n\n<p>When I compile the code:</p>\n\n<pre><code>setup.py build_ext -if\n</code></pre>\n\n<blockquote>\n  <p>Cannot convert '<code>double *</code>' to python object. </p>\n</blockquote>\n\n<p>When I try with a <code>double**</code> function I get the same error.\nWhat should I do?</p>\n"}, {"tags": ["c++", "c", "language-lawyer", "standards", "new-operator"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527701024, "post_id": 50610274, "comment_id": 88230465, "body": "I am going to guess <a href=\"https://twitter.com/shafikyaghmour/status/991384169895755776\" rel=\"nofollow noreferrer\">pointer provenance</a> a lot of the details are going to be in WG14 defect reports though :-("}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527701155, "post_id": 50610274, "comment_id": 88230536, "body": "@ShafikYaghmour the link to the tweet is broken :( Is there a link to that defect report somewhere?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527701214, "post_id": 50610274, "comment_id": 88230568, "body": "Fixed the link, sorry"}, {"owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1527701249, "post_id": 50610274, "comment_id": 88230593, "body": "I would expect <code>behavior is as if the size were some nonzero value</code> to imply non-null addresses returned are unique."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 5, "creation_date": 1527701703, "post_id": 50610274, "comment_id": 88230880, "body": "It goes way back into pre-standard history, and just seems like <a href=\"https://wg21.link/LWG9\" rel=\"nofollow noreferrer\">the way it has always been</a>."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1527701738, "post_id": 50610274, "comment_id": 88230903, "body": "@John I&#39;ve just added the relevant part of the C standard for that to the answer. The caveat is that the C standard does not require the non-null addresses to be unique; it requires the memory allocations to be disjoint."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1527702079, "post_id": 50610274, "comment_id": 88231076, "body": "@BoPersson thanks! That&#39;s maybe as close as I am going to get for a definitive answer. I still wonder why that was specifically prohibited by ARM 5.3.3. :/"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1527702540, "post_id": 50610274, "comment_id": 88231312, "body": "@BoPersson why isn&#39;t it an answer?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527702583, "post_id": 50610274, "comment_id": 88231333, "body": "But <a href=\"http://eel.is/c++draft/basic.stc.dynamic.allocation#footnote-36\" rel=\"nofollow noreferrer\">the footnote says it is to be compatible w/ malloc/calloc</a> so I think disjoint means unique or at leas that is the interpretation."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1527702678, "post_id": 50610274, "comment_id": 88231384, "body": "@SergeyA The defect report contains no rationale beyond &quot;ARM 5.3.3 forbid this&quot; (no reason mentioned). It&#39;s a really good hint, but I don&#39;t know if it alone can be considered an answer. It might maybe be the best answer there ever is though :/"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1527702798, "post_id": 50610274, "comment_id": 88231450, "body": "@ShafikYaghmour That&#39;s not what the C standard says though, and if the intent was to be compatible with C the C++ standard would have kept the semantics. The <a href=\"https://github.com/llvm-mirror/libcxx/blob/master/src/new.cpp#L71\" rel=\"nofollow noreferrer\">libc++</a>  and <a href=\"https://github.com/gcc-mirror/gcc/blob/da8dff89fa9398f04b107e388cb706517ced9505/libstdc%2B%2B-v3/libsupc%2B%2B/new_opa.cc#L95\" rel=\"nofollow noreferrer\">libstdc++</a> implementation of the two new operators mentioned transform zero into a 1byte sized allocation making them disjoint. That is, clang and gcc don&#39;t assume in practice that malloc behaves that way."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 1, "creation_date": 1527728784, "post_id": 50610274, "comment_id": 88240454, "body": "I&#39;d argue that the implementation-defined aspect of <code>malloc</code>/<code>calloc</code>/<code>realloc</code> is something of a defect.  It means that a <code>NULL</code> response can actually signal <i>success</i> if 0 bytes were requested, hence the check for success has to look something like <code>if ((size == 0) || (returnedPointer != NULL)) ...</code> and functions accepting that pointer as an argument may not realize that <code>NULL</code> may actually be &quot;valid.&quot;  I&#39;m not too surprised that C++98 chose to remove this issue, and of course it wasn&#39;t always the case that <code>operator new</code> threw an exception when allocation failed."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527729225, "post_id": 50610274, "comment_id": 88240552, "body": "&quot;It means that a NULL response can actually signal success if 0 bytes were requested&quot; But does it? It might also mean &quot;failed to allocate zero bytes&quot;. In any case, you can&#39;t dereference the returned pointer, and if one is checking for <code>size == 0</code>, why is one still calling <code>malloc(0)</code> then?"}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 1, "creation_date": 1527732256, "post_id": 50610274, "comment_id": 88241127, "body": "One could check for <code>size == 0</code> before calling <code>malloc</code>, of course.  The point is that that check must happen <i>somewhere</i>.  If we knew that successful <code>malloc</code> would always return a non-<code>NULL</code> pointer, then we could just check <code>if (returnedPointer != NULL)</code> after calling <code>malloc</code> -- a check that we&#39;d have to do in any case -- and never have to worry about the <code>size == 0</code> special case."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1527736777, "post_id": 50610274, "comment_id": 88242190, "body": "@JoshuaGreen I can imagine an implementation of <code>malloc</code> where it does something like <code>if(available(p) &gt;= size) return p;</code>, the check for <code>size == 0</code> need not be explicit"}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1527813932, "post_id": 50610274, "comment_id": 88279429, "body": "@PasserBy, what is <code>available</code> and where is <code>p</code> coming from? More concretely, I can imagine: a) Wanting <code>malloc</code> to return a new non-<code>NULL</code> pointer on 0-byte allocations. b) Being OK with <code>malloc</code> returning <code>NULL</code> on 0-byte allocations. If the library provides (a), then I can wrap it with a check to get (b).  If the library provides (b), then I can&#39;t construct (a) out of that.  One could -- and probably would -- argue that there&#39;s no reason to force that strengthened contract on programs that don&#39;t need it, but it does make life simpler in ways that can&#39;t really be simulated otherwise."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1527815815, "post_id": 50610274, "comment_id": 88279771, "body": "@PasserBy, I&#39;d be much happier with the current situation if I could determine the 0-size allocation behavior of <code>malloc</code> at compile-time by testing a predefined macro.  As it is, we have <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/MEM04-C.+Beware+of+zero-length+allocations\" rel=\"nofollow noreferrer\">this warning</a>."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528020973, "post_id": 50610274, "comment_id": 88340551, "body": "@JoshuaGreen that&#39;s because there has been enough research about zero-allocation vulnerabilities, mostly by microsoft security engineering center, that have shown how to exploit these in some cases."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528251638, "post_id": 50610274, "comment_id": 88431668, "body": "@gnzlbg, I agree with the warning, as this forces people to think about what they&#39;re doing.  I think specifying the behavior and/or allowing programmers to determine the behavior would help.  The claim &quot;In cases where the memory allocation functions return a non-null pointer, reading from or writing to the allocated memory area results in undefined behavior&quot; strikes me as trying to make this case seem worse than it is.  After all, reading from or writing outside of the allocated area is <i>always</i> undefined, so this statement is just a specific case that follows from the allocated area being 0."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528251963, "post_id": 50610274, "comment_id": 88431743, "body": "To continue that thought, the first &quot;Noncompliant Code Example&quot; is hardly fair.  For an &quot;arbitrary&quot; <code>size</code>, what sort of <code>&#47;* Continue processing list *&#47;</code> code would make sense, and what would it try to do in the <code>size == 0</code> case if the author weren&#39;t specifically thinking about it?"}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528252067, "post_id": 50610274, "comment_id": 88431766, "body": "(Hallvard Furuseth&#39;s comment at that page is along these lines.)"}], "answers": [{"comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1527710797, "post_id": 50612074, "comment_id": 88235180, "body": "But one could argue that they are the same object."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527723893, "post_id": 50612074, "comment_id": 88239324, "body": "The overloads of <code>operator new</code> mentioned in the question only return raw memory: they have nothing to do with objects AFAICT."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1527727733, "post_id": 50612074, "comment_id": 88240229, "body": "^That. Aliasing is a non-issue, memory returned by <code>operator new</code> is not an object. By the time an object is created, it may either be the only object there, or it destroyed a previous object by reusing its memory."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1527805967, "post_id": 50612074, "comment_id": 88277589, "body": "IMHO, rather than requiring that objects have a unique identity, the Standard should instead have said that an object of size N occupies N+1 addresses, the first N of which each identify a different byte owned by the object and the last N of which each immediately follow those same bytes in the same order.  Requiring that compilers pretend that empty objects take up a byte adds complexity to the language without serving a useful purpose.  Any code that wants to ensure an object&#39;s address will be unique could simply make sure its size isn&#39;t zero."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1527818894, "post_id": 50612074, "comment_id": 88280407, "body": "When are zero sized objects not subobjects of classes of size at least one?"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527934168, "post_id": 50612074, "comment_id": 88321541, "body": "@Emilio Is <code>void* operator new(size_t)</code> a <code>new-expression</code> (cppreference only says that&#39;s a function called by some of them)? What&#39;s the type of the created region of storage?"}, {"owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "reply_to_user": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527962366, "post_id": 50612074, "comment_id": 88329356, "body": "@gnzlbg A new expression is <code>new A</code> returning <code>A*</code>. It results in a call to to operator new (sizeof(A)) and a subsequent call to the A constructor.  if you call <code>new A</code> twice, you need two distinct A*, hence <code>opeator new</code> must return two distinct <code>void*</code>. Even if the size is 0."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528020636, "post_id": 50612074, "comment_id": 88340466, "body": "@EmilioGaravaglia The thing is I am not asking about <code>new-expression</code>s in my question, but about the explicit <code>operator new</code> function calls that allocate raw memory and are used like this:   <code>void* ptr = operator new(size);</code>. AFAICT that&#39;s just a normal function call and not a <code>new-expression</code> (no types involved). If these are <code>new-expression</code>s it would be nice to add a source to your answer, because otherwise nothing in it applies to the question."}, {"owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "reply_to_user": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 1, "creation_date": 1528037829, "post_id": 50612074, "comment_id": 88345207, "body": "@gnzlbg: the point is that <code>operator new</code> must return memory that is suitable for object construction. So it must never be twice the same address (without an <code>operator delete</code>)"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528122506, "post_id": 50612074, "comment_id": 88375417, "body": "That argument makes sense. I think the unique address argument does not apply everywhere now that <code>[[no_unique_address]]</code> has been merged into the <code>std</code> (two zero-sized objects can share the same address). However, this attribute cannot be used in any places where operator new could actually return the same address for two zero-sized objects, so it does not apply here."}], "tags": [], "owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "is_accepted": true, "score": 8, "last_activity_date": 1527839811, "last_edit_date": 1527839811, "creation_date": 1527708203, "answer_id": 50612074, "question_id": 50610274, "link": "https://stackoverflow.com/questions/50610274/what-is-the-rationale-behind-returning-unique-addresses-for-allocations-of-zero/50612074#50612074", "title": "What is the rationale behind returning unique addresses for allocations of zero size in C++?", "body": "<p>The problem is that <strong>objects</strong> (no matter their size) in C++ <strong>must have a unique identity</strong>. So different coexisting objects (no matter their size) must have different address, since <strong>two pointer that compare as equal are assumed to point to a same object</strong>.</p>\n\n<p>If you admit that zero-sized objects can have same address you cannot anymore distinguish if two address are or not a same object.</p>\n\n<hr>\n\n<p>Many comments about the \"new does not return objects\" issue.</p>\n\n<p>Please FORGET OOP terminology in this context:</p>\n\n<p>C++ specification have a precise definition of what the word \"Object\" means.</p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/language/object\" rel=\"noreferrer\">CPP Reference:Object</a></p>\n\n<p>In particular:</p>\n\n<blockquote>\n  <p>C++ programs create, destroy, refer to, access, and manipulate objects.\n  An object, in C++, is a region of storage that has</p>\n  \n  <ul>\n  <li>size (can be determined with sizeof);</li>\n  <li>alignment requirement (can be determined with alignof);</li>\n  <li>storage duration (automatic, static, dynamic, thread-local);</li>\n  <li>lifetime (bounded by storage duration or temporary);</li>\n  <li>type;</li>\n  <li>value (which may be indeterminate, e.g. for default-initialized non-class types);</li>\n  <li>optionally, a name. </li>\n  </ul>\n  \n  <p>The following entities are not objects: value, reference, function,\n  enumerator, type, non-static class member, bit-field, template, class or\n  function template specialization, namespace, parameter pack, and this.</p>\n  \n  <p>A variable is an object or a reference that is not a non-static data member,\n  that is introduced by a declaration.</p>\n  \n  <p>Objects are created by definitions, new-expressions, throw-expressions, when\n  changing the active member of a union, and where temporary objects are\n  required. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528294334, "post_id": 50712543, "comment_id": 88453503, "body": "Thanks for the link, will check it out :)"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528294548, "post_id": 50712543, "comment_id": 88453644, "body": "Note that in C++20 you can&#39;t use two pointers to see if they are the same object, because zero-sized data members are allowed to share their address with other objects (<code>[[no_unique_address]]</code>), so that will only work sometimes, at best."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1539018462, "post_id": 50712543, "comment_id": 92340333, "body": "If a programmer doesn&#39;t care whether the address of a zero-sized object compares equal to anything or not, then user-code handling of boundary conditions could be minimized by guaranteeing that if <code>p</code> and <code>q</code> is a valid pointer or the return of <code>malloc(0)</code>, then <code>p+0</code> and <code>p-0</code> will be equivalent to <code>p</code>, <code>p-p</code> will be equivalent to 0, <code>p&gt;p</code>, <code>p&lt;p</code>, and <code>p!=p</code> will all yield zero, <code>p&gt;=p</code>, <code>p==p,</code> and <code>p&lt;=p</code> will all yield 1, <code>memcpy(p,q,0) and </code>memmove(p,q,0)` will yield <code>p</code>, <code>p==q</code> and <code>p!=q</code> will yield 0 or 1, etc. all without side-effects.  IMHO, malloc(0) should be allowed to..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1539018574, "post_id": 50712543, "comment_id": 92340385, "body": "...return a null pointer only on those systems which would uphold all of the above guarantees <i>anyway</i>.  Outside a few cases where one wants to generate a unique token (which could be better served with a proper &quot;unique token&quot; type) I&#39;m not sure why code should care about whether a pointer to a &quot;zero-sized object&quot; compares equal or unequal to anything else."}], "tags": [], "owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "is_accepted": false, "score": 1, "last_activity_date": 1528261215, "creation_date": 1528261215, "answer_id": 50712543, "question_id": 50610274, "link": "https://stackoverflow.com/questions/50610274/what-is-the-rationale-behind-returning-unique-addresses-for-allocations-of-zero/50712543#50712543", "title": "What is the rationale behind returning unique addresses for allocations of zero size in C++?", "body": "<p>The reason is simply that code should not require special handling of boundary conditions. Many, I would say most, algorithms have to deal with zero-sized objects as boundary conditions. Less common is the algorithm that compare pointers to objects to see if they are the same object, but this still should work even for zero-sized objects.</p>\n\n<p>However, your question assumes that this is a change. Apart from a brief hiatus in the late 1980's all C and C++ implementations that I am aware of have always behaved like this.</p>\n\n<p>The original C compiler by dmr behaved like this but then around 1987 the draft C standard specified that malloc of a zero sized object return NULL. This was truly bizarre and even the final C-89 standard made it implementation-defined but I have never since encountered an implementation that did this horrible thing.</p>\n\n<p>I talk more about this in <a href=\"http://devmethodologies.blogspot.com/2011/11/zero.html\" rel=\"nofollow noreferrer\">my blog</a> in the section \"Malloc Madness\".</p>\n"}], "owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 2, "accepted_answer_id": 50612074, "answer_count": 2, "score": 12, "last_activity_date": 1528261215, "creation_date": 1527700675, "last_edit_date": 1528122765, "question_id": 50610274, "link": "https://stackoverflow.com/questions/50610274/what-is-the-rationale-behind-returning-unique-addresses-for-allocations-of-zero", "title": "What is the rationale behind returning unique addresses for allocations of zero size in C++?", "body": "<p>What is the rationale behind returning unique addresses for allocations of zero size in C++?</p>\n\n<p>Background: the C11 standard says about malloc (7.20.3 Memory management functions):</p>\n\n<blockquote>\n  <p>If the size of the space requested is zero, the behavior is implementation defined: either a null pointer is returned, or the behavior is as if the size were some nonzero value, except that the returned pointer shall not be used to access an object.</p>\n</blockquote>\n\n<p>That is, as I see it, <code>malloc</code> always succeeds for allocations of zero size since the only you can do with the pointer of a zero-sized allocation is call some other memory allocation function like <code>free</code> with it:</p>\n\n<ul>\n<li>if <code>malloc</code> returns <code>NULL</code>, <code>free(NULL)</code> is ok so this can be considered a success,</li>\n<li>if it returns some other value, that's also a success (because it isn't <code>NULL</code>), the only condition is that <code>free</code> on the value should also work.</li>\n</ul>\n\n<p>Also, C11 (also 7.20.3) does not specify that the address returned from malloc must be unique, only that they must point to disjoint memory regions:</p>\n\n<blockquote>\n  <p>The pointer returned if the allocation succeeds is suitably aligned so that it may be assigned to a pointer to any type of object and then used to access such an object or an array of such objects in the space allocated (until the space is explicitly deallocated). The lifetime of an allocated object extends\n  from the allocation until the deallocation. Each such allocation shall yield a pointer to an object disjoint from any other object.</p>\n</blockquote>\n\n<p>All objects of zero size are disjoint AFAICT, and that would mean that <code>malloc</code> can return the same pointer for multiple zero-sized allocations (e.g. <code>NULL</code> would be fine), or different pointers each time, or the same pointer for some, etc.</p>\n\n<p>Then C++98 came along with two raw memory allocation functions: </p>\n\n<pre><code>void* operator new(std::size_t size);\nvoid* operator new(std::size_t size, std::align_val_t alignment);\n</code></pre>\n\n<p>Note that these functions only return raw memory: they do not create or initialize any objects of any type AFAICT.</p>\n\n<p>You call them like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;new&gt;\nint main() {\n    void* ptr = operator new(std::size_t{0});\n    std::cout &lt;&lt; ptr &lt;&lt; std::endl;\n    operator delete(ptr, std::size_t{0});\n    return 0;\n}\n</code></pre>\n\n<p>The <code>[new.delete.single]</code> section of the C++17 standard explains them, but the key guarantee as I see it is given in <code>[basic.stc.dynamic.allocation]</code>:</p>\n\n<blockquote>\n  <p>Even if the size of the space requested is zero, the request can fail. If the request succeeds, the value returned shall be a non-null pointer value (7.11) p0 different from any previously returned value p1, unless that value p1 was subsequently passed to an operator delete. Furthermore, for the library allocation functions in 21.6.2.1 and 21.6.2.2, p0 shall represent the address of a block of storage disjoint from the storage for any other object accessible to the caller. The effect of indirecting through a pointer returned as a request for zero size is undefined.38</p>\n</blockquote>\n\n<p>That is, they must always return distinct pointers on success. That's a bit change from <code>malloc</code>.</p>\n\n<p>My question is: <strong>What is the rationale behind this change?</strong> (that is, behind returning unique addresses for allocations of zero size in C++)</p>\n\n<p>Ideally the answer would be just a link to the paper (or some other source) that explored the alternatives and motivated their semantics. Typically I go for The Design and Evolution of C++ for these C++98 questions, but Section 10 (Memory Management) does not mention anything about it. Otherwise, some sort of authoritative reference would be nice.</p>\n\n<hr>\n\n<p>Disclaimer: I <a href=\"https://www.reddit.com/r/cpp/comments/8n79wj/were_zerosized_memory_allocations_a_good_idea_in/\" rel=\"noreferrer\">asked it on reddit</a> but I did not ask nicely enough so I did not got any useful answer. I would like to kindly ask you that if you only have an hypothesis, please feel free to post it as an answer but mention that it is only an hypothesis. </p>\n\n<p>Also, on reddit people went on and on about zero-sized types, whether I have a proposal to change the standard, etc. This question is about the semantics of the raw memory allocation functions when passed a size equal to zero. If topics like zero-sized types are relevant for your answer, please include them! But try not to get too derailed with tangential issues.</p>\n\n<p>Also, on reddit people also threw arguments like \"that's for optimization purposes\" without really being able to mention anything more concrete. I'd expect something more concrete than \"because optimizations\" in an answer. For example, one redditor mentioned aliasing optimizations, but I wondered which kind of aliasing optimizations apply to pointers that cannot be dereferenced, and wasn't able to get anyone to comment on that. So maybe if you are going to mention optimizations, a small example that shows it would enrich the discussion.</p>\n"}, {"tags": ["c++", "boost", "formatting", "format"], "comments": [{"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1527700381, "post_id": 50610144, "comment_id": 88230108, "body": "this is float.."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1527700465, "post_id": 50610144, "comment_id": 88230157, "body": "C and C++ take entirely different approaches here. Which one are you looking to use? Is this a C++ question or a C one?"}, {"owner": {"reputation": 155, "user_id": 5591035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22c3ac643413b02476b10ce7be511bc8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5591035/john"}, "edited": false, "score": 0, "creation_date": 1527704794, "post_id": 50610144, "comment_id": 88232422, "body": "I need a solution for my problem, I am working with c++ , but have thought that may be the solution is C specific."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527705706, "post_id": 50610144, "comment_id": 88232832, "body": "BTW, always search the internet or StackOverflow before posting."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527705759, "post_id": 50610144, "comment_id": 88232859, "body": "Looks like you are programming in C++ because the C language doesn&#39;t have the <code>std::string</code> data type.  Please update your tags accordingly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527707838, "post_id": 50610144, "comment_id": 88233864, "body": "How many different <code>float</code> are representable in a 32-bit variable? (about 2^32 or about 4,000,000,000)  Is <code>40.432</code> one of those 4,000,000,000? (No) What is the closest <code>float</code> to <code>40.432</code> (40.43199920654296875)  How does that print with <code>&quot;%f&quot;</code> with its default of 6 digits after the <code>.</code>? (&quot;40.431999&quot;)  What is the next closest <code>float</code>? (40.432003021240234375)"}], "owner": {"reputation": 155, "user_id": 5591035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22c3ac643413b02476b10ce7be511bc8?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5591035/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1527700316, "answer_count": 0, "score": 0, "last_activity_date": 1527752981, "creation_date": 1527700168, "last_edit_date": 1527752981, "question_id": 50610144, "link": "https://stackoverflow.com/questions/50610144/loss-of-float-number-while-formatting", "closed_reason": "Duplicate", "title": "Loss of float number while formatting", "body": "<p>While formatting a float number, I get an unexpected result.<br>\nFor example writing any of this </p>\n\n<pre><code>float argument = 40.432;\nchar buff[100];\nsnprintf(buff, sizeof(buff), \"%f\", argument);\nstd::string result = buff;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>std::string result = boost::str(boost::format(\"%\"  + \"f\")%argument);\n</code></pre>\n\n<p>the value of result is 40.431999, while if I set the value of argument 40.111 instead of 40.432 , the result will be 40.111000, as it is accepted.\nAnd if I set the value of argument 40.4, the result will be 40.400002.</p>\n\n<p>Now I understand why it is so, and my question is  how can I get 40.432000 as a result?</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1527700121, "post_id": 50610080, "comment_id": 88229948, "body": "First, you need to initialize <code>alphabet</code> array to all zeros. Next, you need to look at the char code of the letter and calculate the index into the array based on that."}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1527700178, "post_id": 50610080, "comment_id": 88229988, "body": "So.. What exactly is your question? Does your code not produce correct output? If so, how does it differ from the expected one? Did you try stepping through your code with a debugger?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527700371, "post_id": 50610080, "comment_id": 88230107, "body": "Don&#39;t use C-style arrays in C++. Do use <a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\"><code>std::vector</code></a>. These can be initialized with a default value where C arrays won&#39;t be."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1527700845, "post_id": 50610080, "comment_id": 88230367, "body": "Related: <a href=\"https://stackoverflow.com/a/17628697/509868\">count all letters, not only the first letter</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3752, "user_id": 95076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5191e940e594c80451cef370c8c3f16?s=128&d=identicon&r=PG", "display_name": "Robert Horvick", "link": "https://stackoverflow.com/users/95076/robert-horvick"}, "is_accepted": true, "score": 8, "last_activity_date": 1527700264, "creation_date": 1527700264, "answer_id": 50610172, "question_id": 50610080, "link": "https://stackoverflow.com/questions/50610080/number-of-words-in-c/50610172#50610172", "title": "Number of words in C++", "body": "<p>Break the problem up into smaller problems.</p>\n\n<ol>\n<li>Write a program that takes a text file and prints its contents</li>\n<li>Modify the program to splits the words by colon and prints each word on it's own line</li>\n<li>Modify the program to print only the first character of each word</li>\n<li>Modify the program to count the number of instances of each letter (keep printing the letter) - print out the counts when done</li>\n<li>Modify the program to not print out the letters</li>\n</ol>\n\n<p>Now you're done.</p>\n\n<p>At every point along the way you are making a single change to the logic which means you can isolate both your thought process and debug mistakes much more easily.</p>\n"}, {"comments": [{"owner": {"reputation": 15289, "user_id": 583833, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/791a00235c66b6c32effd4291101087f?s=128&d=identicon&r=PG", "display_name": "Borgleader", "link": "https://stackoverflow.com/users/583833/borgleader"}, "edited": false, "score": 1, "creation_date": 1527701135, "post_id": 50610228, "comment_id": 88230524, "body": "<code>&#47;&#47;65 is the ascii code for A</code> the fact that you added a comment should have been a hint that using a magic constant was a bad idea. As Barmar said, use <code>&#39;A&#39;</code> (P.S: <a href=\"https://stackoverflow.com/q/29381067/583833\">it&#39;s not guaranteed to be ASCII</a> so that code isnt even portable)"}], "tags": [], "owner": {"reputation": 1567, "user_id": 8870224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BomtF.jpg?s=128&g=1", "display_name": "samuelnj", "link": "https://stackoverflow.com/users/8870224/samuelnj"}, "is_accepted": false, "score": 1, "last_activity_date": 1527702534, "last_edit_date": 1527702534, "creation_date": 1527700494, "answer_id": 50610228, "question_id": 50610080, "link": "https://stackoverflow.com/questions/50610080/number-of-words-in-c/50610228#50610228", "title": "Number of words in C++", "body": "<p>You want to store the characters in the array by looking at the character byte code. First, set alphabet to an array of all 0's. Then count the first letter of each word with the index representing the letter.</p>\n\n<pre><code>char first_letter = toupper(word[0]);\nalphabet[first_letter - 'A']++; \n</code></pre>\n\n<p>Then, at the end, print out:</p>\n\n<pre><code>for(int i = 0; i &lt; 26; ++i) {\n    printf(\"%c %d\\n\", i + 'A', alphabet[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9295772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2748cd9e8c41f64fa2394e43432b31?s=128&d=identicon&r=PG&f=1", "display_name": "Uchida", "link": "https://stackoverflow.com/users/9295772/uchida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 50610172, "answer_count": 2, "score": 0, "last_activity_date": 1528216465, "creation_date": 1527699918, "last_edit_date": 1528216465, "question_id": 50610080, "link": "https://stackoverflow.com/questions/50610080/number-of-words-in-c", "title": "Number of words in C++", "body": "<p>I was asked to do a program for an assignment which sounds something like this:</p>\n\n<blockquote>\n  <p>Create a program to which you pass a text file with any number of words separated by a colon. The program will create a new file where the letters of the alphabet will be written (from A to Z), each on a new line, followed by a number of words from the input file that begins with the respective letter of the alphabet.</p>\n</blockquote>\n\n<p>At first, it appeared to be quite easy to me. I was able to read the file, find the first letter in all the words and get them to appear in the console.</p>\n\n<p>Here is the point that I am stuck on. I have no clue how to proceed. I am aware that I should use an array, which I could later use to get the required numbers, but I am not for the love of god able to make it work.</p>\n\n<p>Here is what I came up with so far:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;cctype&gt;\n#include &lt;stdio.h&gt;\n\n\nusing namespace std;\n\nint main() {\nifstream fin(\"test.txt\");\nchar ch;\nstring word;\nint alphabet [26];\n\nwhile (fin.get(ch))\n{\n    if (isspace(ch))  \n    {\n        continue;\n    }\n    else if (ch == ':') // found the end of a word\n    {\n        char first_letter = toupper(word[0]);\n        cout &lt;&lt; first_letter &lt;&lt; '\\n';\n        word.clear(); \n    }\n    else  \n    {\n        word += ch;\n    }\n}\n\nif (word.size() &gt; 0)\n{\n    char first_letter = toupper(word[0]);\n    cout &lt;&lt; first_letter &lt;&lt; '\\n';\n}\n}\n</code></pre>\n\n<p>Just to clarify. The input should look something like this - <strong>video:Elizabeth:Martin:service:work:place:British:file:stream:movie:song:quake:love:hate:York</strong> etc</p>\n\n<p>And the output should look like this - </p>\n\n<pre><code>A 0\nB 1\nC 0\nD 0\nE 1\nF 1\nG 0\nH 1\nI 0\nJ 0\nK 0\nL 1\nM 2\nN 0\nO 0\nP 1\nQ 1\nR 0\nS 3\nT 0\nU 0\nV 1\nW 1\nX 0\nY 1\nZ 0\n</code></pre>\n"}, {"tags": ["c++", "windows"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528105304, "post_id": 50609996, "comment_id": 88364646, "body": "This doesn&#39;t sound like anything more than broken error checking.  If LoadLibrary() returns a non-NULL handle then you must <i>not</i> call GetLastError().  If you do anyway then you&#39;ll get a random number, it is only 0 by accident."}, {"owner": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528133592, "post_id": 50609996, "comment_id": 88381473, "body": "Maybe you&#39;re right and it&#39;s zero by accident, however the handle it returns for sure is the handle to my own name.dll and this does not seem random at all"}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "edited": false, "score": 0, "creation_date": 1527754820, "post_id": 50610399, "comment_id": 88249214, "body": "Thank&#39;s for pointing that out.  There is no redirection file, however there is a folder application.exe.local inside which my name.dll is located. I created this folder and deleted the application.manifest file so that application.exe is tricked into taking my dll instead of the real Windows/System32/name.dll.  (Simply storing my name.dll in the application directory does not work (application.exe uses the System32/name.dll, probably because it&#39;s loaded with an absolute path in the app from what you&#39;ve told me)).  Any idea how I could get around this issue ?"}, {"owner": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "edited": false, "score": 0, "creation_date": 1527755319, "post_id": 50610399, "comment_id": 88249479, "body": "Quick clarification : if I create a redirection file application.exe.local, store my name.dll and this redirection file alongside application.exe, the app still does not load my dll. Only the application.exe.local/name.dll folder thing seems to work."}, {"owner": {"reputation": 3960, "user_id": 654614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc0d43eb99234ed9702badb191b7d96?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Boyne", "link": "https://stackoverflow.com/users/654614/frank-boyne"}, "reply_to_user": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "edited": false, "score": 0, "creation_date": 1527756967, "post_id": 50610399, "comment_id": 88250422, "body": "An application manifest introduces (or removes?) another wrinkle.  The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682600(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Dynamic Link Library Redirection</a> article says <b>If the application has a manifest, then any .local files are ignored.</b>.  But my brain isn&#39;t working at the moment, I&#39;ll have to think about this tomorrow. :-)"}, {"owner": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "edited": false, "score": 0, "creation_date": 1527841994, "post_id": 50610399, "comment_id": 88288474, "body": "I&#39;ve edited my question with what I&#39;ve checked so far, thanks for your help :)"}, {"owner": {"reputation": 3960, "user_id": 654614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc0d43eb99234ed9702badb191b7d96?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Boyne", "link": "https://stackoverflow.com/users/654614/frank-boyne"}, "reply_to_user": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "edited": false, "score": 0, "creation_date": 1528090282, "post_id": 50610399, "comment_id": 88357369, "body": "You have two programs - let&#39;s call them <code>fine.exe</code> and <code>own.exe</code>.  The <code>fine.exe</code> program loads your own <code>name.dll</code> and then loads the other <code>name.dll</code> from <code>System32</code>.  The <code>own.exe</code> program loads your own <code>name.dll</code> but when it calls <code>LoadLibrary</code> you get back another handle to your own <code>name.dll</code> instead of a handle to the one from <code>System32</code>.  Please could you edit your question to show whether each of these programs has a manifest - embedded or external - and where your own <code>name.dll</code> is located for each program?"}], "tags": [], "owner": {"reputation": 3960, "user_id": 654614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc0d43eb99234ed9702badb191b7d96?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Boyne", "link": "https://stackoverflow.com/users/654614/frank-boyne"}, "is_accepted": false, "score": 2, "last_activity_date": 1528139542, "last_edit_date": 1528139542, "creation_date": 1527701131, "answer_id": 50610399, "question_id": 50609996, "link": "https://stackoverflow.com/questions/50609996/loadlibray-filenotfound-depending-on-which-application-calls/50610399#50610399", "title": "LoadLibray FileNotFound depending on which application calls", "body": "<p>Is it possible your problem program is using DLL Redirection?  </p>\n\n<p>From the LoadLibrary documentation (emphasis added) ...</p>\n\n<blockquote>\n  <p>If a path is specified and there is a redirection file for the application, the function searches for the module in the application's directory. <strong>If the module exists in the application's directory, LoadLibrary ignores the specified path and loads the module from the application's directory</strong>. If the module does not exist in the application's directory, LoadLibrary loads the module from the specified directory. For more information, see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682600(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Dynamic Link Library Redirection</a>.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Update 6/4/2018</strong></p>\n\n<p>Here's what I think is happening.</p>\n\n<p>Both of your programs are using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684184?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">load-time dynamic linking</a> (sometimes called <a href=\"https://docs.microsoft.com/en-us/cpp/build/linking-an-executable-to-a-dll#determining-which-linking-method-to-use\" rel=\"nofollow noreferrer\">implicit linking</a>) to link to a DLL called <code>name.dll</code>.  I'm assuming both programs just specify <code>name.dll</code> without a full path name.  If you want to check I think you can run <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/imports-dumpbin\" rel=\"nofollow noreferrer\"><code>dumpbin /imports</code></a> against <code>fine.exe</code> and <code>own.exe</code> to examine the DLL name.</p>\n\n<h2>fine.exe</h2>\n\n<p>In the case of the program that does what you expect (loads the second <code>name.dll</code> from \\Windows\\System32) there's no DLL redirection involved so the <a href=\"https://msdn.microsoft.com/library/windows/desktop/ms682586.aspx\" rel=\"nofollow noreferrer\">standard DLL Search Order</a> is followed during the implicit link.  The application directory is searched before the system directory so your copy of <code>name.dll</code> gets loaded.  </p>\n\n<p>Then your <code>name.dll</code> executes a <code>LoadLibrary</code> call specifying a full path to the file <code>C:\\Windows\\System32\\name.dll</code>.  Since there's no redirection going on, the system directory version of <code>name.dll</code> gets loaded as you expect.</p>\n\n<h2>own.exe</h2>\n\n<p>In the case of the program that doesn't do what you expect (gets a handle to your own version of <code>name.dll</code> twice) there is DLL redirection going on because you have a directory called <code>own.exe.local</code> in the application folder.  Since there's redirection going on, during the implicit link the standard search order is ignored and <code>name.dll</code> is loaded from <code>own.exe.local</code>.</p>\n\n<p>Then your <code>name.dll</code> executes a <code>loadlibrary</code> call specifying a full path to the file <code>C:\\Windows\\System32\\name.dll</code>.  <strong>But</strong> this time there is redirection going on.  The full path specified in the <code>LoadLibrary</code> call is ignored and the module is loaded from the redirection folder <code>own.exe.local</code>.  </p>\n\n<p>Since that copy of <code>name.dll</code> has already been loaded by the implicit linking you just get another handle to the module. </p>\n\n<p>As was pointed out in the comments, the <code>GetLastError</code> result is misleading.  The <code>LoadLibrary</code> call didn't return NULL (it returned a handle to your own <code>name.dll</code>) so the value returned by <code>GetLastError</code> doesn't apply to the <code>LoadLibrary</code> call.</p>\n"}], "owner": {"reputation": 70, "user_id": 6560758, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f160444c581fc9d047a7ecf7450bc3c3?s=128&d=identicon&r=PG&f=1", "display_name": "Lauriane.C", "link": "https://stackoverflow.com/users/6560758/lauriane-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528139542, "creation_date": 1527699653, "last_edit_date": 1528101669, "question_id": 50609996, "link": "https://stackoverflow.com/questions/50609996/loadlibray-filenotfound-depending-on-which-application-calls", "title": "LoadLibray FileNotFound depending on which application calls", "body": "<p>I'm trying to impletement a C++ dll named (let's say) name.dll, which loads another dll (not mine) that is also named name.dll. </p>\n\n<p>In my name.dll implementation I'm loading the real name.dll using this line : </p>\n\n<pre><code>            driver_library = LoadLibrary(_T(\"c:\\\\windows\\\\system32\\\\name.dll\"));\n</code></pre>\n\n<p>My dll is in a program.exe.local folder so that the program load mine before the real one in System32. </p>\n\n<p>Depending on which program.exe uses my dll, LoadLibrary <strong>either works fine or returns my own name.dll handle</strong> as driver_library, with GetLastError() returning \"file not found\". </p>\n\n<p>In <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms684175(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms684175(v=vs.85).aspx</a> it is explicit stated that \"If the string specifies a full path, the function searches only that path for the module.\" Why and how does it load itself for some applications ?</p>\n\n<p>What in the program.exe application could affect LoadLibrary's behavior ? </p>\n\n<p>@Franck Boyne commented : \n\"You have two programs - let's call them fine.exe and own.exe. The fine.exe program loads your own name.dll and then loads the other name.dll from System32. The own.exe program loads your own name.dll but when it calls LoadLibrary you get back another handle to your own name.dll instead of a handle to the one from System32.\"</p>\n\n<p>About own.exe (which is not at all my \"own\" application) : \n-> name.dll is located in an own.exe.local folder I created, which is located in own.exe directory. </p>\n\n<p>-> own.exe had an application.manifest file that I deleted (the application still launches correctled without it if not using my dll). own.exe does not have an embedded manifest (checked using sigcheck).</p>\n\n<p>-> name.dll is not one of Windows \"known dlls\" from HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs</p>\n\n<p>-> own.exe does not load name.dll using LoadLibrary() (checked by setting a breakpoint into LoadLibrary/A/W/Ex functions)</p>\n\n<p>-> own.exe and name.dll are both 64 bits. </p>\n\n<p>About fine.exe (it's a sample, I have access to the code): </p>\n\n<p>-> name.dll is located in the fine.exe application directory. </p>\n\n<p>-> No manifest file (either embedded or text). </p>\n"}, {"tags": ["c++", "qt"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 9871569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9dd15a44634e36fe6d7c60316578ecf?s=128&d=identicon&r=PG&f=1", "display_name": "dkneeland", "link": "https://stackoverflow.com/users/9871569/dkneeland"}, "is_accepted": true, "score": 0, "last_activity_date": 1527699908, "creation_date": 1527699908, "answer_id": 50610076, "question_id": 50609922, "link": "https://stackoverflow.com/questions/50609922/qtrcc-parse-error-while-executing-step-make/50610076#50610076", "title": "qt:RCC parse error while executing step &quot;Make&quot;", "body": "<p>I don't know much about Qt but that looks like xml and so shouldn't the slash go before the closing tag name. Like this:</p>\n\n<pre><code>&lt;RCC&gt;\n...\n&lt;/RCC&gt;\n</code></pre>\n\n<p>Sorry if that's not the solution. Just the first thing I noticed.</p>\n"}], "owner": {"reputation": 15, "user_id": 9651575, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u53f2\u52aa\u6bd4", "link": "https://stackoverflow.com/users/9651575/%e5%8f%b2%e5%8a%aa%e6%af%94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 50610076, "answer_count": 1, "score": 0, "last_activity_date": 1527699908, "creation_date": 1527699312, "question_id": 50609922, "link": "https://stackoverflow.com/questions/50609922/qtrcc-parse-error-while-executing-step-make", "title": "qt:RCC parse error while executing step &quot;Make&quot;", "body": "<p>What I want to do now is simply show my .qrc picture to my scene, but something keep going wrong with my program. I've checked my path and it should be fine.\nthanks in advance for the great help!</p>\n\n<p>my picture is placed in a folder called \"img\" under my project.(img folder was newed by right clicking main.cpp and choose \"show containing folder\")</p>\n\n<p>it shows <strong>[qrc_myresources.cpp] Error 1</strong> as i run it, which quite confuse me. I've searched for stack overflow but didn't find the solution.</p>\n\n<p>compile output:</p>\n\n<blockquote>\n  <p>00:30:13: Running steps for project shoot...\n      00:30:13: Configuration unchanged, skipping qmake step.\n      00:30:13: Starting: \"/usr/bin/make\" \n      /home/pd2vm/Qt5.9.2/5.9.2/gcc_64/bin/rcc -name myresources ../shoot/myresources.qrc -o qrc_myresources.cpp\n      RCC Parse Error: '../shoot/myresources.qrc' Line: 10 Column: 6 [expected  tag]\n      Makefile:597: recipe for target 'qrc_myresources.cpp' failed\n      make: *** [qrc_myresources.cpp] Error 1\n      00:30:13: The process \"/usr/bin/make\" exited with code 2.\n      Error while building/deploying project shoot (kit: Desktop Qt 5.9.2 GCC 64bit)\n      When executing step \"Make\"\n      00:30:13: Elapsed time: 00:00.</p>\n</blockquote>\n\n<p>mainwindow.h</p>\n\n<pre><code>#ifndef MAINWINDOW_H\n#define MAINWINDOW_H\n\n#include &lt;QMainWindow&gt;\n#include &lt;QGraphicsScene&gt;\n#include &lt;QGraphicsPixmapItem&gt;\n#include &lt;QTimer&gt;\n#include &lt;QKeyEvent&gt;\n\nnamespace Ui {\nclass MainWindow;\n}\n\nclass MainWindow : public QMainWindow\n{\n    Q_OBJECT\n\npublic:\n    explicit MainWindow(QWidget *parent = 0);\n    ~MainWindow();\n\npublic slots:\nvirtual void keyPressEvent(QKeyEvent *e);\n\nprivate:\n    Ui::MainWindow *ui;\n    QGraphicsScene *scene;\n\n    QGraphicsPixmapItem *player;\n    QTimer *timer;\n\n\n};\n\n#endif // MAINWINDOW_H\n</code></pre>\n\n<p>mainwindow.cpp</p>\n\n<pre><code>#include \"mainwindow.h\"\n#include \"ui_mainwindow.h\"\n\nMainWindow::MainWindow(QWidget *parent) :\n    QMainWindow(parent),\n    ui(new Ui::MainWindow),\n    timer(new QTimer)\n\n{\n    QGraphicsScene * scene = new QGraphicsScene(0,0,1200,880);\n    ui-&gt;setupUi(this);\n    ui-&gt;graphicsView-&gt;setScene(scene);\n\n    //player\n    player = new QGraphicsPixmapItem(QPixmap(\":/img/whitedog.png\"));\n    scene-&gt;addItem(player);\n    player-&gt;setPos(600, 880);\n    timer-&gt;start(10);\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include \"mainwindow.h\"\n#include &lt;QApplication&gt;\n\nint main(int argc, char *argv[])\n{\n    QApplication a(argc, argv);\n    MainWindow w;\n    w.show();\n\n    return a.exec();\n}\n</code></pre>\n\n<p>myresources.qrc</p>\n\n<pre><code>&lt;RCC&gt;\n&lt;qresource prefix=\"/\"&gt;\n        &lt;file&gt;img/whitedog.png&lt;/file&gt;\n    &lt;/qresource&gt;\n&lt;RCC/&gt;\n</code></pre>\n"}, {"tags": ["c++", "singleton"], "comments": [{"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 2, "creation_date": 1527699553, "post_id": 50609921, "comment_id": 88229639, "body": "There will be only one instance. <code>static ContainerTest rhc</code> will be shared throughout a single executable."}, {"owner": {"reputation": 33, "user_id": 9241447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328322ca15fd33433b150d16699e8b8?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/9241447/bob-dole"}, "reply_to_user": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1527699694, "post_id": 50609921, "comment_id": 88229709, "body": "@Steve Thanks, is there any good resource that will let me brush up on translation unit rules for C++? I&#39;m also assuming if GetInstance is not inlined by the compiler it will exist in only one place in memory?"}, {"owner": {"reputation": 6085, "user_id": 425871, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/58MZp.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/425871/steve"}, "edited": false, "score": 0, "creation_date": 1527699870, "post_id": 50609921, "comment_id": 88229804, "body": "Can&#39;t find a really good straight to the point answer, but see this: <a href=\"https://stackoverflow.com/a/246568/425871\">stackoverflow.com/a/246568/425871</a>"}], "answers": [{"tags": [], "owner": {"reputation": 551, "user_id": 7637816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9d3498eeac0ab04f4690d271f8e97d?s=128&d=identicon&r=PG&f=1", "display_name": "kiloalphaindia", "link": "https://stackoverflow.com/users/7637816/kiloalphaindia"}, "is_accepted": true, "score": 3, "last_activity_date": 1527701465, "last_edit_date": 1527701465, "creation_date": 1527700775, "answer_id": 50610299, "question_id": 50609921, "link": "https://stackoverflow.com/questions/50609921/singleton-translation-unit-confusion/50610299#50610299", "title": "Singleton translation unit confusion", "body": "<p>The <code>static</code> variable in the function will get a unique symbol name that is used by the linker to ensure there is only a single instance. It will generate a so called weak symbol, which may occur in multiple translation units. The Linker then will use only one instance. This will even work, when embedded in a dynamic library/shared object.</p>\n\n<p>I used the following small test program: (mostly your code)</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;cstdint&gt;\n\n\n\nclass ContainerTest\n{\nprivate:\n    ContainerTest()\n    { }\n\n    ContainerTest(const ContainerTest&amp;) = delete;\n    ContainerTest(ContainerTest&amp;&amp;) = delete;\n    ContainerTest&amp; operator=(const ContainerTest&amp;) = delete;\n    ContainerTest&amp; operator=(ContainerTest&amp;&amp;) = delete;\npublic:\n    std::vector&lt;uint32_t&gt; test;\n\n    static ContainerTest&amp; GetInstance()\n    {\n        static ContainerTest rhc;\n        return rhc;\n    }\n};\n\n\nint main(int, char**)\n{\n    ContainerTest&amp; ct = ContainerTest::GetInstance();\n}\n</code></pre>\n\n<p>and compiled with gcc then I called:</p>\n\n<pre><code>nm -a libContainerTestSingleton.so |grep rhc| c++filt\n</code></pre>\n\n<p>Which provides the following output:</p>\n\n<pre><code>0000000000000000 b .bss._ZGVZN13ContainerTest11GetInstanceEvE3rhc\n0000000000000000 b .bss._ZZN13ContainerTest11GetInstanceEvE3rhc\n0000000000000000 u guard variable for ContainerTest::GetInstance()::rhc\n0000000000000000 u ContainerTest::GetInstance()::rhc\n</code></pre>\n\n<p>A symbol, than is marked with an <code>u</code> means following: (nm manpage)</p>\n\n<pre><code>\"u\" The symbol is a unique global symbol.  This is a GNU extension to the\n    standard set of ELF symbol bindings.  For such a symbol the dynamic \n    linker will make sure that in the entire process there is just one\n    symbolwith this name and type in use.\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9241447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328322ca15fd33433b150d16699e8b8?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Dole", "link": "https://stackoverflow.com/users/9241447/bob-dole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 2, "accepted_answer_id": 50610299, "answer_count": 1, "score": 3, "last_activity_date": 1527701465, "creation_date": 1527699308, "question_id": 50609921, "link": "https://stackoverflow.com/questions/50609921/singleton-translation-unit-confusion", "title": "Singleton translation unit confusion", "body": "<p>In <code>ContainerTest.h</code> I have the following singleton class defined:</p>\n\n<pre><code>    class ContainerTest\n    {\n    private:\n        ContainerTest()\n        {\n            test = InitializeTest();\n        }\n\n        ContainerTest(const ContainerTest&amp;) = delete;\n        ContainerTest(ContainerTest&amp;&amp;) = delete;\n        ContainerTest&amp; operator=(const ContainerTest&amp;) = delete;\n        ContainerTest&amp; operator=(ContainerTest&amp;&amp;) = delete;\n    public:\n        std::vector&lt;uint32_t&gt; test;\n\n        static ContainerTest&amp; GetInstance()\n        {\n            static ContainerTest rhc;\n            return rhc;\n        }\n    };\n</code></pre>\n\n<p>I am confused about whether only one instance of ContainerTest will exist throughout my program.  </p>\n\n<p>I.e., if two cpp files <code>A.cpp</code> and <code>B.cpp</code> both include <code>ContainerTest.h</code> will there be one instance of ContainerTest created, or two instances? Can someone explain this? And if there's two instances created (one for A and B's translation unit) how can I prevent this?</p>\n"}, {"tags": ["c++", "gcc", "filter", "ffmpeg", "compilation"], "comments": [{"owner": {"reputation": 1199, "user_id": 6356744, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c12512db0046c6637c3e4b084cff575?s=128&d=identicon&r=PG&f=1", "display_name": "tttapa", "link": "https://stackoverflow.com/users/6356744/tttapa"}, "edited": false, "score": 1, "creation_date": 1527714286, "post_id": 50609753, "comment_id": 88236528, "body": "My guess is that MyCode.cpp wasn&#39;t compiled. Did you add it to the makefile?"}, {"owner": {"reputation": 1374, "user_id": 6385870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WcPaBJ4dA7E/AAAAAAAAAAI/AAAAAAAAACU/GqGqqqVbT9E/photo.jpg?sz=128", "display_name": "the kamilz", "link": "https://stackoverflow.com/users/6385870/the-kamilz"}, "edited": false, "score": 0, "creation_date": 1527767907, "post_id": 50609753, "comment_id": 88257319, "body": "Make sure you don&#39;t forget to disable c++ name mangling with extern C keywords."}, {"owner": {"reputation": 1, "user_id": 9717805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joeyes", "link": "https://stackoverflow.com/users/9717805/joeyes"}, "edited": false, "score": 0, "creation_date": 1527774520, "post_id": 50609753, "comment_id": 88261758, "body": "Yes, I added it to the makefile. As a result, the file is compiled (MyCode.o is exists in \\libavfilter folder)"}, {"owner": {"reputation": 49960, "user_id": 32453, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bec38d63650c8912b6ba9b557fb953b9?s=128&d=identicon&r=PG", "display_name": "rogerdpack", "link": "https://stackoverflow.com/users/32453/rogerdpack"}, "edited": false, "score": 0, "creation_date": 1527806110, "post_id": 50609753, "comment_id": 88277630, "body": "try running <code>make V=1</code> and check if MyCode.o is included in the &quot;link&quot; command.  (may need to re-run configure?)"}, {"owner": {"reputation": 1, "user_id": 9717805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joeyes", "link": "https://stackoverflow.com/users/9717805/joeyes"}, "edited": false, "score": 0, "creation_date": 1527863924, "post_id": 50609753, "comment_id": 88302155, "body": "I do make with the V=1 and placed the result in the original message"}, {"owner": {"reputation": 119, "user_id": 1543963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7BidT.png?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1543963/aaron"}, "edited": false, "score": 0, "creation_date": 1585211323, "post_id": 50609753, "comment_id": 107683349, "body": "Did you REGISTER_FILTER your new filter in allfilter.c"}], "owner": {"reputation": 1, "user_id": 9717805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joeyes", "link": "https://stackoverflow.com/users/9717805/joeyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528010294, "creation_date": 1527698556, "last_edit_date": 1528010294, "question_id": 50609753, "link": "https://stackoverflow.com/questions/50609753/compile-own-ffmpeg-filter", "title": "compile own ffmpeg filter", "body": "<p>I'm trying compile my own ffmpeg filter using oficial tutorial. My filter use C++ code. I make header file and adapt my C++ function definition for C. Now I'm trying compile with comand <code>make -j&lt;libavfilter&gt; ffmpeg</code>, but receive error message </p>\n\n<blockquote>\n  <p>gcc -Llibavcodec -Llibavdevice -Llibavfilter -Llibavformat\n  -Llibavresample -Llibavutil -Llibpostproc -Llibswscale -Llibswresample -Wl,--as-needed -Wl,-z,noexecstack -Wl,--warn-common -Wl,-rpath-link=libpostproc:libswresample:libswscale:libavfilter:libavdevice:libavformat:libavcodec:libavutil:libavresample\n  -o ffmpeg_g fftools/ffmpeg_opt.o fftools/ffmpeg_filter.o fftools/ffmpeg_hw.o fftools/cmdutils.o fftools/ffmpeg.o  -lavdevice\n  -lavfilter -lavformat -lavcodec -lswresample -lswscale -lavutil  -lm -pthread -lm -lm -lz -pthread -lm -lz -lm -lm -pthread -lm   libavfilter/libavfilter.a(vf_foobar.o): In function `filter_frame':\n  /home/joeyes/ffmpeg_sources/ffmpeg/libavfilter/vf_foobar.c:302:\n  undefined reference to MyFunction.c\n  collect2: ld returned 1 exit status\n  *** [ffmpeg_g] Error 1</p>\n</blockquote>\n\n<p>For compilation I'm added <code>OBJS-$(CONFIG_FOOBAR_FILTER) += vf_foobar.o MyCode.o</code> to /libavfilter/makefile </p>\n\n<p>Also I put MyCode.h &amp; MyCode.cpp to /libavfilter folder</p>\n"}, {"tags": ["c++", "qt", "openssl", "rsa-sha256"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 7402183, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1f450f6c0d7a3d0c0f6af26e848428c6?s=128&d=identicon&r=PG", "display_name": "AAS.N", "link": "https://stackoverflow.com/users/7402183/aas-n"}, "edited": false, "score": 0, "creation_date": 1527700323, "post_id": 50609926, "comment_id": 88230063, "body": "&#39;RSA_sign() signs the message digest m of size m_len using the private key <b>rsa</b> as specified in PKCS #1 v2.0.&#39; Is the private key rsa indicated the same string I see when I open the private certificate in a text editor? That is, do I simply read the string contents of the certificate and construct an &quot;RSA&quot; key object from it?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527701611, "post_id": 50609926, "comment_id": 88230818, "body": "Fyi, A &quot;certificate file&quot; that begins with <code>-----BEGIN RSA PRIVATE KEY-----</code> is <i>not</i> a certificate file; it&#39;s exactly what the header claims: an RSA private key (PEM encoded, in case that wasn&#39;t obvious). Normally certificates with attached private keys are bandied about in PKCS12 stores. The example linked in this answer is for importing a PEM-encoded RSA private key; not a certificate. Odds are it is still relevant, as it is likely the OP actually has the private key somewhere, but still, may as well be accurate."}], "tags": [], "owner": {"reputation": 172, "user_id": 1971806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B0Dhv.jpg?s=128&g=1", "display_name": "corsel", "link": "https://stackoverflow.com/users/1971806/corsel"}, "is_accepted": false, "score": 0, "last_activity_date": 1527700695, "last_edit_date": 1527700695, "creation_date": 1527699330, "answer_id": 50609926, "question_id": 50609731, "link": "https://stackoverflow.com/questions/50609731/what-does-a-c-project-need-to-sign-files-with-certificate-rsa-sha256/50609926#50609926", "title": "What does a C++ project need to sign files with certificate (RSA-SHA256)", "body": "<p>There appears to be a function <code>RSA_sign</code> which does exactly that, if you're into implementing it yourself with OpenSSL. You can manually take the SHA256 of your file (again, with OpenSSL), <code>RSA_sign</code> it, and use <code>RSA_verify</code>to check its validity.</p>\n\n<p><a href=\"https://linux.die.net/man/3/rsa_sign\" rel=\"nofollow noreferrer\">See here...</a></p>\n\n<p><strong>Edit:</strong>\n<a href=\"https://stackoverflow.com/questions/17400058/how-to-use-openssl-lib-pem-read-to-read-public-private-key-from-a-string/18350718\">Here</a> is an example on how to extract private key data from a PEM certificate - that is of course in case your certificate is in PEM format. PEM basically includes a human-readable header, and following key data in base64 format. You can check if your certificate file begins with a <code>-----BEGIN RSA PRIVATE KEY-----</code> line.</p>\n"}], "owner": {"reputation": 153, "user_id": 7402183, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1f450f6c0d7a3d0c0f6af26e848428c6?s=128&d=identicon&r=PG", "display_name": "AAS.N", "link": "https://stackoverflow.com/users/7402183/aas-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 529, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1527700695, "creation_date": 1527698487, "question_id": 50609731, "link": "https://stackoverflow.com/questions/50609731/what-does-a-c-project-need-to-sign-files-with-certificate-rsa-sha256", "title": "What does a C++ project need to sign files with certificate (RSA-SHA256)", "body": "<p>I am developing an app using Qt, and at some point, I was required to encrypt and \"sign\" a file provided a private certificate using SHA-256. I did a fair amount of readings on OpenSSL and certificates, but I am incapable of understanding how to conduct the process in a C++ code.</p>\n\n<p>In essence, I am attempting the equivalent of this command:</p>\n\n<pre><code>openssl dgst -sha256 -out output.txt -sign certificate.pem input.txt\n</code></pre>\n\n<p>I have explored the available Qt classes, namely the following:</p>\n\n<ul>\n<li><a href=\"http://doc.qt.io/qt-5/qsslcertificate.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qsslcertificate.html</a></li>\n<li><a href=\"http://doc.qt.io/qt-5/qcryptographichash.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qcryptographichash.html</a></li>\n<li><a href=\"http://doc.qt.io/qt-5/qsslkey.html\" rel=\"nofollow noreferrer\">http://doc.qt.io/qt-5/qsslkey.html</a></li>\n</ul>\n\n<p>The QSslCertificate class has a digest method, which seems relevant. Similarly, I can get the hashed content of the file using QCryptographicHash::hash. But nowhere can I find any mentions of \"signing\" the file with the certificate containing the RSA key.</p>\n\n<p>I can't say I fully understand the signing process, but the terminology I've heard is \"masking\" the generated SHA256 hash using an RSA algorithm - which I assumed is achieved by the OpenSSL -sign argument.</p>\n\n<p>If Qt was never meant to achieve that, what would be the easiest, or the typical alternative. I expect I'll need to include another library? Or do I simply dive to explore the OpenSSL libraries and attempt to include them in my project? <a href=\"https://www.openssl.org/docs/manmaster/man3/\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/manmaster/man3/</a></p>\n\n<p>Given how small this encryption process will be in my app, I'd appreciate an option that requires minimal integration and learning.</p>\n"}, {"tags": ["c++", "constexpr", "equivalent"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1527698388, "post_id": 50609668, "comment_id": 88229075, "body": "<a href=\"https://stackoverflow.com/questions/14116003/difference-between-constexpr-and-const\">This</a> holds the answer and so much more so I am hesitant to use it as a dupe."}, {"owner": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1527698576, "post_id": 50609668, "comment_id": 88229176, "body": "@NathanOliver I looked at that before, but didn&#39;t spot the part that answers my question because it&#39;s so far into the answer. That&#39;s the problem with large answers that answer multiple questions - sometimes it&#39;s hard to find the specific bit of information you&#39;re looking for."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1527698725, "post_id": 50609668, "comment_id": 88229257, "body": "It is in the section <i>When can I / should I use both, const and constexpr together? A. In object declarations.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "edited": false, "score": 0, "creation_date": 1527698655, "post_id": 50609747, "comment_id": 88229222, "body": "I&#39;ve upvoted, but I&#39;m going to wait before accepting in case anyone can provide some citations, or better yet - quote the standard."}, {"owner": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "edited": false, "score": 0, "creation_date": 1527699251, "post_id": 50609747, "comment_id": 88229513, "body": "cppreference doesn&#39;t specify anywhere what it means by &#39;an object declaration&#39;."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "edited": false, "score": 0, "creation_date": 1527699422, "post_id": 50609747, "comment_id": 88229579, "body": "@Pharap It does define <a href=\"http://en.cppreference.com/w/cpp/language/object\" rel=\"nofollow noreferrer\">object</a>."}, {"owner": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "edited": false, "score": 0, "creation_date": 1527699735, "post_id": 50609747, "comment_id": 88229730, "body": "On a different page to what I linked to, hence I did not cite that, and until that last comment neither had you."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "edited": false, "score": 1, "creation_date": 1527700057, "post_id": 50609747, "comment_id": 88229904, "body": "@Pharap You said that it does not specify <b>anywhere</b>, this was the reason for my reply."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1527699908, "last_edit_date": 1527699908, "creation_date": 1527698538, "answer_id": 50609747, "question_id": 50609668, "link": "https://stackoverflow.com/questions/50609668/is-const-constexpr-on-variables-redundant/50609747#50609747", "title": "Is `const constexpr` on variables redundant?", "body": "<p><code>const</code> is redundant in <code>const constexpr</code> for objects.</p>\n\n<blockquote>\n  <p>Does \"object declaration\" mean \"any variable declaration\"?</p>\n</blockquote>\n\n<p>It does.</p>\n\n<p>As per <a href=\"http://en.cppreference.com/w/cpp/language/object\" rel=\"nofollow noreferrer\">cppreference</a>, a variable or a constant is an object:</p>\n\n<blockquote>\n  <p>A variable is an object or a reference that is not a non-static data\n  member, that is introduced by a declaration.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1527700626, "post_id": 50609786, "comment_id": 88230255, "body": "the pointer itself is still implicitly const, ie you dont have to write <code>constexpr const int * const</code> because its the same as <code>constexpr const int *</code>, right?"}, {"owner": {"reputation": 352, "user_id": 2565746, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/EZssQ.jpg?s=128&g=1", "display_name": "dragonxlwang", "link": "https://stackoverflow.com/users/2565746/dragonxlwang"}, "edited": false, "score": 0, "creation_date": 1610826532, "post_id": 50609786, "comment_id": 116256629, "body": "I think so - <code>const</code> is no needed since the pointer is made in-mutable by <code>constexpr</code> already which implies its constantness;"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 14, "last_activity_date": 1527698668, "creation_date": 1527698668, "answer_id": 50609786, "question_id": 50609668, "link": "https://stackoverflow.com/questions/50609668/is-const-constexpr-on-variables-redundant/50609786#50609786", "title": "Is `const constexpr` on variables redundant?", "body": "<p>In declarations with primitives, such as the one in your example, <code>const</code> is indeed redundant. However, there may be odd situations where <code>const</code> would be required, for example</p>\n\n<pre><code>constexpr int someConstant = 3;\nconstexpr const int *someConstantPointerToConstant = &amp;someConstant;\n</code></pre>\n\n<p>Here, <code>someConstantPointerToConstant</code> is both a <code>constexpr</code> (i.e. it's known at compile time, hence <code>constexpr</code>) and it is also a pointer to constant (i.e. its object cannot be changed, hence <code>const</code>). The second declaration above would not compile with <code>const</code> omitted (<a href=\"https://ideone.com/0iv38Q\" rel=\"noreferrer\">demo</a>).</p>\n"}], "owner": {"reputation": 3152, "user_id": 1377706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bhJMC.png?s=128&g=1", "display_name": "Pharap", "link": "https://stackoverflow.com/users/1377706/pharap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2018, "favorite_count": 3, "accepted_answer_id": 50609786, "answer_count": 2, "score": 12, "last_activity_date": 1527699908, "creation_date": 1527698233, "question_id": 50609668, "link": "https://stackoverflow.com/questions/50609668/is-const-constexpr-on-variables-redundant", "title": "Is `const constexpr` on variables redundant?", "body": "<p><a href=\"https://en.cppreference.com/w/cpp/language/constexpr\" rel=\"noreferrer\">cppreference</a> states that:</p>\n\n<blockquote>\n  <p>A constexpr specifier used in an object declaration or non-static\n  member function (until C++14) implies const.</p>\n</blockquote>\n\n<hr>\n\n<p>Does \"object declaration\" mean \"any variable declaration\"?</p>\n\n<p>I.e. is</p>\n\n<pre><code>constexpr const int someConstant = 3;\n</code></pre>\n\n<p>equivalent to</p>\n\n<pre><code>constexpr int someConstant = 3;\n</code></pre>\n\n<p>in C++11, C++14 and C++17?</p>\n"}, {"tags": ["c++", "c++11", "move", "move-semantics"], "answers": [{"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 0, "last_activity_date": 1527698947, "creation_date": 1527698947, "answer_id": 50609851, "question_id": 50609626, "link": "https://stackoverflow.com/questions/50609626/can-i-use-stdmove-with-class-that-doesnt-provide-a-move-constructor/50609851#50609851", "title": "can I use std::move with class that doesn&#39;t provide a move constructor?", "body": "<p>Move constructor is generated for your class as you don't define any method which avoid its generation (as user defined destructor or copy constructor)</p>\n\n<p>The auto generated move constructor would move each member. For <code>int[1000]</code> it is equivalent to copy.</p>\n"}, {"tags": [], "owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "is_accepted": false, "score": 0, "last_activity_date": 1527699801, "last_edit_date": 1527699801, "creation_date": 1527698983, "answer_id": 50609858, "question_id": 50609626, "link": "https://stackoverflow.com/questions/50609626/can-i-use-stdmove-with-class-that-doesnt-provide-a-move-constructor/50609858#50609858", "title": "can I use std::move with class that doesn&#39;t provide a move constructor?", "body": "<p>Your question is similar to <a href=\"https://stackoverflow.com/questions/38917130/does-stdmove-work-with-lvalue-references-how-does-stdmove-work-on-standard\">this one</a>. Note that std::move simply is a cast. Your value <em>a</em> will be cast to an rvalue reference, but in your case, the original object will not be plundered or pilfered.</p>\n\n<p>To use an API or an idiom correctly, you have to use it for the right thing. Moving makes most sense for e.g. class objects where the bulk of the object data is allocated on the heap. Such an object is easy to pilfer, and the 'move' can leave the pilfered object in a well-defined state. The canonical example could be e.g. some type of string class with string data on the heap.</p>\n\n<p>In your case, what would you like to happen? Assume <em>a</em> is a local var in some function, i.e. assume <em>a</em> is on the stack. Assume <em>b</em> is a global or file scope or anonymous namespace variable, i.e. not on the stack. What would you like to happen when moving from <em>a</em> to <em>b</em>? </p>\n\n<p>For a string, pilfering makes sense. For your case, pilfering is nonsensical.</p>\n"}, {"tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1527700528, "last_edit_date": 1527700528, "creation_date": 1527699107, "answer_id": 50609877, "question_id": 50609626, "link": "https://stackoverflow.com/questions/50609626/can-i-use-stdmove-with-class-that-doesnt-provide-a-move-constructor/50609877#50609877", "title": "can I use std::move with class that doesn&#39;t provide a move constructor?", "body": "<p>Although you did not provide explicit move constructor, the compiler provided implicit move constructor to you.</p>\n\n<blockquote>\n  <p>If the definition of a class X does not explicitly declare a move constructor, one will be implicitly declared as defaulted if and only if</p>\n  \n  <ul>\n  <li>X does not have a user-declared copy constructor, and</li>\n  <li>X does not have a user-declared copy assignment operator,</li>\n  <li>X does not have a user-declared move assignment operator,</li>\n  <li>X does not have a user-declared destructor, and</li>\n  <li>the move constructor would not be implicitly defined as deleted.</li>\n  </ul>\n</blockquote>\n\n<p>So the answer on your question is: no, A is not copied to B.</p>\n\n<p>It is not clear what you ask in other questions. Please specify more details.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 9871569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9dd15a44634e36fe6d7c60316578ecf?s=128&d=identicon&r=PG&f=1", "display_name": "dkneeland", "link": "https://stackoverflow.com/users/9871569/dkneeland"}, "is_accepted": false, "score": 0, "last_activity_date": 1527699284, "creation_date": 1527699284, "answer_id": 50609913, "question_id": 50609626, "link": "https://stackoverflow.com/questions/50609626/can-i-use-stdmove-with-class-that-doesnt-provide-a-move-constructor/50609913#50609913", "title": "can I use std::move with class that doesn&#39;t provide a move constructor?", "body": "<blockquote>\n  <p>If no user-defined move constructors are provided for a class type (struct, class, or union), and all of the following is true:</p>\n  \n  <ul>\n  <li>There are no user-declared copy constructors.</li>\n  <li>There are no user-declared copy assignment operators.</li>\n  <li>There are no user-declared move assignment operators.</li>\n  <li>There are no user-declared destructors</li>\n  </ul>\n  \n  <p>then the compiler will declare a move constructor as a non-explicit inline public member of its class with the signature T::T(T&amp;&amp;).</p>\n</blockquote>\n\n<p>Quote from <a href=\"https://en.cppreference.com/w/cpp/language/move_constructor\" rel=\"nofollow noreferrer\">cppreference</a></p>\n\n<p>Basically, yes a default move constructor is created as long as you don't define a copy constructor, copy assignment overload, move assignment overload, or destructor. Otherwise you have to either define the behavior yourself or use:\n<code>\nclass_name ( class_name &amp;&amp; ) = default;\n</code>\nwhich will explicitly declare the default version of the move constructor.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1527699724, "creation_date": 1527699724, "answer_id": 50610020, "question_id": 50609626, "link": "https://stackoverflow.com/questions/50609626/can-i-use-stdmove-with-class-that-doesnt-provide-a-move-constructor/50610020#50610020", "title": "can I use std::move with class that doesn&#39;t provide a move constructor?", "body": "<blockquote>\n  <p>Is there any default move constructor for an object?</p>\n</blockquote>\n\n<p>Yes in your case. For any type <code>T</code>, a move constructor is implicitly declared only if some conditions are met. More details can be seen at <a href=\"http://en.cppreference.com/w/cpp/language/move_constructor\" rel=\"nofollow noreferrer\">cpperference.com</a>.</p>\n\n<blockquote>\n  <p>If yes, how it does work with pointers and dynamically allocated arrays?</p>\n</blockquote>\n\n<p>The default implementation will make a shallow copies of pointers. As a consequence, more than one object will point to dynamically allocated arrays. That is going lead to problems. See <a href=\"https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three\">The Rule of Three</a> for more on the subject.</p>\n\n<p>If you have pointers that point to dynamically allocated arrays, you need to:</p>\n\n<ol>\n<li>Provide an explicitly defined copy constructor that does the right thing with the dynamically allocated arrays. The side effect of this will be that the default move constructor will be implicitly deleted. and/or</li>\n<li>Provide an explicitly defined move constructor where you move the ownership of the dynamically allocated arrays appropriately.</li>\n</ol>\n"}], "owner": {"reputation": 14372, "user_id": 654019, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/438148c9a2ac0c1bb66f92a3adbafac2?s=128&d=identicon&r=PG", "display_name": "mans", "link": "https://stackoverflow.com/users/654019/mans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 0, "accepted_answer_id": 50609877, "answer_count": 5, "score": 4, "last_activity_date": 1527700528, "creation_date": 1527698112, "question_id": 50609626, "link": "https://stackoverflow.com/questions/50609626/can-i-use-stdmove-with-class-that-doesnt-provide-a-move-constructor", "title": "can I use std::move with class that doesn&#39;t provide a move constructor?", "body": "<p>I have a class like this:</p>\n\n<pre><code>class myClass\n{\n    int x[1000];\n public:\n     int &amp;getx(int i)\n    {\n        return x[i];\n    }\n}\n</code></pre>\n\n<p>Please note that I did not provide a move construct here.</p>\n\n<p>if I use the following code:</p>\n\n<pre><code>myClass A;\nauto B=std::move(a);\n</code></pre>\n\n<p>does A moves to B or since I did not provided a move constructor, A is copied to B?</p>\n\n<p>Is there any default move constructor for an object? If yes, how it does work with pointers and dynamically allocated arrays?</p>\n"}, {"tags": ["c++", "qt", "qt-creator", "include-guards"], "answers": [{"comments": [{"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1527698440, "post_id": 50609603, "comment_id": 88229108, "body": "Ideally I would like to customize it based on the project, like projectname for istance"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "reply_to_user": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1527706007, "post_id": 50609603, "comment_id": 88232987, "body": "@Moia if it&#39;s only the include guards you want to change just change them to <code>#pragma once</code>, all modern compilers support it."}, {"owner": {"reputation": 3754, "user_id": 4732082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781cea048e688814961606ddf35c5881?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/4732082/anonymous"}, "edited": false, "score": 0, "creation_date": 1527711571, "post_id": 50609603, "comment_id": 88235475, "body": "The jury is out on whether or not <code>#pragma once</code> is generally a good idea."}, {"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "edited": false, "score": 0, "creation_date": 1530537670, "post_id": 50609603, "comment_id": 89258335, "body": "@AlanBirtles do you have any suggestion about how to edit the template file to achieve that?"}, {"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1530548788, "post_id": 50609603, "comment_id": 89264640, "body": "No idea, i don&#39;t know the format of the file, I&#39;m sure you could find the relevant creator source code with a little searching or maybe it&#39;s even documented somewhere"}, {"owner": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "edited": false, "score": 0, "creation_date": 1552373718, "post_id": 50609603, "comment_id": 96972955, "body": "Sorry for reviving an &quot;old&quot; thread. In Windows the files are, starting from the location where you installed QtCreator, in <code>share\\qtcreator\\templates\\wizards\\classes\\cpp</code>. To achieve a default <code>#pragma once</code> directive instead of the <code>#IFNDEF</code> it&#39;s sufficient to open <code>file.h</code>, locate the <code>#IFNDEF %{GUARD} #DEFINE %{GUARD}</code> and replace it with the pragma. Obviously you should also remove the closing <code>#endif</code> at the end of the document. If @AlanBirtles wants to update the description he&#39;s welcome :)"}, {"owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "reply_to_user": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "edited": false, "score": 0, "creation_date": 1564040697, "post_id": 50609603, "comment_id": 100902004, "body": "@phagio the question wasn&#39;t about pragma once at all"}, {"owner": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "edited": false, "score": 0, "creation_date": 1564053314, "post_id": 50609603, "comment_id": 100909157, "body": "I think I have mistaken then what were you referring to when you asked &quot;how to edit the template file&quot;...?"}], "tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 0, "last_activity_date": 1527698002, "creation_date": 1527698002, "answer_id": 50609603, "question_id": 50609424, "link": "https://stackoverflow.com/questions/50609424/qt-creator-include-guard-pattern/50609603#50609603", "title": "Qt creator include guard pattern", "body": "<p>You can edit the templates in <code>share/qtcreator/templates/wizards/classes/cpp</code>.</p>\n\n<p>On the Mac the path is <code>qt creator.app/Contents/Resources/templates/wizards/classes/cpp</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 2883580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6e00f10fe75db800410e75850ebe678?s=128&d=identicon&r=PG&f=1", "display_name": "JulesW", "link": "https://stackoverflow.com/users/2883580/julesw"}, "is_accepted": true, "score": 3, "last_activity_date": 1562679221, "creation_date": 1562679221, "answer_id": 56953833, "question_id": 50609424, "link": "https://stackoverflow.com/questions/50609424/qt-creator-include-guard-pattern/56953833#56953833", "title": "Qt creator include guard pattern", "body": "<p>I achieved to generate header guards of the form NAMESPACE_NESTEDNAMESPACE_CLASSNAME_H. I couldn't find anything to get the project name, but in my case it was not a problem as my top level namespace is my project name.</p>\n\n<p>Following the answer of @Alan Birtles, I modified the cpp class wizard. You need to copy the files (<code>file.cpp</code>, <code>file.h</code>, <code>wizard.json</code>) from the QtCreator install directory to your home directory (<code>$HOME/.config/QtProject/qtcreator/templates/wizards</code> on Linux and macOS or <code>%APPDATA%\\QtProject\\qtcreator\\templates\\wizards</code> on Windows, according to the <a href=\"https://doc.qt.io/qtcreator/creator-project-wizards.html#locating-wizards\" rel=\"nofollow noreferrer\">doc</a>). Put them in the same subfolders (i.e. <code>wizards/classes/cpp</code>).</p>\n\n<p>In <code>wizard.json</code>, change the line:</p>\n\n<pre><code>{ \"key\": \"GUARD\", \"value\": \"%{JS: Cpp.headerGuard('%{HdrFileName}')}\" },\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>{ \"key\": \"GUARD\", \"value\": \"%{JS: Cpp.classToHeaderGuard('%{Class}', '%{JS: Util.suffix('%{HdrFileName}')}')}\" },\n</code></pre>\n\n<p>Note that you can add some static text to your liking:</p>\n\n<pre><code>{ \"key\": \"GUARD\", \"value\": \"RANDOM_TEXT_%{JS: Cpp.classToHeaderGuard('%{Class}', '%{JS: Util.suffix('%{HdrFileName}')}')}_INCLUDED\" },\n</code></pre>\n\n<p>The complete files can be found here:\n<a href=\"https://gist.github.com/juleswh/aeacc89342bc51b19044cf1e04483357\" rel=\"nofollow noreferrer\">https://gist.github.com/juleswh/aeacc89342bc51b19044cf1e04483357</a></p>\n\n<p>Hope this helps!</p>\n\n<hr>\n\n<p>I used the following ressources, in case it might be usefull:</p>\n\n<ul>\n<li>Documentation about qtcreator wizards: <a href=\"https://doc.qt.io/qtcreator/creator-project-wizards.html\" rel=\"nofollow noreferrer\">https://doc.qt.io/qtcreator/creator-project-wizards.html</a></li>\n<li>Sources of some functions available from the wizard.json file: \n\n<ul>\n<li><a href=\"https://github.com/qt-creator/qt-creator/blob/master/src/plugins/coreplugin/corejsextensions.h\" rel=\"nofollow noreferrer\">https://github.com/qt-creator/qt-creator/blob/master/src/plugins/coreplugin/corejsextensions.h</a></li>\n<li><a href=\"https://github.com/qt-creator/qt-creator/blob/master/src/plugins/cpptools/cpptoolsjsextension.cpp\" rel=\"nofollow noreferrer\">https://github.com/qt-creator/qt-creator/blob/master/src/plugins/cpptools/cpptoolsjsextension.cpp</a></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 1773, "user_id": 8805095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4948ba17681551aa212dbc7be9bff40?s=128&d=identicon&r=PG&f=1", "display_name": "Moia", "link": "https://stackoverflow.com/users/8805095/moia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 2, "accepted_answer_id": 56953833, "answer_count": 2, "score": 3, "last_activity_date": 1562679221, "creation_date": 1527697313, "last_edit_date": 1531924517, "question_id": 50609424, "link": "https://stackoverflow.com/questions/50609424/qt-creator-include-guard-pattern", "title": "Qt creator include guard pattern", "body": "<p>There's a way in <em>Qt-Creator</em> to automatically add a template string while creating a new class?</p>\n\n<p>For instance:</p>\n\n<p>I create the new <code>class Foo</code>. The header file auto-generated is</p>\n\n<pre><code>#ifndef FOO_H\n#define FOO_H\n\nclass Foo{\n};\n\n#endif FOO_H\n</code></pre>\n\n<p>What I would:</p>\n\n<pre><code>#ifndef SOMETHING_FOO_H\n#define SOMETHING_FOO_H\n\nclass Foo{\n};\n\n#endif SOMETHING_FOO_H\n</code></pre>\n\n<p>Ideally I would like to <strong><em>customize it based on the project</em></strong> like <code>PROJECTNAME_FOO_H</code> or even better <code>PROJECT_NAMESPACE_FOO_H</code></p>\n"}, {"tags": ["c++", "dynamic", "initialization", "double-pointer"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1527697048, "post_id": 50609330, "comment_id": 88228384, "body": "Do you have to use a double pointer?  <code>std::vector</code> is much easier and safer to use."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1527697112, "post_id": 50609330, "comment_id": 88228411, "body": "Please don&#39;t think of them as &quot;double pointers&quot; - they are &quot;pointers to pointers&quot;."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1527697238, "post_id": 50609330, "comment_id": 88228493, "body": "Are you required to use a pointer to pointer type? If not, don&#39;t go down that path."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527697828, "post_id": 50609330, "comment_id": 88228791, "body": "Avoid double underscores. They &#39;re reserved for use in the standard library implementation. Using them outside the standard library can have interesting and unfortunate effects.  More on that here: <a href=\"https://stackoverflow.com/questions/228783/what-are-the-rules-about-using-an-underscore-in-a-c-identifier\">What are the rules about using an underscore in a C++ identifier?</a>"}, {"owner": {"reputation": 172, "user_id": 1971806, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B0Dhv.jpg?s=128&g=1", "display_name": "corsel", "link": "https://stackoverflow.com/users/1971806/corsel"}, "edited": false, "score": 1, "creation_date": 1527701174, "post_id": 50609330, "comment_id": 88230545, "body": "Also, you can drop the <code>[1]</code> in <code>__ptrTest = new EstablishmentCloud_site *[1];</code>. You don&#39;t need to specify size if it&#39;s only 1."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1527711709, "post_id": 50609330, "comment_id": 88235532, "body": "If you have <i>&quot;several EstablishmentCloud_site in my __ptrTest&quot;</i> then you need to allocate that many pointers, e.g. <code>__ptrTest = new EstablishmentCloud_site *[number];</code> <b>and</b> each pointer will need to point to sufficient allocated storage to holding each <code>EstablishmentCloud_site</code>, e.g. <code>__ptrTest[x] = new EstablishmentCloud_site;</code> for each of them."}, {"owner": {"reputation": 67, "user_id": 3166173, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebd1390332bf6932c05d58e49951184?s=128&d=identicon&r=PG&f=1", "display_name": "cyanat", "link": "https://stackoverflow.com/users/3166173/cyanat"}, "edited": false, "score": 0, "creation_date": 1527849044, "post_id": 50609330, "comment_id": 88292810, "body": "I use object generated by gSoap library (for Webservice), and gSoap use pointer to pointer, so I can&#39;t use vector. It&#39;s also becose of gSoap generation that I have some variables with double underscore. Thanks all, especially to corsel and David, your response were very usefull!"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 3166173, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebd1390332bf6932c05d58e49951184?s=128&d=identicon&r=PG&f=1", "display_name": "cyanat", "link": "https://stackoverflow.com/users/3166173/cyanat"}, "edited": false, "score": 0, "creation_date": 1527849123, "post_id": 50612188, "comment_id": 88292854, "body": "Thanks, for your response, it was very usefull"}], "tags": [], "owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "is_accepted": true, "score": 1, "last_activity_date": 1527708714, "creation_date": 1527708714, "answer_id": 50612188, "question_id": 50609330, "link": "https://stackoverflow.com/questions/50609330/c-dynamic-initialization-of-double-pointer/50612188#50612188", "title": "C++: Dynamic initialization of double pointer", "body": "<p>The syntax to use depends on what you are trying to accomplish. As it stands, it is not clear if there is a syntax error or a logical error.</p>\n\n<p>Here is what the current syntax says to do (skipping some irrelevant steps):</p>\n\n<ol>\n<li>Create an array of pointers <em>(these pointers are garbage initially)</em>.</li>\n<li>Assign a value to the object pointed to by the first of these pointers <strong>(but since the pointer contains garbage, dereferencing it is an access violation)</strong>.</li>\n</ol>\n\n<p>You are missing the step where the pointer is assigned a valid value. If the intent is to point to <code>siteCloud</code>, Killzone Kid's answer is the way to go (<code>ptrTest[0] = &amp;siteCloud;</code> <em>I am not going to advocate using a double underscore</em>). If the intent is to copy the values from <code>siteCloud</code> to the object pointed to by the array element, you need to create that object first (something like <code>ptrTest[0] = new EstablishmentCloud_site</code>).</p>\n\n<p>The former method (assigning addresses) can run into problems if the objects do not have a sufficiently long lifespan. The latter method (more allocations) can run into memory leaks if you do not adequately clean up afterwards. If either of these are problems in your situation, you may want to reconsider if you really want an array of pointers. (You might find that there are standard templates that can make your implementation easier.)</p>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 3166173, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebd1390332bf6932c05d58e49951184?s=128&d=identicon&r=PG&f=1", "display_name": "cyanat", "link": "https://stackoverflow.com/users/3166173/cyanat"}, "is_accepted": false, "score": 0, "last_activity_date": 1527849279, "creation_date": 1527849279, "answer_id": 50641512, "question_id": 50609330, "link": "https://stackoverflow.com/questions/50609330/c-dynamic-initialization-of-double-pointer/50641512#50641512", "title": "C++: Dynamic initialization of double pointer", "body": "<p>With your help, I've managed to create this function. I hope it's not so crappy code! Thanks!</p>\n\n<pre><code>establishmentConversion(mySourceObject establishmentSource)\n{\n    EstablishmentCloud__establishment       establishmentCloud;\n\n    [...]\n\n    establishmentCloud.site_list = new EstablishmentCloudcloud_siteArray;\n    establishmentCloud.site_list-&gt;__ptr = new EstablishmentCloud__cloud_site *;\n    for(int i=0; i&lt;(*(establishmentSource.site_list)).__size; i++)\n    {\n        establishmentCloud.site_list-&gt;__ptr[i] = new EstablishmentCloud__cloud_site;\n        establishmentCloud.site_list-&gt;__ptr[i]-&gt;f_site_id=(*((*(establishmentSource.site_list)).__ptr[i])).f_site_id;\n        establishmentCloud.site_list-&gt;__ptr[i]-&gt;f_status=(*((*(establishmentSource.site_list)).__ptr[i])).f_status;\n        establishmentCloud.site_list-&gt;__ptr[i]-&gt;f_name=(*((*(establishmentSource.site_list)).__ptr[i])).f_name;\n    }\n\n    return establishmentCloud;\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 3166173, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebd1390332bf6932c05d58e49951184?s=128&d=identicon&r=PG&f=1", "display_name": "cyanat", "link": "https://stackoverflow.com/users/3166173/cyanat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 50612188, "answer_count": 2, "score": 0, "last_activity_date": 1527849279, "creation_date": 1527696983, "question_id": 50609330, "link": "https://stackoverflow.com/questions/50609330/c-dynamic-initialization-of-double-pointer", "title": "C++: Dynamic initialization of double pointer", "body": "<p>I would appreciate some help to initialize a double pointer. here is my code:</p>\n\n<pre><code>EstablishmentCloud_site **__ptrTest;\nEstablishmentCloud_site siteCloud;\n\n__ptrTest = new EstablishmentCloud_site *[1];\nsiteCloud.f_site_id=\"site\";\nsiteCloud.f_status=\"status\";\nsiteCloud.f_name=\"name\";\n*(__ptrTest[0])=siteCloud;\n</code></pre>\n\n<p>It seems that initialisation of __ptrTest is wrong because I get a \"Access violation reading location\". What is the good syntax?</p>\n\n<p>Of course, at the end, this code will be in a loop to insert several EstablishmentCloud_site in my __ptrTest.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1527696775, "post_id": 50609240, "comment_id": 88228227, "body": "I don&#39;t see what you are looking for. You could use a macro, or a function if you want to repeat same code on different objects (or multiple times) but you can&#39;t avoid referring to a variable to call a method on it when you are writing your own code. You could make all <code>setA</code> <code>setB</code> etc methods return a <code>numberComparator&amp;</code> so that you can chain them, eg <code>comparator1.setA(78.321).showA().setB(&#39;c&#39;)</code> but then it&#39;s just less readable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 1, "creation_date": 1527696789, "post_id": 50609240, "comment_id": 88228234, "body": "There is no language feature that allows you to do that, and if it is  a problem for you then I would suggest the problem really lies in the design of your classes."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1527696800, "post_id": 50609240, "comment_id": 88228236, "body": "Is it really that hard to type or copy/paste <code>comparator1</code> on each line?"}, {"owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 1, "creation_date": 1527696843, "post_id": 50609240, "comment_id": 88228272, "body": "You can implement the generator pattern, which does exactly what you need. If each of those functions return the object itself (<code>return this;</code>), you can affectively chain them together"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1527696902, "post_id": 50609240, "comment_id": 88228307, "body": "You could type in <code>X</code> for the variable name when you are typing, then use Search &amp; Replace to change <code>X</code> to <code>comparator1</code>."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527696908, "post_id": 50609240, "comment_id": 88228313, "body": "Then I guess the answer is a straight up no, yes?"}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "reply_to_user": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1527697043, "post_id": 50609240, "comment_id": 88228382, "body": "@maja I&#39;ll take note of that. It might come in handy in the future. But I can&#39;t use it for now."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1527697078, "post_id": 50609240, "comment_id": 88228394, "body": "@NathanOliver Not really. It is what I have been doing."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "reply_to_user": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1527697161, "post_id": 50609240, "comment_id": 88228442, "body": "@Jack I understand what you suggested and yes, I agree, it does make it unreadable. But for testing purpose where I delete the code afterwards, that may work well enough for me."}, {"owner": {"reputation": 14131, "user_id": 2224996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/EDCvE.jpg?s=128&g=1", "display_name": "maja", "link": "https://stackoverflow.com/users/2224996/maja"}, "edited": false, "score": 0, "creation_date": 1527697202, "post_id": 50609240, "comment_id": 88228466, "body": "Another option is to write a single set-function which gets a struct that contains all values. This way, you can set everything with a single call"}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1527697114, "post_id": 50609335, "comment_id": 88228413, "body": "I hate it when people do things like that &quot;fluent&quot; interface, as you call it. It is also very hard to do const-correctly."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1527697215, "post_id": 50609335, "comment_id": 88228475, "body": "@SergeyA Things like what?  &quot;Fluent interface&quot; or &quot;use short name&quot;.  I quite like fluent interfaces for &quot;set arbitrary members of a struct with default values&quot;."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527697308, "post_id": 50609335, "comment_id": 88228533, "body": "I will try this &quot;fluent&quot; interface you say, and yes, shorter names. Just a bad habit of mine."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1527697314, "post_id": 50609335, "comment_id": 88228537, "body": "&quot;fluent&quot; interface with a mixture of set/non-set functions as in your example."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527697432, "post_id": 50609335, "comment_id": 88228589, "body": "@A.Ortiga don&#39;t overdo it with shorter names, though. there&#39;s broad area between too long and incomprehensible alphabet soup. Try to drop inside that region somewhere."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527697500, "post_id": 50609335, "comment_id": 88228623, "body": "Oh well. If I just wanted to make the whole code less tiring to type in, which is, even in my opinion, absurd, because coding is basically typing, I should really just shorten the names."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527697523, "post_id": 50609335, "comment_id": 88228636, "body": "@user4581301 True, true."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1527697824, "post_id": 50609335, "comment_id": 88228787, "body": "I don&#39;t hate it when people do &quot;fluent&quot; interface, so downvoted for a different reason."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1527697893, "post_id": 50609335, "comment_id": 88228818, "body": "@anatolyg It would be helpful if you were prepared to explain the downvote - it might enable me to improve my answer."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527697977, "post_id": 50609335, "comment_id": 88228868, "body": "@A.Ortiga &quot;coding is basically typing&quot; - you will find that you spend <i>much</i> more of your time when programming <i>reading</i> code than typing.  The general rule is to make it as easy as possible to understand, not easy to type."}, {"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527698188, "post_id": 50609335, "comment_id": 88228963, "body": "@MartinBonner I see. I learn more and more here than in school. Honestly. Thanks for the heads-up. Appreciate it."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1527696998, "creation_date": 1527696998, "answer_id": 50609335, "question_id": 50609240, "link": "https://stackoverflow.com/questions/50609240/is-there-a-way-to-say-the-object-only-once-when-i-have-to-use-it-again-and-again/50609335#50609335", "title": "Is there a way to say the object only once when I have to use it again and again?", "body": "<p>It depends.  If <code>numberComparator</code> has a \"fluent\" interface, then each member function will return a reference to <code>*this</code>, and you can write:</p>\n\n<pre><code>    comparator1\n        .setA(78.321)\n        .showA()\n        .setB('c')\n        .setB(\"Yes\")\n        .setB(124.213)\n        .showB()\n        .setB(12);\n</code></pre>\n\n<p>Note that this is a bitch to debug by step-into (you have to step into <em>every</em> function until you get to the one you are interested in).</p>\n\n<p>The alternative of course is \"use a shorter name\".  </p>\n\n<pre><code>int main(void){\n    numberComparator c1;\n\n    c1.setA(78.321);\n    c1.showA();\n    c1.setB('c');\n    c1.setB(\"Yes\");\n    c1.setB(124.213);\n    c1.showB();\n    c1.setB(12);\n\n    return 0;\n}\n</code></pre>\n\n<p>There is really no point in having a particularly long name if it is limited in scope to a few lines.  For a local variable, if it isn't limited in scope to a few lines, your function is probably too long.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "edited": false, "score": 0, "creation_date": 1527697835, "post_id": 50609348, "comment_id": 88228800, "body": "If the point of the code <code>Comparator&amp; cr = comparator1;</code> is to shorten the name, I guess I&#39;ll just have to shorten the actual name itself then. Still, something new, so +1."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 6, "last_activity_date": 1527697041, "creation_date": 1527697041, "answer_id": 50609348, "question_id": 50609240, "link": "https://stackoverflow.com/questions/50609240/is-there-a-way-to-say-the-object-only-once-when-i-have-to-use-it-again-and-again/50609348#50609348", "title": "Is there a way to say the object only once when I have to use it again and again?", "body": "<p>You are looking for something like <code>with</code> keyword which is part of, for example, Pascal language.</p>\n\n<p>Unfortunately, C++ doesn't provide similar feature. Using the references, one can shorten the name of the class and somewhat alleviate the pain, i.e.</p>\n\n<pre><code>Comparator comparator1;\n...\n{\n    Comparator&amp; cr = comparator1;\n\n    cr.a();\n    cr.b();\n    cr.c();\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8600657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18d75c0ae70f033952ed82a74699c0ce?s=128&d=identicon&r=PG&f=1", "display_name": "A. Ortiga", "link": "https://stackoverflow.com/users/8600657/a-ortiga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 50609335, "answer_count": 2, "score": 4, "last_activity_date": 1527697041, "creation_date": 1527696650, "question_id": 50609240, "link": "https://stackoverflow.com/questions/50609240/is-there-a-way-to-say-the-object-only-once-when-i-have-to-use-it-again-and-again", "title": "Is there a way to say the object only once when I have to use it again and again?", "body": "<p>Take for example:</p>\n\n<pre><code>int main(void){\n    numberComparator comparator1;\n\n    comparator1.setA(78.321);\n    comparator1.showA();\n    comparator1.setB('c');\n    comparator1.setB(\"Yes\");\n    comparator1.setB(124.213);\n    comparator1.showB();\n    comparator1.setB(12);\n\n    return 0;\n}\n</code></pre>\n\n<p>Instead of saying <code>comparator1</code> over and over again, can I do something shorter?</p>\n\n<p>I understand that this doesn't really change much about how the program works, but it does make it easier to work around with testing a class I make. </p>\n\n<p>I am doing overloading so that for an assortment of inputs into my comparator, my program can handle them without making the results go crazy. In this case, I want the input to be an <code>int</code>, but what if the input isn't?</p>\n\n<p>The answer could be lying around the internet, but as my title may infer, I do not know how to state the question.</p>\n"}, {"tags": ["c++", "default", "default-constructor", "variable-initialization", "member-initialization"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527698164, "post_id": 50609226, "comment_id": 88228953, "body": "&quot;<i>Finally, if I change Foo to this: <code>struct Foo { Foo(){}; int member; };</code> And I do: <code>const Foo defined_construction</code> <code>member</code> is zero-initialized</i>&quot; - no, it is not.  The value of <code>member</code> is still uninitialized and indeterminate. It just HAPPENS to be 0 in your test case, but that is still not a guarantee. If you want <code>member</code> to be initialized to 0, you have to do it yourself: <code>struct Foo { Foo() : member(0) {}; int member; };</code> or, in C++11 and later: <code>struct Foo { int member = 0; };</code>"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527700107, "post_id": 50609226, "comment_id": 88229938, "body": "@RemyLebeau Ummm... shouldn&#39;t <a href=\"https://ideone.com/KlEadm\" rel=\"nofollow noreferrer\">this</a> give me an uninitialized warning then? <a href=\"https://ideone.com/cLPvak\" rel=\"nofollow noreferrer\">This</a> certainly does."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1527705825, "post_id": 50609226, "comment_id": 88232895, "body": "No, the 1st case should not issue a warning, because an explicit user-defined constructor is used, and the compiler has no clue whether that constructor initializes <code>member</code> or not when called. That would require the compiler to perform a deep analysis of what the constructor does, instead of simply calling it. In the 2nd case, the compiler generates its own constructor, and so it knows that constructor does not initialize <code>member</code>, so it can issue a warning when that constructor is used in a context that an uninitialized <code>member</code> may cause issues."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527706523, "post_id": 50609226, "comment_id": 88233243, "body": "@RemyLebeau So I&#39;m really working with uninitialized memory in <code>member</code> in <i>each</i> case. The only way to zero the value is to have a constructor that explicitly initializes <code>member</code> or without a constructor to do: <code>const Foo foo = Foo()</code> Is that correct?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527706675, "post_id": 50609226, "comment_id": 88233311, "body": "Yes, if you want <code>member</code> initialized to 0 correctly, you have to initialize it explicitly."}], "answers": [{"comments": [{"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1527700650, "post_id": 50609309, "comment_id": 88230270, "body": "I&#39;m sorry but I&#39;ve moved the goalposts on you just a bit. I&#39;ve added in links to gcc code behaving as I describe... which is inconsistent with what your quote says will happen. Can you have a look and let me know if I&#39;m missing something?"}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1527856685, "post_id": 50609309, "comment_id": 88297374, "body": "One final clarification and then I&#39;ll accept. <a href=\"https://stackoverflow.com/a/2418195/2642059\">This answer</a> discusses how <code>const Foo value_initialization = Foo()</code> zero-initializes primitives if the default constructor is the implicitly declared one. It&#39;s explaining that the <code>Foo()</code> here is in fact not using the constructor at all. Is that the case?"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 0, "creation_date": 1527865024, "post_id": 50609309, "comment_id": 88302792, "body": "Maybe &quot;Edit 2&quot; above will clarify further."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "edited": false, "score": 2, "creation_date": 1527865661, "post_id": 50609309, "comment_id": 88303216, "body": "Thank you so much for your clarifications. This is really an excellent answer."}], "tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": true, "score": 3, "last_activity_date": 1527865320, "last_edit_date": 1527865320, "creation_date": 1527696891, "answer_id": 50609309, "question_id": 50609226, "link": "https://stackoverflow.com/questions/50609226/what-form-does-the-implicitly-declared-default-constructor-take/50609309#50609309", "title": "What Form Does the Implicitly-Declared Default Constructor Take?", "body": "<p>What you're experiencing is called <a href=\"https://en.cppreference.com/w/cpp/language/default_initialization\" rel=\"nofollow noreferrer\">default initialization</a> and the rules for it are (emphasis mine):</p>\n\n<blockquote>\n  <ul>\n  <li>if T is a non-POD (until C++11) class type, the constructors are considered and subjected to overload resolution against the empty argument list. The constructor selected (which is one of the default constructors) is called to provide the initial value for the new object;</li>\n  <li>if T is an array type, every element of the array is default-initialized;</li>\n  <li><strong>otherwise, nothing is done: the objects with automatic storage duration (and their subobjects) are initialized to indeterminate values.</strong></li>\n  </ul>\n</blockquote>\n\n<p><strong>Edit, in response to OP's request below:</strong></p>\n\n<p>Note that <a href=\"http://en.cppreference.com/w/cpp/language/default_constructor\" rel=\"nofollow noreferrer\">declaring a constructor <code>= default</code></a> does not change the situation (again, emphasis mine):</p>\n\n<blockquote>\n  <p><strong>Implicitly-defined default constructor</strong></p>\n  \n  <p>If the implicitly-declared default constructor is not defined as deleted, it is defined (that is, a function body is generated and compiled) by the compiler if odr-used, and it has exactly the same effect as a user-defined constructor with empty body and <strong>empty initializer list</strong>. That is, it calls the default constructors of the bases and of the non-static members of this class.</p>\n</blockquote>\n\n<p>Since the default constructor has an empty initializer list, its members satisfy the <a href=\"https://en.cppreference.com/w/cpp/language/default_initialization\" rel=\"nofollow noreferrer\">conditions for default initialization</a>:</p>\n\n<blockquote>\n  <p>Default initialization is performed in three situations:</p>\n  \n  <p>...</p>\n  \n  <p>3) when a base class or a non-static data member is not mentioned in a constructor initializer list and that constructor is called.</p>\n</blockquote>\n\n<p>Also note that you have to be careful when experimentally confirming this, because it's entirely possible that the <em>default-initialized</em> value of an <code>int</code> may be zero. In particular, you mentioned that this:</p>\n\n<pre><code>struct Foo {\n    Foo(){};\n    int member;\n} foo;\n</code></pre>\n\n<p>Results in <a href=\"https://en.cppreference.com/w/cpp/language/value_initialization\" rel=\"nofollow noreferrer\">value-initialization</a>, but it does not; here, <code>member</code> is default-initialized.</p>\n\n<p><strong>Edit 2:</strong></p>\n\n<p>Note the following distinction:</p>\n\n<pre><code>struct Foo {\n    int member;\n};\n\nFoo a; // is not value-initialized; value of `member` is undefined\nFoo b = Foo(); // IS value-initialized; value of `member` is 0\n</code></pre>\n\n<p>This behavior can be understood by following the rules for <a href=\"https://en.cppreference.com/w/cpp/language/value_initialization\" rel=\"nofollow noreferrer\">value-initialization</a>:</p>\n\n<blockquote>\n  <p>Value initialization is performed in these situations:</p>\n  \n  <p>1,5) when a nameless temporary object is created with the initializer consisting of an empty pair of parentheses;</p>\n</blockquote>\n\n<p>Form 1 (<code>T();</code>) is the form used on the right-hand side of the <code>=</code> above to initialize <code>b</code>.</p>\n\n<blockquote>\n  <p>The effects of value initialization are:</p>\n  \n  <p>1) if T is a class type with no default constructor or with a user-provided or deleted default constructor, the object is default-initialized;</p>\n  \n  <p>2) if T is a class type with a default constructor that is neither user-provided nor deleted (that is, it may be a class with an implicitly-defined or defaulted default constructor), the object is zero-initialized and then it is default-initialized if it has a non-trivial default constructor;</p>\n  \n  <p>3) if T is an array type, each element of the array is value-initialized;</p>\n  \n  <p><strong>4) otherwise, the object is zero-initialized.</strong></p>\n</blockquote>\n\n<p>Finally though, note that in our earlier example:</p>\n\n<pre><code>struct Foo {\n    Foo(){}; // this satisfies condition (1) above\n    int member;\n};\n\nFoo f = Foo();\n</code></pre>\n\n<p>Now, condition (1) applies, and our (empty) user-declared constructor is called instead. Since this constructor does not initialize <code>member</code>, <code>member</code> is default-initialized (and its initial value is thus undefined).</p>\n"}], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 50609309, "answer_count": 1, "score": 0, "last_activity_date": 1527865320, "creation_date": 1527696590, "last_edit_date": 1527700539, "question_id": 50609226, "link": "https://stackoverflow.com/questions/50609226/what-form-does-the-implicitly-declared-default-constructor-take", "title": "What Form Does the Implicitly-Declared Default Constructor Take?", "body": "<p>So let's say I'm working with this toy example:</p>\n\n<pre><code>struct Foo {\n    int member;\n};\n</code></pre>\n\n<p>I know that the default constructor won't default initialize <code>member</code>. So if I do this, <code>member</code> remains uninitialized: <code>const Foo implicit_construction</code>. <sub>As an aside this seems to work fine: <code>const Foo value_initialization = Foo()</code> though my understanding is that this isn't actually using the default constructor.</sub> </p>\n\n<p>If I change <code>Foo</code> like this:</p>\n\n<pre><code>struct Foo {\n    Foo() = default;\n    int member;\n};\n</code></pre>\n\n<p>And I try to do <code>const Foo defaulted_construction</code>, unsurprisingly it behaves exactly as <code>implicit_construction</code> did, with <code>member</code> being uninitialized.</p>\n\n<p>Finally, if I change <code>Foo</code> to this:</p>\n\n<pre><code>struct Foo {\n    Foo(){};\n    int member;\n};\n</code></pre>\n\n<p>And I do: <code>const Foo defined_construction</code> <code>member</code> <em>is</em> zero-initialized. I'm just trying to make sense of what the implicitly defined constructor looks like. I would have though it would have been <code>Foo(){}</code>. Is this not the case? Is there some other black magic at work that makes my defined constructor behave differently than the defaulted one?</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Perhaps I'm being mislead here. <a href=\"https://ideone.com/cLPvak\" rel=\"nofollow noreferrer\"><code>defaulted_construction</code> is definitely uninitialized</a>.<br>\n<a href=\"https://ideone.com/KlEadm\" rel=\"nofollow noreferrer\">While <code>defined_construction</code> is definitely initialized</a>.</p>\n\n<p>I took this to be standardized behavior, is that incorrect?</p>\n"}, {"tags": ["c++", "overloading", "multiple-inheritance", "pure-virtual"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 4, "creation_date": 1527696432, "post_id": 50609156, "comment_id": 88228035, "body": "You cannot overload based on return value alone.  You need to give <code>B::f()</code> a different set of parameters, or rename it to something else."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1527696513, "post_id": 50609156, "comment_id": 88228083, "body": "You don&#39;t - you, you implement classes D and E that implement the various <code>f()</code>&#39;s and then inherit those."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 2, "creation_date": 1527696598, "post_id": 50609156, "comment_id": 88228126, "body": "even if you were to have both, <code>cObj.f()</code> would be ambiguous"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1527696619, "post_id": 50609156, "comment_id": 88228139, "body": "@vu1p3n0x not if you pass an A or B pointer / reference to an object it&#39;s not"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1527696655, "post_id": 50609156, "comment_id": 88228162, "body": "@vu1p3n0x surprisingly, it is not."}, {"owner": {"reputation": 697, "user_id": 1160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431cd02524d6ee187fcd1b3d9658498c?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/1160404/maddy"}, "edited": false, "score": 1, "creation_date": 1527696699, "post_id": 50609156, "comment_id": 88228181, "body": "Try templatizing your interface so that the same interface can be used for different data type as return values"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1527696878, "post_id": 50609156, "comment_id": 88228289, "body": "@vu1p3n0x ok, I was thinking about something else. Nevermind and let&#39;s pretend it never happened."}, {"owner": {"reputation": 9551, "user_id": 9837301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9414V.png?s=128&g=1", "display_name": "JaMiT", "link": "https://stackoverflow.com/users/9837301/jamit"}, "edited": false, "score": 2, "creation_date": 1527707179, "post_id": 50609156, "comment_id": 88233560, "body": "Suppose you are writing the new code that is supposed to use the <code>B</code> interface via <code>C</code>. How do you expect the new code to tell <code>C</code> that the <code>B</code> interface is to be used? (Once you&#39;ve answered that: what benefit are you gaining by using a single class with both interfaces?)"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 697, "user_id": 1160404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431cd02524d6ee187fcd1b3d9658498c?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/1160404/maddy"}, "edited": false, "score": 0, "creation_date": 1528140117, "post_id": 50609156, "comment_id": 88384586, "body": "@Maddy Can you explain how that generalization (templatisation?) would work?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7098459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/014ab428f370fb6edb785b5f1cb95430?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik Stax&#228;ng", "link": "https://stackoverflow.com/users/7098459/fredrik-stax%c3%a4ng"}, "is_accepted": false, "score": 0, "last_activity_date": 1527835627, "last_edit_date": 1527835627, "creation_date": 1527704197, "answer_id": 50611137, "question_id": 50609156, "link": "https://stackoverflow.com/questions/50609156/how-to-have-two-pure-virtual-methods-with-the-same-name-but-different-return-typ/50611137#50611137", "title": "How to have two pure virtual methods with the same name but different return types", "body": "<p>This at least compiles with VS2017:</p>\n\n<pre><code>struct A\n{\n    virtual void f() = 0;\n};\n\nstruct A2: public A\n{\n    void f() { Af(); }\n    virtual void Af() = 0;\n};\n\nstruct B\n{\n    virtual int f() = 0;\n};\n\nstruct B2 : public B\n{\n    int f() { return Bf(); }\n    virtual int Bf() = 0;\n};\n\nstruct C : public A2, public B2\n{\n    void Af() {}\n    int Bf() { return 42; }\n};\n</code></pre>\n\n<p>Edit: Could not add this a comment on Paul Accisano's own answer, so I put it here.</p>\n\n<p>Modifying Paul's answer slightly. By making the unused default parameter a protected class, you still have correct type checking, and avoid the potential for a type conflict with another member function.</p>\n\n<pre><code>struct A\n{\n    virtual void f() = 0;\n};\n\nstruct B\n{\nprotected:\n    class disambiguator {};\npublic:\n    virtual int f(disambiguator ignoreMe = disambiguator()) = 0;\n};\n\n\nstruct C : public A, public B\n{\n    virtual void f() override {}\n    virtual int f(disambiguator ignoreMe) override { return 42; }\n};\n\nA *createA() { return new C; }\nB *createB() { return new C; }\n</code></pre>\n\n<p>One application for this could be the gradual migration from raw pointers to smart pointers.  </p>\n"}, {"tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1527756957, "creation_date": 1527756957, "answer_id": 50620352, "question_id": 50609156, "link": "https://stackoverflow.com/questions/50609156/how-to-have-two-pure-virtual-methods-with-the-same-name-but-different-return-typ/50620352#50620352", "title": "How to have two pure virtual methods with the same name but different return types", "body": "<p>The way I would do it is</p>\n\n<pre><code>struct A {}\nstruct B {}\nstruct OldImpl : public A {}\nstruct NewImpl : public B {}\nstruct Combined : public AImpl, public BImpl {}\n</code></pre>\n\n<p>You can then pass the combined into anything that wants an A or a B.\nThe problem with this is that your OldImpl and NewImpl are completely separate.  They're not allowed to interact with each other; meaning you can't call <code>setFoo()</code> in A and get the same value in <code>getFoo()</code> in B.  Which is probably not what you want from what you described.</p>\n\n<p>To resolve this, don't create a 2nd interface.  It wouldn't work anyway because where a <code>xxx()</code> might be void now, and an int later, you probably want to do something with the return value.  If you really want to do it in baby steps, create a branch, change a single functions return value, test it, merge it in, repeat.</p>\n"}, {"comments": [{"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1528140207, "post_id": 50629486, "comment_id": 88384628, "body": "Very hackish design!"}], "tags": [], "owner": {"reputation": 1287, "user_id": 238947, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fdd4d509a0a11244dfa8398aeac33807?s=128&d=identicon&r=PG", "display_name": "Paul Accisano", "link": "https://stackoverflow.com/users/238947/paul-accisano"}, "is_accepted": false, "score": 0, "last_activity_date": 1527786878, "last_edit_date": 1527786878, "creation_date": 1527786574, "answer_id": 50629486, "question_id": 50609156, "link": "https://stackoverflow.com/questions/50609156/how-to-have-two-pure-virtual-methods-with-the-same-name-but-different-return-typ/50629486#50629486", "title": "How to have two pure virtual methods with the same name but different return types", "body": "<p>Thanks for the good responses!  But I did figure out my own solution: good old optional parameters!</p>\n\n<pre><code>struct A\n{\n    virtual void f() = 0;\n};\n\nstruct B\n{\n    virtual int f(int ignoreMe = 0) = 0;\n};\n\n\nstruct C : public A, public B\n{\n    virtual void f() override {}\n    virtual int f(int) override {}\n};\n</code></pre>\n\n<p>No ambiguity for external users using <code>A</code> or <code>B</code>, and no parameters need to change.  No ambiguity internally either because parameter is non-optional in the implementation class.  The optional parameter can be removed, along with <code>A</code>, once migration is complete.</p>\n"}], "owner": {"reputation": 1287, "user_id": 238947, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fdd4d509a0a11244dfa8398aeac33807?s=128&d=identicon&r=PG", "display_name": "Paul Accisano", "link": "https://stackoverflow.com/users/238947/paul-accisano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1527835627, "creation_date": 1527696356, "question_id": 50609156, "link": "https://stackoverflow.com/questions/50609156/how-to-have-two-pure-virtual-methods-with-the-same-name-but-different-return-typ", "title": "How to have two pure virtual methods with the same name but different return types", "body": "<p>I've got an interface <code>A</code> which is publicly available, and a back-end implementation class <code>C</code>, like so:</p>\n\n<pre><code>struct A\n{\n    virtual void f() = 0;\n};\n\nstruct C : public A\n{\n    virtual void f() override\n    {\n    }\n};\n</code></pre>\n\n<p>I would like to gradually migrate to a new interface, <code>B</code>.  <code>B</code> will have the same methods, however, the return types might be different.  I would like my implemetation class to implement both <code>A</code> and <code>B</code> so that legacy code can keep using <code>A</code> until it is migrated, but new code can be written with <code>B</code>.  I know that if I have two pure virtual methods with exactly the same signature, I only need one override in my implementation class.  But if they differ by return type, I don't know how to do it...</p>\n\n<pre><code>struct A\n{\n    virtual void f() = 0;\n};\n\nstruct B\n{\n    virtual int f() = 0;\n};\n\n\nstruct C : public A, public B\n{\n    // How do I implement both versions of f() here??\n};\n</code></pre>\n"}, {"tags": ["c++", "qt", "qml"], "comments": [{"owner": {"reputation": 473, "user_id": 9371692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4sipy.png?s=128&g=1", "display_name": "BrutalWizard", "link": "https://stackoverflow.com/users/9371692/brutalwizard"}, "reply_to_user": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "edited": false, "score": 0, "creation_date": 1527698495, "post_id": 50609108, "comment_id": 88229138, "body": "@eyllanesc, I need to get text that person write in this TextField, but when I try to get text properety I not get person input, I get text properety that I code in qml firstly"}], "answers": [{"tags": [], "owner": {"reputation": 185819, "user_id": 6622587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gAYS0.jpg?s=128&g=1", "display_name": "eyllanesc", "link": "https://stackoverflow.com/users/6622587/eyllanesc"}, "is_accepted": true, "score": 3, "last_activity_date": 1556656103, "last_edit_date": 1556656103, "creation_date": 1527698871, "answer_id": 50609832, "question_id": 50609108, "link": "https://stackoverflow.com/questions/50609108/get-user-input-from-qml-to-c/50609832#50609832", "title": "Get user input from qml to c++", "body": "<p>You are asking for the text of the <code>TextField</code> when the window is displayed so what you will get is the text you have initially set, what you should do is get it every time it changes. I think that you have some class that will handle some processing with that data, that class will be called <code>Backend</code>, it must inherit from <code>QObject</code> so that it can have a qproperty and embed an object of that class to QML through <code>setContextProperty</code>, so every time it changes the text in <code>QML</code> will also change the text in the <code>Backend</code> class object.</p>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QGuiApplication&gt;\n#include &lt;QQmlApplicationEngine&gt;\n#include &lt;QQmlContext&gt;\n#include &lt;QQmlProperty&gt;\n\n#include &lt;QDebug&gt;\n\nclass Backend: public QObject{\n    Q_OBJECT\n    Q_PROPERTY(QString text READ text WRITE setText NOTIFY textChanged)\npublic:\n    QString text() const{\n        return mText;\n    }\n   void setText(const QString &amp;text){\n        if(text == mText)\n            return;\n        mText = text;\n        emit textChanged(mText);\n    }\nsignals:\n    void textChanged(const QString &amp; text);\nprivate:\n    QString mText;\n};\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication::setAttribute(Qt::AA_EnableHighDpiScaling);\n\n    QGuiApplication app(argc, argv);\n\n    Backend backend;\n\n    QQmlApplicationEngine engine;\n    engine.rootContext()-&gt;setContextProperty(\"backend\", &amp;backend);\n    engine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n    if (engine.rootObjects().isEmpty())\n        return -1;\n\n    // test\n\n    QObject::connect(&amp;backend, &amp;Backend::textChanged, [](const QString &amp; text){\n        qDebug() &lt;&lt; text;\n    });\n    return app.exec();\n}\n\n#include \"main.moc\"\n</code></pre>\n\n<p><strong>main.qml</strong></p>\n\n<pre><code>import QtQuick 2.9\nimport QtQuick.Window 2.2\nimport QtQuick.Controls 2.4\n\nWindow {\n    visible: true\n    width: 640\n    height: 480\n    title: qsTr(\"Hello World\")\n\n    TextField {\n        id: serverField1\n        x: 15\n        y: 46\n        width: 120\n        height: 45\n        topPadding: 8\n        font.pointSize: 14\n        bottomPadding: 16\n        placeholderText: \"Server Ip\"\n        renderType: Text.QtRendering\n        onTextChanged: backend.text = text\n    }\n}\n</code></pre>\n\n<p><sub>\nYou can find the complete code in the following <a href=\"https://github.com/eyllanesc/stackoverflow/tree/master/questions/50609108\" rel=\"nofollow noreferrer\">link</a>.\n</sub></p>\n"}], "owner": {"reputation": 473, "user_id": 9371692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4sipy.png?s=128&g=1", "display_name": "BrutalWizard", "link": "https://stackoverflow.com/users/9371692/brutalwizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2031, "favorite_count": 1, "accepted_answer_id": 50609832, "answer_count": 1, "score": 3, "last_activity_date": 1558010790, "creation_date": 1527696199, "last_edit_date": 1558010790, "question_id": 50609108, "link": "https://stackoverflow.com/questions/50609108/get-user-input-from-qml-to-c", "title": "Get user input from qml to c++", "body": "<p>I'm trying to get user input from <strong>qml TextField</strong> to <strong>c++</strong>, but it only works if <strong>text property value</strong> is hardcoded <em>(const value)</em>. </p>\n\n<h2>c++</h2>\n\n<pre><code>QQmlApplicationEngine engine;\nengine.load(QUrl(QStringLiteral(\"qrc:/main.qml\")));\n\nQObject *rootObject = engine.rootObjects().first();\nQObject *serverField1 = rootObject-&gt;findChild&lt;QObject*&gt;(\"serverField1\");\n\nqDebug() &lt;&lt; serverField1-&gt;property(\"text\"); //Here I expect to get user input\n</code></pre>\n\n<h2>Qml</h2>\n\n<pre><code>ApplicationWindow {\n    id: applicationWindow\n    visible: true\n    width: 300\n    height: 550\n\n    TextField {\n        id: serverField1\n        objectName: \"serverField1\"\n        width: 200\n        height: 110\n//    text: \"hardcoded value\" //If text is const value, qDebug will get data from this property\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "programming-languages"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 4, "creation_date": 1527696129, "post_id": 50609077, "comment_id": 88227838, "body": "C or C++?  if C++ the answer is pretty much never unless interfacing with C; since lambdas and std::function have replaced them"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 3, "creation_date": 1527696152, "post_id": 50609077, "comment_id": 88227853, "body": "Isn&#39;t a function pointer the only way to pass functions in C? How would you implement a callback without functions pointers?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 8, "creation_date": 1527696217, "post_id": 50609077, "comment_id": 88227895, "body": "&quot;I didn&#39;t get any proper justification for this.&quot; Try coding up a library, you&#39;ll get your justification pretty quickly :-)"}, {"owner": {"reputation": 7456, "user_id": 1202400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ddf9dd040b42f80911e4a53010dfc7?s=128&d=identicon&r=PG", "display_name": "unxnut", "link": "https://stackoverflow.com/users/1202400/unxnut"}, "edited": false, "score": 1, "creation_date": 1527696330, "post_id": 50609077, "comment_id": 88227973, "body": "Look at the implementation of <code>qsort</code>.  See how it allows for user-defined comparator with possibly user-defined data types."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527696446, "post_id": 50609077, "comment_id": 88228042, "body": "If you are interested in embedded, study the source code of the Linux kernel (or just some drivers inside it)"}, {"owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1527696621, "post_id": 50609077, "comment_id": 88228140, "body": "@Carcigenicate - callback is nothing but an address of function which indirect called by other function or some other entity. My statement may be misinterpret. But my query is why same cannot be done via direct call.  You may be answering correctly but for my explanation give a practical use case scenario. That&#39;s why I asked to give some realistic example."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1527696694, "post_id": 50609077, "comment_id": 88228180, "body": "The purpose of callbacks is that you&#39;re passing the function pointer to another function. That other function doesn&#39;t know what function to call unless you tell it."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1527696779, "post_id": 50609077, "comment_id": 88228229, "body": "@Vikere Callback typically means giving a function to some code to have them use it to &quot;call back&quot; at a future time. That necessarily involves passing a function, or something representing a function like a pointer. I&#39;m not sure what you mean by callback then in this question. If you&#39;re just calling a function in the scope that it was defined in, no, you wouldn&#39;t necessarily need a pointer."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1527697688, "post_id": 50609077, "comment_id": 88228723, "body": "Try making a generic heap data structure in C that can hold any type of data.  You will discover the utility of function pointers in carrying out this task."}, {"owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1527697823, "post_id": 50609077, "comment_id": 88228783, "body": "@Carcigenicate Yes you are very correct. So to clarify - if there is a function taking function pointer as argument - void sum (int, int (*)()) So, it means 2nd part could be mapped to any function of same signature. Is it correct??"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1527698366, "post_id": 50609077, "comment_id": 88229063, "body": "Try implementing the <code>qsort</code> stdlib function without a function pointer. Then come back and ask again."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1527701113, "post_id": 50609077, "comment_id": 88230509, "body": "a) it is a ghee whiz feature of the language so why not use it, just like bitfields.  b) it should be easy to see cases where you cannot determine at runtime what you are calling, does that REQUIRE function calls?  no absolutely not.  but it is a quick and dirty way to do it, even if it is not a runtime thing.  generic code that connects to some peripheral, the peripheral can come in through bluetooth or usb but is at some level handled the same way, have a bluetooth transport and a usb transport, glue in the function pointers at discovery and use for the duration. zillion other examples."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1527701166, "post_id": 50609077, "comment_id": 88230542, "body": "@tofro @unxnut actually you can make a generic <code>qsort</code> without function pointers with macros but i am not say it the right way."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1527696690, "creation_date": 1527696690, "answer_id": 50609251, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609251#50609251", "title": "Why to use function pointer?", "body": "<p>There is a concept in programming called DRY -- don't repeat yourself.</p>\n\n<p>Suppose you have 121 buttons in your UI.  Each one of them behaves much the same, except when you press the button, a different operation happens.</p>\n\n<p>You can (A) use virtual inheritance to dispatch to the right operation (requiring a class per button), or (B) use a function pointer (or a <code>std::function</code>) stored in the class in order to call the right \"on click\" handler, or (C) have every single button be a distinct type.</p>\n\n<p>A virtual function is implemented in every compiler I have examined as a complex table that, in the end, is a collection of function pointers.</p>\n\n<p>So your choices are function pointers or generating 121 completely distinct buttons that happen to mostly behave the same.</p>\n\n<p>In any situation where you want to decouple the caller and the called, you must use something akin to a function pointer.  There are a ridiculous number of cases, from work queues to thread off tasks, callbacks, etc.</p>\n\n<p>In tiny programs where everything is hard coded, hard coding every call can work.  But hard coded stuff like this <em>doesn't scale</em>.  When you want to update those 121 buttons each hand-implemented, knowing their points of customization is going to be ridiculously difficult.  And they <em>will</em> fall out of sync.</p>\n\n<p>And 121 is a modest number of buttons.  What about an app with 10,000?  And you want to update every button's behavior to handle touch-based input?</p>\n\n<p>Even more, when you type erase, you can reduce binary size significantly.  121 copies of a class implementing a button is going to take more executable space than 1 class, each of which stores a function pointer or two.</p>\n\n<p>Function pointers are but one type of \"type erasure\".  Type erasure reduces binary size, provides clearer contracts between provider and consumer, and makes it easier to refactor behavior around the type erased data.</p>\n"}, {"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 0, "last_activity_date": 1527698162, "creation_date": 1527698162, "answer_id": 50609642, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609642#50609642", "title": "Why to use function pointer?", "body": "<blockquote>\n  <p>1) callbacks - same can be achieved by direct call.</p>\n</blockquote>\n\n<p>Not in all cases, since the caller may not know at compile-time what function must be called. For instance, this is typical in libraries since they cannot know in advance your code.</p>\n\n<p>However, it can also happen in your own code: whenever you want to re-use partially a function, you can either:</p>\n\n<ul>\n<li>Create several versions of that function, each calling a different function. Duplicates code, very bad maintenance. Good performance unless hit by code bloat.</li>\n<li>Pass a function pointer (or callable in general in C++). Flexible, less code, performance might suffer in some cases.</li>\n<li>Create a set of branches (<code>if</code>/<code>switch</code> chain), if you know in advance the set of possible functions to call. Rigid, but might be faster than a function pointer for small number of branches.</li>\n<li>In C++, create a templated version. Same as the first case, but automated; so good maintenance. Code bloat might be an issue.</li>\n<li>Factor out the common code so that callers can call whatever they need piece by piece. Sometimes this isn't possible/easy -- specially when parametrizing complex algorithms that you want to keep reusable (e.g. <code>qsort()</code>). In C++, see the STL (Standard Template Library).</li>\n</ul>\n\n<blockquote>\n  <p>2) Asynchronous or synchronous event handling - anyway event has to be identified, based on which element no. in function pointer array got updated. But the same can be also done via direct call.</p>\n</blockquote>\n\n<p>Some event systems are designed so that you simply configure which function(s) will be triggered when a given event happens. If this is an external library with a C interface, they have no choice but to use function pointers.</p>\n\n<p>Some other systems let you create your own event loop and you fetch the events somehow and do whatever you want with them; so they avoid callbacks.</p>\n\n<blockquote>\n  <p>3) In some post I had seen people commenting it is to be used when it is not known which function to call. I didn't get any proper justification for this.</p>\n</blockquote>\n\n<p>See the first case.</p>\n"}, {"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527698643, "post_id": 50609646, "comment_id": 88229217, "body": "I am not sure you have made your case here and have certainly not addressed the specific usage of function-pointers described in the question. You have introduced an additional use, which is fine, but seems unlikely to convince the OP of their utility in the specific circumstances he has asked about."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527698874, "post_id": 50609646, "comment_id": 88229331, "body": "@Clifford <a href=\"https://en.wikipedia.org/wiki/Callback_(computer_programming)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Callback_(computer_programming)</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527699245, "post_id": 50609646, "comment_id": 88229511, "body": "I am not sure why you have addressed that link to me, or how it relates to either your answer or my previous comment.  My point is simply that the question is rather broad but your answer rather much narrower.  Moreover it is a good example, but perhaps not a complete answer - also somewhat succinct - you have answered a question with a question, and given the nature of the original question, I doubt the OP will even understand your answer."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527699729, "post_id": 50609646, "comment_id": 88229724, "body": "@Clifford In paragraph one the poster questions the use of callbacks. I have provided an example which illustrates its necessity. I doubt it is unclear to anyone."}], "tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1527698170, "creation_date": 1527698170, "answer_id": 50609646, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609646#50609646", "title": "Why to use function pointer?", "body": "<p>Without function pointers, how would you implement a function which calculates the integral of any real-valued function?</p>\n\n<pre><code>typedef double (*Function)(double);\n\ndouble Integral(Function f, double a, double b);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 3, "last_activity_date": 1527698740, "last_edit_date": 1527698740, "creation_date": 1527698233, "answer_id": 50609665, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609665#50609665", "title": "Why to use function pointer?", "body": "<blockquote>\n  <p>1) callbacks - same can be achieved by direct call.</p>\n</blockquote>\n\n<p>Not true.  For a direct call, the caller must know the function name <em>and</em> signature when the code is compiled, and can only ever call that one function.  A callback is defined at <em>runtime</em> and can be changed dynamically, while the caller need only know the <em>signature</em>, not the name.  Moreover each instance of an object may have a different callback, whereas with a direct call, all instances must call the same function.</p>\n\n<blockquote>\n  <p>2) Asynchronous or synchronous event handling - anyway event has to be\n  identified, based on which element no. in function pointer array got\n  updated. But the same can be also done via direct call.</p>\n</blockquote>\n\n<p>Not sure what you mean, but an event handler is simply a kind of callback.  The event may be identified by the caller and different call-back handlers called through pointers.  Your point only stands if there is one event handler for all event types and the user is to be responsible for identification.</p>\n\n<blockquote>\n  <p>3) In some post I had seen people commenting it is to be used when it is not known which function to call. I didn't get any proper justification for this.</p>\n</blockquote>\n\n<p>See (1) and (2) above.  Often it is a means to hook platform independent third-party library code into a specific platform without having to deliver source-code or for system events that require user/application-defined handlers.</p>\n\n<p>I would not sweat it however - if all your application requirements can be resolved without using a pointer to a function, then you don't need a pointer to a function.  When you need one, you will probably know.  You will most likely encounter it when you have to use an API that requires it before you ever implement an interface yourself that does.  For example in the standard library the <code>qsort()</code> function requires a pointer to a function in order to define how two objects of arbitrary type are to be ordered - allowing <code>qsort()</code> to support any type of object - it is a way in C of making a function \"<em>polymorphic</em>\".  C++ supports polymorphism directly, so there is often less need for explicit function-pointers in C++ - although internally polymorphism is implemented using function pointers in any case.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 3, "last_activity_date": 1527703977, "creation_date": 1527703977, "answer_id": 50611081, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50611081#50611081", "title": "Why to use function pointer?", "body": "<p>Some more things function pointers are often used for:</p>\n\n<ul>\n<li><strong>Runtime polymorphism:</strong> You can define a structure that encapsulates a function pointer, or a pointer to a function table.  This enables you to call the specified function at runtime, even for a type of client object that did not exist when your library was written.  You can use this to implement multiple dispatch or something like the visitor design pattern in C.  This is also how C++ classes and their <code>virtual</code> member functions were originally implemented under the hood.</li>\n<li><strong>Closures:</strong> These can be structures containing a function pointer and one or more of its arguments.</li>\n<li><strong>State Machines:</strong> Instead of a <code>switch</code> with a <code>case</code> for each state label, I\u2019ve often found it convenient to give the handler for each state its own function.  The current state is the function you\u2019re in, the state transitions are tail-recursive calls, and the program variables are parameters. The state labels then become function pointers, which you might store in a table or return from a function. </li>\n<li><strong>Higher-Order Functions:</strong> Two examples from the C standard library are <code>qsort()</code> and <code>btree()</code>, which generalize the type of elements and the comparison function.</li>\n<li><strong>Low-Level Support:</strong> Shared-library loaders, for example, need this.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "is_accepted": false, "score": 0, "last_activity_date": 1527709622, "creation_date": 1527709622, "answer_id": 50612377, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50612377#50612377", "title": "Why to use function pointer?", "body": "<p>Thanks all for actively participating in this discussion. Thanks for giving practical examples like -</p>\n\n<p>1) Implement Library function</p>\n\n<p>2) Look qsort</p>\n\n<p>3) Refer Linux Kernel</p>\n\n<p>4) Generic Heap data structure in C</p>\n\n<p>I feel qsort() <code>void qsort(void *base, size_t nitems, size_t size, int (*compar)(const void *, const void*)) s</code> is quite sufficient to clear my 1) &amp; 3) point.</p>\n\n<p><strong>1) callbacks - same can be achieved by direct call.\n3) In some post I had seen people commenting it is to be used when it is not known which function to call. I didn't get any proper justification for this.</strong></p>\n\n<p>Mainly by callbacks - it is a provision of calling a function for which the body is not yet defined. And it expected that the definition of the function will be provided later during run-time. So, compilation won't be hindered due to lack of function definition. Practical use if someone consider above qsort() function. In this the user is responsible for providing the function definition for compare() like -</p>\n\n<pre><code>int compare (int* a, int* b)\n{\n  //User defined body based on problem requirement\n}\n</code></pre>\n\n<p>Lets consider a practical scenario where multiple threads have their respective compare function. In case of direct call every thread need to implement their own sorting function or if a common function then implementation would be much more bulky. But by using the callback method all threads can use same function for sorting, since the sorting algo remain same for all threads. \nConsidering a <strong>layered architecture</strong> mainly higher layers have an abstract view of lower layer. So, here if say we have qsort() function [User defined qsort] implemented at application layer and lets say underlying application there is a ADC driver layer which capture sample and provide to application for sorting. Then for application it is not necessary to understand the definition of function responsible for collecting and providing the samples. But application will only focus on obtaining the sample. Hence, that main application won't know which function to call. Respective ADC driver will simply make a call to application using the qsort() and provide needful data.</p>\n\n<p>Regarding 2 point still confused -\n<strong>2) Asynchronous or synchronous event handling - anyway event has to be identified, based on which element no. in function pointer array got updated. But the same can be also done via direct call.</strong></p>\n\n<p>From above discussion I conclude that if event handlers pointed to some library function, then it need to be implemented via pointer to function. And secondly to create an independent and handy code it is necessary to maintain function pointer. Lets say between application and driver we have an interfacing layer. So, if either application or driver changes anytime it won't affect or very least affect each other. And this interface layer is implemented using pointer to function. But consider below scenario -</p>\n\n<pre><code>int (*fptr[10]) (void) =\n{\n    function1;     //function for starting LED\n    function2;     //function for relay operation\n      .\n      .\n    function10;    //function for motor control\n}\n</code></pre>\n\n<p>lets say we have GPIO0.0 - GPIO0.10 has been mapped to the function pointer array. i.e. GPIO0.0 - 0th element of fptr\n             .\n             .\n            GPIO0.10 - 10th element of fptr\nThese GPIO pins has been configured for level triggered interrupt and their respective ISR will update the array element no. <code>i=GPIO_Value;</code> further the scheduler have an thread which will call the function pointer array -</p>\n\n<pre><code>fptr[i]();\n</code></pre>\n\n<p>Does the use of function pointer is justifiable here??</p>\n"}], "owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2972, "favorite_count": 4, "closed_date": 1527708993, "answer_count": 6, "score": -6, "last_activity_date": 1527709622, "creation_date": 1527696039, "last_edit_date": 1527703958, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer", "closed_reason": "Duplicate", "title": "Why to use function pointer?", "body": "<p>I hope its an extremely repetitive question. And my advance excuse to all the viewers who find it annoying.</p>\n\n<p>Although I am bit experienced programmer, but I cannot justify the use of function pointer over direct call. Scenarios where I unable to find the differences are -</p>\n\n<p>1) <strong>callbacks</strong> - same can be achieved by direct call.</p>\n\n<p>2) <strong>Asynchronous</strong> or synchronous event handling - anyway event has to be identified, based on which element no. in function pointer array got updated. But the same can be also done via direct call.</p>\n\n<p>3) In some post I had seen people commenting it is to be used when it is <strong>not known which function to call.</strong> I didn't get any proper justification for this.</p>\n\n<p>I really appreciate if someone can explain me using above scenarios with practical and really simple realistic example.</p>\n"}, {"tags": ["c++", "winapi", "mfc"], "comments": [{"owner": {"reputation": 21, "user_id": 9870971, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007167135983749/picture?type=large", "display_name": "Geof", "link": "https://stackoverflow.com/users/9870971/geof"}, "edited": false, "score": 0, "creation_date": 1527697745, "post_id": 50608812, "comment_id": 88228744, "body": "Perfect! Thanks."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "is_accepted": false, "score": 5, "last_activity_date": 1527695996, "last_edit_date": 1527695996, "creation_date": 1527695514, "answer_id": 50608916, "question_id": 50608812, "link": "https://stackoverflow.com/questions/50608812/getting-properties-of-a-running-program/50608916#50608916", "title": "Getting Properties of a Running Program", "body": "<p>As you are inside an MFC window class, you are calling the <code>CWnd::GetWindowRect</code> function - you want to call the one in the Win32 API, so:</p>\n\n<pre><code>::GetWindowRect(hwnd, &amp;rect);\n</code></pre>\n\n<p>where the <code>::</code> scope resolution operator (without a namespace or class name on the left-hand side) says to call the function in the global scope.</p>\n"}], "owner": {"reputation": 21, "user_id": 9870971, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007167135983749/picture?type=large", "display_name": "Geof", "link": "https://stackoverflow.com/users/9870971/geof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527698268, "creation_date": 1527695090, "last_edit_date": 1527698268, "question_id": 50608812, "link": "https://stackoverflow.com/questions/50608812/getting-properties-of-a-running-program", "title": "Getting Properties of a Running Program", "body": "<p>I would like to develop a program which ID's a card as it is played in another running program such as a poker or hearts game or whatever. I'm starting by trying to get the information I need on that game program which is already running, and I'm having problems right from the start. I'm running MSVC++ 2013 and developing an MFC application. Right now I'm playing with the Hearts game and here's the code:</p>\n\n<pre><code>HWND hwnd =  FindWindowA(NULL, \"Hearts\");\nif (hwnd == NULL)\n    {  /* window not found*/\n    }\nelse\n    {  /* window was found */\n    RECT rect;\n    GetWindowRect(hwnd, &amp;rect);\n    int width = rect.right - rect.left;\n    int height = rect.bottom - rect.top;\n    }\n</code></pre>\n\n<p>So I get hwnd just fine and the code works depending on whether I have Hearts open or not. But the line <code>GetWindowRect(hwnd, &amp;rect);</code> won't compile saying </p>\n\n<blockquote>\n  <p>\"error C2660: 'CWnd::GetWindowRect' : function does not take 2 arguments\". </p>\n</blockquote>\n\n<p>There is a <code>GetWindowRect</code> function which only has the rect argument, but gets the properties of the program window I'm working on. There is lot's of documentation on <code>GetWindowRect</code> which shows the two arguments as above, but how do I invoke that subroutine?</p>\n"}, {"tags": ["c++", "algorithm", "matrix"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1527694299, "post_id": 50608515, "comment_id": 88226741, "body": "For any given dimension or for a fixed dimension?"}, {"owner": {"reputation": 15, "user_id": 9850735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec7c54980e29182a09a5c9d75989750?s=128&d=identicon&r=PG&f=1", "display_name": "johnydr", "link": "https://stackoverflow.com/users/9850735/johnydr"}, "edited": false, "score": 0, "creation_date": 1527694417, "post_id": 50608515, "comment_id": 88226822, "body": "For any given dimension"}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1527694635, "post_id": 50608515, "comment_id": 88226962, "body": "no need to make submatrixes, just use original matriz reference + x1, x2, y1, y2 indexes to know your submatrix bounds"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1527694640, "post_id": 50608515, "comment_id": 88226963, "body": "independent of what you want to do with the submatrices you never need to store them explicitly. All you need is the appropriate transformation from indices into the submatrix to indices into the original matrix"}, {"owner": {"reputation": 15, "user_id": 9850735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec7c54980e29182a09a5c9d75989750?s=128&d=identicon&r=PG&f=1", "display_name": "johnydr", "link": "https://stackoverflow.com/users/9850735/johnydr"}, "edited": false, "score": 0, "creation_date": 1527694932, "post_id": 50608515, "comment_id": 88227144, "body": "And what about recursion, can it be used in that process?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9850735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec7c54980e29182a09a5c9d75989750?s=128&d=identicon&r=PG&f=1", "display_name": "johnydr", "link": "https://stackoverflow.com/users/9850735/johnydr"}, "edited": false, "score": 0, "creation_date": 1527695286, "post_id": 50608838, "comment_id": 88227367, "body": "Thanks about suggesting that approach!"}, {"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "reply_to_user": {"reputation": 15, "user_id": 9850735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec7c54980e29182a09a5c9d75989750?s=128&d=identicon&r=PG&f=1", "display_name": "johnydr", "link": "https://stackoverflow.com/users/9850735/johnydr"}, "edited": false, "score": 1, "creation_date": 1527696537, "post_id": 50608838, "comment_id": 88228100, "body": "@johnydr You&#39;re welcome.  It isn&#39;t the fastest approach, according to <a href=\"https://math.stackexchange.com/questions/93501/what-is-the-fastest-numeric-method-for-determinant-calculation\" title=\"what is the fastest numeric method for determinant calculation\">math.stackexchange.com/questions/93501/&hellip;</a> that would be to calculate the LU decomposition.  However it is <code>O(n^3)</code> and doesn&#39;t require a ton of background to understand."}], "tags": [], "owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "is_accepted": true, "score": 4, "last_activity_date": 1527695199, "creation_date": 1527695199, "answer_id": 50608838, "question_id": 50608515, "link": "https://stackoverflow.com/questions/50608515/calculating-determinant-of-matrix-in-c-without-creating-submatrices/50608838#50608838", "title": "Calculating determinant of Matrix in C++ without creating submatrices", "body": "<p>If you're trying to calculate a determinant for any matrix of size larger than 3x3 using Cramer's Rule, you're certainly doing something wrong.  Performance will be terrible.</p>\n\n<p>Probably the easiest approach for you to think your way through is to use row reduction to make it into an upper triangular matrix.  Finding the determinant of an upper triangular matrix is easy - just multiply down the diagonal.  As for the rest, just multiply by the constant factors that you used and remember that every swap is a -1.</p>\n"}], "owner": {"reputation": 15, "user_id": 9850735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec7c54980e29182a09a5c9d75989750?s=128&d=identicon&r=PG&f=1", "display_name": "johnydr", "link": "https://stackoverflow.com/users/9850735/johnydr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 50608838, "answer_count": 1, "score": 1, "last_activity_date": 1527696614, "creation_date": 1527694265, "question_id": 50608515, "link": "https://stackoverflow.com/questions/50608515/calculating-determinant-of-matrix-in-c-without-creating-submatrices", "title": "Calculating determinant of Matrix in C++ without creating submatrices", "body": "<p>Is there a way to determine determinant of given matrix in C++ using only one variable (first loaded matrix) and in next recursion functions using only a reference for that matrix?</p>\n\n<p>How to use coordinates of elements in matrix to determine determinants of submatrices of given matrix without creating them as matrices, just using elements in first matrix and their coordinates? Can that be done using recursion or recursion should not be used?</p>\n"}, {"tags": ["c++", "string", "dictionary"], "comments": [{"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1527694084, "post_id": 50608392, "comment_id": 88226623, "body": "Before you complain about &quot;overhead&quot;, <i>test it</i>, and <i>benchmark it</i>, and <i>profile it</i>. And no you can&#39;t really use pointers of any kind as the key, as then it will be the <i>pointer</i> that is the key and not what it points to."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 1, "creation_date": 1527694176, "post_id": 50608392, "comment_id": 88226672, "body": "That is not going to work as the default specializations for <code>std::hash</code> and <code>std::equal_to</code> will fail to behave like you&#39;d expect."}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1527695066, "post_id": 50608392, "comment_id": 88227228, "body": "How long are the key strings? How many different ones do you expect? Are the keys variable or a fixed set? What is the lifetime of the keys?"}, {"owner": {"reputation": 67, "user_id": 4362507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f37a313a0cb56fb2dd244b7c29ad254?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/4362507/nik"}, "edited": false, "score": 1, "creation_date": 1527695975, "post_id": 50608392, "comment_id": 88227759, "body": "with string key finding element take 70 nanoseconds, but with long long key it take 20 nanoseconds.  With const char* I&#39;m expecting result close to long long. Any way with std::string memory allocation may occur that unacceptable."}], "answers": [{"comments": [{"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1527694356, "post_id": 50608442, "comment_id": 88226781, "body": "And if you don&#39;t have C++17 you can use <a href=\"https://abseil.io/docs/cpp/guides/strings\" rel=\"nofollow noreferrer\"><code>absl::string_view</code></a> (in fact you can use it in both cases, since it will be <code>typedef</code>&#39;d to <code>std::string_view</code> if it exists)."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 1, "creation_date": 1527694408, "post_id": 50608442, "comment_id": 88226813, "body": "@jdehesa Or <a href=\"https://www.boost.org/doc/libs/1_67_0/boost/utility/string_view.hpp\" rel=\"nofollow noreferrer\"><code>boost::string_view</code></a> :)"}, {"owner": {"reputation": 67, "user_id": 4362507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f37a313a0cb56fb2dd244b7c29ad254?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/4362507/nik"}, "edited": false, "score": 1, "creation_date": 1527694516, "post_id": 50608442, "comment_id": 88226895, "body": "std::string_view may be good feature but unfortunately it&#39;s will come in new standard and not present in my compiler vc++12  now(("}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 1, "creation_date": 1527694900, "post_id": 50608442, "comment_id": 88227135, "body": "Upgrade to vc15 or vc17. You&#39;ll be glad you did. Seriously."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 67, "user_id": 4362507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f37a313a0cb56fb2dd244b7c29ad254?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/4362507/nik"}, "edited": false, "score": 1, "creation_date": 1527695608, "post_id": 50608442, "comment_id": 88227560, "body": "@nik As others have said, there&#39;s <code>boost::string_view</code> then."}, {"owner": {"reputation": 67, "user_id": 4362507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f37a313a0cb56fb2dd244b7c29ad254?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/4362507/nik"}, "edited": false, "score": 0, "creation_date": 1527696257, "post_id": 50608442, "comment_id": 88227927, "body": "--Upgrade to vc15 or vc17. I can&#39;t do that because vc14 is the latest version  ))"}, {"owner": {"reputation": 64049, "user_id": 2015579, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28571d6df35321850e78b1ebfd48e5b4?s=128&d=identicon&r=PG", "display_name": "Richard Hodges", "link": "https://stackoverflow.com/users/2015579/richard-hodges"}, "edited": false, "score": 2, "creation_date": 1527697433, "post_id": 50608442, "comment_id": 88228590, "body": "This is brilliant, and faintly terrifying. Think of the abuse and subsequent UB we&#39;ll get in sane-looking programs :/"}], "tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": false, "score": 9, "last_activity_date": 1565252701, "last_edit_date": 1565252701, "creation_date": 1527694079, "answer_id": 50608442, "question_id": 50608392, "link": "https://stackoverflow.com/questions/50608392/using-const-char-as-key-for-map-unordered-map/50608442#50608442", "title": "Using const char* as key for map/unordered_map", "body": "<p>You can use a <a href=\"https://en.cppreference.com/w/cpp/string/basic_string_view\" rel=\"nofollow noreferrer\"><code>std::string_view</code></a>:</p>\n\n<pre><code>std::map&lt;std::string_view, int&gt; Map;\nMap[\"abc\"] = 1; // no allocation necessary to store \"abc\"\n</code></pre>\n\n<p>It is basically a wrapper around string objects. And it's a view, which means that it doesn't own the string and thus doesn't copy and allocate memory to store a string.</p>\n\n<p>Note that for small strings (and also literals), <code>std::string</code> doesn't allocate too due to <a href=\"https://stackoverflow.com/a/10319672/2477364\">SSO</a> and so the overhead is minimal. Always measure before optimizing.</p>\n"}, {"tags": [], "owner": {"reputation": 1471, "user_id": 3655463, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c567c095653589d1b50f37aeb72dbab1?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz Wojtczak", "link": "https://stackoverflow.com/users/3655463/mateusz-wojtczak"}, "is_accepted": false, "score": 0, "last_activity_date": 1527694686, "creation_date": 1527694686, "answer_id": 50608666, "question_id": 50608392, "link": "https://stackoverflow.com/questions/50608392/using-const-char-as-key-for-map-unordered-map/50608666#50608666", "title": "Using const char* as key for map/unordered_map", "body": "<p>If you will use pointer as map keys it will compare keys based on pointer addresses, the same keys will be treated as different. So you will have to create your own comparison function when dealing with plain pointers, so you will better use some wrapper on plain pointers like other answer suggested.</p>\n"}, {"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 5, "last_activity_date": 1527694749, "creation_date": 1527694749, "answer_id": 50608687, "question_id": 50608392, "link": "https://stackoverflow.com/questions/50608392/using-const-char-as-key-for-map-unordered-map/50608687#50608687", "title": "Using const char* as key for map/unordered_map", "body": "<p>As an alternative to <a href=\"https://stackoverflow.com/a/50608442/1782465\">Rakete1111's <code>string_view</code> answer</a>, you can equip your map with a suitable comparator (and hasher, for the <code>unordered_map</code>):</p>\n\n<pre><code>struct LesserString\n{\n  bool operator() (const char *lhs, const char *rhs) const\n  {\n    return std::strcmp(lhs, rhs) &lt; 0;\n  }\n};\n\nstruct HashString\n{\n  std::size_t operator() (const char *arg) const\n  {\n    return however_you_want_to_hash_the_string();\n  }\n};\n\nstruct EqualString\n{\n  bool operator() (const char *lhs, const char *rhs) const\n  {\n    return !strcmp(lhs, rhs);\n  }\n};\n\nstd::map&lt;const char*, WhateverValue, LesserString&gt; m1;\nstd::unorderd_map&lt;const char*, WhateverValue, HashString, EqualString&gt; m2;\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4362507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f37a313a0cb56fb2dd244b7c29ad254?s=128&d=identicon&r=PG&f=1", "display_name": "nik", "link": "https://stackoverflow.com/users/4362507/nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2053, "favorite_count": 3, "answer_count": 3, "score": 4, "last_activity_date": 1565252701, "creation_date": 1527693911, "last_edit_date": 1527697847, "question_id": 50608392, "link": "https://stackoverflow.com/questions/50608392/using-const-char-as-key-for-map-unordered-map", "title": "Using const char* as key for map/unordered_map", "body": "<p>How to create map/unordered_map that will use <code>const char*</code> as key directly?</p>\n\n<p>If I use <code>map&lt;std::string,..&gt;</code>, then on each resolving <code>map[\"abc\"] = ...</code> a new <code>std::string</code> object will be created. That causes a big overhead for allocating memory, creating a string object and copying the string into it.  </p>\n\n<p>How do I declare a map object that uses <code>const char*</code> directly without any overhead?</p>\n"}, {"tags": ["c++", "linux", "sockets", "udp", "broadcast"], "answers": [{"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 1, "last_activity_date": 1527694483, "creation_date": 1527694483, "answer_id": 50608578, "question_id": 50608327, "link": "https://stackoverflow.com/questions/50608327/c-udp-broadcast-using-write/50608578#50608578", "title": "C++ UDP Broadcast using ::write", "body": "<p>The problem with using connect() for broadcast is that (in addition to modifying the behavior of send()/write()), connect() will install a filter on the socket so that it only receives packets whose source-IP field matches the IP address specified in the argument to connect().</p>\n\n<p>That means if you call connect() on your socket with a broadcast-address as its argument, then your socket will only receive packets coming from that broadcast-address -- but packets are never (AFAIK) tagged as coming from a broadcast address -- rather, their Source-IP field is set to the IP address of the computer that sent the packet, as usual.  The upshot is that if you connect() your socket to a broadcast address, you won't receive any packets on that socket.</p>\n"}], "owner": {"reputation": 511, "user_id": 4193196, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fb2dd419dd67186d66002b90f6b130ed?s=128&d=identicon&r=PG&f=1", "display_name": "user12066", "link": "https://stackoverflow.com/users/4193196/user12066"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527694483, "creation_date": 1527693651, "question_id": 50608327, "link": "https://stackoverflow.com/questions/50608327/c-udp-broadcast-using-write", "title": "C++ UDP Broadcast using ::write", "body": "<p>I am writing a UDP client/server application. The server is a broadcast server, that broadcasts on a particular port to two clients on the same subnet. Each client receives a datagram and sends a response to the server. Each client knows the ip address of the server in advance.</p>\n\n<p>My client is basically as in the client example of <a href=\"http://man7.org/linux/man-pages/man3/getaddrinfo.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/getaddrinfo.3.html</a>, i.e. it uses the connect() function to specify the endpoint of all outgoing packets. By using connected UDP, the client can use read() and write() to the socket file descriptor rather than sendto/recvfrom.</p>\n\n<p>For my server, I want to adopt a similar approach - configure the socket for broadcasting, and call read/write on the file descriptor. I can bind() the socket to listen for incoming datagrams on the specified port, and these are collected fine.</p>\n\n<p>Minus error checking, my server code looks like this:</p>\n\n<pre><code>int sockfd = socket(AF_INET, SOCK_DGRAM, 0);\n\nint broadcast = 1;\nsetsockopt(sockfd, SOL_SOCKET, SO_BROADCAST, &amp;broadcast, sizeof int);\n\nstruct sockaddr_in servaddr;\nmemset((char*) &amp;servaddr, 0, sizeof servaddr);\nservaddr.sin_family = AF_INET;\nservaddr.sin_port   = htons(PORT);\nservaddr.sin_addr.s_addr = htonl(INADDR_ANY);\n\nint success = bind(sockfd, (struct sockaddr*) &amp;servaddr, sizeof servaddr);\n\nint BUFSIZE = 256;\nchar buf[BUFSIZE];\n\nwhile (1)\n{\n    // this works fine\n    int bytes_read = read(sockfd, buf, BUFSIZE);\n\n    // WANT TO BROADCAST HERE\n    int bytes_written = write(sockfd, buf, bytes_read); \n}\n</code></pre>\n\n<p>However, when I try and broadcast a packet in the write() line, I get a 'Destination address not specified' error. I could call connect() to set the destination address, but I don't think connect() works on a broadcast socket.</p>\n\n<p>Is there a way of broadcasting using write() rather than sendto? </p>\n"}, {"tags": ["c++", "c", "post-increment", "pre-increment"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527693807, "post_id": 50608320, "comment_id": 88226442, "body": "You are right.."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1527693815, "post_id": 50608320, "comment_id": 88226446, "body": "You are correct. The explaining code is not equivalent to the code above it. Indeed, <code>pattern ++;</code> first uses the variable (assigns it) and then increments it."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527693904, "post_id": 50608320, "comment_id": 88226511, "body": "You might benefit from throwing that book away.  <a href=\"https://stackoverflow.com/questions/388242/\">We have a carefully curated list of suggestions</a>."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "edited": false, "score": 0, "creation_date": 1527693925, "post_id": 50608320, "comment_id": 88226525, "body": "Ok, thanks. It&#39;s very weird, because I already discovered some other faults in this book, while it had a really good rating."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694036, "post_id": 50608320, "comment_id": 88226585, "body": "Don&#39;t believe the ratings... I guess. Believe the experts recommendations."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527694056, "post_id": 50608320, "comment_id": 88226602, "body": "@Drew Dormann One has to say, that the book isn&#39;t about c++ itsself, it&#39;s about arduino. However, I&#39;m a bit dissapointed."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694078, "post_id": 50608320, "comment_id": 88226615, "body": "Explains a lot. :)"}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527694246, "post_id": 50608320, "comment_id": 88226716, "body": "@DrewDormann Just out of curiosity, do you have such a list of books in other languages, too? (german)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694358, "post_id": 50608320, "comment_id": 88226783, "body": "@SomeWindowsUser My lecturer (one of the best in one of the leading institutions) in computer science back few decades ago was pretty strict about it: Never learn C or C++ by any books written not in English or even translated. Perhaps it was changed since then..."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694462, "post_id": 50608320, "comment_id": 88226859, "body": "@EugeneSh. But I don&#39;t think there are no good books in other languages, I just think they are harder to find/pretty rare."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1527695244, "post_id": 50608320, "comment_id": 88227337, "body": "Start <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">here</a> and see if there are any translations available."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527698557, "post_id": 50608320, "comment_id": 88229170, "body": "This illustrates why expressions with side-effects is not a good idea."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527711674, "post_id": 50608320, "comment_id": 88235513, "body": "@AugustKarlstrom Sorry, what do you mean with &quot;expressions with side-effects&quot;? Do you mean that there is a problem if a book covers 2 different topics, or did I get this wrong?"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527712811, "post_id": 50608320, "comment_id": 88235970, "body": "@SomeWindowsUser To be precise, I mean sub-expressions with side-effects. An expression with a side-effect changes the state of the computation, for instance by assigning a new value to a variable. Such expressions are hard to read and can lead to undefined behavior. That&#39;s why most programming languages don&#39;t provide such constructs."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527713236, "post_id": 50608320, "comment_id": 88236104, "body": "@AugustKarlstrom Ok, I think I get it now, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "is_accepted": true, "score": 6, "last_activity_date": 1527693831, "creation_date": 1527693831, "answer_id": 50608369, "question_id": 50608320, "link": "https://stackoverflow.com/questions/50608320/assigning-an-incremented-variable/50608369#50608369", "title": "Assigning an incremented variable", "body": "<p>you are right</p>\n\n<pre><code>PORTB = pattern++;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>PORTB = pattern;\npattern = pattern + 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "is_accepted": false, "score": 2, "last_activity_date": 1527695811, "last_edit_date": 1527695811, "creation_date": 1527694513, "answer_id": 50608593, "question_id": 50608320, "link": "https://stackoverflow.com/questions/50608320/assigning-an-incremented-variable/50608593#50608593", "title": "Assigning an incremented variable", "body": "<p>Prefix form <code>[--,++]a</code> do action (increment or decrement), and then use the result</p>\n\n<p>For example:</p>\n\n<pre><code>  int a[] = {0,1,2};\n  int i = -1;\n  std::cout&lt;&lt; a[++i] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[++i] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[++i] &lt;&lt; std::endl;\n</code></pre>\n\n<p>Equivalent form  </p>\n\n<pre><code> int a[] = {0,1,2}; \n int i = -1;\n for(int j =0; j &lt; 3; j = j + 1) {\n  i = i + 1; // action first\n  std::cout&lt;&lt; a[i] &lt;&lt; ' ';\n }\n std::cout&lt;&lt; std::endl; \n</code></pre>\n\n<p>Postfix form <code>a[++,--]</code> use value as it is, then increment or decrement variable</p>\n\n<p>For example:</p>\n\n<pre><code>  int a[] = {0,1,2};\n  int i = 0;\n  std::cout&lt;&lt; a[i++] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[i++] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[i] &lt;&lt; std::endl;\n</code></pre>\n\n<p>Equivalent form  </p>\n\n<pre><code> int a[] = {0,1,2}; \n int i = 0;\n for(int j =0; j &lt; 3; j = j + 1) {\n  std::cout&lt;&lt; a[i] &lt;&lt; ' ';\n  i = i + 1; // action after\n }\n std::cout&lt;&lt; std::endl; \n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 50608369, "answer_count": 2, "score": 1, "last_activity_date": 1528146258, "creation_date": 1527693624, "last_edit_date": 1528146258, "question_id": 50608320, "link": "https://stackoverflow.com/questions/50608320/assigning-an-incremented-variable", "title": "Assigning an incremented variable", "body": "<pre><code>PORTB = pattern ++;\n//The author explains te upper code with the code below\npattern = pattern + 1;\nPORTB = pattern;\n\nPORTB = ++ pattern; //That's what I think is right\n</code></pre>\n\n<p>I think this code is wrong, as the post-increment should add 1, after using it in the statement, so for the code below, there has to be an pre-increment e. But as I am not that familiar with c/c++ (only read one book), I wanted to know whether I'm messing something up, or the author is just wrong.</p>\n\n<p>Edit: The Book is not about c/c++, it's about arduino.</p>\n"}, {"tags": ["c++", "getline", "palindrome", "stdstring"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1527701241, "post_id": 50608297, "comment_id": 88230584, "body": "You seem to be missing some headers and misspelling some types (assuming that <code>string</code> is supposed to be <code>std::string</code> and <code>tolower</code> should be <code>std::tolower</code>, etc.)"}, {"owner": {"reputation": 23, "user_id": 8774890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10029838cf15251d056614b2d1b25046?s=128&d=identicon&r=PG&f=1", "display_name": "YASH ANAND 15BEC0780", "link": "https://stackoverflow.com/users/8774890/yash-anand-15bec0780"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1527701388, "post_id": 50608297, "comment_id": 88230681, "body": "I used using namespace std so there is no use of std::"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1527701467, "post_id": 50608297, "comment_id": 88230733, "body": "You really ought to avoid <code>using namespace std</code> - it is a bad habit to get into, and <a href=\"/q/1452721\">can silently change the meaning of your program</a> when you&#39;re not expecting it.  Get used to using the namespace prefix (<code>std</code> is intentionally very short), or importing <i>just the names you need</i> into the <i>smallest reasonable scope</i>."}, {"owner": {"reputation": 23, "user_id": 8774890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10029838cf15251d056614b2d1b25046?s=128&d=identicon&r=PG&f=1", "display_name": "YASH ANAND 15BEC0780", "link": "https://stackoverflow.com/users/8774890/yash-anand-15bec0780"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1527701648, "post_id": 50608297, "comment_id": 88230846, "body": "It did nor gave me any problem till now and I already got the solution of my problem mentioned below. Seems like std was not an issue here."}], "answers": [{"tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": true, "score": 1, "last_activity_date": 1527697577, "last_edit_date": 1527697577, "creation_date": 1527696625, "answer_id": 50609236, "question_id": 50608297, "link": "https://stackoverflow.com/questions/50608297/output-befor-giving-the-input-of-string-for-finding-palindrome/50609236#50609236", "title": "Output Befor giving the input of string for finding palindrome", "body": "<blockquote>\n  <p>This code is giving output YES just after entering the value of test\n  case. Output I am getting is YES without giving any input of string</p>\n</blockquote>\n\n<p>Your problem is here:</p>\n\n<pre><code>/* code */\n    cin&gt;&gt;t;    -----------&gt; std::cin        \n    while(t--)\n    {\n        string s;\n        int count = 0,size = 0;\n        getline(cin,s); ------------&gt; std::getline()\n\n/* remaining code */\n</code></pre>\n\n<p>Reading with something like <code>std::cin</code> leaves the newline in the input stream. When the flow of control reaches <code>std::getline()</code>, the newline will be discarded, but the input will cease immediately. This leads, <code>std::getline()</code>s attempt read a new line and skips the input.</p>\n\n<p><strong>FIX</strong>: When switching from white space delimited to newline delimited input, you want to clean all newlines from the input stream by doing a <code>std::cin.ignore()</code></p>\n\n<p>The fixed code should be: <a href=\"https://www.ideone.com/ucDa7i#stdin\" rel=\"nofollow noreferrer\">https://www.ideone.com/ucDa7i#stdin</a></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;limits&gt;\n#include &lt;algorithm&gt;\n\nint main()\n{\n    int t;\n    std::cin &gt;&gt; t;\n    // fix\n    std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n\n    while(t--)\n    {\n        std::string s;\n        int count = 0,size = 0;\n        getline(std::cin,s);\n        /* remaining code */\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8774890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10029838cf15251d056614b2d1b25046?s=128&d=identicon&r=PG&f=1", "display_name": "YASH ANAND 15BEC0780", "link": "https://stackoverflow.com/users/8774890/yash-anand-15bec0780"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50609236, "answer_count": 1, "score": 1, "last_activity_date": 1527701526, "creation_date": 1527693546, "last_edit_date": 1527701526, "question_id": 50608297, "link": "https://stackoverflow.com/questions/50608297/output-befor-giving-the-input-of-string-for-finding-palindrome", "title": "Output Befor giving the input of string for finding palindrome", "body": "<p>This code is giving output YES just after entering the value of test case.\nCode: for alphanumeric pallindrome</p>\n\n<pre><code>int main() {\n    int t;\n    cin&gt;&gt;t;\n    while(t--){\n        string s;\n        int count = 0,size = 0;\n        getline(cin,s);\n        cout&lt;&lt;s&lt;&lt;endl;\n        s.erase(remove_if(s.begin(),s.end(),not1(ptr_fun((int(*)(int))isalnum))), s.end());\n        for(int i=0;i&lt;=s.size()/2;i++){\n            size++;\n            if(tolower(s[i])==tolower(s[s.size()-i-1])){\n                count++;\n            }\n            else\n                break;\n        }\n        if (count==size)\n            cout&lt;&lt;\"YES\"&lt;&lt;endl;\n        else\n            cout&lt;&lt;\"NO\"&lt;&lt;endl;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output I am getting is YES without giving any input of string</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>For Input:\n2\nI am :IronnorI Ma, i\nAb?/Ba\nYour Output is:\n\nYES\nI am :IronnorI Ma, i\nYES\n</code></pre>\n"}, {"tags": ["c++", "memory-management", "boost", "shared-memory", "boost-interprocess"], "comments": [{"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527697618, "post_id": 50608281, "comment_id": 88228677, "body": "&quot;Is there a log to check whether permissions were changed prior to the segmentation fault?&quot; - what gives you the idea it should be a permissions problem? Does it make sense for <code>lock()</code> to segfault in such cases?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527697654, "post_id": 50608281, "comment_id": 88228700, "body": "I&#39;d run this under valgrind or with <code>-fsanitize=address,undefined</code>"}, {"owner": {"reputation": 13335, "user_id": 1107474, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ed1a5311fa24392fb6c5f90f680c8dd?s=128&d=identicon&r=PG", "display_name": "mezamorphic", "link": "https://stackoverflow.com/users/1107474/mezamorphic"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527697791, "post_id": 50608281, "comment_id": 88228769, "body": "@sehe hi (again). I&#39;m limited how I can run it because the application is a module within a third party framework. I figured the only things which would cause seg faults are permissions or the named_mutex being deleted earlier. Is there anything else that could explain a seg fault?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527697824, "post_id": 50608281, "comment_id": 88228784, "body": "ASAN and UBSAN can be preloaded (<code>LD_LIBRARY_PRELOAD</code>). Usually seg faults are caused by corruption or undefined behaviour."}, {"owner": {"reputation": 13335, "user_id": 1107474, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ed1a5311fa24392fb6c5f90f680c8dd?s=128&d=identicon&r=PG", "display_name": "mezamorphic", "link": "https://stackoverflow.com/users/1107474/mezamorphic"}, "reply_to_user": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527697992, "post_id": 50608281, "comment_id": 88228878, "body": "@sehe Given my previous message (and the fact I am compiling with clang), is there any way to still use a memory sanitizer?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "edited": false, "score": 0, "creation_date": 1527698102, "post_id": 50608281, "comment_id": 88228929, "body": "^ see my comment. Also in the <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizer\" rel=\"nofollow noreferrer\">FAQ: &quot;Q: I&#39;ve built my shared library with ASan. Can I run it with unsanitized executable?&quot;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13335, "user_id": 1107474, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ed1a5311fa24392fb6c5f90f680c8dd?s=128&d=identicon&r=PG", "display_name": "mezamorphic", "link": "https://stackoverflow.com/users/1107474/mezamorphic"}, "edited": false, "score": 0, "creation_date": 1527698808, "post_id": 50609653, "comment_id": 88229297, "body": "How can one synchronise destroying the named_mutex, you would need to do this within..... a mutex, surely?"}, {"owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "reply_to_user": {"reputation": 13335, "user_id": 1107474, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ed1a5311fa24392fb6c5f90f680c8dd?s=128&d=identicon&r=PG", "display_name": "mezamorphic", "link": "https://stackoverflow.com/users/1107474/mezamorphic"}, "edited": false, "score": 0, "creation_date": 1527698895, "post_id": 50609653, "comment_id": 88229346, "body": "I wasn&#39;t talking about that. Interesting as that might be it&#39;s a different question (and currently unrelated), and possibly one thats been asked before?"}, {"owner": {"reputation": 13335, "user_id": 1107474, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ed1a5311fa24392fb6c5f90f680c8dd?s=128&d=identicon&r=PG", "display_name": "mezamorphic", "link": "https://stackoverflow.com/users/1107474/mezamorphic"}, "edited": false, "score": 0, "creation_date": 1527787682, "post_id": 50609653, "comment_id": 88269398, "body": "It is memory corruption. I put a char[1000] before and after the mutex and I can see something else in my application is writing either side of the mutex. Other than doing some dodgy raw memory access, or array overload, the runtime system must be aware that I have allocated the shared memory like I have? Just worried it&#39;s my implementation of the shared memory (there&#39;s no reader process, just the writer)"}], "tags": [], "owner": {"reputation": 326119, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": false, "score": 0, "last_activity_date": 1527698195, "creation_date": 1527698195, "answer_id": 50609653, "question_id": 50608281, "link": "https://stackoverflow.com/questions/50608281/boost-interprocess-named-mutex-causing-segmentation-fault/50609653#50609653", "title": "Boost Interprocess named_mutex causing segmentation fault", "body": "<p>Why are you using all these separate named entities, when you could simply use unnamed interprocess synchronization primitives inside the shared memory segment? See e.g. <a href=\"https://stackoverflow.com/questions/50289336/boost-interprocess-share-memory-deletion-permissions-and-output-files/50289625#50289625\">Boost Interprocess share memory deletion, permissions and output files</a> (second example).</p>\n\n<p>That at once removes a race condition between retrieving all the shared objects and actually synchronizing on the primitives.</p>\n\n<hr>\n\n<p>The only thing I can reasonably see being outside the shared object is the <code>named_mutex</code> so you could <em>synchronize</em> the actual creation of the shared memory segment. However, looking at your code it looks like you fail to do precisely that:</p>\n\n<pre><code>    segment.reset(new bip::managed_shared_memory(bip::open_or_create, shared_memory_name.c_str(), numBytes, 0, perm));\n\n    mutex.reset(new bip::named_mutex(bip::open_or_create, shared_mutex_name.c_str(), perm));\n</code></pre>\n\n<p>The mutex is created <em>after</em> the segment. Now, this may not be a problem when you control the order in which server and clients start. However, in such a case there clearly is no need for the separate named-mutex to exist.</p>\n\n<hr>\n\n<p>It's also worrying that you destroy the memory without any synchronization:</p>\n\n<pre><code>destroyMemory(tag);\n</code></pre>\n"}], "owner": {"reputation": 13335, "user_id": 1107474, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1ed1a5311fa24392fb6c5f90f680c8dd?s=128&d=identicon&r=PG", "display_name": "mezamorphic", "link": "https://stackoverflow.com/users/1107474/mezamorphic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527698195, "creation_date": 1527693500, "question_id": 50608281, "link": "https://stackoverflow.com/questions/50608281/boost-interprocess-named-mutex-causing-segmentation-fault", "title": "Boost Interprocess named_mutex causing segmentation fault", "body": "<p>I'm using boost interprocess to share memory but very rarely getting a segmentation fault when I try to take a boost::interprocess:named_mutex using boost::interprocess::scoped_lock. </p>\n\n<p>I am only running the writer process. This process owns the shared memory and does not destroy it (unless the application is closing down). The application creates the shared memory using SharedDataCommon class (see bottom of question) which encpsulates all the boost inner workings and then later on I call write(), which tries to retrieves the named_mutex but it seg faults.</p>\n\n<p>The segmentation fault occurs within </p>\n\n<blockquote>\n  <p>boost/interprocess/sync/posix/named_semaphore.hpp</p>\n</blockquote>\n\n<p>line 63:</p>\n\n<pre><code>void wait()\n   {  semaphore_wait(mp_sem); }     // seg faults here\n</code></pre>\n\n<p>It's as if someone changes the permissions to the semaphore whilst the application is running, except they didn't. Is there a log to check whether permissions were changed prior to the segmentation fault?</p>\n\n<p>The segmentation fault is occurring when taking the scoped lock prior to a write:</p>\n\n<pre><code>bool write(const std::vector&lt;T&gt;&amp; vec, const bool clearFirst = false)\n{\n    bip::scoped_lock&lt;bip::named_mutex&gt; lock(*sdc.mutex);   // seg faults here\n\n    try\n    {\n        sdc.vec-&gt;reserve(sdc.vec-&gt;size() + vec.size());\n    }\n    catch(std::exception&amp; e)\n    {\n        std::cout &lt;&lt; \"Not enough room to write elements\" &lt;&lt; std::endl;\n        return false;\n    }\n\n    if(clearFirst)\n    {\n        sdc.vec-&gt;clear();\n    }\n\n    for(const auto&amp; item : vec)\n    {\n        sdc.vec-&gt;push_back(item);\n    }\n\n    sdc.cond_empty-&gt;notify_all();\n\n    return true;\n} \n</code></pre>\n\n<p>sdc is an instance of SharedDataCommon (see below) encapsulating the boost::interprocess components.</p>\n\n<p>I set temporarily set umask so the shared memory is readable by multiple Linux users.</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct SharedDataCommon\n{\n    using ShmemAllocator = bip::allocator&lt;T, bip::managed_shared_memory::segment_manager&gt;;\n    using MyVector = bip::vector&lt;T, ShmemAllocator&gt;;\n\n    void initialise(const std::string&amp; tag, const int numBytes, const bool ownMemory)\n    {\n        const std::string sharedMemoryName = tag + \"_shared_memory\";\n        const std::string sharedVectorName = tag + \"_shared_vector\";\n        const std::string sharedMutexName = tag + \"_shared_mutex\";\n        const std::string sharedCVName = tag + \"_shared_cv\";\n\n        tag_name = tag;\n        shared_memory_name = sharedMemoryName;\n        shared_mutex_name = sharedMutexName;\n        shared_vector_name = sharedVectorName;\n        shared_cv_name = sharedCVName;\n        destroy_memory = ownMemory;\n\n        if(ownMemory)\n        {\n            destroyMemory(tag);\n        }\n\n        createMemory(numBytes);\n    }\n\n    void createMemory(const int numBytes)\n    {\n        const mode_t old_umask = umask(0);\n\n        bip::permissions perm;\n        perm.set_unrestricted();\n        segment.reset(new bip::managed_shared_memory(bip::open_or_create, shared_memory_name.c_str(), numBytes, 0, perm));\n\n        mutex.reset(new bip::named_mutex(bip::open_or_create, shared_mutex_name.c_str(), perm));\n\n        const ShmemAllocator alloc_inst(segment-&gt;get_segment_manager());\n        vec = segment-&gt;find_or_construct&lt;MyVector&gt;(shared_vector_name.c_str())(alloc_inst);\n\n        cond_empty.reset(new bip::named_condition(bip::open_or_create, shared_cv_name.c_str(), perm));\n\n        umask(old_umask);\n    }\n\n    static void destroyMemory(const std::string&amp; tag)\n    {\n        const std::string sharedMemoryName = tag + \"_shared_memory\";\n        const std::string sharedMutexName = tag + \"_shared_mutex\";\n        const std::string sharedCVName = tag + \"_shared_cv\";\n\n        bip::named_mutex::remove(sharedMutexName.c_str());\n        bip::named_condition::remove(sharedCVName.c_str());     \n        bip::shared_memory_object::remove(sharedMemoryName.c_str());\n    }\n\n    ~SharedDataCommon()\n    {\n        if(destroy_memory)\n        {\n            destroyMemory(tag_name);\n        }\n    }\n\n    std::shared_ptr&lt;bip::named_mutex&gt;           mutex{nullptr};\n    MyVector*                                   vec{nullptr};\n    std::shared_ptr&lt;bip::managed_shared_memory&gt; segment{nullptr};\n    std::shared_ptr&lt;bip::named_condition&gt;       cond_empty;\n    bool                                        destroy_memory{false};\n    std::string                                 shared_vector_name;\n    std::string                                 shared_mutex_name;\n    std::string                                 shared_cv_name;\n    std::string                                 shared_memory_name;\n    std::string                                 tag_name;\n};\n</code></pre>\n\n<p>I don't see anything which explains why the problem would occur some of the time?</p>\n"}, {"tags": ["c++", "pointers", "inheritance", "member"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1527695451, "post_id": 50608269, "comment_id": 88227471, "body": "It is recommended to use <code>std::unique_ptr</code> and <code>std::make_unique</code> in your case, instead of raw pointers and <code>new</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1527696904, "post_id": 50608269, "comment_id": 88228311, "body": "Your design is fine in general, though <code>Container</code> is missing a destructor to call <code>delete m_type;</code> (and should also disable the default copy constructor and copy assignment operator, since <code>m_type</code> should not be copied as-is). And yes, <code>~Base</code> needs to be <code>virtual</code>, so <code>delete m_type;</code> will work correctly, calling the destructor of whatever derived type you choose to instantiate."}, {"owner": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "edited": false, "score": 0, "creation_date": 1527748366, "post_id": 50608269, "comment_id": 88245718, "body": "Is the destructor called if the program is aborted by ctrl-c (ubuntu terminal)? Or do I have to call the destructor manually?"}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 1, "creation_date": 1527757320, "post_id": 50608269, "comment_id": 88250651, "body": "Regarding dynamic allocation being &#39;avoided whenever possible&#39;, this is true but if you want polymorphism in C++ then you <i>must</i> use pointers or references, so in cases like this (i.e. where a reference isn&#39;t suitable) you&#39;ll need to use dynamic allocation."}], "answers": [{"comments": [{"owner": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "edited": false, "score": 0, "creation_date": 1527748516, "post_id": 50608637, "comment_id": 88245791, "body": "So there is no possibility to avoid the use of &quot;new&quot; ? Is this a typical use case for &quot;new&quot; ?"}, {"owner": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "reply_to_user": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "edited": false, "score": 0, "creation_date": 1527751977, "post_id": 50608637, "comment_id": 88247612, "body": "new here is similar to new in Java. You can avoid new by not declaring Base class object as pointer. <code>Base m_type; m_type = Spec1(1)</code> You should avoid dynamic allocation as much as possible. <a href=\"https://stackoverflow.com/questions/22146094/why-should-i-use-a-pointer-rather-than-the-object-itself\" title=\"why should i use a pointer rather than the object itself\">stackoverflow.com/questions/22146094/&hellip;</a> is a good read"}, {"owner": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "edited": false, "score": 0, "creation_date": 1527757258, "post_id": 50608637, "comment_id": 88250599, "body": "That does not work for virtual class: <code>error: cannot declare field \u2018Container::m_type\u2019 to be of abstract type \u2018Base\u2019          Base m_type;</code>"}], "tags": [], "owner": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1527694623, "creation_date": 1527694623, "answer_id": 50608637, "question_id": 50608269, "link": "https://stackoverflow.com/questions/50608269/how-to-initialize-member-variable-with-super-class-type-depending-on-constructor/50608637#50608637", "title": "How to initialize member variable with super class type depending on constructor argument?", "body": "<p>Constructor works like any other function. Local variables are allocated in stack and get out of scope whenever the function completes whereas dynamic memory allocation is done in stack and needs to be explicitaly deallocated (in C++ and not in Java) before the function completes.</p>\n\n<p>However in your case  </p>\n\n<pre><code>m_type = new Spec1(1);\n</code></pre>\n\n<p><code>new Spec1(1)</code> is dynamically allocated in heap and won't get destroyed on completion of Constructor code. The reference is stored in the member variable of the class. So as long as the instance of class <code>Container</code> is in scope, the memory allocated to <code>Spec1(1)</code> can be referred.</p>\n\n<p>To compare just consider other scenario.</p>\n\n<pre><code>Container(String type_message){\n      Base* m_type;\n      if (type_message.compare(\"We need Spec1\")){\n          m_type = new Spec1(1);\n      } // add more ifs for other types (Spec2, Spec3 etc.)\n     }\n</code></pre>\n\n<p>Here as soon as constructor finishes, <code>m_type</code> will go out of scope but <code>new Spec1(1)</code> will still be there in heap as the memory leak.</p>\n"}, {"comments": [{"owner": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "edited": false, "score": 0, "creation_date": 1527757422, "post_id": 50609339, "comment_id": 88250716, "body": "Thanks for factory function, didnt know before. But actually I want to keep it short and simple, and I do other stuff in constructor before, so that would be all passed to createBase method."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "edited": false, "score": 1, "creation_date": 1527758998, "post_id": 50609339, "comment_id": 88251753, "body": "@Lucker10 <code>Container</code> and <code>Base</code> look like <a href=\"https://en.wikipedia.org/wiki/Strategy_pattern\" rel=\"nofollow noreferrer\">strategy design pattern</a>."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1527697011, "creation_date": 1527697011, "answer_id": 50609339, "question_id": 50608269, "link": "https://stackoverflow.com/questions/50608269/how-to-initialize-member-variable-with-super-class-type-depending-on-constructor/50609339#50609339", "title": "How to initialize member variable with super class type depending on constructor argument?", "body": "<p>Requiring <code>Container</code> to be aware of every possible derived class of <code>Base</code> does not sound like good design. That is what factory functions are for.</p>\n\n<p>Have <code>Container</code> store that object as <code>std::unique_ptr</code> to avoid memory leaks and manual memory management.</p>\n\n<pre><code>struct Base {\n    virtual ~Base() = default;\n    virtual void doSomething() = 0;\n};\n\nstruct Spec1 : Base {\n    void doSomething() override {\n        std::printf(\"%s\\n\", __PRETTY_FUNCTION__);\n    }\n};\n\n// Factory function.\nstd::unique_ptr&lt;Base&gt; createBase(std::string const&amp; type) {\n    if(type == \"Spec1\")\n        return std::unique_ptr&lt;Base&gt;(new Spec1);\n    throw std::runtime_error(\"Unknown type \" + type);\n}\n\nclass Container {\n    std::unique_ptr&lt;Base&gt; m_type;\npublic:\n    Container(std::string const&amp; type)\n        : m_type(createBase(type))\n    {}\n\n    void doSomething(){\n        m_type-&gt;doSomething();\n    }\n};\n\nint main() {\n    Container a (\"Spec1\");\n    a.doSomething();\n}\n</code></pre>\n"}], "owner": {"reputation": 392, "user_id": 4270676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c1ca0395b8a72d63ad5579755b8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Lucker10", "link": "https://stackoverflow.com/users/4270676/lucker10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527697011, "creation_date": 1527693467, "question_id": 50608269, "link": "https://stackoverflow.com/questions/50608269/how-to-initialize-member-variable-with-super-class-type-depending-on-constructor", "title": "How to initialize member variable with super class type depending on constructor argument?", "body": "<p>After searching for hours, I end up here. I have a Container class with a pointer to Base class as member variable. This should either refer to Spec1 or another inherited classes of Base, which I omitted here. The type should be determined by the argument in constructor (e.g. string, enum, int, etc.). </p>\n\n<p>I read much about dynamic memory allocation and why it should be avoided whenever possible. Is it possible to avoid here? Isnt any usual object destroyed after the constructor? Or is the design idea completely wrong? I come from Java :( Thanks in advance.</p>\n\n<pre><code>class Base{\n  public:\n    virtual ~Base(){}; // required?\n    virtual void doSomething() = 0;\n};\n\nclass Spec1 : public Base {\n     public:\n       Spec1(){};\n       Spec1(int i){\n         // whatever\n       }\n       void doSomething(){\n          std::printf(\"hello world\");\n       }\n};\n\nclass Container{\n   public:\n     Container(String type_message){\n      if (type_message.compare(\"We need Spec1\")){\n          m_type = new Spec1(1);\n      } // add more ifs for other types (Spec2, Spec3 etc.)\n     }\n     void doSomethingWithSpec(){\n        m_type-&gt;doSomething();\n     }\n   private:\n      Base* m_type;\n };\n\nint main (int argc, char **argv){\n    Container a (\"We need Spec1\");\n    a.doSomething();\n}\n</code></pre>\n"}, {"tags": ["c++", "mpi"], "answers": [{"comments": [{"owner": {"reputation": 834, "user_id": 9696715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3RrU1.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/9696715/ali"}, "edited": false, "score": 0, "creation_date": 1527771904, "post_id": 50619909, "comment_id": 88259988, "body": "Thank you for the response. I tested [top, bottom, left, right] order but still I do not have correct communication with neighbors. The thing that I do not understand is that why a specific order works for 2*2 process grid but not for [nx*ny : nx&gt;2 &amp; ny&gt;2]?"}, {"owner": {"reputation": 834, "user_id": 9696715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3RrU1.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/9696715/ali"}, "edited": false, "score": 0, "creation_date": 1557748296, "post_id": 50619909, "comment_id": 98856993, "body": "After about one year I returned to this question again. For the code that I posted, the correct orders are: <code>sendtypes[4] = {subar_bottom, subar_top, subar_left, subar_right};</code> and <code>recvtypes[4] = {ghost_bottom, ghost_top, ghost_left, ghost_right};</code>. I checked my code with <b>Intel MPI</b> and <b>Open MPI</b> and it works correctly."}], "tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": true, "score": 1, "last_activity_date": 1527755368, "creation_date": 1527755368, "answer_id": 50619909, "question_id": 50608184, "link": "https://stackoverflow.com/questions/50608184/what-is-the-correct-order-of-send-and-receive-in-mpi-neighbor-alltoallw/50619909#50619909", "title": "What is the correct order of send and receive in MPI_Neighbor_alltoallw()?", "body": "<p>From the MPI 3.1 standard chapter 7.6 page 314</p>\n\n<blockquote>\n  <p>For a Cartesian topology, created with MPI_CART_CREATE, the sequence of neighbors in the send and receive buffers at each process is defined by order of the dimensions, first the neighbor in the negative direction and then in the positive direction with displacement 1.</p>\n</blockquote>\n\n<p>I empirically found in the case of a 2D cartesian communicator, the sequence is :</p>\n\n<ul>\n<li>top</li>\n<li>bottom</li>\n<li>left</li>\n<li>right</li>\n</ul>\n\n<p>(I tested both Open MPI and MPICH, though I have some hard time understanding the logic here ...)</p>\n"}], "owner": {"reputation": 834, "user_id": 9696715, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3RrU1.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/9696715/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 50619909, "answer_count": 1, "score": 2, "last_activity_date": 1527856792, "creation_date": 1527693233, "last_edit_date": 1527856792, "question_id": 50608184, "link": "https://stackoverflow.com/questions/50608184/what-is-the-correct-order-of-send-and-receive-in-mpi-neighbor-alltoallw", "title": "What is the correct order of send and receive in MPI_Neighbor_alltoallw()?", "body": "<p>I am using <a href=\"https://www.open-mpi.org/doc/v2.1/man3/MPI_Neighbor_alltoallw.3.php\" rel=\"nofollow noreferrer\">MPI_Neighbor_alltoallw()</a> to send and receive data from neighboring processes. In my application, I have ghost cells, which should be updated by copying cell data from neighboring cells. Here is a schematic of this process:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R3Q01.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R3Q01.png\" alt=\"The blue cells, contain data and the purple cells are ghost cells, which should be updated with a copy of neighboring cell data.\"></a>\n<em>The blue cells, contain data and the purple cells are ghost cells, which should be updated with a copy of neighboring cell data.</em></p>\n\n<p>According to what I learned from <a href=\"https://www.mpi-forum.org/docs/mpi-3.1/mpi31-report.pdf\" rel=\"nofollow noreferrer\">MPI standard</a>, I wrote the simplest example I could. I also wrote a parallel vtk writer to visualize the data later. In the following code I defined new MPI data types for sending and receiving sub-arrays:</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n\n//VTK Library\n#include &lt;vtkXMLPStructuredGridWriter.h&gt;\n#include &lt;vtkXMLStructuredGridWriter.h&gt;\n#include &lt;vtkStructuredGrid.h&gt;\n#include &lt;vtkSmartPointer.h&gt;\n#include &lt;vtkFloatArray.h&gt;\n#include &lt;vtkCellData.h&gt;\n#include &lt;vtkProgrammableFilter.h&gt;\n#include &lt;vtkInformation.h&gt;\n#include &lt;vtkMPIController.h&gt;\n\n// To change the number of processes in each direction change nx, ny\nconst int nx{2};\nconst int ny{2};\nconst int Lx{100/nx};   // grid size without ghost cells\nconst int Ly{100/ny};\nconst int lx{Lx+4};     // grid size plus ghost cells\nconst int ly{Ly+4};\n\nstruct Args {\n  vtkProgrammableFilter* pf;\n  int local_extent[6];\n};\n\n// function to operate on the point attribute data\nvoid execute (void* arg) {\n  Args* args = reinterpret_cast&lt;Args*&gt;(arg);\n  auto info = args-&gt;pf-&gt;GetOutputInformation(0);\n  auto output_tmp = args-&gt;pf-&gt;GetOutput();  //WARNING this is a vtkDataObject*\n  auto input_tmp  = args-&gt;pf-&gt;GetInput();   //WARNING this is a vtkDataObject*\n  vtkStructuredGrid* output = dynamic_cast&lt;vtkStructuredGrid*&gt;(output_tmp);\n  vtkStructuredGrid* input  = dynamic_cast&lt;vtkStructuredGrid*&gt;(input_tmp);\n  output-&gt;ShallowCopy(input);\n  output-&gt;SetExtent(args-&gt;local_extent);\n}\n\nvoid parallel_vtk_writer (double* cells, const char* name, int* coords, int* dim, vtkMPIController* contr) {\n  int dims[2] = {lx+1, ly+1};\n  int global_extent[6] = {0, dim[1]*lx, 0, dim[0]*ly, 0, 0};\n  int local_extent[6] = {coords[1]*lx, coords[1]*lx + lx,\n                        coords[0]*ly, coords[0]*ly + ly, 0, 0};\n\n  int nranks = contr-&gt;GetNumberOfProcesses();\n  int rank   = contr-&gt;GetLocalProcessId();\n\n  auto points = vtkSmartPointer&lt;vtkPoints&gt;::New();\n  points-&gt;Allocate((lx+1)*(ly+1));\n  for (int j=0; j&lt;ly+1; ++j)\n    for (int i=0; i&lt;lx+1; ++i)\n      points-&gt;InsertPoint(i + j*(lx+1), i+coords[1]*lx, j+coords[0]*ly, 0);\n\n  auto cell_value = vtkSmartPointer&lt;vtkFloatArray&gt;::New();\n  cell_value-&gt;SetNumberOfComponents(1);\n  cell_value-&gt;SetNumberOfTuples(lx*ly);\n  cell_value-&gt;SetName (\"cell value\");\n\n  for (int j=0; j&lt;ly; ++j)\n    for (int i=0; i&lt;lx; ++i)\n      cell_value-&gt;SetValue(i + j*lx, cells[i + j*lx]);\n\n  auto pf = vtkSmartPointer&lt;vtkProgrammableFilter&gt;::New();\n\n  Args args;\n  args.pf = pf;\n  for(int i=0; i&lt;6; ++i) args.local_extent[i] = local_extent[i];\n\n  pf-&gt;SetExecuteMethod(execute, &amp;args);\n\n  auto structuredGrid = vtkSmartPointer&lt;vtkStructuredGrid&gt;::New();\n  structuredGrid-&gt;SetExtent(global_extent);\n  pf-&gt;SetInputData(structuredGrid);\n  structuredGrid-&gt;SetPoints(points);\n  structuredGrid-&gt;GetCellData()-&gt;AddArray(cell_value);\n\n  auto parallel_writer = vtkSmartPointer&lt;vtkXMLPStructuredGridWriter&gt;::New();\n  parallel_writer-&gt;SetInputConnection(pf-&gt;GetOutputPort());\n  parallel_writer-&gt;SetController(contr);\n  parallel_writer-&gt;SetFileName(name);\n  parallel_writer-&gt;SetNumberOfPieces(nranks);\n  parallel_writer-&gt;SetStartPiece(rank);\n  parallel_writer-&gt;SetEndPiece(rank);\n  parallel_writer-&gt;SetDataModeToBinary();\n  parallel_writer-&gt;Update();\n  parallel_writer-&gt;Write();\n}\n\nint main (int argc, char *argv[]) {\n  MPI_Init (&amp;argc, &amp;argv);  \n\n  //*** Create cartesian topology for grids ***//\n  MPI_Comm comm_cart;\n  int cartesian_rank;\n  int dim[2] = {ny, nx};\n  int coords[2];\n  int periods[2] = {1, 1};\n  MPI_Cart_create (MPI_COMM_WORLD, 2, dim, periods, 0, &amp;comm_cart);\n  MPI_Comm_rank (comm_cart, &amp;cartesian_rank);\n  MPI_Cart_coords (comm_cart, cartesian_rank, 2, coords);\n\n  //******** Allocate memory and initialize cells ********//\n  double* cells = new double[lx*ly];\n  for (int j=0; j&lt;ly; ++j)\n    for (int i=0; i&lt;lx; ++i)\n      cells[i + j*lx] = 0;\n\n  //********* Assign a value to cells *********//\n  int cx = coords[1];\n  int cy = coords[0];\n  int l, m;\n  // for loops starts with 2, because we don't initialize the ghost cells\n  for (int j=2; j&lt;ly-2; ++j)\n    for (int i=2; i&lt;lx-2; ++i) {\n      l = i + cx*lx - 4*cx;\n      m = j + cy*ly - 4*cy;\n      if ((l-(nx*Lx+3)/2.)*(l-(nx*Lx+3)/2.) + (m-(ny*Ly+3)/2.)*(m-(ny*Ly+3)/2.) &lt;= 400)\n        cells[i + j*lx] = (i+j)*0.1;\n      else\n        cells[i + j*lx] = 0.1;\n    }\n\n  //********** Define new data types **********//\n  const int dims {2};\n  int arr_sizes[dims] = {ly, lx};\n  int subar_sizes_x[dims] = {Ly, 2};\n  int subar_sizes_y[dims] = {2, Lx};\n  MPI_Datatype subar_right;\n  MPI_Datatype subar_left;\n  MPI_Datatype subar_top;\n  MPI_Datatype subar_bottom;\n  MPI_Datatype ghost_left;\n  MPI_Datatype ghost_right;\n  MPI_Datatype ghost_bottom;\n  MPI_Datatype ghost_top;\n\n  // send subarrays\n  int subar_right_start[dims] = {2, Lx};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_x, subar_right_start, MPI_ORDER_C, MPI_DOUBLE, &amp;subar_right);\n  MPI_Type_commit (&amp;subar_right);\n\n  int subar_left_start[dims] = {2, 2};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_x, subar_left_start, MPI_ORDER_C, MPI_DOUBLE, &amp;subar_left);\n  MPI_Type_commit (&amp;subar_left);\n\n  int subar_top_start[dims] = {Ly, 2};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_y, subar_top_start, MPI_ORDER_C, MPI_DOUBLE, &amp;subar_top);\n  MPI_Type_commit (&amp;subar_top);\n\n  int subar_bottom_start[dims] = {2, 2};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_y, subar_bottom_start, MPI_ORDER_C, MPI_DOUBLE, &amp;subar_bottom);\n  MPI_Type_commit (&amp;subar_bottom);\n\n  // recv subarrays\n  int ghost_left_start[dims] = {2, 0};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_x, ghost_left_start, MPI_ORDER_C, MPI_DOUBLE, &amp;ghost_left);\n  MPI_Type_commit (&amp;ghost_left);\n\n  int ghost_right_start[dims] = {2, Lx+2};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_x, ghost_right_start, MPI_ORDER_C, MPI_DOUBLE, &amp;ghost_right);\n  MPI_Type_commit (&amp;ghost_right);\n\n  int ghost_bottom_start[dims] = {0, 2};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_y, ghost_bottom_start, MPI_ORDER_C, MPI_DOUBLE, &amp;ghost_bottom);\n  MPI_Type_commit (&amp;ghost_bottom);\n\n  int ghost_top_start[dims] = {Ly+2, 2};\n  MPI_Type_create_subarray (dims, arr_sizes, subar_sizes_y, ghost_top_start, MPI_ORDER_C, MPI_DOUBLE, &amp;ghost_top);\n  MPI_Type_commit (&amp;ghost_top);\n\n  //******** SENDING SUBARRAY ********//\n  int sendcounts[4] = {1, 1, 1, 1};\n  int recvcounts[4] = {1, 1, 1, 1};\n  MPI_Aint sdispls[4] = {0, 0, 0, 0};\n  MPI_Aint rdispls[4] = {0, 0, 0, 0};\n  MPI_Datatype sendtypes[4] = {subar_bottom, subar_top, subar_left, subar_right};\n  MPI_Datatype recvtypes[4] = {ghost_top, ghost_bottom, ghost_right, ghost_left};\n  MPI_Neighbor_alltoallw (cells, sendcounts, sdispls, sendtypes, cells, recvcounts, rdispls, recvtypes, comm_cart);\n\n  //******** Writing the cells using VTK ********//\n  auto contr = vtkSmartPointer&lt;vtkMPIController&gt;::New();\n  contr-&gt;Initialize(nullptr, nullptr, 1);\n  parallel_vtk_writer (cells, \"data/grid.pvts\", coords, dim, contr);\n\n  //******** Free data types ********//\n  MPI_Type_free (&amp;subar_right);\n  MPI_Type_free (&amp;subar_left);\n  MPI_Type_free (&amp;subar_top);\n  MPI_Type_free (&amp;subar_bottom);\n  MPI_Type_free (&amp;ghost_left);\n  MPI_Type_free (&amp;ghost_right);\n  MPI_Type_free (&amp;ghost_bottom);\n  MPI_Type_free (&amp;ghost_top);\n  delete[] cells;\n\n  MPI_Finalize ();\n  return 0;\n}\n</code></pre>\n\n<p>I am using the following CmakeList to make my executable:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\nPROJECT(TEST)\nadd_executable(TEST test_stackoverflow.cpp)\nadd_compile_options(-std=c++11)\n\nfind_package(VTK REQUIRED)\ninclude(${VTK_USE_FILE})\ntarget_link_libraries(TEST ${VTK_LIBRARIES})\n\nfind_package(MPI REQUIRED)\ninclude_directories(${MPI_INCLUDE_PATH})\ntarget_link_libraries(TEST ${MPI_LIBRARIES})\n</code></pre>\n\n<h2>Question</h2>\n\n<p>When I use a 2 by 2 process grid ([nx,ny] = [2,2]) the send and receive works properly. However, when I use 4 by 4 process grid, I see the wrong result (wrong send and receive). <strong>What is the correct oreder of sendtypes and recvtypes in MPI_Neighbor_alltoallw()?</strong></p>\n\n<p>Any suggestions to improve the code are welcome and appreciated.</p>\n"}, {"tags": ["c++", "algorithm", "while-loop", "c++14", "user-input"], "comments": [{"owner": {"reputation": 551, "user_id": 7637816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9d3498eeac0ab04f4690d271f8e97d?s=128&d=identicon&r=PG&f=1", "display_name": "kiloalphaindia", "link": "https://stackoverflow.com/users/7637816/kiloalphaindia"}, "edited": false, "score": 0, "creation_date": 1527693721, "post_id": 50608176, "comment_id": 88226381, "body": "Under Linux you would use the EOF character &lt;Ctrl-D&gt;"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1527693786, "post_id": 50608176, "comment_id": 88226426, "body": "If you want to explicitly read a <b>line</b>, you should try <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/getline\" rel=\"nofollow noreferrer\"><code>std::getline()</code></a>."}, {"owner": {"reputation": 2041, "user_id": 7316365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/84de9f27708456d85bf1078aa51155b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vivick", "link": "https://stackoverflow.com/users/7316365/vivick"}, "edited": false, "score": 0, "creation_date": 1527694152, "post_id": 50608176, "comment_id": 88226656, "body": "Either read an entire line (via <code>std::getline()</code>) or use program arguments"}, {"owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1534160366, "post_id": 50608176, "comment_id": 90596769, "body": "Is my question wrong, if not why did I get a down vote ?"}], "answers": [{"comments": [{"owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1527694007, "post_id": 50608282, "comment_id": 88226572, "body": "So Shouldn&#39;t this be written in the book"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1527694430, "post_id": 50608282, "comment_id": 88226834, "body": "If the section is about explaining <code>operator &gt;&gt;</code> and its behaviour, then it should be explained, I suppose. If the example is about demonstrating something else, well..."}, {"owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1527694802, "post_id": 50608282, "comment_id": 88227068, "body": "One last thing, is it possible to write a code which stops after a white space"}, {"owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1527694834, "post_id": 50608282, "comment_id": 88227089, "body": "Thanks for your patience"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 6, "last_activity_date": 1527697224, "last_edit_date": 1527697224, "creation_date": 1527693507, "answer_id": 50608282, "question_id": 50608176, "link": "https://stackoverflow.com/questions/50608176/how-to-read-unknown-number-of-inputs/50608282#50608282", "title": "How to read unknown number of inputs?", "body": "<p>You need to terminate your input by an End-Of-File-character (i.e. <kbd>CTRL-Z</kbd> on Windows, <kbd>CTRL-D</kbd> on Mac/Unix), not just by an End-Of-Line (i.e. <kbd>Enter</kbd>).</p>\n\n<p>A simple <kbd>Enter</kbd> is interpreted as white space, which will be simply ignored by <code>operator&gt;&gt;</code> when reading into an integral data type.</p>\n\n<p><kbd>CTRL-Z</kbd> / End-Of-File, in contrast, makes any <code>operator&gt;&gt;</code> fail with an error.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/a/16136924/2630032\">this SO answer</a>.</p>\n\n<p>Note: Entering <code>f</code> will also terminate your loop, since <code>f</code> is not considered a valid integral number; Hence, <code>std::cin &gt;&gt; value</code> with <code>value</code> being of type <code>int</code> and an input like <code>f</code> will fail as well. To be more accurate: <code>operator&gt;&gt;</code> actually returns a reference to the input stream, but if reading in a value fails, <code>failbit</code> is set on the stream, and then interpreting the stream object in a boolean expression (implicitly calling <code>basic_istream::operator bool()</code>) returns <code>false</code>; So maybe the author of the book did not want to explain these details at the respective section in the book :-)</p>\n"}, {"comments": [{"owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 1, "creation_date": 1527694048, "post_id": 50608366, "comment_id": 88226598, "body": "Will this loop break only if input is -1"}, {"owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "reply_to_user": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1527694152, "post_id": 50608366, "comment_id": 88226655, "body": "no, You can also chose the other options here, using the end of file chars, which Stephan Lechner mentioned."}, {"owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "edited": false, "score": 0, "creation_date": 1527694823, "post_id": 50608366, "comment_id": 88227079, "body": "THank you very much"}], "tags": [], "owner": {"reputation": 20494, "user_id": 9609840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XZJmc.png?s=128&g=1", "display_name": "JeJo", "link": "https://stackoverflow.com/users/9609840/jejo"}, "is_accepted": false, "score": 2, "last_activity_date": 1540234536, "last_edit_date": 1592644375, "creation_date": 1527693817, "answer_id": 50608366, "question_id": 50608176, "link": "https://stackoverflow.com/questions/50608176/how-to-read-unknown-number-of-inputs/50608366#50608366", "title": "How to read unknown number of inputs?", "body": "<blockquote>\n<p>Is this expected?</p>\n</blockquote>\n<p><strong>Yes</strong>, Thats what  <code>while (std::cin &gt;&gt; value)</code> does. See this answer for more explanations: <a href=\"https://stackoverflow.com/questions/34395801/how-is-stdcinvalue-evaluated-in-a-while-loop\">How is &quot;std::cin&gt;&gt;value&quot; evaluated in a while loop?</a></p>\n<blockquote>\n<p>is there any code that stops after inputting a newline?</p>\n</blockquote>\n<p><strong>No</strong>, as <code>&gt;&gt;</code> simply ignore a white space(also @StephanLechner mentioned it)</p>\n<p>What you can do instead is:</p>\n<ol>\n<li><p>Just give a condition; if it satisfies just <code>break</code> the loop. you\ncan also provide a console out to make it more understandable to the\nuser. For example:</p>\n<pre><code>std::cout &lt;&lt; &quot;Enter value to sum or press -1 to exit&quot; &lt;&lt; std::endl;\n\nwhile (std::cin &gt;&gt; value &amp;&amp; value != -1) // if value == -1, loop stops.\n{\n    sum += value;\n}\n</code></pre>\n</li>\n<li><p>You can simply terminate by the end of character:</p>\n<ul>\n<li><kbd>CTRL-Z</kbd> on Windows</li>\n<li><kbd>CTRL-D</kbd> on Mac/Unix</li>\n</ul>\n</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1527697853, "creation_date": 1527697853, "answer_id": 50609568, "question_id": 50608176, "link": "https://stackoverflow.com/questions/50608176/how-to-read-unknown-number-of-inputs/50609568#50609568", "title": "How to read unknown number of inputs?", "body": "<blockquote>\n  <p>Is this expected?</p>\n</blockquote>\n\n<p>Yes, as <code>operator&gt;&gt;</code> ignores leading whitespace by default, which includes line breaks.</p>\n\n<blockquote>\n  <p>If yes, is there any code that stops after inputting a newline?</p>\n</blockquote>\n\n<p>Use <code>std::cin.getline()</code> or <code>std::getline()</code> instead of <code>operator&gt;&gt;</code>.  You can then use <code>operator&gt;&gt;</code> with a <code>std::istringstream</code> to parse values from each line, eg:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\nint main()\n{\n    std::string line;\n    int sum, value;\n\n    do\n    {\n        std::cout &lt;&lt; \"Enter a set of numbers, or a blank line to exit: \";\n        if (!std::getline(std::cin, line) || line.empty())\n            break;\n\n        // read until end-of-line, calculating a running total of all values read\n        std::istringstream iss(line);\n        sum = 0;\n        while (iss &gt;&gt; value)\n            sum += value; // equivalent to sum = sum + value\n\n        std::cout &lt;&lt; \"Sum is: \" &lt;&lt; sum &lt;&lt; std::endl;\n    }\n    while (true);\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/Ao67ZI\" rel=\"nofollow noreferrer\">Live Demo</a></p>\n"}], "owner": {"reputation": 1405, "user_id": 9871094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcRu1.png?s=128&g=1", "display_name": "Agile_Eagle", "link": "https://stackoverflow.com/users/9871094/agile-eagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9456, "favorite_count": 1, "accepted_answer_id": 50608282, "answer_count": 3, "score": 2, "last_activity_date": 1566818308, "creation_date": 1527693212, "last_edit_date": 1566818308, "question_id": 50608176, "link": "https://stackoverflow.com/questions/50608176/how-to-read-unknown-number-of-inputs", "title": "How to read unknown number of inputs?", "body": "<p>I am learning C++ using the book C++ Primer.</p>\n\n<p>In <em>Section 1.4.3</em>, the following example code about reading the unknown number of inputs is given.</p>\n\n<pre><code>#include &lt;iostream&gt;\nint main()\n{\n  int sum = 0, value = 0;\n  // read until end-of-file, calculating a running total of all values read\n  while (std::cin &gt;&gt; value)\n  sum += value; // equivalent to sum = sum + value\n  std::cout &lt;&lt; \"Sum is: \" &lt;&lt; sum &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n\n<p>According to the book, if we give an input of <code>3 4 5 6</code>, the output will be <code>Sum is: 18</code></p>\n\n<p>But when I try this on my computer(<em>Windows 10 with MinGW</em>), The code does not end. It just keeps on asking for input even if I enter a newline. It works only when I enter a non-int input like <code>f</code>.</p>\n\n<hr>\n\n<p><strong>Is this expected? If yes, is there any code that stops after inputting a newline?</strong></p>\n\n<p>I am quite new to c++ and I have already learned python, so getting stuck so early on is quite frustrating.</p>\n\n<hr>\n\n<p>Thanks and regards.</p>\n"}, {"tags": ["c++", "lambda", "declaration", "capture"], "comments": [{"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1527693392, "post_id": 50608159, "comment_id": 88226151, "body": "I think you discovered generalized lambda capture: <a href=\"https://stackoverflow.com/a/20669290/6608866\">stackoverflow.com/a/20669290/6608866</a>"}], "answers": [{"tags": [], "owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "is_accepted": false, "score": 1, "last_activity_date": 1527693346, "creation_date": 1527693346, "answer_id": 50608226, "question_id": 50608159, "link": "https://stackoverflow.com/questions/50608159/why-can-i-capture-an-undeclared-variable-in-mutable-lambda-in-c/50608226#50608226", "title": "Why can I capture an undeclared variable in mutable lambda in C++", "body": "<p>When lambdas were first introduced in C++11, you could only capture existing variables in them. However, this was broadened in later iterations of the standard and you can now define members for the closure type without necessarily capturing a variable. That is exactly what you're doing in your example.</p>\n\n<p>Perhaps more common use for this \"capture an expression\" functionality is to enable capturing move-only types by value:</p>\n\n<pre><code>std::unique_ptr&lt;Foo&gt; foo = whatever();\n[p = std::move(foo)]() {\n  p-&gt;bar();\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4405419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LwoKZ.jpg?s=128&g=1", "display_name": "Lance LI", "link": "https://stackoverflow.com/users/4405419/lance-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1527699348, "creation_date": 1527693165, "last_edit_date": 1527699348, "question_id": 50608159, "link": "https://stackoverflow.com/questions/50608159/why-can-i-capture-an-undeclared-variable-in-mutable-lambda-in-c", "title": "Why can I capture an undeclared variable in mutable lambda in C++", "body": "<p>We know that in C++, lambda expressions can capture local variables either by-copy (value) or by-reference, but why can I capture a variable which is not declared anywhere (not in enclosing scope)? How do standards define this behavior and what's the motivation behind this choice?</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nint main()\n{\n    [pi=3.14]() mutable { \n       pi = 3.1415926; \n       cout &lt;&lt; pi &lt;&lt; endl; \n    }();\n}\n</code></pre>\n"}, {"tags": ["c++", "qt", "bit-manipulation", "endianness"], "comments": [{"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1527800111, "post_id": 50607972, "comment_id": 88275522, "body": "As an aside: your API should be <code>setHallState(int)</code> or even <code>setHallState(HallState)</code>, where <code>HallState</code> is an enum or enum class."}, {"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "reply_to_user": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1527848561, "post_id": 50607972, "comment_id": 88292553, "body": "@KubaOber well for me it is easier to just receive ascii characters from the micro-controller...but I know what you mean...thanks/"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1527850743, "post_id": 50607972, "comment_id": 88293815, "body": "ASCII characters aren&#39;t a <code>QString</code>!!! They are <code>QByteArray</code>."}], "answers": [{"comments": [{"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "edited": false, "score": 0, "creation_date": 1527692979, "post_id": 50608060, "comment_id": 88225889, "body": "I don&#39;t want to use a huge library just for something simple really"}], "tags": [], "owner": {"reputation": 6371, "user_id": 1266688, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1KqkE.jpg?s=128&g=1", "display_name": "Elvis Dukaj", "link": "https://stackoverflow.com/users/1266688/elvis-dukaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1527693026, "last_edit_date": 1527693026, "creation_date": 1527692884, "answer_id": 50608060, "question_id": 50607972, "link": "https://stackoverflow.com/questions/50607972/convert-and-mask-bits-of-little-endian-to-big-endian/50608060#50608060", "title": "Convert and mask bits of little endian to big endian", "body": "<p>If you can I suggest you to use <code>Boost C++</code> libraries: in <a href=\"https://www.boost.org/doc/libs/1_67_0/libs/endian/doc/index.html\" rel=\"nofollow noreferrer\">this link</a> you can find all you need.</p>\n\n<p>If you're using <strong>GCC</strong> you can use the <code>int32_t __builtin_bswap32 (int32_t x)</code></p>\n\n<p>Alternative you can write you own function... it's quite easy, at <a href=\"https://stackoverflow.com/questions/105252/how-do-i-convert-between-big-endian-and-little-endian-values-in-c\">this post</a></p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 3174148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb7f4331f05adbf4c47d076055ffdea?s=128&d=identicon&r=PG&f=1", "display_name": "scrapper", "link": "https://stackoverflow.com/users/3174148/scrapper"}, "is_accepted": true, "score": 2, "last_activity_date": 1527693568, "creation_date": 1527693568, "answer_id": 50608307, "question_id": 50607972, "link": "https://stackoverflow.com/questions/50607972/convert-and-mask-bits-of-little-endian-to-big-endian/50608307#50608307", "title": "Convert and mask bits of little endian to big endian", "body": "<p>Maybe add some parentheses:</p>\n\n<pre><code>const void MotorWidget::setHallState(const QString&amp; s)\n{\n int hallState = s.toInt();\n ui-&gt;lbValueHallC-&gt;setText((hallState &amp; 0b100) &gt; 0 ? \"1\" : \"0\");\n ui-&gt;lbValueHallB-&gt;setText((hallState &amp; 0b010) &gt; 0 ? \"1\" : \"0\");\n ui-&gt;lbValueHallA-&gt;setText((hallState &amp; 0b001) &gt; 0 ? \"1\" : \"0\");\n}\n</code></pre>\n\n<p>Also have a look here:\n<a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/language/operator_precedence</a></p>\n"}], "owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 50608307, "answer_count": 2, "score": -1, "last_activity_date": 1527693568, "creation_date": 1527692620, "question_id": 50607972, "link": "https://stackoverflow.com/questions/50607972/convert-and-mask-bits-of-little-endian-to-big-endian", "title": "Convert and mask bits of little endian to big endian", "body": "<p>I am working on a Qt/C++ application. I want to show state of 3 hall sensors so I read it from  micro-controller this way:</p>\n\n<pre><code>uint8_t state = getState(whichMotor);\nint numChars = sprintf(sBuff, \"%d\", state);\nHAL_UART_Transmit_DMA(&amp;huart3, sBuff, numChars);\n</code></pre>\n\n<p>State can be any 1, 5, 4, 6, 2 or 3.</p>\n\n<p>Then in my Qt application I have 3 labels and want to show if corresponding bit is set in the number I receive from UART. I am sure I get the correct number, when I show it as integer its fine. But to break it down into 3 bits into three labels I fail as it just shows 1 1 1 or 0 0 0.</p>\n\n<p>Here is my code on PC:</p>\n\n<pre><code>const void MotorWidget::setHallState(const QString&amp; s)\n{\n int hallState = s.toInt();\n ui-&gt;lbValueHallC-&gt;setText(hallState &amp; 0b100 &gt; 0 ? \"1\" : \"0\");\n ui-&gt;lbValueHallB-&gt;setText(hallState &amp; 0b010 &gt; 0 ? \"1\" : \"0\");\n ui-&gt;lbValueHallA-&gt;setText(hallState &amp; 0b001 &gt; 0 ? \"1\" : \"0\");\n}\n</code></pre>\n\n<p>For example, if I receive <code>hallState</code> as 5, label C should show \"1\", label B should show \"0\" and label A should show \"1\"...but as I said I only get 111 or 000 regardless of what I receive.</p>\n\n<p>I suspect this might be big-endian little-endian thing...but I have no idea how to fix it</p>\n"}, {"tags": ["c++", "c++17", "template-argument-deduction"], "answers": [{"tags": [], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "is_accepted": true, "score": 7, "last_activity_date": 1527692510, "creation_date": 1527692510, "answer_id": 50607927, "question_id": 50607815, "link": "https://stackoverflow.com/questions/50607815/array-to-pointer-class-template-argument-deduction-works-for-template-guide-but/50607927#50607927", "title": "Array to pointer class template argument deduction works for template guide, but not for non template version, is that correct or bug?", "body": "<p>This is expected. A string literal has type <code>const char[N]</code>. Note the <code>const</code>. A const value cannot bind to a non-const reference, so your deduction guide is effectively not chosen and the primary template gets instantiated instead.</p>\n\n<pre><code>template &lt;std::size_t N&gt;\nPrettyPrint(const char(&amp;)[N]) -&gt; PrettyPrint&lt;const char*&gt;;\n</code></pre>\n\n<p>Your second deduction guide works because here, <code>T</code> is deduced to be <code>const char</code>, which is perfectly fine.</p>\n"}, {"comments": [{"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1527693150, "post_id": 50607942, "comment_id": 88225999, "body": "It works, Just to explain myself - I checked with this trick <code>template &lt;typename T&gt; class WhatIsT;  WhatIsT&lt;decltype(PrettyPrint(&quot;aa&quot;))&gt;  dummy;</code>  and it gives me &quot;implicit instantiation of undefined template &#39;WhatIsT&lt;PrettyPrint&lt;char [3]&gt; &gt;&#39;&quot;  - note <code>char[3]</code> - not <code>const char[3]</code>) ... so I tried <code>char[N]</code> ... Thanks."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 1, "creation_date": 1527693305, "post_id": 50607942, "comment_id": 88226105, "body": "@PiotrNycz That&#39;s because your constructor takes a <code>const T&amp;</code>, there is no need to deduce the <code>const</code> because it&#39;s already there :D"}, {"owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "reply_to_user": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "edited": false, "score": 0, "creation_date": 1527693681, "post_id": 50607942, "comment_id": 88226354, "body": "@Rakete1111 Do you think shall I use <code>T&amp;&amp;</code> instead in my general template version like <code>PrettyPrint(T&amp;&amp; value) : value(std::forward&lt;T&gt;(value)) {}  T&amp;&amp; value; </code> . It works - but I am not sure here."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1527693844, "post_id": 50607942, "comment_id": 88226467, "body": "@PiotrNycz Can&#39;t say. I also don&#39;t see a difference between the two, so I&#39;d say whatever you want :)"}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 7, "last_activity_date": 1527692543, "creation_date": 1527692543, "answer_id": 50607942, "question_id": 50607815, "link": "https://stackoverflow.com/questions/50607815/array-to-pointer-class-template-argument-deduction-works-for-template-guide-but/50607942#50607942", "title": "Array to pointer class template argument deduction works for template guide, but not for non template version, is that correct or bug?", "body": "<p>The issue here is a string literal is a <code>const char[N]</code>, not a <code>char[N]</code>.  Changing the guide to </p>\n\n<pre><code>template &lt;std::size_t N&gt;\nPrettyPrint(const char(&amp;)[N]) -&gt; PrettyPrint&lt;const char*&gt;; //deduction guide\n</code></pre>\n\n<p>will give you the expected results.</p>\n"}], "owner": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 50607927, "answer_count": 2, "score": 5, "last_activity_date": 1527692543, "creation_date": 1527692190, "question_id": 50607815, "link": "https://stackoverflow.com/questions/50607815/array-to-pointer-class-template-argument-deduction-works-for-template-guide-but", "title": "Array to pointer class template argument deduction works for template guide, but not for non template version, is that correct or bug?", "body": "<p>I have class template with single type param and <code>const char*</code> type full specialization, simplified example below:</p>\n\n<pre><code>template &lt;typename T&gt;\nstruct PrettyPrint {\n    PrettyPrint(const T&amp; value) : value(value) {}\n    const T&amp; value;\n    friend std::ostream&amp; operator &lt;&lt; (std::ostream&amp; os, const PrettyPrint&amp; pp) {\n        return os &lt;&lt; \"(\" &lt;&lt; pp.value &lt;&lt; \")\";\n    }\n};\ntemplate &lt;&gt;\nstruct PrettyPrint&lt;const char*&gt; {\n    PrettyPrint(const char* value) : value(value) {}\n    const char* value;\n    friend std::ostream&amp; operator &lt;&lt; (std::ostream&amp; os, const PrettyPrint&amp; pp) {\n        return os &lt;&lt; \"\\\"\" &lt;&lt; pp.value &lt;&lt; \"\\\"\";\n    }\n};\n</code></pre>\n\n<p>In short - to print char strings like <code>\"abc\"</code> and all other values like <code>(123)</code> (<code>\"\"</code> vs <code>()</code>)</p>\n\n<p>So, I added, as a replacement of additional partial specialization for all <code>char[N]</code> types  a deduction guide:</p>\n\n<pre><code>template &lt;std::size_t N&gt;\nPrettyPrint(char(&amp;)[N]) -&gt; PrettyPrint&lt;const char*&gt;; //deduction guide\n</code></pre>\n\n<p>Unfortunately it does not work:</p>\n\n<pre><code> std::cout &lt;&lt; PrettyPrint(7) &lt;&lt; PrettyPrint(\"aaa\") &lt;&lt; PrettyPrint((const char*)\"bbb\");\n</code></pre>\n\n<blockquote>\n  <p>(7)(aaa)\"bbb\"</p>\n</blockquote>\n\n<p>Expected output:</p>\n\n<blockquote>\n  <p>(7)\"aaa\"\"bbb\"</p>\n</blockquote>\n\n<p>But, surprisingly, this works:</p>\n\n<pre><code>template &lt;typename T, std::size_t N&gt;\nPrettyPrinter(T(&amp;)[N]) -&gt; PrettyPrinter&lt;const T*&gt;; //deduction guide\n\n std::cout &lt;&lt; PrettyPrint(7) &lt;&lt; PrettyPrint(\"aaa\") &lt;&lt; PrettyPrint((const char*)\"bbb\");\n</code></pre>\n\n<blockquote>\n  <p>(7)\"aaa\"\"bbb\"</p>\n</blockquote>\n\n<p>So the questions:</p>\n\n<ol>\n<li>Is that correct (then why) or this is a bug in compilers (tested with gcc/clang - newest versions)</li>\n<li>If that is correct - then how to limit this template deduction guide to <code>char</code> only?</li>\n</ol>\n"}, {"tags": ["php", "c++", "boost", "stream", "boost-beast"], "comments": [{"owner": {"reputation": 4520, "user_id": 150679, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7162b2123d51b183b31a4dbb6548adaf?s=128&d=identicon&r=PG", "display_name": "Vinnie Falco", "link": "https://stackoverflow.com/users/150679/vinnie-falco"}, "edited": false, "score": 0, "creation_date": 1527693424, "post_id": 50607737, "comment_id": 88226172, "body": "I see a lot of problems with your C++ code, after the call to <code>http::write</code>. My question is this. If you are sending an HTTP request, then why not just use Beast to read the HTTP response from the PHP script, instead of trying to do it yourself (which contains numerous bugs)?"}, {"owner": {"reputation": 93, "user_id": 1800638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2258b2d674be93b466a39350a244cd?s=128&d=identicon&r=PG", "display_name": "Horsetopus", "link": "https://stackoverflow.com/users/1800638/horsetopus"}, "reply_to_user": {"reputation": 4520, "user_id": 150679, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7162b2123d51b183b31a4dbb6548adaf?s=128&d=identicon&r=PG", "display_name": "Vinnie Falco", "link": "https://stackoverflow.com/users/150679/vinnie-falco"}, "edited": false, "score": 0, "creation_date": 1527721840, "post_id": 50607737, "comment_id": 88238833, "body": "@VinnieFalco That&#39;s what I was trying to do at first. But I could only find few examples and they wouldn&#39;t build. If you have anything for me I&#39;d gladly give it a try."}, {"owner": {"reputation": 559, "user_id": 2191610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5Trc.jpg?s=128&g=1", "display_name": "elarmando", "link": "https://stackoverflow.com/users/2191610/elarmando"}, "edited": false, "score": 1, "creation_date": 1527722137, "post_id": 50607737, "comment_id": 88238905, "body": "Follow the boost example to read the http headers. This will not fix the problem but the code would be easier to read and debug. <a href=\"https://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio/example/http/client/sync_client.cpp\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_49_0/doc/html/boost_asio/example/http/&hellip;</a>"}, {"owner": {"reputation": 4520, "user_id": 150679, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7162b2123d51b183b31a4dbb6548adaf?s=128&d=identicon&r=PG", "display_name": "Vinnie Falco", "link": "https://stackoverflow.com/users/150679/vinnie-falco"}, "reply_to_user": {"reputation": 559, "user_id": 2191610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5Trc.jpg?s=128&g=1", "display_name": "elarmando", "link": "https://stackoverflow.com/users/2191610/elarmando"}, "edited": false, "score": 1, "creation_date": 1527732705, "post_id": 50607737, "comment_id": 88241227, "body": "That&#39;s weird, because all the examples compile for me, on several environments. I wouldn&#39;t use Boost 1.49 as @elarmando suggests, because Beast is only available in Boost 1.66 and later."}, {"owner": {"reputation": 93, "user_id": 1800638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2258b2d674be93b466a39350a244cd?s=128&d=identicon&r=PG", "display_name": "Horsetopus", "link": "https://stackoverflow.com/users/1800638/horsetopus"}, "reply_to_user": {"reputation": 559, "user_id": 2191610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5Trc.jpg?s=128&g=1", "display_name": "elarmando", "link": "https://stackoverflow.com/users/2191610/elarmando"}, "edited": false, "score": 0, "creation_date": 1527776332, "post_id": 50607737, "comment_id": 88263000, "body": "@elarmando Thank you but the result is exactly the same. But I noticed something regarding the header I get. I updated my post."}, {"owner": {"reputation": 93, "user_id": 1800638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2258b2d674be93b466a39350a244cd?s=128&d=identicon&r=PG", "display_name": "Horsetopus", "link": "https://stackoverflow.com/users/1800638/horsetopus"}, "reply_to_user": {"reputation": 4520, "user_id": 150679, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7162b2123d51b183b31a4dbb6548adaf?s=128&d=identicon&r=PG", "display_name": "Vinnie Falco", "link": "https://stackoverflow.com/users/150679/vinnie-falco"}, "edited": false, "score": 0, "creation_date": 1527776544, "post_id": 50607737, "comment_id": 88263132, "body": "@Vinnie Falco I can&#39;t even find the sample I tried that didn&#39;t build. Google seams to hate the &quot;::&quot; as I cannot find much when I try &quot;html::read_some&quot;. The compilation error was ocuring when I was setting up the allocator.Anyway I think I found the issue, as I explain in the updated post. Do you think beast, if I ever manage to make it work, handle this &quot;chuncked&quot; mode? Or will I still have to implement it myself?"}, {"owner": {"reputation": 559, "user_id": 2191610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e5Trc.jpg?s=128&g=1", "display_name": "elarmando", "link": "https://stackoverflow.com/users/2191610/elarmando"}, "edited": false, "score": 1, "creation_date": 1527777970, "post_id": 50607737, "comment_id": 88264036, "body": "In case of transfer-encoding is chunked you will need to process the content response differently. This is the process to read the content: 1) First read the headers normally, 2) Then read the first line until  &quot;\\r\\n&quot;. The read line is the content size of the first chunk. 3) Use obtained size to read the chunk until another &quot;\\r\\n&quot;. 4) Read again until &quot;\\r\\n&quot;, this will give the size of the second chunk. 5)Read second chunk... Repeat this until the size of the chunk is 0. Here is an example: <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/HTTP/Headers/&hellip;</a>"}, {"owner": {"reputation": 4520, "user_id": 150679, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7162b2123d51b183b31a4dbb6548adaf?s=128&d=identicon&r=PG", "display_name": "Vinnie Falco", "link": "https://stackoverflow.com/users/150679/vinnie-falco"}, "edited": false, "score": 1, "creation_date": 1527799648, "post_id": 50607737, "comment_id": 88275292, "body": "Beast is perfectly capable of handling chunked encoding both for sending and receiving. It is transparent (no action is required on your part)."}], "owner": {"reputation": 93, "user_id": 1800638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2258b2d674be93b466a39350a244cd?s=128&d=identicon&r=PG", "display_name": "Horsetopus", "link": "https://stackoverflow.com/users/1800638/horsetopus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1527776228, "creation_date": 1527691955, "last_edit_date": 1527776228, "question_id": 50607737, "link": "https://stackoverflow.com/questions/50607737/streaming-some-data-from-php-to-c", "title": "Streaming some data from PHP to C++", "body": "<p>My goal is to send, from a C++ app, a simple GET query to PHP, such as \"do re mi fa sol\" and get some data I can play.</p>\n\n<p>The PHP script will return a stream of bytes that I will interpret in the C++ client.\nI read one byte to know the nature of the next segment (text or WAV audio file).\nI read 2 bytes for the size of the next segment.\nI read the segment data and deal with it accordingly.</p>\n\n<p>I am no expert in neither C++ nor PHP but I managed, using the boost library.\nIt works fine as long as the data I send is small.\nI the data reaches a certain size it's messed up: I get an unvalid byte for the nature of the segment (the first one I read).</p>\n\n<p>I think the limit after which it's messed up is 8192Bytes, and I'm guessing it's just writing back at the beginning of the buffer?</p>\n\n<p>I tried a few things:\n- changing the size of the buffer in which I read the socket.\n- make my PHP script sleep, but the c++ client seams to wait for the request to be over, so I just have a delay before I get the same error.\n- try to flush in my PHP script, and ob-flush... it doesn't work any better, and it seams these methods add some bytes to the output somehow.</p>\n\n<p>Here is my code:\nC++</p>\n\n<pre><code>    std::string host = \"192.168.1.232\";\n    std::string port = \"80\";\n    std::string path = \"/praat/play.php\";\n    int httpVersion = 11;\n\n    boost::asio::io_context ioc;\n    boost::asio::ip::tcp::resolver resolver{ ioc };\n    boost::asio::ip::tcp::socket socket{ ioc };\n\n    auto const results = resolver.resolve( host, port );\n\n    boost::asio::connect( socket, results.begin(), results.end() );\n\n    boost::beast::http::request&lt;boost::beast::http::string_body&gt; req{ boost::beast::http::verb::get, path, httpVersion };\n    req.set( boost::beast::http::field::host, host );\n    req.set( boost::beast::http::field::user_agent, BOOST_BEAST_VERSION_STRING );\n\n    boost::beast::http::write( socket, req );\n\n\n    OutputDebugString( L\"\u2588\u2588\u2588\u2588 Let's read the request:\\n\" );\n\n    std::array&lt; byte, 32 &gt; buf;\n    bool parsingHeader = true;\n    std::string header = \"\";\n    std::deque&lt; byte &gt; data;\n    unsigned long cumul = 0;\n\n    while ( true ) {\n\n        boost::system::error_code error;\n\n        int len = socket.read_some( boost::asio::buffer( buf ), error );\n\n        cumul += len;\n\n        OutputDebugString((L\"\u2588\u2588\u2588\u2588 Error value: \" + std::to_wstring(error.value()) + L\"\\n\").c_str());\n\n        OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 Bytes received: \" + std::to_wstring( len ) + L\" for a total of \" + std::to_wstring( cumul ) + L\"\\n\" ).c_str() );\n\n        if ( error == boost::asio::error::eof ) {\n\n            OutputDebugString(L\"\u2588\u2588\u2588\u2588 End of file\\n\");\n            break;\n        }\n\n        std::string s = (char *)buf.data();\n        s = s.substr( 0, len );\n\n        if ( parsingHeader ) {\n\n            std::size_t index = s.find( \"\\r\\n\\r\\n\" );\n\n            if ( index != std::string::npos ) {\n\n                header += s.substr( 0, index );\n\n                std::wstring ws( header.begin(), header.end() );\n\n                OutputDebugString( L\"\u2588\u2588\u2588\u2588 We got a header:\\n\" );\n                OutputDebugString( ( ws + L\"\\n\" ).c_str() );\n\n                int dataLen = len - index - 4;\n\n                data.resize( dataLen );\n\n                std::copy( std::begin( buf ) + index + 4, std::begin( buf ) + len, std::begin( data ) );\n\n                parsingHeader = false;\n            }\n            else {\n\n                header += s;\n            }\n        }\n        else {\n\n            int currentSize;\n\n            currentSize = data.size();\n\n            data.resize( currentSize + len );\n\n            std::copy( std::begin(buf), std::begin(buf) + len, std::begin(data) + currentSize );\n        }\n\n        if ( !parsingHeader ) {\n\n            OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 Data size: \" + std::to_wstring( data.size() ) + L\"\\n\" ).c_str() );\n\n            while ( data.size() != 0 ) {\n\n                int typeFlag = ( unsigned int )data[0];\n\n                OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 First byte: \" + std::to_wstring( typeFlag ) + L\"\\n\" ).c_str() );\n\n                switch ( typeFlag ) {\n\n                    case 1:\n                        OutputDebugString(L\"\u2588\u2588\u2588\u2588 We have text\");\n                        break;\n                    case 2:\n                        OutputDebugString(L\"\u2588\u2588\u2588\u2588 We have sound\");\n                        break;\n                    default:\n                        OutputDebugString( L\"\u2588\u2588\u2588\u2588 Unhandled byte\\n\" );\n                        goto exitloop;\n                }\n\n                if ( data.size() &lt; 3 ) {\n\n                    OutputDebugString( L\" but not enough bytes to read its length.\\n\" );\n                    break;\n                }\n\n                int segmentSize = int( (unsigned char)data[1] &lt;&lt; 8 | (unsigned char)data[2] );\n\n                OutputDebugString( ( L\" for \" + std::to_wstring( segmentSize )  + L\" bytes\" ).c_str() );\n\n                if ( data.size() &lt; 3 + segmentSize ) {\n\n                    OutputDebugString( L\" but they are not ready yet.\\n\" );\n                    break;\n                }\n\n                OutputDebugString( L\".\\n\" );\n\n                if ( typeFlag == 1 ) {\n\n                    std::wstring encoded( data.begin() + 3, data.begin() + 3 + segmentSize );\n\n                    std::wstring text = base64_decode( encoded );\n\n                    OutputDebugString( ( text + L\"\\n\" ).c_str() );\n                }\n                else if (typeFlag == 2) {\n\n\n                }\n\n                data.erase( data.begin(), data.begin() + 3 + segmentSize );\n            }\n        }\n    }\n\nexitloop:\n\n\n\n    boost::system::error_code ec;\n    socket.shutdown( boost::asio::ip::tcp::socket::shutdown_both, ec );\n\n    if ( ec &amp;&amp; ec != boost::system::errc::not_connected )\n        throw boost::system::system_error{ ec };\n</code></pre>\n\n<p>PHP:</p>\n\n<pre><code>&lt;?php\n\n\nset_time_limit( 0 );\n\n// header or not, it doesn't seam to change anything.\n/*header( 'Content-Type: application/octet-stream' );\nheader( 'Content-Transfer-Encoding: binary' );\nheader( 'Expires: 0' );\nheader( 'Cache-Control: must-revalidate' );\nheader( 'Pragma: public' );*/\n\n//$partition = $_GET[ \"partition\" ];\n$partition = \"do\"; //,re,mi,fa,sol! la:si?\";\n$separators = \" ,.;:!?\";\n\nchdir( \"..\" );\n\nfunction echoObject( $object ) {\n\n    $json = json_encode( $object );\n\n    $encoded = base64_encode( $json );\n\n    echo pack( \"Cn\", 1, strlen( $encoded ) );\n    echo $encoded;\n}\n\nfunction play( $partition, $start, $length ) {\n\n    $note = substr( $partition, $start, $length );\n\n    $object = new stdClass();\n    $object-&gt;type = \"highlight\";\n    $object-&gt;start = $start;\n    $object-&gt;length = $length;\n    $object-&gt;note = $note;\n\n    echoObject( $object );\n\n    $wav = \"notes/\" . $note . \".wav\";\n\n    $fileHandle = fopen( $wav, 'rb' );\n\n    fseek( $fileHandle, 32 );\n\n    $infos = unpack( 'Vsize', fread( $fileHandle, 4 ) );\n\n    $size = intval( $infos[ 'size' ] );\n\n    fread( $fileHandle, 4 ); //remove the 4 bytes for \"data\";\n\n    $total = 0;\n\n    do {\n\n    $len = min( $size - $total, 256 );\n\n    echo pack( \"Cn\", 2, $len );\n    echo fread( $fileHandle, $len );\n\n    $total += $len;\n\n    //usleep( 100000 );\n\n    echoObject( array( \"total\" =&gt; $total, \"size\" =&gt; $size ) );\n    }\n    while( $total &lt; $size );\n\n    fclose( $fileHandle );\n}\n\n$start = 0;\n$length = 0;\n\nechoObject( array( \"type\"=&gt; \"start\" ) );\n\ndo {\n\n    if ( strpos( $separators, substr( $partition, $start + $length, 1 ) ) ) {\n\n    if ( $length == 0 ) {\n\n        $start++;\n    }\n    else {\n\n        play( $partition, $start, $length );\n\n        $start += $length + 1;\n        $length = 0;\n    }\n    }\n    else {\n\n    $length++;\n\n    if ( $start + $length == strlen( $partition ) ) {\n\n        play( $partition, $start, $length );\n    }\n    }\n}\nwhile( $start + $length &lt; strlen( $partition ) );\n\nechoObject( array( \"type\"=&gt; \"over\" ) );\n\n?&gt;\n</code></pre>\n\n<p>At this point I am stuck.\nAny help would be welcome.\nThanks.</p>\n\n<p><strong>UPDATE 1</strong></p>\n\n<p>After changing to another method, following elarmando sample, I have the following code on the client:</p>\n\n<pre><code>boost::asio::streambuf response;\n    boost::asio::read_until( socket, response, \"\\r\\n\" );\n\n    // Check that response is OK.\n    std::istream response_stream( &amp;response );\n    std::string http_version;\n    response_stream &gt;&gt; http_version;\n    unsigned int status_code;\n    response_stream &gt;&gt; status_code;\n    std::string status_message;\n    std::getline( response_stream, status_message );\n\n    if ( !response_stream || http_version.substr( 0, 5 ) != \"HTTP/\" ) {\n\n        OutputDebugString( L\"\u2588\u2588\u2588\u2588 Invalid response\\n\" );\n        return S_FALSE;\n    }\n\n    if ( status_code != 200 ) {\n\n        OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 Response returned with status code \" + std::to_wstring( status_code ) + L\"\\n\" ).c_str() );\n        return S_FALSE;\n    }\n\n    // Read the response headers, which are terminated by a blank line.\n    boost::asio::read_until( socket, response, \"\\r\\n\\r\\n\" );\n\n    OutputDebugString( L\"\u2588\u2588\u2588\u2588 We have a header:\\n\" );\n\n    // Process the response headers.\n    std::string header;\n    while ( std::getline( response_stream, header ) &amp;&amp; header != \"\\r\" )\n        OutputDebugString( ( std::wstring( header.begin(), header.end() ) + L\"\\n\" ).c_str() );\n    OutputDebugString( L\"\\n\" );\n\n    OutputDebugString( L\"\u2588\u2588\u2588\u2588 Now let us parse the body:\\n\" );\n\n    std::deque&lt; byte &gt; data;\n    auto handle = [ &amp;data, &amp;response ]() -&gt; bool {\n\n        const BYTE* test = boost::asio::buffer_cast&lt;const BYTE*&gt;(response.data());\n\n        int currentSize;\n\n        currentSize = data.size();\n\n        data.resize( currentSize + response.size() );\n\n        std::copy( test, test + response.size(), std::begin(data) + currentSize );\n\n        response.consume(response.size());\n\n        OutputDebugString((L\"\u2588\u2588\u2588\u2588 Data end - begin: \" + std::to_wstring( data.end() - data.begin() ) + L\"\\n\").c_str());\n        OutputDebugString((L\"\u2588\u2588\u2588\u2588 Data size: \" + std::to_wstring(data.size()) + L\"\\n\").c_str());\n\n        while ( data.size() != 0 ) {\n\n            int typeFlag = (unsigned int)data[0];\n\n            OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 First byte: \" + std::to_wstring(typeFlag) + L\"\\n\" ).c_str());\n\n            switch (typeFlag) {\n\n                case 1:\n                    OutputDebugString( L\"\u2588\u2588\u2588\u2588 We have text\" );\n                    break;\n                case 2:\n                    OutputDebugString( L\"\u2588\u2588\u2588\u2588 We have sound\" );\n                    break;\n                default:\n                    OutputDebugString( L\"\u2588\u2588\u2588\u2588 Unhandled byte\\n\" );\n                    return false;\n            }\n\n            if ( data.size() &lt; 3 ) {\n\n                OutputDebugString( L\" but not enough bytes to read its length.\\n\" );\n                break;\n            }\n\n            int segmentSize = int( ( unsigned char)data[1] &lt;&lt; 8 | (unsigned char)data[2] );\n\n            OutputDebugString( ( L\" for \" + std::to_wstring( segmentSize ) + L\" bytes\" ).c_str());\n\n            if ( data.size() &lt; 3 + segmentSize) {\n\n                OutputDebugString( L\" but they are not ready yet.\\n\" );\n                break;\n            }\n\n            OutputDebugString( L\".\\n\" );\n\n            if (typeFlag == 1) {\n\n                std::wstring encoded( data.begin() + 3, data.begin() + 3 + segmentSize );\n\n                OutputDebugString( ( encoded + L\"\\n\").c_str() );\n\n                std::wstring text = base64_decode( encoded );\n\n                OutputDebugString( ( text + L\"\\n\" ).c_str() );\n            }\n            else if (typeFlag == 2) {\n\n                //play the audio here\n            }\n\n            OutputDebugString((L\"\u2588\u2588\u2588\u2588 Data size before erase: \" + std::to_wstring(data.size()) + L\"\\n\").c_str());\n\n            data.erase( data.begin(), data.begin() + 3 + segmentSize );\n\n            OutputDebugString((L\"\u2588\u2588\u2588\u2588 Data size after resize: \" + std::to_wstring(data.size()) + L\"\\n\").c_str());\n        }\n\n        //OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 Size: \" + std::to_wstring( data.size() ) + L\"\\n\").c_str() );\n\n        return true;\n    };\n\n    if ( response.size() &gt; 0 )\n        if ( !handle() ) goto parsingerror;\n\n    boost::system::error_code error;\n\n    while (boost::asio::read(socket, response, boost::asio::transfer_at_least(1), error))\n        if ( !handle() ) goto parsingerror;\n\n    if ( error != boost::asio::error::eof )\n        throw boost::system::system_error( error );\n\n    goto done;\n\nparsingerror:\n\n    int typeFlag = (unsigned int)data[0];\n    OutputDebugString( ( L\"\u2588\u2588\u2588\u2588 First byte is: \" + std::to_wstring( typeFlag ) + L\"\\n\" ).c_str() );\n\ndone:\n\n    OutputDebugString( L\"\u2588\u2588\u2588\u2588 Done\\n\" );\n\n    return S_FALSE;\n</code></pre>\n\n<p>And I have the exact same result.</p>\n\n<p>But then I realized something, and that is that when the content is bigger than a certain value ( in my case it seams to be something around 8000, I'm guessing 8192) the header of the response changes from:</p>\n\n<pre><code>Date: Thu, 31 May 2018 14:09:52 GMT\nServer: Apache/2.4.29 (Ubuntu)\nVary: Accept-Encoding\nContent-Length: 7977\nContent-Type: text/html; charset=UTF-8\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Date: Thu, 31 May 2018 14:09:31 GMT\nServer: Apache/2.4.29 (Ubuntu)\nVary: Accept-Encoding\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=UTF-8\n</code></pre>\n\n<p>So I guess the chunked encoding requires extra parsing.</p>\n"}, {"tags": ["c++", "inheritance", "polymorphism"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1527691636, "post_id": 50607528, "comment_id": 88224910, "body": "A container must contain pointers to the base type to offer polymorphic functionalities. For example, an <code>std::unique_ptr&lt;A&gt;</code>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1527691643, "post_id": 50607528, "comment_id": 88224919, "body": "You should have a smart pointer to <code>A</code> in class <code>Q</code>"}, {"owner": {"reputation": 455, "user_id": 4855828, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/O1jE2.jpg?s=128&g=1", "display_name": "Cryckx", "link": "https://stackoverflow.com/users/4855828/cryckx"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1527691751, "post_id": 50607528, "comment_id": 88224996, "body": "@Fran&#231;oisAndrieux fixed"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 4, "creation_date": 1527691790, "post_id": 50607528, "comment_id": 88225036, "body": "And don&#39;t forget the <a href=\"https://stackoverflow.com/q/461203/10077\">virtual destructor</a>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 3, "creation_date": 1527691821, "post_id": 50607528, "comment_id": 88225064, "body": "Your code is still invalid unless <code>foo</code> is an alias to <code>void</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1527692116, "post_id": 50607528, "comment_id": 88225297, "body": "I think the warning is over the lack of the <code>return</code> statement ."}], "answers": [{"comments": [{"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1527752046, "post_id": 50607726, "comment_id": 88247654, "body": "The shared_ptr is not made for owning but for shared ownership. Massive usage of is as owning smart pointer is preliminary pessimization that makes lot of code pointlessly inefficient."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1527800672, "post_id": 50607726, "comment_id": 88275767, "body": "@&#214;&#246;Tiib Not true. Shared pointer is in fact made for owning. Shared owning more specifically. Sure it may be a bit slow depending on use case, but it&#39;s also by far the simplest way to own a polymorphic object that lacks a virtual destructor."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1528017179, "post_id": 50607726, "comment_id": 88339715, "body": "So you repeat what I wrote.  Usage of shared_ptr when there are no need for shared ownership is just confusing. Add the virtual destructor always to polymorphic class. Modern compilers avoid calling it through vtable when possible. It just makes the hierarchy more reliable. Say further analysis shows that Q needs not one A but collection of As. So programmer takes boost::ptr_vector&lt;A&gt; but forgets to check that A&#39;s destructor is virtual and has undefined behavior."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1527691928, "creation_date": 1527691928, "answer_id": 50607726, "question_id": 50607528, "link": "https://stackoverflow.com/questions/50607528/how-to-pass-a-derived-object-to-a-class-in-c/50607726#50607726", "title": "How to pass a derived object to a class in C++?", "body": "<p>A class must know exactly the type of all its sub-objects. Dynamic polymorphism is possible only through indirection. As such, while it is not possible <em>contain</em> an object of polymorphic type, it is possible to <em>own</em> one. Example:</p>\n\n<pre><code>struct Q {\n    shared_ptr&lt;A&gt; object; // could point to B or C\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 4, "creation_date": 1527692138, "post_id": 50607768, "comment_id": 88225315, "body": "Might be prudent to point out that <code>std::unique_ptr&lt;A&gt;</code> has undefined behaviour unless <code>~A</code> is modified to be virtual."}, {"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1527692342, "post_id": 50607768, "comment_id": 88225448, "body": "@user2079303: thank you, that is correct, I edited the answer."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1527696920, "post_id": 50607768, "comment_id": 88228318, "body": "Additional note, which may be a bit off topic: By declaring the virtual destructor, the implicit move constructor/assignment will be suppressed, and copy operations will be used for moves. This is highly undesirable if <code>A</code>, <code>B</code> or <code>C</code> contain members that are slow to copy but fast to move. A good rule of thumb since C++11 is to always declare defaulted move operations whenever a destructor is declared."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1527754443, "post_id": 50607768, "comment_id": 88248982, "body": "@user2079303 when there is a plan to use objects of A B and C polymorphically and so to manage those dynamically through smart pointers then only sane thing is to disable both move and copy of those classes and to use move and copy of pointers instead."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "edited": false, "score": 0, "creation_date": 1527800413, "post_id": 50607768, "comment_id": 88275648, "body": "@&#214;&#246;Tiib disabling move of the class would be just silly. It&#39;s trivial to implement efficiently, and very useful. Copy would be disabled automatically by having a unique pointer member, and I would agree that there&#39;s no need to go out of your way to implement it."}, {"owner": {"reputation": 9434, "user_id": 528720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZpqMk.png?s=128&g=1", "display_name": "&#214;&#246; Tiib", "link": "https://stackoverflow.com/users/528720/%c3%96%c3%b6-tiib"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1528016090, "post_id": 50607768, "comment_id": 88339528, "body": "@user2079303 on case of OP where the owner of B does not want to know if it is B or C not disabled move can only cause defects. Disabling source of defects is not silly."}], "tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": true, "score": 5, "last_activity_date": 1527692798, "last_edit_date": 1527692798, "creation_date": 1527692063, "answer_id": 50607768, "question_id": 50607528, "link": "https://stackoverflow.com/questions/50607528/how-to-pass-a-derived-object-to-a-class-in-c/50607768#50607768", "title": "How to pass a derived object to a class in C++?", "body": "<p>Since you do not want <code>Q</code> to know about <code>B</code> and <code>C</code>, you have to store the <code>A</code> indirectly by a pointer, since you cannot know how much storage <code>B</code>, <code>C</code> or a yet unknown derived class <code>D</code> will need. The classic solution for a single object that is allocated dynamically and owned by Q is a <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code></a>.</p>\n\n<p>Since <code>std::unique_ptr</code> by default uses <code>delete</code> to delete the object, you also need a virtual destructor in A.</p>\n\n<pre><code>#include\"A.hpp\"\n#include&lt;memory&gt;\n\nclass Q {\n    std::unique_ptr&lt;A&gt; a;\npublic:\n    Q(std::unique_ptr&lt;A&gt; ai) : a{std::move(ai)} {}\n};\n</code></pre>\n\n<p>If you do not want exclusive ownership of Q over the A, or do not want to provide a virtual destructor, you can also use a <code>std::shared_ptr</code>. Shared pointers remember the stored class dynamically and thus destroy the object correctly if they are created appropriately, notably with <code>std::make_shared&lt;MostDerivedClass&gt;</code>. Also they use reference counting and will delete the object only after all references to the object are gone.\nThe downside is a bit of extra memory needed and some runtime cost, compared to std::unique_ptr which usually has no overhead compared to a plain pointer.</p>\n"}], "owner": {"reputation": 455, "user_id": 4855828, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/O1jE2.jpg?s=128&g=1", "display_name": "Cryckx", "link": "https://stackoverflow.com/users/4855828/cryckx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 50607768, "answer_count": 2, "score": 2, "last_activity_date": 1527693263, "creation_date": 1527691388, "last_edit_date": 1527693263, "question_id": 50607528, "link": "https://stackoverflow.com/questions/50607528/how-to-pass-a-derived-object-to-a-class-in-c", "title": "How to pass a derived object to a class in C++?", "body": "<p>I think I am misunderstanding something with the C++ inheritance. </p>\n\n<p>Let's say I have this classical inheritance :</p>\n\n<pre><code>    class A{\n    public: \n        virtual void method1() =0;\n        virtual ~A() = default;\n    }\n\n    class B : public A{\n    public :\n        void method1(){doSomething();}\n    }\n\n    class C : public A{\n    public :\n        void method1(){doSomethingElse();}\n    }\n</code></pre>\n\n<p>How do I make an other Class Q own an object of type B or C without knowing in advance which type it is ? (I mean we know it is type A that's all)</p>\n\n<p>Thanks for reading !</p>\n"}, {"tags": ["python", "c++", "cython"], "comments": [{"owner": {"reputation": 1603, "user_id": 6048373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d610d6bb4ae631578ec03de40ae8f8b7?s=128&d=identicon&r=PG&f=1", "display_name": "Vishaal Shankar", "link": "https://stackoverflow.com/users/6048373/vishaal-shankar"}, "edited": false, "score": 0, "creation_date": 1527691510, "post_id": 50607524, "comment_id": 88224823, "body": "Is it a C function or a C++ function ? The title says C function, whereas the description paints a different picture."}, {"owner": {"reputation": 5056, "user_id": 8472976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808aa1971d8e50ab541e1f54a705afad?s=128&d=identicon&r=PG&f=1", "display_name": "MegaIng", "link": "https://stackoverflow.com/users/8472976/megaing"}, "edited": false, "score": 0, "creation_date": 1527692943, "post_id": 50607524, "comment_id": 88225864, "body": "<a href=\"https://github.com/cython/cython/wiki/FAQ#how-do-i-declare-numeric-or-integer-c-types\" rel=\"nofollow noreferrer\">rtfm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5056, "user_id": 8472976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808aa1971d8e50ab541e1f54a705afad?s=128&d=identicon&r=PG&f=1", "display_name": "MegaIng", "link": "https://stackoverflow.com/users/8472976/megaing"}, "is_accepted": true, "score": 0, "last_activity_date": 1527693069, "creation_date": 1527693069, "answer_id": 50608124, "question_id": 50607524, "link": "https://stackoverflow.com/questions/50607524/wrapping-a-c-function-in-cython-which-has-non-stanard-types-as-arguments/50608124#50608124", "title": "Wrapping a C function in Cython which has non-stanard types as arguments", "body": "<p>This is a question answered in the <a href=\"https://github.com/cython/cython/wiki/FAQ#how-do-i-declare-numeric-or-integer-c-types\" rel=\"nofollow noreferrer\">FAQ of cython</a></p>\n\n<pre><code>from libc.stdint cimport uint32_t\n\ncdef extern from \"cppfile.cpp\":\n    cdef int foo(uint32_t x)\n</code></pre>\n"}], "owner": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 50608124, "answer_count": 1, "score": 0, "last_activity_date": 1527693069, "creation_date": 1527691377, "question_id": 50607524, "link": "https://stackoverflow.com/questions/50607524/wrapping-a-c-function-in-cython-which-has-non-stanard-types-as-arguments", "title": "Wrapping a C function in Cython which has non-stanard types as arguments", "body": "<p>I am trying to wrap a C++ function that has arguments of type uint32_t, which can be found in the cstdint library. Let's say the C++ file looks like</p>\n\n<p>cppfile.cpp:</p>\n\n<pre><code>#include &lt;cstdint&gt;\n\nint foo(uint32_t x){\n    return 1;\n}\n</code></pre>\n\n<p>How do I wrap this in a Cython .pxd file? If x was just a normal integer, I would do</p>\n\n<pre><code>cdef extern from \"cppfile.cpp\":\n    cdef int foo(int x)\n</code></pre>\n\n<p>But how do I do this when x is of type uint32_t? How do I obtain the uint32_t as a type in cython?</p>\n"}, {"tags": ["c++", "oop"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1527690397, "post_id": 50607137, "comment_id": 88224038, "body": "Personally I would shoot for not having to write any copy constructor or copy assignment operator.  If you can write the class in a way where the default works then you don&#39;t have to worry about anything.  This is called the <a href=\"http://en.cppreference.com/w/cpp/language/rule_of_three\" rel=\"nofollow noreferrer\">rule of zero</a>"}], "answers": [{"comments": [{"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1527691071, "post_id": 50607323, "comment_id": 88224531, "body": "Thanks for the answer. I do have another one, In the situation I have another class between the base and the derived one, which include only primitive data members, should I explicitly call the second class CCtor ? Or how do I copy all its data members too ?"}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1527691328, "post_id": 50607323, "comment_id": 88224713, "body": "I&#39;ve updated the answer to cover the other parts of your question"}, {"owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1527691664, "post_id": 50607323, "comment_id": 88224938, "body": "So basically you&#39;re saying that if I use the default CCtor and assignment operator , and the Base class is correctly defined, then the second class will also copy the Base class info ? So in my third class, CCtor\\operator  , do I need to call the second class one&#39;s ?"}, {"owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "reply_to_user": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "edited": false, "score": 0, "creation_date": 1527695450, "post_id": 50607323, "comment_id": 88227470, "body": "The default implementation of special member functions (such as copy constructors and copy assignment operators) correctly copies the base classes and members. The compiler understands C++ better than you do and so will do the right thing. So make your base class work correctly, and let the derived classes rely on that."}], "tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": true, "score": 7, "last_activity_date": 1527691100, "last_edit_date": 1527691100, "creation_date": 1527690710, "answer_id": 50607323, "question_id": 50607137, "link": "https://stackoverflow.com/questions/50607137/use-base-class-copy-ctor-in-derived-class/50607323#50607323", "title": "Use base class Copy CTOR in derived class", "body": "<blockquote>\n  <p>Is this the right design for the situation?</p>\n</blockquote>\n\n<p>No, not usually. The more idiomatic approach is to stop manually managing memory like <code>char* name</code> and use <code>std::string</code> or another type that does the right thing:</p>\n\n<pre><code>Class Base {\n    std::string name;\n    ....\n    Base(const Base&amp; other) = default;\n    Base&amp; operator=(const Base&amp; other) = default;\n};\n</code></pre>\n\n<p>(Note that assignment operators should return a reference to the class, not <code>void</code>).</p>\n\n<p>Or encapsulate the memory management in a class design specifically for that purpose (but <code>std::string</code> already is that type).</p>\n\n<p>If you really <em>really</em> need to do it the dumb error-prone way, then implement your copy constructor to do copying:</p>\n\n<pre><code>    Base(const Base&amp; other) { / * deep copy of name */ }\n</code></pre>\n\n<p>Then implement assignment as copy-and-swap:</p>\n\n<pre><code>    Base&amp; operator=(const Base&amp; other)\n    {\n      Base tmp(other);\n      this-&gt;swap(tmp);\n      return *this;\n    }\n</code></pre>\n\n<p>This means you need a cheap, non-throwing <code>swap(Base&amp;)</code> member function.</p>\n\n<p>In any case the derived type copy constructor is just silly. You have a correct copy constructor for the base class so it should be:</p>\n\n<pre><code>Derived(const Derived&amp; other) : Base(other) { }\n</code></pre>\n\n<p>And the assignment can use the base assignment:</p>\n\n<pre><code>Derived&amp; operator=(const Derived&amp; other)\n{\n   Base::operator=(other);\n   return *this;\n}\n</code></pre>\n\n<p>But writing these manually is unnecessary, you can just default its copy operations which will Do The Right Thing anyway:</p>\n\n<pre><code>class Derived : public Base {\npublic:\n    Derived(const Derived&amp;) = default;\n    Derived&amp; operator=(const Derived&amp; ) = default;\n</code></pre>\n\n<blockquote>\n  <p>If i have a third class, between the base and the derived class, but it only contains primitive types, where shoud I copy them ? E.G. use the default assignment operator of the second class ? build a new one? only copy them on the third level ?</p>\n</blockquote>\n\n<p>You should define the copy constructor and assignment operator of that class using <code>= default</code> as well. Once you've made <code>Base</code> safe to copy with correct behaviour, composing other classes to use it is trivial. The default behaviour will Do The Right Thing. You only need to define those operations manually if you need special treatment for something like dynamically-allocated memory that isn't being correctly managed by an RAII type.</p>\n\n<blockquote>\n  <p>I could similary call the base class CCtor inside the derived class CCtor, instead of the assignment operator. What's the difference?</p>\n</blockquote>\n\n<p>If you want to copy construct then use the copy constructor, not assignment. Use the right function for the job.</p>\n"}], "owner": {"reputation": 36469, "user_id": 5353753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8658d889ba478c305810bd346e21da33?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/5353753/sagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 50607323, "answer_count": 1, "score": 6, "last_activity_date": 1527691100, "creation_date": 1527690180, "last_edit_date": 1527690766, "question_id": 50607137, "link": "https://stackoverflow.com/questions/50607137/use-base-class-copy-ctor-in-derived-class", "title": "Use base class Copy CTOR in derived class", "body": "<p>I know there are many posts on the subject, but I couldn't find any to fully answer my questions.</p>\n\n<p>Say I have a Base class and a Derived class, which I implemented a CCtor and an assignment operator for it, something like the following:</p>\n\n<pre><code>class Base {\n    char * name;\n    ....\n    Base(const Base&amp; other) :name(nullptr) { *this = other }\n    void operator=(const Base&amp; other) { ... Deep copy of name } \n}\n\n\nclass Derived : public Base {\n.... \n    Derived(const Derived&amp; other) { *this = other ; }\n    void operator=(const Derived&amp; other) {\n        Base::operator=(other);\n        .....\n    }\n</code></pre>\n\n<p>Now I have some questions about this design. </p>\n\n<ol>\n<li>Is this the right design for the situation?</li>\n<li>If i have a third class, between the base and the derived class, but it only contains primitive types, where shoud I copy them ? E.G. use the default assignment operator of the second class ? build a new one? only copy them on the third level ?</li>\n<li>I could similary call the base class CCtor inside the derived class CCtor, instead of the assignment operator. What's the difference? If I place them in both methods will it try to copy the values two times?</li>\n</ol>\n\n<p>Edit: Just to clarify, the design is what I was given in my project .. I have pointers so I have to use a deep copy .</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1527690174, "post_id": 50607063, "comment_id": 88223853, "body": "In what you call &quot;level 2 operator&quot;, <code>Foo</code> and <code>Bar</code> are <a href=\"http://en.cppreference.com/w/cpp/language/template_argument_deduction#Non-deduced_contexts\" rel=\"nofollow noreferrer\">non-deduced context</a>. You can only call this function if you provide type parameters explicitly."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1527690199, "post_id": 50607063, "comment_id": 88223876, "body": "I don&#39;t really see the need for the &quot;level 2&quot; output operator? Why not simply use standard overloading for the possible alternatives of <code>Bar</code>? Like <code>std::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const OneTypeOfBar&amp; bar);</code>? No special handling needed for the &quot;level 1&quot; operator function."}, {"owner": {"reputation": 503, "user_id": 6608142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K6z7D.jpg?s=128&g=1", "display_name": "KorbenDose", "link": "https://stackoverflow.com/users/6608142/korbendose"}, "edited": false, "score": 0, "creation_date": 1527690916, "post_id": 50607063, "comment_id": 88224418, "body": "I was thinking of specializing, too. But then I am losing all the gains I wanted to achieve with templatization."}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 6608142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K6z7D.jpg?s=128&g=1", "display_name": "KorbenDose", "link": "https://stackoverflow.com/users/6608142/korbendose"}, "edited": false, "score": 0, "creation_date": 1527691277, "post_id": 50607219, "comment_id": 88224677, "body": "Ok, I understand. So the types <code>Foo</code> and <code>Bar</code> are not automatically deduced. Do you have a suggestion on how to solve the problem while still keeping the flexibility of templates?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 503, "user_id": 6608142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K6z7D.jpg?s=128&g=1", "display_name": "KorbenDose", "link": "https://stackoverflow.com/users/6608142/korbendose"}, "edited": false, "score": 0, "creation_date": 1527695409, "post_id": 50607219, "comment_id": 88227442, "body": "@KorbenDose I do not now any good solution, added some general wording."}, {"owner": {"reputation": 503, "user_id": 6608142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K6z7D.jpg?s=128&g=1", "display_name": "KorbenDose", "link": "https://stackoverflow.com/users/6608142/korbendose"}, "edited": false, "score": 0, "creation_date": 1527792321, "post_id": 50607219, "comment_id": 88271691, "body": "Your example made it a lot clearer as to why the compiler can&#39;t deduce the appropriate types. Thanks."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 5, "last_activity_date": 1527695374, "last_edit_date": 1527695374, "creation_date": 1527690412, "answer_id": 50607219, "question_id": 50607063, "link": "https://stackoverflow.com/questions/50607063/two-stage-lookup-for-operator/50607219#50607219", "title": "Two stage lookup for operator&lt;&lt;", "body": "<p>The problem you are describing has nothing to do with two-step lookup. Instead, it has to do with the fact that in the function </p>\n\n<pre><code>template &lt;typename Foo, typename Bar&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const typename MyClass&lt;Foo,Bar&gt;::bar_t&amp; bar)\n</code></pre>\n\n<p><code>Foo</code> and <code>Bar</code> are in non-deduced context. It means, that you have to provide those template arguments every time you call the function.</p>\n\n<p>As to while compiler can't deduce types here, let's consider a simpler example of the same thing which would not work:</p>\n\n<pre><code>template&lt;class T&gt; struct A {\n    using type = int;\n    type i = 42;\n};\n\ntemplate&lt;class T&gt; void foo(typename A&lt;T&gt;::type );\n...\nA&lt;void*&gt; a;\nfoo(a.i); // problematic call\n</code></pre>\n\n<p>You would want <code>T</code> to be deduced to <code>void*</code> in the example above. However, type of <code>a.i</code> is int. So that call is identical to </p>\n\n<pre><code>foo(int(42));\n</code></pre>\n\n<p>Obviously, there is no meaningful <code>T</code> compiler can deduce here.</p>\n\n<p>As to how to solve this problem - try not to use non-deduced types with streams. If you can't, than probably stream insertion operators are not a good fit for this, as the syntax is really ugly. Just use normal functions.</p>\n"}], "owner": {"reputation": 503, "user_id": 6608142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K6z7D.jpg?s=128&g=1", "display_name": "KorbenDose", "link": "https://stackoverflow.com/users/6608142/korbendose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 50607219, "answer_count": 1, "score": 3, "last_activity_date": 1527695374, "creation_date": 1527689944, "question_id": 50607063, "link": "https://stackoverflow.com/questions/50607063/two-stage-lookup-for-operator", "title": "Two stage lookup for operator&lt;&lt;", "body": "<p>Currently I am trying to overload the insertion operator <code>&lt;&lt;</code> for a class I was working on. For some reason I split it up into two functions and called one from the other. After switching to templates, it didn't work anymore. After looking up the problem, I found out about <a href=\"https://stackoverflow.com/a/11922668/6608142\">two stage lookup</a> and <a href=\"https://stackoverflow.com/a/12561834/6608142\">some reasoning</a> behind it.</p>\n\n<p>Essentially, what I was trying to do is the following:</p>\n\n<pre><code>template &lt;typename Foo, typename Bar&gt;\nclass MyClass {\npublic:\n  using foo_t = Foo;\n  using bar_t = Bar;\n\n  bar_t some_func() const { /* do something */ }\n};\n\n/* Level 2 operator */\ntemplate &lt;typename Foo, typename Bar&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const typename MyClass&lt;Foo,Bar&gt;::bar_t&amp; bar) {\n  return out &lt;&lt; some_other_func(bar);\n}\n\n/* Level 1 operator calls level 2 operator */\ntemplate &lt;typename Foo, typename Bar&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const MyClass&lt;Foo,Bar&gt;&amp; myClass) {\n  return out &lt;&lt; myClass.some_func();\n}\n</code></pre>\n\n<p>Unfortunately, due to the fact that <code>bar_t</code> is dependent, this does not compile which had me change the level 1 operator to the following:</p>\n\n<pre><code>template &lt;typename Foo, typename Bar&gt;\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; out, const MyClass&lt;Foo,Bar&gt;&amp; myClass) {\n  return operator&lt;&lt;&lt;Foo,Bar&gt;(out,myClass.some_func());\n}\n</code></pre>\n\n<p>Now this is arguably not very beautiful and in my opinion obliterates the purpose of the <code>&lt;&lt;</code> operator.</p>\n\n<p>Besides the obvious solution of not splitting the two operators, does anybody have a nice solution to this?</p>\n"}, {"tags": ["c++", "openssl", "sha1"], "comments": [{"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1527689699, "post_id": 50606890, "comment_id": 88223515, "body": "My guts say the same. There is a <code>SHA_CTX</code> context. If you discard it at the end of the method, then there is no problem. Not sure if you can reuse a <code>SHA1_CTX</code> if you don&#39;t <code>SHA1_Final</code>."}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1527690212, "post_id": 50606890, "comment_id": 88223890, "body": "I can&#39;t find the code for <code>SHA1_Final</code>... <a href=\"https://github.com/openssl/openssl/blob/4bed94f0c11ef63587c6b2edb03c3c438e221604/crypto/sha/sha512.c#L140\" rel=\"nofollow noreferrer\">Still the code for <code>SHA512_Final</code></a>, that should be similar enough, doesnt clean/free anything."}, {"owner": {"reputation": 2898, "user_id": 1601656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/16b47c431caa644270a534fa772c3010?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/1601656/grzegorz"}, "reply_to_user": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1527690331, "post_id": 50606890, "comment_id": 88223974, "body": "@xanatos - I am only concerned that this does reverse engineering, and depends on implementation, which in future can change. <code>SHA1_CTX</code> can be reused if one calls <code>SHA1_Init()</code> on it. Thank you for your efforts!"}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1527690455, "post_id": 50606890, "comment_id": 88224089, "body": "@gregorz The documentation doesn&#39;t speak about the necessity of using <code>_Final</code>, a similar implementation doesn&#39;t need it, and it would be against the logic of the context as the container of the temporary data to do it..."}], "answers": [{"comments": [{"owner": {"reputation": 2898, "user_id": 1601656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/16b47c431caa644270a534fa772c3010?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/1601656/grzegorz"}, "edited": false, "score": 0, "creation_date": 1527691228, "post_id": 50607457, "comment_id": 88224632, "body": "Makes sense. Thank you for looking this up. I suspect that OpenSSL knows what they do :)"}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "reply_to_user": {"reputation": 2898, "user_id": 1601656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/16b47c431caa644270a534fa772c3010?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/1601656/grzegorz"}, "edited": false, "score": 1, "creation_date": 1527691433, "post_id": 50607457, "comment_id": 88224779, "body": "@Grzegorz Note that doing what you are doing is potentially keeping a piece of source data in memory. For example a password is normally shorter than 64 bytes, so it would be kept in the context waiting for the <code>_Final</code>. If the data is a super-secret and should stay in memory for the shortest time possible to mitigate some server attacks, then you are creating a vulnerability. Note even that <code>SHA1_Init</code> as the first instruction does <code>memset(c, 0, sizeof(*c));</code>, so it zeroes (in a non-secure way) the context, cleaning this state."}], "tags": [], "owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "is_accepted": true, "score": 1, "last_activity_date": 1527691132, "creation_date": 1527691132, "answer_id": 50607457, "question_id": 50606890, "link": "https://stackoverflow.com/questions/50606890/do-i-have-to-call-sha1-final-if-i-abandon-hash-calculation/50607457#50607457", "title": "Do I have to call SHA1_Final() if I abandon hash calculation?", "body": "<p>Many <code>SHA_*</code> methods are defined <a href=\"https://github.com/openssl/openssl/blob/OpenSSL_1_1_0/crypto/include/internal/md32_common.h\" rel=\"nofollow noreferrer\">here</a>, that is a file that through the preprocessor is \"configured\" to be the methods for SHA1, SHA256...</p>\n\n<p>The <a href=\"https://github.com/openssl/openssl/blob/OpenSSL_1_1_0/crypto/include/internal/md32_common.h#L316\" rel=\"nofollow noreferrer\"><code>HASH_FINAL</code></a> method is the <code>SHA1_Final</code> (and <code>SHA256_Final</code>). In here the only operation that \"smells\" of cleaning is an</p>\n\n<pre><code>OPENSSL_cleanse(p, HASH_CBLOCK);\n</code></pre>\n\n<p>where <code>OPENSSL_cleanse</code> is </p>\n\n<blockquote>\n  <p>OPENSSL_cleanse() fills ptr of size len with a string of 0's</p>\n</blockquote>\n\n<p>(taken from <a href=\"https://www.openssl.org/docs/man1.1.1/man3/OPENSSL_cleanse.html\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>But the size of the <code>OPENSSL_cleanse</code> is <code>HASH_CBLOCK</code>, so I'll say that it is cleaning the internal buffer used for keeping partial pieces of source data that have to be hashed. Explanation: SHA1 works on 512 bits (64 bytes) of data at a time. If you try to hash 70 bytes of data with a <code>SHA1_Update</code>, 64 bytes are hashed and 6 bytes are saved somewhere for the next <code>SHA1_Update</code>. The <code>SHA1_Final</code> finishes using these bytes and then clears them.</p>\n"}], "owner": {"reputation": 2898, "user_id": 1601656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/16b47c431caa644270a534fa772c3010?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/1601656/grzegorz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 50607457, "answer_count": 1, "score": 2, "last_activity_date": 1527691132, "creation_date": 1527689478, "last_edit_date": 1527689571, "question_id": 50606890, "link": "https://stackoverflow.com/questions/50606890/do-i-have-to-call-sha1-final-if-i-abandon-hash-calculation", "title": "Do I have to call SHA1_Final() if I abandon hash calculation?", "body": "<p>It is regarding all SHA family.</p>\n\n<p>I look at the <a href=\"https://www.openssl.org/docs/man1.1.0/crypto/SHA1.html\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.1.0/crypto/SHA1.html</a> page and I don't see anything that would prevent me from NOT calling <code>SHA1_Final()</code> in case I want to abandon hash calculation.</p>\n\n<p>In other words, is it okay if I do:</p>\n\n<pre><code>try {\n    SHA1_Init(&amp;ctx);\n    while (!finish) {\n        const Data&amp; data = getData();\n        SHA1_Update(&amp;ctx, data.data(), data.len());\n    }\n    SHA1_Final(&amp;md, &amp;ctx);\n}\ncatch(const std::exception&amp; e) {\n    std::cerr &lt;&lt; \"Ooops, exception while reading data. \" &lt;&lt; e.what() &lt;&lt; std::endl;\n    std::cerr &lt;&lt; \"Not calling SHA1_Final!\" &lt;&lt; std::endl;\n    throw;\n}\n</code></pre>\n\n<p>My guts are telling me that I should be okay with not calling <code>SHA1_Final()</code>, and that if there was a need to 'clean up' ctx, there should be <code>SHA1_Destroy()</code>, which, of course is absent...</p>\n"}, {"tags": ["c++"], "comments": [{"owner": {"reputation": 415, "user_id": 7305358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909955eb7835150dae7bfbfa4e587e23?s=128&d=identicon&r=PG&f=1", "display_name": "Zinki", "link": "https://stackoverflow.com/users/7305358/zinki"}, "edited": false, "score": 0, "creation_date": 1527689503, "post_id": 50606876, "comment_id": 88223358, "body": "<code>vector&lt;int*&gt; a</code> declares a vector containing <code>int*</code>s (pointers to <code>int</code>s). You can access an element at index <code>i</code> with <code>a[i]</code>.  <code>vector&lt;int&gt; *a</code> is a pointer to a vector containing <code>int</code>s and most likely not what you want."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1527689505, "post_id": 50606876, "comment_id": 88223362, "body": "everybody has problems working with pointers, simply dont use them: <code>std::vector&lt;plate&gt; a; a.push_back(plate());</code>"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 0, "creation_date": 1527689508, "post_id": 50606876, "comment_id": 88223365, "body": "The two have very little in common. One is a vector of pointers, the other is a pointer to a vector of <code>int</code>s."}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1527689633, "post_id": 50606876, "comment_id": 88223462, "body": "if you have problems you should show the problematic code (the one you show here looks fishy but in principle it is fine) and include the error messages in the question"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1527691002, "post_id": 50606876, "comment_id": 88224485, "body": "&quot;A collection of locations&quot; (e.g. your address book) vs &quot;the location of a collection of things&quot; (e.g. the address of an office)."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1527691152, "post_id": 50606876, "comment_id": 88224582, "body": "On a side note, it&#39;s almost always wrong to store the result of applying <code>&amp;</code> to something for later."}], "answers": [{"comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1527692891, "post_id": 50607383, "comment_id": 88225831, "body": "Subjective nitpick: &quot;Vector of&quot; sounds less confusing than &quot;Vector to&quot;."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "reply_to_user": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 1, "creation_date": 1527692967, "post_id": 50607383, "comment_id": 88225878, "body": "@byxor sure - I&#39;ll buy that one (I was probably thinking of the next part and got my words tangled)  Thanks :)"}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": true, "score": 2, "last_activity_date": 1527692953, "last_edit_date": 1527692953, "creation_date": 1527690896, "answer_id": 50607383, "question_id": 50606876, "link": "https://stackoverflow.com/questions/50606876/differerece-vector-pointer/50607383#50607383", "title": "Differerece vector pointer", "body": "<p><code>vector&lt;int*&gt; a</code> is a vector of integer pointers.</p>\n\n<ul>\n<li>to access the value of an item one would do <code>*a[0]</code> or <code>*at.at(0)</code>  read as \"take the 0th item in the vector a, and then take the value that it points to\"</li>\n</ul>\n\n<p><code>vector&lt;int&gt;* b</code> is a pointer to a vector of integers</p>\n\n<ul>\n<li>to access the value of an item one would do <code>(*b)[0]</code> or <code>b-&gt;at(0)</code> read as \"take the vector pointed to by b, and then take the 0th item from it\".</li>\n</ul>\n\n<p>Note that the \"at\" version will perform bounds checking ensuring that you have the element; but I added it to show the various syntax's available.</p>\n\n<p>As stated in the comments though, raw pointers are used less and less; in addition one has to manage their lifetime very carefully (in your example would require p to live at least as long as A) and c++ has become better at moving objects around where they support it.</p>\n\n<p>You should consider taking a look at <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">The Definitive C++ Book Guide and List</a> for any additional help regarding pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 1431, "user_id": 8531215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b6f1842cca99191b2e148564e4cc53?s=128&d=identicon&r=PG&f=1", "display_name": "TaQuangTu", "link": "https://stackoverflow.com/users/8531215/taquangtu"}, "is_accepted": false, "score": 0, "last_activity_date": 1527691310, "last_edit_date": 1527691310, "creation_date": 1527690996, "answer_id": 50607417, "question_id": 50606876, "link": "https://stackoverflow.com/questions/50606876/differerece-vector-pointer/50607417#50607417", "title": "Differerece vector pointer", "body": "<pre><code>vector&lt;int*&gt; a;\n</code></pre>\n\n<p>In this case, variable a is a vector that contains integer pointers</p>\n\n<pre><code>vector&lt;int&gt; *a\n</code></pre>\n\n<p>And in this case, a is a pointer used to store address of a vector variable</p>\n\n<p>Below is an example for you, I hope you can see the differences between them:</p>\n\n<pre><code>int var1 = 0, var2 = 1;\nvector&lt;int*&gt; a;\na.push_back(&amp;var1);\na.push_back(&amp;var2);\n\nvector&lt;int&gt;* b;\nvector&lt;int&gt; c;\nc.add(var1);\nc.add(var2);\n\nb = &amp;c;\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6170520, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4f9acb99f29ee73b5cb2776988813d2d?s=128&d=identicon&r=PG&f=1", "display_name": "jofri", "link": "https://stackoverflow.com/users/6170520/jofri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 50607383, "answer_count": 2, "score": -5, "last_activity_date": 1527692953, "creation_date": 1527689429, "last_edit_date": 1527689472, "question_id": 50606876, "link": "https://stackoverflow.com/questions/50606876/differerece-vector-pointer", "title": "Differerece vector pointer", "body": "<p>What is the difference between <code>vector&lt;int*&gt; a</code> and <code>vector&lt;int&gt; *a</code>? I have problems working with pointer and vectors. I can fill the vector with this code.   </p>\n\n<pre><code>    plate p;\n    vector&lt;plate*&gt; A;\n    A.push_back(&amp;p);\n</code></pre>\n\n<p>But I can't find out how to work with the values after that.</p>\n"}, {"tags": ["c++", "c", "lua"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527689924, "post_id": 50606847, "comment_id": 88223684, "body": "If <code>luaL_loadstring</code> something you&#39;re trying to implement? If so, what have you tried?"}, {"owner": {"reputation": 651, "user_id": 6834680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OvYt2.png?s=128&g=1", "display_name": "Egor   Skriptunoff", "link": "https://stackoverflow.com/users/6834680/egor-skriptunoff"}, "edited": false, "score": 1, "creation_date": 1527691307, "post_id": 50606847, "comment_id": 88224701, "body": "Concatenate <code>&quot;return &quot;</code> with <code>TableFromStr</code> and invoke <code>luaL_dostring</code>"}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1527691331, "post_id": 50607305, "comment_id": 88224717, "body": "Suggestion: Add the relevant content (code example)  from the 2nd link directly into your answer.  Leaving the link intact is fine to provide a reference of where the example code came from, but the link by itself may disappear at some point, rendering your answer less useful."}], "tags": [], "owner": {"reputation": 4124, "user_id": 2828480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/30ce285bfd170cf3834d9591fab207e0?s=128&d=identicon&r=PG&f=1", "display_name": "Konrad", "link": "https://stackoverflow.com/users/2828480/konrad"}, "is_accepted": true, "score": 3, "last_activity_date": 1527691626, "last_edit_date": 1527691626, "creation_date": 1527690665, "answer_id": 50607305, "question_id": 50606847, "link": "https://stackoverflow.com/questions/50606847/how-to-create-a-lua-table-from-a-string/50607305#50607305", "title": "How to create a lua table from a string?", "body": "<p>You have to use <code>luaL_dostring</code> </p>\n\n<p><a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_dostring\" rel=\"nofollow noreferrer\">https://www.lua.org/manual/5.1/manual.html#luaL_dostring</a></p>\n\n<p>If you're using Lua 5.1 make sure <code>luaL_dostring</code> is correctly defined. See: <a href=\"http://lua-users.org/lists/lua-l/2006-04/msg00218.html\" rel=\"nofollow noreferrer\">http://lua-users.org/lists/lua-l/2006-04/msg00218.html</a></p>\n\n<blockquote>\n  <p>In Lua 5.1, <code>luaL_dostring</code> is defined as <code>luaL_loadstring(L, s) || lua_pcall(L, 0, 0, 0)</code></p>\n  \n  <p>and so it ignores returns.</p>\n  \n  <p>Try this:</p>\n\n<pre><code>#undef luaL_dostring\n#define luaL_dostring(L,s)    \\   (luaL_loadstring(L, s) || lua_pcall(L, 0, LUA_MULTRET, 0))\n</code></pre>\n</blockquote>\n\n<p>It's possible that you will also have to prepend your string with <code>return</code></p>\n"}], "owner": {"reputation": 55, "user_id": 7093543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b54ef375501043de103218d174f5cfc?s=128&d=identicon&r=PG&f=1", "display_name": "\u971c\u6708\u5e7b\u591c", "link": "https://stackoverflow.com/users/7093543/%e9%9c%9c%e6%9c%88%e5%b9%bb%e5%a4%9c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 50607305, "answer_count": 1, "score": 1, "last_activity_date": 1527691626, "creation_date": 1527689358, "question_id": 50606847, "link": "https://stackoverflow.com/questions/50606847/how-to-create-a-lua-table-from-a-string", "title": "How to create a lua table from a string?", "body": "<p>I have a c function, used to return a table to lua, but the table is created from a string, not lua_newtable, how to do this?</p>\n\n<pre><code>int GetTable(lua_State* L)\n{\n    //this string is generated at runtime, so i can not use lua_newtable\n    const char* TableFromStr = \"{a = 123, b = 456, d = {x = 1, y = 9} }\";\n    //i want to push the table to the top stack\n    luaL_loadstring(L, TableFromStr);\n    //return 1 table, lua code can get the table\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c++", "qt"], "answers": [{"comments": [{"owner": {"reputation": 1614, "user_id": 2131783, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a5f7a6c30de72d289b4c4605601b0f47?s=128&d=identicon&r=PG", "display_name": "Thomas Kowalski", "link": "https://stackoverflow.com/users/2131783/thomas-kowalski"}, "edited": false, "score": 1, "creation_date": 1527692410, "post_id": 50607105, "comment_id": 88225497, "body": "Thank you for that. I&#39;ll look into it. For now, I&#39;ve found about <a href=\"http://doc.qt.io/archives/qt-4.8/qsyntaxhighlighter.html\" rel=\"nofollow noreferrer\"><code>QSyntaxHighliter</code></a> which seems to do what I wanted to achieve."}], "tags": [], "owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "is_accepted": false, "score": 0, "last_activity_date": 1527690043, "creation_date": 1527690043, "answer_id": 50607105, "question_id": 50606725, "link": "https://stackoverflow.com/questions/50606725/updating-qtextdocument-while-user-is-typing/50607105#50607105", "title": "Updating QTextDocument while user is typing", "body": "<p>You can wrap the setHtml(QString) between two calls to <a href=\"http://doc.qt.io/qt-5/qobject.html#blockSignals\" rel=\"nofollow noreferrer\">blockSignals(bool)</a> to prevent the QTextEdit from emitting the textChanged() signal again.</p>\n\n<pre><code>textEdit-&gt;blockSignals(true);\ntextEdit-&gt;setHtml(text);\ntextEdit-&gt;blockSignals(false);\n</code></pre>\n\n<p>Don't know if it's the best design choice. You could try to study the QTextEdit API and see if it is worthing inheriting from it and specialize its behavior, even if I do not believed it was designed to be inherited.  </p>\n"}], "owner": {"reputation": 1614, "user_id": 2131783, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a5f7a6c30de72d289b4c4605601b0f47?s=128&d=identicon&r=PG", "display_name": "Thomas Kowalski", "link": "https://stackoverflow.com/users/2131783/thomas-kowalski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527690043, "creation_date": 1527688987, "question_id": 50606725, "link": "https://stackoverflow.com/questions/50606725/updating-qtextdocument-while-user-is-typing", "title": "Updating QTextDocument while user is typing", "body": "<p>I'm pretty new to Qt and I'd like to do this thing that looks simple to me, though I don't really know where to start.</p>\n\n<p>I use a QTextEdit whose style I'd like to update while the user is typing, for example, put everything between two stars in bold (I'm trying to make a basic Markdown editor). </p>\n\n<p>Though, as I said, I don't know where to go. I wanted to use the <code>textChanged</code> signal, but if I do something like</p>\n\n<pre><code>on textChanged\n    analyze the new text\n    textEdit-&gt;setHtml(formatted new text)\n</code></pre>\n\n<p>The slot is just calling itself (and my app finally crashes) because my <code>onTextChanged</code> is changing the text...</p>\n\n<p>What should I do ? I was thinking that I could work with threads (analyzing while the user is typing) but I fear that doing this might be difficult, since it would cause a non-UI thread to access and modify things in the UI one...</p>\n\n<p>I'm really looking for design advice here...</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c++17", "copy-elision"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1527688883, "post_id": 50606606, "comment_id": 88222895, "body": "Isn&#39;t RVO only guaranteed for anonymous objects? Both <code>bar</code> and <code>baz</code> have named instances"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1527689013, "post_id": 50606606, "comment_id": 88223006, "body": "@UnholySheep still, clang&#39;s lifetime analysis for NRVO looks better in this case. We don&#39;t know gcc version though."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1527689099, "post_id": 50606606, "comment_id": 88223067, "body": "NRVO is not guarantied. so both are valid, just clang does better job."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 4, "creation_date": 1527689304, "post_id": 50606606, "comment_id": 88223204, "body": "ref. <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=51571\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=51571</a>"}], "answers": [{"tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 4, "last_activity_date": 1527689551, "creation_date": 1527689551, "answer_id": 50606912, "question_id": 50606606, "link": "https://stackoverflow.com/questions/50606606/shouldnt-guaranteed-copy-elision-apply/50606912#50606912", "title": "Shouldn&#39;t guaranteed copy elision apply?", "body": "<p>RVO (return value optimization) only applies when you return a temporary from a  function.  In both <code>bar</code> and <code>baz</code> you are not returning a temporary.  Instead you a returning a <em>named</em> object.  This means you are dealing with NRVO (named return value optimization) and that is not guaranteed and is harder to do.  Both outputs are standard compliant and it is just clang does a better job doing the optimization than gcc does.</p>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": true, "score": 4, "last_activity_date": 1527691601, "last_edit_date": 1592644375, "creation_date": 1527689559, "answer_id": 50606916, "question_id": 50606606, "link": "https://stackoverflow.com/questions/50606606/shouldnt-guaranteed-copy-elision-apply/50606916#50606916", "title": "Shouldn&#39;t guaranteed copy elision apply?", "body": "<p>From <a href=\"https://en.cppreference.com/w/cpp/language/copy_elision\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/language/copy_elision</a></p>\n<blockquote>\n<p>Under the following circumstances, the compilers are permitted, but not required to omit the copy- and move- (since C++11)construction of class objects even if the copy/move (since C++11) constructor and the destructor have observable side-effects. This is an optimization: even when it takes place and the copy-/move-constructor is not called, it still must be present and accessible (as if no optimization happened at all), otherwise the program is ill-formed.</p>\n<ul>\n<li>If a function returns a class type by value, and the return statement's expression is the name of a non-volatile object with automatic storage duration, which isn't a function parameter, or a catch clause parameter, and which has the same type (ignoring top-level cv-qualification) as the return type of the function, then copy/move (since C++11) is omitted. When that local object is constructed, it is constructed directly in the storage where the function's return value would otherwise be moved or copied to. This variant of copy elision is known as NRVO, &quot;named return value optimization&quot;.</li>\n</ul>\n</blockquote>\n<p>NRVO is not guaranteed to happen, but would be possible in your case.</p>\n<p>As pointed out by Sander De Dycker in a comment,\nthere is already a <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=51571\" rel=\"nofollow noreferrer\">bug report</a> to get this opportunity of elision.</p>\n"}], "owner": {"reputation": 6840, "user_id": 1353549, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/413d2645039577214eb6382b3166e1c4?s=128&d=identicon&r=PG", "display_name": "akim", "link": "https://stackoverflow.com/users/1353549/akim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 50606916, "answer_count": 2, "score": 3, "last_activity_date": 1527691601, "creation_date": 1527688680, "question_id": 50606606, "link": "https://stackoverflow.com/questions/50606606/shouldnt-guaranteed-copy-elision-apply", "title": "Shouldn&#39;t guaranteed copy elision apply?", "body": "<p>I do not understand the behavior of gcc here, I would expect RVO to apply, but regardless of whether I pass optimization flags and/or I pass <code>-std=c++17</code>, in the second case, the gratuitous pair of braces seems to prevent GCC from eliding the copy.</p>\n\n<pre><code>$ cat /tmp/foo.cc\n#include &lt;iostream&gt;\n#define PING() std::cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; '\\n'\n\nstruct foo\n{\n  foo() { PING(); }\n  ~foo() { PING(); }\n  foo(const foo&amp;) { PING(); }\n};\n\nfoo bar()\n{\n  PING();\n  foo res;\n  return res;\n}\n\nfoo baz()\n{\n  PING();\n  {\n    foo res;\n    return res;\n  }\n}\n\nint main()\n{\n  foo f1 = bar();\n  foo f2 = baz();\n}\n$ g++-mp-7 -std=c++17 -O3 foo.cc\n$ ./a.out\nfoo bar()\nfoo::foo()\nfoo baz()\nfoo::foo()\nfoo::foo(const foo&amp;)\nfoo::~foo()\nfoo::~foo()\nfoo::~foo()\n</code></pre>\n\n<p>Shouldn't this be part of the guaranteed copy elision?  The behavior of Clang matches my expectations:</p>\n\n<pre><code>$ clang++-mp-4.0 foo.cc\n$ ./a.out\nfoo bar()\nfoo::foo()\nfoo baz()\nfoo::foo()\nfoo::~foo()\nfoo::~foo()\n</code></pre>\n"}, {"tags": ["c++", "arrays", "constructor", "destructor"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1527688658, "post_id": 50606548, "comment_id": 88222713, "body": "<code>std::vector&lt;uint8_t&gt;</code> is what you want.  see: <a href=\"https://stackoverflow.com/questions/2151084/map-a-2d-array-onto-a-1d-array\" title=\"map a 2d array onto a 1d array\">stackoverflow.com/questions/2151084/&hellip;</a>"}, {"owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527689021, "post_id": 50606548, "comment_id": 88223010, "body": "I&#39;m planning to use this on a microcontroller so it should be very lightweight"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1527689149, "post_id": 50606548, "comment_id": 88223094, "body": "@gsamaras That&#39;s fine."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1527689734, "post_id": 50606548, "comment_id": 88223544, "body": "<code>uint8_t[][] data;</code> this isn&#39;t C++. Dows it compile for you?"}, {"owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1527690035, "post_id": 50606548, "comment_id": 88223760, "body": "@n.m. I&#39;d love to just compile it and see what I&#39;m doing wrong but unfortunately I have a lot of stuff that&#39;s dependent on it since it&#39;s part of something I&#39;ve already coded for the micro controller and now I had to switch libraries."}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1527697240, "post_id": 50606548, "comment_id": 88228497, "body": "&quot;a friend suggested to use calloc() instead&quot; - Why? This is C++ not C."}, {"owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527772608, "post_id": 50606548, "comment_id": 88260445, "body": "Is it bad to be using C stuff in C++?"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527689091, "post_id": 50606644, "comment_id": 88223056, "body": "Unfortunately, I&#39;ve never learned how to properly allocate in C++. I know it has to be done but always get mixed up when and how it happens."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527689228, "post_id": 50606644, "comment_id": 88223146, "body": "Memory management is important in C++. Would you like me to include an example in my answer? Since it seems that STL makes you worried about the micro controller (where I do not know what is best). @Lithimlin"}, {"owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527689324, "post_id": 50606644, "comment_id": 88223218, "body": "Yes, that would be awesome."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 2, "creation_date": 1527689451, "post_id": 50606644, "comment_id": 88223322, "body": "@Lithimlin I could do that and continue my day, but now that I am thinking about it, it&#39;s not needed. Why would you need to use a pointer, and not the struct itself as a data member of the class? Assuming you are not going for the vector approach, which is suggested."}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1527689654, "post_id": 50606644, "comment_id": 88223474, "body": "Alternatly, why a separate <code>MapData</code> type, instead of just having those members be part of <code>LEDBitmap</code>"}, {"owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527689703, "post_id": 50606644, "comment_id": 88223518, "body": "@gsamaras now that you mention it... I&#39;m not so sure anymore. I used a different class before but I can&#39;t use that anymore because I&#39;m using a different controller and now have different libraries and just started trying to emulate the class I&#39;d used so far. They probably had some reasons for that, but you&#39;re right, I don&#39;t have any."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "edited": false, "score": 0, "creation_date": 1527690014, "post_id": 50606644, "comment_id": 88223745, "body": "@Lithimlin I see, thus I updated my answer, hope it helps now."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1527690034, "post_id": 50606644, "comment_id": 88223758, "body": "@Caleth good point, I updated my answer, what do you think, did it improve?"}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1527697198, "post_id": 50606644, "comment_id": 88228463, "body": "&quot;when new is used, then delete must also be used&quot; - and don&#39;t forget that when new[] is used then delete[] must be used rather than just using delete."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1527689991, "last_edit_date": 1527689991, "creation_date": 1527688785, "answer_id": 50606644, "question_id": 50606548, "link": "https://stackoverflow.com/questions/50606548/c-2d-data-array-in-constructor-when-to-initialize-and-delete/50606644#50606644", "title": "C++ 2D data array in constructor - When to initialize and delete?", "body": "<p>Since <code>ptr</code> is a pointer, no. You are attempting to fill the fields of a struct, that has not even memory allocated to it. That causes <em>Undefined Behavior</em>.</p>\n\n<ol>\n<li>You should first allocate memory for the struct, and then populate\nit.</li>\n<li>Then, in the destructor, you <em>must</em> de-allocate that memory.</li>\n</ol>\n\n<p>Remember, when <code>new</code> is used, then <code>delete</code> must also be used. In general, you want to call <code>delete</code> exactly as many times as <code>new</code> was called.</p>\n\n<hr>\n\n<p>But why use a pointer? It seems redundant in that case. And when you use pointers without a good reason, you make your code prone to errors.</p>\n\n<p>Here are some suggestions you can pick from, instead of using a pointer (which wouldn't require you to define a constructor): </p>\n\n<ul>\n<li>Use <code>std::vector&lt;uint8_t&gt;</code> to do all the work under the hood\n(<a href=\"https://stackoverflow.com/questions/2151084/map-a-2d-array-onto-a-1d-array\">related</a>),\nas NathanOliver stated.</li>\n<li>Use <code>struct MapData</code> as the data member instead of the pointer. That\nmakes sense in OOP programming, if you want the struct to be re-used\nby another class for example.</li>\n<li>If the struct is meant to be used only from this class, then consider\ngiving the class directly the fields of the structs, as its data\nmembers, and not the struct itself.</li>\n</ul>\n"}], "owner": {"reputation": 379, "user_id": 6155242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzqmM.png?s=128&g=1", "display_name": "Lithimlin", "link": "https://stackoverflow.com/users/6155242/lithimlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 50606644, "answer_count": 1, "score": 2, "last_activity_date": 1527690741, "creation_date": 1527688522, "last_edit_date": 1527690741, "question_id": 50606548, "link": "https://stackoverflow.com/questions/50606548/c-2d-data-array-in-constructor-when-to-initialize-and-delete", "title": "C++ 2D data array in constructor - When to initialize and delete?", "body": "<p>This question might be a little stupid but I'm still fairly new to C++ and it's been a while since I've last done something with it.</p>\n\n<p>I have a class called <code>LEDBitmap</code> that is supposed to hold the width, height and data of a bitmap with only ones and zeros.</p>\n\n<p>In the header file I have the following struct:</p>\n\n<pre><code>struct MapData\n{\n  uint8_t width;\n  uint8_t height;\n  uint8_t[][] data;\n};\n</code></pre>\n\n<p>As well as the following constructor, destructor and member variable:</p>\n\n<pre><code>class LEDBitmap\n{\n\n  public:\n    LEDBitmap(uint8_t width, uint8_t, height, uint8_t data[][]);\n    LEDBitmap(uint8_t width, uint8_t, height);\n    virtual ~LEDBitmap() {   };\n\n  [...]\n\n  private: //members\n    MapData _map;\n};\n</code></pre>\n\n<p>I now want to write the constructors and possibly the destructor and so far I have the following for the first constructor:</p>\n\n<pre><code>//initialize an empty bitmap with only zeros in it\nLEDBitmap::LEDBitmap(uint8_t width, uint8_t, height) {\n  _map.width = width;\n  _map.height = height;\n  _map.data = new uint8_t[width][height];\n}\n</code></pre>\n\n<p>Would this implementation work? (probably not)\nAnd should I bother actually implementing the destructor?</p>\n\n<p>EDIT:\nAdjusted my code according to @gsamaras's suggestion.\n<code>_map</code> used to be <code>*_ptr</code> before.</p>\n\n<p><strong>EDIT:</strong> a friend suggested to use <code>calloc()</code> instead. I thus now have:</p>\n\n<pre><code>LEDBitmap::LEDBitmap(uint8_t width, uint8_t height) {\n  _map.width = width;\n  _map.height = height;\n  _map.data = calloc(width*height*(sizeof(uint8_t));\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class LEDBitmap\n{\n\n  public:\n    LEDBitmap(uint8_t width, uint8_t, height, uint8_t data[][]);\n    LEDBitmap(uint8_t width, uint8_t, height);\n    virtual ~LEDBitmap() {\n      free(_map.data);\n    };\n\n  private: //members\n    MapData _map;\n\n};\n</code></pre>\n"}, {"tags": ["c++", "conan"], "comments": [{"owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 2, "creation_date": 1527690184, "post_id": 50606534, "comment_id": 88223861, "body": "No, storage cannot be specified in profiles. I didn&#39;t understand why not changing the storage.path value in the conan.conf file? Did you know about the CONAN_USER_HOME environment variable, that allows to specify where to put the whole local cache? The thing is that in order to locate the conan.conf, it has to exist already in some place defined by convention. Also, what would be the mess? I don&#39;t see any problem with storing the binaries there."}, {"owner": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "reply_to_user": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "edited": false, "score": 0, "creation_date": 1527696802, "post_id": 50606534, "comment_id": 88228238, "body": "I think <code>CONAN_USER_HOME</code> is the way, although I&#39;d prefer a setting in the project configuration."}], "owner": {"reputation": 2039, "user_id": 737971, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cc56d3a9285353e2a29f9289597005a3?s=128&d=identicon&r=PG", "display_name": "senseiwa", "link": "https://stackoverflow.com/users/737971/senseiwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 662, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527688471, "creation_date": 1527688471, "question_id": 50606534, "link": "https://stackoverflow.com/questions/50606534/overriding-conan-storage-directory", "title": "Overriding Conan Storage directory", "body": "<p>I am trying to use <code>conan</code> for a dummy C++ project (language irrelevant here), but I don't like to mess with the user's home directory. By default, <code>conan install</code> will use <code>~/conan/data</code> as specified by <code>~/conan/conan.conf</code>:</p>\n\n<pre><code>[storage]\n# This is the default path, but you can write your own. It must be an absolute path or a\n# path beginning with \"~\" (if the environment var CONAN_USER_HOME is specified, this directory, even\n# with \"~/\", will be relative to the conan user home, not to the system user home)\npath = ~/.conan/data\n</code></pre>\n\n<p>Is there a way to <strong>override the storage directory</strong> to a local one?</p>\n\n<p>I have tried to add a <code>[storage]</code> section to a profile I created but apparently <code>conan</code> doesn't like it (`ERROR: Error reading './locally' profile: ConfigParser: Unrecognized field 'storage').</p>\n"}, {"tags": ["c++", "serialization", "dlib"], "comments": [{"owner": {"reputation": 6295, "user_id": 118803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6534d583d8b442b3be4f608a3c45b5b9?s=128&d=identicon&r=PG", "display_name": "Joshua Smith", "link": "https://stackoverflow.com/users/118803/joshua-smith"}, "edited": false, "score": 0, "creation_date": 1527688522, "post_id": 50606403, "comment_id": 88222611, "body": "can you link to a gist or something of the full src?  Also, are you sure your images are good (ie have a face and are the right size)?"}, {"owner": {"reputation": 357, "user_id": 7919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc91907cc7d2534e3111f2a4882e20a?s=128&d=identicon&r=PG&f=1", "display_name": "EYakoumi", "link": "https://stackoverflow.com/users/7919757/eyakoumi"}, "reply_to_user": {"reputation": 6295, "user_id": 118803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6534d583d8b442b3be4f608a3c45b5b9?s=128&d=identicon&r=PG", "display_name": "Joshua Smith", "link": "https://stackoverflow.com/users/118803/joshua-smith"}, "edited": false, "score": 0, "creation_date": 1527688744, "post_id": 50606403, "comment_id": 88222787, "body": "i will post code as a reply concerning the images yes i am sure i have faces in them as if i don&#39;t use serialization i get the matching result correctly"}, {"owner": {"reputation": 357, "user_id": 7919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc91907cc7d2534e3111f2a4882e20a?s=128&d=identicon&r=PG&f=1", "display_name": "EYakoumi", "link": "https://stackoverflow.com/users/7919757/eyakoumi"}, "reply_to_user": {"reputation": 6295, "user_id": 118803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6534d583d8b442b3be4f608a3c45b5b9?s=128&d=identicon&r=PG", "display_name": "Joshua Smith", "link": "https://stackoverflow.com/users/118803/joshua-smith"}, "edited": false, "score": 0, "creation_date": 1527689509, "post_id": 50606403, "comment_id": 88223366, "body": "i added the code to the question. the commented parts in the code are what i am hoping to use to avoid extraction of the image feature each time the matching is required for a person. so in short i want the features to be extracted. saved to a file then whenever i need to match that specific person i read his file and extract the features of the incoming image only and thus save half of he required time for matching"}], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 7919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc91907cc7d2534e3111f2a4882e20a?s=128&d=identicon&r=PG&f=1", "display_name": "EYakoumi", "link": "https://stackoverflow.com/users/7919757/eyakoumi"}, "is_accepted": true, "score": 1, "last_activity_date": 1527750177, "creation_date": 1527750177, "answer_id": 50618512, "question_id": 50606403, "link": "https://stackoverflow.com/questions/50606403/serializing-face-features-for-recognition-in-dlib/50618512#50618512", "title": "Serializing Face Features for recognition in DLIB", "body": "<p>instead of serializing the Matrix i serialized the output vector (faces).</p>\n\n<pre><code>serialize(\"personX.dat\")&lt;&lt;faces;\n</code></pre>\n\n<p>then when doing the recognition i deserialized the dat file and used the resulting vector:</p>\n\n<pre><code>std::vector&lt;matrix&lt;rgb_pixel&gt;&gt; faces;\ndeserialize(\"out.dat\")&gt;&gt;faces;\nfor (auto face : detector(img2))\n{\n    auto shape = sp(img2, face);\n    matrix&lt;rgb_pixel&gt; face_chip;\n    extract_image_chip(img2, get_face_chip_details(shape, 150, 0.25), face_chip);\n    faces.push_back(move(face_chip));\n}\n</code></pre>\n\n<p>and I continued as mentioned in the question.</p>\n\n<p>I don't know if this is the best way to do it... but it worked.</p>\n"}], "owner": {"reputation": 357, "user_id": 7919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc91907cc7d2534e3111f2a4882e20a?s=128&d=identicon&r=PG&f=1", "display_name": "EYakoumi", "link": "https://stackoverflow.com/users/7919757/eyakoumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 1, "accepted_answer_id": 50618512, "answer_count": 1, "score": 0, "last_activity_date": 1527750177, "creation_date": 1527688129, "last_edit_date": 1527689364, "question_id": 50606403, "link": "https://stackoverflow.com/questions/50606403/serializing-face-features-for-recognition-in-dlib", "title": "Serializing Face Features for recognition in DLIB", "body": "<p>I am writing a dlib code to do face recognition on 1 to 1 basis.</p>\n\n<p>I followed the code sample in <a href=\"http://dlib.net/dnn_face_recognition_ex.cpp.html\" rel=\"nofollow noreferrer\">dlib samples</a> and did the following:</p>\n\n<pre><code>std::vector&lt;matrix&lt;rgb_pixel&gt;&gt; faces;\nfor (auto face : detector(img1))\n{\n    auto shape = sp(img1, face);\n    matrix&lt;rgb_pixel&gt; face_chip;\n    extract_image_chip(img1, get_face_chip_details(shape, 150, 0.25), face_chip);\n    faces.push_back(move(face_chip));\n}\n</code></pre>\n\n<p>this is for the first image and then did the same for the second image:</p>\n\n<pre><code>for (auto face : detector(img2))\n{\n    auto shape = sp(img2, face);\n    matrix&lt;rgb_pixel&gt; face_chip;\n    extract_image_chip(img2, get_face_chip_details(shape, 150, 0.25), face_chip);\n    faces.push_back(move(face_chip));\n}\n</code></pre>\n\n<p>then i continue  as per the mentioned link:</p>\n\n<pre><code>std::vector&lt;matrix&lt;float, 0, 1&gt;&gt; face_descriptors = net(faces);\nstd::vector&lt;sample_pair&gt; edges;\nfor (size_t i = 0; i &lt; face_descriptors.size(); ++i)\n{\n     for (size_t j = i; j &lt; face_descriptors.size(); ++j)\n     {\n          if (length(face_descriptors[i] - face_descriptors[j]) &lt; threshold)\n              edges.push_back(sample_pair(i, j));\n     }\n }\n std::vector&lt;unsigned long&gt; labels;\n const int num_clusters = chinese_whispers(edges, labels);\n//etc\n</code></pre>\n\n<p>and now comes my question. img1 is an image already available to the code that is read when i need to match a specific person. (ie if I want to mach personX, img1 is read using </p>\n\n<pre><code>load_image(img1, \"personX.jpg\");\n</code></pre>\n\n<p>Instead of having the image saved, i was trying to save the features and load them to reduce the time spent the extraction of features. so what I did is I moved the first for loop at a different function (enrollment like)  and made it something like this:</p>\n\n<pre><code>std::vector&lt;matrix&lt;rgb_pixel&gt;&gt; faces;\nfor (auto face : detector(img1))\n{\n    auto shape = sp(img1, face);\n    matrix&lt;rgb_pixel&gt; face_chip;\n    extract_image_chip(img1, get_face_chip_details(shape, 150, 0.25), face_chip);\n    serialize(\"personX.dat\") &lt;&lt;face_chip;\n}\n</code></pre>\n\n<p>then at the recognition instead of the loop i used</p>\n\n<pre><code>matrix&lt;rgb_pixel&gt; face_chip;\ndeserialize(\"personX.dat\")&gt;&gt;face_chip;            \nfaces.push_back(move(face_chip));\n</code></pre>\n\n<p>and the rest of the code from the extraction of img2 onward remained the same. the code compiled. But during execution when i reach the recognition i end up with the following error:</p>\n\n<p>**************************** FATAL ERROR DETECTED ****************************</p>\n\n<p>Error detected at line 216.\nError detected in file /usr/local/include/dlib/dnn/input.h.\nError detected in function void dlib::input_rgb_image_sized::to_tensor(forward_iterator, forward_iterator, dlib::resizable_tensor&amp;) const [with forward_iterator = __gnu_cxx::__normal_iterator*, std::vector > >; long unsigned int NR = 150ul; long unsigned int NC = 150ul].</p>\n\n<p>Failing expression was i->nr()==NR &amp;&amp; i->nc()==NC    input_rgb_image_sized::to_tensor()</p>\n\n<p>All input images must have 150 rows and 150 columns, but we got one with 0 rows and 0 columns.</p>\n\n<p>Is there something wrong with the serialization / de-serialization? or should i do writing the features to a file with another method?</p>\n\n<p>code for the full funtion: </p>\n\n<pre><code>try\n{\n    load_image(img1, check_image);\n}\ncatch (...)\n{\n    cout&lt;&lt;\"Name: \"&lt;&lt;uname&lt;&lt;\" doesn't exist\"&lt;&lt;endl;\n    return;\n}\n\nelse\n{\n    QElapsedTimer timer;\n    timer.start();\n\n\n    dlib::assign_image(img2, dlib::cv_image&lt;bgr_pixel&gt;(colorImage));\n    std::vector&lt;matrix&lt;rgb_pixel&gt;&gt; faces;\n\n    for (auto face : detector(img1))\n    {\n        auto shape = sp(img1, face);\n        matrix&lt;rgb_pixel&gt; face_chip;\n        extract_image_chip(img1, get_face_chip_details(shape, 150, 0.25), face_chip);\n        faces.push_back(move(face_chip));\n//                serialize(\"out.dat\")&lt;&lt;face_chip;   //used whin i dont need to read image\n    }\n\n//            matrix&lt;rgb_pixel&gt; face_chip; //used whin i dont need to read image\n//            deserialize(\"out.dat\")&gt;&gt;face_chip; //used whin i dont need to read image\n//            faces.push_back(move(face_chip)); //used whin i dont need to read image\n\n    cout&lt;&lt;\"Time to extract features for enroled image: \"&lt;&lt;timer.elapsed()&lt;&lt;endl;\n    timer.restart();\n\n    for (auto face : detector(img2))\n    {\n        auto shape = sp(img2, face);\n        matrix&lt;rgb_pixel&gt; face_chip;\n        extract_image_chip(img2, get_face_chip_details(shape, 150, 0.25), face_chip);\n        faces.push_back(move(face_chip));\n    }\n\n    cout&lt;&lt;\"Time to extract features for new image: \"&lt;&lt;timer.elapsed()&lt;&lt;endl;\n    timer.restart();\n\n    if (faces.size() &lt; 2)\n    {\n        cout&lt;&lt;\"No Face\"&lt;&lt;endl;\n    }\n\n    else\n    {\n        std::vector&lt;matrix&lt;float, 0, 1&gt;&gt; face_descriptors = net(faces);\n        std::vector&lt;sample_pair&gt; edges;\n        for (size_t i = 0; i &lt; face_descriptors.size(); ++i)\n        {\n            for (size_t j = i; j &lt; face_descriptors.size(); ++j)\n            {\n                if (length(face_descriptors[i] - face_descriptors[j]) &lt; threshold)\n                    edges.push_back(sample_pair(i, j));\n            }\n        }\n        std::vector&lt;unsigned long&gt; labels;\n        const int num_clusters = chinese_whispers(edges, labels);\n\n        if (num_clusters == 1)\n        {\n            cout&lt;&lt;\"Recognized\"&lt;&lt;endl;\n        }\n        else\n        {\n                    cout&lt;&lt;\"Faces don't match\";\n        }\n    }\n\n    cout&lt;&lt;\"Needed time is: \"&lt;&lt;timer.elapsed()&lt;&lt;\" ms\"&lt;&lt;endl;\n}\n</code></pre>\n"}, {"tags": ["python", "c++", "raster", "gdal"], "comments": [{"owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "edited": false, "score": 0, "creation_date": 1527693945, "post_id": 50606174, "comment_id": 88226536, "body": "The first argument of GDALFillNoData should be a raster band, not the dataset. Is it just a typo?"}, {"owner": {"reputation": 11, "user_id": 4028701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede8a36a7ad93997ed43dea999baf261?s=128&d=identicon&r=PG&f=1", "display_name": "jheathharwood", "link": "https://stackoverflow.com/users/4028701/jheathharwood"}, "reply_to_user": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "edited": false, "score": 0, "creation_date": 1527694418, "post_id": 50606174, "comment_id": 88226824, "body": "Yes, yes it should be a raster band just like it says in the documentation.   Jeez!  It&#39;s always the simplest thing.  Thanks for your help @GabriellaGiordano!."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4028701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede8a36a7ad93997ed43dea999baf261?s=128&d=identicon&r=PG&f=1", "display_name": "jheathharwood", "link": "https://stackoverflow.com/users/4028701/jheathharwood"}, "edited": false, "score": 0, "creation_date": 1527703462, "post_id": 50609176, "comment_id": 88231777, "body": "Thanks for the explanation.  I was some what confused with the GDALRasterBandH...and the documentation was vague.  GDAL is an amazing library!  And is so capable.   I&#39;ll check out the Rasterix.  The GUI is really sharp.  Thanks again.  Will be updating this code soon."}, {"owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "reply_to_user": {"reputation": 11, "user_id": 4028701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede8a36a7ad93997ed43dea999baf261?s=128&d=identicon&r=PG&f=1", "display_name": "jheathharwood", "link": "https://stackoverflow.com/users/4028701/jheathharwood"}, "edited": false, "score": 0, "creation_date": 1527712579, "post_id": 50609176, "comment_id": 88235893, "body": "Thank you for trying it. Any feedback is appreciated :) feel free to submit comments or issues through GitHub, should you find some problem. We will update the docs very soon."}], "tags": [], "owner": {"reputation": 1038, "user_id": 9636903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DZZnv.png?s=128&g=1", "display_name": "Gabriella Giordano", "link": "https://stackoverflow.com/users/9636903/gabriella-giordano"}, "is_accepted": false, "score": 0, "last_activity_date": 1527696749, "last_edit_date": 1527696749, "creation_date": 1527696444, "answer_id": 50609176, "question_id": 50606174, "link": "https://stackoverflow.com/questions/50606174/c-implementation-of-the-gdal-algorithm-gdalfillnodata/50609176#50609176", "title": "C++ Implementation of the GDAL Algorithm GDALFillNodata()", "body": "<p>As a follow up for the comments above, the problem is the fact that the first argument given to the <a href=\"http://www.gdal.org/gdal__alg_8h.html#a0a079afef61968f224b159d48423d1c6\" rel=\"nofollow noreferrer\">GDALFillNoData API</a> is a GDALDataset* instead of a GDALRasterBand*. </p>\n\n<p>But I've been struggling too much with GDAL to keep myself from giving a much explanatory answer. </p>\n\n<p>The implementation of the GDAL lib is very C oriented, while it is indeed written using C++ features (e.g. classes). \nSo, you will find that in many of the available APIs the arguments are not referring to types defined in the library. Instead, they use typedef like the <a href=\"http://www.gdal.org/gdal_8h.html#aeef8194c3ad5f1ed6ca27ea4cce24685\" rel=\"nofollow noreferrer\">GDALRasterBandH</a>, that are indeed alias to the void* type.</p>\n\n<p>This has the nasty effect that, whatever type of argument you feed to the compiler, it won't complain, hence you will get a lot of errors at runtime if you make such (very common) mistakes.    </p>\n\n<p>Why they do this? I think it was a way to exploit <a href=\"http://en.cppreference.com/w/cpp/language/pimpl\" rel=\"nofollow noreferrer\">PIMPL</a> in order to avoid the compiler to work on several <strong>translation units</strong>, every time one of this classes was modified.</p>\n\n<p>The real problem of this approach is that you lose all the benefits from  <a href=\"https://en.wikipedia.org/wiki/Type_system\" rel=\"nofollow noreferrer\">static type checking</a>, i.e. the compiler telling you when there is a type mismatch. As a side note, this is not a critics to the GDAL lib (thank God we have it!! And it is a huge and very useful project), it's just the way it is.</p>\n\n<p>By the way, I'm currently working on a C++ opensource project, <a href=\"https://github.com/mogasw/rasterix/\" rel=\"nofollow noreferrer\">Rasterix</a>, that is meant to be a user friendly GUI to GDAL tools for raster datasets. Do not take it as <em>do it like me</em> hint, as this app still needs proper testing, but there is a lot of GDAL APIs use cases there that may help if you need sort of examples on how to use them.</p>\n"}], "owner": {"reputation": 11, "user_id": 4028701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede8a36a7ad93997ed43dea999baf261?s=128&d=identicon&r=PG&f=1", "display_name": "jheathharwood", "link": "https://stackoverflow.com/users/4028701/jheathharwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527696749, "creation_date": 1527687430, "last_edit_date": 1527687762, "question_id": 50606174, "link": "https://stackoverflow.com/questions/50606174/c-implementation-of-the-gdal-algorithm-gdalfillnodata", "title": "C++ Implementation of the GDAL Algorithm GDALFillNodata()", "body": "<p>Looking for some help with some C++ code to implement/call the GDALFillNoData() algorithm.  I already have a working version using python and gdal, which is somewhat slow filling elevation DEMs (1.5GB).  I'm curious if this is possible.  I've written the code for a command line application and posted it here.  File paths are hard coded at the moment.  It builds (CodeBlocks 16.1/MinGW) and runs in but then crashes.</p>\n\n<p>I'm not a C++ programmer, though I wish I were, but I'm trying to understand the language better.  I'm moderately decent at python.  I'm likely missing some thing basic here that's normal to C++.</p>\n\n<p>There likely code that's been commented out through testing.  So if something doesn't make sense that's why.</p>\n\n<p>Here's the Code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"gdal.h\"\n#include \"gdal_priv.h\"\n#include \"cpl_conv.h\"\n#include \"gdal_alg.h\"\n\nint main()\n{\n    GDALAllRegister();\n    //CPLPushErrorHandler(CPLQuietErrorHandler);\n\n    // Read/Write Files\n    const char *input = \"D:/myIn.tif\";\n\n    GDALDataset *pSrcDataset;\n    //GDALRasterBandH hMaskBand;\n    GDALRasterBand  *poBand;\n    //CPLErr maskBand;\n    int maskFlags;\n    int noData;\n    double maxSearch = 10.0;\n    int maxInt = 1;\n    int nBlockXSize, nBlockYSize;\n    double adfGeoTransform[6];\n    //CPLErr eErr;\n\n    pSrcDataset = (GDALDataset*) GDALOpen(input, GA_Update);\n    CPLAssert( pSrcDataset != NULL );\n\n    poBand = pSrcDataset-&gt;GetRasterBand( 1 );\n    poBand-&gt;GetBlockSize( &amp;nBlockXSize, &amp;nBlockYSize );\n    printf( \"Block=%dx%d Type=%s, ColorInterp=%s\\n\",\n           nBlockXSize, nBlockYSize,\n           GDALGetDataTypeName(poBand-&gt;GetRasterDataType()),\n           GDALGetColorInterpretationName(\n           poBand-&gt;GetColorInterpretation()) );\n\n    noData = pSrcDataset-&gt;GetRasterBand(1)-&gt;GetNoDataValue();\n    printf( \"No Data Value = %i\\n\",noData );\n\n    printf( \"Driver: %s/%s\\n\",\n           pSrcDataset-&gt;GetDriver()-&gt;GetDescription(),\n           pSrcDataset-&gt;GetDriver()-&gt;GetMetadataItem( GDAL_DMD_LONGNAME ) );\n\n    printf( \"Size is %dx%dx%d\\n\",\n           pSrcDataset-&gt;GetRasterXSize(), pSrcDataset-&gt;GetRasterYSize(),\n           pSrcDataset-&gt;GetRasterCount() );\n\n    if( pSrcDataset-&gt;GetProjectionRef()  != NULL )\n        printf( \"Projection is `%s'\\n\", pSrcDataset-&gt;GetProjectionRef() );\n\n    if( pSrcDataset-&gt;GetGeoTransform( adfGeoTransform ) == CE_None )\n        printf( \"Origin = (%.6f,%.6f)\\n\", adfGeoTransform[0], \n               adfGeoTransform[3] );\n        printf( \"Pixel Size = (%.6f,%.6f)\\n\",adfGeoTransform[1], \n               adfGeoTransform[5] );\n\n    //maskBand = pSrcDataset-&gt;GetRasterBand(1)-&gt;GetMaskBand();\n\n    //hMaskBand = GDALGetMaskBand( maskBand );\n    //hMaskBand = pSrcDataset-&gt;GetRasterBand(1)-&gt;GetNoDataValue();\n    maskFlags = pSrcDataset-&gt;GetRasterBand(1)-&gt;GetMaskFlags();\n    printf ( \"Mask Flags = %i\\n\", maskFlags );\n\n    printf ( \"Processing image\\n\" );\n\n    // Ignore that this is on two lines here\n    GDALFillNodata(pSrcDataset, pSrcDataset-&gt;GetRasterBand(1)- \n    &gt;GetMaskBand(), maxSearch, 0, maxInt, NULL, NULL, NULL); \n    //CPLAssert( eErr == CE_None);\n\n    GDALClose(pSrcDataset);\n\n    return 0;\n}\n</code></pre>\n\n<p>Some errors that I'm getting when running this code (see image links).  The process returns a 255 which is I think something that is unique to CodeBlocks?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ezEBA.jpg\" rel=\"nofollow noreferrer\">Program Crashes</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bqV7b.jpg\" rel=\"nofollow noreferrer\">Process returns 255</a></p>\n\n<p>Here is the python implementation.  Pretty straight forward.  Is None the same as NULL?  Because one of the errors I got when using NULL as the hMaskBand (<a href=\"https://github.com/OSGeo/gdal/blob/master/gdal/alg/rasterfill.cpp\" rel=\"nofollow noreferrer\">rasterfill.cpp</a>)</p>\n\n<pre><code>#Run the gdal fill\n    ET = gdal.Open(infile, GA_Update)\n    ETband = ET.GetRasterBand(1)\n\n    result = gdal.FillNodata(targetBand = ETband, maskBand = None, \n    maxSearchDist = 500, smoothingIterations = 1)\n\n    print result # return 0\n\n    ET = None\n</code></pre>\n\n<p>Please let me know if you need more information.  Knowing what little I know about C++ it's probably my build environment.  :)</p>\n\n<p>Thanks,\nHeath</p>\n"}, {"tags": ["c++", "algorithm", "audio", "signal-processing", "audio-processing"], "comments": [{"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1527692592, "post_id": 50606082, "comment_id": 88225630, "body": "Probably a question for Signal Processing."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 8527205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6838e93db03c589a5ad205de2f4f7a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jedi Nerd", "link": "https://stackoverflow.com/users/8527205/jedi-nerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1528279782, "creation_date": 1528279782, "answer_id": 50717753, "question_id": 50606082, "link": "https://stackoverflow.com/questions/50606082/yin-algorithmpitch-detection-alternative-to-difference-function/50717753#50717753", "title": "Yin algorithm(Pitch detection) - Alternative to Difference Function", "body": "<p>Alright, The Yin paper describes that we can use Equation 7 instead of Equation 6.\nEquation 7 can be arrived at using FFT which is much faster.</p>\n\n<p>A simple search online provided lots of implementation examples to achieve this.</p>\n\n<p>An implementation in JAVA can be found <a href=\"https://github.com/JorenSix/TarsosDSP/blob/master/src/core/be/tarsos/dsp/pitch/FastYin.java\" rel=\"nofollow noreferrer\">here</a> done by a user called JorenSix.\nJorenSix, If you are reading this, Thank You.</p>\n"}], "owner": {"reputation": 29, "user_id": 8527205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6838e93db03c589a5ad205de2f4f7a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jedi Nerd", "link": "https://stackoverflow.com/users/8527205/jedi-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 609, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528279782, "creation_date": 1527687193, "question_id": 50606082, "link": "https://stackoverflow.com/questions/50606082/yin-algorithmpitch-detection-alternative-to-difference-function", "title": "Yin algorithm(Pitch detection) - Alternative to Difference Function", "body": "<p>I have implemented <a href=\"http://audition.ens.fr/adc/pdf/2002_JASA_YIN.pdf\" rel=\"nofollow noreferrer\">Yin Algorithm</a> to detect pitch.</p>\n\n<p>My issue is with the Performance of Difference Function(Equation 6)</p>\n\n<p><strong><em>Difference Function:</em></strong></p>\n\n<pre><code>static std::vector&lt;double&gt; difference(const std::vector&lt;double&gt; &amp;data)\n{\n    int index, tau;\n    double delta;\n    int yin_buffer_size = signed(data.size() / 2);\n    std::vector&lt;double&gt; yin_buffer(yin_buffer_size, 0.0);\n\n    for (tau = 1; tau &lt; yin_buffer_size; tau++) {\n        for (index = 0; index &lt; yin_buffer_size; index++) {\n            delta = data[index] - data[index + tau];\n            yin_buffer[tau] += delta * delta;\n        }\n    }\n    return yin_buffer;\n}\n</code></pre>\n\n<p>where <code>data</code> contains the audio data for a specific window size.</p>\n\n<p>As you can see this function gets slower as you increase the data size(window size).</p>\n\n<p>Please let me know if there is an alternative to the Difference Function which is faster. I want to move ahead in the right direction.</p>\n\n<p>I'm quite new to signal processing, Your help is greatly appreciated.</p>\n"}, {"tags": ["c++", "singleton", "phoenix"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1527687140, "post_id": 50606016, "comment_id": 88221528, "body": "where is <code>pInstance_</code> declared?"}, {"owner": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "reply_to_user": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1527687177, "post_id": 50606016, "comment_id": 88221555, "body": "at the bottom, scroll down, its a static pointer member"}], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "edited": false, "score": 0, "creation_date": 1527689310, "post_id": 50606459, "comment_id": 88223208, "body": "thats my question, the create assigns it to local static object, which is already destroyed, does it still have address? How that works?"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1527689395, "post_id": 50606459, "comment_id": 88223282, "body": "<code>KillPhoenixSingleton()</code> only calls destructor for the object that memory is still there."}, {"owner": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "edited": false, "score": 0, "creation_date": 1527690340, "post_id": 50606459, "comment_id": 88223985, "body": "yes, and in the destructor, it assigns pointer to 0, so its not pointing to the same memory anymore, and the next call of create, it will point to deleted local static, how come? And one more question, why we are trying to create it on the same address? isnt just enough to create it?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "edited": false, "score": 1, "creation_date": 1527690790, "post_id": 50606459, "comment_id": 88224332, "body": "@EduardRostomyan: In the next call of <code>Create</code>, <code>pInstance</code> is changed back to point at the <b>destroyed</b> local static. The term &quot;deleted&quot; is misleading because it suggests <code>delete</code>. However, <code>new&#47;delete</code> is used to create and destroy objects with <i>dynamic storage duration</i>, so don&#39;t use the term &quot;deleted&quot; in combination with with static storage duration."}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 2, "last_activity_date": 1527689910, "last_edit_date": 1527689910, "creation_date": 1527688305, "answer_id": 50606459, "question_id": 50606016, "link": "https://stackoverflow.com/questions/50606016/how-we-place-phoenix-singleton-on-same-address-c/50606459#50606459", "title": "How we place Phoenix Singleton on same address? C++", "body": "<p>The \"Phoenix\" name comes from the legendary bird that died, caught fire and was born again from its ashes.</p>\n\n<p>In this case, yes, the Singleton can die, the destructor runs, <code>pInstance</code> becomes <code>nullptr</code>, and it's gone - until it needs to revive. When that happens, <code>Create</code> makes <code>pInstance</code> non-null before <code>new (pInstance) Singeton</code> recreates the object.</p>\n\n<p>[edit]\nYou need to know the rules for object lifetimes and storage duration. Obviously, the storage for an object must be allocated before an object is created, and the storage must not be deallocated until the object is destroyed. The interval in between is known as the <em>storage duration</em>. Now, there is such a thing as <em>static storage duration</em>. Such storage isn't reclaimed until the program exits, even if the object in that storage is destroyed. Variables defined at namespace scope (\"globals\") and <code>static</code> variables have this static storage duration.</p>\n\n<p>Therefore, the storage for <code>theSingleton</code> has static storage duration, and <code>pInstance</code> can point to this storage even if the object there is <code>destroyed</code>. Note that the <code>destroyed</code> and <code>pInstance</code> variables themselves also have static storage duration, as they're globals.</p>\n"}], "owner": {"reputation": 5144, "user_id": 1856429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/AiPnN.jpg?s=128&g=1", "display_name": "Eduard Rostomyan", "link": "https://stackoverflow.com/users/1856429/eduard-rostomyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 1, "accepted_answer_id": 50606459, "answer_count": 1, "score": 0, "last_activity_date": 1527689910, "creation_date": 1527687008, "last_edit_date": 1527687229, "question_id": 50606016, "link": "https://stackoverflow.com/questions/50606016/how-we-place-phoenix-singleton-on-same-address-c", "title": "How we place Phoenix Singleton on same address? C++", "body": "<p>below code illustrates the <a href=\"http://www.cs.fsu.edu/~lacher/lectures/Output/loki6/index.html?$$$slide01.html$$$\" rel=\"nofollow noreferrer\">Phoenix Singleton</a> described in <a href=\"https://en.wikipedia.org/wiki/Andrei_Alexandrescu\" rel=\"nofollow noreferrer\">Andrey Alexandrescu's</a> Modern C++ Design book.</p>\n\n<pre><code>Singleton&amp; Instance()\n{\n   if (!pInstance_)\n   {\n   // Check for dead reference\n      if (destroyed_)\n      {\n         OnDeadReference();\n      }\n      else\n      {\n   // First call\u2014initialize\n         Create();\n      }\n   }\nreturn pInstance_;\n}\n\nvoid Singleton::OnDeadReference()\n{\n// Obtain the shell of the destroyed singleton\n   Create();\n// Now pInstance_ points to the \"ashes\" of the singleton\n// - the raw memory that the singleton was seated in.\n// Create a new singleton at that address\n   new(pInstance_) Singleton;\n// Queue this new object's destruction\n   atexit(KillPhoenixSingleton);\n// Reset destroyed_ because we're back in business\n   destroyed_ = false;\n}\n\nstatic void Create();\n{\n\n// Task: initialize pInstance_\n   static Singleton theInstance;\n   pInstance_ = &amp;theInstance;\n}\n\nvoid Singleton::KillPhoenixSingleton()\n{\n// Make all ashes again\n// - call the destructor by hand.\n// It will set pInstance_ to zero and destroyed_ to true\n   pInstance_-&gt;~Singleton();\n}\n\n\nvirtual ~Singleton()\n{\n   pInstance_ = 0;\n   destroyed_ = true;\n}\n\nSingleton* Singleton::pInstance_ = 0;\nbool Singleton::destroyed_ = false;\n</code></pre>\n\n<p>Quote from the book:  </p>\n\n<blockquote>\n  <p>Let's analyze the flow of events. During the application exit sequence, Singleton's destructor is called.\n  The destructor resets the pointer to zero and sets destroyed_ to true. Now assume some global object\n  tries to access Singleton again. Instance calls OnDeadReference. OnDeadReference\n  reanimates Singleton and queues a call to KillPhoenixSingleton, and Instance successfully\n  returns a reference to a valid Singleton object. From now on, the cycle may repeat.</p>\n</blockquote>\n\n<p>My question is -  if we assign to pointer <code>pInstance_ = 0</code> in the destructor, than it assigns to a local static reference which should be deleted by that point, how that we place a new object at 0 address? Please tell me that I am missing something. If someone can explain me the flow, I would really appreciate. Thanks</p>\n"}, {"tags": ["c++", "class", "oop", "variable-assignment"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1527687074, "post_id": 50606007, "comment_id": 88221463, "body": "A class&#39; data members are fully initialized before the constructor body begins. If you want to specify an initialization other than the default constructor, you will need to use a <a href=\"http://en.cppreference.com/w/cpp/language/initializer_list\" rel=\"nofollow noreferrer\">member initializer list</a>."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 2, "creation_date": 1527687129, "post_id": 50606007, "comment_id": 88221517, "body": "You have <code>B</code> and <code>b</code> in the constructor. What is <code>cosmology</code>?"}, {"owner": {"reputation": 41, "user_id": 7454409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54390310cfad5e215c0777a9a273ecb?s=128&d=identicon&r=PG&f=1", "display_name": "anonMouse", "link": "https://stackoverflow.com/users/7454409/anonmouse"}, "edited": false, "score": 0, "creation_date": 1527687179, "post_id": 50606007, "comment_id": 88221558, "body": "Okay thanks, I kept coming across this when I was trying to find a solution on here. Problem was that I didn&#39;t understand what a member initializer list is and I was hoping there was an easier solution. I will try and understand this now. Do you think I should remove my question?"}, {"owner": {"reputation": 41, "user_id": 7454409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54390310cfad5e215c0777a9a273ecb?s=128&d=identicon&r=PG&f=1", "display_name": "anonMouse", "link": "https://stackoverflow.com/users/7454409/anonmouse"}, "edited": false, "score": 0, "creation_date": 1527687232, "post_id": 50606007, "comment_id": 88221593, "body": "Cosmology was the original name of class_two, apologies!"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 2, "creation_date": 1527687263, "post_id": 50606007, "comment_id": 88221620, "body": "<i>&quot;easier solution&quot;</i> - There is nothing easier than a member initializer list, it&#39;s basically <code>class_one(double A = 0.5, double B = 0.2) : a(A), class2(B) { }</code> instead of your current constructor."}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "edited": false, "score": 1, "creation_date": 1527687364, "post_id": 50606007, "comment_id": 88221677, "body": "But your problem is not here... Your code works fine (<a href=\"https://wandbox.org/permlink/819PMdAORhuO08xO\" rel=\"nofollow noreferrer\">wandbox.org/permlink/819PMdAORhuO08xO</a>) once the typos are fixed... You need to provide an example that reproduces the problem (and that you tested, i.e. compiled and run, before posting)."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 2, "last_activity_date": 1527688349, "creation_date": 1527688349, "answer_id": 50606472, "question_id": 50606007, "link": "https://stackoverflow.com/questions/50606007/c-unable-to-reassign-class-online-the-default-constructor-is-used/50606472#50606472", "title": "C++: Unable to reassign class, online the default constructor is used", "body": "<p>When the constructor of a class is called, then - before its body starts executing - all of its data members are initialized. That means that for `class_two, the default constructor is called for its creation, since you don't say anything different.</p>\n\n<p>In order to achieve your goal, use an <strong>initialization list</strong>, like this:</p>\n\n<pre><code>class_one(double A = 0.5, double B = 0.2) : a(A), class_two(B) {\n    // leave it empty in this case\n}\n</code></pre>\n\n<p>PS: I initialized <code>a</code> via the initializer list as well, which is unrelated to your question, but a good habit to have, since initialization of data members is usually done via the initialization list, and not in the body of the constructor itself.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7454409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54390310cfad5e215c0777a9a273ecb?s=128&d=identicon&r=PG&f=1", "display_name": "anonMouse", "link": "https://stackoverflow.com/users/7454409/anonmouse"}, "is_accepted": false, "score": 0, "last_activity_date": 1527689231, "creation_date": 1527689231, "answer_id": 50606803, "question_id": 50606007, "link": "https://stackoverflow.com/questions/50606007/c-unable-to-reassign-class-online-the-default-constructor-is-used/50606803#50606803", "title": "C++: Unable to reassign class, online the default constructor is used", "body": "<p>My mistake was very dum and not very interesting.</p>\n\n<p>Basically I was using class2 to assign variables but I was only reassigning class2 after I had done this. I hadn't realised this.</p>\n\n<p>Thanks <strong>Holt</strong> for showing me that my problem was not where I thought it was and <strong>gsamaras</strong> and <strong>Fran\u00e7ois Andrieux</strong> for explaining that it's best to use an initialization list for this scenario!</p>\n\n<pre><code>class class_one {\n\nprivate:\n    double a;\n    class_two class2;\n\npublic:\n\n    class_one(double A = 0.5, double B = 0.2) {\n        a = A*set_a();\n        class2 = class_two(b);\n    }\n\n    double set_a(){\n        return class2.some_function();\n    }\n\n    double calculation(){\n        return A*class2.get_b();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7454409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54390310cfad5e215c0777a9a273ecb?s=128&d=identicon&r=PG&f=1", "display_name": "anonMouse", "link": "https://stackoverflow.com/users/7454409/anonmouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1527689231, "creation_date": 1527686978, "last_edit_date": 1527688416, "question_id": 50606007, "link": "https://stackoverflow.com/questions/50606007/c-unable-to-reassign-class-online-the-default-constructor-is-used", "title": "C++: Unable to reassign class, online the default constructor is used", "body": "<p>I am trying to use a class that I have written in another class. The problem is I am having difficulty using anything but the default parameters/constructor from the original class. </p>\n\n<p>I have simplified the classes below to show what I am trying to achieve (I have tried all the variations on this I could think of but I think fundamentally I do not understand what's going on).</p>\n\n<p>When I call <strong>class_two</strong> through <strong>class_one</strong> I want to use my own values for the calculation. However when I try this I just get the default parameters written in <strong>class_two</strong>.</p>\n\n<pre><code>class class_one {\n\nprivate:\n    double a;\n    class_two class2;\n\npublic:\n\n    class_one(double A = 0.5, double B = 0.2) {\n        a = A;\n        class2 = class_two(b);\n    }\n\n    double calculation(){\n        return A*class2.get_b();\n    }\n}\n</code></pre>\n\n<p>Where <strong>class_two</strong> would be,</p>\n\n<pre><code>class class_two {\n\nprivate:\n    double b;\n\npublic:\n    class_two(double B = 0.5){\n        b = B;\n    }\n\n    double get_b(){\n         return b;\n    }\n\n}\n</code></pre>\n\n<p>Example of what I am trying to run,</p>\n\n<pre><code>class_one().calculation();\n\nactual output: A*B = 0.5 * 0.5 (Where the B values comes from class_two)\n\ndesired output: A*B = 0.5 * 0.2 (Where the B values comes from class_one)\n</code></pre>\n\n<p>Apologies this seems like a super simple question but I cannot get it to work!</p>\n"}, {"tags": ["c++", "templates"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 3, "creation_date": 1527686815, "post_id": 50605907, "comment_id": 88221272, "body": "Use <code>if constexpr</code> instead of plain <code>if</code>. Or ditch templates and make two overloads of your function."}, {"owner": {"reputation": 361191, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527687062, "post_id": 50605907, "comment_id": 88221457, "body": "For this I would rather use polymorphism to print the output. The templated function calls a virtual function in the object to do the actual printing, and it can print whatever it wants or needs. The printing function for <code>duo</code> could even all the <code>solo</code> print function to print <code>a</code>. Especially if the inheritance tree is large or you have many child-classes."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9870478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Hugo", "link": "https://stackoverflow.com/users/9870478/hugo"}, "edited": false, "score": 0, "creation_date": 1527687537, "post_id": 50605968, "comment_id": 88221841, "body": "Hi Holt, Thanks for your prompt answer. I was just expecting templates to allow me to do this without overloading functions. Is it impossible? Or is it really better practice to do as you suggest?"}, {"owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "reply_to_user": {"reputation": 91, "user_id": 9870478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Hugo", "link": "https://stackoverflow.com/users/9870478/hugo"}, "edited": false, "score": 1, "creation_date": 1527687689, "post_id": 50605968, "comment_id": 88221966, "body": "@Hugo You can always use a template and <code>if constexpr</code> (C++17) but that&#39;s harder to maintain and extend than this (you simply have to add new function). You could also use polymorphism as mentioned by SomeProgrammerDude, but that would require virtual classes, and you would still need two (member) functions."}], "tags": [], "owner": {"reputation": 32126, "user_id": 2666289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/746dd23bbe20769fbd758421e67f455c?s=128&d=identicon&r=PG", "display_name": "Holt", "link": "https://stackoverflow.com/users/2666289/holt"}, "is_accepted": false, "score": 1, "last_activity_date": 1527686882, "creation_date": 1527686882, "answer_id": 50605968, "question_id": 50605907, "link": "https://stackoverflow.com/questions/50605907/c-template-using-stdis-same-v-instead-of-specializing-and-avoid-compilat/50605968#50605968", "title": "C++ template - using &quot;std::is_same_v&quot; instead of specializing and avoid compilation error?", "body": "<p>You don't need template for this since <code>duo</code> extends <code>solo</code>. Simply call <code>function(solo)</code> from <code>function(duo)</code>:</p>\n\n<pre><code>void function(solo test) {\n   std::cout &lt;&lt; std::to_string(test.a);\n}\n\nvoid function(duo test) {\n   function((solo) test);\n   std::cout &lt;&lt; std::to_string(test.b);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 9870478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Hugo", "link": "https://stackoverflow.com/users/9870478/hugo"}, "edited": false, "score": 0, "creation_date": 1527696708, "post_id": 50608340, "comment_id": 88228185, "body": "Thanks for your answer. Now I have a better understanding of what was happening and how I could do. I will just go with &quot;classic overload of functions&quot; as suggested by Holt but I&#39;m choosing your answer since it was the one that really helped me understand how this works. And thanks to everyone for your very prompt and kind answers:)"}, {"owner": {"reputation": 509, "user_id": 3412316, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ef26d64b7c449b57651eeef354007f97?s=128&d=identicon&r=PG&f=1", "display_name": "Kiruahxh", "link": "https://stackoverflow.com/users/3412316/kiruahxh"}, "edited": false, "score": 0, "creation_date": 1616062835, "post_id": 50608340, "comment_id": 117887818, "body": "How do you choose the return type of <code>function</code> ?"}, {"owner": {"reputation": 3120, "user_id": 4402721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WCNcL.jpg?s=128&g=1", "display_name": "drRobertz", "link": "https://stackoverflow.com/users/4402721/drrobertz"}, "edited": false, "score": 0, "creation_date": 1616076278, "post_id": 50608340, "comment_id": 117894234, "body": "The return type is the second argument of <code>enable_if</code>. Look up <code>std::enable_if</code> for details."}], "tags": [], "owner": {"reputation": 3120, "user_id": 4402721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WCNcL.jpg?s=128&g=1", "display_name": "drRobertz", "link": "https://stackoverflow.com/users/4402721/drrobertz"}, "is_accepted": true, "score": 7, "last_activity_date": 1527781917, "last_edit_date": 1527781917, "creation_date": 1527693684, "answer_id": 50608340, "question_id": 50605907, "link": "https://stackoverflow.com/questions/50605907/c-template-using-stdis-same-v-instead-of-specializing-and-avoid-compilat/50608340#50608340", "title": "C++ template - using &quot;std::is_same_v&quot; instead of specializing and avoid compilation error?", "body": "<p>To answer your question about templates (although in this particular application, it is not the right solution, for many reasons):</p>\n\n<p>The reason it doesn't work as you wrote it is that template instantiation happens at compile-time, and the only thing happening then is that the value of <code>std::is_same</code> is computed for the template argument. Thus, in the code for <code>function&lt;solo&gt;</code> the line </p>\n\n<pre><code>if(std::is_same&lt;T, duo&gt;::value) std::cout&lt;&lt; std::to_string(test.b);\n</code></pre>\n\n<p>would be like</p>\n\n<pre><code>if(false) std::cout&lt;&lt; std::to_string(test.b);\n</code></pre>\n\n<p>which doesn't compile as there is no member <code>b</code> in <code>test</code>.</p>\n\n<p>To make it work, you need two templates and use SFINAE to select the correct one when instantiating the template (and as function templates cannot be partially specialized, you need to write it something like the following, which is really a silly way of writing two overloads. Or you can fully specialize the template, but then you wouldn't use <code>if_same</code>).</p>\n\n<pre><code>template&lt;class T&gt;\ntypename std::enable_if&lt;!std::is_same&lt;T, duo&gt;::value, void&gt;::type function(T test){\n std::cout&lt;&lt; std::to_string(test.a);\n}\n\ntemplate&lt;class T&gt;\ntypename std::enable_if&lt;std::is_same&lt;T, duo&gt;::value, void&gt;::type function(T test){\n std::cout&lt;&lt; std::to_string(test.a);\n std::cout&lt;&lt; std::to_string(test.b);\n}\n</code></pre>\n\n<p>Further, note that is_same looks at the static type of the variable, so if you have a <code>solo&amp;</code> to a <code>duo</code> object, it would still choose the <code>solo</code> overload.</p>\n\n<p>A somewhat less silly use of templates is to write a function template that can handle <em>any type</em> that has a member <code>int b</code>.\nThis uses a helper metafunction (a struct, so we can use partial specialization):</p>\n\n<pre><code>template &lt;class T, class = int&gt;\nstruct has_member_b : std::false_type {};\n\ntemplate &lt;class T&gt; \nstruct has_member_b&lt;T, decltype(std::declval&lt;T&gt;().b)&gt; : std::true_type {};   \n\ntemplate&lt;class T&gt;\ntypename std::enable_if&lt;has_member_b&lt;T&gt;::value, void&gt;::type function(T test){\n    std::cout&lt;&lt; std::to_string(test.a);\n    std::cout&lt;&lt; std::to_string(test.b);\n}\n\ntemplate&lt;class T&gt;\ntypename std::enable_if&lt;!has_member_b&lt;T&gt;::value, void&gt;::type function(T test) {\n    std::cout&lt;&lt; std::to_string(test.a);\n}\n</code></pre>\n\n<p>(Do note that both versions assume there to be a member <code>a</code>, if not it will not compile)</p>\n"}, {"tags": [], "owner": {"reputation": 1033, "user_id": 3410010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFRd3.jpg?s=128&g=1", "display_name": "yadhu", "link": "https://stackoverflow.com/users/3410010/yadhu"}, "is_accepted": false, "score": 2, "last_activity_date": 1550166360, "creation_date": 1550166360, "answer_id": 54696275, "question_id": 50605907, "link": "https://stackoverflow.com/questions/50605907/c-template-using-stdis-same-v-instead-of-specializing-and-avoid-compilat/54696275#54696275", "title": "C++ template - using &quot;std::is_same_v&quot; instead of specializing and avoid compilation error?", "body": "<p>With the introduction of <code>constexpr if(cond)</code> in C++17 you can achieve your goal. <code>constexpr if(cond)</code> gets evaluated at compile time, hence you can choose what you want to do depending the type of the parameter. Following snippet provides an illustration.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\nstruct solo{\n  int a;     \n};\n\nstruct duo : solo{\n    int b;\n};\n\ntemplate&lt;class T&gt;\nvoid function(T test){ \n if constexpr (std::is_same&lt;T, duo&gt;::value) \n    std::cout&lt;&lt; std::to_string(test.b)&lt;&lt;\"\\n\";\n else if constexpr (std::is_same&lt;T, solo&gt;::value) \n    std::cout&lt;&lt; std::to_string(test.a)&lt;&lt;\"\\n\";\n}\n\nint main()\n{\n  solo test1;\n  test1.a = 1;\n\n  duo test2;\n  test2.b = 2;\n\n  function(test1);\n  function(test2);\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9870478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Hugo", "link": "https://stackoverflow.com/users/9870478/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10292, "favorite_count": 4, "accepted_answer_id": 50608340, "answer_count": 3, "score": 8, "last_activity_date": 1609888453, "creation_date": 1527686709, "last_edit_date": 1609888453, "question_id": 50605907, "link": "https://stackoverflow.com/questions/50605907/c-template-using-stdis-same-v-instead-of-specializing-and-avoid-compilat", "title": "C++ template - using &quot;std::is_same_v&quot; instead of specializing and avoid compilation error?", "body": "<p>I'm new to templates and I'm trying to use them in order to avoid duplicating functions that are very much alike.</p>\n<p>In the example below, I made a simple and small working example showing my issue.</p>\n<p>In particular, I have two <code>struct</code> (&quot;solo&quot; and &quot;duo&quot;). Those struct's have a common member (a) and one of them has a specific member (b).</p>\n<p>Then I have a template function that can take either struct and print the member a... and I wanted it to be able to print member b only if the struct type is &quot;duo&quot;.</p>\n<p>The way I did (using <code>std::is_same_v</code>) it doesn't compile. I read that one can use specialization to do so, however I was wondering if there is not a more elegant way? Because then I have the feeling to loose the advantage of templates... but probably I don't get the power of templates yet and how/for what to use them.</p>\n<p>Thank you very much for your help!</p>\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;type_traits&gt;\n\nstruct solo{\n  int a;     \n};\n\nstruct duo : solo{\n    int b;\n};\n\ntemplate&lt;class T&gt;\nvoid function(T test){\n std::cout&lt;&lt; std::to_string(test.a);\n if(std::is_same&lt;T, duo&gt;::value) std::cout&lt;&lt; std::to_string(test.b);\n}\n\nint main()\n{\n  solo testS;\n  testS.a = 1;\n\n  function(testS);\n}\n</code></pre>\n"}, {"tags": ["c++", "visual-studio", "unresolved-external"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1527686603, "post_id": 50605817, "comment_id": 88221123, "body": "You could look at the assembly language for the program and see where it calls out to. Or run the program and F11 into the function to see where it goes."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1527687287, "post_id": 50605817, "comment_id": 88221631, "body": "Having the linker produce a .map file in the 32-bit build would be the simplest way to find it."}, {"owner": {"reputation": 4533, "user_id": 2504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef5b308d33027fab8440d223828fe4c?s=128&d=identicon&r=PG", "display_name": "Robert Andrzejuk", "link": "https://stackoverflow.com/users/2504757/robert-andrzejuk"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1527689515, "post_id": 50605817, "comment_id": 88223374, "body": "@RaymondChen the errors are from a linker issue. So it cannot  be debugged."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1527691293, "post_id": 50605817, "comment_id": 88224695, "body": "Debug the 32-bit version that works. My guess it&#39;s in a library that you haven&#39;t converted to 64-bit."}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 0, "last_activity_date": 1527757877, "creation_date": 1527757877, "answer_id": 50620639, "question_id": 50605817, "link": "https://stackoverflow.com/questions/50605817/32-bit-to-64-bit-lnk2019-error-how-to-retrieve-relevant-information/50620639#50620639", "title": "32-bit to 64-bit : LNK2019 error, how to retrieve relevant information", "body": "<p>Hans, the advise about the *.map file was a life saver: this allowed me to know in which file the mentioned function was to be found.<br>\nObviously, that was not the end of it: the mentioned file was a DLL, while there is no reference towards the DLL itself, but towards a LIB file, who redirects towards the DLL.<br>\nIn case this is not difficult enough: the function itself was a <code>__imp_</code> function, and there seems to be a catch there:</p>\n\n<ul>\n<li>32-bit : <code>__imp__</code> functions (watch both underscores after <code>imp</code>)</li>\n<li>64-bit : <code>__imp_</code> functions (watch the single underscore after <code>imp</code>)</li>\n</ul>\n\n<p>Finally I solved the issue by checking the build output (compare <code>LIB=</code> and <code>PATH=</code> entries and make sure they are similar for both cases: when there is a reference to the 32-bit libraries in one output, there should be a reference to the 64-bit libraries in the other output).<br>\nIn the 32-bit output, I saw that the linker was referring to a lib, which he did not do in case of the 64-bit linking: I added the corresponding lib in the project's configuration (Configuration properties, Linker, Input, Additional Dependencies), and this finally solved the issue.</p>\n"}], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 50620639, "answer_count": 1, "score": 0, "last_activity_date": 1527757877, "creation_date": 1527686456, "question_id": 50605817, "link": "https://stackoverflow.com/questions/50605817/32-bit-to-64-bit-lnk2019-error-how-to-retrieve-relevant-information", "title": "32-bit to 64-bit : LNK2019 error, how to retrieve relevant information", "body": "<p>I'm working on a 32-bit C++ application, which I'm converting to a 64-bit application (simply choose another configuration, copy and adapt all relevant settings, and try to get it to build), and now I get stuck on linker error <code>LNK2019 \"unresolved external symbol ... referenced in function ...\"</code>, and I'd like to get more information:<br>\nI have already re-built the application in 32-bit, and I've found the referred function, but when I press F12, Shift+F12 or Ctrl+F12 I don't see where the implementation is retrieved from.</p>\n\n<p>I think that the function's implementation is somewhere inside a DLL, but I want to be sure of it (once this is confirmed, I can look for the corresponding settings, defining the location, and copy this setting for my 64-bit configuration).</p>\n\n<p>Maybe the question can be reformulated in the following way: in case a function is retrieved from a DLL, is it possible to know in which DLL this function is implemented?</p>\n"}, {"tags": ["c++", "opengl", "pbo"], "comments": [{"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 7, "creation_date": 1527686117, "post_id": 50605653, "comment_id": 88220756, "body": "I have no idea what I am talking about, but my blind guess is: You use two buffers so that at any time one can be written and the other can be read without reads and writes interfering, memory is rather cheap compared to the cost of avoiding race conditions"}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1527686383, "post_id": 50605653, "comment_id": 88220961, "body": "IMHO I think it&#39;s like this: Imagine that one of the PBO&#39;s is being sent to the render buffer to be drawn to the screen. While this operation is taking place during this current frame, what if the information in the PBO is to change before the next frame or draw call... Instead of waiting for the frame to finish drawing, getting the information back, then updating it and sending it back to the render buffer, the updates can take place in the background during the current draw frame, then once that frame is done drawing it can nearly immediately swap the buffers to draw the updated information."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1527686511, "post_id": 50605653, "comment_id": 88221054, "body": "Don&#39;t exactly quote me on it for I have not used PBOs as I mostly have used vbo and vba and rbo mostly, but that is what I think the reasoning would be."}, {"owner": {"reputation": 131, "user_id": 9250784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af77ba29be84c4b8237a63b3304e97d4?s=128&d=identicon&r=PG&f=1", "display_name": "cds84", "link": "https://stackoverflow.com/users/9250784/cds84"}, "reply_to_user": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1527686741, "post_id": 50605653, "comment_id": 88221224, "body": "@FrancisCugler Thanks. But, the information in the PBO cannot change. Any attempt to change it will stall the GPU untill it is nolonger used. OR if the buffer has been orphaned by the glBufferData(...NULL), then any attempt to modify it simply provides a brand new buffer."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 1, "creation_date": 1527686829, "post_id": 50605653, "comment_id": 88221284, "body": "@cds84 didn&#39;t you just answer your own question there?  &quot;Any attempt to change it will stall the GPU untill it is nolonger used&quot;  ie you need 2 so that you don&#39;t stall the GPU"}, {"owner": {"reputation": 131, "user_id": 9250784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af77ba29be84c4b8237a63b3304e97d4?s=128&d=identicon&r=PG&f=1", "display_name": "cds84", "link": "https://stackoverflow.com/users/9250784/cds84"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527687021, "post_id": 50605653, "comment_id": 88221421, "body": "@UKMonkey NO. &quot;OR if the buffer has been orphaned by the glBufferData(...NULL)&quot;... This was the question... The buffer is orphaned, so no stall will take place. A new buffer will be allocated if a stall WOULD have taken place. So a second PBO is not required.. surely?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527687175, "post_id": 50605653, "comment_id": 88221554, "body": "@cds84 &quot;A new buffer will be allocated if a stall WOULD have taken place&quot; so a 2nd will be made for you?  Still seems like a second to me.  The problem is that by allocating a new buffer every time, it&#39;s a bigger drain than having 2 and reusing them both; and while you may not notice the difference on your hardware for the given example, slower hardware might be more obvious."}, {"owner": {"reputation": 131, "user_id": 9250784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af77ba29be84c4b8237a63b3304e97d4?s=128&d=identicon&r=PG&f=1", "display_name": "cds84", "link": "https://stackoverflow.com/users/9250784/cds84"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527688202, "post_id": 50605653, "comment_id": 88222373, "body": "@UKMonkey Thanks. Perhaps the Author intended to enable the <i>new buffer</i> feature... But try to prevent it from being required. Could any Guru&#39;s comment? It was my understanding that this kind of behavior was very cheap. (similar to D3D_DISCARD?)"}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1527689416, "post_id": 50605653, "comment_id": 88223299, "body": "@cds84 Oh okay I think I vaguely remember reading something about the PBO not being able to change its data internally; it&#39;s been a while since I&#39;ve read any material or docs on it, and as I stated the applications that I work with mostly just use basic vbo &amp; vba. Once in a while I may use a frame buffer or render to texture; I&#39;ve never really had a use to work with the PBO&#39;s directly."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 9250784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af77ba29be84c4b8237a63b3304e97d4?s=128&d=identicon&r=PG&f=1", "display_name": "cds84", "link": "https://stackoverflow.com/users/9250784/cds84"}, "is_accepted": true, "score": 1, "last_activity_date": 1527715374, "creation_date": 1527715374, "answer_id": 50613527, "question_id": 50605653, "link": "https://stackoverflow.com/questions/50605653/why-is-using-multiple-pixel-buffer-objects-advised-surely-it-is-redundant/50613527#50613527", "title": "Why is using multiple Pixel buffer Objects advised. Surely it is redundant?", "body": "<p>Answering my own question... But I wont accept it as an answer... (YET).</p>\n\n<p>There are many problems with the benchmark program linked to in the question. It uses immediate mode. It uses GLUT! </p>\n\n<p>The program was spending most of its time doing things we are not interested in profiling. Mainly rendering text via GLUT, and writing pretty stripes to the texture. So I have removed those functions.</p>\n\n<p>I cranked the texture resultion up to 8K, and added more <em>PBO Modes</em>.</p>\n\n<ul>\n<li><p>NO PBO (yeilds 6fps)</p></li>\n<li><p>1 PBO. Orphan previous buffer. (yields 12.2 fps).</p></li>\n<li><p>2 PBO's. Orpha previous buffer. (yields 12.2 fps).</p></li>\n<li><p>1 PBO. DONT orphan previous PBO (possible stall - added by myself. yields 12.4 fps).</p></li>\n<li><p>2 PBO's. DONT orphan previous PBO (possible stall - added by myself. yields 12.4 fps).</p></li>\n</ul>\n\n<p>If anyone else would like to examine my code, it is vailable <a href=\"https://gitlab.com/cds84/pboUnpack\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>I have experimented with different texture sizes... and different updatePixels functions... I cannot, despite my best efforts get the double PBO implementation to perform any better than the single-PBO implementation.</p>\n\n<p>Furthermore... NOT orphanning the previous buffer, actually vields better performance. Exactly opposite to what the article claims.</p>\n\n<p>Perhaps modern drivers / hardware does not suffer the problem that this design is attemtping to fix...</p>\n\n<p>Perhaps my graphics hardware / driver is buggy, and not taking advantage of the double-PBO...</p>\n\n<p>Perhaps the commonly referenced article is completely wrong?</p>\n\n<p>Who knows. . . .\nMy test hardware is Intel(R) HD Graphics 5500 (Broadwell GT2).</p>\n"}], "owner": {"reputation": 131, "user_id": 9250784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af77ba29be84c4b8237a63b3304e97d4?s=128&d=identicon&r=PG&f=1", "display_name": "cds84", "link": "https://stackoverflow.com/users/9250784/cds84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 1, "accepted_answer_id": 50613527, "answer_count": 1, "score": 8, "last_activity_date": 1527715374, "creation_date": 1527686001, "last_edit_date": 1527687690, "question_id": 50605653, "link": "https://stackoverflow.com/questions/50605653/why-is-using-multiple-pixel-buffer-objects-advised-surely-it-is-redundant", "title": "Why is using multiple Pixel buffer Objects advised. Surely it is redundant?", "body": "<p><a href=\"http://www.songho.ca/opengl/gl_pbo.html\" rel=\"noreferrer\">This</a> article is commonly referenced when anyone asks about video streaming textures in OpenGL.</p>\n\n<p>It says:</p>\n\n<blockquote>\n  <p>To maximize the streaming transfer performance, you may use multiple pixel buffer objects. The diagram shows that 2 PBOs are used simultaneously; glTexSubImage2D() copies the pixel data from a PBO while the texture source is being written to the other PBO. </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/cNA4z.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/cNA4z.png\" alt=\"Double PBO\"></a></p>\n\n<blockquote>\n  <p>For nth frame, PBO 1 is used for glTexSubImage2D() and PBO 2 is used to get new texture source. For n+1th frame, 2 pixel buffers are switching the roles and continue to update the texture. Because of asynchronous DMA transfer, the update and copy processes can be performed simultaneously. CPU updates the texture source to a PBO while GPU copies texture from the other PBO. </p>\n</blockquote>\n\n<p>They provide a simple bench-mark program which allows you to cycle between texture updates without PBO's, with a single PBO, and with two PBO's used as described above.</p>\n\n<p>I see a slight performance improvement when enabling one PBO.\nBut the second PBO makes no real difference.</p>\n\n<p>Right before the code glMapBuffer's the PBO, it calls glBufferData with the pointer set to NULL. It does this to avoid a sync-stall.</p>\n\n<pre><code>// map the buffer object into client's memory\n// Note that glMapBufferARB() causes sync issue.\n// If GPU is working with this buffer, glMapBufferARB() will wait(stall)\n// for GPU to finish its job. To avoid waiting (stall), you can call\n// first glBufferDataARB() with NULL pointer before glMapBufferARB().\n// If you do that, the previous data in PBO will be discarded and\n// glMapBufferARB() returns a new allocated pointer immediately\n// even if GPU is still working with the previous data.\n</code></pre>\n\n<p>So, Here is my question...\nDoesn't this make the second PBO completely useless? Just a waste of memory !?</p>\n\n<p>With two PBO's the texture data is stored 3 times. 1 in the texture, and one in each PBO.</p>\n\n<p>With a single PBO. There are two copies of the data. And temporarily only a 3rd in the event that glMapBuffer creates a new buffer because the existing one is presently being DMA'ed to the texture?</p>\n\n<p>The comments seem to suggest that OpenGL drivers internally are capable to creating the second buffer IF and only WHEN it is required to avoid stalling the pipeline. The in-use buffer is being DMA'ed, and my call to map yields a new buffer for me to write to.</p>\n\n<p>The Author of that article appears to be more knowledgeable in this area than myself. Have I completely mis-understood the point?</p>\n"}, {"tags": ["c++", "parallel-processing", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1527686993, "post_id": 50605477, "comment_id": 88221397, "body": "Check <code>MPI_Get_accumulate()</code>"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1527687373, "post_id": 50605477, "comment_id": 88221684, "body": "MPI is about message passing, not about shared memory (even if there are some functionalities in modern MPI). You should start with introduction level material on MPI."}, {"owner": {"reputation": 37, "user_id": 7629468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8IiXP.jpg?s=128&g=1", "display_name": "Abd Alrahman Alhorani", "link": "https://stackoverflow.com/users/7629468/abd-alrahman-alhorani"}, "edited": false, "score": 0, "creation_date": 1527690026, "post_id": 50605477, "comment_id": 88223753, "body": "thanks for information"}], "owner": {"reputation": 37, "user_id": 7629468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8IiXP.jpg?s=128&g=1", "display_name": "Abd Alrahman Alhorani", "link": "https://stackoverflow.com/users/7629468/abd-alrahman-alhorani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527685459, "creation_date": 1527685459, "question_id": 50605477, "link": "https://stackoverflow.com/questions/50605477/shared-data-between-task-mpi", "title": "shared data between task - mpi", "body": "<p>I am working on MPI with c++ for parallel program on visual studio 2012 and HPC pack from microsoft</p>\n\n<p>when i run my program :</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"mpi.h\"\n\nusing namespace std;\n\nvoid main(int argc, char * argv[]){     \n    MPI_Init(&amp;argc, &amp;argv);\n\n    int i = 0;\n    i++;\n\n    cout &lt;&lt; \"i = \" &lt;&lt; i &lt;&lt; endl;\n\n    MPI_Finalize();\n\n}\n</code></pre>\n\n<p>when i run in cmd :</p>\n\n<pre><code>mpiexec App.exe\n</code></pre>\n\n<p>the out put is :</p>\n\n<pre><code>1\n1\n1\n1\n</code></pre>\n\n<p>how to make the ' i ' variable is shared between all task and each of task increase its value so the output became :</p>\n\n<pre><code>1\n2\n3\n4\n</code></pre>\n\n<p>how to do that ?</p>\n\n<p>thanks for advance </p>\n"}, {"tags": ["c++", "vector"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 1, "creation_date": 1527684970, "post_id": 50605235, "comment_id": 88219899, "body": "Why, in <code>getCounterData</code>, do you loop through the <code>vector</code>, if you only want to print a specific element of a <code>vector</code>?"}, {"owner": {"reputation": 61303, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1527685006, "post_id": 50605235, "comment_id": 88219928, "body": "Can you please make your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> a bit more minimal? I have a hard time to even find the vector"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 5, "creation_date": 1527685028, "post_id": 50605235, "comment_id": 88219953, "body": "You never use <code>counter</code> in <code>getCounterData</code>. It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1527685366, "post_id": 50605235, "comment_id": 88220189, "body": "@NathanOliver vecData is a vector of objects of class  Counter and I intend to use the counter If I am able to atleast print the values of that vector"}, {"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 2, "creation_date": 1527687412, "post_id": 50605235, "comment_id": 88221722, "body": "Why does <code>Counter</code> have a member <code>std::vector&lt;Counter&gt;</code>? You might want to split it into two classes. <code>Counter</code> with the <code>int</code> members, and <code>Counters</code> with the <code>std::vector&lt;Counter&gt;</code> member. You seem confused as to which objects you are using for which purposes"}, {"owner": {"reputation": 693, "user_id": 2139902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0050129417b8d5d74968630b13da64c?s=128&d=identicon&r=PG", "display_name": "Sean Burton", "link": "https://stackoverflow.com/users/2139902/sean-burton"}, "edited": false, "score": 0, "creation_date": 1527692360, "post_id": 50605235, "comment_id": 88225464, "body": "You&#39;re creating a new instance of Counter and somehow expect to be able to get out of it the same values that you put into a completely different instance? I don&#39;t know what could possibly make you think that it could work like that..."}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "edited": false, "score": 0, "creation_date": 1528012498, "post_id": 50605465, "comment_id": 88338714, "body": "Thank you so much Jonathan, I understood why I was getting 0 values and tried sharing the vector between to classes using <code>shared_ptr</code> but ran in to a new error as can be seen from this link  <a href=\"https://stackoverflow.com/questions/50664165/segmentation-fault-on-using-shared-ptr-with-vectors?noredirect=1#comment88338534_50664165\" title=\"segmentation fault on using shared ptr with vectors\">stackoverflow.com/questions/50664165/&hellip;</a>"}], "tags": [], "owner": {"reputation": 152528, "user_id": 981959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04798ba8ef6591a9c23c5868dc0bf664?s=128&d=identicon&r=PG", "display_name": "Jonathan Wakely", "link": "https://stackoverflow.com/users/981959/jonathan-wakely"}, "is_accepted": true, "score": 4, "last_activity_date": 1527686093, "last_edit_date": 1527686093, "creation_date": 1527685423, "answer_id": 50605465, "question_id": 50605235, "link": "https://stackoverflow.com/questions/50605235/retrieving-data-from-vector-from-a-fresh-instance-returns-0/50605465#50605465", "title": "Retrieving data from vector from a fresh instance returns 0", "body": "<p>This is C++, don't use macros for constants:</p>\n\n<pre><code>#define MAX_PORTS 3\n</code></pre>\n\n<p>Use a <code>const</code> variable instead:</p>\n\n<pre><code>const int max_ports = 3;\n</code></pre>\n\n<p>Why are you creating this variable on the heap?</p>\n\n<pre><code>  Counter *counter = new Counter(3);\n  counter-&gt;age = 1;\n  counter-&gt;id = 12;\n  counter-&gt;pincode = 123;\n</code></pre>\n\n<p>C++ is not Java or C#, don't do that. You are failing to <code>delete</code> those variables, so you leak memory. Don't do that. This is the correct way:</p>\n\n<pre><code>  Counter counter(3);\n  counter.age = 1;\n  counter.id = 12;\n  counter.pincode = 123;\n</code></pre>\n\n<p>Then either change <code>setCounterData</code> to take a reference, or pass in the address of the object:</p>\n\n<pre><code>  counter-&gt;storeCounterData(&amp;counter,1);\n</code></pre>\n\n<p>You are indexing into the vector with the values <code>1</code>, <code>2</code> and <code>3</code>, but the vector only has three elements, so the correct indices are <code>0</code>, <code>1</code>, and <code>2</code>. Doing <code>vecData[user]</code> when <code>user==3</code> and <code>vecData.size()==3</code> is a serious bug. Don't do that.</p>\n\n<p>Why are you always accessing <code>vecData[1]</code> instead of using the iterator?</p>\n\n<pre><code>  std::vector&lt;Counter&gt;::iterator it;\n\n  for( it = vecData.begin(); it != vecData.end(); ++it)\n  {\n    std::cout&lt;&lt;vecData[1].age&lt;&lt;std::endl;\n    std::cout&lt;&lt;vecData[1].id&lt;&lt;std::endl;\n    std::cout&lt;&lt;vecData[1].pincode&lt;&lt;std::endl;\n  }\n</code></pre>\n\n<p>You probably meant this:</p>\n\n<pre><code>  std::vector&lt;Counter&gt;::iterator it;\n\n  for( it = vecData.begin(); it != vecData.end(); ++it)\n  {\n    std::cout&lt;&lt;it-&gt;age&lt;&lt;std::endl;\n    std::cout&lt;&lt;it-&gt;id&lt;&lt;std::endl;\n    std::cout&lt;&lt;it-&gt;pincode&lt;&lt;std::endl;\n  }\n</code></pre>\n\n<p>Or much simpler:</p>\n\n<pre><code>  for (auto&amp; c : vecData)\n  {\n    std::cout &lt;&lt; c.age &lt;&lt; std::endl;\n    std::cout &lt;&lt; c.id &lt;&lt; std::endl;\n    std::cout &lt;&lt; c.pincode &lt;&lt; std::endl;\n  }\n</code></pre>\n\n<p>(And notice how much easier it is to read that with spaces around the <code>&lt;&lt;</code> operators).</p>\n\n<blockquote>\n  <p>when I am trying to retrieve this data I am getting the value as 0</p>\n</blockquote>\n\n<p>The reason you always get 0 printed is because you are getting the data from an un-filled vector that just contains three new <code>Counter</code> objects:</p>\n\n<pre><code>  Counter *count = new Counter(3);\n  count-&gt;getCounterData(counterData);\n</code></pre>\n\n<p>You haven't stored any values in <code>count-&gt;vecData[1]</code> so the values you print out are just the default values created by the <code>Counter</code> constructor, which fails to initialize its members:</p>\n\n<pre><code>Counter::Counter()\n{  \n}\n</code></pre>\n\n<p>This means the member variables are just garbage. You happen to get zeros because your program has only just started so the heap happens to be full of zeros, but it's actually undefined behaviour to read those variables.</p>\n\n<p>Your <code>Counter</code> class needs to initialize those members properly:</p>\n\n<pre><code>class Counter\n{\nprivate:\n    std::vector&lt;Counter&gt; vecData; // vectors\n\npublic:\n    Counter();\n    Counter(int vecSize);\n    int age = 0;\n    int id = 0;\n    int pincode = 0;\n    void storeCounterData(Counter *counter,int user);\n    void getCounterData(std::vector&lt;Counter&gt; &amp;counter);\n};\n</code></pre>\n"}], "owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 50605465, "answer_count": 1, "score": -1, "last_activity_date": 1527686308, "creation_date": 1527684761, "last_edit_date": 1527685086, "question_id": 50605235, "link": "https://stackoverflow.com/questions/50605235/retrieving-data-from-vector-from-a-fresh-instance-returns-0", "title": "Retrieving data from vector from a fresh instance returns 0", "body": "<p>I am creating an instance after updating records to the vector <code>vecData</code> inside <code>counter.cpp</code> when I am trying to retrieve this data I am getting the value as <code>0</code></p>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"counter.hpp\"\n#define MAX_PORTS 3\n\nint main()\n{\n  Counter *counter = new Counter(3);\n  counter-&gt;age = 1;\n  counter-&gt;id = 12;\n  counter-&gt;pincode = 123;\n\n  std::vector&lt;Counter&gt; counterData(MAX_PORTS);\n\n  counter-&gt;storeCounterData(counter,1);\n  counter-&gt;storeCounterData(counter,2);\n  counter-&gt;storeCounterData(counter,3);\n\n  counter-&gt;getCounterData(counterData);\n\n  // getCounterData here is not able to retrieve value updated in above vector `vecData`\n\n  Counter *count = new Counter(3);\n  count-&gt;getCounterData(counterData);\n  return 0;\n}\n</code></pre>\n\n<p>counter.cpp</p>\n\n<pre><code>#include \"counter.hpp\"\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nCounter::Counter()\n{  \n}\n\nCounter::Counter(int vecSize):vecData(vecSize)\n{    \n}\n\nvoid Counter::storeCounterData(Counter *counter,int user)\n{\n  vecData[user].age = counter-&gt;age;\n  vecData[user].id = counter-&gt;id;\n  vecData[user].pincode = counter-&gt;pincode;\n\n  std::cout&lt;&lt;\"vector size inside storeCounterData = \"&lt;&lt;vecData.size()&lt;&lt;std::endl;\n}\n\nvoid Counter::getCounterData(std::vector&lt;Counter&gt; &amp;counter)\n{\n  counter = vecData;\n  std::cout&lt;&lt;\"vector size inside getCounterData = \"&lt;&lt;vecData.size()&lt;&lt;std::endl;\n  std::vector&lt;Counter&gt;::iterator it;\n\n  for( it = vecData.begin(); it != vecData.end(); ++it)\n  {\n    std::cout&lt;&lt;vecData[1].age&lt;&lt;std::endl;\n    std::cout&lt;&lt;vecData[1].id&lt;&lt;std::endl;\n    std::cout&lt;&lt;vecData[1].pincode&lt;&lt;std::endl;\n  }\n}\n</code></pre>\n\n<p>counter.hpp</p>\n\n<pre><code>#include &lt;vector&gt;\nclass Counter\n{\nprivate:\nstd::vector&lt;Counter&gt; vecData; // vectors\n\npublic:\nCounter();\nCounter(int vecSize);\nint age, id, pincode;\nvoid storeCounterData(Counter *counter,int user);\nvoid getCounterData(std::vector&lt;Counter&gt; &amp;counter);\n\n};\n</code></pre>\n\n<p>Output</p>\n\n<blockquote>\n  <p>./a.out vector size inside storeCounterData = 3</p>\n  \n  <p>vector size inside storeCounterData = 3</p>\n  \n  <p>vector size inside storeCounterData = 3</p>\n  \n  <p>vector size inside getCounterData = 3</p>\n  \n  <p>1 12 123</p>\n  \n  <p>1 12 123</p>\n  \n  <p>1 12 123</p>\n  \n  <p>vector size inside getCounterData = 3</p>\n  \n  <p>0 0 0</p>\n  \n  <p>0 0 0</p>\n  \n  <p>0 0 0</p>\n</blockquote>\n"}, {"tags": ["c++", "openmp"], "comments": [{"owner": {"reputation": 2172, "user_id": 1038318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e61594faa529a77cfd72735b7d8336?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/1038318/bort"}, "edited": false, "score": 0, "creation_date": 1527684784, "post_id": 50605136, "comment_id": 88219759, "body": "you need to define an environment of parallel tasks e.g. started with &quot;#pragma omp parallel&quot; followed by &quot;#pragma omp single nowait&quot;."}, {"owner": {"reputation": 1, "user_id": 9870258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nbiY3.jpg?s=128&g=1", "display_name": "Dmitry Shabat", "link": "https://stackoverflow.com/users/9870258/dmitry-shabat"}, "reply_to_user": {"reputation": 2172, "user_id": 1038318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e61594faa529a77cfd72735b7d8336?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/1038318/bort"}, "edited": false, "score": 0, "creation_date": 1527685417, "post_id": 50605136, "comment_id": 88220230, "body": "@Bort like this? #pragma omp parallel { #pragma omp single  { %code% } }"}, {"owner": {"reputation": 2172, "user_id": 1038318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e61594faa529a77cfd72735b7d8336?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/1038318/bort"}, "edited": false, "score": 0, "creation_date": 1527689895, "post_id": 50605136, "comment_id": 88223658, "body": "E.g. yes. See your error code <a href=\"https://docs.microsoft.com/en-gb/cpp/error-messages/compiler-errors-2/compiler-error-c3001\" rel=\"nofollow noreferrer\">here</a>. Although, I don&#39;t know about supported openmp versions in visual studio. So acraig5075 might be right and it won&#39;t work anyways."}], "answers": [{"tags": [], "owner": {"reputation": 9804, "user_id": 1332041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/871cd231304bb5650f381016cac34d8f?s=128&d=identicon&r=PG", "display_name": "acraig5075", "link": "https://stackoverflow.com/users/1332041/acraig5075"}, "is_accepted": false, "score": 5, "last_activity_date": 1527685248, "creation_date": 1527685248, "answer_id": 50605403, "question_id": 50605136, "link": "https://stackoverflow.com/questions/50605136/task-openmp-directive-name-required/50605403#50605403", "title": "task: OpenMP directive name required", "body": "<p>Visual C++ <a href=\"https://msdn.microsoft.com/en-us/library/tt15eb9t.aspx\" rel=\"noreferrer\">supports</a> the OpenMP 2.0 standard.</p>\n\n<p>OpenMP <a href=\"https://www.openmp.org/wp-content/uploads/OpenMP3.0-SummarySpec.pdf\" rel=\"noreferrer\">introduced</a> tasks with OpenMP 3.0</p>\n\n<p>i.e. It's unsupported.</p>\n"}], "owner": {"reputation": 1, "user_id": 9870258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nbiY3.jpg?s=128&g=1", "display_name": "Dmitry Shabat", "link": "https://stackoverflow.com/users/9870258/dmitry-shabat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527685248, "creation_date": 1527684530, "question_id": 50605136, "link": "https://stackoverflow.com/questions/50605136/task-openmp-directive-name-required", "title": "task: OpenMP directive name required", "body": "<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cstdlib&gt;\n#include &lt;locale&gt;\n#include &lt;omp.h&gt;\n\nusing namespace std;\n\ntypedef pair&lt;int, int&gt; pii;\ntypedef long long ll;\n\nll fib(int n) {\n    if (n &lt;= 1)\n        return 1;\n    ll a, b;\n#pragma omp task shared(a)\n    a = fib(n - 1);\n#pragma omp task shared(b)\n    b = fib(n - 2);\n#pragma omp taskwait\n    return a + b;\n}\n\nint main(int argc, char* argv[]) {\n    setlocale(LC_ALL, \"\");\n    int n;\n    scanf_s(\"%d\", &amp;n);\n    printf(\"Result: %lld\\n\", fib(n));\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p><hr>\nVisual Studio returns C3001 error <b>\"task: OpenMP directive name required\"</b>.<br>\nIf I comment all the \"pragma\" it works fine, so there must be a problem with OpenMP. Some other program with \"#pragma omp parallel\" works fine, it's just the problem with the \"task\" directive.<br>\nWhat could be the problem?</p>\n"}, {"tags": ["c++", "debugging", "inline-assembly"], "comments": [{"owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 3, "creation_date": 1527685312, "post_id": 50605121, "comment_id": 88220156, "body": "Nitpick: <code>NULL</code> may not be an <code>int</code> value. If you mean <code>EXIT_SUCCESS</code>, write <code>EXIT_SUCCESS</code>, or if you mean <code>0</code> write <code>0</code>"}, {"owner": {"reputation": 203, "user_id": 9268948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I4GWR.jpg?s=128&g=1", "display_name": "Segy", "link": "https://stackoverflow.com/users/9268948/segy"}, "reply_to_user": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "edited": false, "score": 0, "creation_date": 1527685971, "post_id": 50605121, "comment_id": 88220639, "body": "it works with NULL, anyway thats not primary problem...."}, {"owner": {"reputation": 861, "user_id": 743414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4865c7841b624ea4f967e6d1806bbbb0?s=128&d=identicon&r=PG", "display_name": "user743414", "link": "https://stackoverflow.com/users/743414/user743414"}, "edited": false, "score": 0, "creation_date": 1527687681, "post_id": 50605121, "comment_id": 88221960, "body": "There&#39;re lot of papers around how anti-debugging techniques work, so take google, read and understand what you find."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 9268948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I4GWR.jpg?s=128&g=1", "display_name": "Segy", "link": "https://stackoverflow.com/users/9268948/segy"}, "edited": false, "score": 0, "creation_date": 1527685860, "post_id": 50605386, "comment_id": 88220543, "body": "IsDebuggerPresent can be easily bypassed and DebugBreak has same result, DebugBreak=int 3 (its same in disassembly)"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527689212, "post_id": 50605386, "comment_id": 88223136, "body": "@Caleth at a stab, I&#39;d guess that they&#39;re trying to prevent debuggers being attached - but then clearly stripping the exe&#39;s would be the better way forward."}, {"owner": {"reputation": 203, "user_id": 9268948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I4GWR.jpg?s=128&g=1", "display_name": "Segy", "link": "https://stackoverflow.com/users/9268948/segy"}, "edited": false, "score": 0, "creation_date": 1542218698, "post_id": 50605386, "comment_id": 93493261, "body": "<code>IsDebuggerPresent</code> can be easilly hooked, better is to call manulay <code>NtQueryInformationProcess</code>"}], "tags": [], "owner": {"reputation": 34388, "user_id": 2610810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c6433073e71478e8da278a188e1d15?s=128&d=identicon&r=PG", "display_name": "Caleth", "link": "https://stackoverflow.com/users/2610810/caleth"}, "is_accepted": false, "score": 2, "last_activity_date": 1527685194, "creation_date": 1527685194, "answer_id": 50605386, "question_id": 50605121, "link": "https://stackoverflow.com/questions/50605121/detect-debugger-in-c-with-zero-division-exception/50605386#50605386", "title": "Detect debugger in c++ with zero division exception", "body": "<p>Given that you are using <code>\"windows.h\"</code>, you can simplify it to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms680345(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>IsDebuggerPresent</code></a>, and / or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms679297(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>DebugBreak</code></a></p>\n"}], "owner": {"reputation": 203, "user_id": 9268948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I4GWR.jpg?s=128&g=1", "display_name": "Segy", "link": "https://stackoverflow.com/users/9268948/segy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527685194, "creation_date": 1527684498, "question_id": 50605121, "link": "https://stackoverflow.com/questions/50605121/detect-debugger-in-c-with-zero-division-exception", "title": "Detect debugger in c++ with zero division exception", "body": "<p>I found function written in c++ which is able to detect debugger when I execute</p>\n\n<pre><code>xor eax, eax\ndiv eax\n</code></pre>\n\n<p>but the problem is when a debugger is attached the process crashes after reaching <code>div eax</code>. I put that inline asm to __try and __except section but after reaching instruction <code>div eax</code> process just freezes. Whole code:</p>\n\n<pre><code>#include \"windows.h\"\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nLONG WINAPI UnhandledExcepFilter(PEXCEPTION_POINTERS pExcepPointers) {\n    SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)pExcepPointers-&gt;ContextRecord-&gt;Eax);\n    pExcepPointers-&gt;ContextRecord-&gt;Eip += 2;\n    return EXCEPTION_CONTINUE_EXECUTION;\n}\n\nint main() {\n     SetUnhandledExceptionFilter(UnhandledExcepFilter);\n\n    __try {\n        __asm {\n            xor eax, eax\n            div eax\n        }\n    }\n    __except (EXCEPTION_INT_DIVIDE_BY_ZERO) {\n        cout &lt;&lt; \"DEBUGGER NOT FOUND\" &lt;&lt; endl;\n    }\n\nreturn NULL;\n}\n</code></pre>\n\n<p>I need just silently detect debugger.\nThx for any help.</p>\n"}]